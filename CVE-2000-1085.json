{"id": "CVE-2000-1085", "sourceIdentifier": "cve@mitre.org", "published": "2001-01-09T05:00:00.000", "lastModified": "2018-10-12T21:29:57.170", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The xp_peekqueue function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) does not properly restrict the length of a buffer before calling the srv_paraminfo function in the SQL Server API for Extended Stored Procedures (XP), which allows an attacker to cause a denial of service or execute arbitrary commands, aka the \"Extended Stored Procedure Parameter Parsing\" vulnerability."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.6}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.9, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:data_engine:1.0:*:*:*:*:*:*:*", "matchCriteriaId": "F455C373-A9F7-47F9-828E-DEE2C8CC6545"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:data_engine:2000:*:*:*:*:*:*:*", "matchCriteriaId": "51ABD323-BF3F-4825-8788-8FCD614E83E4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:sql_server:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "A2AB95D7-394E-423B-884C-87A9960682EE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:sql_server:2000:*:*:*:*:*:*:*", "matchCriteriaId": "A5D559EE-727C-405C-987C-247973A84D32"}]}]}], "references": [{"url": "http://marc.info/?l=bugtraq&m=97570884410184&w=2", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/2040", "source": "cve@mitre.org", "tags": ["Exploit", "Patch", "Vendor Advisory"]}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2000/ms00-092", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1007", "comment": "CVE-2000-1085 - Attackers can inject malicious data into memory, potentially leading to arbitrary code execution, by exploiting the xp_peekqueue function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE)."}, {"techniqueID": "T1053", "comment": "CVE-2000-1085 - The vulnerability allows for command execution on the affected system. Attackers can exploit this vulnerability to execute arbitrary commands, leading to code execution."}, {"techniqueID": "T1204", "comment": "CVE-2000-1085 - This vulnerability involves an attacker injecting malicious data into memory, potentially leading to command execution. Detection and prevention measures should focus on monitoring for suspicious memory access and data manipulation activities."}], "stix_bundle": {"@stix_Malware": {"id": "stix_bundle: mitre_stix_bundle", "info_type": "bundle", "created_by_ref": "init_user", "created_at": "2020-09-21T14:30:00.000", "bundle_version": "1.0.0", "objects": {"vulnerability": {"type": "vulnerability", "id": "vulnerability: CVE-2000-1085", "info_type": "vulnerability", "name": "CVE-2000-1085", "description": "The xp_peekqueue function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) does not properly restrict the length of a buffer before calling the srv_paraminfo function in the SQL Server API for Extended Stored Procedures (XP), which allows an attacker to cause a denial of service or execute arbitrary commands.", "created_by_ref": "init_user", "created_at": "2020-09-21T14:30:00.000", "affected_systems": [{"type": "system", "id": "system: Microsoft SQL Server 2000", "info_type": "system", "name": "Microsoft SQL Server 2000", "description": ""}], "cve": [{"type": "cve", "id": "CVE-2000-1085", "info_type": "cve", "name": "CVE-2000-1085", "description": "The xp_peekqueue function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) does not properly restrict the length of a buffer before calling the srv_paraminfo function in the SQL Server API for Extended Stored Procedures (XP), which allows an attacker to cause a denial of service or execute arbitrary commands.", "cvss": {"vector": "AV:L/AC:L/Au:N/C:P/I:P/A:P", "score": 4.6}}]}}}, "courses_of_action": {"type": "courses_of_action", "id": "course_of_action: Common Vulnerabilities", "info_type": "courses_of_action", "name": "Common Vulnerabilities", "description": "", "corrective_action": [{"type": "corrective_action", "id": "corrective_action: Mitigate with Patch", "info_type": "corrective_action", "name": "Mitigate with Patch", "description": "Patch the vulnerability to prevent exploitation.", "mitigates": "T1007"}]}, "inputs": {"type": "inputs", "id": "input: Microsoft SQL Server 2000", "info_type": "inputs", "name": "Microsoft SQL Server 2000", "description": ""}}, "technical_analysis": {"Introduction": "The vulnerability CVE-2000-1085 allows an attacker to inject malicious data into memory, potentially leading to command execution. This vulnerability is affecting Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE).", "Impact and Scope": "The vulnerability has a CVSS score of 4.6 and an attack vector of LOCAL. It allows for command execution on the affected system.", "Related MITRE ATT&CK Techniques": "T1007, T1053, T1204", "Technical Details": "The vulnerability is caused by the xp_peekqueue function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) not properly restricting the length of a buffer before calling the srv_paraminfo function in the SQL Server API for Extended Stored Procedures (XP).", "Detection": "Detection can be achieved by monitoring for suspicious memory access and data manipulation activities.", "Mitigation": "The vulnerability can be mitigated by applying the patch provided by Microsoft. Additionally, monitoring for suspicious memory access and data manipulation activities can help detect potential exploitation.", "Conclusion": "In conclusion, the vulnerability CVE-2000-1085 is a serious threat to systems running Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) and should be prioritized for remediation."}, "executive_analysis": {"Overview": "The vulnerability CVE-2000-1085 is a serious threat to systems running Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE). It allows for command execution on the affected system and has a CVSS score of 4.6.", "Business Impact": "The vulnerability can result in the compromise of sensitive data, disruption of business operations, and financial losses.", "Technical Impact": "The vulnerability allows for command execution on the affected system, which can be used to access and manipulate sensitive data.", "Mitigation Strategies": "Apply the patch provided by Microsoft and monitor for suspicious memory access and data manipulation activities.", "Recommendations": "Prioritize remediation of this vulnerability, and consider implementing additional security measures such as memory protection and data encryption.", "Conclusions": "In conclusion, the vulnerability CVE-2000-1085 is a serious threat that requires immediate attention and remediation to protect systems and data."}}