{"id": "CVE-2024-29029", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-19T16:15:09.853", "lastModified": "2024-07-31T21:15:16.920", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "memos is a privacy-first, lightweight note-taking service. In memos 0.13.2, an SSRF vulnerability exists at the /o/get/image that allows unauthenticated users to enumerate the internal network and retrieve images. The response from the image request is then copied into the response of the current server request, causing a reflected XSS vulnerability. Version 0.22.0 of memos removes the vulnerable file."}, {"lang": "es", "value": "Memos es un servicio de toma de notas liviano y que prioriza la privacidad. En memos 0.13.2, existe una vulnerabilidad SSRF en /o/get/image que permite a usuarios no autenticados enumerar la red interna y recuperar im\u00e1genes. Luego, la respuesta de la solicitud de imagen se copia en la respuesta de la solicitud del servidor actual, lo que provoca una vulnerabilidad XSS reflejada."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}, {"lang": "en", "value": "CWE-918"}]}], "references": [{"url": "https://github.com/usememos/memos/blob/06dbd8731161245444f4b50f4f9ed267f7c3cf63/api/v1/http_getter.go#L29", "source": "security-advisories@github.com"}, {"url": "https://github.com/usememos/memos/commit/bbd206e8930281eb040cc8c549641455892b9eb5", "source": "security-advisories@github.com"}, {"url": "https://securitylab.github.com/advisories/GHSL-2023-154_GHSL-2023-156_memos/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-29029 - An SSRF vulnerability in memos allows an attacker to enumerate the internal network and retrieve images, which can be used to launch a reflected XSS attack. Defend against this by validating user input and sanitizing output."}, {"techniqueID": "T1502", "comment": "CVE-2024-29029 - The vulnerable file in memos can be used to launch a reflected XSS attack. Defend against this by validating user input and sanitizing output."}, {"techniqueID": "T1547", "comment": "CVE-2024-29029 - The SSRF vulnerability in memos allows an attacker to retrieve sensitive information from the internal network. Defend against this by limiting access to sensitive information and validating user input."}], "stix_bundle": {"bundle": {"id": "cve-2024-29029", "type": "bundle", "created_by": "security-advisories@github.com", "created": "2024-04-19T16:15:09.853", "modified": "2024-07-31T21:15:16.920", "contributed_by": [{"id": "security-advisories@github.com", "type": "organization"}], "description": "A STIX 2.1 bundle describing the vulnerability CVE-2024-29029", "package": {"id": "cve-2024-29029", "type": "indicator", "created_by": "security-advisories@github.com", "created": "2024-04-19T16:15:09.853", "modified": "2024-07-31T21:15:16.920", "title": "memos SSRF vulnerability", "description": "A vulnerability exists in the memos note-taking service allowing SSRF and reflected XSS attacks.", "first_observed": "2023-12-01T00:00:00.000", "last_observed": "2024-06-30T23:59:59.999", "observable": {"type": "file", "name": "memos/api/v1/http_getter.go", "hashes": [{"type": "sha512", "value": "6dbd8731161245444f4b50f4f9ed267f7c3cf63"}]}, "note": {"title": "Vulnerability Description", "text": "A vulnerability exists in the memos note-taking service allowing SSRF and reflected XSS attacks."}, "kill_chain_phases": [{"kill_chain_name": "attack", "phase_name": "initial_access", "phase_module": "persistent_escalation"}, {"kill_chain_name": "attack", "phase_name": "execution", "phase_module": "defense_evasion"}, {"kill_chain_name": "attack", "phase_name": "persistent_escalation", "phase_module": "credential_theft"}], "ttp": {"id": "TA0001", "title": "Initial Access", "description": "The attacker uses SSRF and reflected XSS attacks to gain access to the internal network", "tactics": ["PRE-ATTACK-EXECUTION"]}, "courses_of_action": [{"title": "validate user input", "description": "Validate user input to prevent SSRF and reflected XSS attacks", "techniques": ["T1190", "T1502", "T1547"]}, {"title": "sanitize output", "description": "Sanitize output to prevent SSRF and reflected XSS attacks", "techniques": ["T1190", "T1502", "T1547"]}]}}}, "technical_analysis": {"Introduction": "The memos SSRF vulnerability allows an attacker to enumerate the internal network and retrieve images, which can be used to launch a reflected XSS attack.", "Impact and Scope": "The vulnerability has a CVSS score of 6.1 with a medium severity, and affects versions 0.13.2 and below of the memos note-taking service.", "Related MITRE ATT&CK Techniques": "T1190, T1502, and T1547", "Technical Details": "The vulnerability exists in the /o/get/image endpoint, which allows an attacker to request and retrieve images from the internal network.", "Detection": "Detect the vulnerability by monitoring for SSRF and reflected XSS attacks and sensitive information being accessed from the internal network.", "Mitigation": "Validate user input and sanitize output to prevent SSRF and reflected XSS attacks and limit access to sensitive information.", "Conclusion": "The memos SSRF vulnerability is a serious threat that can be used to launch a reflected XSS attack and access sensitive information. Validating user input and sanitizing output is essential to prevent this vulnerability."}, "executive_analysis": {"Overview": "The memos SSRF vulnerability is a serious threat that can be used to launch a reflected XSS attack and access sensitive information.", "Business Impact": "The vulnerability can be used to steal sensitive information and disrupt business operations.", "Technical Impact": "The vulnerability can be used to access sensitive information and launch a reflected XSS attack.", "Mitigation Strategies": "Implement measures to validate user input and sanitize output to prevent SSRF and reflected XSS attacks.", "Recommendations": "Recommendation to management: Implement measures to mitigate the vulnerability and prevent SSRF and reflected XSS attacks.", "Conclusions": "The memos SSRF vulnerability is a serious threat that requires immediate attention and action to mitigate and prevent."}}