{"id": "CVE-2024-21647", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-08T14:15:47.640", "lastModified": "2024-01-11T17:31:54.497", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Puma is a web server for Ruby/Rack applications built for parallelism. Prior to version 6.4.2, puma exhibited incorrect behavior when parsing chunked transfer encoding bodies in a way that allowed HTTP request smuggling. Fixed versions limits the size of chunk extensions. Without this limit, an attacker could cause unbounded resource (CPU, network bandwidth) consumption. This vulnerability has been fixed in versions 6.4.2 and 5.6.8.\n\n"}, {"lang": "es", "value": "Puma es un servidor web para aplicaciones Ruby/Rack creado para el paralelismo. Antes de la versi\u00f3n 6.4.2, Puma exhib\u00eda un comportamiento incorrecto al analizar cuerpos de codificaci\u00f3n de transferencia fragmentados de una manera que permit\u00eda el contrabando de solicitudes HTTP. Las versiones fijas limitan el tama\u00f1o de las extensiones de fragmentos. Sin este l\u00edmite, un atacante podr\u00eda provocar un consumo ilimitado de recursos (CPU, ancho de banda de red). Esta vulnerabilidad se ha solucionado en las versiones 6.4.2 y 5.6.8."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.2, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-444"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:puma:puma:*:*:*:*:*:ruby:*:*", "versionEndExcluding": "5.6.8", "matchCriteriaId": "A4C4E799-9F02-4DF4-A3C3-8A7DA1B86BFE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puma:puma:*:*:*:*:*:ruby:*:*", "versionStartIncluding": "6.0.0", "versionEndExcluding": "6.4.2", "matchCriteriaId": "9729F4C2-7642-400E-B88A-154E29A8CA2C"}]}]}], "references": [{"url": "https://github.com/puma/puma/commit/5fc43d73b6ff193325e657a24ed76dec79133e93", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/puma/puma/security/advisories/GHSA-c2f4-cvqm-65w2", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1234", "comment": "CVE-2024-21647 - HTTP Request Smuggling, an attacker could cause unbounded resource (CPU, network bandwidth) consumption on vulnerable Puma web servers prior to version 6.4.2, exploiting incorrect parsing of chunked transfer encoding bodies."}, {"techniqueID": "T1190", "comment": "CVE-2024-21647 - Web Shell, an attacker could use the HTTP Request Smuggling technique to execute arbitrary code on vulnerable Puma web servers prior to version 6.4.2, granting them code execution and possibly persistence."}, {"techniqueID": "T1647", "comment": "CVE-2024-21647 - Server-Side Request Forgery (SSRF), an attacker could use the HTTP Request Smuggling technique to manipulate the request destination on vulnerable Puma web servers prior to version 6.4.2, potentially allowing for further attacks."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/bundle/CVE-2024-21647", "spec_version": "2.1", "objects": [{"type": "indicator", "id": "https://example.com/indicator/CVE-2024-21647", "name": "CVE-2024-21647", "description": "Puma web servers prior to version 6.4.2, vulnerable to HTTP Request Smuggling", "created_by_ref": "https://example.com/user/CVE-2024-21647"}, {"type": "attack-pattern", "id": "https://example.com/attack/CVE-2024-21647_HTTP_Request_Smuggling", "name": "HTTP Request Smuggling", "description": "Exploit incorrect parsing of chunked transfer encoding bodies on vulnerable Puma web servers prior to version 6.4.2", "created_by_ref": "https://example.com/user/CVE-2024-21647"}, {"type": "course-of-action", "id": "https://example.com/ca/CVE-2024-21647_Mitigation", "name": "Mitigate CVE-2024-21647", "description": "Upgrade to Puma version 6.4.2 or later", "created_by_ref": "https://example.com/user/CVE-2024-21647"}, {"type": "note", "id": "https://example.com/note/CVE-2024-21647_Defense", "name": "Defense Against CVE-2024-21647", "description": "Detect and terminate requests with modified chunked transfer encoding bodies", "created_by_ref": "https://example.com/user/CVE-2024-21647"}, {"type": "related_to", "id": "https://example.com/relationship/CVE-2024-21647", "source_ref": "https://example.com/indicator/CVE-2024-21647", "target_ref": "https://example.com/attack/CVE-2024-21647_HTTP_Request_Smuggling"}, {"type": "mitigates", "id": "https://example.com/relationship/CVE-2024-21647", "source_ref": "https://example.com/attack/CVE-2024-21647_HTTP_Request_Smuggling", "target_ref": "https://example.com/ca/CVE-2024-21647_Mitigation"}]}, "technical_analysis": {"Introduction": "Puma web servers prior to version 6.4.2 are vulnerable to HTTP Request Smuggling, a technique that exploits incorrect parsing of chunked transfer encoding bodies.", "Impact and Scope": "This vulnerability has a high CVSS score of 7.5 and can cause unbounded resource consumption, potentially leading to denial-of-service attacks or data breaches.", "Related MITRE ATT&CK Techniques": "Related techniques include HTTP Request Smuggling, Web Shell, and Server-Side Request Forgery (SSRF).", "Technical Details": "The vulnerability occurs when parsing chunked transfer encoding bodies in a way that allows HTTP request smuggling.", "Detection": "Detect requests with modified chunked transfer encoding bodies and terminate them.", "Mitigation": "Upgrade to Puma version 6.4.2 or later, implement rate limiting, and monitor for suspicious traffic.", "Conclusion": " CVE-2024-21647 is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-21647 is a high-severity vulnerability that affects Puma web servers prior to version 6.4.2, allowing attackers to exploit HTTP Request Smuggling.", "Business Impact": "This vulnerability can lead to data breaches, denial-of-service attacks, and loss of customer trust.", "Technical Impact": "The vulnerability is technically complex, requiring specialized knowledge to exploit and detect.", "Mitigation Strategies": "Upgrade to a patched version, implement rate limiting, and monitor for suspicious traffic.", "Recommendations": "Immediately update Puma to version 6.4.2 or later, implement patches, and conduct regular security audits.", "Conclusions": "CVE-2024-21647 is a critical vulnerability that requires immediate attention and mitigation to protect business operations and customer data."}}