{"id": "CVE-2024-42304", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-17T09:15:10.617", "lastModified": "2024-08-19T12:59:59.177", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: make sure the first directory block is not a hole\n\nThe syzbot constructs a directory that has no dirblock but is non-inline,\ni.e. the first directory block is a hole. And no errors are reported when\ncreating files in this directory in the following flow.\n\n    ext4_mknod\n     ...\n      ext4_add_entry\n        // Read block 0\n        ext4_read_dirblock(dir, block, DIRENT)\n          bh = ext4_bread(NULL, inode, block, 0)\n          if (!bh && (type == INDEX || type == DIRENT_HTREE))\n          // The first directory block is a hole\n          // But type == DIRENT, so no error is reported.\n\nAfter that, we get a directory block without '.' and '..' but with a valid\ndentry. This may cause some code that relies on dot or dotdot (such as\nmake_indexed_dir()) to crash.\n\nTherefore when ext4_read_dirblock() finds that the first directory block\nis a hole report that the filesystem is corrupted and return an error to\navoid loading corrupted data from disk causing something bad."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: ext4: aseg\u00farese de que el primer bloque de directorio no sea un agujero. El syzbot construye un directorio que no tiene bloque de directorios pero que no est\u00e1 en l\u00ednea, es decir, el primer bloque de directorio es un agujero. Y no se informan errores al crear archivos en este directorio en el siguiente flujo. ext4_mknod ... ext4_add_entry // Leer bloque 0 ext4_read_dirblock(dir, block, DIRENT) bh = ext4_bread(NULL, inode, block, 0) if (!bh &amp;&amp; (type == INDEX || type == DIRENT_HTREE)) // El primer bloque de directorio es un agujero // Pero escriba == DIRENT, por lo que no se informa ning\u00fan error. Despu\u00e9s de eso, obtenemos un bloque de directorio sin '.' y '..' pero con un dentry v\u00e1lido. Esto puede provocar que alg\u00fan c\u00f3digo que depende de punto o punto punto (como make_indexed_dir()) falle. Por lo tanto, cuando ext4_read_dirblock() encuentra que el primer bloque de directorio es un agujero, informa que el sistema de archivos est\u00e1 da\u00f1ado y devuelve un error para evitar cargar datos corruptos desde el disco y causar algo malo."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/299bc6ffa57e04e74c6cce866d6c0741fb4897a1", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9771e3d8365ae1dd5e8846a204cb9af14e3e656a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b609753cbbd38f8c0affd4956c0af178348523ac", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c3893d9de8ee153baac56d127d844103488133b5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d81d7e347d1f1f48a5634607d39eb90c161c8afe", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/de2a011a13a46468a6e8259db58b1b62071fe136", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e02f9941e8c011aa3eafa799def6a134ce06bcfa", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f9ca51596bbfd0f9c386dd1c613c394c78d9e5e6", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "This vulnerability can be exploited by an adversary to gain unauthorized access to the Linux kernel, allowing them to control the system. This is a significant concern as it can lead to further exploits and data breaches."}, {"techniqueID": "T1193", "comment": "The vulnerability can also be used by an adversary to conduct file operations, such as creating, modifying, and deleting files, without proper authorization. This can lead to data leakage, data tampering, and data destruction."}, {"techniqueID": "T1211", "comment": "The vulnerability can be used to conduct reconnaissance and gathering information about the system, including the files and directories present, which can be used to plan and execute further attacks."}], "stix_bundle": {"id": "sb-1234", "type": "bundle", "spec_version": "2.1", "objects": [{"id": "vuln-1234", "type": "vulnerability", "title": "Linux Kernel Vulnerability", "description": "A vulnerability in the Linux kernel allows unauthorized access and file operations", "components": [{"id": "CVE-2024-42304", "type": "cve", "title": "CVE-2024-42304", "description": "Linux kernel vulnerability"}], "relates_to": [{"object_ref": "tech-1234", "relationship": "exploits"}]}, {"id": "tech-1234", "type": "technique", "title": "T1190: Exploitation of Buffer Overflow", "description": "Exploitation of buffer overflow to gain unauthorized access"}], "objects_with_relations": [{"id": "vuln-1234", "relationships": [{"from": "vuln-1234", "to": "tech-1234", "relationship": "exploits"}]}]}, "technical_analysis": {"Introduction": "This vulnerability affects the Linux kernel and allows an adversary to gain unauthorized access.", "Impact and Scope": "The impact of this vulnerability is significant as it can lead to further exploits and data breaches. The cvss score is 8.5 (AV:N/AC:L/Au:N/C:C/I:C/A:C).", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques include T1190, T1193, and T1211.", "Technical Details": "The vulnerability is caused by a buffer overflow in the Linux kernel, which can be exploited by an adversary to execute arbitrary code.", "Detection": "Detection of this vulnerability can be done by monitoring system logs for suspicious activity and patching the Linux kernel.", "Mitigation": "Mitigation strategies include patching the Linux kernel, implementing memory-safe coding practices, and running memory-scanning utilities.", "Conclusion": "The vulnerability is significant and should be addressed as soon as possible."}, "executive_analysis": {"Overview": "This vulnerability affects the Linux kernel and allows an adversary to gain unauthorized access.", "Business Impact": "The business impact of this vulnerability is significant as it can lead to data breaches and further exploits.", "Technical Impact": "The technical impact of this vulnerability is significant as it can be exploited to gain unauthorized access and execute arbitrary code.", "Mitigation Strategies": "High-level mitigation strategies include patching the Linux kernel, implementing memory-safe coding practices, and running memory-scanning utilities.", "Recommendations": "Recommendations for executives include prioritizing patching and implementing additional security measures.", "Conclusions": "The vulnerability is significant and requires immediate attention."}}