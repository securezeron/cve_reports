{"id": "CVE-2024-2029", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-10T17:15:53.880", "lastModified": "2024-04-10T19:49:51.183", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A command injection vulnerability exists in the `TranscriptEndpoint` of mudler/localai, specifically within the `audioToWav` function used for converting audio files to WAV format for transcription. The vulnerability arises due to the lack of sanitization of user-supplied filenames before passing them to ffmpeg via a shell command, allowing an attacker to execute arbitrary commands on the host system. Successful exploitation could lead to unauthorized access, data breaches, or other detrimental impacts, depending on the privileges of the process executing the code."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "references": [{"url": "https://github.com/mudler/localai/commit/31a4c9c9d3abc58de2bdc5305419181c8b33eb1c", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/e092528a-ce3b-4e66-9b98-3f56d6b276b0", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1059.003", "comment": "CVE-2024-2029 - Command Injection attack allowing an attacker to execute arbitrary commands on the host system. This is a High-Impact attack and requires attention to defense against it."}, {"techniqueID": "T1027", "comment": "CVE-2024-2029 - Command Injection attack allowing an attacker to execute arbitrary commands on the host system. This could be part of a larger attack scenario requiring monitoring for lateral movement."}, {"techniqueID": "T1190", "comment": "CVE-2024-2029 - Command Injection attack allowing an attacker to execute arbitrary commands on the host system. This could be part of a deception campaign."}], "stix_bundle": {"type": "bundle", "id": "bundle-f6e45e77-10a4-4f44-be32-5f93d97f32ad", "spec_version": "2.1", "objects": [{"type": "vulnerability", "id": "vulnerability-16b8a8f5-71a3-4f21-a15f-b016a86bb8b5", "created_by_ref": "identity-5f6f0c6d-39f6-4cda-a3f9-3482c49a1d3c", "modified": "2024-04-10T19:49:51.183", "name": "CVE-2024-2029: Command Injection in mudler/localai's TranscriptEndpoint", "description": "A command injection vulnerability exists in the `TranscriptEndpoint` of mudler/localai, specifically within the `audioToWav` function used for converting audio files to WAV format for transcription.", "severity": "high", "references": [{"relationship": "related", "type": "report", "id": "report-9a4e7f35-14d2-4149-9e6c-6c37a5a3a9e8"}]}, {"type": "report", "id": "report-9a4e7f35-14d2-4149-9e6c-6c37a5a3a9e8", "created_by_ref": "identity-5f6f0c6d-39f6-4cda-a3f9-3482c49a1d3c", "modified": "2024-04-10T17:15:53.880", "name": "Report on CVE-2024-2029: Command Injection in mudler/localai's TranscriptEndpoint", "description": "A report detailing the findings and analysis of the command injection vulnerability in the `TranscriptEndpoint` of mudler/localai.", "objects": [{"type": "indicator", "id": "indicator-1e11cd16-9b22-4c6e-a53b-30a6c93c2af5", "name": "CVE-2024-2029: Command Injection Payload", "description": "The payload used to exploit the command injection vulnerability in the `TranscriptEndpoint` of mudler/localai.", "pattern": "/.+/.+/", "valid_from": "2024-04-10T00:00:00.000", "valid_until": "2024-04-10T23:59:59.999", "created_by_ref": "identity-5f6f0c6d-39f6-4cda-a3f9-3482c49a1d3c", "modified": "2024-04-10T17:15:53.880", "relationships": [{"relationship": "observed-data", "type": "report", "id": "report-9a4e7f35-14d2-4149-9e6c-6c37a5a3a9e8"}]}]}], "required_object\u5173\u7cfb\u94fe": [{"object_ref": "vulnerability-16b8a8f5-71a3-4f21-a15f-b016a86bb8b5", "relationship": "affected-by", "relationship_type": "T1059.003"}]}, "technical_analysis": {"Introduction": "The CVE-2024-2029 is a command injection vulnerability in the `TranscriptEndpoint` of mudler/localai's `audioToWav` function.", "Impact and Scope": "The vulnerability allows an attacker to execute arbitrary commands on the host system, with a CVSS score of 9.8 and an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "T1059.003, T1027, T1190", "Technical Details": "The vulnerability arises due to the lack of sanitization of user-supplied filenames before passing them to ffmpeg via a shell command.", "Detection": "Detection may involve monitoring for unusual network traffic patterns and analyzing system logs for signs of command injection.", "Mitigation": "Mitigation involves implementing code changes to sanitize user-supplied filenames and limiting access to sensitive files.", "Conclusion": "The CVE-2024-2029 is a critical vulnerability requiring immediate attention to patch and remediate."}, "executive_analysis": {"Overview": "The CVE-2024-2029 is a command injection vulnerability in the `TranscriptEndpoint` of mudler/localai's `audioToWav` function, allowing an attacker to execute arbitrary commands on the host system.", "Business Impact": "If exploited, the vulnerability could result in unauthorized access, data breaches, or other detrimental impacts, potentially leading to significant financial losses and reputational damage.", "Technical Impact": "The vulnerability allows unauthorized access to system resources, potentially leading to data theft, privilege escalation, and denial-of-service attacks.", "Mitigation Strategies": "Implement code changes to sanitize user-supplied filenames, limit access to sensitive files, and monitor for unusual network traffic patterns.", "Recommendations": "Executives should prioritize patching and remediation of the vulnerability to minimize the risk of exploitation, and work with IT teams to develop a strategy to detect and respond to potential attacks.", "Conclusions": "The CVE-2024-2029 is a critical vulnerability requiring immediate attention to patch and remediate, and executives should prioritize this matter to minimize the risk of exploitation."}}