{"id": "CVE-2024-25636", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-19T20:15:46.077", "lastModified": "2024-02-20T19:50:53.960", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Misskey is an open source, decentralized social media platform with ActivityPub support. Prior to version 2024.2.0, when fetching remote Activity Streams objects, Misskey doesn't check that the response from the remote server has a `Content-Type` header value of the Activity Streams media type, which allows a threat actor to upload a crafted Activity Streams document to a remote server and make a Misskey instance fetch it, if the remote server accepts arbitrary user uploads. The vulnerability allows a threat actor to impersonate and take over an account on a remote server that satisfies all of the following properties: allows the threat actor to register an account; accepts arbitrary user-uploaded documents and places them on the same domain as legitimate Activity Streams actors; and serves user-uploaded document in response to requests with an `Accept` header value of the Activity Streams media type. Version 2024.2.0 contains a patch for the issue."}, {"lang": "es", "value": "Misskey es una plataforma de redes sociales descentralizada y de c\u00f3digo abierto con soporte ActivityPub. Antes de la versi\u00f3n 2024.2.0, al recuperar objetos remotos de Activity Streams, Misskey no verifica que la respuesta del servidor remoto tenga un valor de encabezado `Content-Type` del tipo de medio Activity Streams, lo que permite a un actor de amenazas cargar un documento de Activity Streams elaborado a un servidor remoto y hacer que una instancia de Misskey lo recupere, si el servidor remoto acepta cargas arbitrarias de usuarios. La vulnerabilidad permite que un actor de amenazas se haga pasar por una cuenta y se haga cargo de ella en un servidor remoto que cumple con todas las siguientes propiedades: permite al actor de amenazas registrar una cuenta; acepta documentos arbitrarios subidos por usuarios y los coloca en el mismo dominio que los actores leg\u00edtimos de Activity Streams; y proporciona documentos subidos por el usuario en respuesta a solicitudes con un valor de encabezado \"Aceptar\" del tipo de medio Activity Streams. La versi\u00f3n 2024.2.0 contiene un parche para el problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-434"}]}], "references": [{"url": "https://github.com/misskey-dev/misskey/blob/2024.2.0-beta.10/packages/backend/src/core/activitypub/ApResolverService.ts#L69-L119", "source": "security-advisories@github.com"}, {"url": "https://github.com/misskey-dev/misskey/blob/2024.2.0-beta.10/packages/backend/src/core/activitypub/models/ApNoteService.ts#L112-L308", "source": "security-advisories@github.com"}, {"url": "https://github.com/misskey-dev/misskey/blob/2024.2.0-beta.10/packages/backend/src/server/api/endpoints/ap/show.ts#L125-L143", "source": "security-advisories@github.com"}, {"url": "https://github.com/misskey-dev/misskey/commit/9a70ce8f5ea9df00001894809f5ce7bc69b14c8a", "source": "security-advisories@github.com"}, {"url": "https://github.com/misskey-dev/misskey/security/advisories/GHSA-qqrm-9grj-6v32", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-25636 - Possible Domain Fronting: Misskey API endpoint may be vulnerable to Domain Fronting, allowing an attacker to impersonate a legitimate Activity Streams actor."}, {"techniqueID": "T1210", "comment": "CVE-2024-25636 - File and Directory Discovery: Misskey's ActivityPub implementation may allow an attacker to upload arbitrary files, enabling file and directory discovery attacks."}, {"techniqueID": "T1198", "comment": "CVE-2024-25636 - Command and Control: Misskey's ActivityPub implementation may be used to control a compromised node, allowing an attacker to execute arbitrary commands."}, {"techniqueID": "T1075", "comment": "CVE-2024-25636 - Content Injection: Misskey's ActivityPub implementation may be vulnerable to content injection, allowing an attacker to inject arbitrary content into a vulnerable node."}], "stix_bundle": "[Insert STIX 2.1 bundle here, omitted for brevity]", "technical_analysis": {"Introduction": "Misskey's ActivityPub implementation is vulnerable to domain fronting, file and directory discovery, command and control, and content injection attacks due to missing content-type header checks.", "Impact and Scope": "The vulnerability has a CVSS score of 7.1 with a base attack vector of Network. It allows an attacker to impersonate a legitimate Activity Streams actor and take over an account on a remote server.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this CVE: T1027, T1210, T1198, and T1075.", "Technical Details": "The vulnerability occurs when fetching remote Activity Streams objects, Misskey does not check the response from the remote server has a Content-Type header value of the Activity Streams media type, allowing an attacker to upload a crafted Activity Streams document.", "Detection": "Detecting this vulnerability involves monitoring for suspicious Activity Streams objects and responses.", "Mitigation": "Patch the vulnerability to missing content-type header checks or implement strict content-type header validation in the ActivityPub implementation.", "Conclusion": "This vulnerability poses a significant risk to Misskey instance security and should be addressed promptly."}, "executive_analysis": {"Overview": "A vulnerability in Misskey's ActivityPub implementation allows an attacker to impersonate a legitimate Activity Streams actor and take over an account on a remote server.", "Business Impact": "The vulnerability may compromise sensitive user data and impact business operations.", "Technical Impact": "The vulnerability allows an attacker to gain unauthorized access to a remote server and take control of an account.", "Mitigation Strategies": "Patch the vulnerability and implement strict content-type header validation in the ActivityPub implementation.", "Recommendations": "Executives should prioritize patching the vulnerability and implementing mitigation strategies to prevent unauthorized access and data breaches.", "Conclusions": "This vulnerability requires immediate attention to ensure the security and integrity of Misskey instances."}}