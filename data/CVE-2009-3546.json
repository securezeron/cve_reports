{"id": "CVE-2009-3546", "sourceIdentifier": "secalert@redhat.com", "published": "2009-10-19T20:00:00.657", "lastModified": "2023-02-13T02:20:26.077", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The _gdGetColors function in gd_gd.c in PHP 5.2.11 and 5.3.x before 5.3.1, and the GD Graphics Library 2.x, does not properly verify a certain colorsTotal structure member, which might allow remote attackers to conduct buffer overflow or buffer over-read attacks via a crafted GD file, a different vulnerability than CVE-2009-3293. NOTE: some of these details are obtained from third party information."}, {"lang": "es", "value": "La funci\u00f3n _gdGetColors en el archivo gd_gd.c en PHP versi\u00f3n 5.2.11 y versiones 5.3.x anteriores a 5.3.1, y GD Graphics Library versiones 2.x, no comprueba apropiadamente un determinado miembro de la estructura colorTotal, lo que podr\u00eda permitir a los atacantes remotos conducir ataques de desbordamiento de b\u00fafer o de lectura excesiva de b\u00fafer por medio de un archivo GD especialmente dise\u00f1ado, una vulnerabilidad diferente de CVE-2009-3293. NOTA: algunos de estos datos fueron obtenidos de la informaci\u00f3n de terceros."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.3}, "baseSeverity": "HIGH", "exploitabilityScore": 8.6, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:libgd:gd_graphics_library:2.0.33:*:*:*:*:*:*:*", "matchCriteriaId": "83DED10C-5B2F-41A8-887F-E53C9498D620"}, {"vulnerable": true, "criteria": "cpe:2.3:a:libgd:gd_graphics_library:2.0.34:*:*:*:*:*:*:*", "matchCriteriaId": "B236A476-9FB9-46A0-859A-86B6B37F6960"}, {"vulnerable": true, "criteria": "cpe:2.3:a:libgd:gd_graphics_library:2.0.34:rc1:*:*:*:*:*:*", "matchCriteriaId": "B5C6F71F-A65F-4AEF-B846-BDBF8C1965A3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:libgd:gd_graphics_library:2.0.34:rc2:*:*:*:*:*:*", "matchCriteriaId": "FB25E18F-7078-458C-B517-D7DCC942BF80"}, {"vulnerable": true, "criteria": "cpe:2.3:a:libgd:gd_graphics_library:2.0.35:*:*:*:*:*:*:*", "matchCriteriaId": "7D7EEB86-6942-4A27-9C6A-9CEA73192E6A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:libgd:gd_graphics_library:2.0.35:rc1:*:*:*:*:*:*", "matchCriteriaId": "B928D03E-BABF-4FFB-B068-63A763301D31"}, {"vulnerable": true, "criteria": "cpe:2.3:a:libgd:gd_graphics_library:2.0.35:rc2:*:*:*:*:*:*", "matchCriteriaId": "345F2194-D009-45A8-8606-F2DAEC328A3A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:libgd:gd_graphics_library:2.0.35:rc3:*:*:*:*:*:*", "matchCriteriaId": "FFB324F6-6271-412C-90D3-B91489200C8D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:libgd:gd_graphics_library:2.0.35:rc4:*:*:*:*:*:*", "matchCriteriaId": "0AC18015-92F0-458A-B27D-BA96645A0FB5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:libgd:gd_graphics_library:2.0.35:rc5:*:*:*:*:*:*", "matchCriteriaId": "EBE1488F-E22A-460E-B7AF-F9EBB56B188D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:libgd:gd_graphics_library:2.0.36:rc1:*:*:*:*:*:*", "matchCriteriaId": "84E950C3-0FA9-4AA2-9FC2-81F30398073A"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.2.11:*:*:*:*:*:*:*", "matchCriteriaId": "2CDFB7E9-8510-430F-BFBC-FD811D60DC78"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.3.0:*:*:*:*:*:*:*", "matchCriteriaId": "9EF4B938-BB14-4C06-BEE9-10CA755C5DEF"}]}]}], "references": [{"url": "http://marc.info/?l=oss-security&m=125562113503923&w=2", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/37069", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/37080", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/38055", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://svn.php.net/viewvc?view=revision&revision=289557", "source": "secalert@redhat.com"}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2009:285", "source": "secalert@redhat.com"}, {"url": "http://www.openwall.com/lists/oss-security/2009/11/20/5", "source": "secalert@redhat.com"}, {"url": "http://www.redhat.com/support/errata/RHSA-2010-0003.html", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/bid/36712", "source": "secalert@redhat.com"}, {"url": "http://www.vupen.com/english/advisories/2009/2929", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2009/2930", "source": "secalert@redhat.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A11199", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "TA0002", "comment": " CVE-2009-3546 - This vulnerability allows an attacker to conduct buffer overflow or buffer over-read attacks via a crafted GD file. This is relevant to organizations that use PHP 5.2.11 or 5.3.x before 5.3.1 and the GD Graphics Library 2.x. To defend against this attack, it is recommended to update to the latest version or apply patch."}, {"techniqueID": "TA0005", "comment": " CVE-2009-3546 - This vulnerability allows an attacker to conduct buffer overflow or buffer over-read attacks via a crafted GD file. This is relevant to organizations that use PHP 5.2.11 or 5.3.x before 5.3.1 and the GD Graphics Library 2.x. To defend against this attack, it is recommended to update to the latest version or apply patch."}], "stix_bundle": [{"id": "bundle-1", "type": "bundle", "spec_version": "2.1", "stix_objects": [{"id": "obj-1", "type": "vulnerability", "description": {"value": "The _gdGetColors function in gd_gd.c in PHP 5.2.11 and 5.3.x before 5.3.1, and the GD Graphics Library 2.x, does not properly verify a certain colorsTotal structure member, which might allow remote attackers to conduct buffer overflow or buffer over-read attacks via a crafted GD file"}, "vulnerability": {"cvss_v2": {"score": 9.3, "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C"}}, "references": [{"url": "http://marc.info/?l=oss-security&m=125562113503923&w=2", "source": "secalert@redhat.com"}]}, {"id": "obj-2", "type": "indicator", "description": {"value": "A crafted GD file that can be used to exploit the vulnerability"}, "indicator": {"pattern": "A crafted GD file", "type": "pattern", "is_optionally_unique": false}}, {"id": "obj-3", "type": "course_of_action", "description": {"value": "Apply patch or update to the latest version"}, "course_of_action": {"mitigates": ["obj-1"], "techniques": ["TA0002"]}}]}], "technical_analysis": {"Introduction": "The _gdGetColors function in gd_gd.c in PHP 5.2.11 and 5.3.x before 5.3.1, and the GD Graphics Library 2.x, does not properly verify a certain colorsTotal structure member, which might allow remote attackers to conduct buffer overflow or buffer over-read attacks via a crafted GD file.", "Impact and Scope": "The impact of this vulnerability is a remote attacker can conduct buffer overflow or buffer over-read attacks via a crafted GD file. The vulnerable software versions are PHP 5.2.11 and 5.3.x before 5.3.1, and the GD Graphics Library 2.x.", "Related MITRE ATT&CK Techniques": "TA0002 and TA0005", "Technical Details": "The _gdGetColors function in gd_gd.c does not properly verify a certain colorsTotal structure member, which might allow remote attackers to conduct buffer overflow or buffer over-read attacks via a crafted GD file.", "Detection": "Detection methods include identifying traffic that matches the pattern of a crafted GD file and detecting signs of buffer overflow or buffer over-read attacks.", "Mitigation": "Mitigation strategies include applying patch or updating to the latest version.", "Conclusion": "In conclusion, the _gdGetColors function in gd_gd.c in PHP 5.2.11 and 5.3.x before 5.3.1, and the GD Graphics Library 2.x, is vulnerable to buffer overflow or buffer over-read attacks via a crafted GD file. It is recommended to apply patch or update to the latest version to mitigate this vulnerability."}, "executive_analysis": {"Overview": "A buffer overflow or buffer over-read vulnerability was discovered in the _gdGetColors function in gd_gd.c in PHP 5.2.11 and 5.3.x before 5.3.1, and the GD Graphics Library 2.x.", "Business Impact": "The impact of this vulnerability is that an attacker can conduct buffer overflow or buffer over-read attacks via a crafted GD file, potentially leading to unauthorized access to sensitive data.", "Technical Impact": "The technical impact of this vulnerability is that an attacker can conduct buffer overflow or buffer over-read attacks via a crafted GD file, potentially leading to unauthorized access to sensitive data.", "Mitigation Strategies": "Apply patch or update to the latest version.", "Recommendations": "It is recommended that organizations that use PHP 5.2.11 or 5.3.x before 5.3.1 and the GD Graphics Library 2.x update to the latest version or apply patch.", "Conclusions": "In conclusion, the _gdGetColors function in gd_gd.c in PHP 5.2.11 and 5.3.x before 5.3.1, and the GD Graphics Library 2.x, is vulnerable to buffer overflow or buffer over-read attacks via a crafted GD file. It is recommended to apply patch or update to the latest version to mitigate this vulnerability."}}