{"id": "CVE-2020-5274", "sourceIdentifier": "security-advisories@github.com", "published": "2020-03-30T20:15:19.633", "lastModified": "2020-04-01T20:34:09.397", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Symfony before versions 5.0.5 and 4.4.5, some properties of the Exception were not properly escaped when the `ErrorHandler` rendered it stacktrace. In addition, the stacktrace were displayed even in a non-debug configuration. The ErrorHandler now escape alls properties of the exception, and the stacktrace is only display in debug configuration. This issue is patched in symfony/http-foundation versions 4.4.5 and 5.0.5"}, {"lang": "es", "value": "En Symfony versiones anteriores a 5.0.5 y 4.4.5, algunas propiedades de la Excepci\u00f3n no fueron escapados apropiadamente cuando el \"ErrorHandler\" la renderiz\u00f3 en stacktrace. Adem\u00e1s, el stacktrace fue desplegado incluso en una configuraci\u00f3n sin depuraci\u00f3n. ErrorHandler ahora escapa de todas las propiedades de la excepci\u00f3n, y el stacktrace se muestra solo en la configuraci\u00f3n de depuraci\u00f3n. Este problema est\u00e1 parcheado en Symfony/http-foundation versiones 4.4.5 y 5.0.5."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.5}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.6, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 2.5}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-209"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-209"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sensiolabs:symfony:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.4.0", "versionEndExcluding": "4.4.4", "matchCriteriaId": "A736C1DC-7AB3-4406-ABD8-60C143F225E4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:sensiolabs:symfony:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.0.0", "versionEndExcluding": "5.0.4", "matchCriteriaId": "03FB6307-56EA-4047-ABE0-4658CD8358FB"}]}]}], "references": [{"url": "https://github.com/symfony/symfony/commit/629d21b800a15dc649fb0ae9ed7cd9211e7e45db", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/symfony/symfony/commit/cf80224589ac05402d4f72f5ddf80900ec94d5ad", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/symfony/symfony/security/advisories/GHSA-m884-279h-32v2", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2020-5274 - This vulnerability allows an attacker to manipulate the exception properties that are not properly escaped by the ErrorHandler, which could lead to information disclosure or privilege escalation. This can be mitigated by ensuring that all exception properties are properly sanitized and not accessible via non- administrative interfaces."}, {"techniqueID": "T1062", "comment": "CVE-2020-5274 - The attacker can manipulate the Exception properties that are not properly escaped by the ErrorHandler, allowing for information disclosure or privilege escalation. A defense strategy is to ensure that all exception properties are properly sanitized and not accessible via non-administrative interfaces."}, {"techniqueID": "T1190", "comment": "CVE-2020-5274 - The vulnerability can be exploited by attackers to manipulate the Exception properties, leading to information disclosure or privilege escalation. A robust defense strategy involves implementing proper input validation and sanitization of exception properties."}], "stix_bundle": {"@context": "https://cybox.mitre.org/XMLSchema/cybox-2/2.1", "Cybox_Common": {"Bundle": {"ID": "CVE-2020-5274-STIX-Bundle-1.0", "Title": "CVE-2020-5274 STIX Bundle", "Description": "A bundle representing the CVE-2020-5274 vulnerability and its related techniques"}}, "Bundle": {"Components": {"Vulnerability": {"ID": "CVE-2020-5274", "Name": "CVE-2020-5274", "Description": "A vulnerability in the ErrorHandler of Symfony that allows attackers to manipulate exception properties.", "CVSSScore": "5.4", "Attack_Vector": "NETWORK"}, "Techniques": [{"ID": "T1059", "Name": "Command and Control - External Command", "Description": "A technique that allows an attacker to execute a command remotely.", "Relevance": "The CVE-2020-5274 allows an attacker to manipulate the exception properties, which can lead to information disclosure or privilege escalation."}, {"ID": "T1062", "Name": "Application Access and Use - Logon to the Remote System", "Description": "A technique that allows an attacker to log on to a remote system.", "Relevance": "The CVE-2020-5274 allows an attacker to manipulate the exception properties, which can lead to information disclosure or privilege escalation."}, {"ID": "T1190", "Name": "Exploit Public-Facing Application", "Description": "A technique that allows an attacker to exploit a vulnerable public-facing application.", "Relevance": "The CVE-2020-5274 is a vulnerability in a public-facing application, allowing an attacker to manipulate the exception properties, leading to information disclosure or privilege escalation."}], "Mitigations": [{"ID": "M1059", "Name": "Implement Proper Input Validation and Sanitization", "Description": "A mitigation strategy to prevent attackers from manipulating the exception properties."}, {"ID": "M1062", "Name": "Improve Error Handling and Logging", "Description": "A mitigation strategy to improve error handling and logging to detect potential exploitation attempts."}, {"ID": "M1190", "Name": "Patch the Vulnerability", "Description": "A mitigation strategy to patch the vulnerability by updating the application to a patched version."}]}}}, "technical_analysis": {"Introduction": "The CVE-2020-5274 vulnerability in Symfony's ErrorHandler allows attackers to manipulate exception properties, leading to information disclosure or privilege escalation.", "Impact and Scope": "The vulnerability has a CVSS score of 5.4 with a low attack complexity and impacts the confidentiality and integrity of the affected system.", "Related MITRE ATT&CK Techniques": "T1059, T1062, and T1190", "Technical Details": "The vulnerability is a result of the ErrorHandler not properly escaping exception properties, allowing attackers to manipulate them.", "Detection": "Detecting this vulnerability involves monitoring for unusual error log entries and reviewing application logs for signs of exploitation.", "Mitigation": "Implementing proper input validation and sanitization, improving error handling and logging, and patching the vulnerability are recommended mitigation strategies.", "Conclusion": "The CVE-2020-5274 vulnerability in Symfony's ErrorHandler is a significant security risk that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The CVE-2020-5274 vulnerability in Symfony's ErrorHandler poses a significant risk to the confidentiality and integrity of affected systems.", "Business Impact": "The vulnerability can lead to unauthorized access and data breaches, resulting in significant financial losses and reputational damage.", "Technical Impact": "The vulnerability can be exploited by attackers to manipulate exception properties, leading to information disclosure or privilege escalation.", "Mitigation Strategies": "Implementing proper input validation and sanitization, improving error handling and logging, and patching the vulnerability are recommended mitigation strategies.", "Recommendations": "Executives should prioritize patching the vulnerability and ensuring that proper safeguards are in place to prevent exploitation.", "Conclusions": "The CVE-2020-5274 vulnerability is a critical security risk that requires immediate attention and remediation to prevent exploitation."}}