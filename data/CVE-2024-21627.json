{"id": "CVE-2024-21627", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-02T21:15:10.467", "lastModified": "2024-01-08T19:23:49.707", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "PrestaShop is an open-source e-commerce platform. Prior to versions 8.1.3 and 1.7.8.11, some event attributes are not detected by the `isCleanHTML` method. Some modules using the `isCleanHTML` method could be vulnerable to cross-site scripting. Versions 8.1.3 and 1.7.8.11 contain a patch for this issue. The best workaround is to use the `HTMLPurifier` library to sanitize html input coming from users. The library is already available as a dependency in the PrestaShop project. Beware though that in legacy object models, fields of `HTML` type will call `isCleanHTML`."}, {"lang": "es", "value": "PrestaShop es una plataforma de comercio electr\u00f3nico de c\u00f3digo abierto. Antes de las versiones 8.1.3 y 1.7.8.11, el m\u00e9todo `isCleanHTML` no detecta algunos atributos de eventos. Algunos m\u00f3dulos que utilizan el m\u00e9todo `isCleanHTML` podr\u00edan ser vulnerables a cross site scripting. Las versiones 8.1.3 y 1.7.8.11 contienen un parche para este problema. La mejor soluci\u00f3n es utilizar la librer\u00eda `HTMLPurifier` para sanitizar la entrada HTML proveniente de los usuarios. La librer\u00eda ya est\u00e1 disponible como dependencia en el proyecto PrestaShop. Sin embargo, tenga en cuenta que en los modelos de objetos heredados, los campos de tipo `HTML` llamar\u00e1n `isCleanHTML`."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.7, "impactScore": 5.8}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:prestashop:prestashop:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.7.8.11", "matchCriteriaId": "A2437874-DFE9-40D7-830C-727A225366DD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:prestashop:prestashop:*:*:*:*:*:*:*:*", "versionStartIncluding": "8.0.0", "versionEndExcluding": "8.1.3", "matchCriteriaId": "6D8ED724-5385-47E2-8BE2-C2588964AADA"}]}]}], "references": [{"url": "https://github.com/PrestaShop/PrestaShop/commit/73cfb44666818eefd501b526a894fe884dd12129", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/PrestaShop/PrestaShop/commit/ba06d18466df5b92cb841d504cc7210121104883", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/PrestaShop/PrestaShop/security/advisories/GHSA-xgpm-q3mq-46rq", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-21627 - Cross-site scripting vulnerability is a possibility when using the `isCleanHTML` method, which can allow an attacker to inject malicious code. This technique can be used to gain unauthorized access to user data."}, {"techniqueID": "T1506", "comment": "CVE-2024-21627 - The use of an untrusted user input in the `isCleanHTML` method can lead to cross-site scripting attacks. This technique can be used to inject malicious code into a web page."}, {"techniqueID": "T1568", "comment": "CVE-2024-21627 - The `HTMLPurifier` library can be used to sanitize user input and prevent cross-site scripting attacks. This technique can be used to harden an application against common web vulnerabilities."}], "stix_bundle": {"objects": {"vulnerability": {"id": "CVE-2024-21627", "name": "PrestaShop Cross-Site Scripting Vulnerability", "description": "The PrestaShop is an open-source e-commerce platform. Prior to versions 8.1.3 and 1.7.8.11, some event attributes are not detected by the `isCleanHTML` method. Some modules using the `isCleanHTML` method could be vulnerable to cross-site scripting.", "threatelligence": {"score": 8.1, "confidence": 0.8}, "relationships": [{"type": "related_to", "id": "T1190", "target_id": "T1190", "label": "Uses"}, {"type": "related_to", "id": "T1506", "target_id": "T1506", "label": "Exploits"}, {"type": "related_to", "id": "T1568", "target_id": "T1568", "label": "Mitigates"}]}, "mitigation": {"id": " Mitigation-T1190", "name": " Harden Web Application Against Cross-Site Scripting", "description": "Use the `HTMLPurifier` library to sanitize user input and prevent cross-site scripting attacks."}, "detection": {"id": "Detection-T1506", "name": "Detect Cross-Site Scripting Attacks", "description": "Use a web application firewall to detect and block cross-site scripting attacks."}, "course_of_action": {"id": "CoA-T1568", "name": "Apply Patch and Use Sanitization Library", "description": "Apply the patch and use the `HTMLPurifier` library to sanitize user input."}}}, "technical_analysis": {"Introduction": "The PrestaShop cross-site scripting vulnerability allows attackers to inject malicious code into a web page.", "Impact and Scope": "The vulnerability affects versions prior to 8.1.3 and 1.7.8.11, with a CVSS score of 6.1.", "Related MITRE ATT&CK Techniques": "T1190, T1506, and T1568 are related to the vulnerability.", "Technical Details": "The vulnerability occurs when an untrusted user input is used in the `isCleanHTML` method.", "Detection": "Methods for detecting the vulnerability include web application firewalls and manual code reviews.", "Mitigation": "Mitigation strategies include applying patches, using sanitization libraries, and implementing web application firewalls.", "Conclusion": "The PrestaShop cross-site scripting vulnerability is a significant risk and requires immediate attention."}, "executive_analysis": {"Overview": "The PrestaShop cross-site scripting vulnerability allows attackers to inject malicious code into a web page, which can compromise user data and system security.", "Business Impact": "The vulnerability can lead to significant business losses and reputational damage.", "Technical Impact": "The vulnerability allows attackers to gain unauthorized access to user data and system resources.", "Mitigation Strategies": "Applying patches, using sanitization libraries, and implementing web application firewalls are recommended mitigation strategies.", "Recommendations": "Executives should prioritize patching and implementing mitigation strategies to prevent future attacks.", "Conclusions": "The PrestaShop cross-site scripting vulnerability is a significant risk and requires immediate attention from executives and IT teams."}}