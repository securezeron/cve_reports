{"id": "CVE-2020-14350", "sourceIdentifier": "secalert@redhat.com", "published": "2020-08-24T13:15:10.967", "lastModified": "2023-01-24T02:38:40.410", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "It was found that some PostgreSQL extensions did not use search_path safely in their installation script. An attacker with sufficient privileges could use this flaw to trick an administrator into executing a specially crafted script, during the installation or update of such extension. This affects PostgreSQL versions before 12.4, before 11.9, before 10.14, before 9.6.19, and before 9.5.23."}, {"lang": "es", "value": "Se detect\u00f3 que algunas extensiones de PostgreSQL no usaban la funci\u00f3n search_path de forma segura en su script de instalaci\u00f3n. Un atacante con suficientes privilegios podr\u00eda usar este fallo para enga\u00f1ar a un administrador para ejecutar un script especialmente dise\u00f1ado durante la instalaci\u00f3n o actualizaci\u00f3n de dicha extensi\u00f3n. Esto afecta a PostgreSQL versiones anteriores a 12.4, anteriores a 11.9, anteriores a 10.14, anteriores a 9.6.19 y anteriores a 9.5.23."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.3, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.4}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-426"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.5", "versionEndExcluding": "9.5.23", "matchCriteriaId": "11AA6065-FAE8-4A2E-8B5B-91EA30B13B9A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.6", "versionEndExcluding": "9.6.19", "matchCriteriaId": "A69144A7-9884-402C-8E7B-BBA833E4BC5C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "10.0", "versionEndExcluding": "10.14", "matchCriteriaId": "66E3FC4A-00FF-4006-A9E6-7B9ED8EB3F2E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "11.0", "versionEndExcluding": "11.9", "matchCriteriaId": "B74FDCC8-2D95-45FB-B8DE-2C1AAA71D446"}, {"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "12.0", "versionEndExcluding": "12.4", "matchCriteriaId": "5300CA7F-5BB7-40BA-9237-C4865C1373CF"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*", "matchCriteriaId": "B620311B-34A3-48A6-82DF-6F078D7A4493"}, {"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:15.2:*:*:*:*:*:*:*", "matchCriteriaId": "B009C22E-30A4-4288-BCF6-C3E81DEAF45A"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:esm:*:*:*", "matchCriteriaId": "7A5301BF-1402-4BE0-A0F8-69FBE79BC6D6"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*", "matchCriteriaId": "23A7C53F-B80F-4E6A-AFA9-58EEA84BE11D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:20.04:*:*:*:lts:*:*:*", "matchCriteriaId": "902B8056-9E37-443B-8905-8AA93E2447FB"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-08/msg00043.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2020-08/msg00044.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2020-08/msg00049.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2020-08/msg00050.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2020-09/msg00003.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2020-09/msg00008.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1865746", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2020/08/msg00028.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://security.gentoo.org/glsa/202008-13", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20200918-0002/", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/4472-1/", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "This technique enables privilege escalation, which is relevant to CVE-2020-14350, as an attacker may use it to gain elevated access to a system to exploit this vulnerability."}, {"techniqueID": "T1190", "comment": "This technique involves post-exploitation activities, which is relevant to CVE-2020-14350, as an attacker may use it to maintain a presence on a system after exploiting this vulnerability."}, {"techniqueID": "T1087", "comment": "This technique involves account persistence, which is relevant to CVE-2020-14350, as an attacker may use it to maintain access to a system after exploiting this vulnerability."}, {"techniqueID": "T1555", "comment": "This technique involves command and control, which is relevant to CVE-2020-14350, as an attacker may use it to communicate with a command and control server for further actions after exploiting this vulnerability."}], "stix_bundle": {"label": "CVE-2020-14350", "description": "PostgreSQL extension installation script execution", "object_marking_refs": [{"idref": "marking-definition--xid--1"}], "observed_data_refs": [{"idref": "observed-data--xid--1"}], "recommended_actions": [{"idref": "course-of-action--xid--1"}]}, "technical_analysis": {"Introduction": "CVE-2020-14350 is a vulnerability in PostgreSQL extension installation scripts that allows an attacker to trick an administrator into executing a malicious script. This vulnerability affects multiple versions of PostgreSQL, including 9.5, 9.6, 10, 11, and 12.", "Impact and Scope": "The vulnerability has a CVSS score of 7.3 (High) with an attack vector of local and attack complexity of low. It allows an attacker to execute a malicious script during the installation or update of a PostgreSQL extension, which could lead to a range of impacts including data exfiltration, account takeover, and system compromise.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are relevant to this vulnerability: T1210, T1190, T1087, and T1555.", "Technical Details": "The vulnerability is caused by the failure of some PostgreSQL extensions to properly sanitize user input in their installation scripts. This allows an attacker to manipulate the script and execute malicious code. The affected versions of PostgreSQL are 9.5, 9.6, 10, 11, and 12.", "Detection": "Detection of this vulnerability may involve monitoring for suspicious installation or update activity in PostgreSQL and analyzing logs for signs of malicious scripting.", "Mitigation": "Mitigation strategies include applying patches to affected versions of PostgreSQL, disabling the installation of unknown extensions, and implementing strict access controls for the `psql` command.", "Conclusion": "In conclusion, CVE-2020-14350 is a serious vulnerability that allows an attacker to execute malicious code during the installation or update of a PostgreSQL extension. It is essential to apply patches and implement mitigation strategies to prevent exploitation of this vulnerability."}, "executive_analysis": {"Overview": "CVE-2020-14350 is a critical vulnerability in PostgreSQL that allows an attacker to execute malicious code during the installation or update of an extension.", "Business Impact": "The impact of this vulnerability could be significant, including data exfiltration, account takeover, and system compromise. It is essential to take prompt action to mitigate this vulnerability.", "Technical Impact": "The vulnerability allows an attacker to execute malicious code during the installation or update of a PostgreSQL extension, which could lead to a range of technical impacts including data exfiltration, account takeover, and system compromise.", "Mitigation Strategies": "To mitigate this vulnerability, apply patches to affected versions of PostgreSQL, disable the installation of unknown extensions, and implement strict access controls for the `psql` command.", "Recommendations": "Recommendations for executives include prioritizing the patching of affected systems, monitoring for signs of exploitation, and implementing strict access controls for the `psql` command.", "Conclusions": "In conclusion, CVE-2020-14350 is a critical vulnerability that requires immediate attention. It is essential to apply patches, disable unknown extensions, and implement strict access controls to prevent exploitation of this vulnerability."}}