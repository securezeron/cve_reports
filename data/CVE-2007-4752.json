{"id": "CVE-2007-4752", "sourceIdentifier": "cve@mitre.org", "published": "2007-09-12T01:17:00.000", "lastModified": "2018-10-15T21:37:09.420", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "ssh in OpenSSH before 4.7 does not properly handle when an untrusted cookie cannot be created and uses a trusted X11 cookie instead, which allows attackers to violate intended policy and gain privileges by causing an X client to be treated as trusted."}, {"lang": "es", "value": "ssh en OpenSSH anterior a 4.7 no maneja adecuadamente cuando una cookie no confiable no puede ser creada y utiliza una cookie X11 confiable en su lugar, lo cual permite a los atacantes violar pol\u00edticas establecidas y obtener privilegios provocando que un cliente X sea tratado como confiable."}], "vendorComments": [{"organization": "Red Hat", "comment": "This issue did not affect the OpenSSH packages as distributed with Red Hat Enterprise Linux 2.1 or 3, as they do not support Trusted X11 forwarding.\n\nFor Red Hat Enterprise Linux 4 and 5, this issue was addressed via: https://rhn.redhat.com/errata/RHSA-2008-0855.html\n", "lastModified": "2008-08-28T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": true, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:*:*:*:*:*:*:*:*", "versionEndIncluding": "4.6", "matchCriteriaId": "A410C8F9-717C-4657-91DD-BAEAB53ECC16"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.0:*:*:*:*:*:*:*", "matchCriteriaId": "E003AB3C-8DF3-4AE8-82A3-984F30E5599B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.0p1:*:*:*:*:*:*:*", "matchCriteriaId": "5EBE75FE-DDE2-43BA-80EF-15A6698EABC9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.1:*:*:*:*:*:*:*", "matchCriteriaId": "1FF67D77-02AC-4807-984D-C5AE9799F051"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.1p1:*:*:*:*:*:*:*", "matchCriteriaId": "683B26F0-5EA2-455A-8948-27C100BBA3AC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.2:*:*:*:*:*:*:*", "matchCriteriaId": "E5A75B23-2DD7-4EB2-BEAA-049FF4E51A14"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.2p1:*:*:*:*:*:*:*", "matchCriteriaId": "7279E1EC-DEBC-4ACC-925D-06A7697C162F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.3:*:*:*:*:*:*:*", "matchCriteriaId": "7910598E-BEC1-4644-9DE4-D8BE505A4F9E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.3p1:*:*:*:*:*:*:*", "matchCriteriaId": "FB416D0C-6C86-450F-8917-D4B1BD82AB1E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.3p2:*:*:*:*:*:*:*", "matchCriteriaId": "3640CCC9-EC4A-44A4-B747-7BAAAD3460C7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.4:*:*:*:*:*:*:*", "matchCriteriaId": "B2DD362E-9EA9-4E88-9A94-D7B471EB1FD4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.4p1:*:*:*:*:*:*:*", "matchCriteriaId": "E3094069-AC2E-43BD-8094-D48E2526DECC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.5:*:*:*:*:*:*:*", "matchCriteriaId": "9B72CFB3-39C7-469C-AA59-69F5B8993BF7"}]}]}], "references": [{"url": "http://bugs.gentoo.org/show_bug.cgi?id=191321", "source": "cve@mitre.org"}, {"url": "http://docs.info.apple.com/article.html?artnum=307562", "source": "cve@mitre.org"}, {"url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c01271085", "source": "cve@mitre.org"}, {"url": "http://lists.apple.com/archives/security-announce/2008/Mar/msg00001.html", "source": "cve@mitre.org"}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2007-10/msg00008.html", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27399", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/29420", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/30249", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/31575", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/32241", "source": "cve@mitre.org"}, {"url": "http://security.gentoo.org/glsa/glsa-200711-02.xml", "source": "cve@mitre.org"}, {"url": "http://securityreason.com/securityalert/3126", "source": "cve@mitre.org"}, {"url": "http://support.avaya.com/elmodocs2/security/ASA-2008-399.htm", "source": "cve@mitre.org"}, {"url": "http://www.debian.org/security/2008/dsa-1576", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDKSA-2007:236", "source": "cve@mitre.org"}, {"url": "http://www.openssh.com/txt/release-4.7", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2008-0855.html", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/479760/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/483748/100/200/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/25628", "source": "cve@mitre.org"}, {"url": "http://www.ubuntu.com/usn/usn-566-1", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/3156", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2008/0924/references", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2008/2821", "source": "cve@mitre.org"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=280471", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/36637", "source": "cve@mitre.org"}, {"url": "https://issues.rpath.com/browse/RPL-1706", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A10809", "source": "cve@mitre.org"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A5599", "source": "cve@mitre.org"}, {"url": "https://www.redhat.com/archives/fedora-package-announce/2007-October/msg00214.html", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1078", "comment": "CVE-2007-4752 - Untrusted cookies in OpenSSH could allow an attacker to gain privileges, this is a classic example of a trust relationship attack. To defend against this, make sure to properly configure X11 cookies and ensure that only trusted clients are allowed to connect."}], "stix_bundle": {"bmf:Bundle": {"id": "bundle-1", "created_by_ref": "user-1", "created": "2023-02-20T10:30:00.000Z", "modified": "2023-02-20T10:30:00.000Z", "objects": [{"bmf:Vulnerability": {"id": "vuln-1", "name": "OpenSSH cookie vulnerability", "description": "Untrusted cookies in OpenSSH could allow an attacker to gain privileges", "severity": "HIGH"}}, {"bmf:Course_of_Action": {"id": "coa-1", "name": "Configure X11 cookies", "description": "Configure X11 cookies to only allow trusted clients to connect", "mitigated_vulnerability_refs": ["vuln-1"], "tactic_refs": ["T1078"]}}], "relationships": [{"id": "1", "type": "relates_to", "source_ref": "vuln-1", "target_ref": "coa-1"}]}}, "technical_analysis": {"Introduction": "The OpenSSH cookie vulnerability (CVE-2007-4752) is a classic example of a trust relationship attack, where an attacker can gain privileges by exploiting untrusted cookies in OpenSSH.", "Impact and Scope": "This vulnerability has a CVSS score of 7.5, with a CVSS vector string of AV:N/AC:L/Au:N/C:P/I:P/A:P. It allows an attacker to gain privileges, which can lead to a complete compromise of the system.", "Related MITRE ATT&CK Techniques": "The main MITRE ATT&CK technique related to this vulnerability is T1078, which is 'Valid Accounts'.", "Technical Details": "The vulnerability is in the way OpenSSH handles Trusted X11 forwarding, which allows an attacker to bypass the authentication process and gain access to the system.", "Detection": "Detection of this vulnerability can be done by monitoring for unauthorized access to the system and detecting suspicious login attempts.", "Mitigation": "Mitigation of this vulnerability can be done by configuring X11 cookies to only allow trusted clients to connect and ensuring that all access is properly authenticated.", "Conclusion": "In conclusion, the OpenSSH cookie vulnerability is a significant threat that can lead to a complete compromise of the system. It is essential to properly configure X11 cookies and ensure that all access is properly authenticated to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The OpenSSH cookie vulnerability is a high-severity vulnerability that can allow an attacker to gain privileges and compromise the system.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to a complete compromise of the system and potentially result in data breaches or unauthorized access.", "Technical Impact": "The technical impact of this vulnerability is also significant, as it can allow an attacker to bypass the authentication process and gain access to the system.", "Mitigation Strategies": "The recommended mitigation strategy is to configure X11 cookies to only allow trusted clients to connect and ensure that all access is properly authenticated.", "Recommendations": "We recommend that all organizations affected by this vulnerability take immediate action to mitigate it.", "Conclusions": "In conclusion, the OpenSSH cookie vulnerability is a significant threat that requires immediate attention and action."}}