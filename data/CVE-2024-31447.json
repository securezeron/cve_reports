{"id": "CVE-2024-31447", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-08T16:15:08.190", "lastModified": "2024-04-08T18:48:40.217", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Shopware 6 is an open commerce platform based on Symfony Framework and Vue. Starting in version 6.3.5.0 and prior to versions 6.6.1.0 and 6.5.8.8, when a authenticated request is made to `POST /store-api/account/logout`, the cart will be cleared, but the User won't be logged out. This affects only the direct store-api usage, as the PHP Storefront listens additionally on `CustomerLogoutEvent` and invalidates the session additionally. The problem has been fixed in Shopware 6.6.1.0 and 6.5.8.8. Those who are unable to update can install the latest version of the Shopware Security Plugin as a workaround.\n"}, {"lang": "es", "value": "Shopware 6 es una plataforma de comercio abierta basada en Symfony Framework y Vue. A partir de la versi\u00f3n 6.3.5.0 y anteriores a las versiones 6.6.1.0 y 6.5.8.8, cuando se realiza una solicitud autenticada a `POST /store-api/account/logout`, el carrito se borrar\u00e1, pero el Usuario no se va a desconectar. Esto afecta solo al uso directo de la API de la tienda, ya que PHP Storefront escucha adicionalmente en `CustomerLogoutEvent` e invalida la sesi\u00f3n adicionalmente. El problema se solucion\u00f3 en Shopware 6.6.1.0 y 6.5.8.8. Aquellos que no puedan actualizar pueden instalar la \u00faltima versi\u00f3n del complemento de seguridad de Shopware como workaround."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-613"}]}], "references": [{"url": "https://github.com/shopware/shopware/commit/5cc84ddd817ad0c1d07f9b3c79ab346d50514a77", "source": "security-advisories@github.com"}, {"url": "https://github.com/shopware/shopware/commit/d29775aa758f70d08e0c5999795c7c26d230e7d3", "source": "security-advisories@github.com"}, {"url": "https://github.com/shopware/shopware/security/advisories/GHSA-5297-wrrp-rcj7", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2024-31447 - This technique is relevant as it talks about Authentication Bypass via an alternate channel. To defend against this, implement proper authentication mechanisms and validate user input."}, {"techniqueID": "TA0040", "comment": "CVE-2024-31447 - This technique is relevant as it talks about Session Management. To defend against this, ensure proper session management and invalidate sessions after a user logs out."}, {"techniqueID": "TA0026", "comment": "CVE-2024-31447 - This technique is relevant as it talks about Web Shellcode. To defend against this, implement WAFs and validate user input."}], "stix_bundle": {"type": "bundle", "id": "bundle-1", "created_by_ref": "organization-1", "created": "2024-04-08T16:15:08.190", "modified": "2024-04-08T18:48:40.217", "title": "Shopware 6 Session Management Vulnerability", "description": "Bundle containing information related to the Shopware 6 session management vulnerability.", "objects": [{"type": "vulnerability", "id": "vulnerability-1", "created_by_ref": "organization-1", "created": "2024-04-08T16:15:08.190", "modified": "2024-04-08T18:48:40.217", "title": "Shopware 6 Session Management Vulnerability", "description": "Description of the Shopware 6 session management vulnerability.", "references": [{"type": "external_reference", "id": "external-reference-1", "url": "https://github.com/shopware/shopware/commit/5cc84ddd817ad0c1d07f9b3c79ab346d50514a77"}, {"type": "external_reference", "id": "external-reference-2", "url": "https://github.com/shopware/shopware/commit/d29775aa758f70d08e0c5999795c7c26d230e7d3"}, {"type": "external_reference", "id": "external-reference-3", "url": "https://github.com/shopware/shopware/security/advisories/GHSA-5297-wrrp-rcj7"}], "related_objects": [{"type": "technique", "id": "technique-1", "title": "Authentication Bypass via an Alternate Channel"}, {"type": "technique", "id": "technique-2", "title": "Session Management"}, {"type": "course_of_action", "id": "course-of-action-1", "title": "Implement Proper Authentication Mechanisms"}]}], "relationship": {"attack_pattern": {"type": "attack-pattern", "id": "attack-pattern-1", "title": "Shopware 6 Session Management Vulnerability"}, "course_of_action": {"type": "course-of-action", "id": "course-of-action-1", "title": "Implement Proper Authentication Mechanisms"}}}, "technical_analysis": {"Introduction": "The Shopware 6 session management vulnerability affects the Shopware 6 platform, which is an open commerce platform based on Symfony Framework and Vue.", "Impact and Scope": "The vulnerability has a CVSS 3.1 score of 5.3, with a high attack complexity and a medium severity.", "Related MITRE ATT&CK Techniques": "The techniques related to this vulnerability are T1190, T1191, and T1192.", "Technical Details": "The vulnerability occurs when a authenticated request is made to `POST /store-api/account/logout`, the cart will be cleared, but the User won't be logged out.", "Detection": "Detection methods include identifying requests to `POST /store-api/account/logout` and verifying user authentication.", "Mitigation": "Mitigation strategies include implementing proper authentication mechanisms, validating user input, and invalidating sessions after a user logs out.", "Conclusion": "The Shopware 6 session management vulnerability poses a significant risk to users of the platform, and it is essential to implement proper security measures to mitigate this risk."}, "executive_analysis": {"Overview": "The Shopware 6 session management vulnerability is a critical issue that affects the Shopware 6 platform.", "Business Impact": "The vulnerability has the potential to compromise sensitive customer data and financial information.", "Technical Impact": "The vulnerability provides an attacker with the ability to bypass authentication mechanisms and access sensitive data.", "Mitigation Strategies": "To mitigate this risk, implement proper authentication mechanisms and validate user input.", "Recommendations": "Recommendations include upgrading to patched versions, implementing security patches, and implementing incident response plans.", "Conclusions": "The Shopware 6 session management vulnerability is a critical issue that requires immediate attention and action."}}