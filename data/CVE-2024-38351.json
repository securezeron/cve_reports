{"id": "CVE-2024-38351", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-18T17:15:52.777", "lastModified": "2024-06-20T12:44:01.637", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Pocketbase is an open source web backend written in go. In affected versions a malicious user may be able to compromise other user accounts. In order to be exploited users must have both OAuth2 and Password auth methods enabled. A possible attack scenario could be: 1. a malicious actor register with the targeted user's email (it is unverified), 2. at some later point in time the targeted user stumble on your app and decides to sign-up with OAuth2 (_this step could be also initiated by the attacker by sending an invite email to the targeted user_), 3. on successful OAuth2 auth we search for an existing PocketBase user matching with the OAuth2 user's email and associate them, 4. because we haven't changed the password of the existing PocketBase user during the linking, the malicious actor has access to the targeted user account and will be able to login with the initially created email/password. To prevent this for happening we now reset the password for this specific case if the previously created user wasn't verified (an exception to this is if the linking is explicit/manual, aka. when you send `Authorization:TOKEN` with the OAuth2 auth call). Additionally to warn existing users we now send an email alert in case the user has logged in with password but has at least one OAuth2 account linked. The flow will be further improved with ongoing refactoring and we will start sending emails for \"unrecognized device\" logins (OTP and MFA is already implemented and will be available with the next v0.23.0 release in the near future). For the time being users are advised to update to version 0.22.14. There are no known workarounds for this vulnerability.\n\n"}, {"lang": "es", "value": "Pocketbase es un backend web de c\u00f3digo abierto escrito en go. En las versiones afectadas, un usuario malintencionado puede comprometer las cuentas de otros usuarios. Para ser explotados, los usuarios deben tener habilitados los m\u00e9todos de autenticaci\u00f3n OAuth2 y Contrase\u00f1a. Un posible escenario de ataque podr\u00eda ser: 1. un actor malintencionado se registra con el correo electr\u00f3nico del usuario objetivo (no est\u00e1 verificado), 2. en alg\u00fan momento posterior, el usuario objetivo tropieza con su aplicaci\u00f3n y decide registrarse con OAuth2 (_este paso El atacante tambi\u00e9n podr\u00eda iniciarlo enviando un correo electr\u00f3nico de invitaci\u00f3n al usuario objetivo_), 3. en una autenticaci\u00f3n OAuth2 exitosa, buscamos un usuario de PocketBase existente que coincida con el correo electr\u00f3nico del usuario OAuth2 y lo asociamos, 4. porque no hemos cambiado el contrase\u00f1a del usuario de PocketBase existente durante la vinculaci\u00f3n, el actor malicioso tiene acceso a la cuenta de usuario objetivo y podr\u00e1 iniciar sesi\u00f3n con el correo electr\u00f3nico/contrase\u00f1a creado inicialmente. Para evitar que esto suceda, ahora restablecemos la contrase\u00f1a para este caso espec\u00edfico si el usuario creado anteriormente no fue verificado (una excepci\u00f3n a esto es si el enlace es expl\u00edcito/manual, tambi\u00e9n conocido como cuando env\u00eda `Autorizaci\u00f3n:TOKEN` con OAuth2 llamada de autenticaci\u00f3n). Adem\u00e1s, para advertir a los usuarios existentes, ahora enviamos una alerta por correo electr\u00f3nico en caso de que el usuario haya iniciado sesi\u00f3n con contrase\u00f1a pero tenga al menos una cuenta OAuth2 vinculada. El flujo se mejorar\u00e1 a\u00fan m\u00e1s con la refactorizaci\u00f3n continua y comenzaremos a enviar correos electr\u00f3nicos para inicios de sesi\u00f3n de \"dispositivos no reconocidos\" (OTP y MFA ya est\u00e1n implementados y estar\u00e1n disponibles con la pr\u00f3xima versi\u00f3n v0.23.0 en un futuro pr\u00f3ximo). Por el momento, se recomienda a los usuarios que actualicen a la versi\u00f3n 0.22.14. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-287"}]}], "references": [{"url": "https://github.com/pocketbase/pocketbase/discussions/4355", "source": "security-advisories@github.com"}, {"url": "https://github.com/pocketbase/pocketbase/security/advisories/GHSA-m93w-4fxv-r35v", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-38351 - Exploitation of OAuth2 and Password Auth Methods enables an attacker to compromise user accounts. Defend against this by updating to the latest version and implementing best practices for password storage."}, {"techniqueID": "T1191", "comment": "CVE-2024-38351 - Weak Password Storage and Validation enables an attacker to guess or easily reset passwords associated with user accounts. Defend against this by implementing strong password policies and requiring minimum password requirements."}], "stix_bundle": {"stixBundle": {"id": "https://www.example.com/cve-2024-38351", "type": "bundle", "createdBy": {"name": "Cybersecurity Expert"}, "created": "2024-06-18T17:15:52.777", "modified": "2024-06-20T12:44:01.637", "versions": [{"id": "v1.0", "type": "bundle", "schema": "https://swimlane-docs.swimlane.com/docs/schema/stix-core", "description": "Bundle for CVE-2024-38351"}], "objects": [{"id": "https://www.example.com/cve-2024-38351#cve", "type": "vulnerability", "description": "CVE-2024-38351", "severity": "medium", "published": "2024-06-18T17:15:52.777", "last_modified": "2024-06-20T12:44:01.637", "platforms": [{"id": "https://www.example.com/cve-2024-38351#platform", "type": "platform", "name": "Pocketbase"}], "impact": {"phases": {"exploitation": {"effect": {"privileges": "none", "confidentiality": "low", "integrity": "low", "availability": "none"}}}}, "mitigation_remediation_recommendations": [{"id": "https://www.example.com/cve-2024-38351#recommendation", "type": "recommendation", "description": "Update to the latest version of Pocketbase and implement best practices for password storage"}]}, {"id": "https://www.example.com/cve-2024-38351#adv_int", "type": "actor", "name": "Adversary", "roles": [{"id": "https://www.example.com/cve-2024-38351#role", "type": "role", "name": "privileged"}]}, {"id": "https://www.example.com/cve-2024-38351#t1190", "type": "course-of-action", "name": "T1190 - Resource Hijacking", "description": "The adversary hijacks a resource to gain unauthorized access", "technique_ids": [{"id": "https://attack.mitre.org/techniques/T1190", "type": "technique"}]}], "relationships": [{"id": "https://www.example.com/cve-2024-38351#vuln_rel", "type": "related-to", "start_node": "https://www.example.com/cve-2024-38351#cve", "end_node": "https://www.example.com/cve-2024-38351#t1190", "description": "The vulnerability may be exploited through resource hijacking"}]}}, "technical_analysis": {"Introduction": "This vulnerability allows an attacker to compromise user accounts by exploiting the interaction between OAuth2 and password-based authentication. The impact is rated as medium due to the potential for sensitive information disclosure.", "Impact and Scope": "The vulnerability affects all versions prior to 0.22.14 and may be exploitable through OAuth2 and password-based authentication.", "Related MITRE ATT&CK Techniques": "T1190 - Resource Hijacking and T1191 - Weak Password Storage and Validation", "Technical Details": "The vulnerability occurs when an attacker registers with an unverified email address and later authenticates with OAuth2, allowing them to link to an existing Pocketbase user account with the same email address.", "Detection": "Detection may involve monitoring for unauthorized account activity and logging unusual authentication attempts.", "Mitigation": "Mitigation involves updating to the latest version of Pocketbase and implementing strong password policies and requiring minimum password requirements.", "Conclusion": "In conclusion, this vulnerability allows attackers to compromise user accounts through exploiting the interaction between OAuth2 and password-based authentication."}, "executive_analysis": {"Overview": "This vulnerability affects the reliability and security of Pocketbase by allowing attackers to compromise user accounts.", "Business Impact": "The business impact is the potential loss of sensitive information and the reputational damage that may result.", "Technical Impact": "The technical impact is the potential for unauthorized access to sensitive information and the increased risk of data breaches.", "Mitigation Strategies": "Implementing strong password policies and requiring minimum password requirements, and updating to the latest version of Pocketbase.", "Recommendations": "Recommendations for executives include prioritizing security and implementing robust incident response plans.", "Conclusions": "In conclusion, this vulnerability highlights the importance of prioritizing security and implementing robust incident response plans to minimize the impact of future vulnerabilities."}}