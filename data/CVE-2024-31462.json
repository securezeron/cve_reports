{"id": "CVE-2024-31462", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-12T22:15:07.320", "lastModified": "2024-04-15T13:15:31.997", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "stable-diffusion-webui is a web interface for Stable Diffusion, implemented using Gradio library. Stable-diffusion-webui 1.7.0 is vulnerable to a limited file write affecting Windows systems. The create_ui method (Backup/Restore tab) in modules/ui_extensions.py takes user input into the config_save_name variable on line 653. This user input is later used in the save_config_state method and used to create a file path on line 65, which is afterwards opened for writing on line 67, which leads to a limited file write exploitable on Windows systems. This issue may lead to limited file write. It allows for writing json files anywhere on the server where the web server has access."}, {"lang": "es", "value": "stable-diffusion-webui es una interfaz web para Stable Diffusion, implementada utilizando la librer\u00eda Gradio. Stable-diffusion-webui 1.7.0 es vulnerable a una escritura de archivos limitada que afecta a los sistemas Windows. El m\u00e9todo create_ui (pesta\u00f1a Copia de seguridad/Restaurar) en m\u00f3dulos/ui_extensions.py toma la entrada del usuario en la variable config_save_name en la l\u00ednea 653. Esta entrada del usuario se usa m\u00e1s tarde en el m\u00e9todo save_config_state y se usa para crear una ruta de archivo en la l\u00ednea 65, que es posterior abierto para escritura en la l\u00ednea 67, lo que conduce a una escritura de archivo limitada explotable en sistemas Windows. Este problema puede provocar una escritura de archivos limitada. Permite escribir archivos json en cualquier lugar del servidor al que tenga acceso el servidor web."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-22"}]}], "references": [{"url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L59", "source": "security-advisories@github.com"}, {"url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L646-L660", "source": "security-advisories@github.com"}, {"url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L65", "source": "security-advisories@github.com"}, {"url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L653", "source": "security-advisories@github.com"}, {"url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L67", "source": "security-advisories@github.com"}, {"url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/v1.7.0/modules/ui_extensions.py", "source": "security-advisories@github.com"}, {"url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/commit/d9708c92b444894bce8070e4dcfaa093f8eb8d43", "source": "security-advisories@github.com"}, {"url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/discussions/15461", "source": "security-advisories@github.com"}, {"url": "https://securitylab.github.com/advisories/GHSL-2024-010_stable-diffusion-webui", "source": "security-advisories@github.com"}, {"url": "https://securitylab.github.com/advisories/GHSL-2024-010_stable-diffusion-webui/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1064", "comment": "CVE-2024-31462 - This vulnerability can lead to a limited file write, which may be used as a stepping stone for further exploitation. It is essential to monitor for unusual file access and write operations to detect potential malicious activity."}, {"techniqueID": "T1086", "comment": "CVE-2024-31462 - The vulnerability allows writing json files anywhere on the server where the web server has access, making it a potential avenue for data exfiltration or exploitation. Monitoring for unusual file access and write operations can help detect potential malicious activity."}], "stix_bundle": {"objects": [{"id": "vulnerability", "type": "vulnerability", "spec_version": "2.1", "stix_header": {"id": "vulnerability"}, "entities": [{"id": "vulnerability/stable-diffusion-webui", "class": "vulnerability", "type": "problem"}], "objects": [{"id": "course-of-action/MITRE-IR", "type": "course-of-action", "spec_version": "2.1", "stix_header": {"id": "course-of-action/MITRE-IR"}, "objects": [{"id": " course-of-action/MITRE-IR/defense-echelon", "type": "defense-echelon", "spec_version": "2.1", "stix_header": {"id": "course-of-action/MITRE-IR/defense-echelon"}, "objects": [{"id": "note/monitor-file-system", "type": "note", "spec_version": "2.1", "stix_header": {"id": "note/monitor-file-system"}, "description": "Monitor for unusual file access and write operations to detect potential malicious activity."}]}]}]}]}, "technical_analysis": {"Introduction": "The CVE-2024-31462 vulnerability in Stable Diffusion WebUI allows for limited file write operations, making it a potential stepping stone for further exploitation.", "Impact and Scope": "CVSS 3.1 Score: 6.3, Attack Vector: NETWORK, Attack Complexity: LOW, Privileges Required: LOW, User Interaction: NONE, Scope: UNCHANGED, Confidentiality Impact: LOW, Integrity Impact: LOW, Availability Impact: LOW.", "Related MITRE ATT&CK Techniques": "T1064, T1086", "Technical Details": "The vulnerability occurs when the create_ui method takes user input into the config_save_name variable and creates a file path using it, which is later used to create a file and write to it. This allows for writing json files anywhere on the server where the web server has access.", "Detection": "Monitor for unusual file access and write operations to detect potential malicious activity.", "Mitigation": "Implement monitoring for unusual file access and write operations to detect potential malicious activity. Implement secure file access controls and ensure that the web server does not have excessive privileges.", "Conclusion": "The CVE-2024-31462 vulnerability in Stable Diffusion WebUI allows for limited file write operations, making it a potential stepping stone for further exploitation. It is essential to monitor for unusual file access and write operations to detect potential malicious activity."}, "executive_analysis": {"Overview": "The CVE-2024-31462 vulnerability in Stable Diffusion WebUI allows for limited file write operations, making it a potential stepping stone for further exploitation.", "Business Impact": "This vulnerability can lead to data exfiltration, data corruption, or exploitation of sensitive data.", "Technical Impact": "The vulnerability can be exploited to write json files anywhere on the server where the web server has access, making it a potential avenue for data exfiltration or exploitation.", "Mitigation Strategies": "Implement monitoring for unusual file access and write operations to detect potential malicious activity, Implement secure file access controls, and ensure that the web server does not have excessive privileges.", "Recommendations": "Executive management should prioritize the patching of this vulnerability and implementing additional security measures to detect and prevent potential exploitation.", "Conclusions": "The CVE-2024-31462 vulnerability in Stable Diffusion WebUI is a significant risk and requires immediate attention. It is essential to prioritize the patching of this vulnerability and implementing additional security measures to detect and prevent potential exploitation."}}