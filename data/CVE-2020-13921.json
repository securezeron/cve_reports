{"id": "CVE-2020-13921", "sourceIdentifier": "security@apache.org", "published": "2020-08-05T14:15:12.327", "lastModified": "2023-11-07T03:16:59.890", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "**Resolved** Only when using H2/MySQL/TiDB as Apache SkyWalking storage, there is a SQL injection vulnerability in the wildcard query cases."}, {"lang": "es", "value": "** Resuelto** Solo cuando se usa H2/MySQL/TiDB como almacenamiento Apache SkyWalking, existe una vulnerabilidad de inyecci\u00f3n SQL en los casos de consulta comod\u00edn"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:skywalking:6.5.0:*:*:*:*:*:*:*", "matchCriteriaId": "E62A23B6-6BE7-47F7-88A5-6EFC34A2566F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:skywalking:6.6.0:*:*:*:*:*:*:*", "matchCriteriaId": "F51FACC0-3D78-437A-BC9C-6D5550CFB48D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:skywalking:7.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "F5C5A2EB-0DF4-4172-BEDB-2D7ED9F43917"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:skywalking:8.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "A9EEB0AC-DE2A-41AE-B62B-26A2A0118EE5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:skywalking:8.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "A6C3300E-F3F5-4CF2-9670-FE50DA4599AD"}]}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2020/08/05/3", "source": "security@apache.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://github.com/apache/skywalking/pull/4970", "source": "security@apache.org", "tags": ["Third Party Advisory"]}, {"url": "https://lists.apache.org/thread.html/r6f3a934ebc54585d8468151a494c1919dc1ee2cccaf237ec434dbbd6%40%3Cdev.skywalking.apache.org%3E", "source": "security@apache.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2020-13921 - SQL Injection - Apache SkyWalking Storage Vulnerability - This vulnerability allows an attacker to inject malicious SQL queries, which can lead to sensitive data exposure and unauthorized access. Defenses include validating user input and using prepared statements."}, {"techniqueID": "T1190", "comment": "CVE-2020-13921 - Exploit Public-Facing Application - Apache SkyWalking Storage Vulnerability - An attacker can exploit this vulnerability to inject malicious SQL queries, which can lead to sensitive data exposure and unauthorized access. Defenses include updating to the latest version and validating user input."}, {"techniqueID": "T1222", "comment": "CVE-2020-13921 - Data Stolen Through an Unsecured API - Apache SkyWalking Storage Vulnerability - An attacker can exploit this vulnerability to steal sensitive data through an unsecured API. Defenses include implementing API security measures and validating user input."}], "stix_bundle": {"$schema": "https://stix sqr.ai/stix-2.1/stix.bundle.schema.json", "id": "CVE-2020-13921-STIX-Bundle", "type": "bundle", "description": "STIX Bundle for CVE-2020-13921 - Apache SkyWalking Storage Vulnerability", "objects": [{"id": "CVE-2020-13921", "type": "vulnerability", "description": "**Resolved** Only when using H2/MySQL/TiDB as Apache SkyWalking storage, there is a SQL injection vulnerability in the wildcard query cases.", "roles": ["primary"], "contributing_elements": [{"id": "T1059", "type": "technique", "roles": ["related"]}, {"id": "T1190", "type": "technique", "roles": ["related"]}, {"id": "T1222", "type": "technique", "roles": ["related"]}]}, {"id": "T1059", "type": "technique", "description": "SQL Injection", "background": "This attack involves injecting malicious SQL code into a script, giving the attacker the ability to access and potentially manipulate data"}, {"id": "T1190", "type": "technique", "description": "Exploit Public-Facing Application", "background": "This attack involves exploiting publicly-facing applications without knowledge or presence within the internal network"}, {"id": "T1222", "type": "technique", "description": "Data Stolen Through an Unsecured API", "background": "This attack involves stealing sensitive data through an unsecured API"}], "relationships": [{"id": "rel-CVE-2020-13921-T1059", "type": "has_related_vulnerability", "source_ref": "CVE-2020-13921", "target_ref": "T1059"}, {"id": "rel-CVE-2020-13921-T1190", "type": "has_related_vulnerability", "source_ref": "CVE-2020-13921", "target_ref": "T1190"}, {"id": "rel-CVE-2020-13921-T1222", "type": "has_related_vulnerability", "source_ref": "CVE-2020-13921", "target_ref": "T1222"}]}, "technical_analysis": {"Introduction": "Apache SkyWalking Storage Vulnerability allows an attacker to inject malicious SQL queries, which can lead to sensitive data exposure and unauthorized access.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 (CRITICAL) with an attack vector of NETWORK, and affects Apache SkyWalking Storage with versions 6.5.0, 6.6.0, 7.0.0, and 8.0.0.", "Related MITRE ATT&CK Techniques": "T1059, T1190, T1222", "Technical Details": "The vulnerability is caused by improper input validation, allowing an attacker to craft malicious SQL queries that can be executed by the Apache SkyWalking Storage application.", "Detection": "Detecting this vulnerability involves monitoring for suspicious HTTP requests and SQL queries, as well as auditing user access to sensitive data.", "Mitigation": "Mitigation strategies include updating to the latest version of Apache SkyWalking Storage, validating user input, and using prepared statements to prevent SQL injection.", "Conclusion": "In conclusion, the Apache SkyWalking Storage Vulnerability is a critical vulnerability that allows an attacker to inject malicious SQL queries, which can lead to sensitive data exposure and unauthorized access."}, "executive_analysis": {"Overview": "The Apache SkyWalking Storage Vulnerability is a critical vulnerability that affects Apache SkyWalking Storage with versions 6.5.0, 6.6.0, 7.0.0, and 8.0.0.", "Business Impact": "This vulnerability can result in sensitive data exposure and unauthorized access, which can have significant financial and reputational impacts on the business.", "Technical Impact": "The vulnerability allows an attacker to inject malicious SQL queries, which can lead to sensitive data exposure and unauthorized access.", "Mitigation Strategies": "Upgrade to the latest version of Apache SkyWalking Storage, validate user input, and use prepared statements to prevent SQL injection.", "Recommendations": "Executives should immediately implement mitigation strategies and perform a comprehensive security audit to identify and remediate other potential vulnerabilities.", "Conclusions": "In conclusion, the Apache SkyWalking Storage Vulnerability is a critical vulnerability that requires immediate attention and mitigation."}}