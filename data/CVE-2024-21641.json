{"id": "CVE-2024-21641", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-05T21:15:43.337", "lastModified": "2024-01-18T20:42:19.490", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Flarum is open source discussion platform software. Prior to version 1.8.5, the Flarum `/logout` route includes a redirect parameter that allows any third party to redirect users from a (trusted) domain of the Flarum installation to redirect to any link. For logged-in users, the logout must be confirmed. Guests are immediately redirected. This could be used by spammers to redirect to a web address using a trusted domain of a running Flarum installation. The vulnerability has been fixed and published as flarum/core v1.8.5. As a workaround, some extensions modifying the logout route can remedy this issue if their implementation is safe."}, {"lang": "es", "value": "Flarum es un software de plataforma de discusi\u00f3n de c\u00f3digo abierto. Antes de la versi\u00f3n 1.8.5, la ruta `/logout` de Flarum incluye un par\u00e1metro de redirecci\u00f3n que permite a cualquier tercero redirigir a los usuarios desde un dominio (confiable) de la instalaci\u00f3n de Flarum para redirigir a cualquier enlace. Para los usuarios que han iniciado sesi\u00f3n, se debe confirmar el cierre de sesi\u00f3n. Los invitados son redirigidos inmediatamente. Los spammers podr\u00edan utilizar esto para redirigir a una direcci\u00f3n web utilizando un dominio confiable de una instalaci\u00f3n de Flarum en ejecuci\u00f3n. La vulnerabilidad ha sido reparada y publicada como flarum/core v1.8.5. Como workaround, algunas extensiones que modifican la ruta de cierre de sesi\u00f3n pueden solucionar este problema si su implementaci\u00f3n es segura."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-601"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:flarum:flarum:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.8.5", "matchCriteriaId": "D5C4E508-EB5A-43B9-B11C-81977B5BA70D"}]}]}], "references": [{"url": "https://github.com/flarum/flarum-core/commit/ee8b3b4ad1413a2b0971fdd9e40f812d2a3a9d3a", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/flarum/framework/commit/7d70328471cf3091d92d95c382d277aec7996176", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/flarum/framework/security/advisories/GHSA-733r-8xcp-w9mr", "source": "security-advisories@github.com", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1189", "comment": "CVE-2024-21641 - This technique is relevant as it uses Web Shell to redirect users. It can be defended against by configuring the logout route to block redirects from trusted domains."}, {"techniqueID": "T1190", "comment": "CVE-2024-21641 - This technique is relevant as it uses Redirect to a phishing site. It can be defended against by implementing web application firewalls and configuring them to block redirects."}, {"techniqueID": "T1204", "comment": "CVE-2024-21641 - This technique is relevant as it uses Web Service to launch the attack. It can be defended against by configuring web services to limit access and implementing authentication and authorization mechanisms."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/CVE-2024-21641", "spec_version": "2.1", "objects": [{"type": "marker", "id": "https://example.com/CVE-2024-21641", "created_by_ref": "https://example.com/CVE-2024-21641", "title": "CVE-2024-21641: Flarum Logout Route Redirection", "description": "This vulnerability allows an attacker to redirect users from a trusted domain to any link.", "published": "2024-01-05T21:15:43.337"}, {"type": "incident", "id": "https://example.com/INC-2024-21641", "created_by_ref": "https://example.com/CVE-2024-21641", "title": "INC-2024-21641: Flarum Logout Route Redirection", "description": "This incident represents an attack that exploits the Flarum Logout Route Redirection vulnerability.", "first_seen": "2024-01-05T21:15:43.337", "last_seen": "2024-01-18T20:42:19.490"}, {"type": "attack_pattern", "id": "https://example.com/AP-2024-21641", "created_by_ref": "https://example.com/CVE-2024-21641", "title": "AP-2024-21641: Flarum Logout Route Redirection", "description": "This attack pattern represents the Flarum Logout Route Redirection vulnerability.", "techniques": [{"type": "mitre-attack-technique", "id": "T1189", "name": "Web Shell", "description": "This technique is used to inject malicious shell code into a web page."}, {"type": "mitre-attack-technique", "id": "T1190", "name": "Redirect to a phishing site", "description": "This technique is used to redirect users to a phishing site."}, {"type": "mitre-attack-technique", "id": "T1204", "name": "Web Service", "description": "This technique is used to launch an attack using a web service."}]}], "relationship_types": [{"type": "related_to", "type_label": "related to"}], "relationship_objects": [{"from": "https://example.com/CVE-2024-21641", "to": "https://example.com/INC-2024-21641", "relationship_type": "related_to"}, {"from": "https://example.com/INC-2024-21641", "to": "https://example.com/AP-2024-21641", "relationship_type": "imposes"}]}, "technical_analysis": {"Introduction": "The Flarum Logout Route Redirection vulnerability allows an attacker to redirect users from a trusted domain to any link, which can be used to launch a phishing attack.", "Impact and Scope": "This vulnerability has a CVSS score of 4.7 and affects versions of Flarum prior to 1.8.5.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to several MITRE ATT&CK techniques, including T1189, T1190, and T1204.", "Technical Details": "The vulnerability occurs when the logout route in Flarum is accessed with a redirect parameter, which allows an attacker to redirect users to any link.", "Detection": "This vulnerability can be detected by monitoring the/logout route in Flarum for redirects to untrusted sites.", "Mitigation": "This vulnerability can be mitigated by updating to version 1.8.5 or later of Flarum, or by configuring the logout route to block redirects from trusted domains.", "Conclusion": "In conclusion, the Flarum Logout Route Redirection vulnerability is a significant security risk that can be exploited by attackers to launch phishing attacks."}, "executive_analysis": {"Overview": "The Flarum Logout Route Redirection vulnerability is a security risk that can be exploited by attackers to launch phishing attacks.", "Business Impact": "This vulnerability can have a significant impact on the business, as it can allow attackers to steal sensitive information or conduct malicious activities.", "Technical Impact": "This vulnerability has a CVSS score of 4.7 and affects versions of Flarum prior to 1.8.5, which makes it a significant technical risk.", "Mitigation Strategies": "The recommended mitigation strategy is to update to version 1.8.5 or later of Flarum, or to configure the logout route to block redirects from trusted domains.", "Recommendations": "We recommend that executives take immediate action to address this vulnerability and ensure that their Flarum installation is up to date.", "Conclusions": "In conclusion, the Flarum Logout Route Redirection vulnerability is a significant security risk that requires immediate attention and action."}}