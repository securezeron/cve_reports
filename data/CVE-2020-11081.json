{"id": "CVE-2020-11081", "sourceIdentifier": "security-advisories@github.com", "published": "2020-07-10T19:15:11.553", "lastModified": "2023-01-20T20:32:50.900", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "osquery before version 4.4.0 enables a privilege escalation vulnerability. If a Window system is configured with a PATH that contains a user-writable directory then a local user may write a zlib1.dll DLL, which osquery will attempt to load. Since osquery runs with elevated privileges this enables local escalation. This is fixed in version 4.4.0."}, {"lang": "es", "value": "osquery versiones anteriores a 4.4.0, habilita una vulnerabilidad de escalada de privilegios. Si un sistema Windows est\u00e1 configurado con una PATH que contiene un directorio escribible por parte del usuario, entonces un usuario local puede escribir una biblioteca DLL zlib1.dll, que osquery intentar\u00e1 cargar. Ya que osquery se ejecuta con privilegios elevados, esto permite una escalada local. Esto es corregido en la versi\u00f3n 4.4.0"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.5, "impactScore": 6.0}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:N/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.8, "impactScore": 4.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.4}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-114"}]}, {"source": "nvd@nist.gov", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-426"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:linuxfoundation:osquery:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.4.0", "matchCriteriaId": "6C2CBEA8-4F6B-429A-BBBC-4E7BA6BF5414"}]}]}], "references": [{"url": "https://github.com/osquery/osquery/commit/4d4957f12a6aa0becc9d01d9f97061e1e3d809c5", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/osquery/osquery/issues/6426", "source": "security-advisories@github.com", "tags": ["Exploit", "Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/osquery/osquery/pull/6433", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/osquery/osquery/releases/tag/4.4.0", "source": "security-advisories@github.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/osquery/osquery/security/advisories/GHSA-2xwp-8fv7-c5pm", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-11081 - This privilege escalation vulnerability in osquery (osquery before version 4.4.0) allows a local user to write a zlib1.dll DLL, which osquery will attempt to load, leading to local escalation of privileges. The technique involves loading a malicious DLL, demonstrating a privilege escalation vulnerability. This is mitigated by updating osquery to version 4.4.0."}, {"techniqueID": "T1204", "comment": "CVE-2020-11081 - This vulnerability provides a mechanism for a local user to write a malicious zlib1.dll DLL in a user-writable directory. This is a common technique used by attackers to escalate privileges. Defending against this involves restricting user access to write-sensitive directories and monitoring for suspicious DLL loading activity."}, {"techniqueID": "T1210", "comment": "CVE-2020-11081 - This vulnerability demonstrates the ability of a local user to write a malicious zlib1.dll DLL. This is a form of execution through the use of a malicious DLL. Defending against this involves monitoring for suspicious DLL loading activity, restricting user access to write-sensitive directories, and using anti-virus solutions to detect and prevent the loading of malicious DLLs."}], "stix_bundle": {"id": "https://example.com/stix_bundle", "type": "bundle", "created_by_ref": "https://example.com/identity", "created": "2023-02-20T14:30:00.000Z", "modified": "2023-02-20T14:30:00.000Z", "objects": [{"id": "https://example.com/vulnerability", "type": "vulnerability", "name": "CVE-2020-11081", "description": "Description of CVE-2020-11081", "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H", "cvss_score": 8.2, "attack_vector": "LOCAL", "attack_complexity": "LOW", "privileges_required": "LOW", "user_interaction": "REQUIRED", "scope": "CHANGED", "attack_complexity_required": "LOW", "schedule_attack permits_reuse": "true", "access_complexity": "LOW", "auth_required": "false", "auth_required_can_be_exploited": "true", "base_score": 8.2, "base_severity": "HIGH", "exploitability_score": 1.5, "impact_score": 6.0}]}, "technical_analysis": {"Introduction": "CVE-2020-11081 is a privilege escalation vulnerability in osquery that allows a local user to write a malicious zlib1.dll DLL.", "Impact and Scope": "This vulnerability has a CVSS score of 8.2 and an exploitation score of 1.5. It is a high-severity vulnerability that can potentially allow an attacker to escalate their privileges.", "Related MITRE ATT&CK Techniques": "T1190, T1204, T1210", "Technical Details": "The vulnerability occurs when osquery loads a malicious zlib1.dll DLL from a user-writable directory. This allows an attacker to write a DLL that is then loaded by osquery, allowing them to escalate their privileges.", "Detection": "Detection of this vulnerability involves monitoring for suspicious DLL loading activity and restricting user access to write-sensitive directories.", "Mitigation": "Mitigation of this vulnerability involves updating osquery to version 4.4.0 and restricting user access to write-sensitive directories.", "Conclusion": "In conclusion, CVE-2020-11081 is a privilege escalation vulnerability in osquery that can be exploited by a local user to escalate their privileges."}, "executive_analysis": {"Overview": "CVE-2020-11081 is a privilege escalation vulnerability in osquery that can allow a local user to escalate their privileges.", "Business Impact": "This vulnerability has a high business impact, as it can allow an attacker to gain elevated privileges and potentially access sensitive data.", "Technical Impact": "The technical impact of this vulnerability is high, as it can allow an attacker to escalate their privileges and gain access to sensitive data.", "Mitigation Strategies": "Mitigation strategies include updating osquery to version 4.4.0 and restricting user access to write-sensitive directories.", "Recommendations": "Recommendations include updating osquery to version 4.4.0, restricting user access to write-sensitive directories, and monitoring for suspicious DLL loading activity.", "Conclusions": "In conclusion, CVE-2020-11081 is a significant vulnerability that requires immediate attention and mitigation strategies to prevent exploitation."}}