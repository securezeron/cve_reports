{"id": "CVE-2024-3761", "sourceIdentifier": "security@huntr.dev", "published": "2024-05-20T09:15:09.497", "lastModified": "2024-05-20T13:00:04.957", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In lunary-ai/lunary version 1.2.2, the DELETE endpoint located at `packages/backend/src/api/v1/datasets` is vulnerable to unauthorized dataset deletion due to missing authorization and authentication mechanisms. This vulnerability allows any user, even those without a valid token, to delete a dataset by sending a DELETE request to the endpoint. The issue was fixed in version 1.2.8. The impact of this vulnerability is significant as it permits unauthorized users to delete datasets, potentially leading to data loss or disruption of service."}, {"lang": "es", "value": " En lunary-ai/lunary versi\u00f3n 1.2.2, el endpoint DELETE ubicado en `packages/backend/src/api/v1/datasets` es vulnerable a la eliminaci\u00f3n no autorizada de conjuntos de datos debido a la falta de mecanismos de autorizaci\u00f3n y autenticaci\u00f3n. Esta vulnerabilidad permite que cualquier usuario, incluso aquellos sin un token v\u00e1lido, elimine un conjunto de datos enviando una solicitud DELETE al endpoint. El problema se solucion\u00f3 en la versi\u00f3n 1.2.8. El impacto de esta vulnerabilidad es significativo ya que permite a usuarios no autorizados eliminar conjuntos de datos, lo que podr\u00eda provocar la p\u00e9rdida de datos o la interrupci\u00f3n del servicio."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-862"}]}], "references": [{"url": "https://github.com/lunary-ai/lunary/commit/14078c1d2b8766075bf655f187ece24c7a787776", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/e95fb0a0-e54a-4da8-a33d-ba858d0cec55", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-3761 - This TTP is related to the vulnerability in the DELETE endpoint of the lunary-ai/lunary package, which allows unauthorized users to delete datasets due to missing authorization and authentication mechanisms. Defending against this TTP includes implementing proper authentication and authorization mechanisms in the DELETE endpoint."}, {"techniqueID": "T1087", "comment": "CVE-2024-3761 - This TTP is related to the use of publicly accessible endpoints, such as the DELETE endpoint in the lunary-ai/lunary package, which can be exploited by unauthorized users. Defending against this TTP includes restricting access to critical endpoints and implementing rate limiting and blocking to prevent excessive requests."}, {"techniqueID": "T1210", "comment": "CVE-2024-3761 - This TTP is related to the exploitation of missing or weak authentication mechanisms, such as the lack of authentication and authorization in the DELETE endpoint of the lunary-ai/lunary package. Defending against this TTP includes implementing strong authentication and authorization mechanisms."}, {"techniqueID": "T1229", "comment": "CVE-2024-3761 - This TTP is related to the ability of unauthorized users to delete datasets, which can lead to data loss or disruption of service. Defending against this TTP includes implementing data backups and monitoring systems to detect and prevent unauthorized data deletions."}, {"techniqueID": "T1568", "comment": "CVE-2024-3761 - This TTP is related to the exploitation of publicly accessible endpoints, such as the DELETE endpoint in the lunary-ai/lunary package, which can be exploited by unauthorized users. Defending against this TTP includes restricting access to critical endpoints and implementing rate limiting and blocking to prevent excessive requests."}, {"techniqueID": "T1974", "comment": "CVE-2024-3761 - This TTP is related to the exploitation of missing or weak authorization mechanisms, such as the lack of authorization in the DELETE endpoint of the lunary-ai/lunary package. Defending against this TTP includes implementing strong authorization mechanisms."}], "stix_bundle": {"@stix2_v": "2.1", "objects": [{"@type": "vulnerability", "id": "CVE-2024-3761", "title": "Unpatched Vulnerability in lunary-ai/lunary 1.2.2", "description": "In lunary-ai/lunary version 1.2.2, the DELETE endpoint located at `packages/backend/src/api/v1/datasets` is vulnerable to unauthorized dataset deletion due to missing authorization and authentication mechanisms.", "created": "2024-05-20T09:15:09.497", "modified": "2024-05-20T13:00:04.957", "labels": ["security", "vulnerability"], "external_references": [{"external_id": "CVE-2024-3761", "source_name": "security@huntr.dev"}]}, {"@type": "course-of-action", "id": "COA-1", "title": "Patch the Vulnerability", "description": "Patch the vulnerability by updating the lunary-ai/lunary package to version 1.2.8 or higher.", "type": "mitigation", "created": "2024-05-20T09:15:09.497", "modified": "2024-05-20T13:00:04.957", "labels": ["mitigation", "patching"], "object_marking_refs": [{"id": "id123456789", "type": "marking-definition-ref"}]}, {"@type": "note", "id": "Note-1", "title": "Detection and Mitigation Strategies", "description": "Detection strategies include monitoring for anomalous data deletion requests and monitoring the DELETE endpoint for unauthorized access. Mitigation strategies include implementing strong authentication and authorization mechanisms, rate limiting and blocking, and data backups and monitoring systems.", "created": "2024-05-20T09:15:09.497", "modified": "2024-05-20T13:00:04.957", "labels": ["detection", "mitigation"], "object_refs": [{"id": "CVE-2024-3761", "type": "vulnerability"}]}, {"@type": "note", "id": "Note-2", "title": "Technical Details", "description": "Technical details of the vulnerability include the use of publicly accessible endpoints, missing or weak authentication mechanisms, and lack of data backups and monitoring systems.", "created": "2024-05-20T09:15:09.497", "modified": "2024-05-20T13:00:04.957", "labels": ["technical"], "object_refs": [{"id": "CVE-2024-3761", "type": "vulnerability"}]}], "relationships": [{"relationship": "related_to", "from": "CVE-2024-3761", "to": "COA-1"}, {"relationship": "related_to", "from": "CVE-2024-3761", "to": "Note-1"}, {"relationship": "related_to", "from": "CVE-2024-3761", "to": "Note-2"}]}, "technical_analysis": {"Introduction": "The CVE-2024-3761 vulnerability is a critical security issue affecting the lunary-ai/lunary package, version 1.2.2.", "Impact and Scope": "The vulnerability allows unauthorized users to delete datasets, which can lead to data loss or disruption of service.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1027, T1087, T1210, T1229, T1568, and T1974.", "Technical Details": "The vulnerability is caused by missing or weak authentication mechanisms and lack of data backups and monitoring systems.", "Detection": "Detection strategies include monitoring for anomalous data deletion requests and monitoring the DELETE endpoint for unauthorized access.", "Mitigation": "Mitigation strategies include implementing strong authentication and authorization mechanisms, rate limiting and blocking, and data backups and monitoring systems.", "Conclusion": "In conclusion, the CVE-2024-3761 vulnerability is a critical security issue that requires immediate attention and patching."}, "executive_analysis": {"Overview": "The CVE-2024-3761 vulnerability is a critical security issue affecting the lunary-ai/lunary package, version 1.2.2.", "Business Impact": "This vulnerability can lead to data loss or disruption of service, which can have significant business impacts.", "Technical Impact": "This vulnerability is caused by missing or weak authentication mechanisms and lack of data backups and monitoring systems.", "Mitigation Strategies": "Implementing strong authentication and authorization mechanisms, rate limiting and blocking, and data backups and monitoring systems are the recommended mitigation strategies.", "Recommendations": "We recommend patching the vulnerability as soon as possible and implementing the recommended mitigation strategies.", "Conclusions": "In conclusion, the CVE-2024-3761 vulnerability is a critical security issue that requires immediate attention and patching."}}