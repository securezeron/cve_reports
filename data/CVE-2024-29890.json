{"id": "CVE-2024-29890", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-29T15:15:12.467", "lastModified": "2024-04-01T01:12:59.077", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "DataLens is a business intelligence and data visualization system. A specifically crafted request allowed the creation of a special chart type with the ability to pass custom javascript code that would later be executed in an unprotected sandbox on subsequent requests to that chart. The problem was fixed in the datalens-ui version `0.1449.0`. Restricting access to the API for creating or modifying charts (`/charts/api/charts/v1/`) would mitigate the issue."}, {"lang": "es", "value": "DataLens es un sistema de visualizaci\u00f3n de datos e inteligencia empresarial. Una solicitud manipulada espec\u00edficamente permiti\u00f3 la creaci\u00f3n de un tipo de gr\u00e1fico especial con la capacidad de pasar c\u00f3digo JavaScript personalizado que luego se ejecutar\u00eda en una zona de pruebas desprotegida en solicitudes posteriores a ese gr\u00e1fico. El problema se solucion\u00f3 en la versi\u00f3n de datalens-ui `0.1449.0`. Restringir el acceso a la API para crear o modificar gr\u00e1ficos (`/charts/api/charts/v1/`) mitigar\u00eda el problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "references": [{"url": "https://github.com/datalens-tech/datalens/security/advisories/GHSA-6278-2wvc-4p93", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "Via CVE-2024-29890, an attacker could potentially exploit an unpatched vulnerable chart in DataLens to inject custom JavaScript code. Defending against this vulnerability requires maintaining up-to-date software and restrictiing access to the API for creating or modifying charts as mentioned in the advisory. T1190 is relevant as it is the technique of 'Adding Content to Include' which could be used by an attacker to inject malicious code."}, {"techniqueID": "T1059", "comment": "T1190 can be leveraged to inject custom JavaScript code in DataLens which could be used to conduct network attacks. T1059 is relevant as it is the technique of 'Command and Control' which could be used to remotely execute the injected code."}, {"techniqueID": "T1046", "comment": "The injected custom JavaScript code in DataLens could be used to execute commands and transfer files. T1046 is relevant as it is the technique of 'Ransomware' which could be used to encrypt files and demand payment."}], "stix_bundle": {"type": "bundle", "id": "bundle--CVE-2024-29890", "title": "CVE-2024-29890 STIX 2.1 Bundle", " description": "STIX 2.1 bundle for CVE-2024-29890", "objects": [{"type": "vulnerability", "id": "vulnerability--CVE-2024-29890", "attributes": {"cve_id": "CVE-2024-29890"}}, {"type": "attack-pattern", "id": "attack-pattern--T1190", "attributes": {"id": "T1190", "name": "Adding Content to Include"}}, {"type": "attack-pattern", "id": "attack-pattern--T1059", "attributes": {"id": "T1059", "name": "Command and Control"}}, {"type": "attack-pattern", "id": "attack-pattern--T1046", "attributes": {"id": "T1046", "name": "Ransomware"}}, {"type": "campaign", "id": "campaign--CVE-2024-29890", "attributes": {"name": "CVE-2024-29890 Campaign"}}, {"type": "indicator", "id": "indicator--CVE-2024-29890", "attributes": {"name": "CVE-2024-29890 Indicator"}}], "relationship": {"vulnerability--CVE-2024-29890": {"related_to": ["attack-pattern--T1190", "attack-pattern--T1059", "attack-pattern--T1046", "campaign--CVE-2024-29890", "indicator--CVE-2024-29890"]}, "attack-pattern--T1190": {"used_by": ["campaign--CVE-2024-29890"], "attributed_to": ["vulnerability--CVE-2024-29890"]}, "attack-pattern--T1059": {"used_by": ["campaign--CVE-2024-29890"], "attributed_to": ["vulnerability--CVE-2024-29890"]}, "attack-pattern--T1046": {"used_by": ["campaign--CVE-2024-29890"], "attributed_to": ["vulnerability--CVE-2024-29890"]}, "campaign--CVE-2024-29890": {"used": ["vulnerability--CVE-2024-29890"], "related_to": ["attack-pattern--T1190", "attack-pattern--T1059", "attack-pattern--T1046", "indicator--CVE-2024-29890"]}, "indicator--CVE-2024-29890": {"indicated_by": ["campaign--CVE-2024-29890"], "related_to": ["vulnerability--CVE-2024-29890", "attack-pattern--T1190", "attack-pattern--T1059", "attack-pattern--T1046"]}}}, "technical_analysis": {"Introduction": "CVE-2024-29890 is an unauthenticated remote code execution vulnerability in DataLens.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 with a high impact on confidentiality, integrity, and availability.", "Related MITRE ATT&CK Techniques": "T1190, T1059, and T1046 are relevant as they are used to inject custom JavaScript code and conduct network attacks.", "Technical Details": "The vulnerability is due to an unpatched chart in DataLens that allows the creation of a special chart type with the ability to pass custom JavaScript code.", "Detection": "Detecting the vulnerability requires monitoring for unpatched and vulnerable charts in DataLens.", "Mitigation": "Defending against this vulnerability requires maintaining up-to-date software and restricting access to the API for creating or modifying charts.", "Conclusion": "In conclusion, it is crucial to prioritize patching vulnerable charts in DataLens to prevent remote code execution attacks."}, "executive_analysis": {"Overview": "CVE-2024-29890 is an unauthenticated remote code execution vulnerability in DataLens that requires immediate attention.", "Business Impact": "The vulnerability has a potential business impact as it could result in data breaches, unauthorized access, and financial losses.", "Technical Impact": "The technical impact is the potential to execute malicious code and conduct network attacks.", "Mitigation Strategies": "Implementing patches and restrictions on chart creation and modification is crucial.", "Recommendations": "Recommendations include prioritizing patching, conducting regular security audits, and implementing robust incident response plans.", "Conclusions": "In conclusion, immediate action is required to mitigate the risks associated with CVE-2024-29890."}}