{"id": "CVE-2023-5954", "sourceIdentifier": "security@hashicorp.com", "published": "2023-11-09T21:15:25.143", "lastModified": "2023-12-27T15:15:45.790", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "HashiCorp Vault and Vault Enterprise inbound client requests triggering a policy check can lead to an unbounded consumption of memory. A large number of these requests may lead to denial-of-service. Fixed in Vault 1.15.2, 1.14.6, and 1.13.10."}, {"lang": "es", "value": "Las solicitudes de clientes entrantes de HashiCorp Vault y Vault Enterprise que activan una verificaci\u00f3n de pol\u00edticas pueden provocar un consumo ilimitado de memoria. Un gran n\u00famero de estas solicitudes pueden dar lugar a una denegaci\u00f3n de servicio. Corregido en Vault 1.15.2, 1.14.6 y 1.13.10."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "security@hashicorp.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.2, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-401"}]}, {"source": "security@hashicorp.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-401"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:-:*:*:*", "versionStartIncluding": "1.13.7", "versionEndExcluding": "1.13.10", "matchCriteriaId": "8265AC92-59E4-4229-87E8-ABAF9E3DAAF3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.13.7", "versionEndExcluding": "1.13.10", "matchCriteriaId": "9FD3EF12-C2C0-4529-B0AB-08B8F238531D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:-:*:*:*", "versionStartIncluding": "1.14.3", "versionEndExcluding": "1.14.6", "matchCriteriaId": "38120A49-ED14-4C8C-9A0A-BA040D48C4E7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.14.3", "versionEndExcluding": "1.14.6", "matchCriteriaId": "ABC1488F-D1BA-4C98-98E0-DAFE9BE205A1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:-:*:*:*", "versionStartIncluding": "1.15.0", "versionEndExcluding": "1.15.2", "matchCriteriaId": "1C9C9A12-4062-4968-BE87-1B07A789A7D3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.15.0", "versionEndExcluding": "1.15.2", "matchCriteriaId": "2D3F2482-2783-49B2-888B-AC99FEE976EA"}]}]}], "references": [{"url": "https://discuss.hashicorp.com/t/hcsec-2023-33-vault-requests-triggering-policy-checks-may-lead-to-unbounded-memory-consumption/59926", "source": "security@hashicorp.com", "tags": ["Vendor Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20231227-0001/", "source": "security@hashicorp.com"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2023-5954 - This technique is relevant because it uses network communication to trigger a policy check, which can lead to unbounded memory consumption."}, {"techniqueID": "T1190", "comment": "CVE-2023-5954 - This technique is relevant because it uses client-side requests to trigger a policy check, which can lead to denial-of-service."}, {"techniqueID": "T1489", "comment": "CVE-2023-5954 - This technique is relevant because it uses memory consumption to perform a denial-of-service attack."}, {"techniqueID": "T1602", "comment": "CVE-2023-5954 - This technique is relevant because it uses a client-side state to trigger a policy check."}, {"techniqueID": "T1506", "comment": "CVE-2023-5954 - This technique is relevant because it uses a network communication to trigger a policy check."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/bundles/cve-2023-5954", "spec_version": "2.1", "created_by_ref": "https://example.com/creators/cybersecurity-expert", "changed": "2023-12-27T15:15:45.790", "created": "2023-11-09T21:15:25.143", "objects": [{"type": "vulnerability", "id": "https://example.com/vulnerabilities/cve-2023-5954", "name": "CVE-2023-5954: HashiCorp Vault Policy Check Denial-of-Service", "description": "CVE-2023-5954: A vulnerability in HashiCorp Vault's policy check functionality allows an unauthenticated, remote attacker to consume excessive system resources, potentially leading to a denial-of-service.", "affected_components": [{"type": "software", "id": "https://example.com/software/hashicorp/vault", "name": "HashiCorp Vault"}], "related_components": [{"type": "network", "id": "https://example.com/network", "name": "Network"}], "exploit_targets": [{"type": "network", "id": "https://example.com/network", "name": "Network"}], "related_threats": [{"id": "https://example.com/threats/bad-actors", "type": "threat_actor", "name": "Bad Actors"}]}, {"type": "course-of-action", "id": "https://example.com/course-of-actions/defend-against-cve-2023-5954", "name": "Defend against CVE-2023-5954", "category": "Defense", "description": "Implement a proactive defense strategy to mitigate the effects of CVE-2023-5954.", "effectiveness": "High", "techniques": [{"id": "https://example.com/techniques/T1059", "type": "technique", "name": "Network Communication"}, {"id": "https://example.com/techniques/T1190", "type": "technique", "name": "Client-Side Request"}]}]}, "technical_analysis": {"Introduction": "The CVE-2023-5954 vulnerability in HashiCorp Vault's policy check functionality allows an unauthenticated, remote attacker to consume excessive system resources, potentially leading to a denial-of-service.", "Impact and Scope": "The vulnerability affects HashiCorp Vault versions 1.13.7 to 1.13.10, 1.14.3 to 1.14.6, 1.15.0 to 1.15.2, and 1.15.4 and later. The attack vector is network communication, and the attack complexity is low.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1059, T1190, T1489, T1602, and T1506.", "Technical Details": "The vulnerability occurs when HashiCorp Vault processes a large number of incoming client requests that trigger a policy check, causing unbounded memory consumption. The attacker can exploit this vulnerability by creating a large number of client requests that trigger a policy check, leading to memory exhaustion.", "Detection": "Detection involves monitoring network traffic and system resource utilization to identify potential attacks. Additionally, analyzing log files for evidence of the vulnerability can help detect exploitation.", "Mitigation": "Mitigation strategies include implementing rate limiting on incoming client requests, configuring Vault to prioritize policy checks, and regularly updating to the latest version of Vault.", "Conclusion": "The CVE-2023-5954 vulnerability in HashiCorp Vault highlights the importance of proactive defense and regular updates to ensure the security of your systems."}, "executive_analysis": {"Overview": "The CVE-2023-5954 vulnerability in HashiCorp Vault's policy check functionality poses a significant risk to organizations that rely on Vault for secret management.", "Business Impact": "The vulnerability can lead to denial-of-service attacks, potentially causing revenue losses and damage to reputation.", "Technical Impact": "The vulnerability allows an unauthenticated, remote attacker to consume excessive system resources, potentially leading to a denial-of-service.", "Mitigation Strategies": "Implementing rate limiting on incoming client requests and configuring Vault to prioritize policy checks can help mitigate the risk associated with this vulnerability.", "Recommendations": "Regularly update to the latest version of Vault, monitor network traffic and system resource utilization, and analyze log files for evidence of the vulnerability.", "Conclusions": "The CVE-2023-5954 vulnerability in HashiCorp Vault emphasizes the importance of proactive defense and regular updates to ensure the security of your systems."}}