{"id": "CVE-2024-32645", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-25T18:15:08.593", "lastModified": "2024-04-26T12:58:17.720", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Vyper is a pythonic Smart Contract Language for the Ethereum virtual machine. In versions 0.3.10 and prior, incorrect values can be logged when `raw_log` builtin is called with memory or storage arguments to be used as topics. A contract search was performed and no vulnerable contracts were found in production. The `build_IR` function of the `RawLog` class fails to properly unwrap the variables provided as topics. Consequently, incorrect values are logged as topics. As of time of publication, no fixed version is available."}, {"lang": "es", "value": "Vyper es un lenguaje de contrato inteligente pit\u00f3nico para la m\u00e1quina virtual Ethereum. En las versiones 0.3.10 y anteriores, se pueden registrar valores incorrectos cuando se llama al comando interno `raw_log` con argumentos de memoria o almacenamiento para usar como temas. Se realiz\u00f3 una b\u00fasqueda de contratos y no se encontraron contratos vulnerables en producci\u00f3n. La funci\u00f3n `build_IR` de la clase `RawLog` no desenvuelve correctamente las variables proporcionadas como temas. En consecuencia, los valores incorrectos se registran como temas. Al momento de la publicaci\u00f3n, no hay ninguna versi\u00f3n fija disponible."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "https://github.com/vyperlang/vyper/security/advisories/GHSA-xchq-w5r3-4wg3", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-32645 - This vulnerability could be exploited by an attacker to inject malicious data into the Ethereum virtual machine, leading to incorrect logging and potential manipulation of on-chain data. This is relevant as it allows an attacker to manipulate the integrity of the system, and can be defended against by implementing proper input validation and sanitization."}, {"techniqueID": "T1194", "comment": "CVE-2024-32645 - This vulnerability could be exploited by an attacker to log sensitive information, such as memory and storage arguments, which can lead to data exposure. This is relevant as it can be used to exfiltrate sensitive data, and can be defended against by configuring proper logging and monitoring."}, {"techniqueID": "T1006", "comment": "CVE-2024-32645 - This vulnerability could be exploited by an attacker to inject malicious code into the Ethereum virtual machine, leading to arbitrary code execution. This is relevant as it allows an attacker to execute malicious code on the system, and can be defended against by implementing proper code validation and sanitization."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle-https://github.com/vyperlang/vyper/security/advisories/GHSA-xchq-w5r3-4wg3", "spec_version": "2.1", "objects": [{"type": "vulnerability", "id": "vulnerability-CVE-2024-32645", "created": "2024-04-25T18:15:08.593", "modified": "2024-04-26T12:58:17.720", "name": "Vyper Smart Contract Language for Ethereum Virtual Machine Vulnerability", "description": "Vyper is a pythonic Smart Contract Language for the Ethereum virtual machine. In versions 0.3.10 and prior, incorrect values can be logged when `raw_log` builtin is called with memory or storage arguments to be used as topics. ...", "cvss": {"vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N", "base_score": 5.3, "base_severity": "MEDIUM"}, "external_references": [{"source_name": "github", "external_id": "GHSA-xchq-w5r3-4wg3"}], "objects": [{"type": "attack-pattern", "id": "attack-pattern-T1190", "name": "Code Injection", "description": "Attack pattern description", "external_references": [{"source_name": "mitre", "external_id": "T1190"}]}, {"type": "attack-pattern", "id": "attack-pattern-T1194", "name": "Data Exfiltration", "description": "Attack pattern description", "external_references": [{"source_name": "mitre", "external_id": "T1194"}]}, {"type": "attack-pattern", "id": "attack-pattern-T1006", "name": "Scan", "description": "Attack pattern description", "external_references": [{"source_name": "mitre", "external_id": "T1006"}]}], "relationships": [{"type": "related-to", "id": "related-to-T1190", "from": "vulnerability-CVE-2024-32645", "to": "attack-pattern-T1190"}, {"type": "related-to", "id": "related-to-T1194", "from": "vulnerability-CVE-2024-32645", "to": "attack-pattern-T1194"}, {"type": "related-to", "id": "related-to-T1006", "from": "vulnerability-CVE-2024-32645", "to": "attack-pattern-T1006"}]}]}}, "technical_analysis": {"Introduction": "The CVE-2024-32645 vulnerability is a CWE-20 vulnerability in the Vyper smart contract language for the Ethereum virtual machine.", "Impact and Scope": "The vulnerability affects versions 0.3.10 and prior of the Vyper smart contract language and allows an attacker to inject malicious code, log sensitive information, and potentially expose sensitive data.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190, T1194, and T1006, which are used to inject malicious code, log sensitive information, and scan the system for vulnerabilities, respectively.", "Technical Details": "The vulnerability occurs when the `raw_log` builtin function is called with memory or storage arguments to be used as topics. This allows an attacker to inject malicious data into the Ethereum virtual machine and potentially manipulate the integrity of the system.", "Detection": "The vulnerability can be detected by monitoring the system for unusual logging and monitoring activities, and by implementing input validation and sanitization to prevent malicious code injection.", "Mitigation": "The vulnerability can be mitigated by updating to the latest version of Vyper, implementing proper input validation and sanitization, and configuring proper logging and monitoring.", "Conclusion": "The CVE-2024-32645 vulnerability is a significant vulnerability in the Vyper smart contract language for the Ethereum virtual machine, and it is crucial to identify and mitigate it to prevent potential attacks."}, "executive_analysis": {"Overview": "The CVE-2024-32645 vulnerability is a critical vulnerability in the Vyper smart contract language for the Ethereum virtual machine that allows an attacker to inject malicious code, log sensitive information, and potentially expose sensitive data.", "Business Impact": "The vulnerability has significant business impact, as it can allow an attacker to manipulate the integrity of the system and potentially expose sensitive data, which can lead to reputational damage and financial losses.", "Technical Impact": "The vulnerability has significant technical impact, as it can allow an attacker to inject malicious code into the Ethereum virtual machine, log sensitive information, and potentially expose sensitive data.", "Mitigation Strategies": "The mitigation strategies for the vulnerability are to update to the latest version of Vyper, implement proper input validation and sanitization, and configure proper logging and monitoring.", "Recommendations": "The recommendations for executives are to take immediate action to identify and mitigate the vulnerability, provide training to employees on the vulnerability and its mitigation, and monitor the system for unusual activities.", "Conclusions": "The CVE-2024-32645 vulnerability is a significant vulnerability in the Vyper smart contract language for the Ethereum virtual machine, and it is crucial to identify and mitigate it to prevent potential attacks."}}