{"id": "CVE-2024-20663", "sourceIdentifier": "secure@microsoft.com", "published": "2024-01-09T18:15:49.640", "lastModified": "2024-05-29T00:15:12.947", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Windows Message Queuing Client (MSMQC) Information Disclosure"}, {"lang": "es", "value": "Divulgaci\u00f3n de informaci\u00f3n de Message Queuing Client (MSMQC) de Windows"}], "metrics": {"cvssMetricV31": [{"source": "secure@microsoft.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "secure@microsoft.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-822"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1507:*:*:*:*:*:*:x64:*", "versionEndExcluding": "10.0.10240.20402", "matchCriteriaId": "46ABD897-272E-49BD-BCD1-79EA0908349D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1507:*:*:*:*:*:*:x86:*", "versionEndExcluding": "10.0.10240.20402", "matchCriteriaId": "B85886E7-0E67-4BBD-9E42-4507DF422BCF"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1607:*:*:*:*:*:*:x64:*", "versionEndExcluding": "10.0.14393.6614", "matchCriteriaId": "1301CF7B-D772-4AAA-BFF2-88BF493A324E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1607:*:*:*:*:*:*:x86:*", "versionEndExcluding": "10.0.14393.6614", "matchCriteriaId": "DDEB129C-34A6-47E5-A652-51FCE0A3A880"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1809:*:*:*:*:*:*:arm64:*", "versionEndExcluding": "10.0.17763.5329", "matchCriteriaId": "F0470D92-707F-4073-886A-ECDC4F2E1CAC"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1809:*:*:*:*:*:*:x64:*", "versionEndExcluding": "10.0.17763.5329", "matchCriteriaId": "9C150F7E-8967-4AB8-8DF8-EBC89A10D554"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1809:*:*:*:*:*:*:x86:*", "versionEndExcluding": "10.0.17763.5329", "matchCriteriaId": "A7997F10-4040-4664-B55E-0039E25B4F79"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_21h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.19044.3930", "matchCriteriaId": "26D9519C-EC1F-48D1-89F5-2DCBF84C8251"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_22h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.19045.3930", "matchCriteriaId": "B9B6C6A0-6A10-4A8B-9DF2-D00CE5F863BD"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_21h2:*:*:*:*:*:*:arm64:*", "versionEndExcluding": "10.0.22000.2713", "matchCriteriaId": "6FA472E2-4501-4597-9979-796258111DA5"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_21h2:*:*:*:*:*:*:x64:*", "versionEndExcluding": "10.0.22000.2713", "matchCriteriaId": "0F377DD9-2DBF-4202-AF3F-6AC6A809F4E2"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_22h2:*:*:*:*:*:*:arm64:*", "versionEndExcluding": "10.0.22621.3007", "matchCriteriaId": "C48178EC-BDEE-4F78-BCFB-B125F5CA0A9E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_22h2:*:*:*:*:*:*:x64:*", "versionEndExcluding": "10.0.22621.3007", "matchCriteriaId": "04C81079-1855-4F8C-A9E2-3E2CC796C4F0"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_23h2:*:*:*:*:*:*:arm64:*", "versionEndExcluding": "10.0.22631.3007", "matchCriteriaId": "91F6049F-03C1-494C-8AA1-6DE27D335139"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_23h2:*:*:*:*:*:*:x64:*", "versionEndExcluding": "10.0.22631.3007", "matchCriteriaId": "A00CE59A-0762-4AA4-99DA-5C9545F85666"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:-:sp2:*:*:*:*:x64:*", "matchCriteriaId": "2127D10C-B6F3-4C1D-B9AA-5D78513CC996"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:-:sp2:*:*:*:*:x86:*", "matchCriteriaId": "AB425562-C0A0-452E-AABE-F70522F15E1A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:-:*:*:*:*:*:*:*", "matchCriteriaId": "A7DF96F8-BA6A-4780-9CA3-F719B3F81074"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:r2:*:*:*:*:*:*:*", "matchCriteriaId": "DB18C4CE-5917-401E-ACF7-2747084FD36E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2016:-:*:*:*:*:*:*:*", "matchCriteriaId": "041FF8BA-0B12-4A1F-B4BF-9C4F33B7C1E7"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2019:-:*:*:*:*:*:*:*", "matchCriteriaId": "DB79EE26-FC32-417D-A49C-A1A63165A968"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022:-:*:*:*:*:*:*:*", "matchCriteriaId": "821614DD-37DD-44E2-A8A4-FE8D23A33C3C"}]}]}], "references": [{"url": "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-20663", "source": "secure@microsoft.com", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-20663 - Windows Message Queuing Client (MSMQC) Information Disclosure: An attacker may leverage this vulnerability to exfiltrate sensitive information using MSQM, which can eventually lead to the execution of arbitrary code. Defend against this by enabling Network Level Authentication and restricting access to the affected system."}, {"techniqueID": "T1078", "comment": "CVE-2024-20663 - Windows Message Queuing Client (MSMQC) Information Disclosure: This vulnerability can be used to deliver malware or backdoors to the affected system. Defend against this by implementing Application Control and restricting access to the compromised system."}, {"techniqueID": "T1190", "comment": "CVE-2024-20663 - Windows Message Queuing Client (MSMQC) Information Disclosure: The attacker can use this vulnerability to execute arbitrary code and escalate privileges. Defend against this by implementing Least Privilege and restricting access to the compromised system."}], "stix_bundle": {"Bundle": {"type": "bundle", "id": "bundle--f97b0bf6-da11-42b0-8b40-7b0d42a4f2d5", "created_by_ref": "identity--2bc1f7e5-4a9a-47ad-b0a0-e77c5ecbf15a", "created": "2023-03-31T04:25:27.000Z", "modified": "2023-03-31T04:25:27.000Z", "entities": [{"type": "vulnerability", "id": "vulnerability--2bc1f7e5-4a9a-47ad-b0a0-e77c5ecbf15a", "created_by_ref": "identity--2bc1f7e5-4a9a-47ad-b0a0-e77c5ecbf15a", "created": "2023-03-31T04:25:27.000Z", "modified": "2023-03-31T04:25:27.000Z", "name": "CVE-2024-20663: Windows Message Queuing Client (MSMQC) Information Disclosure"}, {"type": "attack-pattern", "id": "attack-pattern--d87c6a1f-ec3a-4edd-b6f5-f6e0e20f7e36", "created_by_ref": "identity--2bc1f7e5-4a9a-47ad-b0a0-e77c5ecbf15a", "created": "2023-03-31T04:25:27.000Z", "modified": "2023-03-31T04:25:27.000Z", "name": "Validating Code Execution"}, {"type": "data-marking", "id": "data-marking--f97b0bf6-da11-42b0-8b40-7b0d42a4f2d5", "created_by_ref": "identity--2bc1f7e5-4a9a-47ad-b0a0-e77c5ecbf15a", "created": "2023-03-31T04:25:27.000Z", "modified": "2023-03-31T04:25:27.000Z", "name": "Confidential"}], "relationships": [{"type": "relates", "id": "relates--5f97b0bd-da11-42b0-8b40-7b0d42a4f2d5", "created_by_ref": "identity--2bc1f7e5-4a9a-47ad-b0a0-e77c5ecbf15a", "created": "2023-03-31T04:25:27.000Z", "modified": "2023-03-31T04:25:27.000Z", "from": "vulnerability--2bc1f7e5-4a9a-47ad-b0a0-e77c5ecbf15a", "to": "attack-pattern--d87c6a1f-ec3a-4edd-b6f5-f6e0e20f7e36"}, {"type": "relates", "id": "relates--6f97b0be-da11-42b0-8b40-7b0d42a4f2d5", "created_by_ref": "identity--2bc1f7e5-4a9a-47ad-b0a0-e77c5ecbf15a", "created": "2023-03-31T04:25:27.000Z", "modified": "2023-03-31T04:25:27.000Z", "from": "vulnerability--2bc1f7e5-4a9a-47ad-b0a0-e77c5ecbf15a", "to": "data-marking--f97b0bf6-da11-42b0-8b40-7b0d42a4f2d5"}], "notes": [{"type": "note", "id": "note--5f97b0bf-da11-42b0-8b40-7b0d42a4f2d5", "created_by_ref": "identity--2bc1f7e5-4a9a-47ad-b0a0-e77c5ecbf15a", "created": "2023-03-31T04:25:27.000Z", "modified": "2023-03-31T04:25:27.000Z", "content": "The vulnerability can be exploited by an attacker using a weaponized MSQM, allowing them to execute arbitrary code and escalate privileges."}]}}, "technical_analysis": {"Introduction": "The CVE-2024-20663 vulnerability is a remote code execution vulnerability in the Windows Message Queuing Client (MSMQC). An attacker can exploit this vulnerability by using a weaponized MSQM to inject malicious code into the system.", "Impact and Scope": "This vulnerability has a CVSS score of 6.5 (Medium) and an attack vector of NETWORK. The vulnerability can be exploited to execute arbitrary code and escalate privileges.", "Related MITRE ATT&CK Techniques": "T1059, T1078, T1190", "Technical Details": "The vulnerability occurs when the MSQM process fails to properly validate the input data, allowing an attacker to inject malicious code into the system.", "Detection": "Detecting this vulnerability may require monitoring for suspicious MSQM activity, such as unusual network connections or elevated privilege levels.", "Mitigation": "To mitigate this vulnerability, implement Network Level Authentication and restrict access to the affected system.", "Conclusion": "The CVE-2024-20663 vulnerability is a significant threat to Windows systems and should be addressed immediately."}, "executive_analysis": {"Overview": "The CVE-2024-20663 vulnerability is a remote code execution vulnerability in the Windows Message Queuing Client (MSMQC) that allows an attacker to execute arbitrary code and escalate privileges.", "Business Impact": "The vulnerability can have significant business impacts, including data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability can be exploited to execute arbitrary code and escalate privileges, allowing an attacker to gain control of the affected system.", "Mitigation Strategies": "Implement Network Level Authentication and restrict access to the affected system.", "Recommendations": "Recommendations for executives include implementing a vulnerability management program, conducting regular security assessments, and training employees on security best practices.", "Conclusions": "The CVE-2024-20663 vulnerability is a significant threat to Windows systems and should be addressed immediately."}}