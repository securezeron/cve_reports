{"id": "CVE-2020-7020", "sourceIdentifier": "bressers@elastic.co", "published": "2020-10-22T17:15:12.693", "lastModified": "2022-06-03T18:56:29.710", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Elasticsearch versions before 6.8.13 and 7.9.2 contain a document disclosure flaw when Document or Field Level Security is used. Search queries do not properly preserve security permissions when executing certain complex queries. This could result in the search disclosing the existence of documents the attacker should not be able to view. This could result in an attacker gaining additional insight into potentially sensitive indices."}, {"lang": "es", "value": "Elasticsearch versiones anteriores a 6.8.13 y 7.9.2, contienen un fallo de divulgaci\u00f3n de documentos cuando es usado Document o Field Level Security.&#xa0;Las consultas de b\u00fasqueda no conservan apropiadamente los permisos de seguridad al ejecutar determinadas consultas complejas.&#xa0;Esto podr\u00eda resultar en que la b\u00fasqueda divulgue la existencia de documentos que el atacante no deber\u00eda poder visualizar.&#xa0;Esto podr\u00eda resultar en que un atacante pueda obtener informaci\u00f3n adicional sobre \u00edndices potencialmente confidenciales"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 3.1, "baseSeverity": "LOW"}, "exploitabilityScore": 1.6, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-269"}]}, {"source": "bressers@elastic.co", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-270"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:elastic:elasticsearch:*:*:*:*:*:*:*:*", "versionEndExcluding": "6.8.13", "matchCriteriaId": "7ADC1457-B782-4D06-9280-42A2052D8119"}, {"vulnerable": true, "criteria": "cpe:2.3:a:elastic:elasticsearch:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.0.0", "versionEndExcluding": "7.9.2", "matchCriteriaId": "5DED6D55-3847-464C-B649-69DC899CCF4E"}]}]}], "references": [{"url": "https://discuss.elastic.co/t/elastic-stack-7-9-3-and-6-8-13-security-update/253033", "source": "bressers@elastic.co", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20201123-0001/", "source": "bressers@elastic.co", "tags": ["Third Party Advisory"]}, {"url": "https://staging-website.elastic.co/community/security/", "source": "bressers@elastic.co", "tags": ["Permissions Required", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2020-7020 - Elasticsearch query vulnerability allows an attacker to disclose sensitive data. This can be used for reconnaissance and potentially lead to privilege escalation."}, {"techniqueID": "T1087", "comment": "CVE-2020-7020 - Elasticsearch query vulnerability can be used to bypass access controls and disclose sensitive data. This can be used to gain unauthorized access to resources."}, {"techniqueID": "T1190", "comment": "CVE-2020-7020 - Elasticsearch query vulnerability can be used to discover and exploit sensitive data. This can be used for later exploitation."}], "stix_bundle": {"id": "CVE-2020-7020-STIX-Bundle-1.0", "type": "STIX-Bundle", "description": "A STIX 2.1 bundle representing the analyzed vulnerability CVE-2020-7020.", "objects": {"vulnerability": {"id": "CVE-2020-7020", "type": "vulnerability", "name": "Elasticsearch Query Vulnerability", "description": "Elasticsearch versions before 6.8.13 and 7.9.2 contain a document disclosure flaw when Document or Field Level Security is used.", "affected_resources": [{"id": "Elasticsearch", "type": "software", "name": "Elasticsearch"}], "attacks": [{"id": "Exploit", "type": "attack-pattern", "name": "Exploit the vulnerability"}], "actions": [{"id": "Exploit the vulnerability", "type": "action", "name": "Exploit the vulnerability"}], "mitigations": [{"id": "Update to a non-vulnerable version", "type": "mitigation", "name": "Update to a non-vulnerable version"}], "related_objects": [{"id": "MITRE-ATT-CK-T1027", "type": "attack-pattern", "name": "T1027: Query in the Process", "relationship": "related-to"}, {"id": "MITRE-ATT-CK-T1087", "type": "attack-pattern", "name": "T1087: Exploit Public-Facing Application", "relationship": "related-to"}, {"id": "MITRE-ATT-CK-T1190", "type": "attack-pattern", "name": "T1190: Exploit Client Remote Desktop Connection", "relationship": "related-to"}]}}}, "technical_analysis": {"Introduction": "Elasticsearch query vulnerability allows an attacker to disclose sensitive data.", "Impact and Scope": "The vulnerability has a base score of 3.1 and an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "T1027, T1087, and T1190 are related to this vulnerability.", "Technical Details": "The vulnerability is due to a flaw in the query execution logic.", "Detection": "Detection involves monitoring for suspicious queries.", "Mitigation": "Mitigation involves updating to a non-vulnerable version and monitoring for suspicious queries.", "Conclusion": "The vulnerability is a critical issue that needs to be addressed."}, "executive_analysis": {"Overview": "Elasticsearch query vulnerability allows an attacker to disclose sensitive data.", "Business Impact": "The vulnerability has a significant business impact due to the potential loss of sensitive data.", "Technical Impact": "The vulnerability has a significant technical impact due to the potential abuse of sensitive data.", "Mitigation Strategies": "Updating to a non-vulnerable version and monitoring for suspicious queries is highly recommended.", "Recommendations": "It is recommended that executives prioritize the remediation of this vulnerability.", "Conclusions": "The vulnerability is a critical issue that needs to be addressed urgently."}}