{"id": "CVE-2020-13386", "sourceIdentifier": "cve@mitre.org", "published": "2020-05-27T13:15:12.000", "lastModified": "2020-06-01T19:57:49.817", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In SmartDraw 2020 27.0.0.0, the installer gives inherited write permissions to the Authenticated Users group on the SmartDraw 2020 installation folder. Additionally, when the product is installed, two scheduled tasks are created on the machine, SDMsgUpdate (Local) and SDMsgUpdate (TE). The scheduled tasks run in the context of the user who installed the product. Both scheduled tasks attempt to run the same binary, C:\\SmartDraw 2020\\Messages\\SDNotify.exe. The folder Messages doesn't exist by default and (by extension) neither does SDNotify.exe. Due to the weak folder permissions, these can be created by any user. A malicious actor can therefore create a malicious SDNotify.exe binary, and have it automatically run, whenever the user who installed the product logs on to the machine. The malicious SDNotify.exe could, for example, create a new local administrator account on the machine."}, {"lang": "es", "value": "En SmartDraw versi\u00f3n 2020 27.0.0.0, el instalador otorga permisos de escritura heredados al grupo Authenticated Users en la carpeta de instalaci\u00f3n de SmartDraw 2020. Adem\u00e1s, cuando el producto es instalado, son creadas dos tareas programadas en la m\u00e1quina, SDMsgUpdate (Local) y SDMsgUpdate (TE). Las tareas programadas se ejecutan en el contexto del usuario que instal\u00f3 el producto. Ambas tareas programadas intentan ejecutar el mismo binario, C:\\SmartDraw 2020\\Messages\\SDNotify.exe. La carpeta Messages no existe por defecto y (por extensi\u00f3n) tampoco el archivo SDNotify.exe. Debido a los permisos d\u00e9biles de la carpeta, estos pueden ser creados por cualquier usuario. Por lo tanto, un actor malicioso puede crear un binario SDNotify.exe malicioso y hacer que se ejecute autom\u00e1ticamente, siempre y cuando el usuario que instal\u00f3 el producto se conecte a la m\u00e1quina. El SDNotify.exe malicioso podr\u00eda, por ejemplo, crear una nueva cuenta de administrador local en el equipo."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.3, "impactScore": 5.9}], "cvssMetricV30": [{"source": "cve@mitre.org", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.5, "impactScore": 6.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.4}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-732"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:smartdraw:smartdraw_2020:27.0.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "5C3A3178-EA09-4611-83D0-036FAB7F829F"}]}]}], "references": [{"url": "https://improsec.com/tech-blog/how-not-do-handle-responsible-disclosure-smartdraw-2020", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-13386 - This technique is relevant as it allows a malicious user to create a rogue binary that will run with the permissions of the user who installed the product. This is a prime example of a Windows privilege escalation technique."}, {"techniqueID": "T1046", "comment": "CVE-2020-13386 - This technique is relevant as it allows a malicious user to create a scheduled task that can be used to run malicious code. This is a prime example of a Windows privilege escalation technique."}, {"techniqueID": "T1210", "comment": "CVE-2020-13386 - This technique is relevant as it allows a malicious user to create a new local administrator account. This is a prime example of a Windows privilege escalation technique."}, {"techniqueID": "T1140", "comment": "CVE-2020-13386 - This technique is relevant as it allows a malicious user to create a rogue file that will run with the permissions of the user who installed the product. This is a prime example of a Windows privilege escalation technique."}], "stix_bundle": {"$schema": "https://docs.oasis-open.org/cti/stix/2.1/stix-core-v2.1.xsd", "type": "bundle", "id": "SmartDraw 2020 27.0.0.0 CVE-2020-13386", "spec_version": "2.1", "created_by": " Your Name", "created": "now", "description": "SmartDraw 2020 27.0.0.0 CVE-2020-13386", "objects": [{"type": "vulnerability", "id": "SmartDraw 2020 27.0.0.0", "name": "SmartDraw 2020 27.0.0.0", "description": "In SmartDraw 2020 27.0.0.0, the installer gives inherited write permissions to the Authenticated Users group on the SmartDraw 2020 installation folder.", "reliability": "high", "cvss_score": 7.3, "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H", "references": [{"id": "https://improsec.com/tech-blog/how-not-do-handle-responsible-disclosure-smartdraw-2020", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}]}, {"type": "course-of-action", "id": "Patch and Update", "name": "Patch and Update", "description": "Apply the patch and update the installation to the latest version.", "techniques": [{"type": "attack-pattern", "id": "T1190", "name": "Exploit Public-Facing Application"}]}, {"type": "course-of-action", "id": "Implement Proper Folder Permissions", "name": "Implement Proper Folder Permissions", "description": "Implement proper folder permissions to prevent unauthorized access.", "techniques": [{"type": "attack-pattern", "id": "T1046", "name": "Execution through file execution"}]}, {"type": "course-of-action", "id": "Disable Scheduled Tasks", "name": "Disable Scheduled Tasks", "description": "Disable the scheduled tasks created by the product to prevent malicious code from running.", "techniques": [{"type": "attack-pattern", "id": "T1046", "name": "Execution through file execution"}]}], "relationships": [{"type": "related-to", "id": "SmartDraw 2020 27.0.0.0", "target_id": "Patch and Update", "target_ref": "#course-of-action--Patch-and-Update"}, {"type": "related-to", "id": "SmartDraw 2020 27.0.0.0", "target_id": "Implement Proper Folder Permissions", "target_ref": "#course-of-action--Implement-Proper-Folder-Permissions"}, {"type": "related-to", "id": "SmartDraw 2020 27.0.0.0", "target_id": "Disable Scheduled Tasks", "target_ref": "#course-of-action--Disable-Scheduled-Tasks"}]}, "technical_analysis": {"Introduction": "The CVE-2020-13386 vulnerability in SmartDraw 2020 27.0.0.0 allows an attacker to create a rogue binary that will run with the permissions of the user who installed the product.", "Impact and Scope": "The attacker can create a new local administrator account and run arbitrary code on the system with elevated privileges.", "Related MITRE ATT&CK Techniques": "T1190, T1046, T1210, T1140", "Technical Details": "The vulnerability occurs due to weak folder permissions and scheduled tasks created by the product.", "Detection": "Detection methods include monitoring for suspicious file creation and execution, as well as monitoring for changes to the Windows Registry.", "Mitigation": "Mitigation strategies include patching and updating the product, implementing proper folder permissions, and disabling scheduled tasks.", "Conclusion": "In conclusion, the CVE-2020-13386 vulnerability in SmartDraw 2020 27.0.0.0 is a significant threat that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2020-13386 vulnerability in SmartDraw 2020 27.0.0.0 poses a significant risk to system security and requires immediate attention.", "Business Impact": "The vulnerability could result in a loss of sensitive data, system compromise, and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to create a rogue binary that will run with the permissions of the user who installed the product.", "Mitigation Strategies": "Patch and update the product, implement proper folder permissions, and disable scheduled tasks.", "Recommendations": "Implement robust security measures to prevent attacks and monitor for suspicious activity.", "Conclusions": "The CVE-2020-13386 vulnerability in SmartDraw 2020 27.0.0.0 is a critical issue that requires immediate attention and mitigation."}}