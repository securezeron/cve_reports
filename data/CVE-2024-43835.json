{"id": "CVE-2024-43835", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-17T10:15:09.183", "lastModified": "2024-09-08T08:15:12.870", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nvirtio_net: Fix napi_skb_cache_put warning\n\nAfter the commit bdacf3e34945 (\"net: Use nested-BH locking for\nnapi_alloc_cache.\") was merged, the following warning began to appear:\n\n\t WARNING: CPU: 5 PID: 1 at net/core/skbuff.c:1451 napi_skb_cache_put+0x82/0x4b0\n\n\t  __warn+0x12f/0x340\n\t  napi_skb_cache_put+0x82/0x4b0\n\t  napi_skb_cache_put+0x82/0x4b0\n\t  report_bug+0x165/0x370\n\t  handle_bug+0x3d/0x80\n\t  exc_invalid_op+0x1a/0x50\n\t  asm_exc_invalid_op+0x1a/0x20\n\t  __free_old_xmit+0x1c8/0x510\n\t  napi_skb_cache_put+0x82/0x4b0\n\t  __free_old_xmit+0x1c8/0x510\n\t  __free_old_xmit+0x1c8/0x510\n\t  __pfx___free_old_xmit+0x10/0x10\n\nThe issue arises because virtio is assuming it's running in NAPI context\neven when it's not, such as in the netpoll case.\n\nTo resolve this, modify virtnet_poll_tx() to only set NAPI when budget\nis available. Same for virtnet_poll_cleantx(), which always assumed that\nit was in a NAPI context."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: virtio_net: corrige la advertencia de napi_skb_cache_put Despu\u00e9s de que se fusion\u00f3 el commit bdacf3e34945 (\"net: Use bloqueo de BH anidado para napi_alloc_cache.\"), comenz\u00f3 a aparecer la siguiente advertencia: ADVERTENCIA: CPU: 5 PID: 1 en net/core/skbuff.c:1451 napi_skb_cache_put+0x82/0x4b0 __warn+0x12f/0x340 napi_skb_cache_put+0x82/0x4b0 napi_skb_cache_put+0x82/0x4b0 report_bug+0x165/0x370 x80 exc_invalid_op+0x1a/0x50 asm_exc_invalid_op+ 0x1a/0x20 __free_old_xmit+0x1c8/0x510 napi_skb_cache_put+0x82/0x4b0 __free_old_xmit+0x1c8/0x510 __free_old_xmit+0x1c8/0x510 __pfx___free_old_xmit+0x10/0x10 El problema surge porque virtio asumiendo que se est\u00e1 ejecutando en el contexto NAPI incluso cuando no lo es, como en netpoll caso. Para resolver esto, modifique virtnet_poll_tx() para configurar NAPI solo cuando haya presupuesto disponible. Lo mismo ocurre con virtnet_poll_cleantx(), que siempre asumi\u00f3 que estaba en un contexto NAPI."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/468a729b78895893d0e580ceea49bed8ada2a2bd", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6b5325f2457521bbece29499970c0117a648c620", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f5e9a22d19bb98a7e86034db85eb295e94187caa", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f8321fa75102246d7415a6af441872f6637c93ab", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "This vulnerability could be exploited by an attacker to execute code or gain unauthorized access to the affected system, which could potentially lead to data theft, data destruction, or unauthorized access. To defend against this, it is recommended to keep software up-to-date, use reputable security software, and regular security scans."}, {"techniqueID": "T1210: Exploit Use of Encrypted Channels", "comment": "An attacker could potentially exploit this vulnerability to leverage a valid certificate and establish a connection with the affected system, which could lead to a man-in-the-middle attack or data theft. To defend against this, it is recommended to validate the authenticity of certificates and encrypt data."}, {"techniqueID": "T1055: Input Injection", "comment": "An attacker could inject malicious data into the affected system, potentially leading to code execution, data theft, or unauthorized access. To defend against this, it is recommended to sanitize and validate input data, and implement strict input validation."}], "stix_bundle": {"type": "bundle", "objects": [{"type": "observable", "id": "obj-1", "value": "CVE-2024-43835"}, {"type": "report", "id": "rep-1", "published": "2024-08-17T10:15:09.183", "last_modified": "2024-09-08T08:15:12.870", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nvirtio_net: Fix napi_skb_cache_put warning", "referenced_by": "obj-1"}, {"type": "attack-pattern", "id": "ap-1", "name": "Exploit Public-Facing Application", "description": "Exploit a public-facing application to gain unauthorized access or execute code", "objects": [{"type": "related_to", "id": "rel-1", "from": "obj-1", "to": "ap-1"}]}, {"type": "course-of-action", "id": "coa-1", "title": "Apply patch", "description": "Apply the patch to resolve the vulnerability", "mitigates": [{"type": "mitigates", "id": "rel-2", "from": "ap-1", "to": "coa-1"}]}], "relationships": [{"type": "related_to", "id": "rel-3", "from": "coa-1", "to": "rep-1"}]}, "technical_analysis": {"Introduction": "The Linux kernel vulnerabilities CVE-2024-43835 affect the virtio_net module, allowing an attacker to execute code or gain unauthorized access.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to execute code or gain unauthorized access. The scope of this vulnerability is limited to the Linux kernel, specifically the virtio_net module.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are Exploit Public-Facing Application (T1190), Exploit Use of Encrypted Channels (T1210), and Input Injection (T1055).", "Technical Details": "The vulnerability arises because virtio is assuming it's running in NAPI context even when it's not, such as in the netpoll case. To resolve this, modify virtnet_poll_tx() to only set NAPI when budget is available.", "Detection": "Detection methods include monitoring system logs for suspicious activity, scanning the system for vulnerable software, and using threat intelligence feeds.", "Mitigation": "Mitigation strategies include applying the patch, disabling network traffic, and isolating the affected system.", "Conclusion": "The vulnerability CVE-2024-43835 is a critical issue that requires immediate attention. Applying the patch and implementing mitigation strategies can help protect against this vulnerability."}, "executive_analysis": {"Overview": "The Linux kernel vulnerability CVE-2024-43835 is a critical issue that affects the virtio_net module, allowing an attacker to execute code or gain unauthorized access.", "Business Impact": "The impact of this vulnerability is significant, as it could lead to data theft, data destruction, or unauthorized access.", "Technical Impact": "The technical impact of this vulnerability is high, as it allows an attacker to execute code or gain unauthorized access.", "Mitigation Strategies": "Mitigation strategies include applying the patch, disabling network traffic, and isolating the affected system.", "Recommendations": "Recommendations include conducting a thorough vulnerability assessment, applying the patch, and implementing mitigation strategies.", "Conclusions": "The vulnerability CVE-2024-43835 is a critical issue that requires immediate attention. Applying the patch and implementing mitigation strategies can help protect against this vulnerability."}}