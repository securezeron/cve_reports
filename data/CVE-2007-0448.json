{"id": "CVE-2007-0448", "sourceIdentifier": "cve@mitre.org", "published": "2007-05-24T18:30:00.000", "lastModified": "2008-09-11T00:49:19.397", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The fopen function in PHP 5.2.0 does not properly handle invalid URI handlers, which allows context-dependent attackers to bypass safe_mode restrictions and read arbitrary files via a file path specified with an invalid URI, as demonstrated via the srpath URI."}, {"lang": "es", "value": "La funci\u00f3n fopen del PHP 5.2.0 no maneja adecuadamente agentes URI inv\u00e1lidos, lo que permite a atacantes dependientes del contexto evitar las restricciones del modo seguro y leer ficheros de su elecci\u00f3n a trav\u00e9s de la especificaci\u00f3n de una ruta de fichero con un URI no v\u00e1lido, como lo demostrado a trav\u00e9s de la URI srpath."}], "vendorComments": [{"organization": "Mandriva", "comment": "Due to the nature of safe_mode and open_basedir restrictions, and in alignment with the PHP group\u2019s stance on these features, Mandriva does not consider this a security issue.", "lastModified": "2007-09-21T00:00:00"}, {"organization": "Red Hat", "comment": "We do not consider these to be security issues.  For more details see http://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=169857#c1\nand http://www.php.net/security-note.php\n", "lastModified": "2007-05-29T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.2.0:*:*:*:*:*:*:*", "matchCriteriaId": "CD02D837-FD28-4E0F-93F8-25E8D1C84A99"}]}]}], "references": [{"url": "http://securityreason.com/achievement_securityalert/44", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://securityreason.com/securityalert/2175", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/22261", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2007-0448 - An attacker can exploit a vulnerable PHP 5.2.0 fopen function, bypassing safe_mode restrictions and reading arbitrary files. Defend against this by implementing secure coding practices and restricting file access."}, {"techniqueID": "T1059.003", "comment": "CVE-2007-0448 - An attacker can exploit a vulnerable PHP 5.2.0 fopen function, bypassing safe_mode restrictions and reading arbitrary files. Defend against this by implementing secure coding practices and restricting file access."}], "stix_bundle": {"description": "STIX Bundle for CVE-2007-0448", "objects": [{"id": "stix:cve:CVE-2007-0448", "type": "vulnerability", "name": "PHP Open Fopen Vulnerability", "description": "The fopen function in PHP 5.2.0 does not properly handle invalid URI handlers, which allows context-dependent attackers to bypass safe_mode restrictions and read arbitrary files via a file path specified with an invalid URI, as demonstrated via the srpath URI.", "published": "2007-05-24T18:30:00.000", "modified": "2008-09-11T00:49:19.397", "references": [{"id": "stix:reference:http://securityreason.com/achievement_securityalert/44", "type": "reference", "source": "cve@mitre.org", "description": "Exploit for CVE-2007-0448"}], "affiliations": [{"id": "stix:affiliation:php", "type": "affiliation", "entity": "stix:entity:php"}], " relations": [{"type": "exploited_by", "id": "stix:exploitation:CVE-2007-0448-exploit", "object_label": "Exploit for CVE-2007-0448"}]}, {"id": "stix:technique:T1210", "type": "technique", "name": "Bypass Safe Mode Restrictions", "description": "Attempt to bypass safe mode restrictions to gain unauthorized access to sensitive information.", "published": "2007-05-24T18:30:00.000", "modified": "2008-09-11T00:49:19.397", "mitigations": [{"id": "stix:mitigation:secure_coding_practices", "type": "mitigation", "description": "Implement secure coding practices to prevent bypassing safe mode restrictions."}], "cqa": [{"id": "stix:cqa:CVE-2007-0448-cqa", "type": "course_of_action", "name": "Implement secure coding practices", "description": "Implement secure coding practices to prevent bypassing safe mode restrictions."}]}]}, "technical_analysis": {"Introduction": "The PHP fopen function in version 5.2.0 is vulnerable to a bypass safe mode restrictions attack, which allows an attacker to read arbitrary files.", "Impact and Scope": "The vulnerability has a CVSS score of 10.0, with an attack vector of NETWORK, and an impact of COMPLETE on CONFIDENTIALITY, INTEGRITY, and AVAILABILITY.", "Related MITRE ATT&CK Techniques": "T1210: Bypass Safe Mode Restrictions", "Technical Details": "The vulnerabilty occurs when the fopen function is used with an invalid URI handler, allowing the attacker to bypass safe mode restrictions and read arbitrary files.", "Detection": "Detection of this attack involves monitoring for unusual file access patterns and implementing secure coding practices.", "Mitigation": "Mitigation strategies include implementing secure coding practices, restricting file access, and using alternative file access mechanisms.", "Conclusion": "The PHP fopen function in version 5.2.0 is vulnerable to a bypass safe mode restrictions attack, which allows an attacker to read arbitrary files."}, "executive_analysis": {"Overview": "The PHP fopen function in version 5.2.0 is vulnerable to a bypass safe mode restrictions attack, which allows an attacker to read arbitrary files.", "Business Impact": "This vulnerability can result in unauthorized access to sensitive information, which can have a significant impact on business operations and reputation.", "Technical Impact": "The vulnerability has a technical impact on the PHP ecosystem, requiring immediate attention and mitigation.", "Mitigation Strategies": "Implementing secure coding practices, restricting file access, and using alternative file access mechanisms can mitigate this vulnerability.", "Recommendations": "It is recommended that PHP 5.2.0 be upgraded to a secure version and that secure coding practices be implemented.", "Conclusions": "The PHP fopen function in version 5.2.0 is vulnerable to a bypass safe mode restrictions attack, which allows an attacker to read arbitrary files. Immediate attention and mitigation are required to prevent unauthorized access to sensitive information."}}