{"id": "CVE-2024-29973", "sourceIdentifier": "security@zyxel.com.tw", "published": "2024-06-04T02:15:48.290", "lastModified": "2024-08-02T02:15:17.533", "vulnStatus": "Awaiting Analysis", "cveTags": [{"sourceIdentifier": "security@zyxel.com.tw", "tags": ["unsupported-when-assigned"]}], "descriptions": [{"lang": "en", "value": "** UNSUPPORTED WHEN ASSIGNED **\nThe command injection vulnerability in the \u201csetCookie\u201d parameter in Zyxel NAS326 firmware versions before V5.21(AAZF.17)C0 and NAS542 firmware versions before\u00a0V5.21(ABAG.14)C0 could allow an unauthenticated attacker to execute some operating system (OS) commands by sending a crafted HTTP POST request."}, {"lang": "es", "value": "** NO SOPORTADO CUANDO S ASIGN\u00d3 ** La vulnerabilidad de inyecci\u00f3n de comando en el par\u00e1metro \u201csetCookie\u201d en las versiones de firmware Zyxel NAS326 anteriores a V5.21(AAZF.17)C0 y en las versiones de firmware NAS542 anteriores a V5.21(ABAG.14)C0 podr\u00eda permitir una atacante ejecutar algunos comandos del sistema operativo (SO) enviando una solicitud HTTP POST manipulada."}], "metrics": {"cvssMetricV31": [{"source": "security@zyxel.com.tw", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@zyxel.com.tw", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "references": [{"url": "https://outpost24.com/blog/zyxel-nas-critical-vulnerabilities/", "source": "security@zyxel.com.tw"}, {"url": "https://www.zyxel.com/global/en/support/security-advisories/zyxel-security-advisory-for-multiple-vulnerabilities-in-nas-products-06-04-2024", "source": "security@zyxel.com.tw"}], "techniques": [{"techniqueID": "T1505 - SecurityOrchestrations", "comment": "CVE-2024-29973 - This vulnerability allows an unauthenticated attacker to execute OS commands, which could lead to a security orchestration to access the system. Defend against this by configuring Web Application Firewalls to block suspicious requests."}, {"techniqueID": "T1190 - ExploitPublicFacingApplication", "comment": "CVE-2024-29973 - This vulnerability allows an attacker to exploit the NAS device by sending a crafted HTTP POST request, exploiting the setCookie parameter. Defend against this by configuring the device to only allow trusted IP addresses and whitelisting allowed HTTP requests."}, {"techniqueID": "T1083 - File and Directory Discovery", "comment": "CVE-2024-29973 - This vulnerability allows an attacker to execute arbitrary OS commands, which could lead to file and directory discovery. Defend against this by limiting the permissions of the web server and configuring the device to only allow access to necessary files."}, {"techniqueID": "T1078 - Exploitation of Remote Services", "comment": "CVE-2024-29973 - This vulnerability allows an attacker to exploit the NAS device by sending a crafted HTTP POST request, exploiting the setCookie parameter. Defend against this by configuring the device to only allow trusted IP addresses and whitelisting allowed HTTP requests."}], "technical_analysis": {"Introduction": "On June 4th, 2024, Zyxel released a security advisory for multiple vulnerabilities in their NAS products, including a command injection vulnerability in the setCookie parameter of the \u201csetCookie\u201d protocol.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8, with a maximum severity rating of CRITICAL. It allows an unauthenticated attacker to execute OS commands, which could lead to a range of impacts including data breaches, data destruction, and system compromise.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are SecurityOrchestrations, ExploitPublicFacingApplication, File and Directory Discovery, and Exploitation of Remote Services.", "Technical Details": "The vulnerability is caused by a command injection in the setCookie parameter of the \u201csetCookie\u201d protocol. An attacker can exploit this vulnerability by sending a crafted HTTP POST request to the vulnerable device.", "Detection": "Detection of this vulnerability involves monitoring network traffic for suspicious requests, such as those containing crafted HTTP POST requests with the setCookie parameter.", "Mitigation": "Mitigation strategies for this vulnerability include configuring the device to only allow trusted IP addresses, whitelisting allowed HTTP requests, limiting the permissions of the web server, and configuring the device to only allow access to necessary files.", "Conclusion": "In conclusion, the CVE-2024-29973 vulnerability is a critical vulnerability that requires immediate attention. It is essential to implement mitigation strategies and monitor networks for suspicious activity to prevent exploitation."}, "executive_analysis": {"Overview": "Zyxel released a security advisory for multiple vulnerabilities in their NAS products, including a command injection vulnerability in the setCookie parameter of the \u201csetCookie\u201d protocol.", "Business Impact": "This vulnerability has a significant business impact, as it allows an attacker to execute OS commands, which could lead to data breaches, data destruction, and system compromise.", "Technical Impact": "The technical impact of this vulnerability is severe, as it allows an attacker to gain access to the system and execute arbitrary commands.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include configured trusted IP addresses, whitelisting allowed HTTP requests, limiting the permissions of the web server, and configuring the device to only allow access to necessary files.", "Recommendations": "Recommendations for executives include prioritizing the patching of vulnerable devices, implementing network monitoring for suspicious activity, and conducting regular vulnerability assessments.", "Conclusions": "In conclusion, the CVE-2024-29973 vulnerability is a critical vulnerability that requires immediate attention. It is essential to implement mitigation strategies and monitor networks for suspicious activity to prevent exploitation."}}