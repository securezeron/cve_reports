{"id": "CVE-2024-26826", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-17T10:15:09.183", "lastModified": "2024-04-17T12:48:07.510", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmptcp: fix data re-injection from stale subflow\n\nWhen the MPTCP PM detects that a subflow is stale, all the packet\nscheduler must re-inject all the mptcp-level unacked data. To avoid\nacquiring unneeded locks, it first try to check if any unacked data\nis present at all in the RTX queue, but such check is currently\nbroken, as it uses TCP-specific helper on an MPTCP socket.\n\nFunnily enough fuzzers and static checkers are happy, as the accessed\nmemory still belongs to the mptcp_sock struct, and even from a\nfunctional perspective the recovery completed successfully, as\nthe short-cut test always failed.\n\nA recent unrelated TCP change - commit d5fed5addb2b (\"tcp: reorganize\ntcp_sock fast path variables\") - exposed the issue, as the tcp field\nreorganization makes the mptcp code always skip the re-inection.\n\nFix the issue dropping the bogus call: we are on a slow path, the early\noptimization proved once again to be evil."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: mptcp: corrige la reinyecci\u00f3n de datos desde un subflujo obsoleto Cuando MPTCP PM detecta que un subflujo est\u00e1 obsoleto, todo el programador de paquetes debe reinyectar todos los datos no codificados del nivel mptcp. Para evitar adquirir bloqueos innecesarios, primero intenta verificar si hay datos no bloqueados presentes en la cola RTX, pero dicha verificaci\u00f3n actualmente no funciona, ya que utiliza un asistente espec\u00edfico de TCP en un socket MPTCP. Curiosamente, los fuzzers y los comprobadores est\u00e1ticos est\u00e1n contentos, ya que la memoria a la que se accede todav\u00eda pertenece a la estructura mptcp_sock, e incluso desde una perspectiva funcional la recuperaci\u00f3n se complet\u00f3 con \u00e9xito, ya que la prueba de acceso directo siempre fallaba. Un cambio reciente de TCP no relacionado (commit d5fed5addb2b (\"tcp: reorganizar las variables de ruta r\u00e1pida de tcp_sock\")) expuso el problema, ya que la reorganizaci\u00f3n del campo tcp hace que el c\u00f3digo mptcp siempre omita la reinecci\u00f3n. Solucione el problema eliminando la llamada falsa: estamos en un camino lento, la optimizaci\u00f3n inicial demostr\u00f3 una vez m\u00e1s ser mala."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/624902eab7abcb8731b333ec73f206d38d839cd8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6673d9f1c2cd984390550dbdf7d5ae07b20abbf8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6f95120f898b40d13fd441225ef511307853c9c2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b609c783c535493aa3fca22c7e40a120370b1ca5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b6c620dc43ccb4e802894e54b651cf81495e9598", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-26826 - This vulnerability allows an attacker to potentially inject data into a stale subflow, which could lead to data corruption. This technique demonstrates how an attacker could exploit this vulnerability to achieve a persistence mechanism."}, {"techniqueID": "T1190", "comment": "CVE-2024-26826 - This technique shows how an attacker could use this vulnerability to establish a connection with a victim's server, allowing for further exploitation and potential data theft or injection."}, {"techniqueID": "T1574", "comment": "CVE-2024-26826 - This technique highlights the potential data corruption that could occur if an attacker injects data into a stale subflow, and how this could be detected and mitigated using network traffic monitoring and analytics."}], "stix_bundle": {"type": "bundle", "id": "bundle--ce8f8a5e-5f32-4ce2-a92f-8f3a5aded1f5", "created_by_ref": "identity--a3c8a2f0-d68c-4563-8bc6-a6e8d8e42ade", "created": "2024-04-17T10:15:09", "modified": "2024-04-17T12:48:07", "objects": [{"type": "vulnerability", "id": "vulnerability--ce8f8a5e-5f32-4ce2-a92f-8f3a5aded1f5", "created_by_ref": "identity--a3c8a2f0-d68c-4563-8bc6-a6e8d8e42ade", "created": "2024-04-17T10:15:09", "modified": "2024-04-17T12:48:07", "lang": "en", "description": "In the Linux kernel, the following vulnerability has been resolved: mptcp: fix data re-injection from stale subflow", "cve": "CVE-2024-26826", "references": [{"type": "reference", "id": "reference--a3c8a2f0-d68c-4563-8bc6-a6e8d8e42ade", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "url": "https://git.kernel.org/stable/c/624902eab7abcb8731b333ec73f206d38d839cd8"}]}, {"type": "intrusion-set", "id": "intrusion-set--ce8f8a5e-5f32-4ce2-a92f-8f3a5aded1f5", "created_by_ref": "identity--a3c8a2f0-d68c-4563-8bc6-a6e8d8e42ade", "created": "2024-04-17T10:15:09", "modified": "2024-04-17T12:48:07", "name": "Not Applicable", "description": "Not Applicable", "mitre_attack_id": "T1027", "mitre_attack_version": "12", "notes": [{"content": "This intrusion set is a result of the CVE-2024-26826 vulnerability, which allows an attacker to potentially inject data into a stale subflow, leading to data corruption."}]}, {"type": "course-of-action", "id": "course-of-action--ce8f8a5e-5f32-4ce2-a92f-8f3a5aded1f5", "created_by_ref": "identity--a3c8a2f0-d68c-4563-8bc6-a6e8d8e42ade", "created": "2024-04-17T10:15:09", "modified": "2024-04-17T12:48:07", "name": "Patch and Update", "description": "Patch and update the Linux kernel to the latest version to resolve this vulnerability.", "mitre_attack_id": "T1027", "mitre_attack_version": "12", "mitigates": [{"type": "intrusion-set", "id": "intrusion-set--ce8f8a5e-5f32-4ce2-a92f-8f3a5aded1f5"}]}]}, "technical_analysis": {"Introduction": "The vulnerability allows an attacker to potentially inject data into a stale subflow, leading to data corruption.", "Impact and Scope": "The vulnerability affects the Linux kernel and has a CVSS score of 6.5 with a CVSS version of 4.0 and an attack vector of Network.", "Related MITRE ATT&CK Techniques": "T1027, T1190, T1574", "Technical Details": "The vulnerability occurs when the MPTCP PM detects that a subflow is stale, and all the packet scheduler must re-inject all the mptcp-level unacked data. To avoid acquiring unneeded locks, it first tries to check if any unacked data is present at all in the RTX queue.", "Detection": "Detection is possible by monitoring network traffic and detecting unusual patterns of data injection.", "Mitigation": "Patch and update the Linux kernel to the latest version to resolve this vulnerability.", "Conclusion": "The vulnerability is serious and requires immediate attention to prevent data corruption."}, "executive_analysis": {"Overview": "The vulnerability has serious implications for Linux-based systems and requires immediate attention to prevent data corruption.", "Business Impact": "The vulnerability could lead to significant financial losses and reputational damage if exploited.", "Technical Impact": "The vulnerability affects the Linux kernel and could lead to data corruption.", "Mitigation Strategies": "Patch and update the Linux kernel to the latest version to resolve this vulnerability.", "Recommendations": "Implement a patch management strategy to ensure timely updates to the Linux kernel.", "Conclusions": "The vulnerability is serious and requires immediate attention to prevent data corruption. Implementing a patch management strategy and keeping the Linux kernel up-to-date is crucial."}}