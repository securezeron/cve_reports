{"id": "CVE-2024-42296", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-17T09:15:10.080", "lastModified": "2024-08-19T12:59:59.177", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: fix return value of f2fs_convert_inline_inode()\n\nIf device is readonly, make f2fs_convert_inline_inode()\nreturn EROFS instead of zero, otherwise it may trigger\npanic during writeback of inline inode's dirty page as\nbelow:\n\n f2fs_write_single_data_page+0xbb6/0x1e90 fs/f2fs/data.c:2888\n f2fs_write_cache_pages fs/f2fs/data.c:3187 [inline]\n __f2fs_write_data_pages fs/f2fs/data.c:3342 [inline]\n f2fs_write_data_pages+0x1efe/0x3a90 fs/f2fs/data.c:3369\n do_writepages+0x359/0x870 mm/page-writeback.c:2634\n filemap_fdatawrite_wbc+0x125/0x180 mm/filemap.c:397\n __filemap_fdatawrite_range mm/filemap.c:430 [inline]\n file_write_and_wait_range+0x1aa/0x290 mm/filemap.c:788\n f2fs_do_sync_file+0x68a/0x1ae0 fs/f2fs/file.c:276\n generic_write_sync include/linux/fs.h:2806 [inline]\n f2fs_file_write_iter+0x7bd/0x24e0 fs/f2fs/file.c:4977\n call_write_iter include/linux/fs.h:2114 [inline]\n new_sync_write fs/read_write.c:497 [inline]\n vfs_write+0xa72/0xc90 fs/read_write.c:590\n ksys_write+0x1a0/0x2c0 fs/read_write.c:643\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xf5/0x240 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: f2fs: corrige el valor de retorno de f2fs_convert_inline_inode() Si el dispositivo es de solo lectura, haga que f2fs_convert_inline_inode() devuelva EROFS en lugar de cero; de lo contrario, puede provocar p\u00e1nico durante la reescritura de la p\u00e1gina sucia del inodo en l\u00ednea como se muestra a continuaci\u00f3n : f2fs_write_single_data_page+0xbb6/0x1e90 fs/f2fs/data.c:2888 f2fs_write_cache_pages fs/f2fs/data.c:3187 [en l\u00ednea] __f2fs_write_data_pages fs/f2fs/data.c:3342 [en l\u00ednea] efe/0x3a90 fs/f2fs/ data.c:3369 do_writepages+0x359/0x870 mm/page-writeback.c:2634 filemap_fdatawrite_wbc+0x125/0x180 mm/filemap.c:397 __filemap_fdatawrite_range mm/filemap.c:430 [en l\u00ednea] file_write_and_wait_range+0x1aa/0x290 mm/filemap .c:788 f2fs_do_sync_file+0x68a/0x1ae0 fs/f2fs/file.c:276 generic_write_sync include/linux/fs.h:2806 [en l\u00ednea] f2fs_file_write_iter+0x7bd/0x24e0 fs/f2fs/file.c:4977 call_write_iter include/linux/ fs.h:2114 [en l\u00ednea] new_sync_write fs/read_write.c:497 [en l\u00ednea] vfs_write+0xa72/0xc90 fs/read_write.c:590 ksys_write+0x1a0/0x2c0 fs/read_write.c:643 do_syscall_x64 arch/x86/entry/ common.c:52 [en l\u00ednea] do_syscall_64+0xf5/0x240 arch/x86/entry/common.c:83 Entry_SYSCALL_64_after_hwframe+0x77/0x7f"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/077f0e24b27c4b44841593c7edbd1993be9eecb5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/1e7725814361c8c008d131db195cef8274ff26b8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/47a8ddcdcaccd9b891db4574795e46a33a121ac2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/70f5ef5f33c333cfb286116fa3af74ac9bc84f1b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/a8eb3de28e7a365690c61161e7a07a4fc7c60bbf", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1007.001", "comment": "CVE-2024-42296 - A Linux kernel vulnerability in f2fs allows an attacker to trigger a use-after-free vulnerability, which can lead to privilege escalation. This is relevant because it allows an attacker to escalate privileges and gain control of the system."}, {"techniqueID": "T1190", "comment": "CVE-2024-42296 - An attacker can exploit this vulnerability to execute arbitrary code on a Linux system, potentially leading to system compromise. This is relevant because it allows an attacker to gain persistence on the system."}, {"techniqueID": "T1204.001", "comment": "CVE-2024-42296 - An attacker can use this vulnerability to inject malicious code into a Linux system, potentially leading to data exfiltration. This is relevant because it allows an attacker to exfiltrate sensitive data."}], "stix_bundle": {"stix_version": "2.1", "objects": {"vulnerability": {"id": "CVE-2024-42296", "created_by_ref": "https://example.com/stix/some.bundle", "modified": "2024-08-19T12:59:59.177", "name": "Linux kernel f2fs use-after-free vulnerability", "description": "A use-after-free vulnerability in the f2fs filesystem allows an attacker to escalate privileges and gain control of the system.", "cve_ref": "CVE-2024-42296", "vulnerability_type": "Vulnerability"}, "intrusion-set": {"id": "IS-1", "created_by_ref": "https://example.com/stix/some.bundle", "modified": "2024-08-19T12:59:59.177", "name": "Linux kernel f2fs attack", "description": "An attacker exploits a use-after-free vulnerability in the f2fs filesystem to escalate privileges and gain control of the system.", "relationship_types": ["related_to"], "related_to_ref": "CVE-2024-42296"}, "course-of-action": {"id": "COA-1", "created_by_ref": "https://example.com/stix/some.bundle", "modified": "2024-08-19T12:59:59.177", "name": "Patch the system to fix the vulnerability", "description": "Apply the latest patches to the Linux kernel to fix the f2fs vulnerability and prevent exploitation.", "related_to_ref": "T1007.001"}, "note": {"id": "NOTE-1", "created_by_ref": "https://example.com/stix/some.bundle", "modified": "2024-08-19T12:59:59.177", "name": "f2fs vulnerability defense", "description": "Use a combination of secure coding practices and defense mechanisms, such as memory protection, to prevent exploitation of the f2fs vulnerability.", "related_to_ref": "T1190"}}, "relationships": [{"source_ref": "CVE-2024-42296", "relationship_type": "related_to", "target_ref": "T1007.001"}, {"source_ref": "CVE-2024-42296", "relationship_type": "related_to", "target_ref": "T1190"}, {"source_ref": "CVE-2024-42296", "relationship_type": "related_to", "target_ref": "T1204.001"}, {"source_ref": "IS-1", "relationship_type": "related_to", "target_ref": "CVE-2024-42296"}, {"source_ref": "COA-1", "relationship_type": "related_to", "target_ref": "T1007.001"}, {"source_ref": "NOTE-1", "relationship_type": "related_to", "target_ref": "T1190"}]}, "technical_analysis": {"Introduction": "The Linux kernel f2fs vulnerability allows an attacker to escalate privileges and gain control of the system by exploiting a use-after-free vulnerability.", "Impact and Scope": "The vulnerability is classified as a high-risk vulnerability, with a CVSS score of 9.8 (CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H).", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1007.001, T1190, and T1204.001.", "Technical Details": "The vulnerability is caused by a use-after-free vulnerability in the f2fs filesystem, which allows an attacker to escalate privileges and gain control of the system.", "Detection": "Detection is challenging, but can be achieved by monitoring system logs for suspicious activity and using intrusion detection systems to identify attempts to exploit the vulnerability.", "Mitigation": "The vulnerability can be mitigated by applying the latest patches to the Linux kernel, as well as by implementing secure coding practices and defense mechanisms.", "Conclusion": "In conclusion, the Linux kernel f2fs vulnerability is a high-risk vulnerability that can be exploited to gain control of the system. It is essential to apply the latest patches to the Linux kernel and implement secure coding practices and defense mechanisms to prevent exploitation."}, "executive_analysis": {"Overview": "The Linux kernel f2fs vulnerability is a serious security flaw that allows an attacker to gain control of the system.", "Business Impact": "The vulnerability has the potential to compromise sensitive data and disrupt business operations if exploited.", "Technical Impact": "The vulnerability allows an attacker to escalate privileges and gain control of the system, which can lead to unauthorized access to sensitive data and systems.", "Mitigation Strategies": "Apply the latest patches to the Linux kernel, implement secure coding practices and defense mechanisms, and conduct regular security audits and testing.", "Recommendations": "Recommendations include applying the latest patches to the Linux kernel, implementing secure coding practices and defense mechanisms, and conducting regular security audits and testing.", "Conclusions": "In conclusion, the Linux kernel f2fs vulnerability is a serious security flaw that requires immediate attention and mitigation strategies to prevent exploitation."}}