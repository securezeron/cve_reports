{"id": "CVE-2024-6730", "sourceIdentifier": "cna@vuldb.com", "published": "2024-07-14T02:15:03.420", "lastModified": "2024-07-15T13:00:34.853", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability was found in Nanjing Xingyuantu Technology SparkShop up to 1.1.6. It has been rated as critical. This issue affects some unknown processing of the file /api/Common/uploadFile. The manipulation of the argument file leads to unrestricted upload. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. The associated identifier of this vulnerability is VDB-271403."}, {"lang": "es", "value": "Se encontr\u00f3 una vulnerabilidad en Nanjing Xingyuantu Technology SparkShop hasta 1.1.6. Ha sido calificada como cr\u00edtica. Este problema afecta un procesamiento desconocido del archivo /api/Common/uploadFile. La manipulaci\u00f3n del archivo de argumentos conduce a una carga sin restricciones. El ataque puede iniciarse de forma remota. El exploit ha sido divulgado al p\u00fablico y puede utilizarse. El identificador asociado de esta vulnerabilidad es VDB-271403."}], "metrics": {"cvssMetricV40": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "attackVector": "NETWORK", "attackComplexity": "LOW", "attackRequirements": "NONE", "privilegesRequired": "LOW", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "LOW", "vulnerableSystemIntegrity": "LOW", "vulnerableSystemAvailability": "LOW", "subsequentSystemConfidentiality": "NONE", "subsequentSystemIntegrity": "NONE", "subsequentSystemAvailability": "NONE", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NOT_DEFINED", "recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED", "baseScore": 5.3, "baseSeverity": "MEDIUM"}}], "cvssMetricV31": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-434"}]}], "references": [{"url": "https://github.com/J1rrY-learn/learn/blob/main/sparkshop_upload.md", "source": "cna@vuldb.com"}, {"url": "https://vuldb.com/?ctiid.271403", "source": "cna@vuldb.com"}, {"url": "https://vuldb.com/?id.271403", "source": "cna@vuldb.com"}, {"url": "https://vuldb.com/?submit.374047", "source": "cna@vuldb.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-6730 - Unrestricted File Upload vulnerability allows an attacker to inject malicious code, likely as part of a larger watering hole attack. Defenders should focus on limiting file upload functionality, validating user input, and monitoring for malicious activity."}, {"techniqueID": "T1046", "comment": "CVE-2024-6730 - Network exploitation of the vulnerability allows an attacker to inject malicious code, potentially leading to further exploitation. Defenders should focus on network segmentation, monitoring for suspicious traffic, and implementing strict access controls."}, {"techniqueID": "T1192", "comment": "CVE-2024-6730 - Server-side request forgery (SSRF) vulnerability allows an attacker to inject malicious code, potentially leading to further exploitation. Defenders should focus on validating user input, monitoring for suspicious traffic, and implementing strict access controls."}], "stix_bundle": {"bundle": {"$id": "https://example.com/cve-2024-6730-bundle", "type": "bundle", "objects": [{"id": "https://example.com/cve-2024-6730", "type": "vulnerability", "name": "CVE-2024-6730", "description": "Unrestricted File Upload vulnerability in Nanjing Xingyuantu Technology SparkShop", "severity": "MEDIUM", "vulnerability-type": "UNAUTHENTICATED", "cvss": {"score": 6.3, "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L"}, "references": [{"url": "https://github.com/J1rrY-learn/learn/blob/main/sparkshop_upload.md", "source": "cna@vuldb.com"}, {"url": "https://vuldb.com/?ctiid.271403", "source": "cna@vuldb.com"}]}, {"id": "https://example.com/t1190-technique", "type": "attack-pattern", "name": "Unrestricted File Upload", "description": "Allows an attacker to inject malicious code", "kill-chain": "Phases: Identify|Reconnaissance|Exploit|Obtain|Pivot", " Mitre-ATT&CK": ["T1190"]}, {"id": "https://example.com/t1046-technique", "type": "attack-pattern", "name": "Network Exploitation", "description": "Allows an attacker to inject malicious code", "kill-chain": "Phases: Identify|Reconnaissance|Exploit|Obtain|Pivot", " Mitre-ATT&CK": ["T1046"]}, {"id": "https://example.com/t1192-technique", "type": "attack-pattern", "name": "Server-Side Request Forgery", "description": "Allows an attacker to inject malicious code", "kill-chain": "Phases: Identify|Reconnaissance|Exploit|Obtain|Pivot", " Mitre-ATT&CK": ["T1192"]}]}}, "technical_analysis": {"Introduction": "This file upload vulnerability in SparkShop may allow an attacker to inject malicious code, which could lead to further exploitation.", "Impact and Scope": "The vulnerability has a base CVSS score of 6.3 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L) and applies to SparkShop versions up to 1.1.6.", "Related MITRE ATT&CK Techniques": "The vulnerability may be exploited using T1190: Unrestricted File Upload, T1046: Network Exploitation, and T1192: Server-Side Request Forgery.", "Technical Details": "The vulnerability allows an attacker to upload malicious files to the /api/Common/uploadFile endpoint.", "Detection": "Detection of this vulnerability may include monitoring for suspicious traffic, analyzing network logs, and monitoring system files for modifications.", "Mitigation": "Mitigation strategies may include restricting file uploads, validating user input, and implementing strict access controls.", "Conclusion": "This vulnerability has a medium severity and applies to SparkShop versions up to 1.1.6. Defenders should focus on limiting file upload functionality, validating user input, and monitoring for suspicious activity."}, "executive_analysis": {"Overview": "SparkShop has a medium-severity file upload vulnerability that may allow an attacker to inject malicious code.", "Business Impact": "The vulnerability may lead to further exploitation, potentially affecting business operations and customer data.", "Technical Impact": "The vulnerability has a base CVSS score of 6.3 and applies to SparkShop versions up to 1.1.6.", "Mitigation Strategies": "Restricting file uploads, validating user input, and implementing strict access controls are recommended.", "Recommendations": "Executives should require a plan for addressing this vulnerability and consider updating to a patched version of SparkShop.", "Conclusions": "This vulnerability highlights the importance of robust security measures and regular updates to prevent exploitation."}}