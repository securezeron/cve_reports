{"id": "CVE-2024-36420", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-01T16:15:04.377", "lastModified": "2024-07-03T15:29:45.557", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Flowise is a drag & drop user interface to build a customized large language model flow. In version 1.4.3 of Flowise, the `/api/v1/openai-assistants-file` endpoint in `index.ts` is vulnerable to arbitrary file read due to lack of sanitization of the `fileName` body parameter. No known patches for this issue are available."}, {"lang": "es", "value": "Flowise es una interfaz de usuario de arrastrar y soltar para crear un flujo de modelo de lenguaje grande personalizado. En la versi\u00f3n 1.4.3 de Flowise, el endpoint `/api/v1/openai-assistants-file` en `index.ts` es vulnerable a la lectura arbitraria de archivos debido a la falta de sanitizaci\u00f3n del par\u00e1metro del cuerpo `fileName`. No hay parches conocidos disponibles para este problema."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-74"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:flowiseai:flowise:1.4.3:*:*:*:*:*:*:*", "matchCriteriaId": "46DEFB82-D429-4A21-A963-B9DD1EB58AD5"}]}]}], "references": [{"url": "https://github.com/FlowiseAI/Flowise/blob/e93ce07851cdc0fcde12374f301b8070f2043687/packages/server/src/index.ts#L982", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://securitylab.github.com/advisories/GHSL-2023-232_GHSL-2023-234_Flowise/", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2024-36420 - File Access Vulnerability, an Initial Access technique which can be used by attackers to gain unauthorized access to files and directories"}, {"techniqueID": "TA0008", "comment": "CVE-2024-36420 - Command and Scripting Interfacing, a tactic used to execute arbitrary code and scripts on a target system"}, {"techniqueID": "TA0009", "comment": "CVE-2024-36420 - Web Shelling, a technique used to upload and execute malicious files on a target system"}], "stix_bundle": {"@type": "bundle", "description": "STIX 2.1 bundle for CVE-2024-36420", "id": "https://example.com/cve-2024-36420", "name": "STIX 2.1 bundle for CVE-2024-36420", "objects": [{"@type": "indicator", "description": "Arbitrary file read vulnerability in Flowise", "id": " indicaor-Flowise-Vulnerability", "name": "Flowise Vulnerability"}, {"@type": "incident", "description": "Flowise Vulnerability Exploitation", "id": "incident-Flowise-Vulnerability-Exploitation", "name": "Flowise Vulnerability Exploitation"}, {"@type": "tactic", "description": "Execution of arbitrary code and scripts on a target system", "id": "tactic-Execution-of-Arbitrary-Code", "name": "Execution of Arbitrary Code"}], "relationships": [{"from": "indicator-Flowise-Vulnerability", "relationship": "related_to", "to": "incident-Flowise-Vulnerability-Exploitation"}, {"from": "incident-Flowise-Vulnerability-Exploitation", "relationship": "invokes", "to": "tactic-Execution-of-Arbitrary-Code"}]}, "technical_analysis": {"Introduction": "Flowise is a drag & drop user interface to build a customized large language model flow. In version 1.4.3 of Flowise, the `/api/v1/openai-assistants-file` endpoint in `index.ts` is vulnerable to arbitrary file read due to lack of sanitization of the `fileName` body parameter.", "Impact and Scope": "The vulnerability is rated as high severity (CVSS 7.5) and allows an attacker to read arbitrary files on the system, which can be used to extract sensitive information or disrupt system operations.", "Related MITRE ATT&CK Techniques": "TA0001: Initial Access, TA0008: Command and Scripting Interfacing, and TA0009: Web Shelling", "Technical Details": "The vulnerability occurs due to the lack of sanitization of the `fileName` body parameter in the `/api/v1/openai-assistants-file` endpoint in `index.ts`. An attacker can send a malicious request to this endpoint, specifying a file path, to read any file on the system.", "Detection": "Detection involves monitoring the Flowise API for suspicious requests and analyzing the file paths being accessed.", "Mitigation": "Apply patches, restrict access to sensitive files and directories, and implement input validation and sanitization for file paths.", "Conclusion": "Flowise vulnerability (CVE-2024-36420) is a high-severity vulnerability that allows arbitrary file read, which can be used to extract sensitive information or disrupt system operations. It is recommended to apply patches, restrict access to sensitive files and directories, and implement input validation and sanitization for file paths to mitigate this vulnerability."}, "executive_analysis": {"Overview": "Flowise has a vulnerability in its 1.4.3 version that allows arbitrary file read, which can be used to extract sensitive information or disrupt system operations.", "Business Impact": "The vulnerability has a high business impact as it allows unauthorized access to sensitive files and directories, which can compromise sensitive business information.", "Technical Impact": "The vulnerability has a high technical impact as it allows an attacker to read arbitrary files on the system, which can disrupt system operations and compromise sensitive information.", "Mitigation Strategies": "Apply patches, restrict access to sensitive files and directories, and implement input validation and sanitization for file paths.", "Recommendations": "Upgrade to a patched version of Flowise, restrict access to sensitive files and directories, and implement input validation and sanitization for file paths.", "Conclusions": "Flowise vulnerability (CVE-2024-36420) is a high-severity vulnerability that requires immediate attention and mitigation to prevent unauthorized access to sensitive files and directories."}}