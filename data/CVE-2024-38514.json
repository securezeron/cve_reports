{"id": "CVE-2024-38514", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-28T19:15:06.530", "lastModified": "2024-07-01T12:37:24.220", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "NextChat is a cross-platform ChatGPT/Gemini UI. There is a Server-Side Request Forgery (SSRF) vulnerability due to a lack of validation of the `endpoint` GET parameter on the WebDav API endpoint. This SSRF can be used to perform arbitrary HTTPS request from the vulnerable instance (MKCOL, PUT and GET methods supported), or to target NextChat users and make them execute arbitrary JavaScript code in their browser. This vulnerability has been patched in version 2.12.4.\n"}, {"lang": "es", "value": "NextChat es una interfaz de usuario ChatGPT/Gemini multiplataforma. Existe una vulnerabilidad de Server-Side Request Forgery (SSRF) debido a la falta de validaci\u00f3n del par\u00e1metro GET \"endpoint\" en el endpoint de la API WebDav. Este SSRF se puede utilizar para realizar solicitudes HTTPS arbitrarias desde la instancia vulnerable (se admiten m\u00e9todos MKCOL, PUT y GET), o para dirigirse a los usuarios de NextChat y hacer que ejecuten c\u00f3digo JavaScript arbitrario en su navegador. Esta vulnerabilidad ha sido parcheada en la versi\u00f3n 2.12.4."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-918"}]}], "references": [{"url": "https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web/commit/dad122199a85c2f12277593973e1784b212adf5e", "source": "security-advisories@github.com"}, {"url": "https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web/security/advisories/GHSA-gph5-rx77-3pjg", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "This SSRF vulnerability allows an attacker to perform arbitrary HTTPS requests, making it a prime target for reconnaissance and lateral movement. Patching to version 2.12.4 is the recommended mitigation."}, {"techniqueID": "T1218", "comment": "The lack of input validation on the `endpoint` GET parameter makes it susceptible to SSRF attacks, allowing attackers to target users and make them execute arbitrary JavaScript code. Implementing proper input validation is crucial for defense."}, {"techniqueID": "T1194", "comment": "The vulnerability also enables an attacker to target NextChat users and make them execute arbitrary JavaScript code in their browser. This highlights the importance of keeping software and plugins up-to-date and patching vulnerabilities promptly."}, {"techniqueID": "T1567", "comment": "The arbitrary HTTPS request capability can be used to enable command and control (C2) communications, making it essential to monitor network traffic and implement measures to detect and block malicious activities."}, {"techniqueID": "T1497", "comment": "The attacker can leverage the SSRF vulnerability to perform reconnaissance and gather information about the internal network, making it essential to implement a robust network segmentation strategy."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "urn:uuid:12345678-1234-1234-1234-123456789012", "created_by_ref": "urn:uuid:12345678-1234-1234-1234-123456789012", "modified": "2024-07-01T12:37:24.220", "objects": [{"type": "indicator", "id": "urn:uuid:12345678-1234-1234-1234-123456789012", "name": "NextChat SSRF Vulnerability", "description": "This indicator represents the NextChat SSRF vulnerability", "created_by_ref": "urn:uuid:12345678-1234-1234-1234-123456789012", "modified": "2024-07-01T12:37:24.220", "url": "https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web/commit/dad122199a85c2f12277593973e1784b212adf5e", "confidence": 90, "valid_from": "2024-06-28T19:15:06.530", "valid_until": "2024-07-01T12:37:24.220"}, {"type": "course-of-action", "id": "urn:uuid:12345678-1234-1234-1234-123456789012", "name": "Update to version 2.12.4", "description": "Update to the latest version to patch the vulnerability", "created_by_ref": "urn:uuid:12345678-1234-1234-1234-123456789012", "modified": "2024-07-01T12:37:24.220"}, {"type": "tactic", "id": "urn:uuid:12345678-1234-1234-1234-123456789012", "name": "Initial Access", "description": "This tactic represents initial access gained through SSRF vulnerability"}, {"type": "note", "id": "urn:uuid:12345678-1234-1234-1234-123456789012", "name": "Defense Tip", "description": "Monitor network traffic andImplement measures to detect and block malicious activities"}], "relationships": [{"type": "has", "id": "urn:uuid:12345678-1234-1234-1234-123456789012", "object_ref": "urn:uuid:12345678-1234-1234-1234-123456789012"}, {"type": "related_to", "id": "urn:uuid:12345678-1234-1234-1234-123456789012", "object_ref": "urn:uuid:12345678-1234-1234-1234-123456789012"}]}}, "technical_analysis": {"Introduction": "The NextChat SSRF vulnerability is a critical issue that can allow attackers to perform arbitrary HTTPS requests, targeting users and executing arbitrary JavaScript code.", "Impact and Scope": "CVSS 3.1 score: 7.4. Attack vector: NETWORK. Confidentiality impact: HIGH. Integrity impact: HIGH. Attack complexity: HIGH. Privileges required: NONE.", "Related MITRE ATT&CK Techniques": "T1190, T1218, T1194, T1567, T1497", "Technical Details": "The vulnerability is due to a lack of input validation on the `endpoint` GET parameter in the WebDav API endpoint. This allows an attacker to target users and make them execute arbitrary JavaScript code in their browser.", "Detection": "Monitor network traffic for suspicious requests, implement measures to detect and block malicious activities.", "Mitigation": "Update to the latest version (2.12.4) and implement proper input validation.", "Conclusion": "The NextChat SSRF vulnerability is a critical issue that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The NextChat SSRF vulnerability is a critical issue that can allow attackers to perform arbitrary HTTPS requests, targeting users and executing arbitrary JavaScript code.", "Business Impact": "This vulnerability can lead to data breaches, unauthorized access, and potential financial losses.", "Technical Impact": "The vulnerability affects the security and integrity of the application.", "Mitigation Strategies": "Update to the latest version (2.12.4), implement proper input validation, and monitor network traffic for suspicious requests.", "Recommendations": "Implement robust vulnerability management, conduct regular security assessments, and maintain software and plugin updates.", "Conclusions": "The NextChat SSRF vulnerability is a critical issue that requires immediate attention and mitigation."}}