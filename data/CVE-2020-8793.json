{"id": "CVE-2020-8793", "sourceIdentifier": "cve@mitre.org", "published": "2020-02-25T17:15:13.103", "lastModified": "2023-11-07T03:26:45.373", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "OpenSMTPD before 6.6.4 allows local users to read arbitrary files (e.g., on some Linux distributions) because of a combination of an untrusted search path in makemap.c and race conditions in the offline functionality in smtpd.c."}, {"lang": "es", "value": "OpenSMTPD versiones anteriores a 6.6.4, permite a usuarios locales leer archivos arbitrarios (por ejemplo, en algunas distribuciones de Linux) debido a una combinaci\u00f3n de una ruta de b\u00fasqueda no confiable en el archivo makemap.c y unas condiciones de carrera en la funcionalidad offline en el archivo smtpd.c."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:C/I:N/A:N", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.7}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 6.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-367"}, {"lang": "en", "value": "CWE-426"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:opensmtpd:opensmtpd:*:*:*:*:*:*:*:*", "versionEndExcluding": "6.6.4", "matchCriteriaId": "AE4076E6-F78B-421A-BFE1-35E326B88753"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*", "matchCriteriaId": "36D96259-24BD-44E2-96D9-78CE1D41F956"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*", "matchCriteriaId": "23A7C53F-B80F-4E6A-AFA9-58EEA84BE11D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:19.10:*:*:*:*:*:*:*", "matchCriteriaId": "A31C8344-3E02-4EB8-8BD8-4C84B7959624"}]}]}], "references": [{"url": "http://seclists.org/fulldisclosure/2020/Feb/28", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2020/02/24/4", "source": "cve@mitre.org", "tags": ["Exploit", "Mailing List", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/OPH4QU4DNVHA7ACFXMYFCEP5PSXXPN4E/", "source": "cve@mitre.org"}, {"url": "https://usn.ubuntu.com/4294-1/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.openbsd.org/security.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2020-8793 - Local file reading vulnerability in OpenSMTPD. This technique is relevant as it allows an attacker to read arbitrary files on the system, potentially leading to privilege escalation."}, {"techniqueID": "T1040", "comment": "OpenSMTPD provides offline functionality, which can be exploited by an attacker to read arbitrary files. This technique is relevant as it allows an attacker to execute arbitrary code on the system."}, {"techniqueID": "T1190", "comment": "The combination of an untrusted search path in makemap.c and race conditions in smtpd.c can be exploited by an attacker to read arbitrary files. This technique is relevant as it allows an attacker to execute arbitrary code on the system."}, {"techniqueID": "T1222", "comment": "The vulnerability in OpenSMTPD can be exploited by an attacker to gain system privileges. This technique is relevant as it allows an attacker to execute arbitrary code on the system with elevated permissions."}], "stix_bundle": {"objects": {"vulnerability": {"id": "CVE-2020-8793", "cvss": {"vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N", "baseScore": 4.7}, "description": "OpenSMTPD before 6.6.4 allows local users to read arbitrary files (e.g., on some Linux distributions) because of a combination of an untrusted search path in makemap.c and race conditions in the offline functionality in smtpd.c.", "references": [{"source": "cve@mitre.org", "url": "http://seclists.org/fulldisclosure/2020/Feb/28"}]}}, "relationship": {"technique": {"type": "related-to", "object_id": "T1027", "relationship_id": "replaces", "object": {"id": "T1027", "name": "Remote File Copy", "description": "This technique involves copying a file from a remote location to the local system."}}}}, "technical_analysis": {"Introduction": "The CVE-2020-8793 vulnerability in OpenSMTPD is a local file reading vulnerability that allows an attacker to read arbitrary files on the system.", "Impact and Scope": "This vulnerability has a CVSS score of 4.7 and affects OpenSMTPD before 6.6.4. The attack vector is local and the privileges required are low.", "Related MITRE ATT&CK Techniques": ["T1027", "T1040", "T1190", "T1222"], "Technical Details": "The vulnerability is caused by a combination of an untrusted search path in makemap.c and race conditions in smtpd.c. This allows an attacker to read arbitrary files on the system.", "Detection": "Detection of this vulnerability can be performed by monitoring system calls and network traffic related to OpenSMTPD.", "Mitigation": "Mitigation of this vulnerability can be performed by updating to OpenSMTPD 6.6.4 or later and configuring the system to prevent arbitrary file reads.", "Conclusion": "The CVE-2020-8793 vulnerability in OpenSMTPD is a significant vulnerability that can allow an attacker to read arbitrary files on the system. It is important to update to the latest version and configure the system to prevent arbitrary file reads."}, "executive_analysis": {"Overview": "The CVE-2020-8793 vulnerability in OpenSMTPD is a local file reading vulnerability that can allow an attacker to read arbitrary files on the system.", "Business Impact": "This vulnerability can allow an attacker to steal sensitive information from the system, which can result in significant financial loss and damage to the organization's reputation.", "Technical Impact": "This vulnerability can allow an attacker to read arbitrary files on the system, which can result in the compromise of sensitive information and potentially lead to system breaches.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include updating to OpenSMTPD 6.6.4 or later, configuring the system to prevent arbitrary file reads, and monitoring system calls and network traffic related to OpenSMTPD.", "Recommendations": "It is recommended that organizations update to the latest version of OpenSMTPD and configure their systems to prevent arbitrary file reads to prevent exploitation of this vulnerability.", "Conclusions": "The CVE-2020-8793 vulnerability in OpenSMTPD is a significant vulnerability that can allow an attacker to read arbitrary files on the system. It is important to update to the latest version and configure the system to prevent arbitrary file reads to prevent exploitation of this vulnerability."}}