{"id": "CVE-2020-28638", "sourceIdentifier": "cve@mitre.org", "published": "2020-11-13T21:15:12.817", "lastModified": "2020-12-02T15:00:33.973", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "ask_password in Tomb 2.0 through 2.7 returns a warning when pinentry-curses is used and $DISPLAY is non-empty, causing affected users' files to be encrypted with \"tomb {W] Detected DISPLAY, but only pinentry-curses is found.\" as the encryption key."}, {"lang": "es", "value": "La funci\u00f3n ask_password en Tomb versiones 2.0 hasta 2.7, devuelve una advertencia cuando es usado pinentry-curses y $DISPLAY no est\u00e1 vac\u00edo, causando que unos archivos de unos usuarios afectados sean cifrados con \"tomb {W] Detected DISPLAY, but only pinentry-curses is found.\"&#xa0;como clave de cifrado"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-287"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:dyne:tomb:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.0", "versionEndIncluding": "2.7", "matchCriteriaId": "6053A4CA-1894-4538-9007-1D15FCACB159"}]}]}], "references": [{"url": "https://github.com/dyne/Tomb/issues/385", "source": "cve@mitre.org", "tags": ["Exploit", "Issue Tracking", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1210 - Exploit Public-Facing Application", "comment": "CVE-2020-28638 - An attacker may exploit a vulnerability in the ask_password function in Tomb, resulting in encryption of user files using a predictable key. This can be mitigated by patching the affected application and configuring it to use a secure encryption key."}, {"techniqueID": "T1190 - Exploit Reversing", "comment": "CVE-2020-28638 - An attacker may reverse-engineer the affected application to discover the encryption key used to encrypt user files. This can be mitigated by using a secure encryption key and keeping it secret."}, {"techniqueID": "T1204 - Data Encrypted for Impact", "comment": "CVE-2020-28638 - The ask_password function in Tomb encrypts user files using a predictable key, making it easier for an attacker to access the encrypted files. This can be mitigated by using a secure encryption key and storing it securely."}, {"techniqueID": "T1566 - Return Alive", "comment": "CVE-2020-28638 - An attacker may use the predictable key to encrypt files and then return them to the user, making it harder for the user to detect the attack. This can be mitigated by using a secure encryption key and detecting unusual file encryption activity."}], "stix_bundle": {"objects": [{"id": "vuln:CVE-2020-28638", "type": "vulnerability", "\u01a1i:about": "CVE-2020-28638: ask_password in Tomb 2.0 through 2.7 returns a warning when pinentry-curses is used and $DISPLAY is non-empty, causing affected users' files to be encrypted with \"tomb {W] Detected DISPLAY, but only pinentry-curses is found.\" as the encryption key.", "created": "2020-11-13T21:15:12.817", "modified": "2020-12-02T15:00:33.973", "description": "ask_password in Tomb 2.0 through 2.7 returns a warning when pinentry-curses is used and $DISPLAY is non-empty, causing affected users' files to be encrypted with \"tomb {W] Detected DISPLAY, but only pinentry-curses is found.\" as the encryption key.", "severity": "high", "cvss": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}, "references": [{"idref": "https://github.com/dyne/Tomb/issues/385", "type": "issue-tracker"}], "reported_by": [{"name": "unknown", "organization": "unknown"}]}, {"id": "tech:T1210", "type": "technique", "\u01a1i:about": "T1210: Exploit Public-Facing Application", "created": "2019-04-17T14:30:00.000", "modified": "2020-02-20T14:30:00.000", "description": "An adversary exploits a public-facing application to gain access to a system or network.", "pattern": {"id": "attack-pattern--1", "type": "attack-pattern", "\u01a1i:about": "T1210: Exploit Public-Facing Application"}}, {"id": "tech:T1190", "type": "technique", "\u01a1i:about": "T1190: Exploit Reversing", "created": "2019-04-17T14:30:00.000", "modified": "2020-02-20T14:30:00.000", "description": "An adversary uses reverse-engineering techniques to understand the functionality of an application.", "pattern": {"id": "attack-pattern--2", "type": "attack-pattern", "\u01a1i:about": "T1190: Exploit Reversing"}}, {"id": "tech:T1204", "type": "technique", "\u01a1i:about": "T1204: Data Encrypted for Impact", "created": "2019-04-17T14:30:00.000", "modified": "2020-02-20T14:30:00.000", "description": "An adversary encrypts data to make it unusable or to ensure its availability.", "pattern": {"id": "attack-pattern--3", "type": "attack-pattern", "\u01a1i:about": "T1204: Data Encrypted for Impact"}}, {"id": "tech:T1566", "type": "technique", "\u1edf:about": "T1566: Return Alive", "created": "2019-04-17T14:30:00.000", "modified": "2020-02-20T14:30:00.000", "description": "An adversary returns control to the victim system after gaining access.", "pattern": {"id": "attack-pattern--4", "type": "attack-pattern", "\u1edf:about": "T1566: Return Alive"}}], "relationship": [{"type": "vulnerability-exploited-by-technique", "idref": "vuln:CVE-2020-28638", "seealso": "tech:T1210", "description": "The CVE-2020-28638 vulnerability can be exploited using the T1210: Exploit Public-Facing Application technique."}, {"type": "vulnerability-exploited-by-technique", "idref": "vuln:CVE-2020-28638", "seealso": "tech:T1190", "description": "The CVE-2020-28638 vulnerability can be exploited using the T1190: Exploit Reversing technique."}, {"type": "vulnerability-exploited-by-technique", "idref": "vuln:CVE-2020-28638", "seealso": "tech:T1204", "description": "The CVE-2020-28638 vulnerability can be exploited using the T1204: Data Encrypted for Impact technique."}, {"type": "vulnerability-exploited-by-technique", "idref": "vuln:CVE-2020-28638", "seealso": "tech:T1566", "description": "The CVE-2020-28638 vulnerability can be exploited using the T1566: Return Alive technique."}]}, "technical_analysis": {"Introduction": "CVE-2020-28638 is a vulnerability in the ask_password function in Tomb 2.0 through 2.7, which returns a warning when pinentry-curses is used and $DISPLAY is non-empty, causing affected users' files to be encrypted with \"tomb {W] Detected DISPLAY, but only pinentry-curses is found.\" as the encryption key.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8, indicating a high level of severity. The impact is high, as it allows an attacker to access and encrypt user files.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1210: Exploit Public-Facing Application, T1190: Exploit Reversing, T1204: Data Encrypted for Impact, and T1566: Return Alive techniques.", "Technical Details": "The vulnerability is caused by the ask_password function returning a warning when pinentry-curses is used and $DISPLAY is non-empty, causing affected users' files to be encrypted with a predictable key.", "Detection": "Detection of the vulnerability can be done by monitoring for unusual file encryption activity and analyzing the encryption keys used.", "Mitigation": "Mitigation strategies include patching the affected application, configuring it to use a secure encryption key, and monitoring for unusual file encryption activity.", "Conclusion": "In conclusion, the CVE-2020-28638 vulnerability is a high-severity vulnerability that can be exploited using multiple MITRE ATT&CK techniques. It is essential to patch the affected application, configure it to use a secure encryption key, and monitor for unusual file encryption activity."}, "executive_analysis": {"Overview": "The CVE-2020-28638 vulnerability is a high-severity vulnerability in the ask_password function in Tomb 2.0 through 2.7.", "Business Impact": "The vulnerability has a significant business impact, as it allows an attacker to access and encrypt user files.", "Technical Impact": "The vulnerability has a high technical impact, as it allows an attacker to access and encrypt user files.", "Mitigation Strategies": "Mitigation strategies include patching the affected application, configuring it to use a secure encryption key, and monitoring for unusual file encryption activity.", "Recommendations": "Recommendations for executives include prioritizing patching the affected application, configuring it to use a secure encryption key, and monitoring for unusual file encryption activity.", "Conclusions": "In conclusion, the CVE-2020-28638 vulnerability is a high-severity vulnerability that requires immediate attention and mitigation."}}