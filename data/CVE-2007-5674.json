{"id": "CVE-2007-5674", "sourceIdentifier": "cve@mitre.org", "published": "2007-10-24T23:46:00.000", "lastModified": "2017-09-29T01:29:40.457", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Directory traversal vulnerability in index.php in InstaGuide Weather (aka Weather for PHP) 1.0, when magic_quotes_gpc is disabled, allows remote attackers to include and execute arbitrary local files via a .. (dot dot) in the PageName parameter."}, {"lang": "es", "value": "Vulnerabilidad de salto de directorio en index.php de InstaGuide Weather (tambi\u00e9n conocido como Weather para PHP) 1.0, cuando magic_quotes_gpc est\u00e1 deshabilitado, permite a atacantes remotos incluir y ejecutar ficheros locales de su elecci\u00f3n mediante secuencias .. (punto punto) en el par\u00e1metro PageName."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:instaguide:weather:1.0:*:*:*:*:*:*:*", "matchCriteriaId": "FC966A1B-50D5-44AD-BAAF-4DE8C7058492"}]}]}], "references": [{"url": "http://secunia.com/advisories/27305", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/26170", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/37383", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/4558", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0002", "comment": "The vulnerability in InstaGuide Weather (aka Weather for PHP) 1.0 is an example of a directory traversal vulnerability. To defend against this, implement input validation and sanitization to prevent malicious file paths from being used."}, {"techniqueID": "TA0037", "comment": "The use of magic_quotes_gpc disable option makes the application vulnerable to directory traversal. To defend against this, update the application to use a secure configuration and ensure that the magic_quotes_gpc option is not set to false."}, {"techniqueID": "TA0005", "comment": "The vulnerability in InstaGuide Weather (aka Weather for PHP) 1.0 could be exploited using a remote file inclusion attack. To defend against this, implement input validation and sanitization to prevent malicious file paths from being used."}, {"techniqueID": "TA0034", "comment": "The directory traversal vulnerability in InstaGuide Weather (aka Weather for PHP) 1.0 could be used to execute arbitrary local files. To defend against this, implement restrictions on file access and ensure that the application does not use absolute paths."}], "stix_bundle": {"version": "2.1", "type": "bundle", "objects": [{"id": "vulnerability--a5e01f63-b5e3-4f75-afe6-4437b1aef0f4", "type": "vulnerability", "created_by_ref": "identity--f6c557c9-44b6-4132-9bf5-d0bf52db8d6d", "description": "Directory traversal vulnerability in index.php in InstaGuide Weather (aka Weather for PHP) 1.0, when magic_quotes_gpc is disabled, allows remote attackers to include and execute arbitrary local files via a .. (dot dot) in the PageName parameter.", " severity": "Medium", "cvss_score": 6.8, "cvss_vector": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "weaknesses": [{"id": "weakness--6d7a50a4-a5d4-4c84-8406-4d77f9e6d2c1", "type": "weakness", "description": "CWE-22", "confidence": "High"}], "references": [{"id": "reference--5a4c4f9f-f56c-44c1-ae3b-1a9f17a74b5e", "type": "reference", "url": "http://secunia.com/advisories/27305", "name": "Secunia Advisory"}, {"id": "reference--8a3404cb-6f8a-412d-b5be-9dff55f9f6c5", "type": "reference", "url": "http://www.securityfocus.com/bid/26170", "name": "SecurityFocus Advisory"}]}, {"id": "course_of_action--27ceca4d-cf89-4e6c-a04e-1cd9c9d07d4f", "type": "course-of-action", "description": "Update the application to use a secure configuration and ensure that the magic_quotes_gpc option is not set to false", "related_techniques": [{"id": "mitre_attack--6f5a45c6-d45a-48dc-ba19-5b4f4f35c7b2", "type": "mitre_attack", "technique_id": "TA0037", "notes": "This course of action mitigates the use of magic_quotes_gpc disable option"}]}, {"id": "course_of_action--b0f2f45e-4a1b-4207-8e6a-1f1c216d67a6", "type": "course-of-action", "description": "Implement input validation and sanitization to prevent malicious file paths from being used", "related_techniques": [{"id": "mitre_attack--45f5a4c5-4c91-4f5e-8a02-23e1b0c27c4f", "type": "mitre_attack", "technique_id": "TA0002", "notes": "This course of action mitigates the directory traversal vulnerability"}]}, {"id": "indicator--4d74d56e-d4a0-4164-8c43-f4b4e25675f5", "type": "indicator", "description": "Malicious file paths in the PageName parameter", "pattern": "(([A-Za-z]:\\[^\\n]+\\/{2,3}(\\w:\\)*)|\\\\|\\/\\/)+", "related_techniques": [{"id": "mitre_attack--54a45459-4d4e-49c7-8c35-23e1b0c27c4f", "type": "mitre_attack", "technique_id": "TA0005", "notes": "This indicator detects the use of malicious file paths in the PageName parameter"}]}, {"id": "indicator--7b3f7bce-d12b-47a9-8e1e-1f1c216d67a6", "type": "indicator", "description": "Magic_quotes_gpc disable option set to false", "pattern": "magic_quotes_gpc = false", "related_techniques": [{"id": "mitre_attack--6f5a45c6-d45a-48dc-ba19-5b4f4f35c7b2", "type": "mitre_attack", "technique_id": "TA0037", "notes": "This indicator detects the use of magic_quotes_gpc disable option set to false"}]}]}, "technical_analysis": {"Introduction": "The vulnerability in InstaGuide Weather (aka Weather for PHP) 1.0 is a remote code execution vulnerability that can be exploited using a directory traversal attack.", "Impact and Scope": "The vulnerability affects InstaGuide Weather (aka Weather for PHP) 1.0 running on servers with the magic_quotes_gpc option set to false.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to TA0002, TA0037, TA0005, and TA0034.", "Technical Details": "The vulnerability occurs when a remote attacker sends a crafted PageName parameter to the index.php page, causing the server to include and execute arbitrary local files.", "Detection": "Detection involves monitoring for suspicious login attempts and unusual file access patterns.", "Mitigation": "Mitigation involves updating the application to use a secure configuration and ensuring that the magic_quotes_gpc option is not set to false.", "Conclusion": "The vulnerability in InstaGuide Weather (aka Weather for PHP) 1.0 is a serious security risk that can be exploited to gain remote code execution. It is essential to update the application to a secure configuration and monitor for suspicious activity."}, "executive_analysis": {"Overview": "The vulnerability in InstaGuide Weather (aka Weather for PHP) 1.0 is a critical security risk that can be exploited to gain remote code execution.", "Business Impact": "The vulnerability can have significant business impacts, including data breaches and loss of customer confidence.", "Technical Impact": "The vulnerability can have significant technical impacts, including exposure to remote code execution attacks.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability include updating the application to a secure configuration and monitoring for suspicious activity.", "Recommendations": "Recommendations for executives include updating the application to a secure configuration and implementing a comprehensive security program.", "Conclusions": "In conclusion, the vulnerability in InstaGuide Weather (aka Weather for PHP) 1.0 is a critical security risk that requires immediate attention and mitigation."}}