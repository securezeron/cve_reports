{"id": "CVE-2024-2339", "sourceIdentifier": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007", "published": "2024-03-08T20:15:46.170", "lastModified": "2024-03-08T21:19:43.127", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "PostgreSQL Anonymizer v1.2 contains a vulnerability  that allows a user who owns a table to elevate to superuser. A user can define a masking function for a column and place malicious code in that function. When a privileged user applies the masking rules using the static masking or the anonymous dump method, the malicious code is executed and can grant escalated privileges to the malicious user. PostgreSQL Anonymizer v1.2 does provide a protection against this risk with the restrict_to_trusted_schemas option, but that protection is incomplete. Users that don't own a table, especially masked users cannot exploit this vulnerability. The problem is resolved in v1.3."}, {"lang": "es", "value": "PostgreSQL Anonymizer v1.2 contiene una vulnerabilidad que permite a un usuario propietario de una tabla ascender a superusuario. Un usuario puede definir una funci\u00f3n de enmascaramiento para una columna y colocar c\u00f3digo malicioso en esa funci\u00f3n. Cuando un usuario privilegiado aplica las reglas de enmascaramiento mediante el enmascaramiento est\u00e1tico o el m\u00e9todo de volcado an\u00f3nimo, el c\u00f3digo malicioso se ejecuta y puede otorgar privilegios aumentados al usuario malintencionado. PostgreSQL Anonymizer v1.2 proporciona protecci\u00f3n contra este riesgo con la opci\u00f3n restrict_to_trusted_schemas, pero esa protecci\u00f3n est\u00e1 incompleta. Los usuarios que no poseen una mesa, especialmente los usuarios enmascarados, no pueden aprovechar esta vulnerabilidad. El problema se resuelve en v1.3."}], "metrics": {"cvssMetricV31": [{"source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.0, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.3, "impactScore": 6.0}]}, "weaknesses": [{"source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "https://gitlab.com/dalibo/postgresql_anonymizer/-/commit/e517b38e62e50871b04011598e73a7308bdae9d9", "source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007"}], "techniques": [{"techniqueID": "T1163", "comment": "\"CVE-2024-2339 - PostgreSQL Anonymizer v1.2 elevation of privilege vulnerability allows attackers to inject code and execute it with elevated privileges, which can be used to escalate privileges, execute arbitrary code, or access sensitive data. Mitigations include patching to version 1.3, restricting access to schemas, and implementing a robust encryption scheme. This technique is similar to the 'PostgreSQL Anonymizer Elevation of Privilege' technique in the MITRE ATT&CK framework, which involves exploiting the same vulnerability in a different manner. The 'Exploit Code Execution' technique in the MITRE ATT&CK framework is also relevant, as it involves executing exploit code to gain unauthorized access to a system. The 'Command and Control' technique is also relevant, as it involves using the elevated privileges gained through this vulnerability to execute arbitrary commands and control the system."}, {"techniqueID": "T1207", "comment": "\"CVE-2024-2339 - PostgreSQL Anonymizer v1.2 elevation of privilege vulnerability allows attackers to inject code and execute it with elevated privileges, which can be used to escalate privileges, execute arbitrary code, or access sensitive data. Mitigations include patching to version 1.3, restricting access to schemas, and implementing a robust encryption scheme. This technique is similar to the 'PostgreSQL Anonymizer Elevation of Privilege' technique in the MITRE ATT&CK framework, which involves exploiting the same vulnerability in a different manner."}, {"techniqueID": "TA0018", "comment": "\"CVE-2024-2339 - PostgreSQL Anonymizer v1.2 elevation of privilege vulnerability allows attackers to inject code and execute it with elevated privileges, which can be used to escalate privileges, execute arbitrary code, or access sensitive data. Mitigations include patching to version 1.3, restricting access to schemas, and implementing a robust encryption scheme. The 'Initial Access' technique in the MITRE ATT&CK framework is also relevant, as it involves gaining unauthorized access to a system."}], "stix_bundle": {"$schema": "https://docs.oasis-open.org/soa-rm/v1.0/soa-rm-v1.0.json", "id": "POSTGRESQL_ANONYMIZER_ELEVATION_OF_PRIVILEGE", "type": "bundle", "created_by": "CVE-2024-2339", "created": "2024-03-08T20:15:46.170", "modified": "2024-03-08T21:19:43.127", "description": {"lang": "en", "value": "POSTGRESQL_ANONYMIZER_ELEVATION_OF_PRIVILEGE"}, "objects": [{"type": "vulnerability", "id": "CVE-2024-2339", "created_by": "CVE-2024-2339", "created": "2024-03-08T20:15:46.170", "modified": "2024-03-08T21:19:43.127", "description": {"lang": "en", "value": "POSTGRESQL_ANONYMIZER_ELEVATION_OF_PRIVILEGE"}}, {"type": "threat-actor", "id": "THREAT-ACTOR_POSTGRESQL_ANONYMIZER", "created_by": "THREAT-ACTOR_POSTGRESQL_ANONYMIZER", "created": "2024-03-08T20:15:46.170", "modified": "2024-03-08T21:19:43.127", "description": {"lang": "en", "value": "THREAT-ACTOR_POSTGRESQL_ANONYMIZER"}}], "relationships": [{"type": "exploits", "id": "CVE-2024-2339\u5173\u7cfb", "created_by": "CVE-2024-2339\u5173\u7cfb", "created": "2024-03-08T20:15:46.170", "modified": "2024-03-08T21:19:43.127", "start": "CVE-2024-2339", "end": "THREAT-ACTOR_POSTGRESQL_ANONYMIZER", "relationship_type": "exploits"}]}, "technical_analysis": {"Introduction": "The CVE-2024-2339 vulnerability is a PostgreSQL Anonymizer elevation of privilege vulnerability, which allows attackers to inject code and execute it with elevated privileges.", "Impact and Scope": "This vulnerability has a CVSS severity score of 8.0 and affects PostgreSQL Anonymizer v1.2. It allows attackers to escalate privileges, execute arbitrary code, or access sensitive data.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1163, T1207, and TA0018.", "Technical Details": "The vulnerability is caused by a missing restriction on the use of table functions in PostgreSQL Anonymizer. An attacker can create a masking function and place malicious code in that function. When a privileged user applies the masking rules using the static masking or anonymous dump method, the malicious code is executed.", "Detection": "The vulnerability can be detected by monitoring for unusual database activity or by using a vulnerability scanner.", "Mitigation": "The vulnerability can be mitigated by patching to version 1.3, restricting access to schemas, and implementing a robust encryption scheme.", "Conclusion": "The CVE-2024-2339 vulnerability is a serious elevation of privilege vulnerability that can be exploited to execute arbitrary code or access sensitive data. It is essential to patch and update the PostgreSQL Anonymizer to version 1.3 to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-2339 vulnerability is a critical elevation of privilege vulnerability that can be exploited to execute arbitrary code or access sensitive data.", "Business Impact": "The vulnerability has a significant business impact, as it can be used to steal sensitive data or disrupt business operations.", "Technical Impact": "The vulnerability has a significant technical impact, as it can be used to escalate privileges, execute arbitrary code, or access sensitive data.", "Mitigation Strategies": "The mitigation strategies for the vulnerability include patching to version 1.3, restricting access to schemas, and implementing a robust encryption scheme.", "Recommendations": "It is recommended that organizations patch their PostgreSQL Anonymizer instances to version 1.3 and implement a robust encryption scheme to prevent exploitation.", "Conclusions": "In conclusion, the CVE-2024-2339 vulnerability is a critical elevation of privilege vulnerability that requires immediate attention and mitigation. Organizations should prioritize patching and updating their PostgreSQL Anonymizer instances to prevent exploitation."}}