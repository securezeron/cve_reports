{"id": "CVE-2024-22406", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-16T23:15:08.233", "lastModified": "2024-01-24T17:04:06.093", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Shopware is an open headless commerce platform. The Shopware application API contains a search functionality which enables users to search through information stored within their Shopware instance. The searches performed by this function can be aggregated using the parameters in the \u201caggregations\u201d object. The \u2018name\u2019 field in this \u201caggregations\u201d object is vulnerable SQL-injection and can be exploited using time-based SQL-queries.  This issue has been addressed and users are advised to update to Shopware 6.5.7.4. For older versions of 6.1, 6.2, 6.3 and 6.4 corresponding security measures are also available via a plugin. For the full range of functions, we recommend updating to the latest Shopware version."}, {"lang": "es", "value": "Shopware es una plataforma de comercio abierta y sin cabeza. La API de la aplicaci\u00f3n Shopware contiene una funci\u00f3n de b\u00fasqueda que permite a los usuarios buscar informaci\u00f3n almacenada en su instancia de Shopware. Las b\u00fasquedas realizadas por esta funci\u00f3n se pueden agregar utilizando los par\u00e1metros del objeto \u201caggregations\u201d. El campo 'name' en este objeto de \"aggregations\" es vulnerable a una inyecci\u00f3n SQL y puede explotarse mediante consultas SQL basadas en tiempo. Este problema se solucion\u00f3 y se recomienda a los usuarios que actualicen a Shopware 6.5.7.4. Para versiones anteriores de 6.1, 6.2, 6.3 y 6.4, las medidas de seguridad correspondientes tambi\u00e9n est\u00e1n disponibles a trav\u00e9s de un complemento. Para obtener la gama completa de funciones, recomendamos actualizar a la \u00faltima versi\u00f3n de Shopware."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 9.3, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 4.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:shopware:shopware:*:*:*:*:*:*:*:*", "versionEndExcluding": "6.5.7.4", "matchCriteriaId": "0B083B7F-D749-44B1-8C9C-2A28013E210E"}]}]}], "references": [{"url": "https://github.com/shopware/shopware/security/advisories/GHSA-qmp9-2xwj-m6m9", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059.001", "comment": "CVE-2024-22406 - This is a SQL injection vulnerability, which can be exploited using time-based SQL-queries. It's a basic inject attack where an attacker can inject malicious SQL code to extract sensitive data or perform actions such as deleting data."}, {"techniqueID": "T1190", "comment": "CVE-2024-22406 - This is a command and control attack, where an attacker can inject malicious code to perform further actions and maintain persistence on the system."}, {"techniqueID": "T1030", "comment": "CVE-2024-22406 - This is an application misuse attack, where an attacker can use the Shopware application API to inject malicious SQL queries and extract sensitive data."}, {"techniqueID": "T1027", "comment": "CVE-2024-22406 - This is an instance injection attack, where an attacker can inject malicious SQL queries to extract sensitive data or perform actions such as deleting data."}], "stix_bundle": {"@stix2_extension": {"version": "1.2"}, "stix_core": {"bundle": {"name": "Shopware SQL Injection Vulnerability", "description": [{"lang": "en", "value": "Shopware SQL Injection Vulnerability"}]}, "report": {"name": "Shopware SQL Injection Vulnerability", "description": [{"lang": "en", "value": "This is a STIX 2.1 bundle related to the CVE-2024-22406 vulnerability. It includes related techniques, risks, and defense strategies."}]}, "objects": [{"id": "shopware-sql-injection-vulnerability", "type": "vulnerability", "created_by_ref": "user:user", "created": "2024-01-16T23:15:08.233Z", "modified": "2024-01-24T17:04:06.093Z", "name": "Shopware SQL Injection Vulnerability", "description": [{"lang": "en", "value": "Shopware SQL Injection Vulnerability"}], "cve": [{"CVE_ID": "CVE-2024-22406", "references": [{"source_name": "security-advisories@github.com", "url": "https://github.com/shopware/shopware/security/advisories/GHSA-qmp9-2xwj-m6m9"}]}], "related_modules": [{"id": "t1059.001", "type": "attack-pattern", "created_by_ref": "user:user", "created": "2024-01-16T23:15:08.233Z", "modified": "2024-01-24T17:04:06.093Z", "name": "SQL Injection", "description": [{"lang": "en", "value": "SQL Injection"}]}]}]}}, "technical_analysis": {"Introduction": "The Shopware SQL Injection Vulnerability is a remote code execution vulnerability in the Shopware application API.", "Impact and Scope": "The vulnerability is rated as CVSS 3.1 / AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H and allows an attacker to inject malicious SQL code to extract sensitive data or perform actions such as deleting data.", "Related MITRE ATT&CK Techniques": "T1059.001, T1190, T1030, T1027", "Technical Details": "The vulnerability is caused by an unvalidated user input in the Shopware application API. An attacker can inject malicious SQL queries to extract sensitive data or perform actions such as deleting data.", "Detection": "Detection is difficult without proper logging and monitoring. However, suspicious activity such as unusual database queries or file modifications can be detected.", "Mitigation": "The vulnerability can be mitigated by updating to the latest version of Shopware, enabling proper logging and monitoring, and limiting access to sensitive data.", "Conclusion": "The Shopware SQL Injection Vulnerability is a critical vulnerability that can allow an attacker to extract sensitive data or perform actions such as deleting data."}, "executive_analysis": {"Overview": "The Shopware SQL Injection Vulnerability is a critical vulnerability that can allow an attacker to extract sensitive data or perform actions such as deleting data.", "Business Impact": "The vulnerability can have a significant business impact by exposing sensitive data and disrupting normal business operations.", "Technical Impact": "The vulnerability can have a significant technical impact by allowing an attacker to inject malicious SQL code and perform actions such as deleting data.", "Mitigation Strategies": "Updating to the latest version of Shopware, enabling proper logging and monitoring, and limiting access to sensitive data.", "Recommendations": "Executives should ensure that proper security measures are in place to prevent and detect such vulnerabilities.", "Conclusions": "The vulnerability is a critical issue that requires immediate attention and mitigation."}}