{"id": "CVE-2024-4267", "sourceIdentifier": "security@huntr.dev", "published": "2024-05-22T20:15:09.700", "lastModified": "2024-05-24T01:15:30.977", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A remote code execution (RCE) vulnerability exists in the parisneo/lollms-webui, specifically within the 'open_file' module, version 9.5. The vulnerability arises due to improper neutralization of special elements used in a command within the 'open_file' function. An attacker can exploit this vulnerability by crafting a malicious file path that, when processed by the 'open_file' function, executes arbitrary system commands or reads sensitive file content. This issue is present in the code where subprocess.Popen is used unsafely to open files based on user-supplied paths without adequate validation, leading to potential command injection."}, {"lang": "es", "value": "Existe una vulnerabilidad de ejecuci\u00f3n remota de c\u00f3digo (RCE) en parisneo/lollms-webui, espec\u00edficamente dentro del m\u00f3dulo 'open_file', versi\u00f3n 9.5. La vulnerabilidad surge debido a una neutralizaci\u00f3n inadecuada de elementos especiales utilizados en un comando dentro de la funci\u00f3n 'open_file'. Un atacante puede aprovechar esta vulnerabilidad creando una ruta de archivo maliciosa que, cuando se procesa mediante la funci\u00f3n 'open_file', ejecuta comandos arbitrarios del sistema o lee contenido de archivo confidencial. Este problema est\u00e1 presente en el c\u00f3digo donde subprocess.Popen se usa de manera insegura para abrir archivos basados en rutas proporcionadas por el usuario sin una validaci\u00f3n adecuada, lo que lleva a una posible inyecci\u00f3n de comandos."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.5, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-77"}]}], "references": [{"url": "https://huntr.com/bounties/5a127724-cc13-4ea6-b81f-41546a7fff81", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-4267 - This technique is used for command injection, an attacker can exploit this vulnerability by crafting a malicious file path and using subprocess.Popen to execute arbitrary system commands or read sensitive file content, a defense point is to validate user-supplied paths before using them to open files."}, {"techniqueID": "T1059", "comment": "CVE-2024-4267 - This technique is used for command execution, an attacker can exploit this vulnerability by executing arbitrary system commands or reading sensitive file content, a defense point is to restrict shell access and monitor system logs for suspicious activity."}, {"techniqueID": "T1191", "comment": "CVE-2024-4267 - This technique is used for file access, an attacker can exploit this vulnerability by accessing sensitive file content, a defense point is to implement file access controls and monitor access logs for suspicious activity."}], "stix_bundle": {"objects": [{"type": "attack-pattern", "id": "ap:ae63a01a-e3f4-4b82-b6ab-7a8ad47edf41", "created_by_ref": "identity:0a8b133b-2f3f-4ebd-8a1c-6fba1f94e4b2", "name": "Remote Code Execution Vulnerability in ParisNeo/lollms-webui", "description": "A remote code execution (RCE) vulnerability exists in the parisneo/lollms-webui, specifically within the 'open_file' module, version 9.5. An attacker can exploit this vulnerability by crafting a malicious file path that, when processed by the 'open_file' function, executes arbitrary system commands or reads sensitive file content.", "killChainPhases": ["Reconnaissance", "Initial Access", "Execution"], "modified": "2024-05-25T14:00:00.000Z"}, {"type": "indicator", "id": "ind:d8b9c34f-fdf3-42d5-9445-4e1c5ca8e7eb", "name": "ParisNeo/lollms-webui RCE Payload", "description": "The string '<path_to_payload>' is used to craft a malicious file path that, when processed by the 'open_file' function, executes arbitrary system commands or reads sensitive file content.", "pattern": " \\[\\]\\(.*('\\[\\]\\(',.*\\)\\)", "modified": "2024-05-25T14:00:00.000Z"}, {"type": "identity", "id": "identity:0a8b133b-2f3f-4ebd-8a1c-6fba1f94e4b2", "name": "NDR Team", "modified": "2024-05-25T14:00:00.000Z"}], "relationships": [{"id": "r1", "relationship_type": "related_to", "object_ref": "ap:ae63a01a-e3f4-4b82-b6ab-7a8ad47edf41"}, {"id": "r2", "relationship_type": "indicates", "object_ref": "ind:d8b9c34f-fdf3-42d5-9445-4e1c5ca8e7eb"}]}, "technical_analysis": {"Introduction": "A remote code execution vulnerability exists in the ParisNeo/lollms-webui.", "Impact and Scope": "This vulnerability has a CVSS score of 8.4, with an attack vector of LOCAL and attack complexity LOW. An attacker can exploit this vulnerability by crafting a malicious file path that, when processed by the 'open_file' function, executes arbitrary system commands or reads sensitive file content.", "Related MITRE ATT&CK Techniques": "T1190, T1059, T1191", "Technical Details": "The vulnerability arises due to improper neutralization of special elements used in a command within the 'open_file' function.", "Detection": "Detection of this vulnerability involves monitoring system logs for suspicious file access and command execution activity.", "Mitigation": "Mitigation strategies include validating user-supplied paths before using them to open files, restricting shell access, and implementing file access controls.", "Conclusion": "The ParisNeo/lollms-webui RCE vulnerability is a critical vulnerability that requires immediate attention."}, "executive_analysis": {"Overview": "The ParisNeo/lollms-webui RCE vulnerability is a critical vulnerability that can allow an attacker to execute arbitrary system commands or read sensitive file content.", "Business Impact": "This vulnerability can have significant business impacts, including the compromise of sensitive data and disruption of business operations.", "Technical Impact": "The vulnerability arises due to improper neutralization of special elements used in a command within the 'open_file' function.", "Mitigation Strategies": "Mitigation strategies include validating user-supplied paths before using them to open files, restricting shell access, and implementing file access controls.", "Recommendations": "Recommendations for executives include prioritizing vulnerability remediation, conducting regular security assessments, and implementing incident response plans.", "Conclusions": "The ParisNeo/lollms-webui RCE vulnerability is a critical vulnerability that requires immediate attention and prompt mitigation."}}