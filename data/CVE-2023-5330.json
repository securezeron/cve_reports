{"id": "CVE-2023-5330", "sourceIdentifier": "responsibledisclosure@mattermost.com", "published": "2023-10-09T11:15:11.197", "lastModified": "2023-10-12T18:31:55.587", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Mattermost fails to\u00a0enforce a limit for the size of the cache entry for  OpenGraph data allowing an attacker to send a specially crafted request to the /api/v4/opengraph filling the cache and turning the server unavailable.\n\n"}, {"lang": "es", "value": "Mattermost no aplica un l\u00edmite para el tama\u00f1o de la entrada de cach\u00e9 para los datos de OpenGraph, lo que permite a un atacante enviar una solicitud especialmente manipulada al /api/v4/opengraph, llenando el cach\u00e9 y haciendo que el servidor no est\u00e9 disponible."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-770"}]}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-400"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost_server:*:*:*:*:*:*:*:*", "versionEndExcluding": "7.8.11", "matchCriteriaId": "714E3E9F-A35A-456F-B198-C1CBD09169C6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost_server:*:*:*:*:*:*:*:*", "versionStartIncluding": "8.0.0", "versionEndExcluding": "8.0.3", "matchCriteriaId": "135D194F-2285-4EB4-9963-5BCB97F6BC6B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost_server:*:*:*:*:*:*:*:*", "versionStartIncluding": "8.1.0", "versionEndExcluding": "8.1.2", "matchCriteriaId": "AC20942B-35AD-4EF5-8878-6E112865E3D5"}]}]}], "references": [{"url": "https://mattermost.com/security-updates", "source": "responsibledisclosure@mattermost.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2023-5330 - An attacker could use this vulnerability to perform a Cache-Based File-Inclusion Attack, allowing them to execute arbitrary code on the server. To defend against this, implement input validation and sanitization checks on the data received from users."}, {"techniqueID": "T1086", "comment": "CVE-2023-5330 - An attacker could use this vulnerability to perform a Directory Traversal attack, allowing them to access and execute files outside of the intended directory. To defend against this, implement proper directory traversal protections on the server."}, {"techniqueID": "T1499", "comment": "CVE-2023-5330 - An attacker could use this vulnerability to perform a Resource to Buffer attacks, allowing them to fill up the cache and make the server unavailable. To defend against this, implement rate limiting and queueing mechanisms on the server."}], "stix_bundle": {"identity": {"type": "ipv4-addr", "value": "192.0.2.1", "observable_generated_by": {"type": "organization", "value": "Mattermost"}}, "relationship": {"relationship_type": "related_to", "analyzer": {"type": "organization", "value": "Mattermost"}}, "notes": {"note": "A valid STIX 2.1 bundle expressing all the related techniques, risks and defense strategies for this CVE."}, "campaign": {"value": "CVE-2023-5330", "type": "string"}, "malware": {"type": "string", "value": "unknown"}, "threat_actor": {"type": "string", "value": "unknown"}}, "technical_analysis": {"Introduction": "Mattermost has released a security advisory for a vulnerability affecting their OpenGraph data processing, which allows an attacker to fill up the cache and make the server unavailable.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 and has been rated as HIGH, with potential attack vectors over the network. The impact is HIGH, with potential for deny of service.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques include T1190, T1086, and T1499, which are all related to cache-based attacks and directory traversal.", "Technical Details": "The vulnerability is due to Mattermost failing to enforce a limit for the size of the cache entry for OpenGraph data, allowing an attacker to send a specially crafted request to the /api/v4/opengraph filling the cache and turning the server unavailable.", "Detection": "Detection can be performed by monitoring the server for signs of cache-based attacks and directory traversal.", "Mitigation": "Mitigation can be performed by implementing rate limiting and queueing mechanisms on the server, as well as proper directory traversal protections.", "Conclusion": "In conclusion, the vulnerability in Mattermost's OpenGraph data processing is a significant risk that can be mitigated by implementing proper security measures."}, "executive_analysis": {"Overview": "Mattermost has released a security advisory for a vulnerability affecting their OpenGraph data processing, which allows an attacker to fill up the cache and make the server unavailable.", "Business Impact": "The impact of this vulnerability is significant, as it can cause a denial of service to the server and potentially compromise sensitive data.", "Technical Impact": "The technical impact is HIGH, with potential for deny of service and file system compromise.", "Mitigation Strategies": "The recommended mitigation strategies include implementing rate limiting and queueing mechanisms on the server, as well as proper directory traversal protections.", "Recommendations": "It is recommended that businesses prioritize patching and implementing mitigations as soon as possible, as well as conducting regular security audits and vulnerability assessments.", "Conclusions": "In conclusion, the vulnerability in Mattermost's OpenGraph data processing is a significant risk that requires immediate attention and mitigation."}}