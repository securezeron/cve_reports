{"id": "CVE-2015-9097", "sourceIdentifier": "cve@mitre.org", "published": "2017-06-12T20:29:00.237", "lastModified": "2017-07-05T16:43:21.987", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The mail gem before 2.5.5 for Ruby (aka A Really Ruby Mail Library) is vulnerable to SMTP command injection via CRLF sequences in a RCPT TO or MAIL FROM command, as demonstrated by CRLF sequences immediately before and after a DATA substring."}, {"lang": "es", "value": "La mail gem versiones anteriores a 2.5.5 para Ruby (tambi\u00e9n conocida como A Really Ruby Mail Library) es vulnerable a inyecci\u00f3n de comandos SMTP mediante secuencias CRLF con el comando RCPT TO o MAIL FROM, como lo demuestran las secuencias CRLF inmediatamente antes y despu\u00e9s de una subcadena DATA."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-93"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mail_project:mail:*:*:*:*:*:ruby:*:*", "versionEndIncluding": "2.5.4", "matchCriteriaId": "99D6663F-F6E8-4892-8DD4-AAEECBEF6329"}]}]}], "references": [{"url": "http://openwall.com/lists/oss-security/2015/12/11/3", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.mbsd.jp/Whitepaper/smtpi.pdf", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/mikel/mail/commit/72befdc4dab3e6e288ce226a7da2aa474cf5be83", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/mikel/mail/pull/1097", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/rubysec/ruby-advisory-db/issues/215", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://hackerone.com/reports/137631", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://rubysec.com/advisories/mail-OSVDB-131677", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2015-9097 - Allows for command injection via CRLF sequences, which can lead to arbitrary command execution. Defend against this by validating and sanitizing input data, and implementing proper input validation and sanitization."}, {"techniqueID": "T1046", "comment": "CVE-2015-9097 - Allows for SMTP command injection, which can be used to execute arbitrary commands on the system. Defend against this by restrict access to the SMTP server, and implementing proper input validation and sanitization."}, {"techniqueID": "T1190", "comment": "CVE-2015-9097 - Allows for SMTP command injection, which can be used to execute arbitrary commands on the system. Defend against this by monitoring SMTP traffic for suspicious activity, and implementing proper input validation and sanitization."}, {"techniqueID": "TA0049", "comment": "CVE-2015-9097 - Allows for SMTP command injection, which can be used to execute arbitrary commands on the system. Defend against this by limiting shell access, and implementing proper input validation and sanitization."}, {"techniqueID": "TA0011", "comment": "CVE-2015-9097 - Allows for SMTP command injection, which can be used to execute arbitrary commands on the system. Defend against this by restricting access to sensitive data, and implementing proper input validation and sanitization."}], "stix_bundle": {"bundle": {"id": "https://cybox.mitre.org/XMLSchema/cybox_common_objects_2", "type": "Bundle", "version": "2.1", "objects": [{"id": "https://cybox.mitre.org/XMLSchema/cybox_common_objects_2/CVE-2015-9097", "type": "Vulnerability", "description": "The mail gem before 2.5.5 for Ruby (aka A Really Ruby Mail Library) is vulnerable to SMTP command injection via CRLF sequences in a RCPT TO or MAIL FROM command, as demonstrated by CRLF sequences immediately before and after a DATA substring.", "refs": [{"id": "http://openwall.com/lists/oss-security/2015/12/11/3", "type": "Reference", "category": "Mailing List"}, {"id": "http://www.mbsd.jp/Whitepaper/smtpi.pdf", "type": "Reference", "category": "Third Party Advisory"}, {"id": "https://github.com/mikel/mail/commit/72befdc4dab3e6e288ce226a7da2aa474cf5be83", "type": "Reference", "category": "Exploit"}, {"id": "https://github.com/mikel/mail/pull/1097", "type": "Reference", "category": "Issue Tracking"}, {"id": "https://github.com/rubysec/ruby-advisory-db/issues/215", "type": "Reference", "category": "Issue Tracking"}, {"id": "https://hackerone.com/reports/137631", "type": "Reference", "category": "Issue Tracking"}, {"id": "https://rubysec.com/advisories/mail-OSVDB-131677", "type": "Reference", "category": "Vendor Advisory"}], "relation": [{"type": "mitigates", "id": "https://cybox.mitre.org/XMLSchema/cybox_common_objects_2/T1059", "role": "technique"}, {"type": "mitigates", "id": "https://cybox.mitre.org/XMLSchema/cybox_common_objects_2/T1046", "role": "technique"}, {"type": "mitigates", "id": "https://cybox.mitre.org/XMLSchema/cybox_common_objects_2/T1190", "role": "technique"}, {"type": "mitigates", "id": "https://cybox.mitre.org/XMLSchema/cybox_common_objects_2/TA0049", "role": "technique"}, {"type": "mitigates", "id": "https://cybox.mitre.org/XMLSchema/cybox_common_objects_2/TA0011", "role": "technique"}]}]}}, "technical_analysis": {"Introduction": "The mail gem vulnerability allows for command injection via CRLF sequences, which can lead to arbitrary command execution.", "Impact and Scope": "The vulnerability has a CVSS score of 6.1 and an attack vector of NETWORK, and can be exploited by an unauthorized actor.", "Related MITRE ATT&CK Techniques": "T1059, T1046, T1190, TA0049, TA0011", "Technical Details": "The vulnerability is caused by a lack of input validation and sanitization, which allows an attacker to inject CRLF sequences into the SMTP command.", "Detection": "Detection involves monitoring SMTP traffic for suspicious activity and looking for CRLF sequences.", "Mitigation": "Mitigation involves validating and sanitizing input data, restricting shell access, and limiting access to sensitive data.", "Conclusion": "The mail gem vulnerability is a significant risk and should be prioritized for patching and mitigation."}, "executive_analysis": {"Overview": "The mail gem vulnerability allows for command injection via CRLF sequences, which can lead to arbitrary command execution.", "Business Impact": "The vulnerability can lead to data breaches, unauthorized access, and system compromise, which can result in financial losses and reputational damage.", "Technical Impact": "The vulnerability affects the mail gem, which is a widely used library for sending and receiving emails.", "Mitigation Strategies": "Patch the affected version of the mail gem, restrict access to the SMTP server, and implement proper input validation and sanitization.", "Recommendations": "Prioritize patching and mitigation, monitor SMTP traffic for suspicious activity, and limit access to sensitive data.", "Conclusions": "The mail gem vulnerability is a significant risk and should be prioritized for patching and mitigation."}}