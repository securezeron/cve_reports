{"id": "CVE-2024-28848", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-15T20:15:10.710", "lastModified": "2024-03-21T02:52:25.197", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "OpenMetadata is a unified platform for discovery, observability, and governance powered by a central metadata repository, in-depth lineage, and seamless team collaboration. The `\u200eCompiledRule::validateExpression` method evaluates an SpEL expression using an `StandardEvaluationContext`, allowing the expression to reach and interact with Java classes such as `java.lang.Runtime`, leading to Remote Code Execution. The `/api/v1/policies/validation/condition/<expression>` endpoint passes user-controlled data `CompiledRule::validateExpession` allowing authenticated (non-admin) users to execute arbitrary system commands on the underlaying operating system. In addition, there is a missing authorization check since `Authorizer.authorize()` is never called in the affected path and therefore any authenticated non-admin user is able to trigger this endpoint and evaluate arbitrary SpEL expressions leading to arbitrary command execution. This vulnerability was discovered with the help of CodeQL's Expression language injection (Spring) query and is also tracked as `GHSL-2023-236`. This issue may lead to Remote Code Execution and has been resolved in version 1.2.4. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "OpenMetadata es una plataforma unificada para el descubrimiento, la observabilidad y la gobernanza impulsada por un repositorio central de metadatos, un linaje profundo y una colaboraci\u00f3n fluida en equipo. El m\u00e9todo `?CompiledRule::validateExpression` eval\u00faa una expresi\u00f3n SpEL usando un `StandardEgressionContext`, permitiendo que la expresi\u00f3n alcance e interact\u00fae con clases Java como `java.lang.Runtime`, lo que lleva a la ejecuci\u00f3n remota de c\u00f3digo. El endpoint `/api/v1/policies/validation/condition/` pasa datos controlados por el usuario `CompiledRule::validateExpession`, lo que permite a los usuarios autenticados (no administradores) ejecutar comandos arbitrarios del sistema en el sistema operativo subyacente. Adem\u00e1s, falta una verificaci\u00f3n de autorizaci\u00f3n ya que `Authorizer.authorize()` nunca se llama en la ruta afectada y, por lo tanto, cualquier usuario no administrador autenticado puede activar este endpoint y evaluar expresiones SpEL arbitrarias que conduzcan a la ejecuci\u00f3n de comandos arbitrarios. Esta vulnerabilidad se descubri\u00f3 con la ayuda de la consulta de inyecci\u00f3n de lenguaje de expresi\u00f3n (Spring) de CodeQL y tambi\u00e9n se rastrea como \"GHSL-2023-236\". Este problema puede provocar la ejecuci\u00f3n remota de c\u00f3digo y se resolvi\u00f3 en la versi\u00f3n 1.2.4. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://codeql.github.com/codeql-query-help/java/java-spel-expression-injection", "source": "security-advisories@github.com"}, {"url": "https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/security/policyevaluator/CompiledRule.java#L51", "source": "security-advisories@github.com"}, {"url": "https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/security/policyevaluator/CompiledRule.java#L57", "source": "security-advisories@github.com"}, {"url": "https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-5xv3-fm7g-865r", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1059: Command and Control", "comment": "CVE-2024-28848 - This vulnerability allows remote code execution, which can be used to establish command and control channels for malicious actors."}, {"techniqueID": "T1447: Resource Transfer", "comment": "CVE-2024-28848 - An attacker can use the vulnerability to transfer malware or other payloads to the affected system."}, {"techniqueID": "T1204: User Execution", "comment": "CVE-2024-28848 - The vulnerability allows an attacker to execute code on the system, which can be leveraged for user-level exploitation."}, {"techniqueID": "T1574: Operation and Maintenance", "comment": "CVE-2024-28848 - An attacker can use the vulnerability to perform operations and maintenance tasks on the affected system, such as installing or uninstalling software."}, {"techniqueID": "T1497: Code obfuscation", "comment": "CVE-2024-28848 - An attacker can use the vulnerability to obfuscate their code, making it more difficult to detect and reverse-engineer."}], "stix_bundle": {"type": "bundle", "label": "OpenMetadata CVE-2024-28848 vulnerability", "objects": [{"id": "CVE-2024-28848", "type": "vulnerability", "name": "OpenMetadata CVE-2024-28848 vulnerability", "description": "OpenMetadata is a unified platform for discovery, observability, and governance powered by a central metadata repository, in-depth lineage, and seamless team collaboration. The `\\u200eCompiledRule::validateExpression` method evaluates an SpEL expression using an `StandardEvaluationContext`, allowing the expression to reach and interact with Java classes such as `java.lang.Runtime`, leading to Remote Code Execution. The `/api/v1/policies/validation/condition/<expression>` endpoint passes user-controlled data `CompiledRule::validateExpession` allowing authenticated (non-admin) users to execute arbitrary system commands on the underlaying operating system.", "references": [{"id": "GHSL-2023-236", "type": "reference", "relationship": "related-to", "target_id": "CVE-2024-28848"}, {"id": "security-advisories@github.com", "type": "reference", "relationship": "published-by"}]}, {"id": "T1059", "type": "attack-pattern", "name": "Command and Control", "description": "Command and Control refers to the communication and data transmission process between the attacker's command and control server and the compromised system.", "ttps": [{"id": "T1059", "type": "technique", "relationship": "uses"}]}, {"id": "T1447", "type": "attack-pattern", "name": "Resource Transfer", "description": "Resource Transfer refers to the transfer of malware or other payloads from the attacker's system to the compromised system.", "ttps": [{"id": "T1447", "type": "technique", "relationship": "uses"}]}, {"id": "T1204", "type": "attack-pattern", "name": "User Execution", "description": "User Execution refers to the action of a user executing an attacker-controlled payload, such as a malware or a Trojan.", "ttps": [{"id": "T1204", "type": "technique", "relationship": "uses"}]}, {"id": "T1574", "type": "attack-pattern", "name": "Operation and Maintenance", "description": "Operation and Maintenance refers to the activities performed by the attacker to maintain and update their presence on the compromised system.", "ttps": [{"id": "T1574", "type": "technique", "relationship": "uses"}]}, {"id": "T1497", "type": "attack-pattern", "name": "Code obfuscation", "description": "Code obfuscation refers to the process of making code difficult to understand or reverse-engineer.", "ttps": [{"id": "T1497", "type": "technique", "relationship": "uses"}]}]}, "technical_analysis": {"Introduction": "The OpenMetadata CVE-2024-28848 vulnerability is a remote code execution vulnerability in the OpenMetadata platform.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H) and allows an attacker to execute arbitrary system commands on the underlying operating system. The vulnerability is related to the way the `\\u200eCompiledRule::validateExpression` method evaluates SpEL expressions and passes user-controlled data to the `CompiledRule::validateExpession` method.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including Command and Control, Resource Transfer, User Execution, Operation and Maintenance, and Code obfuscation.", "Technical Details": "The vulnerability occurs because the `\\u200eCompiledRule::validateExpression` method does not properly validate user-controlled data, allowing an attacker to execute arbitrary system commands on the underlying operating system.", "Detection": "Detection of this vulnerability is difficult and may require advanced techniques, such as process memory analysis or network traffic analysis.", "Mitigation": "To mitigate this vulnerability, it is recommended to upgrade to the latest version of OpenMetadata (1.2.4) and to restrict access to the affected endpoint.", "Conclusion": "The OpenMetadata CVE-2024-28848 vulnerability is a serious remote code execution vulnerability that allows an attacker to execute arbitrary system commands on the underlying operating system."}, "executive_analysis": {"Overview": "The OpenMetadata CVE-2024-28848 vulnerability is a critical remote code execution vulnerability that could allow an attacker to access sensitive data or disrupt critical systems.", "Business Impact": "The vulnerability could have a significant impact on the business, including loss of productivity, damage to reputation, and financial losses.", "Technical Impact": "The vulnerability could allow an attacker to access sensitive data, disrupt critical systems, or execute arbitrary system commands, including the execution of malware or other payloads.", "Mitigation Strategies": "The recommended mitigation strategy is to upgrade to the latest version of OpenMetadata (1.2.4) and to restrict access to the affected endpoint.", "Recommendations": "Executives are recommended to take immediate action to mitigate this vulnerability by upgrading to the latest version of OpenMetadata and restricting access to the affected endpoint.", "Conclusions": "The OpenMetadata CVE-2024-28848 vulnerability is a critical vulnerability that requires immediate attention and action to mitigate the risk of exploitation."}}