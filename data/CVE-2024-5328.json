{"id": "CVE-2024-5328", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T19:16:08.627", "lastModified": "2024-07-23T19:41:49.540", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A Server-Side Request Forgery (SSRF) vulnerability exists in the lunary-ai/lunary application, specifically within the endpoint '/auth/saml/tto/download-idp-xml'. The vulnerability arises due to the application's failure to validate user-supplied URLs before using them in server-side requests. An attacker can exploit this vulnerability by sending a specially crafted request to the affected endpoint, allowing them to make unauthorized requests to internal or external resources. This could lead to the disclosure of sensitive information, service disruption, or further attacks against the network infrastructure. The issue affects the latest version of the application as of the report."}, {"lang": "es", "value": "Existe una vulnerabilidad de Server-Side Request Forgery (SSRF) en la aplicaci\u00f3n lunary-ai/lunary, espec\u00edficamente dentro del endpoint '/auth/saml/tto/download-idp-xml'. La vulnerabilidad surge debido a que la aplicaci\u00f3n no valida las URL proporcionadas por el usuario antes de usarlas en solicitudes del lado del servidor. Un atacante puede aprovechar esta vulnerabilidad enviando una solicitud especialmente manipulada al endpoint afectado, lo que le permite realizar solicitudes no autorizadas a recursos internos o externos. Esto podr\u00eda provocar la divulgaci\u00f3n de informaci\u00f3n confidencial, la interrupci\u00f3n del servicio o nuevos ataques contra la infraestructura de la red. El problema afecta a la \u00faltima versi\u00f3n de la aplicaci\u00f3n en el momento del informe."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 9.3, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 4.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 8.6, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 4.0}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-918"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:lunary:lunary:-:*:*:*:*:*:*:*", "matchCriteriaId": "01CC1BEE-0221-4740-88A5-FCDAB000D491"}]}]}], "references": [{"url": "https://huntr.com/bounties/80b09757-d9a0-44d1-932f-2461fc8fec69", "source": "security@huntr.dev", "tags": ["Exploit", "Issue Tracking", "Technical Description"]}], "techniques": [{"techniqueID": "T1204.001", "comment": "CVE-2024-5328 - This Server-Side Request Forgery (SSRF) vulnerability can be exploited using the 'Request' technique, allowing an attacker to send a specially crafted request to the affected endpoint, making unauthorized requests to internal or external resources."}, {"techniqueID": "TA0015", "comment": "CVE-2024-5328 - This vulnerability can be used as part of a Command and Control (C2) communication, where an attacker can use the SSRF vulnerability to make requests to internal or external resources, facilitating the exfiltration of sensitive data."}, {"techniqueID": "T1036.003", "comment": "CVE-2024-5328 - This SSRF vulnerability can be used as part of a Data Exfiltration using a Server method, where an attacker can make requests to external resources to exfiltrate sensitive data."}, {"techniqueID": "T1497.001", "comment": "CVE-2024-5328 - This vulnerability can be used as part of a Web Shell to exfiltrate sensitive information or make unauthorized requests to internal or external resources."}], "stix_bundle": {"bundle": {"type": "bundle", "spec_version": "2.1", "id": "https://example.com/cve-2024-5328", "created_by_ref": "https://example.com/organization", "created": "2024-07-23T19:41:49.540Z", "revoked": false, "objects": [{"type": "incident", "id": "https://example.com/cve-2024-5328/incident-1", "label": "CVE-2024-5328 Incident", "description": "A Server-Side Request Forgery (SSRF) vulnerability exists in the lunary-ai/lunary application, affecting the '/auth/saml/tto/download-idp-xml' endpoint."}, {"type": "observable", "id": "https://example.com/cve-2024-5328/observable-1", "label": "SSRF Request", "description": "A malicious SSRF request made to the affected endpoint, attempting to make unauthorized requests to internal or external resources."}, {"type": "identity", "id": "https://example.com/cve-2024-5328/identity-1", "label": "Attacker Identity", "description": "The identity of the attacker, responsible for exploiting the SSRF vulnerability."}, {"type": "indicator", "id": "https://example.com/cve-2024-5328/indicator-1", "label": "SSRF Indicator", "description": "An indicator of the SSRF vulnerability, used to detect and prevent future attacks."}], "relationships": [{"type": "has-incident", "id": "https://example.com/cve-2024-5328/has-incident-1", "from": "https://example.com/cve-2024-5328", "to": "https://example.com/cve-2024-5328/incident-1"}, {"type": "has-observable", "id": "https://example.com/cve-2024-5328/has-observable-1", "from": "https://example.com/cve-2024-5328", "to": "https://example.com/cve-2024-5328/observable-1"}]}}, "technical_analysis": {"Introduction": "A Server-Side Request Forgery (SSRF) vulnerability exists in the lunary-ai/lunary application, affecting the '/auth/saml/tto/download-idp-xml' endpoint.", "Impact and Scope": "This vulnerability has a CVSS score of 9.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:L), indicating a high severity risk of data exfiltration and unauthorized access.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1204.001, TA0015, T1036.003, and T1497.001.", "Technical Details": "The vulnerability arises due to the application's failure to validate user-supplied URLs before using them in server-side requests.", "Detection": "Detections can be implemented using network traffic analysis tools and log analysis to identify unauthorized requests to internal or external resources.", "Mitigation": "Mitigation strategies include applying input validation and sanitization to user-supplied URLs, limiting network access to internal resources, and implementing web application firewalls.", "Conclusion": "This vulnerability poses a significant risk to the confidentiality and integrity of sensitive data. It is essential to prioritize patching and mitigating this vulnerability to prevent future attacks."}, "executive_analysis": {"Overview": "A Server-Side Request Forgery (SSRF) vulnerability exists in the lunary-ai/lunary application, affecting the '/auth/saml/tto/download-idp-xml' endpoint.", "Business Impact": "This vulnerability has the potential to disrupt business operations and compromise sensitive data, leading to financial losses and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to make unauthorized requests to internal or external resources, enabling data exfiltration and service disruption.", "Mitigation Strategies": "Implementing input validation and sanitization, limiting network access, and using web application firewalls can mitigate this vulnerability.", "Recommendations": "We recommend that the application be patched and tested thoroughly to ensure the vulnerability is fully mitigated.", "Conclusions": "This vulnerability requires immediate attention and should be prioritized in the organization's incident response plan."}}