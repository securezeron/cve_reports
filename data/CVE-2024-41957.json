{"id": "CVE-2024-41957", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-01T22:15:29.367", "lastModified": "2024-08-09T14:14:01.190", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Vim is an open source command line text editor. Vim < v9.1.0647 has double free in src/alloc.c:616. When closing a window, the corresponding tagstack data will be cleared and freed. However a bit later, the quickfix list belonging to that window will also be cleared and if that quickfix list points to the same tagstack data, Vim will try to free it again, resulting in a double-free/use-after-free access exception. Impact is low since the user must intentionally execute vim with several non-default flags,\nbut it may cause a crash of Vim. The issue has been fixed as of Vim patch v9.1.0647"}, {"lang": "es", "value": "Vim es un editor de texto de l\u00ednea de comandos de c\u00f3digo abierto. Vim "}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 3.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-415"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-415"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:vim:vim:*:*:*:*:*:*:*:*", "versionEndExcluding": "9.1.0647", "matchCriteriaId": "E45F378C-A666-4E59-AE67-FD0B7BEC9D24"}]}]}], "references": [{"url": "https://github.com/vim/vim/commit/8a0bbe7b8aad6f8da28dee218c01bc8a0185a", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/vim/vim/security/advisories/GHSA-f9cr-gv85-hcr4", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0005: Defense Evasion", "comment": "CVE-2024-41957 - This vulnerability can be used to evade detection by closing the window and free the tagstack data, making it harder to detect."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "CVE-2024-41957 - This vulnerability can be used to exploit a public-facing application, specifically the Vim text editor."}, {"techniqueID": "T1121: File and Directory Discovery", "comment": "CVE-2024-41957 - This vulnerability can be used to discover and access sensitive files and directories by exploiting the double free bug."}, {"techniqueID": "T1518: Web Shell", "comment": "CVE-2024-41957 - This vulnerability can be used to create a web shell to further compromise the system."}, {"techniqueID": "T1563: Post Exploitation Tools", "comment": "CVE-2024-41957 - This vulnerability can be used to install and run post-exploitation tools to further compromise the system."}], "technical_analysis": {"Introduction": "The CVE-2024-41957 vulnerability is a double free bug in the Vim text editor that can be used to exploit public-facing applications and evade detection.", "Impact and Scope": "The vulnerability has a CVSS score of 5.3 and can impact the confidentiality, integrity, and availability of systems that use the Vim text editor.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: Defense Evasion, Exploit Public-Facing Application, File and Directory Discovery, Web Shell, and Post Exploitation Tools.", "Technical Details": "The vulnerability occurs when closing a window in the Vim text editor, which frees the tagstack data. However, the quickfix list is not properly cleared, leading to a double free and use after free bug.", "Detection": "Detecting this vulnerability will require monitoring for suspicious activity around the Vim text editor and looking for signs of a double free bug.", "Mitigation": "Apply the recommended patch to the Vim text editor to prevent exploitation of this vulnerability.", "Conclusion": "In conclusion, this vulnerability is a high-risk threat that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2024-41957 vulnerability is a critical flaw in the Vim text editor that can be used to exploit public-facing applications and evade detection.", "Business Impact": "The business impact of this vulnerability is high, as it can compromise the confidentiality, integrity, and availability of sensitive data and systems.", "Technical Impact": "The technical impact of this vulnerability is also high, as it can be used to create a web shell, install and run post-exploitation tools, and further compromise the system.", "Mitigation Strategies": "Apply the recommended patch to the Vim text editor and implement a web application firewall to block suspicious traffic.", "Recommendations": "Recommend to the executive team that immediate action be taken to patch and remediate the vulnerability, and to implement additional security measures to prevent exploitation.", "Conclusions": "In conclusion, this vulnerability is a critical threat that requires immediate attention and mitigation to prevent exploitation and compromise of sensitive data and systems."}}