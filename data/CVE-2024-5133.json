{"id": "CVE-2024-5133", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T19:16:05.557", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In lunary-ai/lunary version 1.2.4, an account takeover vulnerability exists due to the exposure of password recovery tokens in API responses. Specifically, when a user initiates the password reset process, the recovery token is included in the response of the `GET /v1/users/me/org` endpoint, which lists all users in a team. This allows any authenticated user to capture the recovery token of another user and subsequently change that user's password without consent, effectively taking over the account. The issue lies in the inclusion of the `recovery_token` attribute in the users object returned by the API."}, {"lang": "es", "value": "En lunary-ai/lunary versi\u00f3n 1.2.4, existe una vulnerabilidad de apropiaci\u00f3n de cuenta debido a la exposici\u00f3n de tokens de recuperaci\u00f3n de contrase\u00f1a en las respuestas de API. Espec\u00edficamente, cuando un usuario inicia el proceso de restablecimiento de contrase\u00f1a, el token de recuperaci\u00f3n se incluye en la respuesta del endpoint `GET /v1/users/me/org`, que enumera todos los usuarios de un equipo. Esto permite que cualquier usuario autenticado capture el token de recuperaci\u00f3n de otro usuario y posteriormente cambie la contrase\u00f1a de ese usuario sin consentimiento, asumiendo efectivamente el control de la cuenta. El problema radica en la inclusi\u00f3n del atributo `recovery_token` en el objeto de usuario devuelto por la API."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}], "references": [{"url": "https://huntr.com/bounties/6057598d-93c4-4a94-bb80-5bd508013c5b", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1110", "comment": "CVE-2024-5133 - An unauthorized account takeover vulnerability exists due to the exposure of password recovery tokens in API responses. This allows attackers to capture the recovery token of another user and change the user's password without consent. Defend against this by implementing robust authentication and authorization controls, as well as monitoring API responses for suspicious activity."}, {"techniqueID": "T1133", "comment": "CVE-2024-5133 - The inclusion of the recovery_token attribute in the users object returned by the API allows attackers to capture the recovery token of another user. Defend against this by validating and sanitizing API responses, and implementing input validation and data sanitization techniques to prevent malicious inputs from tampering with the API responses."}, {"techniqueID": "T1555", "comment": "CVE-2024-5133 - Attackers can exploit the vulnerability to change the password of another user without their consent. Defend against this by implementing password reset controls, such as requiring additional authentication factors or limiting the number of password resets without proper authentication."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "https://example.com/CVE-2024-5133", "created_by_ref": "https://example.com/user123", "created": "2024-06-07T14:56:05.647", "modified": "2024-06-07T14:56:05.647", "objects": [{"type": "vulnerability", "id": "https://example.com/CVE-2024-5133", "name": "CVE-2024-5133", "description": "In lunary-ai/lunary version 1.2.4, an account takeover vulnerability exists due to the exposure of password recovery tokens in API responses.", "severity": "CRITICAL", "references": [{"type": "reference", "id": "https://huntr.com/bounties/6057598d-93c4-4a94-bb80-5bd508013c5b", "name": "Huntr Bug Bounty"}]}, {"type": "tactic", "id": "https://example.com/T1110", "name": "T1110", "description": "Enumeration", "objects": [{"type": "indicator", "id": "https://example.com/indicator123", "name": "indicator1", "description": "Enumerating users"}]}, {"type": "tactic", "id": "https://example.com/T1133", "name": "T1133", "description": "File and Path Discovery", "objects": [{"type": "indicator", "id": "https://example.com/indicator456", "name": "indicator2", "description": "Discovering API responses"}]}, {"type": "tactic", "id": "https://example.com/T1555", "name": "T1555", "description": "Modifying Additional Settings", "objects": [{"type": "indicator", "id": "https://example.com/indicator789", "name": "indicator3", "description": "Changing user passwords"}]}, {"type": "course-of-action", "id": "https://example.com/course-of-action1", "name": "course-of-action1", "description": "Implement robust authentication and authorization controls", "related_tactics": ["https://example.com/T1110", "https://example.com/T1133", "https://example.com/T1555"]}, {"type": "course-of-action", "id": "https://example.com/course-of-action2", "name": "course-of-action2", "description": "Validate and sanitize API responses", "related_tactics": ["https://example.com/T1133"]}, {"type": "course-of-action", "id": "https://example.com/course-of-action3", "name": "course-of-action3", "description": "Implement password reset controls", "related_tactics": ["https://example.com/T1555"]}]}}, "technical_analysis": {"Introduction": "CVE-2024-5133 is an account takeover vulnerability that allows attackers to capture and use the password recovery tokens of other users.", "Impact and Scope": "The vulnerability has a CVSS score of 9.1 and affects users of lunary-ai/lunary version 1.2.4.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1110, T1133, and T1555.", "Technical Details": "The vulnerability occurs due to the inclusion of the recovery_token attribute in the users object returned by the API.", "Detection": "The vulnerability can be detected by monitoring API responses for suspicious activity, such as the inclusion of the recovery_token attribute.", "Mitigation": "The vulnerability can be mitigated by implementing robust authentication and authorization controls, validating and sanitizing API responses, and implementing password reset controls.", "Conclusion": "CVE-2024-5133 is a critical vulnerability that can have serious consequences if left unaddressed."}, "executive_analysis": {"Overview": "CVE-2024-5133 is a critical vulnerability that affects users of lunary-ai/lunary version 1.2.4 and allows attackers to capture and use the password recovery tokens of other users.", "Business Impact": "The vulnerability can have serious business consequences, including reputational damage and financial losses.", "Technical Impact": "The vulnerability can have serious technical consequences, including the exploitation of user accounts and data breaches.", "Mitigation Strategies": "Implementing robust authentication and authorization controls, validating and sanitizing API responses, and implementing password reset controls can help mitigate the vulnerability.", "Recommendations": "Executives should prioritize addressing the vulnerability and implementing mitigation strategies to prevent further exploitation.", "Conclusions": "CVE-2024-5133 is a critical vulnerability that requires immediate attention to prevent further exploitation and minimize potential impact."}}