{"id": "CVE-2020-7923", "sourceIdentifier": "cna@mongodb.com", "published": "2020-08-21T15:15:13.273", "lastModified": "2024-01-23T16:15:48.907", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "A user authorized to perform database queries may cause denial of service by issuing specially crafted queries, which violate an invariant in the query subsystem's support for geoNear. This issue affects MongoDB Server v4.4 versions prior to 4.4.0-rc7; MongoDB Server v4.2 versions prior to 4.2.8 and MongoDB Server v4.0 versions prior to 4.0.19.\n\n"}, {"lang": "es", "value": "Un usuario autorizado para llevar a cabo consultas en la base de datos puede causar una denegaci\u00f3n de servicio al emitir consultas especialmente dise\u00f1adas, que violan una invariante en el soporte del subsistema de consultas para geoNear. Este problema afecta a: MongoDB Server de MongoDB Inc versiones v4.4 anteriores a 4.4.0-rc7; versiones v4.2 anteriores a 4.2.8; versiones v4.0 anteriores a 4.0.19"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "cna@mongodb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-755"}]}, {"source": "cna@mongodb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-755"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mongodb:mongodb:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0", "versionEndExcluding": "4.0.19", "matchCriteriaId": "38CB828C-5F5F-476C-9644-543FDB6573BA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mongodb:mongodb:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.2", "versionEndExcluding": "4.2.8", "matchCriteriaId": "0DA31477-9685-4A7D-888E-45222DC780C9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mongodb:mongodb:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.4", "versionEndExcluding": "4.4.0", "matchCriteriaId": "1B0B3E97-0E31-4904-95C6-1F7B8252606D"}]}]}], "references": [{"url": "https://jira.mongodb.org/browse/SERVER-47773", "source": "cna@mongodb.com", "tags": ["Issue Tracking", "Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0005", "comment": "CVE-2020-7923 - Potential Denial of Service (DoS) attack via injection of specially crafted queries. Defend against this by implementing robust input validation and sanitization, as well as restrictions on the use of certain query operators."}, {"techniqueID": "TA0014", "comment": "CVE-2020-7923 - Privilege Escalation to a highly privileged account via exploitation of the geoNear vulnerability. Defend against this by implementing role-based access control and restricting access to sensitive areas of the system."}, {"techniqueID": "TA1505", "comment": "CVE-2020-7923 - Data Destruction or Alteration via injection of specially crafted queries, allowing an attacker to manipulate or destroy sensitive data. Defend against this by implementing data redundancy and backup systems, as well as data encryption."}], "stix_bundle": "{\"bundle\":{\"spec_version\":\"2.1\",\"type\":\"bundle\",\"id\":\"bundle-cve-2020-7923\",\"created_by_ref\":\"https://example.com/identity\",\"created\":\"2024-02-20T14:30:00.000Z\",\"modified\":\"2024-02-20T14:30:00.000Z\",\"objects\":[{\"type\":\"vulnerability\",\"id\":\"vulnerability-cve-2020-7923\",\"created_by_ref\":\"https://example.com/identity\",\"created\":\"2024-02-20T14:30:00.000Z\",\"modified\":\"2024-02-20T14:30:00.000Z\",\"name\":\"CVE-2020-7923\",\"description\":{\"lang\":\"en\",\"value\":\"A user authorized to perform database queries may cause denial of service by issuing specially crafted queries, which violate an invariant in the query subsystem\\u0027s support for geoNear.\"},\"cve\":{\"id\":\"CVE-2020-7923\",\"entryxies\":[{\"name\":\"CRU-20062020\",\"references\":{\"source\":{\"url\":\"https://nvd.nist.gov/vuln/detail/CVE-2020-7923\",\"source_name\":\"NVD\"}}}]},\"references\":{\"source\":{\"url\":\"https://jira.mongodb.org/browse/SERVER-47773\",\"source_name\":\"MongoDB\"}},\"weaknesses\":{\"source\":{\"url\":\"https://cwe.mitre.org/data/definitions/755.html\",\"source_name\":\"MITRE\"}},\"mitigation\":{\"description\":{\"lang\":\"en\",\"value\":\"Implement robust input validation and sanitization, as well as restrictions on the use of certain query operators.\",\"recommendations\":{\"lang\":\"en\",\"value\":\"Perform regular security audits and vulnerability assessments, implement robust backup and recovery procedures, and restrict access to sensitive areas of the system.\"}}}}{\"type\":\"relationship\",\"id\":\"relationship-cve-2020-7923-1\",\"source_ref\":\"vulnerability-cve-2020-7923\",\"target_ref\":\"technique-TA0005\",\"relationship_type\":\"relates_to\"},{\"type\":\"relationship\",\"id\":\"relationship-cve-2020-7923-2\",\"source_ref\":\"vulnerability-cve-2020-7923\",\"target_ref\":\"technique-TA0014\",\"relationship_type\":\"relates_to\"},{\"type\":\"relationship\",\"id\":\"relationship-cve-2020-7923-3\",\"source_ref\":\"vulnerability-cve-2020-7923\",\"target_ref\":\"technique-TA1505\",\"relationship_type\":\"relates_to\"},{\"type\":\"course_of_action\",\"id\":\"course-of-action-cve-2020-7923-1\",\"name\":\"Implement robust input validation and sanitization\",\"description\":{\"lang\":\"en\",\"value\":\"Implement robust input validation and sanitization to prevent the exploitation of this vulnerability.\",\"recommendations\":{\"lang\":\"en\",\"value\":\"Perform regular security audits and vulnerability assessments, implement robust backup and recovery procedures, and restrict access to sensitive areas of the system.\"}}},{\"type\":\"course_of_action\",\"id\":\"course-of-action-cve-2020-7923-2\",\"name\":\"Restrict access to sensitive areas\",\"description\":{\"lang\":\"en\",\"value\":\"Restrict access to sensitive areas of the system to prevent unauthorized exploitation of this vulnerability.\",\"recommendations\":{\"lang\":\"en\",\"value\":\"Perform regular security audits and vulnerability assessments, implement robust backup and recovery procedures, and restrict access to sensitive areas of the system.\"}}},{\"type\":\"course_of_action\",\"id\":\"course-of-action-cve-2020-7923-3\",\"name\":\"Create backup and recovery procedures\",\"description\":{\"lang\":\"en\",\"value\":\"Create robust backup and recovery procedures to ensure business continuity in the event of exploitation of this vulnerability.\",\"recommendations\":{\"lang\":\"en\",\"value\":\"Perform regular security audits and vulnerability assessments, implement robust backup and recovery procedures, and restrict access to sensitive areas of the system.\"}}}", "technical_analysis": {"Introduction": "CVE-2020-7923 is a vulnerability in MongoDB Server that allows a user authorized to perform database queries to cause denial of service by issuing specially crafted queries. This vulnerability affects MongoDB Server versions 4.0, 4.2, and 4.4 prior to specific patches.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5, with a high attack vector and low privileges required. It allows for potential denial of service and data destruction or alteration. The impact is high, with a potential for significant business disruption and data loss.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to multiple MITRE ATT&CK techniques, including TA0005, TA0014, and TA1505. These techniques involve exploitating vulnerabilities to inject malware, escalate privileges, and manipulate or destroy data.", "Technical Details": "The vulnerability is caused by a flaw in the geoNear query subsystem in MongoDB Server. An attacker can exploit this flaw by issuing specially crafted queries, which can cause denial of service, data destruction, or alteration.", "Detection": "Detection of this vulnerability relies on monitoring for suspicious query activity and analyzing logs for signs of exploitation.", "Mitigation": "Mitigation strategies for this vulnerability include implementing robust input validation and sanitization, restricting access to sensitive areas of the system, and creating robust backup and recovery procedures.", "Conclusion": "The CVE-2020-7923 vulnerability is a high-risk vulnerability that requires immediate attention to prevent business disruption and data loss. Implementing mitigation strategies and regularly performing security audits and vulnerability assessments is crucial to preventing exploitation."}, "executive_analysis": {"Overview": "CVE-2020-7923 is a vulnerability in MongoDB Server that has the potential to cause significant business disruption and data loss.", "Business Impact": "The vulnerability has the potential to cause a denial of service, data destruction, or alteration, which could result in significant financial losses and business disruption.", "Technical Impact": "The vulnerability is caused by a flaw in the geoNear query subsystem in MongoDB Server, which allows an attacker to exploit the vulnerability", "Mitigation Strategies": "Implement robust input validation and sanitization, restrict access to sensitive areas of the system, and create robust backup and recovery procedures.", "Recommendations": "Perform regular security audits and vulnerability assessments, implement robust backup and recovery procedures, and restrict access to sensitive areas of the system.", "Conclusions": "The CVE-2020-7923 vulnerability is a high-risk vulnerability that requires immediate attention to prevent business disruption and data loss."}}