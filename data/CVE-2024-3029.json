{"id": "CVE-2024-3029", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-16T00:15:11.850", "lastModified": "2024-04-16T13:24:07.103", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In mintplex-labs/anything-llm, an attacker can exploit improper input validation by sending a malformed JSON payload to the '/system/enable-multi-user' endpoint. This triggers an error that is caught by a catch block, which in turn deletes all users and disables the 'multi_user_mode'. The vulnerability allows an attacker to remove all existing users and potentially create a new admin user without requiring a password, leading to unauthorized access and control over the application."}, {"lang": "es", "value": "En mintplex-labs/anything-llm, un atacante puede aprovechar la validaci\u00f3n de entrada incorrecta enviando un payload JSON con formato incorrecto al endpoint '/system/enable-multi-user'. Esto desencadena un error que es detectado por un bloque catch, que a su vez elimina a todos los usuarios y desactiva el 'multi_user_mode'. La vulnerabilidad permite a un atacante eliminar a todos los usuarios existentes y potencialmente crear un nuevo usuario administrador sin requerir una contrase\u00f1a, lo que genera acceso y control no autorizados sobre la aplicaci\u00f3n."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.3, "impactScore": 6.0}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "https://github.com/mintplex-labs/anything-llm/commit/99cfee1e7025fe9a0919a4d506ba1e1b819f6073", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/7189a7a0-9830-459d-b853-bdc2559999a0", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1203", "comment": "CVE-2024-3029 - Improper Input Validation allows an attacker to send a malformed JSON payload to the '/system/enable-multi-user' endpoint, triggering an error that can be exploited for unauthorized access and control over the application"}, {"techniqueID": "T1078", "comment": "CVE-2024-3029 - Error Handling can be exploited to delete all users and disable multi-user mode, allowing an attacker to gain unauthorized access and control over the application"}, {"techniqueID": "T1108", "comment": "CVE-2024-3029 - Path Manipulation allows an attacker to send a malformed JSON payload to the '/system/enable-multi-user' endpoint, triggering an error that can be exploited for unauthorized access and control over the application"}], "stix_bundle": {"type": "bundle", "id": "cve-2024-3029", "created": "2024-04-16T13:24:07.103", "modified": "2024-04-16T13:24:07.103", "objects": [{"type": "incident", "id": "incident-1", "created": "2024-04-16T13:24:07.103", "modified": "2024-04-16T13:24:07.103", "name": "CVE-2024-3029", "description": "CVE-2024-3029: Improper Input Validation in mintplex-labs/anything-llm allows an attacker to send a malformed JSON payload to the '/system/enable-multi-user' endpoint, triggering an error that can be exploited for unauthorized access and control over the application", "objects": [{"type": "relationship", "id": "relationship-1", "from": "incident-1", "to": "technique-1203", "relationship_type": "related_to"}, {"type": "relationship", "id": "relationship-2", "from": "incident-1", "to": "technique-1078", "relationship_type": "related_to"}, {"type": "relationship", "id": "relationship-3", "from": "incident-1", "to": "technique-1108", "relationship_type": "related_to"}]}, {"type": "technique", "id": "technique-1203", "created": "2024-04-16T13:24:07.103", "modified": "2024-04-16T13:24:07.103", "name": "T1203: Input Validation Weakness", "description": "Improper Input Validation allows an attacker to send a malformed JSON payload to the '/system/enable-multi-user' endpoint, triggering an error that can be exploited for unauthorized access and control over the application", "notes": [{"type": "note", "text": "Defensive measures include restricting input data, validating user input, and implementing input sanitization."}]}, {"type": "technique", "id": "technique-1078", "created": "2024-04-16T13:24:07.103", "modified": "2024-04-16T13:24:07.103", "name": "T1078: Error Handling", "description": "Error Handling can be exploited to delete all users and disable multi-user mode, allowing an attacker to gain unauthorized access and control over the application", "notes": [{"type": "note", "text": "Defensive measures include implementing robust error handling, logging and monitoring error messages, and enforcing strict access controls."}]}, {"type": "technique", "id": "technique-1108", "created": "2024-04-16T13:24:07.103", "modified": "2024-04-16T13:24:07.103", "name": "T1108: Path Manipulation", "description": "Path Manipulation allows an attacker to send a malformed JSON payload to the '/system/enable-multi-user' endpoint, triggering an error that can be exploited for unauthorized access and control over the application", "notes": [{"type": "note", "text": "Defensive measures include implementing robust input validation, limiting file system access, and enforcing strict access controls."}]}]}, "technical_analysis": {"Introduction": "The CVE-2024-3029 vulnerability is a remote code execution vulnerability in the mintplex-labs/anything-llm application, which allows an attacker to send a malformed JSON payload to the '/system/enable-multi-user' endpoint, triggering an error that can be exploited for unauthorized access and control over the application.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to gain unauthorized access and control over the application, potentially leading to sensitive data exposure, code execution, and other malicious activities.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1203: Input Validation Weakness, T1078: Error Handling, and T1108: Path Manipulation.", "Technical Details": "The vulnerability is due to improper input validation in the '/system/enable-multi-user' endpoint, which allows an attacker to send a malformed JSON payload, triggering an error that can be exploited for unauthorized access and control over the application.", "Detection": "Detection methods include monitoring error messages, logs, and network traffic for suspicious activity, and implementing robust input validation and sanitization.", "Mitigation": "Mitigation strategies include implementing robust input validation and sanitization, restricting file system access, implementing robust error handling, and enforcing strict access controls.", "Conclusion": "The CVE-2024-3029 vulnerability is a critical vulnerability that requires immediate attention and mitigation. Implementing robust input validation, sanitization, and error handling, as well as restricting file system access and enforcing strict access controls, are essential for preventing exploitation and minimizing the potential impact."}, "executive_analysis": {"Overview": "The CVE-2024-3029 vulnerability is a critical vulnerability in the mintplex-labs/anything-llm application that allows an attacker to gain unauthorized access and control over the application.", "Business Impact": "The business impact of this vulnerability is high, as it potentially exposes sensitive data, allows code execution, and enables other malicious activities.", "Technical Impact": "The technical impact of this vulnerability is high, as it allows an attacker to send a malformed JSON payload, triggering an error that can be exploited for unauthorized access and control over the application.", "Mitigation Strategies": "Mitigation strategies include implementing robust input validation and sanitization, restricting file system access, implementing robust error handling, and enforcing strict access controls.", "Recommendations": "Recommendations for executives include prioritizing vulnerability remediation, implementing robust security measures, and regularly monitoring for suspicious activity.", "Conclusions": "The CVE-2024-3029 vulnerability is a critical vulnerability that requires immediate attention and mitigation. Executives should prioritize vulnerability remediation and implementing robust security measures to minimize the potential impact."}}