{"id": "CVE-2020-15187", "sourceIdentifier": "security-advisories@github.com", "published": "2020-09-17T22:15:12.647", "lastModified": "2021-11-18T17:51:13.843", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Helm before versions 2.16.11 and 3.3.2, a Helm plugin can contain duplicates of the same entry, with the last one always used. If a plugin is compromised, this lowers the level of access that an attacker needs to modify a plugin's install hooks, causing a local execution attack. To perform this attack, an attacker must have write access to the git repository or plugin archive (.tgz) while being downloaded (which can occur during a MITM attack on a non-SSL connection). This issue has been patched in Helm 2.16.11 and Helm 3.3.2. As a possible workaround make sure to install plugins using a secure connection protocol like SSL."}, {"lang": "es", "value": "En Helm versiones anteriores a 2.16.11 y 3.3.2, un plugin de Helm puede contener duplicados de la misma entrada, y siempre se usa la \u00faltima.&#xa0;Si un plugin est\u00e1 comprometido, esto reduce el nivel de acceso que un atacante necesita para modificar los hooks de instalaci\u00f3n de un plugin, causando un ataque de ejecuci\u00f3n local.&#xa0;Para llevar a cabo este ataque, un atacante necesita tener acceso de escritura al repositorio de git o al archivo de plugins (.tgz) mientras est\u00e1 siendo descargado (lo que puede ocurrir durante un ataque de tipo MITM en una conexi\u00f3n no SSL).&#xa0;Este problema ha sido corregido en Helm versi\u00f3n 2.16.11 y Helm versi\u00f3n 3.3.2.&#xa0;Como posible soluci\u00f3n, aseg\u00farese de instalar plugins usando un protocolo de conexi\u00f3n seguro como SSL"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.0, "baseSeverity": "LOW"}, "exploitabilityScore": 1.3, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-694"}, {"lang": "en", "value": "CWE-74"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:helm:helm:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.0.0", "versionEndExcluding": "2.16.11", "matchCriteriaId": "455BCCE5-1D43-4E59-9591-E84B52DAAF0B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:helm:helm:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.0.0", "versionEndExcluding": "3.3.2", "matchCriteriaId": "B462D769-3FC0-4079-8B48-863F013662EF"}]}]}], "references": [{"url": "https://github.com/helm/helm/commit/d9ef5ce8bad512e325390c0011be1244b8380e4b", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/helm/helm/security/advisories/GHSA-c52f-pq47-2r9j", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0001: Initial Access - Execution", "comment": "CVE-2020-15187 - This vulnerability allows an attacker to gain initial access by exploiting the Helm plugin vulnerability, which can lead to local execution attacks. Defend against this by installing plugins using a secure connection protocol like SSL."}, {"techniqueID": "TA0003: Credential Access - Lateral Movement", "comment": "CVE-2020-15187 - Once an attacker has gained initial access, they can use this vulnerability to move laterally within the system, accessing sensitive credentials and escalating privileges. Defend against this by implementing robust authentication and access controls."}, {"techniqueID": "TA0005: Command and Control - Lateral Movement", "comment": "CVE-2020-15187 - Attackers can use this vulnerability to establish command and control mechanisms, allowing them to move data and commands between systems. Defend against this by implementing network segmentation and monitoring."}], "technical_analysis": {"Introduction": "Helm before versions 2.16.11 and 3.3.2 contains a vulnerability that allows attackers to install a compromised plugin, leading to local execution attacks. This vulnerability has been patched in Helm 2.16.11 and Helm 3.3.2.", "Impact and Scope": "CVSS Score: 4.7, Attack Vector: NETWORK, Attack Complexity: LOW, Privileges Required: HIGH, User Interaction: NONE, Scope: UNCHANGED, Confidentiality Impact: LOW, Integrity Impact: LOW, Availability Impact: LOW.", "Related MITRE ATT&CK Techniques": "TA0001: Initial Access - Execution, TA0003: Credential Access - Lateral Movement, TA0005: Command and Control - Lateral Movement", "Technical Details": "The vulnerability allows attackers to install a compromised plugin, which can then be used to perform local execution attacks. This can occur during a MITM attack on a non-SSL connection.", "Detection": "Detect this vulnerability by monitoring for suspicious plugin installations and monitoring network traffic.", "Mitigation": "Mitigate this vulnerability by installing plugins using a secure connection protocol like SSL and implementing robust authentication and access controls.", "Conclusion": "The Helm plugin vulnerability (CVE-2020-15187) is a remote code execution vulnerability that can be exploited by attackers to gain initial access and move laterally within the system."}, "executive_analysis": {"Overview": "The Helm plugin vulnerability (CVE-2020-15187) is a serious security risk that can allow attackers to gain initial access and move laterally within the system.", "Business Impact": "This vulnerability can lead to data breaches, unauthorized access to sensitive information, and system compromise.", "Technical Impact": "This vulnerability can be exploited by attackers to gain initial access and move laterally within the system, accessing sensitive credentials and escalating privileges.", "Mitigation Strategies": "Implement secure connection protocols like SSL when installing plugins and implement robust authentication and access controls.", "Recommendations": "This vulnerability should be prioritized for patching and mitigation. Implement robust monitoring and detection mechanisms to detect suspicious activity.", "Conclusions": "The Helm plugin vulnerability (CVE-2020-15187) is a serious security risk that requires immediate attention and mitigation."}}