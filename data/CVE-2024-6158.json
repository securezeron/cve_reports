{"id": "CVE-2024-6158", "sourceIdentifier": "contact@wpscan.com", "published": "2024-08-12T13:38:38.913", "lastModified": "2024-08-13T15:35:29.740", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Category Posts Widget WordPress plugin before 4.9.17, term-and-category-based-posts-widget WordPress plugin before 4.9.13 does not validate and escape some of its \"Category Posts\" widget settings before outputting them back in a page/post where the Widget is embed, which could allow high privilege users such as admin to perform Stored Cross-Site Scripting attacks even when the unfiltered_html capability is disallowed (for example in multisite setup)"}, {"lang": "es", "value": "El complemento Category Posts Widget de WordPress anterior a 4.9.17, el complemento term-and-category-based-posts-widget de WordPress anterior a 4.9.13 no valida ni escapa algunas de las configuraciones del widget de \"Publicaciones de categor\u00eda\" antes de devolverlas a una p\u00e1gina/ publicar donde est\u00e1 incrustado el widget, lo que podr\u00eda permitir a usuarios con privilegios elevados, como el administrador, realizar ataques de Cross-Site Scripting Almacenado incluso cuando la capacidad unfiltered_html no est\u00e1 permitida (por ejemplo, en una configuraci\u00f3n multisitio)."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}]}, "references": [{"url": "https://wpscan.com/vulnerability/8adb219f-f0a6-4e87-8626-db26e300c220/", "source": "contact@wpscan.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-6158 - This stored XSS vulnerability allows high privilege users to perform malicious scripts on vulnerable systems. Attackers can exploit this vulnerability by submitting crafted Category Posts Widget settings, which can lead to arbitrary script execution. This technique is relevant and should be defended against by restricting user input, validating and sanitizing user data, and implementing secure headers."}, {"techniqueID": "T1169", "comment": "CVE-2024-6158 - This vulnerability can be exploited by high privilege users to inject malicious scripts into vulnerable systems. Attackers can exploit this vulnerability by submitting crafted Category Posts Widget settings, which can lead to arbitrary script execution. This technique is relevant and should be defended against by restricting user input, validating and sanitizing user data, and implementing secure headers."}, {"techniqueID": "T1197", "comment": "CVE-2024-6158 - This stored XSS vulnerability allows high privilege users to perform malicious scripts on vulnerable systems. Attackers can exploit this vulnerability by submitting crafted Category Posts Widget settings, which can lead to arbitrary script execution. This technique is relevant and should be defended against by restricting user input, validating and sanitizing user data, and implementing secure headers."}], "stix_bundle": {"id": "stix_bundle:example_bundle", "type": "bundle", "created_by_ref": "user:<username>", "modified": "2024-08-13T15:35:29.740", "objects": [{"id": "indicator:stored_xss", "type": "indicator", "name": "Stored XSS", "description": "Stored XSS vulnerability in Category Posts Widget WordPress plugin", "created_by_ref": "user:<username>", "modified": "2024-08-13T15:35:29.740", "first_seen": "2024-08-12T13:38:38.913", "last_seen": "2024-08-13T15:35:29.740", "severity": "MEDIUM", "confidence": "LOW", "valid_from": "2024-08-12T13:38:38.913", "valid_until": "2024-08-13T15:35:29.740"}, {"id": "course_of_action:validate_and_sanitize", "type": "course-of-action", "name": "Validate and Sanitize", "description": "Validate and sanitize user input to prevent stored XSS attacks", "created_by_ref": "user:<username>", "modified": "2024-08-13T15:35:29.740", "related_target_ref": "indicator:stored_xss", "related_technique_ref": "T1190"}, {"id": "course_of_action:restrict_user_input", "type": "course-of-action", "name": "Restrict User Input", "description": "Restrict user input to prevent stored XSS attacks", "created_by_ref": "user:<username>", "modified": "2024-08-13T15:35:29.740", "related_target_ref": "indicator:stored_xss", "related_technique_ref": "T1190"}]}, "technical_analysis": {"Introduction": "The Category Posts Widget WordPress plugin versions before 4.9.17 and term-and-category-based-posts-widget WordPress plugin versions before 4.9.13 contain a stored XSS vulnerability, which allows high privilege users to perform malicious scripts on vulnerable systems.", "Impact and Scope": "The vulnerability affects multiple WordPress plugins and allows attackers to inject malicious scripts into vulnerable systems, leading to arbitrary script execution.", "Related MITRE ATT&CK Techniques": "Related techniques include T1190, T1169, and T1197, which are all related to stored XSS attacks.", "Technical Details": "The vulnerability occurs due to the lack of input validation and sanitization in the Category Posts Widget WordPress plugin, which allows attackers to inject malicious scripts into vulnerable systems.", "Detection": "Detecting this vulnerability can be challenging, but it can be done by monitoring system logs for suspicious script execution and monitoring network traffic for unusual activity.", "Mitigation": "Mitigating this vulnerability requires restricting user input, validating and sanitizing user data, and implementing secure headers.", "Conclusion": "In conclusion, this vulnerability is a significant threat to system security and should be taken seriously. It is essential to implement effective mitigation strategies to prevent attacks."}, "executive_analysis": {"Overview": "The Category Posts Widget WordPress plugin contains a stored XSS vulnerability, which allows high privilege users to perform malicious scripts on vulnerable systems.", "Business Impact": "This vulnerability can lead to data breaches, system compromise, and unauthorized access to sensitive information.", "Technical Impact": "The vulnerability allows attackers to inject malicious scripts into vulnerable systems, leading to arbitrary script execution.", "Mitigation Strategies": "Mitigation strategies include restricting user input, validating and sanitizing user data, and implementing secure headers.", "Recommendations": "Executives should prioritize implementing effective mitigation strategies to prevent attacks and ensure system security.", "Conclusions": "In conclusion, this vulnerability is a significant threat to system security, and it is essential to implement effective mitigation strategies to prevent attacks."}}