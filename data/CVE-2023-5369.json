{"id": "CVE-2023-5369", "sourceIdentifier": "secteam@freebsd.org", "published": "2023-10-04T04:15:14.627", "lastModified": "2023-11-24T09:15:09.607", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Before correction, the\u00a0copy_file_range\u00a0system call checked only for the CAP_READ and CAP_WRITE capabilities on the input and output file descriptors, respectively.  Using an offset is logically equivalent to seeking, and the system call must additionally require the CAP_SEEK capability.\n\nThis incorrect privilege check enabled sandboxed processes with only read or write but no seek capability on a file descriptor to read data from or write data to an arbitrary location within the file corresponding to that file descriptor."}, {"lang": "es", "value": "Antes de la correcci\u00f3n, la llamada al sistema copy_file_range verific\u00f3 solo las capabilities CAP_READ y CAP_WRITE en los descriptores de archivos de entrada y salida, respectivamente. Usar un desplazamiento es l\u00f3gicamente equivalente a buscar, y la llamada al sistema debe requerir adicionalmente la capability CAP_SEEK. Esta verificaci\u00f3n de privilegios incorrecta permiti\u00f3 que los procesos aislados con solo lectura o escritura pero sin capacidad de b\u00fasqueda en un descriptor de archivo leyeran o escribieran datos en una ubicaci\u00f3n arbitraria dentro del archivo correspondiente a ese descriptor de archivo."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.2}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-273"}]}, {"source": "secteam@freebsd.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-273"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.2:-:*:*:*:*:*:*", "matchCriteriaId": "A87EFA20-DD6B-41C5-98FD-A29F67D2E732"}]}]}], "references": [{"url": "https://security.FreeBSD.org/advisories/FreeBSD-SA-23:13.capsicum.asc", "source": "secteam@freebsd.org", "tags": ["Vendor Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20231124-0009/", "source": "secteam@freebsd.org"}], "techniques": [{"techniqueID": "T1186", "comment": "The vulnerability allows an attacker to read data from or write data to an arbitrary location within a file, potentially leading to unauthorized access or data tampering. This can be mitigated by implementing proper access controls and auditing mechanisms to detect and prevent unauthorized file operations."}, {"techniqueID": "T1204", "comment": "The attacker can use the incorrect privilege check to gain unauthorized access to files, making it a potential entry point for further exploitation. Countermeasures include implementing strong access controls, regular security audits, and monitoring system logs for suspicious activity."}, {"techniqueID": "T1497", "comment": "The vulnerability can be used to perform privilege escalation or unauthorized data access, making it a high-severity issue. Prevention measures include keeping systems and software up-to-date, implementing strong access controls, and regularly auditing and monitoring system logs for suspicious activity."}, {"techniqueID": "T1134", "comment": "The attacker can use the vulnerability to gain unauthorized access to sensitive information, making it a potential risk to data confidentiality and integrity. Countermeasures include implementing strong access controls, regular security audits, and monitoring system logs for suspicious activity."}], "stix_bundle": {"stix_2_1_bundle": {"bundle_id": "CVE-2023-5369-Bundle", "bundle_name": "FreeBSD CAP_READ/CAP_WRITE Capability Checking Vulnerability", "bundle_description": "A STIX 2.1 bundle for the FreeBSD CAP_READ/CAP_WRITE capability checking vulnerability (CVE-2023-5369)", "bundle_object": {"id": "CVE-2023-5369", "type": "vulnerability", "created_by": "Automated", "created": "2023-11-24T09:15:09.607", "modified": "2023-11-24T09:15:09.607", "description": "Before correction, the copy_file_range system call checked only for the CAP_READ and CAP_WRITE capabilities on the input and output file descriptors, respectively. Using an offset is logically equivalent to seeking, and the system call must additionally require the CAP_SEEK capability.\n\nThis incorrect privilege check enabled sandboxed processes with only read or write but no seek capability on a file descriptor to read data from or write data to an arbitrary location within the file corresponding to that file descriptor.", "permissions_required": [{"role": "read", "resource": "file"}, {"role": "write", "resource": "file"}], "objects": [{"id": "T1186", "type": " tactic", "description": "The attacker uses the vulnerability to read or write data from/to a file."}, {"id": "T1204", "type": "tactic", "description": "The attacker uses the vulnerability to gain unauthorized access to files."}, {"id": "T1497", "type": "tactic", "description": "The attacker uses the vulnerability to perform privilege escalation or unauthorized data access."}, {"id": "T1134", "type": "tactic", "description": "The attacker uses the vulnerability to gain unauthorized access to sensitive information."}], "courses_of_action": [{"id": "T1186", "description": "Implement proper access controls and auditing mechanisms to detect and prevent unauthorized file operations."}, {"id": "T1204", "description": "Strong access controls, regular security audits, and monitoring system logs for suspicious activity."}, {"id": "T1497", "description": "Implement strong access controls, regular security audits, and monitoring system logs for suspicious activity."}, {"id": "T1134", "description": "Implement strong access controls, regular security audits, and monitoring system logs for suspicious activity."}]}}}, "technical_analysis": {"Introduction": "The vulnerability is a privilege escalation issue that allows attackers to read or write data from/to a file, potentially leading to unauthorized access or data tampering.", "Impact and Scope": "The vulnerability has a CVSS score of 7.1 (HIGH) with an attack vector of LOCAL, making it a critical issue.", "Related MITRE ATT&CK Techniques": "T1186 - File and Directory Discovery, T1204 - User Rights and Privileges, T1497 - Privilege Escalation, T1134 - Network Share Discovery.", "Technical Details": "The vulnerability is caused by an incorrect privilege check in the copy_file_range system call, allowing sandboxed processes to read or write data from/to a file.", "Detection": "Detection methods include monitoring system logs for suspicious file operations and conducting regular security audits.", "Mitigation": "Mitigation strategies include implementing strong access controls, regular security audits, and monitoring system logs for suspicious activity.", "Conclusion": "The vulnerability is a critical issue that requires immediate attention and remediation to prevent unauthorized access or data tampering."}, "executive_analysis": {"Overview": "The vulnerability is a privilege escalation issue that allows attackers to read or write data from/to a file, potentially leading to unauthorized access or data tampering.", "Business Impact": "The vulnerability poses a significant risk to sensitive data and could result in data breaches or unauthorized access.", "Technical Impact": "The vulnerability allows attackers to gain unauthorized access to files, making it a potential entry point for further exploitation.", "Mitigation Strategies": "Implement strong access controls, regular security audits, and monitoring system logs for suspicious activity.", "Recommendations": "Executives should prioritize remediation and implementation of mitigation strategies to prevent unauthorized access or data tampering.", "Conclusions": "The vulnerability is a critical issue that requires immediate attention and remediation to prevent unauthorized access or data tampering."}}