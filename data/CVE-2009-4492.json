{"id": "CVE-2009-4492", "sourceIdentifier": "cve@mitre.org", "published": "2010-01-13T20:30:00.530", "lastModified": "2023-08-01T18:59:27.303", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "WEBrick 1.3.1 in Ruby 1.8.6 through patchlevel 383, 1.8.7 through patchlevel 248, 1.8.8dev, 1.9.1 through patchlevel 376, and 1.9.2dev writes data to a log file without sanitizing non-printable characters, which might allow remote attackers to modify a window's title, or possibly execute arbitrary commands or overwrite files, via an HTTP request containing an escape sequence for a terminal emulator."}, {"lang": "es", "value": "WEBrick v1.3.1 en Ruby v1.8.6 del patchlevel 383, v1.8.7 al patchlevel 248, v1.8.8dev, 1.9.1 al patchlevel 376, y v1.9.2dev ,escribe datos en un archivo de los sin depurar los caracteres no escribibles, lo que podr\u00eda permitir a atacantes remotos modificar la ventana de t\u00edtulo, o posiblemente ejecutar comandos de su elecci\u00f3n o sobrescribir archivos, a trav\u00e9s de una petici\u00f3n HTTP que contiene una secuencia de escape para el emulador de terminal."}], "vendorComments": [{"organization": "Red Hat", "comment": "Red Hat is aware of this issue and is tracking it via the following bug: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2009-4492\n\nThe Red Hat Security Response Team has rated this issue as having low security impact, a future update may address this flaw.\n", "lastModified": "2010-01-21T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:webrick:1.3.1:*:*:*:*:ruby:*:*", "matchCriteriaId": "A3987438-FB66-4B8A-A2E2-124139BC9216"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:a:ruby-lang:ruby:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.8.6", "versionEndIncluding": "1.8.6.383", "matchCriteriaId": "9D02C3E0-04FE-4200-944F-2EF327B8CC37"}, {"vulnerable": false, "criteria": "cpe:2.3:a:ruby-lang:ruby:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.8.7", "versionEndIncluding": "1.8.7.248", "matchCriteriaId": "0F4C4DE1-EDEF-49F4-81FE-6B9D25453300"}, {"vulnerable": false, "criteria": "cpe:2.3:a:ruby-lang:ruby:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.9.1", "versionEndIncluding": "1.9.1.376", "matchCriteriaId": "20792FA1-E46A-4BC1-81FD-E3C4660F2CC6"}]}]}], "references": [{"url": "http://secunia.com/advisories/37949", "source": "cve@mitre.org", "tags": ["Not Applicable", "Vendor Advisory"]}, {"url": "http://securitytracker.com/id?1023429", "source": "cve@mitre.org", "tags": ["Broken Link", "Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.redhat.com/support/errata/RHSA-2011-0908.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.redhat.com/support/errata/RHSA-2011-0909.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.ruby-lang.org/en/news/2010/01/10/webrick-escape-sequence-injection", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/508830/100/0/threaded", "source": "cve@mitre.org", "tags": ["Broken Link", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securityfocus.com/bid/37710", "source": "cve@mitre.org", "tags": ["Broken Link", "Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.ush.it/team/ush/hack_httpd_escape/adv.txt", "source": "cve@mitre.org", "tags": ["Broken Link", "Exploit"]}, {"url": "http://www.vupen.com/english/advisories/2010/0089", "source": "cve@mitre.org", "tags": ["Permissions Required"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2009-4492 - HTTP Request Smuggling to inject arbitrary escape sequences and potentially execute unauthorized commands or overwrite files"}, {"techniqueID": "T1190", "comment": "CVE-2009-4492 - URL Rewrite or Injection to exploit vulnerabilities in downstream applications"}, {"techniqueID": "T1192", "comment": "CVE-2009-4492 - Command Injection to execute arbitrary commands on the affected system"}], "stix_bundle": {"id": "vulnerability:cve-2009-4492", "type": "vulnerability", "spec_version": "2.1", "created_by_ref": "user:operator", "modified": "2023-08-01T18:59:27.303Z", "created": "2010-01-13T20:30:00.530Z", "name": "WEBrick Escape Sequence Injection", "description": "WEBrick 1.3.1 in Ruby 1.8.6 through patchlevel 383, 1.8.7 through patchlevel 248, 1.8.8dev, 1.9.1 through patchlevel 376, and 1.9.2dev writes data to a log file without sanitizing non-printable characters, which might allow remote attackers to modify a window's title, or possibly execute arbitrary commands or overwrite files, via an HTTP request containing an escape sequence for a terminal emulator.", "short_description": "WEBrick Escape Sequence Injection", "base_score": 7.5, "exploit_complexity": "LOW", "attack_vector": "NETWORK", "vulnerability_configuration": {"group_id": "vulnerability_group:cve-2009-4492", "description": "Configuration for the WEBrick Escape Sequence Injection vulnerability"}, "mitigation": [{"id": "mitigation: url-rewriting", "type": "mitigation-technique", "description": "URL rewriting to prevent HTTP request smuggling and injection"}], "detection": [{"id": "detection: log parsing", "type": "detection-technique", "description": "Parsing log files to detect potential HTTP request smuggling and injection attacks"}], "course_of_action": [{"id": "course_of_action: update-ruby", "type": "course_of_action", "description": "Update Ruby to a patched version to mitigate the vulnerability", "mitigates": [{"id": "technique: T1192", "type": "technique", "description": "Command Injection"}]}]}, "technical_analysis": {"Introduction": "The WEBrick Escape Sequence Injection vulnerability is a remote code execution vulnerability that affects WEBrick 1.3.1 in Ruby versions 1.8.6 to 1.8.8dev, 1.9.1 to 1.9.2dev.", "Impact and Scope": "The vulnerability allows remote attackers to execute arbitrary commands or overwrite files by injecting escape sequences into an HTTP request. The CVSS score for this vulnerability is 7.5, with a high severity rating due to the potential for remote code execution.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to MITRE ATT&CK techniques TA0001, T1190, and T1192, which describe HTTP Request Smuggling, URL Rewriting and Injection, and Command Injection, respectively.", "Technical Details": "The vulnerability occurs because WEBrick fails to sanitize non-printable characters in log files. An attacker can inject escape sequences into an HTTP request to execute arbitrary commands or overwrite files.", "Detection": "To detect this vulnerability, log files should be parsed for suspicious activity, and HTTP requests should be monitored for unusual patterns.", "Mitigation": "The vulnerability can be mitigated by updating Ruby to a patched version and configuring WEBrick to sanitize non-printable characters in log files.", "Conclusion": "In conclusion, the WEBrick Escape Sequence Injection vulnerability is a serious remote code execution vulnerability that should be prioritized for remediation."}, "executive_analysis": {"Overview": "The WEBrick Escape Sequence Injection vulnerability is a remote code execution vulnerability that affects WEBrick 1.3.1 in Ruby versions 1.8.6 to 1.8.8dev, 1.9.1 to 1.9.2dev.", "Business Impact": "The vulnerability poses a significant risk to organizations that use WEBrick, as it allows remote attackers to execute arbitrary commands or overwrite files.", "Technical Impact": "The vulnerability has a high technical impact due to the potential for remote code execution.", "Mitigation Strategies": "The vulnerability can be mitigated by updating Ruby to a patched version and configuring WEBrick to sanitize non-printable characters in log files.", "Recommendations": "We recommend that organizations prioritize remediation of this vulnerability, especially those that use WEBrick in their infrastructure.", "Conclusions": "In conclusion, the WEBrick Escape Sequence Injection vulnerability is a serious vulnerability that requires immediate attention and remediation."}}