{"id": "CVE-2024-28105", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-25T19:15:58.020", "lastModified": "2024-03-26T12:55:05.010", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "phpMyFAQ is an open source FAQ web application for PHP 8.1+ and MySQL, PostgreSQL and other databases. The category image upload function in phpmyfaq is vulnerable to manipulation of the `Content-type` and `lang` parameters, allowing attackers to upload malicious files with a .php extension, potentially leading to remote code execution (RCE) on the system. This vulnerability is fixed in 3.2.6."}, {"lang": "es", "value": "phpMyFAQ es una aplicaci\u00f3n web de preguntas frecuentes de c\u00f3digo abierto para PHP 8.1+ y MySQL, PostgreSQL y otras bases de datos. La funci\u00f3n de carga de im\u00e1genes de categor\u00eda en phpmyfaq es vulnerable a la manipulaci\u00f3n de los par\u00e1metros `Content-type` y `lang`, lo que permite a los atacantes cargar archivos maliciosos con una extensi\u00f3n .php, lo que potencialmente conduce a la ejecuci\u00f3n remota de c\u00f3digo (RCE) en el sistema. Esta vulnerabilidad se soluciona en 3.2.6."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-434"}]}], "references": [{"url": "https://github.com/thorsten/phpMyFAQ/commit/9136883776af67dfdb0e8cf14f5e0ca22bf4f2e7", "source": "security-advisories@github.com"}, {"url": "https://github.com/thorsten/phpMyFAQ/security/advisories/GHSA-pwh2-fpfr-x5gf", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1059.005", "comment": "CVE-2024-28105 is a vulnerability in the phpMyFAQ category image upload function, allowing threat actors to upload malicious files with a .php extension, potentially leading to RCE. This technique is relevant due to the exploitation of this vulnerability, which can be achieved by manipulating the `Content-type` and `lang` parameters. Defense points include validating user-uploaded files, limiting the types of files that can be uploaded, and limiting the directory that files are uploaded to."}, {"techniqueID": "T1190", "comment": "The vulnerability in phpMyFAQ allows for exploitation of this technique, as threat actors can upload malicious files to the server, which can then be executed, leading to RCE. Defense points include monitoring file uploads, reviewing file hashing, and implementing a web application firewall to block suspicious traffic."}, {"techniqueID": "T1193", "comment": "The vulnerability in phpMyFAQ can also be used to conduct this technique, as threat actors can manipulate the `Content-type` and `lang` parameters to upload malicious files. Defense points include validating user-uploaded files, validating the type of file uploaded, and limiting the directory that files are uploaded to."}], "technical_analysis": {"Introduction": "This vulnerability in phpMyFAQ is an open-source FAQ web application that allows for the upload of images to categories. However, it has been found to contain a vulnerability that allows for the manipulation of the `Content-type` and `lang` parameters, leading to the uploading of malicious files with a .php extension, potentially leading to remote code execution.", "Impact and Scope": "The vulnerability has been assigned a CVSS score of 7.2 (HIGH) with a CVSS version 3.1, attack vector being NETWORK. The vulnerability is exploitable remotely, allowing an attacker with high privileges to execute arbitrary code.", "Related MITRE ATT&CK Techniques": "T1059.005, T1190, T1193", "Technical Details": "The vulnerability occurs in the category image upload function in phpMyFAQ, where an attacker can manipulate the `Content-type` and `lang` parameters to upload malicious files with a .php extension. The vulnerability is fixed in version 3.2.6.", "Detection": "Detection can be achieved by monitoring file uploads, reviewing file hashing, and implementing a web application firewall to block suspicious traffic.", "Mitigation": "Mitigation strategies include validating user-uploaded files, validating the type of file uploaded, and limiting the directory that files are uploaded to.", "Conclusion": "In conclusion, this vulnerability in phpMyFAQ is a serious issue that requires immediate attention. The vulnerability can be exploited remotely, allowing an attacker with high privileges to execute arbitrary code."}, "executive_analysis": {"Overview": "This vulnerability in phpMyFAQ is a serious issue that requires immediate attention. The vulnerability allows for the uploading of malicious files with a .php extension, potentially leading to remote code execution.", "Business Impact": "The business impact of this vulnerability is significant, as it can be exploited remotely, allowing an attacker to execute arbitrary code, potentially damaging business reputation and financials.", "Technical Impact": "The technical impact of this vulnerability is the potential for remote code execution, allowing an attacker to execute arbitrary code, potentially accessing sensitive data and disrupting business operations.", "Mitigation Strategies": "Mitigation strategies include validating user-uploaded files, validating the type of file uploaded, and limiting the directory that files are uploaded to.", "Recommendations": "Recommendations for executives include prioritizing patching and updating the application, implementing additional security controls, and conducting regular security audits.", "Conclusions": "In conclusion, this vulnerability in phpMyFAQ is a serious issue that requires immediate attention. It is essential to prioritize patching and updating the application, implementing additional security controls, and conducting regular security audits to prevent potential exploitation."}}