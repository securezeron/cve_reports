{"id": "CVE-2024-39895", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-08T17:15:11.980", "lastModified": "2024-07-09T18:19:14.047", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Directus is a real-time API and App dashboard for managing SQL database content. A denial of service (DoS) attack by field duplication in GraphQL is a type of attack where an attacker exploits the flexibility of GraphQL to overwhelm a server by requesting the same field multiple times in a single query. This can cause the server to perform redundant computations and consume excessive resources, leading to a denial of service for legitimate users. Request to the endpoint /graphql are sent when visualizing graphs generated at a dashboard. By modifying the data sent and duplicating many times the fields a DoS attack is possible. This vulnerability is fixed in 10.12.0."}, {"lang": "es", "value": "Directus es una API y un panel de aplicaciones en tiempo real para administrar el contenido de la base de datos SQL. Un ataque de denegaci\u00f3n de servicio (DoS) por duplicaci\u00f3n de campos en GraphQL es un tipo de ataque en el que un atacante aprovecha la flexibilidad de GraphQL para abrumar a un servidor solicitando el mismo campo varias veces en una sola consulta. Esto puede hacer que el servidor realice c\u00e1lculos redundantes y consuma recursos excesivos, lo que lleva a una denegaci\u00f3n de servicio para usuarios leg\u00edtimos. La solicitud al endpoint /graphql se env\u00eda al visualizar gr\u00e1ficos generados en un panel. Modificando los datos enviados y duplicando muchas veces los campos es posible un ataque DoS. Esta vulnerabilidad se solucion\u00f3 en 10.12.0."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-400"}]}], "references": [{"url": "https://github.com/directus/directus/commit/543b345695071c1de61a35004bd063fe59dba0c8", "source": "security-advisories@github.com"}, {"url": "https://github.com/directus/directus/security/advisories/GHSA-7hmh-pfrp-vcx4", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-39895 - An attacker could exploit this vulnerability to overwhelm a server by requesting the same field multiple times in a single query, leading to a denial of service for legitimate users. This technique can be used to perform a GraphQL-based denial of service attack."}, {"techniqueID": "T1040", "comment": "CVE-2024-39895 - An attacker could also utilize this vulnerability to inject malicious data and manipulate the GraphQL query, potentially leading to exploitation and data breaches. This technique can be used to perform data manipulation and exfiltration."}], "stix_bundle": {"objects": [{"id": "vulnerability:cve-2024-39895", "type": "vulnerability", "description": "Directus is a real-time API and App dashboard for managing SQL database content. A denial of service (DoS) attack by field duplication in GraphQL is a type of attack where an attacker exploits the flexibility of GraphQL to overwhelm a server by requesting the same field multiple times in a single query.", "cve": "CVE-2024-39895", "relevant_knowledge_base_references": [{"id": "directus-directus-commit-543b345695071c1de61a35004bd063fe59dba0c8", "type": "commit", "name": "Directus - CVE-2024-39895 Fix Commit", "description": "Fixed denial of service vulnerability by input validation"}, {"id": "directus-directus-security-advisories-GHSA-7hmh-pfrp-vcx4", "type": "security-advisory", "name": "Directus - CVE-2024-39895 Security Advisory", "description": "Published security advisory for CVE-2024-39895 vulnerability"}], "related_stix_objects": [{"type": "attack-pattern", "id": "attack-pattern:t1190", "name": "GraphQL-Based Denial of Service Attack", "description": "An attack pattern that uses the flexibility of GraphQL to overwhelm a server by requesting the same field multiple times in a single query."}, {"type": "attack-pattern", "id": "attack-pattern:t1040", "name": "Data Manipulation and Exfiltration", "description": "An attack pattern that utilizes a vulnerability to inject malicious data and manipulate the GraphQL query, potentially leading to exploitation and data breaches."}, {"type": "course-of-action", "id": "course-of-action:k3wn", "name": "Input Validation", "description": "Validate user input to prevent malicious data from being injected into the GraphQL query."}]}]}, "technical_analysis": {"Introduction": "Directus is a real-time API and App dashboard for managing SQL database content, and it has been found to have a denial of service vulnerability in its GraphQL implementation.", "Impact and Scope": "This vulnerability allows an attacker to overwhelm a server by requesting the same field multiple times in a single query, leading to a denial of service for legitimate users. The CVSS 3.1 score is 6.5 with an attack vector of NETWORK, and the attack complexity is LOW.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190 and T1040, which describe GraphQL-based denial of service attacks and data manipulation/exfiltration, respectively.", "Technical Details": "The vulnerability occurs when an attacker can inject malicious data into the GraphQL query, allowing them to overwhelm the server and cause a denial of service.", "Detection": "Detection of this vulnerability involves monitoring for repetitive and redundant queries to the GraphQL endpoint, and implementing input validation to prevent malicious data from being injected.", "Mitigation": "Mitigation strategies include implementing input validation, rate limiting queries to the GraphQL endpoint, and monitoring for repetitive and redundant queries.", "Conclusion": "In conclusion, the Directus GraphQL denial of service vulnerability (CVE-2024-39895) is a critical issue that requires immediate attention and remediation to prevent exploitation."}, "executive_analysis": {"Overview": "The Directus GraphQL denial of service vulnerability (CVE-2024-39895) is a high-severity issue that poses a significant risk to organizations using the Directus platform.", "Business Impact": "The impact of this vulnerability could be severe, resulting in service disruptions, data breaches, and lost productivity.", "Technical Impact": "The technical impact of this vulnerability is the potential for an attacker to exploit it and cause a denial of service, resulting in the server being unavailable to legitimate users.", "Mitigation Strategies": "To mitigate this vulnerability, organizations should implement input validation, rate limiting queries to the GraphQL endpoint, and monitor for repetitive and redundant queries.", "Recommendations": "We recommend that organizations using Directus take immediate action to remediate this vulnerability by updating to the latest version of Directus and implementing the recommended mitigation strategies.", "Conclusions": "In conclusion, the Directus GraphQL denial of service vulnerability (CVE-2024-39895) is a critical issue that requires immediate attention and remediation to prevent exploitation and protect organizations from potential attacks."}}