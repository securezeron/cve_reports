{"id": "CVE-2024-37843", "sourceIdentifier": "cve@mitre.org", "published": "2024-06-25T21:15:59.770", "lastModified": "2024-08-01T13:54:21.843", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Craft CMS up to v3.7.31 was discovered to contain a SQL injection vulnerability via the GraphQL API endpoint."}, {"lang": "es", "value": "Se descubri\u00f3 que Craft CMS hasta v3.7.31 conten\u00eda una vulnerabilidad de inyecci\u00f3n SQL a trav\u00e9s del endpoint de la API GraphQL."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.7.31", "matchCriteriaId": "C8AAE5DF-2812-42E9-B484-A194A4DD3C99"}]}]}], "references": [{"url": "https://blog.smithsecurity.biz/craft-cms-unauthenticated-sqli-via-graphql", "source": "cve@mitre.org", "tags": ["Broken Link"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-37843 - This vulnerability can be exploited by an attacker to inject malicious SQL code, which can lead to unauthorized data access, data tampering, and denial-of-service attacks. DEFEND against this by implementing proper escape mechanisms and input validation to prevent SQL injection attacks."}, {"techniqueID": "T1091", "comment": "CVE-2024-37843 - This vulnerability can be exploited by an attacker to inject malicious GraphQL queries, which can lead to unauthorized data access and data tampering. DEFEND against this by implementing proper input validation and sanitization to prevent GraphQL injection attacks."}, {"techniqueID": "T1199", "comment": "CVE-2024-37843 - This vulnerability can be exploited by an attacker to gain unauthorized access to the Craft CMS database, which can lead to sensitive data exposure. DEFEND against this by implementing proper authentication and authorization mechanisms to prevent unauthorized database access."}], "stix_bundle": {"spec_version": "2.1", "type": "bundle", "id": "https://example.com/stix_bundle:CVE-2024-37843", "created_by_ref": "https://example.com/identity:my Identity", "created": "2024-08-01T13:54:21.843", "modified": "2024-08-01T13:54:21.843", "labels": ["CVE-2024-37843", "Craft CMS", "SQL Injection", "GraphQL Injection"], "objects": [{"id": "https://example.com/cve:CVE-2024-37843", "type": "indicator", "created_by_ref": "https://example.com/identity:my Identity", "created": "2024-08-01T13:54:21.843", "modified": "2024-08-01T13:54:21.843", "name": "CVE-2024-37843", "description": "Craft CMS up to v3.7.31 was discovered to contain a SQL injection vulnerability via the GraphQL API endpoint.", "valid.from": "2024-06-25T21:15:59.770", "valid.to": "2024-08-01T13:54:21.843", "severity": "high", "schema_version": "2.1"}, {"id": "https://example.com/attack_pattern:T1190", "type": "attack-pattern", "created_by_ref": "https://example.com/identity:my Identity", "created": "2024-08-01T13:54:21.843", "modified": "2024-08-01T13:54:21.843", "name": "SQL Injection", "description": "An attacker injects malicious SQL code into a database to extract or modify sensitive data.", "labels": ["T1190", "SQL Injection"], "objects": [{"id": "https://example.com/course_of_action:Mitigate SQL Injection", "type": "course-of-action", "name": "Mitigate SQL Injection", "description": "Implement proper escape mechanisms and input validation to prevent SQL injection attacks."}]}, {"id": "https://example.com/attack_pattern:T1091", "type": "attack-pattern", "created_by_ref": "https://example.com/identity:my Identity", "created": "2024-08-01T13:54:21.843", "modified": "2024-08-01T13:54:21.843", "name": "GraphQL Injection", "description": "An attacker injects malicious GraphQL queries to extract or modify sensitive data.", "labels": ["T1091", "GraphQL Injection"], "objects": [{"id": "https://example.com/course_of_action:Mitigate GraphQL Injection", "type": "course-of-action", "name": "Mitigate GraphQL Injection", "description": "Implement proper input validation and sanitization to prevent GraphQL injection attacks."}]}, {"id": "https://example.com/attack_pattern:T1199", "type": "attack-pattern", "created_by_ref": "https://example.com/identity:my Identity", "created": "2024-08-01T13:54:21.843", "modified": "2024-08-01T13:54:21.843", "name": "Unauthorized Database Access", "description": "An attacker gains unauthorized access to a database to extract or modify sensitive data.", "labels": ["T1199", "Unauthorized Database Access"], "objects": [{"id": "https://example.com/course_of_action:Prevent Unauthorized Database Access", "type": "course-of-action", "name": "Prevent Unauthorized Database Access", "description": "Implement proper authentication and authorization mechanisms to prevent unauthorized database access."}]}]}, "technical_analysis": {"Introduction": "This analysis provides an in-depth technical review of the CVE-2024-37843 vulnerability in Craft CMS.", "Impact and Scope": "The vulnerability affects Craft CMS up to v3.7.31 and can be exploited by an attacker to inject malicious SQL code, which can lead to unauthorized data access, data tampering, and denial-of-service attacks.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the T1190 SQL Injection, T1091 GraphQL Injection, and T1199 Unauthorized Database Access MITRE ATT&CK techniques.", "Technical Details": "The vulnerability occurs when user-input data is not properly sanitized, allowing an attacker to inject malicious SQL code into the database.", "Detection": "Detection is possible by monitoring database logs for unusual activity and implementing intrusion detection systems.", "Mitigation": "Mitigation strategies include implementing proper escape mechanisms and input validation to prevent SQL injection attacks, implementing proper input validation and sanitization to prevent GraphQL injection attacks, and implementing proper authentication and authorization mechanisms to prevent unauthorized database access.", "Conclusion": "In conclusion, CVE-2024-37843 is a critical vulnerability in Craft CMS that can be exploited by an attacker to gain unauthorized access to the database. Implementing proper mitigation strategies is essential to prevent exploitation."}, "executive_analysis": {"Overview": "This analysis provides an executive-level review of the CVE-2024-37843 vulnerability in Craft CMS.", "Business Impact": "The vulnerability can have significant business impact by allowing an attacker to extract sensitive data, disrupt business operations, and compromise compliance with regulatory requirements.", "Technical Impact": "The vulnerability can have significant technical impact by allowing an attacker to gain unauthorized access to the database, which can compromise data integrity and confidentiality.", "Mitigation Strategies": "Mitigation strategies include implementing proper security best practices, conducting regular security testing and vulnerability assessments, and ensuring compliance with regulatory requirements.", "Recommendations": "Recommendations for executives include prioritizing security testing and vulnerability remediation, conducting regular security awareness training for employees, and ensuring compliance with regulatory requirements.", "Conclusions": "In conclusion, CVE-2024-37843 is a critical vulnerability in Craft CMS that requires immediate attention and remediation to prevent exploitation and minimize business impact."}}