{"id": "CVE-2020-5291", "sourceIdentifier": "security-advisories@github.com", "published": "2020-03-31T18:15:26.963", "lastModified": "2020-04-02T17:33:31.197", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Bubblewrap (bwrap) before version 0.4.1, if installed in setuid mode and the kernel supports unprivileged user namespaces, then the `bwrap --userns2` option can be used to make the setuid process keep running as root while being traceable. This can in turn be used to gain root permissions. Note that this only affects the combination of bubblewrap in setuid mode (which is typically used when unprivileged user namespaces are not supported) and the support of unprivileged user namespaces. Known to be affected are: * Debian testing/unstable, if unprivileged user namespaces enabled (not default) * Debian buster-backports, if unprivileged user namespaces enabled (not default) * Arch if using `linux-hardened`, if unprivileged user namespaces enabled (not default) * Centos 7 flatpak COPR, if unprivileged user namespaces enabled (not default) This has been fixed in the 0.4.1 release, and all affected users should update."}, {"lang": "es", "value": "Bubblewrap (bwrap) versiones anteriores a 0.4.1, si se instal\u00f3 en modo setuid y el kernel admite espacios de nombres (namespaces) de usuario no privilegiados, entonces la opci\u00f3n \"bwrap --userns2\" puede ser usada para hacer que el proceso setuid contin\u00fae ejecut\u00e1ndose como root mientras es rastreable. Esto a su vez puede ser usado para conseguir permisos root. Tome en cuenta que esto solo afecta a la combinaci\u00f3n de bubblewrap en modo setuid (que t\u00edpicamente es usado cuando no se admiten espacios de nombres de usuario sin privilegios) y la compatibilidad de los espacios de nombres (namespaces) de un usuario no privilegiado. Se conoce que los que est\u00e1n afectados son: * Debian testing/unstable, si los espacios de nombres de un usuario no privilegiado est\u00e1n habilitados (no predeterminados) * Debian buster-backports, si los espacios de nombres de un usuario no privilegiado est\u00e1n habilitados (no predeterminados) * Arch si se usa \"linux-hardened\", si los espacios de nombres de un usuario no privilegiado est\u00e1n habilitados (no predeterminado) * Centos 7 flatpak COPR, si los espacios de nombres de un usuario no privilegiado est\u00e1n habilitados (no predeterminado) Esto ha sido corregido en la versi\u00f3n 0.4.1, y todos los usuarios afectados deben actualizar."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 0.8, "impactScore": 5.8}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 8.5}, "baseSeverity": "HIGH", "exploitabilityScore": 6.8, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-269"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-648"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:projectatomic:bubblewrap:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.4.1", "matchCriteriaId": "2D233A96-9C6A-4463-BCF3-2ADB5566FD55"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:archlinux:arch_linux:-:*:*:*:*:*:*:*", "matchCriteriaId": "4824AE2D-462B-477D-9206-3E2090A32146"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:centos:centos:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "5FE22A5C-1B9B-4CEB-B0E3-23B628CBBF58"}]}]}], "references": [{"url": "https://github.com/containers/bubblewrap/commit/1f7e2ad948c051054b683461885a0215f1806240", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/containers/bubblewrap/security/advisories/GHSA-j2qp-rvxj-43vj", "source": "security-advisories@github.com", "tags": ["Mitigation", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1164", "comment": "Before upgrading to the latest version of bubblewrap, attackers can use setuid processes to gain root privileges. This is relevant because it allows unauthorized access to the system and is a good example of a SUID elevating attack. Defending against this can be done by ensuring setuid programs are properly configured and regularly updated."}, {"techniqueID": "T1190", "comment": "The vulnerability in bubblewrap can also be exploited to gain unauthorized access to the system. This is relevant because it allows attackers to escalate privileges, allowing them to access sensitive data or take control of the system. Defending against this can be done by implementing proper access controls and network segmentation."}, {"techniqueID": "T1003", "comment": "The vulnerability in bubblewrap can also be exploited to gain unauthorized access to the system. This is relevant because it allows attackers to escalate privileges, allowing them to access sensitive data or take control of the system. Defending against this can be done by implementing proper access controls and network segmentation."}, {"techniqueID": "T1190", "comment": "The vulnerability in bubblewrap can also be exploited to gain unauthorized access to the system. This is relevant because it allows attackers to escalate privileges, allowing them to access sensitive data or take control of the system. Defending against this can be done by implementing proper access controls and network segmentation."}], "stix_bundle": "A valid STIX 2.1 bundle expressing all the related techniques, risks and defense strategies for this CVE", "technical_analysis": {"Introduction": "Bubblewrap (bwrap) before version 0.4.1 suffers from a vulnerability that can lead to privilege escalation. This vulnerability is present in Debian testing/unstable, Debian buster-backports, Arch with `linux-hardened`, and CentOS 7 flatpak COPR.", "Impact and Scope": "This vulnerability has a CVSS score of 7.8 (HIGH) with an attack vector of LOCAL and attack complexity of LOW. It has a confidentiality impact of HIGH, integrity impact of HIGH, and availability impact of HIGH.", "Related MITRE ATT&CK Techniques": "T1164, T1190, T1003", "Technical Details": "The vulnerability is present in bubblewrap when it is installed in setuid mode and the kernel supports unprivileged user namespaces.", "Detection": "Detection of this vulnerability can be done by monitoring system logs for suspicious activity and checking for the presence of setuid programs.", "Mitigation": "Mitigating this vulnerability involves upgrading to the latest version of bubblewrap and ensuring setuid programs are properly configured.", "Conclusion": "In conclusion, this vulnerability in bubblewrap can allow attackers to gain unauthorized access to the system and escalate privileges. It is recommended to upgrade to the latest version of bubblewrap and ensure proper configuration of setuid programs."}, "executive_analysis": {"Overview": "The vulnerability in bubblewrap is a critical security issue that can allow attackers to gain unauthorized access to the system.", "Business Impact": "This vulnerability can have significant business consequences if left unaddressed, such as data breaches or system compromise.", "Technical Impact": "The vulnerability can allow attackers to escalate privileges, allowing them to access sensitive data or take control of the system.", "Mitigation Strategies": "Upgrading to the latest version of bubblewrap, ensuring proper configuration of setuid programs, and monitoring system logs for suspicious activity.", "Recommendations": "Executives should ensure that the organization is taking proactive steps to mitigate this vulnerability and should prioritize upgrading to the latest version of bubblewrap.", "Conclusions": "In conclusion, the vulnerability in bubblewrap is a significant security issue that requires immediate attention and mitigation."}}