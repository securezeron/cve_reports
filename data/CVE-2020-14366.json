{"id": "CVE-2020-14366", "sourceIdentifier": "secalert@redhat.com", "published": "2020-11-09T17:15:12.597", "lastModified": "2023-11-07T03:17:11.410", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability was found in keycloak, where path traversal using URL-encoded path segments in the request is possible because the resources endpoint applies a transformation of the url path to the file path. Only few specific folder hierarchies can be exposed by this flaw"}, {"lang": "es", "value": "Se encontr\u00f3 una vulnerabilidad en keycloak, donde es posible un salto de ruta usando segmentos de ruta codificados con una URL en la petici\u00f3n porque el endpoint de recursos aplica una transformaci\u00f3n de la ruta de la URL a la ruta del archivo.&#xa0;Solo algunas jerarqu\u00edas de carpetas espec\u00edficas pueden ser expuestas con este fallo"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.2, "impactScore": 4.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}, {"source": "secalert@redhat.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:keycloak:*:*:*:*:*:*:*:*", "versionEndExcluding": "12.0.0", "matchCriteriaId": "859EC983-D6F0-42B2-A6B0-B3887FE4CC00"}]}]}], "references": [{"url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-14366", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": " CVE-2020-14366 - A Remote File Inclusion vulnerability is often the initial step in an attack where attackers exploit the vulnerability to gain access to the system. This can lead to further exploitation of other vulnerabilities, data exfiltration, and other malicious activities."}, {"techniqueID": "TA0002", "comment": " CVE-2020-14366 - Lateral movement is a common tactic used by attackers to spread malware, steal data, or move from one system to another. In this case, an attacker can use the file inclusion vulnerability to move laterally within the network and gain access to other systems."}, {"techniqueID": "TA0005", "comment": " CVE-2020-14366 - Command and Control is a critical aspect of an attack campaign. An attacker can use the file inclusion vulnerability to deliver malicious code, which can then communicate with other systems or send stolen data back to the attacker."}, {"techniqueID": "T1027", "comment": " CVE-2020-14366 - Data Stolen From Process Memory is a common tactic used by attackers to steal sensitive data. In this case, an attacker can use the file inclusion vulnerability to gain access to the system and steal data from process memory."}, {"techniqueID": "TA0030", "comment": " CVE-2020-14366 - Defense Evasion is a tactics used by attackers to avoid detection by security tools. In this case, an attacker can use the file inclusion vulnerability to evade detection by hiding malicious code or hiding the malicious activity from logs."}], "technical_analysis": {"Introduction": "A remote file inclusion vulnerability in Keycloak allows attackers to include arbitrary files from the server or other malicious sources, leading to unauthorized access and potential data theft.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N) and affects Keycloak versions prior to 12.0.0.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK Techniques TA0001, TA0002, TA0005, T1027, and TA0030.", "Technical Details": "The vulnerability is due to the server's failure to properly validate and sanitize user-supplied input, allowing an attacker to inject arbitrary code into the server's file system.", "Detection": "This vulnerability can be detected by monitoring system logs for suspicious file inclusions and traffic anomalies.", "Mitigation": "To mitigate this vulnerability, users should upgrade to the latest version of Keycloak (12.0.0 or later) and implement strict input validation and sanitization.", "Conclusion": "In conclusion, the remote file inclusion vulnerability in Keycloak is a significant threat that can lead to unauthorized access and data theft. It is essential to stay up-to-date with software updates and implement effective security measures to prevent such attacks."}, "executive_analysis": {"Overview": "The remote file inclusion vulnerability in Keycloak is a critical issue that requires immediate attention.", "Business Impact": "The vulnerability can lead to significant business disruption, financial loss, and reputational damage.", "Technical Impact": "The vulnerability can be exploited to gain unauthorized access to sensitive data and perpetrate further attacks.", "Mitigation Strategies": "Implementing strict input validation and sanitization, monitoring system logs, and upgrading to the latest version of Keycloak can effectively mitigate this vulnerability.", "Recommendations": "We recommend that executives prioritize the implementation of these mitigation strategies to prevent this vulnerability from being exploited.", "Conclusions": "In conclusion, the remote file inclusion vulnerability in Keycloak is a serious issue that requires immediate attention and action."}}