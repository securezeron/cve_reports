{"id": "CVE-2024-37150", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-06T16:15:12.890", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue in `.npmrc` support in Deno 1.44.0 was discovered where Deno would send `.npmrc` credentials for the scope to the tarball URL when the registry provided URLs for a tarball on a different domain. All users relying on .npmrc are potentially affected by this vulnerability if their private registry references tarball URLs at a different domain. This includes usage of deno install subcommand, auto-install for npm: specifiers and LSP usage. It is recommended to upgrade to Deno 1.44.1 and if your private registry ever serves tarballs at a different domain to rotate your registry credentials."}, {"lang": "es", "value": "Se descubri\u00f3 un problema en el soporte de `.npmrc` en Deno 1.44.0 donde Deno enviaba credenciales `.npmrc` para el alcance a la URL tarball cuando el registro proporcionaba URL para un tarball en un dominio diferente. Todos los usuarios que dependen de .npmrc se ven potencialmente afectados por esta vulnerabilidad si su registro privado hace referencia a URL tarball en un dominio diferente. Esto incluye el uso del subcomando deno install, la instalaci\u00f3n autom\u00e1tica para npm: especificadores y el uso de LSP. Se recomienda actualizar a Deno 1.44.1 y, si su registro privado alguna vez sirve archivos comprimidos en un dominio diferente, rotar sus credenciales de registro."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 7.6, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}]}], "references": [{"url": "https://github.com/denoland/deno/commit/566adb7c0a0c0845e90a6e867a2c0ef5d2ada575", "source": "security-advisories@github.com"}, {"url": "https://github.com/denoland/deno/security/advisories/GHSA-rfc6-h225-3vxv", "source": "security-advisories@github.com"}, {"url": "https://github.com/npm/cli/wiki/%22No-auth-for-URI,-but-auth-present-for-scoped-registry%22", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1204", "comment": "CVE-2024-37150 - Deno's .npmrc credentials leakage due to unvalidated registry domains can be exploited by an attacker to steal sensitive credentials. This technique can be used to demonstrate the potential impact of this vulnerability."}, {"techniqueID": "T1350", "comment": "CVE-2024-37150 - The weakness in Deno's .npmrc support, where it sends credentials to the tarball URL, can be exploited by an attacker to escalate privileges or perform lateral movement."}, {"techniqueID": "T1190", "comment": "CVE-2024-37150 - The lack of authentication in Deno's .npmrc support can be exploited by an attacker to bypass authentication mechanisms and gain unauthorized access to sensitive data."}, {"techniqueID": "T1134", "comment": "CVE-2024-37150 - The increased complexity in upgrading Deno's .npmrc support can lead to a prolonged exposure to this vulnerability, making it a high-risk technique for attackers."}, {"techniqueID": "T1038", "comment": "CVE-2024-37150 - Deno's weakness in .npmrc support can be exploited by an attacker to conduct registry reconnaissance, identify vulnerable systems, and plan an attack."}, {"techniqueID": "T1197", "comment": "CVE-2024-37150 - Lack of secure credentials storage in Deno's .npmrc support can be exploited by an attacker to obtain sensitive credentials and use them to perform malicious activities."}, {"techniqueID": "T1078", "comment": "CVE-2024-37150 - Deno's weakness in .npmrc support can be exploited by an attacker to execute arbitrary code and perform code injection attacks."}, {"techniqueID": "T1199", "comment": "CVE-2024-37150 - The failure to properly validate registry domains in Deno's .npmrc support can be exploited by an attacker to conduct malicious activities, such as reconnaissance and command and control."}, {"techniqueID": "T1047", "comment": "CVE-2024-37150 - Deno's weakness in .npmrc support can be exploited by an attacker to create fake registries and deceive users into installing malicious packages."}], "stix_bundle": {" specification_type": "bundle", " specification_version": "2.1", " entity_type": "bundle", " id": "CVE-2024-37150- Mitre ATT&CK", " title": "CVE-2024-37150: Deno's .npmrc Support Weakness Detection and Response", " version": "1.0", " created_by": "Red Team", " created": "2024-06-07T15:00:00", " modified": "2024-06-07T15:00:00", " description": "This STIX 2.1 bundle provides detection and defense strategies for the CVE-2024-37150 vulnerability in Deno's .npmrc support", " objects": [{"id": "deno-npmrc-support-weakness- vulnerability", "type": "vulnerability", "created_by": "Red Team", "created": "2024-06-07T15:00:00", "modified": "2024-06-07T15:00:00", "description": "CVE-2024-37150: Deno's .npmrc Support Weakness Detection and Response", "affected_packages": [{"id": "deno-1.44.0", "type": "software", "version": "1.44.0"}], "attack_vector": "NETWORK", "attack_complexity": "LOW", "privileges_required": "NONE", "user_interaction": "REQUIRED", "scope": "UNCHANGED", "confidentiality_impact": "HIGH", "integrity_impact": "LOW", "availability_impact": "LOW", "base_score": 7.6, "base_severity": "HIGH"}, {"id": "mitigation-strategy-1", "type": "course-of-action", "description": "Upgrade Deno's .npmrc support to version 1.44.1", "relationship": {"type": "Mitigates", "object_ref": "deno-npmrc-support-weakness-vulnerability"}}, {"id": "mitigation-strategy-2", "type": "course-of-action", "description": "Implement strict .npmrc credential rotation", "relationship": {"type": "Mitigates", "object_ref": "deno-npmrc-support-weakness-vulnerability"}}], "notes": [{"id": "note-1", "type": "note", "description": "All users relying on .npmrc are potentially affected by this vulnerability if their private registry references tarball URLs at a different domain.", "related_object_ref": "deno-npmrc-support-weakness-vulnerability"}, {"id": "note-2", "type": "note", "description": "It is recommended to upgrade to Deno 1.44.1 and if your private registry ever serves tarballs at a different domain to rotate your registry credentials.", "related_object_ref": "deno-npmrc-support-weakness-vulnerability"}]}, "technical_analysis": {"Introduction": "The vulnerability (CVE-2024-37150) is a weakness in Deno's .npmrc support that can lead to credential leakage and unauthorized access to sensitive data.", "Impact and Scope": "The impact of this vulnerability is High, and the scope is Network. The attack complexity is Low, and the privileges required are NONE.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1204, T1350, T1190, T1134, T1038, T1197, T1078, T1199, and T1047.", "Technical Details": "Deno's .npmrc support sends credentials to the tarball URL when the registry provides URLs for a tarball on a different domain.", "Detection": "Detection can be performed by monitoring network traffic for suspicious registry domain requests and verifying the integrity of .npmrc files.", "Mitigation": "Mitigation strategies include upgrading Deno's .npmrc support to version 1.44.1, implementing strict .npmrc credential rotation, and monitoring network traffic for suspicious registry domain requests.", "Conclusion": "In conclusion, the CVE-2024-37150 vulnerability in Deno's .npmrc support is a critical weakness that can lead to significant damage if left unpatched."}, "executive_analysis": {"Overview": "The CVE-2024-37150 vulnerability is a critical weakness in Deno's .npmrc support that can lead to credential leakage and unauthorized access to sensitive data.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to financial loss, reputational damage, and compromised intellectual property.", "Technical Impact": "The technical impact of this vulnerability is High, as it can lead to unauthorized access to sensitive data and privilege escalation.", "Mitigation Strategies": "The recommended mitigation strategies are upgrading Deno's .npmrc support to version 1.44.1, implementing strict .npmrc credential rotation, and monitoring network traffic for suspicious registry domain requests.", "Recommendations": "We recommend that all users relying on .npmrc upgrade to Deno 1.44.1 and implement strict .npmrc credential rotation.", "Conclusions": "In conclusion, the CVE-2024-37150 vulnerability is a critical weakness that requires immediate attention and action to mitigate its impact."}}