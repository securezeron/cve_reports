{"id": "CVE-2024-2221", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-10T17:15:54.633", "lastModified": "2024-04-10T19:49:51.183", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "qdrant/qdrant is vulnerable to a path traversal and arbitrary file upload vulnerability via the `/collections/{COLLECTION}/snapshots/upload` endpoint, specifically through the `snapshot` parameter. This vulnerability allows attackers to upload and overwrite any file on the filesystem, leading to potential remote code execution. This issue affects the integrity and availability of the system, enabling unauthorized access and potentially causing the server to malfunction."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-434"}]}], "references": [{"url": "https://github.com/qdrant/qdrant/commit/e6411907f0ecf3c2f8ba44ab704b9e4597d9705d", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/6be8d4e3-67e6-4660-a8db-04215a1cff3e", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-2221 - Path traversal and arbitrary file upload vulnerability may allow an attacker to upload and overwrite files on the filesystem, leading to potential remote code execution. This is relevant as it can be used to exploit other vulnerabilities or introduce malware, and can be defended against by ensuring proper validation of user input and restricting file uploads."}, {"techniqueID": "T1203", "comment": "CVE-2024-2221 - Path traversal and arbitrary file upload vulnerability may allow an attacker to read or write files on the filesystem, which can be used to exfiltrate data or introduce malicious code. This is relevant as it can be used to exfiltrate sensitive data, and can be defended against by ensuring proper validation of user input and restricting file uploads."}, {"techniqueID": "T1613", "comment": "CVE-2024-2221 - Path traversal and arbitrary file upload vulnerability may allow an attacker to introduce a web shell or other malware, which can be used to maintain persistence or pivot to other systems. This is relevant as it can be used to maintain an initial foothold in the network, and can be defended against by ensuring proper validation of user input and restricting file uploads."}, {"techniqueID": "D3F6", "comment": "CVE-2024-2221 - The vulnerability can be exploited to introduce a web shell or other malware, which can be used to maintain persistence or pivot to other systems. This can be defended against by implementing a web application firewall (WAF) to detect and block suspicious traffic, and by implementing a memory protection technique to prevent exploitation."}, {"techniqueID": "D3F9", "comment": "CVE-2024-2221 - The vulnerability can be exploited to exfiltrate data, which can be used to compromise sensitive information. This can be defended against by implementing a data loss prevention (DLP) system to detect and prevent data exfiltration, and by implementing encryption to prevent unauthorized access to sensitive data."}], "stix_bundle": {"Bundle": {"type": "software_bundle", "id": "bundle--cve-2024-2221", "created_by_ref": "identity--cve-2024-2221-author", "published": "2024-04-10T17:15:54.633", "updated": "2024-04-10T19:49:51.183", "objects": [{"type": "indicator", "id": "indicator--cve-2024-2221", "created_by_ref": "identity--cve-2024-2221-author", "source_data_identifier": "CVE-2024-2221", "description": [{"lang": "en", "value": "Path traversal and arbitrary file upload vulnerability in qdrant/qdrant"}], "filter": "uri CONTAINS `/collections/{COLLECTION}/snapshots/upload`", " observed_data": {"observed_data": {"file": "qdrant/qdrant/snaphots/upload.js", "request": "POST /collections/{COLLECTION}/snapshots/upload"}}}, {"type": "note", "id": "note--cve-2024-2221", "created_by_ref": "identity--cve-2024-2221-author", "content": [{"lang": "en", "value": "This vulnerability can be exploited to introduce a web shell or other malware, which can be used to maintain persistence or pivot to other systems."}]}], "relationships": [{"id": "rel--cve-2024-2221", "type": "has_observed_data", "from": "indicator--cve-2024-2221", "to": "observed_data--cve-2024-2221"}, {"id": "rel--cve-2024-2221", "type": "has_note", "from": "indicator--cve-2024-2221", "to": "note--cve-2024-2221"}]}}, "technical_analysis": {"Introduction": "CVE-2024-2221 is a path traversal and arbitrary file upload vulnerability in qdrant/qdrant, which can be used to exploit other vulnerabilities or introduce malware.", "Impact and Scope": "This vulnerability has a CVSS score of 9.8 (CRITICAL) and can be used to compromise sensitive data or introduce malware.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to CVE-2024-2221: T1190, T1203, T1613, D3F6, and D3F9.", "Technical Details": "The vulnerability is caused by a lack of proper validation of user input, allowing an attacker to upload and overwrite files on the filesystem.", "Detection": "The vulnerability can be detected by monitoring for suspicious traffic and unusual file uploads.", "Mitigation": "The vulnerability can be mitigated by ensuring proper validation of user input, restricting file uploads, and implementing a web application firewall (WAF) to detect and block suspicious traffic.", "Conclusion": "CVE-2024-2221 is a critical vulnerability that can be used to compromise sensitive data or introduce malware, and requires prompt attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-2221 is a critical vulnerability in qdrant/qdrant that can be used to compromise sensitive data or introduce malware.", "Business Impact": "The vulnerability can have significant business impact, including data breaches, loss of intellectual property, and compromise of sensitive systems.", "Technical Impact": "The vulnerability can be exploited to introduce a web shell or other malware, which can be used to maintain persistence or pivot to other systems.", "Mitigation Strategies": "Implementing proper validation of user input, restricting file uploads, and implementing a web application firewall (WAF) can help mitigate the vulnerability.", "Recommendations": "Executives should prioritize addressing this vulnerability and ensure that proper mitigation strategies are in place.", "Conclusions": "CVE-2024-2221 is a critical vulnerability that requires prompt attention and mitigation to avoid potential business impact."}}