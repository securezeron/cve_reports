{"id": "CVE-2015-9236", "sourceIdentifier": "support@hackerone.com", "published": "2018-05-31T20:29:00.360", "lastModified": "2019-10-09T23:15:57.883", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Hapi versions less than 11.0.0 implement CORS incorrectly and allowed for configurations that at best returned inconsistent headers and at worst allowed cross-origin activities that were expected to be forbidden. If the connection has CORS enabled but one route has it off, and the route is not GET, the OPTIONS prefetch request will return the default CORS headers and then the actual request will go through and return no CORS headers. This defeats the purpose of turning CORS on the route."}, {"lang": "es", "value": "Hapi, en versiones anteriores a la 11.0.0, implementa CORS incorrectamente y permite configuraciones que devuelven cabeceras inconsistentes y, en el peor de los casos, permite actividades Cross-Origin que se espera que est\u00e9n prohibidas. Si la conexi\u00f3n tiene CORS habilitado pero una ruta no la tiene (y, adem\u00e1s, la ruta no es GET), la petici\u00f3n prefetch OPTIONS devolver\u00e1 las cabeceras CORS por defecto y, despu\u00e9s, la petici\u00f3n real pasar\u00e1 y no devolver\u00e1 cabeceras CORS. Esto contradice la finalidad de habilitar CORS en la ruta."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": true, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}, {"source": "support@hackerone.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-284"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hapijs:hapi:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "11.0.0", "matchCriteriaId": "1A8F75AB-20F3-46E7-AB01-F771B607E8A0"}]}]}], "references": [{"url": "https://github.com/hapijs/hapi/issues/2840", "source": "support@hackerone.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/hapijs/hapi/issues/2850", "source": "support@hackerone.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://nodesecurity.io/advisories/45", "source": "support@hackerone.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2015-9236 - This technique can be used to exploit the cross-origin request smuggling vulnerability in Hapi versions less than 11.0.0."}, {"techniqueID": "T1060", "comment": "CVE-2015-9236 - The misconfigured CORS headers allows an attacker to bypass the intended security controls."}, {"techniqueID": "T1474", "comment": "CVE-2015-9236 - The attack vector is network-based and requires no user interaction, making it a significant threat if not properly mitigated."}, {"techniqueID": "T1191", "comment": "CVE-2015-9236 - The CORS configuration issue allows for cross-origin activities that were expected to be forbidden."}], "stix_bundle": {"timeline": {"marks": [{"value": "2018-05-31T20:29:00.360", "type": "created"}]}, "objects": [{"id": "vuln:CVE-2015-9236", "type": "vulnerability", "name": "Hapi CORS Configuration Issue", "description": "A cross-origin request smuggling vulnerability in Hapi versions less than 11.0.0.", "created": "2018-05-31T20:29:00.360", "modified": "2019-10-09T23:15:57.883"}, {"id": "attack-pattern:T1210", "type": "attack-pattern", "name": "Reliable Data Writing", "description": "Writing data to a reliable location."}, {"id": "attack-pattern:T1060", "type": "attack-pattern", "name": "Email Large File", "description": "Emailing a large file."}, {"id": "attack-pattern:T1474", "type": "attack-pattern", "name": "Network Sniffing", "description": "Capturing network traffic."}, {"id": "attack-pattern:T1191", "type": "attack-pattern", "name": "Exploit Public-Facing Application", "description": "Exploiting publicly facing web applications."}, {"id": "course-of-action:mitigate-cwe-200", "type": "course-of-action", "name": "Mitigate CWE-200", "description": "Implement secure CORS configuration in Hapi.", "related_object": "vuln:CVE-2015-9236"}, {"id": "course-of-action:mitigate-cwe-284", "type": "course-of-action", "name": "Mitigate CWE-284", "description": "Implement secure CORS configuration in Hapi.", "related_object": "vuln:CVE-2015-9236"}], "relationship": [{"id": "relation-1", "type": "related-to", "object_ref": "vuln:CVE-2015-9236", "object": "attack-pattern:T1210", "label": "exploits"}, {"id": "relation-2", "type": "related-to", "object_ref": "vuln:CVE-2015-9236", "object": "attack-pattern:T1060", "label": "vulnerable-to"}, {"id": "relation-3", "type": "related-to", "object_ref": "vuln:CVE-2015-9236", "object": "attack-pattern:T1474", "label": "vulnerable-to"}, {"id": "relation-4", "type": "related-to", "object_ref": "vuln:CVE-2015-9236", "object": "attack-pattern:T1191", "label": "vulnerable-to"}, {"id": "relation-5", "type": "mitigates", "object_ref": "vuln:CVE-2015-9236", "object": "course-of-action:mitigate-cwe-200", "label": "mitigates"}, {"id": "relation-6", "type": "mitigates", "object_ref": "vuln:CVE-2015-9236", "object": "course-of-action:mitigate-cwe-284", "label": "mitigates"}]}, "technical_analysis": {"Introduction": "The Hapi CORS configuration issue is a serious vulnerability that allows for cross-origin activities that were expected to be forbidden.", "Impact and Scope": "The vulnerability allows an attacker to bypass the intended security controls and exploit the cross-origin request smuggling vulnerability in Hapi versions less than 11.0.0.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1210, T1060, T1474, and T1191.", "Technical Details": "The vulnerability occurs when the CORS configuration is misconfigured, allowing an attacker to craft a request that is treated as if it were made from a different origin.", "Detection": " Detection methods include monitoring for unusual network traffic patterns and analyzing error messages for signs of malicious activity.", "Mitigation": "Mitigation strategies include implementing secure CORS configuration in Hapi, monitoring network traffic for unusual patterns, and implementing security controls to prevent cross-origin requests.", "Conclusion": "The Hapi CORS configuration issue is a serious vulnerability that requires immediate attention. Implementing secure CORS configuration and monitoring network traffic for unusual patterns are key mitigation strategies."}, "executive_analysis": {"Overview": "The Hapi CORS configuration issue is a serious vulnerability that can allow an attacker to bypass security controls and exploit the cross-origin request smuggling vulnerability.", "Business Impact": "The vulnerability can have a significant business impact, as it can allow an attacker to access sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability can have a significant technical impact, as it can allow an attacker to exploit the cross-origin request smuggling vulnerability and access sensitive data.", "Mitigation Strategies": "Implementing secure CORS configuration, monitoring network traffic for unusual patterns, and implementing security controls to prevent cross-origin requests are key mitigation strategies.", "Recommendations": "Recommendations for executives include implementing secure CORS configuration, monitoring network traffic for unusual patterns, and implementing security controls to prevent cross-origin requests.", "Conclusions": "The Hapi CORS configuration issue is a serious vulnerability that requires immediate attention. Implementing secure CORS configuration and monitoring network traffic for unusual patterns are key mitigation strategies for executives."}}