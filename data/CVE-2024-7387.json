{
    "id": "CVE-2024-7387",
    "sourceIdentifier": "secalert@redhat.com",
    "published": "2024-09-17T00:15:52.757",
    "lastModified": "2024-10-03T21:15:08.593",
    "vulnStatus": "Awaiting Analysis",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "A flaw was found in openshift/builder. This vulnerability allows command injection via path traversal, where a malicious user can execute arbitrary commands on the OpenShift node running the builder container. When using the \u201cDocker\u201d strategy, executable files inside the privileged build container can be overridden using the `spec.source.secrets.secret.destinationDir` attribute of the `BuildConfig` definition. An attacker running code in a privileged container could escalate their permissions on the node running the container."
        },
        {
            "lang": "es",
            "value": "Se encontr\u00f3 una falla en openshift/builder. Esta vulnerabilidad permite la inyecci\u00f3n de comandos a trav\u00e9s de un path traversal, donde un usuario malintencionado puede ejecutar comandos arbitrarios en el nodo OpenShift que ejecuta el contenedor de compilaci\u00f3n. Al utilizar la estrategia \u201cDocker\u201d, los archivos ejecutables dentro del contenedor de compilaci\u00f3n privilegiado se pueden anular utilizando el atributo `spec.source.secrets.secret.destinationDir` de la definici\u00f3n `BuildConfig`. Un atacante que ejecute c\u00f3digo en un contenedor privilegiado podr\u00eda aumentar sus permisos en el nodo que ejecuta el contenedor."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "secalert@redhat.com",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H",
                    "baseScore": 9.1,
                    "baseSeverity": "CRITICAL",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "HIGH",
                    "userInteraction": "NONE",
                    "scope": "CHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 2.3,
                "impactScore": 6.0
            }
        ]
    },
    "weaknesses": [
        {
            "source": "secalert@redhat.com",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-250"
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https://access.redhat.com/errata/RHSA-2024:6685",
            "source": "secalert@redhat.com"
        },
        {
            "url": "https://access.redhat.com/errata/RHSA-2024:6687",
            "source": "secalert@redhat.com"
        },
        {
            "url": "https://access.redhat.com/errata/RHSA-2024:6689",
            "source": "secalert@redhat.com"
        },
        {
            "url": "https://access.redhat.com/errata/RHSA-2024:6691",
            "source": "secalert@redhat.com"
        },
        {
            "url": "https://access.redhat.com/errata/RHSA-2024:6705",
            "source": "secalert@redhat.com"
        },
        {
            "url": "https://access.redhat.com/security/cve/CVE-2024-7387",
            "source": "secalert@redhat.com"
        },
        {
            "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2302259",
            "source": "secalert@redhat.com"
        },
        {
            "url": "https://stuxxn.github.io/advisory/2024/10/02/openshift-build-docker-priv-esc.html",
            "source": "secalert@redhat.com"
        }
    ],
    "techniques": [
        {
            "techniqueID": "T1137",
            "comment": "Remote File Included (RCE) - A malicious user can execute arbitrary commands on the OpenShift node running the builder container."
        },
        {
            "techniqueID": "T1086",
            "comment": "File and Path Manipulation - The `spec.source.secrets.secret.destinationDir` attribute allows an attacker to modify files on the system."
        },
        {
            "techniqueID": "T1047",
            "comment": "Windows Management Instrumentation (WMI) Operations - The attacker can use WMI to execute arbitrary commands on the OpenShift node."
        },
        {
            "techniqueID": "T1190",
            "comment": "Exploit Public-Facing Application - The vulnerability allows a malicious user to exploit a public-facing application to gain access to the OpenShift node."
        },
        {
            "techniqueID": "T1078",
            "comment": "Custom Command and Control - The attacker can use custom command and control channels to communicate with the compromised system."
        },
        {
            "techniqueID": "T1027",
            "comment": "Obfuscated Files or Code - The attacker can use obfuscated files or code to hide the malicious activity."
        },
        {
            "techniqueID": "T1518",
            "comment": "Software Discovery - The attacker can use the vulnerability to discover the software running on the OpenShift node."
        },
        {
            "techniqueID": "T1574",
            "comment": "OVPN File Format - The attacker can use the OVPN file format to deliver the malware."
        }
    ],
    "technical_analysis": {
        "Introduction": "This section describes a vulnerability in OpenShift/builder that allows command injection via path traversal, allowing a malicious user to execute arbitrary commands on the OpenShift node running the builder container.",
        "Impact and Scope": "The vulnerability has a CVSS score of 9.1 and can be exploited using various techniques such as remote file inclusion, file and path manipulation, and WMI operations. An attacker can use the vulnerability to gain access to the OpenShift node and execute arbitrary commands.",
        "Related MITRE ATT&CK Techniques": "The vulnerability is related to various MITRE ATT&CK techniques, including remote file inclusion, file and path manipulation, and WMI operations.",
        "Technical Details": "The vulnerability is due to the `spec.source.secrets.secret.destinationDir` attribute of the `BuildConfig` definition, which can be used to override executable files inside the privileged build container.",
        "Detection": "Detection methods for the vulnerability include monitoring for suspicious file modifications, command execution, and network traffic.",
        "Mitigation": "Mitigation strategies for the vulnerability include restricting access to the build container, using a non-privileged build container, and monitoring for suspicious activity.",
        "Conclusion": "In conclusion, the vulnerability in OpenShift/builder is a significant security risk and can be exploited using various techniques to gain access to the OpenShift node and execute arbitrary commands."
    },
    "executive_analysis": {
        "Overview": "This section provides an overview of the vulnerability in OpenShift/builder and its potential impact on the organization.",
        "Business Impact": "The vulnerability has the potential to impact business operations by allowing an attacker to execute arbitrary commands on the OpenShift node and potentially leading to data breaches or system compromise.",
        "Technical Impact": "The vulnerability has a significant technical impact, allowing an attacker to gain access to the OpenShift node and execute arbitrary commands.",
        "Mitigation Strategies": "Mitigation strategies for the vulnerability include restricting access to the build container, using a non-privileged build container, and monitoring for suspicious activity.",
        "Recommendations": "Recommendations for executives include prioritizing the patching of this vulnerability, restricting access to the build container, and implementing monitoring and detection mechanisms.",
        "Conclusions": "In conclusion, the vulnerability in OpenShift/builder is a significant security risk and requires immediate attention and mitigation."
    }
}