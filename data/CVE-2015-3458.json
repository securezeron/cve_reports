{"id": "CVE-2015-3458", "sourceIdentifier": "cve@mitre.org", "published": "2015-04-29T22:59:04.113", "lastModified": "2016-12-06T03:01:11.223", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The fetchView function in the Mage_Core_Block_Template_Zend class in Magento Community Edition (CE) 1.9.1.0 and Enterprise Edition (EE) 1.14.1.0 does not restrict the stream wrapper used in a template path, which allows remote administrators to include and execute arbitrary PHP files via the phar:// stream wrapper, related to the setScriptPath function.  NOTE: it is not clear whether this issue crosses privilege boundaries, since administrators might already have privileges to include arbitrary files."}, {"lang": "es", "value": "La funci\u00f3n fetchView en la clase Mage_Core_Block_Template_Zend en Magento Community Edition (CE) 1.9.1.0 y Enterprise Edition (EE) 1.14.1.0 no restringe el envoltorio de flujos utilizado en una ruta de plantilla, lo que permite a administradores remotos incluir y ejecutar ficheros PHP arbitrarios a trav\u00e9s del envoltorio de flujos phar://, relacionado con la funci\u00f3n setScriptPath. NOTA: no est\u00e1 claro si este problema cruza los l\u00edmites de los privilegios, como los administradores podr\u00eda ya tener los privilegios para incluir ficheros arbitrarios."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:magento:magento:1.9.1.0:*:*:*:community:*:*:*", "matchCriteriaId": "A6844CE7-F5A9-41CC-BAE8-C860C36F1C14"}, {"vulnerable": true, "criteria": "cpe:2.3:a:magento:magento:1.14.1.0:*:*:*:enterprise:*:*:*", "matchCriteriaId": "3B9093FD-5E68-4616-BFDC-DA589FBCEDFB"}]}]}], "references": [{"url": "http://blog.checkpoint.com/2015/04/20/analyzing-magento-vulnerability/", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://magento.com/blog/technical/critical-security-advisory-remote-code-execution-rce-vulnerability", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/74412", "source": "cve@mitre.org"}, {"url": "http://www.securitytracker.com/id/1032230", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1210", "comment": " CVE-2015-3458 - An attacker can exploit this vulnerability by sending a crafted HTTP request to the fetchView function, potentially leading to remote code execution. Defend against this by configuring the web server to only allow trusted HTTP requests and validate user input."}, {"techniqueID": "T1059", "comment": " CVE-2015-3458 - This vulnerability can be exploited by an attacker to execute arbitrary PHP code, which can be used to steal sensitive data, install malware, or gain access to the system. Defend against this by validating and sanitizing user input and configuring the web server to only allow trusted PHP code execution."}], "stix_bundle": {" objects": [{"id": "msve:CVE-2015-3458", "type": "vulnerability", "created_by_ref": "identity:my-identity", "modified": "2023-03-01T14:30:00.000Z", "name": "Magento Remote PHP Code Execution Vulnerability", "description": "The fetchView function in Magento allows(remote administrators to include and execute arbitrary PHP files via the phar:// stream wrapper, related to the setScriptPath function", "required_impact": "complete", "required_ease_of_use": "easy", "additional_properties": {"url": "http://blog.checkpoint.com/2015/04/20/analyzing-magento-vulnerability/"}, "relationships": [{"id": "r:CVE-2015-3458-CVE", "type": "related", "object_ref": "msve:CVE-2015-3458", "object_id": "msve:CVE-2015-3458"}, {"id": "r:CVE-2015-3458-technique1", "type": "related", "object_ref": "msve:CVE-2015-3458", "object_id": "msve:T1210"}, {"id": "r:CVE-2015-3458-technique2", "type": "related", "object_ref": "msve:CVE-2015-3458", "object_id": "msve:T1059"}]}, {"id": "msve:T1210", "type": "attack-pattern", "created_by_ref": "identity:my-identity", "modified": "2023-03-01T14:30:00.000Z", "name": "Code Execution throughMage_Core_Block_Template_Zend", "description": "An attacker can exploit this vulnerability by sending a crafted HTTP request to the fetchView function, potentially leading to remote code execution", "required_impact": "complete", "required_ease_of_use": "easy", "additional_properties": {"url": "https://attack.mitre.org/techniques/T1210", "display_name": "Exploit Public-Facing Application"}}, {"id": "msve:T1059", "type": "attack-pattern", "created_by_ref": "identity:my-identity", "modified": "2023-03-01T14:30:00.000Z", "name": "Program Execution", "description": "This attack pattern involves the attacker executing code via a program. The code can be malicious, so the goal of the attack is to install malware, steal sensitive data, or gain access to the system.", "required_impact": "complete", "required_ease_of_use": "easy", "additional_properties": {"url": "https://attack.mitre.org/techniques/T1059", "display_name": "Program Execution"}}]}, "technical_analysis": {"Introduction": "The Magento remote PHP code execution vulnerability, CVE-2015-3458, allows an attacker to execute arbitrary PHP code by sending a crafted HTTP request to the fetchView function.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5 and an attack vector of NETWORK. The impact is partial for confidentiality, integrity, and availability.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1210: Code Execution through Public-Facing Application and T1059: Program Execution.", "Technical Details": "The fetchView function in Magento does not restrict the stream wrapper used in a template path, allowing an attacker to include and execute arbitrary PHP files via the phar:// stream wrapper.", "Detection": "Detection can be performed using web application firewalls, intrusion detection systems, and vulnerability scanners.", "Mitigation": "Mitigation strategies include configuring the web server to only allow trusted HTTP requests, validating user input, and configuring the web server to only allow trusted PHP code execution.", "Conclusion": "In conclusion, the Magento remote PHP code execution vulnerability, CVE-2015-3458, highlights the importance of validating user input and configuring the web server to only allow trusted HTTP requests and PHP code execution."}, "executive_analysis": {"Overview": "The Magento remote PHP code execution vulnerability, CVE-2015-3458, allows an attacker to execute arbitrary PHP code and highlights the importance of validating user input and configuring the web server to only allow trusted HTTP requests and PHP code execution.", "Business Impact": "The vulnerability has a business impact on organizations that use Magento, as it can lead to data breaches, unauthorized access, and reputational damage.", "Technical Impact": "The vulnerability has a technical impact on the web application, as it allows an attacker to execute arbitrary PHP code and gain access to sensitive data.", "Mitigation Strategies": "Mitigation strategies include configuring the web server to only allow trusted HTTP requests, validating user input, and configuring the web server to only allow trusted PHP code execution.", "Recommendations": "Recommendations for executives include prioritizing patching and vulnerability remediation, conducting regular security assessments and penetration testing, and implementing web application firewalls and intrusion detection systems.", "Conclusions": "In conclusion, the Magento remote PHP code execution vulnerability, CVE-2015-3458, is a serious vulnerability that highlights the importance of validating user input and configuring the web server to only allow trusted HTTP requests and PHP code execution. Executives should prioritize patching and vulnerability remediation and implement mitigation strategies to prevent attacks."}}