{"id": "CVE-2023-5941", "sourceIdentifier": "secteam@freebsd.org", "published": "2023-11-08T09:15:07.847", "lastModified": "2023-12-14T10:15:08.630", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In versions of FreeBSD 12.4-RELEASE prior to 12.4-RELEASE-p7 and FreeBSD 13.2-RELEASE prior to 13.2-RELEASE-p5 the __sflush() stdio function in libc does not correctly update FILE objects' write space members for write-buffered streams when the write(2) system call returns an error. \u00a0Depending on the nature of an application that calls libc's stdio functions and the presence of errors returned from the write(2) system call (or an overridden stdio write routine) a heap buffer overflow may occur.  Such overflows may lead to data corruption or the execution of arbitrary code at the privilege level of the calling program."}, {"lang": "es", "value": "En las versiones 12.4-RELEASE anteriores a 12.4-RELEASE-p7 y 13.2-RELEASE anteriores a 13.2-RELEASE-p5 de FreeBSD, la funci\u00f3n stdio __sflush() en libc no actualiza correctamente los miembros del espacio de escritura de los objetos FILE para secuencias con b\u00fafer de escritura cuando la llamada al sistema write(2) devuelve un error. Dependiendo de la naturaleza de una aplicaci\u00f3n que llama a las funciones stdio de libc y la presencia de errores devueltos por la llamada al sistema write(2) (o una rutina de escritura stdio anulada), puede ocurrir un desbordamiento del buffer del heap. Dichos desbordamientos pueden provocar da\u00f1os en los datos o la ejecuci\u00f3n de c\u00f3digo arbitrario en el nivel de privilegio del programa que realiza la llamada."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-131"}, {"lang": "en", "value": "CWE-787"}]}, {"source": "secteam@freebsd.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-131"}, {"lang": "en", "value": "CWE-787"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:*:*:*:*:*:*:*:*", "versionEndExcluding": "12.4", "matchCriteriaId": "A7F6C8B0-9D75-476C-ADBA-754416FBC186"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:*:*:*:*:*:*:*:*", "versionStartIncluding": "13.0", "versionEndExcluding": "13.2", "matchCriteriaId": "BA49E374-9F1A-4F62-B88D-CD36EDEA6060"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.4:-:*:*:*:*:*:*", "matchCriteriaId": "24920B4D-96C0-401F-B679-BEB086760EAF"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.4:p1:*:*:*:*:*:*", "matchCriteriaId": "3CE32730-A9F5-4E8D-BDA4-6B8232F84787"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.4:p2:*:*:*:*:*:*", "matchCriteriaId": "552E81DE-D409-475F-8ED0-E10A0BE43D29"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.4:p3:*:*:*:*:*:*", "matchCriteriaId": "251CAE22-C3E6-45AD-8301-F36BEE5C6860"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.4:p4:*:*:*:*:*:*", "matchCriteriaId": "85D94BCA-FA32-4C10-95CD-5D2A69B38A7A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.4:p5:*:*:*:*:*:*", "matchCriteriaId": "8C950F97-40B4-43BF-BB81-C49CE00A468B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.4:p6:*:*:*:*:*:*", "matchCriteriaId": "8FFBAD22-5712-472D-ADAF-13DE0826F888"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.4:rc2-p1:*:*:*:*:*:*", "matchCriteriaId": "BA821886-B26B-47A6-ABC9-B8F70CE0ACFB"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.4:rc2-p2:*:*:*:*:*:*", "matchCriteriaId": "220629AD-32CC-4303-86AE-1DD27F0E4C65"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.2:-:*:*:*:*:*:*", "matchCriteriaId": "A87EFA20-DD6B-41C5-98FD-A29F67D2E732"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.2:p1:*:*:*:*:*:*", "matchCriteriaId": "2888B0C1-4D85-42EC-9696-03FAD0A9C28F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.2:p2:*:*:*:*:*:*", "matchCriteriaId": "A3306F11-D3C0-41D6-BB5E-2ABDC3927715"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.2:p3:*:*:*:*:*:*", "matchCriteriaId": "9E584FE1-3A34-492B-B10F-508DA7CBA768"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.2:p4:*:*:*:*:*:*", "matchCriteriaId": "A5605E90-D125-4CC9-8B9F-F5EED9D4EE0C"}]}]}], "references": [{"url": "https://security.freebsd.org/advisories/FreeBSD-SA-23:15.stdio.asc", "source": "secteam@freebsd.org", "tags": ["Vendor Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20231214-0004/", "source": "secteam@freebsd.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2023-5941 - In FreeBSD, a heap buffer overflow may occur in the `__sflush()` stdio function due to incorrect update of FILE objects' write space members. This technique may result in data corruption or arbitrary code execution at the privilege level of the calling program."}, {"techniqueID": "T1003", "comment": "CVE-2023-5941 - The vulnerable function `__sflush()` in libc does not correctly update FILE objects' write space members for write-buffered streams when the `write(2)` system call returns an error, leading to a potential buffer overflow. This technique may be used to exploit this vulnerability."}, {"techniqueID": "T1075", "comment": "CVE-2023-5941 - Potential exploitation of the heap buffer overflow in `__sflush()` stdio function may result in data corruption or arbitrary code execution at the privilege level of the calling program, demonstrating an execution of arbitray code, thus this technique can be used to exploit this vulnerability."}], "stix_bundle": {"@stix2:version": "2.1", "stixbundle": {"bundle_id": "CVE-2023-5941-STIX-Bundle", "objects": [{"@type": "vulnerability", "id": "vulnerability-CVE-2023-5941", "description": "Heap buffer overflow in __sflush() stdio function in libc due to incorrect update of FILE objects' write space members for write-buffered streams.", "impact": "HIGH", "likelihood": "HIGH", "network_info": {"protocol": "TCP"}}, {"@type": "course-of-action", "id": "course-of-action-1", "description": "Update to a patched version of FreeBSD.", "product": "FreeBSD", "technique": {"technique_id": "T1190"}}, {"@type": "course-of-action", "id": "course-of-action-2", "description": "Apply mitigations to prevent exploitation of the heap buffer overflow vulnerability.", "product": "FreeBSD", "technique": {"technique_id": "T1003"}}], "relationships": [{"type": "has-course-of-action", "object_refs": ["course-of-action-1", "course-of-action-2"], "to": "vulnerability-CVE-2023-5941"}]}}, "technical_analysis": {"Introduction": "The vulnerability CVE-2023-5941 exists in the __sflush() stdio function in libc of FreeBSD versions prior to 12.4-RELEASE-p7 and 13.2-RELEASE-p5.", "Impact and Scope": "The vulnerability allows for potential exploitation, leading to data corruption or arbitrary code execution.", "Related MITRE ATT&CK Techniques": "T1190, T1003, T1075", "Technical Details": "The vulnerability occurs due to incorrect update of FILE objects' write space members for write-buffered streams.", "Detection": "Detection methods include monitoring for suspicious network traffic and analyzing system logs.", "Mitigation": "Mitigation strategies include updating to a patched version of FreeBSD and applying mitigations to prevent exploitation of the heap buffer overflow vulnerability.", "Conclusion": "The vulnerability CVE-2023-5941 is a significant threat to the security of systems running FreeBSD and should be addressed promptly."}, "executive_analysis": {"Overview": "The vulnerability CVE-2023-5941 is a critical security flaw in FreeBSD that allows for potential exploitation.", "Business Impact": "Exploitation of the vulnerability may result in data corruption or arbitrary code execution, compromising business operations and security.", "Technical Impact": "The vulnerability affects the __sflush() stdio function in libc, which may lead to data corruption or arbitrary code execution.", "Mitigation Strategies": "Update to a patched version of FreeBSD and apply mitigations to prevent exploitation of the heap buffer overflow vulnerability.", "Recommendations": "Implement a vulnerability management program and regularly update systems to ensure they are running with the latest security patches.", "Conclusions": "The vulnerability CVE-2023-5941 is a significant threat to the security of systems running FreeBSD and should be addressed promptly."}}