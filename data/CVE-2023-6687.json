{"id": "CVE-2023-6687", "sourceIdentifier": "bressers@elastic.co", "published": "2023-12-12T19:15:08.510", "lastModified": "2023-12-19T15:20:04.910", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered by Elastic whereby Elastic Agent would log a raw event in its own logs at the WARN or ERROR level if ingesting that event to Elasticsearch failed with any 4xx HTTP status code except 409 or 429. Depending on the nature of the event that Elastic Agent attempted to ingest, this could lead to the insertion of sensitive or private information in the Elastic Agent logs. Elastic has released 8.11.3 and 7.17.16 that prevents this issue by limiting these types of logs to DEBUG level logging, which is disabled by default."}, {"lang": "es", "value": "Elastic descubri\u00f3 un problema por el cual Elastic Agent registraba un evento sin formato en sus propios registros en el nivel WARN o ERROR si fallaba la ingesta de ese evento en Elasticsearch con cualquier c\u00f3digo de estado HTTP 4xx excepto 409 o 429. Dependiendo de la naturaleza del evento, el Agente El\u00e1stico intent\u00f3 ingerir, esto podr\u00eda llevar a la inserci\u00f3n de informaci\u00f3n confidencial o privada en los registros del Agente El\u00e1stico. Elastic lanz\u00f3 8.11.3 y 7.17.16 que evitan este problema al limitar estos tipos de registros al registro de nivel DEBUG, que est\u00e1 deshabilitado de forma predeterminada."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "bressers@elastic.co", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 4.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-532"}]}, {"source": "bressers@elastic.co", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-532"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:elastic:elastic_agent:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.0.0", "versionEndExcluding": "7.17.16", "matchCriteriaId": "5F396842-37AD-4E18-9477-47001EF69314"}, {"vulnerable": true, "criteria": "cpe:2.3:a:elastic:elastic_agent:*:*:*:*:*:*:*:*", "versionStartIncluding": "8.0.0", "versionEndExcluding": "8.11.3", "matchCriteriaId": "D1345D08-E070-43B9-83F1-68F32FA619EF"}]}]}], "references": [{"url": "https://discuss.elastic.co/t/beats-and-elastic-agent-8-11-3-7-17-16-security-update-esa-2023-30/349180", "source": "bressers@elastic.co", "tags": ["Mitigation", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1548.001", "comment": "CVE-2023-6687 - Elastic Agent logging sensitive information due to failed event ingestion could lead to the insertion of sensitive or private information in the Elastic Agent logs."}, {"techniqueID": "T1210", "comment": "CVE-2023-6687 - Elastic Agent failing to log events with 4xx HTTP status codes could potentially lead to the insertion of sensitive or private information in the Elastic Agent logs."}, {"techniqueID": "T1567.002", "comment": "CVE-2023-6687 - Elastic Agent failure to log events due to 4xx HTTP status codes could indicate a potential command and control channel"}, {"techniqueID": "T1078", "comment": "CVE-2023-6687 - Elastic Agent logging sensitive information due to failed event ingestion could facilitate command and control activities"}, {"techniqueID": "T1546", "comment": "CVE-2023-6687 - Elastic Agent logging sensitive information due to failed event ingestion could be used to conceal attacker activities"}], "stix_bundle": {"@context": "https://stix2.io/schema/2.1/stix2.json", "Bundle": {"id": "bundle--", "type": "bundle", "created_by_ref": " organisation--", "created": "2023-12-12T19:15:08.510Z", "modified": "2023-12-19T15:20:04.910Z", "objects": [{"id": "vulnerability--", "type": "vulnerability", "created_by_ref": "organisation--", "created": "2023-12-12T19:15:08.510Z", "modified": "2023-12-19T15:20:04.910Z", "name": "CVE-2023-6687", "description": "Description of the vulnerability", "short_description": "Short description of the vulnerability", "published": "2023-12-12T19:15:08.510Z", "last_modified": "2023-12-19T15:20:04.910Z", "vulnerability_score": 6.5, "impact_score": 3.6, "exploitability_score": 2.8, "cvss_vector_string": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "references": [{"id": "reference--", "type": "reference", "name": "CVE-2023-6687", "description": "Reference to the vulnerability"}]}, {"id": "indicator--", "type": "indicator", "created_by_ref": "organisation--", "created": "2023-12-12T19:15:08.510Z", "modified": "2023-12-19T15:20:04.910Z", "name": "Indicator for CVE-2023-6687", "description": "Indicator for the vulnerability", "types": [{"idref": "identification--", "type": "identification_ref"}]}, {"id": "course_of_action--", "type": "course-of-action", "created_by_ref": "organisation--", "created": "2023-12-12T19:15:08.510Z", "modified": "2023-12-19T15:20:04.910Z", "name": "Mitigation for CVE-2023-6687", "description": "Mitigation strategy for the vulnerability", "mitigates": [{"idref": "vulnerability--", "type": "vulnerability_ref"}], "uses": [{"idref": "technique--", "type": "technique_ref"}]}]}}, "technical_analysis": {"Introduction": "This vulnerability, CVE-2023-6687, is a logging issue in Elastic Agent that could potentially lead to the insertion of sensitive or private information in the Elastic Agent logs.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 6.5. It is exploitable over the network, with an exploitability score of 2.8, and has a moderate impact score of 3.6.", "Related MITRE ATT&CK Techniques": "The vulnerability is relevant to the following MITRE ATT&CK techniques: T1548.001, T1210, T1567.002, T1078, and T1546.", "Technical Details": "The vulnerability is a logging issue in Elastic Agent that could potentially lead to the insertion of sensitive or private information in the Elastic Agent logs.", "Detection": "The vulnerability can be detected through log analysis and monitoring of Elastic Agent logs.", "Mitigation": "The vulnerability can be mitigated by limiting log levels to DEBUG and disabling log rotation.", "Conclusion": "In conclusion, the vulnerability CVE-2023-6687 is a high-impact vulnerability that can be exploited over the network and is relevant to several MITRE ATT&CK techniques. It is important to take immediate action to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The vulnerability CVE-2023-6687 is a logging issue in Elastic Agent that could potentially lead to the insertion of sensitive or private information in the Elastic Agent logs.", "Business Impact": "The business impact of this vulnerability is high, as it could potentially lead to the insertion of sensitive or private information in the Elastic Agent logs.", "Technical Impact": "The technical impact of this vulnerability is high, as it could potentially lead to the insertion of sensitive or private information in the Elastic Agent logs.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include limiting log levels to DEBUG and disabling log rotation.", "Recommendations": "We recommend taking immediate action to mitigate this vulnerability by implementing the recommended mitigation strategies.", "Conclusions": "In conclusion, the vulnerability CVE-2023-6687 is a serious vulnerability that requires immediate attention and action to mitigate its impact."}}