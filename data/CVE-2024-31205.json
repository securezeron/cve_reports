{"id": "CVE-2024-31205", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-08T15:15:08.023", "lastModified": "2024-04-08T18:48:40.217", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Saleor is an e-commerce platform. Starting in version 3.10.0 and prior to versions 3.14.64, 3.15.39, 3.16.39, 3.17.35, 3.18.31, and 3.19.19, an attacker may bypass cross-set request forgery (CSRF) validation when calling refresh token mutation with empty string. When a user provides an empty string in `refreshToken` mutation, while the token persists in `JWT_REFRESH_TOKEN_COOKIE_NAME` cookie, application omits validation against CSRF token and returns valid access token. Versions 3.14.64, 3.15.39, 3.16.39, 3.17.35, 3.18.31, and 3.19.19 contain a patch for the issue. As a workaround, one may replace `saleor.graphql.account.mutations.authentication.refresh_token.py.get_refresh_token`. This will fix the issue, but be aware, that it returns `JWT_MISSING_TOKEN` instead of `JWT_INVALID_TOKEN`.\n"}, {"lang": "es", "value": "Saleor es una plataforma de comercio electr\u00f3nico. A partir de la versi\u00f3n 3.10.0 y anteriores a las versiones 3.14.64, 3.15.39, 3.16.39, 3.17.35, 3.18.31 y 3.19.19, un atacante puede omitir la validaci\u00f3n de cross-set request forgery (CSRF) al llamar. actualizar la mutaci\u00f3n del token con una cadena vac\u00eda. Cuando un usuario proporciona una cadena vac\u00eda en la mutaci\u00f3n `refreshToken`, mientras el token persiste en la cookie `JWT_REFRESH_TOKEN_COOKIE_NAME`, la aplicaci\u00f3n omite la validaci\u00f3n contra el token CSRF y devuelve un token de acceso v\u00e1lido. Las versiones 3.14.64, 3.15.39, 3.16.39, 3.17.35, 3.18.31 y 3.19.19 contienen un parche para el problema. Como workaround, se puede reemplazar `saleor.graphql.account.mutations.authentication.refresh_token.py.get_refresh_token`. Esto solucionar\u00e1 el problema, pero tenga en cuenta que devuelve `JWT_MISSING_TOKEN` en lugar de `JWT_INVALID_TOKEN`."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.2, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 2.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-352"}]}], "references": [{"url": "https://github.com/saleor/saleor/commit/36699c6f5c99590d24f46e3d5c5b1a3c2fd072e7", "source": "security-advisories@github.com"}, {"url": "https://github.com/saleor/saleor/security/advisories/GHSA-ff69-fwjf-3c9w", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-31205 - This vulnerability can be exploited by attackers to bypass CSRF validation, allowing them to perform unauthorized actions. Defending against this involves implementing proper CSRF validation and token checking."}, {"techniqueID": "T1047", "comment": "CVE-2024-31205 - Attackers may use this vulnerability to obtain sensitive information by exploiting the lack of CSRF validation. Defending against this involves implementing proper input validation and sanitization."}, {"techniqueID": "T1505", "comment": "CVE-2024-31205 - This vulnerability can be used to compromise user sessions and access unauthorized data. Defending against this involves implementing proper session management and token rotation."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle--1", "objects": [{"type": "vulnerability", "id": "vulnerability--1", "title": "CVE-2024-31205", "description": "Saleor is an e-commerce platform. Starting in version 3.10.0 and prior to versions 3.14.64, 3.15.39, 3.16.39, 3.17.35, 3.18.31, and 3.19.19, an attacker may bypass cross-set request forgery (CSRF) validation when calling refresh token mutation with empty string.", "scores": {"cvss_v31": {"score": 4.2, "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N"}}}, {"type": "technique", "id": "technique--1", "name": "T1190", "description": "Exploit Public-Facing Application"}, {"type": "technique", "id": "technique--2", "name": "T1047", "description": "Web Shellcoding"}, {"type": "technique", "id": "technique--3", "name": "T1505", "description": "Privileged Account Discovery"}, {"type": "relationship", "id": "relationship--1", "source_ref": "vulnerability--1", "target_ref": "technique--1", "relationship_type": "exploited_by"}, {"type": "relationship", "id": "relationship--2", "source_ref": "vulnerability--1", "target_ref": "technique--2", "relationship_type": "exploited_by"}, {"type": "relationship", "id": "relationship--3", "source_ref": "vulnerability--1", "target_ref": "technique--3", "relationship_type": "exploited_by"}, {"type": "course_of_action", "id": "course_of_action--1", "title": "Implement proper CSRF validation", "description": "Implementing proper CSRF validation involves validating the origin and authenticity of requests and checking for valid tokens", "techniqueReferences": ["technique--1"]}, {"type": "course_of_action", "id": "course_of_action--2", "title": "Implement proper input validation", "description": "Implementing proper input validation involves validating user input for malicious patterns and sanitizing input data", "techniqueReferences": ["technique--2"]}, {"type": "course_of_action", "id": "course_of_action--3", "title": "Implement proper session management", "description": "Implementing proper session management involves regularly rotating and invalidating session tokens", "techniqueReferences": ["technique--3"]}, {"type": "note", "id": "note--1", "content": "This vulnerability can be used to compromise user sessions and access unauthorized data"}]}, "technical_analysis": {"Introduction": "This vulnerability allows attackers to bypass CSRF validation, allowing them to perform unauthorized actions. CVSS score: 4.2, Attack Vector: Network.", "Impact and Scope": "This vulnerability affects e-commerce platforms starting in version 3.10.0 and prior to versions 3.14.64, 3.15.39, 3.16.39, 3.17.35, 3.18.31, and 3.19.19.", "Related MITRE ATT&CK Techniques": "T1190, T1047, T1505", "Technical Details": "This vulnerability occurs when an attacker lacks CSRF validation when calling refresh token mutation with an empty string.", "Detection": "Detection involves monitoring for suspicious activity and anomalies in the system.", "Mitigation": "Mitigation strategies include implementing proper CSRF validation and token checking.", "Conclusion": "This vulnerability highlights the importance of proper CSRF validation and token checking in e-commerce platforms."}, "executive_analysis": {"Overview": "This vulnerability allows attackers to compromise user sessions and access unauthorized data, affecting e-commerce platforms.", "Business Impact": "This vulnerability can result in financial losses and damage to reputation.", "Technical Impact": "This vulnerability affects system security and stability.", "Mitigation Strategies": "Implement proper CSRF validation and token checking.", "Recommendations": "Executive leadership should prioritize implementing mitigation strategies to protect against this vulnerability.", "Conclusions": "This vulnerability highlights the importance of prioritizing security in e-commerce platforms."}}