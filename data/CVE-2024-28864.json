{"id": "CVE-2024-28864", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-18T22:15:09.247", "lastModified": "2024-03-19T13:26:46.000", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "SecureProps is a PHP library designed to simplify the encryption and decryption of property data in objects. A vulnerability in SecureProps version 1.2.0 and 1.2.1 involves a regex failing to detect tags during decryption of encrypted data. This occurs when the encrypted data has been encoded with `NullEncoder` and passed to `TagAwareCipher`, and contains special characters such as `\\n`. As a result, the decryption process is skipped since the tags are not detected. This causes the encrypted data to be returned in plain format.  The vulnerability affects users who implement `TagAwareCipher` with any base cipher that has `NullEncoder` (not default). The patch for the issue has been released. Users are advised to update to version 1.2.2. As a workaround, one may use the default `Base64Encoder` with the base cipher decorated with `TagAwareCipher` to prevent special characters in the encrypted string from interfering with regex tag detection logic.  This workaround is safe but may involve double encoding since `TagAwareCipher` uses `NullEncoder` by default."}, {"lang": "es", "value": "SecureProps es una librer\u00eda PHP dise\u00f1ada para simplificar el cifrado y descifrado de datos de propiedades en objetos. Una vulnerabilidad en SecureProps versi\u00f3n 1.2.0 y 1.2.1 implica que una expresi\u00f3n regular no detecta etiquetas durante el descifrado de datos cifrados. Esto ocurre cuando los datos cifrados se codificaron con `NullEncoder` y se pasaron a `TagAwareCipher` y contienen caracteres especiales como `\\n`. Como resultado, se omite el proceso de descifrado ya que no se detectan las etiquetas. Esto hace que los datos cifrados se devuelvan en formato plano. La vulnerabilidad afecta a los usuarios que implementan `TagAwareCipher` con cualquier cifrado base que tenga `NullEncoder` (no predeterminado). Se ha publicado el parche para el problema. Se recomienda a los usuarios que actualicen a la versi\u00f3n 1.2.2. Como workaround, se puede utilizar el `Base64Encoder` predeterminado con el cifrado base decorado con `TagAwareCipher` para evitar que los caracteres especiales en la cadena cifrada interfieran con la l\u00f3gica de detecci\u00f3n de etiquetas regex. Este workaround es seguro pero puede implicar doble codificaci\u00f3n ya que `TagAwareCipher` usa `NullEncoder` de forma predeterminada."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 2.6, "baseSeverity": "LOW"}, "exploitabilityScore": 1.2, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1333"}]}], "references": [{"url": "https://github.com/IlicMiljan/Secure-Props/commit/ab7b561040cd37fda3dbf9a6cab01fefcaa16627", "source": "security-advisories@github.com"}, {"url": "https://github.com/IlicMiljan/Secure-Props/issues/20", "source": "security-advisories@github.com"}, {"url": "https://github.com/IlicMiljan/Secure-Props/pull/21", "source": "security-advisories@github.com"}, {"url": "https://github.com/IlicMiljan/Secure-Props/security/advisories/GHSA-rj29-j2g4-77q8", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1592", "comment": "CVE-2024-28864 - Weakness in SecureProps library allows for decryption of encrypted data with NullEncoder and special characters, making it vulnerable to regression attacks."}, {"techniqueID": "T1190", "comment": "CVE-2024-28864 - Weakness in SecureProps library allows for decryption of encrypted data with NullEncoder and special characters, making it vulnerable to SSL/TLS stripping attacks."}, {"techniqueID": "T1192", "comment": "CVE-2024-28864 - Weakness in SecureProps library allows for decryption of encrypted data with NullEncoder and special characters, making it vulnerable to DNS tunneling attacks."}, {"techniqueID": "T1194", "comment": "CVE-2024-28864 - Weakness in SecureProps library allows for decryption of encrypted data with NullEncoder and special characters, making it vulnerable to HTTP tunneling attacks."}], "stix_bundle": {"stix_violations": {"vulnerability": {"id": "CVE-2024-28864", "description": "Weakness in SecureProps library allows for decryption of encrypted data with NullEncoder and special characters, making it vulnerable to regression attacks.", "created": "2024-03-18T22:15:09.247", "modified": "2024-03-19T13:26:46.000", "exploitability": true, "vulnerability_category": "misc", "exploit_maturity": " maturity_level_low"}, "expansions": {"attack-patter": {"attack-pattern": {"id": "T1592", "name": "Automated Attack of Encryption Algorithm"}}, "course-of-action": {"course-of-action": {"id": "COA-2024-28864-T1592", "name": "Apply SecureProps version 1.2.2 or later"}}}}}, "technical_analysis": {"Introduction": "The SecureProps PHP library is vulnerable to regression attacks due to a weakness in its encryption algorithm.", "Impact and Scope": "The vulnerability affects users who implement the `TagAwareCipher` with any base cipher that has `NullEncoder`. CVSS score: 2.6, Attack Vector: NETWORK, Attack Complexity: HIGH, Privileges Required: LOW, User Interaction: REQUIRED, Scope: UNCHANGED, Confidentiality Impact: LOW, Integrity Impact: NONE, Availability Impact: NONE.", "Related MITRE ATT&CK Techniques": "T1592, T1190, T1192, T1194", "Technical Details": "The weakness occurs when the encrypted data is encoded with `NullEncoder` and contains special characters such as `\\n`. As a result, the decryption process is skipped, causing the encrypted data to be returned in plain format.", "Detection": "Detect the weakness by monitoring for encryption algorithm regressions and anomalies in the encryption algorithm.", "Mitigation": "Mitigate the weakness by applying SecureProps version 1.2.2 or later, or by using `Base64Encoder` with the base cipher decorated with `TagAwareCipher` to prevent special characters from interfering with regex tag detection logic.", "Conclusion": "In conclusion, the weakness in SecureProps library is a significant vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The SecureProps PHP library vulnerability is a critical weakness that affects users who implement the `TagAwareCipher` with any base cipher that has `NullEncoder`.", "Business Impact": "The vulnerability can lead to serious business consequences, such as data breaches, reputation damage, and financial loss.", "Technical Impact": "The vulnerability can allow attackers to decrypt encrypted data and access sensitive information.", "Mitigation Strategies": "Apply SecureProps version 1.2.2 or later, or use `Base64Encoder` with the base cipher decorated with `TagAwareCipher` to prevent special characters from interfering with regex tag detection logic.", "Recommendations": "Recommend that users update to SecureProps version 1.2.2 or later, and consider implementing additional security measures to prevent regression attacks.", "Conclusions": "In conclusion, immediate attention and mitigation are required to prevent serious consequences."}}