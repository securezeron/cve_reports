{"id": "CVE-2024-25124", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-21T21:15:09.250", "lastModified": "2024-02-22T19:07:27.197", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Fiber is a web framework written in go. Prior to version 2.52.1, the CORS middleware allows for insecure configurations that could potentially expose the application to multiple CORS-related vulnerabilities. Specifically, it allows setting the Access-Control-Allow-Origin header to a wildcard (`*`) while also having the Access-Control-Allow-Credentials set to true, which goes against recommended security best practices. The impact of this misconfiguration is high as it can lead to unauthorized access to sensitive user data and expose the system to various types of attacks listed in the PortSwigger article linked in the references. Version 2.52.1 contains a patch for this issue. As a workaround, users may manually validate the CORS configurations in their implementation to ensure that they do not allow a wildcard origin when credentials are enabled. The browser fetch api, as well as browsers and utilities that enforce CORS policies, are not affected by this."}, {"lang": "es", "value": "Fiber es un framework web escrito en go. Antes de la versi\u00f3n 2.52.1, el middleware CORS permit\u00eda configuraciones inseguras que podr\u00edan exponer la aplicaci\u00f3n a m\u00faltiples vulnerabilidades relacionadas con CORS. Espec\u00edficamente, permite establecer el encabezado Access-Control-Allow-Origin en un comod\u00edn (`*`) y al mismo tiempo tener Access-Control-Allow-Credentials establecido en verdadero, lo que va en contra de las mejores pr\u00e1cticas de seguridad recomendadas. El impacto de esta mala configuraci\u00f3n es alto, ya que puede conducir a un acceso no autorizado a datos confidenciales del usuario y exponer el sistema a varios tipos de ataques enumerados en el art\u00edculo de PortSwigger vinculado en las referencias. La versi\u00f3n 2.52.1 contiene un parche para este problema. Como workaround, los usuarios pueden validar manualmente las configuraciones de CORS en su implementaci\u00f3n para asegurarse de que no permitan un origen comod\u00edn cuando las credenciales est\u00e9n habilitadas. La API de recuperaci\u00f3n del navegador, as\u00ed como los navegadores y las utilidades que aplican las pol\u00edticas CORS, no se ven afectados por esto."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 9.4, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-346"}, {"lang": "en", "value": "CWE-942"}]}], "references": [{"url": "http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html", "source": "security-advisories@github.com"}, {"url": "https://codeql.github.com/codeql-query-help/javascript/js-cors-misconfiguration-for-credentials", "source": "security-advisories@github.com"}, {"url": "https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors/CORSNotSupportingCredentials", "source": "security-advisories@github.com"}, {"url": "https://fetch.spec.whatwg.org/#cors-protocol-and-credentials", "source": "security-advisories@github.com"}, {"url": "https://github.com/gofiber/fiber/commit/f0cd3b44b086544a37886232d0530601f2406c23", "source": "security-advisories@github.com"}, {"url": "https://github.com/gofiber/fiber/releases/tag/v2.52.1", "source": "security-advisories@github.com"}, {"url": "https://github.com/gofiber/fiber/security/advisories/GHSA-fmg4-x8pw-hjhg", "source": "security-advisories@github.com"}, {"url": "https://saturncloud.io/blog/cors-cannot-use-wildcard-in-accesscontrolalloworigin-when-credentials-flag-is-true", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1055", "comment": "CVE-2024-25124 - Fiber's CORS middleware allows insecure configurations, potentially exposing the application to multiple CORS-related vulnerabilities. This technique can be used to exploit this vulnerability."}, {"techniqueID": "T1535", "comment": "CVE-2024-25124 - The vulnerability affects the Fiber web framework, which is widely used. This technique highlights the importance of secure configuration of web frameworks."}, {"techniqueID": "T1064", "comment": "CVE-2024-25124 - The vulnerability is exploitable due to insecure CORS configurations. This technique shows how to exploit this vulnerability."}], "stix_bundle": {"type": "bundle", "id": "bundle--a2c9cc68-8a98-43e4-b43f-45c1cb0b4555", "created_by_ref": "identity--5a033f13-4e65-46f1-83a2-66d1b4e5c00e", "created": "2023-09-14T14:30:00.000Z", "modified": "2023-09-14T14:30:00.000Z", "label": "Fiber CVE-2024-25124", "objects": [{"type": "incident", "id": "incident--fc511d68-eb3f-4e54-ab04-40e1c8e7f105", "created_by_ref": "identity--5a033f13-4e65-46f1-83a2-66d1b4e5c00e", "created": "2023-09-14T14:30:00.000Z", "modified": "2023-09-14T14:30:00.000Z", "title": "Fiber Cross-Origin Resource Sharing (CORS) Vulnerability", "description": "Fiber is a web framework written in go. Prior to version 2.52.1, the CORS middleware allows for insecure configurations that could potentially expose the application to multiple CORS-related vulnerabilities."}, {"type": "report", "id": "report--9e2d98d3-1ec9-43a4-a1f5-0b6d3c8a1145", "created_by_ref": "identity--5a033f13-4e65-46f1-83a2-66d1b4e5c00e", "created": "2023-09-14T14:30:00.000Z", "modified": "2023-09-14T14:30:00.000Z", "title": "MITRE ATT&CK Techniques", "description": [{"type": "x-opencti-technique", "value": "T1055"}, {"type": "x-opencti-technique", "value": "T1535"}, {"type": "x-opencti-technique", "value": "T1064"}]}]}, "technical_analysis": {"Introduction": "Fiber's CORS middleware allows insecure configurations that can expose the application to multiple CORS-related vulnerabilities.", "Impact and Scope": "The vulnerability has a CVSS score of 9.4 and affects the Fiber web framework. The attack vector is Network.", "Related MITRE ATT&CK Techniques": "T1055, T1535, T1064", "Technical Details": "The vulnerability occurs when the CORS middleware is configured insecurely, allowing a wildcard origin while enabling credentials.", "Detection": "Detection methods include monitoring for unusual CORS requests and errors.", "Mitigation": "Mitigation strategies include validating CORS configurations and restricting wildcard origins.", "Conclusion": "This vulnerability highlights the importance of secure configuration of web frameworks."}, "executive_analysis": {"Overview": "Fiber's CORS middleware allows insecure configurations that can expose the application to multiple CORS-related vulnerabilities.", "Business Impact": "The vulnerability can result in unauthorized access to sensitive user data and expose the system to various types of attacks.", "Technical Impact": "The vulnerability affects the Fiber web framework, which is widely used.", "Mitigation Strategies": "Validating CORS configurations and restricting wildcard origins can help mitigate this vulnerability.", "Recommendations": "Executives should require developers to validate CORS configurations and restrict wildcard origins to prevent exploitation of this vulnerability.", "Conclusions": "Implementing secure configuration practices for web frameworks can help prevent vulnerabilities like this one."}}