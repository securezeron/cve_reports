{"id": "CVE-2020-15127", "sourceIdentifier": "security-advisories@github.com", "published": "2020-08-05T21:15:12.350", "lastModified": "2020-08-12T13:30:33.623", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Contour ( Ingress controller for Kubernetes) before version 1.7.0, a bad actor can shut down all instances of Envoy, essentially killing the entire ingress data plane. GET requests to /shutdown on port 8090 of the Envoy pod initiate Envoy's shutdown procedure. The shutdown procedure includes flipping the readiness endpoint to false, which removes Envoy from the routing pool. When running Envoy (For example on the host network, pod spec hostNetwork=true), the shutdown manager's endpoint is accessible to anyone on the network that can reach the Kubernetes node that's running Envoy. There is no authentication in place that prevents a rogue actor on the network from shutting down Envoy via the shutdown manager endpoint. Successful exploitation of this issue will lead to bad actors shutting down all instances of Envoy, essentially killing the entire ingress data plane. This is fixed in version 1.7.0."}, {"lang": "es", "value": "En Contour (Controlador de ingreso para Kubernetes) anterior a la versi\u00f3n 1.7.0, un actor malo puede cerrar todas las instancias de Envoy, esencialmente eliminando todo el plano de entrada de datos. Las peticiones GET hacia /shutdown en el puerto 8090 del pod Envoy inician el procedimiento de apagado de Envoy. El procedimiento de apagado incluye cambiar el endpoint readiness a falso, lo que elimina a Envoy del grupo de enrutamiento. Cuando se ejecuta Envoy (por ejemplo, en la red host, pod especifica hostNetwork=true), el endpoint del administrador de cierre es accesible para cualquier persona en la red que pueda alcanzar el nodo Kubernetes que ejecuta Envoy. No existe una autenticaci\u00f3n que impida a un actor malicioso de la red cerrar Envoy por medio del endpoint del administrador de cierre. Una explotaci\u00f3n con \u00e9xito de este problema llevar\u00e1 a que los actores malos cierren todas las instancias de Envoy, esencialmente eliminando todo el plano de datos de ingreso. Esto es corregido en la versi\u00f3n 1.7.0"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-306"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-306"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:projectcontour:contour:*:*:*:*:*:kubernetes:*:*", "versionEndExcluding": "1.7.0", "matchCriteriaId": "BBB4F1FC-CACA-4230-BC7A-813BB0B1C08F"}]}]}], "references": [{"url": "https://github.com/projectcontour/contour/releases/tag/v1.7.0", "source": "security-advisories@github.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/projectcontour/contour/security/advisories/GHSA-mjp8-x484-pm3r", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "This vulnerability allows an attacker to shut down all instances of Envoy, essentially killing the entire ingress data plane. Thus, related to T1210: System Shutdown/Reboot"}, {"techniqueID": "T1077", "comment": "The attacker can shut down Envoy via the shutdown manager's endpoint, which is accessible to anyone on the network that can reach the Kubernetes node that's running Envoy. This is a network-based attack and related to T1077: Network Sniffing"}, {"techniqueID": "T1509", "comment": "The vulnerability can be exploited remotely by sending a GET request to /shutdown on port 8090 of the Envoy pod. This is a remote access technique and related to T1509: Web Shell"}], "stix_bundle": {"objects": [{"type": "indicator", "id": "indicator--abc123", "name": "CVE-2020-15127", "description": "An attacker can shut down all instances of Envoy, essentially killing the entire ingress data plane", "first_seen": "2020-08-05T21:15:12.350", "last_seen": "2020-08-12T13:30:33.623", "vulnerability": {"id": "vulnerability--vul-123", "description": "CVE-2020-15127"}, "related_object": {"type": "intrusion_detection_system", "id": "intrusion_detection_system--ids-123", "name": "IDS System", "description": "IDS System to detect the attacks"}}, {"type": "course_of_action", "id": "course_of_action--mit-123", "name": "Defend Against CVE-2020-15127", "description": "Block incoming traffic to port 8090 on Envoy pods", "related_object": {"type": "technique", "id": "technique--T1210", "name": "System Shutdown/Reboot"}, "mitigated_by": {"type": "countermeasure", "id": "countermeasure--cm-123", "name": "Patch Contour to version 1.7.0"}}, {"type": "indicator", "id": "indicator--envoy-pod", "name": "Envoy Pod", "description": "An Envoy pod with shutdown manager's endpoint exposed", "first_seen": "2020-08-05T21:15:12.350", "last_seen": "2020-08-12T13:30:33.623", "vulnerability": {"id": "vulnerability--vul-123", "description": "CVE-2020-15127"}, "related_object": {"type": "intrusion_detection_system", "id": "intrusion_detection_system--ids-123", "name": "IDS System", "description": "IDS System to detect the attacks"}}]}, "technical_analysis": {"Introduction": "This analysis provides technical details on the CVE-2020-15127 vulnerability and related MITRE ATT&CK techniques.", "Impact and Scope": "The vulnerability allows an attacker to shut down all instances of Envoy, which can lead to high availability impact.", "Related MITRE ATT&CK Techniques": "T1210: System Shutdown/Reboot, T1077: Network Sniffing, T1509: Web Shell", "Technical Details": "The vulnerability is a remote attack that can be triggered by sending a GET request to /shutdown on port 8090 of the Envoy pod.", "Detection": "Detect the attacks by monitoring for incoming traffic to port 8090 on Envoy pods.", "Mitigation": "Patch Contour to version 1.7.0 or block incoming traffic to port 8090 on Envoy pods.", "Conclusion": "This analysis provides a comprehensive view of the CVE-2020-15127 vulnerability and its related MITRE ATT&CK techniques."}, "executive_analysis": {"Overview": "This analysis provides an overview of the CVE-2020-15127 vulnerability and its business impact.", "Business Impact": "The vulnerability can lead to high availability impact and financial losses.", "Technical Impact": "The vulnerability allows an attacker to shut down all instances of Envoy, which can lead to high availability impact.", "Mitigation Strategies": "Patch Contour to version 1.7.0 or block incoming traffic to port 8090 on Envoy pods.", "Recommendations": "Apply patches regularly and implement network segmentation.", "Conclusions": "This analysis provides a comprehensive view of the CVE-2020-15127 vulnerability and its business impact."}}