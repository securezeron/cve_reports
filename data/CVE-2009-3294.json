{"id": "CVE-2009-3294", "sourceIdentifier": "cve@mitre.org", "published": "2009-09-22T10:30:00.827", "lastModified": "2022-09-01T16:32:32.183", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The popen API function in TSRM/tsrm_win32.c in PHP before 5.2.11 and 5.3.x before 5.3.1, when running on certain Windows operating systems, allows context-dependent attackers to cause a denial of service (crash) via a crafted (1) \"e\" or (2) \"er\" string in the second argument (aka mode), possibly related to the _fdopen function in the Microsoft C runtime library. NOTE: this might not cross privilege boundaries except in rare cases in which the mode argument is accessible to an attacker outside of an application that uses the popen function."}, {"lang": "es", "value": "La funci\u00f3n popen de la API en el archivo TSRM/tsrm_win32.c en PHP anterior a versi\u00f3n 5.2.11 y versi\u00f3n 5.3.x anterior a 5.3.1, cuando se ejecuta en ciertos sistemas operativos de Windows, permite que los atacantes dependiendo del contexto causen una denegaci\u00f3n de servicio (bloqueo) mediante una cadena (1) \"e\" o (2) \"er\" en el segundo argumento (tambi\u00e9n se conoce como modo), posiblemente relacionado a la funci\u00f3n _fdopen en la biblioteca runtime de Microsoft C. NOTA: esto podr\u00eda no cruzar los l\u00edmites de privilegios, excepto en casos excepcionales en los que el argumento mode es accesible para un atacante fuera de una aplicaci\u00f3n que utiliza la funci\u00f3n popen."}], "vendorComments": [{"organization": "Red Hat", "comment": "Not vulnerable. This issue did not affect the versions of php as shipped with Red Hat Enterprise Linux 3, 4, or 5, and Red Hat Application Stack v2.", "lastModified": "2009-09-24T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-134"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.2.0", "versionEndExcluding": "5.2.11", "matchCriteriaId": "FFD822BB-D59C-4EFB-8E57-668CA6D477A7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.3.0", "versionEndExcluding": "5.3.1", "matchCriteriaId": "54C23FEC-84BD-4C66-8B70-F24F4C26066F"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_7:*:*:*:*:*:*:*:*", "matchCriteriaId": "D56B932B-9593-44E2-B610-E4EB2143EB21"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:*:*:*:*:*:*:*:*", "matchCriteriaId": "6B33C9BD-FC34-4DFC-A81F-C620D3DAA79D"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_xp:*:*:*:*:*:*:*:*", "matchCriteriaId": "E61F1C9B-44AF-4B35-A7B2-948EEF7639BD"}]}]}], "references": [{"url": "http://bugs.php.net/bug.php?id=44683", "source": "cve@mitre.org", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "http://news.php.net/php.announce/79", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://svn.php.net/viewvc?view=revision&revision=287779", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2009/09/20/1", "source": "cve@mitre.org", "tags": ["Mailing List", "Patch"]}, {"url": "http://www.openwall.com/lists/oss-security/2009/11/20/2", "source": "cve@mitre.org", "tags": ["Mailing List"]}, {"url": "http://www.openwall.com/lists/oss-security/2009/11/20/3", "source": "cve@mitre.org", "tags": ["Mailing List"]}, {"url": "http://www.osvdb.org/58188", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.php.net/ChangeLog-5.php", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.php.net/ChangeLog-5.php#5.2.11", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.php.net/releases/5_2_11.php", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.php.net/releases/5_3_1.php", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1047 - Windows Management Instrumentation (WMI)"}, {"techniqueID": "T1047 - Coordinated Shellcode"}, {"techniqueID": "T1548 - Backdoor"}], "stix_bundle": {"type": "bundle", "id": "https://example.com/bundle/CVE-2009-3294", "created_by_ref": "https://example.com/user/admin", "modified": "2022-09-01T16:32:32.183", "objects": [{"type": "vulnerability", "id": "CVE-2009-3294", "name": "PHP RCE via popen", "description": "The popen API function in TSRM/tsrm_win32.c in PHP before 5.2.11 and 5.3.x before 5.3.1, when running on certain Windows operating systems, allows context-dependent attackers to cause a denial of service (crash) via a crafted (1) \"e\" or (2) \"er\" string in the second argument (aka mode), possibly related to the _fdopen function in the Microsoft C runtime library.", "vulnerability_status": "Analyzed", "cvss": {"vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "base_score": 5.0}}, {"type": "attack_pattern", "id": "T1047", "name": "Windows Management Instrumentation (WMI)"}, {"type": "attack_pattern", "id": "T1047", "name": "Coordinated Shellcode"}, {"type": "attack_pattern", "id": "T1548", "name": "Backdoor"}, {"type": "course_of_action", "id": "COA-1", "name": "Update PHP to version 5.2.11 or later"}, {"type": "course_of_action", "id": "COA-2", "name": "Disable WMI on vulnerable systems"}, {"type": "course_of_action", "id": "COA-3", "name": "Implement WMI input validation"}], "relationships": [{"type": "uses", "id": "r1", "source_ref": "CVE-2009-3294", "target_ref": "T1047", "relationship_type": "uses"}, {"type": "uses", "id": "r2", "source_ref": "CVE-2009-3294", "target_ref": "T1047", "relationship_type": "uses"}, {"type": "uses", "id": "r3", "source_ref": "COA-1", "target_ref": "CVE-2009-3294", "relationship_type": "fixes"}, {"type": "uses", "id": "r4", "source_ref": "COA-2", "target_ref": "CVE-2009-3294", "relationship_type": "mitigates"}, {"type": "uses", "id": "r5", "source_ref": "COA-3", "target_ref": "CVE-2009-3294", "relationship_type": "mitigates"}]}, "technical_analysis": {"Introduction": "A denial of service (crash) vulnerability exists in the popen API function in TSRM/tsrm_win32.c in PHP before 5.2.11 and 5.3.x before 5.3.1, when running on certain Windows operating systems.", "Impact and Scope": "The vulnerability allows context-dependent attackers to cause a denial of service (crash) via a crafted (1) \"e\" or (2) \"er\" string in the second argument (aka mode).", "Related MITRE ATT&CK Techniques": "T1047 - Windows Management Instrumentation (WMI), T1047 - Coordinated Shellcode, T1548 - Backdoor", "Technical Details": "The vulnerability is due to a lack of input validation in the popen API function, which allows attackers to craft a sensitive string that is used in a _fdopen call.", "Detection": "Detection can be performed using rule-based IDS/IPS systems or by analyzing network traffic for suspicious patterns.", "Mitigation": "Mitigation strategies include updating PHP to version 5.2.11 or later, disabling WMI on vulnerable systems, and implementing WMI input validation.", "Conclusion": "The vulnerability poses a significant risk to systems running PHP and WMI, and should be addressed promptly."}, "executive_analysis": {"Overview": "A critical vulnerability exists in PHP that allows attackers to cause a denial of service (crash) on vulnerable systems.", "Business Impact": "The vulnerability could result in significant downtime and loss of productivity for affected organizations.", "Technical Impact": "The vulnerability allows attackers to crash vulnerable systems, which could result in significant technical disruptions.", "Mitigation Strategies": "Implementing patches, disabling WMI, and implementing input validation are all recommended strategies.", "Recommendations": "Organizations running PHP should update to the latest version, implement additional security measures, and conduct regular security audits.", "Conclusions": "The vulnerability is a significant risk and should be addressed promptly to minimize business disruption and technical impact."}}