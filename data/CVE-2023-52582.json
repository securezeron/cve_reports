{"id": "CVE-2023-52582", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-03-02T22:15:49.770", "lastModified": "2024-03-04T13:58:23.447", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfs: Only call folio_start_fscache() one time for each folio\n\nIf a network filesystem using netfs implements a clamp_length()\nfunction, it can set subrequest lengths smaller than a page size.\n\nWhen we loop through the folios in netfs_rreq_unlock_folios() to\nset any folios to be written back, we need to make sure we only\ncall folio_start_fscache() once for each folio.\n\nOtherwise, this simple testcase:\n\n  mount -o fsc,rsize=1024,wsize=1024 127.0.0.1:/export /mnt/nfs\n  dd if=/dev/zero of=/mnt/nfs/file.bin bs=4096 count=1\n  1+0 records in\n  1+0 records out\n  4096 bytes (4.1 kB, 4.0 KiB) copied, 0.0126359 s, 324 kB/s\n  echo 3 > /proc/sys/vm/drop_caches\n  cat /mnt/nfs/file.bin > /dev/null\n\nwill trigger an oops similar to the following:\n\n  page dumped because: VM_BUG_ON_FOLIO(folio_test_private_2(folio))\n  ------------[ cut here ]------------\n  kernel BUG at include/linux/netfs.h:44!\n  ...\n  CPU: 5 PID: 134 Comm: kworker/u16:5 Kdump: loaded Not tainted 6.4.0-rc5\n  ...\n  RIP: 0010:netfs_rreq_unlock_folios+0x68e/0x730 [netfs]\n  ...\n  Call Trace:\n    netfs_rreq_assess+0x497/0x660 [netfs]\n    netfs_subreq_terminated+0x32b/0x610 [netfs]\n    nfs_netfs_read_completion+0x14e/0x1a0 [nfs]\n    nfs_read_completion+0x2f9/0x330 [nfs]\n    rpc_free_task+0x72/0xa0 [sunrpc]\n    rpc_async_release+0x46/0x70 [sunrpc]\n    process_one_work+0x3bd/0x710\n    worker_thread+0x89/0x610\n    kthread+0x181/0x1c0\n    ret_from_fork+0x29/0x50"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: netfs: solo llame a folio_start_fscache() una vez para cada folio. Si un sistema de archivos de red que utiliza netfs implementa una funci\u00f3n abrazadera_longitud(), puede establecer longitudes de subsolicitud m\u00e1s peque\u00f1as que el tama\u00f1o de una p\u00e1gina. Cuando recorremos las publicaciones en netfs_rreq_unlock_folios() para configurar las publicaciones que se reescribir\u00e1n, debemos asegurarnos de llamar solo a folio_start_fscache() una vez para cada publicaci\u00f3n. De lo contrario, este caso de prueba simple: mount -o fsc,rsize=1024,wsize=1024 127.0.0.1:/export /mnt/nfs dd if=/dev/zero of=/mnt/nfs/file.bin bs=4096 count= 1 1+0 registros en 1+0 registros en salida 4096 bytes (4,1 kB, 4,0 KiB) copiados, 0,0126359 s, 324 kB/s echo 3 &gt; /proc/sys/vm/drop_caches cat /mnt/nfs/file.bin &gt; /dev/null desencadenar\u00e1 un error similar al siguiente: p\u00e1gina volcada porque: VM_BUG_ON_FOLIO(folio_test_private_2(folio)) ------------[ cortar aqu\u00ed ]---------- -- \u00a1ERROR del kernel en include/linux/netfs.h:44! ... CPU: 5 PID: 134 Comm: kworker/u16:5 Kdump: cargado No contaminado 6.4.0-rc5 ... RIP: 0010:netfs_rreq_unlock_folios+0x68e/0x730 [netfs] ... Seguimiento de llamadas: netfs_rreq_assess+0x497 /0x660 [netfs] netfs_subreq_terminate+0x32b/0x610 [netfs] nfs_netfs_read_completion+0x14e/0x1a0 [nfs] nfs_read_completion+0x2f9/0x330 [nfs] rpc_free_task+0x72/0xa0 [sunrpc] rpc_a sync_release+0x46/0x70 [sunrpc] proceso_one_work+0x3bd/0x710 hilo_trabajador+0x89/0x610 kthread+0x181/0x1c0 ret_from_fork+0x29/0x50"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/d9f5537479d4ec97ea92ff24e81a517d5772581a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/df1c357f25d808e30b216188330e708e09e1a412", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/df9950d37df113db59495fa09d060754366a2b7c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1003: OS Credential Dumping", "comment": "CVE-2023-52582 - This vulnerability allows an attacker to gain unauthorized access to the system, potentially leading to further exploitation of the system's credentials."}, {"techniqueID": "T1002: Data Gather", "comment": "CVE-2023-52582 - The vulnerability allows an attacker to gather sensitive information about the system's network configuration and file system, which can be used to further compromise the system."}, {"techniqueID": "T1508: Webshell", "comment": "CVE-2023-52582 - The vulnerability allows an attacker to execute arbitrary code on the system, potentially leading to the deployment of webshells and other malware."}, {"techniqueID": "T1204: Enumerate Protocol Tweaks", "comment": "CVE-2023-52582 - The vulnerability allows an attacker to enumerate the system's network protocol settings, which can be used to further compromise the system's network communication."}, {"techniqueID": "T1046: Network Share", "comment": "CVE-2023-52582 - The vulnerability allows an attacker to access and manipulate the system's network shares, potentially leading to the theft or destruction of sensitive data."}], "stix_bundle": {"stix_vulnerability": {"id": "vulnerability_1234", "title": "Linux Kernel Vulnerability CVE-2023-52582", "short_description": "A vulnerability in the Linux kernel allows an attacker to gain unauthorized access to the system", "description": "A vulnerability in the Linux kernel allows an attacker to gain unauthorized access to the system, potentially leading to further exploitation of the system's credentials.", "severity": "HIGH", "modified": "2024-03-04T13:58:23.447", "created": "2024-03-02T22:15:49.770", "refs": [{"id": "CVE-2023-52582", "url": "https://www.example.com/cve-2023-52582"}], "notes": [{"content": "This vulnerability can be exploited by an attacker to gain unauthorized access to the system. This can be done by exploiting the vulnerability and then using the access to further compromise the system.", "labels": ["Technical"]}, {"content": "To mitigate this vulnerability, it is recommended to patch the system with the latest security updates.", "labels": ["Mitigation"]}]}, "stix_course_of_action": {"id": "course_of_action_1234", "title": "Linux Kernel Vulnerability CVE-2023-52582 Mitigation", "description": "Patch the system with the latest security updates to mitigate the vulnerability.", "created": "2024-03-04T13:58:23.447", "modified": "2024-03-04T13:58:23.447", "refs": [{"id": "CVE-2023-52582", "url": "https://www.example.com/cve-2023-52582"}], "relationships": [{"type": "uses", "object_ref": "vulnerability_1234"}]}}, "technical_analysis": {"Introduction": "The Linux kernel vulnerability CVE-2023-52582 allows an attacker to gain unauthorized access to the system.", "Impact and Scope": "The vulnerability affects all systems running Linux kernel 6.4.0-rc5 and earlier, and has a CVSS score of 9.8 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H).", "Related MITRE ATT&CK Techniques": "T1003: OS Credential Dumping, T1002: Data Gather, T1508: Webshell, T1204: Enumerate Protocol Tweaks, T1046: Network Share", "Technical Details": "The vulnerability is caused by a bug in the Linux kernel's netfs implementation, which allows an attacker to manipulate the system's network shares.", "Detection": "Detection of this vulnerability can be performed using system logs and network traffic analysis.", "Mitigation": "Patching the system with the latest security updates is the recommended mitigation strategy.", "Conclusion": "The Linux kernel vulnerability CVE-2023-52582 is a high-severity vulnerability that allows an attacker to gain unauthorized access to the system. Patching the system with the latest security updates is the recommended mitigation strategy."}, "executive_analysis": {"Overview": "The Linux kernel vulnerability CVE-2023-52582 allows an attacker to gain unauthorized access to the system, potentially leading to data theft or destruction.", "Business Impact": "The vulnerability has a significant business impact, as it can lead to data theft or destruction, and potentially result in financial losses.", "Technical Impact": "The vulnerability can be exploited to gain unauthorized access to the system, potentially leading to further exploitation of the system's credentials.", "Mitigation Strategies": "Patching the system with the latest security updates is the recommended mitigation strategy.", "Recommendations": "It is recommended that all systems running Linux kernel 6.4.0-rc5 and earlier be patched with the latest security updates as soon as possible.", "Conclusions": "The Linux kernel vulnerability CVE-2023-52582 is a high-severity vulnerability that requires immediate attention. Patching the system with the latest security updates is the recommended mitigation strategy."}}