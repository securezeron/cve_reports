{"id": "CVE-2024-29895", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-14T15:17:15.593", "lastModified": "2024-05-14T16:13:02.773", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Cacti provides an operational monitoring and fault management framework. A command injection vulnerability on the 1.3.x DEV branch allows any unauthenticated user to execute arbitrary command on the server when `register_argc_argv` option of PHP is `On`. In `cmd_realtime.php` line 119, the `$poller_id` used as part of the command execution is sourced from `$_SERVER['argv']`, which can be controlled by URL when `register_argc_argv` option of PHP is `On`. And this option is `On` by default in many environments such as the main PHP Docker image for PHP. Commit 53e8014d1f082034e0646edc6286cde3800c683d contains a patch for the issue, but this commit was reverted in commit 99633903cad0de5ace636249de16f77e57a3c8fc."}, {"lang": "es", "value": "Cacti proporciona un framework de monitoreo operativo y gesti\u00f3n de fallas. Una vulnerabilidad de inyecci\u00f3n de comandos en la rama DEV 1.3.x permite que cualquier usuario no autenticado ejecute comandos arbitrarios en el servidor cuando la opci\u00f3n `register_argc_argv` de PHP est\u00e1 `activada`. En la l\u00ednea 119 de `cmd_realtime.php`, el `$poller_id` usado como parte de la ejecuci\u00f3n del comando proviene de `$_SERVER['argv']`, que puede controlarse mediante URL cuando la opci\u00f3n `register_argc_argv` de PHP est\u00e1 activada. `. Y esta opci\u00f3n est\u00e1 \"activada\" de forma predeterminada en muchos entornos, como la imagen principal de PHP Docker para PHP. el commit 53e8014d1f082034e0646edc6286cde3800c683d contiene un parche para el problema, pero este commit se revirti\u00f3 en el commit 99633903cad0de5ace636249de16f77e57a3c8fc."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-77"}]}], "references": [{"url": "https://github.com/Cacti/cacti/blob/501712998589763d411a68d35e3cda98fd9cfd18/cmd_realtime.php#L119", "source": "security-advisories@github.com"}, {"url": "https://github.com/Cacti/cacti/commit/53e8014d1f082034e0646edc6286cde3800c683d", "source": "security-advisories@github.com"}, {"url": "https://github.com/Cacti/cacti/commit/99633903cad0de5ace636249de16f77e57a3c8fc", "source": "security-advisories@github.com"}, {"url": "https://github.com/Cacti/cacti/security/advisories/GHSA-cr28-x256-xf5m", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-29895 - Unauthenticated remote command injection vulnerability in Cacti allows attackers to execute arbitrary commands, enabling potential exploitation of the vulnerability. This technique is relevant as it demonstrates the ability to inject malicious code into the vulnerable system."}, {"techniqueID": "T1190", "comment": "CVE-2024-29895 - Attackers can leverage the vulnerable PHP option to register argc and argv to execute arbitrary commands, making it possible to deliver and execute payloads on the affected system. This technique is relevant as it showcases the exploitation of the vulnerability."}], "stix_bundle": {"foreign_attributes": {"Vulnerability": {"id": "CVE-2024-29895", "description": "Cacti provides an operational monitoring and fault management framework. A command injection vulnerability on the 1.3.x DEV branch allows any unauthenticated user to execute arbitrary command on the server when `register_argc_argv` option of PHP is `On`.", "labels": ["CWE-77", "Vulnerability"]}, "Related_Exploit": {"id": "T1190", "description": "Exploit of the vulnerable PHP option to register argc and argv", "labels": ["MITRE", "Technique"]}}}, "technical_analysis": {"Introduction": "CVE-2024-29895 is a command injection vulnerability in Cacti version 1.3.x DEV branch, allowing unauthenticated users to execute arbitrary commands on the server.", "Impact and Scope": "This vulnerability has a CVSS score of 10.0 (CRITICAL) with an attack vector of NETWORK and an attack complexity of LOW.", "Related MITRE ATT&CK Techniques": "The techniques relevant to this CVE include T1059 and T1190, demonstrating the potential for unauthenticated remote command injection and exploitation of the vulnerability.", "Technical Details": "The vulnerability occurs when the `register_argc_argv` option of PHP is set to `On`, allowing attackers to inject malicious code into the system.", "Detection": "Detection of this vulnerability can be achieved by monitoring system logs for suspicious command execution and analyzing system configurations for the presence of the vulnerable PHP option.", "Mitigation": "Mitigation strategies include disabling the `register_argc_argv` option of PHP, patching the vulnerable code, and implementing input validation and sanitization mechanisms.", "Conclusion": "In conclusion, CVE-2024-29895 is a critical vulnerability that requires immediate attention and remediation to prevent compromise of sensitive data and systems."}, "executive_analysis": {"Overview": "CVE-2024-29895 is a critical command injection vulnerability in Cacti that allows unauthenticated users to execute arbitrary commands on the server, posing a significant threat to security.", "Business Impact": "This vulnerability can result in significant financial losses, damage to reputation, and compromise of sensitive data.", "Technical Impact": "The technical impact of this vulnerability includes the potential for remote command injection, making it possible for attackers to execute arbitrary code.", "Mitigation Strategies": "Implementing input validation and sanitization mechanisms, patching the vulnerable code, and disabling the `register_argc_argv` option of PHP are recommended mitigation strategies.", "Recommendations": "Recommendations for executives include prioritizing remediation of the vulnerability, conducting risk assessments, and implementing security improvements.", "Conclusions": "In conclusion, immediate attention is required to remediate this critical vulnerability and prevent potential security breaches."}}