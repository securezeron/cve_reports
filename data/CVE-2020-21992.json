{"id": "CVE-2020-21992", "sourceIdentifier": "cve@mitre.org", "published": "2021-04-29T15:15:10.443", "lastModified": "2021-05-12T15:06:28.480", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Inim Electronics SmartLiving SmartLAN/G/SI <=6.x suffers from an authenticated remote command injection vulnerability. The issue exist due to the 'par' POST parameter not being sanitized when called with the 'testemail' module through web.cgi binary. The vulnerable CGI binary (ELF 32-bit LSB executable, ARM) is calling the 'sh' executable via the system() function to issue a command using the mailx service and its vulnerable string format parameter allowing for OS command injection with root privileges. An attacker can remotely execute system commands as the root user using default credentials and bypass access controls in place."}, {"lang": "es", "value": "Inim Electronics SmartLiving SmartLAN/G/SI versiones anteriores a 6.x  incluy\u00e9ndola, sufre una vulnerabilidad de inyecci\u00f3n de comando remoto autenticado.&#xa0;El problema se presenta debido a que el par\u00e1metro POST \"par\" no est\u00e1 siendo saneado cuando se llama con el m\u00f3dulo \"testemail\" por medio del binario web.cgi.&#xa0;El binario CGI vulnerable (ejecutable ELF LSB de 32 bits, ARM) est\u00e1 llamando al ejecutable \"sh\" por medio de la funci\u00f3n system() para emitir un comando usando el servicio mailx y su par\u00e1metro de formato de cadena vulnerable que permite la inyecci\u00f3n de comandos del Sistema Operativo con privilegios root.&#xa0;Un atacante puede ejecutar comandos del sistema de forma remota como usuario root usando las credenciales predeterminadas y omitir los controles de acceso en su lugar"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:inim:smartliving_505:-:*:*:*:*:*:*:*", "matchCriteriaId": "30FE3762-2144-4DF6-89C1-2181E15ACCF4"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:inim:smartliving_505_firmware:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.0", "matchCriteriaId": "1D6EB9DE-4537-4070-9AAB-197FAD04313C"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:inim:smartliving_515:-:*:*:*:*:*:*:*", "matchCriteriaId": "1EBA5461-77FB-46E5-BFDC-F470A9A97492"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:inim:smartliving_515_firmware:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.0", "matchCriteriaId": "72CEA623-65E8-4F0B-87C0-615ED5C47269"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:inim:smartliving_1050:-:*:*:*:*:*:*:*", "matchCriteriaId": "1BB1029D-DC9C-444A-BCE3-AF1BE074A068"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:inim:smartliving_1050_firmware:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.0", "matchCriteriaId": "E9ACAF85-F4BD-4751-ACA5-0ADE339C82A3"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:inim:smartliving_1050g3:-:*:*:*:*:*:*:*", "matchCriteriaId": "0BF688BA-60F1-4F19-8CFA-6C1EFB4D4128"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:inim:smartliving_1050g3_firmware:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.0", "matchCriteriaId": "945C2E70-72F7-4EF6-BFBC-CFDA43FC6DE0"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:inim:smartliving_10100l:-:*:*:*:*:*:*:*", "matchCriteriaId": "5537E090-43C2-42B1-A793-23E765A82D6E"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:inim:smartliving_10100l_firmware:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.0", "matchCriteriaId": "270CD713-574B-4A14-A002-275CD3C7EF86"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:inim:smartliving_10100lg3:-:*:*:*:*:*:*:*", "matchCriteriaId": "108A7416-7196-49E8-9181-CE27C9F1ED11"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:inim:smartliving_10100lg3_firmware:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.0", "matchCriteriaId": "E3F59BB8-E7D0-4B3A-A05F-CD78B9510DA0"}]}]}], "references": [{"url": "https://www.zeroscience.mk/en/vulnerabilities/ZSL-2019-5544.php", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1086", "comment": "CVE-2020-21992 - This technique relates to the use of command injection, which is a common attack vector used by attackers to execute sensitive commands. This is relevant because it highlights the importance of proper input validation and sanitization in web applications to prevent these types of attacks."}, {"techniqueID": "T1078", "comment": "CVE-2020-21992 - This technique relates to the use of authenticated remote command injection, which is a specific type of command injection that requires an authenticated session to execute. This is relevant because it highlights the importance of properly implementing access controls and securing authenticated sessions to prevent exploitation of this vulnerability."}], "stix_bundle": {"objects": [{"id": "vulnerability:CVE-2020-21992", "type": "vulnerability", "description": "CVE-2020-21992: Inim Electronics SmartLiving SmartLAN/G/SI <=6.x suffers from an authenticated remote command injection vulnerability.", "created_by_ref": null, "modified": "2021-05-12T15:06:28.480", "created": "2021-04-29T15:15:10.443"}, {"id": "indicator:Inim Electronics SmartLiving SmartLAN/G/SI <=6.x", "type": "indicator", "description": "Inim Electronics SmartLiving SmartLAN/G/SI <=6.x is identified as a vulnerable software.", "created_by_ref": null, "modified": null, "created": null}, {"id": "attack-pattern:Authenticated Remote Command Injection", "type": "attack-pattern", "description": "Authenticated Remote Command Injection: An attacker injects a command into a vulnerable application, which is then executed by the application with elevated privileges.", "created_by_ref": null, "modified": null, "created": null}, {"id": "action:Web CGI Binary with Unsanitized Parameters", "type": "action", "description": "Web CGI Binary with Unsanitized Parameters: The web CGI binary processes user input with a vulnerable CGI module, which allows for the execution of arbitrary system commands.", "created_by_ref": null, "modified": null, "created": null}, {"id": "course-of-action:Update Software to Version 6.1", "type": "course-of-action", "description": "Update Software to Version 6.1: Update the SmartLiving SmartLAN/G/SI software to version 6.1 or later to address this vulnerability.", "created_by_ref": null, "modified": null, "created": null}], "relationship": [{"id": "relationship:CVE-2020-21992- Identified_by:Inim Electronics SmartLiving SmartLAN/G/SI <=6.x", "type": "created-from", "description": "The identified vulnerability was created from the Inim Electronics SmartLiving SmartLAN/G/SI <=6.x software.", "object_refs": ["vulnerability:CVE-2020-21992", "indicator:Inim Electronics SmartLiving SmartLAN/G/SI <=6.x"]}, {"id": "relationship:vulnerability:CVE-2020-21992- exploits:Authenticated Remote Command Injection", "type": "exploits", "description": "The authenticated remote command injection attack pattern exploits the identified vulnerability.", "object_refs": ["vulnerability:CVE-2020-21992", "attack-pattern:Authenticated Remote Command Injection"]}, {"id": "relationship:vulnerability:CVE-2020-21992- mitigates:Web CGI Binary with Unsanitized Parameters", "type": "mitigates", "description": "The action of updating the software to version 6.1 or later mitigates the identified vulnerability and the action of using a web CGI binary with sanitized parameters.", "object_refs": ["vulnerability:CVE-2020-21992", "action:Web CGI Binary with Unsanitized Parameters", "course-of-action:Update Software to Version 6.1"]}]}, "technical_analysis": {"Introduction": "Inim Electronics SmartLiving SmartLAN/G/SI <=6.x suffers from an authenticated remote command injection vulnerability due to the 'par' POST parameter not being sanitized when called with the 'testemail' module through web.cgi binary. This vulnerability allows an attacker to remotely execute system commands as the root user with default credentials.", "Impact and Scope": "The CVSS score for this vulnerability is 8.8 (High) with an attack vector of NETWORK and attack complexity of LOW. This vulnerability affects all versions of Inim Electronics SmartLiving SmartLAN/G/SI software prior to version 6.1.", "Related MITRE ATT&CK Techniques": "T1086: Read Data Files and T1078: Lateral Movement are related to this vulnerability.", "Technical Details": "The vulnerability exists due to the web.cgi binary processing user input with a vulnerable CGI module, which allows for the execution of arbitrary system commands.", "Detection": "Detection of this vulnerability can be performed using Intrusion Detection System (IDS) signatures or reconnaissance techniques such as network scanning and OS detection.", "Mitigation": "Mitigation strategies for this vulnerability include updating the software to version 6.1 or later, disabling the 'testemail' module, and implementing access controls to restrict access to the web.cgi binary.", "Conclusion": "In conclusion, the authenticated remote command injection vulnerability in Inim Electronics SmartLiving SmartLAN/G/SI <=6.x software allows an attacker to remotely execute system commands as the root user with default credentials. It is recommended to update the software to version 6.1 or later and implement access controls to mitigate this vulnerability."}, "executive_analysis": {"Overview": "Inim Electronics SmartLiving SmartLAN/G/SI <=6.x software contains a remotely exploitable vulnerability that allows an attacker to execute system commands as the root user with default credentials.", "Business Impact": "This vulnerability can allow attackers to gain unauthorized access to sensitive data and systems, leading to significant financial and reputational damage.", "Technical Impact": "The vulnerability affects all versions of Inim Electronics SmartLiving SmartLAN/G/SI software prior to version 6.1, and exploitation can lead to complete compromise of the system.", "Mitigation Strategies": "Implement access controls to restrict access to the web.cgi binary, update the software to version 6.1 or later, and disable the 'testemail' module.", "Recommendations": "Recommendations for executives include prioritizing the mitigation of this vulnerability, increasing network segmentation, and implementing incident response and disaster recovery plans.", "Conclusions": "In conclusion, the authenticated remote command injection vulnerability in Inim Electronics SmartLiving SmartLAN/G/SI <=6.x software is a critical threat that requires immediate attention and mitigation."}}