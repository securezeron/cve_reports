{"id": "CVE-2024-28250", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-18T22:15:08.750", "lastModified": "2024-03-19T13:26:46.000", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Cilium is a networking, observability, and security solution with an eBPF-based dataplane. Starting in version 1.14.0 and prior to versions 1.14.8 and 1.15.2, In Cilium clusters with WireGuard enabled and traffic matching Layer 7 policies Wireguard-eligible traffic that is sent between a node's Envoy proxy and pods on other nodes is sent unencrypted and Wireguard-eligible traffic that is sent between a node's DNS proxy and pods on other nodes is sent unencrypted. This issue has been resolved in Cilium 1.14.8 and 1.15.2 in in native routing mode (`routingMode=native`) and in Cilium 1.14.4 in tunneling mode (`routingMode=tunnel`). Not that in tunneling mode, `encryption.wireguard.encapsulate` must be set to `true`. There is no known workaround for this issue."}, {"lang": "es", "value": "Cilium es una soluci\u00f3n de redes, observabilidad y seguridad con un plano de datos basado en eBPF. A partir de la versi\u00f3n 1.14.0 y anteriores a las versiones 1.14.8 y 1.15.2, en los cl\u00fasteres de Cilium con WireGuard habilitado y el tr\u00e1fico que coincide con las pol\u00edticas de Capa 7, el tr\u00e1fico elegible para Wireguard que se env\u00eda entre el proxy Envoy de un nodo y los pods de otros nodos se env\u00eda sin cifrar. y el tr\u00e1fico elegible para Wireguard que se env\u00eda entre el proxy DNS de un nodo y los pods de otros nodos se env\u00eda sin cifrar. Este problema se resolvi\u00f3 en Cilium 1.14.8 y 1.15.2 en modo de enrutamiento nativo (`routingMode=native`) y en Cilium 1.14.4 en modo de t\u00fanel (`routingMode=tunnel`). No es que en modo t\u00fanel, `encryption.wireguard.encapsulate` deba establecerse en `true`. No se conoce ning\u00fan workaround para este problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:N", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 4.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-311"}]}], "references": [{"url": "https://github.com/cilium/cilium/releases/tag/v1.13.13", "source": "security-advisories@github.com"}, {"url": "https://github.com/cilium/cilium/releases/tag/v1.14.8", "source": "security-advisories@github.com"}, {"url": "https://github.com/cilium/cilium/releases/tag/v1.15.2", "source": "security-advisories@github.com"}, {"url": "https://github.com/cilium/cilium/security/advisories/GHSA-v6q2-4qr3-5cw6", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1560", "comment": "CVE-2024-28250 - A potential attacker could exploit this vulnerability to intercept wireguard-eligible traffic sent between the Envoy proxy and pods on other nodes in a Cilium cluster, which could lead to unauthorized access and data exfiltration. Defend against this by configuring Cilium to use Encrypted Passthrough or TLS passthrough."}, {"techniqueID": "T1210", "comment": "CVE-2024-28250 - This vulnerability in Cilium's WireGuard implementation allows an attacker to intercept and manipulate traffic, which could enable tactics such as Command and Control, Data Exfiltration, and etc. Defend against this by configuring Cilium to use Encrypted Passthrough or TLS passthrough and monitoring network traffic for suspicious activity."}], "technical_analysis": {"Introduction": "The CVE-2024-28250 vulnerability in Cilium's WireGuard implementation allows an attacker to exploit a lack of encryption in wireguard-eligible traffic sent between nodes in a Cilium cluster, which could enable unauthorized access and data exfiltration.", "Impact and Scope": "The vulnerability has a CVSS score of 6.1 (Medium) and an attack vector of Adjacent Network. It affects Cilium clusters with WireGuard enabled and traffic matching Layer 7 policies.", "Related MITRE ATT&CK Techniques": "T1560, T1210", "Technical Details": "The vulnerability occurs when wireguard-eligible traffic between nodes in a Cilium cluster is sent unencrypted, allowing an attacker to intercept and manipulate traffic.", "Detection": "Monitor network traffic for suspicious activity, especially for wireguard-eligible traffic between nodes in a Cilium cluster.", "Mitigation": "Configure Cilium to use Encrypted Passthrough or TLS passthrough, and monitor network traffic for suspicious activity.", "Conclusion": "This vulnerability highlights the importance of encrypting sensitive data in transit, especially for organizations using Cilium for networking and security."}, "executive_analysis": {"Overview": "The CVE-2024-28250 vulnerability in Cilium's WireGuard implementation allows an attacker to intercept and manipulate sensitive data in transit, which could enable unauthorized access and data exfiltration.", "Business Impact": "This vulnerability could have significant business implications if left unfixed, including data breaches and reputational damage.", "Technical Impact": "The vulnerability affects the confidentiality and integrity of wireguard-eligible traffic sent between nodes in a Cilium cluster.", "Mitigation Strategies": "Configure Cilium to use Encrypted Passthrough or TLS passthrough, and monitor network traffic for suspicious activity.", "Recommendations": "Executives should prioritize patching and configuring Cilium to mitigate this vulnerability, and ensure their organization is monitoring for suspicious activity.", "Conclusions": "This vulnerability emphasizes the importance of proactive security measures, including prioritizing patching and configuring Cilium to mitigate this vulnerability."}}