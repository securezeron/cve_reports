{"id": "CVE-2024-39915", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-15T20:15:03.933", "lastModified": "2024-07-16T13:43:58.773", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Thruk is a multibackend monitoring webinterface for Naemon, Nagios, Icinga and Shinken using the Livestatus API. This authenticated RCE in Thruk allows authorized users with network access to inject arbitrary commands via the URL parameter during PDF report generation. The Thruk web application does not properly process the url parameter when generating a PDF report. An authorized attacker with access to the reporting functionality could inject arbitrary commands that would be executed when the script /script/html2pdf.sh is called. The vulnerability can be exploited by an authorized user with network access. This issue has been addressed in version 3.16. Users are advised to upgrade. There are no known workarounds for this vulnerability.\n"}, {"lang": "es", "value": "Thruk es una interfaz web de monitoreo multibackend para Naemon, Nagios, Icinga y Shinken que utiliza la API Livestatus. Este RCE autenticado en Thruk permite a los usuarios autorizados con acceso a la red inyectar comandos arbitrarios a trav\u00e9s del par\u00e1metro URL durante la generaci\u00f3n de informes PDF. La aplicaci\u00f3n web Thruk no procesa correctamente el par\u00e1metro de URL al generar un informe en PDF. Un atacante autorizado con acceso a la funcionalidad de informes podr\u00eda inyectar comandos arbitrarios que se ejecutar\u00edan cuando se llame al script /script/html2pdf.sh. La vulnerabilidad puede ser explotada por un usuario autorizado con acceso a la red. Este problema se solucion\u00f3 en la versi\u00f3n 3.16. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.9, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.1, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://github.com/sni/Thruk/commit/7e7eb251e76718a07639c4781f0d959d817f173b", "source": "security-advisories@github.com"}, {"url": "https://github.com/sni/Thruk/security/advisories/GHSA-r7gx-h738-4w6f", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-39915 - This RCE vulnerability in Thruk allows attackers to inject arbitrary commands during PDF report generation, highlighting the importance of vulnerability scanning and patch management to prevent exploitation."}, {"techniqueID": "T1190", "comment": "CVE-2024-39915 - The unauthorized execution of commands during PDF report generation demonstrates the potential for lateral movement, emphasizing the need for network segmentation and monitoring to detect and respond to potential exploitation."}, {"techniqueID": "T1204", "comment": "CVE-2024-39915 - The ability to inject arbitrary commands during PDF report generation shows the potential for data exfiltration, highlighting the importance of monitoring for unusual network activity and data transfer."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve-2024-39915", "objects": [{"type": "indicator", "id": "https://example.com/cve-2024-39915/indicator", "name": "CVE-2024-39915 Thruk RCE", "description": "RCE vulnerability in Thruk allowing unauthorized command execution during PDF report generation", "created_by_ref": "https://example.com/cve-2024-39915", "created": "2024-07-15T20:15:03.933"}, {"type": "intrusion-set", "id": "https://example.com/cve-2024-39915/intrusion-set", "name": "Thruk RCE exploitation", "description": "Group of attackers exploiting the RCE vulnerability in Thruk to inject arbitrary commands during PDF report generation", "created_by_ref": "https://example.com/cve-2024-39915", "created": "2024-07-15T20:15:03.933"}, {"type": "course-of-action", "id": "https://example.com/cve-2024-39915/course-of-action", "name": "CVE-2024-39915 Thruk RCE Mitigation", "description": "Upgrade to version 3.16 and implement network segmentation and monitoring to detect and respond to potential exploitation", "mitigated_by_ref": "https://example.com/cve-2024-39915/mitigation", "mitigated": "2024-07-16T13:43:58.773"}, {"type": "technique", "id": "https://example.com/cve-2024-39915/technique", "name": "Thruk RCE exploitation", "description": "Exploitation of the RCE vulnerability in Thruk to inject arbitrary commands during PDF report generation", "techniques_refs": ["https://attack.mitre.org/techniques/T1210", "https://attack.mitre.org/techniques/T1190", "https://attack.mitre.org/techniques/T1204"]}, {"type": "observation-encoder", "id": "https://example.com/cve-2024-39915/observation-encoder", "name": "Thruk RCE detection", "description": "Detection of Thruk RCE exploitation through monitoring of network activity and data transfer", "detection": "https://example.com/cve-2024-39915/detection", "risk_score": 90}], "relationship": [{"type": "has-parts", "id": "https://example.com/cve-2024-39915/has-parts", "relationship": "has-parts", "source_id": "https://example.com/cve-2024-39915/indicator", "target_id": "https://example.com/cve-2024-39915/intrusion-set"}, {"type": "has-parts", "id": "https://example.com/cve-2024-39915/has-parts", "relationship": "has-parts", "source_id": "https://example.com/cve-2024-39915/intrusion-set", "target_id": "https://example.com/cve-2024-39915/technique"}, {"type": "is-mitigated-by", "id": "https://example.com/cve-2024-39915/is-mitigated-by", "relationship": "is-mitigated-by", "source_id": "https://example.com/cve-2024-39915/technique", "target_id": "https://example.com/cve-2024-39915/course-of-action"}]}, "technical_analysis": {"Introduction": "Thruk is a multibackend monitoring webinterface for Naemon, Nagios, Icinga and Shinken using the Livestatus API. A remote code execution vulnerability was discovered in Thruk, allowing authorized users to inject arbitrary commands during PDF report generation.", "Impact and Scope": "The vulnerability has a CVSS score of 9.9, with a high severity rating due to the potential for remote code execution. The vulnerability affects all versions of Thruk prior to 3.16.", "Related MITRE ATT&CK Techniques": "The vulnerability demonstrates the potential for exploitation using MITRE ATT&CK techniques T1210, T1190, and T1204.", "Technical Details": "The vulnerability occurs when the Thruk web application does not properly process the URL parameter when generating a PDF report. The /script/html2pdf.sh script is called, allowing attackers to inject arbitrary commands.", "Detection": "Detection of this vulnerability can be achieved through monitoring of network activity and data transfer. Network segmentation and monitoring can help prevent exploitation.", "Mitigation": "Upgrade to version 3.16 and implement network segmentation and monitoring to detect and respond to potential exploitation.", "Conclusion": "The remote code execution vulnerability in Thruk highlights the importance of regular vulnerability scanning and patch management. Exploitation of this vulnerability can result in significant data breaches and system compromise, emphasizing the need for prompt mitigation and detection."}, "executive_analysis": {"Overview": "A remote code execution vulnerability was discovered in Thruk, allowing authorized users to inject arbitrary commands during PDF report generation.", "Business Impact": "The vulnerability has the potential to result in significant data breaches and system compromise, highlighting the need for prompt mitigation and detection.", "Technical Impact": "The vulnerability demonstrates the potential for exploitation using MITRE ATT&CK techniques T1210, T1190, and T1204, emphasizing the need for network segmentation and monitoring.", "Mitigation Strategies": "Upgrade to version 3.16 and implement network segmentation and monitoring to detect and respond to potential exploitation.", "Recommendations": "Regular vulnerability scanning and patch management should be implemented to prevent exploitation. Network segmentation and monitoring should be implemented to detect and respond to potential exploitation.", "Conclusions": "The remote code execution vulnerability in Thruk highlights the importance of prompt mitigation and detection. Executives should prioritize the implementation of these mitigation strategies to prevent potential exploitation."}}