{"id": "CVE-2024-41062", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-29T15:15:14.173", "lastModified": "2024-07-29T16:21:52.517", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nbluetooth/l2cap: sync sock recv cb and release\n\nThe problem occurs between the system call to close the sock and hci_rx_work,\nwhere the former releases the sock and the latter accesses it without lock protection.\n\n           CPU0                       CPU1\n           ----                       ----\n           sock_close                 hci_rx_work\n\t   l2cap_sock_release         hci_acldata_packet\n\t   l2cap_sock_kill            l2cap_recv_frame\n\t   sk_free                    l2cap_conless_channel\n\t                              l2cap_sock_recv_cb\n\nIf hci_rx_work processes the data that needs to be received before the sock is\nclosed, then everything is normal; Otherwise, the work thread may access the\nreleased sock when receiving data.\n\nAdd a chan mutex in the rx callback of the sock to achieve synchronization between\nthe sock release and recv cb.\n\nSock is dead, so set chan data to NULL, avoid others use invalid sock pointer."}, {"lang": "es", "value": "En el kernel de Linux se ha resuelto la siguiente vulnerabilidad: bluetooth/l2cap: sync sock recv cb and release El problema ocurre entre la llamada al sistema para cerrar el calcet\u00edn y hci_rx_work, donde el primero libera el calcet\u00edn y el segundo accede a \u00e9l sin protecci\u00f3n de bloqueo. . CPU0 CPU1 ---- ---- sock_close hci_rx_work l2cap_sock_release hci_acldata_packet l2cap_sock_kill l2cap_recv_frame sk_free l2cap_conless_channel l2cap_sock_recv_cb Si hci_rx_work procesa los datos que deben recibirse antes de cerrar el sock, entonces todo es normal; De lo contrario, el hilo de trabajo puede acceder al sock liberado al recibir datos. Agregue un mutex chan en la devoluci\u00f3n de llamada rx del sock para lograr la sincronizaci\u00f3n entre la liberaci\u00f3n del sock y recv cb. Sock est\u00e1 muerto, as\u00ed que configure los datos de chan en NULL, evite que otros usen un puntero de sock no v\u00e1lido."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/3b732449b78183d17178db40be3a4401cf3cd629", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/605572e64cd9cebb05ed609d96cff05b50d18cdf", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/89e856e124f9ae548572c56b1b70c2255705f8fe", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b803f30ea23e0968b6c8285c42adf0d862ab2bf6", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-41062 - This vulnerability allows an attacker to potentially access the sock after it has been closed, which can be used to exploit the system. This is a classic example of a Use After Free (UAF) issue, which can be used by attackers to execute arbitrary code."}, {"techniqueID": "T1191", "comment": "CVE-2024-41062 - The kernel's L2CAP implementation allows an attacker to send packets before releasing the socket, which can result in the kernel not properly handling the packets and potentially leading to code execution."}, {"techniqueID": "T1204", "comment": "CVE-2024-41062 - This vulnerability allows an attacker to send crafted packets to the L2CAP socket, which can result in the kernel crashing or leading to unexpected behavior, allowing an attacker to potentially execute arbitrary code."}], "stix_bundle": {"@context": "https://stiX2.1.stix.xml.dshield.org/STIX", "objects": [{"type": "intrusion-set", "id": "intrusion-set--9e5a1c53-56cd-4399-a94f-ecb2e6f542ac", "createdBy": "entity--a94c9a85-7a31-4e37-a8f4-c6c69a4ebf6d", "created": "2024-07-29T16:21:52.517Z", "name": "L2CAP Sock Vulnerability", "description": "The L2CAP sock vulnerability in the Linux kernel allows an attacker to send crafted packets to the L2CAP socket, resulting in unexpected behavior and potentially leading to code execution.", "added_object_refs": [{"typ": "indicator", "href": "indicator--25a4d9e1-43be-4f9a-90f4-42f7bd7f0f3a"}]}, {"type": "indicators", "id": "indicator--25a4d9e1-43be-4f9a-90f4-42f7bd7f0f3a", "createdBy": "entity--a94c9a85-7a31-4e37-a8f4-c6c69a4ebf6d", "created": "2024-07-29T16:21:52.517Z", "name": "L2CAP Sock Packet", "description": "A crafted packet sent to the L2CAP socket, potentially resulting in unexpected behavior and code execution.", "x_mitre.kill_chain_phases": [{"phase_name": "initial-compromise"}]}], "incidents": [{"type": "incident", "id": "incident--9e5a1c53-56cd-4399-a94f-ecb2e6f542ac", "createdBy": "entity--a94c9a85-7a31-4e37-a8f4-c6c69a4ebf6d", "created": "2024-07-29T16:21:52.517Z", "name": "L2CAP Sock Vulnerability Incident", "description": "An incident involving the L2CAP sock vulnerability in the Linux kernel, potentially resulting in code execution."}]}, "technical_analysis": {"Introduction": "The L2CAP sock vulnerability in the Linux kernel is a Use After Free (UAF) issue that allows an attacker to send crafted packets to the L2CAP socket, potentially resulting in unexpected behavior and code execution.", "Impact and Scope": {"cvss_score": "7.5", "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "attack_vector": "Network"}, "Related MITRE ATT&CK Techniques": ["T1190", "T1191", "T1204"], "Technical Details": "The vulnerability occurs when the Linux kernel's L2CAP implementation fails to properly release the socket before sending packets, allowing an attacker to send crafted packets and potentially execute arbitrary code.", "Detection": "Detect the vulnerability by monitoring for unexpected behavior and packet traffic on the L2CAP socket.", "Mitigation": "Apply the patch provided by the Linux kernel developers to fix the vulnerability.", "Conclusion": "The L2CAP sock vulnerability is a critical issue that requires immediate attention and patching to prevent potential code execution."}, "executive_analysis": {"Overview": "The L2CAP sock vulnerability in the Linux kernel is a critical issue that requires immediate attention and patching.", "Business Impact": "The vulnerability can potentially lead to code execution, resulting in business disruption and data loss.", "Technical Impact": "The vulnerability can potentially lead to code execution, resulting in technical disruption and data loss.", "Mitigation Strategies": "Apply the patch provided by the Linux kernel developers to fix the vulnerability.", "Recommendations": "Recommend patching the Linux kernel immediately to prevent potential code execution.", "Conclusions": "The L2CAP sock vulnerability is a critical issue that requires immediate attention and patching to prevent potential code execution."}}