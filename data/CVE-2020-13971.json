{"id": "CVE-2020-13971", "sourceIdentifier": "cve@mitre.org", "published": "2020-07-28T21:15:14.230", "lastModified": "2020-07-31T14:05:05.630", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Shopware before 6.2.3, authenticated users are allowed to use the Mediabrowser fileupload feature to upload SVG images containing JavaScript. This leads to Persistent XSS. An uploaded image can be accessed without authentication."}, {"lang": "es", "value": "En Shopware versiones anteriores a 6.2.3, los usuarios autenticados pueden usar la funcionalidad Mediabrowser fileupload para cargar im\u00e1genes SVG que contengan JavaScript. Esto conlleva a un ataque de tipo XSS Persistente. Una imagen cargada puede ser accedida sin autenticaci\u00f3n"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:shopware:shopware:*:*:*:*:*:*:*:*", "versionEndExcluding": "6.2.3", "matchCriteriaId": "464032D0-B36D-4F58-8F49-E95F4563C9E7"}]}]}], "references": [{"url": "https://docs.shopware.com/en/shopware-6-en/security-updates/security-update-07-2020", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://www.shopware.com/en/changelog/#6-2-3", "source": "cve@mitre.org", "tags": ["Release Notes", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2020-13971 - A Stored Cross-Site Scripting (XSS) vulnerability exists, which allows an authenticated attacker to upload an SVG image containing JavaScript. This allows for persistent XSS attacks."}, {"techniqueID": "T1518.001", "comment": "CVE-2020-13971 - An attacker can exploit the vulnerability to upload SVG images containing JavaScript, which can be accessed without authentication, leading to data exfiltration."}, {"techniqueID": "T1105", "comment": "CVE-2020-13971 - The vulnerability allows an authenticated attacker to upload malicious files, such as SVG images containing JavaScript, which can lead to an unauthorized file upload."}, {"techniqueID": "T1555.012", "comment": "CVE-2020-13971 - An attacker can exploit the vulnerability to upload a malicious SVG image containing JavaScript, which can be accessed without authentication and lead to a Stored Cross-Site Scripting (XSS) attack."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "https://example.com/stix-2.1.json", "created_by_ref": "https://example.com/stix-2.1.json", "created": "2022-01-01T00:00:00.000Z", "modified": "2022-01-01T00:00:00.000Z", "spec_version": "2.1", "stix_content": {"global_ids": [{"id": "https://example.com/stix-2.1.json", "type": "bundle", "relationship": "part_of"}], "objects": [{"id": "https://example.com/CVE-2020-13971", "type": "indicator", "created_by_ref": "https://example.com/stix-2.1.json", "created": "2022-01-01T00:00:00.000Z", "modified": "2022-01-01T00:00:00.000Z", "spec_version": "2.1", "label": "CVE-2020-13971", "description": "Stored Cross-Site Scripting (XSS) vulnerability in Shopware before 6.2.3", "custom_attributes": {"cwe": "79"}, "objects": [{"id": "https://example.com/T1059", "type": "technique", "created_by_ref": "https://example.com/stix-2.1.json", "created": "2022-01-01T00:00:00.000Z", "modified": "2022-01-01T00:00:00.000Z", "spec_version": "2.1", "label": "T1059", "description": "Exposed Web Method"}], "relationships": [{"target_ref": "https://example.com/T1059", "relationship": "uses"}]}]}}}, "technical_analysis": {"Introduction": "The CVE-2020-13971 is a Stored Cross-Site Scripting (XSS) vulnerability in Shopware before 6.2.3, which allows an authenticated attacker to upload an SVG image containing JavaScript.", "Impact and Scope": "The vulnerability has a CVSS score of 5.4 with version 3.1 and an attack vector of Network, affecting all versions of Shopware before 6.2.3.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1059, T1518.001, T1105, and T1555.012.", "Technical Details": "The vulnerability occurs when an authenticated user uploads an SVG image containing JavaScript using the Mediabrowser fileupload feature, which allows for persistent XSS attacks.", "Detection": "Detection can be achieved through web application security scanners and logs monitoring.", "Mitigation": "Mitigation strategies include applying security patches, implementing input validation and sanitization, and configuring web application firewalls.", "Conclusion": "In conclusion, the CVE-2020-13971 is a significant vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2020-13971 is a critical vulnerability in Shopware before 6.2.3 that enables persistent XSS attacks.", "Business Impact": "The vulnerability can lead to data exfiltration, unauthorized access, and financial losses.", "Technical Impact": "The vulnerability allows an attacker to upload malicious files, such as SVG images containing JavaScript, which can be accessed without authentication.", "Mitigation Strategies": "The recommended mitigation strategy is to apply security patches, implement input validation and sanitization, and configure web application firewalls.", "Recommendations": "Recommendations include prioritizing patching, conducting regular security audits, and ensuring proper configuration of web application firewalls.", "Conclusions": "In conclusion, the CVE-2020-13971 is a critical vulnerability that requires immediate attention and mitigation to prevent potential attacks and data breaches."}}