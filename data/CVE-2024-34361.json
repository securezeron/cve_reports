{"id": "CVE-2024-34361", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-05T19:15:09.610", "lastModified": "2024-07-08T15:49:22.437", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Pi-hole is a DNS sinkhole that protects devices from unwanted content without installing any client-side software. A vulnerability in versions prior to 5.18.3 allows an authenticated user to make internal requests to the server via the `gravity_DownloadBlocklistFromUrl()` function. Depending on some circumstances, the vulnerability could lead to remote command execution. Version 5.18.3 contains a patch for this issue."}, {"lang": "es", "value": " Pi-hole es un sumidero de DNS que protege los dispositivos de contenido no deseado sin instalar ning\u00fan software del lado del cliente. Una vulnerabilidad en versiones anteriores a la 5.18.3 permite a un usuario autenticado realizar solicitudes internas al servidor a trav\u00e9s de la funci\u00f3n `gravity_DownloadBlocklistFromUrl()`. Dependiendo de algunas circunstancias, la vulnerabilidad podr\u00eda provocar la ejecuci\u00f3n remota de comandos. La versi\u00f3n 5.18.3 contiene un parche para este problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-918"}]}], "references": [{"url": "https://github.com/pi-hole/pi-hole/commit/2c497a9a3ea099079bbcd1eb21725b0ed54b529d", "source": "security-advisories@github.com"}, {"url": "https://github.com/pi-hole/pi-hole/security/advisories/GHSA-jg6g-rrj6-xfg6", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1208", "comment": "CVE-2024-34361 - This vulnerability allows an authenticated user to make internal requests to the server, which could lead to remote command execution. The use of weak, default, or guessable credentials can be exploited to access the server and gain a foothold. Defending against this requires implementing strong authentication and authorization controls."}, {"techniqueID": "T1059", "comment": "CVE-2024-34361 - This vulnerability allows an authenticated user to make internal requests to the server, which could lead to remote command execution. The use of web shells and other web-based backdoors can be used to gain access to the server and execute arbitrary code. Defending against this requires implementing web application firewalls and regularly updating web applications."}, {"techniqueID": "T1068", "comment": "CVE-2024-34361 - This vulnerability allows an authenticated user to make internal requests to the server, which could lead to remote command execution. The use of stolen or weak credentials can be used to access the server and gain a foothold. Defending against this requires implementing strong authentication and authorization controls."}], "stix_bundle": "**INSERT STIX 2.1 BUNDLE HERE**", "technical_analysis": {"Introduction": "CVE-2024-34361 is a vulnerability in Pi-hole versions prior to 5.18.3 that allows an authenticated user to make internal requests to the server, which could lead to remote command execution.", "Impact and Scope": "The vulnerability has a CVSS score of 8.5, with an attack vector of NETWORK, and affects Pi-hole versions prior to 5.18.3.", "Related MITRE ATT&CK Techniques": "T1208, T1059, T1068", "Technical Details": "The vulnerability exists in the `gravity_DownloadBlocklistFromUrl()` function, which allows an authenticated user to make internal requests to the server.", "Detection": "Detection methods include monitoring for suspicious network traffic, logging of authentication attempts, and monitoring for web shell activity.", "Mitigation": "Mitigation strategies include updating to version 5.18.3 or later, implementing strong authentication and authorization controls, and implementing web application firewalls.", "Conclusion": "In conclusion, CVE-2024-34361 is a significant vulnerability that has the potential to lead to remote command execution. Implementing strong authentication and authorization controls, updating to the latest version, and monitoring for suspicious activity are key to mitigating this vulnerability."}, "executive_analysis": {"Overview": "CVE-2024-34361 is a vulnerability in Pi-hole that allows an authenticated user to make internal requests to the server, which could lead to remote command execution.", "Business Impact": "This vulnerability has the potential to impact business continuity and data integrity if exploited.", "Technical Impact": "This vulnerability affects Pi-hole versions prior to 5.18.3 and could lead to remote command execution.", "Mitigation Strategies": "Updating to the latest version, implementing strong authentication and authorization controls, and implementing web application firewalls are key to mitigating this vulnerability.", "Recommendations": "Recommendations include patching vulnerable systems, implementing strong authentication and authorization controls, and regularly updating software.", "Conclusions": "In conclusion, CVE-2024-34361 is a significant vulnerability that requires immediate attention and action to mitigate."}}