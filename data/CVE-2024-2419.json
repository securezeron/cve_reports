{"id": "CVE-2024-2419", "sourceIdentifier": "secalert@redhat.com", "published": "2024-04-17T14:15:08.367", "lastModified": "2024-04-17T16:15:08.470", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A flaw was found in Keycloak's redirect_uri validation logic. This issue may allow a bypass of otherwise explicitly allowed hosts. A successful attack may lead to the theft of an access token, making it possible for the attacker to impersonate other users. It is very similar to CVE-2023-6291."}, {"lang": "es", "value": "Se encontr\u00f3 una falla en la l\u00f3gica de validaci\u00f3n de redirecci\u00f3n_uri de Keycloak. Este problema puede permitir la omisi\u00f3n de hosts permitidos expl\u00edcitamente. Un ataque exitoso puede conducir al robo de un token de acceso, lo que hace posible que el atacante se haga pasar por otros usuarios. Es muy similar a CVE-2023-6291."}], "metrics": {"cvssMetricV31": [{"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 7.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 3.7}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-601"}]}], "references": [{"url": "https://access.redhat.com/errata/RHSA-2024:1867", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/security/cve/CVE-2024-2419", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2269371", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1036", "comment": "CVE-2024-2419 - Bypass of Allowed Hosts in Keycloak due to incorrect redirects, allowing attackers to steal access tokens. Possible attacks include actor impersonation."}, {"techniqueID": "T1190", "comment": "CVE-2024-2419 - Keycloak redirect_uri validation bypass allows attackers to steal access tokens and impersonate users. Deflect attacks by validating redirect URLs and enforcing strict access control."}, {"techniqueID": "T1568", "comment": "CVE-2024-2419 - The weakness in Keycloak redirect_uri validation can be exploited by an attacker to bypass the restriction of the allowed hostname. This can lead to the theft of an access token and an increase in the attacker's privileges."}, {"techniqueID": "T1409", "comment": "CVE-2024-2419 - The exploitation of this weakness allows an attacker to attack a Keycloak system with reduced privileges. The attacker can use this to escalate privileges and potentially gain unauthorized access to sensitive data."}], "stix_bundle": {"STIX_Bundle": {"description": "STIX Bundle for CVE-2024-2419", "objects": [{"id": "cs-1", "type": "indicator", "description": "Indicator for CVE-2024-2419", "created_by_ref": "user-1", "modified": "2024-04-17T14:15:08.367", "observed_data": [{"value": "https://access.redhat.com/errata/RHSA-2024:1867", "type": "url"}], "tlp": "WHITE"}, {"id": "cs-2", "type": "campaign", "description": "Campaign for CVE-2024-2419", "created_by_ref": "user-1", "modified": "2024-04-17T14:15:08.367", "name": "CVE-2024-2419 Campaign"}, {"id": "cs-3", "type": "identity", "description": "Identity for CVE-2024-2419", "created_by_ref": "user-1", "modified": "2024-04-17T14:15:08.367", "name": "CVE-2024-2419 Identity"}, {"id": "cs-4", "type": "malware", "description": "Malware for CVE-2024-2419", "created_by_ref": "user-1", "modified": "2024-04-17T14:15:08.367", "name": "CVE-2024-2419 Malware"}, {"id": "cs-5", "type": "observer", "description": "Observer for CVE-2024-2419", "created_by_ref": "user-1", "modified": "2024-04-17T14:15:08.367", "name": "CVE-2024-2419 Observer"}], "revoked": false, "modified": "2024-04-17T16:15:08.470"}}, "technical_analysis": {"Introduction": "The vulnerability in Keycloak's redirect_uri validation logic allows attackers to bypass restrictions on allowed hosts, potentially leading to access token theft and user impersonation.", "Impact and Scope": "CVSS 3.1: 7.1, Attack Vector: NETWORK, Attack Complexity: LOW, Privileges Required: NONE, User Interaction: REQUIRED, Scope: CHANGED, Confidentiality Impact: LOW, Integrity Impact: LOW, Availability Impact: LOW.", "Related MITRE ATT&CK Techniques": "T1036, T1190, T1568, T1409", "Technical Details": "The vulnerability allows an attacker to bypass the restriction of the allowed hostname by exploiting the weakness in Keycloak's redirect_uri validation. This can lead to the theft of an access token and the potential for the attacker to impersonate users.", "Detection": "Detecting this vulnerability requires monitoring for unusual access token traffic and validating redirect URLs. Additionally, enforcing strict access control and validation of redirect URLs can help prevent exploitation.", "Mitigation": "Mitigate this vulnerability by validating redirect URLs, enforcing strict access control, and monitoring for unusual access token traffic.", "Conclusion": "The vulnerability in Keycloak's redirect_uri validation logic is a serious concern and requires immediate attention. Implementing mitigation strategies and monitoring for unusual access token traffic can help prevent exploitation."}, "executive_analysis": {"Overview": "The vulnerability in Keycloak's redirect_uri validation logic allows attackers to bypass restrictions on allowed hosts, potentially leading to access token theft and user impersonation.", "Business Impact": "The potential impact of this vulnerability includes data theft, unauthorized access to sensitive information, and reputational damage.", "Technical Impact": "The vulnerability allows attackers to bypass security checks and compromise Keycloak systems, potentially leading to data theft and unauthorized access.", "Mitigation Strategies": "Implement strict access control, validate redirect URLs, and monitor for unusual access token traffic.", "Recommendations": "Recommendations include implementing mitigation strategies, conducting regular security assessments, and increasing security awareness training for employees.", "Conclusions": "The vulnerability in Keycloak's redirect_uri validation logic is a serious concern and requires immediate attention. Implementing mitigation strategies and increasing security awareness training can help prevent exploitation and minimize the impact of this vulnerability."}}