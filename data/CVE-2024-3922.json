{"id": "CVE-2024-3922", "sourceIdentifier": "security@wordfence.com", "published": "2024-06-13T02:15:08.833", "lastModified": "2024-07-18T19:33:55.580", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Dokan Pro plugin for WordPress is vulnerable to SQL Injection via the 'code' parameter in all versions up to, and including, 3.10.3 due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query.  This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database."}, {"lang": "es", "value": "El complemento Dokan Pro para WordPress es vulnerable a la inyecci\u00f3n SQL a trav\u00e9s del par\u00e1metro 'c\u00f3digo' en todas las versiones hasta la 3.10.3 incluida debido a un escape insuficiente en el par\u00e1metro proporcionado por el usuario y a la falta de preparaci\u00f3n suficiente en la consulta SQL existente. Esto hace posible que atacantes no autenticados agreguen consultas SQL adicionales a consultas ya existentes que pueden usarse para extraer informaci\u00f3n confidencial de la base de datos."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:dokan:dokan_pro_plugin:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "3.11.0", "matchCriteriaId": "0980C137-7192-43FB-8906-31C662A7C5EE"}]}]}], "references": [{"url": "https://dokan.co/docs/wordpress/changelog/", "source": "security@wordfence.com", "tags": ["Release Notes"]}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/d9de41de-f2f7-4b16-8ec9-d30bbd3d8786?source=cve", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1056", "comment": "CVE-2024-3922 - SQL Injection attack via the 'code' parameter in the Dokan Pro plugin. This technique is relevant as it allows attackers to extract sensitive information from the database. Defending against this involves validating user input and ensuring proper SQL query preparation."}, {"techniqueID": "T1189", "comment": "CVE-2024-3922 - Exploitation of SQL Injection vulnerability to extract sensitive information. This technique is relevant as it allows attackers to gain unauthorized access to sensitive data. Defending against this involves regular vulnerability scanning and patching, as well as implementing robust security controls."}, {"techniqueID": "T1190", "comment": "CVE-2024-3922 - Execution of unauthorized SQL queries using the 'code' parameter. This technique is relevant as it allows attackers to modify the database schema or execute arbitrary code. Defending against this involves strict access controls and user authentication."}, {"techniqueID": "T1562", "comment": "CVE-2024-3922 - SQL Injection as a means to extract sensitive data. This technique is relevant as it allows attackers to gain unauthorized access to sensitive information. Defending against this involves implementing robust security controls, such as input validation and sanitization."}], "technical_analysis": {"Introduction": "The Dokan Pro plugin for WordPress is vulnerable to SQL Injection due to insufficient escaping on the user-supplied 'code' parameter and lack of sufficient preparation on the existing SQL query.", "Impact and Scope": "The vulnerability allows unauthenticated attackers to extract sensitive information from the database, with a CVSS score of 9.8. The attack vector is NETWORK, and the attack complexity is LOW.", "Related MITRE ATT&CK Techniques": "T1056, T1189, T1190, T1562", "Technical Details": "The vulnerability is due to a lack of input validation and sanitization, which allows attackers to inject malicious SQL queries.", "Detection": "Detection methods include monitoring for unusual database queries, monitoring for SQL Injection attacks, and implementing web application firewalls.", "Mitigation": "Mitigation strategies include validating user input, ensuring proper SQL query preparation, implementing robust security controls, and deploying patches.", "Conclusion": "The vulnerability poses a significant risk to sensitive information, and prompt action is required to resolve the issue."}, "executive_analysis": {"Overview": "The Dokan Pro plugin for WordPress is vulnerable to SQL Injection, which allows attackers to extract sensitive information from the database.", "Business Impact": "The vulnerability poses a significant risk to the confidentiality, integrity, and availability of sensitive information.", "Technical Impact": "The vulnerability can be exploited using a SQL Injection attack, allowing attackers to execute arbitrary SQL queries.", "Mitigation Strategies": "Implement patches, valve user input, and ensure proper SQL query preparation.", "Recommendations": "Recommendations for executives include prioritizing patching and ensuring robust security controls are in place.", "Conclusions": "Prompt action is required to resolve the issue and minimize the risk to sensitive information."}}