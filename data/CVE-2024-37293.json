{"id": "CVE-2024-37293", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-11T17:16:04.237", "lastModified": "2024-08-16T16:11:53.287", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The AWS Deployment Framework (ADF) is a framework to manage and deploy resources across multiple AWS accounts and regions within an AWS Organization. ADF allows for staged, parallel, multi-account, cross-region deployments of applications or resources via the structure defined in AWS Organizations while taking advantage of services such as AWS CodePipeline, AWS CodeBuild, and AWS CodeCommit to alleviate the heavy lifting and management compared to a traditional CI/CD setup. ADF contains a bootstrap process that is responsible to deploy ADF's bootstrap stacks to facilitate multi-account cross-region deployments. The ADF bootstrap process relies on elevated privileges to perform this task. Two versions of the bootstrap process exist; a code-change driven pipeline using AWS CodeBuild and an event-driven state machine using AWS Lambda. If an actor has permissions to change the behavior of the CodeBuild project or the Lambda function, they would be able to escalate their privileges.\n\nPrior to version 4.0.0, the bootstrap CodeBuild role provides access to the `sts:AssumeRole` operation without further restrictions. Therefore, it is able to assume into any AWS Account in the AWS Organization with the elevated privileges provided by the cross-account access role. By default, this role is not restricted when it is created by AWS Organizations, providing Administrator level access to the AWS resources in the AWS Account. The patches for this issue are included in `aws-deployment-framework` version 4.0.0.\n\nAs a temporary mitigation, add a permissions boundary to the roles created by ADF in the management account. The permissions boundary should deny all IAM and STS actions. This permissions boundary should be in place until you upgrade ADF or bootstrap a new account. While the permissions boundary is in place, the account management and bootstrapping of accounts are unable to create, update, or assume into roles. This mitigates the privilege escalation risk, but also disables ADF's ability to create, manage, and bootstrap accounts."}, {"lang": "es", "value": "AWS Deployment Framework (ADF) es un framework para administrar e implementar recursos en m\u00faltiples cuentas y regiones de AWS dentro de una organizaci\u00f3n de AWS. ADF permite implementaciones de aplicaciones o recursos por etapas, paralelas, de m\u00faltiples cuentas y entre regiones a trav\u00e9s de la estructura definida en AWS Organizations, al tiempo que aprovecha servicios como AWS CodePipeline, AWS CodeBuild y AWS CodeCommit para aliviar el trabajo pesado y la administraci\u00f3n en comparaci\u00f3n a una configuraci\u00f3n CI/CD tradicional. ADF contiene un proceso de arranque que es responsable de implementar las pilas de arranque de ADF para facilitar las implementaciones de m\u00faltiples cuentas entre regiones. El proceso de arranque de ADF depende de privilegios elevados para realizar esta tarea. Existen dos versiones del proceso de arranque; una canalizaci\u00f3n impulsada por cambios de c\u00f3digo que utiliza AWS CodeBuild y una m\u00e1quina de estado impulsada por eventos que utiliza AWS Lambda. Si un actor tiene permisos para cambiar el comportamiento del proyecto CodeBuild o la funci\u00f3n Lambda, podr\u00e1 aumentar sus privilegios. Antes de la versi\u00f3n 4.0.0, la funci\u00f3n de arranque CodeBuild proporciona acceso a la operaci\u00f3n `sts:AssumeRole` sin m\u00e1s restricciones. Por lo tanto, puede asumir cualquier cuenta de AWS en la organizaci\u00f3n de AWS con los privilegios elevados proporcionados por la funci\u00f3n de acceso entre cuentas. De forma predeterminada, esta funci\u00f3n no est\u00e1 restringida cuando la crea AWS Organizations, lo que proporciona acceso de nivel de administrador a los recursos de AWS en la cuenta de AWS. Los parches para este problema se incluyen en la versi\u00f3n 4.0.0 de `aws-deployment-framework`. Como mitigaci\u00f3n temporal, agregue un l\u00edmite de permisos a los roles creados por ADF en la cuenta de administraci\u00f3n. El l\u00edmite de permisos debe denegar todas las acciones de IAM y STS. Este l\u00edmite de permisos debe estar vigente hasta que actualice ADF o inicie una nueva cuenta. Mientras el l\u00edmite de permisos est\u00e9 vigente, la administraci\u00f3n de cuentas y el arranque de cuentas no pueden crear, actualizar ni asumir roles. Esto mitiga el riesgo de escalada de privilegios, pero tambi\u00e9n desactiva la capacidad de ADF para crear, administrar y arrancar cuentas."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 0.8, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-266"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:amazon:aws_deployment_framework:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.0.0", "matchCriteriaId": "F3858F8E-B54E-4077-B22D-161EE66B0A73"}]}]}], "references": [{"url": "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://github.com/awslabs/aws-deployment-framework/pull/732", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/awslabs/aws-deployment-framework/releases/tag/v4.0.0", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/awslabs/aws-deployment-framework/security/advisories/GHSA-mcj7-ppmv-h6jr", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-37293 - The actor can escalate privileges by gaining access to the 'sts:AssumeRole' operation without further restrictions, allowing them to assume any AWS account in the AWS Organization with elevated privileges."}, {"techniqueID": "T1204", "comment": "CVE-2024-37293 - The actor can use AWS CodeBuild to bypass security restrictions and limit access to AWS resources, allowing them to escalate privileges."}, {"techniqueID": "T1555", "comment": "CVE-2024-37293 - The actor can use AWS Lambda to run malicious code and escalate privileges, bypassing security restrictions."}, {"techniqueID": "T1210", "comment": "CVE-2024-37293 - The actor can use permissions boundaries to limit access to AWS resources and prevent privilege escalation, but this mitigation also disables ADF's ability to create, manage, and bootstrap accounts."}], "stix_bundle": {"reporter_info": {" id": "reducer5", "name": "Cybersecurity Analyst"}, "reporters": ["reducer5"], "controls": [], "threats": [{"id": "T1190", "type": "action"}, {"id": "T1204", "type": "action"}, {"id": "T1555", "type": "action"}, {"id": "T1210", "type": "control"}], "vulnerabilities": [{"id": "CVE-2024-37293", "title": "AWS Deployment Framework Privilege Escalation", "description": "Privilege escalation vulnerability in AWS Deployment Framework (ADF) allows actors to escalate privileges and assume any AWS account in the AWS Organization with elevated privileges.", "type": "vulnerability", "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-37293"}], "incidents": [], "indicators": [], "observables": []}, "technical_analysis": {"Introduction": "The AWS Deployment Framework (ADF) is a framework for managing and deploying resources across multiple AWS accounts and regions within an AWS Organization.", "Impact and Scope": "The vulnerability allows actors to escalate privileges and assume any AWS account in the AWS Organization with elevated privileges, with a CVSS score of 7.8 (AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H).", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1204, T1555, and T1210.", "Technical Details": "The vulnerability is caused by the inadequate permissions boundaries in the AWS Deployment Framework (ADF) and allows actors to escalate privileges and assume any AWS account in the AWS Organization with elevated privileges.", "Detection": "Detection of the vulnerability requires monitoring for unusual activity in AWS accounts and regions, as well as monitoring for attempts to assume roles with elevated privileges.", "Mitigation": "Mitigation strategies include implementing permissions boundaries to limit access to AWS resources, restricting privileges to specific roles, and implementing monitoring and detection capabilities.", "Conclusion": "The vulnerability highlights the importance of implementing robust permissions and access controls in cloud-based environments."}, "executive_analysis": {"Overview": "The AWS Deployment Framework (ADF) vulnerability is a significant threat to AWS accounts and regions within an AWS Organization.", "Business Impact": "The vulnerability can result in unauthorized access to AWS resources and data, as well as unauthorized changes to AWS configurations and settings.", "Technical Impact": "The vulnerability allows actors to escalate privileges and assume any AWS account in the AWS Organization with elevated privileges.", "Mitigation Strategies": "Implementing permissions boundaries, restricting privileges to specific roles, and implementing monitoring and detection capabilities are key mitigation strategies.", "Recommendations": "Recommendations include implementing a robust security posture, conducting regular security assessments and audits, and implementing incident response and disaster recovery plans.", "Conclusions": "The vulnerability highlights the importance of robust security practices and the need for continuous monitoring and detection capabilities in cloud-based environments."}}