{"id": "CVE-2024-45046", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-28T21:15:06.603", "lastModified": "2024-09-04T17:32:51.960", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHPSpreadsheet is a pure PHP library for reading and writing spreadsheet files. In affected versions `\\PhpOffice\\PhpSpreadsheet\\Writer\\Html` doesn't sanitize spreadsheet styling information such as font names, allowing an attacker to inject arbitrary JavaScript on the page. As a result an attacker may used a crafted spreadsheet to fully takeover a session of a user viewing spreadsheet files as HTML. This issue has been addressed in release version 2.1.0. All users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "PHPSpreadsheet es una librer\u00eda PHP pura para leer y escribir archivos de hojas de c\u00e1lculo. En las versiones afectadas, `\\PhpOffice\\PhpSpreadsheet\\Writer\\Html` no desinfecta la informaci\u00f3n de estilo de las hojas de c\u00e1lculo, como los nombres de las fuentes, lo que permite a un atacante inyectar JavaScript arbitrario en la p\u00e1gina. Como resultado, un atacante puede usar una hoja de c\u00e1lculo manipulada para apoderarse por completo de la sesi\u00f3n de un usuario que visualiza archivos de hojas de c\u00e1lculo como HTML. Este problema se ha solucionado en la versi\u00f3n 2.1.0. Se recomienda a todos los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpoffice:phpspreadsheet:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.29.1", "matchCriteriaId": "520A70B7-2C60-4064-B452-538ED7A8D30E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpoffice:phpspreadsheet:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.0.0", "versionEndExcluding": "2.1.0", "matchCriteriaId": "373AEDCC-F178-41C9-8756-573EB2FCF247"}]}]}], "references": [{"url": "https://github.com/PHPOffice/PhpSpreadsheet/commit/f7cf378faed2e11cf4825bf8bafea4922ae44667", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/PHPOffice/PhpSpreadsheet/pull/3957", "source": "security-advisories@github.com", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-wgmf-q9vr-vww6", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1047", "comment": "Exploit Public-Facing Application (CVE-2024-45046) - Attackers can inject arbitrary JavaScript code into spreadsheet files to take over user sessions. Defend by ensuring all applications are updated to the latest version and using web application firewalls to detect and block malicious requests."}, {"techniqueID": "T1190", "comment": "Trail Making (CVE-2024-45046) - Attackers can use injected JavaScript to move laterally within the network and evade detection. Defend by monitoring network traffic for suspicious activity and implementing web application firewalls to block malicious requests."}, {"techniqueID": "T1555", "comment": "SQL Injection (CVE-2024-45046) - Attackers can use injected JavaScript to perform SQL injection attacks on backend databases. Defend by implementing web application firewalls to detect and block malicious requests and configuring databases to restrict access to sensitive data."}], "stix_bundle": "A valid STIX 2.1 bundle expressing all the related techniques, risks and defense strategies for this CVE. This should be in proper relation and should visualize properly. This should be a valid JSON STIX 2.1 bundle. This STIX bundle must have the vulnerability as the main object and all other other parts as individual objects with relations added to the main object. There should be no hanging nodes, and all relationships should be meaningful and to the correct entity with the correct label. All courses of actions are to be linked properly with the correct technique they mitigate and all the defense points must be added as notes", "technical_analysis": {"Introduction": "Introduction content.", "Impact and Scope": "Details on the impact and scope of the CVE, mention cvss score with version and attack vector.", "Related MITRE ATT&CK Techniques": "List of related MITRE ATT&CK Techniques and their relevance to the CVE.", "Technical Details": "In-depth technical details of the CVE.", "Detection": "Methods for detecting the CVE.", "Mitigation": "Mitigation strategies for the CVE.", "Conclusion": "Summary and conclusions."}, "executive_analysis": {"Overview": "Overview of the CVE.", "Business Impact": "Explanation of the business impact of the CVE.", "Technical Impact": "Explanation of the technical impact of the CVE.", "Mitigation Strategies": "High-level mitigation strategies.", "Recommendations": "Recommendations for executives.", "Conclusions": "Final conclusions and next steps."}}