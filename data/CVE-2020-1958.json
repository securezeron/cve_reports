{"id": "CVE-2020-1958", "sourceIdentifier": "security@apache.org", "published": "2020-04-01T22:15:17.487", "lastModified": "2023-11-07T03:19:38.300", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "When LDAP authentication is enabled in Apache Druid 0.17.0, callers of Druid APIs with a valid set of LDAP credentials can bypass the credentialsValidator.userSearch filter barrier that determines if a valid LDAP user is allowed to authenticate with Druid. They are still subject to role-based authorization checks, if configured. Callers of Druid APIs can also retrieve any LDAP attribute values of users that exist on the LDAP server, so long as that information is visible to the Druid server. This information disclosure does not require the caller itself to be a valid LDAP user."}, {"lang": "es", "value": "Cuando la autenticaci\u00f3n LDAP est\u00e1 habilitada en Apache Druid versi\u00f3n 0.17.0, las personas que llaman desde las API de Druid con un conjunto v\u00e1lido de credenciales LDAP pueden omitir la barrera de filtro credentialsValidator.userSearch que determina si un usuario LDAP v\u00e1lido est\u00e1 habilitado para autenticarse con Druid. A\u00fan est\u00e1n sujetos a comprobaciones de autorizaci\u00f3n basadas en roles, si est\u00e1n configuradas. Las personas que llaman de las API de Druid tambi\u00e9n pueden recuperar cualquiera de los valores de atributo LDAP de los usuarios que existan en el servidor LDAP, siempre que esa informaci\u00f3n este visible para el servidor Druid. Esta divulgaci\u00f3n de informaci\u00f3n no requiere que la persona que llama sea un usuario LDAP v\u00e1lido."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:druid:0.17.0:*:*:*:*:*:*:*", "matchCriteriaId": "26A864B6-C649-4405-886A-82FA0C2399F8"}]}]}], "references": [{"url": "https://lists.apache.org/thread.html/r026540c617d334007810cd8f0068f617b5c78444be00a31fc1b03390%40%3Ccommits.druid.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r1526dbce98a138629a41daa06c13393146ddcaf8f9d273cc49d57681%40%3Ccommits.druid.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r1c32c95543d44559b8d7fd89b0a85f728c80e8b715685bbf788a15a4%40%3Ccommits.druid.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r47c90a378efdb3fd07ff7f74095b8eb63b3ca93b8ada5c2661c5e371%40%3Ccommits.druid.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r75e74d39c41c1b95a658b6a9f75fc6fd02b1d1922566a0ee4ee2fdfc%40%3Ccommits.druid.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r9d437371793b410f8a8e18f556d52d4bb68e18c537962f6a97f4945e%40%3Cdev.druid.apache.org%3E", "source": "security@apache.org", "tags": ["Mailing List", "Vendor Advisory"]}, {"url": "https://lists.apache.org/thread.html/rf70876ecafb45b314eff9d040c5281c4adb0cb7771eb029448cfb79b%40%3Cannounce.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/rffabc9e83cc2831bbee5db32b3965b84b09346a26ebc1012db63d28c%40%3Ccommits.druid.apache.org%3E", "source": "security@apache.org"}], "techniques": [{"techniqueID": "T1133", "comment": "CVE-2020-1958 - This is an LDAP authentication bypass vulnerability in Apache Druid 0.17.0, allowing attackers to bypass credentials validation and retrieve sensitive information. It is an important technique to detect and prevent in a threat hunting campaign."}, {"techniqueID": "T1078", "comment": "CVE-2020-1958 - This technique is related to using a valid set of LDAP credentials to bypass the credentials validation filter in Apache Druid 0.17.0 and retrieve sensitive information. It is an important technique to detect and prevent in a threat hunting campaign."}], "stix_bundle": {"objects": [{"type": "note", "id": "note--1", "created_by_ref": "identity--1", "created": "2023-11-07T03:19:38.300", "modified": "2023-11-07T03:19:38.300", "label": "Apache Druid LDAP Authentication Bypass", "description": "Apache Druid 0.17.0 is vulnerable to a LDAP authentication bypass vulnerability.", "severity": "high", "expires": null}, {"type": "indicator", "id": "indicator--1", "created_by_ref": "identity--1", "created": "2023-11-07T03:19:38.300", "modified": "2023-11-07T03:19:38.300", "label": "Apache Druid LDAP Authentication Bypass Indicator", "description": "Apache Druid 0.17.0 is vulnerable to a LDAP authentication bypass vulnerability.", "valid_from": "2020-04-01T22:15:17.487", "valid_until": "2023-11-07T03:19:38.300", "confidence": 90, "tags": ["ldap", "authentication", "bypass"]}, {"type": "course-of-action", "id": "course-of-action--1", "created_by_ref": "identity--1", "created": "2023-11-07T03:19:38.300", "modified": "2023-11-07T03:19:38.300", "label": "Apache Druid LDAP Authentication Bypass Defense", "description": "Apply the latest patches for Apache Druid 0.17.0 and ensure proper configuration and testing of the LDAP authentication mechanism.", "severity": "high", "mitigates": ["technique--1"]}], "relationships": [{"source_ref": "note--1", "target_ref": "indicator--1", "label": "based-on"}, {"source_ref": "indicator--1", "target_ref": "course-of-action--1", "label": "mitigated-by"}]}, "technical_analysis": {"Introduction": "Apache Druid 0.17.0 is vulnerable to a LDAP authentication bypass vulnerability, which allows attackers to bypass the credentials validation filter and retrieve sensitive information.", "Impact and Scope": "The vulnerability has a moderate impact and is limited to Apache Druid 0.17.0. The attack vector is over the network.", "Related MITRE ATT&CK Techniques": "The relevant MITRE ATT&CK techniques include T1133 and T1078, which relate to using a valid set of LDAP credentials to bypass the credentials validation filter and retrieve sensitive information.", "Technical Details": "The vulnerability is exploitable by using a valid set of LDAP credentials to bypass the credentials validation filter and retrieve sensitive information. The vulnerable code is in the Apache Druid 0.17.0 LDAP authentication mechanism.", "Detection": "The vulnerability can be detected through log analysis and network monitoring for unusual LDAP authentication activity.", "Mitigation": "The vulnerability can be mitigated by applying the latest patches for Apache Druid 0.17.0 and ensuring proper configuration and testing of the LDAP authentication mechanism.", "Conclusion": "The Apache Druid 0.17.0 LDAP authentication bypass vulnerability is a relevant threat to Apache Druid 0.17.0 users and can be detected and mitigated with proper detection and mitigation strategies."}, "executive_analysis": {"Overview": "Apache Druid 0.17.0 has a vulnerability in its LDAP authentication mechanism that can be exploited by attackers to bypass credential validation and retrieve sensitive information.", "Business Impact": "The vulnerability can cause business disruption if exploited by attackers to gain unauthorized access to sensitive information.", "Technical Impact": "The vulnerability allows attackers to bypass credential validation and retrieve sensitive information, which can compromise the security of the Apache Druid 0.17.0 system.", "Mitigation Strategies": "Apply the latest patches for Apache Druid 0.17.0 and ensure proper configuration and testing of the LDAP authentication mechanism.", "Recommendations": "Apply the latest patches for Apache Druid 0.17.0, conduct regular security testing and monitoring, and ensure proper configuration and testing of the LDAP authentication mechanism.", "Conclusions": "The Apache Druid 0.17.0 LDAP authentication bypass vulnerability is a relevant threat to Apache Druid 0.17.0 users and should be prioritized for detection and mitigation."}}