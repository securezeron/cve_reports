{"id": "CVE-2007-2999", "sourceIdentifier": "cve@mitre.org", "published": "2007-06-04T17:30:00.000", "lastModified": "2012-11-06T03:40:45.187", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Microsoft Windows Server 2003, when time restrictions are in effect for user accounts, generates different error messages for failed login attempts with a valid user name than for those with an invalid user name, which allows context-dependent attackers to determine valid Active Directory account names."}, {"lang": "es", "value": "Microsoft Windows Server 2003, cuando las restricciones de tiempo est\u00e1n en efecto para las cuentas del usuario, genera diversos mensajes de error para las tentativas falladas de conexi\u00f3n con un nombre v\u00e1lido de usuario que para aquellos que tengan un nombre inv\u00e1lido de usuario, permite que los atacantes dependientes del contexto determinen nombres de cuenta activos v\u00e1lidos del directorio."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:H/Au:N/C:P/I:N/A:N", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "HIGH", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 1.8}, "baseSeverity": "LOW", "exploitabilityScore": 3.2, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_2003_server:gold:*:*:*:*:*:*:*", "matchCriteriaId": "B058588A-88F3-4789-8EA9-0D37447B08CA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_2003_server:sp1:*:*:*:*:*:*:*", "matchCriteriaId": "644E2E89-F3E3-4383-B460-424D724EE62F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_2003_server:sp2:*:*:*:*:*:*:*", "matchCriteriaId": "377F7D0C-6B44-4B90-BF90-DAF959880C6D"}]}]}], "references": [{"url": "http://osvdb.org/36138", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/25457", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.notsosecure.com/folder2/2007/05/27/logon-time-restrictions-in-a-domain-in-windows-server-2003-allows-username-enumeration/", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/24248", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0001", "comment": "This technique is relevant as the vulnerability allows an attacker to determine valid Active Directory account names. This can be defended against by implementing access controls and authentication measures to limit the ability to enumerate Active Directory accounts."}, {"techniqueID": "TA0008", "comment": "The vulnerability can be exploited to gain information about valid usernames. This can be defended against by implementing measures to limit the information available to attackers, such as logon restrictions and denying access to unauthorized users."}, {"techniqueID": "TA0009", "comment": "The vulnerability can be used to gather information about valid usernames. This can be defended against by implementing measures to limit the information available to attackers, such as logon restrictions and denying access to unauthorized users."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/bundle/CVE-2007-2999", "version": "2.1", "objects": [{"type": "vulnerability", "id": "https://example.com/vulnerability/CVE-2007-2999", "name": "CVE-2007-2999", "description": "Microsoft Windows Server 2003, when time restrictions are in effect for user accounts, generates different error messages for failed login attempts with a valid user name than for those with an invalid user name, which allows context-dependent attackers to determine valid Active Directory account names.", "published": "2007-06-04T17:30:00.000", "modified": "2012-11-06T03:40:45.187", "severity": "LOW", "affected_components": [{"type": "cpe", "id": "cpe:2.3:o:microsoft:windows_2003_server:gold:*:*:*:*:*:*:*"}, {"type": "cpe", "id": "cpe:2.3:o:microsoft:windows_2003_server:sp1:*:*:*:*:*:*:*"}, {"type": "cpe", "id": "cpe:2.3:o:microsoft:windows_2003_server:sp2:*:*:*:*:*:*:*"}]}, {"type": "attack-pattern", "id": "https://example.com/attack-pattern/TA0001", "name": "TA0001: Information Gather", "description": "Information Gathering", "keywords": ["information_gathering"], "related_vulnerabilities": [{"type": "vulnerability", "id": "https://example.com/vulnerability/CVE-2007-2999"}]}, {"type": "attack-pattern", "id": "https://example.com/attack-pattern/TA0008", "name": "TA0008: Valid Accounts", "description": "Valid Accounts", "keywords": ["account_gathering"], "related_vulnerabilities": [{"type": "vulnerability", "id": "https://example.com/vulnerability/CVE-2007-2999"}]}, {"type": "attack-pattern", "id": "https://example.com/attack-pattern/TA0009", "name": "TA0009: Account Gaining", "description": "Account Gaining", "keywords": ["account_gaining"], "related_vulnerabilities": [{"type": "vulnerability", "id": "https://example.com/vulnerability/CVE-2007-2999"}]}, {"type": "course-of-action", "id": "https://example.com/course-of-action/Defend", "name": "Defend Against CVE-2007-2999", "description": "To defend against this vulnerability, implement access controls and authentication measures to limit the ability to enumerate Active Directory accounts.", "mitigates": [{"type": "attack-pattern", "id": "https://example.com/attack-pattern/TA0001"}, {"type": "attack-pattern", "id": "https://example.com/attack-pattern/TA0008"}, {"type": "attack-pattern", "id": "https://example.com/attack-pattern/TA0009"}]}], "relationship": {"related_to": [{"type": "vulnerability", "id": "https://example.com/vulnerability/CVE-2007-2999"}]}}, "technical_analysis": {"Introduction": "Microsoft Windows Server 2003 has a vulnerability that allows an attacker to determine valid Active Directory account names. This can be exploited by attackers to gain access to the network.", "Impact and Scope": "The vulnerability has a CVSS score of 1.8 and an attack vector of ADJACENT_NETWORK. This means that the vulnerability can be exploited by attackers who have adjacent network access.", "Related MITRE ATT&CK Techniques": "The vulnerability is relevant to the following MITRE ATT&CK techniques: TA0001, TA0008, and TA0009.", "Technical Details": "The vulnerability is caused by the way Windows Server 2003 handles login attempts. When time restrictions are in effect for user accounts, the server generates different error messages for failed login attempts with a valid user name than for those with an invalid user name.", "Detection": "This vulnerability can be detected by monitoring network traffic and looking for unusual login attempts.", "Mitigation": "The vulnerability can be mitigated by implementing access controls and authentication measures to limit the ability to enumerate Active Directory accounts.", "Conclusion": "In conclusion, the vulnerability is a low-severity issue that can be mitigated by implementing proper access controls and authentication measures."}, "executive_analysis": {"Overview": "The vulnerability allows an attacker to determine valid Active Directory account names, which can be exploited to gain access to the network.", "Business Impact": "The vulnerability has the potential to impact the business by allowing attackers to gain access to sensitive information.", "Technical Impact": "The vulnerability is a low-severity issue that can be mitigated by implementing proper access controls and authentication measures.", "Mitigation Strategies": "Implement access controls and authentication measures to limit the ability to enumerate Active Directory accounts.", "Recommendations": "All Windows Server 2003 systems should be updated to the latest security patches and access controls implemented to prevent unauthorized access.", "Conclusions": "In conclusion, the vulnerability is a low-severity issue that can be mitigated by implementing proper access controls and authentication measures."}}