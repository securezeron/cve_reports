{"id": "CVE-2024-21877", "sourceIdentifier": "csirt@divd.nl", "published": "2024-08-12T13:38:14.980", "lastModified": "2024-08-23T18:06:45.520", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') vulnerability through a url parameter in Enphase IQ Gateway (formerly known as Envoy) allows File Manipulation. The endpoint requires authentication.This issue affects Envoy: from 4.x to 8.0 and\u00a0< 8.2.4225."}, {"lang": "es", "value": "La limitaci\u00f3n inadecuada de una vulnerabilidad de nombre de ruta a un directorio restringido (\"Path Traversal\") a trav\u00e9s de un par\u00e1metro de URL en Enphase IQ Gateway (anteriormente conocido como Envoy) permite la manipulaci\u00f3n de archivos. El punto final requiere autenticaci\u00f3n. Este problema afecta a Envoy: de 4.x a 8.0 y &lt;8.2.4225."}], "metrics": {"cvssMetricV40": [{"source": "csirt@divd.nl", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:H/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:L/SI:L/SA:L/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:P/AU:Y/R:I/V:C/RE:H/U:X", "attackVector": "NETWORK", "attackComplexity": "HIGH", "attackRequirements": "NONE", "privilegesRequired": "NONE", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "HIGH", "vulnerableSystemIntegrity": "HIGH", "vulnerableSystemAvailability": "HIGH", "subsequentSystemConfidentiality": "LOW", "subsequentSystemIntegrity": "LOW", "subsequentSystemAvailability": "LOW", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "PRESENT", "automatable": "YES", "recovery": "IRRECOVERABLE", "valueDensity": "CONCENTRATED", "vulnerabilityResponseEffort": "HIGH", "providerUrgency": "NOT_DEFINED", "baseScore": 9.2, "baseSeverity": "CRITICAL"}}], "cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}, {"source": "csirt@divd.nl", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:enphase:iq_gateway_firmware:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0", "versionEndExcluding": "8.2.4225", "matchCriteriaId": "045C0178-42FE-4511-A182-AF3BA9545EF0"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:enphase:iq_gateway:-:*:*:*:*:*:*:*", "matchCriteriaId": "75882BE4-CF58-44B5-BA30-DD13BDFF78C0"}]}]}], "references": [{"url": "https://csirt.divd.nl/CVE-2024-21877", "source": "csirt@divd.nl", "tags": ["Third Party Advisory"]}, {"url": "https://csirt.divd.nl/DIVD-2024-00011", "source": "csirt@divd.nl", "tags": ["Third Party Advisory"]}, {"url": "https://enphase.com/cybersecurity/advisories/ensa-2024-2", "source": "csirt@divd.nl", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-21877 - The vulnerability in Enphase IQ Gateway allows an attacker to perform file manipulation through a URL parameter. This technique is used to achieve this, and it is essential to defend against it by implementing proper input validation and sanitization."}, {"techniqueID": "T1191", "comment": "CVE-2024-21877 - The attacker can use this vulnerability to write files to arbitrary locations. This technique is used to achieve this, and it is essential to defend against it by implementing proper access control and permission management."}, {"techniqueID": "T1192", "comment": "CVE-2024-21877 - The vulnerability allows an attacker to read files from arbitrary locations. This technique is used to achieve this, and it is essential to defend against it by implementing proper access control and permission management."}], "stix_bundle": {"objects": {"vulnerability": {"id": "CVE-2024-21877", "description": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') vulnerability through a url parameter in Enphase IQ Gateway (formerly known as Envoy) allows File Manipulation.", "affects": {"software": {"xsd": "ENPHASE-IQ-GATEWAY", "identity": [{"cpe": "cpe:2.3:o:enphase:iq_gateway_firmware:*:*:*:*:*:*:*:*"}]}}, "analyzed": {"cvss_v40": {"vectorString": "CVSS:4.0/AV:N/AC:H/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:L/SI:L/SA:L/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:P/AU:Y/R:I/V:C/RE:H/U:X", "score": 9.2}, "cvss_v31": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "score": 6.5}}}}, "relationship": {"s relationship": {"source": "vulnerability", "target": "technique", "type": "mitigates"}}}, "technical_analysis": {"Introduction": "The CVE-2024-21877 is a critical vulnerability in Enphase IQ Gateway that allows file manipulation through a URL parameter. The vulnerability has a high attack complexity and requires authentication.", "Impact and Scope": "The vulnerability affects Enphase IQ Gateway firmware versions 4.0 to 8.2.4225 and has a CVSS score of 9.2 according to CVSS 4.0 and 6.5 according to CVSS 3.1.", "Related MITRE ATT&CK Techniques": "T1190, T1191, T1192", "Technical Details": "The vulnerability occurs when the web application fails to properly validate and sanitize user input, allowing an attacker to manipulate the file system.", "Detection": "Detect the vulnerability by searching for suspicious file manipulation activity in the system logs.", "Mitigation": "Mitigate the vulnerability by implementing proper input validation and sanitization, and restricting access to sensitive areas of the file system.", "Conclusion": "The CVE-2024-21877 is a serious vulnerability that requires immediate attention. Implementing the recommended mitigations is essential to prevent file manipulation attacks."}, "executive_analysis": {"Overview": "The CVE-2024-21877 is a critical vulnerability in Enphase IQ Gateway that allows file manipulation through a URL parameter.", "Business Impact": "The vulnerability has the potential to cause significant business disruption and financial loss.", "Technical Impact": "The vulnerability allows an attacker to manipulate the file system, which could lead to data theft, data destruction, or privilege escalation.", "Mitigation Strategies": "Implement proper input validation and sanitization, and restrict access to sensitive areas of the file system.", "Recommendations": "Recommend implementing a vulnerability management program to identify and prioritize vulnerabilities like CVE-2024-21877.", "Conclusions": "The CVE-2024-21877 is a serious vulnerability that requires immediate attention. Implementing the recommended mitigations is essential to prevent file manipulation attacks."}}