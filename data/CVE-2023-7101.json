{"id": "CVE-2023-7101", "sourceIdentifier": "mandiant-cve@google.com", "published": "2023-12-24T22:15:07.983", "lastModified": "2024-08-14T19:40:37.900", "vulnStatus": "Analyzed", "cveTags": [], "cisaExploitAdd": "2024-01-02", "cisaActionDue": "2024-01-23", "cisaRequiredAction": "Apply mitigations per vendor instructions or discontinue use of the product if mitigations are unavailable.", "cisaVulnerabilityName": "Spreadsheet::ParseExcel Remote Code Execution Vulnerability", "descriptions": [{"lang": "en", "value": "Spreadsheet::ParseExcel version 0.65 is a Perl module used for parsing Excel files. Spreadsheet::ParseExcel is vulnerable to an arbitrary code execution (ACE) vulnerability due to passing unvalidated input from a file into a string-type \u201ceval\u201d. Specifically, the issue stems from the evaluation of Number format strings (not to be confused with printf-style format strings) within the Excel parsing logic. \n"}, {"lang": "es", "value": "Spreadsheet::ParseExcel version 0.65 es un m\u00f3dulo Perl utilizado para analizar archivos Excel. Spreadsheet::ParseExcel es afectado por una vulnerabilidad de ejecuci\u00f3n de c\u00f3digo arbitrario (ACE) debido a que se pasa una entrada no validada de un archivo a una \"evaluaci\u00f3n\" de tipo cadena. Espec\u00edficamente, el problema surge de la evaluaci\u00f3n de cadenas de formato num\u00e9rico (que no deben confundirse con cadenas de formato de estilo printf) dentro de la l\u00f3gica de an\u00e1lisis de Excel."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}, {"source": "mandiant-cve@google.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-95"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:jmcnamara:spreadsheet\\:\\:parseexcel:*:*:*:*:*:perl:*:*", "versionEndIncluding": "0.65", "matchCriteriaId": "1C81AC37-3219-4A80-A89E-8BDC1E238F82"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:38:*:*:*:*:*:*:*", "matchCriteriaId": "CC559B26-5DFC-4B7A-A27C-B77DE755DFF9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:39:*:*:*:*:*:*:*", "matchCriteriaId": "B8EDB836-4E6A-4B71-B9B2-AA3E03E0F646"}]}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2023/12/29/4", "source": "mandiant-cve@google.com", "tags": ["Mailing List", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/jmcnamara/spreadsheet-parseexcel/blob/c7298592e102a375d43150cd002feed806557c15/lib/Spreadsheet/ParseExcel/Utility.pm#L171", "source": "mandiant-cve@google.com", "tags": ["Product"]}, {"url": "https://github.com/mandiant/Vulnerability-Disclosures/blob/master/2023/MNDT-2023-0019.md", "source": "mandiant-cve@google.com", "tags": ["Third Party Advisory"]}, {"url": "https://https://github.com/haile01/perl_spreadsheet_excel_rce_poc", "source": "mandiant-cve@google.com", "tags": ["Broken Link", "Third Party Advisory"]}, {"url": "https://https://github.com/jmcnamara/spreadsheet-parseexcel/commit/bd3159277e745468e2c553417b35d5d7dc7405bc", "source": "mandiant-cve@google.com", "tags": ["Broken Link", "Patch"]}, {"url": "https://https://metacpan.org/dist/Spreadsheet-ParseExcel", "source": "mandiant-cve@google.com", "tags": ["Broken Link", "Product"]}, {"url": "https://https://www.cve.org/CVERecord?id=CVE-2023-7101", "source": "mandiant-cve@google.com", "tags": ["Broken Link", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2023/12/msg00025.html", "source": "mandiant-cve@google.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/IFEHKULQRVXHIV7XXK2RGD4VQN6Y4CV5/", "source": "mandiant-cve@google.com", "tags": ["Mailing List"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/M2FIWDHRYTAAQLGM6AFOZVM7AFZ4H2ZR/", "source": "mandiant-cve@google.com", "tags": ["Mailing List"]}, {"url": "https://security.metacpan.org/2024/02/10/vulnerable-spreadsheet-parsing-modules.html", "source": "mandiant-cve@google.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2023-7101 - Execution of arbitrary code can be devastating. Always validate user input before processing it."}, {"techniqueID": "T1190", "comment": "CVE-2023-7101 - Code injection is a potential attack vector. Ensure proper input validation and sanitization."}, {"techniqueID": "T1210", "comment": "CVE-2023-7101 - Weak input validation and lack of sanitization can lead to exploits. Implement input validation and sanitization mechanisms."}, {"techniqueID": "T1191", "comment": "CVE-2023-7101 - The use of untrusted data can compromise system integrity. Ensure proper input validation and sanitization."}, {"techniqueID": "T1404", "comment": "CVE-2023-7101 - Code execution can be performed remotely. Implement network segmentation and restrict access to vulnerable systems."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "https://cve.mitre.org/extensions/vulnerability/2.0/CVE-2023-7101", "description": "Spreadsheet::ParseExcel remote code execution vulnerability", "published": "2023-12-24T22:15:07.983", "last_modified": "2024-08-14T19:40:37.900", "base_score": 7.8, "base_severity": "HIGH"}, {"type": "observable", "id": "https://example.com/T1190", "description": "User input validation bypass"}, {"type": "observable", "id": "https://example.com/T1191", "description": "Untrusted data execution"}, {"type": "observable", "id": "https://example.com/T1210", "description": "Weak input validation"}, {"type": "observable", "id": "https://example.com/T1404", "description": "Remote code execution"}, {"type": "indicator", "id": "https://example.com/Indicator-1", "description": "Suspicious Excel file behavior", "pattern": "SUSPICIOUS_EXCEL_FILE_PATTERN"}], "relationships": [{"source_id": "https://cve.mitre.org/extensions/vulnerability/2.0/CVE-2023-7101", "target_id": "https://example.com/T1190", "relationship": "relates_to"}, {"source_id": "https://cve.mitre.org/extensions/vulnerability/2.0/CVE-2023-7101", "target_id": "https://example.com/T1191", "relationship": "relates_to"}, {"source_id": "https://cve.mitre.org/extensions/vulnerability/2.0/CVE-2023-7101", "target_id": "https://example.com/T1210", "relationship": "relates_to"}, {"source_id": "https://cve.mitre.org/extensions/vulnerability/2.0/CVE-2023-7101", "target_id": "https://example.com/T1404", "relationship": "relates_to"}, {"source_id": "https://example.com/T1190", "target_id": "https://example.com/Indicator-1", "relationship": "related_to"}, {"source_id": "https://example.com/T1191", "target_id": "https://example.com/Indicator-1", "relationship": "related_to"}, {"source_id": "https://example.com/T1210", "target_id": "https://example.com/Indicator-1", "relationship": "related_to"}, {"source_id": "https://example.com/T1404", "target_id": "https://example.com/Indicator-1", "relationship": "related_to"}]}, "technical_analysis": {"Introduction": "The CVE-2023-7101 is a remote code execution vulnerability in Spreadsheet::ParseExcel. This vulnerability can be exploited by injecting malicious code into the Excel file.", "Impact and Scope": "The impact of this vulnerability is HIGH, with a CVSS score of 7.8. The scope of the vulnerability is limited to systems running Spreadsheet::ParseExcel.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: TA0001, T1190, T1191, T1210, and T1404.", "Technical Details": "The vulnerability is caused by the use of unvalidated user input. An attacker can inject malicious code into the Excel file, which will be executed when the file is opened.", "Detection": "The CVE-2023-7101 can be detected by looking for suspicious Excel file behavior, such as untrusted data execution.", "Mitigation": "The CVE-2023-7101 can be mitigated by implementing input validation and sanitization mechanisms, and by restricting access to vulnerable systems.", "Conclusion": "The CVE-2023-7101 is a critical vulnerability that can be exploited by injecting malicious code into Excel files. It is essential to implement mitigation strategies to protect against this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2023-7101 is a remote code execution vulnerability in Spreadsheet::ParseExcel that can have significant business and technical impacts.", "Business Impact": "The business impact of this vulnerability is HIGH, as it can compromise sensitive data and disrupt business operations. It is essential to take immediate action to mitigate this vulnerability.", "Technical Impact": "The technical impact of this vulnerability is HIGH, as it can compromise system integrity and lead to unauthorized code execution. It is essential to implement mitigation strategies to protect against this vulnerability.", "Mitigation Strategies": "The following mitigation strategies can be implemented to protect against the CVE-2023-7101: input validation and sanitization, and restricting access to vulnerable systems.", "Recommendations": "We recommend that all organizations affected by this vulnerability take immediate action to mitigate it. This includes implementing input validation and sanitization mechanisms, and restricting access to vulnerable systems.", "Conclusions": "The CVE-2023-7101 is a critical vulnerability that requires immediate attention. It is essential to take action to mitigate this vulnerability to protect against potential attacks."}}