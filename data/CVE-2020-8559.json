{"id": "CVE-2020-8559", "sourceIdentifier": "jordan@liggitt.net", "published": "2020-07-22T14:15:16.517", "lastModified": "2023-01-27T20:34:52.773", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Kubernetes kube-apiserver in versions v1.6-v1.15, and versions prior to v1.16.13, v1.17.9 and v1.18.6 are vulnerable to an unvalidated redirect on proxied upgrade requests that could allow an attacker to escalate privileges from a node compromise to a full cluster compromise."}, {"lang": "es", "value": "El Kubernetes kube-apiserver en versiones v1.6-v1.15 y versiones anteriores a v1.16.13, v1.17.9 y v1.18.6, son vulnerables a un redireccionamiento no validado en las peticiones de actualizaci\u00f3n proxy que podr\u00edan permitir a un atacante escalar privilegios desde un compromiso de nodo a un compromiso del cl\u00faster completo"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.9, "impactScore": 5.9}, {"source": "jordan@liggitt.net", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.5, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 6.8, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-601"}]}, {"source": "jordan@liggitt.net", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-601"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.6.0", "versionEndIncluding": "1.15.0", "matchCriteriaId": "43222A9D-6D48-490F-8120-349DCE1C1218"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.16.0", "versionEndExcluding": "1.16.13", "matchCriteriaId": "FE1EA8C5-2EF4-4462-B693-FE20B3DF75C6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.17.0", "versionEndExcluding": "1.17.9", "matchCriteriaId": "CC1FA454-87A3-480C-BB5E-A23086E2EA99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.18.0", "versionEndExcluding": "1.18.6", "matchCriteriaId": "3E4009BA-8220-4B8E-8B4B-1ADA1680DD70"}]}]}], "references": [{"url": "https://github.com/kubernetes/kubernetes/issues/92914", "source": "jordan@liggitt.net", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://groups.google.com/d/msg/kubernetes-security-announce/JAIGG5yNROs/19nHQ5wkBwAJ", "source": "jordan@liggitt.net", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20200810-0004/", "source": "jordan@liggitt.net", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1047", "comment": "CVE-2020-8559 - An adversary may use a vulnerability in the Kubernetes kube-apiserver to redirect upgrade requests and escalate privileges from a node compromise to a full cluster compromise."}, {"techniqueID": "T1190", "comment": "An attacker may exploit the vulnerability in the Kubernetes kube-apiserver to gain unauthorized access to the cluster, which could allow for further exploitation and escalation of privileges."}, {"techniqueID": "T1027", "comment": "An attacker may use the vulnerability in the Kubernetes kube-apiserver to gain a foothold in the network and establish a presence in the environment, which could be used for further exploitation."}], "stix_bundle": {"type": "bundle", "id": "bundle--cve-2020-8559", "created_byRef": {"id": "identity--user", "type": "identity"}, "description": "STIX 2.1 Bundle for CVE-2020-8559", "objects": [{"type": "indicator", "id": "indicator--cve-2020-8559", "created_byRef": {"id": "identity--user", "type": "identity"}, "modified": "2023-01-27T20:34:52.773", "name": "CVE-2020-8559", "description": "A vulnerability in the Kubernetes kube-apiserver that allows an attacker to redirect upgrade requests and escalate privileges from a node compromise to a full cluster compromise.", "intrusion_Set_refs": [{"id": "intrusion-set--kubernetes-apiserver", "type": "intrusion-set"}], "kill_chain_phases": [{"kill_chain_name": "ATT&CK", "phase_name": "Command and Control"}]}, {"type": "intrusion-set", "id": "intrusion-set--kubernetes-apiserver", "created_byRef": {"id": "identity--user", "type": "identity"}, "modified": "2023-01-27T20:34:52.773", "name": "Kubernetes Apiserver", "description": "An intrusion set used to exploit the vulnerability in the Kubernetes kube-apiserver.", "_intrusion_set_ tactics": [{"tactic_name": "Initial Access", "tactics_refs": ["tactic--initial-access"]}]}, {"type": "tactic", "id": "tactic--initial-access", "created_byRef": {"id": "identity--user", "type": "identity"}, "modified": "2023-01-27T20:34:52.773", "name": "Initial Access", "description": "The initial step in an attack, where the attacker gains access to the system", "techniques": [{"technique_name": "T1047", "techniques_refs": ["technique--t1047"]}]}, {"type": "technique", "id": "technique--t1047", "created_byRef": {"id": "identity--user", "type": "identity"}, "modified": "2023-01-27T20:34:52.773", "name": "T1047", "description": "Web Shell", "data_sources": [{"id": "data-source--logs", "type": "data-source"}]}]}, "technical_analysis": {"Introduction": "The Kubernetes kube-apiserver in versions v1.6-v1.15, and versions prior to v1.16.13, v1.17.9 and v1.18.6 is vulnerable to an unvalidated redirect on proxied upgrade requests that could allow an attacker to escalate privileges from a node compromise to a full cluster compromise.", "Impact and Scope": "The vulnerability affects the Kubernetes kube-apiserver in versions v1.6-v1.15, and versions prior to v1.16.13, v1.17.9 and v1.18.6. It has a CVSS base score of 6.8 and allows an attacker to escalate privileges from a node compromise to a full cluster compromise.", "Related MITRE ATT&CK Techniques": "T1047, T1190, and T1027", "Technical Details": "The vulnerability occurs when the Kubernetes kube-apiserver does not properly validate redirects on proxied upgrade requests. An attacker can take advantage of this vulnerability to redirect upgrade requests and escalate privileges from a node compromise to a full cluster compromise.", "Detection": "Detection methods may include monitoring logs for unusual upgrade requests, monitoring for changes in the cluster configuration, and monitoring for suspicious traffic.", "Mitigation": "Mitigation strategies may include updating to a patched version of the Kubernetes kube-apiserver, implementing a web application firewall to block suspicious traffic, and monitoring logs for unusual upgrade requests.", "Conclusion": "In conclusion, the vulnerability in the Kubernetes kube-apiserver is a significant threat to the security of Kubernetes clusters. It is essential to update to a patched version of the kube-apiserver and to implement additional mitigation strategies to prevent an attacker from exploiting this vulnerability."}, "executive_analysis": {"Overview": "The Kubernetes kube-apiserver in versions v1.6-v1.15, and versions prior to v1.16.13, v1.17.9 and v1.18.6 is vulnerable to an unvalidated redirect on proxied upgrade requests that could allow an attacker to escalate privileges from a node compromise to a full cluster compromise.", "Business Impact": "The vulnerability could allow an attacker to gain unauthorized access to the cluster, which could have serious consequences for the business, including data theft, financial loss, and reputational damage.", "Technical Impact": "The vulnerability could allow an attacker to escalate privileges from a node compromise to a full cluster compromise, which could have serious technical consequences, including unauthorized access to sensitive data, disruption of business operations, and destruction of data.", "Mitigation Strategies": " Updating to a patched version of the Kubernetes kube-apiserver, implementing a web application firewall to block suspicious traffic, and monitoring logs for unusual upgrade requests.", "Recommendations": "Recommendations include updating to a patched version of the kube-apiserver, implementing a web application firewall to block suspicious traffic, and monitoring logs for unusual upgrade requests.", "Conclusions": "In conclusion, the vulnerability in the Kubernetes kube-apiserver is a significant threat to the security of Kubernetes clusters. It is essential to take immediate action to mitigate this vulnerability and prevent an attacker from exploiting it."}}