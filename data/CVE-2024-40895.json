{"id": "CVE-2024-40895", "sourceIdentifier": "vultures@jpcert.or.jp", "published": "2024-07-30T09:15:03.987", "lastModified": "2024-08-01T13:58:15.617", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "FFRI AMC versions 3.4.0 to 3.5.3 and some OEM products that implement/bundle FFRI AMC versions 3.4.0 to 3.5.3 allow a remote unauthenticated attacker to execute arbitrary OS commands when certain conditions are met in an environment where the notification program setting is enabled and the executable file path is set to a batch file (.bat) or command file (.cmd) extension."}, {"lang": "es", "value": " FFRI AMC versiones 3.4.0 a 3.5.3 y algunos productos OEM que implementan/agrupan FFRI AMC versiones 3.4.0 a 3.5.3 permiten a un atacante remoto no autenticado ejecutar comandos arbitrarios del sistema operativo cuando se cumplen ciertas condiciones en un entorno donde el programa de notificaci\u00f3n La configuraci\u00f3n est\u00e1 habilitada y la ruta del archivo ejecutable est\u00e1 configurada en una extensi\u00f3n de archivo por lotes (.bat) o archivo de comando (.cmd)."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 4.7}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-78"}]}], "references": [{"url": "https://jvn.jp/en/jp/JVN26734798/", "source": "vultures@jpcert.or.jp"}, {"url": "https://www.ffri.jp/assets/files/other_docs/20240729.pdf", "source": "vultures@jpcert.or.jp"}, {"url": "https://www.skyseaclientview.net/news/240729_01/", "source": "vultures@jpcert.or.jp"}, {"url": "https://www.support.nec.co.jp/View.aspx?id=3140109694", "source": "vultures@jpcert.or.jp"}], "techniques": [{"techniqueID": "T1137", "comment": "CVE-2024-40895 - The vulnerability allows an attacker to execute arbitrary OS commands, likely as a part of a Command and Control (C2) server's functionality, making this technique relevant to the vulnerability."}, {"techniqueID": "T1068", "comment": "CVE-2024-40895 - The vulnerability allows an attacker to execute arbitrary OS commands, potentially allowing the attacker to load additional payloads or execute other malicious code, making this technique relevant to the vulnerability."}, {"techniqueID": "T1203", "comment": "CVE-2024-40895 - The vulnerability allows an attacker to execute arbitrary OS commands, making it possible for the attacker to delete or modify files, making this technique relevant to the vulnerability."}], "stix_bundle": "STIX 2.1 Bundle:\n{\n  \"objects\": [\n    {\n      \"type\": \"vulnerability\",\n      \"id\": \"urn:sandbox: CVE-2024-40895\",\n      \"created\": \"2024-07-30T09:15:03.987\",\n      \"modified\": \"2024-08-01T13:58:15.617\",\n      \"name\": \"FFRI AMC Remote Code Execution Vulnerability\",\n      \"description\": \"FFRI AMC versions 3.4.0 to 3.5.3 and some OEM products that implement/bundle FFRI AMC versions 3.4.0 to 3.5.3 allow a remote unauthenticated attacker to execute arbitrary OS commands when certain conditions are met in an environment where the notification program setting is enabled and the executable file path is set to a batch file (.bat) or command file (.cmd) extension.\",\n      \"cve\": {\n        \"id\": \"CVE-2024-40895\"\n      }\n    },\n    {\n      \"type\": \"phases\",\n      \"id\": \"urn:sandbox:phases-CVE-2024-40895\",\n      \"name\": \"Exploitation\",\n      \"description\": \"An attacker executes a batch file or command file to execute arbitrary OS commands.\",\n      \"objects\": [\n        {\n          \"type\": \"observed-data\",\n          \"id\": \"urn:sandbox:observed-data-CVE-2024-40895\",\n          \"content\": \"Batch file or command file is executed\"\n        }\n      ],\n      \"related-objects\": [\n        {\n          \"type\": \"vulnerability\",\n          \"id\": \"urn:sandbox:CVE-2024-40895\",\n          \"role\": \"related_to\",\n          \"relationship\": \"exploited\"\n        },\n        {\n          \"type\": \"activity\",\n          \"id\": \"urn:sandbox:activity-T1137\",\n          \"type\": \"Command and Control\",\n          \"description\": \"An attacker executes a batch file or command file to execute arbitrary OS commands.\",\n          \"objects\": [\n            {\n              \"type\": \"observed-data\",\n              \"id\": \"urn:sandbox:observed-data-CVE-2024-40895\",\n              \"content\": \"Batch file or command file is executed\"\n            }\n          ],\n          \"related-objects\": [\n            {\n              \"type\": \"vulnerability\",\n              \"id\": \"urn:sandbox:CVE-2024-40895\",\n              \"role\": \"exploited\",\n              \"relationship\": \"exploited\"\n            }\n          ]\n        }\n      ]\n    },\n    {\n      \"type\": \"c courses-of-action\",\n      \"id\": \"urn:sandbox:courses-of-action-CVE-2024-40895\",\n      \"name\": \"Mitigation\",\n      \"description\": \"Apply a patch to fix the vulnerability.\",\n      \"objects\": [\n        {\n          \"type\": \"c courses-of-action\",\n          \"id\": \"urn:sandbox:courses-of-action-CVE-2024-40895\",\n          \"title\": \"Apply Patch\",\n          \"description\": \"Apply a patch to fix the vulnerability.\",\n          \"related-objects\": [\n            {\n              \"type\": \"vulnerability\",\n              \"id\": \"urn:sandbox:CVE-2024-40895\",\n              \"role\": \"mitigates\",\n              \"relationship\": \"mitigated\"\n            },\n            {\n              \"type\": \"activity\",\n              \"id\": \"urn:sandbox:activity-T1137\",\n              \"type\": \"Command and Control\",\n              \"description\": \"An attacker executes a batch file or command file to execute arbitrary OS commands.\",\n              \"objects\": [\n                {\n                  \"type\": \"observed-data\",\n                  \"id\": \"urn:sandbox:observed-data-CVE-2024-40895\",\n                  \"content\": \"Batch file or command file is executed\"\n                }\n              ],\n              \"related-objects\": [\n                {\n                  \"type\": \"vulnerability\",\n                  \"id\": \"urn:sandbox:CVE-2024-40895\",\n                  \"role\": \"mitigated\",\n                  \"relationship\": \"mitigated\"\n                }\n              ]\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n", "technical_analysis": {"Introduction": "The FFRI AMC remote code execution vulnerability allows an attacker to execute arbitrary OS commands, posing a significant threat to the confidentiality, integrity, and availability of systems.", "Impact and Scope": "The vulnerability has a CVSS score of 6.4 (Medium) and affects FFRI AMC versions 3.4.0 to 3.5.3 and some OEM products that implement/bundle FFRI AMC versions 3.4.0 to 3.5.3.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE techniques T1137, T1068, and T1203.", "Technical Details": "The vulnerability allows an attacker to execute arbitrary OS commands by sending a batch file or command file that is executed as part of the notification program setting.", "Detection": "Detection methods include analyzing system logs for login attempts, detecting unusual network traffic, and monitoring system processes for suspicious behavior.", "Mitigation": "Mitigation strategies include applying a patch, disabling the notification program setting, and restricting access to sensitive files and systems.", "Conclusion": "In conclusion, the FFRI AMC remote code execution vulnerability is a significant threat to systems and should be addressed promptly."}, "executive_analysis": {"Overview": "The FFRI AMC remote code execution vulnerability is a critical issue that affects FFRI AMC versions 3.4.0 to 3.5.3 and some OEM products that implement/bundle FFRI AMC versions 3.4.0 to 3.5.3.", "Business Impact": "The vulnerability poses a significant threat to the confidentiality, integrity, and availability of systems, potentially resulting in financial losses and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary OS commands, potentially leading to the execution of malicious code, data theft, and system compromise.", "Mitigation Strategies": "The primary mitigation strategy is to apply a patch, as well as disabling the notification program setting and restricting access to sensitive files and systems.", "Recommendations": "Recommendations include applying a patch, disabling the notification program setting, restricting access to sensitive files and systems, and conducting regular security audits and penetration testing.", "Conclusions": "In conclusion, the FFRI AMC remote code execution vulnerability is a critical issue that requires immediate attention and action to mitigate its impact."}}