{"id": "CVE-2023-52835", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-21T16:15:21.023", "lastModified": "2024-05-21T16:53:56.550", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nperf/core: Bail out early if the request AUX area is out of bound\n\nWhen perf-record with a large AUX area, e.g 4GB, it fails with:\n\n    #perf record -C 0 -m ,4G -e arm_spe_0// -- sleep 1\n    failed to mmap with 12 (Cannot allocate memory)\n\nand it reveals a WARNING with __alloc_pages():\n\n\t------------[ cut here ]------------\n\tWARNING: CPU: 44 PID: 17573 at mm/page_alloc.c:5568 __alloc_pages+0x1ec/0x248\n\tCall trace:\n\t __alloc_pages+0x1ec/0x248\n\t __kmalloc_large_node+0xc0/0x1f8\n\t __kmalloc_node+0x134/0x1e8\n\t rb_alloc_aux+0xe0/0x298\n\t perf_mmap+0x440/0x660\n\t mmap_region+0x308/0x8a8\n\t do_mmap+0x3c0/0x528\n\t vm_mmap_pgoff+0xf4/0x1b8\n\t ksys_mmap_pgoff+0x18c/0x218\n\t __arm64_sys_mmap+0x38/0x58\n\t invoke_syscall+0x50/0x128\n\t el0_svc_common.constprop.0+0x58/0x188\n\t do_el0_svc+0x34/0x50\n\t el0_svc+0x34/0x108\n\t el0t_64_sync_handler+0xb8/0xc0\n\t el0t_64_sync+0x1a4/0x1a8\n\n'rb->aux_pages' allocated by kcalloc() is a pointer array which is used to\nmaintains AUX trace pages. The allocated page for this array is physically\ncontiguous (and virtually contiguous) with an order of 0..MAX_ORDER. If the\nsize of pointer array crosses the limitation set by MAX_ORDER, it reveals a\nWARNING.\n\nSo bail out early with -ENOMEM if the request AUX area is out of bound,\ne.g.:\n\n    #perf record -C 0 -m ,4G -e arm_spe_0// -- sleep 1\n    failed to mmap with 12 (Cannot allocate memory)"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: perf/core: rescate anticipado si el \u00e1rea AUX de la solicitud est\u00e1 fuera de los l\u00edmites. Cuando perf-record con un \u00e1rea AUX grande, por ejemplo, 4 GB, falla con: #perf record -C 0 -m, 4G -e arm_spe_0// -- el sue\u00f1o 1 no pudo mapear con 12 (no se puede asignar memoria) y revela una ADVERTENCIA con __alloc_pages(): ------------[ cortar aqu\u00ed ] ------------ ADVERTENCIA: CPU: 44 PID: 17573 en mm/page_alloc.c:5568 __alloc_pages+0x1ec/0x248 Rastreo de llamadas: __alloc_pages+0x1ec/0x248 __kmalloc_large_node+0xc0/0x1f8 __kmalloc_node+0x134/ 0x1e8 rb_alloc_aux+0xe0/0x298 perf_mmap+0x440/0x660 mmap_region+0x308/0x8a8 do_mmap+0x3c0/0x528 vm_mmap_pgoff+0xf4/0x1b8 ksys_mmap_pgoff+0x18c/0x218 sys_mmap+0x38/0x58 invoke_syscall+0x50/0x128 el0_svc_common.constprop.0+0x58/0x188 do_el0_svc+0x34/0x50 el0_svc+0x34/0x108 el0t_64_sync_handler+0xb8/0xc0 el0t_64_sync+0x1a4/0x1a8 'rb-&gt;aux_pages' asignado por kcalloc() es una matriz de punteros que se utiliza para mantener p\u00e1ginas de seguimiento AUX. La p\u00e1gina asignada para esta matriz es f\u00edsicamente contigua (y virtualmente contigua) con un orden de 0..MAX_ORDER. Si el tama\u00f1o de la matriz de punteros cruza la limitaci\u00f3n establecida por MAX_ORDER, se revela una ADVERTENCIA. Por lo tanto, salve pronto con -ENOMEM si el \u00e1rea AUX de la solicitud est\u00e1 fuera de los l\u00edmites, por ejemplo: #perf record -C 0 -m ,4G -e arm_spe_0// -- el sue\u00f1o 1 no pudo asignar mm con 12 (no se puede asignar memoria)"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/1a2a4202c60fcdffbf04f259002ce9bff39edece", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/2424410f94a94d91230ced094062d859714c984a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/2e905e608e38cf7f8dcddcf8a6036e91a78444cb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/54aee5f15b83437f23b2b2469bcf21bdd9823916", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/788c0b3442ead737008934947730a6d1ff703734", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8c504f615d7ed60ae035c51d0c789137ced6797f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9ce4e87a8efd37c85766ec08b15e885cab08553a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/fd0df3f8719201dbe61a4d39083d5aecd705399a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2023-52835 - This vulnerability can be exploited by an attacker to gain access to the affected Linux kernel, potentially leading to a denial-of-service or privilege escalation. Defending against this vulnerability requires implementing proper security measures, such as updating the kernel to the latest version and enabling security features like SELinux and AppArmor."}, {"techniqueID": "T1191", "comment": "CVE-2023-52835 - This vulnerability can be exploited by an attacker to inject malicious code into the Linux kernel, potentially leading to a privilege escalation. Defending against this vulnerability requires implementing proper security measures, such as updating the kernel to the latest version and enabling security features like SELinux and AppArmor."}], "stix_bundle": {"@Extension": {"xml:lang": "en-US", "stix_version": "2.1"}, "bundle_id": "cvc-52835", "bundle_name": "CVE-2023-52835", "description": "This STIX bundle represents the vulnerability CVE-2023-52835, including the related techniques, risks, and defense strategies.", "objects": [{"type": "vulnerability", "id": "vuln-cve-52835", "label": "CVE-2023-52835", "description": "In the Linux kernel, the following vulnerability has been resolved: perf/core: Bail out early if the request AUX area is out of bound...", "references": [{"href": "https://git.kernel.org/stable/c/1a2a4202c60fcdffbf04f259002ce9bff39edece", "idref": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}]}, {"type": "indicator", "id": "ind-t1190", "label": "T1190", "description": "Indicator for T1190", "observed_data": {"x_opencti_value": "indicator"}}, {"type": "course-of-action", "id": "c-sec-update-kernel", "label": "Update Kernel", "description": "Update the Linux kernel to the latest version to mitigate this vulnerability.", "related_relationships": [{"type": "mitigates", "id": "m-sec-update-kernel", "object_id": "ind-t1190"}]}]}, "technical_analysis": {"Introduction": "The CVE-2023-52835 vulnerability is a denial-of-service vulnerability in the Linux kernel that allows an attacker to inject malicious code into the kernel.", "Impact and Scope": "The impact of this vulnerability is a denial-of-service or privilege escalation, and the scope is limited to systems running a vulnerable version of the Linux kernel.", "Related MITRE ATT&CK Techniques": "T1190, T1191", "Technical Details": "The vulnerability allows an attacker to inject malicious code into the kernel by exploiting a bug in the perf/core implementation.", "Detection": "The vulnerability can be detected by monitoring for unusual kernel activity or by analyzing system logs for evidence of malicious code injection.", "Mitigation": "Updating the kernel to the latest version and enabling security features like SELinux and AppArmor can mitigate this vulnerability.", "Conclusion": "In conclusion, the CVE-2023-52835 vulnerability is a serious issue that requires immediate attention to prevent exploitation. It is essential to update the kernel to the latest version and enable security features like SELinux and AppArmor to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2023-52835 vulnerability is a critical issue that can lead to a denial-of-service or privilege escalation. It is essential to identify and mitigate this vulnerability to prevent attacks.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to downtime, data breaches, or privilege escalation. It is essential to prioritize the mitigation of this vulnerability to prevent these impacts.", "Technical Impact": "The technical impact of this vulnerability is a compromise of the Linux kernel, which can lead to a denial-of-service or privilege escalation.", "Mitigation Strategies": "The primary mitigation strategy is to update the kernel to the latest version and enable security features like SELinux and AppArmor.", "Recommendations": "It is recommended to prioritize the mitigation of this vulnerability, update the kernel to the latest version, and enable security features like SELinux and AppArmor.", "Conclusions": "In conclusion, the CVE-2023-52835 vulnerability is a critical issue that requires immediate attention. It is essential to prioritize the mitigation of this vulnerability to prevent attacks and minimize downtime."}}