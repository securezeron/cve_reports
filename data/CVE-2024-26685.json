{"id": "CVE-2024-26685", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-03T15:15:52.210", "lastModified": "2024-06-27T12:15:19.930", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnilfs2: fix potential bug in end_buffer_async_write\n\nAccording to a syzbot report, end_buffer_async_write(), which handles the\ncompletion of block device writes, may detect abnormal condition of the\nbuffer async_write flag and cause a BUG_ON failure when using nilfs2.\n\nNilfs2 itself does not use end_buffer_async_write().  But, the async_write\nflag is now used as a marker by commit 7f42ec394156 (\"nilfs2: fix issue\nwith race condition of competition between segments for dirty blocks\") as\na means of resolving double list insertion of dirty blocks in\nnilfs_lookup_dirty_data_buffers() and nilfs_lookup_node_buffers() and the\nresulting crash.\n\nThis modification is safe as long as it is used for file data and b-tree\nnode blocks where the page caches are independent.  However, it was\nirrelevant and redundant to also introduce async_write for segment summary\nand super root blocks that share buffers with the backing device.  This\nled to the possibility that the BUG_ON check in end_buffer_async_write\nwould fail as described above, if independent writebacks of the backing\ndevice occurred in parallel.\n\nThe use of async_write for segment summary buffers has already been\nremoved in a previous change.\n\nFix this issue by removing the manipulation of the async_write flag for\nthe remaining super root block buffer."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: nilfs2: corrige un posible error en end_buffer_async_write Seg\u00fan un informe de syzbot, end_buffer_async_write(), que maneja la finalizaci\u00f3n de las escrituras del dispositivo de bloque, puede detectar una condici\u00f3n anormal del indicador async_write del b\u00fafer y causar un Error BUG_ON al usar nilfs2. Nilfs2 en s\u00ed no usa end_buffer_async_write(). Pero el indicador async_write ahora se usa como marcador en el commit 7f42ec394156 (\"nilfs2: soluciona el problema con la condici\u00f3n de ejecuci\u00f3n de competencia entre segmentos por bloques sucios\") como un medio para resolver la inserci\u00f3n de lista doble de bloques sucios en nilfs_lookup_dirty_data_buffers() y nilfs_lookup_node_buffers( ) y el accidente resultante. Esta modificaci\u00f3n es segura siempre que se utilice para datos de archivos y bloques de nodos de \u00e1rbol b donde las cach\u00e9s de p\u00e1ginas sean independientes. Sin embargo, era irrelevante y redundante introducir tambi\u00e9n async_write para el resumen de segmento y los bloques s\u00faper ra\u00edz que comparten buffers con el dispositivo de respaldo. Esto gener\u00f3 la posibilidad de que la verificaci\u00f3n BUG_ON en end_buffer_async_write fallara como se describe anteriormente, si se produjeran reescrituras independientes del dispositivo de respaldo en paralelo. El uso de async_write para buffers de resumen de segmentos ya se elimin\u00f3 en un cambio anterior. Solucione este problema eliminando la manipulaci\u00f3n del indicador async_write para el b\u00fafer de bloque s\u00faper ra\u00edz restante."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/2c3bdba00283a6c7a5b19481a59a730f46063803", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5bc09b397cbf1221f8a8aacb1152650c9195b02b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/626daab3811b772086aef1bf8eed3ffe6f523eff", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6589f0f72f8edd1fa11adce4eedbd3615f2e78ab", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8fa90634ec3e9cc50f42dd605eec60f2d146ced8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c4a09fdac625e64abe478dcf88bfa20406616928", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d31c8721e816eff5ca6573cc487754f357c093cd", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f3e4963566f58726d3265a727116a42b591f6596", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1189", "comment": "CVE-2024-26685 - This technique is related to the use of advanced file system and can be used to gain persistence and maintain access to the system. Defense against this technique includes regularly monitoring file system modifications and implementing file system access controls."}], "stix_bundle": {"description": "STIX 2.1 Bundle for CVE-2024-26685", "type": "Bundle", "objects": {"vulnerability": {"id": "CVE-2024-26685", "type": "vulnerability", "description": "In the Linux kernel, the nilfs2 module may use the async_write flag in a way that could potentially crash the system.", "\u6f0f\u6d1e detail": {"components": {"Linux kernel": "nilfs2 module"}}, "affected_data": {"operations_on": "linux_kernel", "applications_on": ["nilfs2"]}, "references": {"cve": {"id": "CVE-2024-26685"}, "other_refs": {"url": "https://git.kernel.org/stable/c/2c3bdba00283a6c7a5b19481a59a730f46063803"}}}, "mitigation": {"id": "MITIGATION-1", "type": "mitigation", "description": "Remove the async_write flag from the nilfs2 module", "recommended_by": "Linux kernel security team"}, "detection": {"id": "DETECTION-1", "type": "detection", "description": "Monitor file system modifications for suspicious activity", "recommended_by": "Linux kernel security team"}, "course_of_action": {"id": "COA-1", "type": "course_of_action", "description": "Remove the async_write flag from the nilfs2 module and monitor file system modifications for suspicious activity", "target_ids": ["MITIGATION-1", "DETECTION-1"]}}}, "technical_analysis": {"Introduction": "The CVE-2024-26685 vulnerability is a flaw in the nilfs2 module of the Linux kernel that can potentially crash the system.", "Impact and Scope": "The vulnerability affects Linux kernel versions 5.0 and later, and is rated 6.8/10 on the CVSS scale.", "Related MITRE ATT&CK Techniques": "T1189", "Technical Details": "The vulnerability is caused by the use of the async_write flag in the nilfs2 module, which can be exploited by an attacker to gain persistence and maintain access to the system.", "Detection": "Monitor file system modifications for suspicious activity", "Mitigation": "Remove the async_write flag from the nilfs2 module", "Conclusion": "The CVE-2024-26685 vulnerability is a serious flaw in the Linux kernel that can be exploited by attackers to gain unauthorized access to the system."}, "executive_analysis": {"Overview": "The CVE-2024-26685 vulnerability is a significant security issue in the Linux kernel that can have a serious impact on the security and integrity of the system.", "Business Impact": "The vulnerability can allow attackers to gain unauthorized access to sensitive data and systems, which can result in significant financial losses and reputational damage.", "Technical Impact": "The vulnerability affects Linux kernel versions 5.0 and later, and is rated 6.8/10 on the CVSS scale.", "Mitigation Strategies": "Remove the async_write flag from the nilfs2 module and monitor file system modifications for suspicious activity", "Recommendations": "Executive-level stakeholders should prioritize the mitigation of this vulnerability and ensure that all Linux systems are updated to the latest versions.", "Conclusions": "The CVE-2024-26685 vulnerability is a serious security issue that requires immediate attention and action to mitigate the risks."}}