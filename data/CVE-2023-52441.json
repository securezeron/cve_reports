{"id": "CVE-2023-52441", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-02-21T08:15:45.463", "lastModified": "2024-05-28T20:16:22.480", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nksmbd: fix out of bounds in init_smb2_rsp_hdr()\n\nIf client send smb2 negotiate request and then send smb1 negotiate\nrequest, init_smb2_rsp_hdr is called for smb1 negotiate request since\nneed_neg is set to false. This patch ignore smb1 packets after ->need_neg\nis set to false."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: ksmbd: correcci\u00f3n fuera de los l\u00edmites en init_smb2_rsp_hdr() Si el cliente env\u00eda una solicitud de negociaci\u00f3n smb2 y luego env\u00eda una solicitud de negociaci\u00f3n smb1, se llama a init_smb2_rsp_hdr para la solicitud de negociaci\u00f3n smb1 ya que need_neg est\u00e1 configurado en falso. Este parche ignora los paquetes smb1 despu\u00e9s de que -&gt;need_neg se establece en falso."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.15.0", "versionEndExcluding": "5.15.145", "matchCriteriaId": "9FF1671D-E1DC-4CBC-8438-A46DF4F1E978"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.16.0", "versionEndExcluding": "6.1.53", "matchCriteriaId": "10E7E9D1-2299-4B6E-945D-98FF23478015"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2.0", "versionEndExcluding": "6.4.16", "matchCriteriaId": "447B7633-4054-4954-8C80-6F6098C5574B"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/330d900620dfc9893011d725b3620cd2ee0bc2bc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/536bb492d39bb6c080c92f31e8a55fe9934f452b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/5c0df9d30c289d6b9d7d44e2a450de2f8e3cf40b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/aa669ef229ae8dd779da9caa24e254964545895f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1205.005", "comment": "CVE-2023-52441 - Exploitation of the Linux kernel vulnerability allows for remote code execution via sending a crafted SMB2 negotiate request."}, {"techniqueID": "T1210", "comment": "CVE-2023-52441 - Use of the Linux kernel vulnerability allows for privileged escalation, which can be used to gain system access."}, {"techniqueID": "T1016", "comment": "CVE-2023-52441 - Network communication sent on a listening port, allowing for information gathering and potential further exploitation."}, {"techniqueID": "T1208", "comment": "CVE-2023-52441 - The vulnerability is caused by a buffer over-read in the Linux kernel, which can lead to code execution."}], "stix_bundle": {"_bundle": {"type": "simplified", "id": "https://example.com/cve-2023-52441.stix", "spec_version": "2.1", "stix_version": "2.1", "objects": [{"id": "https://example.com/cve-2023-52441", "type": "vulnerability", "name": "CVE-2023-52441", "description": "CWE-119", "threat_actor": [], "cve_id": "CVE-2023-52441", "platform": "Linux", "subcategory": "Local", "class": "windows-ipc-rce", "objective": "Privilege Escalation", "tactics": [{"id": "https://example.com/cve-2023-52441/tactic/1", "type": "tactic", "name": "Lateral Movement", "description": "Use the vulnerability to gain privilege escalation and access the system."}], "techniques": [{"id": "https://example.com/cve-2023-52441/technique/1", "type": "technique", "name": "Linux Kernel Exploitation", "description": "Exploitation of the Linux kernel vulnerability allows for remote code execution via sending a crafted SMB2 negotiate request."}, {"id": "https://example.com/cve-2023-52441/technique/2", "type": "technique", "name": "Privilege Escalation", "description": "Use the vulnerability to gain privilege escalation and access the system."}], "courses_of_action": [{"id": "https://example.com/cve-2023-52441/course_of_action/1", "type": "course_of_action", "name": "Apply the patch", "description": "Apply the patch to fix the vulnerability."}]}, {"id": "https://example.com/patch-2023-52441", "type": "indicator", "name": "Patch for CVE-2023-52441", "description": "The patch for CVE-2023-52441", "indicator_types": ["patch"], "valid_from": "2024-03-01T08:00:00.000", "valid_until": "2024-12-31T23:59:59.999", "created_by": "https://example.com/", "revoked": false, "links": [{"id": "https://example.com/patch-2023-52441/relationship/1", "type": "mitigates", "to_id": "https://example.com/cve-2023-52441", "description": "The patch mitigates the vulnerability."}]}]}}, "technical_analysis": {"Introduction": "CVE-2023-52441 is a Linux kernel vulnerability in the ksmbd component, which allows for remote code execution.", "Impact and Scope": "The vulnerability has a CVSS score of 7.8 and is exploitable by sending a crafted SMB2 negotiate request.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to MITRE ATT&CK techniques T1205.005, T1210, T1016, and T1208.", "Technical Details": "The vulnerability is caused by a buffer over-read in the Linux kernel, which can lead to code execution.", "Detection": "Detection can be performed by monitoring network traffic for suspicious SMB2 negotiate requests.", "Mitigation": "Apply the patch to fix the vulnerability.", "Conclusion": "CVE-2023-52441 is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2023-52441 is a Linux kernel vulnerability that can lead to remote code execution and privilege escalation.", "Business Impact": "The vulnerability can allow attackers to gain access to sensitive data and systems, which can have severe business implications.", "Technical Impact": "The vulnerability is exploitable by sending a crafted SMB2 negotiate request, which can lead to code execution and privilege escalation.", "Mitigation Strategies": "Apply the patch to fix the vulnerability.", "Recommendations": "Executives should prioritize patching the vulnerability and implementing detection and incident response strategies.", "Conclusions": "CVE-2023-52441 is a critical vulnerability that requires immediate attention and mitigation."}}