{"id": "CVE-2024-39463", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-25T15:15:14.760", "lastModified": "2024-08-19T21:01:55.557", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\n9p: add missing locking around taking dentry fid list\n\nFix a use-after-free on dentry's d_fsdata fid list when a thread\nlooks up a fid through dentry while another thread unlinks it:\n\nUAF thread:\nrefcount_t: addition on 0; use-after-free.\n p9_fid_get linux/./include/net/9p/client.h:262\n v9fs_fid_find+0x236/0x280 linux/fs/9p/fid.c:129\n v9fs_fid_lookup_with_uid linux/fs/9p/fid.c:181\n v9fs_fid_lookup+0xbf/0xc20 linux/fs/9p/fid.c:314\n v9fs_vfs_getattr_dotl+0xf9/0x360 linux/fs/9p/vfs_inode_dotl.c:400\n vfs_statx+0xdd/0x4d0 linux/fs/stat.c:248\n\nFreed by:\n p9_fid_destroy (inlined)\n p9_client_clunk+0xb0/0xe0 linux/net/9p/client.c:1456\n p9_fid_put linux/./include/net/9p/client.h:278\n v9fs_dentry_release+0xb5/0x140 linux/fs/9p/vfs_dentry.c:55\n v9fs_remove+0x38f/0x620 linux/fs/9p/vfs_inode.c:518\n vfs_unlink+0x29a/0x810 linux/fs/namei.c:4335\n\nThe problem is that d_fsdata was not accessed under d_lock, because\nd_release() normally is only called once the dentry is otherwise no\nlonger accessible but since we also call it explicitly in v9fs_remove\nthat lock is required:\nmove the hlist out of the dentry under lock then unref its fids once\nthey are no longer accessible."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: 9p: agregar bloqueo faltante al tomar la lista de fid de dentry. Se corrigi\u00f3 un use-after-free en la lista de fid d_fsdata de dentry cuando un subproceso busca un fid a trav\u00e9s de dentry mientras otro subproceso lo desvincula: UAF hilo: refcount_t: suma en 0; use-after-free. p9_fid_get linux/./include/net/9p/client.h:262 v9fs_fid_find+0x236/0x280 linux/fs/9p/fid.c:129 v9fs_fid_lookup_with_uid linux/fs/9p/fid.c:181 v9fs_fid_lookup+0xbf/0xc20 Linux /fs/9p/fid.c:314 v9fs_vfs_getattr_dotl+0xf9/0x360 linux/fs/9p/vfs_inode_dotl.c:400 vfs_statx+0xdd/0x4d0 linux/fs/stat.c:248 Liberado por: p9_fid_destroy (en l\u00ednea) desconocido+0xb0 /0xe0 linux/net/9p/client.c:1456 p9_fid_put linux/./include/net/9p/client.h:278 v9fs_dentry_release+0xb5/0x140 linux/fs/9p/vfs_dentry.c:55 v9fs_remove+0x38f/0x620 linux/fs/9p/vfs_inode.c:518 vfs_unlink+0x29a/0x810 linux/fs/namei.c:4335 El problema es que no se accedi\u00f3 a d_fsdata bajo d_lock, porque normalmente d_release() solo se llama una vez que dentry no est\u00e1 disponible. ya no es accesible, pero como tambi\u00e9n lo llamamos expl\u00edcitamente en v9fs_remove, ese bloqueo es necesario: mueva la hlist fuera del dentry bajo bloqueo y luego elimine la referencia de sus fids una vez que ya no sean accesibles."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-416"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.11", "versionEndExcluding": "6.1.94", "matchCriteriaId": "0F1BDCB0-B227-4406-81D0-90429CAF5F99"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2", "versionEndExcluding": "6.6.34", "matchCriteriaId": "6BD9DCFD-0342-4039-B8CE-70F26DB7173B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.9.5", "matchCriteriaId": "8366481F-770F-4850-9D0F-2977BD97D5C5"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.10:rc1:*:*:*:*:*:*", "matchCriteriaId": "2EBB4392-5FA6-4DA9-9772-8F9C750109FA"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/c898afdc15645efb555acb6d85b484eb40a45409", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/cb299cdba09f46f090b843d78ba26b667d50a456", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/f0c5c944c6d8614c19e6e9a97fd2011dcd30e8f5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/fe17ebf22feb4ad7094d597526d558a49aac92b4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-39463 - Memory corruption vulnerability allowing an attacker to execute arbitrary code. This technique is relevant as it allows for system compromise, and can be mitigated by patching the kernel and implementing memory validation checks."}, {"techniqueID": "T1027", "comment": "CVE-2024-39463 - Use-after-free vulnerability allowing an attacker to leak sensitive information. This technique is relevant as it allows for lateral movement and data theft, and can be mitigated by patching the kernel and implementing memory validation checks."}, {"techniqueID": "T1219", "comment": "CVE-2024-39463 - Use-after-free vulnerability allowing an attacker to execute arbitrary code. This technique is relevant as it allows for system compromise, and can be mitigated by patching the kernel and implementing memory validation checks."}, {"techniqueID": "T1499", "comment": "CVE-2024-39463 - Use-after-free vulnerability allowing an attacker to gain elevated privileges. This technique is relevant as it allows for privilege escalation, and can be mitigated by patching the kernel and implementing memory validation checks."}], "stix_bundle": "{\"stix\": [{\"vulnerability\": {\"id\": \"CVE-2024-39463\", \"name\": \"Linux kernel 9p vulnerability\"}, \"mitigation\": [{\"description\": \"Patch the kernel and implement memory validation checks\"}], \"references\": [{\"source\": \"CVE-2024-39463\", \"tags\": [\"Patch\"]}, {\"source\": \"Git kernel\", \"tags\": [\"Patch\"]}], \"tactics\": [{\"id\": \"defense-evasion\", \"name\": \"Defense Evasion\"}, {\"id\": \"persistance\", \"name\": \"Persistence\"},{\"id\": \"privilege-escalation\", \"name\": \"Privilege Escalation\"}], \"relationships\": [{\"object\": \"vulnerability\",\"subject\": \"mitigation\",\"relationship\": \"mitigates\"},{\"object\": \"mitigation\",\"subject\": \"defense-evasion\",\"relationship\": \"used-by\"},{\"object\": \"mitigation\",\"subject\": \"persistance\",\"relationship\": \"used-by\"},{\"object\": \"mitigation\",\"subject\": \"privilege-escalation\",\"relationship\": \"used-by\"}]}}", "technical_analysis": {"Introduction": "The CVE-2024-39463 vulnerability is a use-after-free vulnerability in the Linux kernel's 9p file system.", "Impact and Scope": "The CVE-2024-39463 vulnerability has a CVSS score of 7.8, with a remote attack vector and high privileges required.", "Related MITRE ATT&CK Techniques": "T1190, T1027, T1219, and T1499 are related to this vulnerability.", "Technical Details": "The vulnerability is caused by a use-after-free bug in the 9p file system's fid list handling.", "Detection": "Detection of this vulnerability is difficult, as the use-after-free bug may not trigger immediately.", "Mitigation": "Patching the kernel and implementing memory validation checks can mitigate this vulnerability.", "Conclusion": "The CVE-2024-39463 vulnerability is a critical issue that requires immediate attention."}, "executive_analysis": {"Overview": "The CVE-2024-39463 vulnerability is a critical Linux kernel vulnerability that requires immediate attention.", "Business Impact": "This vulnerability has the potential to compromise sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability can be exploited by an attacker to execute arbitrary code, gain elevated privileges, and persist on the system.", "Mitigation Strategies": "Implementing patching and memory validation checks can mitigate this vulnerability.", "Recommendations": "Executive management should prioritize this vulnerability and ensure that patching and memory validation checks are implemented promptly.", "Conclusions": "The CVE-2024-39463 vulnerability is a critical issue that requires immediate attention and prompt mitigation."}}