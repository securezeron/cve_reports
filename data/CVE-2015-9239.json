{"id": "CVE-2015-9239", "sourceIdentifier": "support@hackerone.com", "published": "2018-05-31T20:29:00.457", "lastModified": "2019-10-09T23:15:58.133", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "ansi2html is vulnerable to regular expression denial of service (ReDoS) when certain types of user input is passed in."}, {"lang": "es", "value": "ansi2html es vulnerable a una denegaci\u00f3n de servicio con expresiones regulares (ReDoS) cuando se pasan ciertos tipos de entradas de usuario."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}, {"source": "support@hackerone.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-400"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ansi2html_project:ansi2html:0.0.1:*:*:*:*:node.js:*:*", "matchCriteriaId": "FE14CF87-2DBE-4CAA-A835-D9EBD8E90A76"}]}]}], "references": [{"url": "https://nodesecurity.io/advisories/51", "source": "support@hackerone.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0034: File and Directory Discovery", "comment": "CVE-2015-9239 - ansi2html is vulnerable to regular expression denial of service (ReDoS) when certain types of user input is passed in. This technique can be used for reconnaissance before exploitation."}, {"techniqueID": "TA0008: Powered Shell", "comment": "CVE-2015-9239 - Once exploited, this vulnerability can grant an attacker a persistent command-line interface on the compromised system, allowing them to execute system-level commands and maintain control over the system."}, {"techniqueID": "TA0011: Brute Force", "comment": "CVE-2015-9239 - A brute force attack could be launched against the ansi2html application to find a valid user input that triggers the ReDoS vulnerability."}, {"techniqueID": "TA0046: Execution via Hijacked Process", "comment": "CVE-2015-9239 - An attacker could potentially exploit this vulnerability to execute arbitrary code as the ansi2html process, potentially granting them system-level privileges."}], "technical_analysis": {"Introduction": "ansi2html is a utility that converts ANSI-formatted text to HTML. It is vulnerable to a regular expression denial of service (ReDoS) attack, which can be triggered by certain types of user input. This vulnerability allows an attacker to consume excessive CPU resources on the system, causing a denial of service.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H) and can be exploited remotely. The attack vector is via the ansi2html utility and the vulnerability can be triggered by exploiting the ReDoS vulnerability.", "Related MITRE ATT&CK Techniques": "TA0034: File and Directory Discovery, TA0008: Powered Shell, TA0011: Brute Force, TA0046: Execution via Hijacked Process", "Technical Details": "The vulnerability occurs when the ansi2html utility is processing certain types of user input, which triggers a regular expression loop that consumes excessive CPU resources. This can cause a denial of service and make the system unavailable.", "Detection": "Detection is possible through monitoring for high CPU utilization and unusual system behavior. Network traffic analysis can also help detect reconnaissance activities preceding exploitation.", "Mitigation": "Mitigations include configuring the ansi2html utility to restrict user input, implementing rate limiting and IP blocking to prevent brute force attacks, and monitoring for unusual system behavior. Running the ansi2html utility on a sandboxed or isolated environment can also help prevent exploitation.", "Conclusion": "Preventing exploitation of this vulnerability requires a combination of technical mitigations, threat intelligence, and incident response planning."}, "executive_analysis": {"Overview": "ansi2html is a utility that is vulnerable to a ReDoS attack, which can cause a denial of service and make the system unavailable.", "Business Impact": "The business impact of this vulnerability includes data loss and system downtime, which can result in financial losses and damage to reputation.", "Technical Impact": "The technical impact of this vulnerability is that an attacker can consume excessive CPU resources and make the system unavailable.", "Mitigation Strategies": "To mitigate this vulnerability, implement rate limiting and IP blocking, restrict user input, and monitor for unusual system behavior.", "Recommendations": "Recommendations include re-evaluating the use of ansi2html and implementing alternative solutions, reviewing incident response plans, and conducting regular security testing and vulnerability assessments.", "Conclusions": "Executive-level awareness of this vulnerability is crucial to drive remediation actions and prevent exploitation."}}