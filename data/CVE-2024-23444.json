{"id": "CVE-2024-23444", "sourceIdentifier": "bressers@elastic.co", "published": "2024-07-31T18:15:11.983", "lastModified": "2024-08-01T12:42:36.933", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "It was discovered by Elastic engineering that when elasticsearch-certutil CLI tool is used with the csr option in order to create a new Certificate Signing Requests, the associated private key that is generated is stored on disk unencrypted even if the --pass parameter is passed in the command invocation."}, {"lang": "es", "value": " La ingenier\u00eda de Elastic descubri\u00f3 que cuando se utiliza la herramienta CLI elasticsearch-certutil con la opci\u00f3n csr para crear nuevas solicitudes de firma de certificado, la clave privada asociada que se genera se almacena en el disco sin cifrar incluso si se pasa el par\u00e1metro --pass en la invocaci\u00f3n del comando."}], "metrics": {"cvssMetricV31": [{"source": "bressers@elastic.co", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.6}]}, "weaknesses": [{"source": "bressers@elastic.co", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-311"}]}], "references": [{"url": "https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-23-security-update-esa-2024-12/364157", "source": "bressers@elastic.co"}], "techniques": [{"techniqueID": "T1134", "comment": "CVE-2024-23444 - An attacker could potentially obtain sensitive information by exploiting the lack of encryption for private keys generated by the elasticsearch-certutil CLI tool."}, {"techniqueID": "T1486", "comment": "CVE-2024-23444 - An attacker could potentially use the private key generated by the elasticsearch-certutil CLI tool to authenticate to the target system or decrypt stored sensitive information."}, {"techniqueID": "T1555", "comment": "CVE-2024-23444 - An attacker could potentially use the generated private key to perform cryptographic attacks such as decrypting stored sensitive information or authenticating to the target system."}, {"techniqueID": "T1199", "comment": "CVE-2024-23444 - An attacker could potentially exfiltrate sensitive information such as private keys generated by the elasticsearch-certutil CLI tool."}], "stix_bundle": "This STIX 2.1 bundle outlines the vulnerability as a threat actor capability and its potential impact on the target system. It also includes various related techniques, risks, and defense strategies to mitigate the vulnerability.\n{\n  \"objects\": [\n    {\n      \"id\": \"vulnerability:1\",\n      \"type\": \"vulnerability\",\n      \"description\": \"CVE-2024-23444\",\n      \"published\": \"2024-07-31T18:15:11.983\",\n      \"lastModified\": \"2024-08-01T12:42:36.933\",\n      \"vulnStatus\": \"Awaiting Analysis\",\n      \"cveTags\": [],\n      \"descriptions\": [{\n        \"lang\": \"en\",\n        \"value\": \"It was discovered by Elastic engineering that when elasticsearch-certutil CLI tool is used with the csr option in order to create a new Certificate Signing Requests, the associated private key that is generated is stored on disk unencrypted even if the --pass parameter is passed in the command invocation.\"\n      }],\n      \"metrics\": {\n        \"cvssMetricV31\": [{\n          \"source\": \"bressers@elastic.co\",\n          \"type\": \"Secondary\",\n          \"cvssData\": {\n            \"version\": \"3.1\",\n            \"vectorString\": \"CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N\",\n            \"attackVector\": \"NETWORK\",\n            \"attackComplexity\": \"LOW\",\n            \"privilegesRequired\": \"HIGH\",\n            \"userInteraction\": \"NONE\",\n            \"scope\": \"UNCHANGED\",\n            \"confidentialityImpact\": \"HIGH\",\n            \"integrityImpact\": \"NONE\",\n            \"availabilityImpact\": \"NONE\",\n            \"baseScore\": 4.9,\n            \"baseSeverity\": \"MEDIUM\"\n          },\n          \"exploitabilityScore\": 1.2,\n          \"impactScore\": 3.6\n        }],\n        \"weaknesses\": [{\n          \"source\": \"bressers@elastic.co\",\n          \"type\": \"Secondary\",\n          \"description\": [{\n            \"lang\": \"en\",\n            \"value\": \"CWE-311\"\n          }]\n        }]\n      },\n      \"references\": [{\n        \"url\": \"https://discuss.elastic.co/t/elasticsearch-8-13-0-7-17-23-security-update-esa-2024-12/364157\",\n        \"source\": \"bressers@elastic.co\"\n      }]\n    },\n    {\n      \"id\": \"capability:1\",\n      \"type\": \"capability\",\n      \"name\": \"Elasticsearch Private Key Generation\",\n      \"description\": \"The Elasticsearch private key generation capability allows attackers to generate private keys for Certificate Signing Requests without encryption.\",\n      \"related_vulnerabilities\": [{\n        \"id\": \"vulnerability:1\",\n        \"relationship\": \"uses\",\n        \"role\": \"target\"\n      }]\n    },\n    {\n      \"id\": \"mitigation:1\",\n      \"type\": \"mitigation\",\n      \"name\": \"Encryption of Private Keys\",\n      \"description\": \"To prevent unauthorized access to sensitive information, it is recommended to encrypt private keys generated by the Elasticsearch-certutil CLI tool.\",\n      \"related_techniques\": [{\n        \"id\": \"T1134\",\n        \"relationship\": \"mitigated_by\",\n        \"role\": \"technique\"\n      }]\n    }\n  ],\n  \"links\": [\n    {\n      \"id\": \"uses\",\n      \"source\": \"capability:1\",\n      \"target\": \"vulnerability:1\"\n    },\n    {\n      \"id\": \"mitigated_by\",\n      \"source\": \"mitigation:1\",\n      \"target\": \"T1134\"\n    }\n  ]\n}", "technical_analysis": {"Introduction": "CVE-2024-23444 is a vulnerability in the Elasticsearch-certutil CLI tool that could allow attackers to obtain sensitive information by exploiting the lack of encryption for private keys generated by the tool.", "Impact and Scope": "The vulnerability has a CVSS score of 4.9 with a version of 3.1 and an attack vector of NETWORK. It affects the confidentiality and integrity of sensitive information.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1134, T1486, T1555, and T1199.", "Technical Details": "The vulnerability is caused by the lack of encryption for private keys generated by the Elasticsearch-certutil CLI tool. This allows attackers to obtain sensitive information such as private keys.", "Detection": "Detection methods for the vulnerability include monitoring for unusual file system activity and monitoring for suspicious network traffic.", "Mitigation": "Mitigation strategies for the vulnerability include encrypting private keys generated by the Elasticsearch-certutil CLI tool and implementing strict access controls for sensitive information.", "Conclusion": "In conclusion, CVE-2024-23444 is a vulnerability in the Elasticsearch-certutil CLI tool that could allow attackers to obtain sensitive information by exploiting the lack of encryption for private keys generated by the tool."}, "executive_analysis": {"Overview": "The vulnerability is a significant risk to sensitive information, and it is essential to implement mitigation strategies to prevent attackers from exploiting it.", "Business Impact": "The vulnerability could have a significant impact on the business if sensitive information is compromised.", "Technical Impact": "The vulnerability affects the confidentiality and integrity of sensitive information, making it a significant technical risk.", "Mitigation Strategies": "Mitigation strategies include encrypting private keys and implementing strict access controls.", "Recommendations": "Recommendations for executives include implementing mitigation strategies and monitoring for unusual activity.", "Conclusions": "In conclusion, the vulnerability is a significant risk, and it is essential to implement mitigation strategies to prevent attackers from exploiting it."}}