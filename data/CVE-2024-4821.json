{"id": "CVE-2024-4821", "sourceIdentifier": "security@wordfence.com", "published": "2024-06-05T09:15:10.260", "lastModified": "2024-06-11T17:29:33.213", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The WP Shortcodes Plugin \u2014 Shortcodes Ultimate plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's su_lightbox shortcode in all versions up to, and including, 7.1.6 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page."}, {"lang": "es", "value": "El complemento WP Shortcodes Plugin \u2014 Shortcodes Ultimate para WordPress es vulnerable a Cross-Site Scripting Almacenado a trav\u00e9s del c\u00f3digo abreviado su_lightbox del complemento en todas las versiones hasta la 7.1.6 incluida debido a una sanitizaci\u00f3n de entrada insuficiente y a un escape de salida en los atributos proporcionados por el usuario. Esto hace posible que atacantes autenticados, con acceso de nivel de colaborador y superior, inyecten scripts web arbitrarios en p\u00e1ginas que se ejecutar\u00e1n cada vez que un usuario acceda a una p\u00e1gina inyectada."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.1, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:getshortcodes:shortcodes_ultimate:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "7.1.7", "matchCriteriaId": "B0C7F17C-E820-45D4-8452-F92863C6C556"}]}]}], "references": [{"url": "https://plugins.trac.wordpress.org/browser/shortcodes-ultimate/tags/7.1.5/includes/shortcodes/lightbox.php#L71", "source": "security@wordfence.com", "tags": ["Product"]}, {"url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=3096024%40shortcodes-ultimate%2Ftrunk&old=3084162%40shortcodes-ultimate%2Ftrunk&sfp_email=&sfph_mail=#file1", "source": "security@wordfence.com", "tags": ["Patch"]}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/ec7649da-5358-4fe2-8706-b945bba02c93?source=cve", "source": "security@wordfence.com", "tags": ["Broken Link"]}], "techniques": [{"techniqueID": "T1192", "comment": "CVE-2024-4821 - Stored Cross-Site Scripting via su_lightbox shortcode, feasible for authenticated attackers to inject arbitrary web scripts. Defense: Validate and sanitize user-supplied input for su_lightbox shortcode attributes."}, {"techniqueID": "T1215", "comment": "CVE-2024-4821 - Insufficient input sanitization and output escaping in WordPress's su_lightbox shortcode allows for Stored Cross-Site Scripting (XSS). Defense: Conduct regular web application security testing and patch management to prevent XSS attacks."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/CVE-2024-4821.stix", "created_by_ref": "https://example.com/analyst", "created": "2024-06-20T14:30:00.000Z", "modified": "2024-06-20T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "https://example.com/CVE-2024-4821", "name": "CVE-2024-4821: Stored Cross-Site Scripting in WordPress's su_lightbox shortcode", "description": "The su_lightbox shortcode in WordPress's Shortcodes Ultimate plugin is vulnerable to Stored Cross-Site Scripting attacks due to insufficient input sanitization and output escaping.", "cve": "CVE-2024-4821", "cvss": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "references": [{"type": "indicator", "id": "https://example.com/indicator-1", "name": "Indication of attack"}]}, {"type": "indicator", "id": "https://example.com/indicator-1", "name": "Indication of attack", "description": "The presence of malicious JavaScript code injected into the document via the su_lightbox shortcode.", "pattern": "String 'javascript:function_name()"}, {"type": "course_of_action", "id": "https://example.com/Course-1", "name": "Mitigate CWE-79", "description": "Apply patches and updates to fix the vulnerability. Validate and sanitize user-supplied input for su_lightbox shortcode attributes."}], "relationships": [{"type": "has_vulnerability", "id": "https://example.com/CVE-2024-4821/has-vulnerability-1", "created_by_ref": "https://example.com/analyst", "created": "2024-06-20T14:30:00.000Z", "modified": "2024-06-20T14:30:00.000Z", "from": "https://example.com/CVE-2024-4821", "to": "https://example.com/indicator-1"}, {"type": "mitigated_by", "id": "https://example.com/CVE-2024-4821/mitigated-by-1", "created_by_ref": "https://example.com/analyst", "created": "2024-06-20T14:30:00.000Z", "modified": "2024-06-20T14:30:00.000Z", "from": "https://example.com/CVE-2024-4821", "to": "https://example.com/Course-1"}]}, "technical_analysis": {"Introduction": "The CVE-2024-4821 vulnerability is a stored cross-site scripting (XSS) vulnerability in the su_lightbox shortcode of WordPress's Shortcodes Ultimate plugin, which allows authenticated attackers to inject arbitrary web scripts.", "Impact and Scope": "The vulnerability affects all versions of Shortcodes Ultimate plugin up to and including 7.1.6, making it vulnerable to Stored Cross-Site Scripting attacks.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK Techniques T1192 and T1215.", "Technical Details": "The vulnerability is caused by insufficient input sanitization and output escaping in the su_lightbox shortcode.", "Detection": "Detection methods include searching for malicious JavaScript code injected into the document via the su_lightbox shortcode.", "Mitigation": "Mitigation strategies include applying patches and updates to fix the vulnerability, and validating and sanitizing user-supplied input for su_lightbox shortcode attributes.", "Conclusion": "In conclusion, the CVE-2024-4821 vulnerability is a significant security risk that requires prompt attention and mitigation measures."}, "executive_analysis": {"Overview": "The CVE-2024-4821 vulnerability is a significant security risk that affects the Shortcodes Ultimate plugin in WordPress, allowing authenticated attackers to inject arbitrary web scripts.", "Business Impact": "The vulnerability has the potential to impact business operations and reputation, enabling attackers to inject malicious code and manipulate user data.", "Technical Impact": "The vulnerability has significant technical implications, allowing attackers to inject arbitrary web scripts and potentially leading to data breaches and unauthorized access.", "Mitigation Strategies": "Key mitigation strategies include applying patches and updates, validating and sanitizing user-supplied input, and conducting regular web application security testing.", "Recommendations": "Recommendations for executives include prioritizing security and implementing robust security measures to prevent attacks.", "Conclusions": "In conclusion, it is essential to prioritize security and take immediate action to mitigate the CVE-2024-4821 vulnerability to prevent attacks and protect business operations."}}