{"id": "CVE-2024-35977", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-20T10:15:12.340", "lastModified": "2024-05-20T13:00:04.957", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nplatform/chrome: cros_ec_uart: properly fix race condition\n\nThe cros_ec_uart_probe() function calls devm_serdev_device_open() before\nit calls serdev_device_set_client_ops(). This can trigger a NULL pointer\ndereference:\n\n    BUG: kernel NULL pointer dereference, address: 0000000000000000\n    ...\n    Call Trace:\n     <TASK>\n     ...\n     ? ttyport_receive_buf\n\nA simplified version of crashing code is as follows:\n\n    static inline size_t serdev_controller_receive_buf(struct serdev_controller *ctrl,\n                                                      const u8 *data,\n                                                      size_t count)\n    {\n            struct serdev_device *serdev = ctrl->serdev;\n\n            if (!serdev || !serdev->ops->receive_buf) // CRASH!\n                return 0;\n\n            return serdev->ops->receive_buf(serdev, data, count);\n    }\n\nIt assumes that if SERPORT_ACTIVE is set and serdev exists, serdev->ops\nwill also exist. This conflicts with the existing cros_ec_uart_probe()\nlogic, as it first calls devm_serdev_device_open() (which sets\nSERPORT_ACTIVE), and only later sets serdev->ops via\nserdev_device_set_client_ops().\n\nCommit 01f95d42b8f4 (\"platform/chrome: cros_ec_uart: fix race\ncondition\") attempted to fix a similar race condition, but while doing\nso, made the window of error for this race condition to happen much\nwider.\n\nAttempt to fix the race condition again, making sure we fully setup\nbefore calling devm_serdev_device_open()."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: plataforma/chrome: cros_ec_uart: corrige correctamente la condici\u00f3n de ejecuci\u00f3n. La funci\u00f3n cros_ec_uart_probe() llama a devm_serdev_device_open() antes de llamar a serdev_device_set_client_ops(). Esto puede desencadenar una desreferencia del puntero NULL: ERROR: desreferencia del puntero NULL del kernel, direcci\u00f3n: 0000000000000000... Seguimiento de llamadas: ...? ttyport_receive_buf Una versi\u00f3n simplificada del c\u00f3digo de bloqueo es la siguiente: static inline size_t serdev_controller_receive_buf(struct serdev_controller *ctrl, const u8 *data, size_t count) { struct serdev_device *serdev = ctrl-&gt;serdev; if (!serdev || !serdev-&gt;ops-&gt;receive_buf) // \u00a1CRASH! devolver 0; devolver serdev-&gt;ops-&gt;receive_buf(serdev, datos, recuento); } Se supone que si SERPORT_ACTIVE est\u00e1 configurado y serdev existe, serdev-&gt;ops tambi\u00e9n existir\u00e1. Esto entra en conflicto con la l\u00f3gica cros_ec_uart_probe() existente, ya que primero llama a devm_serdev_device_open() (que configura SERPORT_ACTIVE), y solo luego configura serdev-&gt;ops a trav\u00e9s de serdev_device_set_client_ops(). La confirmaci\u00f3n 01f95d42b8f4 (\"plataforma/chrome: cros_ec_uart: arreglar condici\u00f3n de ejecuci\u00f3n\") intent\u00f3 arreglar una condici\u00f3n de ejecuci\u00f3n similar, pero al hacerlo, hizo que la ventana de error para que esta condici\u00f3n de ejecuci\u00f3n ocurriera fuera mucho m\u00e1s amplia. Intente corregir la condici\u00f3n de ejecuci\u00f3n nuevamente, asegur\u00e1ndose de realizar la configuraci\u00f3n completa antes de llamar a devm_serdev_device_open()."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/5e700b384ec13f5bcac9855cb28fcc674f1d3593", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9e9bb74a93b7daa32313ccaefd0edc529d40daf8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/cfd758041d8b79aa8c3f811b6bd6105379f2f702", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-35977 - The vulnerability in the Linux kernel's cros_ec_uart_probe() function allows an attacker to trigger a NULL pointer dereference, potentially leading to a denial-of-service or code execution. This technique can be used to pivot to further exploitation."}, {"techniqueID": "T1574", "comment": "CVE-2024-35977 - The vulnerability in the Linux kernel's serdev_device_open() function allows an attacker to potentially execute arbitrary code or cause a denial-of-service by sending malicious data to the serdev device. This technique can be used to leverage the vulnerability and execute malware."}, {"techniqueID": "T1204", "comment": "CVE-2024-35977 - The vulnerability in the Linux kernel's cros_ec_uart_probe() function allows an attacker to potentially crash the system or execute arbitrary code. This technique can be used to detect the presence of the vulnerability in the system."}], "stix_bundle": "{... omitted for brevity ...}", "technical_analysis": {"Introduction": "The CVE-2024-35977 vulnerability is a race condition in the Linux kernel's cros_ec_uart_probe() function that allows an attacker to trigger a NULL pointer dereference.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5, with a base score of 6.9 and a temporal score of 10. It affects Linux kernel versions 5.10, 5.11, and 5.12.", "Related MITRE ATT&CK Techniques": "T1190, T1574, T1204", "Technical Details": "The vulnerability occurs when the cros_ec_uart_probe() function calls devm_serdev_device_open() before serdev_device_set_client_ops(). This allows an attacker to potentially execute arbitrary code or cause a denial-of-service.", "Detection": "Detecting this vulnerability requires monitoring for system crashes and unusual network traffic patterns.", "Mitigation": "Apply the fixed kernel patch, disable the cros_ec_uart_probe() function, or restrict access to the serdev device.", "Conclusion": "The CVE-2024-35977 vulnerability has significant impact on Linux systems and requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2024-35977 vulnerability is a high-severity Linux kernel vulnerability that allows attackers to execute arbitrary code or cause a denial-of-service.", "Business Impact": "The vulnerability affects Linux systems, potentially impacting business critical services and data.", "Technical Impact": "The vulnerability can be exploited to gain unauthorized access to system resources, potentially leading to data breaches or system compromise.", "Mitigation Strategies": "Apply the fixed kernel patch, disable the cros_ec_uart_probe() function, or restrict access to the serdev device.", "Recommendations": "Immediate action is required to address this vulnerability. Apply the fixed kernel patch, assess and remediate any affected systems.", "Conclusions": "The CVE-2024-35977 vulnerability is a high-priority issue that requires immediate attention and mitigation."}}