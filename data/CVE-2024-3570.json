{"id": "CVE-2024-3570", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-10T17:15:58.543", "lastModified": "2024-04-10T19:49:51.183", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A stored Cross-Site Scripting (XSS) vulnerability exists in the chat functionality of the mintplex-labs/anything-llm repository, allowing attackers to execute arbitrary JavaScript in the context of a user's session. By manipulating the ChatBot responses, an attacker can inject malicious scripts to perform actions on behalf of the user, such as creating a new admin account or changing the user's password, leading to a complete takeover of the AnythingLLM application. The vulnerability stems from the improper sanitization of user and ChatBot input, specifically through the use of `dangerouslySetInnerHTML`. Successful exploitation requires convincing an admin to add a malicious LocalAI ChatBot to their AnythingLLM instance."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:L/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 0.0, "baseSeverity": "NONE"}, "exploitabilityScore": 0.3, "impactScore": 0.0}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "references": [{"url": "https://github.com/mintplex-labs/anything-llm/commit/a4ace56a401ffc8ce0082d7444159dfd5dc28834", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/f0eaf552-aaf3-42b6-a5df-cfecd2de15ee", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-3570 - This Stored XSS vulnerability can be exploited by attackers to execute arbitrary JavaScript in the context of a user's session, allowing for a complete takeover of the AnythingLLM application."}, {"techniqueID": "T1505", "comment": "CVE-2024-3570 - An attacker can inject malicious scripts to perform actions on behalf of the user, such as creating a new admin account or changing the user's password, by manipulating the ChatBot responses."}, {"techniqueID": "T1534", "comment": "CVE-2024-3570 - The vulnerability stems from the improper sanitization of user and ChatBot input, specifically through the use of `dangerouslySetInnerHTML`, making it vulnerable to Stored XSS attacks."}, {"techniqueID": "T1199", "comment": "CVE-2024-3570 - An admin's interaction with the ChatBot, such as adding a malicious LocalAI ChatBot, is required for successful exploitation of this vulnerability."}], "stix_bundle": {"objects": {"vulnerability": {"id": "CVE-2024-3570", "name": "AnythignLLM ChatBot Stored XSS vulnerable", "description": "A stored Cross-Site Scripting (XSS) vulnerability exists in the chat functionality of the mintplex-labs/anything-llm repository, allowing attackers to execute arbitrary JavaScript in the context of a user's session.", "references": [{"url": "https://github.com/mintplex-labs/anything-llm/commit/a4ace56a401ffc8ce0082d7444159dfd5dc28834", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/f0eaf552-aaf3-42b6-a5df-cfecd2de15ee", "source": "security@huntr.dev"}]}, "course_of_action": {"id": "COA-2024-3570-2", "name": "Prevent Admin Interaction with Malicious ChatBots", "description": "Implement protection mechanisms to prevent admins from interacting with malicious ChatBots.", "related_technique": "T1199"}}, "relationships": {"vulnerability": [{"source_id": "CVE-2024-3570", "target_id": "COA-2024-3570-1", "relationship_type": "mitigated_by"}, {"source_id": "CVE-2024-3570", "target_id": "COA-2024-3570-2", "relationship_type": "mitigated_by"}]}}, "technical_analysis": {"Introduction": "The AnythingLLM application is vulnerable to a stored Cross-Site Scripting (XSS) attack due to the improper sanitization of user and ChatBot input.", "Impact and Scope": "The vulnerability allows attackers to execute arbitrary JavaScript in the context of a user's session, enabling them to perform actions such as creating a new admin account or changing the user's password.", "Related MITRE ATT&CK Techniques": "T1190, T1505, T1534, T1199", "Technical Details": "The vulnerability occurs due to the use of `dangerouslySetInnerHTML` in the ChatBot responses, which allows attackers to inject malicious scripts", "Detection": "Detecting this vulnerability requires monitoring for suspicious JavaScript execution or unusual user behavior", "Mitigation": "Implement proper sanitization of user and ChatBot input, and prevent admins from interacting with malicious ChatBots", "Conclusion": "The AnythingLLM application is vulnerable to a stored XSS attack, and immediate mitigation measures should be taken to prevent exploitation"}, "executive_analysis": {"Overview": "The AnythingLLM application has a stored XSS vulnerability that can be exploited to take over the application.", "Business Impact": "The vulnerability can lead to unauthorized account creation and password changes, potentially causing significant business disruption.", "Technical Impact": "The vulnerability can be exploited to execute arbitrary JavaScript, enabling attackers to perform a wide range of malicious actions.", "Mitigation Strategies": "Implement proper sanitization of user and ChatBot input and prevent admins from interacting with malicious ChatBots.", "Recommendations": "Review and update existing security controls to prevent this vulnerability from being exploited.", "Conclusions": "Immediate action is required to mitigate this vulnerability and prevent potential business disruption."}}