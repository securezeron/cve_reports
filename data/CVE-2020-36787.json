{"id": "CVE-2020-36787", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-02-28T09:15:37.030", "lastModified": "2024-02-28T14:06:45.783", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: aspeed: fix clock handling logic\n\nVideo engine uses eclk and vclk for its clock sources and its reset\ncontrol is coupled with eclk so the current clock enabling sequence works\nlike below.\n\n Enable eclk\n De-assert Video Engine reset\n 10ms delay\n Enable vclk\n\nIt introduces improper reset on the Video Engine hardware and eventually\nthe hardware generates unexpected DMA memory transfers that can corrupt\nmemory region in random and sporadic patterns. This issue is observed\nvery rarely on some specific AST2500 SoCs but it causes a critical\nkernel panic with making a various shape of signature so it's extremely\nhard to debug. Moreover, the issue is observed even when the video\nengine is not actively used because udevd turns on the video engine\nhardware for a short time to make a query in every boot.\n\nTo fix this issue, this commit changes the clock handling logic to make\nthe reset de-assertion triggered after enabling both eclk and vclk. Also,\nit adds clk_unprepare call for a case when probe fails.\n\nclk: ast2600: fix reset settings for eclk and vclk\nVideo engine reset setting should be coupled with eclk to match it\nwith the setting for previous Aspeed SoCs which is defined in\nclk-aspeed.c since all Aspeed SoCs are sharing a single video engine\ndriver. Also, reset bit 6 is defined as 'Video Engine' reset in\ndatasheet so it should be de-asserted when eclk is enabled. This\ncommit fixes the setting."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: medios: aspeed: corrige la l\u00f3gica de manejo del reloj El motor de video usa eclk y vclk para sus fuentes de reloj y su control de reinicio est\u00e1 acoplado con eclk para que la secuencia de habilitaci\u00f3n del reloj actual funcione como se muestra a continuaci\u00f3n. Habilitar eclk De-assert Video Engine restablece un retraso de 10 ms Habilitar vclk Introduce un reinicio incorrecto en el hardware de Video Engine y eventualmente el hardware genera transferencias de memoria DMA inesperadas que pueden da\u00f1ar la regi\u00f3n de la memoria en patrones aleatorios y espor\u00e1dicos. Este problema se observa muy raramente en algunos SoC AST2500 espec\u00edficos, pero provoca un p\u00e1nico cr\u00edtico en el kernel al crear varias formas de firma, por lo que es extremadamente dif\u00edcil de depurar. Adem\u00e1s, el problema se observa incluso cuando el motor de v\u00eddeo no se utiliza activamente porque udevd enciende el hardware del motor de v\u00eddeo durante un breve periodo de tiempo para realizar una consulta en cada arranque. Para solucionar este problema, esta confirmaci\u00f3n cambia la l\u00f3gica de manejo del reloj para activar la anulaci\u00f3n de reinicio despu\u00e9s de habilitar tanto eclk como vclk. Adem\u00e1s, agrega la llamada clk_unprepare para un caso en el que falla la sonda. clk: ast2600: corrige la configuraci\u00f3n de restablecimiento para eclk y vclk La configuraci\u00f3n de restablecimiento del motor de video debe combinarse con eclk para que coincida con la configuraci\u00f3n de los SoC Aspeed anteriores que se define en clk-aspeed.c, ya que todos los SoC Aspeed comparten un \u00fanico controlador de motor de video. Adem\u00e1s, el bit de reinicio 6 se define como reinicio del 'Motor de video' en la hoja de datos, por lo que debe desactivarse cuando eclk est\u00e1 habilitado. Este commit corrige la configuraci\u00f3n."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/1dc1d30ac101bb8335d9852de2107af60c2580e7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/2964c37563e86cfdc439f217eb3c5a69adfdba6a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/3536169f8531c2c5b153921dc7d1ac9fd570cda7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/75321dc8aebe3f30eff226028fe6da340fe0bf02", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/a59d01384c80a8a4392665802df57c3df20055f5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1044: Software Environment Manipulation", "comment": "CVE-2020-36787 - The vulnerability allows an attacker to manipulate the software environment, potentially leading to arbitrary code execution."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "CVE-2020-36787 - The vulnerability is present in a public-facing application, making it an attractive target for attackers."}, {"techniqueID": "T1082: Application Layer Protocol", "comment": "CVE-2020-36787 - The vulnerability involves an improper reset on the Video Engine hardware, which could allow an attacker to exploit it."}, {"techniqueID": "T1534: Create or Modify System Process", "comment": "CVE-2020-36787 - An attacker could potentially create or modify system processes to exploit the vulnerability."}], "stix_bundle": {"bundleId": "CVE-2020-36787-Bundle", "description": "This STIX bundle provides a comprehensive overview of the CVE-2020-36787 vulnerability, including related techniques, risks, and defense strategies.", "objects": [{"Object": {"id": "https://example.com/CVE-2020-36787", "type": "vulnerability", "description": "CVE-2020-36787: Improper reset on Video Engine hardware", "published": "2024-02-28T09:15:37.030", "lastModified": "2024-02-28T14:06:45.783"}, "Relationships": [{"relationshipType": "related_to", "related_to": {"id": "https://example.com/T1044", "type": "technique"}}, {"relationshipType": "related_to", "related_to": {"id": "https://example.com/T1190", "type": "technique"}}, {"relationshipType": "related_to", "related_to": {"id": "https://example.com/T1082", "type": "technique"}}, {"relationshipType": "related_to", "related_to": {"id": "https://example.com/T1534", "type": "technique"}}]}, {"Object": {"id": "https://example.com/T1044", "type": "technique", "description": "T1044: Software Environment Manipulation", " tactic": "initial_access", "mitigation": "Typically, this technique is mitigated through proper configuration and patching of software environment."}, "Relationships": [{"relationshipType": "uses", "uses": {"id": "https://example.com/CVE-2020-36787", "type": "vulnerability"}}]}, {"Object": {"id": "https://example.com/T1190", "type": "technique", "description": "T1190: Exploit Public-Facing Application", " tactic": "initial_access", "mitigation": "Typically, this technique is mitigated through proper patching and security hardening of public-facing applications."}, "Relationships": [{"relationshipType": "uses", "uses": {"id": "https://example.com/CVE-2020-36787", "type": "vulnerability"}}]}, {"Object": {"id": "https://example.com/T1082", "type": "technique", "description": "T1082: Application Layer Protocol", " tactic": "execution", "mitigation": "Typically, this technique is mitigated through proper configuration and patching of application layer protocols."}, "Relationships": [{"relationshipType": "uses", "uses": {"id": "https://example.com/CVE-2020-36787", "type": "vulnerability"}}]}, {"Object": {"id": "https://example.com/T1534", "type": "technique", "description": "T1534: Create or Modify System Process", " tactic": "execution", "mitigation": "Typically, this technique is mitigated through proper configuration and patching of system processes."}, "Relationships": [{"relationshipType": "uses", "uses": {"id": "https://example.com/CVE-2020-36787", "type": "vulnerability"}}]}]}, "technical_analysis": {"Introduction": "The CVE-2020-36787 vulnerability is an improperly reset on the Video Engine hardware, which could allow an attacker to exploit it.", "Impact and Scope": "The vulnerability has a high impact, with potential for arbitrary code execution, and a scope that includes public-facing applications.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the T1044, T1190, T1082, and T1534 techniques.", "Technical Details": "The vulnerability occurs when the Video Engine hardware is improperly reset, leading to arbitrary code execution.", "Detection": "Detection methods include monitoring for suspicious system process activity and application layer protocol anomalies.", "Mitigation": "Mitigation strategies include proper configuration and patching of software environment, public-facing applications, application layer protocols, and system processes.", "Conclusion": "In conclusion, the CVE-2020-36787 vulnerability is a significant threat that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The CVE-2020-36787 vulnerability poses a significant threat to public-facing applications, and immediate attention and remediation are required.", "Business Impact": "The vulnerability could lead to financial loss, reputational damage, and business disruption.", "Technical Impact": "The vulnerability could allow an attacker to execute arbitrary code, potentially leading to data theft, data destruction, or other malicious activities.", "Mitigation Strategies": "Immediate mitigation strategies include proper configuration and patching of software environment, public-facing applications, application layer protocols, and system processes.", "Recommendations": "Recommendations for executives include prioritizing vulnerability remediation, conducting threat modeling, and implementing incident response planning.", "Conclusions": "In conclusion, the CVE-2020-36787 vulnerability requires immediate attention and remediation to prevent potential security breaches and business disruption."}}