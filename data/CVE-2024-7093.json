{"id": "CVE-2024-7093", "sourceIdentifier": "security-report@netflix.com", "published": "2024-08-01T21:16:05.100", "lastModified": "2024-08-02T12:59:43.990", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Dispatch's notification service uses Jinja templates to generate messages to users. Jinja permits code execution within blocks, which were neither properly sanitized nor sandboxed. This vulnerability enables users to construct command line scripts in their custom message templates, which are then executed whenever these notifications are rendered and sent out."}, {"lang": "es", "value": " El servicio de notificaci\u00f3n de Dispatch utiliza plantillas de Jinja para generar mensajes para los usuarios. Jinja permite la ejecuci\u00f3n de c\u00f3digo dentro de bloques, que no fueron sanitizados ni metidos en sandbox adecuadamente. Esta vulnerabilidad permite a los usuarios crear scripts de l\u00ednea de comando en sus plantillas de mensajes personalizadas, que luego se ejecutan cada vez que se procesan y env\u00edan estas notificaciones."}], "metrics": {"cvssMetricV40": [{"source": "security-report@netflix.com", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "attackVector": "NETWORK", "attackComplexity": "LOW", "attackRequirements": "NONE", "privilegesRequired": "HIGH", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "HIGH", "vulnerableSystemIntegrity": "HIGH", "vulnerableSystemAvailability": "HIGH", "subsequentSystemConfidentiality": "HIGH", "subsequentSystemIntegrity": "HIGH", "subsequentSystemAvailability": "HIGH", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NOT_DEFINED", "recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED", "baseScore": 9.4, "baseSeverity": "CRITICAL"}}]}, "weaknesses": [{"source": "security-report@netflix.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://github.com/Netflix/security-bulletins/blob/master/advisories/nflx-2024-003.md", "source": "security-report@netflix.com"}], "techniques": [{"techniqueID": "T1177", "comment": "CVE-2024-7093 - This technique is relevant because it shows how attackers can use Jinja templates to execute arbitrary code. Defenders can defend against this by restricting the use of Jinja templates and implementing proper sanitization and sandboxing mechanisms."}, {"techniqueID": "T1061", "comment": "CVE-2024-7093 - This technique is relevant because it shows how attackers can generate custom messages with code execution capabilities. Defenders can defend against this by implementing proper input validation and filtering mechanisms."}, {"techniqueID": "T1190", "comment": "CVE-2024-7093 - This technique is relevant because it shows how attackers can use custom templates to execute commands. Defenders can defend against this by restricting access to sensitive data and implementing proper access controls."}, {"techniqueID": "T1210", "comment": "CVE-2024-7093 - This technique is relevant because it shows how attackers can use misconfigured Jinja templates to execute code. Defenders can defend against this by implementing proper configuration monitoring and auditing mechanisms."}], "stix_bundle": null, "technical_analysis": {"Introduction": "The vulnerability CVE-2024-7093 is a critical remote code execution vulnerability in the Dispatch's notification service. It allows attackers to execute arbitrary code by constructing command line scripts in custom message templates.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 9.4. It affects the Dispatch's notification service and allows attackers to execute arbitrary code remotely. The scope of this vulnerability is network-based, making it a potential threat to the entire network.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1177, T1061, T1190, and T1210. These techniques are relevant because they show how attackers can use Jinja templates to execute code, generate custom messages with code execution capabilities, use custom templates to execute commands, and use misconfigured Jinja templates to execute code.", "Technical Details": "The vulnerability is caused by Jinja templates not being properly sanitized or sandboxed. attackers can use this vulnerability to execute arbitrary code remotely. The vulnerability affects the Dispatch's notification service and can be exploited by unauthenticated attackers.", "Detection": "The vulnerability can be detected by monitoring for unusual network activity, such as unusual commands being executed or files being accessed. defenders can also use security information and event management (SIEM) systems to monitor for signs of exploitation.", "Mitigation": "The vulnerability can be mitigated by restricting the use of Jinja templates, implementing proper sanitization and sandboxing mechanisms, and using input validation and filtering mechanisms. defenders can also implement access controls to restrict access to sensitive data.", "Conclusion": "In conclusion, the vulnerability CVE-2024-7093 is a critical remote code execution vulnerability that can have significant impact on the network. defenders can mitigate this vulnerability by implementing proper security controls and monitoring for signs of exploitation."}, "executive_analysis": {"Overview": "The vulnerability CVE-2024-7093 is a critical remote code execution vulnerability that affects the Dispatch's notification service. It allows attackers to execute arbitrary code remotely and can have significant impact on the network.", "Business Impact": "The business impact of this vulnerability is significant, as it can allow attackers to execute arbitrary code remotely and potentially gain access to sensitive data.", "Technical Impact": "The technical impact of this vulnerability is high, with a CVSS score of 9.4. It affects the Dispatch's notification service and allows attackers to execute arbitrary code remotely.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include restricting the use of Jinja templates, implementing proper sanitization and sandboxing mechanisms, and using input validation and filtering mechanisms.", "Recommendations": "We recommend that defenders prioritize patching and upgrading affected systems, implementing proper security controls, and monitoring for signs of exploitation.", "Conclusions": "In conclusion, the vulnerability CVE-2024-7093 is a critical remote code execution vulnerability that requires immediate attention. We recommend that defenders take prompt action to mitigate this vulnerability and prevent potential attacks."}}