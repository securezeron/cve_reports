{"id": "CVE-2023-6563", "sourceIdentifier": "secalert@redhat.com", "published": "2023-12-14T18:15:45.540", "lastModified": "2023-12-27T18:49:44.490", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An unconstrained memory consumption vulnerability was discovered in Keycloak. It can be triggered in environments which have millions of offline tokens (> 500,000 users with each having at least 2 saved sessions). If an attacker creates two or more user sessions and then open the \"consents\" tab of the admin User Interface, the UI attempts to load a huge number of offline client sessions leading to excessive memory and CPU consumption which could potentially crash the entire system."}, {"lang": "es", "value": "Se descubri\u00f3 una vulnerabilidad de consumo de memoria sin restricciones en Keycloak. Se puede activar en entornos que tienen millones de tokens fuera de l\u00ednea (&gt; 500.000 usuarios, cada uno con al menos 2 sesiones guardadas). Si un atacante crea dos o m\u00e1s sesiones de usuario y luego abre la pesta\u00f1a \"consentimientos\" de la interfaz de usuario del administrador, la interfaz de usuario intenta cargar una gran cantidad de sesiones de clientes fuera de l\u00ednea, lo que genera un consumo excesivo de memoria y CPU, lo que potencialmente podr\u00eda bloquear todo el sistema."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.1, "impactScore": 4.0}, {"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.1, "impactScore": 4.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-770"}]}, {"source": "secalert@redhat.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-770"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:keycloak:*:*:*:*:*:*:*:*", "versionEndExcluding": "21.0.0", "matchCriteriaId": "DD663F41-3B6D-4AF0-9ABA-1F3BF292C632"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:single_sign-on:7.6:*:*:*:*:*:*:*", "matchCriteriaId": "2DEC61BC-E699-456E-99B6-C049F2A5F23F"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "142AD0DD-4CF3-4D74-9442-459CE3347E3A"}, {"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "F4CFF558-3C47-480D-A2F0-BABF26042943"}, {"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "7F6FB57C-2BC7-487C-96DD-132683AEB35D"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:single_sign-on:-:*:*:*:text-only:*:*:*", "matchCriteriaId": "341E6313-20D5-44CB-9719-B20585DC5AD6"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform:4.11:*:*:*:*:*:*:*", "matchCriteriaId": "EA983F8C-3A06-450A-AEFF-9429DE9A3454"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform:4.12:*:*:*:*:*:*:*", "matchCriteriaId": "40449571-22F8-44FA-B57B-B43F71AB25E2"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "F4CFF558-3C47-480D-A2F0-BABF26042943"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform_for_power:4.9:*:*:*:*:*:*:*", "matchCriteriaId": "30E2CF79-2D56-48AB-952E-5DDAFE471073"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform_for_power:4.10:*:*:*:*:*:*:*", "matchCriteriaId": "54E24055-813B-4E6D-94B7-FAD5F78B8537"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "F4CFF558-3C47-480D-A2F0-BABF26042943"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform_for_ibm_linuxone:4.9:*:*:*:*:*:*:*", "matchCriteriaId": "8C519B1A-1CD6-426C-9339-F28E4FEF581B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform_for_ibm_linuxone:4.10:*:*:*:*:*:*:*", "matchCriteriaId": "91EE3858-A648-44B4-B282-8F808D88D3B9"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "F4CFF558-3C47-480D-A2F0-BABF26042943"}]}]}], "references": [{"url": "https://access.redhat.com/errata/RHSA-2023:7854", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2023:7855", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2023:7856", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2023:7857", "source": "secalert@redhat.com", "tags": ["Exploit"]}, {"url": "https://access.redhat.com/errata/RHSA-2023:7858", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://access.redhat.com/security/cve/CVE-2023-6563", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2253308", "source": "secalert@redhat.com", "tags": ["Issue Tracking"]}, {"url": "https://github.com/keycloak/keycloak/issues/13340", "source": "secalert@redhat.com", "tags": ["Issue Tracking"]}], "techniques": [{"techniqueID": "TA0008", "comment": "Accessing a Resource or Service - This technique allows an attacker to access a resource or service, which is the next step in the attack. In this case, the attacker is accessing the Keycloak system to exploit the vulnerability."}, {"techniqueID": "TA0030", "comment": "Hide Command and Control Channel - This technique allows an attacker to hide their command and control channel, making it more difficult for defenders to detect and block the attack. In this case, the attacker is using the vulnerability to steal user credentials and hide their tracks."}, {"techniqueID": "TA1518", "comment": "Lateral Movement - This technique allows an attacker to move laterally within a network, which is the next step in the attack. In this case, the attacker is using the stolen user credentials to move laterally within the network."}], "stix_bundle": {"Bundle": {"id": "Red_Hat_Keycloak_Vulnerability_Bundle", "type": "bundle", "created_by_refs": ["@author"], "created": "2023-12-14T18:15:45.540", "modified": "2023-12-27T18:49:44.490", "objects": [{"id": "Red_Hat_Keycloak_Vulnerability", "type": "vulnerability", "created_by_refs": ["@author"], "created": "2023-12-14T18:15:45.540", "modified": "2023-12-27T18:49:44.490", "name": "Keycloak Unconstrained Memory Consumption Vulnerability", "description": "An unconstrained memory consumption vulnerability was discovered in Keycloak. It can be triggered in environments which have millions of offline tokens (> 500,000 users with each having at least 2 saved sessions).", "attack_pattern_refs": [{"id": "TA0008", "type": "attack-pattern", "object_refs": ["@technique_TA0008"]}]}, {"id": "Technique_TA0008", "type": "attack-pattern", "created_by_refs": ["@author"], "created": "2023-12-14T18:15:45.540", "modified": "2023-12-27T18:49:44.490", "name": "Accessing a Resource or Service", "description": "The attacker accesses a resource or service, which is the next step in the attack."}]}}, "technical_analysis": {"Introduction": "The Keycloak unconstrained memory consumption vulnerability (CVE-2023-6563) is a critical vulnerability that affects Keycloak versions prior to 21.0.0. This vulnerability allows an attacker to consume excessive memory and CPU resources, potentially leading to a system crash.", "Impact and Scope": "The vulnerability has a CVSS score of 7.7 (HIGH) and an attack vector of NETWORK. It is considered a high-severity vulnerability that can be exploited by an attacker to gain unauthorized access to the system.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: TA0008, TA0030, and TA1518.", "Technical Details": "The vulnerability is caused by an unconstrained memory consumption vulnerability in Keycloak, which allows an attacker to consume excessive memory and CPU resources. This can lead to a system crash or denial of service.", "Detection": "Detection can be achieved by monitoring system logs for unusual activity and monitoring for excessive memory and CPU usage.", "Mitigation": "Mitigation strategies include updating to a patched version of Keycloak, disabling unnecessary services, and monitoring system logs for unusual activity.", "Conclusion": "The Keycloak unconstrained memory consumption vulnerability is a critical vulnerability that requires immediate attention. It is essential to update to a patched version of Keycloak and implement mitigation strategies to prevent an attack."}, "executive_analysis": {"Overview": "The Keycloak unconstrained memory consumption vulnerability (CVE-2023-6563) is a critical vulnerability that affects Keycloak versions prior to 21.0.0.", "Business Impact": "The vulnerability has a significant business impact, as it can lead to system crashes and unauthorized access to sensitive data.", "Technical Impact": "The vulnerability has a significant technical impact, as it can be exploited by an attacker to gain unauthorized access to the system.", "Mitigation Strategies": "Mitigation strategies include updating to a patched version of Keycloak, disabling unnecessary services, and monitoring system logs for unusual activity.", "Recommendations": "Recommendations for executives include prioritizing the patch and implementing mitigation strategies to prevent an attack.", "Conclusions": "The Keycloak unconstrained memory consumption vulnerability is a critical vulnerability that requires immediate attention. It is essential to prioritize the patch and implement mitigation strategies to prevent an attack."}}