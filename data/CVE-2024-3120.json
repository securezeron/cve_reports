{"id": "CVE-2024-3120", "sourceIdentifier": "41c37e40-543d-43a2-b660-2fee83ea851a", "published": "2024-04-10T00:15:12.340", "lastModified": "2024-04-10T13:23:38.787", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A stack-buffer overflow vulnerability exists in all versions of sngrep since v1.4.1. The flaw is due to inadequate bounds checking when copying 'Content-Length' and 'Warning' headers into fixed-size buffers in the sip_validate_packet and sip_parse_extra_headers functions within src/sip.c. This vulnerability allows remote attackers to execute arbitrary code or cause a denial of service (DoS) via crafted SIP\u00a0messages."}, {"lang": "es", "value": "Existe una vulnerabilidad de desbordamiento de b\u00fafer en la regi\u00f3n stack de la memoria en todas las versiones de sngrep desde la v1.4.1. La falla se debe a una verificaci\u00f3n inadecuada de los l\u00edmites al copiar los encabezados 'Content-Length' y 'Warning' en b\u00faferes de tama\u00f1o fijo en las funciones sip_validate_packet y sip_parse_extra_headers dentro de src/sip.c. Esta vulnerabilidad permite a atacantes remotos ejecutar c\u00f3digo arbitrario o provocar una denegaci\u00f3n de servicio (DoS) a trav\u00e9s de mensajes SIP manipulados."}], "metrics": {"cvssMetricV31": [{"source": "41c37e40-543d-43a2-b660-2fee83ea851a", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.2, "impactScore": 6.0}]}, "weaknesses": [{"source": "41c37e40-543d-43a2-b660-2fee83ea851a", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-120"}]}], "references": [{"url": "https://github.com/irontec/sngrep/pull/480/commits/f229a5d31b0be6a6cc3ab4cd9bfa4a1b5c5714c6", "source": "41c37e40-543d-43a2-b660-2fee83ea851a"}, {"url": "https://github.com/irontec/sngrep/releases/tag/v1.8.1", "source": "41c37e40-543d-43a2-b660-2fee83ea851a"}, {"url": "https://pentraze.com/vulnerability-reports/", "source": "41c37e40-543d-43a2-b660-2fee83ea851a"}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2024-3120 - Demonstrate command execution by exploiting a vulnerable SIP parser, this is a prime example of a successful exploitation of a buffer overflow vulnerability, utilizing the vulnerability to remotely execute arbitrary commands."}, {"techniqueID": "TA0002", "comment": "CVE-2024-3120 - Leverage the vulnerability to manipulate SIP packets and inject malicious code, further demonstrating the remote code execution capabilities of the exploitable buffer overflow."}, {"techniqueID": "TA0012", "comment": "CVE-2024-3120 - Utilize the vulnerability to remotely send arbitrary files to the targeted system."}, {"techniqueID": "TA0021", "comment": "CVE-2024-3120 - Exploit the vulnerability to steal sensitive information such as authentication credentials, further mitigating the severity of the vulnerability."}, {"techniqueID": "TA0039", "comment": "CVE-2024-3120 - Launch a denial-of-service (DoS) attack by exploiting the vulnerability, affecting the targeted system's availability and causing widespread network disruption."}], "stix_bundle": "{\"bundle\": {\"type\": \"bundle\", \"id\": \"bundle-01\", \"objects\": [{\"type\": \"vulnerability\", \"id\": \"vuln-01\", \"name\": \"CVE-2024-3120\", \"description\": \"A stack-buffer overflow vulnerability exists in all versions of sngrep since v1.4.1.\", \"severity\": \"CRITICAL\"},\r\n{\"type\": \"exploit-technique\", \"id\": \"exploit-01\", \"name\": \"Exploit Technique 1\", \"description\": \"Demonstrate command execution by exploiting a vulnerable SIP parser.\", \"mitigations\": [{\"type\": \"mitigation\", \"id\": \"mitig-01\", \"name\": \"Update to v1.8.1\"}]\r\n},\r\n{\"type\": \"incident-response\", \"id\": \"ir-01\", \"name\": \"Incident Response 1\", \"description\": \"Remote code execution vulnerability detected through SIP packets.\", \"mitigations\": [{\"type\": \"mitigation\", \"id\": \"mitig-02\", \"name\": \"Network segmentation\"}]\r\n},\r\n{\"type\": \"indicator\", \"id\": \"ind-01\", \"name\": \"Indicator 1\", \"description\": \"SIP packet with specific header values.\", \"MITRE\": [{\"type\": \"MITRE-Technique\", \"id\": \"TA0001\"}]}].", "technical_analysis": {"Introduction": "A stack-buffer overflow vulnerability exists in all versions of sngrep since v1.4.1.", "Impact and Scope": "The vulnerability allows remote attackers to execute arbitrary code or cause a denial of service (DoS) via crafted SIP packets.", "Related MITRE ATT&CK Techniques": "TA0001, TA0002, TA0012, TA0021, TA0039", "Technical Details": "The vulnerability is due to inadequate bounds checking when copying 'Content-Length' and 'Warning' headers into fixed-size buffers in the sip_validate_packet and sip_parse_extra_headers functions within src/sip.c.", "Detection": "Detection methods should focus on identifying SIP packets with specific header values.", "Mitigation": "Mitigation strategies include updating to v1.8.1, network segmentation, and implementing security controls to prevent unauthorized access.", "Conclusion": "Conclusion: The vulnerability (CVE-2024-3120) is a critical remote code execution vulnerability in sngrep's SIP parser, allowing remote attackers to execute arbitrary code or cause a denial of service (DoS)."}, "executive_analysis": {"Overview": "Overview: A critical remote code execution vulnerability (CVE-2024-3120) in sngrep's SIP parser could allow remote attackers to execute arbitrary code or cause a denial of service (DoS).", "Business Impact": "The vulnerability could have a severe impact on business operations, causing downtime and disrupting critical services.", "Technical Impact": "The vulnerability allows remote attackers to execute arbitrary code or cause a denial of service (DoS), which could lead to critical technical issues.", "Mitigation Strategies": "Update to v1.8.1, network segmentation, and implementing security controls to prevent unauthorized access.", "Recommendations": "Recommendations: Implement a patch management strategy, conduct regular security assessments, and develop a incident response plan.", "Conclusions": "Conclusion: The vulnerability (CVE-2024-3120) is a critical remote code execution vulnerability in sngrep's SIP parser, requiring immediate attention and mitigation."}}