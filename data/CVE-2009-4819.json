{"id": "CVE-2009-4819", "sourceIdentifier": "cve@mitre.org", "published": "2010-04-27T15:30:00.827", "lastModified": "2017-08-17T01:31:46.227", "vulnStatus": "Modified", "cveTags": [], "evaluatorComment": "Per: http://cwe.mitre.org/data/definitions/434.html\r\n\r\n'CWE-434: Unrestricted Upload of File with Dangerous Type'", "descriptions": [{"lang": "en", "value": "Multiple unrestricted file upload vulnerabilities in upload.php in PHPhotoalbum allow remote attackers to execute arbitrary code by uploading a file with a (1) .php.pgif or (2) .php.pjpeg double extension, then accessing it via a direct request to the file in albums/userpics/."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de subida de archivos sin restricci\u00f3n en upload.php en PHPhotoalbum permite a atacantes remotos ejecutar c\u00f3digo de su elecci\u00f3n subiendo un archivo con una extensi\u00f3n doble (1) .php.pgif o (2) .php.pjpeg, y accediendo a \u00e9l a trav\u00e9s de una petici\u00f3n directa al fichero  en albums/userpics/."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:stoverud:phphotoalbum:0.3:*:*:*:*:*:*:*", "matchCriteriaId": "E2B49214-DC96-440A-AD5A-E78C5FDB2CD6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:stoverud:phphotoalbum:0.4:*:*:*:*:*:*:*", "matchCriteriaId": "46D31292-9697-4028-A6AC-6B74E96545C4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:stoverud:phphotoalbum:0.5:*:*:*:*:*:*:*", "matchCriteriaId": "9E92961C-9837-4D84-B85E-25F0610A6E8D"}]}]}], "references": [{"url": "http://www.exploit-db.com/exploits/10584", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.securityfocus.com/bid/37436", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/54958", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2009-4819 - This technique involves using unrestricted file uploads to bypass security measures and execute arbitrary code on the targeted system."}, {"techniqueID": "T1191", "comment": "CVE-2009-4819 - This technique involves manipulating the file extension to bypass security checks and execute arbitrary code on the targeted system."}, {"techniqueID": "T1192", "comment": "CVE-2009-4819 - This technique involves exploiting the lack of input validation to execute arbitrary code on the targeted system."}], "stix_bundle": {"id": "CVE-2009-4819-STIX", "type": "indicator", "spec_version": "2.1", "idref": "CVE-2009-4819", "created_by_ref": "MITRE", "modified": "2022-01-01T14:30:00.000", "first_observed": "2009-04-27T15:30:00.000", "last_observed": "2022-01-01T14:30:00.000", "threat_actor": {"KillChain_Phase": "Reconnaissance", "Initial_Access": "Network"}, "tool": {"URL": "http://cwe.mitre.org/data/definitions/434.html"}, "attack_pattern": {"ID": "CVE-2009-4819-AP", "description": "Exploitation of the PHPhotoalbum file upload vulnerability to execute arbitrary code"}, "indicator": {"type": "file", "value": "upload.php", "description": "Unrestricted file upload vulnerability in PHPhotoalbum"}, "course_of_action": [{"description": "Implement input validation for file uploads", "technique": "T1190"}, {"description": "Disable executable file extensions", "technique": "T1191"}, {"description": "Implement appropriate access controls", "technique": "T1192"}], "note": [{"text": "The cvss score for this vulnerability is 6.8 with a version of 2.0. The attack vector is network."}]}, "technical_analysis": {"Introduction": "PHPhotoalbum is a photography sharing platform that allows users to upload and share their photos. A vulnerability exists in the file upload functionality that allows for unrestricted file uploads.", "Impact and Scope": "The vulnerability allows for the execution of arbitrary code on the targeted system. The attack vector is network and the exploitation requires medium complexity.", "Related MITRE ATT&CK Techniques": "T1190, T1191, T1192", "Technical Details": "The vulnerability exists in the upload.php file of PHPhotoalbum. The file allows for unrestricted file uploads, which can be exploited by an attacker to execute arbitrary code on the targeted system.", "Detection": "Detection of this vulnerability can be done by monitoring for suspicious file uploads and access to sensitive areas of the system.", "Mitigation": "Mitigation strategies include implementing input validation for file uploads, disabling executable file extensions, and implementing appropriate access controls.", "Conclusion": "In summary, the PHPhotoalbum file upload vulnerability is a critical vulnerability that allows for the execution of arbitrary code on the targeted system."}, "executive_analysis": {"Overview": "The PHPhotoalbum file upload vulnerability is a critical vulnerability that can lead to the execution of arbitrary code on the targeted system.", "Business Impact": "The business impact of this vulnerability is significant as it can lead to the theft or destruction of sensitive data.", "Technical Impact": "The technical impact of this vulnerability is the potential to execute arbitrary code on the targeted system.", "Mitigation Strategies": "Implementing input validation for file uploads, disabling executable file extensions, and implementing appropriate access controls are effective mitigation strategies.", "Recommendations": "Recommendations include prioritizing patching and vulnerability management, as well as implementing additional security measures to detect and prevent exploitation.", "Conclusions": "In conclusion, the PHPhotoalbum file upload vulnerability is a critical vulnerability that poses a significant risk to the security of the system. It is essential to prioritize mitigation and address this vulnerability as soon as possible."}}