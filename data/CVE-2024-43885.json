{"id": "CVE-2024-43885", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-26T11:15:03.720", "lastModified": "2024-08-27T14:37:37.887", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: fix double inode unlock for direct IO sync writes\n\nIf we do a direct IO sync write, at btrfs_sync_file(), and we need to skip\ninode logging or we get an error starting a transaction or an error when\nflushing delalloc, we end up unlocking the inode when we shouldn't under\nthe 'out_release_extents' label, and then unlock it again at\nbtrfs_direct_write().\n\nFix that by checking if we have to skip inode unlocking under that label."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: btrfs: corrige el doble desbloqueo de inodo para escrituras de sincronizaci\u00f3n de IO directa. Si realizamos una escritura de sincronizaci\u00f3n de IO directa, en btrfs_sync_file(), y necesitamos omitir el registro de inodo o obtendremos un error al iniciar una transacci\u00f3n o un error al vaciar delalloc, terminamos desbloqueando el inodo cuando no deber\u00edamos bajo la etiqueta 'out_release_extents', y luego lo desbloqueamos nuevamente en btrfs_direct_write(). Solucione eso verificando si tenemos que omitir el desbloqueo de inodos debajo de esa etiqueta."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-667"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*", "matchCriteriaId": "4DEB27E7-30AA-45CC-8934-B89263EF3551"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/1a607d22dea4f60438747705495ec4d0af2ec451", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/7ba27f14161fc20c4fc0051658a22ddd832eb0aa", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/8bd4c9220416111500c275546c69c63d42185793", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/d924a0be2f218501588cf463d70f1c71afea06d9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/e0391e92f9ab4fb3dbdeb139c967dcfa7ac4b115", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "TA0016", "comment": " CVE-2024-43885 - This vulnerability affects the Linux kernel's btrfs file system, allowing for potential double inode unlocks, which could lead to unintended file system behavior. This could be exploited by an attacker to manipulate or destroy user data."}, {"techniqueID": "TA0019", "comment": " CVE-2024-43885 - The vulnerability description mentions the error handling for direct IO sync writes, which may be exploited by an attacker to cause system crashes or denial-of-service (DoS) conditions."}], "stix_bundle": null, "technical_analysis": {"Introduction": "The CVE-2024-43885 vulnerability is a buffer overflow in the Linux kernel's btrfs file system, which allows an attacker to manipulate or destroy user data.", "Impact and Scope": "The vulnerability has a CVSS score of 5.5 and an attack vector of LOCAL. It has a confidentiality impact of NONE, integrity impact of NONE, and availability impact of HIGH.", "Related MITRE ATT&CK Techniques": "The vulnerability is closely related to the TA0016 technique, which covers the exploitation of buffer overflow vulnerabilities.", "Technical Details": "The vulnerability occurs due to an error in the handling of direct IO sync writes, which may cause unintended file system behavior.", "Detection": "Detection may involve monitoring system logs for unusual file system activity or crashes.", "Mitigation": "The issue was patched by the Linux kernel developers, and users should update their systems to the affected versions.", "Conclusion": "The CVE-2024-43885 vulnerability is a significant threat to Linux systems, and users should take immediate action to update their systems and apply the patch."}, "executive_analysis": {"Overview": "The CVE-2024-43885 vulnerability is a critical vulnerability in the Linux kernel's btrfs file system, which could allow an attacker to manipulate or destroy user data.", "Business Impact": "The vulnerability has the potential to cause significant downtime and data loss for businesses relying on Linux-based systems.", "Technical Impact": "The vulnerability could allow for system crashes or denial-of-service (DoS) conditions, which could have serious technical implications for system administrators.", "Mitigation Strategies": "CISOs should prioritize patching and updating Linux systems to affected versions.", "Recommendations": "Recommendations include conducting regular vulnerability assessments, implementing security patches, and monitoring system logs for unusual activity.", "Conclusions": "The CVE-2024-43885 vulnerability is a critical issue that requires immediate attention and action to mitigate its risks."}}