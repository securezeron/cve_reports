{"id": "CVE-2024-35921", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-19T11:15:48.443", "lastModified": "2024-05-20T13:00:04.957", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: mediatek: vcodec: Fix oops when HEVC init fails\n\nThe stateless HEVC decoder saves the instance pointer in the context\nregardless if the initialization worked or not. This caused a use after\nfree, when the pointer is freed in case of a failure in the deinit\nfunction.\nOnly store the instance pointer when the initialization was successful,\nto solve this issue.\n\n Hardware name: Acer Tomato (rev3 - 4) board (DT)\n pstate: 80400009 (Nzcv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n pc : vcodec_vpu_send_msg+0x4c/0x190 [mtk_vcodec_dec]\n lr : vcodec_send_ap_ipi+0x78/0x170 [mtk_vcodec_dec]\n sp : ffff80008750bc20\n x29: ffff80008750bc20 x28: ffff1299f6d70000 x27: 0000000000000000\n x26: 0000000000000000 x25: 0000000000000000 x24: 0000000000000000\n x23: ffff80008750bc98 x22: 000000000000a003 x21: ffffd45c4cfae000\n x20: 0000000000000010 x19: ffff1299fd668310 x18: 000000000000001a\n x17: 000000040044ffff x16: ffffd45cb15dc648 x15: 0000000000000000\n x14: ffff1299c08da1c0 x13: ffffd45cb1f87a10 x12: ffffd45cb2f5fe80\n x11: 0000000000000001 x10: 0000000000001b30 x9 : ffffd45c4d12b488\n x8 : 1fffe25339380d81 x7 : 0000000000000001 x6 : ffff1299c9c06c00\n x5 : 0000000000000132 x4 : 0000000000000000 x3 : 0000000000000000\n x2 : 0000000000000010 x1 : ffff80008750bc98 x0 : 0000000000000000\n Call trace:\n  vcodec_vpu_send_msg+0x4c/0x190 [mtk_vcodec_dec]\n  vcodec_send_ap_ipi+0x78/0x170 [mtk_vcodec_dec]\n  vpu_dec_deinit+0x1c/0x30 [mtk_vcodec_dec]\n  vdec_hevc_slice_deinit+0x30/0x98 [mtk_vcodec_dec]\n  vdec_if_deinit+0x38/0x68 [mtk_vcodec_dec]\n  mtk_vcodec_dec_release+0x20/0x40 [mtk_vcodec_dec]\n  fops_vcodec_release+0x64/0x118 [mtk_vcodec_dec]\n  v4l2_release+0x7c/0x100\n  __fput+0x80/0x2d8\n  __fput_sync+0x58/0x70\n  __arm64_sys_close+0x40/0x90\n  invoke_syscall+0x50/0x128\n  el0_svc_common.constprop.0+0x48/0xf0\n  do_el0_svc+0x24/0x38\n  el0_svc+0x38/0xd8\n  el0t_64_sync_handler+0xc0/0xc8\n  el0t_64_sync+0x1a8/0x1b0\n Code: d503201f f9401660 b900127f b900227f (f9400400)"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: media: mediatek: vcodec: corrija el error cuando falla el inicio de HEVC El decodificador HEVC sin estado guarda el puntero de la instancia en el contexto independientemente de si la inicializaci\u00f3n funcion\u00f3 o no. Esto provoc\u00f3 un use after free, cuando el puntero se libera en caso de fallo en la funci\u00f3n deinit. Para resolver este problema, almacene \u00fanicamente el puntero de instancia cuando la inicializaci\u00f3n sea exitosa. Nombre del hardware: Acer Tomato (rev3 - 4) placa (DT) pstate: 80400009 (Nzcv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--) pc: vcodec_vpu_send_msg+0x4c/0x190 [mtk_vcodec_dec] lr: vcodec_send_ap_ipi+0x78 /0x170 [mtk_vcodec_dec] sp: ffff80008750bc20 x29: ffff80008750bc20 x28: ffff1299f6d70000 x27: 0000000000000000 x26: 0000000000000000 x25: 0000000000 x24: 0000000000000000 x23: ffff80008750bc98 x22: 000000000000a003 x21: ffffd45c4cfae000 x20: 0000000000000010 x19: 310 x18: 000000000000001a x17: 000000040044ffff x16: ffffd45cb15dc648 x15: 0000000000000000 x14: ffff1299c08da1c0 x13: ffffd45cb1f87a10 x12: ffffd45cb2f5fe80 x11: 0000000000000001 x10: 0000000000001b30 x9: 45c4d12b488 x8: 1fffe25339380d81 x7: 0000000000000001 x6: ffff1299c9c06c00 x5: 0000000000000132 x4: 0000000000000000 x3: 0000000000000 000 x2: 0000000000000010 x1: ffff80008750bc98 x0: 0000000000000000 Rastreo de llamadas : vcodec_vpu_send_msg+0x4c/0x190 [mtk_vcodec_dec] vcodec_send_ap_ipi+0x78/0x170 [mtk_vcodec_dec] vpu_dec_deinit+0x1c/0x30 [mtk_vcodec_dec] vdec_hevc_slice_deinit+0x30/0x98 tk_vcodec_dec] vdec_if_deinit+0x38/0x68 [mtk_vcodec_dec] mtk_vcodec_dec_release+0x20/0x40 [mtk_vcodec_dec] fops_vcodec_release +0x64/0x118 [mtk_vcodec_dec] v4l2_release+0x7c/0x100 __fput+0x80/0x2d8 __fput_sync+0x58/0x70 __arm64_sys_close+0x40/0x90 invoke_syscall+0x50/0x128 .0+0x48/0xf0 do_el0_svc+0x24/0x38 el0_svc+0x38/ 0xd8 el0t_64_sync_handler+0xc0/0xc8 el0t_64_sync+0x1a8/0x1b0 C\u00f3digo: d503201f f9401660 b900127f b900227f (f9400400)"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/521ce0ea7418298d754494fe53263c23c4c78a8e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/97c75ee5de060d271d80109b0c47cb6008439e5b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ec25fc3c2c1e8958a51abcfed614f81446d918c4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1134", "comment": "CVE-2024-35921 - This Mitre ATT&CK Technique is related to the Linux Kernel vulnerability, where an attacker can exploit a use-after-free vulnerability in the HEVC decoder, and potentially execute arbitrary code. This technique is relevant as it allows attackers to potentially escalate privileges, steal sensitive information, or disrupt system function."}, {"techniqueID": "T1210", "comment": "CVE-2024-35921 - This Mitre ATT&CK Technique is related to the Linux Kernel vulnerability, where an attacker can exploit a use-after-free vulnerability in the HEVC decoder, and potentially execute arbitrary code. This technique is relevant as it allows attackers to potentially execute code, escalate privileges, or disrupt system function."}, {"techniqueID": "T1486", "comment": "CVE-2024-35921 - This Mitre ATT&CK Technique is related to the Linux Kernel vulnerability, where an attacker can exploit a use-after-free vulnerability in the HEVC decoder, and potentially execute arbitrary code. This technique is relevant as it allows attackers to potentially escalate privileges, steal sensitive information, or disrupt system function."}], "stix_bundle": {"version": "2.1", "objects": [{"type": "vulnerability", "id": "CVE-2024-35921", "name": "CVE-2024-35921", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: mediatek: vcodec: Fix oops when HEVC init fails\n\n...", "references": [{"url": "https://git.kernel.org/stable/c/521ce0ea7418298d754494fe53263c23c4c78a8e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/97c75ee5de060d271d80109b0c47cb6008439e5b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ec25fc3c2c1e8958a51abcfed614f81446d918c4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "relationships": [{"from": "CVE-2024-35921", "to": "T1134", "label": "exploits"}, {"from": "CVE-2024-35921", "to": "T1210", "label": "exploits"}, {"from": "CVE-2024-35921", "to": "T1486", "label": "exploits"}]}, {"type": "analyzer", "id": "T1134", "name": "T1134", "description": "Use After Free", "author": "MITRE Corporation", "refs": ["https://attack.mitre.org/wiki/Technique/T1134"]}, {"type": "analyzer", "id": "T1210", "name": "T1210", "description": "Exploitation of Public-Facing Application", "author": "MITRE Corporation", "refs": ["https://attack.mitre.org/wiki/Technique/T1210"]}, {"type": "analyzer", "id": "T1486", "name": "T1486", "description": "Domain Controller exploitation", "author": "MITRE Corporation", "refs": ["https://attack.mitre.org/wiki/Technique/T1486"]}]}, "technical_analysis": {"Introduction": "This vulnerability affects the Linux Kernel and is a use-after-free vulnerability in the HEVC decoder, which allows an attacker to potentially execute arbitrary code.", "Impact and Scope": "The impact of this vulnerability is the ability for an attacker to potentially execute arbitrary code, escalate privileges, steal sensitive information, or disrupt system function.", "Related MITRE ATT&CK Techniques": "T1134, T1210, T1486", "Technical Details": "The vulnerability occurs when the HEVC decoder saves the instance pointer in the context regardless of whether the initialization worked or not.", "Detection": "Detection of this vulnerability can be done using a combination of Heuristic and Signature-based detection methods.", "Mitigation": "Mitigation strategies include preventing the initial exploitation of the vulnerability, and applying fixes or patches to the affected system.", "Conclusion": "In conclusion, the CVE-2024-35921 is a serious vulnerability in the Linux Kernel that allows an attacker to potentially execute arbitrary code, escalate privileges, steal sensitive information, or disrupt system function."}, "executive_analysis": {"Overview": "This vulnerability is a serious threat to the security of Linux-based systems, and should be addressed immediately.", "Business Impact": "The impact of this vulnerability on businesses is significant, as it can lead to data breaches, system compromise, and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is the potential for an attacker to execute arbitrary code, escalate privileges, steal sensitive information, or disrupt system function.", "Mitigation Strategies": "Mitigation strategies include preventing the initial exploitation of the vulnerability, and applying fixes or patches to the affected system.", "Recommendations": "It is recommended that organizations patch and update their systems immediately to prevent exploitation of this vulnerability.", "Conclusions": "In conclusion, the CVE-2024-35921 is a significant threat to the security of Linux-based systems, and should be addressed immediately."}}