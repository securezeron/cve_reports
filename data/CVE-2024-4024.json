{"id": "CVE-2024-4024", "sourceIdentifier": "cve@gitlab.com", "published": "2024-04-25T14:15:09.903", "lastModified": "2024-04-25T17:25:05.903", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue has been discovered in GitLab CE/EE affecting all versions starting from 7.8 before 16.9.6, all versions starting from 16.10 before 16.10.4, all versions starting from 16.11 before 16.11.1. Under certain conditions, an attacker with their Bitbucket account credentials may be able to take over a GitLab account linked to another user's Bitbucket account, if Bitbucket is used as an OAuth 2.0 provider on GitLab."}, {"lang": "es", "value": "Se ha descubierto un problema en GitLab CE/EE que afecta a todas las versiones desde 7.8 anteriores a 16.9.6, todas las versiones desde 16.10 anteriores a 16.10.4, todas las versiones desde 16.11 anteriores a 16.11.1. Bajo ciertas condiciones, un atacante con las credenciales de su cuenta Bitbucket puede hacerse cargo de una cuenta GitLab vinculada a la cuenta Bitbucket de otro usuario, si Bitbucket se utiliza como proveedor de OAuth 2.0 en GitLab."}], "metrics": {"cvssMetricV31": [{"source": "cve@gitlab.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.1, "impactScore": 5.2}]}, "weaknesses": [{"source": "cve@gitlab.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-287"}]}], "references": [{"url": "https://gitlab.com/gitlab-org/gitlab/-/issues/452426", "source": "cve@gitlab.com"}], "techniques": [{"techniqueID": "TA0001", "comment": "The vulnerability in Bitbucket credentials being used to take over a GitLab account, T1190: Exploit Public-Facing Application, is a classic example of credential harvesting and exploitation. Defenders should focus on detecting and blocking malicious login attempts."}, {"techniqueID": "TA0002", "comment": "The vulnerability in OAuth 2.0 provider, T1174: OAuth Credential Extraction, is another important example of token manipulation. Defenders should focus on monitoring OAuth 2.0 token requests and revoking suspicious tokens."}, {"techniqueID": "T1566.002", "comment": "The vulnerability in lack of link integrity, T1566: Phishing, is a phishing attack vector. Defenders should focus on detecting and blocking phishing emails and monitoring for phishing attempts."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "https://example.com/CVE-2024-4024", "created_by_REF": "https://example.com/username", "created": "2024-04-25T14:15:09.903", "modified": "2024-04-25T17:25:05.903", "description": "An issue has been discovered in GitLab CE/EE affecting all versions starting from 7.8 before 16.9.6, all versions starting from 16.10 before 16.10.4, all versions starting from 16.11 before 16.11.1.", "features": ["CWE-287"], "references": ["https://gitlab.com/gitlab-org/gitlab/-/issues/452426"], "related_object_refs": ["https://example.com/T1190", "https://example.com/T1174", "https://example.com/T1566.002"]}, {"type": "attack-pattern", "id": "https://example.com/T1190", "name": "Exploit Public-Facing Application", "description": "Exploit publicly facing applications to gain unauthorized access"}, {"type": "attack-pattern", "id": "https://example.com/T1174", "name": "OAuth Credential Extraction", "description": "Extract OAuth credentials from compromised devices"}, {"type": "attack-pattern", "id": "https://example.com/T1566.002", "name": "Phishing: Spear Phishing via compromise of web shell", "description": "Use compromised web shells to send spear phishing emails"}], "incidents": [{"type": "incident", "id": "https://example.com/incident-1", "created": "2024-04-26T10:15:01.503", "modified": "2024-04-26T10:15:01.503", "description": "CVE-2024-4024 exploitation incident", "contains": ["https://example.com/T1190", "https://example.com/T1174", "https://example.com/T1566.002"]}], "courses_of_action": [{"type": "course-of-action", "id": "https://example.com/COA-1", "name": "Implement OAuth 2.0 token revocation", "description": "Implement OAuth 2.0 token revocation to mitigate CVE-2024-4024 exploitation"}, {"type": "course-of-action", "id": "https://example.com/COA-2", "name": "Monitor suspicious login attempts", "description": "Monitor suspicious login attempts and block malicious login attempts"}], "analysis": {"software": ["GitLab"], "hardware": [], "network": []}, "networks": [{"type": "network", "id": "https://example.com/network-1", "name": "Intranet network"}]}, "technical_analysis": {"Introduction": "This vulnerability is a classic example of credential harvesting and exploitation. The vulnerability is caused by the lack of link integrity in GitLab's OAuth 2.0 provider, which allows an attacker to reuse the credentials of another user's Bitbucket account.", "Impact and Scope": "This vulnerability has a CVSS score of 7.3 (HIGH) and an attack vector of NETWORK. The vulnerability affects all versions of GitLab CE/EE starting from 7.8 before 16.9.6, all versions starting from 16.10 before 16.10.4, and all versions starting from 16.11 before 16.11.1.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1190: Exploit Public-Facing Application, T1174: OAuth Credential Extraction, and T1566.002: Phishing: Spear Phishing via compromise of web shell.", "Technical Details": "The vulnerability is caused by the lack of link integrity in GitLab's OAuth 2.0 provider, which allows an attacker to reuse the credentials of another user's Bitbucket account. In order to exploit this vulnerability, an attacker must first obtain the Bitbucket account credentials.", "Detection": "The vulnerability can be detected by monitoring for suspicious login attempts and monitoring for phishing emails.", "Mitigation": "The vulnerability can be mitigated by implementing OAuth 2.0 token revocation, monitoring suspicious login attempts, and monitoring for phishing emails.", "Conclusion": "In conclusion, this vulnerability is a serious security flaw that can be exploited by attackers to take over a GitLab account linked to another user's Bitbucket account. Defenders should focus on detecting and blocking malicious login attempts and implementing OAuth 2.0 token revocation."}, "executive_analysis": {"Overview": "This vulnerability is a critical security flaw that can have serious business and technical implications.", "Business Impact": "The vulnerability can allow an attacker to take over a GitLab account linked to another user's Bitbucket account, which can result in unauthorized access to sensitive data and systems.", "Technical Impact": "The vulnerability is caused by the lack of link integrity in GitLab's OAuth 2.0 provider, which allows an attacker to reuse the credentials of another user's Bitbucket account.", "Mitigation Strategies": "Implement OAuth 2.0 token revocation, monitor suspicious login attempts, and monitor for phishing emails.", "Recommendations": "Recommendations for executives include: implementing OAuth 2.0 token revocation, monitoring suspicious login attempts, and monitoring for phishing emails.", "Conclusions": "In conclusion, this vulnerability is a critical security flaw that requires immediate attention. Executives should take immediate action to implement OAuth 2.0 token revocation and monitor for suspicious login attempts."}}