{"id": "CVE-2024-23676", "sourceIdentifier": "prodsec@splunk.com", "published": "2024-01-22T21:15:10.530", "lastModified": "2024-04-10T01:15:18.240", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Splunk versions below 9.0.8 and 9.1.3, the \u201cmrollup\u201d SPL command lets a low-privileged user view metrics on an index that they do not have permission to view. This vulnerability requires user interaction from a high-privileged user to exploit."}, {"lang": "es", "value": "En las versiones de Splunk inferiores a 9.0.8 y 9.1.3, el comando SPL \u201cmrollup\u201d permite a un usuario con pocos privilegios ver m\u00e9tricas en un \u00edndice para el que no tiene permiso. Esta vulnerabilidad requiere la interacci\u00f3n de un usuario con altos privilegios para poder explotarla."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}, {"source": "prodsec@splunk.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.6, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 2.5}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "prodsec@splunk.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:splunk:cloud:*:*:*:*:*:*:*:*", "versionEndExcluding": "9.1.2308.200", "matchCriteriaId": "9F37499F-F597-4CE3-8E14-E53AE6B46202"}, {"vulnerable": true, "criteria": "cpe:2.3:a:splunk:splunk:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "9.0.0", "versionEndExcluding": "9.0.8", "matchCriteriaId": "51D25D9F-2F3B-4A9A-B468-1DF8EB682692"}, {"vulnerable": true, "criteria": "cpe:2.3:a:splunk:splunk:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "9.1.0", "versionEndExcluding": "9.1.3", "matchCriteriaId": "125F126C-4B0F-4B3D-891F-498E6DE761D7"}]}]}], "references": [{"url": "https://advisory.splunk.com/advisories/SVD-2024-0106", "source": "prodsec@splunk.com", "tags": ["Vendor Advisory"]}, {"url": "https://research.splunk.com/application/ee69374a-d27e-4136-adac-956a96ff60fd/", "source": "prodsec@splunk.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0005", "comment": "CVE-2024-23676 - Splunk \u2018mrollup\u2019 SPL command vulnerability allows for unauthorized access to metrics. Relevant MITRE technique for exploitation is TA0005 - Defense Evasion"}, {"techniqueID": "TA0003", "comment": "CVE-2024-23676 - Manipulation of metrics for unauthorized access utilizing low-privileged user interaction. Relevant MITRE technique for exploitation is TA0003 - Command and Control"}, {"techniqueID": "TA0002", "comment": "CVE-2024-23676 - Customizable metrics for exploitation, requires high-privileged user interaction. Relevant MITRE technique for exploitation is TA0002 - Execution"}, {"techniqueID": "T1083", "comment": "CVE-2024-23676 - Command injection via the 'mrollup' SPL command to retrieve unauthorized metrics. Relevant MITRE technique for exploitation is T1083 - File and Directory Discovery"}, {"techniqueID": "T1047", "comment": "CVE-2024-23676 - Customizable metrics for exploitation to retrieve unauthorized information from Splunk. Relevant MITRE technique for exploitation is T1047 - Network Sniffing"}, {"techniqueID": "T1190", "comment": "CVE-2024-23676 - Customizable metrics for exploitation to retrieve unauthorized information from Splunk. Relevant MITRE technique for exploitation is T1190 - Exploit Public-Facing Application"}, {"techniqueID": "TA0038", "comment": "CVE-2024-23676 - Customizable metrics for exploitation to retrieve unauthorized information from Splunk. Relevant MITRE technique for exploitation is TA0038 - Custom Application"}], "stix_bundle": {"type": "bundle", "id": "CVE-2024-23676", "name": "CVE-2024-23676 - Splunk \u2018mrollup\u2019 SPL command vulnerability", "description": "This STIX 2.1 bundle expresses all the related techniques, risks and defense strategies for CVE-2024-23676.", "objects": [{"type": "vulnerability", "id": "CVE-2024-23676", "name": "CVE-2024-23676", "description": "In Splunk versions below 9.0.8 and 9.1.3, the \u201cmrollup\u201d SPL command lets a low-privileged user view metrics on an index that they do not have permission to view."}, {"type": "indicator", "id": "indicator-1", "name": "Unauthorized Metrics Access", "description": "Indication of unauthorized metrics access in Splunk."}, {"type": "course-of-action", "id": "COA-1", "name": "Patch and Update Splunk", "description": "Apply the latest patch and update Splunk to the latest version (9.0.8 and 9.1.3) to mitigate the vulnerability."}, {"type": "course-of-action", "id": "COA-2", "name": "Monitor SPL Command", "description": "Monitor the \u2018mrollup\u2019 SPL command for unauthorized access and alert on any suspicious activity."}, {"type": "course-of-action", "id": "COA-3", "name": "Restrict Access", "description": "Restrict access to the \u2018mrollup\u2019 SPL command to only authorized users with the necessary permissions."}], "relationships": [{"source_ref": "CVE-2024-23676", "target_ref": "TA0005", "type": "exploit"}, {"source_ref": "CVE-2024-23676", "target_ref": "COA-1", "type": "mitigation"}, {"source_ref": "CVE-2024-23676", "target_ref": "COA-2", "type": "monitor"}, {"source_ref": "CVE-2024-23676", "target_ref": "COA-3", "type": "restriction"}]}, "technical_analysis": {"Introduction": "The Splunk \u2018mrollup\u2019 SPL command vulnerability (CVE-2024-23676) allows low-privileged users to view metrics on an index they do not have permission to view.", "Impact and Scope": "The vulnerability has a CVSS score of 3.5 (Low) with a potential attack vector of NETWORK and a user interaction requirement.", "Related MITRE ATT&CK Techniques": "Related MITRE ATT&CK techniques for this vulnerability include TA0005, TA0003, TA0002, T1083, T1047, T1190, and TA0038.", "Technical Details": "The vulnerability is exploited by interacting with the \u2018mrollup\u2019 SPL command, allowing the attacker to view unauthorized metrics.", "Detection": "Detection methods include monitoring the \u2018mrollup\u2019 SPL command for unusual activity and alerting on any suspicious metrics retrieval.", "Mitigation": "Mitigation strategies include patching and updating Splunk to the latest version, monitoring the \u2018mrollup\u2019 SPL command, and restricting access to the command.", "Conclusion": "The Splunk \u2018mrollup\u2019 SPL command vulnerability highlights the importance of proper access control and monitoring in Splunk environments."}, "executive_analysis": {"Overview": "The Splunk \u2018mrollup\u2019 SPL command vulnerability is a critical issue that requires immediate attention.", "Business Impact": "The vulnerability has the potential to compromise sensitive information and data.", "Technical Impact": "The vulnerability allows unauthorized access to metrics, which can be used to gather sensitive information.", "Mitigation Strategies": "Recommendations include patching and updating Splunk, monitoring the \u2018mrollup\u2019 SPL command, and restricting access to the command.", "Recommendations": "Executives are advised to prioritize patching and updating Splunk, as well as conducting regular security assessments to detect and prevent similar vulnerabilities.", "Conclusions": "The Splunk \u2018mrollup\u2019 SPL command vulnerability emphasizes the importance of proactive security measures and regular security assessments to ensure the integrity of sensitive information and data."}}