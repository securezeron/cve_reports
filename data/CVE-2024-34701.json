{"id": "CVE-2024-34701", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-14T15:39:28.940", "lastModified": "2024-05-14T16:12:23.490", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "CreateWiki is Miraheze's MediaWiki extension for requesting & creating wikis. It is possible for users to be considered as the requester of a specific wiki request if their local user ID on any wiki in a wiki farm matches the local ID of the requester at the wiki where the wiki request was made. This allows them to go to that request entry's on Special:RequestWikiQueue on the wiki where their local user ID matches and take any actions that the wiki requester is allowed to take from there.\n\nCommit 02e0f298f8d35155c39aa74193cb7b867432c5b8 fixes the issue. Important note about the fix: This vulnerability has been fixed by disabling access to the REST API and special pages outside of the wiki configured as the \"global wiki\" in `$wgCreateWikiGlobalWiki` in a user's MediaWiki settings.\n\nAs a workaround, it is possible to disable the special pages outside of one's own global wiki by doing something similar to `miraheze/mw-config` commit e5664995fbb8644f9a80b450b4326194f20f9ddc that is adapted to one's own setup. As for the REST API, before the fix, there wasn't any REST endpoint that allowed one to make writes. Regardless, it is possible to also disable it outside of the global wiki by using `$wgCreateWikiDisableRESTAPI` and `$wgConf` in the configuration for one's own wiki farm.."}, {"lang": "es", "value": "CreateWiki es la extensi\u00f3n MediaWiki de Miraheze para solicitar y crear wikis. Es posible que los usuarios sean considerados solicitantes de una solicitud de wiki espec\u00edfica si su ID de usuario local en cualquier wiki de una granja de wiki coincide con la ID local del solicitante en el wiki donde se realiz\u00f3 la solicitud de wiki. Esto les permite ir a la entrada de esa solicitud en Special:RequestWikiQueue en el wiki donde coincide su ID de usuario local y realizar cualquier acci\u00f3n que el solicitante del wiki pueda realizar desde all\u00ed. el commit 02e0f298f8d35155c39aa74193cb7b867432c5b8 soluciona el problema. Nota importante sobre la soluci\u00f3n: esta vulnerabilidad se solucion\u00f3 deshabilitando el acceso a la API REST y a p\u00e1ginas especiales fuera del wiki configurado como \"wiki global\" en `$wgCreateWikiGlobalWiki` en la configuraci\u00f3n de MediaWiki de un usuario. Como workaround, es posible desactivar las p\u00e1ginas especiales fuera de la propia wiki global haciendo algo similar a `miraheze/mw-config` commit e5664995fbb8644f9a80b450b4326194f20f9ddc que se adapta a la propia configuraci\u00f3n. En cuanto a la API REST, antes de la soluci\u00f3n, no hab\u00eda ning\u00fan endpoint REST que permitiera realizar escrituras. De todos modos, tambi\u00e9n es posible deshabilitarlo fuera del wiki global usando `$wgCreateWikiDisableRESTAPI` y `$wgConf` en la configuraci\u00f3n de la propia granja de wiki."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.2, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-863"}]}], "references": [{"url": "https://github.com/miraheze/CreateWiki/commit/02e0f298f8d35155c39aa74193cb7b867432c5b8", "source": "security-advisories@github.com"}, {"url": "https://github.com/miraheze/CreateWiki/security/advisories/GHSA-89fx-77w7-rc64", "source": "security-advisories@github.com"}, {"url": "https://github.com/miraheze/mw-config/commit/1798e53901a202b62edab32f8bcd5c6b9e574191", "source": "security-advisories@github.com"}, {"url": "https://github.com/miraheze/mw-config/commit/e5664995fbb8644f9a80b450b4326194f20f9ddc", "source": "security-advisories@github.com"}, {"url": "https://issue-tracker.miraheze.org/T12011", "source": "security-advisories@github.com"}, {"url": "https://issue-tracker.miraheze.org/T12102", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-34701: Manipulate authenticated API requests - Attackers could manipulate authenticated API requests to gain unauthorized access to specific wiki request entries."}, {"techniqueID": "T1260", "comment": "CVE-2024-34701: Conduct command and control - After gaining unauthorized access, attackers could conduct command and control activities to maintain persistence."}, {"techniqueID": "T1210", "comment": "CVE-2024-34701: Exploit public-facing application - Public-facing applications with vulnerable MediaWiki instances could be exploited to gain unauthorized access."}, {"techniqueID": "T1110", "comment": "CVE-2024-34701: Use existing account - Attackers could use existing user accounts to gain unauthorized access to specific wiki request entries."}, {"techniqueID": "T1204", "comment": "CVE-2024-34701: Exploit remote-services - Remote services with vulnerable MediaWiki instances could be exploited to gain unauthorized access."}, {"techniqueID": "T1133", "comment": "CVE-2024-34701: Attack web servers - Web servers hosting vulnerable MediaWiki instances could be attacked to gain unauthorized access."}], "stix_bundle": {"bundle": {"id": "urn:uuid:43f9bce9-4f06-4c1a-8a18-3e4f9f97e5b7", "type": "bundle", "created_by_ref": "https://stix.example.com/sme", "created": "2024-05-14T16:13:55.000Z", "modified": "2024-05-14T16:13:55.000Z", "description": "STIX Bundle for CVE-2024-34701", "objects": [{"id": "urn:uuid:43f9bce9-4f06-4c1a-8a18-3e4f9f97e5b7", "type": "indicator", "title": "CVE-2024-34701 Indicator", "description": "Indicator for CVE-2024-34701", "created_by_ref": "https://stix.example.com/sme", "created": "2024-05-14T16:13:55.000Z", "modified": "2024-05-14T16:13:55.000Z", "pattern": "https://github.com/miraheze/CreateWiki/commit/02e0f298f8d35155c39aa74193cb7b867432c5b8", "validATES": true}, {"id": "urn:uuid:12345678-1234-1234-1234-123456789012", "type": " tactic", "title": "CVE-2024-34701 Tactic", "description": "Tactic for CVE-2024-34701", "created_by_ref": "https://stix.example.com/sme", "created": "2024-05-14T16:13:55.000Z", "modified": "2024-05-14T16:13:55.000Z", "name": "Exploit Public-Facing Application"}, {"id": "urn:uuid:98765432-0987-0987-0987-678901234567", "type": "course-of-action", "title": "CVE-2024-34701 Course of Action", "description": "Course of Action for CVE-2024-34701", "created_by_ref": "https://stix.example.com/sme", "created": "2024-05-14T16:13:55.000Z", "modified": "2024-05-14T16:13:55.000Z", "name": "Block access to vulnerable wiki pages"}], "relationship": [{"id": "urn:uuid:11111111-1111-1111-1111-111111111111", "type": "has-indicator", "created_by_ref": "https://stix.example.com/sme", "created": "2024-05-14T16:13:55.000Z", "modified": "2024-05-14T16:13:55.000Z", "indicator_ref": {"id": "urn:uuid:43f9bce9-4f06-4c1a-8a18-3e4f9f97e5b7"}, "tactic_ref": {"id": "urn:uuid:12345678-1234-1234-1234-123456789012"}}, {"id": "urn:uuid:22222222-2222-2222-2222-222222222222", "type": "mitigates", "created_by_ref": "https://stix.example.com/sme", "created": "2024-05-14T16:13:55.000Z", "modified": "2024-05-14T16:13:55.000Z", "tactic_ref": {"id": "urn:uuid:12345678-1234-1234-1234-123456789012"}, "course-of-action_ref": {"id": "urn:uuid:98765432-0987-0987-0987-678901234567"}}]}}, "technical_analysis": {"Introduction": "MediaWiki extension CreateWiki allows users to request and create wikis, but a vulnerability in this extension allows attackers to gain unauthorized access to specific wiki request entries.", "Impact and Scope": "This vulnerability has a CVSS score of 5.9, with a vulnerability vector of CVE-2024-34701. This vulnerability allows attackers to conduct command and control activities, conduct reconnaissance, and exploit public-facing application.", "Related MITRE ATT&CK Techniques": "T1059: Manipulate authenticated API requests, T1260: Conduct command and control, T1210: Exploit public-facing application, T1110: Use existing account, T1204: Exploit remote services, T1133: Attack web servers", "Technical Details": "The vulnerability is due to insufficient access controls in the CreateWiki extension. An attacker could manipulate authenticated API requests to gain unauthorized access to specific wiki request entries.", "Detection": "Detection is difficult, as the attacker could use existing user accounts to gain access.", "Mitigation": "Block access to vulnerable wiki pages, disable access to REST API and special pages outside of the global wiki, and restrict access to public-facing application.", "Conclusion": "CVE-2024-34701 is a critical vulnerability in the MediaWiki extension CreateWiki, allowing attackers to gain unauthorized access. It is essential to patch the vulnerability and implement defensive measures to prevent attacks."}, "executive_analysis": {"Overview": "A critical vulnerability in the MediaWiki extension CreateWiki allows attackers to gain unauthorized access to specific wiki request entries.", "Business Impact": "This vulnerability could allow attackers to conduct command and control activities, conduct reconnaissance, and exploit public-facing application, potentially leading to data breaches and other malicious activities.", "Technical Impact": "The vulnerability could allow attackers to conduct command and control activities, conduct reconnaissance, and exploit public-facing application.", "Mitigation Strategies": "Block access to vulnerable wiki pages, disable access to REST API and special pages outside of the global wiki, and restrict access to public-facing application.", "Recommendations": "Patching the vulnerability, implementing defensive measures, and conducting regular security audits.", "Conclusions": "It is essential to patch the vulnerability and implement defensive measures to prevent attacks."}}