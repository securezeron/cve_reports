{"id": "CVE-2024-26886", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-17T11:15:10.253", "lastModified": "2024-04-17T12:48:07.510", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: af_bluetooth: Fix deadlock\n\nAttemting to do sock_lock on .recvmsg may cause a deadlock as shown\nbellow, so instead of using sock_sock this uses sk_receive_queue.lock\non bt_sock_ioctl to avoid the UAF:\n\nINFO: task kworker/u9:1:121 blocked for more than 30 seconds.\n      Not tainted 6.7.6-lemon #183\nWorkqueue: hci0 hci_rx_work\nCall Trace:\n <TASK>\n __schedule+0x37d/0xa00\n schedule+0x32/0xe0\n __lock_sock+0x68/0xa0\n ? __pfx_autoremove_wake_function+0x10/0x10\n lock_sock_nested+0x43/0x50\n l2cap_sock_recv_cb+0x21/0xa0\n l2cap_recv_frame+0x55b/0x30a0\n ? psi_task_switch+0xeb/0x270\n ? finish_task_switch.isra.0+0x93/0x2a0\n hci_rx_work+0x33a/0x3f0\n process_one_work+0x13a/0x2f0\n worker_thread+0x2f0/0x410\n ? __pfx_worker_thread+0x10/0x10\n kthread+0xe0/0x110\n ? __pfx_kthread+0x10/0x10\n ret_from_fork+0x2c/0x50\n ? __pfx_kthread+0x10/0x10\n ret_from_fork_asm+0x1b/0x30\n </TASK>"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: Bluetooth: af_bluetooth: Reparar interbloqueo Intentar ejecutar sock_lock en .recvmsg puede causar un interbloqueo como se muestra a continuaci\u00f3n, por lo que en lugar de usar sock_sock, usa sk_receive_queue.lock en bt_sock_ioctl para evitar el UAF: INFORMACI\u00d3N: tarea kworker/u9:1:121 bloqueada durante m\u00e1s de 30 segundos. No contaminado 6.7.6-lemon #183 Cola de trabajo: hci0 hci_rx_work Seguimiento de llamadas:  __schedule+0x37d/0xa00 Schedule+0x32/0xe0 __lock_sock+0x68/0xa0 ? __pfx_autoremove_wake_function+0x10/0x10 lock_sock_nested+0x43/0x50 l2cap_sock_recv_cb+0x21/0xa0 l2cap_recv_frame+0x55b/0x30a0 ? psi_task_switch+0xeb/0x270? terminar_task_switch.isra.0+0x93/0x2a0 hci_rx_work+0x33a/0x3f0 proceso_one_work+0x13a/0x2f0 trabajador_thread+0x2f0/0x410 ? __pfx_worker_thread+0x10/0x10 kthread+0xe0/0x110 ? __pfx_kthread+0x10/0x10 ret_from_fork+0x2c/0x50 ? __pfx_kthread+0x10/0x10 ret_from_fork_asm+0x1b/0x30 "}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/2c9e2df022ef8b9d7fac58a04a2ef4ed25288955", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/64be3c6154886200708da0dfe259705fb992416c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/817e8138ce86001b2fa5c63d6ede756e205a01f7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/cb8adca52f306563d958a863bb0cbae9c184d1ae", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f7b94bdc1ec107c92262716b073b3e816d4784fb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "The fact that a deadlock has been resolved in the Linux kernel's Bluetooth module, specifically in the af_bluetooth function, suggests a potential attacker may try to exploit this vulnerability to achieve a deadlock, particularly in the l2cap_sock_recv_cb function. This could allow an attacker to gain unauthorized access to the system."}, {"techniqueID": "T1505", "comment": "The reported UAF (Use-After-Free) issue in the l2cap_sock_recv_cb function could be exploited by an attacker to write arbitrary data to a free memory location, potentially leading to code execution or other malicious actions."}, {"techniqueID": "T1210", "comment": "The presence of a potential deadlock in the Linux kernel's Bluetooth module, combined with the reported UAF issue, could allow an attacker to gain unauthorized access to the system. This could potentially be achieved by manipulating the sk_receive_queue.lock variable in the bt_sock_ioctl function."}, {"techniqueID": "T1027", "comment": "The fact that the vulnerability is located in the Linux kernel's Bluetooth module, specifically in the af_bluetooth function, suggests a potential attacker may try to exploit this vulnerability to achieve code execution or other malicious actions."}], "technical_analysis": {"Introduction": "The CVE-2024-26886 vulnerability is a resolved issue in the Linux kernel's Bluetooth module that could have allowed an attacker to gain unauthorized access to the system.", "Impact and Scope": "The impact of this vulnerability is a potential deadlock and UAF issue in the l2cap_sock_recv_cb function, affecting systems with the affected kernel version.", "Related MITRE ATT&CK Techniques": "T1190, T1505, T1210, T1027", "Technical Details": "The vulnerability is located in the af_bluetooth function of the Linux kernel's Bluetooth module.", "Detection": "Detection of this vulnerability may involve monitoring system logs for evidence of the reported UAF issue or deadlock.", "Mitigation": "Mitigation strategies for this vulnerability include updating to the latest kernel version and disabling Bluetooth functionality.", "Conclusion": "The CVE-2024-26886 vulnerability has been resolved in the Linux kernel's Bluetooth module."}, "executive_analysis": {"Overview": "The CVE-2024-26886 vulnerability is a resolved issue in the Linux kernel's Bluetooth module.", "Business Impact": "The business impact of this vulnerability is a potential risk to system security, which could result in unauthorized access to sensitive data or systems.", "Technical Impact": "The technical impact of this vulnerability is a potential deadlock and UAF issue in the l2cap_sock_recv_cb function.", "Mitigation Strategies": "Disabling Bluetooth functionality and updating to the latest kernel version are recommended mitigation strategies.", "Recommendations": "We recommend that all affected systems be updated to the latest kernel version and that Bluetooth functionality be disabled until further notice.", "Conclusions": "The CVE-2024-26886 vulnerability has been resolved, but it is still important to take steps to mitigate the potential risks and maintain system security."}}