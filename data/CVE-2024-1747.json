{"id": "CVE-2024-1747", "sourceIdentifier": "contact@wpscan.com", "published": "2024-08-01T06:15:01.980", "lastModified": "2024-08-01T15:35:05.150", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The WooCommerce Customers Manager WordPress plugin before 30.2 does not have authorisation and CSRF in various AJAX actions, allowing any authenticated users, such as subscriber, to call them and update/delete/create customer metadata, also leading to Stored Cross-Site Scripting due to the lack of escaping of said metadata values."}, {"lang": "es", "value": " El complemento de WordPress WooCommerce Customers Manager anterior a 30.2 no tiene autorizaci\u00f3n ni CSRF en varias acciones AJAX, lo que permite a cualquier usuario autenticado, como un suscriptor, llamarlos y actualizar/eliminar/crear metadatos del cliente, lo que tambi\u00e9n genera Cross Site Scripting almacenado debido a la falta de escape de dichos valores de metadatos."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 3.7}]}, "references": [{"url": "https://wpscan.com/vulnerability/17e45d4d-0ee1-4863-a8a4-df8587f448ec/", "source": "contact@wpscan.com"}], "techniques": [{"techniqueID": "T1047", "comment": "CVE-2024-1747 - An unauthorised user can utilise CSRF to update/delete/create customer metadata, leading to Stored Cross-Site Scripting due to lack of escaping of metadata values, which can be exploited to infiltrate the system. This technique is relevant as it demonstrates an example of how an attacker can abuse the plugin's lack of CSRF protection."}, {"techniqueID": "T1190", "comment": "CVE-2024-1747 - An attacker can leverage the lack of authorisation and CSRF protection in various AJAX actions to update/delete/create customer metadata, thereby causing Persistent XSS, which can be used to inject malicious code and conduct further attacks. This technique is relevant as it highlights the significance of proper authorisation and CSRF protection in preventing such vulnerabilities."}, {"techniqueID": "T1505", "comment": "CVE-2024-1747 - An attacker can exploit the stored XSS to conduct further attacks, such as stealing or manipulating customer data, which can result in significant business and reputational damage, as well as compromise user privacy and security. This technique is relevant as it illustrates the potential consequences of failing to properly secure the server-side output."}], "stix_bundle": "Replace with the corresponding STIX 2.1 bundle.", "technical_analysis": {"Introduction": "The WooCommerce Customers Manager plugin, prior to version 30.2, is vulnerable to several security flaws, including an unauthorised access issue and a stored Cross-Site Scripting (XSS) vulnerability.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5 (MEDIUM) with a medium attack complexity, and affects all authenticated users, including subscribers, allowing them to update, delete, or create customer metadata. This could potentially lead to Stored Cross-Site Scripting due to the lack of escaping of metadata values.", "Related MITRE ATT&CK Techniques": "T1047: Web Shell, T1190: Exploitation of Remote Services, T1505: Crypto Malware.", "Technical Details": "The plugin lacks authorisation and CSRF protection in various AJAX actions, allowing authenticated users to update, delete, or create customer metadata, which can be used to inject malicious code and conduct further attacks.", "Detection": "Detection methods may include monitoring for suspicious API requests, monitoring for stored XSS payloads, and monitoring for unusual customer metadata modifications.", "Mitigation": "The vulnerability can be mitigated by implementing proper authorisation and CSRF protection in the plugin, patching the plugin to version 30.2 or later, and regularly monitoring for suspicious activity and updating the plugin as needed.", "Conclusion": "The vulnerability in the WooCommerce Customers Manager plugin highlights the importance of ensuring proper security measures, including authorisation and CSRF protection, are implemented in web applications to prevent unauthorised access and Stored Cross-Site Scripting."}, "executive_analysis": {"Overview": "The WooCommerce Customers Manager plugin, prior to version 30.2, contains several security flaws that can be exploited by attackers.", "Business Impact": "The vulnerability can lead to Stored Cross-Site Scripting and potential theft or manipulation of customer data, resulting in significant business and reputational damage.", "Technical Impact": "The vulnerability can be exploited to inject malicious code and conduct further attacks, compromising user privacy and security.", "Mitigation Strategies": "Implement proper authorisation and CSRF protection, patch the plugin to version 30.2 or later, and regularly monitor for suspicious activity.", "Recommendations": "Take immediate action to address the vulnerability, implement robust security measures, and consider conducting a thorough risk assessment and security audit.", "Conclusions": "The vulnerability highlights the critical need for vigilance in ensuring the security and integrity of web applications to prevent unauthorised access and damage to business operations."}}