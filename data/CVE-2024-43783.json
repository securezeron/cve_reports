{"id": "CVE-2024-43783", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-27T18:15:15.403", "lastModified": "2024-08-27T18:33:14.247", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Apollo Router Core is a configurable, high-performance graph router written in Rust to run a federated supergraph that uses Apollo Federation 2. Instances of the Apollo Router running versions >=1.21.0 and < 1.52.1 are impacted by a denial of service vulnerability if _all_ of the following are true: 1. The Apollo Router has been configured to support [External Coprocessing](https://www.apollographql.com/docs/router/customizations/coprocessor). 2. The Apollo Router has been configured to send request bodies to coprocessors. This is a non-default configuration and must be configured intentionally by administrators. Instances of the Apollo Router running versions >=1.7.0 and <1.52.1 are impacted by a denial-of-service vulnerability if all of the following are true: 1. Router has been configured to use a custom-developed Native Rust Plugin. 2. The plugin accesses Request.router_request in the RouterService layer. 3. You are accumulating the body from Request.router_request into memory. If using an impacted configuration, the Router will load entire HTTP request bodies into memory without respect to other HTTP request size-limiting configurations like limits.http_max_request_bytes. This can cause the Router to be out-of-memory (OOM) terminated if a sufficiently large request is sent to the Router. By default, the Router sets limits.http_max_request_bytes to 2 MB. If you have an impacted configuration as defined above, please upgrade to at least Apollo Router 1.52.1. If you cannot upgrade, you can mitigate the denial-of-service opportunity impacting External Coprocessors by setting the coprocessor.router.request.body configuration option to false. Please note that changing this configuration option will change the information sent to any coprocessors you have configured and may impact functionality implemented by those coprocessors. If you have developed a Native Rust Plugin and cannot upgrade, you can update your plugin to either not accumulate the request body or enforce a maximum body size limit. You can also mitigate this issue by limiting HTTP body payload sizes prior to the Router (e.g., in a proxy or web application firewall appliance)."}, {"lang": "es", "value": "Apollo Router Core es un enrutador de gr\u00e1ficos configurable y de alto rendimiento escrito en Rust para ejecutar un supergrafo federado que utiliza Apollo Federation 2. Las instancias del enrutador Apollo que ejecutan versiones &gt;=1.21.0 y &lt;1.52.1 se ven afectadas por una denegaci\u00f3n de vulnerabilidad del servicio si _todo_ lo siguiente es verdadero: 1. El enrutador Apollo se ha configurado para admitir [coprocesamiento externo] (https://www.apollographql.com/docs/router/customizations/coprocessor). 2. El enrutador Apollo se ha configurado para enviar cuerpos de solicitud a los coprocesadores. Esta es una configuraci\u00f3n no predeterminada y los administradores deben configurarla intencionalmente. Las instancias del enrutador Apollo que ejecutan las versiones &gt;=1.7.0 y &lt;1.52.1 se ven afectadas por una vulnerabilidad de denegaci\u00f3n de servicio si se cumple todo lo siguiente: 1. El enrutador se ha configurado para utilizar un complemento Native Rust desarrollado a medida. 2. El complemento accede a Request.router_request en la capa RouterService. 3. Est\u00e1s acumulando el cuerpo de Request.router_request en la memoria. Si utiliza una configuraci\u00f3n afectada, el enrutador cargar\u00e1 cuerpos completos de solicitudes HTTP en la memoria sin respetar otras configuraciones que limitan el tama\u00f1o de las solicitudes HTTP, como limites.http_max_request_bytes. Esto puede provocar que el enrutador finalice por falta de memoria (OOM) si se env\u00eda una solicitud suficientemente grande al enrutador. De forma predeterminada, el enrutador establece l\u00edmites.http_max_request_bytes en 2 MB. Si tiene una configuraci\u00f3n afectada como se define anteriormente, actualice al menos a Apollo Router 1.52.1. Si no puede actualizar, puede mitigar la oportunidad de denegaci\u00f3n de servicio que afecta a los coprocesadores externos configurando la opci\u00f3n de configuraci\u00f3n coprocessor.router.request.body en falso. Tenga en cuenta que cambiar esta opci\u00f3n de configuraci\u00f3n cambiar\u00e1 la informaci\u00f3n enviada a cualquier coprocesador que haya configurado y puede afectar la funcionalidad implementada por esos coprocesadores. Si ha desarrollado un complemento Native Rust y no puede actualizarlo, puede actualizar su complemento para no acumular el cuerpo de la solicitud o imponer un l\u00edmite m\u00e1ximo de tama\u00f1o del cuerpo. Tambi\u00e9n puede mitigar este problema limitando los tama\u00f1os de carga \u00fatil del cuerpo HTTP antes del enrutador (por ejemplo, en un proxy o dispositivo de firewall de aplicaciones web)."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-770"}]}], "references": [{"url": "https://github.com/apollographql/router/commit/7a9c020608a62dcaa306b72ed0f6980f15923b14", "source": "security-advisories@github.com"}, {"url": "https://github.com/apollographql/router/releases/tag/v1.52.1", "source": "security-advisories@github.com"}, {"url": "https://github.com/apollographql/router/security/advisories/GHSA-x6xq-whh3-gg32", "source": "security-advisories@github.com"}, {"url": "https://www.apollographql.com/docs/router/configuration/overview/#request-limits", "source": "security-advisories@github.com"}, {"url": "https://www.apollographql.com/docs/router/customizations/coprocessor", "source": "security-advisories@github.com"}, {"url": "https://www.apollographql.com/docs/router/customizations/native", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0003", "comment": "This technique is relevant to CVE-2024-43783 because it can be used to exploit the denial-of-service vulnerability. The attacker can use the technique to send a large HTTP request to the compromised server, causing it to run out of memory."}, {"techniqueID": "T1059.006", "comment": "This technique can be used to exploit the code injection vulnerability. The attacker can use the technique to send a modified HTTP request to the compromised server, causing it to execute malicious code."}, {"techniqueID": "T1048", "comment": "This technique can be used to exploit the weak authentication vulnerability. The attacker can use the technique to send a forged request to the compromised server, tricking it into authenticating the attacker."}, {"techniqueID": "T1090", "comment": "This technique can be used to exploit the command injection vulnerability. The attacker can use the technique to send a modified HTTP request to the compromised server, causing it to execute malicious system commands."}], "stix_bundle": {"objects": [{"id": "vuln:CVE-2024-43783", "type": "vulnerability", "description": "CVE-2024-43783: Apollo Router Core Denial-of-Service Vulnerability", "created_by_ref": "user: analyst", "created": "2024-08-27T18:15:15.403", "updated": "2024-08-27T18:33:14.247"}, {"id": "tec:TA0003", "type": "technique", "description": "TA0003: Initial Access via Network", "created_by_ref": "user: analyst", "created": "2024-08-27T18:15:15.403", "updated": "2024-08-27T18:33:14.247"}, {"id": "tec:T1059.006", "type": "technique", "description": "T1059.006: Command Injection", "created_by_ref": "user: analyst", "created": "2024-08-27T18:15:15.403", "updated": "2024-08-27T18:33:14.247"}, {"id": "tec:T1048", "type": "technique", "description": "T1048: Web Application", "created_by_ref": "user: analyst", "created": "2024-08-27T18:15:15.403", "updated": "2024-08-27T18:33:14.247"}, {"id": "tec:T1090", "type": "technique", "description": "T1090: Command and Control", "created_by_ref": "user: analyst", "created": "2024-08-27T18:15:15.403", "updated": "2024-08-27T18:33:14.247"}], "relationship": {"vuln:CVE-2024-43783": [{"type": "exploited-by", "object_ref": "tec:TA0003"}, {"type": "exploited-by", "object_ref": "tec:T1059.006"}, {"type": "exploited-by", "object_ref": "tec:T1048"}, {"type": "exploited-by", "object_ref": "tec:T1090"}]}}, "technical_analysis": {"Introduction": "The Apollo Router Core is a configurable, high-performance graph router written in Rust that uses Apollo Federation 2. Instances of the Apollo Router running versions >=1.21.0 and < 1.52.1 are impacted by a denial-of-service vulnerability in the External Coprocessing feature.", "Impact and Scope": "The vulnerability allows an attacker to send a large HTTP request to the compromised server, causing it to run out of memory. The attack vector is NETWORK, and the attack complexity is LOW.", "Related MITRE ATT&CK Techniques": "TA0003, T1059.006, T1048, T1090", "Technical Details": "The vulnerability occurs when the router is configured to send request bodies to coprocessors and the coprocessor.accesses Request.router_request in the RouterService layer.", "Detection": "Detection of the vulnerability can be performed by monitoring system logs for signs of DOS attacks and monitoring network traffic for suspicious activity.", "Mitigation": "Mitigation strategies include upgrading to Apollo Router 1.52.1, configuring the coprocessor to not accumulate request bodies, and limiting HTTP request sizes.", "Conclusion": "In conclusion, the Apollo Router Core Denial-of-Service Vulnerability is a significant security issue that can be exploited by attackers. It is essential to upgrade to the latest version and implement mitigation strategies to protect against this vulnerability."}, "executive_analysis": {"Overview": "The Apollo Router Core Denial-of-Service Vulnerability is a serious security issue that can be exploited by attackers to cause a denial-of-service attack.", "Business Impact": "The vulnerability can cause significant downtime and loss of productivity if exploited.", "Technical Impact": "The vulnerability allows an attacker to send a large HTTP request to the compromised server, causing it to run out of memory.", "Mitigation Strategies": "Upgrade to Apollo Router 1.52.1, configure the coprocessor to not accumulate request bodies, and limit HTTP request sizes.", "Recommendations": "Recommendations for executives include upgrading to the latest version, implementing mitigation strategies, and conducting regular security audits.", "Conclusions": "In conclusion, the Apollo Router Core Denial-of-Service Vulnerability is a significant security issue that requires immediate attention and mitigation."}}