{"id": "CVE-2020-25846", "sourceIdentifier": "twcert@cert.org.tw", "published": "2020-12-31T08:15:13.363", "lastModified": "2021-01-06T14:41:23.340", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The digest generation function of NHIServiSignAdapter has not been verified for source file path, which leads to the SMB request being redirected to a malicious host, resulting in the leakage of user's credential."}, {"lang": "es", "value": "La funci\u00f3n digest generation de NHIServiSignAdapter no ha sido verificada para la ruta de archivo de origen, lo que conlleva que petici\u00f3n SMB sea redireccionada hacia un host malicioso, resultando en el filtrado de la credencial del usuario."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.0}, {"source": "twcert@cert.org.tw", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-601"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:panorama_project:nhiservisignadapter:1.0.20.0218:*:*:*:*:windows:*:*", "matchCriteriaId": "8CA254A8-7D44-440A-9FCA-02C36E32143F"}]}]}], "references": [{"url": "https://www.twcert.org.tw/tw/cp-132-4274-7bd65-1.html", "source": "twcert@cert.org.tw", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2020-25846 - Spearphishing attacks involve Social Engineering techniques to trick victims into providing sensitive information, which can lead to the exposure of credentials"}, {"techniqueID": "T1210", "comment": "CVE-2020-25846 - Input Validation and Manipulation techniques can be used to craft input that is used in SMB requests, which can lead to credential leakage"}, {"techniqueID": "T1190", "comment": "CVE-2020-25846 - Exploit publicly known vulnerabilities, such as the SMB vulnerability, to gain access to a system"}, {"techniqueID": "T1027", "comment": "CVE-2020-25846 - Use of SMB requests can be used to communicate with a remote shell, once access to the system is gained"}], "stix_bundle": {"bundle": {"Type": "bundle", "Id": "CVE2020_25846_STIX", "Generated_Date": "2023-03-15T14:30:00.000", "Valid_From": "2020-12-31T00:00:00.000", "Valid_To": "2023-03-15T00:00:00.000", "objects": {"vulnerability": {"Type": "vulnerability", "Id": "CVE-2020-25846", "Introduced_Through": "Unpatched software", "Description": "The digest generation function of NHIServiSignAdapter has not been verified for source file path, which leads to the SMB request being redirected to a malicious host, resulting in the leakage of user's credential.", "Related_Objects": [{"Type": "note", "Id": "NT-2020-25846-Tech-Detection", "Title": "Technical Detection for CVE-2020-25846"}]}, "note": {"Type": "note", "Id": "NT-2020-25846-Tech-Detection", "Title": "Technical Detection for CVE-2020-25846", "Description": "Detect the vulnerability by monitoring for SMB requests with invalid source file paths and redirecting them to a malicious host.", "Related_Objects": [{"Type": "course-of-action", "Id": "COA-2020-25846-Tech", "Title": "Technical Mitigation for CVE-2020-25846"}]}, "course-of-action": {"Type": "course-of-action", "Id": "COA-2020-25846-Tech", "Title": "Technical Mitigation for CVE-2020-25846", "Description": "Patch the vulnerability by updating the NHIServiSignAdapter software to the latest version.", "Related_Objects": [{"Type": "note", "Id": "NT-2020-25846-Exploit", "Title": "Exploit Details for CVE-2020-25846"}]}}}}, "technical_analysis": {"Introduction": "The vulnerability CVE-2020-25846 exists in the NHIServiSignAdapter software due to the lack of input validation.", "Impact and Scope": "The vulnerability allows an attacker to perform SMB requests with invalid source file paths, which can lead to credential leakage.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to the MITRE ATT&CK techniques TA0001, T1210, T1190, and T1027.", "Technical Details": "The vulnerability is located in the digest generation function of NHIServiSignAdapter, which does not verify the source file path.", "Detection": "Detection of this vulnerability can be done by monitoring for SMB requests with invalid source file paths.", "Mitigation": "Patch the vulnerability by updating the NHIServiSignAdapter software to the latest version.", "Conclusion": "The vulnerability CVE-2020-25846 is a significant risk and requires immediate attention to patch the software and implement detection and mitigation measures."}, "executive_analysis": {"Overview": "The vulnerability CVE-2020-25846 is a critical vulnerability that affects the NHIServiSignAdapter software.", "Business Impact": "The vulnerability can lead to credential leakage, which can result in financial loss and damage to reputation.", "Technical Impact": "The vulnerability affects the integrity of the system and allows an attacker to perform unauthorized actions.", "Mitigation Strategies": "Patch the vulnerability immediately and implement detection and mitigation measures to prevent attacks.", "Recommendations": "Recommend that all system administrators update the NHIServiSignAdapter software to the latest version and implement additional security measures.", "Conclusions": "The vulnerability CVE-2020-25846 is a significant risk and requires immediate attention to patch the software and implement detection and mitigation measures."}}