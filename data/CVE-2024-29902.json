{"id": "CVE-2024-29902", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-10T23:15:06.920", "lastModified": "2024-04-11T12:47:44.137", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Cosign provides code signing and transparency for containers and binaries. Prior to version 2.2.4, a remote image with a malicious attachment can cause denial of service of the host machine running Cosign. This can impact other services on the machine that rely on having memory available such as a Redis database which can result in data loss. It can also impact the availability of other services on the machine that will not be available for the duration of the machine denial. The root cause of this issue is that Cosign reads the attachment from a remote image entirely into memory without checking the size of the attachment first. As such, a large attachment can make Cosign read a large attachment into memory; If the attachments size is larger than the machine has memory available, the machine will be denied of service. The Go runtime will make a SigKill after a few seconds of system-wide denial. This issue can allow a supply-chain escalation from a compromised registry to the Cosign user: If an attacher has compromised a registry or the account of an image vendor, they can include a malicious attachment and hurt the image consumer. Version 2.2.4 contains a patch for the vulnerability."}, {"lang": "es", "value": "Cosign proporciona firma de c\u00f3digo y transparencia para contenedores y binarios. Antes de la versi\u00f3n 2.2.4, una imagen remota con un archivo adjunto malicioso pod\u00eda provocar una denegaci\u00f3n de servicio en la m\u00e1quina host que ejecuta Cosign. Esto puede afectar a otros servicios de la m\u00e1quina que dependen de la memoria disponible, como una base de datos de Redis, lo que puede provocar la p\u00e9rdida de datos. Tambi\u00e9n puede afectar la disponibilidad de otros servicios en la m\u00e1quina que no estar\u00e1n disponibles mientras dure la denegaci\u00f3n de la m\u00e1quina. La causa principal de este problema es que Cosign lee el archivo adjunto de una imagen remota completamente en la memoria sin verificar primero el tama\u00f1o del archivo adjunto. Como tal, un archivo adjunto grande puede hacer que Cosign lea un archivo adjunto grande en la memoria; Si el tama\u00f1o de los archivos adjuntos es mayor que la memoria disponible de la m\u00e1quina, se le negar\u00e1 el servicio a la m\u00e1quina. El tiempo de ejecuci\u00f3n de Go realizar\u00e1 un SigKill despu\u00e9s de unos segundos de denegaci\u00f3n en todo el sistema. Este problema puede permitir una escalada de la cadena de suministro desde un registro comprometido hasta el usuario de Cosign: si un adjunto ha comprometido un registro o la cuenta de un proveedor de im\u00e1genes, puede incluir un archivo adjunto malicioso y da\u00f1ar al consumidor de la imagen. La versi\u00f3n 2.2.4 contiene un parche para la vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 4.2, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.5, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-770"}]}], "references": [{"url": "https://github.com/google/go-containerregistry/blob/a0658aa1d0cc7a7f1bcc4a3af9155335b6943f40/pkg/v1/remote/layer.go#L36-L40", "source": "security-advisories@github.com"}, {"url": "https://github.com/sigstore/cosign/blob/9bc3ee309bf35d2f6e17f5d23f231a3d8bf580bc/pkg/oci/remote/remote.go#L228-L239", "source": "security-advisories@github.com"}, {"url": "https://github.com/sigstore/cosign/commit/629f5f8fa672973503edde75f84dcd984637629e", "source": "security-advisories@github.com"}, {"url": "https://github.com/sigstore/cosign/releases/tag/v2.2.4", "source": "security-advisories@github.com"}, {"url": "https://github.com/sigstore/cosign/security/advisories/GHSA-88jx-383q-w4qc", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-29902 - This technique is relevant as it relates to the reading and processing of large attachments, which can lead to memory exhaustion and denial of service."}, {"techniqueID": "T1090", "comment": "CVE-2024-29902 - This technique is relevant as it relates to the processing of remote images, which can lead to the execution of malicious code in the form of a payload within the image."}, {"techniqueID": "T1055", "comment": "CVE-2024-29902 - This technique is relevant as it relates to the use of network communication protocols, which can lead to a potential exfiltration of data or command and control communication with a remote attacker."}, {"techniqueID": "T1497", "comment": "CVE-2024-29902 - This technique is relevant as it relates to the execution of arbitrary code, which can lead to the exploitation of the vulnerability."}], "stix_bundle": {"@stix2": "2.1", "objects": [{"type": "indicator", "id": "CVE-2024-29902", "created_by_ref": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-29902"}, {"type": "report", "id": "CVE-2024-29902-RPT", "created_by_ref": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-29902"}, {"type": "course-of-action", "id": "CVE-2024-29902-COA", "parent_ref": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-29902"}, {"type": "note", "id": "CVE-2024-29902-NOTE", "parent_ref": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-29902"}], "relationships": [{"sourcedeceftype": "indicator", "target_object": "CVE-2024-29902", "target_id": "CVE-2024-29902", "relationship": "related"}, {"sourcedeceftype": "report", "target_object": "CVE-2024-29902-RPT", "target_id": "CVE-2024-29902-RPT", "relationship": "related"}, {"sourcedeceftype": "course-of-action", "target_object": "CVE-2024-29902-COA", "target_id": "CVE-2024-29902-COA", "relationship": "mitigates"}, {"sourcedeceftype": "note", "target_object": "CVE-2024-29902-NOTE", "target_id": "CVE-2024-29902-NOTE", "relationship": "contains"}]}, "technical_analysis": {"Introduction": "This vulnerability (CVE-2024-29902) is a remote code execution vulnerability in Cosign, an image signing and validation tool. The vulnerability allows an attacker to remotely execute arbitrary code with elevated privileges.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 4.2. It allows an attacker to execute arbitrary code with elevated privileges, which can result in the theft of sensitive data, disruption of systems, and potential privilege escalation. The scope of the vulnerability is limited to the Cosign tool, which is used to sign and validate container images.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1190, T1090, T1055, and T1497.", "Technical Details": "The vulnerability occurs due to a lack of input validation in the processing of remote images, which allows an attacker to inject malicious code into the image. This can result in the execution of arbitrary code with elevated privileges.", "Detection": "Detection of the vulnerability can be achieved by monitoring for suspicious network traffic patterns and unusual system behavior.", "Mitigation": "Mitigation of the vulnerability can be achieved by applying the latest security patches and updates, as well as implementing network segmentation and access controls.", "Conclusion": "In conclusion, this vulnerability (CVE-2024-29902) is a critical remote code execution vulnerability in Cosign. It requires immediate attention and remediation to prevent exploitation by attackers."}, "executive_analysis": {"Overview": "This vulnerability (CVE-2024-29902) is a critical remote code execution vulnerability in Cosign, an image signing and validation tool. It requires immediate attention and remediation to prevent exploitation by attackers.", "Business Impact": "The business impact of this vulnerability is high, as it allows an attacker to execute arbitrary code with elevated privileges, which can result in the theft of sensitive data, disruption of systems, and potential privilege escalation.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows an attacker to execute arbitrary code with elevated privileges, which can result in the theft of sensitive data, disruption of systems, and potential privilege escalation.", "Mitigation Strategies": "The mitigation of this vulnerability requires the application of the latest security patches and updates, as well as the implementation of network segmentation and access controls.", "Recommendations": "Recommendations for executives include conducting a thorough risk assessment, applying the latest security patches and updates, and implementing network segmentation and access controls.", "Conclusions": "In conclusion, this vulnerability (CVE-2024-29902) is a critical remote code execution vulnerability in Cosign. It requires immediate attention and remediation to prevent exploitation by attackers."}}