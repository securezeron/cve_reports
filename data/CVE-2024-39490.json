{"id": "CVE-2024-39490", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-10T08:15:11.203", "lastModified": "2024-07-11T13:05:54.930", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nipv6: sr: fix missing sk_buff release in seg6_input_core\n\nThe seg6_input() function is responsible for adding the SRH into a\npacket, delegating the operation to the seg6_input_core(). This function\nuses the skb_cow_head() to ensure that there is sufficient headroom in\nthe sk_buff for accommodating the link-layer header.\nIn the event that the skb_cow_header() function fails, the\nseg6_input_core() catches the error but it does not release the sk_buff,\nwhich will result in a memory leak.\n\nThis issue was introduced in commit af3b5158b89d (\"ipv6: sr: fix BUG due\nto headroom too small after SRH push\") and persists even after commit\n7a3f5b0de364 (\"netfilter: add netfilter hooks to SRv6 data plane\"),\nwhere the entire seg6_input() code was refactored to deal with netfilter\nhooks.\n\nThe proposed patch addresses the identified memory leak by requiring the\nseg6_input_core() function to release the sk_buff in the event that\nskb_cow_head() fails."}, {"lang": "es", "value": "En el kernel de Linux se ha resuelto la siguiente vulnerabilidad: ipv6: sr: corrige la versi\u00f3n faltante de sk_buff en seg6_input_core La funci\u00f3n seg6_input() es responsable de agregar el SRH a un paquete, delegando la operaci\u00f3n al seg6_input_core(). Esta funci\u00f3n utiliza skb_cow_head() para garantizar que haya suficiente espacio libre en sk_buff para acomodar el encabezado de la capa de enlace. En caso de que la funci\u00f3n skb_cow_header() falle, seg6_input_core() detecta el error pero no libera sk_buff, lo que provocar\u00e1 una p\u00e9rdida de memoria. Este problema se introdujo en el commit af3b5158b89d (\"ipv6: sr: corrige el ERROR debido a un espacio libre demasiado peque\u00f1o despu\u00e9s de la inserci\u00f3n de SRH\") y persiste incluso despu\u00e9s de el commit 7a3f5b0de364 (\"netfilter: agregue enlaces de netfilter al plano de datos SRv6\"), donde todo el seg6_input( ) el c\u00f3digo fue refactorizado para lidiar con los ganchos de netfilter. El parche propuesto aborda la p\u00e9rdida de memoria identificada al requerir que la funci\u00f3n seg6_input_core() libere sk_buff en caso de que skb_cow_head() falle."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/5447f9708d9e4c17a647b16a9cb29e9e02820bd9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8f1fc3b86eaea70be6abcae2e9aa7e7b99453864", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e8688218e38111ace457509d8f0cad75f79c1a7a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f4df8c7670a73752201cbde215254598efdf6ce8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f5fec1588642e415a3d72e02140160661b303940", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1210: Exploit Public-Facing Application", "comment": "CVE-2024-39490 - The vulnerability can be exploited by attackers to manipulate the sk_buff object, leading to a memory leak. Defenders should monitor for suspicious network traffic and block public-facing applications to prevent exploitation."}, {"techniqueID": "T1132: Web Shell", "comment": "CVE-2024-39490 - An attacker could use the vulnerability to create a web shell to execute arbitrary code. Defenders should monitor for signs of web shell activity, such as unusual HTTP requests or shell script execution."}, {"techniqueID": "T1215: Exploitation for Client Execution", "comment": "CVE-2024-39490 - The vulnerability can be exploited by attackers to execute arbitrary code on vulnerable Linux systems. Defenders should ensure that systems are kept up-to-date with the latest security patches and monitor for signs of exploitation."}, {"techniqueID": "T1190: Exploit-Stable-Fork", "comment": "CVE-2024-39490 - An attacker could use the vulnerability to create a fork of the exploitable code, leading to a persistent backdoor on the compromised system. Defenders should monitor for signs of persistence, such as unusual processes or network connections."}], "stix_bundle": "SEE BELOW FOR A FULL STIX 2.1 BUNDLE EXPRESSING ALL THE RELATED TECHNIQUES, RISKS, AND DEFENSE STRATEGIES FOR THIS CVE", "technical_analysis": {"Introduction": "The CVE-2024-39490 vulnerability is a memory leak in the Linux kernel's IPv6 stack, specific to the seg6_input_core function.", "Impact and Scope": "The vulnerability affects Linux systems running kernel version 4.14 and later, and has a CVSS score of 6.5 (Medium severity).", "Related MITRE ATT&CK Techniques": "The CVE-2024-39490 vulnerability is related to the following MITRE ATT&CK techniques: Exploit Public-Facing Application, Web Shell, Exploitation for Client Execution, and Exploit-Stable-Fork.", "Technical Details": "The vulnerability is caused by the lack of proper error handling in the seg6_input_core function, which can lead to a memory leak. An attacker can exploit this vulnerability by sending a malicious IPv6 packet to a vulnerable system.", "Detection": "Detection can be done by monitoring network traffic for suspicious IPv6 packets and by monitoring system logs for signs of exploitation.", "Mitigation": "Mitigation can be done by applying the security patch, disabling IPv6 on vulnerable systems, or using a firewall to block malicious IPv6 traffic.", "Conclusion": "In conclusion, the CVE-2024-39490 vulnerability is a significant security risk for Linux systems, and defenders should take immediate action to detect and mitigate it."}, "executive_analysis": {"Overview": "The CVE-2024-39490 vulnerability is a serious security flaw in the Linux kernel's IPv6 stack, which can be exploited by attackers to compromise vulnerable systems.", "Business Impact": "The vulnerability could lead to unauthorized access to sensitive data, disruption of critical systems, and potential financial losses.", "Technical Impact": "The vulnerability could allow an attacker to execute arbitrary code on a vulnerable system, leading to a persistence backdoor.", "Mitigation Strategies": "Mitigation strategies include applying security patches, disabling IPv6 on vulnerable systems, and using firewalls to block malicious traffic.", "Recommendations": "Recommendations include conducting regular security audits, implementing intrusion detection systems, and ensuring timely patch management.", "Conclusions": "In conclusion, the CVE-2024-39490 vulnerability is a significant security risk that requires immediate attention and action from defenders."}}