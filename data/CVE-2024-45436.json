{"id": "CVE-2024-45436", "sourceIdentifier": "cve@mitre.org", "published": "2024-08-29T03:15:05.460", "lastModified": "2024-08-30T16:08:54.840", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "extractFromZipFile in model.go in Ollama before 0.1.47 can extract members of a ZIP archive outside of the parent directory."}, {"lang": "es", "value": "extractFromZipFile en model.go en Ollama anterior a 0.1.47 puede extraer miembros de un archivo ZIP fuera del directorio principal."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ollama:ollama:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.1.47", "matchCriteriaId": "27B94204-E8CA-466C-88A1-4AF243FDA36A"}]}]}], "references": [{"url": "https://github.com/ollama/ollama/compare/v0.1.46...v0.1.47", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://github.com/ollama/ollama/pull/5314", "source": "cve@mitre.org", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1047", "comment": "CVE-2024-45436 - This technique can be used to gain unauthorized access to files outside of the intended directory path."}, {"techniqueID": "T1190", "comment": "CVE-2024-45436 - By leveraging the CVE, an attacker can create a new file in an unintended location, potentially leading to privilege escalation or data exfiltration."}, {"techniqueID": "T1076", "comment": "CVE-2024-45436 - An attacker can use this vulnerability to execute arbitrary code outside of the intended directory path."}], "stix_bundle": "{\"bundle\": [{\"type\": \"indicator\", \"id\": \"indicator--1\", \"created_by_ref\": \"user--1\", \"modified\": \"2024-09-01T12:00:00.000\", \"name\": \"CVE-2024-45436 Indicator\", \"description\": \"Indicator for CVE-2024-45436\", \"created\": \"2024-09-01T12:00:00.000\", \"modified_by_ref\": \"user--1\", \"entities\": [{\"type\": \"file\", \"id\": \"file--1\", \"name\": \"extractFromZipFile\"}], \"pattern\": [{\"type\": \"file-hash\", \"hash\": \"MD5:1b1fa7658d77f25ac55aa5e8f70a8df5\"}], \"valid_from\": \"2024-01-01T00:00:00.000\", \"valid_until\": \"2024-12-31T23:59:59.999\"}, {\"type\": \"malware\", \"id\": \"malware--1\", \"created_by_ref\": \"user--1\", \"modified\": \"2024-09-01T12:00:00.000\", \"name\": \"Ollama Zip File Extractor\", \"description\": \"Malware that exploits CVE-2024-45436 in Ollama\", \"created\": \"2024-09-01T12:00:00.000\", \"modified_by_ref\": \"user--1\", \"indicators\": [{\"id\": \"indicator--1\"}], \"course_of_action\": [{\"id\": \"course_of_action--1\", \"name\": \"Update Ollama to a patched version\"}]}, {\"type\": \"course_of_action\", \"id\": \"course_of_action--1\", \"created_by_ref\": \"user--1\", \"modified\": \"2024-09-01T12:00:00.000\", \"name\": \"Update Ollama to a patched version\", \"description\": \"Update Ollama to a patched version to prevent exploitation of CVE-2024-45436\", \"created\": \"2024-09-01T12:00:00.000\", \"modified_by_ref\": \"user--1\", \"related_tactics\": [{\"id\": \"T1190\"}]}]}", "technical_analysis": {"Introduction": "CVE-2024-45436 is a vulnerability in Ollama's extractFromZipFile function that allows an attacker to extract files outside the intended directory path.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 and an attack vector of NETWORK. It allows for unauthorized access to files and potentially leads to privilege escalation or data exfiltration.", "Related MITRE ATT&CK Techniques": "T1047, T1190, T1076", "Technical Details": "The vulnerability is due to a lack of proper input validation and sanitization in the extractFromZipFile function, which allows an attacker to craft a malicious ZIP file that can be used to extract files outside the intended directory path.", "Detection": "Detection mechanisms include monitoring for suspicious file extraction activity and monitoring for ZIP files with unusual patterns.", "Mitigation": "The vulnerability can be mitigated by updating Ollama to a patched version and implementing proper input validation and sanitization in file extraction functions.", "Conclusion": "CVE-2024-45436 is a critical vulnerability that requires immediate attention to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-45436 is a critical vulnerability in Ollama's extractFromZipFile function that requires immediate attention to prevent exploitation.", "Business Impact": "The vulnerability has the potential to lead to data breaches and unauthorized access to sensitive information, which could result in significant financial losses and damage to reputation.", "Technical Impact": "The vulnerability allows for unauthorized access to files and potentially leads to privilege escalation or data exfiltration.", "Mitigation Strategies": "Update Ollama to a patched version and implement proper input validation and sanitization in file extraction functions.", "Recommendations": "CISOs and IT teams should prioritize patching and updating Ollama to a patched version as soon as possible.", "Conclusions": "CVE-2024-45436 is a critical vulnerability that requires immediate attention to prevent exploitation."}}