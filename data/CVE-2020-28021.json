{"id": "CVE-2020-28021", "sourceIdentifier": "cve@mitre.org", "published": "2021-05-06T13:15:09.640", "lastModified": "2021-05-10T16:23:49.257", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Exim 4 before 4.94.2 has Improper Neutralization of Line Delimiters. An authenticated remote SMTP client can insert newline characters into a spool file (which indirectly leads to remote code execution as root) via AUTH= in a MAIL FROM command."}, {"lang": "es", "value": "Exim 4 versiones anteriores a 4.94.2, presenta una Neutralizaci\u00f3n Inapropiada de Delimitadores de L\u00ednea.&#xa0;Un cliente SMTP remoto autenticado puede insertar caracteres newline en un archivo de cola (que indirectamente conlleva a una ejecuci\u00f3n de c\u00f3digo remota como root) por medio de AUTH= en un comando MAIL FROM"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:exim:exim:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.00", "versionEndExcluding": "4.94.2", "matchCriteriaId": "E0B1EAB0-1202-4BB9-94AF-CC07299D0256"}]}]}], "references": [{"url": "https://www.exim.org/static/doc/security/CVE-2020-qualys/CVE-2020-28021-MAUTH.txt", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-28021 - This vulnerability allows an authenticated remote SMTP client to inject newline characters into a spool file, which can lead to remote code execution as root. Defenders should focus on monitoring and analyzing mail server logs for unusual activity and implement strict access controls for remote SMTP clients."}, {"techniqueID": "T1059", "comment": "CVE-2020-28021 - This vulnerability uses Improper Neutralization of Line Delimiters to inject newline characters into a spool file, which is a common technique used by attackers. Defenders should implement strict input validation and sanitization to prevent these types of attacks."}, {"techniqueID": "T1509", "comment": "CVE-2020-28021 - This vulnerability is an example of a command injection attack, which can be mitigated by implementing proper input validation and sanitization, as well as monitoring and analyzing system logs for unusual activity."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle--1-1-1", "created_by_ref": "identity--1-1-1", "created": "2021-05-10T16:23:49.257", "modified": "2021-05-10T16:23:49.257", "objects": [{"type": "report", "id": "report--1-1-1", "created_by_ref": "identity--1-1-1", "created": "2021-05-10T16:23:49.257", "modified": "2021-05-10T16:23:49.257", "name": "Vulnerability Exploitation Analysis", "description": "An analysis of the vulnerability CVE-2020-28021, including related techniques, risks, and defense strategies.", "objects": [{"type": "indicator", "id": "indicator--1-1-1", "created_by_ref": "identity--1-1-1", "created": "2021-05-10T16:23:49.257", "modified": "2021-05-10T16:23:49.257", "name": "Indicator of Compromise", "description": "An indicator of compromise for the vulnerability CVE-2020-28021, including related techniques and risks.", "pattern": "An authenticated remote SMTP client injecting newline characters into a spool file", "valid_from": "2021-05-06T13:15:09.640", "valid_until": "2021-05-10T16:23:49.257", "labels": ["cve-2020-28021", "vulnerability-exploitation"]}, {"type": "course_of_action", "id": "course_of_action--1-1-1", "created_by_ref": "identity--1-1-1", "created": "2021-05-10T16:23:49.257", "modified": "2021-05-10T16:23:49.257", "name": "Defense Strategy", "description": "A defense strategy for mitigating the vulnerability CVE-2020-28021, including related techniques and risks.", "description_type": "markdown", "steps": [{"type": "note", "id": "note--1-1-1", "created_by_ref": "identity--1-1-1", "created": "2021-05-10T16:23:49.257", "modified": "2021-05-10T16:23:49.257", "name": "Note", "description": "Implement strict access controls for remote SMTP clients", "category": "mitigation"}], "labels": ["cve-2020-28021", "defense-strategy"]}]}]}, "technical_analysis": {"Introduction": "The CVE-2020-28021 vulnerability is a remote code execution vulnerability in Exim 4 before 4.94.2. It allows an authenticated remote SMTP client to inject newline characters into a spool file, which can lead to remote code execution as root.", "Impact and Scope": "The attack vector is NETWORK and the attack complexity is LOW. The confidentiality impact is HIGH, integrity impact is HIGH, and availability impact is HIGH. The base score is 8.8 and the base severity is HIGH.", "Related MITRE ATT&CK Techniques": "T1190, T1059, T1509", "Technical Details": "The vulnerability is caused by Improper Neutralization of Line Delimiters in Exim 4 before 4.94.2. It allows an attacker to inject newline characters into a spool file, which can lead to remote code execution as root.", "Detection": "Monitor and analyze mail server logs for unusual activity, such as unauthorized access or changes to mail server configurations.", "Mitigation": "Implement strict access controls for remote SMTP clients and ensure that all remote SMTP clients are authenticated and authorized.", "Conclusion": "The CVE-2020-28021 vulnerability is a critical remote code execution vulnerability that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The CVE-2020-28021 vulnerability is a critical remote code execution vulnerability in Exim 4 before 4.94.2.", "Business Impact": "The vulnerability poses a significant risk to business operations, as it can allow attackers to gain unauthorized access to sensitive data and systems.", "Technical Impact": "The attack vector is NETWORK and the attack complexity is LOW. The confidentiality impact is HIGH, integrity impact is HIGH, and availability impact is HIGH.", "Mitigation Strategies": "Implement strict access controls for remote SMTP clients and ensure that all remote SMTP clients are authenticated and authorized.", "Recommendations": "Recommend to executives that immediate attention and remediation are required to mitigate the vulnerability.", "Conclusions": "The CVE-2020-28021 vulnerability is a critical remote code execution vulnerability that requires immediate attention and remediation."}}