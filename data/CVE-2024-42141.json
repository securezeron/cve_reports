{"id": "CVE-2024-42141", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-30T08:15:05.917", "lastModified": "2024-07-30T13:32:45.943", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: ISO: Check socket flag instead of hcon\n\nThis fixes the following Smatch static checker warning:\n\nnet/bluetooth/iso.c:1364 iso_sock_recvmsg()\nerror: we previously assumed 'pi->conn->hcon' could be null (line 1359)\n\nnet/bluetooth/iso.c\n1347 static int iso_sock_recvmsg(struct socket *sock, struct msghdr *msg,\n1348                             size_t len, int flags)\n1349 {\n1350         struct sock *sk = sock->sk;\n1351         struct iso_pinfo *pi = iso_pi(sk);\n1352\n1353         BT_DBG(\"sk %p\", sk);\n1354\n1355         if (test_and_clear_bit(BT_SK_DEFER_SETUP,\n                                      &bt_sk(sk)->flags)) {\n1356                 lock_sock(sk);\n1357                 switch (sk->sk_state) {\n1358                 case BT_CONNECT2:\n1359                         if (pi->conn->hcon &&\n                                     ^^^^^^^^^^^^^^ If ->hcon is NULL\n\n1360                             test_bit(HCI_CONN_PA_SYNC,\n                                         &pi->conn->hcon->flags)) {\n1361                                 iso_conn_big_sync(sk);\n1362                                 sk->sk_state = BT_LISTEN;\n1363                         } else {\n--> 1364                         iso_conn_defer_accept(pi->conn->hcon);\n                                                       ^^^^^^^^^^^^^^\n                                                       then we're toast\n\n1365                                 sk->sk_state = BT_CONFIG;\n1366                         }\n1367                         release_sock(sk);\n1368                         return 0;\n1369                 case BT_CONNECTED:\n1370                         if (test_bit(BT_SK_PA_SYNC,"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: Bluetooth: ISO: Verifique el indicador de socket en lugar de hcon. Esto corrige la siguiente advertencia del verificador est\u00e1tico de Smatch: net/bluetooth/iso.c:1364 iso_sock_recvmsg() error: previamente asumimos 'pi -&gt;conn-&gt;hcon' podr\u00eda ser nulo (l\u00ednea 1359) net/bluetooth/iso.c 1347 static int iso_sock_recvmsg(struct socket *sock, struct msghdr *msg, 1348 size_t len, int flags) 1349 { 1350 struct sock *sk = calcet\u00edn-&gt;sk; 1351 estructura iso_pinfo *pi = iso_pi(sk); 1352 1353 BT_DBG(\"sk%p\",sk); 1354 1355 if (test_and_clear_bit(BT_SK_DEFER_SETUP, &amp;bt_sk(sk)-&gt;flags)) { 1356 lock_sock(sk); 1357 interruptor (sk-&gt;sk_state) { 1358 caso BT_CONNECT2: 1359 si (pi-&gt;conn-&gt;hcon &amp;&amp; ^^^^^^^^^^^^^^ Si -&gt;hcon es NULL 1360 test_bit(HCI_CONN_PA_SYNC, &amp;pi -&gt;conn-&gt;hcon-&gt;flags)) { 1361 iso_conn_big_sync(sk); 1362 sk-&gt;sk_state = BT_LISTEN; 1363 } else { --&gt; 1364 iso_conn_defer_accept(pi-&gt;conn-&gt;hcon); ^^^^^^^^^^^^^^ entonces estamos 1365 sk-&gt;sk_state = BT_CONFIG; 1366 } 1367 liberaci\u00f3n_sock(sk); 1368 devuelve 0; 1369 caso BT_CONNECTED: 1370 si (test_bit(BT_SK_PA_SYNC,"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/045669710464a21c67e690ef14698fd71857cb11", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/33fabef489169c6db87843ef23351ed0d5e51ad8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/596b6f081336e77764ca35cfeab66d0fcdbe544e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1210 - Exploitation of RemotelyAccessible Applications", "comment": "CVE-2024-42141 - Exploitation of Bluetooth ISO socket flag vulnerability, an attacker could potentially exploit this vulnerability to gain access to the system."}, {"techniqueID": "T1190 - Exploitation of Partitioning Fault to Leak Information", "comment": "CVE-2024-42141 - Exploitation of Bluetooth ISO socket flag vulnerability, an attacker could potentially exploit this vulnerability to leak sensitive information."}], "stix_bundle": {"objects": {"vulnerability": {"id": "CVE-2024-42141", "description": "In the Linux kernel, the Bluetooth ISO socket flag vulnerability affects the Bluetooth ISO socket. This vulnerability could allow an attacker to gain unauthorized access to the system.", "references": {"url": ["https://git.kernel.org/stable/c/045669710464a21c67e690ef14698fd71857cb11", "https://git.kernel.org/stable/c/33fabef489169c6db87843ef23351ed0d5e51ad8", "https://git.kernel.org/stable/c/596b6f081336e77764ca35cfeab66d0fcdbe544e"]}}, "threat_actor": {"id": "T1499-001"}, "campaign": {"id": "C0001"}, "attack_pattern": {"id": "AP20.001"}, "threat_action": {"id": "TA0001"}, "course_of_action": {"id": "COA001", "related_technique": "T1210"}}, "relationships": {"vulnerability--exploits": {"sibling": {"_attack_pattern": {"id": "AP20.001"}}}, "vulnerability--related_to": {"sibling": {"threat_actor": {"id": "T1499-001"}}}, "course_of_action--mitigates": {"sibling": {"attack_pattern": {"id": "AP20.001"}}}}}, "technical_analysis": {"Introduction": "CVE-2024-42141 is a Bluetooth ISO socket flag vulnerability in the Linux kernel, which allows an attacker to gain unauthorized access to the system.", "Impact and Scope": "This vulnerability has a CVSS score of 6.8 and an attack vector of CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to the MITRE ATT&CK techniques T1210 and T1190.", "Technical Details": "The vulnerability occurs when an attacker exploits the Bluetooth ISO socket flag vulnerability in the Linux kernel, allowing them to gain unauthorized access to the system.", "Detection": "This vulnerability can be detected by monitoring system logs for suspicious activity related to Bluetooth ISO socket flag manipulation.", "Mitigation": "The mitigation strategy for this vulnerability involves applying the patch provided by the Linux kernel maintainers.", "Conclusion": "In conclusion, CVE-2024-42141 is a significant vulnerability that allows an attacker to gain unauthorized access to the system. It is essential to apply the patch and monitor system logs for suspicious activity."}, "executive_analysis": {"Overview": "CVE-2024-42141 is a critical vulnerability in the Linux kernel that affects the Bluetooth ISO socket flag.", "Business Impact": "The business impact of this vulnerability is significant, as it allows an attacker to gain unauthorized access to the system, which could result in data breaches and system compromise.", "Technical Impact": "The technical impact of this vulnerability is that it allows an attacker to exploit a critical vulnerability in the Linux kernel, which could result in system compromise and data breaches.", "Mitigation Strategies": "The mitigation strategy for this vulnerability is to apply the patch provided by the Linux kernel maintainers.", "Recommendations": "I recommend that you apply the patch as soon as possible and monitor system logs for suspicious activity related to Bluetooth ISO socket flag manipulation.", "Conclusions": "In conclusion, CVE-2024-42141 is a critical vulnerability that requires immediate attention and mitigation."}}