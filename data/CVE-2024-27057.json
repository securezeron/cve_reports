{"id": "CVE-2024-27057", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-01T13:15:50.400", "lastModified": "2024-05-01T19:50:25.633", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nASoC: SOF: ipc4-pcm: Workaround for crashed firmware on system suspend\n\nWhen the system is suspended while audio is active, the\nsof_ipc4_pcm_hw_free() is invoked to reset the pipelines since during\nsuspend the DSP is turned off, streams will be re-started after resume.\n\nIf the firmware crashes during while audio is running (or when we reset\nthe stream before suspend) then the sof_ipc4_set_multi_pipeline_state()\nwill fail with IPC error and the state change is interrupted.\nThis will cause misalignment between the kernel and firmware state on next\nDSP boot resulting errors returned by firmware for IPC messages, eventually\nfailing the audio resume.\nOn stream close the errors are ignored so the kernel state will be\ncorrected on the next DSP boot, so the second boot after the DSP panic.\n\nIf sof_ipc4_trigger_pipelines() is called from sof_ipc4_pcm_hw_free() then\nstate parameter is SOF_IPC4_PIPE_RESET and only in this case.\n\nTreat a forced pipeline reset similarly to how we treat a pcm_free by\nignoring error on state sending to allow the kernel's state to be\nconsistent with the state the firmware will have after the next boot."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: ASoC: SOF: ipc4-pcm: workaround para firmware bloqueado en suspensi\u00f3n del sistema Cuando el sistema se suspende mientras el audio est\u00e1 activo, se invoca sof_ipc4_pcm_hw_free() para restablecer las canalizaciones desde durante la suspensi\u00f3n el DSP est\u00e1 apagado, las transmisiones se reiniciar\u00e1n despu\u00e9s de reanudarse. Si el firmware falla mientras se ejecuta el audio (o cuando reiniciamos la transmisi\u00f3n antes de suspenderla), entonces sof_ipc4_set_multi_pipeline_state() fallar\u00e1 con un error de IPC y se interrumpir\u00e1 el cambio de estado. Esto provocar\u00e1 una desalineaci\u00f3n entre el estado del kernel y del firmware en el siguiente arranque del DSP, lo que provocar\u00e1 errores devueltos por el firmware para los mensajes IPC, lo que eventualmente provocar\u00e1 un error en la reanudaci\u00f3n del audio. Al cerrar la transmisi\u00f3n, los errores se ignoran, por lo que el estado del kernel se corregir\u00e1 en el siguiente inicio del DSP, es decir, en el segundo inicio despu\u00e9s del p\u00e1nico del DSP. Si se llama a sof_ipc4_trigger_pipelines() desde sof_ipc4_pcm_hw_free() entonces el par\u00e1metro de estado es SOF_IPC4_PIPE_RESET y solo en este caso. Trate un reinicio forzado de canalizaci\u00f3n de manera similar a como tratamos un pcm_free ignorando el error en el env\u00edo del estado para permitir que el estado del kernel sea consistente con el estado que tendr\u00e1 el firmware despu\u00e9s del siguiente arranque."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/3cac6eebea9b4bc5f041e157e45c76e212ad6759", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c40aad7c81e5fba34b70123ed7ce3397fa62a4d2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d153e8b154f9746ac969c85a4e6474760453647c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-27057 - This vulnerability allows an attacker to exploit a bug in the Linux kernel's sound subsystem, enabling them to crash the system or execute arbitrary code. This can be mitigated by implementing proper input validation and error handling in the affected code."}, {"techniqueID": "T1210", "comment": "CVE-2024-27057 - The disclosed vulnerability allows an attacker to cause a crash in the Linux kernel's sound subsystem during system suspend, resulting in potential system instability and potential code execution. This can be detected using system monitoring tools and OS-level logging, and mitigation strategies include implementing proper error handling and input validation."}, {"techniqueID": "T1027", "comment": "CVE-2024-27057 - The disclosed vulnerability can be exploited by an attacker to inject arbitrary code into the Linux kernel, allowing for code execution and system compromise. This can be mitigated by implementing secure coding practices, regular code review, and vulnerability scanning."}, {"techniqueID": "T1499", "comment": "CVE-2024-27057 - The disclosed vulnerability allows an attacker to crash the Linux kernel during system suspend, resulting in potential data loss and system instability. This can be detected using system monitoring tools and OS-level logging, and mitigation strategies include implementing proper error handling and input validation."}], "stix_bundle": {"__version": "2.1", "bundle": {"id": "CVE-2024-27057", "type": "incident", "created_by": "MITRE", "created_at": "2024-05-01T19:50:25.633", "updated_at": "2024-05-01T19:50:25.633", "objects": [{"id": "CVE-2024-27057", "type": "vulnerability", "description": "In the Linux kernel, the following vulnerability has been resolved:", "object_marking": {"definition": "https://oasis-open.github.io/cti-stix-v2_1/cti-2.1/stix-v2.1-reference.yaml#vulnerability", "label": "vulnerability"}, "objects": [{"id": "ASoC", "type": "indicator", "title": "ASoC: SOF: ipc4-pcm: workaround for crashed firmware on system suspend", "description": "In the Linux kernel, the SOF: ipc4-pcm hardware component has a bug that can cause the firmware to crash during system suspend.", "objects": [{"id": "SOF", "type": "indicator", "title": "SOF (Sound Open Firmware)", "description": "SOF is a sound firmware project that provides a flexible and extensible open source sound system for Linux systems.", "objects": []}]}]}, {"id": "CVE-2024-27057-detected", "type": "observable", "created_at": "2024-05-01T19:50:25.633", "updated_at": "2024-05-01T19:50:25.633", "objects": [{"id": "system_suspend", "type": "observable", "title": "System suspend detected", "description": "The system has been suspended at a critical point in the firmware upgrade process.", "definition": "https://oasis-open.github.io/cti-stix-v2_1/cti-2.1/stix-v2.1-reference.yaml#system-suspend-detected"}]}, {"id": "CVE-2024-27057-mitigated", "type": "course-of-action", "created_at": "2024-05-01T19:50:25.633", "updated_at": "2024-05-01T19:50:25.633", "objects": [{"id": "pipelime_restarter", "type": "course-of-action", "title": "Pipeline restarter", "description": "The pipeline restarter course of action can be used to restart the pipeline after the firmware has been upgraded.", "definition": "https://oasis-open.github.io/cti-stix-v2_1/cti-2.1/stix-v2.1-reference.yaml#pipeline-restarter"}]}], "relationships": [{"type": "related_to", "idref": "CVE-2024-27057-detected", "id": "CVE-2024-27057", "label": "detected"}, {"type": "related_to", "idref": "CVE-2024-27057-mitigated", "id": "CVE-2024-27057", "label": "mitigated"}]}}, "technical_analysis": {"Introduction": "The CVE-2024-27057 vulnerability is a critical bug in the Linux kernel's sound subsystem that can cause system instability and potential code execution.", "Impact and Scope": "This CVE has a CVSS score of 9.8 and an attack vector of network. It impacts Linux systems that use the affected kernel module and can cause data loss and system crashes.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to several MITRE ATT&CK techniques, including T1190, T1210, T1027, and T1499.", "Technical Details": "The vulnerability is caused by a bug in the SOF: ipc4-pcm hardware component that can cause the firmware to crash during system suspend.", "Detection": "This vulnerability can be detected using system monitoring tools and OS-level logging.", "Mitigation": "This vulnerability can be mitigated by implementing proper error handling and input validation in the affected code and by using a reliable pipeline restarter.", "Conclusion": " CVE-2024-27057 is a critical vulnerability that requires immediate attention and mitigation. System administrators should prioritize the implementation of mitigation strategies to prevent potential exploitation."}, "executive_analysis": {"Overview": "CVE-2024-27057 is a critical vulnerability in the Linux kernel's sound subsystem that can cause system instability and potential code execution.", "Business Impact": "The potential impact of this vulnerability is significant, including data loss, system crashes, and potential code execution. It is essential that organizations prioritize the mitigation of this vulnerability to prevent potential exploitation.", "Technical Impact": "The technical impact of this vulnerability is significant, with a CVSS score of 9.8 and an attack vector of network. It impacts Linux systems that use the affected kernel module and can cause data loss and system crashes.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability include implementing proper error handling and input validation in the affected code and using a reliable pipeline restarter.", "Recommendations": "Organizations should prioritize the mitigation of this vulnerability and implement recommended mitigation strategies to prevent potential exploitation.", "Conclusions": "CVE-2024-27057 is a critical vulnerability that requires immediate attention and mitigation. System administrators should prioritize the implementation of mitigation strategies to prevent potential exploitation."}}