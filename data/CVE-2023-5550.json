{"id": "CVE-2023-5550", "sourceIdentifier": "patrick@puiterwijk.org", "published": "2023-11-09T20:15:10.867", "lastModified": "2023-11-17T16:36:28.377", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In a shared hosting environment that has been misconfigured to allow access to other users' content, a Moodle user who also has direct access to the web server outside of the Moodle webroot could utilise a local file include to achieve remote code execution."}, {"lang": "es", "value": "En un entorno de alojamiento compartido que ha sido mal configurado para permitir el acceso al contenido de otros usuarios, un usuario de Moodle que tambi\u00e9n tiene acceso directo al servidor web fuera del root web de Moodle podr\u00eda utilizar un archivo local incluido para lograr la ejecuci\u00f3n remota de c\u00f3digo."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "patrick@puiterwijk.org", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 2.5}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}, {"source": "patrick@puiterwijk.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.9.24", "matchCriteriaId": "A2A8D2D9-48FE-417F-8062-65794AA65706"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.11.0", "versionEndExcluding": "3.11.17", "matchCriteriaId": "7C058D38-D206-4BEC-B647-4CD1808A1FC8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.0.11", "matchCriteriaId": "4827B277-0EC2-4254-B6DF-F18475A6253C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.1.0", "versionEndExcluding": "4.1.6", "matchCriteriaId": "E660C47C-2CB3-4B06-B98A-F8EE211F798A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.2.0", "versionEndExcluding": "4.2.3", "matchCriteriaId": "C65020B8-B78E-4B59-B894-3F223D769078"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:fedoraproject:extra_packages_for_enterprise_linux:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "3D9C7598-4BB4-442A-86DF-EEDE041A4CC7"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:38:*:*:*:*:*:*:*", "matchCriteriaId": "CC559B26-5DFC-4B7A-A27C-B77DE755DFF9"}]}]}], "references": [{"url": "http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-72249", "source": "patrick@puiterwijk.org", "tags": ["Patch"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2243452", "source": "patrick@puiterwijk.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://moodle.org/mod/forum/discuss.php?d=451591", "source": "patrick@puiterwijk.org", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190-003", "comment": "CVE-2023-5550 - An attacker may exploit the vulnerability to achieve remote code execution. This technique is relevant because it shows how attackers can use local file inclusion to upload and execute malicious code on the web server. To defend against this, implement proper web application security practices, such as input validation and sanitization, and restrict access to sensitive files and folders."}, {"techniqueID": "T1190-001", "comment": "CVE-2023-5550 - The vulnerability allows an attacker to inject malicious code into the web application. This technique is relevant because it shows how attackers can use file inclusion to inject and execute arbitrary code. To defend against this, implement proper web application security practices, such as input validation and sanitization, and restrict access to sensitive files and folders."}, {"techniqueID": "T1204-001", "comment": "CVE-2023-5550 - The vulnerability allows an attacker to access and execute arbitrary files on the web server. This technique is relevant because it shows how attackers can use file inclusion to access sensitive files and folders. To defend against this, implement proper web application security practices, such as input validation and sanitization, and restrict access to sensitive files and folders."}], "stix_bundle": {"objects": [{"id": "bundle", "type": "bundle", "spec_version": "2.1"}, {"id": "vulnerability", "type": "vulnerability", "name": "CVE-2023-5550", "description": "A vulnerability in Moodle that allows an attacker to achieve remote code execution by exploiting a local file inclusion bug.", "scanner_error": "False", "scanner_type": "Generic", "scanner_id": "Patrick Puiterwijk"}, {"id": "attack_pattern", "type": "attack-pattern", "name": "Local File Inclusion", "description": "An attack pattern where an attacker includes a local file in the web application to inject and execute arbitrary code.", "x_mitre_attack_id": "T1190"}, {"id": "exploit", "type": "exploit", "name": "CVE-2023-5550 Exploit", "description": "An exploit that uses the local file inclusion vulnerability to inject and execute arbitrary code.", "x_mitre_attack_id": "T1190"}, {"id": "course_of_action", "type": "course-of-action", "name": "Implement Input Validation and Sanitization", "description": "Implement input validation and sanitization to prevent malicious code from being injected into the web application.", "x_mitre_attack_id": "T1190"}, {"id": "course_of_action", "type": "course-of-action", "name": "Restrict Access to Sensitive Files and Folders", "description": "Restrict access to sensitive files and folders to prevent unauthorized access and execution.", "x_mitre_attack_id": "T1190"}], "relationships": [{"type": "has", "object_id": "vulnerability", "relationship_id": "related_attack_pattern"}, {"type": "has", "object_id": "vulnerability", "relationship_id": "related_exploit"}, {"type": "uses", "object_id": "vulnerability", "relationship_id": "course_of_action"}]}, "technical_analysis": {"Introduction": "CVE-2023-5550 is a remote code execution vulnerability in Moodle that allows an attacker to inject and execute arbitrary code. This vulnerability is caused by a local file inclusion bug in the web application.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to take control of the web server and execute arbitrary code. The scope of this vulnerability is limited to the web application and the web server.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to the following MITRE ATT&CK techniques: T1190-003, T1190-001, and T1204-001.", "Technical Details": "The vulnerability is caused by a local file inclusion bug in the web application, which allows an attacker to inject and execute arbitrary code. The attacker can exploit this vulnerability by including a local file in the web application and executing the code.", "Detection": "The vulnerability can be detected using web application scanning tools and signature-based detection systems.", "Mitigation": "The vulnerability can be mitigated by implementing input validation and sanitization, restricting access to sensitive files and folders, and implementing a web application firewall.", "Conclusion": "In conclusion, CVE-2023-5550 is a remote code execution vulnerability in Moodle that allows an attacker to inject and execute arbitrary code. This vulnerability is caused by a local file inclusion bug in the web application and can be mitigated by implementing input validation and sanitization, restricting access to sensitive files and folders, and implementing a web application firewall."}, "executive_analysis": {"Overview": "CVE-2023-5550 is a remote code execution vulnerability in Moodle that allows an attacker to inject and execute arbitrary code.", "Business Impact": "This vulnerability can have a significant impact on business operations, as it allows an attacker to take control of the web server and execute arbitrary code.", "Technical Impact": "The technical impact of this vulnerability is high, as it allows an attacker to take control of the web server and execute arbitrary code.", "Mitigation Strategies": "The vulnerability can be mitigated by implementing input validation and sanitization, restricting access to sensitive files and folders, and implementing a web application firewall.", "Recommendations": "We recommend that you implement input validation and sanitization, restrict access to sensitive files and folders, and implement a web application firewall to mitigate the vulnerability.", "Conclusions": "In conclusion, CVE-2023-5550 is a remote code execution vulnerability in Moodle that allows an attacker to inject and execute arbitrary code. We recommend that you implement input validation and sanitization, restrict access to sensitive files and folders, and implement a web application firewall to mitigate the vulnerability."}}