{"id": "CVE-2024-43846", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-17T10:15:09.900", "lastModified": "2024-08-19T12:59:59.177", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nlib: objagg: Fix general protection fault\n\nThe library supports aggregation of objects into other objects only if\nthe parent object does not have a parent itself. That is, nesting is not\nsupported.\n\nAggregation happens in two cases: Without and with hints, where hints\nare a pre-computed recommendation on how to aggregate the provided\nobjects.\n\nNesting is not possible in the first case due to a check that prevents\nit, but in the second case there is no check because the assumption is\nthat nesting cannot happen when creating objects based on hints. The\nviolation of this assumption leads to various warnings and eventually to\na general protection fault [1].\n\nBefore fixing the root cause, error out when nesting happens and warn.\n\n[1]\ngeneral protection fault, probably for non-canonical address 0xdead000000000d90: 0000 [#1] PREEMPT SMP PTI\nCPU: 1 PID: 1083 Comm: kworker/1:9 Tainted: G        W          6.9.0-rc6-custom-gd9b4f1cca7fb #7\nHardware name: Mellanox Technologies Ltd. MSN3700/VMOD0005, BIOS 5.11 01/06/2019\nWorkqueue: mlxsw_core mlxsw_sp_acl_tcam_vregion_rehash_work\nRIP: 0010:mlxsw_sp_acl_erp_bf_insert+0x25/0x80\n[...]\nCall Trace:\n <TASK>\n mlxsw_sp_acl_atcam_entry_add+0x256/0x3c0\n mlxsw_sp_acl_tcam_entry_create+0x5e/0xa0\n mlxsw_sp_acl_tcam_vchunk_migrate_one+0x16b/0x270\n mlxsw_sp_acl_tcam_vregion_rehash_work+0xbe/0x510\n process_one_work+0x151/0x370\n worker_thread+0x2cb/0x3e0\n kthread+0xd0/0x100\n ret_from_fork+0x34/0x50\n ret_from_fork_asm+0x1a/0x30\n </TASK>"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: lib: objagg: soluciona un fallo de protecci\u00f3n general. La librer\u00eda admite la agregaci\u00f3n de objetos en otros objetos s\u00f3lo si el objeto principal no tiene un padre en s\u00ed. Es decir, no se admite el anidamiento. La agregaci\u00f3n ocurre en dos casos: sin y con sugerencias, donde las sugerencias son una recomendaci\u00f3n calculada previamente sobre c\u00f3mo agregar los objetos proporcionados. El anidamiento no es posible en el primer caso debido a una verificaci\u00f3n que lo impide, pero en el segundo caso no hay verificaci\u00f3n porque se supone que el anidamiento no puede ocurrir cuando se crean objetos basados en sugerencias. La violaci\u00f3n de este supuesto conduce a diversas advertencias y eventualmente a un fallo de protecci\u00f3n general [1]. Antes de solucionar la causa ra\u00edz, elimine el error cuando se produzca el anidamiento y advierta. [1] falla de protecci\u00f3n general, probablemente para la direcci\u00f3n no can\u00f3nica 0xdead000000000d90: 0000 [#1] CPU PREEMPT SMP PTI: 1 PID: 1083 Comm: kworker/1:9 Tainted: GW 6.9.0-rc6-custom-gd9b4f1cca7fb #7 Nombre del hardware: Mellanox Technologies Ltd. MSN3700/VMOD0005, BIOS 5.11 06/01/2019 Cola de trabajo: mlxsw_core mlxsw_sp_acl_tcam_vregion_rehash_work RIP: 0010:mlxsw_sp_acl_erp_bf_insert+0x25/0x80 [...] Rastreo de llamadas:  acl_atcam_entry_add+0x256/0x3c0 mlxsw_sp_acl_tcam_entry_create+0x5e /0xa0 mlxsw_sp_acl_tcam_vchunk_migrate_one+0x16b/0x270 mlxsw_sp_acl_tcam_vregion_rehash_work+0xbe/0x510 Process_one_work+0x151/0x370 trabajador_thread+0x2cb/0x3e0 kthread+0xd0/0x100 x34/0x50 ret_from_fork_asm+0x1a/0x30 "}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/1936fa05a180834c3b52e0439a6bddc07814d3eb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/22ae17a267f4812861f0c644186c3421ff97dbfc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/499f742fed42e74f1321f4b12ca196a66a2b49fc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/565213e005557eb6cc4e42189d26eb300e02f170", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5adc61d29bbb461d7f7c2b48dceaa90ecd182eb7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8161263362154cbebfbf4808097b956a6a8cb98a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b4a3a89fffcdf09702b1f161b914e52abca1894d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-43846 - Validated exploitation of existing vulnerabilities in systems with Mellanox Technologies Ltd. MSN3700/VMOD0005 hardware to gain unauthorized access. Prevention is through secure coding practices and vulnerability scanning."}, {"techniqueID": "T1204", "comment": "CVE-2024-43846 - Use of aggregated objects in the Linux kernel for privilege escalation. Prevention is through secure coding practices, input validation, and access control."}, {"techniqueID": "T1547", "comment": "CVE-2024-43846 - Use of a general protection fault in the Linux kernel for system compromise. Prevention is through memory protection, data execution prevention, and safe coding practices."}], "stix_bundle": {"spec_version": "2.1", "bundle": {"type": "bundle", "id": "CVE-2024-43846-stix-bundle", "created_by_ref": "https://schema.org/Chris-Lange", "created": "2024-08-17T10:15:09.900", "modified": "2024-08-19T12:59:59.177", "objects": {"vulnerability": {"type": "vulnerability", "id": "CVE-2024-43846", "name": "CVE-2024-43846: Linux kernel object aggregation vulnerability", "description": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nlib: objagg: Fix general protection fault\n\n..."}], "published": "2024-08-17T10:15:09.900", "last_modified": "2024-08-19T12:59:59.177", "severity": "high", "cvss": {"version": "3.1", "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"}}, "mitigation": {"type": "mitigation", "id": "Mitigation for CVE-2024-43846", "description": "Mitigate this vulnerability by implementing secure coding practices, input validation, and access control.", "relatedthreats": [{"id_ref": "T1190", "relationship": "mitigated_by"}, {"id_ref": "T1204", "relationship": "mitigated_by"}, {"id_ref": "T1547", "relationship": "mitigated_by"}]}}, "relationships": {"vulnerability_has_mitigation": {"id": "vulnerability_has_mitigation", "type": "vulnerability_has_mitigation", "to_id": "Mitigation for CVE-2024-43846", "from_id": "CVE-2024-43846", "relationship": "mitigates"}}}}, "technical_analysis": {"Introduction": "CVE-2024-43846 is a vulnerability in the Linux kernel's object aggregation feature, which can be exploited to gain unauthorized access.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 and an attack vector of Network.", "Related MITRE ATT&CK Techniques": "T1190, T1204, and T1547", "Technical Details": "The vulnerability is due to an error in the Linux kernel's object aggregation feature, which allows an attacker to create an object that can be used to exploit the vulnerability.", "Detection": "Detection of this vulnerability can be done by monitoring for suspicious behavior and analyzing system logs.", "Mitigation": "Mitigation strategies include secure coding practices, input validation, and access control.", "Conclusion": "Conclusion and summary of the vulnerability."}, "executive_analysis": {"Overview": "CVE-2024-43846 is a vulnerability in the Linux kernel's object aggregation feature, which can be exploited to gain unauthorized access.", "Business Impact": "This vulnerability has the potential to impact business operations by allowing unauthorized access to systems.", "Technical Impact": "The vulnerability has the potential to compromise system security and confidentiality.", "Mitigation Strategies": "Implement secure coding practices, input validation, and access control to mitigate this vulnerability.", "Recommendations": "Recommendations for executives include implementing secure coding practices, input validation, and access control to mitigate this vulnerability.", "Conclusions": "Final conclusions and next steps for executives."}}