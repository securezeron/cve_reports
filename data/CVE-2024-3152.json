{"id": "CVE-2024-3152", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T18:15:17.490", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "mintplex-labs/anything-llm is vulnerable to multiple security issues due to improper input validation in several endpoints. An attacker can exploit these vulnerabilities to escalate privileges from a default user role to an admin role, read and delete arbitrary files on the system, and perform Server-Side Request Forgery (SSRF) attacks. The vulnerabilities are present in the `/request-token`, `/workspace/:slug/thread/:threadSlug/update`, `/system/remove-logo`, `/system/logo`, and collector's `/process` endpoints. These issues are due to the application's failure to properly validate user input before passing it to `prisma` functions and other critical operations. Affected versions include the latest version prior to 1.0.0."}, {"lang": "es", "value": "mintplex-labs/anything-llm es vulnerable a m\u00faltiples problemas de seguridad debido a una validaci\u00f3n de entrada incorrecta en varios endpoints. Un atacante puede aprovechar estas vulnerabilidades para escalar privilegios de una funci\u00f3n de usuario predeterminada a una funci\u00f3n de administrador, leer y eliminar archivos arbitrarios en el sistema y realizar ataques de Server-Side Request Forgery (SSRF). Las vulnerabilidades est\u00e1n presentes en `/request-token`, `/workspace/:slug/thread/:threadSlug/update`, `/system/remove-logo`, `/system/logo`, and collector's `/process` endpoints. Estos problemas se deben a que la aplicaci\u00f3n no valida adecuadamente la entrada del usuario antes de pasarla a las funciones \"prisma\" y otras operaciones cr\u00edticas. Las versiones afectadas incluyen la \u00faltima versi\u00f3n anterior a 1.0.0."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "https://github.com/mintplex-labs/anything-llm/commit/200bd7f0615347ed2efc07903d510e5a208b0afc", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/46034fa0-d623-49f8-8ee8-390390181373", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1059.010 - Command and PowerShell", "comment": "CVE-2024-3152 - The vulnerability allows an attacker to exploit the 'prisma' functions and other critical operations, which can be done through command and PowerShell. Defending against this involves proper validation of user input and limiting access to sensitive functions."}, {"techniqueID": "T1078 -Valid Accounts", "comment": "CVE-2024-3152 - An attacker can escalate privileges from a default user role to an admin role by exploiting the vulnerability. Valid accounts can be used to authenticate and authorize the attacker's actions."}, {"techniqueID": "T1190 -Exploit Public-Facing Application", "comment": "CVE-2024-3152 - The vulnerability is present in several public-facing application endpoints, making it susceptible to exploitation by an attacker."}, {"techniqueID": "T1027 - Remote Services", "comment": "CVE-2024-3152 - An attacker can use Server-Side Request Forgery (SSRF) attacks to exploit this vulnerability, which involves remote services."}, {"techniqueID": "T1499 -Custom Action Module", "comment": "CVE-2024-3152 - An attacker can use custom action modules to exploit this vulnerability and escalate privileges."}], "stix_bundle": {"type": "bundle", "id": "CVE-2024-3152-Bundle", "Created": "2024-06-06T18:15:17.490", "Modified": "2024-06-07T14:56:05.647", "objects": [{"type": "vulnerability", "id": "CVE-2024-3152", "title": "CVE-2024-3152 - improper input validation in mintplex-labs/anything-llm", "description": "improper input validation in mintplex-labs/anything-llm", "created": "2024-06-06T18:15:17.490", "modified": "2024-06-07T14:56:05.647", "references": [{"type": "Bounty", "id": "Huntr-46034fa0-d623-49f8-8ee8-390390181373", "source_name": "Huntr", "href": "https://huntr-dev.github.io/containers/security/46034fa0-d623-49f8-8ee8-390390181373", "description": "Huntr Bounty"}], "related_indicators": [{"type": "indicator", "id": "Any-Anything-Llm", "title": "Anything LLM", "description": "Anything LLM vulnerability", "created": "2024-06-06T18:15:17.490", "modified": "2024-06-07T14:56:05.647", "objects": [{"type": "course-of-action", "id": "DoNotUseAnythingLlm", "title": "Do Not Use Anything LLM", "description": "Avoid using Anything LLM due to vulnerability", "created": "2024-06-06T18:15:17.490", "modified": "2024-06-07T14:56:05.647", "label": "Do Not Use", "notes": "Do Not Use Anything LLM due to vulnerability", "references": [{"type": "Bounty", "id": "DoNotUseAnythingLlm-1", "source_name": "Huntr", "href": "https://huntr-dev.github.io/containers/security/46034fa0-d623-49f8-8ee8-390390181373", "description": "Huntr Bounty"}]}]}]}]}, "technical_analysis": {"Introduction": "CVE-2024-3152 is a vulnerability in mintplex-labs/anything-llm, a machine learning framework, which allows an attacker to escalate privileges, read and delete arbitrary files, and perform SSRF attacks.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 and an attack vector of NETWORK. It can be exploited by an attacker to escalate privileges from a default user role to an admin role and read and delete arbitrary files on the system.", "Related MITRE ATT&CK Techniques": "T1059.010, T1078, T1190, T1027, and T1499", "Technical Details": "The vulnerability is due to improper input validation in several endpoints, such as /request-token, /workspace/:slug/thread/:threadSlug/update, /system/remove-logo, /system/logo, and collector's /process. An attacker can exploit this by sending a crafted input to manipulate the 'prisma' functions and other critical operations.", "Detection": "Detection involves monitoring for unusual network traffic patterns and file modifications on the system.", "Mitigation": "Mitigation involves proper validation of user input, limiting access to sensitive functions, and regularly updating the system with the latest security patches.", "Conclusion": "In conclusion, CVE-2024-3152 is a critical vulnerability that requires immediate attention. It is essential to patch the vulnerability and implement proper validation of user input to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-3152 is a critical vulnerability in mintplex-labs/anything-llm that has the potential to negatively impact business operations.", "Business Impact": "The vulnerability can lead to data breaches, unauthorized access to sensitive information, and system compromise, resulting in financial losses and reputational damage.", "Technical Impact": "The vulnerability can be exploited by an attacker to escalate privileges, read and delete arbitrary files, and perform SSRF attacks, which can lead to a complete system compromise.", "Mitigation Strategies": "Patching the vulnerability, implementing proper validation of user input, and regularly updating the system with the latest security patches.", "Recommendations": "It is recommended that the organization immediately patch the vulnerability and implement proper validation of user input to prevent exploitation.", "Conclusions": "In conclusion, CVE-2024-3152 is a critical vulnerability that requires immediate attention. It is essential to patch the vulnerability and implement proper validation of user input to prevent exploitation and minimize business impact."}}