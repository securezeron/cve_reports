{"id": "CVE-2020-35666", "sourceIdentifier": "cve@mitre.org", "published": "2020-12-23T20:15:12.927", "lastModified": "2020-12-23T20:29:19.160", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Steedos Platform through 1.21.24 allows NoSQL injection because the /api/collection/findone implementation in server/packages/steedos_base.js mishandles req.body validation, as demonstrated by MongoDB operator attacks such as an X-User-Id[$ne]=1 value."}, {"lang": "es", "value": "Steedos Platform versiones hasta 1.21.24, permite una inyecci\u00f3n NoSQL porque la implementaci\u00f3n de /api/collection/findone en el archivo server/packages/steedos_base.js maneja inapropiadamente una comprobaci\u00f3n de req.body, como es demostrado mediante unos ataques del operador de MongoDB tal y como un valor X-User-Id[$ne]=1"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:steedos:steedos:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.21.24", "matchCriteriaId": "74A7D344-88BB-463F-A267-480CE9237176"}]}]}], "references": [{"url": "https://github.com/steedos/steedos-platform/issues/1245", "source": "cve@mitre.org", "tags": ["Exploit", "Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0002", "comment": "CVE-2020-35666 - This vulnerability allows for NoSQL injection attacks, which can be executed using MongoDB operators. This technique is relevant as it highlights the importance of validating user-input data to prevent such attacks. Defending against this vulnerability requires implementing input validation and sanitization mechanisms."}, {"techniqueID": "TA0011", "comment": "CVE-2020-35666 - This vulnerability allows for code injection attacks, which can be executed using MongoDB operators. This technique is relevant as it highlights the importance of sanitizing user-input data to prevent such attacks. Defending against this vulnerability requires implementing input validation and sanitization mechanisms."}, {"techniqueID": "TA0013", "comment": "CVE-2020-35666 - This vulnerability allows for command injection attacks, which can be executed using MongoDB operators. This technique is relevant as it highlights the importance of validating user-input data to prevent such attacks. Defending against this vulnerability requires implementing input validation and sanitization mechanisms."}, {"techniqueID": "TA0043", "comment": "CVE-2020-35666 - This vulnerability allows for data manipulation attacks, which can be executed using MongoDB operators. This technique is relevant as it highlights the importance of validating user-input data to prevent such attacks. Defending against this vulnerability requires implementing input validation and sanitization mechanisms."}], "stix_bundle": {"type": "bundle", "id": "CVE-2020-35666- MITRE-EX", "spec_version": "2.1", "stix_filters": [], "objects": [{"type": "vulnerability", "id": "vulnerability-CVE-2020-35666", "name": "Steedos Platform CVE-2020-35666", "description": "Steedos Platform through 1.21.24 allows NoSQL injection because the /api/collection/findone implementation in server/packages/steedos_base.js mishandles req.body validation.", "object_marking_refs": [], "related_object_refs": [{"relationship": "attributed_to", "id": "actor- Steedos"}]}, {"type": "capec", "id": "capec-T1040", "name": "Data Manipulation", "description": "The attacker exploits a vulnerability to manipulate data stored in a database. This could lead to unauthorized data modification or deletion."}, {"type": "capec", "id": "capec-T1042", "name": "Command Injection", "description": "The attacker exploits a vulnerability to inject malicious commands into a system. This could lead to system compromise or data theft."}, {"type": "identification", "id": "identification-CVE-2020-35666", "name": "Steedos Platform CVE-2020-35666", "description": "Steedos Platform through 1.21.24 allows NoSQL injection because the /api/collection/findone implementation in server/packages/steedos_base.js mishandles req.body validation.", "object_marking_refs": [], "related_object_refs": [{"relationship": "attributed_to", "id": "actor-Steedos"}]}], "relationship": {"vulnerability-CVE-2020-35666": {"relation_type": "related_to", "object_refs": [{"relationship": "attributed_to", "id": "actor-Steedos"}, {"relationship": "has_report", "id": "identification-CVE-2020-35666"}]}}}, "technical_analysis": {"Introduction": "The Steedos Platform through 1.21.24 allows NoSQL injection due to the mishandling of req.body validation in the /api/collection/findone implementation.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8, with an attack vector of NETWORK and requires LOW privileges. This affects the CONFIGURATION file of the Steedos Platform.", "Related MITRE ATT&CK Techniques": "TA0002, TA0011, TA0013, and TA0043.", "Technical Details": "The vulnerability occurs due to the lack of proper validation of user-input data in the server-side code.", "Detection": "Detection methods include monitoring system logs for suspicious MongoDB queries and implementing input validation mechanisms.", "Mitigation": "Mitigation strategies include implementing input validation and sanitization mechanisms and updating the Steedos Platform to a version greater than 1.21.24.", "Conclusion": "The vulnerability highlights the importance of proper validation and sanitization of user-input data to prevent NoSQL injection attacks."}, "executive_analysis": {"Overview": "The Steedos Platform has fallen victim to a NoSQL injection vulnerability, allowing attackers to execute MongoDB operators.", "Business Impact": "The vulnerability can lead to data breaches and unauthorized data modification, potentially affecting business operations and reputation.", "Technical Impact": "The vulnerability may allow attackers to manipulate or delete critical data, leading to system compromise.", "Mitigation Strategies": "Implementing input validation and sanitization mechanisms and updating the Steedos Platform to a version greater than 1.21.24.", "Recommendations": "Recommendations include conducting regular vulnerability assessments and implementing proactive security measures.", "Conclusions": "The vulnerability emphasizes the need for robust security practices and emphasizes the importance of timely updates and patches."}}