{"id": "CVE-2023-6804", "sourceIdentifier": "product-cna@github.com", "published": "2023-12-21T21:15:15.020", "lastModified": "2023-12-29T19:15:50.637", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Improper privilege management allowed arbitrary workflows to be committed and run using an improperly scoped PAT. To exploit this, a workflow must have already existed in the target repo. This vulnerability affected all versions of GitHub Enterprise Server since 3.8 and was fixed in version 3.8.12, 3.9.7, 3.10.4, and 3.11.1. \n"}, {"lang": "es", "value": "La gesti\u00f3n inadecuada de privilegios permiti\u00f3 que se confirmaran y ejecutaran workflows arbitrarios utilizando una PAT con un alcance inadecuado. Para aprovechar esto, ya debe haber existido un flujo de trabajo en el repositorio de destino. Esta vulnerabilidad afect\u00f3 a todas las versiones de GitHub Enterprise Server desde la 3.8 y se solucion\u00f3 en las versiones 3.8.12, 3.9.7, 3.10.4 y 3.11.1."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}, {"source": "product-cna@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:L", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 5.5}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-269"}]}, {"source": "product-cna@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-269"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:github:enterprise_server:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.8.0", "versionEndExcluding": "3.8.12", "matchCriteriaId": "B3D983FF-FDDE-484C-AA34-31EB52E25EC2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:github:enterprise_server:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.9.0", "versionEndExcluding": "3.9.7", "matchCriteriaId": "B118EB53-4459-4817-8F74-002DBA4860DA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:github:enterprise_server:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.10.0", "versionEndExcluding": "3.10.4", "matchCriteriaId": "F65FB74F-11AB-439B-9CF0-9F08E03E4083"}, {"vulnerable": true, "criteria": "cpe:2.3:a:github:enterprise_server:3.11.0:*:*:*:*:*:*:*", "matchCriteriaId": "AC723276-C3EE-4F79-857A-3A5C078C33E2"}]}]}], "references": [{"url": "https://docs.github.com/en/enterprise-server@3.10/admin/release-notes#3.10.4", "source": "product-cna@github.com", "tags": ["Release Notes"]}, {"url": "https://docs.github.com/en/enterprise-server@3.11/admin/release-notes#3.11.1", "source": "product-cna@github.com", "tags": ["Release Notes"]}, {"url": "https://docs.github.com/en/enterprise-server@3.8/admin/release-notes#3.8.12", "source": "product-cna@github.com", "tags": ["Release Notes"]}, {"url": "https://docs.github.com/en/enterprise-server@3.9/admin/release-notes#3.9.7", "source": "product-cna@github.com", "tags": ["Release Notes"]}], "techniques": [{"techniqueID": "T1214 - User Execution", "comment": "CVE-2023-6804 - This vulnerability can be exploited by an attacker by creating an arbitrarily scoped PAT, which can be used to execute arbitrary workflows on the target GitHub Enterprise Server. User execution is a key part of this technique, as it allows the attacker to execute the workflow on the server."}, {"techniqueID": "T1565 - Impact", "comment": "CVE-2023-6804 - This vulnerability can impact the integrity of the GitHub Enterprise Server, as an attacker can execute arbitrary workflows on the server, potentially modifying sensitive data or manipulating the server's configuration."}], "stix_bundle": {"type": "bundle", "id": "b-0001", "created_at": "2023-12-21T21:15:15.020", "updated_at": "2023-12-29T19:15:50.637", "objects": [{"type": "indicator", "id": "i-0001", "description": "Arbitrary workflow execution on GitHub Enterprise Server", "created_at": "2023-12-21T21:15:15.020", "updated_at": "2023-12-29T19:15:50.637", "objects": [{"type": "attack_pattern", "id": "ap-0001", "description": "Arbitrary workflow execution on GitHub Enterprise Server", "created_at": "2023-12-21T21:15:15.020", "updated_at": "2023-12-29T19:15:50.637", "related_objects": [{"id": "i-0001", "type": "indicator", "role": "indicates", "relationship": "indicates"}]}]}], " relationships": [{"id": "r-0001", "type": "indicator-attack-pattern", " relationship": "indicates", " created_at": "2023-12-21T21:15:15.020", "updated_at": "2023-12-29T19:15:50.637"}]}, "technical_analysis": {"Introduction": "GitHub Enterprise Server CVE-2023-6804 allows arbitrary workflows to be committed and run using an improperly scoped PAT, potentially leading to unauthorized access and modification of sensitive data.", "Impact and Scope": "This vulnerability has a CVSS score of 5.5 and 6.5, depending on the severity of the impact, and requires local access. It affects GitHub Enterprise Server versions 3.8 and later.", "Related MITRE ATT&CK Techniques": "T1214, T1565", "Technical Details": "The vulnerability occurs due to improper privilege management, allowing arbitrary workflows to be committed and run using an improperly scoped PAT.", "Detection": "Detection methods include monitoring for unusual workflow execution or changes to the server's configuration.", "Mitigation": "Mitigation strategies include properly configuring PATs and workflows, as well as implementing auditing and logging mechanisms.", "Conclusion": "This vulnerability highlights the importance of proper privilege management and configuration in GitHub Enterprise Server. Proper mitigation and detection strategies are essential to preventing unauthorized access and modification of sensitive data."}, "executive_analysis": {"Overview": "GitHub Enterprise Server CVE-2023-6804 is a critical vulnerability that allows arbitrary workflows to be executed with an improperly scoped PAT, potentially leading to unauthorized access and modification of sensitive data.", "Business Impact": "This vulnerability can have significant business impacts, including data breaches, unauthorized access, and loss of confidentiality and integrity.", "Technical Impact": "The vulnerability affects GitHub Enterprise Server versions 3.8 and later, and requires local access.", "Mitigation Strategies": "Executive mitigation strategies include prioritizing proper privilege management and configuration, as well as implementing auditing and logging mechanisms.", "Recommendations": "Recommendations include patching affected systems, implementing additional security measures, and conducting regular security audits and risk assessments.", "Conclusions": "This vulnerability highlights the importance of prioritizing security and proper configuration in GitHub Enterprise Server. Executives should prioritize mitigation and take immediate action to protect sensitive data and intellectual property."}}