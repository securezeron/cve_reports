{"id": "CVE-2024-40893", "sourceIdentifier": "disclosure@vulncheck.com", "published": "2024-08-12T19:15:16.643", "lastModified": "2024-08-21T18:15:09.803", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple authenticated operating system (OS) command injection vulnerabilities exist in Firewalla Box Software \nversions before 1.979. A physically close \nattacker that is authenticated to the Bluetooth Low-Energy (BTLE) interface can use the network configuration service to inject commands in various configuration parameters including\u00a0networkConfig.Interface.Phy.Eth0.Extra.PingTestIP,\u00a0networkConfig.Interface.Phy.Eth0.Extra.DNSTestDomain, and\u00a0networkConfig.Interface.Phy.Eth0.Gateway6. Additionally, because the configuration can be synced to the Firewalla cloud, the attacker may be able to persist access even after hardware resets and firmware re-flashes."}, {"lang": "es", "value": "Existen m\u00faltiples vulnerabilidades de inyecci\u00f3n de comandos del sistema operativo (SO) autenticado en las versiones del software Firewalla Box anteriores a la 1.979. Un atacante f\u00edsicamente cercano que est\u00e9 autenticado en la interfaz Bluetooth Low-Energy (BTLE) puede usar el servicio de configuraci\u00f3n de red para inyectar comandos en varios par\u00e1metros de configuraci\u00f3n, incluidos networkConfig.Interface.Phy.Eth0.Extra.PingTestIP, networkConfig.Interface.Phy.Eth0.Extra.DNSTestDomain y networkConfig.Interface.Phy.Eth0.Gateway6. Adem\u00e1s, debido a que la configuraci\u00f3n se puede sincronizar con la nube de Firewalla, el atacante puede persistir en el acceso incluso despu\u00e9s de reiniciar el hardware y actualizar el firmware."}], "metrics": {"cvssMetricV31": [{"source": "disclosure@vulncheck.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "disclosure@vulncheck.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-78"}]}], "references": [{"url": "https://vulncheck.com/advisories/firewalla-bt-command-injection", "source": "disclosure@vulncheck.com"}, {"url": "https://www.labs.greynoise.io/grimoire/2024-08-20-bluuid-firewalla/", "source": "disclosure@vulncheck.com"}], "techniques": [{"techniqueID": "TA0001", "comment": "This vulnerability allows an attacker to execute arbitrary commands as the web server. This can be mitigated by validating user input."}, {"techniqueID": "T1021", "comment": "The attacker can exploit this vulnerability by injecting commands through the network configuration service. This can be detected by monitoring network traffic and looking for suspicious commands."}, {"techniqueID": "T1190", "comment": "The attacker can use this vulnerability to inject malicious commands in various configuration parameters. This can be mitigated by ensuring that all user input is properly sanitized."}, {"techniqueID": "T1203", "comment": "The attacker can exploit this vulnerability to inject commands in the network configuration service. This can be detected by monitoring system logs for suspicious activity."}], "technical_analysis": {"Introduction": "Firewalla Box Software versions before 1.979 contain multiple authenticated operating system command injection vulnerabilities.", "Impact and Scope": "These vulnerabilities exist in the network configuration service and can be exploited by a physically close attacker who is authenticated to the Bluetooth Low-Energy (BTLE) interface.", "Related MITRE ATT&CK Techniques": "TA0001: Initial Access, T1021: Remote Services, T1190: Command Injection, T1203: Command and Control", "Technical Details": "The vulnerability exists in the network configuration service and can be exploited by injecting commands through the service. The commands can be executed as the web server.", "Detection": "Detection can be performed by monitoring network traffic and system logs for suspicious activity.", "Mitigation": "Mitigation can be achieved by validating user input, ensuring that all user input is properly sanitized, and monitoring system logs for suspicious activity.", "Conclusion": "These vulnerabilities can be exploited by an attacker to inject commands and execute arbitrary code as the web server."}, "executive_analysis": {"Overview": "Firewalla Box Software versions before 1.979 contain multiple authenticated operating system command injection vulnerabilities.", "Business Impact": "These vulnerabilities can be exploited to gain unauthorized access to the network and execute arbitrary code.", "Technical Impact": "The vulnerability exists in the network configuration service and can be exploited by a physically close attacker who is authenticated to the Bluetooth Low-Energy (BTLE) interface.", "Mitigation Strategies": "Implementing a comprehensive vulnerability management program, patching vulnerabilities, and monitoring system logs for suspicious activity can help mitigate these vulnerabilities.", "Recommendations": "Firewalla Box Software users should apply the latest software updates to version 1.979 or later to mitigate these vulnerabilities.", "Conclusions": "These vulnerabilities highlight the importance of implementing robust vulnerability management and security measures to protect against command injection attacks."}}