{"id": "CVE-2024-40626", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-16T17:15:11.580", "lastModified": "2024-07-16T18:00:02.110", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Outline is an open source, collaborative document editor. A type confusion issue was found in ProseMirror\u2019s rendering process that leads to a Stored Cross-Site Scripting (XSS) vulnerability in Outline. An authenticated user can create a document containing a malicious JavaScript payload. When other users view this document, the malicious Javascript can execute in the origin of Outline. Outline includes CSP rules to prevent third-party code execution, however in the case of self-hosting and having your file storage on the same domain as Outline a malicious payload can be uploaded as a file attachment and bypass those CSP restrictions. This issue has been addressed in release version 0.77.3. Users are advised to upgrade. There are no known workarounds for this vulnerability.\n"}, {"lang": "es", "value": "Outline es un editor de documentos colaborativo de c\u00f3digo abierto. Se encontr\u00f3 un problema de confusi\u00f3n de tipos en el proceso de renderizado de ProseMirror que conduce a una vulnerabilidad de Cross-Site Scripting (XSS) Almacenado en Outline. Un usuario autenticado puede crear un documento que contenga un payload de JavaScript malicioso. Cuando otros usuarios ven este documento, el Javascript malicioso puede ejecutarse en el origen de Outline. Outline incluye reglas de CSP para evitar la ejecuci\u00f3n de c\u00f3digo de terceros; sin embargo, en el caso de autohospedaje y almacenamiento de archivos en el mismo dominio que Outline, se puede cargar un payload malicioso como un archivo adjunto y evitar esas restricciones de CSP. Este problema se solucion\u00f3 en la versi\u00f3n 0.77.3. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.1, "impactScore": 5.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "references": [{"url": "https://github.com/outline/outline/security/advisories/GHSA-888c-mvg8-v6wh", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-40626: Stored Cross-Site Scripting (XSS) vulnerability - an attacker can manipulate the document content to inject malicious JavaScript, which can potentially lead to a high-impact attack. Defend against this by ensuring the version of Outline is up-to-date, validating user input, and restricting file uploads."}, {"techniqueID": "T1591", "comment": "CVE-2024-40626: XSS vulnerability in Outline - an authenticated user can upload a malicious JavaScript payload to a document, which can then be executed by other users. Defend against this by implementing Content Security Policy (CSP) and validating user input."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle--eaebd71f-f0f7-4f6a-93f1-ea3a1a7b0a4c", "created_by_ref": "identity--5be94fa7-97e2-47f9-a2b1-79d23d3409e4", "created": "2024-07-16T18:00:02.110Z", "modified": "2024-07-16T18:00:02.110Z", "name": "Outline XSS Vulnerability", "description": "A stored Cross-Site Scripting (XSS) vulnerability in Outline, an open-source document editor.", "objects": [{"type": "vulnerability", "id": "vulnerability--f3c6c964-92b4-49ac-96b1-64b23f45c5c5", "created_by_ref": "identity--5be94fa7-97e2-47f9-a2b1-79d23d3409e4", "created": "2024-07-16T17:15:11.580Z", "modified": "2024-07-16T18:00:02.110Z", "name": "Outline XSS Vulnerability", "description": "Stored Cross-Site Scripting (XSS) vulnerability in Outline."}, {"type": "attack_pattern", "id": "attack_pattern--b7ee9e6e-f443-418f-abbf-3494f6a3f23a", "created_by_ref": "identity--5be94fa7-97e2-47f9-a2b1-79d23d3409e4", "created": "2024-07-16T17:15:11.580Z", "modified": "2024-07-16T18:00:02.110Z", "name": "Stored Cross-Site Scripting (XSS) in Outline", "description": "An attacker injects malicious JavaScript code into a document in Outline, which is then executed by other users."}, {"type": "course_of_action", "id": "course_of_action--ab7e943c-4c41-4c3c-9463-0c26fe91c2f7", "created_by_ref": "identity--5be94fa7-97e2-47f9-a2b1-79d23d3409e4", "created": "2024-07-16T17:15:11.580Z", "modified": "2024-07-16T18:00:02.110Z", "name": "Update Outline to version 0.77.3", "description": "Update Outline to the latest version, which includes a fix for the stored Cross-Site Scripting (XSS) vulnerability."}, {"type": "note", "id": "note--09e4cd49-45ba-497a-a37b-97dbc94f79f7", "created_by_ref": "identity--5be94fa7-97e2-47f9-a2b1-79d23d3409e4", "created": "2024-07-16T17:15:11.580Z", "modified": "2024-07-16T18:00:02.110Z", "name": "CSP Configuration", "description": "Configure Outline to restrict file uploads and limit the execution of third-party code."}], "relationships": [{"type": "vulnerability-attack_pattern", "id": "relationship--fda4f5c4-c53b-49c1-a0f2-46c5a05f69a3", "since": "2024-07-16T17:15:11.580Z", "until": "2024-07-16T18:00:02.110Z", "vulnerability": "vulnerability--f3c6c964-92b4-49ac-96b1-64b23f45c5c5", "attack_pattern": "attack_pattern--b7ee9e6e-f443-418f-abbf-3494f6a3f23a"}, {"type": "attack_pattern-course_of_action", "id": "relationship--9e5f6eee-461d-48c9-b59d-5bfc34fba8b7", "since": "2024-07-16T17:15:11.580Z", "until": "2024-07-16T18:00:02.110Z", "attack_pattern": "attack_pattern--b7ee9e6e-f443-418f-abbf-3494f6a3f23a", "course_of_action": "course_of_action--ab7e943c-4c41-4c3c-9463-0c26fe91c2f7"}, {"type": "note-course_of_action", "id": "relationship--f8d8b2e1-d19a-46b2-ba35-f47f4e6f22e1", "since": "2024-07-16T17:15:11.580Z", "until": "2024-07-16T18:00:02.110Z", "note": "note--09e4cd49-45ba-497a-a37b-97dbc94f79f7", "course_of_action": "course_of_action--ab7e943c-4c41-4c3c-9463-0c26fe91c2f7"}]}}, "technical_analysis": {"Introduction": "A stored Cross-Site Scripting (XSS) vulnerability in Outline, an open-source document editor, can allow an attacker to inject malicious JavaScript code into a document, which is then executed by other users.", "Impact and Scope": "The vulnerability has a CVSS score of 7.3 and can potentially lead to a high-impact attack. It affects Outline 0.77.2 and lower.", "Related MITRE ATT&CK Techniques": "The vulnerability can be exploited using techniques T1190 (Exploit Public-Facing Application) and T1591 (Phishing for Information).", "Technical Details": "The vulnerability occurs when an attacker injects malicious JavaScript code into a document in Outline, which is then executed by other users.", "Detection": "Detection of this vulnerability can be done by monitoring for suspicious HTTP requests and monitoring file uploads.", "Mitigation": "Mitigation strategies include updating Outline to the latest version, validating user input, and restricting file uploads.", "Conclusion": "The stored Cross-Site Scripting (XSS) vulnerability in Outline is a high-priority vulnerability that requires immediate attention."}, "executive_analysis": {"Overview": "The Outline XSS vulnerability is a significant security risk that can allow an attacker to inject malicious JavaScript code into a document, which is then executed by other users.", "Business Impact": "The vulnerability can have a significant impact on the business, including financial loss and reputational damage.", "Technical Impact": "The vulnerability requires immediate attention and mitigation to prevent exploitation.", "Mitigation Strategies": "Mitigation strategies include updating Outline to the latest version, validating user input, and restricting file uploads.", "Recommendations": "Recommendations for executives include prioritizing security and implementing security best practices.", "Conclusions": "The combination of technical and business analyses emphasizes the importance of addressing this vulnerability promptly and effectively."}}