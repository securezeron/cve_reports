{"id": "CVE-2024-3054", "sourceIdentifier": "security@wordfence.com", "published": "2024-04-12T10:15:08.670", "lastModified": "2024-04-12T12:43:46.210", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "WPvivid Backup & Migration Plugin for WordPress is vulnerable to PHAR Deserialization in all versions up to, and including, 0.9.99 via deserialization of untrusted input at the wpvividstg_get_custom_exclude_path_free action. This is due to the plugin not providing sufficient path validation on the tree_node[node][id] parameter. This makes it possible for authenticated attackers, with admin-level access and above, to call files using a PHAR wrapper that will deserialize the data and call arbitrary PHP Objects. No POP chain is present in the vulnerable plugin. If a POP chain is present via an additional plugin or theme installed on the target system, it could allow the attacker to delete arbitrary files, retrieve sensitive data, or execute code."}, {"lang": "es", "value": "El complemento WPvivid Backup &amp; Migration para WordPress es vulnerable a la deserializaci\u00f3n PHAR en todas las versiones hasta la 0.9.99 incluida a trav\u00e9s de la deserializaci\u00f3n de entradas que no son de confianza en la acci\u00f3n wpvividstg_get_custom_exclude_path_free. Esto se debe a que el complemento no proporciona suficiente validaci\u00f3n de ruta en el par\u00e1metro tree_node[nodo][id]. Esto hace posible que atacantes autenticados, con acceso de nivel de administrador y superior, llamen archivos usando un contenedor PHAR que deserializar\u00e1 los datos y llamar\u00e1 objetos PHP arbitrarios. No hay ninguna cadena POP presente en el complemento vulnerable. Si hay una cadena POP presente a trav\u00e9s de un complemento o tema adicional instalado en el sistema de destino, podr\u00eda permitir al atacante eliminar archivos arbitrarios, recuperar datos confidenciales o ejecutar c\u00f3digo."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}]}, "references": [{"url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3067224%40wpvivid-backuprestore&new=3067224%40wpvivid-backuprestore&sfp_email=&sfph_mail=", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/bf26fc68-9fd4-4e4e-b34f-c947d95891f9?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1059.002", "comment": "CVE-2024-3054 - The use of PHAR deserialization in the WPvivid Backup & Migration Plugin for WordPress allows authenticated attackers to call files using a PHAR wrapper, which can be used to delete arbitrary files, retrieve sensitive data, or execute code. This technique can be used to enable the attack."}, {"techniqueID": "T1190", "comment": "CVE-2024-3054 - The vulnerability allows an attacker to call files using a PHAR wrapper, which can be used to execute arbitrary PHP code. This technique can be used to deliver the attacker's payload."}, {"techniqueID": "T1027", "comment": "CVE-2024-3054 - The vulnerability allows an attacker to call files using a PHAR wrapper, which can be used to upload and execute malicious PHP code. This technique can be used to deliver the attacker's payload."}, {"techniqueID": "T1204", "comment": "CVE-2024-3054 - The vulnerability allows an attacker to call files using a PHAR wrapper, which can be used to delete arbitrary files. This technique can be used to clear the way for other attacks."}], "stix_bundle": {"@stix_Collection": {"name": "CVE-2024-3054 Analysis", "created_by_ref": "sid://unknown", "created": "2024-04-12T10:15:08.670"}, "objects": [{"id": "vuln:CVE-2024-3054", "created_by_ref": "sid://unknown", "created": "2024-04-12T10:15:08.670", "modified": "2024-04-12T12:43:46.210", "name": "CVE-2024-3054", "description": [{"lang": "en", "value": "WPvivid Backup & Migration Plugin for WordPress is vulnerable to PHAR Deserialization in all versions up to, and including, 0.9.99 via deserialization of untrusted input at the wpvividstg_get_custom_exclude_path_free action."}], "type": "vulnerability"}, {"id": "tec:T1059.002", "created_by_ref": "sid://unknown", "created": "2024-04-12T10:15:08.670", "modified": "2024-04-12T12:43:46.210", "name": "Phar Deserialization", "description": [{"lang": "en", "value": "The use of PHAR deserialization in the WPvivid Backup & Migration Plugin for WordPress allows authenticated attackers to call files using a PHAR wrapper."}], "type": "attack-pattern"}, {"id": "tec:T1190", "created_by_ref": "sid://unknown", "created": "2024-04-12T10:15:08.670", "modified": "2024-04-12T12:43:46.210", "name": "Exploit-Phar", "description": [{"lang": "en", "value": "The use of a PHAR file to deliver and execute a payload of arbitrary PHP code."}], "type": "attack-pattern"}, {"id": "tec:T1027", "created_by_ref": "sid://unknown", "created": "2024-04-12T10:15:08.670", "modified": "2024-04-12T12:43:46.210", "name": "Command and Control-Phar", "description": [{"lang": "en", "value": "The use of a PHAR file to upload and execute malicious PHP code."}], "type": "attack-pattern"}, {"id": "tec:T1204", "created_by_ref": "sid://unknown", "created": "2024-04-12T10:15:08.670", "modified": "2024-04-12T12:43:46.210", "name": "File Deletion", "description": [{"lang": "en", "value": "The use of a PHAR file to delete arbitrary files."}], "type": "attack-pattern"}], "relationship": [{"id": "r:Attack-Pattern-Vulnerability", "relationship_type": "related_to", "source_ref": "vuln:CVE-2024-3054", "target_ref": "tec:T1059.002"}, {"id": "r:Attack-Pattern-Vulnerability", "relationship_type": "related_to", "source_ref": "vuln:CVE-2024-3054", "target_ref": "tec:T1190"}, {"id": "r:Attack-Pattern-Vulnerability", "relationship_type": "related_to", "source_ref": "vuln:CVE-2024-3054", "target_ref": "tec:T1027"}, {"id": "r:Attack-Pattern-Vulnerability", "relationship_type": "related_to", "source_ref": "vuln:CVE-2024-3054", "target_ref": "tec:T1204"}]}, "technical_analysis": {"Introduction": "The CVE-2024-3054 vulnerability is a PHAR deserialization vulnerability in the WPvivid Backup & Migration Plugin for WordPress. This vulnerability allows authenticated attackers to call files using a PHAR wrapper, which can be used to delete arbitrary files, retrieve sensitive data, or execute code.", "Impact and Scope": "The impact and scope of this vulnerability are HIGH, as it allows authenticated attackers to call files using a PHAR wrapper, which can be used to delete arbitrary files, retrieve sensitive data, or execute code. The CVSS score for this vulnerability is 7.2.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1059.002, T1190, T1027, and T1204.", "Technical Details": "The vulnerability occurs due to the plugin not providing sufficient path validation on the tree_node[node][id] parameter, which allows an attacker to call files using a PHAR wrapper.", "Detection": "Detection methods include monitoring for suspicious PHAR file execution, monitoring for unauthorized file access, and monitoring for suspicious network traffic.", "Mitigation": "Mitigation strategies include updating the WPvivid Backup & Migration Plugin to the latest version, disabling the plugin's PHAR deserialization feature, and implementing a web application firewall to block suspicious traffic.", "Conclusion": "In conclusion, the CVE-2024-3054 vulnerability is a HIGH-SEVERITY vulnerability that allows authenticated attackers to call files using a PHAR wrapper, which can be used to delete arbitrary files, retrieve sensitive data, or execute code. It is essential to update and patch the vulnerability as soon as possible."}, "executive_analysis": {"Overview": "The CVE-2024-3054 vulnerability is a critical vulnerability in the WPvivid Backup & Migration Plugin for WordPress that allows authenticated attackers to call files using a PHAR wrapper, which can be used to delete arbitrary files, retrieve sensitive data, or execute code.", "Business Impact": "The business impact of this vulnerability is significant, as it allows attackers to compromise the security and integrity of the WordPress site, which can lead to financial losses, reputation damage, and regulatory issues.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows attackers to access and manipulate sensitive data, delete critical files, and execute malicious code.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability are to update the WPvivid Backup & Migration Plugin to the latest version, disable the plugin's PHAR deserialization feature, and implement a web application firewall to block suspicious traffic.", "Recommendations": "Recommendations for executives include prioritizing the patching of this vulnerability, implementing additional security measures to detect and prevent similar attacks, and conducting regular security audits and penetration testing to identify and remediate vulnerabilities.", "Conclusions": "In conclusion, the CVE-2024-3054 vulnerability is a critical vulnerability that requires immediate attention and action. It is essential to prioritize patching and implementing mitigation strategies to prevent exploitation and ensure the security and integrity of the WordPress site."}}