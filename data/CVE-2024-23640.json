{"id": "CVE-2024-23640", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-20T16:15:08.090", "lastModified": "2024-03-20T17:18:21.343", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "GeoServer is an open source software server written in Java that allows users to share and edit geospatial data. A stored cross-site scripting (XSS) vulnerability exists in versions prior to 2.23.3 and 2.24.0 that enables an authenticated administrator with workspace-level privileges to store a JavaScript payload in uploaded style/legend resources or in a specially crafted datastore file that will execute in the context of another user's browser when viewed in the Style Publisher. Access to the Style Publisher is available to all users although data security may limit users' ability to trigger the XSS. Versions 2.23.3 and 2.24.0 contain a fix for this issue."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "references": [{"url": "https://github.com/geoserver/geoserver/pull/7162", "source": "security-advisories@github.com"}, {"url": "https://github.com/geoserver/geoserver/pull/7181", "source": "security-advisories@github.com"}, {"url": "https://github.com/geoserver/geoserver/security/advisories/GHSA-9rfr-pf2x-g4xf", "source": "security-advisories@github.com"}, {"url": "https://osgeo-org.atlassian.net/browse/GEOS-11149", "source": "security-advisories@github.com"}, {"url": "https://osgeo-org.atlassian.net/browse/GEOS-11155", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1194", "comment": "CVE-2024-23640 - An attacker may use stored XSS to inject malicious JavaScript payloads into style/legend resources or datastore files, which can be executed in the context of another user's browser when viewed. Detection can be improved by monitoring for unusual JavaScript activity and implementing input validation and sanitization."}, {"techniqueID": "T1568.001", "comment": "CVE-2024-23640 - An attacker may use authenticated administrator privileges to bypass security controls, store malicious JavaScript payloads, and execute them in the context of another user's browser. Detection can be improved by monitoring for unauthorized access and implementing role-based access control."}, {"techniqueID": "T1198", "comment": "CVE-2024-23640 - An attacker may use a cross-site scripting vulnerability to inject malware or conduct credential harvesting attacks. Detection can be improved by monitoring for unusual browser activity and implementing web application firewalls."}], "stix_bundle": {"id": "CVE-2024-23640-STIX-2.1-Bundle", "type": "bundle", "spec_version": "2.1", "unpack_credential": {"spec_version": "2.1"}, "objects": [{"id": "CVE-2024-23640-Vulnerability", "type": "vulnerability", "name": "GeoServer Stored Cross-Site Scripting Vulnerability", "description": "A stored cross-site scripting (XSS) vulnerability exists in GeoServer versions prior to 2.23.3 and 2.24.0 that enables an authenticated administrator with workspace-level privileges to store a JavaScript payload in uploaded style/legend resources or in a specially crafted datastore file that will execute in the context of another user's browser when viewed in the Style Publisher.", "severity": "Medium", "cvss_v3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "baseScore": 4.8}}, {"id": "T1194-Technique", "type": "attack-pattern", "name": "Stored Cross-Site Scripting", "description": "An attacker injects malicious JavaScript into a Web server, which is then executed by users who visit the affected site.", "x_mitre_detection": {"behavior": [{"match": {"condition": "unusual JavaScript activity"}}], "detection": "Monitor for unusual JavaScript activity"}}, {"id": "T1568.001-Technique", "type": "attack-pattern", "name": "Privileged Account Discovery", "description": "An attacker discovers and exploits authentication mechanisms or credentials to access a targeted system or network.", "x_mitre_detection": {"behavior": [{"match": {"condition": "unauthorized access"}}], "detection": "Monitor for unauthorized access"}}, {"id": "T1198-Technique", "type": "attack-pattern", "name": "Cross-Site Scripting", "description": "An attacker injects malicious JavaScript code into a Web site or application, which is then executed by users who visit the affected site.", "x_mitre_detection": {"behavior": [{"match": {"condition": "unusual browser activity"}}], "detection": "Monitor for unusual browser activity"}}, {"id": "Web Application Firewall-Defense", "type": "course-of-action", "name": "Implement Web Application Firewall", "description": "Implementing a Web Application Firewall can help detect and prevent XSS attacks by filtering and validating HTTP traffic.", "x_mitre_prevention": {"mitigation": ["Implement Web Application Firewall"]}}, {"id": "Role-Based Access Control-Defense", "type": "course-of-action", "name": "Implement Role-Based Access Control", "description": "Implementing Role-Based Access Control can help prevent unauthorized access by restricting user access to sensitive resources.", "x_mitre_prevention": {"mitigation": ["Implement Role-Based Access Control"]}}], "relationships": [{"id": "CVE-2024-23640-Vulnerability-rel-T1194-Technique", "type": "related", "object": {"id": "T1194-Technique"}}, {"id": "CVE-2024-23640-Vulnerability-rel-T1568.001-Technique", "type": "related", "object": {"id": "T1568.001-Technique"}}, {"id": "CVE-2024-23640-Vulnerability-rel-T1198-Technique", "type": "related", "object": {"id": "T1198-Technique"}}, {"id": "CVE-2024-23640-Vulnerability-rel-Web Application Firewall-Defense", "type": "uses", "object": {"id": "Web Application Firewall-Defense"}}, {"id": "CVE-2024-23640-Vulnerability-rel-Role-Based Access Control-Defense", "type": "uses", "object": {"id": "Role-Based Access Control-Defense"}}]}, "technical_analysis": {"Introduction": "The GeoServer Stored Cross-Site Scripting Vulnerability (CVE-2024-23640) allows an authenticated administrator with workspace-level privileges to store malicious JavaScript payloads in uploaded style/legend resources or in specially crafted datastore files.", "Impact and Scope": "The vulnerability has a CVSS score of 4.8, indicating a medium severity. It affects GeoServer versions prior to 2.23.3 and 2.24.0, and the attack vector is network-based.", "Related MITRE ATT&CK Techniques": "The vulnerability is relevant to the following MITRE ATT&CK techniques: T1194, T1568.001, and T1198.", "Technical Details": "The vulnerability exists due to a lack of input validation and sanitization in GeoServer. An attacker can inject malicious JavaScript code into style/legend resources or datastore files, which can be executed in the context of another user's browser when viewed.", "Detection": "Detection can be improved by monitoring for unusual JavaScript activity, unauthorized access, and unusual browser activity.", "Mitigation": "Mitigation strategies include implementing input validation and sanitization, using web application firewalls, and enforcing role-based access control.", "Conclusion": "The GeoServer Stored Cross-Site Scripting Vulnerability (CVE-2024-23640) is a medium-severity vulnerability that allows an attacker to inject malicious JavaScript code into style/legend resources or datastore files. Detection and mitigation strategies should be implemented to prevent exploitation."}, "executive_analysis": {"Overview": "The GeoServer Stored Cross-Site Scripting Vulnerability (CVE-2024-23640) is a medium-severity vulnerability that affects GeoServer versions prior to 2.23.3 and 2.24.0.", "Business Impact": "The vulnerability has the potential to impact business operations by allowing an attacker to inject malicious JavaScript code into style/legend resources or datastore files.", "Technical Impact": "The vulnerability has a CVSS score of 4.8, indicating a medium severity. The attack vector is network-based, and the vulnerability can be exploited by an authenticated administrator with workspace-level privileges.", "Mitigation Strategies": "Mitigation strategies include implementing input validation and sanitization, using web application firewalls, and enforcing role-based access control.", "Recommendations": "We recommend that organizations immediately upgrade to GeoServer version 2.23.3 or later and implement additional security measures to prevent exploitation of this vulnerability.", "Conclusions": "The GeoServer Stored Cross-Site Scripting Vulnerability (CVE-2024-23640) is a serious vulnerability that requires immediate attention and mitigation. Organizations must prioritize upgrading and implementing additional security measures to prevent exploitation."}}