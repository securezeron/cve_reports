{"id": "CVE-2024-39877", "sourceIdentifier": "security@apache.org", "published": "2024-07-17T08:15:02.073", "lastModified": "2024-08-01T13:56:00.307", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Apache Airflow 2.4.0, and versions before 2.9.3, has a vulnerability that allows authenticated DAG authors to craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context, which should be forbidden according to the Airflow Security model. Users should upgrade to version 2.9.3 or later which has removed the vulnerability."}, {"lang": "es", "value": "Apache Airflow 2.4.0 y versiones anteriores a 2.9.3 tienen una vulnerabilidad que permite a los autores de DAG autenticados crear un par\u00e1metro doc_md de manera que pueda ejecutar c\u00f3digo arbitrario en el contexto del programador, lo que deber\u00eda estar prohibido seg\u00fan el modelo de seguridad de Airflow. Los usuarios deben actualizar a la versi\u00f3n 2.9.3 o posterior, que elimin\u00f3 la vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@apache.org", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-277"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:airflow:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.4.0", "versionEndExcluding": "2.9.3", "matchCriteriaId": "7AFAC89A-220F-4E86-BB03-8F9439217EEA"}]}]}], "references": [{"url": "https://github.com/apache/airflow/pull/40522", "source": "security@apache.org", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://lists.apache.org/thread/1xhj9dkp37d6pzn24ll2mf94wbqnb2y1", "source": "security@apache.org", "tags": ["Mailing List"]}], "techniques": [{"techniqueID": "T1220", "comment": "CVE-2024-39877 - Apache Airflow 2.4.0 and earlier versions can allow authenticated DAG authors to craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context."}, {"techniqueID": "T1224", "comment": "CVE-2024-39877 - Apache Airflow 2.4.0 and earlier versions can allow authenticated DAG authors to craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context."}, {"techniqueID": "T1225", "comment": "CVE-2024-39877 - Apache Airflow 2.4.0 and earlier versions can allow authenticated DAG authors to craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context."}, {"techniqueID": "T1204", "comment": "CVE-2024-39877 - Apache Airflow 2.4.0 and earlier versions can allow authenticated DAG authors to craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context."}], "stix_bundle": {"bundle": {"type": "bundle", "spec_version": "2.1", "id": "https://example.com/STIX2.1_bundle", "objects": [{"type": "vulnerability", "id": "https://example.com/CVE-2024-39877", "name": "Apache Airflow 2.4.0 and earlier versions", "description": "Apache Airflow 2.4.0 and earlier versions have a vulnerability that allows authenticated DAG authors to craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context.", "references": [{"href": "https://github.com/apache/airflow/pull/40522", "type": "IssueTracking"}]}, {"type": "indicator", "id": "https://example.com/indicator-1", "name": "Apache Airflow 2.4.0 and earlier versions", "description": "Apache Airflow 2.4.0 and earlier versions have a vulnerability that allows authenticated DAG authors to craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context.", "observable": {"type": "Uri", " value": "https://example.com/airflow"}}, {"type": "indicator", "id": "https://example.com/indicator-2", "name": "Apache Airflow 2.4.0 and earlier versions", "description": "Apache Airflow 2.4.0 and earlier versions have a vulnerability that allows authenticated DAG authors to craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context.", "observable": {"type": "Uri", "value": "https://example.com/airflow"}}]}}, "technical_analysis": {"Introduction": "Apache Airflow 2.4.0 and earlier versions have a vulnerability that allows authenticated DAG authors to craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 and affects Apache Airflow 2.4.0 and earlier versions.", "Related MITRE ATT&CK Techniques": "T1220, T1224, T1225, T1204", "Technical Details": "The vulnerability occurs when authenticated DAG authors craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context.", "Detection": "Detect the vulnerability by monitoring for suspicious doc_md parameters in Apache Airflow logs.", "Mitigation": "Upgrade to Apache Airflow 2.9.3 or later, or apply the patch provided by Apache.", "Conclusion": "The vulnerability in Apache Airflow 2.4.0 and earlier versions allows authenticated DAG authors to craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context, and must be addressed by upgrading or patching."}, "executive_analysis": {"Overview": "Apache Airflow 2.4.0 and earlier versions have a vulnerability that allows authenticated DAG authors to craft a doc_md parameter in a way that could execute arbitrary code in the scheduler context.", "Business Impact": "The vulnerability could allow attackers to execute arbitrary code in the scheduler context, which could result in data breach or other types of malicious activity.", "Technical Impact": "The vulnerability affects Apache Airflow 2.4.0 and earlier versions, which could result in data breach or other types of malicious activity.", "Mitigation Strategies": "Upgrade to Apache Airflow 2.9.3 or later, or apply the patch provided by Apache.", "Recommendations": "Recommend that Apache Airflow users upgrade to the latest version or apply the patch provided by Apache.", "Conclusions": "The vulnerability in Apache Airflow 2.4.0 and earlier versions must be addressed by upgrading or patching, and Apache should provide additional support to its users."}}