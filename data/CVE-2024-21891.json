{"id": "CVE-2024-21891", "sourceIdentifier": "support@hackerone.com", "published": "2024-02-20T02:15:50.347", "lastModified": "2024-05-01T18:15:13.500", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Node.js depends on multiple built-in utility functions to normalize paths provided to node:fs functions, which can be overwitten with user-defined implementations leading to filesystem permission model bypass through path traversal attack.\nThis vulnerability affects all users using the experimental permission model in Node.js 20 and Node.js 21.\nPlease note that at the time this CVE was issued, the permission model is an experimental feature of Node.js."}, {"lang": "es", "value": "Node.js depende de m\u00faltiples funciones de utilidad integradas para normalizar las rutas proporcionadas a las funciones de node:fs, que pueden ser exageradas con implementaciones definidas por el usuario que conducen a la omisi\u00f3n del modelo de permisos del sistema de archivos mediante un ataque de path traversal. Esta vulnerabilidad afecta a todos los usuarios que utilizan el modelo de permiso experimental en Node.js 20 y Node.js 21. Tenga en cuenta que en el momento en que se emiti\u00f3 este CVE, el modelo de permiso es una caracter\u00edstica experimental de Node.js."}], "metrics": {"cvssMetricV30": [{"source": "support@hackerone.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.9, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.5, "impactScore": 5.8}]}, "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/03/11/1", "source": "support@hackerone.com"}, {"url": "https://hackerone.com/reports/2259914", "source": "support@hackerone.com"}, {"url": "https://security.netapp.com/advisory/ntap-20240315-0005/", "source": "support@hackerone.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-21891 - This susceptibility can be exploited using file traversal attacks, allowing attackers to bypass filesystem permission models and access sensitive files. Defend against this by implementing secure path normalization and validating user-input paths."}, {"techniqueID": "T1027", "comment": "CVE-2024-21891 - Attackers may attempt to exploit this vulnerability by manipulating user-defined path implementation, enabling them to access restricted areas of the filesystem. Defend against this by implementing secure path validation and restricting file permissions."}], "stix_bundle": {"@stix2-extension": "1.2", "_bundle": {"id": "bundle--", "type": "bundle", "created_by_ref": "identity--", "created_at": "2024-05-01T18:15:13.500", "_MODIFIED": "2024-05-01T18:15:13.500", "information_sources": [{"id": "identity--", "type": "identity"}], "objects": [{"id": "vulnerability--", "type": "vulnerability", "name": "Node.js Path Normalization Permission Model Bypass Vulnerability (CVE-2024-21891)", "description": "Node.js depends on multiple built-in utility functions to normalize paths provided to node:fs functions, which can be overwritten with user-defined implementations leading to filesystem permission model bypass through path traversal attack.", "created_by_ref": "identity--", "created_at": "2024-05-01T18:15:13.500", "_MODIFIED": "2024-05-01T18:15:13.500", "labels": ["Vulnerability"], "recommendations": [{"id": "mitigation--", "type": "mitigation"}], "affected_components": [{"id": "binary--", "type": "binary", "name": "Node.js", "version": "20, 21", "component_type": "Library"}], "impact": {"description": "This vulnerability affects all users using the experimental permission model in Node.js 20 and Node.js 21.", "impact_category": "Security"}}, {"id": "mitigation--", "type": "mitigation", "name": "Implement Secure Path Normalization and Validation", "description": "Implement secure path normalization and validation to prevent attackers from exploiting this vulnerability.", "created_by_ref": "identity--", "created_at": "2024-05-01T18:15:13.500", "_MODIFIED": "2024-05-01T18:15:13.500", "techniques": [{"id": "T1190", "type": "technique"}], "cisa": [{"id": "CISA--", "type": "cisa"}]}, {"id": "cisa--", "type": "cisa", "name": "Implement Secure Path Normalization and Validation (CISA-2024-23-14)", "description": "Implement Secure Path Normalization and Validation to prevent attackers from exploiting Node.js Path Normalization Permission Model Bypass Vulnerability (CVE-2024-21891).", "created_by_ref": "identity--", "created_at": "2024-05-01T18:15:13.500", "_MODIFIED": "2024-05-01T18:15:13.500", "techniques": [{"id": "T1190", "type": "technique"}]}]}}, "technical_analysis": {"Introduction": "Node.js Path Normalization Permission Model Bypass Vulnerability (CVE-2024-21891) is a vulnerability that allows attackers to bypass filesystem permission models and access sensitive files by exploiting the experimental permission model in Node.js 20 and Node.js 21.", "Impact and Scope": "The vulnerability has a CVSS score of 7.9 and an attack vector of LOCAL. It affects all users using the experimental permission model in Node.js 20 and Node.js 21.", "Related MITRE ATT&CK Techniques": "This vulnerability is relevant to techniques T1190 and T1027.", "Technical Details": "The vulnerability occurs due to the dependency on multiple built-in utility functions to normalize paths provided to node:fs functions, which can be overwritten with user-defined implementations.", "Detection": "Detect the vulnerability by monitoring for suspicious file interactions and enforcing secure path normalization and validation.", "Mitigation": "Mitigate the vulnerability by implementing secure path normalization and validation, and restricting file permissions.", "Conclusion": "Node.js Path Normalization Permission Model Bypass Vulnerability (CVE-2024-21891) is a critical vulnerability that requires prompt mitigation to prevent attackers from exploiting it."}, "executive_analysis": {"Overview": "Node.js Path Normalization Permission Model Bypass Vulnerability (CVE-2024-21891) is a serious vulnerability that can be exploited to gain unauthorized access to sensitive files.", "Business Impact": "This vulnerability has a significant impact on businesses that use Node.js 20 and Node.js 21, as it can lead to data breaches and unauthorized access to sensitive information.", "Technical Impact": "The vulnerability has a CVSS score of 7.9 and an attack vector of LOCAL, making it a high-priority vulnerability to be mitigated.", "Mitigation Strategies": "Implement secure path normalization and validation, and restrict file permissions to prevent attackers from exploiting this vulnerability.", "Recommendations": "Promptly update Node.js to the latest version, and implement secure path normalization and validation to prevent attackers from exploiting this vulnerability.", "Conclusions": "Node.js Path Normalization Permission Model Bypass Vulnerability (CVE-2024-21891) is a critical vulnerability that requires immediate attention and prompt mitigation to prevent attackers from exploiting it."}}