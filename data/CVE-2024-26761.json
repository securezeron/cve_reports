{"id": "CVE-2024-26761", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-03T17:15:52.413", "lastModified": "2024-04-03T17:24:18.150", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ncxl/pci: Fix disabling memory if DVSEC CXL Range does not match a CFMWS window\n\nThe Linux CXL subsystem is built on the assumption that HPA == SPA.\nThat is, the host physical address (HPA) the HDM decoder registers are\nprogrammed with are system physical addresses (SPA).\n\nDuring HDM decoder setup, the DVSEC CXL range registers (cxl-3.1,\n8.1.3.8) are checked if the memory is enabled and the CXL range is in\na HPA window that is described in a CFMWS structure of the CXL host\nbridge (cxl-3.1, 9.18.1.3).\n\nNow, if the HPA is not an SPA, the CXL range does not match a CFMWS\nwindow and the CXL memory range will be disabled then. The HDM decoder\nstops working which causes system memory being disabled and further a\nsystem hang during HDM decoder initialization, typically when a CXL\nenabled kernel boots.\n\nPrevent a system hang and do not disable the HDM decoder if the\ndecoder's CXL range is not found in a CFMWS window.\n\nNote the change only fixes a hardware hang, but does not implement\nHPA/SPA translation. Support for this can be added in a follow on\npatch series."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: cxl/pci: corrige la desactivaci\u00f3n de la memoria si el rango DVSEC CXL no coincide con una ventana CFMWS. El subSYSTEM Linux CXL se basa en el supuesto de que HPA == SPA. Es decir, la direcci\u00f3n f\u00edsica del host (HPA) con la que est\u00e1n programados los registros del decodificador HDM son direcciones f\u00edsicas del SYSTEM (SPA). Durante la configuraci\u00f3n del decodificador HDM, los registros de rango DVSEC CXL (cxl-3.1, 8.1.3.8) se verifican si la memoria est\u00e1 habilitada y el rango CXL est\u00e1 en una ventana HPA que se describe en una estructura CFMWS del puente de host CXL (cxl- 3.1, 9.18.1.3). Ahora, si el HPA no es un SPA, el rango CXL no coincide con una ventana CFMWS y el rango de memoria CXL se desactivar\u00e1 en ese momento. El descodificador HDM deja de funcionar, lo que provoca que la memoria del SYSTEM se desactive y, adem\u00e1s, el SYSTEM se cuelgue durante la inicializaci\u00f3n del descodificador HDM, normalmente cuando se inicia un kernel habilitado para CXL. Evite que el SYSTEM se cuelgue y no desactive el decodificador HDM si el rango CXL del decodificador no se encuentra en una ventana CFMWS. Tenga en cuenta que el cambio solo soluciona un problema de hardware, pero no implementa la traducci\u00f3n HPA/SPA. Se puede agregar soporte para esto en una serie de parches de seguimiento."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/031217128990d7f0ab8c46db1afb3cf1e075fd29", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/0cab687205986491302cd2e440ef1d253031c221", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/2cc1a530ab31c65b52daf3cb5d0883c8b614ea69", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/3a3181a71935774bda2398451256d7441426420b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-26761 - Insufficient data validation/ sanitization in the Linux kernel's CXL subsystem allows for potential memory corruption, leading to a system hang."}, {"techniqueID": "T1198", "comment": "CVE-2024-26761 - Lack of input validation and sanitization in the Linux kernel's CXL subsystem enables an attacker to inject malicious code"}, {"techniqueID": "T1210", "comment": "CVE-2024-26761 - The Linux kernel's CXL subsystem failure to remove access to the affected area of memory can lead to an attacker gaining unauthorized access"}], "stix_bundle": {"bundle": {"title": "STIX Bundle for CVE-2024-26761", "created_by_ref": "my_uuid", "created": "2024-04-03T17:15:52.413", "modified": "2024-04-03T17:24:18.150", "objects": [{"id": "vulnerability--cve-2024-26761", "type": "vulnerability", "name": "CVE-2024-26761", "description": "In the Linux kernel, the following vulnerability has been resolved:\ncmpx/pci: Fix disabling memory if DVSEC CXL Range does not match a CFMWS window\n\n...", "references": [{"source_name": "Linux Kernel Bugzilla", "url": "https://git.kernel.org/stable/c/031217128990d7f0ab8c46db1afb3cf1e075fd29", "source_id": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"source_name": "Linux Kernel Bugzilla", "url": "https://git.kernel.org/stable/c/0cab687205986491302cd2e440ef1d253031c221", "source_id": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}]}, {"id": "attack-pattern--cxl-memory-corruption", "type": "attack-pattern", "name": "CXL Memory Corruption", "description": "An attacker can inject malicious code into the Linux kernel's CXL subsystem, leading to memory corruption", "kill_chain_phases": [{"kill_chain_name": "MITRE ATT&CK", "phase_name": "Initial Access", "phase_id": "TA0001"}]}, {"id": "incident-identity--system-hang", "type": "incident-identity", "name": "System Hang", "description": "System hangs caused by CVE-2024-26761", "kill_chain_phases": [{"kill_chain_name": "MITRE ATT&CK", "phase_name": "Initial Access", "phase_id": "TA0001"}]}]}}, "technical_analysis": {"Introduction": "CVE-2024-26761 is a vulnerability in the Linux kernel's CXL subsystem that allows attackers to inject malicious code and cause memory corruption, leading to system hangs.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 ( CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). It is an issue in the Linux kernel and affects systems running Linux with CXL support.", "Related MITRE ATT&CK Techniques": "T1190, T1198, and T1210", "Technical Details": "The vulnerability occurs because of insufficient data validation and sanitization in the Linux kernel's CXL subsystem, allowing an attacker to inject malicious code and cause memory corruption.", "Detection": "Detection methods include monitoring system logs for errors related to CXL memory corruption and monitoring system memory usage for signs of unusual activity.", "Mitigation": "Mitigation strategies include updating to a patched version of the Linux kernel, enabling CXL memory protection, and implementing memory corruption detection tools.", "Conclusion": "In conclusion, CVE-2024-26761 is a significant vulnerability in the Linux kernel's CXL subsystem that can be used to inject malicious code and cause system hangs."}, "executive_analysis": {"Overview": "CVE-2024-26761 is a critical vulnerability in the Linux kernel's CXL subsystem that has the potential to allow attackers to inject malicious code and cause system hangs.", "Business Impact": "The vulnerability has the potential to cause significant business disruption, particularly for organizations that rely heavily on Linux and CXL technologies.", "Technical Impact": "The vulnerability is a significant technical risk, as it can allow attackers to inject malicious code and cause system hangs, potentially leading to data breaches and unauthorized access.", "Mitigation Strategies": "Implementing patch management, enabling CXL memory protection, and implementing memory corruption detection tools can help mitigate the risk associated with this vulnerability", "Recommendations": "Executive leadership should prioritize addressing this vulnerability and ensure that adequate resources are allocated to patch management and risk mitigation.", "Conclusions": "In conclusion, CVE-2024-26761 is a critical vulnerability that requires immediate attention and action from executive leadership."}}