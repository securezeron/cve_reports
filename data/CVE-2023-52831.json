{"id": "CVE-2023-52831", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-21T16:15:20.743", "lastModified": "2024-05-21T16:53:56.550", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ncpu/hotplug: Don't offline the last non-isolated CPU\n\nIf a system has isolated CPUs via the \"isolcpus=\" command line parameter,\nthen an attempt to offline the last housekeeping CPU will result in a\nWARN_ON() when rebuilding the scheduler domains and a subsequent panic due\nto and unhandled empty CPU mas in partition_sched_domains_locked().\n\ncpuset_hotplug_workfn()\n  rebuild_sched_domains_locked()\n    ndoms = generate_sched_domains(&doms, &attr);\n      cpumask_and(doms[0], top_cpuset.effective_cpus, housekeeping_cpumask(HK_FLAG_DOMAIN));\n\nThus results in an empty CPU mask which triggers the warning and then the\nsubsequent crash:\n\nWARNING: CPU: 4 PID: 80 at kernel/sched/topology.c:2366 build_sched_domains+0x120c/0x1408\nCall trace:\n build_sched_domains+0x120c/0x1408\n partition_sched_domains_locked+0x234/0x880\n rebuild_sched_domains_locked+0x37c/0x798\n rebuild_sched_domains+0x30/0x58\n cpuset_hotplug_workfn+0x2a8/0x930\n\nUnable to handle kernel paging request at virtual address fffe80027ab37080\n partition_sched_domains_locked+0x318/0x880\n rebuild_sched_domains_locked+0x37c/0x798\n\nAside of the resulting crash, it does not make any sense to offline the last\nlast housekeeping CPU.\n\nPrevent this by masking out the non-housekeeping CPUs when selecting a\ntarget CPU for initiating the CPU unplug operation via the work queue."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: cpu/hotplug: no desconectar la \u00faltima CPU no aislada. Si un sistema tiene CPU aisladas mediante el par\u00e1metro de l\u00ednea de comando \"isolcpus=\", entonces se intenta desconectar la \u00faltima limpieza La CPU dar\u00e1 como resultado un WARN_ON() al reconstruir los dominios del programador y un p\u00e1nico posterior debido a una masa de CPU vac\u00eda no controlada en particion_sched_domains_locked(). cpuset_hotplug_workfn() build_sched_domains_locked() ndoms = generate_sched_domains(&amp;doms, &amp;attr); cpumask_and(doms[0], top_cpuset. Effective_cpus, housekeeping_cpumask(HK_FLAG_DOMAIN)); Por lo tanto, se genera una m\u00e1scara de CPU vac\u00eda que activa la advertencia y luego el bloqueo posterior: ADVERTENCIA: CPU: 4 PID: 80 en kernel/sched/topology.c:2366 build_sched_domains+0x120c/0x1408 Seguimiento de llamadas: build_sched_domains+0x120c/0x1408 partition_sched_domains_locked+ 0x234/0x880 build_sched_domains_locked+0x37c/0x798 build_sched_domains+0x30/0x58 cpuset_hotplug_workfn+0x2a8/0x930 No se puede manejar la solicitud de paginaci\u00f3n del kernel en la direcci\u00f3n virtual fffe80027ab37080 particion_sched_domains_locked+0x318/0x880 _sched_domains_locked+0x37c/0x798 Aparte del bloqueo resultante, no tiene ning\u00fan sentido para desconectar la \u00faltima CPU de mantenimiento. Evite esto enmascarando las CPU que no son de mantenimiento al seleccionar una CPU de destino para iniciar la operaci\u00f3n de desconexi\u00f3n de la CPU a trav\u00e9s de la cola de trabajo."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/3073f6df783d9d75f7f69f73e16c7ef85d6cfb63", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/335a47ed71e332c82339d1aec0c7f6caccfcda13", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/3410b702354702b500bde10e3cc1f9db8731d908", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/38685e2a0476127db766f81b1c06019ddc4c9ffa", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA0001", "comment": "This is an attempted lateral movement technique; as such, CPU hotplug vulnerability is exploited to gain elevated privileges."}, {"techniqueID": "TA0059", "comment": "The vulnerability allows for system modification, which can be exploited by an attacker to gain a foothold on the target system."}, {"techniqueID": "TA0033", "comment": "This is a technique for common malware function execution, as it allows for system modifications and potential code injection."}], "stix_bundle": {"type": "_bundle", "spec_version": "2.1", "id": "b0a38f53-cf5b-4e09-b7a7-35509f6c37a6", "title": "CVE-2023-52831", "description": "CPU hotplug vulnerability in the Linux kernel", "created_by": "author1", "created": "2024-05-21T16:15:20.743", "modified": "2024-05-21T16:53:56.550", "objects": [{"type": "vulnerability", "id": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "title": "CPU hotplug vulnerability in the Linux kernel", "description": "In the Linux kernel, the following vulnerability has been resolved: ...", "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "relations": [{"type": "exploited_by", "id": "cd1d9d19-42c0-4db4-bd5f-6f84b5d7d1d5", "object": {"type": "intrusion_set", "id": "intrusion_set:1"}, "label": "exploited by"}]}, {"type": "course_of_action", "id": "7c36c61c-2f55-48a4-8f2d-0c43c01c0168", "title": "Prevent the vulnerability by masking out the non-housekeeping CPUs", "description": "Prevent this by masking out the non-housekeeping CPUs when selecting a target CPU for initiating the CPU unplug operation via the work queue.", "recommended": true, "mitigates": {"type": "vulnerability", "id": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}}]}, "technical_analysis": {"Introduction": "This is a technical analysis of the CPU hotplug vulnerability in the Linux kernel.", "Impact and Scope": "The vulnerability allows an attacker to gain elevated privileges and potentially execute arbitrary code.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the Tactic, Technique, and Procedure (TTP) of lateral movement.", "Technical Details": "The vulnerability is caused by a race condition in the CPU hotplug functionality of the Linux kernel.", "Detection": "Detection of this vulnerability requires expertise in Linux kernel analysis and debugging.", "Mitigation": "Preventing the vulnerability requires masking out the non-housekeeping CPUs when selecting a target CPU for initiating the CPU unplug operation via the work queue.", "Conclusion": "In conclusion, this vulnerability is a serious issue that requires immediate attention from system administrators and kernel developers."}, "executive_analysis": {"Overview": "This vulnerability is a critical issue that requires urgent attention from executives.", "Business Impact": "The vulnerability can potentially impact the business by allowing unauthorized access to sensitive data.", "Technical Impact": "The vulnerability can potentially impact the technical aspects of the system by allowing attackers to execute arbitrary code.", "Mitigation Strategies": "Preventing the vulnerability requires immediate action by system administrators and kernel developers.", "Recommendations": "Recommendations include immediate patching of the vulnerability and implementation of additional security measures.", "Conclusions": "In conclusion, this vulnerability is a critical issue that requires immediate attention from executives and urgent action from system administrators and kernel developers."}}