{"id": "CVE-2015-1158", "sourceIdentifier": "product-security@apple.com", "published": "2015-06-26T10:59:00.093", "lastModified": "2017-09-23T01:29:00.717", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The add_job function in scheduler/ipp.c in cupsd in CUPS before 2.0.3 performs incorrect free operations for multiple-value job-originating-host-name attributes, which allows remote attackers to trigger data corruption for reference-counted strings via a crafted (1) IPP_CREATE_JOB or (2) IPP_PRINT_JOB request, as demonstrated by replacing the configuration file and consequently executing arbitrary code."}, {"lang": "es", "value": "La funci\u00f3n add_job en scheduler/ipp.c en cupsd en CUPS anterior a 2.0.3 realiza incorrectamente las operaciones libres para los atributos de los nombres de anfitriones que originan trabajos de m\u00faltiples valores, lo que permite a atacantes remotos provocar la corrupci\u00f3n de datos para las cadenas de referencias contadas a trav\u00e9s de una solicitud (1) IPP_CREATE_JOB o (2) IPP_PRINT_JOB manipulada, tal y como fue demostrado mediante el remplazo del fichero de configuraci\u00f3n y como consecuencia la ejecuci\u00f3n de c\u00f3digo arbitrario."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-254"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:cups:cups:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.0.2", "matchCriteriaId": "E16A5939-A072-4A0C-AD13-9A580B0DF4D3"}]}]}], "references": [{"url": "http://googleprojectzero.blogspot.in/2015/06/owning-internet-printing-case-study-in.html", "source": "product-security@apple.com"}, {"url": "http://kb.juniper.net/InfoCenter/index?page=content&id=JSA10702", "source": "product-security@apple.com"}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2015-06/msg00003.html", "source": "product-security@apple.com"}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2015-06/msg00006.html", "source": "product-security@apple.com"}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2015-06/msg00010.html", "source": "product-security@apple.com"}, {"url": "http://rhn.redhat.com/errata/RHSA-2015-1123.html", "source": "product-security@apple.com"}, {"url": "http://www.cups.org/blog.php?L1082", "source": "product-security@apple.com", "tags": ["Vendor Advisory"]}, {"url": "http://www.debian.org/security/2015/dsa-3283", "source": "product-security@apple.com"}, {"url": "http://www.kb.cert.org/vuls/id/810572", "source": "product-security@apple.com", "tags": ["Third Party Advisory", "US Government Resource"]}, {"url": "http://www.securityfocus.com/bid/75098", "source": "product-security@apple.com"}, {"url": "http://www.securitytracker.com/id/1032556", "source": "product-security@apple.com"}, {"url": "http://www.ubuntu.com/usn/USN-2629-1", "source": "product-security@apple.com"}, {"url": "https://bugzilla.opensuse.org/show_bug.cgi?id=924208", "source": "product-security@apple.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1221641", "source": "product-security@apple.com"}, {"url": "https://code.google.com/p/google-security-research/issues/detail?id=455", "source": "product-security@apple.com"}, {"url": "https://github.com/0x00string/oldays/blob/master/CVE-2015-1158.py", "source": "product-security@apple.com"}, {"url": "https://security.gentoo.org/glsa/201510-07", "source": "product-security@apple.com"}, {"url": "https://www.cups.org/str.php?L4609", "source": "product-security@apple.com", "tags": ["Vendor Advisory"]}, {"url": "https://www.exploit-db.com/exploits/37336/", "source": "product-security@apple.com"}, {"url": "https://www.exploit-db.com/exploits/41233/", "source": "product-security@apple.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2015-1158 - This technique allows attackers to trigger data corruption for reference-counted strings via a crafted (1) IPP_CREATE_JOB or (2) IPP_PRINT_JOB request. Defending against this threat requires implementing proper input validation and sanitization mechanisms."}, {"techniqueID": "T1505", "comment": "CVE-2015-1158 - This technique is used to exploit the vulnerability in CUPS for arbitrary code execution. Defending against this threat requires patching the CUPS software and implementing a robust incident response plan."}, {"techniqueID": "T1190", "comment": "CVE-2015-1158 - This technique allows attackers to control the flow of data in the system by exploiting the vulnerability in CUPS. Defending against this threat requires implementing data encryption and proper access control mechanisms."}], "stix_bundle": {"id": "bundle-1", "type": "bundle", "created_by_ref": "vulnerability-1", "created": "2020-01-01T00:00:00.000Z", "modified": "2020-01-01T00:00:00.000Z", "title": "CVE-2015-1158 - CUPS Vulnerability", "description": "Bundle containing details on the CVE-2015-1158 vulnerability in CUPS and related threat intelligence.", "objects": [{"id": "vulnerability-1", "type": "vulnerability", "created_by_ref": "user-1", "created": "2020-01-01T00:00:00.000Z", "modified": "2020-01-01T00:00:00.000Z", "name": "CVE-2015-1158", "description": "CUPS vulnerability allowing remote attackers to trigger data corruption for reference-counted strings via a crafted (1) IPP_CREATE_JOB or (2) IPP_PRINT_JOB request.", "cvssv2": {"vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}}, {"id": "relationship-1", "type": "relationship", "predicate": "indicates", "object_ref": "vulnerability-1", "subject_ref": "technique-1"}, {"id": "technique-1", "type": "s-mutable", "created_by_ref": "user-1", "created": "2020-01-01T00:00:00.000Z", "modified": "2020-01-01T00:00:00.000Z", "name": "T1210", "description": "Exploit Public-Facing Application"}, {"id": "relationship-2", "type": "relationship", "predicate": "uses", "object_ref": "technique-1", "subject_ref": "vulnerability-1"}, {"id": "ca-1", "type": "course-of-action", "created_by_ref": "user-1", "created": "2020-01-01T00:00:00.000Z", "modified": "2020-01-01T00:00:00.000Z", "name": "Apply Patch", "description": "Apply the latest patch for CUPS to mitigate the vulnerability.", "mitigates_technique_ref": "technique-1"}], "relationships": [{"id": "relationship-1", "type": "relationship", "predicate": "indicates", "object_ref": "vulnerability-1", "subject_ref": "technique-1"}, {"id": "relationship-2", "type": "relationship", "predicate": "uses", "object_ref": "technique-1", "subject_ref": "vulnerability-1"}, {"id": "relationship-3", "type": "relationship", "predicate": "mitigates", "object_ref": "ca-1", "subject_ref": "technique-1"}]}, "technical_analysis": {"Introduction": "This section provides an in-depth technical analysis of the CVE-2015-1158 vulnerability in CUPS.", "Impact and Scope": "The vulnerability allows remote attackers to trigger data corruption for reference-counted strings via a crafted (1) IPP_CREATE_JOB or (2) IPP_PRINT_JOB request.", "Related MITRE ATT&CK Techniques": "The vulnerabilities is related to the following MITRE ATT&CK techniques: T1210, T1505, and T1190.", "Technical Details": "The vulnerability occurs when the add_job function in scheduler/ipp.c in cupsd in CUPS before 2.0.3 performs incorrect free operations for multiple-value job-originating-host-name attributes.", "Detection": "Detection methods include monitoring system logs for suspicious activity and implementing network traffic analysis tools.", "Mitigation": "Mitigation strategies include applying the latest patch for CUPS and implementing a robust incident response plan.", "Conclusion": "In conclusion, the CVE-2015-1158 vulnerability in CUPS is a critical threat that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "This section provides an executive-level analysis of the CVE-2015-1158 vulnerability in CUPS.", "Business Impact": "The vulnerability has significant business impact, as it can allow remote attackers to trigger data corruption in CUPS.", "Technical Impact": "The technical impact of the vulnerability is the potential for remote code execution and data corruption.", "Mitigation Strategies": "Mitigation strategies include applying the latest patch for CUPS and implementing a robust incident response plan.", "Recommendations": "We recommend that executives prioritize patching CUPS and implementing incident response plans to mitigate the risk of attack.", "Conclusions": "In conclusion, the CEO and other executives should prioritize addressing the CVE-2015-1158 vulnerability in CUPS due to its critical nature and potential impact on the organization."}}