{"id": "CVE-2024-32022", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-16T15:15:36.870", "lastModified": "2024-04-19T16:15:10.533", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Kohya_ss is a GUI for Kohya's Stable Diffusion trainers. Kohya_ss  is vulnerable to command injection in basic_caption_gui.py. This vulnerability is fixed in 23.1.5."}, {"lang": "es", "value": "Kohya_ss es una GUI para los entrenadores Stable Diffusion de Kohya. Kohya_ss es vulnerable a la inyecci\u00f3n de comandos en basic_caption_gui.py. Esta vulnerabilidad se solucion\u00f3 en 23.1.5."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-77"}]}], "references": [{"url": "https://github.com/bmaltais/kohya_ss/commit/831af8babeb75faff62bcc6a8c6a4f80354f1ff1", "source": "security-advisories@github.com"}, {"url": "https://github.com/bmaltais/kohya_ss/security/advisories/GHSA-m6jq-7j4v-2fg3", "source": "security-advisories@github.com"}, {"url": "https://securitylab.github.com/advisories/GHSL-2024-019_GHSL-2024-024_kohya_ss", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-32022 - A command injection vulnerability allows an attacker to inject OS commands, making it a high-priority issue. To defend against this, ensure proper input validation and sanitization in the GUI's basic_caption_gui.py file."}, {"techniqueID": "T1059", "comment": "CVE-2024-32022 - The vulnerability in basic_caption_gui.py allows an attacker to execute arbitrary commands, posing a significant risk. Implement proper access controls and segregation of duties to minimize the attack surface."}, {"techniqueID": "T1076", "comment": "CVE-2024-32022 - The vulnerable GUI aspect provides an entry point for attackers to inject commands, making it essential to integrate defense strategies that focus on user interaction."}, {"techniqueID": "T1190", "comment": "CVE-2024-32022 - The vulnerability's impact on the GUI's stability and integrity highlights the importance of implementing robust defense strategies that focus on availability."}], "stix_bundle": {"@stix_bundl": {"type": "bundle", "id": "bundle--f6b6f8c1-f8e5-4b5b-99cd-3e3a9f6be8d9"}, "objects": [{"id": "object--34567890", "type": "vulnerability", "name": "Kohya_ss Command Injection Vulnerability", "description": "The basic_caption_gui.py file in Kohya_ss GUI for Kohya's Stable Diffusion trainers contains a command injection vulnerability.", "exploitability": "Moderately Exploitable", "impact": "High", "cvss_score": "9.1", "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N"}, {"id": "object--24678901", "type": "attacker", "name": "Malicious Actor", "description": "An attacker compromising the Kohya_ss GUI"}, {"id": "object--34567892", "type": "course_of_action", "name": "Validate User Input", "description": "Validate user input to prevent command injection attacks", "mitigates": ["object--34567890"]}, {"id": "object--24678903", "type": "course_of_action", "name": "Implement Access Controls", "description": "Implement access controls and segregation of duties to minimize the attack surface", "mitigates": ["object--34567890"]}], "relationships": [{"id": "relationship--f6b6f8c1-f8e5-4b5b-99cd-3e3a9f6be8d9", "type": "related_to", "objects": [{"id": "object--34567890"}, {"id": "object--24678901"}]}, {"id": "relationship--34567895", "type": "mitigates", "objects": [{"id": "object--34567890"}, {"id": "object--34567892"}]}, {"id": "relationship--24678907", "type": "mitigates", "objects": [{"id": "object--34567890"}, {"id": "object--24678903"}]}]}, "technical_analysis": {"Introduction": "The Kohya_ss GUI for Kohya's Stable Diffusion trainers contains a command injection vulnerability in its basic_caption_gui.py file.", "Impact and Scope": "The vulnerability allows an attacker to inject OS commands, posing a high risk to system integrity and availability. The cvss score is 9.1 and the attack vector is Network.", "Related MITRE ATT&CK Techniques": "T1210, T1059, T1076, T1190", "Technical Details": "The vulnerability occurs when an attacker injects malicious input into the GUI, which is then executed as system commands.", "Detection": "Monitor system logs for suspicious command injection attempts and implement intrusion detection systems to identify potential attacks.", "Mitigation": "Implement proper input validation and sanitization, and restrict access to the GUI.", "Conclusion": "The command injection vulnerability in Kohya_ss GUI highlights the importance of robust defense strategies that focus on user interaction and access controls."}, "executive_analysis": {"Overview": "The Kohya_ss GUI for Kohya's Stable Diffusion trainers contains a critical command injection vulnerability.", "Business Impact": "The vulnerability poses a significant risk to system integrity and availability, which may lead to data breaches and financial losses.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary commands, compromising system stability and integrity.", "Mitigation Strategies": "Implement robust defense strategies, restrict access to the GUI, and monitor system logs for suspicious activity.", "Recommendations": "Patch all affected systems, restrict user access to the GUI, and implement intrusion detection systems.", "Conclusions": "The command injection vulnerability in Kohya_ss GUI emphasizes the importance of prioritizing security and implementing robust defense strategies."}}