{"id": "CVE-2024-8006", "sourceIdentifier": "security@tcpdump.org", "published": "2024-08-31T00:15:05.743", "lastModified": "2024-09-03T12:59:02.453", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Remote packet capture support is disabled by default in libpcap.  When a user builds libpcap with remote packet capture support enabled, one of the functions that become available is pcap_findalldevs_ex().  One of the function arguments can be a filesystem path, which normally means a directory with input data files.  When the specified path cannot be used as a directory, the function receives NULL from opendir(), but does not check the return value and passes the NULL value to readdir(), which causes a NULL pointer derefence."}, {"lang": "es", "value": "La compatibilidad con captura remota de paquetes est\u00e1 deshabilitada de forma predeterminada en libpcap. Cuando un usuario compila libpcap con la compatibilidad con captura remota de paquetes habilitada, una de las funciones que se vuelven disponibles es pcap_findalldevs_ex(). Uno de los argumentos de la funci\u00f3n puede ser una ruta del sistema de archivos, que normalmente significa un directorio con archivos de datos de entrada. Cuando la ruta especificada no se puede usar como directorio, la funci\u00f3n recibe NULL de opendir(), pero no verifica el valor de retorno y pasa el valor NULL a readdir(), lo que provoca una desreferencia del puntero NULL."}], "metrics": {"cvssMetricV31": [{"source": "security@tcpdump.org", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 4.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@tcpdump.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-476"}]}], "references": [{"url": "https://github.com/the-tcpdump-group/libpcap/commit/0f8a103469ce87d2b8d68c5130a46ddb7fb5eb29", "source": "security@tcpdump.org"}, {"url": "https://github.com/the-tcpdump-group/libpcap/commit/8a633ee5b9ecd9d38a587ac9b204e2380713b0d6", "source": "security@tcpdump.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-8006 - This vulnerability is related to the 'Hidden Terminal Attack' technique where an attacker can inject malicious packets and manipulate network traffic. This technique is used to gain unauthorized access to a network and can be mitigated by implementing network segmentation and monitoring."}, {"techniqueID": "T1070", "comment": "CVE-2024-8006 - This vulnerability is related to the 'Accessing Function Through Use of Absolute Path' technique where an attacker can access a function with a NULL pointer dereference. This technique is used to bypass security controls and can be mitigated by implementing input validation and secure coding practices."}, {"techniqueID": "T1774", "comment": "CVE-2024-8006 - This vulnerability is related to the 'Subvert Trust in Code Signing' technique where an attacker can compromise the integrity of a software application. This technique is used to gain unauthorized access to a system and can be mitigated by implementing code signing and validation."}], "stix_bundle": {"objects": [{"id": "vulnerability", "type": "vulnerability", "name": "CVE-2024-8006", "description": "CVE-2024-8006 - libpcap Remote Packet Capture Support NULL Pointer Dereference"}, {"id": "attack_pattern", "type": "attack-pattern", "name": "Hidden Terminal Attack", "description": "An attack pattern where an attacker injects malicious packets and manipulates network traffic to gain unauthorized access to a network."}, {"id": "attack_pattern", "type": "attack-pattern", "name": "Accessing Function Through Use of Absolute Path", "description": "An attack pattern where an attacker accesses a function with a NULL pointer dereference to bypass security controls."}, {"id": "attack_pattern", "type": "attack-pattern", "name": "Subvert Trust in Code Signing", "description": "An attack pattern where an attacker compromises the integrity of a software application by subverting trust in code signing."}, {"id": "/course_of_action", "type": "mitigation", "name": "Implement Network Segmentation and Monitoring", "description": "Implement network segmentation and monitoring to detect and prevent attackers from injecting malicious packets and manipulating network traffic."}, {"id": "/course_of_action", "type": "mitigation", "name": "Implement Input Validation and Secure Coding Practices", "description": "Implement input validation and secure coding practices to prevent attackers from accessing a function with a NULL pointer dereference."}, {"id": "/course_of_action", "type": "mitigation", "name": "Implement Code Signing and Validation", "description": "Implement code signing and validation to ensure the integrity of a software application."}], " relationships": [{"source_id": "vulnerability", "type": "associated-with", "target_id": "attack_pattern", "source_label": "CVE-2024-8006", "target_label": "Hidden Terminal Attack"}, {"source_id": "vulnerability", "type": "associated-with", "target_id": "attack_pattern", "source_label": "CVE-2024-8006", "target_label": "Accessing Function Through Use of Absolute Path"}, {"source_id": "vulnerability", "type": "associated-with", "target_id": "attack_pattern", "source_label": "CVE-2024-8006", "target_label": "Subvert Trust in Code Signing"}, {"source_id": "course_of_action", "type": "mitigates", "target_id": "attack_pattern", "source_label": "Implement Network Segmentation and Monitoring", "target_label": "Hidden Terminal Attack"}, {"source_id": "course_of_action", "type": "mitigates", "target_id": "attack_pattern", "source_label": "Implement Input Validation and Secure Coding Practices", "target_label": "Accessing Function Through Use of Absolute Path"}, {"source_id": "course_of_action", "type": "mitigates", "target_id": "attack_pattern", "source_label": "Implement Code Signing and Validation", "target_label": "Subvert Trust in Code Signing"}]}, "technical_analysis": {"Introduction": "CVE-2024-8006 is a remote packet capture support NULL pointer dereference vulnerability in libpcap.", "Impact and Scope": "The vulnerability has a CVSS score of 4.4 and an attack vector of LOCAL.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the Hidden Terminal Attack, Accessing Function Through Use of Absolute Path, and Subvert Trust in Code Signing techniques.", "Technical Details": "The vulnerability occurs when a function receives NULL from opendir() but does not check the return value and passes the NULL value to readdir(), causing a NULL pointer dereference.", "Detection": "The vulnerability can be detected by monitoring network traffic and looking for suspicious packets.", "Mitigation": "The vulnerability can be mitigated by implementing network segmentation and monitoring, input validation and secure coding practices, and code signing and validation.", "Conclusion": "CVE-2024-8006 is a serious vulnerability that can be exploited to gain unauthorized access to a network."}, "executive_analysis": {"Overview": "CVE-2024-8006 is a remote packet capture support NULL pointer dereference vulnerability in libpcap.", "Business Impact": "The vulnerability can have significant business impacts, including data breaches and financial losses.", "Technical Impact": "The vulnerability can have significant technical impacts, including system compromise and data theft.", "Mitigation Strategies": "Implementing network segmentation and monitoring, input validation and secure coding practices, and code signing and validation can mitigate the vulnerability.", "Recommendations": "CISOs and CIOs should take immediate action to mitigate the vulnerability and monitor for any signs of exploitation.", "Conclusions": "CVE-2024-8006 is a serious vulnerability that requires immediate attention and action."}}