{"id": "CVE-2024-35958", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-20T10:15:11.057", "lastModified": "2024-06-25T21:15:59.560", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: ena: Fix incorrect descriptor free behavior\n\nENA has two types of TX queues:\n- queues which only process TX packets arriving from the network stack\n- queues which only process TX packets forwarded to it by XDP_REDIRECT\n  or XDP_TX instructions\n\nThe ena_free_tx_bufs() cycles through all descriptors in a TX queue\nand unmaps + frees every descriptor that hasn't been acknowledged yet\nby the device (uncompleted TX transactions).\nThe function assumes that the processed TX queue is necessarily from\nthe first category listed above and ends up using napi_consume_skb()\nfor descriptors belonging to an XDP specific queue.\n\nThis patch solves a bug in which, in case of a VF reset, the\ndescriptors aren't freed correctly, leading to crashes."}, {"lang": "es", "value": " En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net: ena: soluciona el comportamiento incorrecto sin descriptor. ENA tiene dos tipos de colas TX: - colas que solo procesan paquetes TX que llegan desde la pila de red - colas que solo procesan paquetes TX reenviados a mediante instrucciones XDP_REDIRECT o XDP_TX. Ena_free_tx_bufs() recorre todos los descriptores en una cola de TX y desasigna + libera todos los descriptores que a\u00fan no han sido reconocidos por el dispositivo (transacciones de TX incompletas). La funci\u00f3n supone que la cola TX procesada es necesariamente de la primera categor\u00eda enumerada anteriormente y termina usando napi_consume_skb() para los descriptores que pertenecen a una cola XDP espec\u00edfica. Este parche resuelve un error por el cual, en caso de restablecer VF, los descriptores no se liberan correctamente, lo que provoca fallos."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/19ff8fed3338898b70b2aad831386c78564912e1", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5c7f2240d9835a7823d87f7460d8eae9f4e504c7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b26aa765f7437e1bbe8db4c1641b12bd5dd378f0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/bf02d9fe00632d22fa91d34749c7aacf397b6cde", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c31baa07f01307b7ae05f3ce32b89d8e2ba0cc1d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/fdfbf54d128ab6ab255db138488f9650485795a2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA0010 - Initial Access", "comment": "CVE-2024-35958 - This vulnerability could be exploited by an attacker to gain initial access to a network, allowing them to execute arbitrary code on a vulnerable system."}, {"techniqueID": "TA0022 - Execution", "comment": "CVE-2024-35958 - An attacker could exploit this vulnerability to execute arbitrary code on a vulnerable system, potentially leading to further exploitation or data destruction."}, {"techniqueID": "TA0026 - Defense Evasion", "comment": "CVE-2024-35958 - An attacker could exploit this vulnerability to evade detection by disabling or modifying security features on a compromised system."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "objects": [{"type": "indicator", "id": "indicator--6f3089e5-4edd-4581-9d15-e1f44e8df4f1", "name": "CVE-2024-35958 Exploit Attempt", "description": "Indication of potential exploitation of CVE-2024-35958", "pattern": "_traffic: Ena drivers are being used by attackers to execute code on vulnerable systems_", "created": "2024-05-20T10:15:11.057", "modified": "2024-06-25T21:15:59.560"}, {"type": "course-of-action", "id": "course-of-action--6f3089e5-4edd-4581-9d15-e1f44e8df4f1", "name": "Update to latest Linux kernel version", "description": "Update to the latest Linux kernel version to resolve the vulnerability", "description_type": "markdown", "created": "2024-05-20T10:15:11.057", "modified": "2024-06-25T21:15:59.560"}, {"type": "course-of-action", "id": "course-of-action--6f3089e5-4edd-4581-9d15-e1f44e8df4f2", "name": "Disable USB Debugging", "description": "Disable USB debugging on vulnerable systems to prevent potential exploitation", "description_type": "markdown", "created": "2024-05-20T10:15:11.057", "modified": "2024-06-25T21:15:59.560"}, {"type": "note", "id": "note--6f3089e5-4edd-4581-9d15-e1f44e8df4f3", "content": "A note about the vulnerability and its potential impact on the organization.", "created": "2024-05-20T10:15:11.057", "modified": "2024-06-25T21:15:59.560"}], " relationships": [{"id": "r1", "type": "indicator-detects", "id_ref": "indicator--6f3089e5-4edd-4581-9d15-e1f44e8df4f1", "id_in": "course-of-action--6f3089e5-4edd-4581-9d15-e1f44e8df4f1"}, {"id": "r2", "type": "indicator-is-related-to", "id_ref": "course-of-action--6f3089e5-4edd-4581-9d15-e1f44e8df4f1", "id_in": "course-of-action--6f3089e5-4edd-4581-9d15-e1f44e8df4f2"}]}, "technical_analysis": {"Introduction": "CVE-2024-35958 is a critical vulnerability in the Linux kernel's Ena drivers, allowing attackers to execute arbitrary code on vulnerable systems.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and an attack vector of Local.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to the initial access technique TA0010 and the execution technique TA0022.", "Technical Details": "The vulnerability is caused by a bug in the Ena drivers, which allows attackers to execute arbitrary code on vulnerable systems.", "Detection": "Detection can be done by monitoring for suspicious network traffic and system resources.", "Mitigation": "Mitigation can be done by updating to the latest Linux kernel version and disabling USB debugging.", "Conclusion": "Conclusion: CVE-2024-35958 is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-35958 is a critical vulnerability in the Linux kernel's Ena drivers with a high potential impact on the organization.", "Business Impact": "The vulnerability could lead to data theft, system compromise, and reputational damage.", "Technical Impact": "The vulnerability could allow attackers to execute arbitrary code on vulnerable systems, potentially leading to further exploitation or data destruction.", "Mitigation Strategies": "Update to the latest Linux kernel version, disable USB debugging, and implement network traffic monitoring.", "Recommendations": "Recommendations for executives: prioritize patching, implement detection and monitoring, and ensure comprehensive security posture.", "Conclusions": "Conclusion: CVE-2024-35958 requires immediate attention and mitigation to protect the organization's assets and reputation."}}