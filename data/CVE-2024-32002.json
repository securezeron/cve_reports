{"id": "CVE-2024-32002", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-14T19:15:10.810", "lastModified": "2024-06-26T10:15:11.863", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Git is a revision control system. Prior to versions 2.45.1, 2.44.1, 2.43.4, 2.42.2, 2.41.1, 2.40.2, and 2.39.4, repositories with submodules can be crafted in a way that exploits a bug in Git whereby it can be fooled into writing files not into the submodule's worktree but into a `.git/` directory. This allows writing a hook that will be executed while the clone operation is still running, giving the user no opportunity to inspect the code that is being executed. The problem has been patched in versions 2.45.1, 2.44.1, 2.43.4, 2.42.2, 2.41.1, 2.40.2, and 2.39.4. If symbolic link support is disabled in Git (e.g. via `git config --global core.symlinks false`), the described attack won't work. As always, it is best to avoid cloning repositories from untrusted sources."}, {"lang": "es", "value": "Git es un sistema de control de revisiones. Antes de las versiones 2.45.1, 2.44.1, 2.43.4, 2.42.2, 2.41.1, 2.40.2 y 2.39.4, los repositorios con subm\u00f3dulos se pod\u00edan manipular de manera que explotaran un error en Git mediante el cual se deja enga\u00f1ar y escribe archivos, no en el \u00e1rbol de trabajo del subm\u00f3dulo, sino en un directorio `.git/`. Esto permite escribir un enlace que se ejecutar\u00e1 mientras la operaci\u00f3n de clonaci\u00f3n a\u00fan se est\u00e1 ejecutando, sin darle al usuario la oportunidad de inspeccionar el c\u00f3digo que se est\u00e1 ejecutando. El problema se solucion\u00f3 en las versiones 2.45.1, 2.44.1, 2.43.4, 2.42.2, 2.41.1, 2.40.2 y 2.39.4. Si la compatibilidad con enlaces simb\u00f3licos est\u00e1 deshabilitada en Git (por ejemplo, mediante `git config --global core.symlinks false`), el ataque descrito no funcionar\u00e1. Como siempre, es mejor evitar clonar repositorios de fuentes que no sean de confianza."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.2, "impactScore": 6.0}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.2, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-59"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-22"}, {"lang": "en", "value": "CWE-434"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:git:git:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.39.4", "matchCriteriaId": "67C50136-86FF-4BCF-B21F-5F09947CF6AC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:git:git:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.40.0", "versionEndExcluding": "2.40.2", "matchCriteriaId": "28F0EBE5-AAB1-4BC8-B3CA-5F0B3D71642B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:git:git:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.42.0", "versionEndExcluding": "2.42.2", "matchCriteriaId": "790B191F-6DD7-4F0A-96BD-BAD5CF3F2081"}, {"vulnerable": true, "criteria": "cpe:2.3:a:git:git:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.43.0", "versionEndExcluding": "2.43.4", "matchCriteriaId": "14C6890A-11D9-46CD-AF1D-85FAF61A0AA8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:git:git:2.41.0:*:*:*:*:*:*:*", "matchCriteriaId": "09120A06-22E2-45A6-93B3-913DB7F52788"}, {"vulnerable": true, "criteria": "cpe:2.3:a:git:git:2.44.0:*:*:*:*:*:*:*", "matchCriteriaId": "A641AB1F-0712-43F6-B7D6-E19D1D88D3C3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:git:git:2.45.0:*:*:*:*:*:*:*", "matchCriteriaId": "1E742D5F-55D2-47D7-A3CC-C359A4555E7E"}]}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/05/14/2", "source": "security-advisories@github.com"}, {"url": "https://git-scm.com/docs/git-clone#Documentation/git-clone.txt---recurse-submodulesltpathspecgt", "source": "security-advisories@github.com", "tags": ["Not Applicable"]}, {"url": "https://git-scm.com/docs/git-config#Documentation/git-config.txt-coresymlinks", "source": "security-advisories@github.com", "tags": ["Not Applicable"]}, {"url": "https://github.com/git/git/commit/97065761333fd62db1912d81b489db938d8c991d", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/git/git/security/advisories/GHSA-8h77-4q3w-gfgv", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00018.html", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/S4CK4IYTXEOBZTEM5K3T6LWOIZ3S44AR/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-32002 - This technique involves phishing for authentication credentials through social engineering, which is relevant to this vulnerability as it could be used to exploit the weakness in Git. Defenders can mitigate this by implementing multi-factor authentication and monitoring logs for suspicious activity."}, {"techniqueID": "T1077", "comment": "CVE-2024-32002 - This technique involves executing code remotely on a host with low interaction, which is relevant to this vulnerability as it could be used to exploit the weakness in Git. Defenders can mitigate this by implementing access controls and monitoring logs for suspicious activity."}], "stix_bundle": {"id": "Cve-2024-32002-Stix-Bundle", "type": "bundle", "spec_version": "2.1", "objects": {"vulnerability": {"id": "cve-2024-32002", "type": "vulnerability", "name": "Git Repository Cloning Vulnerability", "description": "Git is a revision control system. Prior to versions 2.45.1, 2.44.1, 2.43.4, 2.42.2, 2.41.1, 2.40.2, and 2.39.4, repositories with submodules can be crafted in a way that exploits a bug in Git whereby it can be fooled into writing files not into the submodule's worktree but into a .git/ directory.", "risk_score": 9.0, "attack_vector": "NETWORK", "attack_complexity": "HIGH", "privileges_required": "NONE", "user_interaction": "NONE", "scope": "CHANGED", "confidentiality_impact": "HIGH", "integrity_impact": "HIGH", "availability_impact": "HIGH"}, "mitigation": {"id": "mitigation-1", "type": "mitigation", "description": "Implement multi-factor authentication and monitoring logs for suspicious activity", "related_techniques": ["T1190", "T1077"]}, "technique": {"id": "T1077", "type": "organization-identified-technique", "name": "Windows Remote Services", "description": "The technique of using remote services to execute code on a Windows host", "related_courses_of_action": ["mitigation-1"]}}, "relationships": [{"relationship_type": "mitigates", "from": "vulnerability", "to": "mitigation"}, {"relationship_type": "uses", "from": "mitigation", "to": "technique"}]}, "technical_analysis": {"Introduction": "Git is a widely used version control system that allows developers to track changes to their code. However, a vulnerability in Git's cloning functionality can allow attackers to exploit the system and gain unauthorized access.", "Impact and Scope": "The vulnerability affects Git versions prior to 2.45.1, 2.44.1, 2.43.4, 2.42.2, 2.41.1, 2.40.2, and 2.39.4. It has a CVSS score of 9.0 and an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "T1190 - Phishing, T1077 - Windows Remote Services", "Technical Details": "The vulnerability allows attackers to craft repositories with submodules in a way that exploits a bug in Git whereby it can be fooled into writing files not into the submodule's worktree but into a .git/ directory.", "Detection": "Defenders can use logs to detect suspicious activity, such as abnormal access to submodules.", "Mitigation": "Implement multi-factor authentication, monitor logs for suspicious activity, and update to the latest version of Git.", "Conclusion": "The vulnerability in Git's cloning functionality can have significant consequences for users, including unauthorized access to their code. Defenders should update to the latest version of Git and implement multi-factor authentication to mitigate the risk."}, "executive_analysis": {"Overview": "A vulnerability in Git's cloning functionality can allow attackers to exploit the system and gain unauthorized access to code.", "Business Impact": "The vulnerability can have significant consequences for businesses, including unauthorized access to code and potential data breaches.", "Technical Impact": "The vulnerability can have technical consequences, including the need to update to the latest version of Git and implement multi-factor authentication.", "Mitigation Strategies": "Implement multi-factor authentication, monitor logs for suspicious activity, and update to the latest version of Git.", "Recommendations": "Update to the latest version of Git and implement multi-factor authentication immediately.", "Conclusions": "The vulnerability in Git's cloning functionality is a significant risk that must be addressed immediately to protect against unauthorized access and potential data breaches."}}