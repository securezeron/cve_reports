{"id": "CVE-2024-24004", "sourceIdentifier": "cve@mitre.org", "published": "2024-02-07T00:15:56.550", "lastModified": "2024-08-19T21:35:02.860", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "jshERP v3.3 is vulnerable to SQL Injection. The com.jsh.erp.controller.DepotHeadController: com.jsh.erp.utils.BaseResponseInfo findInOutDetail() function of jshERP does not filter `column` and `order` parameters well enough, and an attacker can construct malicious payload to bypass jshERP's protection mechanism in `safeSqlParse` method for sql injection."}, {"lang": "es", "value": "jshERP v3.3 es vulnerable a la inyecci\u00f3n SQL. La funci\u00f3n com.jsh.erp.controller.DepotHeadController: com.jsh.erp.utils.BaseResponseInfo findInOutDetail() de jshERP no filtra los par\u00e1metros de `columna` y `orden` lo suficientemente bien, y un atacante puede construir un payload malicioso para eludir los par\u00e1metros de jshERP Mecanismo de protecci\u00f3n en el m\u00e9todo `safeSqlParse` para inyecci\u00f3n SQL."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:jishenghua:jsherp:3.3:*:*:*:*:*:*:*", "matchCriteriaId": "A549663F-7809-4723-9F1F-251DB15E31CA"}]}]}], "references": [{"url": "https://github.com/cxcxcxcxcxcxcxc/cxcxcxcxcxcxcxc/blob/main/cxcxcxcxcxc/about-2024/24004.txt", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/jishenghua/jshERP/issues/99", "source": "cve@mitre.org", "tags": ["Exploit", "Issue Tracking", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1027", "comment": "T1027: Command and Control - Custom Command and Control, the attacker could use this vulnerability to establish a backdoor in the system for further exploitation."}, {"techniqueID": "T1130", "comment": "T1130: Attack Pattern - Web Application, the vulnerability could be exploited using a SQL injection attack, which is a common attack pattern used in web applications."}, {"techniqueID": "T1048", "comment": "T1048: Network Traffic, the attacker could use this vulnerability to inject malicious SQL queries, which would be executed by the system, allowing the attacker to access or modify sensitive data."}, {"techniqueID": "T1190", "comment": "T1190: Exfiltration - Web, the attacker could use this vulnerability to exfiltrate sensitive data from the system or network."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "indicator--<unique_id>", "created_by_ref": "identity--<unique_id>", "modified": "2024-08-19T21:35:02.860", "name": "jshERP v3.3 SQL Injection", "description": "jshERP v3.3 is vulnerable to SQL Injection", "confidence": 90, "created": "2024-02-07T00:15:56.550", "modified_by_ref": "identity--<unique_id>"}], "relationships": [{"type": "has-subindicator", "id": "relationship--<unique_id>", "source_ref": "indicator--<unique_id>", "target_ref": "indicator--<unique_id>"}]}, "technical_analysis": {"Introduction": "jshERP v3.3 is vulnerable to SQL Injection due to an unfiltered input parameter in the com.jsh.erp.controller.DepotHeadController: com.jsh.erp.utils.BaseResponseInfo findInOutDetail() function.", "Impact and Scope": "The vulnerability allows an attacker to inject malicious SQL queries, which could result in the disclosure or modification of sensitive data. The CVSS score is 9.8 with a version of 3.1, attack vector of NETWORK, and attack complexity of LOW.", "Related MITRE ATT&CK Techniques": "T1027, T1130, T1048, T1190", "Technical Details": "The vulnerability is caused by a lack of input validation in the com.jsh.erp.controller.DepotHeadController: com.jsh.erp.utils.BaseResponseInfo findInOutDetail() function, which allows an attacker to inject malicious SQL queries.", "Detection": "Detecting this vulnerability may involve monitoring database queries and monitoring for malicious SQL code.", "Mitigation": "Mitigating this vulnerability requires updating the jshERP application to a version that fixes this vulnerability.", "Conclusion": "jshERP v3.3 is vulnerable to SQL Injection and should be updated to a version that fixes this vulnerability to prevent exploitation."}, "executive_analysis": {"Overview": "jshERP v3.3 is vulnerable to SQL Injection due to an unfiltered input parameter.", "Business Impact": "This vulnerability could result in the disclosure or modification of sensitive data, which could have severe business implications.", "Technical Impact": "The vulnerability could allow an attacker to inject malicious SQL queries, which could result in the disclosure or modification of sensitive data.", "Mitigation Strategies": "Updating the application to a version that fixes this vulnerability is the most effective mitigation strategy.", "Recommendations": "Executive stakeholders should be informed of this vulnerability and its potential impact, and should prioritize updating the application to a version that fixes this vulnerability.", "Conclusions": "jshERP v3.3 is vulnerable to SQL Injection and immediate action is required to mitigate this vulnerability."}}