{"id": "CVE-2024-7340", "sourceIdentifier": "reefs@jfrog.com", "published": "2024-07-31T15:15:11.203", "lastModified": "2024-08-01T14:01:07.677", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Weave server API allows remote users to fetch files from a specific directory, but due to a lack of input validation, it is possible to traverse and leak arbitrary files remotely. In various common scenarios, this allows a low-privileged user to assume the role of the server admin."}, {"lang": "es", "value": "La API Weave server permite a los usuarios remotos recuperar archivos de un directorio espec\u00edfico, pero debido a la falta de validaci\u00f3n de entrada, es posible atravesar y filtrar archivos arbitrarios de forma remota. En varios escenarios comunes, esto permite que un usuario con pocos privilegios asuma el rol de administrador del servidor."}], "metrics": {"cvssMetricV31": [{"source": "reefs@jfrog.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "https://github.com/wandb/weave/pull/1657", "source": "reefs@jfrog.com"}, {"url": "https://research.jfrog.com/vulnerabilities/wandb-weave-server-remote-arbitrary-file-leak-jfsa-2024-001039248/", "source": "reefs@jfrog.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-7340 - An authenticated remote file inclusion vulnerability exists in Weave, allowing an attacker to access arbitrary files. This technique is related to data exfiltration and lateral movement."}, {"techniqueID": "T1190", "comment": "CVE-2024-7340 - Weave server API allows remote users to fetch files from a specific directory, enabling traversal and leakage of arbitrary files. This technique is related to data exfiltration and privilege escalation."}, {"techniqueID": "T1490", "comment": "CVE-2024-7340 - Authentication bypass vulnerability in Weave server API allows low-privileged users to assume the role of the server admin. This technique is related to privilege escalation and lateral movement."}, {"techniqueID": "T1191", "comment": "CVE-2024-7340 - Weave server API lacks input validation, enabling remote code execution and arbitrary file upload. This technique is related to data manipulation and privilege escalation."}, {"techniqueID": "T1075", "comment": "CVE-2024-7340 - Attackers can leverage Weave server API to perform a remote command execution vulnerability. This technique is related to command and control and lateral movement."}], "stix_bundle": {"@type": "bundle", "id": "https://example.com/cve-2024-7340.stix", "created_by_ref": "https://example.com/user", "created": "2024-08-01T14:01:07.677", "modified": "2024-08-01T14:01:07.677", "description": "STIX Bundle for CVE-2024-7340", "objects": [{"@type": "vulnerability", "id": "https://example.com/cve-2024-7340", "description": "CVE-2024-7340 - Weave server API remote arbitrary file leak vulnerability", "severity": "HIGH", "range": [8.8, 8.8], "affected_range": "Weave Server API", "exploitability": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}, {"@type": "intrusion-set", "id": "https://example.com/attack-group", "description": "Known attack groups that exploit CVE-2024-7340", "names": ["Attack Group 1", "Attack Group 2"]}, {"@type": "course-of-action", "id": "https://example.com/cve-2024-7340-coa", "description": "COA for CVE-2024-7340", "impact": "HIGH", "relevance": "HIGH", "mitigates": ["T1210", "T1190", "T1490", "T1191", "T1075"], "notes": ["Implement input validation for Weave server API", "Configure Weave server API to only allow trusted connections"]}], "relationships": [{"type": "vulnerability-affected-by", "subject": "https://example.com/cve-2024-7340", "object": "https://example.com/t1210"}, {"type": "intrusion-set-exploits", "subject": "https://example.com/attack-group", "object": "https://example.com/cve-2024-7340"}, {"type": "course-of-action-mitigates", "subject": "https://example.com/cve-2024-7340-coa", "object": "https://example.com/t1210"}]}, "technical_analysis": {"Introduction": "CVE-2024-7340 is a remote arbitrary file leak vulnerability in Weave server API, allowing attackers to access and manipulate sensitive data.", "Impact and Scope": "CVSS Score: 8.8, Attack Vector: NETWORK, Severity: HIGH. This vulnerability affects Weave Server API and allows an attacker to perform data exfiltration, lateral movement, and privilege escalation.", "Related MITRE ATT&CK Techniques": "T1210, T1190, T1490, T1191, T1075", "Technical Details": "The vulnerability occurs due to a lack of input validation in Weave server API, allowing an attacker to traverse and leak arbitrary files remotely.", "Detection": "Monitor Weave server API logs for suspicious file access and transfer activities.", "Mitigation": "Implement input validation for Weave server API, configure Weave server API to only allow trusted connections, and limit access to sensitive data and files.", "Conclusion": "CVE-2024-7340 is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-7340 is a remote arbitrary file leak vulnerability in Weave server API that can lead to significant data breaches and business disruptions.", "Business Impact": "Data breaches can result in loss of sensitive data, financial fraud, and reputational damage.", "Technical Impact": "The vulnerability affects Weave server API and allows attackers to perform data exfiltration, lateral movement, and privilege escalation.", "Mitigation Strategies": "Implement input validation for Weave server API and configure Weave server API to only allow trusted connections.", "Recommendations": "Prioritize CVE-2024-7340 mitigation and patching, implement robust security controls, and conduct regular security assessments.", "Conclusions": "CVE-2024-7340 is a critical vulnerability that demands immediate attention and action to mitigate its impact."}}