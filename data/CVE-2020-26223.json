{"id": "CVE-2020-26223", "sourceIdentifier": "security-advisories@github.com", "published": "2020-11-13T18:15:12.777", "lastModified": "2020-11-30T16:18:08.080", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Spree is a complete open source e-commerce solution built with Ruby on Rails. In Spree from version 3.7 and before versions 3.7.13, 4.0.5, and 4.1.12, there is an authorization bypass vulnerability. The perpetrator could query the API v2 Order Status endpoint with an empty string passed as an Order token. This is patched in versions 3.7.11, 4.0.4, or 4.1.11 depending on your used Spree version. Users of Spree < 3.7 are not affected."}, {"lang": "es", "value": "Spree es una completa soluci\u00f3n e-commerce de c\u00f3digo abierto construida con Ruby on Rails.&#xa0;En Spree desde la versi\u00f3n 3.7 y versiones anteriores a 3.7.13, 4.0.5 y 4.1.12, se presenta una vulnerabilidad de omisi\u00f3n de autorizaci\u00f3n.&#xa0;El perpetrador podr\u00eda consultar el endpoint API v2 Order Status con una cadena vac\u00eda pasada como un token de pedido.&#xa0;Esto est\u00e1 parcheado en versiones 3.7.11, 4.0.4 o 4.1.11 dependiendo de la versi\u00f3n de Spree usada.&#xa0;Los usuarios de Spree versiones anteriores a 3.7 no est\u00e1n afectados"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.1, "impactScore": 4.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-863"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:spreecommerce:spree:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.7.0", "versionEndExcluding": "3.7.13", "matchCriteriaId": "4F0DFB4E-3D62-4C6C-A227-3B839055F34C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:spreecommerce:spree:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.0.5", "matchCriteriaId": "B10057D2-194D-4019-A8F3-9A64E3BAFE70"}, {"vulnerable": true, "criteria": "cpe:2.3:a:spreecommerce:spree:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.1.0", "versionEndExcluding": "4.1.12", "matchCriteriaId": "95279953-3BEB-454E-8C60-F4E00602849B"}]}]}], "references": [{"url": "https://github.com/spree/spree/pull/10573", "source": "security-advisories@github.com", "tags": ["Exploit", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/spree/spree/security/advisories/GHSA-m2jr-hmc3-qmpr", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://guides.spreecommerce.org/api/v2/storefront#tag/Order-Status", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1130", "comment": "CVE-2020-26223 - This technique exploits the authorization bypass vulnerability in Spree e-commerce platform, allowing an attacker to query the API v2 Order Status endpoint with an empty string as an Order token, which can lead to unauthorized access and data theft. Defending against this requires configuring the platform correctly and implementing robust authorization mechanisms."}], "stix_bundle": {"stix": {"Incident": {"id": "CVE-2020-26223", "title": "CVE-2020-26223: Spree e-commerce platform Authorization Bypass vulnerability", "description": "This STIX bundle represents the vulnerability CVE-2020-26223 in the Spree e-commerce platform, which is an authorization bypass vulnerability allowing an attacker to query the API v2 Order Status endpoint with an empty string as an Order token, leading to unauthorized access and data theft.", "created": "2020-11-13T18:15:12.777", "modified": "2020-11-30T16:18:08.080", "status": "Analyzed"}, "Vulnerability": {"id": "CVE-2020-26223", "created": "2020-11-13T18:15:12.777", "modified": "2020-11-30T16:18:08.080", "cveID": "CVE-2020-26223", "name": "CVE-2020-26223: Spree e-commerce platform Authorization Bypass vulnerability", "description": "This vulnerability is an authorization bypass in the Spree e-commerce platform, allowing an attacker to query the API v2 Order Status endpoint with an empty string as an Order token, leading to unauthorized access and data theft.", "severity": "HIGH", "cvssv2Vector": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "cvssv3Vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "weakness": "CWE-863: Use of Weakness: Authorization Bypass by Weakness", "vulnerableConfiguration": {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:spreecommerce:spree:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.7.0", "versionEndExcluding": "3.7.13"}, {"vulnerable": true, "criteria": "cpe:2.3:a:spreecommerce:spree:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.0.5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:spreecommerce:spree:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.1.0", "versionEndExcluding": "4.1.12"}]}]}}, "Course_of_Action": {"id": "CoA-1", "description": "Patch the vulnerability by updating the Spree e-commerce platform to a secure version.", "mitigates": "T1130", "notes": ["Update the Spree e-commerce platform to a secure version to mitigate the vulnerability.", "Configure the platform correctly and implement robust authorization mechanisms to prevent exploitation."]}}}, "technical_analysis": {"Introduction": "This CVE affects the Spree e-commerce platform, an authorization bypass vulnerability allowing an attacker to query the API v2 Order Status endpoint with an empty string as an Order token, leading to unauthorized access and data theft.", "Impact and Scope": "This vulnerability has a CVSSv3 score of 6.5 and affects versions 3.7 and below, 4.0 and below, and 4.1 and below of the Spree e-commerce platform.", "Related MITRE ATT&CK Techniques": "T1130: Exploit Public-Facing Application", "Technical Details": "The vulnerability allows an attacker to query the API v2 Order Status endpoint with an empty string as an Order token, bypassing authorization controls.", "Detection": "Detect this vulnerability by monitoring for suspicious API requests to the Order Status endpoint and analyzing system logs for unauthorized access.", "Mitigation": "Mitigate this vulnerability by patching the Spree e-commerce platform to a secure version and configuring the platform correctly.", "Conclusion": "This CVE is a high-severity vulnerability that allows an attacker to bypass authorization controls and access sensitive data. Defending against it requires prompt patching and configuration changes."}, "executive_analysis": {"Overview": "This CVE is a high-severity vulnerability in the Spree e-commerce platform, allowing an unauthorized attacker to access sensitive data.", "Business Impact": "This vulnerability can lead to data theft, financial loss, and reputational damage.", "Technical Impact": "This vulnerability allows an attacker to bypass authorization controls, leading to unauthorized access and potential data theft.", "Mitigation Strategies": "Patching the platform to a secure version and configuring it correctly can mitigate this vulnerability.", "Recommendations": "Recommend that executives prioritize patching and configuration changes to mitigate this vulnerability.", "Conclusions": "This CVE is a high-severity vulnerability that requires prompt attention and mitigation to prevent potential data breaches and reputational damage."}}