{"id": "CVE-2020-21788", "sourceIdentifier": "cve@mitre.org", "published": "2021-06-24T15:15:08.173", "lastModified": "2021-07-01T18:49:22.063", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In CRMEB 3.1.0+ strict domain name filtering leads to SSRF(Server-Side Request Forgery). The vulnerable code is in file /crmeb/app/admin/controller/store/CopyTaobao.php."}, {"lang": "es", "value": "En CRMEB 3.1.0+ el filtrado estricto de nombres de dominio conlleva a una vulnerabilidad de tipo SSRF(Server-Side Request Forgery). El c\u00f3digo vulnerable se encuentra en el archivo /crmeb/app/admin/controller/store/CopyTaobao.php"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-918"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:crmeb:crmeb:3.1.0\\+:*:*:*:*:*:*:*", "matchCriteriaId": "E661515C-C392-4254-94A5-B0E9B23E680E"}]}]}], "references": [{"url": "https://gitee.com/ZhongBangKeJi/CRMEB/issues/I18MKC", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1497", "comment": "CVE-2020-21788 - This SSRF vulnerability in CRMEB 3.1.0+ allows an attacker to perform server-side requests to arbitrary servers, enabling data exfiltration and command execution. Defend against it by implementing strict domain name filtering and validating user input."}, {"techniqueID": "T1190", "comment": "CVE-2020-21788 - This vulnerability may be used to conduct DNS tunneling attacks, allowing an attacker to exfiltrate data and execute commands on the compromised system. Protect against it by implementing a DNS cache blocking solution and monitoring network traffic for suspicious activity."}, {"techniqueID": "T1191", "comment": "CVE-2020-21788 - This SSRF vulnerability can be used to conduct HTTP tunneling attacks, enabling an attacker to bypass web application firewalls and access internal systems. Defend against it by implementing an HTTP intercepting proxy and validating user input."}], "technical_analysis": {"Introduction": "The CRMEB 3.1.0+ SSRF vulnerability (CVE-2020-21788) allows an attacker to perform server-side requests to arbitrary servers, enabling data exfiltration and command execution. The vulnerability is caused by the insufficient validation of user input, leading to the bypassing of security controls.", "Impact and Scope": "The attack vector is HIGH, the attack complexity is LOW, and the confidential impact is LOW. The exploitability score is 2.8 and the impact score is 1.4, indicating a moderately exploitable vulnerability.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1497, T1190, and T1191.", "Technical Details": "The vulnerability occurs in the CopyTaobao.php file in the /crmeb/app/admin/controller/store directory. The affected code does not properly validate user input, allowing an attacker to inject arbitrary domain names and access internal servers.", "Detection": "Detect this vulnerability by monitoring network traffic for suspicious DNS requests and monitoring system logs for evidence of data exfiltration or command execution.", "Mitigation": "Mitigate this vulnerability by implementing strict domain name filtering, validating user input, and monitoring network traffic and system logs for suspicious activity.", "Conclusion": "In conclusion, the CRMEB 3.1.0+ SSRF vulnerability (CVE-2020-21788) is a serious security risk that can be exploited by an attacker to perform server-side requests, exfiltrate data, and execute commands. To defend against this vulnerability, implement strict domain name filtering, validate user input, and monitor network traffic and system logs for suspicious activity."}, "executive_analysis": {"Overview": "The CRMEB 3.1.0+ SSRF vulnerability (CVE-2020-21788) is a serious security risk that can be exploited by an attacker to perform server-side requests, exfiltrate data, and execute commands.", "Business Impact": "The business impact of this vulnerability is significant, as it can result in data theft, unauthorized access to internal systems, and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is significant, as it can result in data exfiltration, command execution, and unauthorized access to internal systems.", "Mitigation Strategies": "Mitigate this vulnerability by implementing strict domain name filtering, validating user input, and monitoring network traffic and system logs for suspicious activity.", "Recommendations": "Recommendations for executives include conducting a thorough risk assessment, implementing appropriate mitigation strategies, and providing regular security awareness training to employees.", "Conclusions": "In conclusion, the CRMEB 3.1.0+ SSRF vulnerability (CVE-2020-21788) is a serious security risk that requires immediate attention and action. By implementing appropriate mitigation strategies and providing regular security awareness training, organizations can reduce the risk of this vulnerability being exploited and protect their data and systems."}}