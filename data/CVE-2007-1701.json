{"id": "CVE-2007-1701", "sourceIdentifier": "cve@mitre.org", "published": "2007-03-27T01:19:00.000", "lastModified": "2019-10-09T22:52:34.790", "vulnStatus": "Modified", "cveTags": [], "evaluatorImpact": "Successful exploitation requires that variable \"register_globals\" is enabled.", "descriptions": [{"lang": "en", "value": "PHP 4 before 4.4.5, and PHP 5 before 5.2.1, when register_globals is enabled, allows context-dependent attackers to execute arbitrary code via deserialization of session data, which overwrites arbitrary global variables, as demonstrated by calling session_decode on a string beginning with \"_SESSION|s:39:\"."}, {"lang": "es", "value": "PHP 4 anterior a 4.4.5, y PHP 5 anterior a 5.2.1, cuando register_globals est\u00e1 activado, permiten a atacantes locales o remotos dependiendo del contexto ejecutar c\u00f3digo de su elecci\u00f3n mediante una deserializaci\u00f3n de los datos de sesi\u00f3n, lo cual sobrescribe variables globales de su elecci\u00f3n, como se ha demostrado llamando a session-decode en una cadena que comience con \"_SESSION|s:39:\"."}], "vendorComments": [{"organization": "Red Hat", "comment": "This CVE name is a duplicate as the vulnerability is addressed by CVE-2007-0910.\n", "lastModified": "2007-05-01T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-502"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.4.5", "matchCriteriaId": "FCAA3859-EAB8-4F6E-84FE-4DBBF9B1A251"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.0.0", "versionEndExcluding": "5.2.1", "matchCriteriaId": "E8CF9623-B049-425F-ADC0-3E7E94E2F7A3"}]}]}], "references": [{"url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?lang=en&cc=us&objectID=c01056506", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?lang=en&cc=us&objectID=c01086137", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/25423", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/25445", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/25850", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://security.gentoo.org/glsa/glsa-200705-19.xml", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.php-security.org/MOPB/MOPB-31-2007.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.securityfocus.com/bid/23120", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.vupen.com/english/advisories/2007/1991", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2007/2374", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/33658", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A11034", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "PHP 4 before 4.4.5, and PHP 5 before 5.2.1, when register_globals is enabled, allows context-dependent attackers to execute arbitrary code via deserialization of session data, which overwrites arbitrary global variables, as demonstrated by calling session_decode on a string beginning with \"_SESSION|s:39:\"."}, {"techniqueID": "TA0002", "comment": "The vulnerability occurs due to the absence of proper input validation in the PHP 4 and 5 registers, which allows an attacker to inject malicious code by tampering with the session data."}, {"techniqueID": "TA0043", "comment": "The vulnerability can be mitigated by disabling the register_globals option in PHP 4 and 5 configurations."}, {"techniqueID": "TA0085", "comment": "Proper error handling and validation of user input can prevent attacks on this vulnerability."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2007-1701", "name": "PHP 4/5 register_globals-enabled session deserialization vulnerability", "description": "PHP 4/5 register_globals-enabled session deserialization vulnerability"}], "relationships": [{"type": "related_course_of_action", "id": "related-course-of-action-1", "source_id": "CVE-2007-1701", "target_id": "TAL-0050", "relationship": "mitigates"}, {"type": "related_course_of_action", "id": "related-course-of-action-2", "source_id": "CVE-2007-1701", "target_id": "TAL-0051", "relationship": "mitigates"}, {"type": "related_course_of_action", "id": "related-course-of-action-3", "source_id": "CVE-2007-1701", "target_id": "TAL-0052", "relationship": "mitigates"}], "courses_of_action": [{"id": "TAL-0050", "name": "Disable register_globals", "description": "Disabling register_globals option in PHP 4 and 5 configurations can prevent attacks on this vulnerability."}, {"id": "TAL-0051", "name": "Proper error handling", "description": "Proper error handling and validation of user input can prevent attacks on this vulnerability."}, {"id": "TAL-0052", "name": "Patch", "description": "Patching to PHP 4.4.5 or 5.2.1 can fix this vulnerability."}]}, "technical_analysis": {"Introduction": "The vulnerability occurs due to the absence of proper input validation in the PHP 4 and 5 registers, which allows an attacker to inject malicious code by tampering with the session data.", "Impact and Scope": "This vulnerability poses a moderate risk to PHP 4 and 5 applications, especially those that use the register_globals option.", "Related MITRE ATT&CK Techniques": ["TA0001: Initial Access", "TA0002: Execution", "TA0043: Defense Evasion", "TA0085: Command and Control"], "Technical Details": "In PHP 4 and 5, when register_globals is enabled, the script uses the registry to load global variables, which allows an attacker to inject malicious code by tampering with the session data.", "Detection": "Detecting this vulnerability requires looking for evidence of session data tampering and register_globals being enabled.", "Mitigation": "Disabling register_globals and proper error handling can prevent attacks on this vulnerability.", "Conclusion": "The vulnerability poses a moderate risk to PHP 4 and 5 applications, but can be mitigated by proper configuration and error handling."}, "executive_analysis": {"Overview": "The vulnerability is a significant risk to PHP 4 and 5 applications that rely on the register_globals option.", "Business Impact": "The vulnerability can allow an attacker to inject malicious code into the application, potentially leading to data breaches or unauthorized access.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary code on the server, potentially leading to unauthorized access and data breaches.", "Mitigation Strategies": "Disabling register_globals and proper error handling can prevent attacks on this vulnerability.", "Recommendations": "Recommendations include disabling register_globals, implementing proper error handling, and patching to PHP 4.4.5 or 5.2.1.", "Conclusions": "The vulnerability is a significant risk to PHP 4 and 5 applications that require immediate attention and mitigation."}}