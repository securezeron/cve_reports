{"id": "CVE-2024-39916", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-12T15:15:11.813", "lastModified": "2024-09-05T15:34:36.877", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "FOG is a free open-source cloning/imaging/rescue suite/inventory management system. There is a security issue with the NFS configuration in /etc/exports generated by the installer that allows an attacker to modify files outside the export in the default installation. The exports have the no_subtree_check option. The no_subtree_check option means that if a client performs a file operation, the server will only check if the requested file is on the correct filesystem, not if it is in the correct directory. This enables modifying files in /images, accessing other files on the same filesystem, and accessing files on other filesystems. This vulnerability is fixed in 1.5.10.30."}, {"lang": "es", "value": "FOG es un sistema gratuito de gesti\u00f3n de inventario, im\u00e1genes, clonaci\u00f3n y rescate de c\u00f3digo abierto. Existe un problema de seguridad con la configuraci\u00f3n de NFS en /etc/exports generada por el instalador que permite a un atacante modificar archivos fuera de la exportaci\u00f3n en la instalaci\u00f3n predeterminada. Las exportaciones tienen la opci\u00f3n no_subtree_check. La opci\u00f3n no_subtree_check significa que si un cliente realiza una operaci\u00f3n de archivo, el servidor solo verificar\u00e1 si el archivo solicitado est\u00e1 en el sistema de archivos correcto, no si est\u00e1 en el directorio correcto. Esto permite modificar archivos en /images, acceder a otros archivos en el mismo sistema de archivos y acceder a archivos en otros sistemas de archivos. Esta vulnerabilidad se solucion\u00f3 en 1.5.10.30."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.1, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.1, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-1188"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-453"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:fogproject:fogproject:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.5.10", "matchCriteriaId": "D6C828F1-A3A9-4637-8F07-CD959CB2B7CD"}]}]}], "references": [{"url": "https://github.com/FOGProject/fogproject/commit/2de209bc57a177a052b4a877f000c591740b2f88", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/FOGProject/fogproject/security/advisories/GHSA-3xjr-xf9v-hwjh", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1234", "comment": "CVE-2024-39916 - Disabling NFS in FOG Project to prevent unauthorized modifications"}, {"techniqueID": "T1129", "comment": "CVE-2024-39916 - Leveraging the 'no_subtree_check' option in NFS to escalate privileges"}, {"techniqueID": "T1587.001", "comment": "CVE-2024-39916 - Using the FOG Project installer to inject a malicious NFS export"}, {"techniqueID": "T1590", "comment": "CVE-2024-39916 - Exploiting the 'no_subtree_check' option in NFS to mask command execution"}], "stix_bundle": "{\"relationship\":{\r\n    \"objects\":{\r\n        \"vulnerability\":{\r\n            \"description\":\"FOG is a free open-source cloning/imaging/rescue suite/inventory management system. There is a security issue with the NFS configuration in /etc/exports generated by the installer that allows an attacker to modify files outside the export in the default installation. The exports have the no_subtree_check option. The no_subtree_check option means that if a client performs a file operation, the server will only check if the requested file is on the correct filesystem, not if it is in the correct directory. This enables modifying files in /images, accessing other files on the same filesystem, and accessing files on other filesystems. This vulnerability is fixed in 1.5.10.30.\",\r\n            \" severity\": \"Medium\",\r\n            \"created\": \"2024-07-12T15:15:11.813\",\r\n            \"modified\": \"2024-09-05T15:34:36.877\",\r\n            \"identity\":{\r\n                \"name\":\"CVE-2024-39916\",\r\n                \"type\":\"Vulnerability\"\r\n            }\r\n        },\r\n        \" threat_actor\":{\r\n            \"description\":\"Attackers who have a low level of access and user interaction may be able to exploit this vulnerability for low-severity impact.\",\r\n            \"type\":\"Actor\",\r\n            \"name\":\"Low-Access Threat Actor\"\r\n        },\r\n        \" tactic\":{\r\n            \"description\":\"Low-impact tactics may be used to exploit this vulnerability.\",\r\n            \"type\":\"Tactic\",\r\n            \"name\":\"Privilege Escalation\"\r\n        },\r\n        \" technique\":{\r\n            \"description\":\"The attacker will exploit the 'no_subtree_check' option in NFS to evade detection and hide their malicious activity.\",\r\n            \"type\":\"Technique\",\r\n            \"name\":\"T1234\",\r\n            \"related_analysis\":{\r\n                \"description\":\"This technique is related to CVE-2024-39916 and is used to disable NFS in the FOG Project.\",\r\n                \"type\":\"Analysis\",\r\n                \"name\":\"Technique Analysis\"\r\n            }\r\n        },\r\n        \" course_of_action\":{\r\n            \"description\":\"The defender should focus on updating FOG Project to at least version 1.5.10.30 to address this vulnerability.\",\r\n            \"type\":\"Course of Action\",\r\n            \"name\":\"Mitigation Strategy\",\r\n            \"related_technique\":{\r\n                \"name\":\"T1234\"\r\n            }\r\n        }\r\n    },\r\n    \"relationships\":{\r\n        \"vulnerability Threat Actor\":{\r\n            \"type\":\"Used By\",\r\n            \"strength\":\"High\",\r\n            \"confidence\":\"High\"\r\n        },\r\n        \"Threat Actor Tactic\":{\r\n            \"type\":\"Used By\",\r\n            \"strength\":\"High\",\r\n            \"confidence\":\"High\"\r\n        },\r\n        \"Tactic Technique\":{\r\n            \"type\":\"Used By\",\r\n            \"strength\":\"High\",\r\n            \"confidence\":\"High\"\r\n        },\r\n        \"Technique Course of Action\":{\r\n            \"type\":\"Mitigates\",\r\n            \"strength\":\"High\",\r\n            \"confidence\":\"High\"\r\n        }\r\n    }\r\n}", "technical_analysis": {"Introduction": "The vulnerability in FOG Project's NFS configuration allows an attacker to modify files outside the export, enabling privileged access and potentially leading to data exfiltration or system compromise.", "Impact and Scope": "The vulnerability has a medium severity rating and is exploitable by an attacker with low privileges. The attack vector is Network-based.", "Related MITRE ATT&CK Techniques": "T1234, T1129, T1587.001, T1590", "Technical Details": "The vulnerability is caused by the 'no_subtree_check' option in NFS, which allows clients to perform file operations without checking the directory permissions. This can be exploited by an attacker with low privileges to access and modify files outside the export.", "Detection": "Detection involves monitoring for unusual NFS activity and monitoring for signs of privilege escalation.", "Mitigation": "Mitigation involves updating FOG Project to at least version 1.5.10.30. Additional mitigation strategies may include disabling NFS if not required or segmenting network traffic to isolate vulnerable systems.", "Conclusion": "In conclusion, the vulnerability in FOG Project's NFS configuration is a significant security risk that can be exploited by an attacker with low privileges. Proper mitigation and detection strategies are crucial to preventing potential attacks."}, "executive_analysis": {"Overview": "The FOG Project vulnerability poses a significant risk to business operations and data integrity.", "Business Impact": "The vulnerability could allow an attacker to exfiltrate sensitive data or compromise system integrity, leading to financial losses and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to access and modify files outside the export, enabling privileged access and potentially leading to system compromise.", "Mitigation Strategies": "Updating FOG Project to at least version 1.5.10.30 and disabling NFS if not required are recommended."}}