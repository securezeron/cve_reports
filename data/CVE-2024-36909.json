{"id": "CVE-2024-36909", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-30T16:15:14.380", "lastModified": "2024-05-30T18:18:58.870", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nDrivers: hv: vmbus: Don't free ring buffers that couldn't be re-encrypted\n\nIn CoCo VMs it is possible for the untrusted host to cause\nset_memory_encrypted() or set_memory_decrypted() to fail such that an\nerror is returned and the resulting memory is shared. Callers need to\ntake care to handle these errors to avoid returning decrypted (shared)\nmemory to the page allocator, which could lead to functional or security\nissues.\n\nThe VMBus ring buffer code could free decrypted/shared pages if\nset_memory_decrypted() fails. Check the decrypted field in the struct\nvmbus_gpadl for the ring buffers to decide whether to free the memory."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: Controladores: hv: vmbus: no liberar b\u00faferes de anillo que no se pudieron volver a cifrar. En las m\u00e1quinas virtuales CoCo, es posible que el host que no es de confianza cause set_memory_encrypted() o set_memory_decrypted( ) falle de modo que se devuelva un error y se comparta la memoria resultante. Las personas que llaman deben tener cuidado al manejar estos errores para evitar devolver memoria descifrada (compartida) al asignador de p\u00e1ginas, lo que podr\u00eda provocar problemas funcionales o de seguridad. El c\u00f3digo del buffer circular de VMBus podr\u00eda liberar p\u00e1ginas descifradas/compartidas si falla set_memory_decrypted(). Verifique el campo descifrado en la estructura vmbus_gpadl para ver los b\u00faferes en anillo para decidir si liberar la memoria."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/2f622008bf784a9f5dd17baa19223cc2ac30a039", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/30d18df6567be09c1433e81993e35e3da573ac48", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/82f9e213b124a7d2bb5b16ea35d570260ef467e0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/a9212a4e2963a7fbe3864ba33dc551d4ad8d0abb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-36909 - This tactic can be used to cause a kernel panic in Linux systems by exploiting the vulnerability in the hv: vmbus: driver. Defending against this requires checking the decrypted field in the struct vmbus_gpadl for ring buffers and handling errors to avoid returning decrypted/shared pages to the page allocator."}], "stix_bundle": {"type": "bundle", "id": "f8bebc5a-7b75-4156-b74e-3f4f7d3ddb28", "created_by_ref": "https://stix.cs.trust__/stix/bundle", "created": "2024-06-01T12:00:00.000", "modified": "2024-06-01T12:00:00.000", "objects": [{"type": "vulnerability", "id": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "created_by_ref": "https://stix.cs.trust__/stix/bundle", "created": "2024-05-30T16:15:14.380", "modified": "2024-05-30T18:18:58.870", "name": "Linux kernel hv: vmbus: driver vulnerability", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nDrivers: hv: vmbus: Don't free ring buffers that couldn't be re-encrypted\n\nIn CoCo VMs it is possible for the untrusted host to cause\nset_memory_encrypted() or set_memory_decrypted() to fail such that an\nerror is returned and the resulting memory is shared. Callers need to\ntake care to handle these errors to avoid returning decrypted (shared)\nmemory to the page allocator, which could lead to functional or security\nissues.\n\nThe VMBus ring buffer code could free decrypted/shared pages if\nset_memory_decrypted() fails. Check the decrypted field in the struct\nvmbus_gpadl for the ring buffers to decide whether to free the memory.", "reporting_analysis": "https://stix.cs.trust__/stix/bundle/"}, {"type": "course-of-action", "id": "c9a4db56-4c12-4d74-a31b-1bdf51b4a455", "created_by_ref": "https://stix.cs.trust__/stix/bundle", "created": "2024-06-01T12:00:00.000", "modified": "2024-06-01T12:00:00.000", "name": "Update Linux kernel hv: vmbus: driver", "description": "Update the Linux kernel hv: vmbus: driver to the latest version that resolves the vulnerability.", "relatedcourse-of-action": "https://stix.cs.trust__/stix/bundle/"}], " relationships": [{"start": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "end": "c9a4db56-4c12-4d74-a31b-1bdf51b4a455", "type": "mitigates", "relationship": "https://stix.cs.trust__/stix/relationship"}]}, "technical_analysis": {"Introduction": "The CVE-2024-36909 vulnerability is a kernel-level vulnerability in the Linux kernel that affects the hv: vmbus: driver.", "Impact and Scope": "The vulnerability allows an untrusted host to cause a kernel panic in Linux systems. The impact is system-wide and can cause data loss or corruption.", "Related MITRE ATT&CK Techniques": "T1190 - Exploit Public-Facing Application", "Technical Details": "The vulnerability occurs when the hv: vmbus: driver fails to free ring buffers that couldn't be re-encrypted.", "Detection": "Detection methods include monitoring system logs for kernel panic errors and tracing system memory allocation.", "Mitigation": "Mitigation strategies include updating the Linux kernel hv: vmbus: driver to the latest version that resolves the vulnerability and implementing kernel-based memory isolation.", "Conclusion": "The CVE-2024-36909 vulnerability is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2024-36909 vulnerability is a critical kernel-level vulnerability that affects the hv: vmbus: driver in the Linux kernel.", "Business Impact": "The vulnerability poses a significant risk to business operations and data security.", "Technical Impact": "The vulnerability allows an untrusted host to cause a kernel panic in Linux systems, which can cause data loss or corruption.", "Mitigation Strategies": "Implementing kernel-based memory isolation and updating the Linux kernel hv: vmbus: driver to the latest version that resolves the vulnerability.", "Recommendations": "Executives should prioritize patching and upgrading the Linux kernel hv: vmbus: driver to the latest version that resolves the vulnerability.", "Conclusions": "The CVE-2024-36909 vulnerability is a critical vulnerability that requires prompt attention and mitigation. Executives should ensure that their organization is taking necessary steps to address this vulnerability."}}