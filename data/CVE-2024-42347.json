{"id": "CVE-2024-42347", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-06T18:15:57.103", "lastModified": "2024-08-12T18:52:08.163", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "matrix-react-sdk  is a react-based SDK for inserting a Matrix chat/voip client into a web page. A malicious homeserver could manipulate a user's account data to cause the client to enable URL previews in end-to-end encrypted rooms, in which case any URLs in encrypted messages would be sent to the server. This was patched in matrix-react-sdk 3.105.0. Deployments that trust their homeservers, as well as closed federations of trusted servers, are not affected. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Matrix-react-sdk es un SDK basado en reacci\u00f3n para insertar un cliente de chat/voip Matrix en una p\u00e1gina web. Un servidor dom\u00e9stico malicioso podr\u00eda manipular los datos de la cuenta de un usuario para hacer que el cliente habilite vistas previas de URL en salas cifradas de extremo a extremo, en cuyo caso cualquier URL de los mensajes cifrados se enviar\u00eda al servidor. Esto fue parcheado en Matrix-react-sdk 3.105.0. Las implementaciones que conf\u00edan en sus servidores dom\u00e9sticos, as\u00ed como las federaciones cerradas de servidores confiables, no se ven afectadas. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.1, "impactScore": 4.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-359"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:matrix:matrix-react-sdk:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.105.1", "matchCriteriaId": "08EF7CA9-DDC4-458C-811F-4DC290E7898B"}]}]}], "references": [{"url": "https://github.com/matrix-org/matrix-react-sdk/releases/tag/v3.105.1", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/matrix-org/matrix-react-sdk/security/advisories/GHSA-f83w-wqhc-cfp4", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1078", "comment": "CVE-2024-42347 - In this technique, an attacker could manipulate a user's account data to cause the client to enable URL previews in end-to-end encrypted rooms. This could allow an attacker to manipulate the user's data and potentially exploit the user's trust in the client."}, {"techniqueID": "T1190", "comment": "CVE-2024-42347 - An attacker could exploit the client's trust in the homeserver by manipulating the user's account data to cause the client to enable URL previews in end-to-end encrypted rooms."}, {"techniqueID": "T1204", "comment": "CVE-2024-42347 - The vulnerability allows an attacker to manipulate the user's account data, potentially to gain unauthorized access or permissions."}], "stix_bundle": {"objects": [{"id": "vuln:3f43b5a5-c5df-43ca-a135-b87c2b7d3f47", "type": "vulnerability", "description": {"lang": "en", "value": "CVE-2024-42347"}, "title": "Matrix React SDK URL Preview Vulnerability"}, {"id": "tech:83a3f0c6-64a2-4659-a165-2b6e6d9c4c66", "type": "vulnerability-technique", "confidence": "high", "created_by": {"id": "user:1234567890", "type": "user"}}, {"id": "tech:5c65e8b4-6c5d-497f-a7c1-8a4d3eb9b8ee", "type": "vulnerability-technique", "confidence": "medium", "created_by": {"id": "user:1234567890", "type": "user"}}, {"id": "tech:2a86c2a5-ee52-4669-bd1c-d2d44cd81a37", "type": "vulnerability-technique", "confidence": "low", "created_by": {"id": "user:1234567890", "type": "user"}}], "relationships": [{"source_ref": "vuln:3f43b5a5-c5df-43ca-a135-b87c2b7d3f47", "target_ref": "tech:83a3f0c6-64a2-4659-a165-2b6e6d9c4c66", "type": "related"}, {"source_ref": "vuln:3f43b5a5-c5df-43ca-a135-b87c2b7d3f47", "target_ref": "tech:5c65e8b4-6c5d-497f-a7c1-8a4d3eb9b8ee", "type": "related"}, {"source_ref": "vuln:3f43b5a5-c5df-43ca-a135-b87c2b7d3f47", "target_ref": "tech:2a86c2a5-ee52-4669-bd1c-d2d44cd81a37", "type": "related"}]}, "technical_analysis": {"Introduction": "The Matrix React SDK URL Preview Vulnerability (CVE-2024-42347) allows an attacker to manipulate a user's account data to cause the client to enable URL previews in end-to-end encrypted rooms.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5 (Medium) and an attack vector of NETWORK, and could potentially lead to unauthorized access or manipulation of user data.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the T1078, T1190, and T1204 MITRE ATT&CK Techniques.", "Technical Details": "The vulnerability is due to a weakness in the Matrix React SDK's handling of user data, which can be manipulated by an attacker to enable URL previews in end-to-end encrypted rooms.", "Detection": "Detection is challenging due to the complexity of the vulnerability, and may require specialized tools and expertise.", "Mitigation": "Mitigation strategies include upgrading to the latest version of the Matrix React SDK and implementing additional security measures to prevent data manipulation.", "Conclusion": "The Matrix React SDK URL Preview Vulnerability is a significant vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The Matrix React SDK URL Preview Vulnerability (CVE-2024-42347) is a critical vulnerability that has the potential to compromise user data and trust in the Matrix React SDK.", "Business Impact": "The vulnerability has the potential to have a significant business impact, as it could compromise the trust of users and partners in the Matrix React SDK.", "Technical Impact": "The vulnerability has a significant technical impact, as it could compromise the security and integrity of user data and the Matrix React SDK.", "Mitigation Strategies": "Mitigation strategies include upgrading to the latest version of the Matrix React SDK and implementing additional security measures to prevent data manipulation.", "Recommendations": "We recommend that executives prioritize the mitigation of this vulnerability and take immediate action to protect user data and trust.", "Conclusions": "The Matrix React SDK URL Preview Vulnerability is a high-priority vulnerability that requires immediate attention and mitigation to protect user data and trust."}}