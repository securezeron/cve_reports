{
    "id": "CVE-2023-4807",
    "sourceIdentifier": "openssl-security@openssl.org",
    "published": "2023-09-08T12:15:08.043",
    "lastModified": "2025-04-23T17:16:47.073",
    "vulnStatus": "Modified",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "Issue summary: The POLY1305 MAC (message authentication code) implementation\ncontains a bug that might corrupt the internal state of applications on the\nWindows 64 platform when running on newer X86_64 processors supporting the\nAVX512-IFMA instructions.\n\nImpact summary: If in an application that uses the OpenSSL library an attacker\ncan influence whether the POLY1305 MAC algorithm is used, the application\nstate might be corrupted with various application dependent consequences.\n\nThe POLY1305 MAC (message authentication code) implementation in OpenSSL does\nnot save the contents of non-volatile XMM registers on Windows 64 platform\nwhen calculating the MAC of data larger than 64 bytes. Before returning to\nthe caller all the XMM registers are set to zero rather than restoring their\nprevious content. The vulnerable code is used only on newer x86_64 processors\nsupporting the AVX512-IFMA instructions.\n\nThe consequences of this kind of internal application state corruption can\nbe various - from no consequences, if the calling application does not\ndepend on the contents of non-volatile XMM registers at all, to the worst\nconsequences, where the attacker could get complete control of the application\nprocess. However given the contents of the registers are just zeroized so\nthe attacker cannot put arbitrary values inside, the most likely consequence,\nif any, would be an incorrect result of some application dependent\ncalculations or a crash leading to a denial of service.\n\nThe POLY1305 MAC algorithm is most frequently used as part of the\nCHACHA20-POLY1305 AEAD (authenticated encryption with associated data)\nalgorithm. The most common usage of this AEAD cipher is with TLS protocol\nversions 1.2 and 1.3 and a malicious client can influence whether this AEAD\ncipher is used by the server. This implies that server applications using\nOpenSSL can be potentially impacted. However we are currently not aware of\nany concrete application that would be affected by this issue therefore we\nconsider this a Low severity security issue.\n\nAs a workaround the AVX512-IFMA instructions support can be disabled at\nruntime by setting the environment variable OPENSSL_ia32cap:\n\n   OPENSSL_ia32cap=:~0x200000\n\nThe FIPS provider is not affected by this issue."
        },
        {
            "lang": "es",
            "value": "Resumen del problema: la implementaci\u00f3n POLY1305 MAC (c\u00f3digo de autenticaci\u00f3n de mensajes) contiene un error que podr\u00eda da\u00f1ar el estado interno de las aplicaciones en la plataforma Windows 64 cuando se ejecutan en procesadores X86_64 m\u00e1s nuevos que admiten las instrucciones AVX512-IFMA. Resumen del impacto: si en una aplicaci\u00f3n que usa la librer\u00eda OpenSSL un atacante puede influir en si se usa el algoritmo MAC POLY1305, el estado de la aplicaci\u00f3n podr\u00eda corromperse con varias consecuencias dependientes de la aplicaci\u00f3n. La implementaci\u00f3n POLY1305 MAC (c\u00f3digo de autenticaci\u00f3n de mensajes) en OpenSSL no guarda el contenido de los registros XMM no vol\u00e1tiles en la plataforma Windows 64 al calcular la MAC de datos de m\u00e1s de 64 bytes. Antes de regresar a la persona que llama, todos los registros XMM se establecen en cero en lugar de restaurar su contenido anterior. El c\u00f3digo vulnerable se utiliza s\u00f3lo en procesadores x86_64 m\u00e1s nuevos que admiten las instrucciones AVX512-IFMA. Las consecuencias de este tipo de corrupci\u00f3n del estado de la aplicaci\u00f3n interna pueden ser diversas: desde ninguna consecuencia, si la aplicaci\u00f3n que llama no depende en absoluto del contenido de los registros XMM no vol\u00e1tiles, hasta las peores consecuencias, donde el atacante podr\u00eda obtener el control total de el proceso de solicitud. Sin embargo, dado que el contenido de los registros simplemente se pone a cero para que el atacante no pueda colocar valores arbitrarios en su interior, la consecuencia m\u00e1s probable, si la hubiera, ser\u00eda un resultado incorrecto de algunos c\u00e1lculos dependientes de la aplicaci\u00f3n o una falla que provocar\u00eda una denegaci\u00f3n de servicio. El algoritmo POLY1305 MAC se utiliza con mayor frecuencia como parte del algoritmo CHACHA20-POLY1305 AEAD (cifrado autenticado con datos asociados). El uso m\u00e1s com\u00fan de este cifrado AEAD es con las versiones 1.2 y 1.3 del protocolo TLS y un cliente malicioso puede influir en si el servidor utiliza este cifrado AEAD. Esto implica que las aplicaciones de servidor que utilizan OpenSSL pueden verse potencialmente afectadas. Sin embargo, actualmente no conocemos ninguna aplicaci\u00f3n concreta que pueda verse afectada por este problema, por lo que lo consideramos un problema de seguridad de gravedad Baja. Como workaround, el soporte de instrucciones AVX512-IFMA se puede desactivar en tiempo de ejecuci\u00f3n configurando la variable de entorno OPENSSL_ia32cap: OPENSSL_ia32cap=:~0x200000 El proveedor FIPS no se ve afectado por este problema."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
                    "baseScore": 7.8,
                    "baseSeverity": "HIGH",
                    "attackVector": "LOCAL",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "LOW",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 1.8,
                "impactScore": 5.9
            },
            {
                "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
                    "baseScore": 7.8,
                    "baseSeverity": "HIGH",
                    "attackVector": "LOCAL",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "LOW",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 1.8,
                "impactScore": 5.9
            }
        ]
    },
    "weaknesses": [
        {
            "source": "openssl-security@openssl.org",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-440"
                }
            ]
        },
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "NVD-CWE-noinfo"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:openssl:openssl:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "1.1.1",
                            "versionEndExcluding": "1.1.1w",
                            "matchCriteriaId": "AE28C377-98B8-48F3-9869-A5085F95D22C"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:openssl:openssl:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "3.0.0",
                            "versionEndExcluding": "3.0.11",
                            "matchCriteriaId": "F9CA5322-712C-46EC-85D4-82BBCD86A370"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:openssl:openssl:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "3.1.0",
                            "versionEndExcluding": "3.1.3",
                            "matchCriteriaId": "8CD493DA-9CA9-4D3C-A2C0-BE0A06D7E265"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=4bfac4471f53c4f74c8d81020beb938f92d84ca5",
            "source": "openssl-security@openssl.org",
            "tags": [
                "Mailing List",
                "Patch"
            ]
        },
        {
            "url": "https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=6754de4a121ec7f261b16723180df6592cbb4508",
            "source": "openssl-security@openssl.org",
            "tags": [
                "Mailing List",
                "Patch"
            ]
        },
        {
            "url": "https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=a632d534c73eeb3e3db8c7540d811194ef7c79ff",
            "source": "openssl-security@openssl.org",
            "tags": [
                "Mailing List",
                "Patch"
            ]
        },
        {
            "url": "https://www.openssl.org/news/secadv/20230908.txt",
            "source": "openssl-security@openssl.org",
            "tags": [
                "Vendor Advisory"
            ]
        },
        {
            "url": "https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=4bfac4471f53c4f74c8d81020beb938f92d84ca5",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Mailing List",
                "Patch"
            ]
        },
        {
            "url": "https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=6754de4a121ec7f261b16723180df6592cbb4508",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Mailing List",
                "Patch"
            ]
        },
        {
            "url": "https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=a632d534c73eeb3e3db8c7540d811194ef7c79ff",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Mailing List",
                "Patch"
            ]
        },
        {
            "url": "https://security.netapp.com/advisory/ntap-20230921-0001/",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://www.openssl.org/news/secadv/20230908.txt",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Vendor Advisory"
            ]
        }
    ],
    "techniques": [
        {
            "techniqueID": "T1134",
            "comment": "CVE-2023-4807 - This CVE relates to a vulnerability in POLY1305 MAC implementation in OpenSSL, which could allow an attacker to corrupt the internal state of an application running on Windows 64 platform. This could lead to various consequences, including incorrect results, crashes, or denial of service."
        },
        {
            "techniqueID": "T1110",
            "comment": "CVE-2023-4807 - The vulnerability in POLY1305 MAC implementation in OpenSSL can be exploited by an attacker to disrupt the normal functioning of an application. This can be done by influencing the use of the POLY1305 MAC algorithm in the application."
        },
        {
            "techniqueID": "T1030",
            "comment": "CVE-2023-4807 - The vulnerability in POLY1305 MAC implementation in OpenSSL can be used to gain unauthorized access to an application, or to cause it to malfunction. This can be done by exploiting the vulnerability to corrupt the internal state of the application."
        },
        {
            "techniqueID": "T1574",
            "comment": "CVE-2023-4807 - The vulnerability in POLY1305 MAC implementation in OpenSSL can be used to cause an application to crash, or to manipulate its output. This can be done by exploiting the vulnerability to corrupt the internal state of the application."
        }
    ],
    "stix_bundle": {
        "TYPE": "bundle",
        "ID": "CVE-2023-4807",
        "created_by": "security-researcher",
        "created": "2023-02-15T14:30:00.000Z",
        "modified": "2023-02-15T14:30:00.000Z",
        "objects": [
            {
                "TYPE": "vulnerability",
                "ID": "CVE-2023-4807",
                "name": "POLY1305 MAC implementation vulnerability",
                "created_by": "security-researcher",
                "created": "2023-02-15T14:30:00.000Z",
                "modified": "2023-02-15T14:30:00.000Z",
                "description": "The POLY1305 MAC implementation in OpenSSL contains a bug that might corrupt the internal state of applications on the Windows 64 platform when running on newer X86_64 processors supporting the AVX512-IFMA instructions."
            },
            {
                "TYPE": "indicator",
                "ID": "Indicator-1",
                "name": "AVX512-IFMA Instructions Support",
                "created_by": "security-researcher",
                "created": "2023-02-15T14:30:00.000Z",
                "modified": "2023-02-15T14:30:00.000Z",
                "groups": [
                    {
                        "IDs": [
                            "CVE-2023-4807"
                        ]
                    }
                ],
                "modifiers": [
                    {
                        "IDs": [
                            "T1134"
                        ]
                    }
                ]
            },
            {
                "TYPE": "course-of-action",
                "ID": "Defense-1",
                "name": "Disable AVX512-IFMA Instructions Support",
                "created_by": "security-researcher",
                "created": "2023-02-15T14:30:00.000Z",
                "modified": "2023-02-15T14:30:00.000Z",
                "description": "To prevent exploitation, disable the support for AVX512-IFMA instructions by setting the environment variable OPENSSL_ia32cap.:~0x200000.",
                "techniques": [
                    "T1134"
                ]
            }
        ],
        "relationship": [
            {
                "source": "CVE-2023-4807",
                "target": "Indicator-1",
                "type": "related"
            },
            {
                "source": "Indicator-1",
                "target": "Defense-1",
                "type": "implemented"
            },
            {
                "source": "Defense-1",
                "target": "T1134",
                "type": "mitigates"
            }
        ]
    },
    "technical_analysis": {
        "Introduction": "The CVE-2023-4807 is a vulnerability in the POLY1305 MAC implementation in OpenSSL, which can be exploited by an attacker to disrupt the normal functioning of an application.",
        "Impact and Scope": "This vulnerability can lead to various consequences, including incorrect results, crashes, or denial of service.",
        "Related MITRE ATT&CK Techniques": "The vulnerability relates to T1134, T1110, T1030, and T1574.",
        "Technical Details": "The vulnerability is caused by the bug in the POLY1305 MAC implementation in OpenSSL, which can be exploited by an attacker to corrupt the internal state of an application.",
        "Detection": "To detect this vulnerability, monitor for network traffic patterns and system calls that indicate potential exploitation.",
        "Mitigation": "To mitigate this vulnerability, disable the support for AVX512-IFMA instructions by setting the environment variable OPENSSL_ia32cap.:~0x200000.",
        "Conclusion": "The CVE-2023-4807 is a vulnerability in the POLY1305 MAC implementation in OpenSSL, which can be exploited by an attacker to disrupt the normal functioning of an application. To prevent exploitation, disable the support for AVX512-IFMA instructions."
    },
    "executive_analysis": {
        "Overview": "The CVE-2023-4807 is a vulnerability in the POLY1305 MAC implementation in OpenSSL, which can be exploited by an attacker to disrupt the normal functioning of an application.",
        "Business Impact": "This vulnerability can lead to significant business impact, including data loss, system downtime, and reputational damage.",
        "Technical Impact": "This vulnerability can be exploited by an attacker to disrupt the normal functioning of an application, which can have significant technical impact.",
        "Mitigation Strategies": "To mitigate this vulnerability, disable the support for AVX512-IFMA instructions by setting the environment variable OPENSSL_ia32cap.:~0x200000.",
        "Recommendations": "Recommendations for executives include implementing a vulnerability management program, conducting regular security assessments, and providing training on security best practices.",
        "Conclusions": "In conclusion, the CVE-2023-4807 is a vulnerability in the POLY1305 MAC implementation in OpenSSL, which can be exploited by an attacker to disrupt the normal functioning of an application. To prevent exploitation, disable the support for AVX512-IFMA instructions."
    }
}