{"id": "CVE-2024-40624", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-15T20:15:04.810", "lastModified": "2024-07-16T13:43:58.773", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "TorrentPier is an open source BitTorrent Public/Private tracker engine, written in php. In `torrentpier/library/includes/functions.php`, `get_tracks()` uses the unsafe native PHP serialization format to deserialize user-controlled cookies. One can use phpggc and the chain Guzzle/FW1 to write PHP code to an arbitrary file, and execute commands on the system. For instance, the cookie bb_t will be deserialized when browsing to viewforum.php. This issue has been addressed in commit `ed37e6e52` which is expected to be included in release version 2.4.4. Users are advised to upgrade as soon as the new release is available. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "TorrentPier es un motor de seguimiento p\u00fablico/privado de BitTorrent de c\u00f3digo abierto, escrito en php. En `torrentpier/library/includes/functions.php`, `get_tracks()` utiliza el formato de serializaci\u00f3n PHP nativo no seguro para deserializar las cookies controladas por el usuario. Se pueden usar phpggc y la cadena Guzzle/FW1 para escribir c\u00f3digo PHP en un archivo arbitrario y ejecutar comandos en el sistema. Por ejemplo, la cookie bb_t se deserializar\u00e1 al navegar por viewforum.php. Este problema se solucion\u00f3 en el commit `ed37e6e52`, que se espera que se incluya en la versi\u00f3n 2.4.4. Se recomienda a los usuarios que actualicen tan pronto como est\u00e9 disponible la nueva versi\u00f3n. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-502"}]}], "references": [{"url": "https://github.com/torrentpier/torrentpier/blob/84f6c9f4a081d9ffff4c233098758280304bf50f/library/includes/functions.php#L41-L60", "source": "security-advisories@github.com"}, {"url": "https://github.com/torrentpier/torrentpier/commit/ed37e6e522f345f2b46147c6f53c1ab6dec1db9e", "source": "security-advisories@github.com"}, {"url": "https://github.com/torrentpier/torrentpier/security/advisories/GHSA-fg86-4c2r-7wxw", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1046", "comment": "CVE-2024-40624 - This is a demonstration of the potential for using deserialization of user-controlled data to execute arbitrary code, therefore it is related to T1046, 'Exploitation of Remote File Inclusion'."}, {"techniqueID": "T1210", "comment": "CVE-2024-40624 - This vulnerability relies on the ability to manipulate the system by controlling the deserialization of user-controlled data, therefore it is related to T1210, 'Exploitation of Integer Overflow'."}], "stix_bundle": {"cybox_version": "2.1", "id": "CVE-2024-40624", "type": "vulnerability", "first_seen": "2024-07-15T20:15:04.810", "last_modified": "2024-07-16T13:43:58.773", "vulnerability_status": "Awaiting Analysis", "description": [{"lang": "en", "value": "CVE-2024-40624"}], "references": [{"href": "https://github.com/torrentpier/torrentpier/blob/84f6c9f4a081d9ffff4c233098758280304bf50f/library/includes/functions.php#L41-L60", "id": "SRGFSALE", "type": "github://security-advisories@github.com"}, {"href": "https://github.com/torrentpier/torrentpier/commit/ed37e6e522f345f2b46147c6f53c1ab6dec1db9e", "id": "SRGFSALE", "type": "github://security-advisories@github.com"}, {"href": "https://github.com/torrentpier/torrentpier/security/advisories/GHSA-fg86-4c2r-7wxw", "id": "SRGFSALE", "type": "github://security-advisories@github.com"}], "incident": {"type": "vulnerability-incident", "phase": "analysis", "name": "CVE-2024-40624", "description": [{"lang": "en", "value": "CVE-2024-40624"}]}, "related_relationships": [{"type": "related", "target_id": "SRGFSALE", "target_type": "github://security-advisories@github.com"}]}, "technical_analysis": {"Introduction": "CVE-2024-40624 is a vulnerability in TorrentPier's BitTorrent tracker engine that allows for the deserialization of user-controlled data, which can be used to execute arbitrary code on the system.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 (CRITICAL) and an attack vector of 'NETWORK'. It allows for the execution of arbitrary code on the system.", "Related MITRE ATT&CK Techniques": "T1046 and T1210 are related to this vulnerability as they both involve the exploitation of remote file inclusion and the use of integer overflow to manipulate the system.", "Technical Details": "The vulnerability occurs in the `get_tracks()` function in `torrentpier/library/includes/functions.php`, where the function uses the unsafe native PHP serialization format to deserialize user-controlled cookies.", "Detection": "Detection of this vulnerability can be done by monitoring system logs for suspicious activity related to PHP code execution and by conducting regular vulnerability scans.", "Mitigation": "Mitigation strategies include updating to the latest version of TorrentPier, disabling the use of PHP serialization, and implementing input validation and sanitization.", "Conclusion": "CVE-2024-40624 is a critical vulnerability that can be exploited by attackers to execute arbitrary code on the system. It is essential to update to the latest version of TorrentPier and implement mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-40624 is a critical vulnerability in TorrentPier's BitTorrent tracker engine that can be exploited by attackers to execute arbitrary code on the system.", "Business Impact": "This vulnerability can lead to the theft of sensitive data, disruption of critical systems, and reputational damage.", "Technical Impact": "The vulnerability allows for the execution of arbitrary code on the system, which can be used to conduct a range of malicious activities.", "Mitigation Strategies": "Immediate mitigation is necessary to prevent exploitation. This includes updating to the latest version of TorrentPier, disabling the use of PHP serialization, and implementing input validation and sanitization.", "Recommendations": "We recommend that all affected systems be updated as soon as possible and that a comprehensive risk assessment be conducted to identify and mitigate any potential threats.", "Conclusions": "CVE-2024-40624 is a critical vulnerability that requires immediate attention and mitigation. We urge all affected organizations to take immediate action to protect their systems."}}