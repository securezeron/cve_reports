{"id": "CVE-2000-1087", "sourceIdentifier": "cve@mitre.org", "published": "2001-01-09T05:00:00.000", "lastModified": "2018-10-12T21:29:57.827", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The xp_proxiedmetadata function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) does not properly restrict the length of a buffer before calling the srv_paraminfo function in the SQL Server API for Extended Stored Procedures (XP), which allows an attacker to cause a denial of service or execute arbitrary commands, aka the \"Extended Stored Procedure Parameter Parsing\" vulnerability."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.6}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.9, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:data_engine:1.0:*:*:*:*:*:*:*", "matchCriteriaId": "F455C373-A9F7-47F9-828E-DEE2C8CC6545"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:data_engine:2000:*:*:*:*:*:*:*", "matchCriteriaId": "51ABD323-BF3F-4825-8788-8FCD614E83E4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:sql_server:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "A2AB95D7-394E-423B-884C-87A9960682EE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:sql_server:2000:*:*:*:*:*:*:*", "matchCriteriaId": "A5D559EE-727C-405C-987C-247973A84D32"}]}]}], "references": [{"url": "http://marc.info/?l=bugtraq&m=97570884410184&w=2", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/2042", "source": "cve@mitre.org", "tags": ["Exploit", "Patch", "Vendor Advisory"]}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2000/ms00-092", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2000-1087 - An attacker can cause a denial of service or execute arbitrary commands by exploiting the xp_proxiedmetadata function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) through the SQL Server API for Extended Stored Procedures (XP). This can be detected using techniques such as auditing of database access and monitoring of system calls for suspicious activity."}, {"techniqueID": "T1078", "comment": "CVE-2000-1087 - An attacker can execute arbitrary commands by exploiting the xp_proxiedmetadata function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE). This can be detected using techniques such as monitoring system calls for suspicious activity and verifying the integrity of database entries."}, {"techniqueID": "T1087", "comment": "CVE-2000-1087 - An attacker can cause a denial of service or execute arbitrary commands by exploiting the xp_proxiedmetadata function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) through the SQL Server API for Extended Stored Procedures (XP). This can be detected using techniques such as monitoring system performance and network traffic for suspicious activity."}, {"techniqueID": "T1218", "comment": "CVE-2000-1087 - An attacker can execute arbitrary commands by exploiting the xp_proxiedmetadata function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE). This can be detected using techniques such as monitoring system calls for suspicious activity and verifying the integrity of database entries."}, {"techniqueID": "T1505", "comment": "CVE-2000-1087 - An attacker can cause a denial of service or execute arbitrary commands by exploiting the xp_proxiedmetadata function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) through the SQL Server API for Extended Stored Procedures (XP). This can be detected using techniques such as monitoring system performance and network traffic for suspicious activity."}], "stix_bundle": {"type": "bundle", "id": "2.1:example_bundle", "created_by_ref": "creator:example", "created": "2023-02-20T14:30:00.000", "modified": "2023-02-20T14:30:00.000", "objects": [{"type": "vulnerability", "id": "2.1:vulnerability_cve-2000-1087", "created_by_ref": "creator:example", "created": "2023-02-20T14:30:00.000", "modified": "2023-02-20T14:30:00.000", "name": "CVE-2000-1087 - Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) Vulnerability", "description": "The xp_proxiedmetadata function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) does not properly restrict the length of a buffer before calling the srv_paraminfo function in the SQL Server API for Extended Stored Procedures (XP), which allows an attacker to cause a denial of service or execute arbitrary commands.", "severity": "Medium", "cvss_vector": "AV:L/AC:L/Au:N/C:P/I:P/A:P", "references": [{"type": "reference", "source_name": "CVE", "source_ref": "CVE-2000-1087", "relation": "is related to"}], "incident_response": [{"type": "course_of_action", "id": "2.1:coa_cve-2000-1087_1", "name": "Update Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) to the latest version", "description": "Update Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) to the latest version to fix the vulnerability.", "related_techniques": [{"type": "technique", "id": "2.1:technique_id_T1190"}]}], "mitigation": [{"type": "note", "text": "Do not use the xp_proxiedmetadata function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE). Instead, use the recommended methods for interacting with the SQL Server API for Extended Stored Procedures (XP)."}]}]}, "technical_analysis": {"Introduction": "The CVE-2000-1087 vulnerability is a remote code execution vulnerability in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) through the SQL Server API for Extended Stored Procedures (XP).", "Impact and Scope": "The vulnerability allows an attacker to execute arbitrary commands and cause a denial of service, impacting the confidentiality, integrity, and availability of the database.", "Related MITRE ATT&CK Techniques": "T1190, T1078, T1087, T1218, and T1505", "Technical Details": "The vulnerability is caused by a buffer overflow in the xp_proxiedmetadata function, which can be exploited by an attacker to execute arbitrary code.", "Detection": "The vulnerability can be detected by monitoring system calls for suspicious activity, auditing database access, and verifying the integrity of database entries.", "Mitigation": "The vulnerability can be mitigated by updating Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) to the latest version, disabling the xp_proxiedmetadata function, and implementing access controls to restrict access to the database.", "Conclusion": "The CVE-2000-1087 vulnerability is a significant risk to databases using Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) and should be addressed promptly."}, "executive_analysis": {"Overview": "The CVE-2000-1087 vulnerability is a remote code execution vulnerability in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) through the SQL Server API for Extended Stored Procedures (XP).", "Business Impact": "The vulnerability can cause a denial of service and execute arbitrary commands, impacting the confidentiality, integrity, and availability of the database, which can lead to financial losses and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary commands and cause a denial of service, impacting the technical capabilities of the database and the organization.", "Mitigation Strategies": "Updating Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) to the latest version, disabling the xp_proxiedmetadata function, and implementing access controls to restrict access to the database.", "Recommendations": "Recommended action is to take immediate action to update Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) to the latest version and implement access controls to restrict access to the database.", "Conclusions": "The CVE-2000-1087 vulnerability is a significant risk to databases using Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) and should be addressed promptly."}}