{"id": "CVE-2024-42060", "sourceIdentifier": "security@zyxel.com.tw", "published": "2024-09-03T02:15:04.900", "lastModified": "2024-09-05T14:37:03.387", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A post-authentication command injection vulnerability in Zyxel ATP series firmware versions from V4.32 through V5.38, USG FLEX series firmware versions from V4.50 through V5.38, USG FLEX 50(W) series firmware versions from V4.16 through V5.38, and USG20(W)-VPN series firmware versions from V4.16 through V5.38 could allow an authenticated attacker with administrator privileges to execute some OS commands on an affected device by uploading a crafted internal user agreement file to the vulnerable device."}, {"lang": "es", "value": "Una vulnerabilidad de inyecci\u00f3n de comandos posterior a la autenticaci\u00f3n en las versiones de firmware de la serie Zyxel ATP de V4.32 a V5.38, las versiones de firmware de la serie USG FLEX de V4.50 a V5.38, las versiones de firmware de la serie USG FLEX 50(W) de V4.16 a V5.38 y las versiones de firmware de la serie USG20(W)-VPN de V4.16 a V5.38 podr\u00eda permitir que un atacante autenticado con privilegios de administrador ejecute algunos comandos del sistema operativo en un dispositivo afectado cargando un archivo de acuerdo de usuario interno manipulado espec\u00edficamente para el dispositivo vulnerable."}], "metrics": {"cvssMetricV31": [{"source": "security@zyxel.com.tw", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@zyxel.com.tw", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:zyxel:zld_firmware:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.32", "versionEndExcluding": "5.39", "matchCriteriaId": "EAE9D73B-62CC-419D-8FDF-3BD7B84F5636"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:atp100:-:*:*:*:*:*:*:*", "matchCriteriaId": "7F7654A1-3806-41C7-82D4-46B0CD7EE53B"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:atp100w:-:*:*:*:*:*:*:*", "matchCriteriaId": "47398FD0-6C5E-4625-9EFD-DE08C9AB7DB2"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:atp200:-:*:*:*:*:*:*:*", "matchCriteriaId": "D68A36FF-8CAF-401C-9F18-94F3A2405CF4"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:atp500:-:*:*:*:*:*:*:*", "matchCriteriaId": "2818E8AC-FFEE-4DF9-BF3F-C75166C0E851"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:atp700:-:*:*:*:*:*:*:*", "matchCriteriaId": "0B41F437-855B-4490-8011-DF59887BE6D5"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:atp800:-:*:*:*:*:*:*:*", "matchCriteriaId": "66B99746-0589-46E6-9CBD-F38619AD97DC"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:zyxel:zld_firmware:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.50", "versionEndExcluding": "5.39", "matchCriteriaId": "C96951B7-DDC3-4DF2-B349-C9AB1BEF9045"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_100:-:*:*:*:*:*:*:*", "matchCriteriaId": "2B30A4C0-9928-46AD-9210-C25656FB43FB"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_100ax:-:*:*:*:*:*:*:*", "matchCriteriaId": "03036815-04AE-4E39-8310-DA19A32CFA48"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_100w:-:*:*:*:*:*:*:*", "matchCriteriaId": "D74ABA7E-AA78-4A13-A64E-C44021591B42"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_200:-:*:*:*:*:*:*:*", "matchCriteriaId": "F93B6A06-2951-46D2-A7E1-103D7318D612"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_50:-:*:*:*:*:*:*:*", "matchCriteriaId": "646C1F07-B553-47B0-953B-DC7DE7FD0F8B"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_500:-:*:*:*:*:*:*:*", "matchCriteriaId": "92C697A5-D1D3-4FF0-9C43-D27B18181958"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_700:-:*:*:*:*:*:*:*", "matchCriteriaId": "9D1396E3-731B-4D05-A3F8-F3ABB80D5C29"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:zyxel:zld_firmware:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.16", "versionEndExcluding": "5.39", "matchCriteriaId": "668B88CE-7DCB-4EA7-81B9-1BE3DAB8E2E5"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_50w:-:*:*:*:*:*:*:*", "matchCriteriaId": "110A1CA4-0170-4834-8281-0A3E14FC5584"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:zyxel:zld_firmware:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.16", "versionEndExcluding": "5.39", "matchCriteriaId": "668B88CE-7DCB-4EA7-81B9-1BE3DAB8E2E5"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_20w-vpn:-:*:*:*:*:*:*:*", "matchCriteriaId": "6BEA412F-3DA1-4E91-9C74-0666147DABCE"}]}]}], "references": [{"url": "https://www.zyxel.com/global/en/support/security-advisories/zyxel-security-advisory-for-multiple-vulnerabilities-in-firewalls-09-03-2024", "source": "security@zyxel.com.tw", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-42060 - This vulnerability allows an attacker to execute OS commands on an affected device by uploading a crafted internal user agreement file. This is a Command Injection vulnerability that could lead to remote code execution or data tampering. Defenses include restricting file uploads and validating file content."}, {"techniqueID": "T1205", "comment": "CVE-2024-42060 - The vulnerability in Zyxel devices can allow an authenticated attacker to read, write, or execute files on the device, which can lead to data tampering, escalation of privileges, or command injection. Defenses include restricting access to sensitive areas of the device and validating file hashes."}, {"techniqueID": "T1047", "comment": "CVE-2024-42060 - The vulnerability can be exploited through a crafted internal user agreement file, which can lead to the execution of OS commands, data tampering, or remote code execution. Defenses include restricting file uploads and validating file content."}, {"techniqueID": "T1190", "comment": "CVE-2024-42060 - The vulnerability in Zyxel devices can be exploited to read, write, or execute files on the device, which can lead to data tampering, escalation of privileges, or command injection. Defenses include validating file hashes and restricting access to sensitive areas."}], "stix_bundle": {"type": "bundle", "id": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "created_by_ref": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "modified": "2024-09-05T14:37:03.387", "objects": [{"type": "vulnerability", "id": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "name": "CVE-2024-42060", "description": "A post-authentication command injection vulnerability in Zyxel ATP series firmware versions from V4.32 through V5.38, USG FLEX series firmware versions from V4.50 through V5.38, USG FLEX 50(W) series firmware versions from V4.16 through V5.38, and USG20(W)-VPN series firmware versions from V4.16 through V5.38 could allow an authenticated attacker with administrator privileges to execute some OS commands on an affected device by uploading a crafted internal user agreement file to the vulnerable device.", "baseModule": {"type": "attack-pattern", "id": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "name": "Command Injection"}, "related_attack_patterns": [{"type": "attack-pattern", "id": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "name": "Command Injection"}], "related_course_discovery": [{"type": "course-of-action", "id": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "name": "Detect file uploads"}], "related_mitigation": [{"type": "mitigation", "id": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "name": "Restrict file uploads"}]}]}, "technical_analysis": {"Introduction": "The Zyxel CVE-2024-42060 vulnerability is a command injection vulnerability in various Zyxel devices, allowing attackers to execute OS commands, data tampering, or remote code execution.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2, with a vector string of CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H. This means it is a high-severity vulnerability with a moderate attack complexity, requiring high privileges and no user interaction.", "Related MITRE ATT&CK Techniques": "T1210, T1205, T1047, T1190", "Technical Details": "The vulnerability occurs when an authenticated attacker with administrator privileges uploads a crafted internal user agreement file to the vulnerable device, leading to command injection.", "Detection": "Detection methods include monitoring for unusual file uploads and anomalies in system logs.", "Mitigation": "Mitigation strategies include restricting file uploads, validating file content, and validating file hashes.", "Conclusion": "Conclusions and next steps."}, "executive_analysis": {"Overview": "The Zyxel CVE-2024-42060 vulnerability is a critical command injection vulnerability that can lead to remote code execution or data tampering.", "Business Impact": "This vulnerability can lead to data breaches, system compromise, or financial losses.", "Technical Impact": "The vulnerability can potentially lead to escalation of privileges, data tampering, or remote code execution.", "Mitigation Strategies": "Restrict file uploads, validate file content, and validate file hashes.", "Recommendations": "Implement additional security controls and regularly update device firmware.", "Conclusions": "Conclusion and next steps."}}