{"id": "CVE-2024-5248", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T19:16:06.917", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In lunary-ai/lunary version 1.2.5, an improper access control vulnerability exists due to a missing permission check in the `GET /v1/users/me/org` endpoint. The platform's role definitions restrict the `Prompt Editor` role to prompt management and project viewing/listing capabilities, explicitly excluding access to user information. However, the endpoint fails to enforce this restriction, allowing users with the `Prompt Editor` role to access the full list of users in the organization. This vulnerability allows unauthorized access to sensitive user information, violating the intended access controls."}, {"lang": "es", "value": "En lunary-ai/lunary versi\u00f3n 1.2.5, existe una vulnerabilidad de control de acceso inadecuado debido a una falta de verificaci\u00f3n de permiso en el endpoint `GET /v1/users/me/org`. Las definiciones de funciones de la plataforma restringen la funci\u00f3n \"Editor de mensajes\" a la gesti\u00f3n de mensajes y las capacidades de visualizaci\u00f3n/enumeraci\u00f3n de proyectos, excluyendo expl\u00edcitamente el acceso a la informaci\u00f3n del usuario. Sin embargo, el endpoint no aplica esta restricci\u00f3n, lo que permite a los usuarios con la funci\u00f3n \"Editor de mensajes\" acceder a la lista completa de usuarios de la organizaci\u00f3n. Esta vulnerabilidad permite el acceso no autorizado a informaci\u00f3n confidencial del usuario, violando los controles de acceso previstos."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-284"}]}], "references": [{"url": "https://huntr.com/bounties/4ec75087-5630-4813-952b-88ccabe6d117", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1047", "comment": "CVE-2024-5248 - This technique is relevant because it involves an improper access control vulnerability in the GET /v1/users/me/org endpoint, allowing unauthorized access to sensitive user information. This can be mitigated by implementing proper restrictions on access controls and validating user roles."}, {"techniqueID": "T1190", "comment": "CVE-2024-5248 - This technique is relevant because it involves access to sensitive user information without authentication, which is a common technique used by attackers. This can be mitigated by implementing strong authentication and authorization controls."}, {"techniqueID": "T1078", "comment": "CVE-2024-5248 - This technique is relevant because it involves the collection of sensitive user information, which can be used for future attacks. This can be mitigated by implementing data minimization and data masking controls."}, {"techniqueID": "T1204", "comment": "CVE-2024-5248 - This technique is relevant because it involves the exfiltration of sensitive user information, which can be used for malicious purposes. This can be mitigated by implementing data loss prevention controls and monitoring for unusual data transfer patterns."}], "stix_bundle": {"type": "bundle", "id": "CVE-2024-5248", "created_by_ref": "security@huntr.dev", "created": "2024-06-06T19:16:06.917", "modified": "2024-06-07T14:56:05.647", "objects": [{"type": "indicator", "id": "IND-1", "name": "Impersonation of user roles", "description": "IP addresses scanning for vulnerabilities", "created_by_ref": "security@huntr.dev", "created": "2024-06-06T19:16:06.917", "modified": "2024-06-07T14:56:05.647", "first_observed": "2024-06-06T19:16:06.917", "last_observed": "2024-06-07T14:56:05.647", "affected\u8d44\u4ea7": [{"type": "asset", "id": "Asset-1", "name": "Lunary AI Platform"}], "tactics": [{"type": "tactic", "id": "TA0001", "name": "Initial Access"}]}], " relationships": [{"type": "started", "id": "INC-REL-1", "source_ref": "IND-1", "target_ref": "CVE-2024-5248"}]}, "technical_analysis": {"Introduction": "The CVE-2024-5248 vulnerability exists in the lunary-ai/lunary version 1.2.5, which allows unauthorized access to sensitive user information due to improper access control.", "Impact and Scope": "The vulnerability affects users with the 'Prompt Editor' role, allowing them to access the full list of users in the organization.", "Related MITRE ATT&CK Techniques": "T1047, T1190, T1078, and T1204 are the relevant MITRE ATT&CK techniques related to this CVE.", "Technical Details": "The vulnerability occurs due to a missing permission check in the GET /v1/users/me/org endpoint, which allows users with the 'Prompt Editor' role to access the full list of users in the organization.", "Detection": "The vulnerability can be detected by monitoring for unusual data transfer patterns and monitoring for access to sensitive user information.", "Mitigation": "The vulnerability can be mitigated by implementing proper restrictions on access controls, validating user roles, and implementing strong authentication and authorization controls.", "Conclusion": "The CVE-2024-5248 vulnerability is a critical security issue that allows unauthorized access to sensitive user information. It is essential to implement proper security controls to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-5248 vulnerability is a serious security issue that affects the lunary-ai/lunary version 1.2.5.", "Business Impact": "This vulnerability can result in unauthorized access to sensitive user information, which can lead to financial loss, reputational damage, and legal consequences.", "Technical Impact": "The vulnerability can allow attackers to access sensitive user information, which can be used for malicious purposes.", "Mitigation Strategies": "Implementing proper security controls, such as access restrictions and authentication controls, can mitigate this vulnerability.", "Recommendations": "Executives should ensure that proper security controls are implemented to prevent unauthorized access to sensitive user information.", "Conclusions": "The CVE-2024-5248 vulnerability is a critical security issue that requires immediate attention and mitigation."}}