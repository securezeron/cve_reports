{"id": "CVE-2024-42146", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-30T08:15:06.313", "lastModified": "2024-07-30T13:32:45.943", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/xe: Add outer runtime_pm protection to xe_live_ktest@xe_dma_buf\n\nAny kunit doing any memory access should get their own runtime_pm\nouter references since they don't use the standard driver API\nentries. In special this dma_buf from the same driver.\n\nFound by pre-merge CI on adding WARN calls for unprotected\ninner callers:\n\n<6> [318.639739]     # xe_dma_buf_kunit: running xe_test_dmabuf_import_same_driver\n<4> [318.639957] ------------[ cut here ]------------\n<4> [318.639967] xe 0000:4d:00.0: Missing outer runtime PM protection\n<4> [318.640049] WARNING: CPU: 117 PID: 3832 at drivers/gpu/drm/xe/xe_pm.c:533 xe_pm_runtime_get_noresume+0x48/0x60 [xe]"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: drm/xe: agregue protecci\u00f3n runtime_pm externa a xe_live_ktest@xe_dma_buf. Cualquier kunit que acceda a la memoria debe obtener sus propias referencias externas runtime_pm ya que no usan las entradas API del controlador est\u00e1ndar. En especial este dma_buf del mismo controlador. Encontrado por CI previo a la fusi\u00f3n al agregar llamadas WARN para llamadores internos desprotegidos: &lt;6&gt; [318.639739] # xe_dma_buf_kunit: ejecutando xe_test_dmabuf_import_same_driver &lt;4&gt; [318.639957] ------------[ cortar aqu\u00ed ]-- ---------- &lt;4&gt; [318.639967] xe 0000:4d:00.0: Falta protecci\u00f3n PM de tiempo de ejecuci\u00f3n externo &lt;4&gt; [318.640049] ADVERTENCIA: CPU: 117 PID: 3832 en drivers/gpu/drm/xe /xe_pm.c:533 xe_pm_runtime_get_noresume+0x48/0x60 [xe]"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0888d15ea45ba8ef4508edd1123ea5ad95b58994", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f9116f658a6217b101e3b4e89f845775b6fb05d9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-42146 - The Linux kernel vulnerability allows an attacker to potentially exploit the missing PM protection, allowing for elevated privileges and potential for data theft or manipulation."}, {"techniqueID": "T1204", "comment": "CVE-2024-42146 - The vulnerability potentially allows an attacker to execute code with elevated privileges, allowing for persistence and potential for further attacks."}], "stix_bundle": {"bundle": {"type": "bundle", "spec_version": "2.1", "id": "698f5e4e-7a48-4c4b-8c3c-66c1d6e2cd51", "created_by_ref": "http://stix.incubator.io/v2/ courses_of_action/8b3bd49c-18c7-413e-b5f1-b94de1d96d11", "created": "2023-01-01T14:30:00.000Z", "modified": "2023-01-01T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "8b3bd49c-18c7-413e-b5f1-b94de1d96d11", "created_by_ref": "http://stix.incubator.io/v2/ courses_of_action/8b3bd49c-18c7-413e-b5f1-b94de1d96d11", "created": "2023-01-01T14:30:00.000Z", "modified": "2023-01-01T14:30:00.000Z", "name": "CVE-2024-42146", "description": "In the Linux kernel, the following vulnerability has been resolved:  <drm/xe>: Add outer runtime_pm protection to xe_live_ktest@xe_dma_buf.\r\n\r\nAny kunit doing any memory access should get their own runtime_pm outer references since they don't use the standard driver API entries.\r\n\r\nFound by pre-merge CI on adding WARN calls for unprotected inner callers:", "cve_id": "CVE-2024-42146", "cwe_id": [], "severity": "HIGH", "impact": "HIGH", "difficulty": "MEDIUM", " exploitability_ease": "HIGH", " risk_analyzers": [{"type": "risk-analyzer", "id": "risk-analyzer-1", "name": "Risk-1", "description": "Risk-Analyzer-1", "analyzer_type": "MITRE", "data": {" risk": "HIGH"}}]}, {"type": "course_of_action", "id": "8b3bd49c-18c7-413e-b5f1-b94de1d96d11", "created_by_ref": "http://stix.incubator.io/v2/ courses_of_action/8b3bd49c-18c7-413e-b5f1-b94de1d96d11", "created": "2023-01-01T14:30:00.000Z", "modified": "2023-01-01T14:30:00.000Z", "name": "COA-1", "description": "COA-1 Details", "mitigations": [{"type": "mitigation", "id": "mitigation-1", "name": "Mitigation-1", "description": "Mitigation-1 Details"}], "detection": [{"type": "detection", "id": "detection-1", "name": "Detection-1", "description": "Detection-1 Details"}], "recommendations": [{"type": "recommendation", "id": "recommendation-1", "name": "Recommendation-1", "description": "Recommendation-1 Details"}]}], "relation": {"type": "has part", "id": "has-part-1", "created_by_ref": "http://stix.incubator.io/v2/ courses_of_action/8b3bd49c-18c7-413e-b5f1-b94de1d96d11", "created": "2023-01-01T14:30:00.000Z", "modified": "2023-01-01T14:30:00.000Z", "from_ref": "http://stix.incubator.io/v2/ vulnerabilities/8b3bd49c-18c7-413e-b5f1-b94de1d96d11", "to_ref": "http://stix.incubator.io/v2/ courses_of_action/8b3bd49c-18c7-413e-b5f1-b94de1d96d11"}}}, "technical_analysis": {"Introduction": "This report provides a technical analysis of the CVE-2024-42146 vulnerability in the Linux kernel.", "Impact and Scope": "The vulnerability allows an attacker to potentially exploit the missing PM protection, allowing for elevated privileges and potential for data theft or manipulation.", "Related MITRE ATT&CK Techniques": "T1027 and T1204", "Technical Details": "The vulnerability is caused by missing PM protection in the Linux kernel, allowing for elevated privileges.", "Detection": "Detection of the vulnerability through security controls such as IDS/IPS and log analysis.", "Mitigation": "Mitigations include applying patches, disabling unnecessary services, and implementing secure coding practices.", "Conclusion": "The vulnerability poses a significant risk to the Linux kernel and requires prompt attention from security practitioners."}, "executive_analysis": {"Overview": "This report provides an executive-level analysis of the CVE-2024-42146 vulnerability in the Linux kernel.", "Business Impact": "The vulnerability poses a significant risk to the Linux kernel, and failure to mitigate it could result in data theft, manipulation, or destruction.", "Technical Impact": "The vulnerability allows an attacker to potentially exploit the missing PM protection, allowing for elevated privileges and potential for further attacks.", "Mitigation Strategies": "Implementing patches, disabling unnecessary services, and enforcing secure coding practices can help mitigate the vulnerability.", "Recommendations": "We recommend performing a thorough risk assessment, implementing patches, and disabling unnecessary services to mitigate the vulnerability.", "Conclusions": "In conclusion, the vulnerability poses a significant risk to the Linux kernel and requires prompt attention from security practitioners. Implementing mitigation strategies is crucial to ensure the security of the Linux kernel."}}