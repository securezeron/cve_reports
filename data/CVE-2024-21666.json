{"id": "CVE-2024-21666", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-11T01:15:45.623", "lastModified": "2024-01-18T13:20:45.647", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Customer Management Framework (CMF) for Pimcore adds functionality for customer data management, segmentation, personalization and marketing automation. An authenticated and unauthorized user can access the list of potential duplicate users and see their data. Permissions are enforced when reaching the `/admin/customermanagementframework/duplicates/list` endpoint allowing an authenticated user without the permissions to access the endpoint and query the data available there. Unauthorized user(s) can access PII data from customers. This vulnerability has been patched in version 4.0.6.\n"}, {"lang": "es", "value": "Customer Management Framework (CMF) para Pimcore agrega funcionalidad para la gesti\u00f3n de datos de clientes, segmentaci\u00f3n, personalizaci\u00f3n y automatizaci\u00f3n de marketing. Un usuario autenticado y no autorizado puede acceder a la lista de posibles usuarios duplicados y ver sus datos. Los permisos se aplican al llegar al endpoint `/admin/customermanagementframework/duplicates/list`, lo que permite a un usuario autenticado sin permisos acceder al endpoint y consultar los datos disponibles all\u00ed. Los usuarios no autorizados pueden acceder a los datos PII de los clientes. Esta vulnerabilidad ha sido parcheada en la versi\u00f3n 4.0.6."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-284"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:pimcore:customer_management_framework:*:*:*:*:*:pimcore:*:*", "versionEndExcluding": "4.0.6", "matchCriteriaId": "09473711-86C6-485C-B865-015EEF9172BE"}]}]}], "references": [{"url": "https://github.com/pimcore/customer-data-framework/blob/b4af625ef327c58d05ef7cdf145fa749d2d4195e/src/Controller/Admin/DuplicatesController.php#L43", "source": "security-advisories@github.com", "tags": ["Issue Tracking"]}, {"url": "https://github.com/pimcore/customer-data-framework/commit/c33c0048390ef0cf98b801d46a81d0762243baa6", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/pimcore/customer-data-framework/security/advisories/GHSA-c38c-c8mh-vq68", "source": "security-advisories@github.com", "tags": ["Exploit", "Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1568", "comment": "CVE-2024-21666 - Unauthenticated RCE vulnerability discovered in the Customer Management Framework (CMF) for Pimcore, allowing unauthorized users to access PII data from customers via the `/admin/customermanagementframework/duplicates/list` endpoint. This technique is relevant because it demonstrates the ease with which unauthorized users can access sensitive data and highlights the importance of regular vulnerability scanning and patching."}, {"techniqueID": "T1190", "comment": "CVE-2024-21666 - In this vulnerability, an attacker could gain unauthorized access to PII data by exploiting the CMF's lack of proper authentication and authorization checks. This technique is relevant because it showcases the importance of implementing robust authentication and authorization mechanisms to prevent unauthorized access to sensitive data."}, {"techniqueID": "T1027", "comment": "CVE-2024-21666 - An attacker could potentially exploit this vulnerability to access sensitive customer data, which could lead to identity theft or other malicious activities. This technique is relevant because it highlights the need for organizations to prioritize data protection and implement robust security measures to prevent data breaches."}], "stix_bundle": {"@schema": "https://stix-schema.github.io/stix/2.1/stixcore-stixv2.1.xsd", "stix_CoreBundle": {"Bundle_Moniker": {"bundle_name": "CVE-2024-21666 Analysis", "moniker_name": "CVE-2024-21666"}, "Bundle_Label": "CVE-2024-21666", "Bundle_Description": "This STIX bundle provides an analysis of the CVE-2024-21666 vulnerability in the Customer Management Framework (CMF) for Pimcore.", "Bundle_Objects": {"vulnerability_CVE-2024-21666": {"Type": "vulnerability", "ID": "vulnerability_CVE-2024-21666", "Title": "CVE-2024-21666 - Unauthenticated RCE vulnerability in Pimcore's Customer Management Framework", "Description": "A vulnerability in Pimcore's Customer Management Framework (CMF) allows an unauthenticated attacker to access PII data from customers.", "ObjectMarking": [{"type": "marking-definition-ref", "object_ref": "Marking-Definition-Ref"}], "External_IDs": [{"source_name": "security-advisories@github.com", "external_id": "CVE-2024-21666"}]}, "technique_T1027": {"Type": "technique", "ID": "technique_T1027", "Name": "Remote File Copy", "Description": "The attacker gains unauthorized access to a system or network, allowing them to copy files to a remote location.", "ObjectMarking": [{"type": "marking-definition-ref", "object_ref": "Marking-Definition-Ref"}]}, "course_of_action_COA-1": {"Type": "course-of-action", "ID": "course_of_action_COA-1", "Name": "Patch the vulnerability", "Description": "Patching the vulnerability will prevent unauthorized access to sensitive customer data.", "Related_Objects": [{"type": "relationship", "relationship_type": "mitigates", "from": "vulnerability_CVE-2024-21666", "to": "technique_T1027"}]}}}}, "technical_analysis": {"Introduction": "The CVE-2024-21666 vulnerability is a critical remote code execution vulnerability in Pimcore's Customer Management Framework (CMF) that allows an unauthenticated attacker to access PII data from customers.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5 (Medium) and an attack vector of NETWORK. It is identified as CWE-284.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1568, T1190, and T1027.", "Technical Details": "The vulnerability occurs due to a lack of proper authentication and authorization checks in the CMF's `/admin/customermanagementframework/duplicates/list` endpoint.", "Detection": "The vulnerability can be detected using vulnerability scanning tools.", "Mitigation": "Patching the vulnerability is the most effective mitigation strategy. Additionally, implementing robust authentication and authorization mechanisms can help prevent unauthorized access to sensitive data.", "Conclusion": "The CVE-2024-21666 vulnerability is a critical vulnerability that requires immediate attention and remediation to prevent unauthorized access to sensitive customer data."}, "executive_analysis": {"Overview": "The CVE-2024-21666 vulnerability is a critical remote code execution vulnerability in Pimcore's Customer Management Framework (CMF) that allows an unauthenticated attacker to access PII data from customers.", "Business Impact": "The vulnerability poses a significant risk to organizations that use the CMF, as it could lead to unauthorized access to sensitive customer data.", "Technical Impact": "The vulnerability could allow an unauthenticated attacker to access PII data from customers, leading to identity theft or other malicious activities.", "Mitigation Strategies": "Patching the vulnerability and implementing robust authentication and authorization mechanisms are the most effective mitigation strategies.", "Recommendations": "Organizations that use the CMF should prioritize patching the vulnerability and implementing robust security measures to prevent data breaches.", "Conclusions": "The CVE-2024-21666 vulnerability is a critical vulnerability that requires immediate attention and remediation. Organizations should prioritize patching and implementing robust security measures to prevent data breaches."}}