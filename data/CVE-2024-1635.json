{"id": "CVE-2024-1635", "sourceIdentifier": "secalert@redhat.com", "published": "2024-02-19T22:15:48.647", "lastModified": "2024-04-17T16:15:07.720", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability was found in Undertow. This vulnerability impacts a server that supports the wildfly-http-client protocol. Whenever a malicious user opens and closes a connection with the HTTP port of the server and then closes the connection immediately, the server will end with both memory and open file limits exhausted at some point, depending on the amount of memory available. \r\n\r\nAt HTTP upgrade to remoting, the WriteTimeoutStreamSinkConduit leaks connections if RemotingConnection is closed by Remoting ServerConnectionOpenListener. Because the remoting connection originates in Undertow as part of the HTTP upgrade, there is an external layer to the remoting connection. This connection is unaware of the outermost layer when closing the connection during the connection opening procedure. Hence, the Undertow WriteTimeoutStreamSinkConduit is not notified of the closed connection in this scenario. Because WriteTimeoutStreamSinkConduit creates a timeout task, the whole dependency tree leaks via that task, which is added to XNIO WorkerThread. So, the workerThread points to the Undertow conduit, which contains the connections and causes the leak."}, {"lang": "es", "value": "Se encontr\u00f3 una vulnerabilidad en Undertow. Esta vulnerabilidad afecta a un servidor que admite el protocolo wildfly-http-client. Siempre que un usuario malintencionado abre y cierra una conexi\u00f3n con el puerto HTTP del servidor y luego cierra la conexi\u00f3n inmediatamente, el servidor finalizar\u00e1 con los l\u00edmites de memoria y de archivos abiertos agotados en alg\u00fan momento, dependiendo de la cantidad de memoria disponible. En la actualizaci\u00f3n HTTP a comunicaci\u00f3n remota, WriteTimeoutStreamSinkConduit pierde conexiones si RemotingConnection se cierra mediante Remoting ServerConnectionOpenListener. Debido a que la conexi\u00f3n remota se origina en Undertow como parte de la actualizaci\u00f3n HTTP, existe una capa externa a la conexi\u00f3n remota. Esta conexi\u00f3n desconoce la capa m\u00e1s externa al cerrar la conexi\u00f3n durante el procedimiento de apertura de la conexi\u00f3n. Por lo tanto, Undertow WriteTimeoutStreamSinkConduit no recibe notificaci\u00f3n de la conexi\u00f3n cerrada en este escenario. Debido a que WriteTimeoutStreamSinkConduit crea una tarea de tiempo de espera, todo el \u00e1rbol de dependencia se filtra a trav\u00e9s de esa tarea, que se agrega a XNIO WorkerThread. Entonces, el hilo de trabajo apunta al conducto Undertow, que contiene las conexiones y causa la fuga."}], "metrics": {"cvssMetricV31": [{"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-400"}]}], "references": [{"url": "https://access.redhat.com/errata/RHSA-2024:1674", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1675", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1676", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1677", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1860", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1861", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1862", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1864", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1866", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/security/cve/CVE-2024-1635", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2264928", "source": "secalert@redhat.com"}, {"url": "https://security.netapp.com/advisory/ntap-20240322-0007/", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-1635 - This technique is relevant due to the server's memory and file limit exhaustion vulnerability. An attacker can exploit this by constantly opening and closing connections to the HTTP port, leading to a denial-of-service."}, {"techniqueID": "T1210", "comment": "CVE-2024-1635 - This technique is relevant due to the server's memory and file limit exhaustion vulnerability. An attacker can exploit this by constantly opening and closing connections to the HTTP port, leading to a denial-of-service."}, {"techniqueID": "T1189", "comment": "CVE-2024-1635 - This technique is relevant due to the server's memory and file limit exhaustion vulnerability. An attacker can exploit this by constantly opening and closing connections to the HTTP port, leading to a denial-of-service."}, {"techniqueID": "T1196", "comment": "CVE-2024-1635 - This technique is relevant due to the server's memory and file limit exhaustion vulnerability. An attacker can exploit this by constantly opening and closing connections to the HTTP port, leading to a denial-of-service."}], "stix_bundle": {"bundle": {"name": "CVE-2024-1635 Bundle", "producer_conSUMER": "https://github.com/mitre/cti", "description": "Bundle describing the CVE-2024-1635 vulnerability", "objects": [{"id": "vulnerability--CVE-2024-1635", "type": "vulnerability", "name": "CVE-2024-1635", "description": "A vulnerability was found in Undertow.", "severity": "HIGH", "cvssV3": {"score": 7.5, "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"}}, {"id": "indicator--T1190", "type": "indicator", "name": "HTTP Server Overload", "description": "An indication of potential exploitation of CVE-2024-1635.", "pattern": "Server overload detected"}, {"id": "course_of_action--Avoid_HTTP_Connection_Retry", "type": "course-of-action", "name": "Avoid HTTP Connection Retry", "description": "Avoid retrying HTTP connections to prevent exhaustion of server resources.", "mitigates": ["vulnerability--CVE-2024-1635"]}, {"id": "course_of_action--Monitor_Server_Resource_Utilization", "type": "course-of-action", "name": "Monitor Server Resource Utilization", "description": "Monitor server resource utilization to detect potential exploitation of CVE-2024-1635.", "detects": ["indicator--T1190"]}]}}, "technical_analysis": {"Introduction": "The CVE-2024-1635 vulnerability is a server-side vulnerability in Undertow, a web server, which allows an attacker to exhaust the server's memory and file limits.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 and an attack vector of network.", "Related MITRE ATT&CK Techniques": "T1190, T1210, T1189, and T1196 are relevant techniques due to the server's memory and file limit exhaustion vulnerability.", "Technical Details": "The vulnerability occurs when an attacker constantly opens and closes connections to the HTTP port, leading to a denial-of-service.", "Detection": "Monitor server resource utilization to detect potential exploitation of CVE-2024-1635.", "Mitigation": "Avoid retrying HTTP connections to prevent exhaustion of server resources and monitor server resource utilization to detect potential exploitation.", "Conclusion": "The CVE-2024-1635 vulnerability is a significant threat and requires immediate attention and mitigation measures."}, "executive_analysis": {"Overview": "The CVE-2024-1635 vulnerability is a significant threat to web servers and requires immediate attention and mitigation measures.", "Business Impact": "The vulnerability can lead to a denial-of-service, impacting business operations and potentially causing significant financial losses.", "Technical Impact": "The vulnerability can exhaust server resources, leading to a denial-of-service and potential data loss.", "Mitigation Strategies": "Implement measures to prevent HTTP connection retries and monitor server resource utilization to detect potential exploitation.", "Recommendations": "Recommendations for executives include implementing measures to prevent HTTP connection retries and monitoring server resource utilization to detect potential exploitation.", "Conclusions": "The CVE-2024-1635 vulnerability is a significant threat and requires immediate attention and mitigation measures."}}