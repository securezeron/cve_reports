{"id": "CVE-2024-24823", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-07T18:15:54.870", "lastModified": "2024-02-15T15:41:48.550", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Graylog is a free and open log management platform. Starting in version 4.3.0 and prior to versions 5.1.11 and 5.2.4, reauthenticating with an existing session cookie would re-use that session id, even if for different user credentials. In this case, the pre-existing session could be used to gain elevated access to an existing Graylog login session, provided the malicious user could successfully inject their session cookie into someone else's browser. The complexity of such an attack is high, because it requires presenting a spoofed login screen and injection of a session cookie into an existing browser, potentially through a cross-site scripting attack. No such attack has been discovered. Graylog 5.1.11 and 5.2.4, and any versions of the 6.0 development branch, contain patches to not re-use sessions under any circumstances. Some workarounds are available. Using short session expiration and explicit log outs of unused sessions can help limiting the attack vector. Unpatched this vulnerability exists, but is relatively hard to exploit. A proxy could be leveraged to clear the `authentication` cookie for the Graylog server URL for the `/api/system/sessions` endpoint, as that is the only one vulnerable."}, {"lang": "es", "value": "Graylog es una plataforma de gesti\u00f3n de registros abierta y gratuita. A partir de la versi\u00f3n 4.3.0 y antes de las versiones 5.1.11 y 5.2.4, la nueva autenticaci\u00f3n con una cookie de sesi\u00f3n existente reutilizar\u00eda esa identificaci\u00f3n de sesi\u00f3n, incluso si se trata de credenciales de usuario diferentes. En este caso, la sesi\u00f3n preexistente podr\u00eda usarse para obtener acceso elevado a una sesi\u00f3n de inicio de sesi\u00f3n de Graylog existente, siempre que el usuario malintencionado pueda inyectar con \u00e9xito su cookie de sesi\u00f3n en el navegador de otra persona. La complejidad de un ataque de este tipo es alta, porque requiere presentar una pantalla de inicio de sesi\u00f3n falsificada e inyectar una cookie de sesi\u00f3n en un navegador existente, potencialmente a trav\u00e9s de un ataque de cross-site scripting. No se ha descubierto ning\u00fan ataque de este tipo. Graylog 5.1.11 y 5.2.4, y cualquier versi\u00f3n de la rama de desarrollo 6.0, contienen parches para no reutilizar sesiones bajo ninguna circunstancia. Algunos workarounds est\u00e1n disponibles. El uso de una caducidad corta de la sesi\u00f3n y cierres de sesi\u00f3n expl\u00edcitos de las sesiones no utilizadas pueden ayudar a limitar el vector de ataque. Esta vulnerabilidad no est\u00e1 parcheada, pero es relativamente dif\u00edcil de explotar. Se podr\u00eda aprovechar un proxy para borrar la cookie de \"autenticaci\u00f3n\" para la URL del servidor Graylog para el endpoint \"/api/system/sessions\", ya que ese es el \u00fanico vulnerable."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.5, "impactScore": 5.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-384"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:graylog:graylog:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.3.0", "versionEndExcluding": "5.1.11", "matchCriteriaId": "924684AB-5E3A-4A6B-B607-1DB1124848EE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:graylog:graylog:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.2.0", "versionEndExcluding": "5.2.4", "matchCriteriaId": "4A343880-1202-4534-AE60-F314473EABD9"}]}]}], "references": [{"url": "https://github.com/Graylog2/graylog2-server/commit/1596b749db86368ba476662f23a0f0c5ec2b5097", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/Graylog2/graylog2-server/commit/b93a66353f35a94a4e8f3f75ac4f5cdc5a2d4a6a", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/Graylog2/graylog2-server/security/advisories/GHSA-3xf8-g8gr-g7rh", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "Detecting credential harvesting - A malicious actor could use this vulnerability to harvest credentials and gain unauthorized access to the Graylog server. Implementing monitoring for suspicious login attempts and session management can help detect and mitigate this attack. CVE-2024-24823"}, {"techniqueID": "TA0002", "comment": "Webshell creation - An attacker could use this vulnerability to create a webshell on theGRAYLOG server and gain persistent access. Implementing web application firewalls (WAFs) and configuring Graylog's security settings can help prevent this attack. CVE-2024-24823"}, {"techniqueID": "T1190", "comment": "Exploit public-facing application, 'Graylog server' A malicious actor could use this vulnerability to gain unauthorized access to the Graylog server. Implementing regular security updates and configuring Graylog's security settings can help prevent this attack. CVE-2024-24823"}, {"techniqueID": "T1567.2", "comment": "Proxy, 'Graylog server' A malicious actor could use this vulnerability to authenticate with the Graylog server using a proxy. Implementing proxy filters and configuring Graylog's security settings can help prevent this attack. CVE-2024-24823"}, {"techniqueID": "T1556.1", "comment": "Use Alternate Authentication Material, 'Graylog server' A malicious actor could use this vulnerability to inject session cookies into an existing browser using a cross-site scripting attack. Implementing browser security settings and configuring Graylog's security settings can help prevent this attack. CVE-2024-24823"}], "stix_bundle": {"objects": [{"id": "graylog-CVE-2024-24823", "type": "vulnerability", "description": "Graylog is a free and open log management platform. Starting in version 4.3.0 and prior to versions 5.1.11 and 5.2.4, reauthenticating with an existing session cookie would re-use that session id, even if for different user credentials.", "properties": {"impact": "HIGH", "exploitability": "HIGH", "cve_id": "CVE-2024-24823"}}, {"id": "mitigation-1", "type": "mitigation", "description": "Implement regular security updates and configure Graylog's security settings.", "relation": "mitigates", "object": "graylog-CVE-2024-24823", "labels": ["risk_reduction"]}, {"id": "mitigation-2", "type": "mitigation", "description": "Implement proxy filters and configure Graylog's security settings.", "relation": "mitigates", "object": "graylog-CVE-2024-24823", "labels": ["risk_reduction"]}, {"id": "mitigation-3", "type": "mitigation", "description": "Implement browser security settings and configure Graylog's security settings.", "relation": "mitigates", "object": "graylog-CVE-2024-24823", "labels": ["risk_reduction"]}, {"id": "technique-1", "type": "technique", "description": "Detecting credential harvesting", "relation": "uses", "object": "graylog-CVE-2024-24823", "labels": [" mitre_attackbarbuckle"]}, {"id": "technique-2", "type": "technique", "description": "Webshell creation", "relation": "uses", "object": "graylog-CVE-2024-24823", "labels": [" mitre_attackbarbuckle"]}], "labels": ["graylog", "CVE-2024-24823"]}, "technical_analysis": {"Introduction": "Graylog is a free and open log management platform. Starting in version 4.3.0 and prior to versions 5.1.11 and 5.2.4, reauthenticating with an existing session cookie would re-use that session id, even if for different user credentials.", "Impact and Scope": "The vulnerability allows for unauthorized access to the Graylog server, which could lead to the theft of sensitive information. The attack vector is network-based, and the complexity of the attack is high.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques TA0001, TA0002, T1190, T1567.2, and T1556.1.", "Technical Details": "The vulnerability is caused by the re-use of session ids for different user credentials. This allows an attacker to inject session cookies into an existing browser using a cross-site scripting attack.", "Detection": "Detection can be achieved by monitoring for suspicious login attempts and session management.", "Mitigation": "Mitigation strategies include implementing regular security updates, proxy filters, and browser security settings. Implementing monitoring for suspicious login attempts and session management can also help detect and mitigate this attack.", "Conclusion": "The vulnerability is a high-severity issue that affects the security of the Graylog server. Implementing mitigation strategies and monitoring for suspicious activity can help prevent this attack."}, "executive_analysis": {"Overview": "The vulnerability in Graylog allows for unauthorized access to the server, which could lead to the theft of sensitive information.", "Business Impact": "The vulnerability could have a significant impact on the business, as it could lead to the theft of sensitive information.", "Technical Impact": "The vulnerability could also have a significant technical impact, as it could allow an attacker to gain persistent access to the server.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include implementing regular security updates, proxy filters, and browser security settings.", "Recommendations": "Recommendations include implementing mitigation strategies and monitoring for suspicious activity.", "Conclusions": "The vulnerability is a high-severity issue that affects the security of the Graylog server. Implementing mitigation strategies and monitoring for suspicious activity can help prevent this attack."}}