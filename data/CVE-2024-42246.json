{"id": "CVE-2024-42246", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-07T16:15:47.297", "lastModified": "2024-08-08T14:52:35.353", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet, sunrpc: Remap EPERM in case of connection failure in xs_tcp_setup_socket\n\nWhen using a BPF program on kernel_connect(), the call can return -EPERM. This\ncauses xs_tcp_setup_socket() to loop forever, filling up the syslog and causing\nthe kernel to potentially freeze up.\n\nNeil suggested:\n\n  This will propagate -EPERM up into other layers which might not be ready\n  to handle it. It might be safer to map EPERM to an error we would be more\n  likely to expect from the network system - such as ECONNREFUSED or ENETDOWN.\n\nECONNREFUSED as error seems reasonable. For programs setting a different error\ncan be out of reach (see handling in 4fbac77d2d09) in particular on kernels\nwhich do not have f10d05966196 (\"bpf: Make BPF_PROG_RUN_ARRAY return -err\ninstead of allow boolean\"), thus given that it is better to simply remap for\nconsistent behavior. UDP does handle EPERM in xs_udp_send_request()."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net, sunrpc: reasignar EPERM en caso de falla de conexi\u00f3n en xs_tcp_setup_socket Cuando se usa un programa BPF en kernel_connect(), la llamada puede devolver -EPERM. Esto hace que xs_tcp_setup_socket() se repita indefinidamente, llenando el syslog y provocando que el kernel se congele potencialmente. Neil sugiri\u00f3: Esto propagar\u00e1 -EPERM a otras capas que podr\u00edan no estar listas para manejarlo. Podr\u00eda ser m\u00e1s seguro asignar EPERM a un error que probablemente esperar\u00edamos del sistema de red, como ECONNREFUSED o ENETDOWN. ECONNREFUSED como error parece razonable. Para los programas, configurar un error diferente puede estar fuera de su alcance (consulte el manejo en 4fbac77d2d09), en particular en los n\u00facleos que no tienen f10d05966196 (\"bpf: Make BPF_PROG_RUN_ARRAY return -err en lugar de permitir boolean\"), por lo que es mejor simplemente reasignar para un comportamiento consistente. UDP maneja EPERM en xs_udp_send_request()."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-835"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.17", "versionEndExcluding": "6.1.100", "matchCriteriaId": "0573E395-3D6E-46EA-B0B9-C915C6EF8375"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2", "versionEndExcluding": "6.6.41", "matchCriteriaId": "96AC42B8-D66D-4AC5-B466-E9BA7910FA29"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.9.10", "matchCriteriaId": "AB2E8DEC-CFD5-4C2B-981D-E7E45A36C352"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/626dfed5fa3bfb41e0dffd796032b555b69f9cde", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/d6c686c01c5f12ff8f7264e0ddf71df6cb0d4414", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/f2431e7db0fe0daccb2f06bb0d23740affcd2fa6", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/f388cfd913a2b96c05339a335f365795db1b36b6", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1078", "comment": "CVE-2024-42246 - This vulnerability is related to a Linux kernel issue with potential for high impact and exploitation, potentially causing kernel freezes and performance degradation, making it a relevant technique for exploitation."}, {"techniqueID": "T1027", "comment": "CVE-2024-42246 - The vulnerability affects the Linux kernel, potentially allowing attackers to execute code on the system, making it a relevant technique for privilege escalation and command and control."}, {"techniqueID": "T1552", "comment": "CVE-2024-42246 - The vulnerability affects the Linux kernel, potentially allowing attackers to inject code or commands, making it a relevant technique for execution and pivot."}], "stix_bundle": {"objects": {"vx-attack-pattern": {"id": "vx-attack-pattern--cve-2024-42246", "name": "CVE-2024-42246: Linux Kernel Vulnerability", "description": "A Linux kernel vulnerability with potential for high impact and exploitation.", "modified": "2024-08-20T14:15:00.000Z", "created": "2024-08-20T14:15:00.000Z"}, "vx-kill-chain- Phelps": {"id": "vx-kill-chain--cve-2024-42246", "name": "CVE-2024-42246 Kill Chain", "description": "A kill chain for CVE-2024-42246, including attack patterns and resulting effects.", "modified": "2024-08-20T14:15:00.000Z", "created": "2024-08-20T14:15:00.000Z"}, "vx-incident-response-task": {"id": "vx-incident-response-task--cve-2024-42246", "name": "Incident Response Task for CVE-2024-42246", "description": "Incident response tasks for CVE-2024-42246, including detection and response procedures.", "modified": "2024-08-20T14:15:00.000Z", "created": "2024-08-20T14:15:00.000Z"}, "vx-indicator": {"id": "vx-indicator--cve-2024-42246", "name": "Indicator for CVE-2024-42246", "description": "Indicator for CVE-2024-42246, including network traffic and file signatures.", "modified": "2024-08-20T14:15:00.000Z", "created": "2024-08-20T14:15:00.000Z"}, "vx-observable-data- Feed": {"id": "vx-observable-data-feed--cve-2024-42246", "name": "Observable Data Feed for CVE-2024-42246", "description": "Observable data feed for CVE-2024-42246, including network traffic and file signatures.", "modified": "2024-08-20T14:15:00.000Z", "created": "2024-08-20T14:15:00.000Z"}}, "relationships": {"vx-attack-pattern": {"vx-kill-chain": {"start": "vx-attack-pattern--cve-2024-42246", "end": "vx-kill-chain--cve-2024-42246", "type": "related_to"}, "vx-incident-response-task": {"start": "vx-attack-pattern--cve-2024-42246", "end": "vx-incident-response-task--cve-2024-42246", "type": "related_to"}, "vx-indicator": {"start": "vx-attack-pattern--cve-2024-42246", "end": "vx-indicator--cve-2024-42246", "type": "related_to"}, "vx-observable-data-feed": {"start": "vx-attack-pattern--cve-2024-42246", "end": "vx-observable-data-feed--cve-2024-42246", "type": "related_to"}}, "vx-kill-chain": {"vx-incident-response-task": {"start": "vx-kill-chain--cve-2024-42246", "end": "vx-incident-response-task--cve-2024-42246", "type": "related_to"}}}}, "technical_analysis": {"Introduction": "The CVE-2024-42246 is a Linux kernel vulnerability that allows attackers to potentially execute code on the system, making it a significant threat to the affected systems.", "Impact and Scope": "The vulnerability has a CVSS score of 5.5, affecting Linux kernel versions 4.17 to 6.9.10, and has a high potential for exploitation.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to techniques T1078, T1027, and T1552, as attackers can use these techniques to exploit the vulnerability.", "Technical Details": "The vulnerability affects the Linux kernel's sunrpc module, allowing attackers to inject code or commands, and potentially causing kernel freezes and performance degradation.", "Detection": "Detection methods include monitoring network traffic for suspicious patterns and file signatures, as well as implementing kernel-level monitoring tools.", "Mitigation": "Mitigation strategies include patching the affected systems, implementing kernel-level controls, and implementing network traffic monitoring tools.", "Conclusion": "The CVE-2024-42246 is a significant vulnerability that requires immediate attention and mitigation to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-42246 is a Linux kernel vulnerability that has significant business and technical implications.", "Business Impact": "The vulnerability can cause significant business disruptions, data breaches, and financial losses if not properly mitigated.", "Technical Impact": "The vulnerability affects Linux kernel versions 4.17 to 6.9.10, making it a significant technical issue for organizations using these kernel versions.", "Mitigation Strategies": "Immediate patching of affected systems, implementing kernel-level controls, and implementing network traffic monitoring tools are recommended mitigation strategies.", "Recommendations": "Executive-level buy-in is necessary for prompt patching and mitigation, as well as prioritizing technical oversight and monitoring for affected systems.", "Conclusions": "The CVE-2024-42246 is a critical vulnerability that requires immediate attention and mitigation to prevent exploitation and minimize business impacts."}}