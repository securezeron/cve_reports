{"id": "CVE-2024-32966", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-01T06:15:21.277", "lastModified": "2024-05-01T13:01:51.263", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Static Web Server (SWS) is a tiny and fast production-ready web server suitable to serve static web files or assets. In affected versions if directory listings are enabled for a directory that an untrusted user has upload privileges for, a malicious file name like `<img src=x onerror=alert(1)>.txt` will allow JavaScript code execution in the context of the web server\u2019s domain. SWS generally does not perform escaping of HTML entities on any values inserted in the directory listing. At the very least `file_name` and `current_path` could contain malicious data however. `file_uri` could also be malicious but the relevant scenarios seem to be all caught by hyper. For any web server that allow users to upload files or create directories under a name of their choosing this becomes a stored Cross-site Scripting vulnerability. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Static Web Server (SWS) es un peque\u00f1o y r\u00e1pido servidor web listo para producci\u00f3n, adecuado para servir archivos o activos web est\u00e1ticos. En las versiones afectadas, si los listados de directorios est\u00e1n habilitados para un directorio para el que un usuario que no es de confianza tiene privilegios de carga, un nombre de archivo malicioso como `.txt` permitir\u00e1 la ejecuci\u00f3n de c\u00f3digo JavaScript en el contexto de el dominio del servidor web. SWS generalmente no realiza escapes de entidades HTML en ning\u00fan valor insertado en la lista del directorio. Sin embargo, al menos `file_name` y `current_path` podr\u00edan contener datos maliciosos. `file_uri` tambi\u00e9n podr\u00eda ser malicioso, pero todos los escenarios relevantes parecen ser detectados por hyper. Para cualquier servidor web que permita a los usuarios cargar archivos o crear directorios con el nombre de su elecci\u00f3n, esto se convierte en una vulnerabilidad de Cross Site Scripting almacenada. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}, {"lang": "en", "value": "CWE-80"}]}], "references": [{"url": "https://github.com/static-web-server/static-web-server/security/advisories/GHSA-rwfq-v4hq-h7fg", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-32966 - This technique involves static file inclusion, which can be used to execute malicious code in the context of the web server\u2019s domain."}, {"techniqueID": "T1499", "comment": "CVE-2024-32966 - This technique involves cross-site scripting (XSS), which can be used to inject malicious code into a web page."}, {"techniqueID": "T1498", "comment": "CVE-2024-32966 - This technique involves directory traversal, which can be used to access and manipulate files on the web server."}, {"techniqueID": "T1040", "comment": "CVE-2024-32966 - This technique involves web shell upload, which can be used to upload malicious code to the web server."}, {"techniqueID": "T1038", "comment": "CVE-2024-32966 - This technique involves steganography, which can be used to hide malicious code within a web page."}], "stix_bundle": {"stix_version": "2.1", "objects": [{"id": "vulnerability--cve-2024-32966", "type": "vulnerability", "label": "CVE-2024-32966", "description": "A vulnerability in the Static Web Server (SWS) allows an attacker to execute malicious code in the context of the web server's domain.", "published": "2024-05-01T06:15:21.277", "last_modified": "2024-05-01T13:01:51.263", " severity": "MEDIUM", "cvss_v3": {"version": "3.1", "vector_string": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L"}, "references": [{"url": "https://github.com/static-web-server/static-web-server/security/advisories/GHSA-rwfq-v4hq-h7fg", "source": "security-advisories@github.com"}]}, {"id": "indicator--cve-2024-32966-1", "type": "indicator", "label": "Untrusted User Directory Listing Enablement", "description": "Detection of directory listing enablement for untrusted users", "pattern": "directory listing enabled for untrusted user", "generated": "2024-05-01T06:15:21.277", "valid_from": "2024-05-01T06:15:21.277", "valid_until": "2024-05-01T13:01:51.263"}, {"id": "course_of_action--cve-2024-32966-1", "type": "course_of_action", "label": "Disable Directory Listing for Untrusted Users", "description": "Disable directory listing for untrusted users to prevent malicious code execution", "analysis": ["disable directory listing"], "recommended_action": "Disable directory listing for untrusted users"}], "relationships": [{"scheme": "indicate", "object_ref": "vulnerability--cve-2024-32966", "object": "indicator--cve-2024-32966-1"}, {"scheme": "mitigates", "object_ref": "vulnerability--cve-2024-32966", "object": "course_of_action--cve-2024-32966-1"}]}, "technical_analysis": {"Introduction": "This vulnerability allows an attacker to execute malicious code in the context of the web server's domain by enabling directory listing for untrusted users.", "Impact and Scope": "The impact of this vulnerability is medium, with a CVSS score of 5.8, and the scope is widespread, affecting any web server that allows users to upload files or create directories.", "Related MITRE ATT&CK Techniques": "T1190, T1499, T1498, T1040, and T1038", "Technical Details": "The vulnerability arises from the web server's lack of escaping of HTML entities, allowing an attacker to inject malicious code into a web page.", "Detection": "Detection of this vulnerability requires monitoring for directory listing enablement for untrusted users.", "Mitigation": "Disable directory listing for untrusted users and ensure proper input validation and sanitization.", "Conclusion": "This vulnerability requires immediate attention, as it can lead to the execution of malicious code in the context of the web server's domain."}, "executive_analysis": {"Overview": "This vulnerability allows an attacker to execute malicious code in the context of the web server's domain.", "Business Impact": "This vulnerability can have a significant business impact, as it can lead to the execution of malicious code in the context of the web server's domain.", "Technical Impact": "The technical impact of this vulnerability is the execution of malicious code in the context of the web server's domain.", "Mitigation Strategies": "Disable directory listing for untrusted users and ensure proper input validation and sanitization.", "Recommendations": "Ensure proper input validation and sanitization, and disable directory listing for untrusted users.", "Conclusions": "This vulnerability requires immediate attention, as it can lead to the execution of malicious code in the context of the web server's domain."}}