{"id": "CVE-2024-34353", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-14T15:38:43.910", "lastModified": "2024-05-14T16:17:24.107", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The matrix-sdk-crypto crate, part of the Matrix Rust SDK project, is an implementation of a Matrix end-to-end encryption state machine in Rust. In Matrix, the server-side `key backup` stores encrypted copies of Matrix message keys. This facilitates key sharing between a user's devices and provides a redundant copy in case all devices are lost. The key backup uses asymmetric\ncryptography, with each server-side key backup assigned a unique public-private key pair. Due to a logic bug introduced in commit 71136e44c03c79f80d6d1a2446673bc4d53a2067, matrix-sdk-crypto version 0.7.0 will sometimes log the private part of the backup key pair to Rust debug logs (using the `tracing` crate). This issue has been resolved in matrix-sdk-crypto version 0.7.1. No known workarounds are available."}, {"lang": "es", "value": "La caja Matrix-sdk-crypto, parte del proyecto Matrix Rust SDK, es una implementaci\u00f3n de una m\u00e1quina de estado de cifrado de extremo a extremo de Matrix en Rust. En Matrix, la \"copia de seguridad de claves\" del lado del servidor almacena copias cifradas de las claves de mensajes de Matrix. Esto facilita el intercambio de claves entre los dispositivos de un usuario y proporciona una copia redundante en caso de que se pierdan todos los dispositivos. La copia de seguridad de claves utiliza criptograf\u00eda asim\u00e9trica, y a cada copia de seguridad de claves del lado del servidor se le asigna un par de claves p\u00fablica-privada \u00fanico. Debido a un error l\u00f3gico introducido en el commit 71136e44c03c79f80d6d1a2446673bc4d53a2067, la versi\u00f3n 0.7.0 de Matrix-sdk-crypto a veces registrar\u00e1 la parte privada del par de claves de respaldo en los registros de depuraci\u00f3n de Rust (usando la caja de \"rastreo\"). Este problema se resolvi\u00f3 en la versi\u00f3n 0.7.1 de Matrix-sdk-crypto. No hay workarounds conocidos disponibles."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-532"}]}], "references": [{"url": "https://crates.io/crates/matrix-sdk-crypto/0.7.1", "source": "security-advisories@github.com"}, {"url": "https://github.com/matrix-org/matrix-rust-sdk/commit/71136e44c03c79f80d6d1a2446673bc4d53a2067", "source": "security-advisories@github.com"}, {"url": "https://github.com/matrix-org/matrix-rust-sdk/commit/fa10bbb5dd0f9120a51aa1854cec752e25790bb0", "source": "security-advisories@github.com"}, {"url": "https://github.com/matrix-org/matrix-rust-sdk/releases/tag/matrix-sdk-crypto-0.7.1", "source": "security-advisories@github.com"}, {"url": "https://github.com/matrix-org/matrix-rust-sdk/security/advisories/GHSA-9ggc-845v-gcgv", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1003.002", "comment": "CVE-2024-34353: Matrix-sdk-crypto private key logging - An attacker can potentially obtain sensitive information, including private keys, by exploiting this bug. This technique is relevant and can be mitigated by implementing robust key management and logging policies."}, {"techniqueID": "T1022.003", "comment": "CVE-2024-34353: Matrix-sdk-crypto private key logging - An attacker can potentially obtain sensitive information, including private keys, by exploiting this bug. This technique is relevant and can be mitigated by implementing robust threat hunting and incident response procedures."}, {"techniqueID": "T1190", "comment": "CVE-2024-34353: Matrix-sdk-crypto private key logging - An attacker can potentially obtain sensitive information, including private keys, by exploiting this bug. This technique is relevant and can be mitigated by implementing robust access control and segmentation policies."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve-2024-34353", "created_by_ref": "https://example.com/author", "created": "2024-05-14T15:38:43.910", "modified": "2024-05-14T16:17:24.107", "description": "Matrix-sdk-crypto private key logging vulnerability", "objects": {"vulnerability": {"type": "vulnerability", "id": "https://example.com/vulnerability/cve-2024-34353", "created_by_ref": "https://example.com/author", "created": "2024-05-14T15:38:43.910", "modified": "2024-05-14T16:17:24.107", "name": "CVE-2024-34353: Matrix-sdk-crypto private key logging", "description": "The matrix-sdk-crypto crate, part of the Matrix Rust SDK project, is an implementation of a Matrix end-to-end encryption state machine in Rust. In Matrix, the server-side key backup stores encrypted copies of Matrix message keys.", "cve_data_var": "CVE-2024-34353", "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"}, "technique": {"type": "attack-pattern", "id": "https://example.com/technique/T1003.002", "created_by_ref": "https://example.com/author", "created": "2024-05-14T15:38:43.910", "modified": "2024-05-14T16:17:24.107", "name": "Os Credential Dumping", "description": "An attacker can dump os credentials to access sensitive information", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "kill_chain_phase_name": "Initial Access"}]}, "indicator": {"type": "indicator", "id": "https://example.com/indicator/cve-2024-34353-indicator", "created_by_ref": "https://example.com/author", "created": "2024-05-14T15:38:43.910", "modified": "2024-05-14T16:17:24.107", "name": "CVE-2024-34353 Indicator", "description": "This indicator is related to the CVE-2024-34353 vulnerability", "pattern_type": "url", "pattern": "https://example.com/cve-2024-34353"}}, "relationship": {" Attack Pattern": {"relationship_type": "related-to", "object_ref": "https://example.com/technique/T1003.002"}, "Indicator": {"relationship_type": "related-to", "object_ref": "https://example.com/indicator/cve-2024-34353-indicator"}}}, "technical_analysis": {"Introduction": "This vulnerability allows an attacker to obtain sensitive information, including private keys, by exploiting a bug in the matrix-sdk-crypto crate.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to access sensitive information. The scope of this vulnerability is limited to the matrix-sdk-crypto crate.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are Os Credential Dumping (T1003.002) and Credential Dumping (T1003).", "Technical Details": "The vulnerability occurs when the matrix-sdk-crypto crate logs private keys to the debug log.", "Detection": "This vulnerability can be detected by monitoring the debug log for private key logs.", "Mitigation": "This vulnerability can be mitigated by implementing robust key management and logging policies.", "Conclusion": "In conclusion, this vulnerability is a high-severity vulnerability that allows an attacker to access sensitive information. It is essential to implement robust key management and logging policies to mitigate this vulnerability."}, "executive_analysis": {"Overview": "This vulnerability allows an attacker to obtain sensitive information, including private keys, by exploiting a bug in the matrix-sdk-crypto crate.", "Business Impact": "The business impact of this vulnerability is high, as it allows an attacker to access sensitive information.", "Technical Impact": "The technical impact of this vulnerability is high, as it allows an attacker to access sensitive information.", "Mitigation Strategies": "The mitigation strategy for this vulnerability is to implement robust key management and logging policies.", "Recommendations": "It is recommended that organizations review and implement robust key management and logging policies to mitigate this vulnerability.", "Conclusions": "In conclusion, this vulnerability is a high-severity vulnerability that allows an attacker to access sensitive information. It is essential to implement robust key management and logging policies to mitigate this vulnerability."}}