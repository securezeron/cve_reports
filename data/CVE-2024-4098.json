{"id": "CVE-2024-4098", "sourceIdentifier": "security@wordfence.com", "published": "2024-06-20T07:15:41.933", "lastModified": "2024-06-20T12:43:25.663", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Shariff Wrapper plugin for WordPress is vulnerable to Local File Inclusion in versions up to, and including, 4.6.13 via the shariff3uu_fetch_sharecounts function. This allows unauthenticated attackers to include and execute arbitrary files on the server, allowing the execution of any PHP code in those files. This can be used to bypass access controls, obtain sensitive data, or achieve code execution in cases where images and other \u201csafe\u201d file types can be uploaded and included."}, {"lang": "es", "value": "El complemento Shariff Wrapper para WordPress es vulnerable a la inclusi\u00f3n de archivos locales en versiones hasta la 4.6.13 incluida a trav\u00e9s de la funci\u00f3n shariff3uu_fetch_sharecounts. Esto permite a atacantes no autenticados incluir y ejecutar archivos arbitrarios en el servidor, permitiendo la ejecuci\u00f3n de cualquier c\u00f3digo PHP en esos archivos. Esto se puede utilizar para eludir los controles de acceso, obtener datos confidenciales o lograr la ejecuci\u00f3n de c\u00f3digo en los casos en que se puedan cargar e incluir im\u00e1genes y otros tipos de archivos \"seguros\"."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "references": [{"url": "https://plugins.trac.wordpress.org/browser/shariff/trunk/shariff.php#L410", "source": "security@wordfence.com"}, {"url": "https://plugins.trac.wordpress.org/changeset/3103137", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/f49fba00-c576-4a1a-8b0b-9ebed3e3d090?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-4098 - This vulnerability allows an attacker to include and execute arbitrary files on the server, which can be used to bypass access controls, obtain sensitive data, or achieve code execution."}, {"techniqueID": "T1210", "comment": "CVE-2024-4098 - This technique can be used to include files with malicious content, allowing the attacker to execute arbitrary code on the server."}, {"techniqueID": "T1555", "comment": "CVE-2024-4098 - This technique can be used to obtain sensitive data by including a file that contains sensitive information."}, {"techniqueID": "T1499", "comment": "CVE-2024-4098 - This vulnerability can be used to achieve code execution by including a file containing malicious code."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle--d2ce5c5e-4a3a-4ca0-9b9d-45ab46f6f8b5", "created_by_ref": "http://stix.example.com/person--4f6ad6d3-d0d3-4564-aed4-1f1e6b90a15b", "created": "2023-09-12T14:30:00.000000", "modified": "2023-09-12T14:30:00.000000", "name": "CVE-2024-4098 Exploitation and Defense", "description": "This STIX 2.1 bundle represents the exploitation and defense strategies for CVE-2024-4098.", "objects": {"vulnerability": {"type": "vulnerability", "id": "vulnerability--73c6f8e8-7451-4221-8d47-17a8d42f11e9", "created_by_ref": "http://stix.example.com/person--4f6ad6d3-d0d3-4564-aed4-1f1e6b90a15b", "created": "2023-09-12T14:30:00.000000", "modified": "2023-09-12T14:30:00.000000", "name": "CVE-2024-4098", "description": "The Shariff Wrapper plugin for WordPress is vulnerable to Local File Inclusion in versions up to, and including, 4.6.13 via the shariff3uu_fetch_sharecounts function.", "<cvss": {"id": "cvss--4c5e9f1b-62d5-4ee9-9e96-7a77dcf1d93a", "version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}}, "attack_pattern": {"type": "attack-pattern", "id": "attack_pattern--4a1c9e9a-4a8b-4c83-ac3c-5e3a3494f4a3", "created_by_ref": "http://stix.example.com/person--4f6ad6d3-d0d3-4564-aed4-1f1e6b90a15b", "created": "2023-09-12T14:30:00.000000", "modified": "2023-09-12T14:30:00.000000", "name": "Local File Inclusion", "description": "This attack pattern involves including local files to bypass security controls or achieve code execution."}, "course_of_action": {"type": "course-of-action", "id": "course_of_action--41f3c52a-4f09-44b4-af85-4c3e4c0c4b16", "created_by_ref": "http://stix.example.com/person--4f6ad6d3-d0d3-4564-aed4-1f1e6b90a15b", "created": "2023-09-12T14:30:00.000000", "modified": "2023-09-12T14:30:00.000000", "name": "Update Shariff Wrapper Plugin", "description": "Update the Shariff Wrapper plugin to version 4.6.14 or higher to mitigate this vulnerability."}, "indicator": {"type": "indicator", "id": "indicator--3f6b9d7a-4478-4b09-9fe2-2c5c4a4b45b5", "created_by_ref": "http://stix.example.com/person--4f6ad6d3-d0d3-4564-aed4-1f1e6b90a15b", "created": "2023-09-12T14:30:00.000000", "modified": "2023-09-12T14:30:00.000000", "name": "Unusual File Inclusions", "description": "Monitor for unusual file inclusions on the server to detect potential exploitation of this vulnerability."}}, "relationships": {"contains": [{"from": "bundle--d2ce5c5e-4a3a-4ca0-9b9d-45ab46f6f8b5", "to": "vulnerability--73c6f8e8-7451-4221-8d47-17a8d42f11e9"}, {"from": "bundle--d2ce5c5e-4a3a-4ca0-9b9d-45ab46f6f8b5", "to": "attack_pattern--4a1c9e9a-4a8b-4c83-ac3c-5e3a3494f4a3"}, {"from": "bundle--d2ce5c5e-4a3a-4ca0-9b9d-45ab46f6f8b5", "to": "course_of_action--41f3c52a-4f09-44b4-af85-4c3e4c0c4b16"}, {"from": "bundle--d2ce5c5e-4a3a-4ca0-9b9d-45ab46f6f8b5", "to": "indicator--3f6b9d7a-4478-4b09-9fe2-2c5c4a4b45b5"}]}}}, "technical_analysis": {"Introduction": "The CVE-2024-4098 vulnerability is a Local File Inclusion vulnerability in the Shariff Wrapper plugin for WordPress.", "Impact and Scope": "This vulnerability allows an attacker to include and execute arbitrary files on the server, which can be used to bypass access controls, obtain sensitive data, or achieve code execution.", "Related MITRE ATT&CK Techniques": "T1190, T1210, T1555, T1499", "Technical Details": "The vulnerability is caused by the shariff3uu_fetch_sharecounts function in the Shariff Wrapper plugin, which allows attackers to include and execute arbitrary files on the server.", "Detection": "Monitor for unusual file inclusions on the server to detect potential exploitation of this vulnerability.", "Mitigation": "Update the Shariff Wrapper plugin to version 4.6.14 or higher to mitigate this vulnerability.", "Conclusion": "The CVE-2024-4098 vulnerability is a critical vulnerability that allows attackers to include and execute arbitrary files on the server. It is important to update the Shariff Wrapper plugin to version 4.6.14 or higher to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-4098 vulnerability is a critical vulnerability in the Shariff Wrapper plugin for WordPress that allows attackers to include and execute arbitrary files on the server.", "Business Impact": "This vulnerability can be used to bypass access controls, obtain sensitive data, or achieve code execution, which can have significant business impacts.", "Technical Impact": "The vulnerability is caused by a Local File Inclusion vulnerability in the Shariff Wrapper plugin, which allows attackers to include and execute arbitrary files on the server.", "Mitigation Strategies": "Update the Shariff Wrapper plugin to version 4.6.14 or higher, monitor for unusual file inclusions on the server, and implement additional security controls.", "Recommendations": "Recommend that all organizations that use the Shariff Wrapper plugin update it to version 4.6.14 or higher.", "Conclusions": "The CVE-2024-4098 vulnerability is a critical vulnerability that requires immediate attention and action. It is important to update the Shariff Wrapper plugin to version 4.6.14 or higher to mitigate this vulnerability."}}