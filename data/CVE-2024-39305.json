{"id": "CVE-2024-39305", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-01T21:15:04.520", "lastModified": "2024-07-02T12:09:16.907", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Envoy is a cloud-native, open source edge and service proxy. Prior to versions 1.30.4, 1.29.7, 1.28.5, and 1.27.7. Envoy references already freed memory when route hash policy is configured with cookie attributes. Note that this vulnerability has been fixed in the open as the effect would be immediately apparent if it was configured. Memory allocated for holding attribute values is freed after configuration was parsed. During request processing Envoy will attempt to copy content of de-allocated memory into request cookie header. This can lead to arbitrary content of Envoy's memory to be sent to the upstream service or abnormal process termination. This vulnerability is fixed in Envoy versions v1.30.4, v1.29.7, v1.28.5, and v1.27.7. As a workaround, do not use cookie attributes in route action hash policy."}, {"lang": "es", "value": "Envoy es un proxy de servicio y borde de c\u00f3digo abierto, nativo de la nube. Antes de las versiones 1.30.4, 1.29.7, 1.28.5 y 1.27.7. Envoy hace referencia a la memoria ya liberada cuando la pol\u00edtica de hash de ruta se configura con atributos de cookies. Tenga en cuenta que esta vulnerabilidad se ha solucionado abiertamente, ya que el efecto ser\u00eda inmediatamente evidente si se configurara. La memoria asignada para contener valores de atributos se libera despu\u00e9s de analizar la configuraci\u00f3n. Durante el procesamiento de la solicitud, Envoy intentar\u00e1 copiar el contenido de la memoria desasignada en el encabezado de la cookie de solicitud. Esto puede provocar que el contenido arbitrario de la memoria de Envoy se env\u00ede al servicio ascendente o que el proceso finalice anormalmente. Esta vulnerabilidad se solucion\u00f3 en las versiones de Envoy v1.30.4, v1.29.7, v1.28.5 y v1.27.7. Como workaround, no utilice atributos de cookies en la pol\u00edtica hash de acci\u00f3n de ruta."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 2.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-416"}]}], "references": [{"url": "https://github.com/envoyproxy/envoy/commit/02a06681fbe0e039b1c7a9215257a7537eddb518", "source": "security-advisories@github.com"}, {"url": "https://github.com/envoyproxy/envoy/commit/50b384cb203a1f2894324cbae64b6d9bc44cce45", "source": "security-advisories@github.com"}, {"url": "https://github.com/envoyproxy/envoy/commit/99b6e525fb9f6f6f19a0425f779bc776f121c7e5", "source": "security-advisories@github.com"}, {"url": "https://github.com/envoyproxy/envoy/commit/b7f509607ad860fd6a63cde4f7d6f0197f9f63bb", "source": "security-advisories@github.com"}, {"url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-fp35-g349-h66f", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0003", "comment": "CVE-2024-39305 - This vulnerability is related to the Error Handling technique, which includes unintended exposure of sensitive information. Defending against this involves implementing proper error handling and logging mechanisms to prevent the unauthorized exposure of sensitive data."}, {"techniqueID": "TA0005", "comment": "CVE-2024-39305 - This vulnerability is also related to the Resource Discovery technique, which involves identifying and exploiting network resources to gain further access. Defending against this involves implementing network access controls and monitoring to detect and prevent unauthorized network activity."}, {"techniqueID": "TA0006", "comment": "CVE-2024-39305 - This vulnerability is related to the Command and Control technique, which involves establishing communication channels between compromised systems and malicious actors. Defending against this involves implementing network segmentation and monitoring to detect and prevent unauthorized communication."}], "stix_bundle": {"Bundle": {"$schema": "https://stix2.io/schema/2.1/stix-core.owl#", "type": "bundle", "id": "bundle--a5c7a87a-7ef7-4c93-a84c-0a47c63bc73e", "created_by_ref": "identity--c6c8f89f-8c31-46d6-97d5-93f8a1e6f82c", "created": "2022-12-22T15:45:00.000", "modified": "2022-12-22T15:45:00.000", "objects": [{"type": "vulnerability", "id": "vulnerability--a5c7a87a-7ef7-4c93-a84c-0a47c63bc73e", "created_by_ref": "identity--c6c8f89f-8c31-46d6-97d5-93f8a1e6f82c", "created": "2022-12-22T15:45:00.000", "modified": "2022-12-22T15:45:00.000", "name": "CVE-2024-39305", "description": "Envoy references already freed memory when route hash policy is configured with cookie attributes.", "severity": 3.5}, {"type": "courses-of-action", "id": "courses-of-action--a5c7a87a-7ef7-4c93-a84c-0a47c63bc737", "created_by_ref": "identity--c6c8f89f-8c31-46d6-97d5-93f8a1e6f82c", "created": "2022-12-22T15:45:00.000", "modified": "2022-12-22T15:45:00.000", "title": "MITRE ATT&CK Techniques 1", "description": "Implement network segmentation and monitoring to detect and prevent unauthorized communication.", "effective_at": "2024-07-01T21:15:04.520", "related_suggested_actions": [{"relation": " Mitigates", "target_ref": "technique--a5c7a87a-7ef7-4c93-a84c-0a47c63bc73d"}]}, {"type": "technique", "id": "technique--a5c7a87a-7ef7-4c93-a84c-0a47c63bc73d", "created_by_ref": "identity--c6c8f89f-8c31-46d6-97d5-93f8a1e6f82c", "created": "2022-12-22T15:45:00.000", "modified": "2022-12-22T15:45:00.000", "name": "TA0003", "description": "Error Handling", "phase": "pre-attack", "background_ref": "identity--c6c8f89f-8c31-46d6-97d5-93f8a1e6f82c"}], " relationships": [{"id": "associated-with", "start": "vulnerability--a5c7a87a-7ef7-4c93-a84c-0a47c63bc73e", "end": "technique--a5c7a87a-7ef7-4c93-a84c-0a47c63bc73d", "type": "associated-with"}]}}, "technical_analysis": {"Introduction": "CVE-2024-39305 is a vulnerability in Envoy that allows an attacker to expose sensitive information. This analysis provides an in-depth look at the technical details of the vulnerability.", "Impact and Scope": "CVE-2024-39305 has a CVSS score of 6.5 with a medium severity rating. It affects Envoy versions 1.30.4, 1.29.7, 1.28.5, and 1.27.7.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the Error Handling, Resource Discovery, and Command and Control techniques.", "Technical Details": "CVE-2024-39305 involves Envoy referencing already freed memory when route hash policy is configured with cookie attributes.", "Detection": "Detecting this vulnerability involves monitoring for network activity that suggests an attacker is attempting to exploit it.", "Mitigation": "Mitigating this vulnerability involves implementing network segmentation and monitoring to detect and prevent unauthorized network activity.", "Conclusion": "In conclusion, CVE-2024-39305 is a significant vulnerability that requires prompt attention. Implementing network segmentation and monitoring is crucial to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-39305 is a vulnerability in Envoy that exposes sensitive information.", "Business Impact": "The business impact of this vulnerability is significant, as it allows an attacker to gain unauthorized access to sensitive data.", "Technical Impact": "The technical impact of this vulnerability is the exposure of sensitive information, which can be used to further compromise the system.", "Mitigation Strategies": "Implementing network segmentation and monitoring is crucial to prevent exploitation.", "Recommendations": "Executives should take immediate action to address this vulnerability by patching affected systems and implementing network segmentation and monitoring.", "Conclusions": "In conclusion, CVE-2024-39305 is a significant vulnerability that requires prompt attention from executives."}}