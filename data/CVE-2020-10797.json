{"id": "CVE-2020-10797", "sourceIdentifier": "cve@mitre.org", "published": "2020-04-29T14:15:16.967", "lastModified": "2020-05-01T14:42:33.410", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An XSS vulnerability resides in the hostname field of the diag_ping.php page in pfsense before 2.4.5 version. After passing inputs to the command and executing this command, the $result variable is not sanitized before it is printed."}, {"lang": "es", "value": "Una vulnerabilidad de tipo XSS reside en el campo hostname de la p\u00e1gina diag_ping.php en pfsense versiones anteriores a 2.4.5. Despu\u00e9s de pasar las entradas al comando y ejecutar este comando, la variable $result  no es saneada antes de ser impresa."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:netgate:pfsense:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.4.5", "matchCriteriaId": "D211001F-1AF6-453C-A997-D45C099B5895"}]}]}], "references": [{"url": "https://docs.netgate.com/pfsense/en/latest/releases/2-4-5-new-features-and-changes.html", "source": "cve@mitre.org", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "https://github.com/pfsense/pfsense/commit/cc3990a334059018b004c91eeb66c147d8afe83d", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://redmine.pfsense.org/issues/10355", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0040 - Client-Side Input Validation", "comment": "CVE-2020-10797 - The attacker can inject arbitrary HTML/CSS/JavaScript into the hostname field of the diag_ping.php page, which can lead to XSS. This technique is relevant to this vulnerability as it is an example of client-side input validation being bypassed."}, {"techniqueID": "TA0016 - Cross-Site Scripting", "comment": "CVE-2020-10797 - An attacker can inject arbitrary HTML/CSS/JavaScript into the hostname field of the diag_ping.php page, which can lead to XSS. This technique is directly applied to this vulnerability, as the attacker injects malicious scripts into the website."}, {"techniqueID": "TA0027 - Command Injection", "comment": "CVE-2020-10797 - The attacker can inject arbitrary commands into the hostname field of the diag_ping.php page, which can lead to command injection. This technique is relevant to this vulnerability as it is an example of command injection being used to exploit the vulnerability."}], "stix_bundle": {"bundle_id": "CVE-2020-10797", "producer_id": "cve@mitre.org", "package_id": "CVE-2020-10797", "objects": [{"id": "CVE-2020-10797", "type": "vulnerability", "created_by_ref": "cve@mitre.org", "created": "2020-04-29T14:15:16.967", "published": "2020-04-29T14:15:16.967", "modified": "2020-05-01T14:42:33.410", "name": "CVE-2020-10797", "description": "An XSS vulnerability resides in the hostname field of the diag_ping.php page in pfsense before 2.4.5 version. After passing inputs to the command and executing this command, the $result variable is not sanitized before it is printed.", "severity": "medium", "cvssv3": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"}, "cvssv2": {"vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N"}, "references": [{"id": "CVE-2020-10797", "source": "cve@mitre.org", "url": "https://docs.netgate.com/pfsense/en/latest/releases/2-4-5-new-features-and-changes.html"}]}, {"id": "T1046", "type": "attack-pattern", "created_by_ref": "cve@mitre.org", "created": "2020-04-29T14:15:16.967", "published": "2020-04-29T14:15:16.967", "modified": "2020-05-01T14:42:33.410", "name": "T1046", "description": "Cross-Site Scripting (XSS)", ".kill_chain_phases": [{"kill_chain_name": "Attack Kill Chain", "phase_name": "Actions on the Objective"}]}, {"id": "T1055", "type": "attack-pattern", "created_by_ref": "cve@mitre.org", "created": "2020-04-29T14:15:16.967", "published": "2020-04-29T14:15:16.967", "modified": "2020-05-01T14:42:33.410", "name": "T1055", "description": "Command Injection", "kill_chain_phases": [{"kill_chain_name": "Attack Kill Chain", "phase_name": "Initial Access"}]}], "relationships": [{"id": "1", "type": "has-part"}, {"id": "2", "from": "CVE-2020-10797", "to": "T1046", "type": "related-to"}, {"id": "3", "from": "CVE-2020-10797", "to": "T1055", "type": "related-to"}]}, "technical_analysis": {"Introduction": "The CVE-2020-10797 vulnerability is an XSS vulnerability that resides in the hostname field of the diag_ping.php page in pfsense before 2.4.5 version.", "Impact and Scope": "The vulnerability has a CVSSv3 score of 6.1 and a CVSSv2 score of 4.3, indicating a medium severity. The attack vector is NETWORK, and the scope is CHANGED.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1046 (Cross-Site Scripting) and T1055 (Command Injection).", "Technical Details": "The vulnerability occurs when the $result variable is not sanitized before it is printed, allowing an attacker to inject arbitrary HTML/CSS/JavaScript.", "Detection": "Detection methods include monitoring for suspicious activity, such as unusual network traffic or anomalous behavior from the diag_ping.php page.", "Mitigation": "Mitigation strategies include updating to a patched version, disabling the diag_ping.php page, or implementing input validation and sanitization.", "Conclusion": "The CVE-2020-10797 vulnerability is a medium-severity vulnerability that can be exploited to inject arbitrary HTML/CSS/JavaScript into the diag_ping.php page. Vulnerability scanning and penetration testing can help identify the vulnerability, and patching or mitigation strategies can help prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2020-10797 vulnerability is an XSS vulnerability that resides in the hostname field of the diag_ping.php page in pfsense before 2.4.5 version.", "Business Impact": "The vulnerability can lead to the compromise of sensitive data or malicious code execution, which can have significant business impact.", "Technical Impact": "The vulnerability can result in unauthorized access or data disclosure, which can have technical implications.", "Mitigation Strategies": "Mitigation strategies include updating to a patched version, disabling the diag_ping.php page, or implementing input validation and sanitization.", "Recommendations": "We recommend updating to a patched version, implementing input validation and sanitization, and monitoring for suspicious activity.", "Conclusions": "The CVE-2020-10797 vulnerability is a medium-severity vulnerability that requires immediate attention and remediation."}}