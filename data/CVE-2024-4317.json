{"id": "CVE-2024-4317", "sourceIdentifier": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007", "published": "2024-05-14T15:43:16.473", "lastModified": "2024-05-14T16:11:39.510", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Missing authorization in PostgreSQL built-in views pg_stats_ext and pg_stats_ext_exprs allows an unprivileged database user to read most common values and other statistics from CREATE STATISTICS commands of other users. The most common values may reveal column values the eavesdropper could not otherwise read or results of functions they cannot execute. Installing an unaffected version only fixes fresh PostgreSQL installations, namely those that are created with the initdb utility after installing that version. Current PostgreSQL installations will remain vulnerable until they follow the instructions in the release notes. Within major versions 14-16, minor versions before PostgreSQL 16.3, 15.7, and 14.12 are affected. Versions before PostgreSQL 14 are unaffected."}, {"lang": "es", "value": "La falta de autorizaci\u00f3n en las vistas integradas de PostgreSQL pg_stats_ext y pg_stats_ext_exprs permite a un usuario de base de datos sin privilegios leer los valores m\u00e1s comunes y otras estad\u00edsticas de los comandos CREATE STATISTICS de otros usuarios. Los valores m\u00e1s comunes pueden revelar valores de columnas que el esp\u00eda no podr\u00eda leer de otro modo o resultados de funciones que no pueden ejecutar. La instalaci\u00f3n de una versi\u00f3n no afectada solo corrige instalaciones nuevas de PostgreSQL, es decir, aquellas que se crean con la utilidad initdb despu\u00e9s de instalar esa versi\u00f3n. Las instalaciones actuales de PostgreSQL seguir\u00e1n siendo vulnerables hasta que sigan las instrucciones de las notas de la versi\u00f3n. Dentro de las versiones principales 14-16, las versiones menores anteriores a PostgreSQL 16.3, 15.7 y 14.12 se ven afectadas. Las versiones anteriores a PostgreSQL 14 no se ven afectadas."}], "metrics": {"cvssMetricV31": [{"source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 3.1, "baseSeverity": "LOW"}, "exploitabilityScore": 1.6, "impactScore": 1.4}]}, "weaknesses": [{"source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-862"}]}], "references": [{"url": "https://www.postgresql.org/support/security/CVE-2024-4317/", "source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007"}], "techniques": [{"techniqueID": "T1030", "comment": "CVE-2024-4317 - This vulnerability allows an unprivileged database user to read most common values and other statistics from CREATE STATISTICS commands of other users. This can be used to reveal column values that the attacker could not otherwise read or results of functions they cannot execute. The most common technique used to exploit this vulnerability is to use social engineering tactics to trick the user into executing the Create Statistics command."}, {"techniqueID": "T1204", "comment": "CVE-2024-4317 - This vulnerability can be used to read most common values and other statistics from CREATE STATISTICS commands of other users. This can lead to the disclosure of sensitive information. The tactic used is to use the vulnerability to gather information about the database, such as column names, data types, and statistics."}, {"techniqueID": "T1190", "comment": "CVE-2024-4317 - This vulnerability can be used to read most common values and other statistics from CREATE STATISTICS commands of other users. This can be used to gather information that can be used to plan subsequent attacks."}], "stix_bundle": {"description": "STIX Bundle for CVE-2024-4317", "packages": [{"type": "identity", "id": "identity--CVE-2024-4317", "name": "CVE-2024-4317"}, {"type": "indicator", "id": "indicator--T1030", "name": "T1030", "description": "Indication of potential exploitation of CVE-2024-4317 using T1030", "generated_at": "2024-05-14T15:43:16.473", "modified_at": "2024-05-14T16:11:39.510", "observable": {"type": "file", "hash": "1234567890", "name": "pg_stats_ext"}, "relationship": {"type": "related_to", "id_ref": "identity--CVE-2024-4317"}}, {"type": "indicator", "id": "indicator--T1204", "name": "T1204", "description": "Indication of potential exploitation of CVE-2024-4317 using T1204", "generated_at": "2024-05-14T15:43:16.473", "modified_at": "2024-05-14T16:11:39.510", "observable": {"type": "file", "hash": "abcdefg", "name": "pg_stats_ext_exprs"}, "relationship": {"type": "related_to", "id_ref": "identity--CVE-2024-4317"}}, {"type": "indicator", "id": "indicator--T1190", "name": "T1190", "description": "Indication of potential exploitation of CVE-2024-4317 using T1190", "generated_at": "2024-05-14T15:43:16.473", "modified_at": "2024-05-14T16:11:39.510", "observable": {"type": "network_traffic", "destination_port": 5432}, "relationship": {"type": "related_to", "id_ref": "identity--CVE-2024-4317"}}], "objects": [{"type": "report", "id": "report--cvss", "name": "CVSS Report", "description": "CVSS Report for CVE-2024-4317", "generated_at": "2024-05-14T15:43:16.473", "modified_at": "2024-05-14T16:11:39.510", "object_refs": ["indicator--T1030", "indicator--T1204", "indicator--T1190"]}]}, "technical_analysis": {"Introduction": "CVE-2024-4317 is a vulnerability in PostgreSQL that allows an unprivileged database user to read most common values and other statistics from CREATE STATISTICS commands of other users. This vulnerability can be used to reveal column values that the attacker could not otherwise read or results of functions they cannot execute.", "Impact and Scope": "The impact of this vulnerability is that an unprivileged database user can read most common values and other statistics from CREATE STATISTICS commands of other users. This can lead to the disclosure of sensitive information. The scope of this vulnerability is that it affects versions of PostgreSQL prior to 14.12, 15.7, and 16.3.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1030, T1204, and T1190.", "Technical Details": "This vulnerability occurs when an unprivileged database user is able to access the pg_stats_ext and pg_stats_ext_exprs views without proper authorization. This can be done using social engineering tactics to trick the user into executing the Create Statistics command.", "Detection": "The detection of this vulnerability involves monitoring database activity and looking for signs of unauthorized access to the pg_stats_ext and pg_stats_ext_exprs views. Additionally, monitoring for suspicious database queries and network traffic can help detect potential exploitation of this vulnerability.", "Mitigation": "The mitigation for this vulnerability involves installing an unaffected version of PostgreSQL, as well as implementing proper authorization and access controls. Additionally, regularly monitoring database activity and network traffic can help detect potential exploitation of this vulnerability.", "Conclusion": "In conclusion, CVE-2024-4317 is a vulnerability in PostgreSQL that allows an unprivileged database user to read most common values and other statistics from CREATE STATISTICS commands of other users. This vulnerability can be used to reveal column values that the attacker could not otherwise read or results of functions they cannot execute. The related MITRE ATT&CK techniques for this vulnerability are T1030, T1204, and T1190."}, "executive_analysis": {"Overview": "CVE-2024-4317 is a vulnerability in PostgreSQL that allows an unprivileged database user to read most common values and other statistics from CREATE STATISTICS commands of other users.", "Business Impact": "This vulnerability can have a significant business impact if not properly addressed. It can lead to the disclosure of sensitive information, which can result in financial loss, reputational damage, and legal consequences.", "Technical Impact": "The technical impact of this vulnerability is that it allows an unprivileged database user to read most common values and other statistics from CREATE STATISTICS commands of other users. This can lead to the disclosure of sensitive information.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include installing an unaffected version of PostgreSQL, implementing proper authorization and access controls, and regularly monitoring database activity and network traffic.", "Recommendations": "We recommend that you install an unaffected version of PostgreSQL, implement proper authorization and access controls, and regularly monitor database activity and network traffic to detect potential exploitation of this vulnerability.", "Conclusions": "In conclusion, CVE-2024-4317 is a vulnerability in PostgreSQL that allows an unprivileged database user to read most common values and other statistics from CREATE STATISTICS commands of other users. We recommend that you take immediate action to address this vulnerability and prevent potential exploitation."}}