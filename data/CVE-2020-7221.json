{"id": "CVE-2020-7221", "sourceIdentifier": "cve@mitre.org", "published": "2020-02-04T17:15:13.233", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "mysql_install_db in MariaDB 10.4.7 through 10.4.11 allows privilege escalation from the mysql user account to root because chown and chmod are performed unsafely, as demonstrated by a symlink attack on a chmod 04755 of auth_pam_tool_dir/auth_pam_tool. NOTE: this does not affect the Oracle MySQL product, which implements mysql_install_db differently."}, {"lang": "es", "value": "mysql_install_db en MariaDB versiones 10.4.7 hasta 10.4.11, permite una escalada de privilegios de la cuenta de usuario mysql a root porque chown y chmod se realizan de forma no segura, como es demostrado por un ataque de tipo symlink  en un chmod 04755 de auth_pam_tool_dir/auth_pam_tool. NOTA: esto no afecta el producto Oracle MySQL, que implementa mysql_install_db de manera diferente."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-59"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mariadb:mariadb:*:*:*:*:*:*:*:*", "versionStartIncluding": "10.4.7", "versionEndIncluding": "10.4.11", "matchCriteriaId": "58B7E318-FE05-4119-BA77-D315934F7E96"}]}]}], "references": [{"url": "https://bugzilla.suse.com/show_bug.cgi?id=1160868", "source": "cve@mitre.org", "tags": ["Exploit", "Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/MariaDB/server/commit/9d18b6246755472c8324bf3e20e234e08ac45618", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://seclists.org/oss-sec/2020/q1/55", "source": "cve@mitre.org", "tags": ["Exploit", "Mailing List", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-7221 - This vulnerability allows privilege escalation from the mysql user account to root, as demonstrated by a symlink attack on a chmod 04755 of auth_pam_tool_dir/auth_pam_tool. This technique can be used to gain elevated privileges, allowing an attacker to execute arbitrary code with root privileges."}, {"techniqueID": "T1078", "comment": "CVE-2020-7221 - This vulnerability allows an attacker to create a directory that would be executable by the mysql user, which can be used to execute code with elevated privileges. This technique can be used to achieve persistence and maintain access to the system."}, {"techniqueID": "T1027", "comment": "CVE-2020-7221 - This vulnerability allows an attacker to execute a symlink attack on a chmod 04755 of auth_pam_tool_dir/auth_pam_tool, which can be used to escalate privileges. This technique can be used to gain access to sensitive data and execute arbitrary code."}], "stix_bundle": "stix.json", "technical_analysis": {"Introduction": "The CVE-2020-7221 vulnerability is a privilege escalation vulnerability in the mysql_install_db utility of MariaDB, allowing an attacker to gain elevated privileges and execute arbitrary code.", "Impact and Scope": "The vulnerability affects MariaDB versions 10.4.7 through 10.4.11 and has a CVSS 3.1 score of 7.8 (High) with an attack vector of Local and attack complexity of Low.", "Related MITRE ATT&CK Techniques": "T1190, T1078, T1027", "Technical Details": "The vulnerability is due to the unsafe use of chown and chmod in the mysql_install_db utility, allowing an attacker to create a directory that would be executable by the mysql user.", "Detection": "Detection can be achieved by monitoring for unusual privilege escalation activity and inspecting system logs for suspicious directory creation events.", "Mitigation": "Mitigation strategies include ensuring that the mysql_install_db utility is updated to a version that is not affected by the vulnerability, as well as restricting access to the directory where the utility is installed.", "Conclusion": "In conclusion, the CVE-2020-7221 vulnerability is a serious privilege escalation vulnerability that allows an attacker to gain elevated privileges and execute arbitrary code. Detection and mitigation strategies are essential to prevent an attacker from exploiting this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2020-7221 vulnerability is a critical privilege escalation vulnerability in the mysql_install_db utility of MariaDB, allowing an attacker to gain elevated privileges and execute arbitrary code.", "Business Impact": "The vulnerability has the potential to compromise sensitive data and disrupt business operations, making it essential to prioritize detection and mitigation strategies.", "Technical Impact": "The vulnerability affects MariaDB versions 10.4.7 through 10.4.11 and has a CVSS 3.1 score of 7.8 (High) with an attack vector of Local and attack complexity of Low.", "Mitigation Strategies": "Ensure that the mysql_install_db utility is updated to a version that is not affected by the vulnerability and restrict access to the directory where the utility is installed.", "Recommendations": "Prioritize detection and mitigation strategies to prevent an attacker from exploiting this vulnerability and minimize the potential impact.", "Conclusions": "In conclusion, the CVE-2020-7221 vulnerability is a critical privilege escalation vulnerability that requires immediate attention and action to prevent an attacker from exploiting it."}}