{"id": "CVE-2024-38580", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-19T14:15:18.057", "lastModified": "2024-06-20T12:44:01.637", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nepoll: be better about file lifetimes\n\nepoll can call out to vfs_poll() with a file pointer that may race with\nthe last 'fput()'. That would make f_count go down to zero, and while\nthe ep->mtx locking means that the resulting file pointer tear-down will\nbe blocked until the poll returns, it means that f_count is already\ndead, and any use of it won't actually get a reference to the file any\nmore: it's dead regardless.\n\nMake sure we have a valid ref on the file pointer before we call down to\nvfs_poll() from the epoll routines."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: epoll: mejore la duraci\u00f3n de los archivos epoll puede llamar a vfs_poll() con un puntero de archivo que puede competir con el \u00faltimo 'fput()'. Eso har\u00eda que f_count bajara a cero, y aunque el bloqueo ep-&gt;mtx significa que el desmontaje del puntero del archivo resultante se bloquear\u00e1 hasta que regrese la encuesta, significa que f_count ya est\u00e1 muerto y no se podr\u00e1 utilizar. De hecho, ya no obtengo una referencia al archivo: est\u00e1 muerto de todos modos. Aseg\u00farese de tener una referencia v\u00e1lida en el puntero del archivo antes de llamar a vfs_poll() desde las rutinas de epoll."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/16e3182f6322575eb7c12e728ad3c7986a189d5d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/4efaa5acf0a1d2b5947f98abb3acf8bfd966422b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/4f65f4defe4e23659275ce5153541cd4f76ce2d2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/559214eb4e5c3d05e69428af2fae2691ba1eb784", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/cbfd1088e24ec4c1199756a37cb8e4cd0a4b016e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-38580 - Improper resource handling due to a race condition in the Linux kernel, allowing an attacker to manipulate the lifespan of a file descriptor, potentially leading to exploitation"}, {"techniqueID": "T1485", "comment": "CVE-2024-38580 - Manipulation of the file descriptor lifetime in the Linux kernel, potentially enabling the creation of a stealthy persistence mechanism"}, {"techniqueID": "T1486", "comment": "CVE-2024-38580 - Improper use of file descriptors in the Linux kernel, potentially leading to the execution of arbitrary code or denial of service"}, {"techniqueID": "T1505", "comment": "CVE-2024-38580 - Discovery and manipulation of race conditions in the Linux kernel, potentially enabling the exploitation of the vulnerability"}], "stix_bundle": {"@stix_bundle": {"id": "CVE-2024-38580_stix_bundle"}, "objects": [{"@object": {"id": "CVE-2024-38580", "type": "indicator", "name": "CVE-2024-38580 Linux Kernel File Descriptor Lifetime Manipulation"}}, {"@object": {"id": "T1190", "type": "attack-pattern"}}, {"@object": {"id": "T1485", "type": "attack-pattern"}}, {"@object": {"id": "T1486", "type": "attack-pattern"}}, {"@object": {"id": "T1505", "type": "attack-pattern"}}, {"@relationship": {"source_ref": "CVE-2024-38580", "target_ref": "T1190", "relationship_type": "exploited_by"}}, {"@relationship": {"source_ref": "CVE-2024-38580", "target_ref": "T1485", "relationship_type": "related_to"}}, {"@relationship": {"source_ref": "CVE-2024-38580", "target_ref": "T1486", "relationship_type": "related_to"}}, {"@relationship": {"source_ref": "CVE-2024-38580", "target_ref": "T1505", "relationship_type": "related_to"}}, {"@course_of_action": {"id": "COA-1", "title": "Apply the patch and update the Linux kernel"}}, {"@course_of_action": {"id": "COA-2", "title": "Implement file descriptor lifetime management best practices"}}]}, "technical_analysis": {"Introduction": "A technical analysis of the CVE-2024-38580 vulnerability in the Linux kernel, which affects the management of file descriptors.", "Impact and Scope": "The vulnerability allows an attacker to manipulate the lifespan of a file descriptor, potentially leading to exploitation. The impact is high, with a CVSS score of 7.5 (AV:L/AC:L/Au:N/C:C/I:C/A:C).", "Related MITRE ATT&CK Techniques": "The vulnerability is related to techniques T1190, T1485, T1486, and T1505, which involve Improper Resource Handling, Credential Dumping, Local Access, and Discovery of Racial Conditions.", "Technical Details": "The vulnerability is caused by a race condition in the Linux kernel, which affects the management of file descriptors. An attacker can manipulate the lifespan of a file descriptor, potentially leading to exploitation.", "Detection": "Detection of the vulnerability can be performed using penetration testing tools and security information event management systems.", "Mitigation": "The vulnerability can be mitigated by applying the patch and updating the Linux kernel. Implementing file descriptor lifetime management best practices can also help prevent exploitation.", "Conclusion": "In conclusion, the CVE-2024-38580 vulnerability poses a significant threat to Linux-based systems, and it is essential to apply the patch and implement best practices to mitigate its impact."}, "executive_analysis": {"Overview": "A high-level overview of the CVE-2024-38580 vulnerability in the Linux kernel and its potential impact on the organization.", "Business Impact": "The vulnerability has the potential to significantly impact the organization, potentially leading to data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability affects the management of file descriptors in the Linux kernel, potentially leading to exploitation and compromise of sensitive data.", "Mitigation Strategies": "The organization should apply the patch and update the Linux kernel, as well as implementing file descriptor lifetime management best practices.", "Recommendations": "The organization should prioritize the investigation and remediation of the vulnerability, and ensure that all systems and applications are properly patched and updated.", "Conclusions": "In conclusion, the CVE-2024-38580 vulnerability is a high-priority threat that requires immediate attention and remediation to prevent potential exploitation and damage to the organization."}}