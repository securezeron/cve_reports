{"id": "CVE-2024-26718", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-03T15:15:53.897", "lastModified": "2024-04-03T17:24:18.150", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndm-crypt, dm-verity: disable tasklets\n\nTasklets have an inherent problem with memory corruption. The function\ntasklet_action_common calls tasklet_trylock, then it calls the tasklet\ncallback and then it calls tasklet_unlock. If the tasklet callback frees\nthe structure that contains the tasklet or if it calls some code that may\nfree it, tasklet_unlock will write into free memory.\n\nThe commits 8e14f610159d and d9a02e016aaf try to fix it for dm-crypt, but\nit is not a sufficient fix and the data corruption can still happen [1].\nThere is no fix for dm-verity and dm-verity will write into free memory\nwith every tasklet-processed bio.\n\nThere will be atomic workqueues implemented in the kernel 6.9 [2]. They\nwill have better interface and they will not suffer from the memory\ncorruption problem.\n\nBut we need something that stops the memory corruption now and that can be\nbackported to the stable kernels. So, I'm proposing this commit that\ndisables tasklets in both dm-crypt and dm-verity. This commit doesn't\nremove the tasklet support, because the tasklet code will be reused when\natomic workqueues will be implemented.\n\n[1] https://lore.kernel.org/all/d390d7ee-f142-44d3-822a-87949e14608b@suse.de/T/\n[2] https://lore.kernel.org/lkml/20240130091300.2968534-1-tj@kernel.org/"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: dm-crypt, dm-verity: deshabilitar tasklets Los tasklets tienen un problema inherente con la corrupci\u00f3n de la memoria. La funci\u00f3n tasklet_action_common llama a tasklet_trylock, luego llama a la devoluci\u00f3n de llamada del tasklet y luego llama a tasklet_unlock. Si la devoluci\u00f3n de llamada del tasklet libera la estructura que contiene el tasklet o si llama a alg\u00fan c\u00f3digo que pueda liberarlo, tasklet_unlock escribir\u00e1 en la memoria libre. Las confirmaciones 8e14f610159d y d9a02e016aaf intentan solucionarlo para dm-crypt, pero no es una soluci\u00f3n suficiente y la corrupci\u00f3n de datos a\u00fan puede ocurrir [1]. No hay ninguna soluci\u00f3n para dm-verity y dm-verity escribir\u00e1 en la memoria libre con cada biograf\u00eda procesada por tasklet. Habr\u00e1 colas de trabajo at\u00f3micas implementadas en el kernel 6.9 [2]. Tendr\u00e1n una mejor interfaz y no sufrir\u00e1n el problema de corrupci\u00f3n de memoria. Pero necesitamos algo que detenga la corrupci\u00f3n de la memoria ahora y que pueda ser compatible con los n\u00facleos estables. Entonces, propongo esta confirmaci\u00f3n que deshabilita los tasklets tanto en dm-crypt como en dm-verity. Esta confirmaci\u00f3n no elimina la compatibilidad con el tasklet, porque el c\u00f3digo del tasklet se reutilizar\u00e1 cuando se implementen las colas de trabajo at\u00f3micas. [1] https://lore.kernel.org/all/d390d7ee-f142-44d3-822a-87949e14608b@suse.de/T/ [2] https://lore.kernel.org/lkml/20240130091300.2968534-1- tj@kernel.org/"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0a9bab391e336489169b95cb0d4553d921302189", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/0c45a20cbe68bc4d681734f5c03891124a274257", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/30884a44e0cedc3dfda8c22432f3ba4078ec2d94", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5735a2671ffb70ea29ca83969fe01316ee2ed6fc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1041", "comment": "CVE-2024-26718 - Possible exploitation of the Linux kernel vulnerability to execute arbitrary code through a tasklet callback, potentially leading to memory corruption and data loss."}, {"techniqueID": "T1059", "comment": "CVE-2024-26718 - Potential use of a tasklet callback to execute arbitrary code, which could be used to escalate privileges or inject malware."}, {"techniqueID": "T1499", "comment": "CVE-2024-26718 - Tasklet callback might be used to conduct a Denial of Service (DoS) attack, potentially affecting system availability."}, {"techniqueID": "T1221", "comment": "CVE-2024-26718 - Possible exploitation of the vulnerability to conduct a supply chain attack, potentially leading to data theft or integrity loss."}, {"techniqueID": "T1048", "comment": "CVE-2024-26718 - Potential exploitation of the vulnerability to execute a command or code on the system, potentially leading to data theft or integrity loss."}], "stix_bundle": {"objects": [{"@type": "Vulnerability", "id": "CVE-2024-26718", "name": "Linux kernel vulnerability", "description": "Tasklet callback vulnerability in the Linux kernel", "severity": "High", "tactics": ["Persistence", "Privilege Escalation"], "mitigations": ["Disable tasklets in dm-crypt and dm-verity"]}, {"@type": "Course-Of-Action", "id": "COA-1", "name": "Disable tasklets in dm-crypt and dm-verity", "description": "Disable tasklets in dm-crypt and dm-verity to prevent exploitation of the vulnerability"}, {"@type": "Technique", "id": "T1041", "name": "Execution Through Module Load", "description": "Exploitation of the vulnerability to execute arbitrary code through a tasklet callback"}, {"@type": "Technique", "id": "T1059", "name": "Software Manipulation", "description": "Use of a tasklet callback to execute arbitrary code"}, {"@type": "Analytic", "id": "Analytic-1", "name": "Analytic Report", "description": "In-depth analysis of the vulnerability and its potential impact"}, {"@type": "Stix2Bundle", "id": "Bundle", "name": "CVE-2024-26718 Analysis"}], "relationship": [{"ID": "rel-1", "type": "related_to", "source": "CVE-2024-26718", "target": "T1041"}, {"ID": "rel-2", "type": "related_to", "source": "CVE-2024-26718", "target": "T1059"}, {"ID": "rel-3", "type": "mitigates", "source": "T1041", "target": "COA-1"}]}, "technical_analysis": {"Introduction": "The Linux kernel vulnerability CVE-2024-26718 is a tasklet callback vulnerability that can be exploited to execute arbitrary code.", "Impact and Scope": "This vulnerability can lead to memory corruption, data loss, and potential system crashes.", "Related MITRE ATT&CK Techniques": "T1041, T1059, T1499", "Technical Details": "The vulnerability occurs in the dm-crypt and dm-verity code paths, allowing an attacker to execute arbitrary code through a tasklet callback.", "Detection": "Detection of this vulnerability involves monitoring system calls and checking for irregularities in tasklet callback execution.", "Mitigation": "Disable tasklets in dm-crypt and dm-verity to prevent exploitation of the vulnerability.", "Conclusion": "This vulnerability is a critical security issue that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "This vulnerability affects the Linux kernel and can lead to memory corruption, data loss, and potential system crashes.", "Business Impact": "This vulnerability can lead to data theft, integrity loss, and system downtime, resulting in significant financial losses.", "Technical Impact": "This vulnerability can also lead to system crashes and data corruption, making it a critical security issue.", "Mitigation Strategies": "Disable tasklets in dm-crypt and dm-verity, and apply patches as soon as they become available.", "Recommendations": "Apply patches as soon as they become available, and consider implementing additional security measures to prevent exploitation of the vulnerability.", "Conclusions": "This vulnerability is a critical security issue that requires immediate attention and mitigation. It is essential to take proactive measures to prevent exploitation and minimize potential impact."}}