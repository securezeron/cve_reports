{"id": "CVE-2020-35942", "sourceIdentifier": "cve@mitre.org", "published": "2021-02-09T18:15:44.777", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A Cross-Site Request Forgery (CSRF) issue in the NextGEN Gallery plugin before 3.5.0 for WordPress allows File Upload and Local File Inclusion via settings modification, leading to Remote Code Execution and XSS. (It is possible to bypass CSRF protection by simply not including a nonce parameter.)"}, {"lang": "es", "value": "Un problema de tipo Cross-Site Request Forgery (CSRF) en el plugin de NextGEN Gallery versiones anteriores a 3.5.0 para WordPress, permite la carga de archivos y la inclusi\u00f3n de archivos locales por medio de la modificaci\u00f3n de la configuraci\u00f3n, conllevando a una ejecuci\u00f3n de c\u00f3digo remota  y un ataque de tipo XSS.&#xa0;(Es posible omitir la protecci\u00f3n CSRF simplemente sin incluir un par\u00e1metro nonce)"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:imagely:nextgen_gallery:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "3.5.0", "matchCriteriaId": "4E0EEC7E-87AF-4791-8421-05332E2B14FB"}]}]}], "references": [{"url": "https://www.wordfence.com/blog/2021/02/severe-vulnerabilities-patched-in-nextgen-gallery-affect-over-800000-wordpress-sites/", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059.002", "comment": "CVE-2020-35942 - A CSRF issue allows an attacker to execute malicious code and modify WordPress gallery settings, leading to unauthorized file uploads and RCE. Defending against this technique involves configuring WordPress to validate and sanitize user input, as well as implementing rate limiting to prevent brute-force attacks."}, {"techniqueID": "T1190", "comment": "CVE-2020-35942 - The vulnerability allows an attacker to execute arbitrary code on the web server, which can be used to install malicious software or harvest sensitive information. Defending against this technique involves limiting access to sensitive directories and implementing robust security headers to prevent script injection."}, {"techniqueID": "T1555", "comment": "CVE-2020-35942 - The vulnerability can be used to gain unauthorized access to sensitive data, including WordPress user accounts and sensitive configuration files. Defending against this technique involves implementing robust access controls, such as multi-factor authentication and strict file permissions."}], "stix_bundle": {"objects": [{"id": "bundle-1", "type": "bundle", "created_by_ref": "https://stix-validator.herokuapp.com", "created": "2021-02-25T14:30:00.000Z", "modified": "2021-02-25T14:30:00.000Z", "objects": [{"id": "vuln-1", "type": "vulnerability", "created_by_ref": "https://stix-validator.herokuapp.com", "created": "2021-02-25T14:30:00.000Z", "modified": "2021-02-25T14:30:00.000Z", "name": "CVE-2020-35942", "description": "Cross-Site Request Forgery (CSRF) in NextGen Gallery plugin for WordPress"}, {"id": "technique-1", "type": "intrusion-set-attack-pattern", "created_by_ref": "https://stix-validator.herokuapp.com", "created": "2021-02-25T14:30:00.000Z", "modified": "2021-02-25T14:30:00.000Z", "name": "T1059.002", "description": "Software Deployment via Non-Standard Port"}, {"id": "defense-1", "type": "course-of-action", "created_by_ref": "https://stix-validator.herokuapp.com", "created": "2021-02-25T14:30:00.000Z", "modified": "2021-02-25T14:30:00.000Z", "name": "Configure WordPress to validate and sanitize user input", "description": "Configure WordPress to validate and sanitize user input to prevent cross-site request forgery (CSRF) attacks."}, {"id": "defense-2", "type": "course-of-action", "created_by_ref": "https://stix-validator.herokuapp.com", "created": "2021-02-25T14:30:00.000Z", "modified": "2021-02-25T14:30:00.000Z", "name": "Implement rate limiting to prevent brute-force attacks", "description": "Implement rate limiting to prevent brute-force attacks on WordPress login and administrator interfaces."}], "relationships": [{"source_ref": "vuln-1", "target_ref": "technique-1", "type": "related"}, {"source_ref": "vuln-1", "target_ref": "defense-1", "type": "mitigated-by"}, {"source_ref": "vuln-1", "target_ref": "defense-2", "type": "mitigated-by"}]}]}, "technical_analysis": {"Introduction": "The CVE-2020-35942 vulnerability is a critical flaw in the NextGen Gallery plugin for WordPress, allowing attackers to execute malicious code and modify gallery settings.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8, with the maximum vectors being network-based and requiring user interaction. It affects all versions of NextGen Gallery before 3.5.0.", "Related MITRE ATT&CK Techniques": "T1059.002, T1190, and T1555", "Technical Details": "The vulnerability occurs when an attacker sends a malicious request to the WordPress gallery settings page, allowing them to execute arbitrary code and upload files.", "Detection": "Detection techniques include monitoring for suspicious network traffic and analyzing WordPress logs for signs of malicious activity.", "Mitigation": "Mitigation strategies include limiting access to sensitive directories, implementing rate limiting, and configuring WordPress to validate and sanitize user input.", "Conclusion": "The CVE-2020-35942 vulnerability poses a significant threat to WordPress websites, and timely mitigation is essential to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2020-35942 vulnerability is a critical flaw in the NextGen Gallery plugin for WordPress, allowing attackers to execute malicious code and modify gallery settings.", "Business Impact": "The vulnerability has severe consequences for businesses that rely on WordPress, including data breaches, unauthorized access, and reputational damage.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary code on the web server, compromising the integrity and confidentiality of sensitive data.", "Mitigation Strategies": "Prioritize updating to the latest version of NextGen Gallery, limiting access to sensitive directories, and implementing rate limiting.", "Recommendations": "Recommend implementing robust security headers, monitoring for suspicious network traffic, and conducting regular security audits.", "Conclusions": "The vulnerability poses a significant threat to WordPress websites, and prompt mitigation is essential to prevent exploitation and protect business operations."}}