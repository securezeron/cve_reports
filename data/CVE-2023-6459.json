{"id": "CVE-2023-6459", "sourceIdentifier": "responsibledisclosure@mattermost.com", "published": "2023-12-06T09:15:09.140", "lastModified": "2023-12-12T19:23:29.137", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Mattermost is grouping calls in\u00a0the /metrics endpoint by id and reports that id in the response. Since this id is the channelID, the public /metrics endpoint is revealing channelIDs.\n\n"}, {"lang": "es", "value": "Mattermost agrupa llamadas en el endpoint /metrics por identificaci\u00f3n e informar esa identificaci\u00f3n en la respuesta. Dado que esta identificaci\u00f3n es la ID del canal, el endpoint p\u00fablico /metrics revela los ID de los canales."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost_server:*:*:*:*:*:*:*:*", "versionEndExcluding": "7.8.14", "matchCriteriaId": "6DC0F1AE-87E5-483B-BD2A-945BE99CD487"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost_server:*:*:*:*:*:*:*:*", "versionStartIncluding": "8.0.0", "versionEndExcluding": "8.1.5", "matchCriteriaId": "82659141-9C39-492A-9DF2-B2E293E151BE"}]}]}], "references": [{"url": "https://mattermost.com/security-updates", "source": "responsibledisclosure@mattermost.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1078/T1211: Unprivileged File and Directory Discovery", "comment": "CVE-2023-6459 - Potential abuse of the /metrics endpoint to reveal channel IDs, which could be used for further reconnaissance and attack"}, {"techniqueID": "T1027: Remote Services", "comment": "CVE-2023-6459 - Vulnerable Mattermost Server version exposes metrics endpoint, allowing remote attackers to gather information about channel IDs"}, {"techniqueID": "T1030: Network Service Discovery", "comment": "CVE-2023-6459 - Potential discovery of channel IDs through the public /metrics endpoint, enabling further reconnaissance and potential exploitation"}], "stix_bundle": {"@type": "bundle", "@schema": "https://stix2.iojson", "syntax_version": "2.1", "title": "CVE-2023-6459 Bundle", "description": "STIX Bundle for CVE-2023-6459", "objects": [{"@type": "vulnerability", "id": "CVE-2023-6459", "external_references": [{"source_name": "Mattermost", "external_id": "CVE-2023-6459"}], "name": "Mattermost Server metrics endpoint channel ID disclosure", "description": "Mattermost is grouping calls in the /metrics endpoint by id and reports that id in the response. Since this id is the channelID, the public /metrics endpoint is revealing channelIDs."}, {"@type": "campaign", "id": "Campaign-CVE-2023-6459", "title": "Campaign for CVE-2023-6459", "description": "Campaign to exploit CVE-2023-6459 vulnerability in Mattermost Server", "objects": [{"@type": "course-of-action", "id": "COA-T1078-T1211", "title": "Unprivileged File and Directory Discovery", "description": "Use the /metrics endpoint to gather channel ID information", "objects": [{"@type": "note", "id": "Note-CWE-200", "text": "Use of CWE-200: Exposure of Sensitive Data to an Unauthorized Actor"}], "relationships": [{"start_node": "COA-T1078-T1211", "end_node": "Vulnerability-CVE-2023-6459", "relationship_type": "mitigates"}]}]}]}, "technical_analysis": {"Introduction": "The vulnerability in Mattermost Server's /metrics endpoint allows remote attackers to gather channel IDs, potentially leading to a compromise of the system.", "Impact and Scope": "CVSS 3.1 score: 5.3, AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "Related MITRE ATT&CK Techniques": "T1078/T1211, T1027, T1030", "Technical Details": "The /metrics endpoint reveals channel IDs in the response, allowing remote attackers to gather sensitive information.", "Detection": "Monitor for unusual traffic patterns and channel ID disclosures", "Mitigation": "Update Mattermost Server to a patched version, restrict access to the /metrics endpoint, and implement additional logging and monitoring", "Conclusion": "The vulnerability in Mattermost Server's /metrics endpoint poses a significant threat to the confidentiality and integrity of the system. Proper mitigation and detection strategies are crucial to preventing exploitation."}, "executive_analysis": {"Overview": "A vulnerability in Mattermost Server's /metrics endpoint allows remote attackers to gather channel IDs, potentially compromising the system.", "Business Impact": "Loss of sensitive data, disruption of critical systems, and potential reputational damage.", "Technical Impact": "Vulnerability allows remote attackers to gather sensitive information, potentially leading to exploitation and compromise", "Mitigation Strategies": "Update Mattermost Server, restrict access to the /metrics endpoint, and implement additional logging and monitoring", "Recommendations": "Ensure timely patching, implement robust security monitoring, and conduct regular security assessments", "Conclusions": "The vulnerability in Mattermost Server's /metrics endpoint is a serious threat. Immediate action is required to mitigate the risk and prevent exploitation."}}