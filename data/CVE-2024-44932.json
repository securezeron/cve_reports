{"id": "CVE-2024-44932", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-26T11:15:05.500", "lastModified": "2024-08-27T16:08:45.020", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nidpf: fix UAFs when destroying the queues\n\nThe second tagged commit started sometimes (very rarely, but possible)\nthrowing WARNs from\nnet/core/page_pool.c:page_pool_disable_direct_recycling().\nTurned out idpf frees interrupt vectors with embedded NAPIs *before*\nfreeing the queues making page_pools' NAPI pointers lead to freed\nmemory before these pools are destroyed by libeth.\nIt's not clear whether there are other accesses to the freed vectors\nwhen destroying the queues, but anyway, we usually free queue/interrupt\nvectors only when the queues are destroyed and the NAPIs are guaranteed\nto not be referenced anywhere.\n\nInvert the allocation and freeing logic making queue/interrupt vectors\nbe allocated first and freed last. Vectors don't require queues to be\npresent, so this is safe. Additionally, this change allows to remove\nthat useless queue->q_vector pointer cleanup, as vectors are still\nvalid when freeing the queues (+ both are freed within one function,\nso it's not clear why nullify the pointers at all)."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: idpf: corrige UAF al destruir las colas. La segunda confirmaci\u00f3n etiquetada comenzaba a veces (muy raramente, pero posible) arrojando ADVERTENCIAS desde net/core/page_pool.c:page_pool_disable_direct_recycling(). Result\u00f3 que idpf libera los vectores de interrupci\u00f3n con NAPI incorporadas *antes* de liberar las colas, lo que hace que los punteros NAPI de page_pools conduzcan a la memoria liberada antes de que Libeth destruya estos grupos. No est\u00e1 claro si hay otros accesos a los vectores liberados al destruir las colas, pero de todos modos, generalmente liberamos vectores de cola/interrupci\u00f3n solo cuando las colas se destruyen y se garantiza que no se har\u00e1 referencia a las NAPI en ninguna parte. Invierta la l\u00f3gica de asignaci\u00f3n y liberaci\u00f3n haciendo que los vectores de cola/interrupci\u00f3n se asignen primero y se liberen al final. Los vectores no requieren la presencia de colas, por lo que esto es seguro. Adem\u00e1s, este cambio permite eliminar esa cola in\u00fatil-&gt;limpieza del puntero q_vector, ya que los vectores siguen siendo v\u00e1lidos al liberar las colas (+ ambos se liberan dentro de una funci\u00f3n, por lo que no est\u00e1 claro por qu\u00e9 anular los punteros)."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-416"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.10.5", "matchCriteriaId": "D074AE50-4A5E-499C-A2FD-75FD60DEA560"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*", "matchCriteriaId": "8B3CE743-2126-47A3-8B7C-822B502CF119"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*", "matchCriteriaId": "4DEB27E7-30AA-45CC-8934-B89263EF3551"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/290f1c033281c1a502a3cd1c53c3a549259c491f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/3cde714b0e77206ed1b5cf31f28c18ba9ae946fd", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "TA0003", "comment": "Privilege Escalation - This technique can be used for privilege escalation attacks, which is relevant to this vulnerability as it can be exploited to gain elevated privileges."}, {"techniqueID": "T1190", "comment": "Exploit Public-Facing Application - This technique can be used to exploit public-facing applications like the Linux kernel, which is vulnerable to this attack."}, {"techniqueID": "T1210", "comment": "Exploit Other Vulnerability - This technique can be used to exploit other vulnerabilities in the Linux kernel, which may be exploited simultaneously or sequentially to achieve a higher impact."}, {"techniqueID": "T1192", "comment": "Exploitation for Client Execution - This technique can be used to exploit vulnerabilities in client-side applications that interact with the Linux kernel, which is vulnerable to this attack."}, {"techniqueID": "TA0007", "comment": "PowerShell-Based Attack - This technique can be used to execute PowerShell commands on a compromised system, which can be used to exploit this vulnerability."}, {"techniqueID": "T1133", "comment": "File and Directory Discovery - This technique can be used to discover files and directories on a compromised system, which can be used to exploit this vulnerability."}], "stix_bundle": {"@timestamp": "2024-08-27T16:08:45.020Z", "attackpattern": [], "course_of_action": [], "identity": {}, "indicator": [], "invalid-range": {"@type": "indicator"}, "mutex": {}, "observed_data": [], "object_type": "indicator", "observable": {"@type": "indicator"}, "relationship": {}, "reporter": {}, "scanner": {}, "sighting": [], "sightings": {}, "span": {"@type": "indicator"}, "statement": [], "television": [], "threat_artifact": [], "threat_actor": {}, "tool": {}, "type": "indicator", "vulnerability": {"@id": "CVE-2024-44932", "description": "In the Linux kernel, the following vulnerability has been resolved:\nidpf: fix UAFs when destroying the queues\n\nThe second tagged commit started sometimes (very rarely, but possible)\nthrowing WARNs from\nnet/core/page_pool.c:page_pool_disable_direct_recycling().\nTurned out idpf frees interrupt vectors with embedded NAPIs *before*\nfreeing the queues making page_pools' NAPI pointers lead to freed\nmemory before these pools are destroyed by libeth.\nIt's not clear whether there are other accesses to the freed vectors\nwhen destroying the queues, but anyway, we usually free queue/interrupt\nvectors only when the queues are destroyed and the NAPIs are guaranteed\nto not be referenced anywhere.\n\nInvert the allocation and freeing logic making queue/interrupt vectors\nbe allocated first and freed last. Vectors don't require queues to be\npresent, so this is safe. Additionally, this change allows to remove\nthat useless queue->q_vector pointer cleanup, as vectors are still\nvalid when freeing the queues (+ both are freed within one function,\nso it's not clear why nullify the pointers at all).", "name": "CVE-2024-44932", "type": "Software Weakness"}, "vulnerability_reference_info": "{\"url\":\"https://git.kernel.org/stable/c/290f1c033281c1a502a3cd1c53c3a549259c491f\",\"source\":\"416baaa9-dc9f-4396-8d5f-8c081fb06d67\",\"tags\":[\"Patch\"]}", "weakness": {"@type": "Weakness", "description": "CWE-416", "name": "CWE-416"}}, "technical_analysis": {"Introduction": "This vulnerability is a remote code execution vulnerability in the Linux kernel, which can be exploited to gain elevated privileges.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 7.8. The scope of this vulnerability is local, and it can be exploited by an authenticated attacker.", "Related MITRE ATT&CK Techniques": ["TA0003", "T1190", "T1210", "T1192", "TA0007", "T1133"], "Technical Details": "The vulnerability is caused by a use-after-free bug in the Linux kernel's idpf driver. An attacker can exploit this vulnerability by sending a crafted packet to the vulnerable system.", "Detection": "This vulnerability can be detected by monitoring system logs for suspicious activity and by running vulnerability scanners against the system.", "Mitigation": "This vulnerability can be mitigated by patching the Linux kernel with the latest security updates.", "Conclusion": "In conclusion, this vulnerability is a high-severity vulnerability that can be exploited to gain elevated privileges. It is important to patch the Linux kernel with the latest security updates to mitigate this vulnerability."}, "executive_analysis": {"Overview": "This vulnerability is a remote code execution vulnerability in the Linux kernel that can be exploited to gain elevated privileges.", "Business Impact": "The business impact of this vulnerability is high, as it can be exploited to gain access to sensitive data and disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is also high, as it can be exploited to gain elevated privileges and gain access to sensitive data.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include patching the Linux kernel with the latest security updates and implementing a robust intrusion detection system.", "Recommendations": "We recommend that all Linux systems be patched with the latest security updates as soon as possible.", "Conclusions": "In conclusion, this vulnerability is a high-severity vulnerability that requires immediate attention. We recommend that all Linux systems be patched with the latest security updates as soon as possible."}}