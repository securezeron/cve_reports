{"id": "CVE-2020-10760", "sourceIdentifier": "secalert@redhat.com", "published": "2020-07-06T19:15:12.307", "lastModified": "2023-11-07T03:14:21.080", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "A use-after-free flaw was found in all samba LDAP server versions before 4.10.17, before 4.11.11, before 4.12.4 used in a AC DC configuration. A Samba LDAP user could use this flaw to crash samba."}, {"lang": "es", "value": "Se encontr\u00f3 un fallo de uso de la memoria previamente liberada en todas las versiones del servidor LDAP de samba anteriores a 4.10.17, anteriores a 4.11.11, anteriores a 4.12.4, usado en una configuraci\u00f3n AC DC. Un usuario del LDAP de Samba podr\u00eda usar este fallo para bloquear samba"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-416"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.5.0", "versionEndExcluding": "4.10.17", "matchCriteriaId": "BFE2F478-6A74-4D4A-A914-F1B29CB8620F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.11.0", "versionEndExcluding": "4.11.11", "matchCriteriaId": "EE656EC4-DE4C-4921-A22D-88C9CEDFFECB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.12.0", "versionEndExcluding": "4.12.4", "matchCriteriaId": "6D8FF3AF-B703-4021-8156-3D767FA10B8E"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*", "matchCriteriaId": "23A7C53F-B80F-4E6A-AFA9-58EEA84BE11D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:19.10:*:*:*:*:*:*:*", "matchCriteriaId": "A31C8344-3E02-4EB8-8BD8-4C84B7959624"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:20.04:*:*:*:lts:*:*:*", "matchCriteriaId": "902B8056-9E37-443B-8905-8AA93E2447FB"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*", "matchCriteriaId": "B620311B-34A3-48A6-82DF-6F078D7A4493"}, {"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:15.2:*:*:*:*:*:*:*", "matchCriteriaId": "B009C22E-30A4-4288-BCF6-C3E81DEAF45A"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:31:*:*:*:*:*:*:*", "matchCriteriaId": "80F0FA5D-8D3B-4C0E-81E2-87998286AF33"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-07/msg00030.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2020-07/msg00054.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2020-09/msg00002.html", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1849509%3B", "source": "secalert@redhat.com"}, {"url": "https://lists.debian.org/debian-lts-announce/2020/11/msg00041.html", "source": "secalert@redhat.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6YLNQ5GRXUKYRUAOFZ4DUBVN4SMTL6Q2/", "source": "secalert@redhat.com"}, {"url": "https://security.gentoo.org/glsa/202007-15", "source": "secalert@redhat.com"}, {"url": "https://usn.ubuntu.com/4409-1/", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "https://www.samba.org/samba/security/CVE-2020-10760.html", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0005-Initial_Access", "comment": "CVE-2020-10760 - An attacker could exploit the use-after-free vulnerability to gain initial access to the targeted system."}, {"techniqueID": "TA0008-Accompanying_Persistence", "comment": "An attacker could use this vulnerability to establish persistence on the targeted system by leveraging the use-after-free vulnerability to inject a malicious payload."}, {"techniqueID": "TA0002-Execution", "comment": "An attacker could execute arbitrary code on the targeted system by exploiting the use-after-free vulnerability."}, {"techniqueID": "TA0013-Pre_Hooking", "comment": "An attacker could use this vulnerability to pre-hook into the targeted system's process space to gain arbitrary code execution capabilities."}], "stix_bundle": {"identity": {"type": " indicator", "value": "CVE-2020-10760"}, "objects": [{"type": "attack-pattern", "id": "attack-pattern--cve-2020-10760-1", "name": "Samba LDAP Server Use-After-Free Vulnerability Exploit", "description": "Exploit code for the Samba LDAP Server Use-After-Free vulnerability (CVE-2020-10760)", "created_by": {"name": "Red Hat Security"}}, {"type": "course-of-action", "id": "course-of-action--cve-2020-10760-1", "name": "Apply the Samba patch", "description": "Apply the patch provided by Samba to mitigate the vulnerability", "related_object": {"type": "attack-pattern", "id": "attack-pattern--cve-2020-10760-1"}}, {"type": "indicator", "id": "indicator--cve-2020-10760-1", "name": "Samba LDAP Server Use-After-Free Vulnerability", "description": "The Samba LDAP Server Use-After-Free vulnerability (CVE-2020-10760)", "created_by": {"name": "Red Hat Security"}}], "relationships": [{"id": "relationship--cve-2020-10760-1", "source": {"type": "attack-pattern", "id": "attack-pattern--cve-2020-10760-1"}, "destination": {"type": "indicator", "id": "indicator--cve-2020-10760-1"}, "relationship_type": "exploits"}, {"id": "relationship--cve-2020-10760-2", "source": {"type": "course-of-action", "id": "course-of-action--cve-2020-10760-1"}, "destination": {"type": "attack-pattern", "id": "attack-pattern--cve-2020-10760-1"}, "relationship_type": "mitigates"}]}, "technical_analysis": {"Introduction": "The Samba LDAP Server Use-After-Free vulnerability (CVE-2020-10760) is a remote code execution vulnerability in the Samba LDAP server that can be exploited by an attacker to execute arbitrary code.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5 and is rated as medium severity. It affects all versions of Samba before 4.10.17, before 4.11.11, and before 4.12.4.", "Related MITRE ATT&CK Techniques": "TA0005-Initial Acess, TA0008-Accompanying Persistence, TA0002-Execution, and TA0013-Pre Hooking", "Technical Details": "The vulnerability occurs when the Samba LDAP server processes a specially crafted LDAP query, which can cause a use-after-free error in the server's memory. An attacker can exploit this vulnerability by sending a malformed LDAP query to the server.", "Detection": "Detection of this vulnerability can be performed by monitoring the Samba LDAP server logs for unusual activity.", "Mitigation": "The vulnerability can be mitigated by applying the patch provided by Samba or by configuring the Samba LDAP server to restrict access.", "Conclusion": "In conclusion, the Samba LDAP Server Use-After-Free vulnerability (CVE-2020-10760) is a remote code execution vulnerability that can be exploited by an attacker to execute arbitrary code. The vulnerability affects all versions of Samba before 4.10.17, before 4.11.11, and before 4.12.4, and can be mitigated by applying the patch or configuring the Samba LDAP server to restrict access."}, "executive_analysis": {"Overview": "The Samba LDAP Server Use-After-Free vulnerability (CVE-2020-10760) is a remote code execution vulnerability that can be exploited by an attacker to execute arbitrary code.", "Business Impact": "The vulnerability can have a significant business impact if exploited by an attacker, as it can give them unauthorized access to sensitive data.", "Technical Impact": "The vulnerability can have a significant technical impact if exploited by an attacker, as it can allow them to execute arbitrary code on the system.", "Mitigation Strategies": "The vulnerability can be mitigated by applying the patch provided by Samba or by configuring the Samba LDAP server to restrict access.", "Recommendations": "We recommend that organizations apply the patch provided by Samba or configure the Samba LDAP server to restrict access.", "Conclusions": "In conclusion, the Samba LDAP Server Use-After-Free vulnerability (CVE-2020-10760) is a remote code execution vulnerability that can be exploited by an attacker to execute arbitrary code. We recommend that organizations apply the patch provided by Samba or configure the Samba LDAP server to restrict access."}}