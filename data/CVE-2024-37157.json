{"id": "CVE-2024-37157", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-03T20:15:04.573", "lastModified": "2024-07-05T12:55:51.367", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Discourse is an open-source discussion platform. Prior to version 3.2.3 on the `stable` branch and version 3.3.0.beta4 on the `beta` and `tests-passed` branches, a malicious actor could get the FastImage library to redirect requests to an internal Discourse IP. This issue is patched in version 3.2.3 on the `stable` branch and version 3.3.0.beta4 on the `beta` and `tests-passed` branches. No known workarounds are available."}, {"lang": "es", "value": "Discourse es una plataforma de discusi\u00f3n de c\u00f3digo abierto. Antes de la versi\u00f3n 3.2.3 en la rama `stable` y la versi\u00f3n 3.3.0.beta4 en las ramas `beta` y `tests-passed`, un actor malintencionado pod\u00eda hacer que la librer\u00eda FastImage redirigir solicitudes a una IP interna de Discourse. Este problema se solucion\u00f3 en la versi\u00f3n 3.2.3 en la rama \"estable\" y en la versi\u00f3n 3.3.0.beta4 en las ramas \"beta\" y \"pruebas aprobadas\". No hay workarounds disponibles."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 4.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-918"}]}], "references": [{"url": "https://github.com/discourse/discourse/commit/5b8cf11b69e05d5c058c1148ec69ec309491fa6e", "source": "security-advisories@github.com"}, {"url": "https://github.com/discourse/discourse/commit/67e78086035cec494b15ce79342a0cb9052c2d95", "source": "security-advisories@github.com"}, {"url": "https://github.com/discourse/discourse/security/advisories/GHSA-46pq-7958-fc68", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-37157 - This technique is relevant to this vulnerability as it describes the tactics used by an attacker to exploit this vulnerability. The attacker may use this technique to redirect requests to an internal IP, which could lead to unauthorized access, modification, or exfiltration of data."}, {"techniqueID": "T1068", "comment": "CVE-2024-37157 - This technique is relevant to this vulnerability as it describes the tactics used by an attacker to use of unauthorized ports or protocols, which could be used to exploit this vulnerability."}, {"techniqueID": "T1568", "comment": "CVE-2024-37157 - This technique is relevant to this vulnerability as it describes the tactics used by an attacker to achieve elevated privileges, which could be used to exploit this vulnerability."}], "stix_bundle": {"id": "CVE-2024-37157", "type": "bundle", "spec_version": "2.1", "idrefs": [{"idref": "CVE-2024-37157"}], "objects": [{"id": "CVE-2024-37157", "type": "vulnerability", "description": "Prior to version 3.2.3 on the `stable` branch and version 3.3.0.beta4 on the `beta` and `tests-passed` branches, a malicious actor could get the FastImage library to redirect requests to an internal Discourse IP.", "name": "Discourse FastImage Library Redirect Vulnerability"}, {"id": "T1190", "type": "attack-pattern", "description": "This attack pattern is responsible for actions that occur once an attacker has gained access to an internal network, such as code execution or data exfiltration.", "name": "Exploit Public-Facing Application"}, {"id": "T1068", "type": "attack-pattern", "description": "This attack pattern is responsible for using unauthorized ports or protocols, which could be used to exploit this vulnerability.", "name": "Access to Unauthorized Ports"}, {"id": "T1568", "type": "attack-pattern", "description": "This attack pattern is responsible for actions that are used to achieve elevated privileges, which could be used to exploit this vulnerability.", "name": "Imposter/SPOIT Delivery"}, {"id": "CWE-918", "type": "weakness", "description": "Improperly Restricted Cross-Site Request Forgery (CSRF) in Successful Request Forgery", "name": "Cross-Site Request Forgery"}], "relationships": [{"id": "rel1", "type": "related-to", "source_ref": "CVE-2024-37157", "target_ref": "T1190"}, {"id": "rel2", "type": "related-to", "source_ref": "CVE-2024-37157", "target_ref": "T1068"}, {"id": "rel3", "type": "related-to", "source_ref": "CVE-2024-37157", "target_ref": "T1568"}, {"id": "rel4", "type": "related-to", "source_ref": "CVE-2024-37157", "target_ref": "CWE-918"}]}, "technical_analysis": {"Introduction": "Discourse is an open-source discussion platform that has been found to have a vulnerability in its FastImage library that could allow an attacker to redirect requests to an internal IP.", "Impact and Scope": "The impact of this vulnerability is that an attacker could redirect requests to an internal IP, which could lead to unauthorized access, modification, or exfiltration of data. The scope of this vulnerability is limited to versions 3.2.3 and earlier of the `stable` branch and versions 3.3.0.beta4 and earlier of the `beta` and `tests-passed` branches.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability include Exploit Public-Facing Application, Access to Unauthorized Ports, and Imposter/SPOIT Delivery.", "Technical Details": "The vulnerability is in the FastImage library, which could be used to redirect requests to an internal IP.", "Detection": "Detection of this vulnerability could be done using network-based detection systems such as IDS/IPS.", "Mitigation": "Mitigation of this vulnerability could be done by updating to version 3.2.3 or later of the `stable` branch or version 3.3.0.beta4 or later of the `beta` and `tests-passed` branches.", "Conclusion": "In conclusion, the Discourse FastImage library redirect vulnerability is a serious vulnerability that could allow an attacker to redirect requests to an internal IP, resulting in unauthorized access, modification, or exfiltration of data."}, "executive_analysis": {"Overview": "The Discourse FastImage library redirect vulnerability is a serious vulnerability that could allow an attacker to redirect requests to an internal IP, resulting in unauthorized access, modification, or exfiltration of data.", "Business Impact": "The business impact of this vulnerability is significant, as it could result in unauthorized access to sensitive data, disruption of business operations, and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is that it could allow an attacker to achieve elevated privileges, which could be used to conduct further attacks.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include updating to the latest version of Discourse, enabling network-based detection systems, and implementing security measures to prevent unauthorized access.", "Recommendations": "Recommendations for executives include prioritizing the patching of this vulnerability, implementing additional security measures, and conducting regular security assessments and testing.", "Conclusions": "In conclusion, the Discourse FastImage library redirect vulnerability is a serious vulnerability that requires immediate attention and mitigation. Executives should prioritize the patching of this vulnerability and implement additional security measures to protect against future attacks."}}