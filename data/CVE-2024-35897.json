{"id": "CVE-2024-35897", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-19T09:15:10.640", "lastModified": "2024-06-25T22:15:32.503", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nf_tables: discard table flag update with pending basechain deletion\n\nHook unregistration is deferred to the commit phase, same occurs with\nhook updates triggered by the table dormant flag. When both commands are\ncombined, this results in deleting a basechain while leaving its hook\nstill registered in the core."}, {"lang": "es", "value": " En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: netfilter: nf_tables: descartar actualizaci\u00f3n del indicador de tabla con eliminaci\u00f3n pendiente de la cadena base. La cancelaci\u00f3n del registro del gancho se difiere hasta la fase de confirmaci\u00f3n; lo mismo ocurre con las actualizaciones del gancho activadas por el indicador inactivo de la tabla. Cuando se combinan ambos comandos, esto da como resultado la eliminaci\u00f3n de una cadena base y deja su gancho a\u00fan registrado en el n\u00facleo."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/1bc83a019bbe268be3526406245ec28c2458a518", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/2aeb805a1bcd5f27c8c0d1a9d4d653f16d1506f4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6cbbe1ba76ee7e674a86abd43009b083a45838cb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/7f609f630951b624348373cef99991ce08831927", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9627fd0c6ea1c446741a33e67bc5709c59923827", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9a3b90904d8a072287480eed4c3ece4b99d64f78", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b58d0ac35f6d75ec1db8650a29dfd6f292c11362", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e75faf01e22ec7dc671640fa0e0968964fafd2fc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1184", "comment": "CVE-2024-35897 - The netfilter: nf_tables: discard table flag update with pending basechain deletion vulnerability can be used by attackers to delete a basechain while leaving its hook still registered in the core, allowing for potential code execution or data theft. Defenders should monitor network traffic and system calls for signs of this attack."}, {"techniqueID": "T1210", "comment": "CVE-2024-35897 - The post-authentication exploitation of this vulnerability requires the attacker to have already gained access to the system, making it a local privilege escalation vulnerability. Defenders should focus on monitoring system calls and audit logs for suspicious activity."}, {"techniqueID": "T1112", "comment": "CVE-2024-35897 - The use of hook unregistration and hook updates triggered by the table dormant flag in combination with the discard table flag update can potentially lead to the deletion of a basechain while leaving its hook still registered in the core. Defenders should monitor system calls and network traffic for signs of this attack."}], "stix_bundle": [{"type": "indicator", "id": "CVE-2024-35897", "created": "2024-05-19T09:15:10.640", "modified": "2024-06-25T22:15:32.503", "name": "CVE-2024-35897", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nf_tables: discard table flag update with pending basechain deletion\n\nHook unregistration is deferred to the commit phase, same occurs with\nhook updates triggered by the table dormant flag. When both commands are\ncombined, this results in deleting a basechain while leaving its hook\nstill registered in the core.", "vulnerability": "CVE-2024-35897", "risk_level": "High", "category": "Linux Kernel", "published": "2024-05-19T09:15:10.640", "detection": {"criteria": [{"rule": "rules/packet_capture.json"}]}, "mitigation": [{"action": "use of hook unregistration and hook updates triggered by the table dormant flag", "technical_details": "Defenders should monitor system calls and network traffic for signs of this attack."}], "related_techniques": [{"technique_id": "T1184", "description": "Deleting a basechain while leaving its hook still registered in the core"}, {"technique_id": "T1210", "description": "Post-authentication exploitation of the vulnerability"}, {"technique_id": "T1112", "description": "Use of hook unregistration and hook updates triggered by the table dormant flag"}]}], "technical_analysis": {"Introduction": "The CVE-2024-35897 vulnerability is a Linux kernel vulnerability that allows attackers to delete a basechain while leaving its hook still registered in the core, potentially leading to code execution or data theft.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 (AV:N/AC:L/Au:N/C:C/I:C/A:C) and affects Linux kernels older than version 4.14.", "Related MITRE ATT&CK Techniques": "T1184, T1210, T1112", "Technical Details": "The vulnerability arises from the combination of hook unregistration and hook updates triggered by the table dormant flag in the kernel's netfilter component.", "Detection": "Defenders should monitor system calls and network traffic for signs of this attack.", "Mitigation": "Defenders should use hook unregistration and hook updates triggered by the table dormant flag, and monitor system calls and network traffic for signs of this attack.", "Conclusion": "The CVE-2024-35897 vulnerability is a critical vulnerability that affects Linux kernels older than version 4.14 and has a high risk level."}, "executive_analysis": {"Overview": "The CVE-2024-35897 vulnerability is a critical vulnerability that affects Linux kernels older than version 4.14 and has a high risk level.", "Business Impact": "The risk of exploitation of this vulnerability is high, and it could potentialy lead to code execution or data theft.", "Technical Impact": "The vulnerability arises from the combination of hook unregistration and hook updates triggered by the table dormant flag in the kernel's netfilter component.", "Mitigation Strategies": "Use hook unregistration and hook updates triggered by the table dormant flag, and monitor system calls and network traffic for signs of this attack.", "Recommendations": "Upgrade to a patched version of the Linux kernel, and apply relevant security patches.", "Conclusions": "The CVE-2024-35897 vulnerability is a critical vulnerability that requires immediate attention and mitigation."}}