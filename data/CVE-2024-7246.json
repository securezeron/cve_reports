{"id": "CVE-2024-7246", "sourceIdentifier": "cve-coordination@google.com", "published": "2024-08-06T11:16:07.587", "lastModified": "2024-08-06T16:30:24.547", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "It's possible for a gRPC client communicating with a HTTP/2 proxy to poison the HPACK table between the proxy and the backend such that other clients see failed requests. It's also possible to use this vulnerability to leak other clients HTTP header keys, but not values.\n\nThis occurs because the error status for a misencoded header is not cleared between header reads, resulting in subsequent (incrementally indexed) added headers in the first request being poisoned until cleared from the HPACK table.\n\nPlease update to a fixed version of gRPC as soon as possible. This bug has been fixed in 1.58.3, 1.59.5, 1.60.2, 1.61.3, 1.62.3, 1.63.2, 1.64.3, 1.65.4."}, {"lang": "es", "value": "Es posible que un cliente gRPC que se comunica con un proxy HTTP/2 envenene la tabla HPACK entre el proxy y el backend de modo que otros clientes vean solicitudes fallidas. Tambi\u00e9n es posible utilizar esta vulnerabilidad para filtrar claves de encabezado HTTP de otros clientes, pero no valores. Esto ocurre porque el estado de error de un encabezado mal codificado no se borra entre lecturas de encabezado, lo que da como resultado que los encabezados agregados posteriores (indexados incrementalmente) en la primera solicitud se envenenen hasta que se eliminen de la tabla HPACK. Actualice a una versi\u00f3n fija de gRPC lo antes posible. Este error se solucion\u00f3 en 1.58.3, 1.59.5, 1.60.2, 1.61.3, 1.62.3, 1.63.2, 1.64.3, 1.65.4."}], "metrics": {"cvssMetricV40": [{"source": "cve-coordination@google.com", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:H/AT:N/PR:N/UI:N/VC:N/VI:N/VA:L/SC:N/SI:N/SA:L/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "attackVector": "NETWORK", "attackComplexity": "HIGH", "attackRequirements": "NONE", "privilegesRequired": "NONE", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "NONE", "vulnerableSystemIntegrity": "NONE", "vulnerableSystemAvailability": "LOW", "subsequentSystemConfidentiality": "NONE", "subsequentSystemIntegrity": "NONE", "subsequentSystemAvailability": "LOW", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NOT_DEFINED", "recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED", "baseScore": 6.3, "baseSeverity": "MEDIUM"}}]}, "weaknesses": [{"source": "cve-coordination@google.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-440"}]}], "references": [{"url": "https://github.com/grpc/grpc/issues/36245", "source": "cve-coordination@google.com"}], "techniques": [{"techniqueID": "T1190", "comment": "Use of malformed HTTP/2 headers can lead to HPACK poisoning and subsequent exploitation. gRPC clients may be vulnerable to this attack when communicating with HTTP/2 proxies. CVE-2024-7246"}, {"techniqueID": "T1566", "comment": "Exploitation of a software vulnerability can lead to unauthorized access to sensitive data. CVE-2024-7246"}, {"techniqueID": "T1568", "comment": "Exploitation of a software vulnerability can lead to unauthorized modification of data. CVE-2024-7246"}, {"techniqueID": "T1570", "comment": "Data from other clients' HTTP headers can be leaked to unauthorized parties. CVE-2024-7246"}], "stix_bundle": {"timestamp": "2024-08-06T11:16:07.587", "objects": [{"id": "vuln-cve-2024-7246", "type": "vulnerability", "spec_version": "2.1", "description": "gRPC HTTP/2 header injection vulnerability", "created_by_ref": "https://example.com/collections/known-vulnerabilities", "modified": "2024-08-06T16:30:24.547", "labels": ["Vulnerability", "Exploit", "Software"], "attributes": [{"type": "cve", "value": "CVE-2024-7246"}], "external_references": [{"source_name": "cve-coordination@google.com", "url": "https://github.com/grpc/grpc/issues/36245"}], "relationships": [{"type": "has-note", "id": "note-1", "note": "This vulnerability was discovered by Google and fixed in gRPC versions 1.58.3, 1.59.5, 1.60.2, 1.61.3, 1.62.3, 1.63.2, 1.64.3, 1.65.4"}]}], "courses_of_action": [{"id": "coa-1", "type": "course-of-action", "spec_version": "2.1", "name": "Update gRPC to a fixed version", "description": "Update gRPC to a version that fixes this vulnerability. CVE-2024-7246", "recommended": true, "mitigated_by": ["UPDATE_GRPC"], "related_techniques": ["T1190"]}], "notes": [{"type": "note", "id": "note-1", "spec_version": "2.1", "content": "HPACK poisoning can occur when a gRPC client communicates with an HTTP/2 proxy. This vulnerability may allow an attacker to inject malformed HTTP/2 headers that can be used to poison the HPACK table."}]}, "technical_analysis": {"Introduction": "gRPC is a popular framework for building scalable and high-performance applications. A vulnerability in the HTTP/2 implementation of gRPC can allow an attacker to inject malformed HTTP/2 headers that can be used to poison the HPACK table.", "Impact and Scope": "This vulnerability has a CVSS score of 6.3 and an attack vector of NETWORK. It may allow an attacker to inject malicious HTTP/2 headers that can be used to poison the HPACK table, leading to unauthorized access to sensitive data.", "Related MITRE ATT&CK Techniques": "T1190, T1566, T1568, T1570", "Technical Details": "The vulnerability occurs because the error status for a misencoded header is not cleared between header reads, resulting in subsequent (incrementally indexed) added headers in the first request being poisoned until cleared from the HPACK table.", "Detection": "Detection of this vulnerability is challenging, but can be done by monitoring network traffic and looking for signs of HPACK poisoning.", "Mitigation": "The recommended mitigation is to update gRPC to a fixed version.", "Conclusion": "In conclusion, this vulnerability is significant and can have serious consequences if not addressed. It is recommended that all gRPC users update to a fixed version as soon as possible."}, "executive_analysis": {"Overview": "A vulnerability in the HTTP/2 implementation of gRPC can allow an attacker to inject malformed HTTP/2 headers that can be used to poison the HPACK table.", "Business Impact": "This vulnerability can have a significant business impact, as it can allow an attacker to inject malicious HTTP/2 headers that can be used to poison the HPACK table, leading to unauthorized access to sensitive data.", "Technical Impact": "The technical impact of this vulnerability is significant, as it can allow an attacker to inject malicious HTTP/2 headers that can be used to poison the HPACK table.", "Mitigation Strategies": "The recommended mitigation is to update gRPC to a fixed version.", "Recommendations": "Recommendations for executives include implementing network monitoring and detection techniques to identify signs of HPACK poisoning, and updating gRPC to a fixed version as soon as possible.", "Conclusions": "In conclusion, this vulnerability is significant and requires immediate attention. It is recommended that all gRPC users update to a fixed version as soon as possible."}}