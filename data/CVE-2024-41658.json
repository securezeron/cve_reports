{"id": "CVE-2024-41658", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-20T21:15:13.910", "lastModified": "2024-08-28T16:08:31.743", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Casdoor is a UI-first Identity and Access Management (IAM) / Single-Sign-On (SSO) platform.  In Casdoor 1.577.0 and earlier, he purchase URL that is created to generate a WechatPay QR code is vulnerable to reflected XSS. When purchasing an item through casdoor, the product page allows you to pay via wechat pay. When using wechat pay, a QR code with the wechat pay link is displayed on the payment page, hosted on the domain of casdoor. This page takes a query parameter from the url successUrl, and redirects the user to that url after a successful purchase. Because the user has no reason to think that the payment page contains sensitive information, they may share it with other or can be social engineered into sending it to others. An attacker can then craft the casdoor link with a special url and send it back to the user, and once payment has gone though an XSS attack occurs."}, {"lang": "es", "value": "Casdoor es una plataforma de gesti\u00f3n de acceso e identidad (IAM)/inicio de sesi\u00f3n \u00fanico (SSO) basada en la interfaz de usuario. En Casdoor 1.577.0 y versiones anteriores, la URL de compra creada para generar un c\u00f3digo QR de WechatPay es vulnerable al XSS reflejado. Al comprar un art\u00edculo a trav\u00e9s de casdoor, la p\u00e1gina del producto le permite pagar mediante wechat pay. Cuando se utiliza wechat pay, se muestra un c\u00f3digo QR con el enlace de wechat pay en la p\u00e1gina de pago, alojada en el dominio de casdoor. Esta p\u00e1gina toma un par\u00e1metro de consulta de la URL SuccessUrl y redirige al usuario a esa URL despu\u00e9s de una compra exitosa. Debido a que el usuario no tiene motivos para pensar que la p\u00e1gina de pago contiene informaci\u00f3n confidencial, puede compartirla con otros o puede sufrir ingenier\u00eda social para enviarla a otros. Luego, un atacante puede crear el enlace casdoor con una URL especial y envi\u00e1rselo de vuelta al usuario, y una vez que se haya realizado el pago, se produce un ataque XSS."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:casbin:casdoor:*:*:*:*:*:*:*:*", "matchCriteriaId": "F1B75F3C-3552-48E9-87F8-B34056AA5A5E"}]}]}], "references": [{"url": "https://github.com/casdoor/casdoor/blob/v1.577.0/web/src/QrCodePage.js", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://securitylab.github.com/advisories/GHSL-2024-035_GHSL-2024-036_casdoor/", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-41658 - A vulnerability in Casdoor allows an attacker to launch a reflected XSS attack on the system. To defend against this vulnerability, it's essential to update to a patched version and implement adequate input validation and sanitization for user input."}, {"techniqueID": "T1507", "comment": "CVE-2024-41658 - This vulnerability can be used as a stepping stone for other attacks. An attacker may use this vulnerability to gain access to the system and then use other techniques to escalate their privileges."}, {"techniqueID": "T1070", "comment": "CVE-2024-41658 - This vulnerability allows an attacker to manipulate URLs to launch a reflected XSS attack. To detect this vulnerability, look for unintended changes to the system behavior."}], "stix_bundle": {"objects": [{"type": "attack-pattern", "id": "vulnerability-CVE-2024-41658", "name": "CVE-2024-41658 - Reflected XSS vulnerability in Casdoor"}, {"type": "malware", "id": "malware-CVE-2024-41658", "name": "Malware used in CVE-2024-41658"}, {"type": "campaign", "id": "campaign-CVE-2024-41658", "name": "Campaign for CVE-2024-41658"}, {"type": "course-of-action", "id": "course-of-action-CVE-2024-41658", "name": "COA for CVE-2024-41658"}], "relations": [{"type": "related-to", "object_ref": "vulnerability-CVE-2024-41658", "object": "malware-CVE-2024-41658", "relationship": "uses"}, {"type": "related-to", "object_ref": "malware-CVE-2024-41658", "object": "vulnerability-CVE-2024-41658", "relationship": "targets"}, {"type": "related-to", "object_ref": "course-of-action-CVE-2024-41658", "object": "malware-CVE-2024-41658", "relationship": "mitigates"}]}, "technical_analysis": {"Introduction": "CVE-2024-41658 is a reflected XSS vulnerability in Casdoor that allows an attacker to launch a XSS attack on the system.", "Impact and Scope": "The vulnerability has a CVSS score of 6.1, with a severity of medium. It is available in Casdoor 1.577.0 and earlier versions.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1190, T1507, and T1070.", "Technical Details": "The vulnerability is caused by the failure to validate and sanitize user input, allowing an attacker to manipulate URLs to launch a reflected XSS attack.", "Detection": "To detect this vulnerability, look for unintended changes to the system behavior.", "Mitigation": "Update to a patched version of Casdoor and implement adequate input validation and sanitization for user input.", "Conclusion": "CVE-2024-41658 is a serious vulnerability that requires immediate attention. It is essential to patch the vulnerability and implement adequate security measures to prevent future attacks."}, "executive_analysis": {"Overview": "CVE-2024-41658 is a reflected XSS vulnerability in Casdoor that can be used to launch a XSS attack on the system.", "Business Impact": "The vulnerability can result in data breaches, unauthorized access, and other business impacts.", "Technical Impact": "The vulnerability affects the security of the system, allowing an attacker to manipulate URLs and launch a reflected XSS attack.", "Mitigation Strategies": "Update to a patched version of Casdoor and implement adequate security measures to prevent future attacks.", "Recommendations": "Executives should prioritize patching the vulnerability and implementing adequate security measures to prevent future attacks.", "Conclusions": "CVE-2024-41658 is a serious vulnerability that requires immediate attention. It is essential to prioritize patching the vulnerability and implementing adequate security measures to prevent future attacks."}}