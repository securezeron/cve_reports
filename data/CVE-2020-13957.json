{"id": "CVE-2020-13957", "sourceIdentifier": "security@apache.org", "published": "2020-10-13T19:15:12.460", "lastModified": "2023-11-07T03:17:04.050", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Apache Solr versions 6.6.0 to 6.6.6, 7.0.0 to 7.7.3 and 8.0.0 to 8.6.2 prevents some features considered dangerous (which could be used for remote code execution) to be configured in a ConfigSet that's uploaded via API without authentication/authorization. The checks in place to prevent such features can be circumvented by using a combination of UPLOAD/CREATE actions."}, {"lang": "es", "value": "Apache Solr versiones 6.6.0 hasta 6.6.6, 7.0.0 hasta 7.7.3 y 8.0.0 hasta 8.6.2, impiden que algunas funcionalidades consideradas peligrosas (que podr\u00edan ser usadas para una ejecuci\u00f3n de c\u00f3digo remota) sean configuradas en un ConfigSet que es cargado por medio de la API sin autenticaci\u00f3n y autorizaci\u00f3n.&#xa0;Las comprobaciones implementadas impiden que tales funcionalidades puedan ser omitidas al usar una combinaci\u00f3n de acciones UPLOAD/CREATE"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-863"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.6.0", "versionEndIncluding": "6.6.6", "matchCriteriaId": "97C43AD4-DF31-4CE4-AA9C-BFD17B498BD1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.0.0", "versionEndIncluding": "7.7.3", "matchCriteriaId": "B0ECAE20-D7DC-4E8B-AF90-93B2AD328BA6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*", "versionStartIncluding": "8.0.0", "versionEndIncluding": "8.6.2", "matchCriteriaId": "BB9B7A5A-E776-41A0-B140-C0B879E9528C"}]}]}], "references": [{"url": "https://lists.apache.org/thread.html/r13a728994c60be5b5a7049282b5c926dac1fc6a9a0b2362f6adfa573%40%3Cissues.lucene.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r1c783d3d81ba62f3381a17a4d6c826f7dead3a132ba42349c90df075%40%3Ccommits.lucene.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r1d4a247329a8478073163567bbc8c8cb6b49c6bfc2bf58153a857af1%40%3Ccommits.druid.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r2236fdf99ac3efbfc36c2df96d3a88f822baa6f45e13fec7ff558e34%40%3Cdev.bigtop.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r226c1112bb41e7cd427862d875eff9877a20a40242c2542f4dd39e4a%40%3Cissues.lucene.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r2a6600fe9afd502c04d26fd112823ec3f3c3ad1b4a289d10567a78a0%40%3Cdev.bigtop.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r2f8d33a4de07db9459fb2a98a1cd39747066137636b53f84a13e5628%40%3Cissues.lucene.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r3d1e24a73e6bffa1d6534e1f34c8f5cbd9999495e7d933640f4fa0ed%40%3Cissues.lucene.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r3da9895cea476bcee2557531bebd4e8f6f367dc3ea900a65e2f51cd8%40%3Cissues.bigtop.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r4ca8ba5980d9049cf3707798aa3116ee76c1582f171ff452ad2ca75e%40%3Cissues.lucene.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r5557641fcf5cfd99260a7037cfbc8788fb546b72c98a900570edaa2e%40%3Cissues.lucene.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r622a043c2890327f8a4aea16b131e8a7137a282a004614369fceb224%40%3Cdev.bigtop.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r7512ae552cd9d14ab8b1bc0a7e95f2ec52ae85364f068d4034398ede%40%3Cissues.lucene.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r853fdc6d0b91d5e01a26c7bd5becb044ad775a231703d634ca5d55c9%40%3Cissues.lucene.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r8b1782d42d0a4ce573495d5d9345ad328d652c68c411ccdb245c57e3%40%3Cissues.lucene.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r999f828e6e37d9e825e207471cbfd2681c3befcd7f3abd59ed87c0d5%40%3Cissues.bigtop.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r9d7356f209ee30d702b6a921c866564eb2e291b126640c7ab70feea7%40%3Ccommits.lucene.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/rb1de6ba50a468e9baff32a249edaa08f6bcec7dd7cc208e25e6b48c8%40%3Cissues.bigtop.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/rb2f1c7fd3d3ea719dfac4706a80e6affddecae8663dda04e1335347f%40%3Ccommits.bigtop.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/rf1a32f00017e83ff29a74be2de02e28e4302dddb5f14c624e297a8c0%40%3Cdev.bigtop.apache.org%3E", "source": "security@apache.org"}, {"url": "https://mail-archives.us.apache.org/mod_mbox/www-announce/202010.mbox/%3CCAECwjAWCVLoVaZy%3DTNRQ6Wk9KWVxdPRiGS8NT%2BPHMJCxbbsEVg%40mail.gmail.com%3E", "source": "security@apache.org", "tags": ["Mailing List", "Vendor Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20201023-0002/", "source": "security@apache.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1078", "comment": "CVE-2020-13957 - Remote code execution can be achieved by uploading a misconfigured ConfigSet using the Apache Solr API. Defend against this by implementing proper authentication and authorization checks."}, {"techniqueID": "T1629", "comment": "CVE-2020-13957 - The vulnerability can be exploited by creating a misconfigured ConfigSet using a combination of upload and create API actions. Defend against this by implementing proper validation and sanitization of user input."}], "stix_bundle": {"identity": {"type": "vulnerability", "id": "CVE-2020-13957", "name": "Apache Solr Information Disclosure"}, "objects": [{"type": "indicator", "id": "indicator-1", "name": "Misconfigured ConfigSet", "description": "A ConfigSet with disabled checks that prevents features from being configured", "pattern": "^[a-zA-Z0-9_]*$", "relationship": {"type": "related_to", "id": "related-to-1", "object_ref": "CVE-2020-13957"}}, {"type": "malware", "id": "malware-1", "name": "Apache Solr Malware", "description": "Malware that uses a misconfigured ConfigSet to gain remote code execution", "relationship": {"type": "uses", "id": "uses-1", "object_ref": "indicator-1"}}], " relationships": [{"type": "uses", "id": "uses-1", "source_ref": "malware-1", "target_ref": "indicator-1"}, {"type": "related_to", "id": "related-to-1", "source_ref": "indicator-1", "target_ref": "CVE-2020-13957"}]}, "technical_analysis": {"Introduction": "Apache Solr is a popular search engine software that can be vulnerable to remote code execution if not configured properly.", "Impact and Scope": {"cvss_score": "9.8", "attack_vector": "NETWORK", "description": "Remote code execution can be achieved by uploading a misconfigured ConfigSet using the Apache Solr API.", "scope": "System-level"}, "Related MITRE ATT&CK Techniques": ["T1078", "T1629"], "Technical Details": "The vulnerability occurs when the checks that prevent features from being configured are disabled.", "Detection": "Monitor for suspicious uploads of ConfigSets using the Apache Solr API.", "Mitigation": "Implement proper authentication and authorization checks, and validate and sanitize user input.", "Conclusion": "Proper configuration of Apache Solr can prevent remote code execution attacks."}, "executive_analysis": {"Overview": "Apache Solr is a popular search engine software that can be vulnerable to remote code execution if not configured properly.", "Business Impact": "Remote code execution can lead to data breaches, financial loss, and reputational damage.", "Technical Impact": "The vulnerability requires no authentication and can be exploited by creating a misconfigured ConfigSet.", "Mitigation Strategies": "Implement proper configuration of Apache Solr, and monitor for suspicious activity.", "Recommendations": "Executives should prioritize configuration and patch management to prevent remote code execution attacks.", "Conclusions": "Proper configuration and monitoring can prevent remote code execution attacks."}}