{"id": "CVE-2020-11439", "sourceIdentifier": "cve@mitre.org", "published": "2020-07-15T20:15:12.960", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "LibreHealth EMR v2.0.0 is affected by a Local File Inclusion issue allowing arbitrary PHP to be included and executed within the EMR application."}, {"lang": "es", "value": "LibreHealth EMR versi\u00f3n v2 est\u00e1 afectada por un problema de inclusi\u00f3n de archivos locales permitiendo incluir y ejecutar PHP arbitrario dentro de la aplicaci\u00f3n EMR"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:librehealth:librehealth_ehr:2.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "9E9170AF-92DB-4B39-AC8F-73EB8CB496CC"}]}]}], "references": [{"url": "https://know.bishopfox.com/advisories", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://labs.bishopfox.com/advisories/librehealth-version-2.0.0-0", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://librehealth.io/", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-11439 - This Local File Inclusion vulnerability allows arbitrary PHP to be included and executed within the EMR application, demonstrating a classic exploitation pattern of Server-Side Request Forgery (SSRF) and Server-Side Template Injection (SSTI)."}, {"techniqueID": "T1068", "comment": "CVE-2020-11439 - An attacker could use this vulnerability to inject arbitrary PHP code and execute it, potentially leading to remote code execution, highlighting the importance of secure code review and input validation."}, {"techniqueID": "T1193", "comment": "CVE-2020-11439 - The Local File Inclusion issue can be exploited to include and execute arbitrary PHP scripts, illustrating the potential for increased attack surface and introducing the need for defensive measures like Web Application Firewalls (WAFs) and Input Validation."}, {"techniqueID": "T1087", "comment": "CVE-2020-11439 - A malicious actor could use this vulnerability to inject and execute arbitrary code, demonstrating the potential for both horizontal and vertical privilege escalation, stressing the importance of secure configuration and access controls."}], "stix_bundle": {"bundle": {"id": "CVE-2020-11439-STIX-Bundle", "type": "bundle", "spec_version": "2.1", "bundles": [{"id": "VulnerabilityBundle", "type": "vulnerability", "spec_version": "2.1", "created_by_ref": "https://cve.mitre.org/cve/cve/2020/CVE-2020-11439", "modified": "2021-07-21T11:39:23.747", "data_mark": "c59d45f4-e25e-495c-a8a1-a413b1c10a54", "objects": [{"id": "CVE-2020-11439", "type": "vulnerability", "spec_version": "2.1", "name": "CVE-2020-11439", "description": "LibreHealth EMR v2.0.0 is affected by a Local File Inclusion issue allowing arbitrary PHP to be included and executed within the EMR application.", "labels": ["CWE-22"], "external_references": [{"source_name": "cve@mitre.org", "external_id": "CVE-2020-11439"}]}, {"id": "Local-File-Inclusion", "type": "intrusion-set", "spec_version": "2.1", "name": "Local File Inclusion", "description": "In this attack, an attacker attempts to include a local file on a targeted system, often to gain access to sensitive data or execute arbitrary code.", "labels": ["T1190"], "external_references": [{"source_name": "mitre-attack", "external_id": "T1190"}]}, {"id": "PHP-Code-Execution", "type": "intrusion-set", "spec_version": "2.1", "name": "PHP Code Execution", "description": "This tactic involves injecting and executing arbitrary PHP code, potentially leading to remote code execution.", "labels": ["T1068"], "external_references": [{"source_name": "mitre-attack", "external_id": "T1068"}]}, {"id": "Arbitrary-Code-Execution", "type": "intrusion-set", "spec_version": "2.1", "name": "Arbitrary Code Execution", "description": "In this attack, an attacker injects and executes arbitrary code, potentially leading to privilege escalation and increased attack surface.", "labels": ["T1087"], "external_references": [{"source_name": "mitre-attack", "external_id": "T1087"}]}], "relationships": [{"id": "vulnerability-related_attack_pattern", "type": "vulnerability-related-attack-pattern", "relationship_type": "related_to", "source_ref": "CVE-2020-11439", "target_ref": "Local-File-Inclusion"}, {"id": "vulnerability-related_attack_pattern", "type": "vulnerability-related-attack-pattern", "relationship_type": "related_to", "source_ref": "CVE-2020-11439", "target_ref": "PHP-Code-Execution"}, {"id": "vulnerability-related_attack_pattern", "type": "vulnerability-related-attack-pattern", "relationship_type": "related_to", "source_ref": "CVE-2020-11439", "target_ref": "Arbitrary-Code-Execution"}]}]}}, "technical_analysis": {"Introduction": "CVE-2020-11439 is a Local File Inclusion vulnerability in LibreHealth EMR v2.0.0, enabling arbitrary PHP code inclusion and execution.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8, with a maximum severity rating of HIGH. It allows for SSRF and SSTI exploitation.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques identified include T1190, T1068, T1193, and T1087.", "Technical Details": "The Local File Inclusion vulnerability is a result of inadequate input validation and insecure code practices.", "Detection": "Detection involves monitoring for unusual Web traffic patterns, identifying injection attempts, and analyzing PHP execution logs.", "Mitigation": "Mitigation strategies include secure coding practices, input validation, secure configuration, and Web Application Firewalls (WAFs).", "Conclusion": "CVE-2020-11439 demonstrates the importance of secure coding practices, input validation, and secure configuration to prevent Local File Inclusion and other type of attacks."}, "executive_analysis": {"Overview": "CVE-2020-11439 is a critical vulnerability in LibreHealth EMR v2.0.0, allowing arbitrary PHP code inclusion and execution.", "Business Impact": "The vulnerability poses a significant risk to sensitive data and IT infrastructure, necessitating immediate attention and remediation.", "Technical Impact": "The vulnerability can lead to SSRF and SSTI exploitation, remote code execution, and increased attack surface.", "Mitigation Strategies": "Secure coding practices, input validation, secure configuration, and Web Application Firewalls (WAFs) can mitigate the risk.", "Recommendations": "Executives are recommended to implement the mitigation strategies and monitor for unusual Web traffic patterns to prevent exploitation.", "Conclusions": "CVE-2020-11439 is a critical vulnerability that requires immediate attention and remediation to prevent potential damage to the organization."}}