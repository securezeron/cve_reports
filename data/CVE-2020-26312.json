{"id": "CVE-2020-26312", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-14T21:15:10.587", "lastModified": "2024-05-15T16:40:19.330", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Dotmesh is a git-like command-line interface for capturing, organizing and sharing application states. In versions 0.8.1 and prior, the unsafe handling of symbolic links in an unpacking routine may \nenable attackers to read and/or write to arbitrary locations outside the\n designated target folder.\u00a0The routine `untarFile` attempts to guard against creating symbolic links that point outside the directory a tar archive is extracted to. However, a malicious tarball first linking `subdir/parent` to `..` (allowed, because `subdir/..` falls within the archive root) and then linking `subdir/parent/escapes` to `..` results in a symbolic link pointing to the tarball\u2019s parent directory, contrary to the routine\u2019s goals. This issue may lead to arbitrary file write (with same permissions as the program running the unpack operation) if the attacker can control the archive file. Additionally, if the attacker has read access to the unpacked files, they may be able to read arbitrary system files the parent process has permissions to read. As of time of publication, no patch for this issue is available.\n"}, {"lang": "es", "value": "Dotmesh es una interfaz de l\u00ednea de comandos similar a git para capturar, organizar y compartir estados de aplicaciones. En las versiones 0.8.1 y anteriores, el manejo inseguro de enlaces simb\u00f3licos en una rutina de descompresi\u00f3n puede permitir a los atacantes leer y/o escribir en ubicaciones arbitrarias fuera de la carpeta de destino designada. La rutina `untarFile` intenta evitar la creaci\u00f3n de enlaces simb\u00f3licos que apunten fuera del directorio al que se extrae un archivo tar. Sin embargo, un tarball malicioso que primero vincula `subdir/parent` a `..` (permitido, porque `subdir/..` se encuentra dentro de la ra\u00edz del archivo) y luego vincula `subdir/parent/escapes` a `..` da como resultado un enlace simb\u00f3lico que apunta al directorio principal del tarball, contrario a los objetivos de la rutina. Este problema puede provocar la escritura arbitraria de archivos (con los mismos permisos que el programa que ejecuta la operaci\u00f3n de descomprimir) si el atacante puede controlar el archivo comprimido. Adem\u00e1s, si el atacante tiene acceso de lectura a los archivos descomprimidos, es posible que pueda leer archivos arbitrarios del sistema para los que el proceso principal tiene permisos de lectura. Al momento de la publicaci\u00f3n, no hay ning\u00fan parche disponible para este problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-125"}, {"lang": "en", "value": "CWE-787"}]}], "references": [{"url": "https://github.com/dotmesh-io/dotmesh/blob/master/pkg/archiver/tar.go#L255", "source": "security-advisories@github.com"}, {"url": "https://securitylab.github.com/advisories/GHSL-2020-254-zipslip-dotmesh/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2020-26312 - The unsafe handling of symbolic links in the unpacking routine allows attackers to read and write arbitrary locations outside the designated target folder, enabling lateral movement. This can be detected using file integrity monitoring and process monitoring tools."}, {"techniqueID": "T1027.001", "comment": "CVE-2020-26312 - The use of malicious tarballs with symbolic links pointing to the tarball's parent directory allows attackers to read and write arbitrary locations outside the designated target folder, enabling data theft. This can be detected using file integrity monitoring and process monitoring tools."}, {"techniqueID": "T1190", "comment": "CVE-2020-26312 - The use of arbitrary file write capabilities to write malicious files, potentially leading to privilege escalation. This can be detected using file integrity monitoring and process monitoring tools."}, {"techniqueID": "T1190.001", "comment": "CVE-2020-26312 - The use of read access to read system files potentially leading to data theft. This can be detected using file integrity monitoring and process monitoring tools."}, {"techniqueID": "T1562.001", "comment": "CVE-2020-26312 - The use of a tampered tarball to execute arbitrary code on the system. This can be detected using file integrity monitoring and process monitoring tools."}], "stix_bundle": {"@include": "stix2.inc", "type": "bundle", "id": "bundle--CVE-2020-26312", "created_by": "Your Name", "created": "2024-05-15T16:40:19.330", "description": "STIX bundle for CVE-2020-26312", "objects": [{"type": "vulnerability", "id": "vulnerability--CVE-2020-26312", "created_by": "Your Name", "created": "2024-05-15T16:40:19.330", "description": "CVE-2020-26312: Dotmesh is a git-like command-line interface for capturing, organizing and sharing application states. In versions 0.8.1 and prior, the unsafe handling of symbolic links in an unpacking routine may enable attackers to read and/or write to arbitrary locations outside the designated target folder.", "attributes": {"cvssV3_vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "cvssV3_baseScore": 8.1, "cvssV3_baseSeverity": "HIGH", "exploitability_score": 2.8, "impact_score": 5.2}, "relationships": [{"type": "indicates", "id": "indicates--CVE-2020-26312-T1027", "started": "2024-05-15T16:40:19.330", "ended": "2024-05-15T16:40:19.330", "created": "2024-05-15T16:40:19.330", "modified": "2024-05-15T16:40:19.330", "to": {"id": "technique--T1027"}}, {"type": "indicates", "id": "indicates--CVE-2020-26312-T1190", "started": "2024-05-15T16:40:19.330", "ended": "2024-05-15T16:40:19.330", "created": "2024-05-15T16:40:19.330", "modified": "2024-05-15T16:40:19.330", "to": {"id": "technique--T1190"}}, {"type": "indicates", "id": "indicates--CVE-2020-26312-T1562.001", "started": "2024-05-15T16:40:19.330", "ended": "2024-05-15T16:40:19.330", "created": "2024-05-15T16:40:19.330", "modified": "2024-05-15T16:40:19.330", "to": {"id": "technique--T1562.001"}}]}]}, "technical_analysis": {"Introduction": "Dotmesh is a git-like command-line interface for capturing, organizing and sharing application states. In versions 0.8.1 and prior, the unsafe handling of symbolic links in an unpacking routine may enable attackers to read and/or write to arbitrary locations outside the designated target folder.", "Impact and Scope": "The impact of this CVE is high, with a CVSS score of 8.1. The scope is network, with the attack vector being network.", "Related MITRE ATT&CK Techniques": "T1027, T1190, T1562.001", "Technical Details": "The vulnerability occurs in the `untarFile` routine, which is responsible for unpacking tarballs. A malicious tarball can be created with symbolic links pointing to the tarball's parent directory, allowing attackers to read and write arbitrary locations outside the designated target folder.", "Detection": "File integrity monitoring and process monitoring tools can be used to detect this CVE.", "Mitigation": "The vulnerability can be mitigated by updating to version 0.8.2 or later, which addresses the issue.", "Conclusion": "This CVE is a high-severity vulnerability that can be exploited to read and write arbitrary locations outside the designated target folder."}, "executive_analysis": {"Overview": "Dotmesh is a git-like command-line interface for capturing, organizing and sharing application states. In versions 0.8.1 and prior, the unsafe handling of symbolic links in an unpacking routine may enable attackers to read and/or write to arbitrary locations outside the designated target folder.", "Business Impact": "This CVE has a high business impact due to the potential for data theft and privilege escalation.", "Technical Impact": "The technical impact is high, with a CVSS score of 8.1.", "Mitigation Strategies": "Updating to version 0.8.2 or later is the recommended mitigation strategy.", "Recommendations": "Executives should prioritize the update and ensure that all systems are up-to-date.", "Conclusions": "This CVE is a high-severity vulnerability that requires immediate attention and action."}}