{"id": "CVE-2024-34694", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-14T15:15:50.637", "lastModified": "2024-06-17T12:42:04.623", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "LNbits is a Lightning wallet and accounts system. Paying invoices in Eclair that do not get settled within the internal timeout (about 30s) lead to a payment being considered failed, even though it may still be in flight. This vulnerability can lead to a total loss of funds for the node backend. This vulnerability is fixed in 0.12.6.\n"}, {"lang": "es", "value": "LNbits es un sistema de cuentas y billetera Lightning. Pagar facturas en Eclair que no se liquidan dentro del tiempo de espera interno (alrededor de 30 segundos) hace que el pago se considere fallido, aunque todav\u00eda pueda estar en proceso. Esta vulnerabilidad puede provocar una p\u00e9rdida total de fondos para el backend del nodo. Esta vulnerabilidad se solucion\u00f3 en 0.12.6."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-754"}]}], "references": [{"url": "https://github.com/lnbits/lnbits/security/advisories/GHSA-3j4h-h3fp-vwww", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0003", "comment": "T1590 - Server-Side Request Forgery - This technique is relevant as it can be used to exploit the vulnerability by modifying the Eclair invoices to lead to a total loss of funds for the node backend."}, {"techniqueID": "T1190", "comment": "T1190 - Exploitation of Authentication Mechanism - This technique is relevant as it can be used to exploit the vulnerability by using leaked authentication information to pay invoices in Eclair."}, {"techniqueID": "T1499", "comment": "T1499 - Encryption of Sensitive Information - This technique is relevant as it can be used to exploit the vulnerability by encrypting sensitive information, such as payment invoices, to make them harder to detect."}, {"techniqueID": "T1496", "comment": "T1496 - Data Luring - This technique is relevant as it can be used to exploit the vulnerability by tricking the node backend into accepting malicious invoices."}], "technical_analysis": {"Introduction": "The CVE-2024-34694 is a vulnerability in the LNbits Lightning wallet and accounts system that allows attackers to exploit the Eclair invoices payment functionality to lead to a total loss of funds for the node backend.", "Impact and Scope": "The vulnerability has a CVSS score of 8.1, with an attack vector of NETWORK, and an attack complexity of LOW. The confidentiality impact is NONE, the integrity impact is HIGH, and the availability impact is HIGH.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1590, T1190, T1499, and T1496.", "Technical Details": "The vulnerability occurs when paying invoices in Eclair that do not get settled within the internal timeout (about 30s) lead to a payment being considered failed, even though it may still be in flight.", "Detection": "The vulnerability can be detected by monitoring for unauthorized changes to the node backend's payment invoices and by reviewing the node's payment logs for suspicious activity.", "Mitigation": "The vulnerability can be mitigated by implementing additional validation and verification of payment invoices, and by implementing rate limiting and IP blocking for suspicious activity.", "Conclusion": "The CVE-2024-34694 is a serious vulnerability that requires prompt attention and mitigation to prevent attacks. Detection and mitigation strategies are outlined above."}, "executive_analysis": {"Overview": "The CVE-2024-34694 is a vulnerability in the LNbits Lightning wallet and accounts system that poses a high risk to the node backend's payment functionality.", "Business Impact": "The vulnerability could lead to a total loss of funds for the node backend, resulting in significant financial losses.", "Technical Impact": "The vulnerability allows attackers to exploit the Eclair invoices payment functionality, making it a serious threat to the node's payment security.", "Mitigation Strategies": "Implementing additional validation and verification of payment invoices, and implementing rate limiting and IP blocking for suspicious activity are recommended mitigation strategies.", "Recommendations": "It is recommended that executives prioritize the mitigation of this vulnerability to prevent attacks and minimize financial losses.", "Conclusions": "The CVE-2024-34694 is a serious vulnerability that requires prompt attention and mitigation to prevent attacks. Executives should prioritize the mitigation of this vulnerability and work with the technical team to implement effective mitigation strategies."}}