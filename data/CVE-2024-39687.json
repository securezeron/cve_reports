{"id": "CVE-2024-39687", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-05T18:15:32.663", "lastModified": "2024-07-08T15:49:22.437", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Fedify is a TypeScript library for building federated server apps powered by ActivityPub and other standards. At present, when Fedify needs to retrieve an object or activity from a remote activitypub server, it makes a HTTP request to the `@id` or other resources present within the activity it has received from the web. This activity could reference an `@id` that points to an internal IP address, allowing an attacker to send request to resources internal to the fedify server's network. This applies to not just resolution of documents containing activities or objects, but also to media URLs as well. Specifically this is a Server Side Request Forgery attack. Users should upgrade to Fedify version 0.9.2, 0.10.1, or 0.11.1 to receive a patch for this issue."}, {"lang": "es", "value": "Fedify es una biblioteca de TypeScript para crear aplicaciones de servidor federado impulsadas por ActivityPub y otros est\u00e1ndares. En la actualidad, cuando Fedify necesita recuperar un objeto o actividad de un servidor de actividad remoto, realiza una solicitud HTTP al `@id` u otros recursos presentes dentro de la actividad que ha recibido de la web. Esta actividad podr\u00eda hacer referencia a un `@id` que apunta a una direcci\u00f3n IP interna, permitiendo a un atacante enviar solicitudes a recursos internos de la red del servidor de Fedify. Esto se aplica no s\u00f3lo a la resoluci\u00f3n de documentos que contienen actividades u objetos, sino tambi\u00e9n a las URL de medios. Espec\u00edficamente, se trata de un ataque de Server Side Request Forgery. Los usuarios deben actualizar a Fedify versi\u00f3n 0.9.2, 0.10.1 o 0.11.1 para recibir un parche para este problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 2.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-918"}]}], "references": [{"url": "https://github.com/dahlia/fedify/commit/30f9cf4a175704a04c874f3ea88414c5f1e00b28", "source": "security-advisories@github.com"}, {"url": "https://github.com/dahlia/fedify/commit/c641e976089dd913f649889c1bfb016df04e86ba", "source": "security-advisories@github.com"}, {"url": "https://github.com/dahlia/fedify/security/advisories/GHSA-p9cg-vqcc-grcx", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-39687 - A Server Side Request Forgery (SSRF) attack by making HTTP requests to internal IP addresses, exploiting the Fedify library's use of uncertain '@id' values."}, {"techniqueID": "T1190", "comment": "CVE-2024-39687 - An access of network resource by using uncertain '@id' values to send requests to internal IP addresses, compromising the confidentiality, integrity, and availability of the system."}, {"techniqueID": "T1037", "comment": "CVE-2024-39687 - An execution of a network payload by manipulating the Fedify library to send requests to internal IP addresses, potentially leading to the execution of malicious code."}, {"techniqueID": "T1560", "comment": "CVE-2024-39687 - An exploitation of a remote service by using the Fedify library's SSRF vulnerability to access internal resources, potentially leading to the compromise of sensitive data."}, {"techniqueID": "T1499", "comment": "CVE-2024-39687 - A destructive data operations by exploiting the Fedify library's SSRF vulnerability to access internal resources, potentially leading to data destruction or corruption."}], "stix_bundle": {"$type": "Bundle", "objects": [{"$type": "Vulnerability", "id": "CVE-2024-39687", "name": "Fedify Library SSRF vulnerability", "description": "A Server Side Request Forgery (SSRF) attack by making HTTP requests to internal IP addresses, exploiting the Fedify library's use of uncertain '@id' values."}, {"$type": "TTP", "id": "T1210", "name": "Exploitation of Public-Facing Application", "description": "An adversary exploits a publicly facing application by making HTTP requests to internal IP addresses, compromising the confidentiality, integrity, and availability of the system."}, {"$type": "Node", "id": "Node-1", "name": "Fedify Library", "description": "A TypeScript library for building federated server apps powered by ActivityPub and other standards."}, {"$type": "Relationship", "id": "Relationship-1", "type": "Vulnerable_Configuration", "source": "Node-1", "target": "CVE-2024-39687", "description": "The Fedify library's SSRF vulnerability allows an attacker to make HTTP requests to internal IP addresses."}, {"$type": "Course_of_Action", "id": "Course-1", "name": "Upgrade to Federify 0.9.2, 0.10.1, or 0.11.1", "description": "Upgrade to a patched version of the Fedify library to mitigate the SSRF vulnerability.", "techniques": ["T1210"]}]}, "technical_analysis": {"Introduction": "The Fedify library's SSRF vulnerability allows an attacker to make HTTP requests to internal IP addresses, compromising the confidentiality, integrity, and availability of the system.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2, with a high severity rating. It affects versions 0.9.0 and earlier of the Fedify library.", "Related MITRE ATT&CK Techniques": "T1210, T1190, T1037, T1560, T1499", "Technical Details": "The vulnerability is caused by the Fedify library's use of uncertain '@id' values to make HTTP requests to internal IP addresses.", "Detection": "Detection methods for the vulnerability include monitoring network traffic for suspicious requests and running vulnerability scanning tools.", "Mitigation": "Mitigation strategies for the vulnerability include upgrading to a patched version of the Fedify library and implementing network segmentation.", "Conclusion": "The Fedify library's SSRF vulnerability is a critical threat to system security and must be addressed promptly."}, "executive_analysis": {"Overview": "The Fedify library's SSRF vulnerability is a critical security threat that could compromise sensitive data and disrupt business operations.", "Business Impact": "The vulnerability could result in reputational damage, loss of customer trust, and significant financial losses.", "Technical Impact": "The vulnerability could lead to unauthorized access to sensitive data, disruption of business operations, and compromise of system security.", "Mitigation Strategies": "Implement network segmentation and upgrade to a patched version of the Fedify library.", "Recommendations": "Patch the vulnerability promptly, conduct regular security testing, and implement incident response planning.", "Conclusions": "The Fedify library's SSRF vulnerability is a high-priority security threat that requires immediate attention and action."}}