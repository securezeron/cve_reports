{"id": "CVE-2024-39918", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-15T20:15:04.160", "lastModified": "2024-07-16T13:43:58.773", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "@jmondi/url-to-png is an open source URL to PNG utility featuring parallel rendering using Playwright for screenshots and with storage caching via Local, S3, or CouchDB. Input of the `ImageId` in the code is not sanitized and may lead to path traversal. This allows an attacker to store an image in an arbitrary location that the server has permission to access. This issue has been addressed in version 2.1.2 and all users are advised to upgrade. There are no known workarounds for this vulnerability.\n"}, {"lang": "es", "value": "@jmondi/url-to-png es una utilidad de c\u00f3digo abierto de URL a PNG que presenta renderizado paralelo usando Playwright para capturas de pantalla y con almacenamiento en cach\u00e9 a trav\u00e9s de Local, S3 o CouchDB. La entrada de \"ImageId\" en el c\u00f3digo no est\u00e1 sanitizado y puede provocar un path traversal. Esto permite a un atacante almacenar una imagen en una ubicaci\u00f3n arbitraria a la que el servidor tiene permiso para acceder. Este problema se solucion\u00f3 en la versi\u00f3n 2.1.2 y se recomienda a todos los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-22"}]}], "references": [{"url": "https://github.com/jasonraimondi/url-to-png/blob/e43098e0af3a380ebc044e7f303a83933b94b434/src/middlewares/extract_query_params.ts#L75", "source": "security-advisories@github.com"}, {"url": "https://github.com/jasonraimondi/url-to-png/commit/e4eaeca6493b21cd515b582fd6c0af09ede54507", "source": "security-advisories@github.com"}, {"url": "https://github.com/jasonraimondi/url-to-png/security/advisories/GHSA-vvmv-wrvp-9gjr", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-39918 - This path traversal vulnerability allows an attacker to store an image in an arbitrary location that the server has permission to access, enabling them to potentially elevate privileges or access sensitive data."}, {"techniqueID": "T1191", "comment": "CVE-2024-39918 - The exploitation of this vulnerability can be carried out by sending a specially crafted request that includes an attacker-controlled user-supplied input, enabling a path traversal attack."}, {"techniqueID": "T1078", "comment": "CVE-2024-39918 - An attacker could potentially use this path traversal vulnerability to create a new file or directory with a file name traversal, enabling them to escalate privileges or perform further malicious actions."}, {"techniqueID": "T1189", "comment": "CVE-2024-39918 - This vulnerability can be exploited by sending a series of crafted requests with the malicious input, allowing an attacker to traverse the file system and potentially access sensitive files."}], "stix_bundle": {"bundle_type": "STIXBundle", "objects": [{"type": "vulnerability", "id": "vuln-CVE-2024-39918", "number": "CVE-2024-39918", "threat_actor": {"type": "individual", "id": "threat-actor-attackers"}, "maltopattern": {"type": "pattern", "id": "pattern-cve-2024-39918"}, "observable": {"type": "observable", "id": "observable-cve-2024-39918"}, "campaign": {"type": "campaign", "id": "campaign-cve-2024-39918"}, "indicator": {"type": "indicator", "id": "indicator-cve-2024-39918"}, " Course-of-Action": {"type": "course-of-action", "id": "course-of-action-cve-2024-39918"}}, {"type": "intrusion-set", "id": "intrusion-set-attackers", "description": "Attackers exploiting CVE-2024-39918"}, {"type": "pattern", "id": "pattern-cve-2024-39918", "name": "CVE-2024-39918 exploitation pattern"}, {"type": "observable", "id": "observable-cve-2024-39918", "description": "CVE-2024-39918 exploitation observable"}, {"type": "course-of-action", "id": "course-of-action-cve-2024-39918", "description": "Course of action for mitigating CVE-2024-39918"}], "incidents": [{"type": "incident", "id": "incident-cve-2024-39918", "summary": "CVE-2024-39918 exploitation detected"}], "analysis": [{"type": "analysis", "id": "analysis-cve-2024-39918", "description": "Analysis of CVE-2024-39918 exploitation"}]}, "technical_analysis": {"Introduction": "CVE-2024-39918 is a path traversal vulnerability in the @jmondi/url-to-png utility, allowing an attacker to store an image in an arbitrary location.", "Impact and Scope": "This vulnerability has a CVSS score of 4.3 (MEDIUM) and affects the @jmondi/url-to-png utility in all versions prior to 2.1.2.", "Related MITRE ATT&CK Techniques": "T1190, T1191, T1078, and T1189", "Technical Details": "The vulnerability occurs due to the lack of input validation in the `ImageId` field, allowing an attacker to specify a directory traversal string.", "Detection": "Detection can be carried out by monitoring system logs for suspicious file access and creation requests or by using network-based security controls to identify and block malicious traffic.", "Mitigation": "Mitigation strategies include updating to version 2.1.2 or later, restricting access to sensitive files and directories, and implementing input validation and sanitization.", "Conclusion": "CVE-2024-39918 is a path traversal vulnerability with significant potential impact, and prompt remediation is recommended."}, "executive_analysis": {"Overview": "CVE-2024-39918 is a critical vulnerability in the @jmondi/url-to-png utility that allows an attacker to store an image in an arbitrary location.", "Business Impact": "This vulnerability has the potential to impact business operations, compromise sensitive data, and lead to reputational damage.", "Technical Impact": "The vulnerability can be exploited to elevate privileges, access sensitive files, and perform further malicious actions.", "Mitigation Strategies": "Implementing input validation and sanitization, updating to version 2.1.2 or later, and restricting access to sensitive files and directories.", "Recommendations": "Review and update the @jmondi/url-to-png utility, implement security controls, and conduct regular security assessments.", "Conclusions": "CVE-2024-39918 is a significant vulnerability that requires prompt attention and remediation to minimize potential impact."}}