{"id": "CVE-2007-3577", "sourceIdentifier": "cve@mitre.org", "published": "2007-07-05T20:30:00.000", "lastModified": "2023-11-07T02:00:51.950", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHPIDS before 20070703 does not properly handle use of the substr method in (1) document.location.search and (2) document.referrer; (3) certain use of document.location.hash; (4) certain \"window[eval\" and similar expressions; (5) certain Function expressions; (6) certain '=' expressions, as demonstrated by a 'whatever=\"something\"' sequence; and (7) certain \"with\" expressions, which allows remote attackers to inject arbitrary web script."}, {"lang": "es", "value": "PHPIDS anterior al 03/07/2007 no maneja adecuadamente el m\u00e9todo substr en (1) document.location.search y (2) document.referrer; (3) cierto uso de document.location.hash; (4) cierta expresi\u00f3n \"window[eval\" y expresiones similares; (5) ciertas expresiones de funciones; (6) ciertas expresiones '=', como ha sido demostrado por la secuencia 'whatever=\"something\"'; y (7) ciertas expresiones \"with\", lo cual permite a atacantes remotos inyectar secuencias de comandos web o HTML de su elecci\u00f3n."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpids:phpids:*:*:*:*:*:*:*:*", "matchCriteriaId": "9BE66088-CEDD-41AC-8A44-B8BB32E2BCA7"}]}]}], "references": [{"url": "http://groups.google.com/group/php-ids/browse_thread/thread/3ec15f69d6b3dba0", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/45759", "source": "cve@mitre.org"}, {"url": "http://sla.ckers.org/forum/read.php?2%2C13209%2C13218", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/35489", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059.001", "comment": "CVE-2007-3577 - PHPIDS is vulnerable to a Cross-Site Scripting (XSS) attack. An attacker can inject malicious JavaScript code in (1) document.location.search and (2) document.referrer. This allows remote attackers to inject arbitrary web script."}, {"techniqueID": "T1190", "comment": "CVE-2007-3577 - PHPIDS is also vulnerable to a Command Injection attack. The substr method is not properly handled, which allows remote attackers to execute arbitrary commands."}, {"techniqueID": "T1222", "comment": "CVE-2007-3577 - PHPIDS is also vulnerable to a Cross-Site Request Forgery (CSRF) attack. An attacker can trick victims into making unintended requests to a web application."}], "stix_bundle": {"@id": "bundle-1", "type": "bundle", "spec_version": "2.1", "objects": [{"id": "node-1", "type": "indicator", "name": "PHPIDS Cross-Site Scripting Vulnerability", "created_by_ref": "identity-1", "modified": "2023-11-07T02:00:51.950", "description": "PHPIDS is vulnerable to a Cross-Site Scripting (XSS) attack.", "first_seen": "2007-07-05T20:30:00.000", "last_seen": "2023-11-07T02:00:51.950", "objects": [{"id": "node-2", "type": "course-of-action", "name": "Update PHPIDS", "description": "Update PHPIDS to a version that fixes the vulnerability."}]}, {"id": "node-3", "type": "course-of-action", "name": "Avoid Using the Substr Method", "description": "Avoid using the substr method in document.location.search and document.referrer to prevent Command Injection attacks."}], "relationship": [{"id": "relation-1", "type": "indicated", "target_ref": "node-1", "source_ref": "node-2"}]}, "technical_analysis": {"Introduction": "PHPIDS is a popular open-source security tool that helps identify and prevent various types of attacks. However, it is vulnerable to several types of attacks, including Cross-Site Scripting (XSS), Command Injection, and Cross-Site Request Forgery (CSRF).", "Impact and Scope": "The vulnerability has a CVSS score of 4.3 with a medium severity. It affects PHPIDS versions before 20070703 and can be exploited by remote attackers.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including T1059.001, T1190, and T1222.", "Technical Details": "The vulnerability is due to the use of the substr method in PHPIDS, which is not properly handled. This allows attackers to inject malicious JavaScript code or execute arbitrary commands.", "Detection": "Detection of the vulnerability can be done by monitoring for suspicious requests to PHPIDS and looking for patterns that indicate the use of the substr method.", "Mitigation": "Mitigation strategies include updating PHPIDS to a version that fixes the vulnerability, avoiding the use of the substr method in document.location.search and document.referrer, and monitoring for suspicious requests to PHPIDS.", "Conclusion": "In conclusion, the PHPIDS vulnerability is a significant threat that can be exploited by remote attackers. It is essential to take immediate action to mitigate the vulnerability and prevent attacks."}, "executive_analysis": {"Overview": "The PHPIDS vulnerability is a significant threat that can be exploited by remote attackers. It is essential to take immediate action to mitigate the vulnerability and prevent attacks.", "Business Impact": "The vulnerability can result in significant business losses and damage to the company's reputation.", "Technical Impact": "The vulnerability can result in the execution of arbitrary commands or the injection of malicious JavaScript code.", "Mitigation Strategies": "The company should update PHPIDS to a version that fixes the vulnerability, avoid using the substr method in document.location.search and document.referrer, and monitoring for suspicious requests to PHPIDS.", "Recommendations": "The company should implement a robust security framework that includes regular security testing and vulnerability assessments.", "Conclusions": "In conclusion, the PHPIDS vulnerability is a significant threat that requires immediate attention. The company should take immediate action to mitigate the vulnerability and prevent attacks."}}