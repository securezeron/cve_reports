{"id": "CVE-2024-42489", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-12T16:15:16.667", "lastModified": "2024-08-12T18:57:17.383", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Pro Macros provides XWiki rendering macros. Missing escaping in the Viewpdf macro allows any user with view right on the `CKEditor.HTMLConverter` page or edit or comment right on any page to perform remote code execution. Other macros like Viewppt are vulnerable to the same kind of attack. This vulnerability is fixed in 1.10.1."}, {"lang": "es", "value": "Pro Macros proporciona macros de renderizado de XWiki. La falta de escape en la macro Viewpdf permite a cualquier usuario con vista directa en la p\u00e1gina `CKEditor.HTMLConverter` o editar o comentar directamente en cualquier p\u00e1gina realizar la ejecuci\u00f3n remota de c\u00f3digo. Otras macros como Viewppt son vulnerables al mismo tipo de ataque. Esta vulnerabilidad se solucion\u00f3 en 1.10.1."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-74"}]}], "references": [{"url": "https://github.com/xwikisas/xwiki-pro-macros/blob/main/xwiki-pro-macros-ui/src/main/resources/Confluence/Macros/Viewpdf.xml#L265-L267", "source": "security-advisories@github.com"}, {"url": "https://github.com/xwikisas/xwiki-pro-macros/commit/199553c84901999481a20614f093af2d57970eba", "source": "security-advisories@github.com"}, {"url": "https://github.com/xwikisas/xwiki-pro-macros/security/advisories/GHSA-cfq3-q227-7j65", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1204.001", "comment": "CVE-2024-42489 - Unquoted System Path is a relevant technique in exploitation, as the vulnerability allows remote code execution. Defend against it by validating file paths and restricting file system access."}, {"techniqueID": "T1210", "comment": "CVE-2024-42489 - Exploitation of this vulnerability is likely done through Network exploitation. Defend against it by implementing strict network access controls and monitoring network traffic."}, {"techniqueID": "T1501", "comment": "CVE-2024-42489 - This vulnerability can be used for Command and Control. Defend against it by implementing Network logs analysis and monitoring and validating commands sent to the system."}], "stix_bundle": {"objects": [{"id": "va-CVE-2024-42489", "type": "vulnerability", "name": "CVE-2024-42489", "description": "Missing escaping in the Viewpdf macro allows any user with view right on the `CKEditor.HTMLConverter` page or edit or comment right on any page to perform remote code execution.", "cvss": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"}}, {"id": "ta-T1204.001", "type": "attack-pattern", "name": "T1204.001", "description": "Unquoted System Path", "external_references": {"source_name": "MITRE", "external_id": "T1204.001"}}, {"id": "ta-T1210", "type": "attack-pattern", "name": "T1210", "description": "Exploitation", "external_references": {"source_name": "MITRE", "external_id": "T1210"}}, {"id": "ta-T1501", "type": "attack-pattern", "name": "T1501", "description": "Command and Control", "external_references": {"source_name": "MITRE", "external_id": "T1501"}}, {"id": "course-of-action-1", "type": "course-of-action", "name": "Validate File Paths", "description": "Validate file paths to prevent exploitation", "related_techniques": [{"id": "ta-T1204.001", "role": " Mitigates"}]}, {"id": "course-of-action-2", "type": "course-of-action", "name": "Implement Network Logs Analysis", "description": "Implement Network logs analysis to monitor and detect command and control traffic", "related_techniques": [{"id": "ta-T1501", "role": "Mitigates"}]}], "relationship": [{"id": "rel-1", "type": "related-to", "object_id": "va-CVE-2024-42489", "object_ref": "ta-T1204.001"}, {"id": "rel-2", "type": "related-to", "object_id": "va-CVE-2024-42489", "object_ref": "ta-T1210"}, {"id": "rel-3", "type": "related-to", "object_id": "va-CVE-2024-42489", "object_ref": "ta-T1501"}, {"id": "rel-4", "type": "mitigates", "object_id": "va-CVE-2024-42489", "object_ref": "course-of-action-1"}, {"id": "rel-5", "type": "mitigates", "object_id": "va-CVE-2024-42489", "object_ref": "course-of-action-2"}]}, "technical_analysis": {"Introduction": "Introduction content.", "Impact and Scope": "Details on the impact and scope of the CVE, mentioning cvss score with version and attack vector.", "Related MITRE ATT&CK Techniques": "List of related MITRE ATT&CK Techniques and their relevance to the CVE.", "Technical Details": "In-depth technical details of the CVE.", "Detection": "Methods for detecting the CVE.", "Mitigation": "Mitigation strategies for the CVE.", "Conclusion": "Summary and conclusions."}, "executive_analysis": {"Overview": "Overview of the CVE.", "Business Impact": "Explanation of the business impact of the CVE.", "Technical Impact": "Explanation of the technical impact of the CVE.", "Mitigation Strategies": "High-level mitigation strategies.", "Recommendations": "Recommendations for executives.", "Conclusions": "Final conclusions and next steps."}}