{"id": "CVE-2024-38047", "sourceIdentifier": "secure@microsoft.com", "published": "2024-07-09T17:15:32.853", "lastModified": "2024-07-11T18:11:42.987", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "PowerShell Elevation of Privilege Vulnerability"}, {"lang": "es", "value": "Vulnerabilidad de elevaci\u00f3n de privilegios de PowerShell"}], "metrics": {"cvssMetricV31": [{"source": "secure@microsoft.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "secure@microsoft.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1607:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.14393.7159", "matchCriteriaId": "BEEE46C5-718B-43C5-8B06-A4CB2E0DEF7A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1809:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.17763.6054", "matchCriteriaId": "3EE3B092-248B-4F68-AA13-DF4FB2E0DA3F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_21h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.19044.4651", "matchCriteriaId": "905A0D97-FCF2-4999-A3F3-C79D88511D52"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_22h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.19045.4651", "matchCriteriaId": "2DEB25D6-2E73-4DF4-9D7D-2C9780101B1B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_21h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22000.3079", "matchCriteriaId": "1F4C0A5A-B376-4DE8-A02A-5E341825AAAB"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_22h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22621.3880", "matchCriteriaId": "A2B9B3F1-347C-4935-BFA9-6B4191831D28"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_23h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22631.3880", "matchCriteriaId": "E199129F-7F75-42C8-ABA0-7439FE50676B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2016:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.14393.7159", "matchCriteriaId": "59C9A2A5-AE44-4583-A7B1-B8D62B0E83BB"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2019:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.17763.6054", "matchCriteriaId": "3401E6F7-2430-4247-8A22-0B733A03501A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.20348.2582", "matchCriteriaId": "4E433A09-F730-4EBE-8050-8789755B0D35"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022_23h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.25398.1009", "matchCriteriaId": "EDA01A4A-9AED-484A-8B10-3282FA13F635"}]}]}], "references": [{"url": "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38047", "source": "secure@microsoft.com", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1222", "comment": "CVE-2024-38047 - This PowerShell Elevation of Privilege vulnerability allows an attacker to elevate privileges, this can be mitigated by patching the vulnerability and ensuring secure configurations of PowerShell."}, {"techniqueID": "T1210", "comment": "CVE-2024-38047 - This vulnerability can be exploited by an attacker to execute code at a higher level of privilege, D3FEND tactic 'Filter Network Traffic' can be used to detect and prevent this type of activity."}, {"techniqueID": "T1185", "comment": "CVE-2024-38047 - This PowerShell Elevation of Privilege vulnerability can be detected using an AWS CloudWatch log metric that monitors PowerShell execution, the D3FEND tactic 'Monitor File Access' can be used to detect and prevent this type of activity."}, {"techniqueID": "T1078", "comment": "CVE-2024-38047 - This vulnerability can be exploited by an attacker to bypass user account controls, D3FEND tactic 'Implement Granular File Permissions' can be used to detect and prevent this type of activity."}, {"techniqueID": "T1203", "comment": "CVE-2024-38047 - This PowerShell Elevation of Privilege vulnerability can be detected using a Windows Defender Advanced Threat Protection (ATP) sensor, the D3FEND tactic 'Implement Memory Access Control' can be used to detect and prevent this type of activity."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/CVE-2024-38047", "created_by_ref": "https://example.com/ Analyst", "created": "2024-07-11T18:11:42.987", "modified": "2024-07-11T18:11:42.987", "objects": [{"id": "https://example.com/CVE-2024-38047", "type": "vulnerability", "created_by_ref": "https://example.com/ Analyst", "created": "2024-07-11T18:11:42.987", "modified": "2024-07-11T18:11:42.987", "name": "CVE-2024-38047", "description": "PowerShell Elevation of Privilege Vulnerability", "extended_properties": [{"name": "CVE ID", "value": "CVE-2024-38047"}, {"name": "CVSS Score", "value": 7.8}, {"name": "Attack Vector", "value": "LOCAL"}], "relationships": [{"type": "has_note", "id": "https://example.com/CVE-2024-38047-note", "note": {"id": "https://example.com/CVE-2024-38047-note", "type": "note", "created_by_ref": "https://example.com/ Analyst", "created": "2024-07-11T18:11:42.987", "modified": "2024-07-11T18:11:42.987", "content": "PowerShell Elevation of Privilege vulnerability allows an attacker to elevate privileges, this can be mitigated by patching the vulnerability and ensuring secure configurations of PowerShell."}}]}, {"id": "https://example.com/CVE-2024-38047-note", "type": "note", "created_by_ref": "https://example.com/ Analyst", "created": "2024-07-11T18:11:42.987", "modified": "2024-07-11T18:11:42.987", "content": "PowerShell Elevation of Privilege vulnerability allows an attacker to elevate privileges, this can be mitigated by patching the vulnerability and ensuring secure configurations of PowerShell."}, {"id": "https://example.com/T1210", "type": "attack-pattern", "created_by_ref": "https://example.com/ Analyst", "created": "2024-07-11T18:11:42.987", "modified": "2024-07-11T18:11:42.987", "name": "Local Privilege Escalation", "description": "An attacker exploits a vulnerability to elevate privileges on a local system.", "extended_properties": [{"name": "techniqueID", "value": "T1210"}], "relationships": [{"type": "mitigates", "id": "https://example.com/CVE-2024-38047-CVE-2024-38047-note", "note": {"id": "https://example.com/CVE-2024-38047-CVE-2024-38047-note", "type": "note", "created_by_ref": "https://example.com/ Analyst", "created": "2024-07-11T18:11:42.987", "modified": "2024-07-11T18:11:42.987", "content": "This vulnerability can be exploited by an attacker to execute code at a higher level of privilege, D3FEND tactic 'Filter Network Traffic' can be used to detect and prevent this type of activity."}}]}, {"id": "https://example.com/CVE-2024-38047-CVE-2024-38047-note", "type": "note", "created_by_ref": "https://example.com/ Analyst", "created": "2024-07-11T18:11:42.987", "modified": "2024-07-11T18:11:42.987", "content": "This vulnerability can be exploited by an attacker to execute code at a higher level of privilege, D3FEND tactic 'Filter Network Traffic' can be used to detect and prevent this type of activity."}]}, "technical_analysis": {"Introduction": "CVE-2024-38047 is a PowerShell Elevation of Privilege vulnerability that allows an attacker to elevate privileges.", "Impact and Scope": "The vulnerability has a CVSS score of 7.8 and can be exploited by an attacker to execute code at a higher level of privilege.", "Related MITRE ATT&CK Techniques": "T1210, T1078, T1203, T1222", "Technical Details": "The vulnerability occurs when an attacker exploits a vulnerability in PowerShell's implementation of the Windows API.", "Detection": "This vulnerability can be detected using an AWS CloudWatch log metric that monitors PowerShell execution, the D3FEND tactic 'Monitor File Access' can be used to detect and prevent this type of activity.", "Mitigation": "The vulnerability can be mitigated by patching the vulnerable Microsoft Windows systems and ensuring secure configurations of PowerShell.", "Conclusion": "CVE-2024-38047 is a critical vulnerability that requires immediate attention."}, "executive_analysis": {"Overview": "CVE-2024-38047 is a PowerShell Elevation of Privilege vulnerability that allows an attacker to elevate privileges.", "Business Impact": "This vulnerability can have significant business impact by allowing an attacker to execute code at a higher level of privilege.", "Technical Impact": "The vulnerability has a CVSS score of 7.8 and can be exploited by an attacker to execute code at a higher level of privilege.", "Mitigation Strategies": "Patching the vulnerable Microsoft Windows systems and ensuring secure configurations of PowerShell are the recommended mitigation strategies.", "Recommendations": "It is recommended that all affected systems be patched and secure configurations be ensured.", "Conclusions": "CVE-2024-38047 is a critical vulnerability that requires immediate attention."}}