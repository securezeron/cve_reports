{"id": "CVE-2020-10744", "sourceIdentifier": "secalert@redhat.com", "published": "2020-05-15T14:15:11.700", "lastModified": "2023-11-07T03:14:19.440", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "An incomplete fix was found for the fix of the flaw CVE-2020-1733 ansible: insecure temporary directory when running become_user from become directive. The provided fix is insufficient to prevent the race condition on systems using ACLs and FUSE filesystems. Ansible Engine 2.7.18, 2.8.12, and 2.9.9 as well as previous versions are affected and Ansible Tower 3.4.5, 3.5.6 and 3.6.4 as well as previous versions are affected."}, {"lang": "es", "value": "Se ha encontrado una correcci\u00f3n incompleta para la correcci\u00f3n del fallo de ansible CVE-2020-1733: un directorio temporal no seguro cuando se ejecuta become_user desde become directive. La correcci\u00f3n proporcionada no es suficiente para impedir una condici\u00f3n de carrera en sistemas que usan ACLs y sistemas de archivos FUSE. Ansible Engine versiones 2.7.18, 2.8.12, y 2.9.9 as\u00ed como las versiones previas est\u00e1n afectadas y Ansible Tower versioes 3.4.5, 3.5.6 y 3.6.4 as\u00ed como las versiones previas est\u00e1n afectadas."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.0, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.8, "impactScore": 3.7}, {"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.0, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.8, "impactScore": 3.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:H/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "HIGH", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 3.7}, "baseSeverity": "LOW", "exploitabilityScore": 1.9, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-362"}]}, {"source": "secalert@redhat.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-377"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:ansible:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.7.0", "versionEndIncluding": "2.7.18", "matchCriteriaId": "3F1AB041-8234-4A8B-BE31-49BCC28589F6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:ansible:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.8.0", "versionEndIncluding": "2.8.12", "matchCriteriaId": "6AC81D26-7550-439F-B243-5E1DEE4EE7B3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:ansible:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.9.0", "versionEndIncluding": "2.9.9", "matchCriteriaId": "5746BAA8-5284-4BE0-B43F-55EB7EA46151"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:ansible_tower:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.4.0", "versionEndIncluding": "3.4.5", "matchCriteriaId": "F5C0F920-A505-452D-AFAA-AE6C20FB25EF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:ansible_tower:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.5.0", "versionEndIncluding": "3.5.6", "matchCriteriaId": "38DE8041-5A20-41AA-83B5-61303E299204"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:ansible_tower:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.6.0", "versionEndIncluding": "3.6.4", "matchCriteriaId": "7A4566CE-6A1C-470A-AA0E-98A859F9172F"}]}]}], "references": [{"url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-10744", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1204.001", "comment": "CVE-2020-10744 - The vulnerability allows an attacker to gain elevated privileges by exploiting a race condition in Ansible's become_user feature, which is used to run become commands as a different user. This technique is relevant because it demonstrates how an attacker can exploit a vulnerability to gain elevated privileges."}, {"techniqueID": "T1199", "comment": "CVE-2020-10744 - The vulnerability allows an attacker to gain elevated privileges by exploiting a race condition in Ansible's become_user feature, which is used to run become commands as a different user. This technique is relevant because it demonstrates how an attacker can exploit a vulnerability to gain elevated privileges."}, {"techniqueID": "T1003.002", "comment": "CVE-2020-10744 - The vulnerability allows an attacker to gain elevated privileges by exploiting a race condition in Ansible's become_user feature, which is used to run become commands as a different user. This technique is relevant because it demonstrates how an attacker can exploit a vulnerability to gain elevated privileges."}], "stix_bundle": "{\"stix2_version\":\"2.1\",\"objects\":[{\"type\":\"vulnerability\",\"id\":\"CVE-2020-10744\",\"created\":\"2023-11-07T03:14:19.440Z\",\"modified\":\"2023:11-07T03:14:19.440Z\",\"description\":[{\"lang\":\"en\",\"value\":\"An incomplete fix was found for the fix of the flaw CVE-2020-1733 ansible: insecure temporary directory when running become_user from become directive. The provided fix is insufficient to prevent the race condition on systems using ACLs and FUSE filesystems.\",\"relates_to\":{\"type\":\"note\",\"id\":\"CVE-2020-10744-note\"}},{\"lang\":\"es\",\"value\":\"Se ha encontrado una correcci\u00f3n incompleta para la correcci\u00f3n del fallo de ansible CVE-2020-1733: un directorio temporal no seguro cuando se ejecuta become_user desde become directive. La correcci\u00f3n proporcionada no es suficiente para impedir una condici\u00f3n de carrera en sistemas que usan ACLs y sistemas de archivos FUSE.\",\"relates_to\":{\"type\":\"note\",\"id\":\"CVE-2020-10744-note\"}}],\"references\":[{\"type\":\"reference\",\"id\":\"CVE-2020-10744-ref\",\"relates_to\":{\"type\":\"vulnerability\",\"id\":\"CVE-2020-10744\"},\"source\":{\"type\":\"source\",\"id\":\"secalert@redhat.com\"},\"description\":[{\"lang\":\"en\",\"value\":\"https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-10744\"},{\"lang\":\"es\",\"value\":\"https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-10744\"}],\"category\":null,\"tags\":[\"Issue Tracking\",\"Vendor Advisory\"]}],\"bundle\":{\"type\":\"bundle\",\"id\":\"CVE-2020-10744-bundle\",\"created\":\"2023-11-07T03:14:19.440Z\",\"modified\":\"2023-11-07T03:14:19.440Z\",\"objects\":{\"nodes\":[{\"type\":\"cve\",\"id\":\"CVE-2020-10744\",\"relates_to\":{\"type\":\"vulnerability\",\"id\":\"CVE-2020-10744\"},\"platform\":{\"type\":\"cpe\",\"id\":\"cpe:2.3:a:redhat:ansible:*:*:*:*:*:*:*:*\",\"relates_to\":{\"type\":\"cpe\",\"id\":\"cpe:2.3:a:redhat:ansible:*:*:*:*:*:*:*:*\"}},{\"type\":\"cve\",\"id\":\"CVE-2020-10744\",\"relates_to\":{\"type\":\"vulnerability\",\"id\":\"CVE-2020-10744\"},\"platform\":{\"type\":\"cpe\",\"id\":\"cpe:2.3:a:redhat:ansible_tower:*:*:*:*:*:*:*:*\",\"relates_to\":{\"type\":\"cpe\",\"id\":\"cpe:2.3:a:redhat:ansible_tower:*-*:*-*:*-*:*-*:*\"}}]}}}}", "technical_analysis": {"Introduction": "The vulnerability in Ansible's become_user feature allows an attacker to gain elevated privileges by exploiting a race condition.", "Impact and Scope": "The vulnerability has a CVSS score of 5.0 and an attack vector of LOCAL, which means it can be exploited by a local attacker. The vulnerability affects Ansible Engine versions 2.7.18, 2.8.12, and 2.9.9 as well as previous versions.", "Related MITRE ATT&CK Techniques": "T1204.001, T1199, T1003.002", "Technical Details": "The vulnerability occurs when Ansible's become_user feature is used to run become commands as a different user. The feature creates a temporary directory to store the Become directory, but it does not properly clean up the directory, leaving it open to exploitation.", "Detection": "Detection methods for this vulnerability include monitoring for suspicious system activity, monitoring for changes to the temporary directory, and monitoring for unexpected privilege escalations.", "Mitigation": "Mitigation strategies include disabling the become_user feature, restricting access to the temporary directory, and implementing proper access controls to limit privilege escalation.", "Conclusion": "The vulnerability in Ansible's become_user feature is a critical security risk that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The vulnerability in Ansible's become_user feature is a critical security risk that allows an attacker to gain elevated privileges.", "Business Impact": "The vulnerability can have significant business impact if exploited by an attacker, potentially leading to data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability can be exploited by a local attacker to gain elevated privileges, potentially allowing an attacker to manipulate system configurations, steal sensitive data, and execute malware.", "Mitigation Strategies": "Disabling the become_user feature, restricting access to the temporary directory, and implementing proper access controls to limit privilege escalation.", "Recommendations": "Executives should immediately take action to mitigate the vulnerability by implementing the recommended mitigation strategies.", "Conclusions": "The vulnerability in Ansible's become_user feature requires immediate attention and mitigation to prevent exploitation and potential business impact."}}