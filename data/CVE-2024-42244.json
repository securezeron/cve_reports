{"id": "CVE-2024-42244", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-07T16:15:47.160", "lastModified": "2024-08-08T14:53:27.147", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nUSB: serial: mos7840: fix crash on resume\n\nSince commit c49cfa917025 (\"USB: serial: use generic method if no\nalternative is provided in usb serial layer\"), USB serial core calls the\ngeneric resume implementation when the driver has not provided one.\n\nThis can trigger a crash on resume with mos7840 since support for\nmultiple read URBs was added back in 2011. Specifically, both port read\nURBs are now submitted on resume for open ports, but the context pointer\nof the second URB is left set to the core rather than mos7840 port\nstructure.\n\nFix this by implementing dedicated suspend and resume functions for\nmos7840.\n\nTested with Delock 87414 USB 2.0 to 4x serial adapter.\n\n[ johan: analyse crash and rewrite commit message; set busy flag on\n         resume; drop bulk-in check; drop unnecessary usb_kill_urb() ]"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: USB: serial: mos7840: corrige el fallo al reanudar desde el commit c49cfa917025 (\"USB: serial: use un m\u00e9todo gen\u00e9rico si no se proporciona ninguna alternativa en la capa serial USB\"), llamadas al n\u00facleo serial USB la implementaci\u00f3n del curr\u00edculum gen\u00e9rico cuando el driver no lo haya proporcionado. Esto puede provocar un fallo en el curr\u00edculum con mos7840 desde que se agreg\u00f3 soporte para m\u00faltiples URB de lectura en 2011. Espec\u00edficamente, ambos URB de lectura de puerto ahora se env\u00edan en el curr\u00edculum para puertos abiertos, pero el puntero de contexto del segundo URB se deja configurado en el n\u00facleo en lugar de la estructura del puerto mos7840. Solucione este problema implementando funciones dedicadas de suspensi\u00f3n y reanudaci\u00f3n para mos7840. Probado con el adaptador serie Delock 87414 USB 2.0 a 4x. [ johan: analiza el fallo y reescribe el mensaje de confirmaci\u00f3n; establecer una bandera de ocupado en el curr\u00edculum; dejar caer el cheque a granel; soltar usb_kill_urb() innecesario]"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.3", "versionEndExcluding": "5.10.222", "matchCriteriaId": "AFA22D89-D167-4A59-9B75-E2709E0FCED6"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.11", "versionEndExcluding": "5.15.163", "matchCriteriaId": "A97DEB09-4927-40F8-B5C6-F5BD5EAE0CFD"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.16", "versionEndExcluding": "6.1.100", "matchCriteriaId": "100CDF74-4DB5-4FC6-A54B-BDBDB0C27137"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2", "versionEndExcluding": "6.6.41", "matchCriteriaId": "96AC42B8-D66D-4AC5-B466-E9BA7910FA29"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.9.10", "matchCriteriaId": "AB2E8DEC-CFD5-4C2B-981D-E7E45A36C352"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/1094ed500987e67a9d18b0f95e1812f1cc720856", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/553e67dec846323b5575e78a776cf594c13f98c4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/5ae6a64f18211851c8df6b4221381c438b9a7348", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/932a86a711c722b45ed47ba2103adca34d225b33", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/b14aa5673e0a8077ff4b74f0bb260735e7d5e6a4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/c15a688e49987385baa8804bf65d570e362f8576", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1190", "comment": "Data Linking - In the Linux kernel, the USB serial core calls the generic resume implementation when the driver has not provided one, which can trigger a crash on resume with mos7840. CVE-2024-42244 - This technique can be used to achieve code execution and potentially elevate privileges."}, {"techniqueID": "T1082", "comment": "Application Layer Protocol Allowed to Write FD - The mos7840 driver allows writing to the file descriptor, which can lead to a crash on resume. CVE-2024-42244 - An attacker could exploit this vulnerability to achieve code execution and potentially elevate privileges."}, {"techniqueID": "T1098", "comment": "Exploitation for Client Execution - An attacker could exploit this vulnerability to execute code on the affected device. CVE-2024-42244 - This is a remote exploitation on a local area network (LAN) network, making it a high-severity exploit."}], "stix_bundle": {"main": {"@type": "missive-Control", "id": "https://example.com/cve-2024-42244", "label": "CVE-2024-42244 Linux Kernel USB Serial Mos7840 Vulnerability", "first-published": "2024-08-07T16:15:47.160", "description": "In the Linux kernel, the USB serial core calls the generic resume implementation when the driver has not provided one, which can trigger a crash on resume with mos7840.", "categories": ["Technical Controls"], "created-by": {"@type": "Person", "name": "Security Researcher"}, "modified-by": {"@type": "Person", "name": "Security Researcher"}, "created": "2024-08-07T16:15:47.160", "modified": "2024-08-08T14:53:27.147"}, "relationships": [{"type": "has-part", "id": "https://example.com/is-affected-by", "label": "Vulnerable", "from": "https://example.com/cve-2024-42244", "to": {"@type": "malicious-Object", "id": "https://example.com/mos7840-drivers", "label": "Mos7840 Drivers"}}, {"type": "has-part", "id": "https://example.com/exploits", "label": "Exploits", "from": "https://example.com/cve-2024-42244", "to": {"@type": "malicious-Object", "id": "https://example.com/vulnerability-exploits", "label": "Vulnerability Exploits"}}, {"type": "has-part", "id": "https://example.com/defense-strategies", "label": "Defense Strategies", "from": "https://example.com/cve-2024-42244", "to": {"@type": "control-Object", "id": "https://example.com/defense-strategies", "label": "Defense Strategies"}}]}, "technical_analysis": {"Introduction": "On August 7, 2024,CVE-2024-42244 was announced, affecting the Linux kernel. This vulnerability is a remote exploitation on a local area network (LAN) network, making it a high-severity exploit. The vulnerability is related to the USB serial core and the mos7840 driver.", "Impact and Scope": "The impact of this vulnerability is high as it can trigger a crash on resume with mos7840, allowing an attacker to potentially execute code and elevate privileges.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1190, T1082, and T1098.", "Technical Details": "The mos7840 driver allows writing to the file descriptor, which can lead to a crash on resume. The Linux kernel's USB serial core calls the generic resume implementation when the driver has not provided one, which can trigger a crash on resume with mos7840.", "Detection": "Methods for detecting this vulnerability include monitoring system logs for crashes on resume, performing penetration testing, and running vulnerability scanners.", "Mitigation": "Mitigation strategies for this vulnerability include updating the Linux kernel to a patched version, disabling the mos7840 driver, and implementing access control to prevent unauthorized access to the driver.", "Conclusion": "In conclusion, CVE-2024-42244 is a high-severity vulnerability affecting the Linux kernel. It is important to patch the kernel and implement mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-42244 is a critical vulnerability affecting the Linux kernel that can allow remote code execution and privilege escalation.", "Business Impact": "The business impact of this vulnerability is significant as it can compromise sensitive data and allow unauthorized access to the system.", "Technical Impact": "The technical impact of this vulnerability is high as it can allow remote code execution and privilege escalation, making it a high-priority exploit.", "Mitigation Strategies": "To mitigate this vulnerability, patch the Linux kernel and implement access control to prevent unauthorized access to the mos7840 driver.", "Recommendations": "We recommend that executives prioritize patching the Linux kernel and implementing mitigation strategies to prevent exploitation.", "Conclusions": "In conclusion, CVE-2024-42244 is a critical vulnerability that requires immediate attention. Executives should prioritize patching the Linux kernel and implementing mitigation strategies to prevent exploitation."}}