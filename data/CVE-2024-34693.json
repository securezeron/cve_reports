{"id": "CVE-2024-34693", "sourceIdentifier": "security@apache.org", "published": "2024-06-20T09:15:11.683", "lastModified": "2024-06-20T12:43:25.663", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Improper Input Validation vulnerability in Apache Superset, allows for an authenticated attacker to create a MariaDB connection with local_infile enabled. If both the MariaDB server (off by default) and the local mysql client on the web server are set to allow for local infile, it's possible for the attacker to execute a specific MySQL/MariaDB SQL command that is able to read files from the server and insert their content on a MariaDB database table.This issue affects Apache Superset: before 3.1.3 and version 4.0.0\n\nUsers are recommended to upgrade to version 4.0.1 or 3.1.3, which fixes the issue.\n\n"}, {"lang": "es", "value": "Vulnerabilidad de validaci\u00f3n de entrada incorrecta en Apache Superset, permite que un atacante autenticado cree una conexi\u00f3n MariaDB con local_infile habilitado. Si tanto el servidor MariaDB (desactivado de forma predeterminada) como el cliente MySQL local en el servidor web est\u00e1n configurados para permitir el archivo local, es posible que el atacante ejecute un comando SQL MySQL/MariaDB espec\u00edfico que pueda leer archivos del servidor e inserte su contenido en una tabla de base de datos MariaDB. Este problema afecta a Apache Superset: antes de 3.1.3 y versi\u00f3n 4.0.0. Se recomienda a los usuarios actualizar a la versi\u00f3n 4.0.1 o 3.1.3, que soluciona el problema."}], "metrics": {"cvssMetricV31": [{"source": "security@apache.org", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 4.0}]}, "weaknesses": [{"source": "security@apache.org", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/06/20/1", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread/1803x1s34m7r71h1k0q1njol8k6fmyon", "source": "security@apache.org"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-34693 - Apache Superset Improper Input Validation vulnerability allows for authenticated attackers to create a MariaDB connection with local_infile enabled. Mitigating this vulnerability involves applying the recommended patches and strengthening input validation controls. This can be achieved by implementing input validation, sanitization, and whitelisting."}, {"techniqueID": "T1190", "comment": "CVE-2024-34693 - Apache Superset Improper Input Validation vulnerability allows attackers to inject malicious input and ultimately execute arbitrary commands on the affected system. Defending against this requires implementing robust input validation, whitelisting allowed input, and monitoring for suspicious activity."}, {"techniqueID": "T1027", "comment": "CVE-2024-34693 - Apache Superset Improper Input Validation vulnerability allows for a successful SQL injection attack, which can be used to read files from the server and insert their content into a MariaDB database table. To defend against this, implement SQL injection protection, validate user input, and monitor database queries."}], "stix_bundle": {"objects": {"indicator": [{"name": "Apache Superset Improper Input Validation vulnerability Indicator", "created": "2024-06-20T09:15:11.683", "modified": "2024-06-20T12:43:25.663", "description": "Apache Superset Improper Input Validation vulnerability indicator", "first_seen": "2024-06-20T09:15:11.683", "last_seen": "2024-06-20T12:43:25.663", "confidence": 50, "types": ["indicator"], "created_by_ref": "apache-superset-vulnerability"}], "vulnerability": [{"name": "Apache Superset Improper Input Validation Vulnerability", "created": "2024-06-20T09:15:11.683", "modified": "2024-06-20T12:43:25.663", "description": {"lang": "en", "value": "Improper Input Validation vulnerability in Apache Superset, allows for an authenticated attacker to create a MariaDB connection with local_infile enabled."}, "severity": "MEDIUM", "cvss": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N", "baseScore": 6.8}, "created_by_ref": "apache-superset-vulnerability"}], "course_of_action": [{"name": "Apache Superset Improper Input Validation Vulnerability Mitigation", "description": "Apply recommended patches and strengthen input validation controls to mitigate Apache Superset Improper Input Validation vulnerability", "related_required_object_refs": ["T1210", "T1190", "T1027"], "recommended_by_ref": "apache-superset-vulnerability"}], "note": [{"name": "Apache Superset Improper Input Validation Vulnerability Notes", "description": {"lang": "en", "value": "Apache Superset Improper Input Validation vulnerability notes"}, "objects": ["Apache Superset Improper Input Validation vulnerability Indicator", "Apache Superset Improper Input Validation Vulnerability"], "created_by_ref": "apache-superset-vulnerability"}]}, "relationships": {"indicator": {"Apache Superset Improper Input Validation vulnerability Indicator": {"course_of_action": ["Apache Superset Improper Input Validation Vulnerability Mitigation"]}}, "vulnerability": {"Apache Superset Improper Input Validation Vulnerability": {"related_indicators": ["Apache Superset Improper Input Validation vulnerability Indicator"], "related_course_of_actions": ["Apache Superset Improper Input Validation Vulnerability Mitigation"], "related_notes": ["Apache Superset Improper Input Validation Vulnerability Notes"]}}}}, "technical_analysis": {"Introduction": "Apache Superset Improper Input Validation vulnerability is a CWE-20 vulnerability that allows authenticated attackers to create a MariaDB connection with local_infile enabled.", "Impact and Scope": "The vulnerability allows for the execution of arbitrary commands on the affected system and the reading and writing of files. The attack vector is network-based, with an attack complexity of LOW and privileges required of HIGH.", "Related MITRE ATT&CK Techniques": "T1210, T1190, and T1027", "Technical Details": "The vulnerability is due to improper input validation in Apache Superset, which allows attackers to inject malicious input and execute arbitrary commands on the affected system.", "Detection": "Detection involves monitoring for suspicious activity and monitoring database queries for signs of SQL injection attacks.", "Mitigation": "Mitigation involves applying the recommended patches and strengthening input validation controls.", "Conclusion": "Conclusion: This vulnerability is a serious attack vector that allows for the execution of arbitrary commands on the affected system and the reading and writing of files."}, "executive_analysis": {"Overview": "Apache Superset Improper Input Validation vulnerability allows for the execution of arbitrary commands on the affected system and the reading and writing of files.", "Business Impact": "This vulnerability can lead to data breaches, data corruption, and system compromise, resulting in financial loss and reputational damage.", "Technical Impact": "The vulnerability affects the integrity and confidentiality of data stored on the affected system.", "Mitigation Strategies": "Applying recommended patches and strengthening input validation controls.", "Recommendations": "Implement robust input validation, whitelisting allowed input, and monitoring for suspicious activity.", "Conclusions": "Conclusion: This vulnerability is a high-priority threat that requires immediate attention and remediation."}}