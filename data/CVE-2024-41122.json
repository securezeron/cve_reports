{"id": "CVE-2024-41122", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-19T20:15:08.430", "lastModified": "2024-07-22T13:00:53.287", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Woodpecker is a simple yet powerful CI/CD engine with great extensibility. The server allow to create any user who can trigger a pipeline run malicious workflows: 1. Those workflows can either lead to a host takeover that runs the agent executing the workflow. 2. Or allow to extract the secrets who would be normally provided to the plugins who's entrypoint are overwritten. This issue has been addressed in release version 2.7.0. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Woodpecker es un motor CI/CD simple pero potente con gran extensibilidad. El servidor permite crear cualquier usuario que pueda desencadenar una canalizaci\u00f3n que ejecute workflows maliciosos: 1. Esos workflows pueden conducir a una toma de control del host que ejecuta el agente que ejecuta el workflow. 2. O permitir extraer los secretos que normalmente se proporcionar\u00edan a los complementos cuyo punto de entrada se sobrescribe. Este problema se solucion\u00f3 en la versi\u00f3n 2.7.0. Se recomienda a los usuarios que actualicen. No se conocen soluciones para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.6, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-74"}]}], "references": [{"url": "https://github.com/woodpecker-ci/woodpecker-security/issues/10", "source": "security-advisories@github.com"}, {"url": "https://github.com/woodpecker-ci/woodpecker/issues/3929", "source": "security-advisories@github.com"}, {"url": "https://github.com/woodpecker-ci/woodpecker/pull/3909", "source": "security-advisories@github.com"}, {"url": "https://github.com/woodpecker-ci/woodpecker/pull/3934", "source": "security-advisories@github.com"}, {"url": "https://github.com/woodpecker-ci/woodpecker/security/advisories/GHSA-3wf2-2pq4-4rvc", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1555.003", "comment": "CVE-2024-41122 - A stored cross-site scripting vulnerability was found in the Woodpecker CI/CD server, allowing an attacker to create a malicious workflow that can either take over the host or extract secrets. This technique can be used to execute unauthorized workflows."}, {"techniqueID": "T1204.001", "comment": "CVE-2024-41122 - An attacker can use this vulnerability to inject malicious JavaScript code in the Woodpecker CI/CD server, allowing for cross-site scripting (XSS) attacks."}, {"techniqueID": "T1547.001", "comment": "CVE-2024-41122 - This vulnerability allows an attacker to remotely execute code on the Woodpecker CI/CD server, enabling command and control (C2) capabilities."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "vulnerability--14", "stix_id": "vulnerability--14", "description": "A stored cross-site scripting vulnerability in the Woodpecker CI/CD server.", "creator": "security-advisories@github.com", "created": "2024-07-19T20:15:08.430", "modified": "2024-07-22T13:00:53.287", "name": "CVE-2024-41122", "cve": "CVE-2024-41122", "cvss": {"vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "baseScore": 7.5, "baseSeverity": "HIGH"}, "mitigations": [{"type": "mitigation", "id": "mitigation--14", "stix_id": "mitigation--14", "description": "Upgrade to version 2.7.0 of the Woodpecker CI/CD server.", "relation": " Mitigates the stored cross-site scripting vulnerability."}], "notes": [{"type": "note", "id": "note--14", "stix_id": "note--14", "description": "The attack vector is limited to network access, and the exploitability score is 1.6.", "relation": "Notes on the attack vector and exploitability score."}], "relationships": [{"type": "incident-response", "id": "incident-response--14", "stix_id": "incident-response--14", "description": "The related incident response is the deployment of security patches.", "relation": "Related incident response."}]}]}, "technical_analysis": {"Introduction": "The CVE-2024-41122 vulnerability is a stored cross-site scripting vulnerability in the Woodpecker CI/CD server.", "Impact and Scope": "The vulnerability has a cvss score of 7.5, with an attack vector of network and attack complexity of high.", "Related MITRE ATT&CK Techniques": "T1555.003, T1204.001, T1547.001", "Technical Details": "The vulnerability allows an attacker to create a malicious workflow that can either take over the host or extract secrets.", "Detection": "Detection of the vulnerability can be done using security tools that monitor network traffic and identify malicious workflows.", "Mitigation": "Mitigation strategies include upgrading to version 2.7.0 of the Woodpecker CI/CD server and patching vulnerabilities.", "Conclusion": "The CVE-2024-41122 vulnerability is a significant threat to the security of the Woodpecker CI/CD server and requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2024-41122 vulnerability is a stored cross-site scripting vulnerability in the Woodpecker CI/CD server.", "Business Impact": "The vulnerability has the potential to cause significant business disruption and data breaches.", "Technical Impact": "The vulnerability allows an attacker to remotely execute code on the Woodpecker CI/CD server, enabling command and control (C2) capabilities.", "Mitigation Strategies": "Upgrade to version 2.7.0 of the Woodpecker CI/CD server and patch vulnerabilities.", "Recommendations": "Implement security patches and upgrades, and monitor network traffic for malicious workflows.", "Conclusions": "The CVE-2024-41122 vulnerability requires immediate attention and mitigation to prevent business disruption and data breaches."}}