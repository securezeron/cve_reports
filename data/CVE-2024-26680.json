{"id": "CVE-2024-26680", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-02T07:15:44.490", "lastModified": "2024-04-02T12:50:42.233", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: atlantic: Fix DMA mapping for PTP hwts ring\n\nFunction aq_ring_hwts_rx_alloc() maps extra AQ_CFG_RXDS_DEF bytes\nfor PTP HWTS ring but then generic aq_ring_free() does not take this\ninto account.\nCreate and use a specific function to free HWTS ring to fix this\nissue.\n\nTrace:\n[  215.351607] ------------[ cut here ]------------\n[  215.351612] DMA-API: atlantic 0000:4b:00.0: device driver frees DMA memory with different size [device address=0x00000000fbdd0000] [map size=34816 bytes] [unmap size=32768 bytes]\n[  215.351635] WARNING: CPU: 33 PID: 10759 at kernel/dma/debug.c:988 check_unmap+0xa6f/0x2360\n...\n[  215.581176] Call Trace:\n[  215.583632]  <TASK>\n[  215.585745]  ? show_trace_log_lvl+0x1c4/0x2df\n[  215.590114]  ? show_trace_log_lvl+0x1c4/0x2df\n[  215.594497]  ? debug_dma_free_coherent+0x196/0x210\n[  215.599305]  ? check_unmap+0xa6f/0x2360\n[  215.603147]  ? __warn+0xca/0x1d0\n[  215.606391]  ? check_unmap+0xa6f/0x2360\n[  215.610237]  ? report_bug+0x1ef/0x370\n[  215.613921]  ? handle_bug+0x3c/0x70\n[  215.617423]  ? exc_invalid_op+0x14/0x50\n[  215.621269]  ? asm_exc_invalid_op+0x16/0x20\n[  215.625480]  ? check_unmap+0xa6f/0x2360\n[  215.629331]  ? mark_lock.part.0+0xca/0xa40\n[  215.633445]  debug_dma_free_coherent+0x196/0x210\n[  215.638079]  ? __pfx_debug_dma_free_coherent+0x10/0x10\n[  215.643242]  ? slab_free_freelist_hook+0x11d/0x1d0\n[  215.648060]  dma_free_attrs+0x6d/0x130\n[  215.651834]  aq_ring_free+0x193/0x290 [atlantic]\n[  215.656487]  aq_ptp_ring_free+0x67/0x110 [atlantic]\n...\n[  216.127540] ---[ end trace 6467e5964dd2640b ]---\n[  216.132160] DMA-API: Mapped at:\n[  216.132162]  debug_dma_alloc_coherent+0x66/0x2f0\n[  216.132165]  dma_alloc_attrs+0xf5/0x1b0\n[  216.132168]  aq_ring_hwts_rx_alloc+0x150/0x1f0 [atlantic]\n[  216.132193]  aq_ptp_ring_alloc+0x1bb/0x540 [atlantic]\n[  216.132213]  aq_nic_init+0x4a1/0x760 [atlantic]"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net: atlantic: corrige el mapeo DMA para el anillo PTP hwts. La funci\u00f3n aq_ring_hwts_rx_alloc() asigna bytes AQ_CFG_RXDS_DEF adicionales para el anillo PTP HWTS, pero luego el aq_ring_free() gen\u00e9rico no tiene esto en cuenta. Cree y utilice una funci\u00f3n espec\u00edfica para liberar el anillo HWTS y solucionar este problema. Seguimiento: [215.351607] ------------[ cortar aqu\u00ed ]------------ [ 215.351612] DMA-API: atlantic 0000:4b:00.0: el controlador de dispositivo se libera Memoria DMA con diferente tama\u00f1o [direcci\u00f3n del dispositivo=0x00000000fbdd0000] [tama\u00f1o del mapa=34816 bytes] [tama\u00f1o de desasignaci\u00f3n=32768 bytes] [215.351635] ADVERTENCIA: CPU: 33 PID: 10759 en kernel/dma/debug.c:988 check_unmap+0xa6f/ 0x2360... [215.581176] Seguimiento de llamadas: [215.583632]  [215.585745]? show_trace_log_lvl+0x1c4/0x2df [215.590114]? show_trace_log_lvl+0x1c4/0x2df [215.594497]? debug_dma_free_coherent+0x196/0x210 [215.599305]? check_unmap+0xa6f/0x2360 [215.603147]? __advertir+0xca/0x1d0 [215.606391] ? check_unmap+0xa6f/0x2360 [215.610237]? report_bug+0x1ef/0x370 [215.613921]? handle_bug+0x3c/0x70 [215.617423]? exc_invalid_op+0x14/0x50 [215.621269]? asm_exc_invalid_op+0x16/0x20 [215.625480]? check_unmap+0xa6f/0x2360 [215.629331]? mark_lock.part.0+0xca/0xa40 [215.633445] debug_dma_free_coherent+0x196/0x210 [215.638079]? __pfx_debug_dma_free_coherent+0x10/0x10 [215.643242] ? slab_free_freelist_hook+0x11d/0x1d0 [ 215.648060] dma_free_attrs+0x6d/0x130 [ 215.651834] aq_ring_free+0x193/0x290 [atl\u00e1ntico] [ 215.656487] aq_ptp_ring_free+0x67/0x110 [atl\u00e1ntico]... [216.127540] ---[fin de seguimiento 6467e5964dd2640b]- -- [ 216.132160] DMA-API: Asignado en: [ 216.132162] debug_dma_alloc_coherent+0x66/0x2f0 [ 216.132165] dma_alloc_attrs+0xf5/0x1b0 [ 216.132168] aq_ring_hwts_rx_alloc+0x150 /0x1f0 [atl\u00e1ntico] [ 216.132193] aq_ptp_ring_alloc+0x1bb/0x540 [atl\u00e1ntico] [216.132213] aq_nic_init+0x4a1/0x760 [atl\u00e1ntico]"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/004fe5b7f59286a926a45e0cafc7870e9cdddd56", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/2e7d3b67630dfd8f178c41fa2217aa00e79a5887", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/466ceebe48cbba3f4506f165fca7111f9eb8bb12", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e42e334c645575be5432adee224975d4f536fdb1", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-26680 - This technique is used to obtain sensitive information that can be used to execute further attacks. The specific vulnerability in the Linux kernel allows an attacker to gain access to the DMA memory region, which can be used to exfiltrate sensitive data."}, {"techniqueID": "T1074", "comment": "CVE-2024-26680 - This technique is used to enable persistence on the system. The vulnerability in the Linux kernel allows an attacker to gain access to the DMA memory region, which can be used to maintain a persistent presence on the system."}, {"techniqueID": "T1075", "comment": "CVE-2024-26680 - This technique is used to inject malicious code onto the system. The vulnerability in the Linux kernel allows an attacker to gain access to the DMA memory region, which can be used to inject malicious code and execute it on the system."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/stix/stix_bundle", "created_by_ref": "https://example.com/users/user1", "updated_by_ref": "https://example.com/users/user1", "created": "2024-04-02T07:15:44.490", "updated": "2024-04-02T12:50:42.233", "objects": [{"type": "vulnerability", "id": "https://example.com/stix/vulnerability/CVE-2024-26680", "created_by_ref": "https://example.com/users/user1", "updated_by_ref": "https://example.com/users/user1", "created": "2024-04-02T07:15:44.490", "updated": "2024-04-02T12:50:42.233", "name": "CVE-2024-26680", "description": "The vulnerability in the Linux kernel allows an attacker to gain access to the DMA memory region, which can be used to execute further attacks.", "severity": "High", "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}, {"type": "indicator", "id": "https://example.com/stix/indicator/T1047", "created_by_ref": "https://example.com/users/user1", "updated_by_ref": "https://example.com/users/user1", "created": "2024-04-02T07:15:44.490", "updated": "2024-04-02T12:50:42.233", "name": "T1047: Data Stolen from Process Memory", "description": "This indicator detects the exfiltration of data from process memory using the CVE-2024-26680 vulnerability.", "pattern": ["process memory exfiltration"]}, {"type": "course_of_action", "id": "https://example.com/stix/course_of_action/CVE-2024-26680-T1027", "created_by_ref": "https://example.com/users/user1", "updated_by_ref": "https://example.com/users/user1", "created": "2024-04-02T07:15:44.490", "updated": "2024-04-02T12:50:42.233", "name": "Apply kernel patch", "description": "Apply the kernel patch to mitigate the CVE-2024-26680 vulnerability.", "mitigated_by_ref": "https://example.com/stix/vulnerability/CVE-2024-26680"}], " relationships": [{"type": "has_member", "id": "https://example.com/stix/relationship/has_member/CVE-2024-26680", "created_by_ref": "https://example.com/users/user1", "updated_by_ref": "https://example.com/users/user1", "created": "2024-04-02T07:15:44.490", "updated": "2024-04-02T12:50:42.233", "source_ref": "https://example.com/stix/vulnerability/CVE-2024-26680", "target_ref": "https://example.com/stix/indicator/T1047"}, {"type": "mitigated_by", "id": "https://example.com/stix/relationship/mitigated_by/CVE-2024-26680", "created_by_ref": "https://example.com/users/user1", "updated_by_ref": "https://example.com/users/user1", "created": "2024-04-02T07:15:44.490", "updated": "2024-04-02T12:50:42.233", "source_ref": "https://example.com/stix/vulnerability/CVE-2024-26680", "target_ref": "https://example.com/stix/course_of_action/CVE-2024-26680-T1027"}]}, "technical_analysis": {"Introduction": "The CVE-2024-26680 vulnerability is a high-severity vulnerability in the Linux kernel that allows an attacker to gain access to the DMA memory region, which can be used to execute further attacks.", "Impact and Scope": "The vulnerability affects Linux systems with kernel version 5.10 and above, and allows an attacker to gain access to the DMA memory region. The impact is significant, as it allows an attacker to execute further attacks on the system.", "Related MITRE ATT&CK Techniques": "T1027: Data Stolen from Process Memory, T1074: Copying Virtual File System Files and Registry Keys, T1075: Execution via Instalation of Run.LOGON Script.", "Technical Details": "The vulnerability is caused by a bug in the Linux kernel's DMA mapping code, which allows an attacker to gain access to the DMA memory region.", "Detection": "Detection can be done by monitoring the DMA memory region for unusual activity.", "Mitigation": "The vulnerability can be mitigated by applying the kernel patch.", "Conclusion": "Summary and conclusions."}, "executive_analysis": {"Overview": "The CVE-2024-26680 vulnerability is a high-severity vulnerability in the Linux kernel that allows an attacker to gain access to the DMA memory region, which can be used to execute further attacks.", "Business Impact": "The vulnerability has a significant business impact, as it allows an attacker to execute further attacks on the system, which can lead to data breaches and system compromise.", "Technical Impact": "The vulnerability has a significant technical impact, as it allows an attacker to gain access to the DMA memory region, which can be used to execute further attacks.", "Mitigation Strategies": "Applying the kernel patch and monitoring the DMA memory region for unusual activity can be used to mitigate the vulnerability.", "Recommendations": "Executives should ensure that the kernel patch is applied and that monitoring is put in place to detect any unusual activity.", "Conclusions": "Final conclusions and next steps."}}