{"id": "CVE-2024-42084", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-29T17:15:11.170", "lastModified": "2024-07-30T13:33:30.653", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nftruncate: pass a signed offset\n\nThe old ftruncate() syscall, using the 32-bit off_t misses a sign\nextension when called in compat mode on 64-bit architectures.  As a\nresult, passing a negative length accidentally succeeds in truncating\nto file size between 2GiB and 4GiB.\n\nChanging the type of the compat syscall to the signed compat_off_t\nchanges the behavior so it instead returns -EINVAL.\n\nThe native entry point, the truncate() syscall and the corresponding\nloff_t based variants are all correct already and do not suffer\nfrom this mistake."}, {"lang": "es", "value": " En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: ftruncate: pasa un desplazamiento firmado La antigua llamada al sistema ftruncate(), que utiliza off_t de 32 bits, pierde una extensi\u00f3n de signo cuando se llama en modo de compatibilidad en arquitecturas de 64 bits. Como resultado, pasar una longitud negativa accidentalmente logra truncar el tama\u00f1o del archivo entre 2GiB y 4GiB. Cambiar el tipo de llamada al sistema compat a compat_off_t firmado cambia el comportamiento, por lo que en su lugar devuelve -EINVAL. El punto de entrada nativo, la llamada al sistema truncate() y las variantes correspondientes basadas en loff_t ya son correctas y no sufren este error."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/4b8e88e563b5f666446d002ad0dc1e6e8e7102b0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5ae6af68410bdad6181ec82104bb9985a7a6a0fa", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/836359247b0403e0634bfbc83e5bb8063fad287a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/84bf6b64a1a0dfc6de7e1b1c776d58d608e7865a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/930a4c369f74da26816eaaa71b5888d29b759c27", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c329760749b5419769e57cb2be80955d2805f9c9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/dbb226d81cd02cee140139c2369791e6f61f2007", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f531d4bc6c5588d713359e42ed65e46816d841d8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1102", "comment": "CVE-2024-42084 - The use of signed offsets in the Linux kernel's ftruncate function can lead to memory corruption, making it an important technique to detect and prevent."}, {"techniqueID": "T1547", "comment": "CVE-2024-42084 - The exploitation of the ftruncate function vulnerability can be used for privilege escalation, making it important to detect and prevent."}, {"techniqueID": "T1059", "comment": "CVE-2024-42084 - The ability to truncate files to arbitrary sizes can be used for data destruction and tampering, making it important to detect and prevent."}], "stix_bundle": {"id": "bundle-cve-2024-42084", "title": "Vulnerability Analysis for CVE-2024-42084", "description": "STIX bundle for CVE-2024-42084", "objects": [{"id": "vulnerability-cve-2024-42084", "type": "vulnerability", "description": "Linux kernel - ftruncate function vulnerability", "cve-id": "CVE-2024-42084", "cvss-v3": {"score": 8.8, "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}}, {"id": "relationship-technique-1", "type": "relationship", "description": "Related technique T1102 - Query File System", "object_ref": "technique-t1102"}, {"id": "relationship-technique-2", "type": "relationship", "description": "Related technique T1547 - Artifact Collection", "object_ref": "technique-t1547"}, {"id": "relationship-technique-3", "type": "relationship", "description": "Related technique T1059 - Command and Control", "object_ref": "technique-t1059"}]}, "technical_analysis": {"Introduction": "The Linux kernel's ftruncate function has been found to have a vulnerability that can lead to memory corruption, privilege escalation, and data destruction.", "Impact and Scope": "The impact of this vulnerability is high, as it can be used to gain elevated privileges on a system, and the scope of the vulnerability is widespread, affecting many Linux systems.", "Related MITRE ATT&CK Techniques": "The following techniques are related to this vulnerability: T1102, T1547, and T1059.", "Technical Details": "The vulnerability is caused by the use of signed offsets in the ftruncate function, which can lead to memory corruption and privilege escalation.", "Detection": "The vulnerability can be detected through various means, including memory dumping, system crashing, and network monitoring.", "Mitigation": "The vulnerability can be mitigated through various means, including patching the kernel, using a firewall to block vulnerable connections, and using anti-exploitation tools.", "Conclusion": "The vulnerability is a significant threat to Linux systems, and immediate action should be taken to mitigate its effects."}, "executive_analysis": {"Overview": "The Linux kernel's ftruncate function has a vulnerability that can lead to significant consequences.", "Business Impact": "The business impact of this vulnerability is high, as it can be used to compromise sensitive data and compromise system security.", "Technical Impact": "The technical impact of this vulnerability is significant, as it can be used to gain elevated privileges on a system and compromise system security.", "Mitigation Strategies": "The following mitigation strategies should be implemented: patching the kernel, using a firewall to block vulnerable connections, and using anti-exploitation tools.", "Recommendations": "Recommendations for executives include implementing mitigation strategies, conducting thorough risk assessments, and implementing incident response plans.", "Conclusions": "The vulnerability is a significant threat to Linux systems, and immediate action should be taken to mitigate its effects."}}