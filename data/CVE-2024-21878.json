{"id": "CVE-2024-21878", "sourceIdentifier": "csirt@divd.nl", "published": "2024-08-12T13:38:15.107", "lastModified": "2024-08-23T17:52:11.777", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Improper Neutralization of Special Elements used in a Command ('Command Injection') vulnerability in Enphase IQ Gateway (formerly known as Envoy) allows OS Command Injection. This vulnerability is present in an internal script.This issue affects Envoy: from 4.x up to and including 8.x and is currently unpatched."}, {"lang": "es", "value": "La neutralizaci\u00f3n inadecuada de elementos especiales utilizados en una vulnerabilidad de comando (\"Inyecci\u00f3n de comando\") en Enphase IQ Gateway (anteriormente conocido como Envoy) permite la inyecci\u00f3n de comando del sistema operativo. Esta vulnerabilidad est\u00e1 presente en un script interno. Este problema afecta a Envoy: desde 4.x hasta 8.x inclusive y actualmente no est\u00e1 parcheado."}], "metrics": {"cvssMetricV40": [{"source": "csirt@divd.nl", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:H/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:L/SI:L/SA:L/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:P/AU:Y/R:I/V:C/RE:H/U:X", "attackVector": "NETWORK", "attackComplexity": "HIGH", "attackRequirements": "NONE", "privilegesRequired": "NONE", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "HIGH", "vulnerableSystemIntegrity": "HIGH", "vulnerableSystemAvailability": "HIGH", "subsequentSystemConfidentiality": "LOW", "subsequentSystemIntegrity": "LOW", "subsequentSystemAvailability": "LOW", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "PRESENT", "automatable": "YES", "recovery": "IRRECOVERABLE", "valueDensity": "CONCENTRATED", "vulnerabilityResponseEffort": "HIGH", "providerUrgency": "NOT_DEFINED", "baseScore": 9.2, "baseSeverity": "CRITICAL"}}], "cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}, {"source": "csirt@divd.nl", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-77"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:enphase:iq_gateway_firmware:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0", "versionEndExcluding": "8.2.4225", "matchCriteriaId": "045C0178-42FE-4511-A182-AF3BA9545EF0"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:enphase:iq_gateway:-:*:*:*:*:*:*:*", "matchCriteriaId": "75882BE4-CF58-44B5-BA30-DD13BDFF78C0"}]}]}], "references": [{"url": "https://csirt.divd.nl/CVE-2024-21878", "source": "csirt@divd.nl", "tags": ["Third Party Advisory"]}, {"url": "https://csirt.divd.nl/DIVD-2024-00011", "source": "csirt@divd.nl", "tags": ["Third Party Advisory"]}, {"url": "https://enphase.com/cybersecurity/advisories/ensa-2024-3", "source": "csirt@divd.nl", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-21878 - The command injection vulnerability allows an attacker to execute arbitrary commands on the system, which can be used to escalate privileges and move laterally in the network. Defending against this involves validating and sanitizing all user input before executing it, as well as restricting access to sensitive areas of the system."}, {"techniqueID": "T1210", "comment": "CVE-2024-21878 - The credentials used for the Enphase IQ Gateway (formerly Envoy) can be used to gain unauthorized access to the system, which can be used to exploit other vulnerabilities. Defending against this involves implementing strong authentication and authorization controls, as well as using least privilege access controls."}, {"techniqueID": "T1078", "comment": "CVE-2024-21878 - The script injection vulnerability allows an attacker to inject malicious code into the system, which can be used to gain control of the system and move laterally. Defending against this involves validating and sanitizing all script input, as well as restricting access to sensitive areas of the system."}, {"techniqueID": "T1560", "comment": "CVE-2024-21878 - The vulnerability allows an attacker to execute arbitrary code on the system, which can be used to gain control of the system and move laterally. Defending against this involves implementing strong memory protection, as well as using secure coding practices."}], "stix_bundle": "{\"stix_2_1\": {...}},", "technical_analysis": {"Introduction": "The CVE-2024-21878 vulnerability affects the Enphase IQ Gateway (formerly Envoy) and allows for command injection, which can be used to gain unauthorized access to the system.", "Impact and Scope": "The vulnerability has a CVSS score of 9.2 (CVE-2024-21878) and allows for network-based attacks. The attack vector is network, and the attack complexity is high.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1210, T1078, and T1560.", "Technical Details": "The vulnerability exists in the internal script of the Enphase IQ Gateway (formerly Envoy) and allows an attacker to inject maliciou", "Detection": "Detecting the vulnerability involves monitoring for network-based attacks and unusual system behavior.", "Mitigation": "Mitigating the vulnerability involves implementing strong authentication and authorization controls, validating and sanitizing all user input, and restricting access to sensitive areas of the system.", "Conclusion": "In conclusion, the CVE-2024-21878 vulnerability is a significant threat to the Enphase IQ Gateway (formerly Envoy) and requires immediate attention."}, "executive_analysis": {"Overview": "The CVE-2024-21878 vulnerability affects the Enphase IQ Gateway (formerly Envoy) and allows for command injection, which can be used to gain unauthorized access to the system.", "Business Impact": "The vulnerability has significant business implications, including potential data breaches and system compromise.", "Technical Impact": "The vulnerability has significant technical implications, including the potential for unauthorized access to the system and data.", "Mitigation Strategies": "Mitigating the vulnerability requires a multifaceted approach involving technical, procedural, and organizational controls.", "Recommendations": "Recommendations for executives include addressing the vulnerability, implementing strong authentication and authorization controls, and regularly reviewing and updating security protocols.", "Conclusions": "In conclusion, the CVE-2024-21878 vulnerability is a significant threat that requires immediate attention and action."}}