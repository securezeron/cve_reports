{"id": "CVE-2024-3640", "sourceIdentifier": "PSIRT@rockwellautomation.com", "published": "2024-05-16T16:15:10.477", "lastModified": "2024-05-17T18:36:31.297", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "An unquoted executable path exists in the Rockwell Automation\u00a0FactoryTalk\u00ae Remote Access\u2122 possibly resulting in remote code execution if exploited. While running the FTRA installer package, the executable path is not properly quoted, which could allow a threat actor to enter a malicious executable and run it as a System user. A threat actor needs admin privileges to exploit this vulnerability."}, {"lang": "es", "value": "Existe una ruta ejecutable sin comillas en Rockwell Automation FactoryTalk\u00ae Remote Access\u2122 que, si se explota, podr\u00eda provocar la ejecuci\u00f3n remota de c\u00f3digo. Mientras se ejecuta el paquete de instalaci\u00f3n de FTRA, la ruta del ejecutable no se cita correctamente, lo que podr\u00eda permitir que un actor de amenazas ingrese un ejecutable malicioso y lo ejecute como usuario del sistema. Un actor malicioso necesita privilegios de administrador para explotar esta vulnerabilidad."}], "metrics": {"cvssMetricV40": [{"source": "PSIRT@rockwellautomation.com", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:L/AC:L/AT:N/PR:H/UI:A/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "attackVector": "LOCAL", "attackComplexity": "LOW", "attackRequirements": "NONE", "privilegesRequired": "HIGH", "userInteraction": "ACTIVE", "vulnerableSystemConfidentiality": "HIGH", "vulnerableSystemIntegrity": "HIGH", "vulnerableSystemAvailability": "HIGH", "subsequentSystemConfidentiality": "NONE", "subsequentSystemIntegrity": "NONE", "subsequentSystemAvailability": "NONE", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NOT_DEFINED", "recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED", "baseScore": 7.0, "baseSeverity": "HIGH"}}]}, "weaknesses": [{"source": "PSIRT@rockwellautomation.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-428"}]}], "references": [{"url": "https://www.rockwellautomation.com/en-us/support/advisory.SD1671.html", "source": "PSIRT@rockwellautomation.com"}], "techniques": [{"techniqueID": "T1190", "comment": "This vulnerability - CVE-2024-3640 - is related to exploitation of unquoted executable paths in the Rockwell Automation FactoryTalk Remote Access. An attacker can exploit this to execute arbitrary code with SYSTEM privileges. This is relevant to defense because it requires immediate attention to prevent remote code execution."}, {"techniqueID": "T1204", "comment": "The vulnerability CVE-2024-3640 is also related to the execution of arbitrary code, making it relevant to the PowerShell Empire technique. This technique can be used to deliver malware and conduct post-exploitation activities. Defense against this technique requires proper configuration of PowerShell settings and monitoring for suspicious activities."}, {"techniqueID": "T1078", "comment": "The exploitation of unquoted executable paths in the Rockwell Automation FactoryTalk Remote Access can also be used to conduct Credential Dumping. This technique is relevant to the attack scenario and requires effective privilege management and logging mechanisms to detect and prevent."}], "stix_bundle": {"type": "bundle", "id": "bundle--1", "created_by_ref": "organization--123", "created": "2024-05-17T18:36:31.297", "modified": "2024-05-17T18:36:31.297", "objects": [{"type": "vulnerability", "id": "vulnerability--1", "created_by_ref": "organization--123", "created": "2024-05-17T18:36:31.297", "modified": "2024-05-17T18:36:31.297", "name": "CVE-2024-3640", "description": "An unquoted executable path exists in the Rockwell Automation FactoryTalk Remote Access possibly resulting in remote code execution if exploited.", "cvssV40": {"vectorString": "CVSS:4.0/AV:L/AC:L/AT:N/PR:H/UI:A/VC:H/VI:H/VA:H", "baseScore": 7.0}, "description_data": [{"lang": "en", "value": "An unquoted executable path exists in the Rockwell Automation FactoryTalk Remote Access possibly resulting in remote code execution if exploited. While running the FTRA installer package, the executable path is not properly quoted, which could allow a threat actor to enter a malicious executable and run it as a System user. A threat actor needs admin privileges to exploit this vulnerability."}], "references": [{"url": "https://www.rockwellautomation.com/en-us/support/advisory.SD1671.html", "name": "Rockwell Automation Advisory"}], "related_objects": [{"type": "intrusion-set", "id": "intrusion-set--1", "name": "PowerShell Empire"}, {"type": "mitigation", "id": "mitigation--1", "name": "Properly quote executable paths"}, {"type": "course-of-action", "id": "course-of-action--1", "name": "Disable admin privileges for users"}]}, {"type": "intrusion-set", "id": "intrusion-set--1", "created_by_ref": "organization--123", "created": "2024-05-17T18:36:31.297", "modified": "2024-05-17T18:36:31.297", "name": "PowerShell Empire"}, {"type": "mitigation", "id": "mitigation--1", "created_by_ref": "organization--123", "created": "2024-05-17T18:36:31.297", "modified": "2024-05-17T18:36:31.297", "name": "Properly quote executable paths"}, {"type": "course-of-action", "id": "course-of-action--1", "created_by_ref": "organization--123", "created": "2024-05-17T18:36:31.297", "modified": "2024-05-17T18:36:31.297", "name": "Disable admin privileges for users"}]}, "technical_analysis": {"Introduction": "This report provides a technical analysis of the CVE-2024-3640 vulnerability, which is related to unquoted executable paths in the Rockwell Automation FactoryTalk Remote Access. The vulnerability is exploitable and can result in remote code execution with SYSTEM privileges.", "Impact and Scope": "The CVE-2024-3640 vulnerability has a CVSS score of 7.0 and affects the Rockwell Automation FactoryTalk Remote Access. It requires admin privileges to exploit and can result in remote code execution with SYSTEM privileges.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1204, and T1078.", "Technical Details": "The vulnerability is caused by an unquoted executable path in the Rockwell Automation FactoryTalk Remote Access, which allows an attacker to execute arbitrary code with SYSTEM privileges.", "Detection": "Detection of this vulnerability can be done by monitoring for suspicious activities and monitoring system logs for entries related to the vulnerable executable path.", "Mitigation": "Mitigation of this vulnerability can be done by properly quoting executable paths and disabling admin privileges for users.", "Conclusion": "Conclusion: The CVE-2024-3640 vulnerability is a critical vulnerability that requires immediate attention. It is exploitable and can result in remote code execution with SYSTEM privileges. Detection and mitigation strategies are outlined above."}, "executive_analysis": {"Overview": "This report provides an overview of the CVE-2024-3640 vulnerability and its impact on the organization.", "Business Impact": "The CVE-2024-3640 vulnerability has a significant business impact, as it can result in remote code execution with SYSTEM privileges and data breach.", "Technical Impact": "The CVE-2024-3640 vulnerability has a significant technical impact, as it affects the Rockwell Automation FactoryTalk Remote Access and requires admin privileges to exploit.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include properly quoting executable paths and disabling admin privileges for users.", "Recommendations": "Recommendations for executives include prioritizing the patching of the vulnerable software and implementing additional security controls to prevent exploitation.", "Conclusions": "Conclusion: The CVE-2024-3640 vulnerability is a critical vulnerability that requires immediate attention. It is exploitable and can result in remote code execution with SYSTEM privileges. Recommendations for executives are outlined above."}}