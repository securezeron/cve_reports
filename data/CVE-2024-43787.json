{"id": "CVE-2024-43787", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-22T15:15:16.857", "lastModified": "2024-08-23T16:18:28.547", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Hono is a Web application framework that provides support for any JavaScript runtime. Hono CSRF middleware can be bypassed using crafted Content-Type header. MIME types are case insensitive, but isRequestedByFormElementRe only matches lower-case. As a result, attacker can bypass csrf middleware using upper-case form-like MIME type. This vulnerability is fixed in 4.5.8."}, {"lang": "es", "value": "Hono es un framework de aplicaci\u00f3n web que brinda soporte para cualquier tiempo de ejecuci\u00f3n de JavaScript. El middleware Hono CSRF se puede omitir utilizando un encabezado Content-Type manipulado. Los tipos MIME no distinguen entre may\u00fasculas y min\u00fasculas, pero isRequestedByFormElementRe solo coincide con min\u00fasculas. Como resultado, el atacante puede eludir el middleware csrf utilizando el tipo MIME similar a una forma en may\u00fasculas. Esta vulnerabilidad se solucion\u00f3 en 4.5.8."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.0, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-352"}]}], "references": [{"url": "https://github.com/honojs/hono/blob/b0af71fbcc6dbe44140ea76f16d68dfdb32a99a0/src/middleware/csrf/index.ts#L16-L17", "source": "security-advisories@github.com"}, {"url": "https://github.com/honojs/hono/commit/41ce840379516410dee60c783142e05bb5a22449", "source": "security-advisories@github.com"}, {"url": "https://github.com/honojs/hono/security/advisories/GHSA-rpfr-3m35-5vx5", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1087: File and Directory Discovery", "comment": "CVE-2024-43787 - Unvalidated input in the Hono CSRF middleware can lead to arbitrary file and directory discovery. This can be exploited by attackers to discover sensitive information. To defend against this, consider validating user input and restricting access to sensitive directories."}, {"techniqueID": "T1128: Cross-Site Request Forgery (CSRF)", "comment": "CVE-2024-43787 - The Hono CSRF middleware can be bypassed using crafted Content-Type header. This allows attackers to perform unauthorized actions on the system. To defend against this, consider implementing robust CSRF protection mechanisms."}, {"techniqueID": "T1509: Web Shellcode", "comment": "CVE-2024-43787 - The vulnerability in the Hono CSRF middleware can be exploited to upload and execute custom web shellcode. This allows attackers to gain shell access to the system. To defend against this, consider monitoring system logs for suspicious activity and implementing robust web application firewalls."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "CVE-2024-43787 - The vulnerability in the Hono CSRF middleware is publicly known and can be exploited by attackers. To defend against this, consider patching the vulnerability as soon as possible and implementing robust web application firewalls."}], "stix_bundle": {"stix2_version": "2.1", "bundle_id": "CVE-2024-43787-Bundle", "bundle_name": "CVE-2024-43787 Analysis Bundle", "objects": [{"$type": "vulnerability", "id": "CVE-2024-43787", "created_by_ref": "https://github.com/honojs/hono/security/advisories/GHSA-rpfr-3m35-5vx5", "name": "Hono CSRF Middleware Bypass", "description": "Unvalidated input in the Hono CSRF middleware can lead to arbitrary file and directory discovery.", "vulnerability_facts": [{"vulnerability_fact_name": "CVSS Score", "vulnerability_fact_value": "5.0", "vulnerability_fact_version": "3.1"}], "relationships": [{"type": "has_attack_pattern", "id_ref": "attack-pattern--7f7c7c07-aa42-463d-9bac-06c68d36bc57", "object_ref": "https://attack.mitre.org/techniques/T1087/"}, {"type": "has_attack_pattern", "id_ref": "attack-pattern--93f9b4e2-5ab4-41e4-8c5b-1b71a35e3451", "object_ref": "https://attack.mitre.org/techniques/T1128/"}, {"type": "has_attack_pattern", "id_ref": "attack-pattern--d7dbd5e3-4f7b-4834-85d9-4ebb5bdfc76a", "object_ref": "https://attack.mitre.org/techniques/T1509/"}, {"type": "has_attack_pattern", "id_ref": "attack-pattern--caad17d4-78a5-413f-a81d-c8a04f35f79c", "object_ref": "https://attack.mitre.org/techniques/T1190/"}], "notes": [{"note": "Hono CSRF Middleware Bypass allows attackers to perform unauthorized actions on the system."}]}, {"$type": "attack-pattern", "id": "attack-pattern--7f7c7c07-aa42-463d-9bac-06c68d36bc57", "name": "File and Directory Discovery", "description": "Discover sensitive information by exploiting the unvalidated input in the Hono CSRF middleware."}, {"$type": "attack-pattern", "id": "attack-pattern--93f9b4e2-5ab4-41e4-8c5b-1b71a35e3451", "name": "Cross-Site Request Forgery (CSRF)", "description": "Perform unauthorized actions on the system by exploiting the bypassable CSRF middleware."}, {"$type": "attack-pattern", "id": "attack-pattern--d7dbd5e3-4f7b-4834-85d9-4ebb5bdfc76a", "name": "Web Shellcode", "description": "Upload and execute custom web shellcode to gain shell access to the system."}, {"$type": "attack-pattern", "id": "attack-pattern--caad17d4-78a5-413f-a81d-c8a04f35f79c", "name": "Exploit Public-Facing Application", "description": "Exploit known vulnerabilities in public-facing applications to gain unauthorized access to the system."}], " relationships": [{"type": "cve", "vuln_ref": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-43787", "object_ref": "https://github.com/honojs/hono/security/advisories/GHSA-rpfr-3m35-5vx5"}]}, "technical_analysis": {"Introduction": "This vulnerability is a critical security issue that can be exploited by attackers to gain unauthorized access to the system.", "Impact and Scope": "The CVSS score for this vulnerability is 5.0, with a high attack complexity and a low attack vector.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1087, T1128, T1509, and T1190.", "Technical Details": "The vulnerability is caused by unvalidated input in the Hono CSRF middleware, which allows attackers to perform unauthorized actions on the system.", "Detection": "The vulnerability can be detected by monitoring system logs for suspicious activity and implementing robust web application firewalls.", "Mitigation": "The vulnerability can be mitigated by patching the vulnerability as soon as possible and implementing robust web application firewalls.", "Conclusion": "This vulnerability is a critical security issue that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "This vulnerability is a critical security issue that can be exploited by attackers to gain unauthorized access to the system.", "Business Impact": "The business impact of this vulnerability is the risk of unauthorized access to sensitive information and systems.", "Technical Impact": "The technical impact of this vulnerability is the potential for attackers to gain shell access to the system and perform unauthorized actions.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability are patching the vulnerability as soon as possible and implementing robust web application firewalls.", "Recommendations": "Executives are recommended to prioritize the mitigation of this vulnerability and implement robust security controls to prevent unauthorized access to the system.", "Conclusions": "The conclusions for this vulnerability are that it is a critical security issue that requires immediate attention and mitigation."}}