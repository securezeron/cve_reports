{"id": "CVE-2020-10789", "sourceIdentifier": "cve@mitre.org", "published": "2020-03-25T14:15:12.227", "lastModified": "2020-03-27T17:01:33.113", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "openITCOCKPIT before 3.7.3 has a web-based terminal that allows attackers to execute arbitrary OS commands via shell metacharacters that are mishandled on an su command line in app/Lib/SudoMessageInterface.php."}, {"lang": "es", "value": "openITCOCKPIT versiones anteriores a 3.7.3, presenta un terminal basado en web que permite a atacantes ejecutar comandos arbitrarios del Sistema Operativo por medio de metacaracteres de shell que son manejados inapropiadamente en una l\u00ednea de comando en la biblioteca app/Lib/SudoMessageInterface.php."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:it-novum:openitcockpit:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.7.3", "matchCriteriaId": "4F60863F-E720-4B98-BCD8-3A16A413203F"}]}]}], "references": [{"url": "https://github.com/it-novum/openITCOCKPIT/commit/73b5b34afa8bd82ff26c0097558341214c768cfc", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://openitcockpit.io/2020/2020/03/23/openitcockpit-3-7-3-released/", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059.001", "comment": "CVE-2020-10789 - This technique is relevant as it allows an attacker to execute arbitrary OS commands via shell metacharacters that are mishandled on an su command line, which is a common tactic used in command injection attacks. Defending against this requires implementing input validation and sanitization to prevent malicious commands from being executed."}, {"techniqueID": "T1190", "comment": "CVE-2020-10789 - This technique can also be used to execute arbitrary OS commands via command injection, which is a common tactic used in web shells and other types of attacks. Defending against this requires implementing secure coding practices and validating user input to prevent malicious commands from being executed."}, {"techniqueID": "T1204", "comment": "CVE-2020-10789 - This technique can also be used to execute arbitrary OS commands via command injection, which is a common tactic used in shell uploads and other types of attacks. Defending against this requires implementing secure coding practices and validating user input to prevent malicious commands from being executed."}], "stix_bundle": {" Bundle": {"type": "bundle", "id": "bundle-1", "created_by_ref": "user: analyst", "created": "2021-01-01T00:00:00.000", "modified": "2021-01-01T00:00:00.000", "name": "CVE-2020-10789 STIX Bundle", "objects": [{"type": "vulnerability", "id": "vuln-1", "created_by_ref": "user: analyst", "created": "2021-01-01T00:00:00.000", "modified": "2021-01-01T00:00:00.000", "name": "CVE-2020-10789", "description": "A vulnerability in openITCOCKPIT allows an attacker to execute arbitrary OS commands via shell metacharacters that are mishandled on an su command line.", "related_object_refs": [{"type": "mitre-technique", "id": "t1059-001"}, {"type": "mitre-technique", "id": "t1190"}, {"type": "mitre-technique", "id": "t1204"}]}, {"type": "mitre-technique", "id": "t1059-001", "created_by_ref": "user: analyst", "created": "2021-01-01T00:00:00.000", "modified": "2021-01-01T00:00:00.000", "name": "Command Injection", "description": "An attacker inserts malicious commands into a command or executable file, enabling the execution of arbitrary system commands or code."}, {"type": "mitre-technique", "id": "t1190", "created_by_ref": "user: analyst", "created": "2021-01-01T00:00:00.000", "modified": "2021-01-01T00:00:00.000", "name": "Exploit Public-Facing Application", "description": "An attacker searches for and exploits vulnerabilities in public-facing applications, such as web portals, FTP servers, or other services."}, {"type": "mitre-technique", "id": "t1204", "created_by_ref": "user: analyst", "created": "2021-01-01T00:00:00.000", "modified": "2021-01-01T00:00:00.000", "name": "File and Directory Discovery", "description": "An attacker uses various techniques to discover files and directories on the target system."}]}}, "technical_analysis": {"Introduction": "CVE-2020-10789 is a command injection vulnerability in openITCOCKPIT that allows an attacker to execute arbitrary OS commands via shell metacharacters that are mishandled on an su command line.", "Impact and Scope": "The vulnerability affects openITCOCKPIT versions prior to 3.7.3 and has a CVSS score of 9.8. It allows an attacker to execute arbitrary OS commands, which can result in the attacker gaining elevated privileges, accessing sensitive data, or disrupting the normal functioning of the system.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1059.001, T1190, and T1204.", "Technical Details": "The vulnerability is caused by the mishandling of shell metacharacters on an su command line in app/Lib/SudoMessageInterface.php. An attacker can exploit this by injecting malicious commands into the su command, allowing them to execute arbitrary OS commands.", "Detection": "Detection of this vulnerability can be challenging, but it can be done by monitoring system logs for suspicious activity and implementing input validation and sanitization to prevent malicious commands from being executed.", "Mitigation": "Mitigating this vulnerability requires implementing secure coding practices, validating user input, and restricting access to sensitive areas of the system.", "Conclusion": "In conclusion, CVE-2020-10789 is a serious vulnerability that can be exploited to gain elevated privileges, access sensitive data, or disrupt the normal functioning of the system. It is essential to implement mitigation strategies to prevent exploitation and to regularly monitor system logs for suspicious activity."}, "executive_analysis": {"Overview": "CVE-2020-10789 is a critical command injection vulnerability in openITCOCKPIT that affects versions prior to 3.7.3.", "Business Impact": "The vulnerability can result in the attacker gaining elevated privileges, accessing sensitive data, or disrupting the normal functioning of the system, which can have significant business implications.", "Technical Impact": "The vulnerability is caused by the mishandling of shell metacharacters on an su command line, which allows an attacker to execute arbitrary OS commands.", "Mitigation Strategies": "The recommended mitigation strategies are implementing secure coding practices, validating user input, and restricting access to sensitive areas of the system.", "Recommendations": "We recommend that all users of openITCOCKPIT upgrade to version 3.7.3 or later, and implement additional security measures to prevent exploitation.", "Conclusions": "In conclusion, CVE-2020-10789 is a critical vulnerability that requires immediate attention. Implementing effective mitigation strategies is essential to prevent exploitation and minimize the risk of a successful attack."}}