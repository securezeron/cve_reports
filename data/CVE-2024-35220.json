{"id": "CVE-2024-35220", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-21T21:15:08.117", "lastModified": "2024-05-22T12:46:53.887", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "@fastify/session is a session plugin for fastify. Requires the @fastify/cookie plugin. When restoring the cookie from the session store, the `expires` field is overriden if the `maxAge` field was set.\nThis means a cookie is never correctly detected as expired and thus expired sessions are not destroyed. This vulnerability has been patched 10.8.0."}, {"lang": "es", "value": "@fastify/session es un complemento de sesi\u00f3n para fastify. Requiere el complemento @fastify/cookie. Al restaurar la cookie desde el almac\u00e9n de sesiones, el campo \"expires\" se anula si se configur\u00f3 el campo \"maxAge\". Esto significa que una cookie nunca se detecta correctamente como caducada y, por lo tanto, las sesiones caducadas no se destruyen. Esta vulnerabilidad ha sido parcheada 10.8.0."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-613"}]}], "references": [{"url": "https://github.com/fastify/session/commit/0495ce5b534c4550f25228821db8098293439f2f", "source": "security-advisories@github.com"}, {"url": "https://github.com/fastify/session/issues/251", "source": "security-advisories@github.com"}, {"url": "https://github.com/fastify/session/security/advisories/GHSA-pj27-2xvp-4qxg", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1134", "comment": "CVE-2024-35220 - This vulnerability can allow an attacker to bypass session expiration, enabling exploitation of other vulnerabilities and maintaining persistence. Defend against this by using session management best practices and configuring session settings to ensure correct expiration."}, {"techniqueID": "T1027", "comment": "CVE-2024-35220 - Attackers can potentially exploit this vulnerability to maintain persistence by prolonging the session duration. Implement defense strategies such as configuring session timeout and frequency of session renewal."}, {"techniqueID": "T1190", "comment": "CVE-2024-35220 - This vulnerability can enable attackers to maintain and manipulate session data, potentially affecting system integrity. Implement defense strategies such as session validation and input validation checks."}], "stix_bundle": {"type": "bundle", "id": "CVE-2024-35220", "title": "Fastify Session Plugin Vulnerability (CVE-2024-35220)", "created_by": "Your Name", "created": "2024-05-23T14:30:00.000Z", "modified": "2024-05-23T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "CVE-2024-35220", "title": "Fastify Session Plugin Vulnerability (CVE-2024-35220)", "description": "The @fastify/session plugin for Fastify does not properly handle session expiration.", "published": "2024-05-21T21:15:08.117Z", "last_modified": "2024-05-22T12:46:53.887Z", "vuln_status": "Awaiting Analysis"}, {"type": "technique", "id": "T1134", "title": "Browser Bookmarking", "description": "This technique involves creating bookmarks in the victim's browser to facilitate future access to compromised systems."}, {"type": "technique", "id": "T1027", "title": "Logon to Modify Authentication Information", "description": "This technique involves logging onto a system using valid credentials and modifying authentication information to facilitate subsequent unauthorized access."}, {"type": "technique", "id": "T1190", "title": "Exploit Other Vulnerabilities", "description": "This technique involves exploiting other vulnerabilities in a system to gain unauthorized access or maintain persistence."}, {"type": "course-of-action", "id": "COA-1", "title": "Configure Session Timeout", "description": "Configure the session timeout to ensure that sessions are properly expired and deleted."}, {"type": "course-of-action", "id": "COA-2", "title": "Implement Input Validation", "description": "Implement input validation checks to prevent malicious input from exploiting this vulnerability."}], "relationships": [{"type": "related_to", "source_id": "CVE-2024-35220", "target_id": "T1134"}, {"type": "related_to", "source_id": "CVE-2024-35220", "target_id": "T1027"}, {"type": "related_to", "source_id": "CVE-2024-35220", "target_id": "T1190"}, {"type": "relates_to", "source_id": "COA-1", "target_id": "T1134"}, {"type": "relates_to", "source_id": "COA-2", "target_id": "T1190"}]}, "technical_analysis": {"Introduction": "The Fastify Session Plugin Vulnerability (CVE-2024-35220) is a serious vulnerability that affects the @fastify/session plugin. This plugin is used to manage sessions in Fastify-based applications.", "Impact and Scope": "This vulnerability can allow an attacker to bypass session expiration, enabling exploitation of other vulnerabilities and maintaining persistence. The attack vector is over the network and the complexity is low.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1134, T1027, and T1190.", "Technical Details": "The vulnerability occurs when the `expires` field in the session cookie is overridden by the `maxAge` field, preventing the cookie from being properly detected as expired.", "Detection": "Detecting this vulnerability involves monitoring session expiration and checking for inconsistencies in session data.", "Mitigation": "Mitigating this vulnerability involves configuring session timeout and implementing input validation checks.", "Conclusion": "The Fastify Session Plugin Vulnerability (CVE-2024-35220) is a serious vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The Fastify Session Plugin Vulnerability (CVE-2024-35220) is a significant vulnerability that affects the security of Fastify-based applications.", "Business Impact": "This vulnerability can lead to unauthorized access, data theft, and system compromise, resulting in significant financial and reputational losses.", "Technical Impact": "The technical impact of this vulnerability is that it allows attackers to bypass session expiration and maintain persistence, enabling exploitation of other vulnerabilities.", "Mitigation Strategies": "Recommend configuring session timeout and implementing input validation checks to mitigate this vulnerability.", "Recommendations": "Recommend that executives prioritize the mitigation of this vulnerability to protect their organizations from potential attacks.", "Conclusions": "The Fastify Session Plugin Vulnerability (CVE-2024-35220) is a critical vulnerability that requires immediate attention and mitigation. Executives should prioritize this vulnerability and implement mitigation strategies to protect their organizations from potential attacks."}}