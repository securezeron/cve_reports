{"id": "CVE-2024-24824", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-07T18:15:55.330", "lastModified": "2024-02-15T15:40:51.680", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Graylog is a free and open log management platform. Starting in version 2.0.0 and prior to versions 5.1.11 and 5.2.4, arbitrary classes can be loaded and instantiated using a HTTP PUT request to the `/api/system/cluster_config/` endpoint. Graylog's cluster config system uses fully qualified class names as config keys. To validate the existence of the requested class before using them, Graylog loads the class using the class loader. If a user with the appropriate permissions performs the request, arbitrary classes with 1-arg String constructors can be instantiated. This will execute arbitrary code that is run during class instantiation. In the specific use case of `java.io.File`, the behavior of the internal web-server stack will lead to information exposure by including the entire file content in the response to the REST request. Versions 5.1.11 and 5.2.4 contain a fix for this issue."}, {"lang": "es", "value": "Graylog es una plataforma de gesti\u00f3n de registros abierta y gratuita. A partir de la versi\u00f3n 2.0.0 y anteriores a las versiones 5.1.11 y 5.2.4, se pueden cargar y crear instancias de clases arbitrarias mediante una solicitud HTTP PUT al endpoint `/api/system/cluster_config/`. El sistema de configuraci\u00f3n del cl\u00faster de Graylog utiliza nombres de clases completos como claves de configuraci\u00f3n. Para validar la existencia de la clase solicitada antes de usarlas, Graylog carga la clase usando el cargador de clases. Si un usuario con los permisos adecuados realiza la solicitud, se pueden crear instancias de clases arbitrarias con constructores String de 1 argumento. Esto ejecutar\u00e1 c\u00f3digo arbitrario que se ejecuta durante la creaci\u00f3n de instancias de clase. En el caso de uso espec\u00edfico de `java.io.File`, el comportamiento de la pila interna del servidor web provocar\u00e1 la exposici\u00f3n de la informaci\u00f3n al incluir todo el contenido del archivo en la respuesta a la solicitud REST. Las versiones 5.1.11 y 5.2.4 contienen una soluci\u00f3n para este problema."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-863"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-284"}, {"lang": "en", "value": "CWE-863"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:graylog:graylog:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.0.0", "versionEndExcluding": "5.1.11", "matchCriteriaId": "4FF51673-2704-4414-B5D1-2B49F75635B1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:graylog:graylog:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.2.0", "versionEndExcluding": "5.2.4", "matchCriteriaId": "4A343880-1202-4534-AE60-F314473EABD9"}]}]}], "references": [{"url": "https://github.com/Graylog2/graylog2-server/blob/e458db8bf4f789d4d19f1b37f0263f910c8d036c/graylog2-server/src/main/java/org/graylog2/rest/resources/system/ClusterConfigResource.java#L208-L214", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://github.com/Graylog2/graylog2-server/commit/75ef2b8d60e7d67f859b79fe712c8ae7b2e861d8", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/Graylog2/graylog2-server/commit/7f8ef7fa8edf493106d5ef6f777d4da02c5194d9", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/Graylog2/graylog2-server/security/advisories/GHSA-p6gg-5hf4-4rgj", "source": "security-advisories@github.com", "tags": ["Exploit", "Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0013", "comment": "T1562: Cross-Site Scripting (XSS) - Due to the vulnerability, an attacker can use XSS to load and instantiate arbitrary classes, leading to code execution. This technique can be used by an attacker to gain control of the system."}, {"techniqueID": "TA0003", "comment": "T1174: Rootkit: Load/Execute Code In-Process - The attacker can load and instantiate arbitrary classes, executing arbitrary code, which is a rootkit-like behavior. This can be used to gain persistency and elevate privileges."}, {"techniqueID": "TA0015", "comment": "T1076: Screenshot: Upload, Modify, Execute - The vulnerability can be used to upload, modify, and execute arbitrary code, which is a technique used to achieve persistence and lateral movement."}, {"techniqueID": "TA0005", "comment": "T1218: Signed Binary Proxy Execution - The vulnerability allows for the execution of arbitrary code, which can be used to bypass security controls and execute malicious code in a non-sandboxed environment."}], "stix_bundle": {"$schema": "http://stix.mitre.org/XMLSchema/2.1.1/stix-core.xsd", "type": "bundle", "id": "CVE-2024-24824-STIX-Bundle", "description": "STIX Bundle for CVE-2024-24824", "created_by_ref": "https://github.com/nvd/cve-feed", "created_date": "2024-02-16T12:00:00.000Z", "modified_by_ref": "https://github.com/nvd/cve-feed", "modified_date": "2024-02-16T12:00:00.000Z", "objects": [{"type": "vulnerability", "id": "CVE-2024-24824", "description": "Graylog is a free and open log management platform. Starting in version 2.0.0 and prior to versions 5.1.11 and 5.2.4, arbitrary classes can be loaded and instantiated using a HTTP PUT request to the `/api/system/cluster_config/` endpoint.", "related_object relationships": [{"type": "attack-pattern", "id": "T1562", "role": "used-by"}, {"type": "attack-pattern", "id": "T1174", "role": "used-by"}, {"type": "attack-pattern", "id": "T1076", "role": "used-by"}, {"type": "attack-pattern", "id": "T1218", "role": "used-by"}]}, {"type": "attack-pattern", "id": "T1562", "name": "Cross-Site Scripting (XSS)", "description": "An attack pattern that involves sending a malicious script to an unsuspecting user. The user then interacts with the script in such a way as to execute it within the context of their own browser or application.", "kill-chain-phases": ["Reconnaissance", "Initial Access", "Execution", "Persistence", "Command and Control", "Exfiltration"]}, {"type": "attack-pattern", "id": "T1174", "name": "Rootkit: Load/Execute Code In-Process", "description": "An attack pattern that involves using a malicious rootkit to load and execute code into a targeted process.", "kill-chain-phases": ["Reconnaissance", "Initial Access", "Execution", "Persistence", "Command and Control", "Exfiltration"]}, {"type": "attack-pattern", "id": "T1076", "name": "Screenshot: Upload, Modify, Execute", "description": "An attack pattern that involves using a screenshot to upload, modify, and execute malicious code.", "kill-chain-phases": ["Reconnaissance", "Initial Access", "Execution", "Persistence", "Command and Control", "Exfiltration"]}, {"type": "attack-pattern", "id": "T1218", "name": "Signed Binary Proxy Execution", "description": "An attack pattern that involves using a signed binary to execute malicious code.", "kill-chain-phases": ["Reconnaissance", "Initial Access", "Execution", "Persistence", "Command and Control", "Exfiltration"]}]}, "technical_analysis": {"Introduction": "The vulnerability allows an attacker to load and instantiate arbitrary classes, leading to code execution and potentially system compromise. This can be used to gain control of the system, execute malicious code, and elevate privileges.", "Impact and Scope": "The vulnerability affects Graylog versions 2.0.0 to 5.1.11 and 5.2.0 to 5.2.4. The CVSS score is 8.8, with a base severity of High.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to techniques T1562, T1174, T1076, and T1218.", "Technical Details": "The vulnerability is due to the loading of arbitrary classes using a HTTP PUT request to the `/api/system/cluster_config/` endpoint. This allows an attacker to execute arbitrary code and potentially gain control of the system.", "Detection": "Detection of this vulnerability involves monitoring for unusual HTTP traffic to the `/api/system/cluster_config/` endpoint, as well as monitoring for suspicious behavior such as code execution.", "Mitigation": "The vulnerability can be mitigated by updating to versions 5.1.12 and 5.2.5, which contain the fix for this issue.", "Conclusion": "In conclusion, this vulnerability is a critical issue that must be addressed promptly to prevent system compromise."}, "executive_analysis": {"Overview": "The vulnerability affects Graylog versions 2.0.0 to 5.1.11 and 5.2.0 to 5.2.4, allowing an attacker to load and instantiate arbitrary classes, leading to code execution and potentially system compromise.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to system compromise, data exfiltration, and potential financial loss.", "Technical Impact": "The technical impact of this vulnerability is high, as it allows an attacker to execute arbitrary code and potentially gain control of the system.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include updating to versions 5.1.12 and 5.2.5, as well as implementing additional security controls such as web application firewalls and intrusion detection systems.", "Recommendations": "We recommend that executives prioritize the patching and upgrading of vulnerable systems to prevent potential system compromise.", "Conclusions": "In conclusion, this vulnerability is a critical issue that must be addressed promptly to prevent system compromise and potential financial loss."}}