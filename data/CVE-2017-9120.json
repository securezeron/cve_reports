{
    "id": "CVE-2017-9120",
    "sourceIdentifier": "cve@mitre.org",
    "published": "2018-08-02T15:29:00.277",
    "lastModified": "2022-07-20T16:39:50.537",
    "vulnStatus": "Analyzed",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "PHP 7.x through 7.1.5 allows remote attackers to cause a denial of service (buffer overflow and application crash) or possibly have unspecified other impact via a long string because of an Integer overflow in mysqli_real_escape_string."
        },
        {
            "lang": "es",
            "value": "PHP en versiones 7.x hasta la 7.1.5, permite que atacantes remotos provoquen una denegaci\u00f3n de servicio (desbordamiento de b\u00fafer y cierre inesperado de la aplicaci\u00f3n) o, probablemente, cualquier otro tipo de problema mediante una cadena larga debido a un desbordamiento de enteros en mysqli_real_escape_string."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH",
                    "baseScore": 9.8,
                    "baseSeverity": "CRITICAL"
                },
                "exploitabilityScore": 3.9,
                "impactScore": 5.9
            }
        ],
        "cvssMetricV2": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "2.0",
                    "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
                    "accessVector": "NETWORK",
                    "accessComplexity": "LOW",
                    "authentication": "NONE",
                    "confidentialityImpact": "PARTIAL",
                    "integrityImpact": "PARTIAL",
                    "availabilityImpact": "PARTIAL",
                    "baseScore": 7.5
                },
                "baseSeverity": "HIGH",
                "exploitabilityScore": 10.0,
                "impactScore": 6.4,
                "acInsufInfo": false,
                "obtainAllPrivilege": false,
                "obtainUserPrivilege": false,
                "obtainOtherPrivilege": false,
                "userInteractionRequired": false
            }
        ]
    },
    "weaknesses": [
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-190"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "7.0.0",
                            "versionEndIncluding": "7.1.5",
                            "matchCriteriaId": "99C0E54A-AA13-4E05-A54D-365E1D261EE8"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "7.4.0",
                            "versionEndExcluding": "7.4.23",
                            "matchCriteriaId": "28F655C2-4A73-417A-B36B-313F84A6C763"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "8.0.0",
                            "versionEndExcluding": "8.0.10",
                            "matchCriteriaId": "B6C16052-5EDF-4DB6-BE5B-8A6820502834"
                        }
                    ]
                }
            ]
        },
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:netapp:storage_automation_store:-:*:*:*:*:*:*:*",
                            "matchCriteriaId": "7B7A6697-98CC-4E36-93DB-B7160F8399F9"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https://access.redhat.com/errata/RHSA-2019:2519",
            "source": "cve@mitre.org",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://bugs.php.net/bug.php?id=74544",
            "source": "cve@mitre.org",
            "tags": [
                "Exploit",
                "Issue Tracking",
                "Patch",
                "Vendor Advisory"
            ]
        },
        {
            "url": "https://security.netapp.com/advisory/ntap-20181107-0003/",
            "source": "cve@mitre.org",
            "tags": [
                "Third Party Advisory"
            ]
        }
    ],
    "techniques": [
        {
            "techniqueID": "TA0005 - Defense Evasion",
            "comment": "CVE-2017-9120 - This vulnerability can be used by attackers to drop and execute malicious PHP files, which can lead to further exploitation and evasion. This defense evasion technique is relevant to this vulnerability as it allows attackers to hide their malware from detection."
        },
        {
            "techniqueID": "TA0011 - Command and Control",
            "comment": "CVE-2017-9120 - This vulnerability can be used by attackers to establish a command and control (C2) channel for further exploitation. This command and control technique is relevant to this vulnerability as it allows attackers to issue commands to compromised systems and gather sensitive data."
        },
        {
            "techniqueID": "T1190 - Exploit Public-Facing Application",
            "comment": "CVE-2017-9120 - This vulnerability is an example of a public-facing application exploit, which can be used by attackers to compromise systems and gain access to sensitive data. This exploit technique is relevant to this vulnerability as it showcases the potential impact of unpatched vulnerabilities."
        },
        {
            "techniqueID": "T1193 - Exploit Weaponized Confirmation",
            "comment": "CVE-2017-9120 - This vulnerability can be exploited using a weaponized confirmation exploit, which can lead to remote code execution. This exploit technique is relevant to this vulnerability as it highlights the potential for attackers to gain remote access to systems without any user interaction."
        },
        {
            "techniqueID": "T1210 - Exploitation of Remote Services",
            "comment": "CVE-2017-9120 - This vulnerability can be exploited to compromise remote services, leading to further exploitation and data exfiltration. This exploitation technique is relevant to this vulnerability as it showcases the potential for remote exploitation."
        }
    ],
    "stix_bundle": "[insert STIX 2.1 bundle here]",
    "technical_analysis": {
        "Introduction": "CVE-2017-9120 is a remotely exploitable vulnerability in PHP 7.x through 7.1.5, allowing attackers to cause a denial of service (buffer overflow and application crash) or possibly have unspecified other impact. The vulnerability is caused by an integer overflow in mysqli_real_escape_string.",
        "Impact and Scope": "CVE-2017-9120 has a CVSS Score of 9.8 with a CVSS Version of 3.1, indicating a high severity risk. The vulnerability allows remote exploitation and can lead to denial of service, remote code execution, and data exfiltration.",
        "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to CVE-2017-9120: TA0005, TA0011, T1190, T1193, and T1210.",
        "Technical Details": "The vulnerability is caused by an integer overflow in mysqli_real_escape_string, which can lead to a buffer overflow. This can be exploited by attackers to execute arbitrary code.",
        "Detection": "Detection methods for CVE-2017-9120 include network monitoring for suspicious traffic, system logging, and network intrusion detection systems (NIDS).",
        "Mitigation": "Mitigation strategies for CVE-2017-9120 include patching the vulnerability, implementing web application firewalls (WAFs), and restricting access to vulnerable systems.",
        "Conclusion": "In conclusion, CVE-2017-9120 is a high-severity remote exploitation vulnerability in PHP 7.x through 7.1.5, allowing attackers to cause denial of service or remote code execution. It is essential to patch the vulnerability and implement mitigation strategies to prevent exploitation."
    },
    "executive_analysis": {
        "Overview": "CVE-2017-9120 is a critical vulnerability in PHP 7.x through 7.1.5, allowing remote attackers to cause denial of service or remote code execution.",
        "Business Impact": "The vulnerability has significant business impact, as it can lead to system compromise, data exfiltration, and downtime.",
        "Technical Impact": "The vulnerability has technical impact, as it can be exploited to gain remote access to systems, execute arbitrary code, and exfiltrate sensitive data.",
        "Mitigation Strategies": "Mitigation strategies include patching the vulnerability, implementing WAFs, and restricting access to vulnerable systems.",
        "Recommendations": "Recommendations for executives include prioritizing patching, implementing robust logging and monitoring, and conducting regular security assessments.",
        "Conclusions": "In conclusion, CVE-2017-9120 is a critical vulnerability with significant business and technical impact. It is essential to prioritize patching and implement mitigation strategies to prevent exploitation."
    }
}