{"id": "CVE-2023-52767", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-21T16:15:15.917", "lastModified": "2024-05-21T16:53:56.550", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ntls: fix NULL deref on tls_sw_splice_eof() with empty record\n\nsyzkaller discovered that if tls_sw_splice_eof() is executed as part of\nsendfile() when the plaintext/ciphertext sk_msg are empty, the send path\ngets confused because the empty ciphertext buffer does not have enough\nspace for the encryption overhead. This causes tls_push_record() to go on\nthe `split = true` path (which is only supposed to be used when interacting\nwith an attached BPF program), and then get further confused and hit the\ntls_merge_open_record() path, which then assumes that there must be at\nleast one populated buffer element, leading to a NULL deref.\n\nIt is possible to have empty plaintext/ciphertext buffers if we previously\nbailed from tls_sw_sendmsg_locked() via the tls_trim_both_msgs() path.\ntls_sw_push_pending_record() already handles this case correctly; let's do\nthe same check in tls_sw_splice_eof()."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: tls: corrige NULL deref en tls_sw_splice_eof() con registro vac\u00edo syzkaller descubri\u00f3 que si tls_sw_splice_eof() se ejecuta como parte de sendfile() cuando el texto plano/texto cifrado sk_msg est\u00e1 vac\u00edo, el env\u00edo La ruta se confunde porque el b\u00fafer de texto cifrado vac\u00edo no tiene suficiente espacio para la sobrecarga de cifrado. Esto hace que tls_push_record() vaya a la ruta `split = true` (que se supone que solo debe usarse al interactuar con un programa BPF adjunto), y luego se confunda a\u00fan m\u00e1s y acceda a la ruta tls_merge_open_record(), que luego supone que hay debe haber al menos un elemento de b\u00fafer poblado, lo que lleva a una deref NULL. Es posible tener buffers de texto plano/texto cifrado vac\u00edos si previamente salimos de tls_sw_sendmsg_locked() a trav\u00e9s de la ruta tls_trim_both_msgs(). tls_sw_push_pending_record() ya maneja este caso correctamente; hagamos la misma verificaci\u00f3n en tls_sw_splice_eof()."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/2214e2bb5489145aba944874d0ee1652a0a63dc8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/53f2cb491b500897a619ff6abd72f565933760f0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/944900fe2736c07288efe2d9394db4d3ca23f2c9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2023-52767 - This technique is applicable as it involves the exploitation of a NULL dereference vulnerability in the Linux kernel's TLS module, allowing an attacker to manipulate the TLS state and potentially gain control of the system. Defending against this vulnerability involves patching the affected kernel version and implementing security controls to prevent exploitation."}, {"techniqueID": "T1048", "comment": "CVE-2023-52767 - This technique is relevant as it involves the exploitation of a remote code execution vulnerability in the Linux kernel, allowing an attacker to execute arbitrary code on the system. Defending against this vulnerability involves patching the affected kernel version and implementing security controls to prevent exploitation."}], "stix_bundle": "To be added later.", "technical_analysis": {"Introduction": "The CVE-2023-52767 vulnerability is a NULL dereference vulnerability in the Linux kernel's TLS module. It allows an attacker to manipulate the TLS state and potentially gain control of the system.", "Impact and Scope": "CVSS Score: 9.8, Attack Vector: CVSS:3.1/AV:N/AC:N/PR:N/UI:N/S:U/C:H/I:H/A:H", "Related MITRE ATT&CK Techniques": "T1190, T1048", "Technical Details": "The vulnerability occurs when the tls_sw_splice_eof() function is executed as part of sendfile() and the plaintext/ciphertext sk_msg are empty. This causes the tls_push_record() function to go on the 'split = true' path, leading to a NULL dereference.", "Detection": "Detection of this vulnerability involves identifying potential exploitation attempts and monitoring system calls for suspicious activity.", "Mitigation": "Mitigation involves patching the affected kernel version and implementing security controls to prevent exploitation.", "Conclusion": "This vulnerability is highly critical and may have severe consequences if exploited successfully."}, "executive_analysis": {"Overview": "The CVE-2023-52767 vulnerability is a critical remote code execution vulnerability in the Linux kernel's TLS module.", "Business Impact": "This vulnerability has significant business implications, potentially allowing attackers to execute arbitrary code on the system and compromising sensitive data.", "Technical Impact": "This vulnerability allows an attacker to manipulate the TLS state and potentially gain control of the system.", "Mitigation Strategies": "Patching the affected kernel version and implementing security controls are the primary mitigation strategies.", "Recommendations": "Executives should prioritize patching and implementing security controls to prevent exploitation.", "Conclusions": "CVE-2023-52767 is a critical vulnerability that requires immediate attention and remediation."}}