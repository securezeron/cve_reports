{"id": "CVE-2024-20328", "sourceIdentifier": "ykramarz@cisco.com", "published": "2024-03-01T21:15:07.790", "lastModified": "2024-03-01T22:22:25.913", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability in the VirusEvent feature of ClamAV could allow a local attacker to inject arbitrary commands with the privileges of the application service account.The vulnerability is due to unsafe handling of file names. A local attacker could exploit this vulnerability by supplying a file name containing command-line sequences. When processed on a system using configuration options for the VirusEvent feature, the attacker could cause the application to execute arbitrary commands.\nClamAV has released software updates that address this vulnerability. There are no workarounds that address this vulnerability.\n\n\n"}, {"lang": "es", "value": "Una vulnerabilidad en la caracter\u00edstica VirusEvent de ClamAV podr\u00eda permitir a un atacante local inyectar comandos arbitrarios con los privilegios de la cuenta de servicio de la aplicaci\u00f3n. La vulnerabilidad se debe al manejo inseguro de nombres de archivos. Un atacante local podr\u00eda aprovechar esta vulnerabilidad proporcionando un nombre de archivo que contenga secuencias de l\u00ednea de comandos. Cuando se procesa en un sistema usando opciones de configuraci\u00f3n para la funci\u00f3n VirusEvent, el atacante podr\u00eda hacer que la aplicaci\u00f3n ejecute comandos arbitrarios. ClamAV ha lanzado actualizaciones de software que abordan esta vulnerabilidad. No existen soluciones alternativas que aborden esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "ykramarz@cisco.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.4}]}, "weaknesses": [{"source": "ykramarz@cisco.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-78"}]}], "references": [{"url": "https://blog.clamav.net/2023/11/clamav-130-122-105-released.html", "source": "ykramarz@cisco.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-20328 - Unvalidated input could allow an attacker to execute arbitrary commands as the ClamAV service account. This technique can be used to gain persistence on a system or to perform actions with elevated privileges."}, {"techniqueID": "T1027", "comment": "CVE-2024-20328 - The vulnerability in the VirusEvent feature can be exploited to inject arbitrary commands, allowing an attacker to gain system-level access and perform actions with elevated privileges."}, {"techniqueID": "T1202", "comment": "CVE-2024-20328 - The vulnerability can be exploited to execute arbitrary code, potentially allowing an attacker to gain system-level access and perform actions with elevated privileges."}, {"techniqueID": "T1390", "comment": "CVE-2024-20328 - The vulnerability can be used to hijack system-level privileges, allowing an attacker to perform actions with elevated privileges."}], "stix_bundle": {"@stix_core_v21": {" Bundle": {"handling": "manually", "spec_version": "2.1"}, ".objects": [{"ObjectReference": {"value": "vulnerability--CVE-2024-20328", "id": "vulnerability--CVE-2024-20328", "type": "vulnerability"}, "Observable": {"data_type": "string", "data": "CVE-2024-20328", "start": "2024-03-01T21:15:07.790", "stop": "2024-03-01T22:22:25.913"}}, {"Intrusion-Detection-System-Setting": {"id": "IDS-Setting-1", "type": "intrusion-detection-system-setting"}, "Related-Object": {"id_ref": "vulnerability--CVE-2024-20328", "type": "related-object"}}, {"Intrusion-Detection-System-Setting": {"id": "IDS-Setting-2", "type": "intrusion-detection-system-setting"}, "Related-Object": {"id_ref": "vulnerability--CVE-2024-20328", "type": "related-object"}}], " relationships": [{"relationship": "related-to", "from": "vulnerability--CVE-2024-20328", "to": "IDS-Setting-1"}, {"relationship": "related-to", "from": "vulnerability--CVE-2024-20328", "to": "IDS-Setting-2"}]}}, "technical_analysis": {"Introduction": "The CVE-2024-20328 vulnerability in ClamAV's VirusEvent feature allows an attacker to inject arbitrary commands, potentially leading to code execution with elevated privileges.", "Impact and Scope": "The vulnerability has a CVSS score of 5.3 with a severity of MEDIUM. It can be exploited via LOCAL attack vector, requiring LOW privileges.", "Related MITRE ATT&CK Techniques": "T1190, T1027, T1202, and T1390", "Technical Details": "The vulnerability occurs due to unsafe handling of file names, allowing an attacker to inject arbitrary commands.", "Detection": "Detection methods include monitoring system logs for suspicious command executions and analyzing system files for unusual modifications.", "Mitigation": "Mitigation strategies include updating ClamAV software, disabling the VirusEvent feature, and implementing strict file access controls.", "Conclusion": "The CVE-2024-20328 vulnerability presents a significant risk to systems utilizing ClamAV's VirusEvent feature, highlighting the importance of timely software updates and robust security measures."}, "executive_analysis": {"Overview": "The CVE-2024-20328 vulnerability poses a moderate risk to organizations utilizing ClamAV's VirusEvent feature, requiring immediate attention and mitigation.", "Business Impact": "The vulnerability's potential exploitation could lead to data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability can be exploited to execute arbitrary code, potentially gaining system-level access and control.", "Mitigation Strategies": "Implement software updates, disable VirusEvent feature, and enhance system security controls.", "Recommendations": "Executives should prioritize software updates, monitor system logs, and conduct regular security audits to ensure the vulnerability is mitigated and systems are secure.", "Conclusions": "Immediate attention to the CVE-2024-20328 vulnerability is critical to prevent potential attacks and minimize business risks."}}