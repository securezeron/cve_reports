{"id": "CVE-2024-5128", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T19:16:04.323", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "An Insecure Direct Object Reference (IDOR) vulnerability was identified in lunary-ai/lunary, affecting versions up to and including 1.2.2. This vulnerability allows unauthorized users to view, update, or delete any dataset_prompt or dataset_prompt_variation within any dataset or project. The issue stems from improper access control checks in the dataset management endpoints, where direct references to object IDs are not adequately secured against unauthorized access. This vulnerability was fixed in version 1.2.25."}, {"lang": "es", "value": "Se identific\u00f3 una vulnerabilidad de referencia directa de objetos inseguros (IDOR) en lunary-ai/lunary, que afecta a las versiones hasta la 1.2.2 incluida. Esta vulnerabilidad permite a usuarios no autorizados ver, actualizar o eliminar cualquier dataset_prompt o dataset_prompt_variation dentro de cualquier conjunto de datos o proyecto. El problema surge de controles de acceso inadecuados en los endpoints de gesti\u00f3n de conjuntos de datos, donde las referencias directas a los ID de objetos no est\u00e1n adecuadamente protegidas contra el acceso no autorizado. Esta vulnerabilidad se solucion\u00f3 en la versi\u00f3n 1.2.25."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 9.4, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.5}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-284"}]}], "references": [{"url": "https://github.com/lunary-ai/lunary/commit/0755dde1afc2a74ec23b55eee03e4416916cf48f", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/11248071-11b2-42d9-991a-504bf2044332", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1059.003", "comment": "CVE-2024-5128 - This Insecure Direct Object Reference (IDOR) vulnerability allows unauthorized users to view, update, or delete any dataset_prompt or dataset_prompt_variation within any dataset or project, demonstrating the importance of proper access control checks and secure object references."}, {"techniqueID": "T1190", "comment": "CVE-2024-5128 - The lack of secure object references and improper access control checks can enable attackers to exploit this vulnerability, highlighting the need for robust access controls and secure coding practices."}, {"techniqueID": "T1505.003", "comment": "CVE-2024-5128 - The ability to view, update, or delete dataset_prompt or dataset_prompt_variation objects without proper authorization can facilitate lateral movement and data manipulation, emphasizing the importance of implementing strong access controls and monitoring."}], "stix_bundle": {"objects": [{"id": "bundle--cve-2024-5128", "type": "bundle", "spec_version": "2.1", "meta": {"generator": "cyber security expert"}, "entities": [{"id": "entity--cve-2024-5128", "type": "incident", "created_by_ref": "identity--cyber_security_expert", "started": "2024-06-06T19:16:04.323", "ended": null, "status": "awaiting-analysis", "severity": "critical", "description": "Insecure Direct Object Reference (IDOR) vulnerability in lunary-ai/lunary", "vulnerability_refs": [{"id": "vulnerability--cve-2024-5128", "type": "vulnerability", "name": "CVE-2024-5128"}]}, {"id": "entity--technique-t1059-003", "type": " technique", "name": "T1059.003", "description": "IDOR - Account Manipulation", "exploits_refs": [{"id": "exploit--cve-2024-5128-t1059-003", "type": "exploit", "name": "Exploit for CVE-2024-5128 (T1059.003)"}]}, {"id": "entity--technique-t1190", "type": "technique", "name": "T1190", "description": "Exploitation of Authentication", "exploits_refs": [{"id": "exploit--cve-2024-5128-t1190", "type": "exploit", "name": "Exploit for CVE-2024-5128 (T1190)"}]}, {"id": "entity--technique-t1505-003", "type": "technique", "name": "T1505.003", "description": "Data Manipulation", "exploits_refs": [{"id": "exploit--cve-2024-5128-t1505-003", "type": "exploit", "name": "Exploit for CVE-2024-5128 (T1505.003)"}]}], "relationships": [{"id": "relationship--cve-2024-5128-to-entity--cve-2024-5128", "type": "related-to", "source_ref": "bundle--cve-2024-5128", "target_ref": "entity--cve-2024-5128"}, {"id": "relationship--entity--cve-2024-5128-to-technique--t1059-003", "type": "exploits", "source_ref": "entity--cve-2024-5128", "target_ref": "entity--technique-t1059-003"}, {"id": "relationship--entity--cve-2024-5128-to-technique--t1190", "type": "exploits", "source_ref": "entity--cve-2024-5128", "target_ref": "entity--technique-t1190"}, {"id": "relationship--entity--cve-2024-5128-to-technique--t1505-003", "type": "exploits", "source_ref": "entity--cve-2024-5128", "target_ref": "entity--technique-t1505-003"}]}]}, "technical_analysis": {"Introduction": "CVE-2024-5128 is an IDOR vulnerability in lunary-ai/lunary that allows unauthorized users to view, update, or delete any dataset_prompt or dataset_prompt_variation within any dataset or project.", "Impact and Scope": "The vulnerability has a CVSS score of 9.4, with a high impact on confidentiality and integrity, and low availability.", "Related MITRE ATT&CK Techniques": "The techniques related to this vulnerability include T1059.003, T1190, and T1505.003.", "Technical Details": "The vulnerability arises from improper access control checks in the dataset management endpoints, where direct references to object IDs are not secured against unauthorized access.", "Detection": "Detection can be performed using security information and event management (SIEM) systems and log analysis tools.", "Mitigation": "Mitigation strategies include implementing robust access controls and secure coding practices, as well as monitoring and logging for suspicious activity.", "Conclusion": "In conclusion, CVE-2024-5128 is a critical vulnerability that requires immediate attention and remediation to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-5128 is a critical vulnerability in lunary-ai/lunary that affects unauthorized access to sensitive data.", "Business Impact": "The vulnerability has the potential to result in data breaches and compromise business operations, impacting revenue and reputation.", "Technical Impact": "The vulnerability has a high technical impact, allowing attackers to manipulate sensitive data and escalate privileges.", "Mitigation Strategies": "Recommendations include implementing robust access controls, secure coding practices, and regular security audits.", "Recommendations": "Recommendations for executives include prioritizing remediation, implementing incident response plans, and conducting regular security training.", "Conclusions": "In conclusion, prompt remediation and mitigation are essential to prevent exploitation and protect business operations."}}