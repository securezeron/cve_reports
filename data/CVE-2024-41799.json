{"id": "CVE-2024-41799", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-29T15:15:16.267", "lastModified": "2024-07-29T16:21:52.517", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "tgstation-server is a production scale tool for BYOND server management. Prior to 6.8.0, low permission users using the \"Set .dme Path\" privilege could potentially set malicious .dme files existing on the host machine to be compiled and executed. These .dme files could be uploaded via tgstation-server (requiring a separate, isolated privilege) or some other means. A server configured to execute in BYOND's trusted security level (requiring a third separate, isolated privilege OR being set by another user) could lead to this escalating into remote code execution via BYOND's shell() proc. The ability to execute this kind of attack is a known side effect of having privileged TGS users, but normally requires multiple privileges with known weaknesses. This vector is not intentional as it does not require control over the where deployment code is sourced from and _may_ not require remote write access to an instance's `Configuration` directory. This problem is fixed in versions 6.8.0 and above."}, {"lang": "es", "value": "tgstation-server es una herramienta a escala de producci\u00f3n para la gesti\u00f3n de servidores BYOND. Antes de 6.8.0, los usuarios con permisos bajos que usaban el privilegio \"Set .dme Path\" pod\u00edan configurar archivos .dme maliciosos existentes en la m\u00e1quina host para compilarlos y ejecutarlos. Estos archivos .dme se pueden cargar a trav\u00e9s del servidor tgstation (que requiere un privilegio aislado e independiente) o por alg\u00fan otro medio. Un servidor configurado para ejecutarse en el nivel de seguridad confiable de BYOND (que requiere un tercer privilegio separado y aislado O que lo establezca otro usuario) podr\u00eda llevar a que esto se convierta en una ejecuci\u00f3n remota de c\u00f3digo a trav\u00e9s del proceso shell() de BYOND. La capacidad de ejecutar este tipo de ataque es un efecto secundario conocido de tener usuarios privilegiados de TGS, pero normalmente requiere m\u00faltiples privilegios con debilidades conocidas. Este vector no es intencional ya que no requiere control sobre el origen del c\u00f3digo de implementaci\u00f3n y _puede_ no requerir acceso de escritura remota al directorio \"Configuration\" de una instancia. Este problema se solucion\u00f3 en las versiones 6.8.0 y superiores."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:L/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "HIGH", "baseScore": 8.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-22"}]}], "references": [{"url": "https://github.com/tgstation/tgstation-server/commit/374852fe5ae306415eb5aafb2d16b06897d7afe4", "source": "security-advisories@github.com"}, {"url": "https://github.com/tgstation/tgstation-server/pull/1835", "source": "security-advisories@github.com"}, {"url": "https://github.com/tgstation/tgstation-server/security/advisories/GHSA-c3h4-9gc2-f7h4", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1068", "comment": "Prior to 6.8.0, low permission users using the 'Set .dme Path' privilege could potentially set malicious .dme files existing on the host machine to be compiled and executed. This technique is used for privilege escalation and code execution."}, {"techniqueID": "T1210", "comment": "A server configured to execute in BYOND's trusted security level could lead to this escalating into remote code execution via BYOND's shell() proc."}, {"techniqueID": "T1190", "comment": "This vulnerability requires multiple privileges with known weaknesses, making it a known side effect of having privileged TGS users."}], "stix_bundle": {"objects": [{"id": "vulnerability-cve-2024-41799", "type": "vulnerability", "description": "CVE-2024-41799: Prior to 6.8.0, low permission users using the 'Set .dme Path' privilege could potentially set malicious .dme files existing on the host machine to be compiled and executed."}, {"id": "technique-privilege-escalation", "type": "intrusion-set", "description": "Privilege escalation using 'Set .dme Path' privilege", "relationships": [{"id": "vulnerability-cve-2024-41799", "type": "associated-with", "role": "Vulnerability"}]}, {"id": "technique-code-execution", "type": "intrusion-set", "description": "Code execution using BYOND's shell() proc", "relationships": [{"id": "technique-privilege-escalation", "type": "uses", "role": "Privilege Escalation"}]}, {"id": "course-of-action- detect-vulnerability", "type": "alert", "description": "Detect vulnerabilities in tgstation-server configuration", "relationships": [{"id": "technique-code-execution", "type": "mitigates", "role": "Code Execution"}]}]}, "technical_analysis": {"Introduction": "CVE-2024-41799 is a vulnerability in tgstation-server, a production scale tool for BYOND server management, prior to version 6.8.0.", "Impact and Scope": "The vulnerability allows low permission users to set malicious .dme files to be compiled and executed, leading to remote code execution via BYOND's shell() proc.", "Related MITRE ATT&CK Techniques": "T1068, T1210, and T1190", "Technical Details": "The vulnerability occurs due to a flaw in the 'Set .dme Path' privilege, which allows users to set malicious .dme files to be executed.", "Detection": "Detection of this vulnerability involves monitoring for unusual file access and execution patterns.", "Mitigation": "Mitigation strategies include updating tgstation-server to version 6.8.0 or above, and implementing strict access controls for .dme files.", "Conclusion": "CVE-2024-41799 is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-41799 is a critical vulnerability in tgstation-server, a production scale tool for BYOND server management, prior to version 6.8.0.", "Business Impact": "The vulnerability poses a significant risk to the business, as it could allow unauthorized access to sensitive data and systems.", "Technical Impact": "The vulnerability allows low permission users to set malicious .dme files to be compiled and executed, leading to remote code execution via BYOND's shell() proc.", "Mitigation Strategies": "Update tgstation-server to version 6.8.0 or above, and implement strict access controls for .dme files.", "Recommendations": "Implement a vulnerability management program to identify and remediate vulnerabilities, and provide regular security training to employees.", "Conclusions": "CVE-2024-41799 is a critical vulnerability that requires immediate attention and mitigation. Implementing the recommended mitigation strategies and best practices will help to minimize the risk posed by this vulnerability."}}