{"id": "CVE-2024-22403", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-18T20:15:08.610", "lastModified": "2024-05-01T05:15:49.080", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Nextcloud server is a self hosted personal cloud system. In affected versions OAuth codes did not expire. When an attacker would get access to an authorization code they could authenticate at any time using the code. As of version 28.0.0 OAuth codes are invalidated after 10 minutes and will no longer be authenticated. To exploit this vulnerability an attacker would need to intercept an OAuth code from a user session. It is recommended that the Nextcloud Server is upgraded to 28.0.0. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "El servidor Nextcloud es un sistema de nube personal autohospedado. En las versiones afectadas, los c\u00f3digos OAuth no caducaban. Cuando un atacante tuviera acceso a un c\u00f3digo de autorizaci\u00f3n, podr\u00eda autenticarse en cualquier momento utilizando el c\u00f3digo. A partir de la versi\u00f3n 28.0.0, los c\u00f3digos OAuth se invalidan despu\u00e9s de 10 minutos y ya no se autenticar\u00e1n. Para aprovechar esta vulnerabilidad, un atacante necesitar\u00eda interceptar un c\u00f3digo OAuth de una sesi\u00f3n de usuario. Se recomienda actualizar el servidor Nextcloud a 28.0.0. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.7, "baseSeverity": "LOW"}, "exploitabilityScore": 2.2, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 3.0, "baseSeverity": "LOW"}, "exploitabilityScore": 1.3, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-613"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:*:*:*:*", "versionEndExcluding": "28.0.0", "matchCriteriaId": "40C7FB8D-EB7F-45B8-9F7F-8E5B1AE3ABEA"}]}]}], "references": [{"url": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-wppc-f5g8-vx36", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/nextcloud/server/pull/40766", "source": "security-advisories@github.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://hackerone.com/reports/1784162", "source": "security-advisories@github.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/S6PN4GVJ5TZUC6WSG4X3ZA3AMPBEKNAX/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-22403 - Lack of Expiration Date on OAuth Codes - An attacker could use stolen OAuth codes to authenticate at any time. Defend against by implementing rate limiting and IP blocking on authentication requests."}, {"techniqueID": "T1505", "comment": "CVE-2024-22403 - OAuth Code Interception - An attacker could intercept an OAuth code from a user session. Defend against by implementing secure communication protocols and end-to-end encryption."}, {"techniqueID": "T1190", "comment": "CVE-2024-22403 - Authentication Bypass - An attacker could use stolen OAuth codes to bypass authentication. Defend against by implementing multi-factor authentication and requiring additional login credentials."}], "stix_bundle": {"type": "bundle", "objects": [{"id": "https://example.com/cve/2024-22403", "type": "vulnerability", "description": "OAuth code expiration date not set in Nextcloud server", "severity": "LOW", "cvssV3": {"vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N", "baseScore": 3.7}, "affects": [{"id": "https://example.com/endpoint/nextcloud-server", "type": "endpoint", "description": "Nextcloud Server"}], "mitigations": [{"id": "https://example.com/technique/t1210", "type": "mitigation", "description": "Implement rate limiting and IP blocking on authentication requests"}, {"id": "https://example.com/technique/t1505", "type": "mitigation", "description": "Implement secure communication protocols and end-to-end encryption"}], "relationships": [{"id": "https://example.com/relationship/related-technique", "type": "relation", "description": "Related to T1210 and T1505", "target": [{"id": "https://example.com/technique/t1210", "type": "technique"}, {"id": "https://example.com/technique/t1505", "type": "technique"}]}]}, {"id": "https://example.com/technique/t1210", "type": "technique", "description": "Rate Limiting and IP Blocking on Authentication Requests", "tactics": ["Defense Evasion"]}, {"id": "https://example.com/technique/t1505", "type": "technique", "description": "Secure Communication Protocols and End-to-End Encryption", "tactics": ["Defend Against Credential Abuse"]}]}, "technical_analysis": {"Introduction": "The vulnerability CVE-2024-22403 affects the Nextcloud server due to the lack of expiration date on OAuth codes.", "Impact and Scope": "The vulnerability allows an attacker to use stolen OAuth codes to authenticate at any time, with a CVSS score of 3.7.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1210, T1505, and T1190.", "Technical Details": "The vulnerability occurs due to the lack of expiration date on OAuth codes, allowing attackers to use stolen codes to authenticate.", "Detection": "Detection methods include monitoring authentication requests and implementing rate limiting and IP blocking.", "Mitigation": "Mitigation strategies include implementing rate limiting and IP blocking on authentication requests, secure communication protocols, and end-to-end encryption.", "Conclusion": "The vulnerability can be mitigated by implementing recommended techniques and strategies."}, "executive_analysis": {"Overview": "The vulnerability CVE-2024-22403 affects the Nextcloud server due to the lack of expiration date on OAuth codes.", "Business Impact": "The vulnerability allows attackers to use stolen OAuth codes to authenticate, potentially resulting in unauthorized access to sensitive data.", "Technical Impact": "The vulnerability affects the security of the Nextcloud server and its users.", "Mitigation Strategies": "Mitigation strategies include implementing rate limiting and IP blocking on authentication requests, secure communication protocols, and end-to-end encryption.", "Recommendations": "Executives should prioritize implementing recommended mitigation strategies to minimize risk.", "Conclusions": "The vulnerability is a significant risk to the security of the Nextcloud server and its users."}}