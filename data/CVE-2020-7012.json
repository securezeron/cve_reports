{"id": "CVE-2020-7012", "sourceIdentifier": "bressers@elastic.co", "published": "2020-06-03T18:15:22.857", "lastModified": "2020-08-14T17:28:30.630", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Kibana versions 6.7.0 to 6.8.8 and 7.0.0 to 7.6.2 contain a prototype pollution flaw in the Upgrade Assistant. An authenticated attacker with privileges to write to the Kibana index could insert data that would cause Kibana to execute arbitrary code. This could possibly lead to an attacker executing code with the permissions of the Kibana process on the host system."}, {"lang": "es", "value": "Kibana versiones 6.7.0 hasta 6.8.8 y 7.0.0 hasta 7.6.2, contienen un fallo contaminaci\u00f3n de prototipo en el Upgrade Assistant. Un atacante autenticado con privilegios para escribir en el \u00edndice de Kibana podr\u00eda insertar datos que har\u00edan que Kibana ejecutara c\u00f3digo arbitrario. Esto podr\u00eda conllevar posiblemente a que un atacante ejecute c\u00f3digo con los permisos del proceso de Kibana en el sistema host."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}, {"source": "bressers@elastic.co", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:elastic:kibana:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7.0", "versionEndIncluding": "6.8.8", "matchCriteriaId": "430EE754-4FF0-41C4-BE1D-3BEB042E98FA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:elastic:kibana:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.0.0", "versionEndIncluding": "7.6.2", "matchCriteriaId": "6A924300-1A1E-4244-B734-3BFAB553A9F5"}]}]}], "references": [{"url": "https://www.elastic.co/community/security/", "source": "bressers@elastic.co", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "The vulnerability can be exploited by an authenticated attacker with privileges to write to the Kibana index through a prototype pollution flaw. This allows the attacker to execute arbitrary code with the permissions of the Kibana process on the host system."}, {"techniqueID": "TA0002", "comment": "The vulnerability allows for the execution of arbitrary code and potentially elevation of privileges, which is a common goal of attackers in the TA0002 tactic."}, {"techniqueID": "TA0040", "comment": "The vulnerability relies on the authentication of the attacker, which is a common criterion in the TA0040 tactic."}, {"techniqueID": "TA0041", "comment": "The vulnerability can be exploited through a network-based attack, which is a common attack vector in the TA0041 tactic."}], "stix_bundle": {"bundle": {"id": "f7f2e12a-aa10-4448-8f65-f8c6a6b12345", "type": "bundle", "version": "2.1", "objects": [{"type": "indicator", "id": "indicator-1", "name": "Kibana Prototype Pollution Indicator", "description": "An indicator for the Kibana prototype pollution vulnerability", "pattern": "Kibana Prototype Pollution Indicator", "modified": "2020-06-03T18:15:22.857"}, {"type": "attack-pattern", "id": "attack-pattern-1", "name": "Kibana Prototype Pollution Attack Pattern", "description": "An attack pattern for the Kibana prototype pollution vulnerability", "data-tier-requirements": [{"type": "required-tools", "name": "Kibana", "version": "6.7.0 TO 6.8.8 and 7.0.0 TO 7.6.2"}], "modified": "2020-06-03T18:15:22.857"}, {"type": "course-of-action", "id": "course-of-action-1", "name": "Kibana Prototype Pollution Defense", "description": "A course of action for defending against the Kibana prototype pollution vulnerability", "relevant-data": [{"type": "indicator", "id": "indicator-1"}], "related-objects": [{"type": "attack-pattern", "id": "attack-pattern-1"}], "modified": "2020-06-03T18:15:22.857"}], "relationships": [{"type": "uses", "source-ref": "bundle", "target-ref": "indicator-1"}, {"type": "uses", "source-ref": "bundle", "target-ref": "attack-pattern-1"}, {"type": "uses", "source-ref": "bundle", "target-ref": "course-of-action-1"}]}}, "technical_analysis": {"Introduction": "The Kibana prototype pollution vulnerability, identified as CVE-2020-7012, is a critical vulnerability that allows an authenticated attacker with privileges to write to the Kibana index to execute arbitrary code with the permissions of the Kibana process on the host system.", "Impact and Scope": "This vulnerability has a CVSS score of 8.8 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H) and affects Kibana versions 6.7.0 to 6.8.8 and 7.0.0 to 7.6.2.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the TA0001, TA0002, TA0040, and TA0041 MITRE ATT&CK techniques.", "Technical Details": "The vulnerability is caused by a prototype pollution flaw in the Upgrade Assistant and allows an attacker to execute arbitrary code with the permissions of the Kibana process on the host system.", "Detection": "Methods for detecting the vulnerability include monitoring for suspicious code execution and network traffic analysis.", "Mitigation": "Mitigation strategies for the vulnerability include updating to a patched version of Kibana, disabling the Upgrade Assistant, and implementing additional security controls such as access controls and logging.", "Conclusion": "The Kibana prototype pollution vulnerability is a critical vulnerability that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The Kibana prototype pollution vulnerability is a critical vulnerability that affects Kibana versions 6.7.0 to 6.8.8 and 7.0.0 to 7.6.2.", "Business Impact": "The vulnerability has the potential to allow an attacker to execute arbitrary code with the permissions of the Kibana process on the host system, which could result in significant business disruption and loss of sensitive data.", "Technical Impact": "The vulnerability is caused by a prototype pollution flaw in the Upgrade Assistant and allows an attacker to execute arbitrary code with the permissions of the Kibana process on the host system.", "Mitigation Strategies": "Mitigation strategies for the vulnerability include updating to a patched version of Kibana, disabling the Upgrade Assistant, and implementing additional security controls such as access controls and logging.", "Recommendations": "It is recommended that organizations using Kibana update to a patched version as soon as possible and implement additional security controls to mitigate the risk of exploitation.", "Conclusions": "The Kibana prototype pollution vulnerability is a critical vulnerability that requires immediate attention and remediation."}}