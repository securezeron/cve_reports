{"id": "CVE-2024-31458", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-14T15:25:25.307", "lastModified": "2024-06-10T17:16:26.193", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Cacti provides an operational monitoring and fault management framework. Prior to version 1.2.27, some of the data stored in `form_save()` function in `graph_template_inputs.php` is not thoroughly checked and is used to concatenate the SQL statement in `draw_nontemplated_fields_graph_item()` function from `lib/html_form_templates.php` , finally resulting in SQL injection. Version 1.2.27 contains a patch for the issue."}, {"lang": "es", "value": "Cacti proporciona un framework de monitoreo operativo y gesti\u00f3n de fallas. Antes de la versi\u00f3n 1.2.27, algunos de los datos almacenados en la funci\u00f3n `form_save()` en `graph_template_inputs.php` no se verifican exhaustivamente y se usan para concatenar la instrucci\u00f3n SQL en la funci\u00f3n `draw_nontemplate_fields_graph_item()` de `lib/html_form_templates. php`, lo que finalmente resulta en una inyecci\u00f3n SQL. La versi\u00f3n 1.2.27 contiene un parche para el problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.6, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 2.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-89"}]}], "references": [{"url": "https://github.com/Cacti/cacti/security/advisories/GHSA-jrxg-8wh8-943x", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-31458 - This is a SQL Injection vulnerability in Cacti, where an attacker can inject malicious SQL queries to obtain sensitive information. Defend against this by validating user input and limiting database privileges."}, {"techniqueID": "T1190", "comment": "CVE-2024-31458 - This vulnerability can be exploited by an attacker to inject malicious SQL queries and extract sensitive data. Defend against this by implementing proper input validation and sanitization."}, {"techniqueID": "T1027", "comment": "CVE-2024-31458 - This vulnerability can be used to inject malicious SQL queries, allowing an attacker to gain unauthorized access to the database and extract sensitive data. Defend against this by implementing proper access controls and limiting database privileges."}], "stix_bundle": {"stixBundle": {"type": "bundle", "id": "bundle--a48f3f51-3456-421f-881e-12c56f37c89d", "created_by_ref": "identification--id-1", "modified": "2024-06-10T17:16:26.193", "objects": [{"type": "vulnerability", "id": "vulnerability--id-1", "created_by_ref": "identification--id-1", "modified": "2024-06-10T17:16:26.193", "name": "CVE-2024-31458: Cacti SQL Injection Vulnerability", "description": "A SQL injection vulnerability in Cacti.", " severity": "Medium", "cvssV3": {"baseScore": 4.6, "baseSeverity": "MEDIUM", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "LOW"}, "refs": [{"type": "relationship", "id": "relationship--id-1", "from": {"idRef": "vulnerability--id-1"}, "to": {"idRef": "technique--id-1", "type": "technique"}, "relationship_type": "implies"}]}, {"type": "technique", "id": "technique--id-1", "created_by_ref": "identification--id-1", "modified": "2024-06-10T17:16:26.193", "name": "T1059: Command and Control-Codex", "description": "An attacker can command and control remote systems.", "related_op": [{"type": "relationship", "id": "relationship--id-2", "from": {"idRef": "technique--id-1"}, "to": {"idRef": "vulnerability--id-1", "type": "vulnerability"}, "relationship_type": "exploits"}]}]}}, "technical_analysis": {"Introduction": "CVE-2024-31458 is a SQL injection vulnerability in Cacti, which allows an attacker to inject malicious SQL queries and extract sensitive information.", "Impact and Scope": "This vulnerability has a CVSS score of 4.6 and an attack vector of NETWORK. It can be exploited by an attacker to inject malicious SQL queries and extract sensitive data.", "Related MITRE ATT&CK Techniques": "T1059, T1190, and T1027 are related to this vulnerability.", "Technical Details": "The vulnerability is due to improper input validation and sanitization, allowing an attacker to inject malicious SQL queries.", "Detection": "Detection methods include monitoring database logs for suspicious activity and implementing additional logging and auditing rules.", "Mitigation": "Mitigation strategies include validating user input, limiting database privileges, and implementing proper access controls.", "Conclusion": "CVE-2024-31458 is a medium-severity vulnerability that can be exploited by an attacker to inject malicious SQL queries and extract sensitive data."}, "executive_analysis": {"Overview": "CVE-2024-31458 is a SQL injection vulnerability in Cacti, which can be exploited by an attacker to gain unauthorized access to the database and extract sensitive data.", "Business Impact": "This vulnerability can result in data breaches, financial loss, and reputational damage.", "Technical Impact": "The vulnerability can be exploited by an attacker to gain unauthorized access to the database and extract sensitive data.", "Mitigation Strategies": "Implement proper input validation and sanitization, validate user input, and limit database privileges.", "Recommendations": "Patch the affected version of Cacti, implement additional logging and auditing rules, and monitor database logs for suspicious activity.", "Conclusions": "CVE-2024-31458 is a medium-severity vulnerability that requires immediate attention to prevent data breaches and financial loss."}}