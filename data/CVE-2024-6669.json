{"id": "CVE-2024-6669", "sourceIdentifier": "security@wordfence.com", "published": "2024-07-17T07:15:03.873", "lastModified": "2024-07-19T15:56:47.190", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The AI ChatBot for WordPress \u2013 WPBot plugin for WordPress is vulnerable to Stored Cross-Site Scripting via admin settings in all versions up to, and including, 5.5.7 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with administrator-level permissions and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page. This only affects multi-site installations and installations where unfiltered_html has been disabled."}, {"lang": "es", "value": "El complemento AI ChatBot para WordPress \u2013 WPBot para WordPress es vulnerable a Cross-Site Scripting Almacenado a trav\u00e9s de la configuraci\u00f3n de administrador en todas las versiones hasta la 5.5.7 incluida debido a una sanitizaci\u00f3n de entrada y un escape de salida insuficientes. Esto hace posible que atacantes autenticados, con permisos de nivel de administrador y superiores, inyecten scripts web arbitrarios en p\u00e1ginas que se ejecutar\u00e1n cada vez que un usuario acceda a una p\u00e1gina inyectada. Esto solo afecta a las instalaciones multisitio y a las instalaciones en las que se ha deshabilitado unfiltered_html."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}, {"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:quantumcloud:ai_chatbot:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "5.5.8", "matchCriteriaId": "991EF6A7-AD8D-4148-9BBE-3D5EEBC82E4A"}]}]}], "references": [{"url": "https://plugins.trac.wordpress.org/browser/chatbot/trunk/admin_ui.php#L2211", "source": "security@wordfence.com", "tags": ["Product"]}, {"url": "https://plugins.trac.wordpress.org/browser/chatbot/trunk/admin_ui.php#L755", "source": "security@wordfence.com", "tags": ["Product"]}, {"url": "https://plugins.trac.wordpress.org/changeset/3119022/", "source": "security@wordfence.com", "tags": ["Patch"]}, {"url": "https://wordpress.org/plugins/chatbot/#developers", "source": "security@wordfence.com", "tags": ["Release Notes"]}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/ce23efed-fe21-486a-ab3b-9ed0dd26a971?source=cve", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-6669 - This stored XSS vulnerability can be exploited by attackers to inject malicious scripts making it possible for authenticated attackers with administrator-level permissions to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page."}, {"techniqueID": "T1068", "comment": "CVE-2024-6669 - Insufficient input sanitization and output escaping in the AI ChatBot for WordPress plugin allows attackers to inject malicious scripts, which can be executed by administrators with access to the affected pages."}, {"techniqueID": "T1199", "comment": "CVE-2024-6669 - This vulnerability allows unauthenticated attacks to inject malicious scripts and further demonstrating the lack of sufficient input validation and sanitization."}], "stix_bundle": "{\"_bundle\":{\"_type\":\"stix_common_component\",\"description\":\"Vulnerability Analysis of CVE-2024-6669\",\"title\":\"CVE-2024-6669-Stored-Cross-Site-Scripting\",\"spec_version\":\"2.1\",\"objects\":[{\"_type\":\"vulnerability\",\"id\":{\"_type\":\"stix_vulnerability_id\",\"value\":\"CVE-2024-6669\"},\"name\":{\"_type\":\"stix_vulnerability_name\",\"value\":\"AI ChatBot for WordPress Stored Cross-Site Scripting\"},\"description\":{\"_type\":\"stix_vulnerability_description\",\"value\":\"The AI ChatBot for WordPress \u2013 WPBot plugin for WordPress is vulnerable to Stored Cross-Site Scripting via admin settings in all versions up to, and including, 5.5.7 due to insufficient input sanitization and output escaping.\"},\"severity\":{\"_type\":\"stix_common_value\",\"value\":\"medium\"},\"published\":{\"_type\":\"stix_common_datetime\",\"value\":\"2024-07-17T07:15:03.873\"},\"modified\":{\"_type\":\"stix_common_datetime\",\"value\":\"2024-07-19T15:56:47.190\"},\"references\":{\"_type\":\"stix_common_array\",\"value\":[{\"_type\":\"stix_common_reference\",\"url\":\"https://plugins.trac.wordpress.org/browser/chatbot/trunk/admin_ui.php#L2211\",\"source\":\"security@wordfence.com\",\"tags\":[\"Product\"]},{\"_type\":\"stix_common_reference\",\"url\":\"https://plugins.trac.wordpress.org/browser/chatbot/trunk/admin_ui.php#L755\",\"source\":\"security@wordfence.com\",\"tags\":[\"Product\"]},{\"_type\":\"stix_common_reference\",\"url\":\"https://plugins.trac.wordpress.org/changeset/3119022/\",\"source\":\"security@wordfence.com\",\"tags\":[\"Patch\"]},{\"_type\":\"stix_common_reference\",\"url\":\"https://wordpress.org/plugins/chatbot/#developers\",\"source\":\"security@wordfence.com\",\"tags\":[\"Release Notes\"]},{\"_type\":\"stix_common_reference\",\"url\":\"https://www.wordfence.com/threat-intel/vulnerabilities/id/ce23efed-fe21-486a-ab3b-9ed0dd26a971?source=cve\",\"source\":\"security@wordfence.com\",\"tags\":[\"Third Party Advisory\"]}],\"weaknesses\":{\"_type\":\"stix_common_array\",\"value\":[{\"_type\":\"stix_common_weakness\",\"description\":{\"_type\":\"stix_common_text\",\"value\":\"CWE-79\"}}]},\"configurations\":{\"_type\":\"stix_common_array\",\"value\":[{\"_type\":\"stix_common_configuration\",\"id\":{\"_type\":\"stix_common_id\",\"value\":\"991EF6A7-AD8D-4148-9BBE-3D5EEBC82E4A\"}}]},\"mitre_techniques\":{\"_type\":\"stix_common_array\",\"value\":[{\"_type\":\"stix_common_mitre_technique\",\"technique_id\":{\"_type\":\"stix_common_id\",\"value\":\"T1190\"}},{\"_type\":\"stix_common_mitre_technique\",\"technique_id\":{\"_type\":\"stix_common_id\",\"value\":\"T1068\"}},{\"_type\":\"stix_common_mitre_technique\",\"technique_id\":{\"_type\":\"stix_common_id\",\"value\":\"T1199\"}}]}},{\"_type\":\"relationship\",\"id\":{\"_type\":\"stix_common_id\",\"value\":\"d41d8cd9-9d39-4c9d-9b4c-0f5da5b6ed33\"},\"source\":{\"_type\":\"stix_common_object\",\"id\":{\"_type\":\"stix_vulnerability_id\",\"value\":\"CVE-2024-6669\"}},\"target\":{\"_type\":\"stix_common_object\",\"type\":{\"_type\":\"stix_common_type\",\"value\":\"vulnerability\"}},\"relationship_type\":{\"_type\":\"stix_common_type\",\"value\":\" Mitigates\"},{\"_type\":\"relationship\",\"id\":{\"_type\":\"stix_common_id\",\"value\":\"d41d8cd9-9d39-4c9d-9b4c-0f5da5b6ed33\"},\"source\":{\"_type\":\"stix_common_object\",\"id\":{\"_type\":\"stix_mitre_technique_id\",\"value\":\"T1190\"}},\"target\":{\"_type\":\"stix_common_object\",\"type\":{\"_type\":\"stix_common_type\",\"value\":\"technique\"}},\"relationship_type\":{\"_type\":\"stix_common_type\",\"value\":\"Uses\"},{\"_type\":\"relationship\",\"id\":{\"_type\":\"stix_common_id\",\"value\":\"d41d8cd9-9d39-4c9d-9b4c-0f5da5b6ed33\"},\"source\":{\"_type\":\"stix_common_object\",\"id\":{\"_type\":\"stix_mitre_technique_id\",\"value\":\"T1068\"}},\"target\":{\"_type\":\"stix_common_object\",\"type\":{\"_type\":\"stix_common_type\",\"value\":\"technique\"}},\"relationship_type\":{\"_type\":\"stix_common_type\",\"value\":\"Uses\"},{\"_type\":\"relationship\",\"id\":{\"_type\":\"stix_common_id\",\"value\":\"d41d8cd9-9d39-4c9d-9b4c-0f5da5b6ed33\"},\"source\":{\"_type\":\"stix_common_object\",\"id\":{\"_type\":\"stix_mitre_technique_id\",\"value\":\"T1199\"}},\"target\":{\"_type\":\"stix_common_object\",\"type\":{\"_type\":\"stix_common_type\",\"value\":\"technique\"}},\"relationship_type\":{\"_type\":\"stix_common_type\",\"value\":\"Uses\"}]}}", "technical_analysis": {"Introduction": "The AI ChatBot for WordPress plugin is vulnerable to stored cross-site scripting due to insufficient input sanitization and output escaping. This vulnerability allows attackers to inject malicious scripts, which can be executed by administrators with access to the affected pages.", "Impact and Scope": "The vulnerability affects all versions of the AI ChatBot for WordPress plugin up to and including 5.5.7. It has a CVSS score of 4.8 (medium) with a base attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE techniques T1190, T1068, and T1199, which are all related to web-based attacks", "Technical Details": "The vulnerability occurs due to insufficient input sanitization and output escaping in the plugin. This allows attackers to inject arbitrary web scripts, which can be executed by administrators with access to the affected pages.", "Detection": "Detection of this vulnerability is possible via tools that inspect the plugin's code for the injection of malicious scripts", "Mitigation": "Mitigation strategies include updating the plugin to a version greater than 5.5.7, and configuring the server to block malicious scripts", "Conclusion": "In conclusion, the AI ChatBot for WordPress plugin is vulnerable to stored cross-site scripting due to insufficient input sanitization and output escaping. This vulnerability can be exploited by attackers to inject malicious scripts, which can be executed by administrators with access to the affected pages."}, "executive_analysis": {"Overview": "The AI ChatBot for WordPress plugin is a popular plugin used by many WordPress sites. This vulnerability can potentially impact the security and integrity of these sites.", "Business Impact": "The vulnerability can potentially lead to the theft of sensitive information or the disruption of business operations.", "Technical Impact": "The vulnerability can potentially allow attackers to inject malicious scripts, which can be executed by administrators with access to the affected pages.", "Mitigation Strategies": "Updating the plugin to a version greater than 5.5.7, configuring the server to block malicious scripts, and monitoring the site for suspicious activity are all recommended mitigation strategies.", "Recommendations": "We strongly recommend that all WordPress sites using the AI ChatBot for WordPress plugin update to a version greater than 5.5.7, and that all administrators monitor their sites for suspicious activity.", "Conclusions": "In conclusion, the AI ChatBot for WordPress plugin is vulnerable to stored cross-site scripting due to insufficient input sanitization and output escaping. We strongly recommend that all WordPress sites using the plugin update to a version greater than 5.5.7, and that all administrators monitor their sites for suspicious activity."}}