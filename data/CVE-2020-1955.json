{"id": "CVE-2020-1955", "sourceIdentifier": "security@apache.org", "published": "2020-05-20T14:15:11.550", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "CouchDB version 3.0.0 shipped with a new configuration setting that governs access control to the entire database server called `require_valid_user_except_for_up`. It was meant as an extension to the long standing setting `require_valid_user`, which in turn requires that any and all requests to CouchDB will have to be made with valid credentials, effectively forbidding any anonymous requests. The new `require_valid_user_except_for_up` is an off-by-default setting that was meant to allow requiring valid credentials for all endpoints except for the `/_up` endpoint. However, the implementation of this made an error that lead to not enforcing credentials on any endpoint, when enabled. CouchDB versions 3.0.1[1] and 3.1.0[2] fix this issue."}, {"lang": "es", "value": "CouchDB versi\u00f3n 3.0.0, es enviada con una nueva configuraci\u00f3n que rige el control de acceso a todo el servidor de base de datos llamada \"require_valid_user_except_for_up\". Se supon\u00eda que una extensi\u00f3n del antiguo ajuste \"require_valid_user\", que a su vez requiere que todas y cada una de las peticiones hacia CouchDB tengan que hacerse con credenciales v\u00e1lidas, prohibiendo efectivamente cualquier petici\u00f3n an\u00f3nima. El nuevo \"require_valid_user_except_for_up\" es un ajuste desactivado por defecto que se supone que permite requerir credenciales v\u00e1lidas para todos los endpoints excepto para el endpoint \"/_up\". Sin embargo, la implementaci\u00f3n de \u00e9ste cometi\u00f3 un error que conllev\u00f3 a no aplicar las credenciales sobre ning\u00fan endpoint, cuando estaba habilitado. CouchDB versiones 3.0.1[1] y 3.1.0[2]  corrige este problema."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-306"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:couchdb:3.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "6CF039B4-F4AB-4A07-9BE5-5FA7C73A23B4"}]}]}], "references": [{"url": "https://docs.couchdb.org/en/master/cve/2020-1955.html", "source": "security@apache.org", "tags": ["Mitigation", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1204.001", "comment": "CVE-2020-1955 - This technique highlights the importance of ensuring proper authentication and authorization controls are in place to prevent unauthorized access to sensitive data."}, {"techniqueID": "T1190", "comment": "CVE-2020-1955 - This technique showcases the exploitation of misconfigured database access controls, emphasizing the need for regular configuration audits and updates."}, {"techniqueID": "T1165", "comment": "CVE-2020-1955 - This technique illustrates the significance of testing and verifying the proper functioning of newly implemented security controls, such as the 'require_valid_user_except_for_up' setting."}], "technical_analysis": {"Introduction": "Apache CouchDB 3.0.0 ships with a compromised 'require_valid_user_except_for_up' setting, allowing unauthorized access to the database server. This CVE highlights the importance of implementing and testing security controls to prevent exploitation.", "Impact and Scope": "The vulnerability affects CouchDB versions 3.0.0 and earlier, with a CVSS score of 9.8, 6.8 in version 2.0 respectively, and an attack vector of 'Network'. This means an attacker can exploit the vulnerability to gain unauthorized access to sensitive data.", "Related MITRE ATT&CK Techniques": "T1204.001, T1190, and T1165 are related to this CVE, as they all involve the exploitation of misconfigured database access controls.", "Technical Details": "The 'require_valid_user_except_for_up' setting allows bypassing the 'require_valid_user' setting, which requires valid credentials for all requests. This configuration allows unauthorized access to the database server.", "Detection": "Detection can be achieved by monitoring database logs for suspicious authentication attempts and monitoring the 'require_valid_user_except_for_up' setting for any changes.", "Mitigation": "Update to CouchDB version 3.0.1 or 3.1.0, which address this vulnerability. Additionally, ensure proper configuration and testing of the 'require_valid_user_except_for_up' setting.", "Conclusion": "This CVE highlights the importance of implementing and testing security controls to prevent exploitation. Regular vulnerability scanning and patching are crucial to ensure the security of the database server."}, "executive_analysis": {"Overview": "Apache CouchDB 3.0.0 has a critical vulnerability that allows unauthorized access to the database server, compromising sensitive data.", "Business Impact": "This vulnerability puts business data at risk of unauthorized access, potentially resulting in financial losses and reputational damage.", "Technical Impact": "The vulnerability affects the security posture of the organization, making it vulnerable to attacks and exploitation.", "Mitigation Strategies": "Implement timely patches, conduct regular vulnerability scanning, and ensure proper configuration and testing of security controls.", "Recommendations": "Develop a comprehensive security strategy, include regular vulnerability scanning and patching, and ensure proper training for security personnel.", "Conclusions": "This CVE emphasizes the importance of prioritizing security, and organizations must take immediate action to address this vulnerability and prevent future incidents."}}