{"id": "CVE-2020-8564", "sourceIdentifier": "jordan@liggitt.net", "published": "2020-12-07T22:15:21.307", "lastModified": "2021-03-29T19:30:55.300", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Kubernetes clusters using a logging level of at least 4, processing a malformed docker config file will result in the contents of the docker config file being leaked, which can include pull secrets or other registry credentials. This affects < v1.19.3, < v1.18.10, < v1.17.13."}, {"lang": "es", "value": "En los cl\u00fasteres de Kubernetes que usan un nivel de registro de al menos 4, el procesamiento de un archivo de configuraci\u00f3n de docker malformado dar\u00e1 como resultado la filtraci\u00f3n del contenido del archivo de configuraci\u00f3n de docker, que puede incluir secretos de extracci\u00f3n u otras credenciales de registro. Esto afecta versiones anteriores a v1.19.3, versiones anteriores a v1.18.10, versiones anteriores a v1.17.13"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}, {"source": "jordan@liggitt.net", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 2.1}, "baseSeverity": "LOW", "exploitabilityScore": 3.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-532"}]}, {"source": "jordan@liggitt.net", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-532"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.17.0", "versionEndExcluding": "1.17.13", "matchCriteriaId": "B765012B-C658-4EB8-956A-62A91142CE05"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.18.0", "versionEndExcluding": "1.18.10", "matchCriteriaId": "67F84BBA-5FCA-4A23-BB4E-47BE92E3706A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.19.0", "versionEndExcluding": "1.19.3", "matchCriteriaId": "456BD01B-44E8-4823-B220-5E109D8C377D"}]}]}], "references": [{"url": "https://github.com/kubernetes/kubernetes/issues/95622", "source": "jordan@liggitt.net", "tags": ["Third Party Advisory"]}, {"url": "https://groups.google.com/g/kubernetes-security-discuss/c/vm-HcrFUOCs/m/36utxAM5CwAJ", "source": "jordan@liggitt.net", "tags": ["Mailing List", "Patch", "Third Party Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20210122-0006/", "source": "jordan@liggitt.net", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2020-8564 - The vulnerability allows an attacker to leak docker config files, potentially revealing sensitive information such as pull secrets or registry credentials."}, {"techniqueID": "T1190", "comment": "CVE-2020-8564 - The vulnerability enables an attacker to access sensitive information, including registry credentials, which can be used to conduct further attacks."}], "stix_bundle": {"objects": [{"id": "https://example.com/vulnerability/CVE-2020-8564", "type": "vulnerability", "name": "CVE-2020-8564 - Kubernetes Docker Config File Leak", "description": "A vulnerability in Kubernetes allows an attacker to leak docker config files, potentially revealing sensitive information such as pull secrets or registry credentials.", "severity": "MEDIUM", "cvss": {"base_score": 5.5, "attack_vector": "LOCAL", "attack_complexity": "LOW", "privileges_required": "LOW", "user_interaction": "NONE", "confidentiality_impact": "HIGH", "integrity_impact": "NONE", "availability_impact": "NONE"}, "references": [{"id": "https://github.com/kubernetes/kubernetes/issues/95622", "type": "reference", "name": "CVE-2020-8564 - Kubernetes Docker Config File Leak", "description": "The official Kubernetes GitHub issue for this vulnerability."}], "relates_to": [{"id": "https://example.com/attack-pattern/T1027", "type": "relates_to", "name": "T1027: Remote File Inclusion", "description": "The attacker can include a remote file to reveal sensitive information."}, {"id": "https://example.com/attack-pattern/T1190", "type": "relates_to", "name": "T1190: Exploitation of Remediation Background/ Context", "description": "The attacker can use the leaked configuration files to conduct further attacks."}]}, {"id": "https://example.com/attack-pattern/T1027", "type": "attack-pattern", "name": "T1027: Remote File Inclusion", "description": "The attacker includes a remote file to reveal sensitive information."}, {"id": "https://example.com/attack-pattern/T1190", "type": "attack-pattern", "name": "T1190: Exploitation of Remediation Background/ Context", "description": "The attacker uses the leaked configuration files to conduct further attacks."}]}, "technical_analysis": {"Introduction": "The CVE-2020-8564 vulnerability in Kubernetes allows an attacker to leak docker config files, potentially revealing sensitive information such as pull secrets or registry credentials.", "Impact and Scope": "The vulnerability has a CVSS score of 5.5, with a high confidentiality impact and a low attack complexity.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to T1027: Remote File Inclusion and T1190: Exploitation of Remediation Background/ Context.", "Technical Details": "The vulnerability occurs when a Kubernetes cluster is configured to log at a level of at least 4, allowing an attacker to access sensitive information.", "Detection": "Detection of this vulnerability can be achieved by monitoring Kubernetes cluster logs for unauthorized access to docker config files.", "Mitigation": "Mitigation strategies include patching the vulnerability, configuring the Kubernetes cluster to log at a level of less than 4, and monitoring cluster logs for unauthorized access.", "Conclusion": "This vulnerability poses a significant risk to Kubernetes clusters and requires immediate attention to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2020-8564 vulnerability in Kubernetes allows an attacker to leak docker config files, potentially revealing sensitive information.", "Business Impact": "This vulnerability could result in the theft of sensitive information, leading to financial losses and damage to reputation.", "Technical Impact": "The vulnerability could enable unauthorized access to sensitive information, allowing attackers to conduct further attacks.", "Mitigation Strategies": "Patch the vulnerability, configure the Kubernetes cluster to log at a level of less than 4, and monitor cluster logs for unauthorized access.", "Recommendations": "Executives should prioritize patching and configuring the Kubernetes cluster to minimize the risk of exploitation.", "Conclusions": "This vulnerability requires immediate attention to prevent exploitation and minimize the risk of compromising sensitive information."}}