{"id": "CVE-2024-31997", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-10T22:15:07.527", "lastModified": "2024-04-11T12:47:44.137", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "XWiki Platform is a generic wiki platform. Prior to versions 4.10.19, 15.5.4, and 15.10-rc-1, parameters of UI extensions are always interpreted as Velocity code and executed with programming rights. Any user with edit right on any document like the user's own profile can create UI extensions. This allows remote code execution and thereby impacts the confidentiality, integrity and availability of the whole XWiki installation. This vulnerability has been patched in XWiki 14.10.19, 15.5.4 and 15.9-RC1. No known workarounds are available."}, {"lang": "es", "value": "XWiki Platform es una plataforma wiki gen\u00e9rica. Antes de las versiones 4.10.19, 15.5.4 y 15.10-rc-1, los par\u00e1metros de las extensiones de UI siempre se interpretan como c\u00f3digo Velocity y se ejecutan con derechos de programaci\u00f3n. Cualquier usuario con derecho de edici\u00f3n en cualquier documento, como el propio perfil del usuario, puede crear extensiones de interfaz de usuario. Esto permite la ejecuci\u00f3n remota de c\u00f3digo y, por lo tanto, afecta la confidencialidad, integridad y disponibilidad de toda la instalaci\u00f3n de XWiki. Esta vulnerabilidad ha sido parcheada en XWiki 14.10.19, 15.5.4 y 15.9-RC1. No hay workarounds disponibles."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.9, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.1, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-862"}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/171e7c7d0e56deaa7b3678657ae26ef95379b1ea", "source": "security-advisories@github.com"}, {"url": "https://github.com/xwiki/xwiki-platform/commit/1b2574eb966457ca4ef34e557376b8751d1be90d", "source": "security-advisories@github.com"}, {"url": "https://github.com/xwiki/xwiki-platform/commit/56748e154a9011f0d6239bec0823eaaeab6ec3f7", "source": "security-advisories@github.com"}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-c2gg-4gq4-jv5j", "source": "security-advisories@github.com"}, {"url": "https://jira.xwiki.org/browse/XWIKI-21335", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-31997 - An adversary can utilize this vulnerability to execute remote code on the XWiki platform, which is a generic wiki platform. This is relevant to the CVE since it provides a means for an attacker to compromise the confidentiality, integrity, and availability of the XWiki installation."}, {"techniqueID": "T1211", "comment": "CVE-2024-31997 - The remote code execution vulnerability in XWiki platform can be used to execute arbitrary code on the system, which is a key action in the adversary's attack campaign. Defenders should be aware of this technique to detect and prevent it."}, {"techniqueID": "T1484", "comment": "CVE-2024-31997 - The adversary can create UI extensions to remotely execute code on the XWiki platform, which is a technique that defenders should be aware of to prevent the adversary from executing malicious code."}, {"techniqueID": "T1190", "comment": "CVE-2024-31997 - The remote code execution vulnerability in XWiki platform can be used to execute arbitrary code on the system, which is a key action in the adversary's attack campaign. Defenders should be aware of this technique to detect and prevent it."}], "stix_bundle": {"type": "bundle", "id": "bundle--cve-2024-31997", "spec_version": "2.1", "extensions": [], "objects": [{"type": "vulnerability", "id": "vulnerability--cve-2024-31997", "created_by_ref": " organisation--xwiki-security-team", "modified": "2024-04-11T12:47:44.137", "name": "XWiki Platform Remote Code Execution Vulnerability", "description": "XWiki Platform is a generic wiki platform. Prior to versions 4.10.19, 15.5.4, and 15.10-rc-1, parameters of UI extensions are always interpreted as Velocity code and executed with programming rights.", "severity": "CRITICAL", "scores": {"cvss": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "baseSeverity": "CRITICAL", "baseScore": 9.9}}}, {"type": "indicator", "id": "indicator--xwiki-ui-extension", "created_by_ref": "organisation--xwiki-security-team", "modified": "2024-04-11T12:47:44.137", "name": "XWiki UI Extension", "description": "A UI extension in XWiki platform that does not properly validate user input", "pattern": "regex--xwiki-ui-extension"}, {"type": "courses-of-action", "id": "courses-of-action--cve-2024-31997", "created_by_ref": "organisation--xwiki-security-team", "modified": "2024-04-11T12:47:44.137", "name": "MITRE ATT&CK Techniques to Mitigate", "description": "MITRE ATT&CK techniques that can be used to mitigate the XWiki platform remote code execution vulnerability", "courses_of_action_refs": ["technique--T1059", "technique--T1211", "technique--T1484", "technique--T1190"]}], " relationships": [{"type": "vulnerability-relates-to", "id": "vulnerability-relates-to--cve-2024-31997-indicator", "vulnerability_ref": "vulnerability--cve-2024-31997", "indicator_ref": "indicator--xwiki-ui-extension"}, {"type": "vulnerability-has-course-of-action", "id": "vulnerability-has-course-of-action--cve-2024-31997-coa", "vulnerability_ref": "vulnerability--cve-2024-31997", "courses_of_action_ref": "courses-of-action--cve-2024-31997"}]}, "technical_analysis": {"Introduction": "The XWiki platform is a generic wiki platform that allows users to create and manage content. Prior to versions 4.10.19, 15.5.4, and 15.10-rc-1, the platform had a remote code execution vulnerability that allowed an adversary to execute arbitrary code on the system.", "Impact and Scope": "The vulnerability has a CVSS score of 9.9 and an attack complexity of LOW, making it a high-severity vulnerability. The attack vector is NETWORK, and the privileges required are LOW.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques such as T1059, T1211, T1484, and T1190, which involve executing remote code on the system.", "Technical Details": "The vulnerability occurs because the platform does not properly validate user input, which allows an adversary to create UI extensions that can be used to execute arbitrary code on the system.", "Detection": "Defenders can detect the vulnerability by monitoring for suspicious UI extension creation and monitoring for unusual system behavior.", "Mitigation": "The vulnerability can be mitigated by updating to a patched version of the XWiki platform, as well as by monitoring for suspicious activity and shutting down any suspicious UI extensions.", "Conclusion": "The XWiki platform remote code execution vulnerability is a high-severity vulnerability that can be mitigated by updating to a patched version of the platform and by monitoring for suspicious activity."}, "executive_analysis": {"Overview": "The XWiki platform remote code execution vulnerability is a high-severity vulnerability that can be used by an adversary to execute arbitrary code on the system.", "Business Impact": "The vulnerability can have a significant business impact, as it can allow an adversary to compromise the confidentiality, integrity, and availability of the XWiki installation.", "Technical Impact": "The vulnerability has a technical impact, as it allows an adversary to execute arbitrary code on the system, which can be used to compromise the confidentiality, integrity, and availability of the XWiki installation.", "Mitigation Strategies": "The vulnerability can be mitigated by updating to a patched version of the XWiki platform, as well as by monitoring for suspicious activity and shutting down any suspicious UI extensions.", "Recommendations": "Executives should recommend that the organization's security team update to a patched version of the XWiki platform and monitor for suspicious activity.", "Conclusions": "The XWiki platform remote code execution vulnerability is a high-severity vulnerability that can be mitigated by updating to a patched version of the platform and by monitoring for suspicious activity. Executives should recommend that the organization's security team take immediate action to mitigate the vulnerability."}}