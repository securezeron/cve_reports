{"id": "CVE-2024-28253", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-15T20:15:09.807", "lastModified": "2024-03-17T22:38:29.433", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "OpenMetadata is a unified platform for discovery, observability, and governance powered by a central metadata repository, in-depth lineage, and seamless team collaboration. `CompiledRule::validateExpression` is also called from `PolicyRepository.prepare`. `prepare()` is called from `EntityRepository.prepareInternal()` which, in turn, gets called from `EntityResource.createOrUpdate()`. Note that even though there is an authorization check (`authorizer.authorize()`), it gets called after `prepareInternal()` gets called and therefore after the SpEL expression has been evaluated. In order to reach this method, an attacker can send a PUT request to `/api/v1/policies` which gets handled by `PolicyResource.createOrUpdate()`. This vulnerability was discovered with the help of CodeQL's Expression language injection (Spring) query and is also tracked as `GHSL-2023-252`. This issue may lead to Remote Code Execution and has been addressed in version 1.3.1. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "OpenMetadata es una plataforma unificada para el descubrimiento, la observabilidad y la gobernanza impulsada por un repositorio central de metadatos, un linaje profundo y una colaboraci\u00f3n fluida en equipo. `CompiledRule::validateExpression` tambi\u00e9n se llama desde `PolicyRepository.prepare`. `prepare()` se llama desde `EntityRepository.prepareInternal()` que, a su vez, se llama desde `EntityResource.createOrUpdate()`. Tenga en cuenta que aunque hay una verificaci\u00f3n de autorizaci\u00f3n (`authorizer.authorize()`), se llama despu\u00e9s de que se llama a `prepareInternal()` y, por lo tanto, despu\u00e9s de que se haya evaluado la expresi\u00f3n SpEL. Para llegar a este m\u00e9todo, un atacante puede enviar una solicitud PUT a `/api/v1/policies` que es manejada por `PolicyResource.createOrUpdate()`. Esta vulnerabilidad se descubri\u00f3 con la ayuda de la consulta de inyecci\u00f3n de lenguaje de expresi\u00f3n (Spring) de CodeQL y tambi\u00e9n se rastrea como \"GHSL-2023-252\". Este problema puede provocar la ejecuci\u00f3n remota de c\u00f3digo y se solucion\u00f3 en la versi\u00f3n 1.3.1. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 9.4, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://codeql.github.com/codeql-query-help/java/java-spel-expression-injection", "source": "security-advisories@github.com"}, {"url": "https://github.com/open-metadata/OpenMetadata/blob/b6b337e09a05101506a5faba4b45d370cc3c9fc8/openmetadata-service/src/main/java/org/openmetadata/service/jdbi3/EntityRepository.java#L693", "source": "security-advisories@github.com"}, {"url": "https://github.com/open-metadata/OpenMetadata/blob/b6b337e09a05101506a5faba4b45d370cc3c9fc8/openmetadata-service/src/main/java/org/openmetadata/service/resources/EntityResource.java#L219", "source": "security-advisories@github.com"}, {"url": "https://github.com/open-metadata/OpenMetadata/blob/b6b337e09a05101506a5faba4b45d370cc3c9fc8/openmetadata-service/src/main/java/org/openmetadata/service/resources/policies/PolicyResource.java#L365", "source": "security-advisories@github.com"}, {"url": "https://github.com/open-metadata/OpenMetadata/blob/main/openmetadata-service/src/main/java/org/openmetadata/service/jdbi3/PolicyRepository.java#L113", "source": "security-advisories@github.com"}, {"url": "https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-7vf4-x5m2-r6gr", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0008", "comment": "Attempt Capture One: An attacker may attempt to capture a screenshot of the user's system to obtain sensitive information, such as passwords or credit card numbers. This vulnerability can be exploited to capture the user's system and exploit it further."}, {"techniqueID": "T1190", "comment": "Expansive File System Permissions: An attacker may attempt to exploit this vulnerability to gain expansive file system permissions on the affected system, allowing them to read, write, or execute files outside of their normal scope."}, {"techniqueID": "T1027", "comment": "Remote Service Sessions: An attacker may attempt to exploit this vulnerability to establish a remote service session, allowing them to interact with the affected system over a network."}, {"techniqueID": "T1405", "comment": "Data Staging: An attacker may attempt to exploit this vulnerability to stage sensitive data on the affected system, allowing them to access it later."}, {"techniqueID": "T1190", "comment": "Enclave Execution: An attacker may attempt to exploit this vulnerability to execute code within an enclave, allowing them to hide their tracks and evade detection."}], "stix_bundle": {"@context": "https://cybox.mitre.org/XMLSchema/2.1", "type": "bundle", "id": "CVE-2024-28253-Bundle", "name": "CVE-2024-28253 Bundle", "created_by": "Automatic Analysis", "created": "2023-03-15T09:00:00.000", "modified": "2023-03-15T09:00:00.000", "objects": {"vulnerability": {"name": "OpenMetadata OpenMetadata Service", "description": "OpenMetadata Service is a unified platform for discovery, observability, and governance powered by a central metadata repository, in-depth lineage, and seamless team collaboration.", "id": "CVE-2024-28253", "type": "vulnerability"}, "threat_actor": {"name": "Attackers", "description": "Attackers that exploit this vulnerability."}, "capability": {"name": "Exploitation Capabilities", "description": "Capabilities related to the exploitation of this vulnerability."}, "course_of_action": {"name": "Mitigation Strategy", "description": "A mitigation strategy to address this vulnerability."}}, "relationships": {"vulnerability-relations": {"vulnerability": "CVE-2024-28253", "relates_to": "threat_actor"}, "course_of_action-relations": {"course_of_action": "Mitigation Strategy", "relates_to": "vulnerability"}, "capability-relations": {"capability": "Exploitation Capabilities", "relates_to": "vulnerability"}}}, "technical_analysis": {"Introduction": "OpenMetadata Service is a unified platform for discovery, observability, and governance powered by a central metadata repository, in-depth lineage, and seamless team collaboration.", "Impact and Scope": "The exploitation of this vulnerability can lead to Remote Code Execution and has been addressed in version 1.3.1.", "Related MITRE ATT&CK Techniques": "TA0008, T1190, T1027, T1405", "Technical Details": "Exploitation is possible by sending a PUT request to `/api/v1/policies` which gets handled by `PolicyResource.createOrUpdate()`", "Detection": "Exploitation can be detected by monitoring for unusual network traffic and system calls.", "Mitigation": "Upgrade to version 1.3.1", "Conclusion": "Summary and conclusions."}, "executive_analysis": {"Overview": "OpenMetadata Service is a unified platform for discovery, observability, and governance powered by a central metadata repository, in-depth lineage, and seamless team collaboration.", "Business Impact": "The exploitation of this vulnerability can lead to significant business disruptions and data breaches.", "Technical Impact": "The exploitation of this vulnerability can lead to Remote Code Execution and has been addressed in version 1.3.1.", "Mitigation Strategies": "Upgrade to version 1.3.1", "Recommendations": "Recommendations for executives.", "Conclusions": "Final conclusions and next steps."}}