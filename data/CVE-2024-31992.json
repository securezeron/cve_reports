{"id": "CVE-2024-31992", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-19T21:15:08.337", "lastModified": "2024-04-22T13:28:50.310", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Mealie is a self hosted recipe manager and meal planner. Prior to 1.4.0, the safe_scrape_html function utilizes a user-controlled URL to issue a request to a remote server, however these requests are not rate-limited. While there are efforts to prevent DDoS by implementing a timeout on requests, it is possible for an attacker to issue a large number of requests to the server which will be handled in batches based on the configuration of the Mealie server. The chunking of responses is helpful for mitigating memory exhaustion on the Mealie server, however a single request to an arbitrarily large external file (e.g. a Debian ISO) is often sufficient to completely saturate a CPU core assigned to the Mealie container. Without rate limiting in place, it is possible to not only sustain traffic against an external target indefinitely, but also to exhaust the CPU resources assigned to the Mealie container. This vulnerability is fixed in 1.4.0."}, {"lang": "es", "value": "Mealie es un administrador de recetas y planificador de comidas aut\u00f3nomo. Antes de 1.4.0, la funci\u00f3n safe_scrape_html utiliza una URL controlada por el usuario para emitir una solicitud a un servidor remoto; sin embargo, estas solicitudes no tienen una velocidad limitada. Si bien se est\u00e1n realizando esfuerzos para evitar DDoS implementando un tiempo de espera en las solicitudes, es posible que un atacante emita una gran cantidad de solicitudes al servidor que se manejar\u00e1n en lotes seg\u00fan la configuraci\u00f3n del servidor Mealie. La fragmentaci\u00f3n de las respuestas es \u00fatil para mitigar el agotamiento de la memoria en el servidor Mealie; sin embargo, una sola solicitud a un archivo externo arbitrariamente grande (por ejemplo, una ISO de Debian) suele ser suficiente para saturar completamente un n\u00facleo de CPU asignado al contenedor Mealie. Sin una limitaci\u00f3n de velocidad, es posible no solo mantener el tr\u00e1fico contra un objetivo externo indefinidamente, sino tambi\u00e9n agotar los recursos de CPU asignados al contenedor Mealie. Esta vulnerabilidad se solucion\u00f3 en 1.4.0."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-400"}]}], "references": [{"url": "https://github.com/mealie-recipes/mealie/blob/mealie-next/mealie/services/scraper/scraper_strategies.py#L27-L70", "source": "security-advisories@github.com"}, {"url": "https://github.com/mealie-recipes/mealie/commit/2a3463b7466bc297aede50046da9550d919ec56f", "source": "security-advisories@github.com"}, {"url": "https://github.com/mealie-recipes/mealie/pull/3368", "source": "security-advisories@github.com"}, {"url": "https://securitylab.github.com/advisories/GHSL-2023-225_GHSL-2023-226_Mealie/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1171", "comment": "Unvalidated Redirects and Forwards: CVE-2024-31992 - An attacker can leverage unvalidated redirects and forwards to inject malicious scripts, bypass security controls, and gain unauthorized access. This technique is relevant to Mealie's safe_scrape_html function"}, {"techniqueID": "T1190", "comment": "Exploitation of Remote Services: CVE-2024-31992 - An attacker can exploit remote services without authentication, such as the unsanitized user-controlled URL in Mealie's safe_scrape_html function. This technique is relevant to the vulnerability's ability to issue a large number of requests to the server"}, {"techniqueID": "T1405", "comment": "Data Encoding: CVE-2024-31992 - An attacker can use data encoding techniques to bypass security controls and inject malicious scripts, such as the unsanitized user-controlled URL in Mealie's safe_scrape_html function"}], "stix_bundle": {"bundle": {"id": "https://example.com/cve-2024-31992", "type": "Bundle", "spec_version": "2.1", "stix_version": "2.1", "objects": [{"id": "https://example.com/vulnerability/cve-2024-31992", "type": "Vulnerability", "name": "CVE-2024-31992: Unvalidated Redirects and Forwards", "description": "A vulnerability in Mealie's safe_scrape_html function allows an attacker to issue a large number of requests to the server without rate limiting", "related_events": [{"id": "https://example.com/event/T1171", "type": "Event", "name": "Unvalidated Redirects and Forwards"}, {"id": "https://example.com/event/T1190", "type": "Event", "name": "Exploitation of Remote Services"}, {"id": "https://example.com/event/T1405", "type": "Event", "name": "Data Encoding"}]}, {"id": "https://example.com/technique/T1171", "type": "T Technique", "name": "Unvalidated Redirects and Forwards", "description": "An attacker can leverage unvalidated redirects and forwards to inject malicious scripts, bypass security controls, and gain unauthorized access"}, {"id": "https://example.com/technique/T1190", "type": "Technique", "name": "Exploitation of Remote Services", "description": "An attacker can exploit remote services without authentication"}, {"id": "https://example.com/technique/T1405", "type": "Technique", "name": "Data Encoding", "description": "An attacker can use data encoding techniques to bypass security controls and inject malicious scripts"}, {"id": "https://example.com/course-of-action/CODEC601", "type": "Course-of-Action", "name": "Implement rate limiting for remote requests", "description": "Implement rate limiting for remote requests to prevent denial-of-service attacks"}, {"id": "https://example.com/course-of-action/CODEC602", "type": "Course-of-Action", "name": "Validate user input", "description": "Validate user input to prevent data encoding attacks"}]}}, "technical_analysis": {"Introduction": "This is a vulnerability analysis report for CVE-2024-31992.", "Impact and Scope": "This vulnerability has a CVSS score of 6.5 (MEDIUM) and allows an attacker to issue a large number of requests to the server without rate limiting.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK Techniques T1171, T1190, and T1405.", "Technical Details": "The vulnerability is located in Mealie's safe_scrape_html function, which uses a user-controlled URL to issue a request to a remote server.", "Detection": "Detection methods include monitoring for unusual network traffic patterns and unusual CPU usage.", "Mitigation": "Mitigation strategies include implementing rate limiting for remote requests, validating user input, and monitoring for unusual network traffic patterns and CPU usage.", "Conclusion": "This vulnerability has significant implications for the security of the Mealie application and requires immediate attention."}, "executive_analysis": {"Overview": "This vulnerability is a serious security issue that threatens the integrity of the Mealie application.", "Business Impact": "The vulnerability has the potential to cause significant financial loss and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to issue a large number of requests to the server without rate limiting, which could lead to a denial-of-service attack.", "Mitigation Strategies": "Mitigation strategies include implementing rate limiting for remote requests and validating user input.", "Recommendations": "Recommendations include implementing rate limiting for remote requests, validating user input, and monitoring for unusual network traffic patterns and CPU usage.", "Conclusions": "The vulnerability is a serious security issue that requires immediate attention to prevent potential exploitation."}}