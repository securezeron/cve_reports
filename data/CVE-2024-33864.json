{"id": "CVE-2024-33864", "sourceIdentifier": "cve@mitre.org", "published": "2024-05-14T16:17:22.280", "lastModified": "2024-07-03T01:59:02.930", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered in linqi before 1.4.0.1 on Windows. There is SSRF via Document template generation; i.e., via remote images in process creation, file inclusion, and PDF document generation via malicious JavaScript."}, {"lang": "es", "value": "Se descubri\u00f3 un problema en linqi anterior a 1.4.0.1 en Windows. Hay SSRF mediante la generaci\u00f3n de plantillas de documentos; es decir, a trav\u00e9s de im\u00e1genes remotas en procesos de creaci\u00f3n, inclusi\u00f3n de archivos y generaci\u00f3n de documentos PDF a trav\u00e9s de JavaScript malicioso."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.5, "impactScore": 3.4}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-918"}]}], "references": [{"url": "https://linqi.help/Updates/en#/SecurityUpdates", "source": "cve@mitre.org"}, {"url": "https://www.linqi.de/de-DE/blog.html", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0002", "comment": " CVE-2024-33864 - This vulnerability is related to Server Side Request Forgery (SSRF) and is relevant to the MITRE ATT&CK technique named 'Initial Access - Execution' as it allows an attacker to create a malicious JavaScript file which can be used to access remote resources, used in Reconnaissance, or used to upload a web shell to the server. Defending against SSRF vulnerabilities includes validating user input, validating requests, and configuring web servers to reject unauthorized requests."}, {"techniqueID": "TA0021", "comment": " CVE-2024-33864 - This vulnerability is also related to the MITRE ATT&CK technique named 'Command and Control - Data Encapsulation' as it allows an attacker to upload files and execute arbitrary code on the server, used in Command and Control, Data Encapsulation. Defending against this vulnerability involves limiting file uploads, validating file extensions, and validating user input."}], "stix_bundle": {"@stix2-extensions": "https://stix2.io/extensions/2/attack-pattern", "timestamp": "2022-08-16T14:30:00.000Z", "objects": [{"id": "bundle--CVE-2024-33864", "type": "bundle", "spec_version": "2.1", "versions": "1.0", "objects": [{"id": "indicator--i-1", "type": "indicator", "name": "Linqi SSRF Vulnerability", "description": "An issue was discovered in linqi before 1.4.0.1 on Windows. There is SSRF via Document template generation; i.e., via remote images in process creation, file inclusion, and PDF document generation via malicious JavaScript.", "protocol": "http", "references": [{"source_name": "CVE-2024-33864", "external_id": "CVE-2024-33864", "source_name_ref": "cve@mitre.org"}]}, {"id": "attack-pattern--ap-1", "type": "attack-pattern", "name": "Server Side Request Forgery (SSRF) Attack", "description": "An attack that exploits a vulnerability in a server's request handling capabilities to access remote resources.", "external_references": [{"source_name": "MITRE ATT&CK", "external_id": "TA0002", "source_name_ref": "mitre-attack"}]}, {"id": "course-of-action--coa-1", "type": "course-of-action", "name": "Validate User Input", "description": "Validate user input to prevent malicious JavaScript files from being uploaded and executed.", "related_threats": [{"id": "indicator--i-1", "type": "indicator", "role": "vulnerability"}]}, {"id": "course-of-action--coa-2", "type": "course-of-action", "name": "Configure Web Servers to Reject Unauthorized Requests", "description": "Configure web servers to reject unauthorized requests and prevent SSRF attacks.", "related_threats": [{"id": "indicator--i-1", "type": "indicator", "role": "vulnerability"}]}]}]}, "technical_analysis": {"Introduction": "The Linqi SSRF vulnerability is a security issue that allows an attacker to create a malicious JavaScript file which can be used to access remote resources, used in Reconnaissance, or used to upload a web shell to the server. The vulnerability is exploitable when a user uploads a malicious file to the server, or when a user click on a malicious link.", "Impact and Scope": "The impact of this vulnerability is LOW, as it can only be exploited if a user uploads a malicious file to the server or clicks on a malicious link. The scope of this vulnerability is limited to the server and the users interacting with it.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK technique is 'Initial Access - Execution' and 'Command and Control - Data Encapsulation'.", "Technical Details": "The vulnerability occurs because the server does not properly validate user input, allowing an attacker to upload malicious files and execute arbitrary code on the server.", "Detection": "Detection involves monitoring system logs for suspicious requests, monitoring file uploads and downloads, and monitoring user activity.", "Mitigation": "The mitigation strategy involves validating user input, configuring web servers to reject unauthorized requests, and limiting file uploads.", "Conclusion": "In conclusion, the Linqi SSRF vulnerability is a security issue that can be mitigated by following best practices for validating user input and configuring web servers to reject unauthorized requests."}, "executive_analysis": {"Overview": "The Linqi SSRF vulnerability is a security issue that can allow an attacker to create a malicious JavaScript file which can be used to access remote resources, used in Reconnaissance, or used to upload a web shell to the server. This vulnerability is considered LOW in impact and is limited in scope to the server and the users interacting with it.", "Business Impact": "The business impact of this vulnerability is minimal, as it is only exploitable if a user uploads a malicious file to the server or clicks on a malicious link.", "Technical Impact": "The technical impact of this vulnerability is limited to the server and the users interacting with it.", "Mitigation Strategies": "The recommended mitigation strategy is to validate user input, configure web servers to reject unauthorized requests, and limit file uploads.", "Recommendations": "Executives should ensure that their organizations are following best practices for validating user input and configuring web servers to reject unauthorized requests.", "Conclusions": "In conclusion, the Linqi SSRF vulnerability is a security issue that can be mitigated by following best practices for validating user input and configuring web servers to reject unauthorized requests."}}