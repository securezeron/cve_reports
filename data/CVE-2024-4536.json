{"id": "CVE-2024-4536", "sourceIdentifier": "emo@eclipse.org", "published": "2024-05-07T13:15:48.513", "lastModified": "2024-05-07T13:39:32.710", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Eclipse Dataspace Components from version 0.2.1 to 0.6.2, in the EDC Connector component ( https://github.com/eclipse-edc/Connector ), an attacker might obtain OAuth2 client secrets from the vault.\n\nIn Eclipse Dataspace Components from version 0.2.1 to 0.6.2, we have identified a security vulnerability in the EDC Connector component ( https://github.com/eclipse-edc/Connector ) regarding the OAuth2-protected data sink feature. When using a custom, OAuth2-protected data sink, the OAuth2-specific data address properties are resolved by the provider data plane. Problematically, the consumer-provided clientSecretKey, which indicates the OAuth2 client secret to retrieve from a secrets vault, is resolved in the context of the provider's vault, not the consumer. This secret's value is then sent to the tokenUrl, also consumer-controlled, as part of an OAuth2 client credentials grant. The returned access token is then sent as a bearer token to the data sink URL.\n\nThis feature is now disabled entirely, because not all code paths necessary for a successful realization were fully implemented.\n\n"}, {"lang": "es", "value": "En los componentes de Eclipse Dataspace de la versi\u00f3n 0.2.1 a 0.6.2, en el componente EDC Connector (https://github.com/eclipse-edc/Connector), un atacante podr\u00eda obtener secretos del cliente OAuth2 de la b\u00f3veda. En los componentes de Eclipse Dataspace de la versi\u00f3n 0.2.1 a 0.6.2, hemos identificado una vulnerabilidad de seguridad en el componente EDC Connector (https://github.com/eclipse-edc/Connector) con respecto a la funci\u00f3n de receptor de datos protegido por OAuth2. Cuando se utiliza un receptor de datos personalizado protegido por OAuth2, el plano de datos del proveedor resuelve las propiedades de direcci\u00f3n de datos espec\u00edficas de OAuth2. Lo problem\u00e1tico es que la clientSecretKey proporcionada por el consumidor, que indica el secreto del cliente OAuth2 para recuperar de una b\u00f3veda de secretos, se resuelve en el contexto de la b\u00f3veda del proveedor, no en el del consumidor. Luego, el valor de este secreto se env\u00eda a tokenUrl, tambi\u00e9n controlado por el consumidor, como parte de una concesi\u00f3n de credenciales de cliente OAuth2. El token de acceso devuelto se env\u00eda luego como token de portador a la URL del receptor de datos. Esta caracter\u00edstica ahora est\u00e1 completamente deshabilitada porque no se implementaron completamente todas las rutas de c\u00f3digo necesarias para una realizaci\u00f3n exitosa."}], "metrics": {"cvssMetricV31": [{"source": "emo@eclipse.org", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:C/C:H/I:L/A:L", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 5.3}]}, "weaknesses": [{"source": "emo@eclipse.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-201"}, {"lang": "en", "value": "CWE-522"}]}], "references": [{"url": "https://github.com/eclipse-edc/Connector/commit/a4e6018d2c0457fba6f672fafa6c590513c45d1b", "source": "emo@eclipse.org"}, {"url": "https://github.com/eclipse-edc/Connector/releases/tag/v0.6.3", "source": "emo@eclipse.org"}, {"url": "https://gitlab.eclipse.org/security/cve-assignement/-/issues/22", "source": "emo@eclipse.org"}, {"url": "https://gitlab.eclipse.org/security/vulnerability-reports/-/issues/198", "source": "emo@eclipse.org"}], "techniques": [{"techniqueID": "T1040", "comment": "CVE-2024-4536 - This vulnerability allows an attacker with adjacent network access to obtain OAuth2 client secrets, which can then be used to gain unauthorized access to data. This is a high-severity issue and requires immediate attention to ensure data security."}, {"techniqueID": "T1003", "comment": "CVE-2024-4536 - The weakness in the OAuth2-protected data sink feature allows an attacker to manipulate the clientSecretKey, which could lead to unauthorized data access. This is a high-severity issue and requires immediate attention to ensure data security."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle--CVE-2024-4536", "created_by_ref": "organization--Eclipse.org", "created": "2024-05-07T13:15:48.513Z", "modified": "2024-05-07T13:39:32.710Z", "objects": [{"type": "incident", "id": "incident--CVE-2024-4536", "created_by_ref": "organization--Eclipse.org", "created": "2024-05-07T13:15:48.513Z", "modified": "2024-05-07T13:39:32.710Z", "name": "Eclipse Dataspace Components OAuth2 client secret vulnerability", "description": "A vulnerability in the Eclipse Dataspace Components EDC Connector component (https://github.com/eclipse-edc/Connector) allows an attacker to obtain OAuth2 client secrets, which can then be used to gain unauthorized access to data.", "first_seen": "2024-05-07T13:15:48.513Z", "last_seen": "2024-05-07T13:39:32.710Z", "objective": {"type": "indicator", "id": "indicator--CVE-2024-4536", "pattern": "https://github.com/eclipse-edc/Connector/commit/a4e6018d2c0457fba6f672fafa6c590513c45d1b"}}, {"type": "note", "id": "note--CVE-2024-4536", "created_by_ref": "organization--Eclipse.org", "created": "2024-05-07T13:15:48.513Z", "modified": "2024-05-07T13:39:32.710Z", "name": "OAuth2 client secret vulnerability mitigation", "description": "To mitigate this vulnerability, it is recommended to disable the OAuth2-protected data sink feature and use alternative authentication methods. Additionally, it is recommended to sanitize and validate any user input data to prevent potential attacks.", "contents": "https://github.com/eclipse-edc/Connector/commit/a4e6018d2c0457fba6f672fafa6c590513c45d1b"}]}}, "technical_analysis": {"Introduction": "The Eclipse Dataspace Components EDC Connector component (https://github.com/eclipse-edc/Connector) contains a vulnerability that allows an attacker to obtain OAuth2 client secrets, which can then be used to gain unauthorized access to data.", "Impact and Scope": "This vulnerability has a CVSS score of 6.8 and affects all versions of the EDC Connector component from 0.2.1 to 0.6.2. The attack vector is ADJACENT_NETWORK and the attack complexity is HIGH.", "Related MITRE ATT&CK Techniques": "T1040: Password Cracking and T1003: Credential Access.", "Technical Details": "The vulnerability is caused by a weakness in the OAuth2-protected data sink feature, which allows an attacker to manipulate the clientSecretKey. This is a high-severity issue and requires immediate attention to ensure data security.", "Detection": "Detections for this vulnerability include monitoring for suspicious login attempts and monitoring for unusual data access patterns.", "Mitigation": "To mitigate this vulnerability, it is recommended to disable the OAuth2-protected data sink feature and use alternative authentication methods. Additionally, it is recommended to sanitize and validate any user input data to prevent potential attacks.", "Conclusion": "This vulnerability is a high-severity issue and requires immediate attention to ensure data security. It is recommended to take immediate action to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The Eclipse Dataspace Components EDC Connector component (https://github.com/eclipse-edc/Connector) contains a vulnerability that allows an attacker to obtain OAuth2 client secrets, which can then be used to gain unauthorized access to data.", "Business Impact": "This vulnerability has the potential to cause significant business disruption and reputational damage if not addressed promptly.", "Technical Impact": "This vulnerability has a CVSS score of 6.8 and affects all versions of the EDC Connector component from 0.2.1 to 0.6.2. The attack vector is ADJACENT_NETWORK and the attack complexity is HIGH.", "Mitigation Strategies": "Disable the OAuth2-protected data sink feature and use alternative authentication methods. Sanitize and validate any user input data to prevent potential attacks.", "Recommendations": "Immediate action should be taken to mitigate this vulnerability. A thorough review of the system and its components should be conducted to identify any potential breaches.", "Conclusions": "This vulnerability is a high-severity issue and requires immediate attention to ensure data security. It is recommended to take immediate action to mitigate this vulnerability and ensure the integrity of the system."}}