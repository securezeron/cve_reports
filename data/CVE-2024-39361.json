{"id": "CVE-2024-39361", "sourceIdentifier": "responsibledisclosure@mattermost.com", "published": "2024-07-03T09:15:06.917", "lastModified": "2024-07-05T17:07:34.827", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Mattermost versions 9.8.0, 9.7.x <= 9.7.4, 9.6.x <= 9.6.2 and 9.5.x <= 9.5.5 fail to\u00a0prevent users from specifying a RemoteId for their posts which allows an attacker to specify both a remoteId and the post ID, resulting in creating a post with a user-defined post ID. This can cause some broken functionality in the channel or thread with user-defined posts"}, {"lang": "es", "value": "Las versiones de Mattermost 9.8.0, 9.7.x &lt;= 9.7.4, 9.6.x &lt;= 9.6.2 y 9.5.x &lt;= 9.5.5 no evitan que los usuarios especifiquen un RemoteId para sus publicaciones, lo que permite a un atacante especificar ambos. un ID remoto y el ID de la publicaci\u00f3n, lo que da como resultado la creaci\u00f3n de una publicaci\u00f3n con una ID de publicaci\u00f3n definida por el usuario. Esto puede causar alguna funcionalidad rota en el canal o hilo con publicaciones definidas por el usuario."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.5}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 3.1, "baseSeverity": "LOW"}, "exploitabilityScore": 1.6, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-284"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.5.0", "versionEndExcluding": "9.5.6", "matchCriteriaId": "D07BE1B5-9663-4112-9F58-A4BAD0BEC92F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.6.0", "versionEndExcluding": "9.6.3", "matchCriteriaId": "08894FF3-4671-4A09-BC9C-9C2664072DE5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.7.0", "versionEndExcluding": "9.7.4", "matchCriteriaId": "93806FF3-A98A-442B-AC2C-D5BB18D3D54F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.8.0", "versionEndExcluding": "9.8.1", "matchCriteriaId": "68C48441-A3DC-4812-9E7E-92B23E1B95BB"}]}]}], "references": [{"url": "https://mattermost.com/security-updates", "source": "responsibledisclosure@mattermost.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1036", "comment": "CVE-2024-39361 - This is a web shell injection vulnerability that can be exploited using remote code execution (RCE) techniques. Attackers can use this vulnerability to inject malicious code, leading to arbitrary code execution, data leakage, and other malicious activities. Defenses can be implemented by validating and sanitizing user inputs, implementing proper input validation and sanitization, and using a web application firewall to detect and prevent malicious traffic."}, {"techniqueID": "T1062", "comment": "CVE-2024-39361 - This is a web shell injection vulnerability that can be exploited using RCE techniques. The vulnerability can be exploited by uploading a malicious file to the web server, which can lead to arbitrary code execution, data leakage, and other malicious activities. Defenses can be implemented by validating and sanitizing user inputs, implementing proper input validation and sanitization, and using a web application firewall to detect and prevent malicious traffic."}], "stix_bundle": {"bundle": {"id": "bundle-1", "type": "bundle", "producer": "Vulnerability Analyst", "created": "2024-07-10T14:30:00Z", "modified": "2024-07-10T14:30:00Z", "objects": [{"type": "intrusion-set", "id": "intrad-1", "name": "Mattermost Web Shell Injection", "description": "Mattermost Web Shell Injection is an intrusion set that usesCVE-2024-39361 to inject and execute malicious code on web servers."}, {"type": "intrusion-set", "id": "intrad-2", "name": "RCE Attack", "description": "RCE Attack is an intrusion set that uses CVE-2024-39361 to inject and execute malicious code on web servers."}, {"type": "course-of-action", "id": "coa-1", "name": " Validate and Sanitize User Inputs", "description": "Validate and sanitize user inputs to prevent injection attacks.", "mitigates": "T1036", "notes": "Implement proper input validation and sanitization in the web server to prevent injection attacks."}, {"type": "course-of-action", "id": "coa-2", "name": "Implement a Web Application Firewall", "description": "Implement a web application firewall to detect and prevent malicious traffic.", "mitigates": "T1062", "notes": "Use a web application firewall to detect and prevent malicious traffic and block suspicious requests."}]}}, "technical_analysis": {"Introduction": "This vulnerability is a web shell injection vulnerability in Mattermost versions 9.8.0, 9.7.x <= 9.7.4, 9.6.x <= 9.6.2 and 9.5.x <= 9.5.5, which can be exploited to inject and execute malicious code on web servers.", "Impact and Scope": "The impact of this vulnerability is severe, as it can lead to arbitrary code execution, data leakage, and other malicious activities. The scope of this vulnerability is limited to web servers running Mattermost versions affected.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1036 and T1062, which involve web shell injection and RCE attacks.", "Technical Details": "The vulnerability is caused by a failure to prevent users from specifying a remoteId for their posts, which allows an attacker to inject and execute malicious code.", "Detection": "Detection of this vulnerability can be performed using security information and event management (SIEM) systems and web application firewalls.", "Mitigation": "Mitigation strategies include validating and sanitizing user inputs, implementing proper input validation and sanitization, and using a web application firewall to detect and prevent malicious traffic.", "Conclusion": "In conclusion, this vulnerability is a serious security issue that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "This vulnerability is a web shell injection vulnerability in Mattermost versions 9.8.0, 9.7.x <= 9.7.4, 9.6.x <= 9.6.2 and 9.5.x <= 9.5.5, which can be exploited to inject and execute malicious code on web servers.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to data breaches, financial losses, and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is severe, as it can lead to arbitrary code execution, data leakage, and other malicious activities.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include validating and sanitizing user inputs, implementing proper input validation and sanitization, and using a web application firewall to detect and prevent malicious traffic.", "Recommendations": "Recommendations for executives include implementing a strong security plan, conducting regular security audits, and investing in security training for employees.", "Conclusions": "In conclusion, this vulnerability is a serious security issue that requires immediate attention and mitigation."}}