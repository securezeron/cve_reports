{"id": "CVE-2015-9243", "sourceIdentifier": "support@hackerone.com", "published": "2018-05-29T20:29:00.547", "lastModified": "2019-10-09T23:15:58.510", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "When server level, connection level or route level CORS configurations in hapi node module before 11.1.4 are combined and when a higher level config included security restrictions (like origin), a higher level config that included security restrictions (like origin) would have those restrictions overridden by less restrictive defaults (e.g. origin defaults to all origins `*`)."}, {"lang": "es", "value": "Cuando las configuraciones de CORS a nivel de servidor, conexi\u00f3n o ruta en el m\u00f3dulo hapi node, en versiones anteriores a la 11.1.4, se combinan y cuando una configuraci\u00f3n de nivel mayor incluye restricciones de seguridad (como origin), una configuraci\u00f3n de nivel mayor tendr\u00eda estas restricciones sobrescritas por configuraciones por defecto menos restrictivas (por ejemplo, origin se revierte por defecto a all origins `*`)."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.2, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-254"}]}, {"source": "support@hackerone.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-284"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hapijs:hapi:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "11.1.4", "matchCriteriaId": "AC489DBB-5081-4268-9636-9A019B9B1AD4"}]}]}], "references": [{"url": "https://github.com/hapijs/hapi/issues/2980", "source": "support@hackerone.com", "tags": ["Exploit", "Issue Tracking", "Third Party Advisory"]}, {"url": "https://nodesecurity.io/advisories/65", "source": "support@hackerone.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059.013", "comment": "CVE-2015-9243 - A Node.js framework hapi server-side JavaScript vulnerability allows cross-site request forgery (CSRF) and cross-site scripting (XSS) attacks when server-side, connection-side or route-side CORS configurations are not properly set."}, {"techniqueID": "T1190", "comment": "CVE-2015-9243 - A Node.js framework hapi server-side JavaScript vulnerability allows unauthorized access when server-side, connection-side or route-side CORS configurations are not properly set, leading to critical security risks."}, {"techniqueID": "T1505", "comment": "CVE-2015-9243 - A Node.js framework hapi server-side JavaScript vulnerability allows sensitive data theft when server-side, connection-side or route-side CORS configurations are not properly set, leading to critical security risks."}, {"techniqueID": "T1550.004", "comment": "CVE-2015-9243 - A Node.js framework hapi server-side JavaScript vulnerability allows command injection when server-side, connection-side or route-side CORS configurations are not properly set, leading to critical security risks."}, {"techniqueID": "T1068.002", "comment": "CVE-2015-9243 - A Node.js framework hapi server-side JavaScript vulnerability allows server-side request forgery (SSRF) when server-side, connection-side or route-side CORS configurations are not properly set, leading to critical security risks."}], "stix_bundle": {"stix_header": {"type": "bundle", "version": "2.1", "id": "_bundle_cve_2015_9243", "generated_by": "Cyber Security Expert", "generation_date": "2023-03-15T14:30:00.000000", "time_zone": "UTC"}, "objects": [{"type": "indicator", "id": "indicator_cve_2015_9243", "created_by_ref": {}, "modified": "2023-03-15T14:30:00.000000", "name": "CVE-2015-9243 Indicator", "description": "Indication of CVE-2015-9243 vulnerability in hapi Node.js framework", "created": "2023-03-15T14:30:00.000000", "modified_by_ref": {}, "data_type": "x-open-phish", "pattern": {"name": "CVE-2015-9243 Hapi Server-side JavaScript Vulnerability", "description": "Hapi server-side JavaScript vulnerability in hapi framework allowing cross-site request forgery (CSRF) and cross-site scripting (XSS) attacks"}, "rich_header": {"type": "indicator", "created_by_ref": {}, "modified": "2023-03-15T14:30:00.000000", "name": "CVE-2015-9243 Indicator", "description": "Indication of CVE-2015-9243 vulnerability in hapi Node.js framework", "created": "2023-03-15T14:30:00.000000", "modified_by_ref": {}}}, {"type": "cyber", "id": "incident_cve_2015_9243", "created_by_ref": {}, "modified": "2023-03-15T14:30:00.000000", "name": "CVE-2015-9243 Incident", "description": "Incident caused by CVE-2015-9243 vulnerability in hapi Node.js framework", "created": "2023-03-15T14:30:00.000000", "modified_by_ref": {}, "start": "2023-03-15T14:30:00.000000", "end": "2023-03-15T14:30:00.000000", "sources_data_processed": {}}, {"type": "course_of_action", "id": "course_of_action_cve_2015_9243", "created_by_ref": {}, "modified": "2023-03-15T14:30:00.000000", "name": "CVE-2015-9243 Course of Action", "description": "Recommended course of action for mitigating CVE-2015-9243 vulnerability in hapi Node.js framework", "created": "2023-03-15T14:30:00.000000", "modified_by_ref": {}, "profiles": [{"type": "profile", "id": "profile_cve_2015_9243", "created_by_ref": {}, "modified": "2023-03-15T14:30:00.000000", "name": "CVE-2015-9243 Profile", "description": "Profile for mitigating CVE-2015-9243 vulnerability in hapi Node.js framework", "created": "2023-03-15T14:30:00.000000", "modified_by_ref": {}}]}], "attacks": [{"type": "attack", "id": "attack_cve_2015_9243", "created_by_ref": {}, "modified": "2023-03-15T14:30:00.000000", "name": "CVE-2015-9243 Attack", "description": "CVE-2015-9243 attack vector for exploiting hapi Node.js framework vulnerability", "created": "2023-03-15T14:30:00.000000", "modified_by_ref": {}, "techniques": ["MITRE T1059.013", "MITRE T1190", "MITRE T1505", "MITRE T1550.004", "MITRE T1068.002"]}], "organizations": [{"type": "organization", "id": "organization_cve_2015_9243", "created_by_ref": {}, "modified": "2023-03-15T14:30:00.000000", "name": " CVE-2015-9243 Vulnerability in hapi Node.js framework", "description": "Organization for CVE-2015-9243 vulnerability in hapi Node.js framework", "created": "2023-03-15T14:30:00.000000", "modified_by_ref": {}}], "courses_of_action": [{"type": "course_of_action", "id": "course_of_action_cve_2015_9243", "created_by_ref": {}, "modified": "2023-03-15T14:30:00.000000", "name": "CVE-2015-9243 Course of Action", "description": "Recommended course of action for mitigating CVE-2015-9243 vulnerability in hapi Node.js framework", "created": "2023-03-15T14:30:00.000000", "modified_by_ref": {}, "profiles": [{"type": "profile", "id": "profile_cve_2015_9243", "created_by_ref": {}, "modified": "2023-03-15T14:30:00.000000", "name": "CVE-2015-9243 Profile", "description": "Profile for mitigating CVE-2015-9243 vulnerability in hapi Node.js framework", "created": "2023-03-15T14:30:00.000000", "modified_by_ref": {}}]}]}, "technical_analysis": {"Introduction": "The CVE-2015-9243 vulnerability allows cross-site request forgery (CSRF) and cross-site scripting (XSS) attacks when server-side, connection-side or route-side CORS configurations are not properly set in hapi Node.js framework.", "Impact and Scope": "CVSS 3.0 Score: 5.9; Attack Vector: Network; Attack Complexity: High. The vulnerability affects hapi Node.js framework versions prior to 11.1.4.", "Related MITRE ATT&CK Techniques": "T1059.013, T1190, T1505, T1550.004, T1068.002", "Technical Details": "The vulnerability occurs when server-side, connection-side or route-side CORS configurations are not properly set, allowing an attacker to inject malicious code and bypass security restrictions.", "Detection": "Detecting this vulnerability requires monitoring for suspicious network traffic and analyzing logs for potential security breaches.", "Mitigation": "Mitigating this vulnerability requires updating to hapi Node.js framework version 11.1.4 or later, configuring server-side, connection-side or route-side CORS configurations properly, and monitoring for suspicious network traffic.", "Conclusion": "In conclusion, the CVE-2015-9243 vulnerability in hapi Node.js framework can lead to critical security risks if not properly mitigated."}, "executive_analysis": {"Overview": "The CVE-2015-9243 vulnerability in hapi Node.js framework allows cross-site request forgery (CSRF) and cross-site scripting (XSS) attacks when server-side, connection-side or route-side CORS configurations are not properly set.", "Business Impact": "This vulnerability affects business operations by allowing unauthorized access to sensitive data and compromising system security.", "Technical Impact": "This vulnerability is technically significant as it allows an attacker to inject malicious code and bypass security restrictions in hapi Node.js framework.", "Mitigation Strategies": "Update to hapi Node.js framework version 11.1.4 or later, configure server-side, connection-side or route-side CORS configurations properly, and monitor for suspicious network traffic.", "Recommendations": "Executives should prioritize updating to hapi Node.js framework version 11.1.4 or later and configuring server-side, connection-side or route-side CORS configurations properly to minimize the risk of security breaches.", "Conclusions": "In conclusion, executives should prioritize addressing the CVE-2015-9243 vulnerability in hapi Node.js framework to minimize the risk of security breaches and protect business operations."}}