{"id": "CVE-2024-1727", "sourceIdentifier": "security@huntr.dev", "published": "2024-03-21T20:15:07.620", "lastModified": "2024-04-16T12:15:09.843", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A Cross-Site Request Forgery (CSRF) vulnerability in gradio-app/gradio allows attackers to upload multiple large files to a victim's system if they are running Gradio locally. By crafting a malicious HTML page that triggers an unauthorized file upload to the victim's server, an attacker can deplete the system's disk space, potentially leading to a denial of service. This issue affects the file upload functionality as implemented in gradio/routes.py."}, {"lang": "es", "value": "Para evitar que sitios web maliciosos de terceros realicen solicitudes a aplicaciones de Gradio que se ejecutan localmente, este PR endurece las reglas CORS en torno a las aplicaciones de Gradio. En particular, verifica si el encabezado del host es localhost (o uno de sus alias) y, de ser as\u00ed, requiere que el encabezado de origen (si est\u00e1 presente) tambi\u00e9n sea localhost (o uno de sus alias)."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "references": [{"url": "https://github.com/gradio-app/gradio/commit/84802ee6a4806c25287344dce581f9548a99834a", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/a94d55fb-0770-4cbe-9b20-97a978a2ffff", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "TA0003", "comment": "CVE-2024-1727 - File manipulation via CSRF attack. This technique allows attackers to upload multiple large files to the victim's system, potentially leading to a denial of service."}, {"techniqueID": "TA0005", "comment": "CVE-2024-1727 - Web application vulnerability. This technique exploits the vulnerability by crafting a malicious HTML page that triggers an unauthorized file upload to the victim's server."}, {"techniqueID": "TA1517", "comment": "CVE-2024-1727 - File upload exploitation. This technique uses the vulnerability to upload multiple large files to the victim's system, causing a denial of service."}], "stix_bundle": {"bundle_types": ["indicator", "observed-data", "event", "report", "note"], "objects": [{"id": "GRADIO-CONF-1", "type": "indicator", "created_by_ref": "NIST", "modified": "2024-04-16T12:15:09.843", "name": "GRADIO CSRF Vulnerability", "description": "GRADIO CSRF vulnerability that allows attackers to upload multiple large files to the victim's system.", "pattern_info": "csrf-gradio"}, {"id": "GRADIO-EVENT-1", "type": "event", "created_by_ref": "NIST", "modified": "2024-04-16T12:15:09.843", "name": "GRADIO CSRF Attack", "description": "GRADIO CSRF attack that uploads multiple large files to the victim's system.", "object_marking_refs": ["marking-definition--1"]}, {"id": "GRADIO-DEFENSE-1", "type": "course-of-action", "created_by_ref": "NIST", "modified": "2024-04-16T12:15:09.843", "name": "GRADIO CSRF Defense", "description": "Implementing CORS security headers to prevent CSRF attacks in GRADIO.", "recommended_action_refs": ["action--1"]}, {"id": "action--1", "type": "intrusion_detection_system", "created_by_ref": "NIST", "modified": "2024-04-16T12:15:09.843", "name": "block-gradio-csrf-traffic", "description": "Block GRADIO CSRF traffic to prevent file upload attacks."}], "relationships": [{"relationship": "indicates", "from": "GRADIO-CONF-1", "to": "GRADIO-EVENT-1"}, {"relationship": "mitigates", "from": "GRADIO-EVENT-1", "to": "GRADIO-DEFENSE-1"}, {"relationship": "uses", "from": "GRADIO-DEFENSE-1", "to": "action--1"}]}, "technical_analysis": {"Introduction": "GRADIO is a popular framework for creating web applications, but it has a significant vulnerability that allows attackers to upload multiple large files to the victim's system.", "Impact and Scope": "This vulnerability has a CVSS score of 4.3 (MEDIUM) with an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to TA0003 (Command and Control), TA0005 (Web Application), and TA1517 (File Upload).", "Technical Details": "The vulnerability is caused by a lack of validation on the client-side, allowing attackers to upload files without the user's consent.", "Detection": "Detecting this vulnerability requires monitoring web traffic for suspicious file uploads.", "Mitigation": "Implementing CORS security headers and validating client-side requests is an effective mitigation strategy.", "Conclusion": "The GRADIO CSRF vulnerability is a significant threat to web applications, and implementing effective security measures is crucial to prevent exploitation."}, "executive_analysis": {"Overview": "The GRADIO CSRF vulnerability is a critical security threat that can allow attackers to upload multiple large files to the victim's system, potentially leading to a denial of service.", "Business Impact": "This vulnerability can have significant business impacts, including system downtime, data loss, and reputation damage.", "Technical Impact": "The vulnerability allows attackers to compromise the victim's system, potentially leading to unauthorized file uploads and data theft.", "Mitigation Strategies": "Implementing CORS security headers and validating client-side requests is an effective mitigation strategy.", "Recommendations": "Executives should prioritize addressing this vulnerability to prevent exploitation and minimize potential impacts.", "Conclusions": "The GRADIO CSRF vulnerability is a significant security threat that requires immediate attention to prevent exploitation and minimize potential impacts."}}