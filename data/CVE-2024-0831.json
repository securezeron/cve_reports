{"id": "CVE-2024-0831", "sourceIdentifier": "security@hashicorp.com", "published": "2024-02-01T02:15:46.330", "lastModified": "2024-02-23T16:15:46.980", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Vault and Vault Enterprise (\u201cVault\u201d) may expose sensitive information when enabling an audit device which specifies the `log_raw` option, which may log sensitive information to other audit devices, regardless of whether they are configured to use `log_raw`."}, {"lang": "es", "value": "Vault y Vault Enterprise (\u201cVault\u201d) pueden exponer informaci\u00f3n confidencial al habilitar un dispositivo de auditor\u00eda que especifica la opci\u00f3n `log_raw`, que puede registrar informaci\u00f3n confidencial en otros dispositivos de auditor\u00eda, independientemente de si est\u00e1n configurados para usar `log_raw`."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security@hashicorp.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-532"}]}, {"source": "security@hashicorp.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-532"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.15.0", "versionEndExcluding": "1.15.5", "matchCriteriaId": "459B7BA3-5070-4686-9DDD-D3B8ADED0DF8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.15.0", "versionEndExcluding": "1.15.5", "matchCriteriaId": "B92203A3-1C92-430B-8008-A4FC4745DEEE"}]}]}], "references": [{"url": "https://developer.hashicorp.com/vault/docs/upgrading/upgrade-to-1.15.x#audit-devices-could-log-raw-data-despite-configuration", "source": "security@hashicorp.com", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "https://discuss.hashicorp.com/t/hcsec-2024-01-vault-may-expose-sensitive-information-when-configuring-an-audit-log-device/62311", "source": "security@hashicorp.com", "tags": ["Vendor Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20240223-0005/", "source": "security@hashicorp.com"}], "techniques": [{"techniqueID": "T1036", "comment": "Vault data could be exfiltrated due to misconfigured audit devices, enabling the `log_raw` option allowing sensitive information to be logged to other devices, regardless of configuration. Related to the CVE-2024-0831 vulnerability."}, {"techniqueID": "T1071", "comment": "Exploitation of the vulnerability could be achieved by configuring an audit device to capture sensitive information, bypassing security controls. Related to the CVE-2024-0831 vulnerability."}, {"techniqueID": "T1190", "comment": "The vulnerability could be exploited by using a remote code execution vulnerability and using an exploit to create a shell on the target system. This would allow the attacker to gain access to the targeted system. Related to the CVE-2024-0831 vulnerability."}], "stix_bundle": {"type": "bundle", "objects": [{"type": "vulnerability", "id": "vuln-CVE-2024-0831", "title": "Vault Audit Device Log Raw Data Expos", "description": "Vault and Vault Enterprise (\u201cVault\u201d) may expose sensitive information when enabling an audit device which specifies the `log_raw` option, which may log sensitive information to other audit devices, regardless of whether they are configured to use `log_raw`.", "cveid": "CVE-2024-0831", "cvss": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "references": [{"source": "security@hashicorp.com", "url": "https://developer.hashicorp.com/vault/docs/upgrading/upgrade-to-1.15.x#audit-devices-could-log-raw-data-despite-configuration", "tags": ["Exploit", "Vendor Advisory"]}]}, {"type": "course-of-action", "id": "coa-1", "title": "Disable Log Raw Option", "description": "Disable the `log_raw` option on audit devices to prevent sensitive information from being logged to other devices."}, {"type": "course-of-action", "id": "coa-2", "title": "Monitor Audit Logs", "description": "Monitor audit logs regularly to detect and respond to potential data exfiltration attempts."}, {"type": "indicator", "id": "indicator-1", "title": "Unusual Audit Log Activity", "description": "Unusual audit log activity, such as unexpected log entries or unusual traffic patterns, may indicate attempted data exfiltration."}], "attack_pattern": [{"id": "attack-pattern-1", "type": "attack-pattern", "title": "Vault Data Exfiltration", "description": "The attacker enables the `log_raw` option on an audit device, allowing sensitive information to be logged to other devices."}]}, "technical_analysis": {"Introduction": "The CVE-2024-0831 vulnerability allows sensitive information to be exposed when enabling an audit device with the `log_raw` option. This could be exploited by an attacker to gain access to sensitive data.", "Impact and Scope": "The impact and scope of this vulnerability are high, as it allows an attacker to gain access to sensitive data. The vulnerability affects Vault and Vault Enterprise, and can be exploited remotely.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1036, T1071, and T1190.", "Technical Details": "The vulnerability is caused by the misconfiguration of an audit device, which allows sensitive information to be logged to other devices. This can be exploited by an attacker to gain access to sensitive data.", "Detection": "The vulnerability can be detected by monitoring audit logs for unusual activity and monitoring network traffic for suspicious patterns.", "Mitigation": "The vulnerability can be mitigated by disabling the `log_raw` option on audit devices and implementing strict access controls.", "Conclusion": "The CVE-2024-0831 vulnerability is a serious security risk that can be exploited by an attacker to gain access to sensitive data. It is recommended that affected organizations disable the `log_raw` option on audit devices and implement strict access controls."}, "executive_analysis": {"Overview": "The CVE-2024-0831 vulnerability is a serious security risk that can be exploited by an attacker to gain access to sensitive data.", "Business Impact": "The business impact of this vulnerability is high, as it could result in the loss of sensitive data or intellectual property.", "Technical Impact": "The technical impact of this vulnerability is also high, as it could allow an attacker to gain access to sensitive data.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include disabling the `log_raw` option on audit devices and implementing strict access controls.", "Recommendations": "Recommendations for executives include prioritizing the remediation of this vulnerability and implementing additional security controls.", "Conclusions": "In conclusion, the CVE-2024-0831 vulnerability is a serious security risk that requires immediate attention. It is recommended that all affected organizations prioritize the remediation of this vulnerability and implement additional security controls."}}