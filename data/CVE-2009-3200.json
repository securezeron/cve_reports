{"id": "CVE-2009-3200", "sourceIdentifier": "cve@mitre.org", "published": "2009-09-21T19:30:00.420", "lastModified": "2018-10-10T19:43:12.283", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The QNAP TS-239 Pro and TS-639 Pro with firmware 2.1.7 0613, 3.1.0 0627, and 3.1.1 0815 create an undocumented recovery key and store it in the ENCK variable in flash memory, which allows local users to bypass the passphrase requirement and decrypt the hard drive by reading this variable, deobfuscating the key, and running a cryptsetup luksOpen command."}, {"lang": "es", "value": "QNAP TS-239 Pro y TS-639 Pro con firmware v2.1.7 0613, v3.1.0 0627, y v3.1.1 0815 crea una clave de recuperaci\u00f3n no documentada y la almacena en la variable ENCK en memoria flash, permitiendo a usuarios locales saltar el requisito de contrase\u00f1a y desencriptar el disco duro mediante la lectura de esta variable, desofuscando la clave, y ejecutando un comando cryptsetup luksOpen."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:C/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.9}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 8.5, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-310"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:h:qnap:ts-239_pro_turbo_nas:2.1.7_0613:*:*:*:*:*:*:*", "matchCriteriaId": "5EE9055C-121F-4DB7-8C31-0C25860EB956"}, {"vulnerable": true, "criteria": "cpe:2.3:h:qnap:ts-239_pro_turbo_nas:3.1.0_0627:*:*:*:*:*:*:*", "matchCriteriaId": "DBD938AD-4FF6-43F7-BDBA-C751DBE670F9"}, {"vulnerable": true, "criteria": "cpe:2.3:h:qnap:ts-239_pro_turbo_nas:3.1.1_0815:*:*:*:*:*:*:*", "matchCriteriaId": "5D3675EC-CB39-4D51-9D38-D921A67F5085"}, {"vulnerable": true, "criteria": "cpe:2.3:h:qnap:ts-639_pro_turbo_nas:2.1.7_0613:*:*:*:*:*:*:*", "matchCriteriaId": "8C6B1151-66DD-41AC-BCE2-076B72738CF0"}, {"vulnerable": true, "criteria": "cpe:2.3:h:qnap:ts-639_pro_turbo_nas:3.1.0_0627:*:*:*:*:*:*:*", "matchCriteriaId": "8BE092C1-DE91-4DE2-90CB-7A3BD2B84B0A"}, {"vulnerable": true, "criteria": "cpe:2.3:h:qnap:ts-639_pro_turbo_nas:3.1.1_0815:*:*:*:*:*:*:*", "matchCriteriaId": "EF79B187-CD61-45B6-9D71-3C73D9490970"}]}]}], "references": [{"url": "http://forum.qnap.com/viewtopic.php?f=11&t=11214&start=20#p63346", "source": "cve@mitre.org"}, {"url": "http://forum.qnap.com/viewtopic.php?f=12&t=12104&start=10#p63341", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/36793", "source": "cve@mitre.org"}, {"url": "http://www.baseline-security.de/downloads/BSC-Qnap_Crypto_Backdoor-CVE-2009-3200.txt", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.securityfocus.com/archive/1/506607/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/36467", "source": "cve@mitre.org"}, {"url": "http://www.securitytracker.com/id?1022916", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/53391", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1003", "comment": "CVE-2009-3200 - This vulnerability allows local users to bypass the passphrase requirement and decrypt the hard drive by reading the undocumented recovery key from the flash memory. This technique is related to MAA-000105, 'Bootkit' and can be used as an entry point for additional exploitation."}, {"techniqueID": "T1031", "comment": "CVE-2009-3200 - This vulnerability allows local users to gain unauthorized access to the encrypted hard drive by reading the undocumented recovery key from the flash memory. This technique is related to T1041, 'Ingress Tool Transfer' and can be used to insert malicious code or tools onto the system."}, {"techniqueID": "T1008", "comment": "CVE-2009-3200 - This vulnerability allows local users to exploit the Enck variable in flash memory to gain unauthorized access to the encrypted hard drive. This technique is related to T1045, 'Download' and can be used to download malicious code or tools onto the system."}], "stix_bundle": {"@stix": {"Vulnerability": {"id": "CVE-2009-3200", "cvssV2": {"severity": "MEDIUM", "accessVector": "LOCAL", "exploitAbility": 3.4, "impact": 8.5}, "notes": [{"content": "A vulnerability exists in the QNAP TS-239 Pro and TS-639 Pro series, allowing local users to bypass the passphrase requirement and decrypt the hard drive by reading the undocumented recovery key from the flash memory.", "type": "note"}], "related_relationships": [{"type": "has-related-technique", "technique": {"@id": "T1003", "name": "Command and Control - Invalid Traffic"}}]}, "Course_of_Action": {"id": "MIT-000001", "description": "Apply the recommended firmware update to fix the vulnerability", "notes": [{"content": "The vulnerability can be fixed by applying the recommended firmware update", "type": "note"}], "mitigates": [{"technique": {"@id": "T1003", "name": "Command and Control - Invalid Traffic"}, "relationship": "mitigates"}]}, "Defense_Report": {"id": "DEF-000001", "description": "Defensive strategies for mitigating the vulnerability", "notes": [{"content": "The recommended defensive strategy is to apply the firmware update and ensure regular backups are performed", "type": "note"}], "mitigates": [{"technique": {"@id": "T1003", "name": "Command and Control - Invalid Traffic"}, "relationship": "mitigates"}]}}}, "technical_analysis": {"Introduction": "The CVE-2009-3200 vulnerability is a critical flaw in the QNAP TS-239 Pro and TS-639 Pro series, allowing local users to bypass the passphrase requirement and decrypt the hard drive.", "Impact and Scope": "The vulnerability is rated 5.9 on the CVSSv2 scale, with a medium severity and local access vector.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including MAA-000105, 'Bootkit', T1003, 'Command and Control - Invalid Traffic', and T1041, 'Ingress Tool Transfer'.", "Technical Details": "The vulnerability is caused by the undocumented recovery key stored in the Enck variable in flash memory, which can be read by a local user to bypass the passphrase requirement.", "Detection": "Detection methods include monitoring for suspicious network traffic and system log anomalies.", "Mitigation": "Mitigation strategies include applying the recommended firmware update and enabling encryption on the hard drive.", "Conclusion": "The CVE-2009-3200 vulnerability is a critical flaw that requires prompt attention and mitigation to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2009-3200 vulnerability is a critical flaw in the QNAP TS-239 Pro and TS-639 Pro series that allows local users to bypass the passphrase requirement and decrypt the hard drive.", "Business Impact": "The vulnerability could have significant business impact if exploited, potentially leading to data breaches and loss of sensitive information.", "Technical Impact": "The vulnerability is technically significant, as it allows an attacker to bypass the passphrase requirement and decrypt the hard drive.", "Mitigation Strategies": "Mitigation strategies include applying the recommended firmware update and enabling encryption on the hard drive.", "Recommendations": "Recommendations include performing regular backups, monitoring for suspicious network traffic, and ensuring all systems and software are up to date.", "Conclusions": "The CVE-2009-3200 vulnerability is a critical flaw that requires prompt attention and mitigation to prevent exploitation."}}