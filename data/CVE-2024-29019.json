{"id": "CVE-2024-29019", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-11T01:25:11.690", "lastModified": "2024-04-11T12:47:44.137", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "ESPHome is a system to control microcontrollers remotely through Home Automation systems. API endpoints in dashboard component of ESPHome version 2023.12.9 (command line installation) are vulnerable to Cross-Site Request Forgery (CSRF) allowing remote attackers to carry out attacks against a logged user of the dashboard to perform operations on configuration files (create, edit, delete). It is possible for a malicious actor to create a specifically crafted web page that triggers a cross site request against ESPHome, this allows bypassing the authentication for API calls on the platform. This vulnerability allows bypassing authentication on API calls accessing configuration file operations on the behalf of a logged user. In order to trigger the vulnerability, the victim must visit a weaponized page. In addition to this, it is possible to chain this vulnerability with GHSA-9p43-hj5j-96h5/ CVE-2024-27287 to obtain a complete takeover of the user account. Version 2024.3.0 contains a patch for this issue.\n\n"}, {"lang": "es", "value": "ESPHome es un sistema para controlar microcontroladores de forma remota a trav\u00e9s de sistemas de Dom\u00f3tica. Los endpoints API en el componente del tablero de ESPHome versi\u00f3n 2023.12.9 (instalaci\u00f3n de l\u00ednea de comando) son vulnerables a Cross-Site Request Forgery (CSRF), lo que permite a atacantes remotos llevar a cabo ataques contra un usuario registrado en el tablero para realizar operaciones en archivos de configuraci\u00f3n (crear, editar Borrar). Es posible que un actor malintencionado cree una p\u00e1gina web espec\u00edficamente manipulada que active una solicitud entre sitios contra ESPHome, lo que permite omitir la autenticaci\u00f3n para llamadas API en la plataforma. Esta vulnerabilidad permite omitir la autenticaci\u00f3n en llamadas API que acceden a operaciones del archivo de configuraci\u00f3n en nombre de un usuario registrado. Para activar la vulnerabilidad, la v\u00edctima debe visitar una p\u00e1gina armada. Adem\u00e1s de esto, es posible encadenar esta vulnerabilidad con GHSA-9p43-hj5j-96h5/ CVE-2024-27287 para obtener una toma completa de la cuenta del usuario. La versi\u00f3n 2024.3.0 contiene un parche para este problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-352"}]}], "references": [{"url": "https://github.com/advisories/GHSA-9p43-hj5j-96h5", "source": "security-advisories@github.com"}, {"url": "https://github.com/esphome/esphome/security/advisories/GHSA-5925-88xh-6h99", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-29019 - This technique is relevant as it is a Cross-Site Request Forgery (CSRF) vulnerability that allows remote attackers to carry out attacks against a logged user of the dashboard to perform operations on configuration files. It is important to defend against this technique by validating user input and ensuring that only authorized requests are made to the API."}, {"techniqueID": "T1204", "comment": "CVE-2024-29019 - This technique is relevant as it involves using a maliciously crafted web page to trick a user into performing an unintended action. It is important to defend against this technique by educating users about the dangers of phishing and ensuring that all web pages are trusted before performing any actions."}, {"techniqueID": "T1005", "comment": "CVE-2024-29019 - This technique is relevant as it involves the use of a remote attacker to carry out a malicious action. It is important to defend against this technique by ensuring that all remote access is secure and that all network traffic is monitored for suspicious activity."}, {"techniqueID": "T1595", "comment": "CVE-2024-29019 - This technique is relevant as it involves the use of a vulnerability in a trusted application to carry out a malicious action. It is important to defend against this technique by ensuring that all applications are kept up to date and that all vulnerabilities are patched promptly."}], "stix_bundle": {"definition": {"description": "STIX 2.1 Bundle for CVE-2024-29019", "published": "2024-04-11T01:25:11.690", "created_by": "security-advisories@github.com", "modified": "2024-04-11T12:47:44.137", "id": "CVE-2024-29019-STIX2.1"}, "objects": [{"type": "vulnerability", "id": "CVE-2024-29019", "name": "CVE-2024-29019", "description": "ESPHome dashboard component of ESPHome version 2023.12.9 (command line installation) is vulnerable to Cross-Site Request Forgery (CSRF) allowing remote attackers to carry out attacks against a logged user of the dashboard to perform operations on configuration files.", "scenarios": [{"type": "attack-pattern", "id": "T1190"}, {"type": "attack-pattern", "id": "T1204"}, {"type": "attack-pattern", "id": "T1005"}, {"type": "attack-pattern", "id": "T1595"}], "courses_of_action": [{"type": "tactic", "id": "TA0001", "name": "Initial Access", "notes": "Use valid credentials to access the ESPHome dashboard."}, {"type": "tactic", "id": "TA0002", "name": "Execution", "notes": "Use a maliciously crafted web page to trick a user into performing an unintended action."}, {"type": "tactic", "id": "TA0003", "name": "Persistence", "notes": "Use a remote attacker to carry out a malicious action."}, {"type": "tactic", "id": "TA0004", "name": "Privilege Escalation", "notes": "Use a vulnerability in a trusted application to carry out a malicious action."}], "defense_points": [{"type": "mitigation", "id": "Mitigation-1", "name": "Validating User Input", "description": "Validate all user input to prevent CSRF attacks."}, {"type": "mitigation", "id": "Mitigation-2", "name": "Educating Users", "description": "Educate users about the dangers of phishing and ensure that all web pages are trusted before performing any actions."}]}]}, "technical_analysis": {"Introduction": "CVE-2024-29019 is a Cross-Site Request Forgery (CSRF) vulnerability in the dashboard component of ESPHome version 2023.12.9 (command line installation).", "Impact and Scope": "This vulnerability allows remote attackers to carry out attacks against a logged user of the dashboard to perform operations on configuration files. The attack vector is CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N.", "Related MITRE ATT&CK Techniques": "T1190, T1204, T1005, T1595", "Technical Details": "The vulnerability occurs when a maliciously crafted web page is visited by a user, which triggers a CSRF attack on the ESPHome dashboard.", "Detection": "Detection can be achieved by monitoring for suspicious API requests and validating user input.", "Mitigation": "Mitigation strategies include validating user input, educating users about phishing, and ensuring that all web pages are trusted before performing any actions.", "Conclusion": "In conclusion, CVE-2024-29019 is a significant vulnerability that allows remote attackers to carry out attacks against a logged user of the dashboard to perform operations on configuration files."}, "executive_analysis": {"Overview": "CVE-2024-29019 is a critical vulnerability in the ESPHome dashboard component that can be exploited by remote attackers to perform unauthorized actions.", "Business Impact": "The_business_impact_of_this_vulnerability_Will_Be_Severe.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows remote attackers to carry out attacks against a logged user of the dashboard to perform operations on configuration files.", "Mitigation Strategies": " Validate user input, educate users about phishing, and ensure that all web pages are trusted before performing any actions.", "Recommendations": "Recommendations for executives include implementing a security information and event management (SIEM) system, conducting regular security audits, and ensuring that all software is up to date.", "Conclusions": "In conclusion, CVE-2024-29019 is a critical vulnerability that requires immediate attention and mitigation to prevent any potential attacks."}}