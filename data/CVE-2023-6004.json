{"id": "CVE-2023-6004", "sourceIdentifier": "secalert@redhat.com", "published": "2024-01-03T17:15:11.623", "lastModified": "2024-05-22T17:16:07.773", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "A flaw was found in libssh. By utilizing the ProxyCommand or ProxyJump feature, users can exploit unchecked hostname syntax on the client. This issue may allow an attacker to inject malicious code into the command of the features mentioned through the hostname parameter."}, {"lang": "es", "value": "Se encontr\u00f3 una falla en libssh. Al utilizar la funci\u00f3n ProxyCommand o ProxyJump, los usuarios pueden explotar la sintaxis del hostname no verificada en el cliente. Este problema puede permitir que un atacante inyecte c\u00f3digo malicioso en el comando de las funciones mencionadas a trav\u00e9s del par\u00e1metro de hostname."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 3.4}, {"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 3.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}]}, {"source": "secalert@redhat.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-74"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:libssh:libssh:*:*:*:*:*:*:*:*", "versionStartIncluding": "0.8.0", "versionEndExcluding": "0.9.8", "matchCriteriaId": "CCC06989-1635-446A-B017-0D938580165B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:libssh:libssh:*:*:*:*:*:*:*:*", "versionStartIncluding": "0.10.0", "versionEndExcluding": "0.10.6", "matchCriteriaId": "BCB546AC-788C-422E-B6BD-756BF39BD0F5"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:38:*:*:*:*:*:*:*", "matchCriteriaId": "CC559B26-5DFC-4B7A-A27C-B77DE755DFF9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "F4CFF558-3C47-480D-A2F0-BABF26042943"}, {"vulnerable": true, "criteria": "cpe:2.3:o:redhat:enterprise_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "7F6FB57C-2BC7-487C-96DD-132683AEB35D"}]}]}], "references": [{"url": "https://access.redhat.com/errata/RHSA-2024:2504", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3233", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/security/cve/CVE-2023-6004", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2251110", "source": "secalert@redhat.com", "tags": ["Issue Tracking"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LZQVUHWVWRH73YBXUQJOD6CKHDQBU3DM/", "source": "secalert@redhat.com", "tags": ["Mailing List", "Vendor Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20240223-0004/", "source": "secalert@redhat.com"}, {"url": "https://www.libssh.org/security/advisories/CVE-2023-6004.txt", "source": "secalert@redhat.com", "tags": ["Mailing List"]}], "techniques": [{"techniqueID": "T1068", "comment": "CVE-2023-6004 - This vulnerability can be exploited by an attacker to gain access to a victim's system by injecting malicious code through the ProxyCommand or ProxyJump feature."}, {"techniqueID": "T1046", "comment": "This vulnerability can be used by an attacker to execute code and interact with the target system through the ProxyCommand or ProxyJump feature."}, {"techniqueID": "T1210", "comment": "An attacker can use this vulnerability to establish a command prompt or shell and get a reverse shell to run arbitrary commands on the system."}], "stix_bundle": {"type": "bundle", "id": "CVE-2023-6004 Bundle", "created_by": "Cyber Security Expert", "created": "2024-01-03T17:15:11.623", "objects": [{"id": "CVE-2023-6004", "type": "vulnerability", "description": "A flaw was found in libssh. By utilizing the ProxyCommand or ProxyJump feature, users can exploit unchecked hostname syntax on the client. This issue may allow an attacker to inject malicious code into the command of the features mentioned through the hostname parameter."}, {"id": "T1068", "type": "attack-pattern", "description": "Exploit a remote service's command execution capability", "relations": [{"type": "uses", "id_ref": "CVE-2023-6004"}]}, {"id": "T1046", "type": "attack-pattern", "description": "R Shell", "relations": [{"type": "uses", "id_ref": "CVE-2023-6004"}]}, {"id": "T1210", "type": "attack-pattern", "description": "Spearphishing Attachment", "relations": [{"type": "uses", "id_ref": "CVE-2023-6004"}]}]}, "technical_analysis": {"Introduction": "The CVE-2023-6004 vulnerability is a remote command execution vulnerability in the libssh library.", "Impact and Scope": "The vulnerability is a remote command execution vulnerability, which can be used to execute arbitrary commands on the system with the privileges of the user running the libssh client.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1068, T1046, and T1210.", "Technical Details": "The vulnerability is due to the fact that the libssh library does not properly validate the hostname syntax in the ProxyCommand or ProxyJump feature.", "Detection": "The vulnerability can be detected by monitoring for unusual network traffic patterns or by implementing a robust security information and event management (SIEM) system.", "Mitigation": "The vulnerability can be mitigated by patching the libssh library or by implementing a valid hostname syntax check in the ProxyCommand or ProxyJump feature.", "Conclusion": "The CVE-2023-6004 vulnerability is a remote command execution vulnerability that can be used to execute arbitrary commands on the system."}, "executive_analysis": {"Overview": "The CVE-2023-6004 vulnerability is a remote command execution vulnerability in the libssh library.", "Business Impact": "The vulnerability can be used by an attacker to execute arbitrary commands on the system, which can result in data breaches, data destruction, or denial of service.", "Technical Impact": "The vulnerability can be used to execute arbitrary commands on the system, which can result in data breaches, data destruction, or denial of service.", "Mitigation Strategies": "The vulnerability can be mitigated by patching the libssh library or by implementing a valid hostname syntax check in the ProxyCommand or ProxyJump feature.", "Recommendations": "Executives should recommend patching the libssh library or implementing a valid hostname syntax check in the ProxyCommand or ProxyJump feature to mitigate the vulnerability.", "Conclusions": "The CVE-2023-6004 vulnerability is a remote command execution vulnerability that can be used to execute arbitrary commands on the system, and it is recommended to take immediate action to mitigate the vulnerability."}}