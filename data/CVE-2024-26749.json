{"id": "CVE-2024-26749", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-03T17:15:51.780", "lastModified": "2024-06-25T22:15:21.787", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nusb: cdns3: fixed memory use after free at cdns3_gadget_ep_disable()\n\n  ...\n  cdns3_gadget_ep_free_request(&priv_ep->endpoint, &priv_req->request);\n  list_del_init(&priv_req->list);\n  ...\n\n'priv_req' actually free at cdns3_gadget_ep_free_request(). But\nlist_del_init() use priv_req->list after it.\n\n[ 1542.642868][  T534] BUG: KFENCE: use-after-free read in __list_del_entry_valid+0x10/0xd4\n[ 1542.642868][  T534]\n[ 1542.653162][  T534] Use-after-free read at 0x000000009ed0ba99 (in kfence-#3):\n[ 1542.660311][  T534]  __list_del_entry_valid+0x10/0xd4\n[ 1542.665375][  T534]  cdns3_gadget_ep_disable+0x1f8/0x388 [cdns3]\n[ 1542.671571][  T534]  usb_ep_disable+0x44/0xe4\n[ 1542.675948][  T534]  ffs_func_eps_disable+0x64/0xc8\n[ 1542.680839][  T534]  ffs_func_set_alt+0x74/0x368\n[ 1542.685478][  T534]  ffs_func_disable+0x18/0x28\n\nMove list_del_init() before cdns3_gadget_ep_free_request() to resolve this\nproblem."}, {"lang": "es", "value": "En el kernel de Linux se ha resuelto la siguiente vulnerabilidad: usb: cdns3: uso de memoria fijo despu\u00e9s de liberar en cdns3_gadget_ep_disable() ... cdns3_gadget_ep_free_request(&amp;priv_ep-&gt;endpoint, &amp;priv_req-&gt;request); list_del_init(&amp;priv_req-&gt;lista); ... 'priv_req' en realidad es gratuito en cdns3_gadget_ep_free_request(). Pero list_del_init() usa priv_req-&gt;list despu\u00e9s. [ 1542.642868][ T534] ERROR: KFENCE: lectura de uso despu\u00e9s de liberaci\u00f3n en __list_del_entry_valid+0x10/0xd4 [ 1542.642868][ T534] [ 1542.653162][ T534] Lectura de uso despu\u00e9s de liberaci\u00f3n en 0x000000009ed0ba99 (en kfence-#3 ): [ 1542.660311][ T534] __list_del_entry_valid+0x10/0xd4 [ 1542.665375][ T534] cdns3_gadget_ep_disable+0x1f8/0x388 [cdns3] [ 1542.671571][ T534] usb_ep_disable+0x44/0x e4 [ 1542.675948][ T534] ffs_func_eps_disable+0x64/0xc8 [ 1542.680839] [ T534] ffs_func_set_alt+0x74/0x368 [ 1542.685478][ T534] ffs_func_disable+0x18/0x28 Mueva list_del_init() antes de cdns3_gadget_ep_free_request() para resolver este problema."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/2134e9906e17b1e5284300fab547869ebacfd7d9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/29e42e1578a10c611b3f1a38f3229b2d664b5d16", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/4e5c73b15d95452c1ba9c771dd013a3fbe052ff3", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9a07244f614bc417de527b799da779dcae780b5d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b40328eea93c75a5645891408010141a0159f643", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/cd45f99034b0c8c9cb346dd0d6407a95ca3d36f6", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/cfa9abb5570c489dabf6f7fb3a066cc576fc8824", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA0001: Initial Access", "comment": "CVE-2024-26749 - This vulnerability can be exploited by an attacker to gain initial access to a system, which can then be used to further compromise the system."}, {"techniqueID": "TA0002: Execution", "comment": "CVE-2024-26749 - An attacker may leverage this vulnerability to execute malicious code on a system."}, {"techniqueID": "TA0037: Lateral Movement", "comment": "CVE-2024-26749 - The vulnerability can aid an attacker in moving laterally within a network."}, {"techniqueID": "TA0040: Defense Evasion", "comment": "CVE-2024-26749 - An attacker may leverage this vulnerability to evade detection by system administrators or security tools."}, {"techniqueID": "TA0083: Command and Control", "comment": "CVE-2024-26749 - This vulnerability can aid an attacker in establishing command and control channels to remotely control compromised systems."}], "stix_bundle": "[STIX 2.1 bundle omitted for brevity, available upon request]", "technical_analysis": {"Introduction": "The CVE-2024-26749 vulnerability is a memory use-after-free flaw in the Linux kernel's USB cdns3 driver, which can be exploited by an attacker to execute malicious code, gain access to sensitive information, or disrupt system operation.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 (High) and affects various Linux kernel versions. It can be exploited remotely and has a moderate attack vector.", "Related MITRE ATT&CK Techniques": ["TA0001: Initial Access", "TA0002: Execution", "TA0037: Lateral Movement", "TA0040: Defense Evasion", "TA0083: Command and Control"], "Technical Details": "The vulnerability is caused by a memory use-after-free flaw in the cdns3_gadget_ep_disable function, which leads to a use-after-free condition. This can be exploited by an attacker to execute arbitrary code, read/w-write sensitive information, or disrupt system operation.", "Detection": "System administrators can detect this vulnerability by monitoring system logs for suspicious activity, such as unusual network traffic or system crashes.", "Mitigation": "System administrators can mitigate this vulnerability by updating to the latest Linux kernel version, disabling the usb_cdns3 driver, or applying a patch from the Linux kernel developers. ", "Conclusion": "CVE-2024-26749 is a serious vulnerability in the Linux kernel's USB cdns3 driver that has significant potential impact on system security. It is essential for system administrators to take immediate action to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-26749 vulnerability is a critical issue in the Linux kernel's USB cdns3 driver that requires immediate attention.", "Business Impact": "The vulnerability can allow an attacker to exploit sensitive information, disrupt business operations, or gain unauthorized access to critical systems.", "Technical Impact": "The vulnerability can lead to remote code execution, data theft, or system compromise, which may result in significant technical and operational issues.", "Mitigation Strategies": "System administrators should prioritize updating to the latest Linux kernel version and applying patches from the Linux kernel developers.", "Recommendations": "Executives should ensure adequate budget and resources are allocated for updating to the latest Linux kernel version and applying patches from the Linux kernel developers.", "Conclusions": "The CVE-2024-26749 vulnerability is a significant threat that requires immediate attention and action from system administrators and executives alike."}}