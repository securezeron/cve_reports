{"id": "CVE-2020-5844", "sourceIdentifier": "cve@mitre.org", "published": "2020-03-16T18:15:12.617", "lastModified": "2022-11-29T16:57:36.767", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "index.php?sec=godmode/extensions&sec2=extensions/files_repo in Pandora FMS v7.0 NG allows authenticated administrators to upload malicious PHP scripts, and execute them via base64 decoding of the file location. This affects v7.0NG.742_FIX_PERL2020."}, {"lang": "es", "value": "index.php?sec=godmode/extensions&amp;sec2=extensions/files_repo en Pandora FMS versi\u00f3n v7.0 NG, permite a los administradores autenticados cargar scripts PHP maliciosos y ejecutarlos por medio de la decodificaci\u00f3n base64 de la ubicaci\u00f3n de archivo. Esto afecta a la versi\u00f3n v7.0NG.742_FIX_PERL2020."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-434"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:artica:pandora_fms:7.0_ng:*:*:*:*:*:*:*", "matchCriteriaId": "B552ED8D-00AC-4DBF-B654-592C561E73AB"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/167503/Pandora-FMS-7.0NG.742-Remote-Code-Execution.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/TheCyberGeek/CVE-2020-5844", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://pandorafms.com", "source": "cve@mitre.org", "tags": ["Product"]}], "techniques": [{"techniqueID": "T1204", "comment": "Pandora FMS 7.0 NG allows authenticated administrators to upload malicious PHP scripts, and execute them via base64 decoding of the file location. This can be mitigated by restricting file uploads to specific directories only."}, {"techniqueID": "T1102", "comment": "The vulnerability in index.php allows an authenticated administrator to upload a malicious PHP script and executes it via base64 decoding of the file location. This can be mitigated by implementing a web application firewall to block unauthorized file uploads."}, {"techniqueID": "T1055", "comment": "The vulnerability in Pandora FMS allows an authenticated administrator to upload a malicious PHP script and executes it via base64 decoding of the file location. This can be mitigated by implementing a intrusion detection system to monitor for suspicious file uploads."}, {"techniqueID": "T1190", "comment": "The vulnerability in Pandora FMS allows an authenticated administrator to upload a malicious PHP script and executes it via base64 decoding of the file location. This can be mitigated by implementing a intrusion prevention system to block suspicious file uploads."}], "stix_bundle": {"bundle": {"type": "bundle", "spec_version": "2.1"}, "objects": [{"id": "vulnerability", "type": "vulnerability", "name": "CVE-2020-5844", "description": "Pandora FMS 7.0 NG allows authenticated administrators to upload malicious PHP scripts, and execute them via base64 decoding of the file location.", "cve": {"id": "CVE-2020-5844", "source": "NVD"}}, {"id": "exploit", "type": "exploit", "name": "Exploit for CVE-2020-5844", "description": "Exploit for CVE-2020-5844, allows authenticated administrators to upload a malicious PHP script and executes it via base64 decoding of the file location."}, {"id": "mitigation", "type": "mitigation", "name": "Mitigation for CVE-2020-5844", "description": "Mitigate the vulnerability by restricting file uploads to specific directories only."}]}, "technical_analysis": {"Introduction": "Pandora FMS 7.0 NG allows authenticated administrators to upload malicious PHP scripts, and execute them via base64 decoding of the file location. This vulnerability is exploitable by an authenticated administrator.", "Impact and Scope": "The vulnerability affects Pandora FMS 7.0 NG and allows an authenticated administrator to execute arbitrary PHP code. The CVSS score for this vulnerability is 7.2.", "Related MITRE ATT&CK Techniques": "T1204, T1102, T1055, T1190", "Technical Details": "The vulnerability occurs due to the existence of a file upload feature in Pandora FMS 7.0 NG. This feature allows authenticated administrators to upload files to the server. However, instead of uploading legitimate files, an authenticated administrator can upload a malicious PHP script and execute it via base64 decoding of the file location.", "Detection": "Detection can be done by monitoring for suspicious file uploads and examining the uploaded files for malicious code.", "Mitigation": "Mitigation can be achieved by restricting file uploads to specific directories only.", "Conclusion": "In conclusion, the vulnerability in Pandora FMS 7.0 NG is exploitable by an authenticated administrator and affects the system's integrity. It is recommended to restrict file uploads to specific directories only and to monitor for suspicious file uploads."}, "executive_analysis": {"Overview": "The vulnerability in Pandora FMS 7.0 NG allows an authenticated administrator to execute arbitrary PHP code, which can result in the compromise of sensitive data and systems.", "Business Impact": "The compromise of sensitive data and systems can result in significant financial losses and reputational damage.", "Technical Impact": "The vulnerability allows an authenticated administrator to execute arbitrary PHP code, which can result in the compromise of sensitive data and systems.", "Mitigation Strategies": "Restrict file uploads to specific directories only, monitor for suspicious file uploads, and consider implementing a web application firewall to block unauthorized file uploads.", "Recommendations": "The CISO and the security team should work together to implement the recommended mitigation strategies and ensure that all systems are up-to-date and patched.", "Conclusions": "In conclusion, the vulnerability in Pandora FMS 7.0 NG is a serious issue that requires immediate attention. It is recommended to restrict file uploads to specific directories only, monitor for suspicious file uploads, and consider implementing a web application firewall to block unauthorized file uploads."}}