{"id": "CVE-2024-4033", "sourceIdentifier": "security@wordfence.com", "published": "2024-05-02T17:15:33.740", "lastModified": "2024-05-02T18:00:37.360", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The All-in-One Video Gallery plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the aiovg_create_attachment_from_external_image_url function in all versions up to, and including, 3.6.4. This makes it possible for authenticated attackers, with contributor access and above, to upload arbitrary files on the affected site's server which may make remote code execution possible."}, {"lang": "es", "value": "El complemento All-in-One Video Gallery para WordPress es vulnerable a la carga de archivos arbitrarios debido a la falta de validaci\u00f3n del tipo de archivo en la funci\u00f3n aiovg_create_attachment_from_external_image_url en todas las versiones hasta la 3.6.4 incluida. Esto hace posible que atacantes autenticados, con acceso de colaborador y superior, carguen archivos arbitrarios en el servidor del sitio afectado, lo que puede hacer posible la ejecuci\u00f3n remota de c\u00f3digo."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "references": [{"url": "https://plugins.trac.wordpress.org/browser/all-in-one-video-gallery/trunk/includes/functions.php#L140", "source": "security@wordfence.com"}, {"url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=3078876%40all-in-one-video-gallery%2Ftrunk&old=3072329%40all-in-one-video-gallery%2Ftrunk&sfp_email=&sfph_mail=", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/e0f295f9-1090-4b10-abc5-3f73c5b4e28d?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1505: Domain Name System (DNS) Queries", "comment": "The attacker could use DNS queries to reconnaissance the systems and networks in order to identify potential targets and create a map of the domain. - CVE-2024-4033 - Unauthenticated remote attackers could create sensitive directories and upload arbitrary files, making it possible for attacker to use DNS queries to identify vulnerabilities."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "The vulnerable All-in-One Video Gallery plugin can be exploited remotely by an authenticated attacker with contributor access or above, making it vulnerable to remote code execution. - CVE-2024-4033 - The attacker could exploit this vulnerability to gain unauthorized access to the system."}, {"techniqueID": "T1572: User Execution", "comment": "The attacker could trick an authenticated user with contributor access or above to execute malicious code by uploading a malicious file. - CVE-2024-4033 - User interaction is required to exploit this vulnerability."}], "stix_bundle": {"type": "bundle", "id": "bundle-1", "created_by_ref": "https://json.org/example.json", "created": "2024-05-02T18:00:37.360", "modified": "2024-05-02T18:00:37.360", "objects": [{"type": "vulnerability", "id": "vuln-1", "created_by_ref": "https://json.org/example.json", "created": "2024-05-02T18:00:37.360", "modified": "2024-05-02T18:00:37.360", "name": "CVE-2024-4033", "description": "The All-in-One Video Gallery plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the aiovg_create_attachment_from_external_image_url function in all versions up to, and including, 3.6.4.", "references": [{"id": "ref-1", "type": "reference", "url": "https://plugins.trac.wordpress.org/browser/all-in-one-video-gallery/trunk/includes/functions.php#L140"}, {"id": "ref-2", "type": "reference", "url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=3078876%40all-in-one-video-gallery%2Ftrunk&old=3072329%40all-in-one-video-gallery%2Ftrunk&sfp_email=&sfph_mail="}], "reporting_score": "8.8", "base_score": "8.8", "base_severity": "HIGH", "attack_vector": "NETWORK", "attack_complexity": "LOW", "privileges_required": "LOW", "user_interaction": "NONE", "scope": "UNCHANGED", "confidentiality_impact": "HIGH", "integrity_impact": "HIGH", "availability_impact": "HIGH"}, {"type": "course-of-action", "id": "coa-1", "created_by_ref": "https://json.org/example.json", "created": "2024-05-02T18:00:37.360", "modified": "2024-05-02T18:00:37.360", "name": "Update to version 3.6.5 or later", "description": "Update to the latest version of the All-in-One Video Gallery plugin to patch the vulnerability.", "related_object_id_ref": "vuln-1", "related_object_type": "vulnerability", "relating_object_id_ref": "technique-1", "relating_object_type": "technique"}, {"type": "course-of-action", "id": "coa-2", "created_by_ref": "https://json.org/example.json", "created": "2024-05-02T18:00:37.360", "modified": "2024-05-02T18:00:37.360", "name": "Restrict file uploads", "description": "Restrict file uploads to only allow certain file types and extensions.", "related_object_id_ref": "vuln-1", "related_object_type": "vulnerability", "relating_object_id_ref": "technique-1", "relating_object_type": "technique"}]}, "technical_analysis": {"Introduction": "The CVE-2024-4033 is a remote code execution vulnerability in the All-in-One Video Gallery plugin for WordPress.", "Impact and Scope": "The vulnerability is exploitable remotely by an authenticated attacker with contributor access or above. The CVSS score is 8.8, with a high severity rating.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1505: Domain Name System (DNS) Queries, T1190: Exploit Public-Facing Application, and T1572: User Execution.", "Technical Details": "The vulnerability is caused by a missing file type validation in the aiovg_create_attachment_from_external_image_url function.", "Detection": "The vulnerability can be detected by monitoring for suspicious DNS queries and file uploads.", "Mitigation": "The vulnerability can be mitigated by updating to the latest version of the All-in-One Video Gallery plugin and restricting file uploads.", "Conclusion": "The CVE-2024-4033 is a critical remote code execution vulnerability in the All-in-One Video Gallery plugin for WordPress. It is essential to update to the latest version of the plugin and restrict file uploads to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-4033 is a remote code execution vulnerability in the All-in-One Video Gallery plugin for WordPress.", "Business Impact": "The vulnerability allows attackers to gain unauthorized access to the system, which can lead to data breaches and reputational damage.", "Technical Impact": "The vulnerability is a high-severity remote code execution vulnerability that can be exploited remotely.", "Mitigation Strategies": "The vulnerability can be mitigated by updating to the latest version of the All-in-One Video Gallery plugin and restricting file uploads.", "Recommendations": "Executives should prioritize patching the vulnerability and restricting file uploads to prevent exploitation.", "Conclusions": "The CVE-2024-4033 is a critical vulnerability that requires immediate attention and action."}}