{"id": "CVE-2024-42057", "sourceIdentifier": "security@zyxel.com.tw", "published": "2024-09-03T02:15:04.213", "lastModified": "2024-09-05T14:40:39.073", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A command injection vulnerability in the IPSec VPN feature of Zyxel ATP series firmware versions from V4.32 through V5.38, USG FLEX series firmware versions from V4.50 through V5.38, USG FLEX 50(W) series firmware versions from V4.16 through V5.38, and USG20(W)-VPN series firmware versions from V4.16 through V5.38 could allow an unauthenticated attacker to execute some OS commands on an affected device by sending a crafted username to the vulnerable device. Note that this attack could be successful only if the device was configured in User-Based-PSK authentication mode and a valid user with a long username exceeding 28 characters exists."}, {"lang": "es", "value": "Una vulnerabilidad de inyecci\u00f3n de comandos en la funci\u00f3n IPSec VPN de las versiones de firmware de la serie Zyxel ATP desde la V4.32 hasta la V5.38, las versiones de firmware de la serie USG FLEX desde la V4.50 hasta la V5.38, las versiones de firmware de la serie USG FLEX 50(W) desde la V4.16 hasta la V5.38 y las versiones de firmware de la serie USG20(W)-VPN desde la V4.16 hasta la V5.38 podr\u00eda permitir que un atacante no autenticado ejecute algunos comandos del sistema operativo en un dispositivo afectado mediante el env\u00edo de un nombre de usuario manipulado al dispositivo vulnerable. Tenga en cuenta que este ataque podr\u00eda tener \u00e9xito solo si el dispositivo se configur\u00f3 en modo de autenticaci\u00f3n User-Based-PSK y existe un usuario v\u00e1lido con un nombre de usuario largo que supere los 28 caracteres."}], "metrics": {"cvssMetricV31": [{"source": "security@zyxel.com.tw", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@zyxel.com.tw", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:zyxel:zld_firmware:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.32", "versionEndExcluding": "5.39", "matchCriteriaId": "EAE9D73B-62CC-419D-8FDF-3BD7B84F5636"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:atp100:-:*:*:*:*:*:*:*", "matchCriteriaId": "7F7654A1-3806-41C7-82D4-46B0CD7EE53B"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:atp100w:-:*:*:*:*:*:*:*", "matchCriteriaId": "47398FD0-6C5E-4625-9EFD-DE08C9AB7DB2"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:atp200:-:*:*:*:*:*:*:*", "matchCriteriaId": "D68A36FF-8CAF-401C-9F18-94F3A2405CF4"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:atp500:-:*:*:*:*:*:*:*", "matchCriteriaId": "2818E8AC-FFEE-4DF9-BF3F-C75166C0E851"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:atp700:-:*:*:*:*:*:*:*", "matchCriteriaId": "0B41F437-855B-4490-8011-DF59887BE6D5"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:atp800:-:*:*:*:*:*:*:*", "matchCriteriaId": "66B99746-0589-46E6-9CBD-F38619AD97DC"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:zyxel:zld_firmware:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.50", "versionEndExcluding": "5.39", "matchCriteriaId": "C96951B7-DDC3-4DF2-B349-C9AB1BEF9045"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_100:-:*:*:*:*:*:*:*", "matchCriteriaId": "2B30A4C0-9928-46AD-9210-C25656FB43FB"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_100ax:-:*:*:*:*:*:*:*", "matchCriteriaId": "03036815-04AE-4E39-8310-DA19A32CFA48"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_100w:-:*:*:*:*:*:*:*", "matchCriteriaId": "D74ABA7E-AA78-4A13-A64E-C44021591B42"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_200:-:*:*:*:*:*:*:*", "matchCriteriaId": "F93B6A06-2951-46D2-A7E1-103D7318D612"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_50:-:*:*:*:*:*:*:*", "matchCriteriaId": "646C1F07-B553-47B0-953B-DC7DE7FD0F8B"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_500:-:*:*:*:*:*:*:*", "matchCriteriaId": "92C697A5-D1D3-4FF0-9C43-D27B18181958"}, {"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_700:-:*:*:*:*:*:*:*", "matchCriteriaId": "9D1396E3-731B-4D05-A3F8-F3ABB80D5C29"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:zyxel:zld_firmware:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.16", "versionEndExcluding": "5.39", "matchCriteriaId": "668B88CE-7DCB-4EA7-81B9-1BE3DAB8E2E5"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_flex_50w:-:*:*:*:*:*:*:*", "matchCriteriaId": "110A1CA4-0170-4834-8281-0A3E14FC5584"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:zyxel:zld_firmware:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.16", "versionEndExcluding": "5.39", "matchCriteriaId": "668B88CE-7DCB-4EA7-81B9-1BE3DAB8E2E5"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:zyxel:usg_20w-vpn:-:*:*:*:*:*:*:*", "matchCriteriaId": "6BEA412F-3DA1-4E91-9C74-0666147DABCE"}]}]}], "references": [{"url": "https://www.zyxel.com/global/en/support/security-advisories/zyxel-security-advisory-for-multiple-vulnerabilities-in-firewalls-09-03-2024", "source": "security@zyxel.com.tw", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210:Exploit Public-Facing Application", "comment": "CVE-2024-42057 - This is a command injection vulnerability within an IPSec VPN. An attacker can manipulate a crafted username to execute OS commands on an affected device, making it a potential exploit for public-facing applications."}, {"techniqueID": "T1086:Read File and Directories", "comment": "CVE-2024-42057 - An attacker can leverage this command injection vulnerability to read sensitive files and directories on an affected device, potentially leading to sensitive data disclosure."}, {"techniqueID": "T1059:Command Injection", "comment": "CVE-2024-42057 - This is a classic command injection vulnerability that allows an attacker to inject custom commands, making it a potential tool for executing malicious actions on an affected device."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "i-1", "name": "Vulnerable IPSec VPN", "description": "IPSec VPN with vulnerable firmware versions", "pattern": "cpe:2.3:o:zyxel:zld_firmware:*:*:*:*:*:*:*:*", "created_by_ref": "c:\\path\\to\\creator"}, {"type": "indicator", "id": "i-2", "name": "Affected Devices", "description": "Devices running vulnerable firmware versions", "pattern": "cpe:2.3:o:zyxel:*:*:*:*:*:*:*", "created_by_ref": "c:\\path\\to\\creator"}, {"type": "course-of-action", "id": "coa-1", "name": "Update Firmware", "description": "Update IPSec VPN firmware to a non-vulnerable version", "related_object_ref": "i-1"}, {"type": "course-of-action", "id": "coa-2", "name": "Disable IPSec VPN", "description": "Disable IPSec VPN to prevent exploitation", "related_object_ref": "i-2"}, {"type": "note", "id": "n-1", "name": "Defense Against Command Injection", "description": "Use input validation and sanitization to prevent command injection attacks", "related_object_ref": "i-1"}], "relationships": [{"id": "rel-1", "source_ref": "i-1", "target_ref": "coa-1", "type": "x-discovered-by"}, {"id": "rel-2", "source_ref": "i-2", "target_ref": "coa-2", "type": "x-discovered-by"}, {"id": "rel-3", "source_ref": "i-1", "target_ref": "n-1", "type": "x-part-of"}]}, "technical_analysis": {"Introduction": "The vulnerability CVE-2024-42057 is a command injection vulnerability within the IPSec VPN feature of certain Zyxel firmware versions.", "Impact and Scope": "The vulnerability affects devices running vulnerable firmware versions, allowing an attacker to execute arbitrary commands on the affected device. The CVSS score is 8.1, with an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1210, T1086, and T1059.", "Technical Details": "The vulnerability occurs due to insufficient input validation on the affected device. An attacker can manipulate a crafted username to execute OS commands on the affected device.", "Detection": "Detection methods include monitoring device logs for suspicious command execution and monitoring network traffic for signs of command injection attacks.", "Mitigation": "Mitigation strategies include updating firmware to a non-vulnerable version, disabling IPSec VPN, and implementing input validation and sanitization to prevent command injection attacks.", "Conclusion": "The vulnerability CVE-2024-42057 is a critical vulnerability that can lead to significant data breaches and system compromise. It is essential to take immediate action to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The vulnerability CVE-2024-42057 is a critical command injection vulnerability within the IPSec VPN feature of certain Zyxel firmware versions.", "Business Impact": "The vulnerability can lead to significant data breaches and system compromise, resulting in reputational damage and financial loss.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary commands on the affected device, potentially leading to sensitive data disclosure and system compromise.", "Mitigation Strategies": "Immediate action is required to update firmware to a non-vulnerable version, disable IPSec VPN, and implement input validation and sanitization to prevent command injection attacks.", "Recommendations": "Executives should recommend immediate action to remediate this vulnerability and ensure that all affected devices are updated with the latest firmware version.", "Conclusions": "The vulnerability CVE-2024-42057 is a critical vulnerability that requires immediate attention and remediation to prevent significant data breaches and system compromise."}}