{"id": "CVE-2024-40627", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-15T20:15:05.033", "lastModified": "2024-07-16T13:43:58.773", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Fastapi OPA is an opensource fastapi middleware which includes auth flow. HTTP `OPTIONS` requests are always allowed by `OpaMiddleware`, even when they lack authentication, and are passed through directly to the application. `OpaMiddleware` allows all HTTP `OPTIONS` requests without evaluating it against any policy. If an application provides different responses to HTTP `OPTIONS` requests based on an entity existing (such as to indicate whether an entity is writable on a system level), an unauthenticated attacker could discover which entities exist within an application. This issue has been addressed in release version 2.0.1. All users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Fastapi OPA es un middleware fastapi de c\u00f3digo abierto que incluye flujo de autenticaci\u00f3n. Las solicitudes HTTP `OPCIONES` siempre son permitidas por `OpaMiddleware`, incluso cuando carecen de autenticaci\u00f3n, y se pasan directamente a la aplicaci\u00f3n. `OpaMiddleware` permite todas las solicitudes HTTP de `OPCIONES` sin evaluarlas con respecto a ninguna pol\u00edtica. Si una aplicaci\u00f3n proporciona diferentes respuestas a las solicitudes HTTP \"OPCIONES\" basadas en una entidad existente (por ejemplo, para indicar si se puede escribir en una entidad a nivel del sistema), un atacante no autenticado podr\u00eda descubrir qu\u00e9 entidades existen dentro de una aplicaci\u00f3n. Este problema se solucion\u00f3 en la versi\u00f3n 2.0.1. Se recomienda a todos los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-204"}]}], "references": [{"url": "https://github.com/busykoala/fastapi-opa/blob/6dd6f8c87e908fe080784a74707f016f1422b58a/fastapi_opa/opa/opa_middleware.py#L79-L80", "source": "security-advisories@github.com"}, {"url": "https://github.com/busykoala/fastapi-opa/commit/9588109ff651f7ffc92687129c4956126443fb8c", "source": "security-advisories@github.com"}, {"url": "https://github.com/busykoala/fastapi-opa/security/advisories/GHSA-5f5c-8rvc-j8wf", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1059.005", "comment": "CVE-2024-40627 - HTTP Options Enumeration to discover entities in the system without authentication"}, {"techniqueID": "T1128.004", "comment": "CVE-2024-40627 - Inadequate Certificate Verification in Fastapi OPA could allow an attacker to spoof a certificate"}], "technical_analysis": {"Introduction": "Fastapi OPA's OpaMiddleware allows all HTTP OPTIONS requests without evaluating them against any policy, allowing an unauthenticated attacker to discover entities in the system.", "Impact and Scope": "This vulnerability has a CVSS score of 5.8 with a version of 3.1, attack vector of NETWORK, and can have a Low confidentiality impact.", "Related MITRE ATT&CK Techniques": "T1059.005 - HTTP Options Enumeration and T1128.004 - Inadequate Certificate Verification", "Technical Details": "Fastapi OPA's OpaMiddleware allows all HTTP OPTIONS requests without evaluating them against any policy, allowing an unauthenticated attacker to discover entities in the system.", "Detection": "Monitor HTTP OPTIONS requests and identify requests that are not authenticated.", "Mitigation": "Upgrade to version 2.0.1 or implement additional authentication checks.", "Conclusion": "This vulnerability highlights the importance of proper authentication checks in Fastapi OPA."}, "executive_analysis": {"Overview": "Fastapi OPA's OpaMiddleware vulnerability allows an unauthenticated attacker to discover entities in the system.", "Business Impact": "This vulnerability could allow an attacker to discover sensitive information and potentially disrupt business operations.", "Technical Impact": "This vulnerability requires an attacker to have network access to the system and exploit the vulnerability.", "Mitigation Strategies": "Upgrade to version 2.0.1 or implement additional authentication checks.", "Recommendations": "Executives should ensure that their organization prioritizes the mitigation of this vulnerability.", "Conclusions": "This vulnerability highlights the importance of proper authentication checks in Fastapi OPA and the need for regular security updates."}}