{"id": "CVE-2024-40430", "sourceIdentifier": "cve@mitre.org", "published": "2024-07-22T07:15:02.207", "lastModified": "2024-08-02T05:15:40.473", "vulnStatus": "Modified", "cveTags": [{"sourceIdentifier": "cve@mitre.org", "tags": ["disputed"]}], "descriptions": [{"lang": "en", "value": "In SFTPGO 2.6.2, the JWT implementation lacks certain security measures, such as using JWT ID (JTI) claims, nonces, and proper expiration and invalidation mechanisms. NOTE: The vendor argues that the prerequisite for this exploit is to be able to steal another user's cookie. Additionally, it is argued that SFTPGo validates cookies being used by the IP address it was issued to, so stolen cookies from different IP addresses will not work."}, {"lang": "es", "value": "En SFTPGO 2.6.2, la implementaci\u00f3n de JWT carece de ciertas medidas de seguridad, como el uso de reclamos de JWT ID (JTI), nonces y mecanismos adecuados de caducidad e invalidaci\u00f3n."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.6}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-639"}]}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-639"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sftpgo_project:sftpgo:2.6.2:*:*:*:*:*:*:*", "matchCriteriaId": "4D7B3817-DF8C-4DC3-AAEF-306552248D56"}]}]}], "references": [{"url": "https://alexsecurity.rocks/posts/cve-2024-40430/", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/github/advisory-database/pull/4645", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1134", "comment": "CVE-2024-40430 - The vulnerability allows unauthenticated users to steal JWT tokens, which can be used to gain unauthorized access to the system. This can be mitigated by implementing proper JWT security measures."}, {"techniqueID": "T1027", "comment": "CVE-2024-40430 - The vulnerability allows an attacker to steal cookies from other users, which can be used to gain unauthorized access to the system. This can be mitigated by implementing proper cookie validation measures."}, {"techniqueID": "T1102", "comment": "CVE-2024-40430 - The vulnerability allows an attacker to inject arbitrary JWT tokens, which can be used to gain unauthorized access to the system. This can be mitigated by implementing proper JWT validation measures."}], "stix_bundle": {"type": "bundle", "objects": [{"type": "vulnerability", "id": "vuln-CVE-2024-40430", "description": "CVE-2024-40430 - Unauthenticated JWT token stealing vulnerability in SFTPGO 2.6.2", "references": [{"type": "report", "id": "rd-CVE-2024-40430", "title": "CVE-2024-40430 - SFTPGO 2.6.2 JWT Token Stealing Vulnerability", "description": "This report discusses the vulnerability CVE-2024-40430 and its potential impact on SFTPGO 2.6.2", "published": "2024-07-22T07:15:02.207", "updated": "2024-08-02T05:15:40.473"}], "cvss": {"vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N", "version": "3.1", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "weaknesses": [{"type": "weakness", "id": "w-CWE-639", "description": "CWE-639 - Weakness in JWT Token Implementation", "refs": [{"type": "report", "id": "rd-CWE-639", "title": "CWE-639 - Weakness in JWT Token Implementation", "description": "This report discusses the weakness CWE-639 and its potential impact on JWT token implementations", "published": "2024-07-22T07:15:02.207", "updated": "2024-08-02T05:15:40.473"}]}], "attributedTo": {"type": "identity", "id": "id-CVE-2024-40430", "name": "CVE-2024-40430", "description": "CVE-2024-40430 - SFTPGO 2.6.2 JWT Token Stealing Vulnerability"}, "relatedToOne": {"type": "identity", "id": "id-SFTPGO", "name": "SFTPGO", "description": "SFTPGO 2.6.2 - JWT Token Stealing Vulnerability"}, "contains": [{"type": "indicator", "id": "intr-1", "description": "Indicator of Compromise: JWT token stealing vulnerability in SFTPGO 2.6.2", "pattern": ".*"}, {"type": "indicator", "id": "intr-2", "description": "Indicator of Compromise: Cookie validation bypass vulnerability in SFTPGO 2.6.2", "pattern": ".*"}]}, {"type": "course-of-action", "id": "coa-CVE-2024-40430", "description": "Course of Action: Remediate SFTPGO 2.6.2 to fix the JWT token stealing vulnerability", "target": {"type": "vulnerability", "id": "vuln-CVE-2024-40430", "description": "CVE-2024-40430 - Unauthenticated JWT token stealing vulnerability in SFTPGO 2.6.2"}, "mitigatedBy": {"type": "technique", "id": "T1134", "description": "Technique: Validate JWT tokens to prevent token stealing"}}, {"type": "course-of-action", "id": "coa-CVE-2024-40430", "description": "Course of Action: Monitor for indicators of compromise related to the JWT token stealing vulnerability", "target": {"type": "indicator", "id": "intr-1", "description": "Indicator of Compromise: JWT token stealing vulnerability in SFTPGO 2.6.2"}, "mitigatedBy": {"type": "technique", "id": "T1027", "description": "Technique: Monitor for suspicious cookie activity"}}]}, "technical_analysis": {"Introduction": "The vulnerability CVE-2024-40430 is a JWT token stealing vulnerability in SFTPGO 2.6.2, which can be exploited by an unauthenticated attacker to gain unauthorized access to the system.", "Impact and Scope": "The vulnerability has a CVSS score of 5.3, with a high confidentiality impact and a medium severity rating.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK Techniques T1134 and T1027.", "Technical Details": "The vulnerability occurs when SFTPGO 2.6.2 fails to implement proper security measures for JWT tokens, allowing an unauthenticated attacker to steal tokens and gain unauthorized access.", "Detection": "Detection methods include monitoring for indicators of compromise related to the vulnerability.", "Mitigation": "Mitigation strategies include validating JWT tokens to prevent token stealing and monitoring for suspicious cookie activity.", "Conclusion": "In conclusion, the vulnerability CVE-2024-40430 is a significant security risk that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The vulnerability CVE-2024-40430 is a JWT token stealing vulnerability in SFTPGO 2.6.2 that can be exploited by an unauthenticated attacker to gain unauthorized access to the system.", "Business Impact": "The vulnerability has significant business implications, including potential data breaches and unauthorized access to sensitive information.", "Technical Impact": "The vulnerability has technical implications, including the potential for unauthorized access to the system and the possibility of data breaches.", "Mitigation Strategies": "Mitigation strategies include validating JWT tokens to prevent token stealing and monitoring for suspicious cookie activity.", "Recommendations": "Recommended actions include implementing proper security measures for JWT tokens and monitoring for indicators of compromise related to the vulnerability.", "Conclusions": "In conclusion, the vulnerability CVE-2024-40430 is a serious security risk that requires immediate attention and remediation."}}