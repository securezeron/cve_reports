{"id": "CVE-2024-41157", "sourceIdentifier": "scy@openharmony.io", "published": "2024-09-02T05:15:16.740", "lastModified": "2024-09-04T16:30:40.737", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "in OpenHarmony v4.1.0 and prior versions allow a local attacker cause the common permission is upgraded to root and sensitive information leak through use after free."}, {"lang": "es", "value": "en OpenHarmony v4.1.0 y versiones anteriores se permite que un atacante local haga que el permiso com\u00fan se actualice a superusuario y se filtre informaci\u00f3n confidencial mediante use after free. "}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}, {"source": "scy@openharmony.io", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.0, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-416"}]}, {"source": "scy@openharmony.io", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-416"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:openatom:openharmony:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0", "versionEndIncluding": "4.1", "matchCriteriaId": "DB1039E0-0E86-40F4-96FB-52DC3384E36C"}]}]}], "references": [{"url": "https://gitee.com/openharmony/security/blob/master/zh/security-disclosure/2024/2024-09.md", "source": "scy@openharmony.io", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1083", "comment": "CVE-2024-41157 - Use of Use-After-Free vulnerability in OpenHarmony for privilege escalation and sensitive information leak. This vulnerability can be exploited through use-after-free to upgrade the common permission to root and leak sensitive information."}, {"techniqueID": "T1190", "comment": "CVE-2024-41157 - Use of Local Privilege Escalation vulnerability in OpenHarmony to upgrade common permission to root. This can be used to escalate privileges and increase attack surface."}, {"techniqueID": "T1556.001", "comment": "CVE-2024-41157 - Use of Local File Inclusion vulnerability in OpenHarmony to include arbitrary files. This can be used to bypass security restrictions and execute malicious code."}, {"techniqueID": "T1210", "comment": "CVE-2024-41157 - Use of Information Leaks from Use-After-Free vulnerability in OpenHarmony to gather sensitive information. This can be used to gather information about the system and its users."}], "technical_analysis": {"Introduction": "CVE-2024-41157 is a Use-After-Free vulnerability in OpenHarmony that allows local attackers to upgrade the common permission to root and leak sensitive information. This vulnerability is a critical issue that requires immediate attention and mitigation.", "Impact and Scope": "The vulnerability affects versions 4.0 and prior of OpenHarmony. It has a CVSS score of 7.8 with an attack vector of LOCAL. The vulnerability can be exploited through use-after-free to upgrade the common permission to root and leak sensitive information. The scope of the vulnerability is LOCAL, meaning it only affects systems with direct access to the vulnerable code.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1083, T1190, T1556.001, and T1210. These techniques can be used to exploit the vulnerability and gain unauthorized access to the system.", "Technical Details": "The vulnerability occurs because of a use-after-free error in the vulnerable code. This error allows an attacker to access and modify memory locations that are no longer allocated, leading to a situation where the attacker can upgrade the common permission to root and leak sensitive information.", "Detection": "The vulnerability can be detected using various security tools and techniques, including code reviews, penetration testing, and vulnerability scanners.", "Mitigation": "The mitigation for this vulnerability is to patch the affected versions of OpenHarmony. Additionally, users should ensure that they are running the latest version of OpenHarmony and are implementing secure coding practices to prevent similar vulnerabilities.", "Conclusion": "CVE-2024-41157 is a critical vulnerability that requires immediate attention and mitigation. Users should ensure that they are running the latest version of OpenHarmony and are implementing secure coding practices to prevent similar vulnerabilities."}, "executive_analysis": {"Overview": "CVE-2024-41157 is a critical vulnerability in OpenHarmony that affects versions 4.0 and prior. It allows local attackers to upgrade the common permission to root and leak sensitive information.", "Business Impact": "The vulnerability can have significant business impact if left unmitigated. It can lead to unauthorized access to sensitive information and system compromise, resulting in financial loss, reputational damage, and compliance issues.", "Technical Impact": "The vulnerability can have significant technical impact if left unmitigated. It can lead to system compromise, data breaches, and unauthorized access to sensitive information.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability are to patch the affected versions of OpenHarmony and implement secure coding practices to prevent similar vulnerabilities.", "Recommendations": "We recommend that executives prioritize the mitigation of this vulnerability and ensure that their organization is taking necessary measures to prevent similar vulnerabilities.", "Conclusions": "CVE-2024-41157 is a critical vulnerability that requires immediate attention and mitigation. We recommend that executives prioritize the mitigation of this vulnerability and ensure that their organization is taking necessary measures to prevent similar vulnerabilities."}}