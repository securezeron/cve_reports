{"id": "CVE-2020-13151", "sourceIdentifier": "cve@mitre.org", "published": "2020-08-05T13:15:10.603", "lastModified": "2023-01-28T02:30:41.777", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Aerospike Community Edition 4.9.0.5 allows for unauthenticated submission and execution of user-defined functions (UDFs), written in Lua, as part of a database query. It attempts to restrict code execution by disabling os.execute() calls, but this is insufficient. Anyone with network access can use a crafted UDF to execute arbitrary OS commands on all nodes of the cluster at the permission level of the user running the Aerospike service."}, {"lang": "es", "value": "Aerospike Community Edition versi\u00f3n 4.9.0.5, permite el env\u00edo y la ejecuci\u00f3n no autenticada de funciones definidas por el usuario (UDF), escritas en Lua, como parte de una consulta de base de datos. Intenta restringir la ejecuci\u00f3n del c\u00f3digo al deshabilitar las llamadas a la funci\u00f3n os.execute(), pero esto es insuficiente. Cualquier persona con acceso a la red puede utilizar una UDF dise\u00f1ada para ejecutar comandos arbitrarios de Sistema Operativo en todos los nodos del cl\u00faster en el nivel de permiso del usuario que ejecuta el servicio de Aerospike"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:aerospike:aerospike_server:*:*:*:*:community:*:*:*", "versionEndExcluding": "4.5.3.21", "matchCriteriaId": "DDD39672-A99B-418B-B1F0-D4A7140B6B87"}, {"vulnerable": true, "criteria": "cpe:2.3:a:aerospike:aerospike_server:*:*:*:*:community:*:*:*", "versionStartIncluding": "4.6.0.1", "versionEndExcluding": "4.6.0.19", "matchCriteriaId": "318A7CDD-9791-45CC-9F17-24A81D48D6C5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:aerospike:aerospike_server:*:*:*:*:community:*:*:*", "versionStartIncluding": "4.7.0.1", "versionEndExcluding": "4.7.0.17", "matchCriteriaId": "AD4254DC-DD44-468D-A71C-ACD54AA33F32"}, {"vulnerable": true, "criteria": "cpe:2.3:a:aerospike:aerospike_server:*:*:*:*:community:*:*:*", "versionStartIncluding": "4.8.0.1", "versionEndExcluding": "4.8.0.13", "matchCriteriaId": "A90BBE74-9DC4-4AA4-97F8-6FCC227F733D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:aerospike:aerospike_server:*:*:*:*:community:*:*:*", "versionStartIncluding": "4.9.0.1", "versionEndExcluding": "4.9.0.10", "matchCriteriaId": "C23279C2-82B4-4614-8FDC-EFDC6D9E3637"}, {"vulnerable": true, "criteria": "cpe:2.3:a:aerospike:aerospike_server:*:*:*:*:community:*:*:*", "versionStartIncluding": "5.0.0.1", "versionEndExcluding": "5.0.0.7", "matchCriteriaId": "CD99C634-6C21-4CC0-99B9-71F122789F33"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/160106/Aerospike-Database-5.1.0.3-Remote-Command-Execution.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://packetstormsecurity.com/files/160451/Aerospike-Database-UDF-Lua-Code-Execution.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://b4ny4n.github.io/network-pentest/2020/08/01/cve-2020-13151-poc-aerospike.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://www.aerospike.com/docs/operations/configure/security/access-control/index.html#create-users-and-assign-roles", "source": "cve@mitre.org", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "https://www.aerospike.com/download/server/notes.html#5.1.0.3", "source": "cve@mitre.org", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "https://www.aerospike.com/enterprise/download/server/notes.html#5.1.0.3", "source": "cve@mitre.org", "tags": ["Release Notes", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-13151 - This is a remote command execution vulnerability in Aerospike Community Edition, which could allow attackers to execute arbitrary OS commands. Defend against this by restricting access to the Aerospike server and implementing strong authentication and authorization mechanisms."}, {"techniqueID": "T1047", "comment": "CVE-2020-13151 - This vulnerability can be exploited using a crafted UDF in Lua, which allows an attacker to execute arbitrary OS commands. Monitor for suspicious network traffic and implement a web application firewall to prevent exploitation."}, {"techniqueID": "T1204", "comment": "CVE-2020-13151 - This vulnerability can be used to execute arbitrary OS commands, which can lead to data modification, destruction, or leakage. Implement strong access controls and conduct regular security audits to prevent exploitation."}], "stix_bundle": {"type": "bundle", "stix_2_1": true, "objects": [{"id": "vulnerability-aerospike-cve-2020-13151", "type": "vulnerability", "properties": {"name": "CVE-2020-13151: Aerospike Community Edition Remote Command Execution Vulnerability", "description": "A remote command execution vulnerability in Aerospike Community Edition allows attackers to execute arbitrary OS commands.", "published": "2020-08-05T13:15:10.603", "modified": "2023-01-28T02:30:41.777"}}, {"id": "aerospike-server-cpe-vendor", "type": "vendor", "properties": {"name": "Aerospike", "description": "Aerospike is a distributed NoSQL database.", "products": [{"id": "aerospike-server", "type": "product", "properties": {"name": "Aerospike Server"}}]}}, {"id": "cve-2020-13151-impact", "type": "impact", "properties": {"type": "impact", "description": "The vulnerability can be used to execute arbitrary OS commands, which can lead to data modification, destruction, or leakage."}}, {"id": "cve-2020-13151-exploit", "type": "exploit", "properties": {"type": "exploit", "description": "The vulnerability can be exploited using a crafted UDF in Lua.", "techniques": ["T1190", "T1047", "T1204"]}}, {"id": "cve-2020-13151-mitigation", "type": "mitigation", "properties": {"type": "mitigation", "description": "Defend against this vulnerability by restricting access to the Aerospike server and implementing strong authentication and authorization mechanisms."}}], "relationships": [{"id": "vulnerability-aerospike-cve-2020-13151", "type": "has_impact", "from": "vulnerability-aerospike-cve-2020-13151", "to": "cve-2020-13151-impact"}, {"id": "cve-2020-13151-exploit", "type": "uses_technique", "from": "cve-2020-13151-exploit", "to": ["T1190", "T1047", "T1204"]}, {"id": "cve-2020-13151-mitigation", "type": "countermeasure", "from": "cve-2020-13151-mitigation", "to": "vulnerability-aerospike-cve-2020-13151"}]}, "technical_analysis": {"Introduction": "The CVE-2020-13151 is a remote command execution vulnerability in Aerospike Community Edition, which can be exploited using a crafted UDF in Lua.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and can be used to execute arbitrary OS commands, which can lead to data modification, destruction, or leakage.", "Related MITRE ATT&CK Techniques": "The vulnerability can be used to execute MITRE ATT&CK techniques T1190, T1047, and T1204.", "Technical Details": "The vulnerability occurs when a crafted UDF in Lua is submitted and executed by the Aerospike server.", "Detection": "Monitor for suspicious network traffic and implement a web application firewall to prevent exploitation.", "Mitigation": "Defend against this vulnerability by restricting access to the Aerospike server and implementing strong authentication and authorization mechanisms.", "Conclusion": "The CVE-2020-13151 is a critical vulnerability that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The CVE-2020-13151 is a remote command execution vulnerability in Aerospike Community Edition, which can be used to execute arbitrary OS commands.", "Business Impact": "The vulnerability can lead to data modification, destruction, or leakage, which can result in business disruption and reputation loss.", "Technical Impact": "The vulnerability can be used to execute MITRE ATT&CK techniques T1190, T1047, and T1204, which can lead to data modification, destruction, or leakage.", "Mitigation Strategies": "Implement strong access controls, restrict access to the Aerospike server, and conduct regular security audits.", "Recommendations": "Update to a patched version of Aerospike Community Edition, restrict access to the Aerospike server, and conduct regular security audits.", "Conclusions": "The CVE-2020-13151 is a critical vulnerability that requires immediate attention and remediation."}}