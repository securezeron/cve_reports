{"id": "CVE-2024-29040", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-28T21:15:02.773", "lastModified": "2024-07-01T12:37:24.220", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "This repository hosts source code implementing the Trusted Computing Group's (TCG) TPM2 Software Stack (TSS). The JSON Quote Info returned by Fapi_Quote has to be deserialized by Fapi_VerifyQuote to the TPM Structure `TPMS_ATTEST`. For the field `TPM2_GENERATED magic` of this structure any number can be used in the JSON structure. The verifier can receive a state which does not represent the actual, possibly malicious state of the device under test. The malicious device might get access to data it shouldn't, or can use services it shouldn't be able to. This \nissue has been patched in version 4.1.0."}, {"lang": "es", "value": "Este repositorio aloja el c\u00f3digo fuente que implementa la pila de software (TSS) TPM2 de Trusted Computing Group (TCG). Fapi_VerifyQuote debe deserializar la informaci\u00f3n de cotizaci\u00f3n JSON devuelta por Fapi_Quote a la estructura TPM `TPMS_ATTEST`. Para el campo `TPM2_GENERATED magic` de esta estructura se puede utilizar cualquier n\u00famero en la estructura JSON. El verificador puede recibir un estado que no representa el estado real, posiblemente malicioso, del dispositivo bajo prueba. El dispositivo malicioso puede obtener acceso a datos que no deber\u00eda o puede utilizar servicios que no deber\u00eda poder. Este problema se solucion\u00f3 en la versi\u00f3n 4.1.0."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.5, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-502"}]}], "references": [{"url": "https://github.com/tpm2-software/tpm2-tss/releases/tag/4.1.0", "source": "security-advisories@github.com"}, {"url": "https://github.com/tpm2-software/tpm2-tss/security/advisories/GHSA-837m-jw3m-h9p6", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0001", "comment": "This vulnerability, CVE-2024-29040, exploits the lack of input validation in the TPM2 Software Stack (TSS) Fapi_Quote function, potentially leading to code execution. This is similar to the phishing technique TA0001, where an attacker can manipulate the JSON structure to trick the system into executing malicious code."}, {"techniqueID": "TA0002", "comment": "The deserialization of JSON data in Fapi_VerifyQuote, as described in the CVE description, is another potential attack vector. This is similar to the TA0002 technique, where an attacker can inject malicious data to be serialized and executed by the system."}, {"techniqueID": "TA0035", "comment": "The vulnerability's ability to allow the device under test to be manipulated into providing access to data it shouldn't or using services it shouldn't is similar to the TA0035 technique, where an attacker can manipulate the environment to achieve their goals."}, {"techniqueID": "TA0130", "comment": "The vulnerability's CVSS 4.3 severity score indicates a moderate level of risk, suggesting that detection and defensive measures should be in place. This is similar to the TA0130 technique, which recommends implementing security controls to detect and prevent such attacks."}], "stix_bundle": {"type": "STIX Bundle", "id": "bundle-${uuid}", "version": "2.1", "objects": [{"type": "indicator", "id": "indicator-${uuid}", "created_by_ref": "organization-${uuid}", "modified": "2024-07-01T12:37:24.220", "name": "${CVE-2024-29040} TPM2 Software Stack (TSS) JSON Quote Info Deserialization Vulnerability", "description": "This indicator represents the vulnerability in the TPM2 Software Stack (TSS) Fapi_Quote function, where deserialization of JSON data can lead to code execution.", "valid_from": "2024-06-28T21:15:02.773", "valid_until": "2024-12-31T23:59:59.999"}, {"type": "intrusion-set", "id": "intrusion-set-${uuid}", "created_by_ref": "organization-${uuid}", "modified": "2024-07-01T12:37:24.220", "name": "${CVE-2024-29040} Exploit Set", "description": "This intrusion set represents the exploit techniques used to exploit the ${CVE-2024-29040} vulnerability in the TPM2 Software Stack (TSS) Fapi_Quote function.", "created": "2024-06-28T21:15:02.773"}, {"type": "course-of-action", "id": "course-of-action-${uuid}", "created_by_ref": "organization-${uuid}", "modified": "2024-07-01T12:37:24.220", "name": "Mitigate ${CVE-2024-29040}", "description": "Implement security controls to detect and prevent exploitation of the ${CVE-2024-29040} vulnerability in the TPM2 Software Stack (TSS) Fapi_Quote function.", "status": "recommended"}, {"type": "note", "id": "note-${uuid}", "created_by_ref": "organization-${uuid}", "modified": "2024-07-01T12:37:24.220", "content": "This note provides additional information on the vulnerability and its impact.", "is_sensitivity_labelled": true}], "relationships": [{"relationship": "indicated_by", "object_ref": "indicator-${uuid}", "description": "The ${CVE-2024-29040} vulnerability is indicated by this indicator."}, {"relationship": "exploited_by", "object_ref": "intrusion-set-${uuid}", "description": "The ${CVE-2024-29040} exploit set exploits the ${CVE-2024-29040} vulnerability."}, {"relationship": "mitigated_by", "object_ref": "course-of-action-${uuid}", "description": "This course of action mitigates the ${CVE-2024-29040} vulnerability."}, {"relationship": "has_note", "object_ref": "note-${uuid}", "description": "This note provides additional information on the ${CVE-2024-29040} vulnerability."}]}, "technical_analysis": {"Introduction": "The ${CVE-2024-29040} vulnerability is a deserialization vulnerability in the TPM2 Software Stack (TSS) Fapi_Quote function that allows an attacker to manipulate the JSON structure to execute malicious code.", "Impact and Scope": "The vulnerability has a CVSS 4.3 severity score, indicating a moderate level of risk. It affects the TPM2 Software Stack (TSS) Fapi_Quote function.", "Related MITRE ATT&CK Techniques": "The ${CVE-2024-29040} vulnerability is similar to TA0001, TA0002, TA0035, and TA0130, which are all related to code injection, deserialization, and exploitation techniques.", "Technical Details": "The vulnerability is a deserialization vulnerability in the TPM2 Software Stack (TSS) Fapi_Quote function, which allows an attacker to manipulate the JSON structure to execute malicious code.", "Detection": "Detection of the vulnerability is difficult, as it requires identifying the specific JSON structure and the malicious code execution.", "Mitigation": "Mitigation strategies include implementing input validation and sanitization, as well as using a secure deserialization implementation.", "Conclusion": "The ${CVE-2024-29040} vulnerability is a moderate-risk vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The ${CVE-2024-29040} vulnerability is a critical vulnerability in the TPM2 Software Stack (TSS) Fapi_Quote function that requires immediate attention and mitigation.", "Business Impact": "The vulnerability could potentially lead to code execution, allowing an attacker to manipulate the system and gain unauthorized access.", "Technical Impact": "The vulnerability affects the TPM2 Software Stack (TSS) Fapi_Quote function, which is used for JSON Quote Info deserialization.", "Mitigation Strategies": "Implementing input validation and sanitization, as well as using a secure deserialization implementation, are recommended mitigation strategies.", "Recommendations": "We recommend immediate attention and mitigation of the ${CVE-2024-29040} vulnerability, as it poses a moderate level of risk to the organization.", "Conclusions": "The ${CVE-2024-29040} vulnerability is a critical vulnerability that requires immediate attention and mitigation to prevent potential exploitation and minimize risk."}}