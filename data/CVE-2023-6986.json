{"id": "CVE-2023-6986", "sourceIdentifier": "security@wordfence.com", "published": "2024-01-03T07:15:07.483", "lastModified": "2024-01-10T16:52:07.623", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The EmbedPress \u2013 Embed PDF, YouTube, Google Docs, Vimeo, Wistia Videos, Audios, Maps & Any Documents in Gutenberg & Elementor plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's embed_oembed_html shortcode in all versions up to 3.9.5 (exclusive) due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers with contributor-level and above permissions to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page."}, {"lang": "es", "value": "EmbedPress \u2013 Embed PDF, YouTube, Google Docs, Vimeo, Wistia Videos, Audios, Maps &amp; Any Documents in Gutenberg &amp; Elementor plugin for WordPress es vulnerable a cross site scripting almacenado a trav\u00e9s del c\u00f3digo corto embed_oembed_html del complemento en todas las versiones hasta la 3.9.5 (exclusivo) debido a una sanitizaci\u00f3n insuficiente de las entradas y a que la salida se escape en los atributos proporcionados por el usuario. Esto hace posible que atacantes autenticados con permisos de nivel de colaborador y superiores inyecten scripts web arbitrarios en p\u00e1ginas que se ejecutar\u00e1n cada vez que un usuario acceda a una p\u00e1gina inyectada."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.1, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:wpdeveloper:embedpress:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "3.9.6", "matchCriteriaId": "E7BEAE5C-2F3F-485A-AA00-B676D7B111B3"}]}]}], "references": [{"url": "https://plugins.svn.wordpress.org/embedpress/trunk/EmbedPress/Shortcode.php", "source": "security@wordfence.com", "tags": ["Product"]}, {"url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3014595%40embedpress&new=3014595%40embedpress&sfp_email=&sfph_mail=#file11", "source": "security@wordfence.com", "tags": ["Patch"]}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/ceae0115-268c-401b-876b-3477d10c10e6?source=cve", "source": "security@wordfence.com", "tags": ["Patch", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059: Command and Control", "comment": "CVE-2023-6986 - This technique is relevant as it involves attackers compromising systems to control and command. The stored cross-site scripting vulnerability makes it possible for attackers to inject malicious web scripts, which can be used to launch further attacks."}, {"techniqueID": "T1190: Exploitation of Remote Services", "comment": "CVE-2023-6986 - This technique is relevant as it involves the exploitation of remote services. The EmbedPress bug allows attackers to inject arbitrary web scripts, which can be used to exploit other vulnerabilities in the system."}, {"techniqueID": "T1568: Dynamic Link Library Injection", "comment": "CVE-2023-6986 - This technique is relevant as it involves the injection of dynamic link libraries. The embedded scripts can be used to inject malicious DLLs, which can be used to launch further attacks."}, {"techniqueID": "T1020: Web Shell", "comment": "CVE-2023-6986 - This technique is relevant as it involves the creation and use of web shells. The vulnerable embed_oembed_html shortcode can be used to inject web shells, which can be used to further compromise the system."}], "stix_bundle": {"type": "bundle", "id": "CVE-2023-6986-Bundle", "generated_by": {"name": "MITRE ATT&CK"}, "created_by_ref": "", "created": "2024-02-01T10:00:00Z", "modified": "2024-02-01T10:00:00Z", "lang": "en", "objects": [{"type": "vulnerability", "id": "CVE-2023-6986", "created_by_ref": "", "created": "2024-02-01T10:00:00Z", "modified": "2024-02-01T10:00:00Z", "description": [{"lang": "en", "value": "The EmbedPress - Embed PDF, YouTube, Google Docs, Vimeo, Wistia Videos, Audios, Maps & Any Documents in Gutenberg & Elementor plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's embed_oembed_html shortcode in all versions up to 3.9.5 (exclusive) due to insufficient input sanitization and output escaping on user supplied attributes."}], "x_mitre_descriptor": {"type": "vulnerability", "description": [{"lang": "en", "value": "The EmbedPress - Embed PDF, YouTube, Google Docs, Vimeo, Wistia Videos, Audios, Maps & Any Documents in Gutenberg & Elementor plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's embed_oembed_html shortcode in all versions up to 3.9.5 (exclusive) due to insufficient input sanitization and output escaping on user supplied attributes."}]}, "pivot_ref": "", "pivot": [{"type": "indicator", "id": "CWE-79", "pattern": "CVE-2023-6986"}], "relationship": {"type": "related", "id": "related-ref", "from": "CVE-2023-6986", "to": "CWE-79", "relationship_type": "is Related To"}}, {"type": "attack-pattern", "id": "Stored Cross-Site Scripting", "created_by_ref": "", "created": "2024-02-01T10:00:00Z", "modified": "2024-02-01T10:00:00Z", "description": [{"lang": "en", "value": "An attack pattern where an attacker inserts malicious code into a dynamic content area, such as a web-based Forms Autocomplete Dropdown."}]}]}, "technical_analysis": {"Introduction": "The vulnerability in EmbedPress allows attackers to inject malicious web scripts, which can be used to launch further attacks.", "Impact and Scope": "CVSS score: 5.4 (CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N) - The vulnerability affects all versions up to 3.9.5 (exclusive) of the EmbedPress plugin for WordPress.", "Related MITRE ATT&CK Techniques": "Techniques T1059: Command and Control, T1190: Exploitation of Remote Services, T1568: Dynamic Link Library Injection, and T1020: Web Shell", "Technical Details": "The vulnerability is caused by insufficient input sanitization and output escaping on user-supplied attributes in the embed_oembed_html shortcode.", "Detection": "Detection methods include monitoring for unusual traffic patterns and verifying system logs for evidence of malicious activity.", "Mitigation": "Mitigation strategies include updating to the latest version of the EmbedPress plugin, disabling the embed_oembed_html shortcode, and implementing web application firewalls.", "Conclusion": "In conclusion, the vulnerability in EmbedPress highlights the importance of proper input sanitization and output escaping in web applications."}, "executive_analysis": {"Overview": "The vulnerability in EmbedPress allows attackers to inject malicious web scripts, which can be used to launch further attacks.", "Business Impact": "The vulnerability has the potential to compromise sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability affects all versions up to 3.9.5 (exclusive) of the EmbedPress plugin for WordPress.", "Mitigation Strategies": "Updating to the latest version of the EmbedPress plugin, disabling the embed_oembed_html shortcode, and implementing web application firewalls.", "Recommendations": "It is recommended that all users update to the latest version of the EmbedPress plugin and disable the embed_oembed_html shortcode.", "Conclusions": "In conclusion, the vulnerability in EmbedPress requires immediate attention to minimize the risk of compromise."}}