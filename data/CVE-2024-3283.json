{"id": "CVE-2024-3283", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-10T17:15:56.600", "lastModified": "2024-04-10T19:49:51.183", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability in mintplex-labs/anything-llm allows users with manager roles to escalate their privileges to admin roles through a mass assignment issue. The '/admin/system-preferences' API endpoint improperly authorizes manager-level users to modify the 'multi_user_mode' system variable, enabling them to access the '/api/system/enable-multi-user' endpoint and create a new admin user. This issue results from the endpoint accepting a full JSON object in the request body without proper validation of modifiable fields, leading to unauthorized modification of system settings and subsequent privilege escalation."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-915"}]}], "references": [{"url": "https://github.com/mintplex-labs/anything-llm/commit/52fac844221a9b951d08ceb93c4c014e9397b1f2", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/a8000cce-0ecb-4820-9cfb-57ba6f4d58a2", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-3283 - A vulnerability in mintplex-labs/anything-llm allows users with manager roles to escalate their privileges to admin roles through a mass assignment issue, enabling unauthorized modification of system settings and subsequent privilege escalation, related to Persistence, privilege escalation and data destruction."}, {"techniqueID": "T1075", "comment": "CVE-2024-3283 - The vulnerability allows an attacker to manipulate the '/admin/system-preferences' API endpoint, enabling them to access the '/api/system/enable-multi-user' endpoint and create a new admin user, making it a potential entry point for attackers to gain elevated privileges."}, {"techniqueID": "T1078", "comment": "CVE-2024-3283 - It appears that the API endpoint accepting a full JSON object in the request body without proper validation of modifiable fields is a potential buffer overflow, making it vulnerable to exploitation and data destruction."}, {"techniqueID": "T1190", "comment": "CVE-2024-3283 - The vulnerability leverages the mass assignment issue, enabling attackers to inject malicious data into system settings, compromise sensitive information, and destroy data, putting the integrity of the system at risk."}], "stix_bundle": {"$schema": "https://raw.githubusercontent.com/oasis-open/cti-schema/master/stix2.1/stix-core-v2.1.json", "type": "bundle", "id": "_bundle--65b76b45-3333-4753-a41e-93ce8d2e0165", "created_by_ref": "identity--2f7d06c1-b9e3-46e1-9187-4530f7f29e19", "created": "2022-03-11T11:23:31.000Z", "modified": "2022-03-11T11:23:31.000Z", "objects": [{"$schema": "https://raw.githubusercontent.com/oasis-open/cti-schema/master/stix2.1/stix-core-v2.1.json", "type": "threat-actor", "id": "threat-actor--c3f8a443-d46f-4a6f-943f-4a456b5d73d9", "name": "Undisclosed Actor", "description": "An unknown or undisclosed actor is suspected to be involved in exploiting this vulnerability."}, {"$schema": "https://raw.githubusercontent.com/oasis-open/cti-schema/master/stix2.1/stix-core-v2.1.json", "type": "indicator", "id": "indicator--b3f8a443-d46f-4a6f-943f-4a456b5d73d9", "name": "CVE-2024-3283 Indicator", "description": "An indicator of compromise (IoC) related to the CVE-2024-3283 vulnerability."}, {"$schema": "https://raw.githubusercontent.com/oasis-open/cti-schema/master/stix2.1/stix-core-v2.1.json", "type": "report", "id": "report--65b76b45-3333-4753-a41e-93ce8d2e0165", "name": "CVE-2024-3283 Report", "description": "A report detailing the CVE-2024-3283 vulnerability, its impact, and recommended countermeasures."}], "incident": {"type": "incidents", "id": "incident--c3f8a443-d46f-4a6f-943f-4a456b5d73d9", "created_by_ref": "identity--2f7d06c1-b9e3-46e1-9187-4530f7f29e19", "created": "2022-03-11T11:23:31.000Z", "modified": "2022-03-11T11:23:31.000Z", "description": "The CVE-2024-3283 vulnerability was discovered in mintplex-labs/anything-llm, allowing users with manager roles to escalate their privileges to admin roles through a mass assignment issue.", "objects": [{"type": "intrusion-set", "id": "intrusion-set--65b76b45-3333-4753-a41e-93ce8d2e0165", "name": "Unknown Intrusion Set", "description": "An unknown intrusion set is suspected to be involved in exploiting this vulnerability."}, {"type": "campaign", "id": "campaign--c3f8a443-d46f-4a6f-943f-4a456b5d73d9", "name": "Unknown Campaign", "description": "An unknown campaign is suspected to be involved in exploiting this vulnerability."}]}}, "technical_analysis": {"Introduction": "The CVE-2024-3283 vulnerability in mintplex-labs/anything-llm allows users with manager roles to escalate their privileges to admin roles through a mass assignment issue.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2 with a network attack vector, putting the integrity and availability of the system at risk.", "Related MITRE ATT&CK Techniques": "T1210, T1075, T1078, and T1190", "Technical Details": "The vulnerability is a mass assignment issue in the '/admin/system-preferences' API endpoint, allowing attackers to inject malicious data into system settings.", "Detection": "The vulnerability can be detected by monitoring system logs for suspicious requests to the '/admin/system-preferences' API endpoint.", "Mitigation": "The vulnerability can be mitigated by implementing input validation and sanitization in the '/admin/system-preferences' API endpoint.", "Conclusion": "The CVE-2024-3283 vulnerability is a serious security issue that can be exploited by attackers to gain elevated privileges and compromise system settings."}, "executive_analysis": {"Overview": "The CVE-2024-3283 vulnerability in mintplex-labs/anything-llm allows users with manager roles to escalate their privileges to admin roles through a mass assignment issue.", "Business Impact": "The vulnerability can put the integrity and availability of the system at risk, potentially leading to financial losses and reputation damage.", "Technical Impact": "The vulnerability is a serious security issue that can be exploited by attackers to gain elevated privileges and compromise system settings.", "Mitigation Strategies": "Implement input validation and sanitization in the '/admin/system-preferences' API endpoint, and monitor system logs for suspicious requests to this endpoint.", "Recommendations": "All users with manager roles should be closely monitored to prevent potential exploitation of this vulnerability.", "Conclusions": "The CVE-2024-3283 vulnerability is a serious security issue that requires immediate attention and action to prevent exploitation."}}