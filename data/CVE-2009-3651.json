{"id": "CVE-2009-3651", "sourceIdentifier": "cve@mitre.org", "published": "2009-10-09T14:30:00.500", "lastModified": "2017-08-17T01:31:13.600", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in the \"Monitor browsers' feature in Browscap before 5.x-1.1 and 6.x-1.1, a module for Drupal, allows remote attackers to inject arbitrary web script or HTML via the User-Agent HTTP header."}, {"lang": "es", "value": "Una vulnerabilidad de ejecuci\u00f3n de secuencias de comandos en sitios cruzados (XSS) en la opci\u00f3n \"Monitor Browsers\" del m\u00f3dulo de Drupal \"Browscap\" antes de v5.x-1.1 y v6.x-1.1, permite a atacantes remotos inyectar HTML o scripts web a trav\u00e9s de la cabecera HTTP User-Agent."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mikeryan:browscap:*:*:*:*:*:*:*:*", "versionEndIncluding": "5.x-1.0", "matchCriteriaId": "EA279A02-7B75-4616-9084-E184B1D9BE63"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mikeryan:browscap:4.7.x-1.x-dev:*:*:*:*:*:*:*", "matchCriteriaId": "B1BD11BA-AB45-4741-B4C1-B03178862400"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mikeryan:browscap:5.x-1.x-dev:*:*:*:*:*:*:*", "matchCriteriaId": "EC919445-9754-4AEE-98E5-490D52B0CE96"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mikeryan:browscap:6.x-1.0:*:*:*:*:*:*:*", "matchCriteriaId": "BBE23509-BD29-4659-AC28-3BA78F029698"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mikeryan:browscap:6.x-1.x-dev:*:*:*:*:*:*:*", "matchCriteriaId": "3F49DB0A-E41D-4322-ABE2-2FD7D4AA9E55"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:a:drupal:drupal:*:*:*:*:*:*:*:*", "matchCriteriaId": "799CA80B-F3FA-4183-A791-2071A7DA1E54"}]}]}], "references": [{"url": "http://drupal.org/node/592262", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://drupal.org/node/592264", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://drupal.org/node/592272", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://osvdb.org/58444", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://secunia.com/advisories/36912", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/36557", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/53571", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2009-3651 - This is an example of a Cross-Site Scripting (XSS) vulnerability. An attacker may inject malicious scripts into the user's browser, allowing for session hijacking, data theft, and other types of attacks. This can be detected using web application firewalls (WAFs) and intrusion detection systems (IDS) that monitor for suspicious traffic patterns."}, {"techniqueID": "T1075", "comment": "CVE-2009-3651 - Another technique that can be used to exploit this vulnerability is by injecting malicious code into the User-Agent HTTP header. This can be detected by monitoring for unusual traffic patterns and utilizing host-based intrusion detection systems (HIDS) to identify and block suspicious activity."}], "stix_bundle": {"type": "bundle", "ID": "CVE-2009-3651-STIX-Bundle", "created_by_ref": "https://example.com/stix", "modified": "2021-05-15T14:30:00.000Z", "packages": [{"type": "vulnerability", "id": "CVE-2009-3651", "created_by_ref": "https://example.com/stix", "modified": "2021-05-15T14:30:00.000Z", "name": "Cross-Site Scripting (XSS) in Browscap module", "description": "A cross-site scripting (XSS) vulnerability in the Browscap module for Drupal allows remote attackers to inject arbitrary web script or HTML via the User-Agent HTTP header.", "CVSS": {"vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9}, "references": [{"type": "reference", "id": "http://drupal.org/node/592262", "source_name": "Drupal"}, {"type": "reference", "id": "http://osvdb.org/58444", "source_name": "OSVDB"}], "mitigations": [{"type": "mitigation", "id": "update-browscap", "description": "Update to version 6.x-1.1 or later", "notes": "This should be done to remediate the vulnerability"}]}], "indicator": [{"type": "indicator", "id": "xss-browscap", "created_by_ref": "https://example.com/stix", "modified": "2021-05-15T14:30:00.000Z", "name": "XSS in Browscap module", "description": "Detects requests with suspicious User-Agent HTTP headers", "pattern": "regex:/User-Agent:.+/", "analyst_notes": "This indicator should be used to detect and prevent XSS attacks"}]}, "technical_analysis": {"Introduction": "The CVE-2009-3651 vulnerability is a cross-site scripting (XSS) vulnerability in the Browscap module for Drupal. It allows an attacker to inject arbitrary web script or HTML via the User-Agent HTTP header.", "Impact and Scope": "The impact of this vulnerability is that an attacker can inject malicious scripts into the user's browser, allowing for session hijacking, data theft, and other types of attacks. The scope of this vulnerability is limited to the Browscap module, but the impact can be significant.", "Related MITRE ATT&CK Techniques": "T1059 Cross-Site Scripting and T1075 Input Validation", "Technical Details": "The vulnerability is caused by the Browscap module not properly sanitizing the User-Agent HTTP header, allowing an attacker to inject malicious scripts. This can be exploited by injecting malicious code into the User-Agent header.", "Detection": "The vulnerability can be detected by monitoring for suspicious traffic patterns and utilizing host-based intrusion detection systems (HIDS) to identify and block suspicious activity.", "Mitigation": "The vulnerability can be mitigated by updating to version 6.x-1.1 or later and implementing web application firewalls (WAFs) and intrusion detection systems (IDS).", "Conclusion": "The CVE-2009-3651 vulnerability is a significant risk and should be addressed promptly."}, "executive_analysis": {"Overview": "The CVE-2009-3651 vulnerability is a cross-site scripting vulnerability in the Browscap module for Drupal that allows an attacker to inject malicious scripts into the user's browser.", "Business Impact": "The impact of this vulnerability is significant, as it allows an attacker to inject malicious scripts into the user's browser, allowing for session hijacking, data theft, and other types of attacks.", "Technical Impact": "The technical impact of this vulnerability is that it allows an attacker to inject malicious scripts into the user's browser, allowing for session hijacking, data theft, and other types of attacks.", "Mitigation Strategies": "The recommended mitigation strategy is to update to version 6.x-1.1 or later and implement web application firewalls (WAFs) and intrusion detection systems (IDS).", "Recommendations": "Recommendations for executives include updating to the latest version of the Browscap module, implementing web application firewalls (WAFs) and intrusion detection systems (IDS), and monitoring for suspicious traffic patterns.", "Conclusions": "In conclusion, the CVE-2009-3651 vulnerability is a significant risk and should be addressed promptly."}}