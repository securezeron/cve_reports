{"id": "CVE-2024-7856", "sourceIdentifier": "security@wordfence.com", "published": "2024-08-29T11:15:29.173", "lastModified": "2024-08-29T13:25:27.537", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The MP3 Audio Player \u2013 Music Player, Podcast Player & Radio by Sonaar plugin for WordPress is vulnerable to unauthorized arbitrary file deletion due to a missing capability check on the removeTempFiles() function and insufficient path validation on the 'file' parameter in all versions up to, and including, 5.7.0.1. This makes it possible for authenticated attackers, with subscriber-level access and above, to delete arbitrary files which can make remote code execution possible when wp-config.php is deleted."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "security@wordfence.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-862"}]}], "references": [{"url": "https://plugins.trac.wordpress.org/browser/mp3-music-player-by-sonaar/tags/5.7.0.1/includes/class-sonaar-music.php#L739", "source": "security@wordfence.com"}, {"url": "https://plugins.trac.wordpress.org/browser/mp3-music-player-by-sonaar/tags/5.7.0.1/includes/class-sonaar-music.php#L755", "source": "security@wordfence.com"}, {"url": "https://plugins.trac.wordpress.org/changeset/3142445/mp3-music-player-by-sonaar/trunk/includes/class-sonaar-music.php", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/43adc9dd-1780-440f-90c2-ff05a22eb084?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1222", "comment": "CVE-2024-7856 - Insufficient path validation on 'file' parameter allows authenticated attackers to delete arbitrary files, making remote code execution possible when wp-config.php is deleted."}, {"techniqueID": "T1027", "comment": "CVE-2024-7856 - Missing capability check on removeTempFiles() function allows authenticated attackers to delete arbitrary files, making remote code execution possible when wp-config.php is deleted."}, {"techniqueID": "T1190", "comment": "CVE-2024-7856 - Attackers can leverage the vulnerability to gain unauthorized access and execute arbitrary code, making it a potential entry point for further attacks."}], "stix_bundle": {"bundle": {"type": "Bundle", "id": "b2f5de35-16e2-46a4-8b6c-c8a16cd3a6ca", "created_by_ref": "f5be8da6-5ce6-4d34-ac01-5d2a0447d36c", "modified": "2024-08-29T13:25:27.537", "objects": [{"type": "Vulnerability", "id": "vuln-1", "created_by_ref": "f5be8da6-5ce6-4d34-ac01-5d2a0447d36c", "description": "The MP3 Audio Player \u2013 Music Player, Podcast Player & Radio by Sonaar plugin for WordPress is vulnerable to unauthorized arbitrary file deletion due to a missing capability check on the removeTempFiles() function and insufficient path validation on the 'file' parameter in all versions up to, and including, 5.7.0.1.", "cvss": {"vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H"}, "metrics": {"cvssMetricV31": [{"score": 9.1, "severity": "CRITICAL"}]}}, {"type": "mitigate", "id": "coa-1", "created_by_ref": "f5be8da6-5ce6-4d34-ac01-5d2a0447d36c", "title": "Update MP3 Audio Player \u2013 Music Player, Podcast Player & Radio by Sonaar plugin to version 5.7.0.1 or later", "description": "Update the MP3 Audio Player \u2013 Music Player, Podcast Player & Radio by Sonaar plugin to version 5.7.0.1 or later to remediate the vulnerability.", "note": "This course of action mitigates the vulnerability by addressing the missing capability check on the removeTempFiles() function and insufficient path validation on the 'file' parameter.", "related_object": {"type": "Vulnerability", "ref_id": "vuln-1"}}, {"type": "detect", "id": "coa-2", "created_by_ref": "f5be8da6-5ce6-4d34-ac01-5d2a0447d36c", "title": "Monitor log files for unauthorized file deletion attempts", "description": "Monitor log files for unauthorized file deletion attempts, including those made by the removeTempFiles() function, to detect potential exploitation of the vulnerability.", "note": "This course of action detects potential exploitation of the vulnerability by monitoring log files for unauthorized file deletion attempts.", "related_object": {"type": "Vulnerability", "ref_id": "vuln-1"}}], "relationship": [{"type": "related-to", "id": "rel-1", "from": {"type": "Vulnerability", "ref_id": "vuln-1"}, "to": {"type": "Course-of-Action", "ref_id": "coa-1"}, "relationship_type": "mitigates"}, {"type": "related-to", "id": "rel-2", "from": {"type": "Vulnerability", "ref_id": "vuln-1"}, "to": {"type": "Course-of-Action", "ref_id": "coa-2"}, "relationship_type": "detects"}]}}, "technical_analysis": {"Introduction": "The MP3 Audio Player \u2013 Music Player, Podcast Player & Radio by Sonaar plugin for WordPress is vulnerable to unauthorized arbitrary file deletion due to a missing capability check on the removeTempFiles() function and insufficient path validation on the 'file' parameter.", "Impact and Scope": "The vulnerability allows authenticated attackers to delete arbitrary files, making remote code execution possible when wp-config.php is deleted. The impact is high, with a CVSS score of 9.1.", "Related MITRE ATT&CK Techniques": "T1222, T1027, T1190", "Technical Details": "The vulnerability is caused by a missing capability check on the removeTempFiles() function and insufficient path validation on the 'file' parameter. This allows attackers to delete arbitrary files, making remote code execution possible when wp-config.php is deleted.", "Detection": "Monitor log files for unauthorized file deletion attempts, including those made by the removeTempFiles() function.", "Mitigation": "Update the MP3 Audio Player \u2013 Music Player, Podcast Player & Radio by Sonaar plugin to version 5.7.0.1 or later, and monitor log files for unauthorized file deletion attempts.", "Conclusion": "The vulnerability is critical and requires immediate attention. Updating the plugin and monitoring log files can help remediate the issue."}, "executive_analysis": {"Overview": "The MP3 Audio Player \u2013 Music Player, Podcast Player & Radio by Sonaar plugin for WordPress is vulnerable to unauthorized arbitrary file deletion due to a missing capability check on the removeTempFiles() function and insufficient path validation on the 'file' parameter.", "Business Impact": "The vulnerability can allow attackers to delete arbitrary files, making remote code execution possible when wp-config.php is deleted. This can lead to data loss, system downtime, and reputation damage.", "Technical Impact": "The vulnerability can allow attackers to execute arbitrary code, which can be used to gain unauthorized access to sensitive data and systems.", "Mitigation Strategies": "Update the MP3 Audio Player \u2013 Music Player, Podcast Player & Radio by Sonaar plugin to version 5.7.0.1 or later, and monitor log files for unauthorized file deletion attempts.", "Recommendations": "Immediately update the plugin and monitor log files for unauthorized file deletion attempts. Implement additional security measures, such as intrusion detection and prevention systems, to detect and block potential exploitation of the vulnerability.", "Conclusions": "The vulnerability is critical and requires immediate attention. Updating the plugin and monitoring log files can help remediate the issue. Additional security measures should be implemented to detect and block potential exploitation of the vulnerability."}}