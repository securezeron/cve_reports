{"id": "CVE-2020-7014", "sourceIdentifier": "bressers@elastic.co", "published": "2020-06-03T18:15:23.043", "lastModified": "2020-06-19T11:15:10.337", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The fix for CVE-2020-7009 was found to be incomplete. Elasticsearch versions from 6.7.0 to 6.8.7 and 7.0.0 to 7.6.1 contain a privilege escalation flaw if an attacker is able to create API keys and also authentication tokens. An attacker who is able to generate an API key and an authentication token can perform a series of steps that result in an authentication token being generated with elevated privileges."}, {"lang": "es", "value": "Se encontr\u00f3 que la soluci\u00f3n para CVE-2020-7009 estaba incompleta. Elasticsearch versiones desde 6.7.0 hasta 6.8.7 y 7.0.0 hasta 7.6.1, contienen un fallo de escalada de privilegios si un atacante puede crear claves de la API y tambi\u00e9n tokens de autenticaci\u00f3n. Un atacante que puede generar una clave de la API y un token de autenticaci\u00f3n puede llevar a cabo una serie de pasos que resultan en que un token de autenticaci\u00f3n se genere con privilegios elevados."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-269"}]}, {"source": "bressers@elastic.co", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-266"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:elastic:elasticsearch:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7.0", "versionEndIncluding": "6.8.7", "matchCriteriaId": "FEA3F192-8348-43DA-8075-D4062E7D89AC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:elastic:elasticsearch:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.0.0", "versionEndIncluding": "7.6.1", "matchCriteriaId": "3628E8E8-502E-44FD-AF0E-E30A26B16D03"}]}]}], "references": [{"url": "https://security.netapp.com/advisory/ntap-20200619-0003/", "source": "bressers@elastic.co"}, {"url": "https://www.elastic.co/community/security/", "source": "bressers@elastic.co", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1078: Exploiting a Valid Credential", "comment": "CVE-2020-7014 - Elasticsearch versions from 6.7.0 to 6.8.7 and 7.0.0 to 7.6.1 contain a privilege escalation flaw. An attacker who is able to generate an API key and an authentication token can perform a series of steps that result in an authentication token being generated with elevated privileges."}, {"techniqueID": "T1134: Privilege Escalation", "comment": "CVE-2020-7014 - Elasticsearch versions from 6.7.0 to 6.8.7 and 7.0.0 to 7.6.1 contain a privilege escalation flaw. An attacker who is able to generate an API key and an authentication token can perform a series of steps that result in an authentication token being generated with elevated privileges."}, {"techniqueID": "T1505: System Network Configuration Discovery", "comment": "CVE-2020-7014 - Elasticsearch versions from 6.7.0 to 6.8.7 and 7.0.0 to 7.6.1 contain a privilege escalation flaw. An attacker who is able to generate an API key and an authentication token can perform a series of steps that result in an authentication token being generated with elevated privileges."}, {"techniqueID": "T1027: Obfuscated Files or Information", "comment": "CVE-2020-7014 - Elasticsearch versions from 6.7.0 to 6.8.7 and 7.0.0 to 7.6.1 contain a privilege escalation flaw. An attacker who is able to generate an API key and an authentication token can perform a series of steps that result in an authentication token being generated with elevated privileges."}], "technical_analysis": {"Introduction": "CVE-2020-7014 is a privilege escalation vulnerability in Elasticsearch that allows an attacker to generate an authentication token with elevated privileges. This vulnerability affects versions 6.7.0 to 6.8.7 and 7.0.0 to 7.6.1.", "Impact and Scope": "This vulnerability has a CVSS score of 8.8 and is categorized as HIGH severity. The attack vector is NETWORK.", "Related MITRE ATT&CK Techniques": "CVE-2020-7014 is related to the following MITRE ATT&CK techniques: T1078, T1134, T1505, T1027.", "Technical Details": "The vulnerability occurs when an attacker is able to create API keys and authentication tokens. By performing a series of steps, the attacker can generate an authentication token with elevated privileges.", "Detection": "Detection of this vulnerability can be done by monitoring API key and authentication token creation, as well as monitoring for unauthorized access to Elasticsearch.", "Mitigation": "Mitigation of this vulnerability can be done by applying the patches provided by Elasticsearch, as well as by implementing secure authentication and authorization mechanisms.", "Conclusion": "CVE-2020-7014 is a critical vulnerability that allows an attacker to escalate privileges. It is essential to apply the patches and implement secure authentication and authorization mechanisms to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2020-7014 is a critical vulnerability in Elasticsearch that allows an attacker to escalate privileges and gain unauthorized access to sensitive data.", "Business Impact": "This vulnerability has significant business implications, including data compromise, financial loss, and reputational damage.", "Technical Impact": "This vulnerability has significant technical implications, including the potential for unauthorized access to sensitive data and systems.", "Mitigation Strategies": "To mitigate this vulnerability, it is essential to apply the patches provided by Elasticsearch and implement secure authentication and authorization mechanisms.", "Recommendations": "Executives should prioritize the patching of vulnerability and implementation of secure authentication and authorization mechanisms to prevent exploitation.", "Conclusions": "CVE-2020-7014 is a critical vulnerability that requires immediate attention and action to prevent exploitation."}}