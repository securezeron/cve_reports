{"id": "CVE-2024-35221", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-29T21:15:49.017", "lastModified": "2024-05-30T13:15:41.297", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Rubygems.org is the Ruby community's gem hosting service. A Gem publisher can cause a Remote DoS when publishing a Gem. This is due to how Ruby reads the Manifest of Gem files when using Gem::Specification.from_yaml. from_yaml makes use of SafeYAML.load which allows YAML aliases inside the YAML-based metadata of a gem. YAML aliases allow for Denial of Service attacks with so-called `YAML-bombs` (comparable to Billion laughs attacks). This was patched. There is is no action required by users. This issue is also tracked as GHSL-2024-001 and was discovered by the GitHub security lab."}, {"lang": "es", "value": "Rubygems.org es el servicio de alojamiento de gemas de la comunidad Ruby. Un editor de gemas puede provocar un DoS remoto al publicar una gema. Esto se debe a c\u00f3mo Ruby lee los archivos Manifiesto de Gem cuando usa Gem::Specification.from_yaml. from_yaml utiliza SafeYAML.load, que permite alias YAML dentro de los metadatos basados en YAML de una gema. Los alias YAML permiten ataques de denegaci\u00f3n de servicio con las llamadas \"bombas YAML\" (comparables a los ataques de mil millones de risas). Esto fue parcheado. No se requiere ninguna acci\u00f3n por parte de los usuarios. Este problema tambi\u00e9n se rastrea como GHSL-2024-001 y fue descubierto por el laboratorio de seguridad de GitHub."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-400"}]}], "references": [{"url": "https://en.wikipedia.org/wiki/Billion_laughs_attack", "source": "security-advisories@github.com"}, {"url": "https://github.com/ruby/ruby/blob/7cf74a2ff28b1b4c26e367d0d67521f7e1fed239/lib/rubygems/safe_yaml.rb#L28", "source": "security-advisories@github.com"}, {"url": "https://github.com/rubygems/rubygems.org/security/advisories/GHSA-4vc5-whwr-7hh2", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-35221 - Denial of Service attack using YAML aliases, Exploitation of YAML aliasing to cause a denial of service, Abuse of YAML specification to consume system resources."}, {"techniqueID": "T1204", "comment": "CVE-2024-35221 - User input used to commit a denial of service, User input used to cause a denial of service, Data is written in a way that causes excessive process consumption."}, {"techniqueID": "T1210", "comment": "CVE-2024-35221 - User interaction with a malicious actor is required to commit the denial of service, User interaction with a malicious actor is required to cause a denial of service, The attack requires the victim to perform some action."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "objects": [{"type": "vulnerability", "id": "vulnerability--2257e4a2-b3c8-4ed1-a159-86e4a3f32f44", "name": "Rubygems.org YAML Denial of Service", "description": {"lang": "en", "value": "CVE-2024-35221 - Rubygems.org is the Ruby community's gem hosting service. A Gem publisher can cause a Remote DoS when publishing a Gem."}, "short_description": "Rubygems.org YAML Denial of Service", "published": "2024-05-29T21:15:49.017", "modified": "2024-05-30T13:15:41.297", "vuln_status": "Awaiting Analysis", "cve_tags": [], "references": [{"url": "https://en.wikipedia.org/wiki/Billion_laughs_attack", "source": "security-advisories@github.com"}, {"url": "https://github.com/ruby/ruby/blob/7cf74a2ff28b1b4c26e367d0d67521f7e1fed239/lib/rubygems/safe_yaml.rb#L28", "source": "security-advisories@github.com"}, {"url": "https://github.com/rubygems/rubygems.org/security/advisories/GHSA-4vc5-whwr-7hh2", "source": "security-advisories@github.com"}]}], " relationships": [{"relationship_type": "indicates", "source_ref": "vulnerability--2257e4a2-b3c8-4ed1-a159-86e4a3f32f44", "target_ref": "technique--a4f0f4b8-5e41-45b0-8d21-e4a3f32f40a3"}]}, "technical_analysis": {"Introduction": "CVE-2024-35221 is a Remote Denial of Service (DoS) vulnerability in Rubygems.org's Gem publishing feature.", "Impact and Scope": "The vulnerability has a CVSS score of 4.3 (MEDIUM) with an attack vector of NETWORK and attack complexity of LOW, it's a medium-severity vulnerability that can impact Rubygems.org users who publish gems on the platform.", "Related MITRE ATT&CK Techniques": "T1190, T1204, T1210", "Technical Details": "The vulnerability is due to how Ruby reads the Manifest of Gem files when using Gem::Specification.from_yaml. from_yaml makes use of SafeYAML.load which allows YAML aliases inside the YAML-based metadata of a gem.", "Detection": "Detection can be done by monitoring the Rubygems.org platform and its gem publishing feature for signs of excessive resource consumption.", "Mitigation": "Mitigation strategies include implementing YAML parsing limits on the Rubygems.org platform and monitoring gem publishing for abnormal resource consumption.", "Conclusion": "In conclusion, CVE-2024-35221 is a medium-severity vulnerability in Rubygems.org's Gem publishing feature that can cause a denial of service."}, "executive_analysis": {"Overview": "CVE-2024-35221 is a Remote Denial of Service vulnerability in Rubygems.org's Gem publishing feature.", "Business Impact": "This vulnerability can impact Rubygems.org users who publish gems on the platform and can cause a denial of service, which can lead to revenue loss and reputational damage.", "Technical Impact": "The vulnerability has a medium CVSS score, and it's a medium-severity vulnerability that requires user interaction with a malicious actor to cause a denial of service.", "Mitigation Strategies": "Rubygems.org should implement YAML parsing limits on the platform, and monitoring gem publishing for abnormal resource consumption should be enhanced.", "Recommendations": "Rubygems.org users should be aware of this vulnerability and implement proper security measures to prevent it.", "Conclusions": "In conclusion, Rubygems.org should patch this vulnerability as soon as possible to prevent a potential denial of service attack."}}