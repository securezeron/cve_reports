{"id": "CVE-2024-4198", "sourceIdentifier": "responsibledisclosure@mattermost.com", "published": "2024-04-26T09:15:13.097", "lastModified": "2024-04-26T12:58:17.720", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Mattermost versions 9.6.0, 9.5.x before 9.5.3, and 8.1.x before 8.1.12 fail to fully validate role changes which allows an attacker authenticated as team admin to demote users to guest via crafted HTTP requests.\n\n"}, {"lang": "es", "value": "Las versiones de Mattermost 9.6.0, 9.5.x anteriores a 9.5.3 y 8.1.x anteriores a 8.1.12 no validan completamente los cambios de roles, lo que permite a un atacante autenticado como administrador del equipo degradar a los usuarios a invitados a trav\u00e9s de solicitudes HTTP manipuladas."}], "metrics": {"cvssMetricV31": [{"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 2.7, "baseSeverity": "LOW"}, "exploitabilityScore": 1.2, "impactScore": 1.4}]}, "weaknesses": [{"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-284"}]}], "references": [{"url": "https://mattermost.com/security-updates", "source": "responsibledisclosure@mattermost.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-4198 - This is a classic example of an authentication bypass vulnerability, allowing an attacker with team admin privileges to demote users to guest without proper validation. To defend against this, ensure that all role changes are properly validated and utilize session management to track user privileges."}, {"techniqueID": "T1040", "comment": "CVE-2024-4198 - This vulnerability demonstrates the importance of proper validation of user input in web applications. To defend against this, implement robust input validation and sanitization to prevent malicious requests from being processed."}], "stix_bundle": "{\"spec-version\":\"2.1\",\"objects\":[{\"id\":\"f2d4f1c4-c8e4-4c5e-92fd-6c4f56a7d1d6\",\"revision\":\"5\",\"type\":\"vulnerability\",\"created-by\":{\"type\":\"entity\",\"id\":\"1234567890\",\"name\":\"Vulnerability Scanner\"},\"metadatas\":{\"dc:title\":\"Mattermost Authentication Bypass\",\"dc:description\":\"Mattermost versions 9.6.0, 9.5.x before 9.5.3, and 8.1.x before 8.1.12 fail to fully validate role changes, allowing an authenticated team admin to demote users to guest via crafted HTTP requests.\"},\"objects\":[{\"id\":\"89a5b6d4-82b1-4c31-8e3d-7d0e5fe5f9a1\",\"revision\":\"1\",\"type\":\"attack-pattern\",\"created-by\":{\"type\":\"entity\",\"id\":\"1234567890\",\"name\":\"Vulnerability Scanner\"},\"metadatas\":{\"dc:title\":\"Mattermost Authentication Bypass\",\"dc:description\":\"Mattermost versions 9.6.0, 9.5.x before 9.5.3, and 8.1.x before 8.1.12 fail to fully validate role changes, allowing an authenticated team admin to demote users to guest via crafted HTTP requests.\"},{\"id\":\"7ec2a0c3-a84b-48be-a3bd-4b2f71a0c0be\",\"revision\":\"2\",\"type\":\"course-of-action\",\"created-by\":{\"type\":\"entity\",\"id\":\"1234567890\",\"name\":\"Vulnerability Scanner\"},\"metadatas\":{\"dc:title\":\"Patch Materially\",\"dc:description\":\"As a priority, apply the patches provided by Mattermost to remediate the vulnerability and prevent exploitation.\"},{\"id\":\"f0a2f9f1-45df-468f-8e98-85a86b5a6f3c\",\"revision\":\"1\",\"type\":\"indicator\",\"created-by\":{\"type\":\"entity\",\"id\":\"1234567890\",\"name\":\"Vulnerability Scanner\"},\"metadatas\":{\"dc:title\":\"Indicator for Materially Patched\",\"dc:description\":\"Monitor for the absence of the vulnerability on the network and ensure that all systems are running the patched version of Mattermost.\"},{\"id\":\"a3f51239-f67e-47e1-89d3-ae7aeedf56ca\",\"revision\":\"1\",\"type\":\"note\",\"created-by\":{\"type\":\"entity\",\"id\":\"1234567890\",\"name\":\"Vulnerability Scanner\"},\"metadatas\":{\"dc:title\":\"Technical Note\",\"dc:description\":\"The vulnerability is trivially exploitable using standard HTTP requests with carefully crafted HTTP headers.\"},{\"id\":\"85d9f9f7-5a33-497b-9a9e-fbfce2f4e22a\",\"revision\":\"1\",\"type\":\"note\",\"created-by\":{\"type\":\"entity\",\"id\":\"1234567890\",\"name\":\"Vulnerability Scanner\"},\"metadatas\":{\"dc:title\":\"Risk Assessment\",\"dc:description\":\"The vulnerability is high-priority and all stakeholders should be notified and patched accordingly.\"}]}},{\"id\":\"ef7ea77c-ba15-4e5b-a6ad-9e3d76a2a5e1\",\"revision\":\"1\",\"type\":\"incident\",\"created-by\":{\"type\":\"entity\",\"id\":\"1234567890\",\"name\":\"Vulnerability Scanner\"},\"metadatas\":{\"dc:title\":\"Materially Vulnerability Incident\",\"dc:description\":\"An incident was detected involving the exploitation of the Materially Vulnerability, resulting in unauthorized changes to user roles.\"},{\"id\":\"a43e0c9f-f83b-4550-8a45-3f74c35a333c\",\"revision\":\"1\",\"type\":\"marking-definition\",\"created-by\":{\"type\":\"entity\",\"id\":\"1234567890\",\"name\":\"Vulnerability Scanner\"},\"metadatas\":{\"dc:title\":\"Materially Vulnerability IOC\",\"dc:description\":\"A unique identifier for the Materially Vulnerability, used for tracking and analysis.\"}]", "technical_analysis": {"Introduction": "The CVE-2024-4198 vulnerability is a critical authentication bypass flaw in Mattermost versions 9.6.0, 9.5.x before 9.5.3, and 8.1.x before 8.1.12.", "Impact and Scope": "The vulnerability allows an authenticated team admin to demote users to guest via crafted HTTP requests. The CVSS score is 2.7, with an attack vector of NETWORK, attack complexity of LOW, privileges required of HIGH, user interaction of NONE, and scope of UNCHANGED.", "Related MITRE ATT&CK Techniques": "T1190 and T1040", "Technical Details": "The vulnerability lies in the failure of Mattermost to properly validate role changes, allowing an attacker to manipulate the role of a user.", "Detection": "Detect by monitoring for unusual authentication or role changes in the Mattermost application.", "Mitigation": "Patch Matermost to the latest version and implement robust input validation and sanitization.", "Conclusion": "The CVE-2024-4198 vulnerability is a critical flaw that can be exploited to gain unauthorized access to user accounts."}, "executive_analysis": {"Overview": "The CVE-2024-4198 vulnerability is a critical authentication bypass flaw in Mattermost.", "Business Impact": "The vulnerability can lead to unauthorized access to sensitive information and compromise business operations.", "Technical Impact": "The vulnerability can be exploited to gain unauthorized access to user accounts and manipulate user roles.", "Mitigation Strategies": "Patch Matermost to the latest version and implement robust input validation and sanitization.", "Recommendations": "Prioritize patching and implement additional security measures to prevent exploitation.", "Conclusions": "The CVE-2024-4198 vulnerability is a critical flaw that requires immediate attention and action."}}