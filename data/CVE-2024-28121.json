{"id": "CVE-2024-28121", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-12T20:15:08.313", "lastModified": "2024-03-13T21:16:00.460", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "stimulus_reflex is a system to extend the capabilities of both Rails and Stimulus by intercepting user interactions and passing them to Rails over real-time websockets. In affected versions more methods than expected can be called on reflex instances. Being able to call some of them has security implications. To invoke a reflex a websocket message of the following shape is sent: `\\\"target\\\":\\\"[class_name]#[method_name]\\\",\\\"args\\\":[]`. The server will proceed to instantiate `reflex` using the provided `class_name` as long as it extends `StimulusReflex::Reflex`. It then attempts to call `method_name` on the instance with the provided arguments. This is problematic as `reflex.method method_name` can be more methods that those explicitly specified by the developer in their reflex class. A good example is the instance_variable_set method. This vulnerability has been patched in versions 3.4.2 and 3.5.0.rc4. Users unable to upgrade should: see the backing GHSA advisory for mitigation advice."}, {"lang": "es", "value": "stimulus_reflex es un sistema para ampliar las capacidades de Rails y Stimulus interceptando las interacciones del usuario y pas\u00e1ndolas a Rails a trav\u00e9s de websockets en tiempo real. En las versiones afectadas se pueden invocar m\u00e1s m\u00e9todos de los esperados en instancias reflejas. Poder llamar a algunos de ellos tiene implicaciones de seguridad. Para invocar un reflejo, se env\u00eda un mensaje websocket con la siguiente forma: `\\\"target\\\":\\\"[class_name]#[method_name]\\\",\\\"args\\\":[]`. El servidor proceder\u00e1 a crear una instancia de `reflex` utilizando el `class_name` proporcionado siempre que extienda `StimulusReflex::Reflex`. Luego intenta llamar a \"method_name\" en la instancia con los argumentos proporcionados. Esto es problem\u00e1tico ya que `reflex.method method_name` puede contener m\u00e1s m\u00e9todos que los especificados expl\u00edcitamente por el desarrollador en su clase refleja. Un buen ejemplo es el m\u00e9todo instance_variable_set. Esta vulnerabilidad ha sido parcheada en las versiones 3.4.2 y 3.5.0.rc4. Los usuarios que no puedan actualizar deben: consultar el aviso de respaldo de GHSA para obtener consejos de mitigaci\u00f3n."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-470"}]}], "references": [{"url": "http://seclists.org/fulldisclosure/2024/Mar/16", "source": "security-advisories@github.com"}, {"url": "https://github.com/stimulusreflex/stimulus_reflex/blob/0211cad7d60fe96838587f159d657e44cee51b9b/app/channels/stimulus_reflex/channel.rb#L83", "source": "security-advisories@github.com"}, {"url": "https://github.com/stimulusreflex/stimulus_reflex/commit/538582d240439aab76066c72335ea92096cd0c7f", "source": "security-advisories@github.com"}, {"url": "https://github.com/stimulusreflex/stimulus_reflex/releases/tag/v3.4.2", "source": "security-advisories@github.com"}, {"url": "https://github.com/stimulusreflex/stimulus_reflex/releases/tag/v3.5.0.rc4", "source": "security-advisories@github.com"}, {"url": "https://github.com/stimulusreflex/stimulus_reflex/security/advisories/GHSA-f78j-4w3g-4q65", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1059 - Command and Control", "comment": "CVE-2024-28121 - Unrestricted uploads via Rails WebSocket can allow an attacker to call arbitrary methods on injected reflex instances, enabling command and control functionality. Defend against this by validating WebSocket messages and ensuring only authorized requests are processed."}, {"techniqueID": "T1190 - Exploit Public-Facing Application", "comment": "CVE-2024-28121 - The vulnerability in stimulus_reflex can be exploited by sending a specific WebSocket message, making it a public-facing application vulnerability. Defend against this by implementing secure WebSocket implementations and validating user input."}, {"techniqueID": "T1568 - Defensive Counter Measures", "comment": "CVE-2024-28121 - Perform regular application security testing to identify vulnerabilities like stimulus_reflex and patch them promptly. Implement Web Application Firewalls (WAFs) and Intrusion Detection Systems (IDS) to detect and prevent exploit attempts."}], "stix_bundle": {"@type": "bundle", "description": "STIX 2.1 bundle for CVE-2024-28121", "objects": [{"@type": "vulnerability", "id": "CVE-2024-28121", "name": "stimulus_reflex Remote Code Execution Vulnerability", "description": "Unrestricted uploads via Rails WebSocket can allow an attacker to call arbitrary methods on injected reflex instances, enabling command and control functionality.", "severity": "HIGH", "impact": "HIGH", "probability": "MEDIUM", "risk_rating": 8.8, "published": "2024-03-12T20:15:08.313", "last_modified": "2024-03-13T21:16:00.460", "mitre_attack_ids": ["T1059", "T1190", "T1568"], "risk_categorization": {"threat_actor": "UNINFORMED", "tactics": ["DEFENSE EVASION", "COMMAND AND CONTROL"], "techniques": ["T1059", "T1190", "T1568"], "courses_of_action": [{"@type": "course-of-action", "title": "Patch stimulus_reflex", "description": "Update stimulus_reflex to patched version 3.4.2 or 3.5.0.rc4 to remediate the vulnerability.", "techniques": ["T1568"], "mitigations": ["Web Application Firewall (WAF)", "Intrusion Detection System (IDS)"]}]}}]}, "technical_analysis": {"Introduction": "This technical analysis provides an in-depth look at the stimulus_reflex remote code execution vulnerability.", "Impact and Scope": "The vulnerability allows an attacker to call arbitrary methods on injected reflex instances, enabling command and control functionality. The CVSS score is 8.8 with a version of 3.1, attack vector of NETWORK, and privileges required as LOW.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1059 - Command and Control, T1190 - Exploit Public-Facing Application, and T1568 - Defensive Counter Measures.", "Technical Details": "The vulnerability occurs when an attacker sends a specific WebSocket message, which can be exploited to inject a reflex instance and call arbitrary methods.", "Detection": "Detection involves monitoring WebSocket traffic for suspicious messages and validating user input.", "Mitigation": "Mitigation strategies include validating WebSocket messages, implementing secure WebSocket implementations, and patching stimulus_reflex to a patched version.", "Conclusion": "In conclusion, this vulnerability allows an attacker to gain remote code execution and command and control functionality. It is essential to patch stimulus_reflex and implement proper detection and mitigation strategies."}, "executive_analysis": {"Overview": "This executive analysis provides an overview of the stimulus_reflex remote code execution vulnerability and its business impact.", "Business Impact": "The vulnerability can result in unauthorized access and control of an application, which can lead to financial loss and reputation damage.", "Technical Impact": "The vulnerability allows an attacker to gain remote code execution and command and control functionality, which can be exploited to perform malicious activities.", "Mitigation Strategies": "Implement patching, validation, and proper detection and mitigation strategies to remediate the vulnerability.", "Recommendations": "Recommendations for executives include monitoring network traffic and implementing patching and validation strategies.", "Conclusions": "In conclusion, this vulnerability is a top priority and requires immediate attention. Executives should prioritize patching and validation to mitigate the risk of exploitation."}}