{"id": "CVE-2024-43881", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-21T01:15:12.280", "lastModified": "2024-08-21T12:30:33.697", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: ath12k: change DMA direction while mapping reinjected packets\n\nFor fragmented packets, ath12k reassembles each fragment as a normal\npacket and then reinjects it into HW ring. In this case, the DMA\ndirection should be DMA_TO_DEVICE, not DMA_FROM_DEVICE. Otherwise,\nan invalid payload may be reinjected into the HW and\nsubsequently delivered to the host.\n\nGiven that arbitrary memory can be allocated to the skb buffer,\nknowledge about the data contained in the reinjected buffer is lacking.\nConsequently, there\u2019s a risk of private information being leaked.\n\nTested-on: QCN9274 hw2.0 PCI WLAN.WBE.1.1.1-00209-QCAHKSWPL_SILICONZ-1"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: wifi: ath12k: cambia la direcci\u00f3n de DMA al mapear paquetes reinyectados. Para paquetes fragmentados, ath12k vuelve a ensamblar cada fragmento como un paquete normal y luego lo reinyecta en el anillo HW. En este caso, la direcci\u00f3n DMA debe ser DMA_TO_DEVICE, no DMA_FROM_DEVICE. De lo contrario, se puede reinyectar una carga \u00fatil no v\u00e1lida en el HW y posteriormente entregarla al host. Dado que se puede asignar memoria arbitraria al b\u00fafer skb, falta conocimiento sobre los datos contenidos en el b\u00fafer reinyectado. En consecuencia, existe el riesgo de que se filtre informaci\u00f3n privada. Probado en: QCN9274 hw2.0 PCI WLAN.WBE.1.1.1-00209-QCAHKSWPL_SILICONZ-1"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/33322e3ef07409278a18c6919c448e369d66a18e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6925320fcd40d8042d32bf4ede8248e7a5315c3b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e99d9b16ff153de9540073239d24adc3b0a3a997", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1047 - Windows Registry Run Keys / Start Folder", "comment": "CVE-2024-43881 - Attacker could potentially inject arbitrary data into the ath12k device, which could lead to information disclosure or arbitrary code execution. This technique could be used to deliver malicious code, making it critical to monitor registry run keys and start folders for suspicious activity."}, {"techniqueID": "T1518 - Mine for Forgeable Commands", "comment": "CVE-2024-43881 - Attacker could manipulate the ath12k device to inject forged commands, allowing for potential code injection or command injection attacks. This technique could be used to exploit the vulnerability and gain further privileges."}, {"techniqueID": "T1041 - Network Share Discovery", "comment": "CVE-2024-43881 - An attacker could potentially access private information on the vulnerable devices, making it essential to monitor network shares for suspicious activity."}, {"techniqueID": "T1190 - Expostition on Operational Technology", "comment": "CVE-2024-43881 - The vulnerable ath12k device could be exploited to inject arbitrary data, allowing for potential information disclosure or arbitrary code execution. This technique could be used to expose sensitive information."}, {"techniqueID": "T1083 - File and Directory Discovery", "comment": "CVE-2024-43881 - An attacker could potentially access sensitive files and directories on the vulnerable devices, making it essential to monitor file and directory access for suspicious activity."}], "technical_analysis": {"Introduction": "CVE-2024-43881 is a vulnerability in the Linux kernel that could potentially allow an attacker to inject arbitrary data into the ath12k device, leading to information disclosure or arbitrary code execution.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 and an attack vector of Local. It could potentially affect devices running Linux with the ath12k driver installed.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this CVE include T1047 - Windows Registry Run Keys / Start Folder, T1518 - Mine for Forgeable Commands, T1041 - Network Share Discovery, T1190 - Expostition on Operational Technology, and T1083 - File and Directory Discovery.", "Technical Details": "The vulnerability occurs when the ath12k driver changes the DMA direction while mapping reinjected packets. This could potentially lead to information disclosure or arbitrary code execution.", "Detection": "To detect this CVE, monitor registry run keys and start folders for suspicious activity, and monitor network shares for unauthorized access.", "Mitigation": "To mitigate this CVE, update the Linux kernel to the latest version, restrict access to sensitive areas of the system, and monitor network shares for suspicious activity.", "Conclusion": "CVE-2024-43881 is a critical vulnerability that could potentially allow an attacker to compromise devices running Linux with the ath12k driver installed. It is essential to monitor registry run keys and start folders, network shares, and file and directory access for suspicious activity, and to update the Linux kernel to the latest version."}, "executive_analysis": {"Overview": "CVE-2024-43881 is a vulnerability in the Linux kernel that could potentially compromise devices running Linux.", "Business Impact": "The vulnerability could potentially lead to information disclosure or arbitrary code execution, which could result in significant financial losses or reputational damage.", "Technical Impact": "The vulnerability occurs due to a flaw in the ath12k driver that could potentially lead to information disclosure or arbitrary code execution.", "Mitigation Strategies": "To mitigate this vulnerability, update the Linux kernel to the latest version and restrict access to sensitive areas of the system.", "Recommendations": " Executives should recommend that their IT teams update the Linux kernel to the latest version and monitor registry run keys and start folders, network shares, and file and directory access for suspicious activity.", "Conclusions": "In conclusion, CVE-2024-43881 is a critical vulnerability that could potentially compromise devices running Linux. It is essential to implement mitigation strategies and monitor systems for suspicious activity to prevent attacks."}}