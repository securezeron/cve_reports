{"id": "CVE-2024-25641", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-14T15:05:50.423", "lastModified": "2024-06-10T17:16:21.837", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Cacti provides an operational monitoring and fault management framework. Prior to version 1.2.27, an arbitrary file write vulnerability, exploitable through the \"Package Import\" feature, allows authenticated users having the \"Import Templates\" permission to execute arbitrary PHP code on the web server. The vulnerability is located within the `import_package()` function defined into the `/lib/import.php` script. The function blindly trusts the filename and file content provided within the XML data, and writes such files into the Cacti base path (or even outside, since path traversal sequences are not filtered). This can be exploited to write or overwrite arbitrary files on the web server, leading to execution of arbitrary PHP code or other security impacts. Version 1.2.27 contains a patch for this issue."}, {"lang": "es", "value": "Cacti proporciona un framework de monitoreo operativo y gesti\u00f3n de fallas. Antes de la versi\u00f3n 1.2.27, una vulnerabilidad de escritura de archivos arbitrarios, explotable a trav\u00e9s de la funci\u00f3n \"Importar paquetes\", permit\u00eda a los usuarios autenticados que ten\u00edan el permiso \"Importar plantillas\" ejecutar c\u00f3digo PHP arbitrario en el servidor web. La vulnerabilidad se encuentra dentro de la funci\u00f3n `import_package()` definida en el script `/lib/import.php`. La funci\u00f3n conf\u00eda ciegamente en el nombre del archivo y el contenido del archivo proporcionado dentro de los datos XML, y escribe dichos archivos en la ruta base de Cacti (o incluso fuera, ya que las secuencias de Path Traversal no se filtran). Esto puede aprovecharse para escribir o sobrescribir archivos arbitrarios en el servidor web, lo que lleva a la ejecuci\u00f3n de c\u00f3digo PHP arbitrario u otros impactos en la seguridad. La versi\u00f3n 1.2.27 contiene un parche para este problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.3, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "http://seclists.org/fulldisclosure/2024/May/6", "source": "security-advisories@github.com"}, {"url": "https://github.com/Cacti/cacti/commit/eff35b0ff26cc27c82d7880469ed6d5e3bef6210", "source": "security-advisories@github.com"}, {"url": "https://github.com/Cacti/cacti/security/advisories/GHSA-7cmj-g5qc-pj88", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-25641 - Exploitation of arbitrary file write vulnerability by authenticated users through the 'Package Import' feature, enabling execution of arbitrary PHP code on the web server."}, {"techniqueID": "T1223", "comment": "CVE-2024-25641 - Writing or overwriting arbitrary files on the web server to execute arbitrary PHP code or other security impacts, highlighting the need for defense against path traversal sequences."}, {"techniqueID": "T1036", "comment": "CVE-2024-25641 - Execution of arbitrary PHP code on the web server by authenticated users with the 'Import Templates' permission, emphasizing the importance of secure coding practices and vulnerability patching."}, {"techniqueID": "T1027", "comment": "CVE-2024-25641 - Execution of arbitrary code on the web server by exploiting a vulnerability in Cacti, highlighting the need for regular security assessments and penetration testing."}, {"techniqueID": "T1139", "comment": "CVE-2024-25641 - Execution of arbitrary code on the web server by exploiting a trust relationship in the 'import_package()' function, emphasizing the importance of secure coding practices."}], "stix_bundle": {"@stix_bundles": {"id": "cve-2024-25641-bundle", "title": "CVE-2024-25641 STIX 2.1 Bundle", "created": "2024-06-10T17:16:21.837", "modified": "2024-06-10T17:16:21.837", "bundle_type": "stix_bundle", "bundle_version": "2.1"}, "objects": [{"id": "cve-2024-25641", "created": "2024-06-10T17:16:21.837", "modified": "2024-06-10T17:16:21.837", "type": "vulnerability", "title": "CVE-2024-25641: Cacti Arbitrary File Write Vulnerability", "description": "CVE-2024-25641: Cacti provides an operational monitoring and fault management framework. Prior to version 1.2.27, an arbitrary file write vulnerability, exploitable through the 'Package Import' feature, allows authenticated users having the 'Import Templates' permission to execute arbitrary PHP code on the web server.", "references": [{"source": "security-advisories@github.com", "url": "http://seclists.org/fulldisclosure/2024/May/6"}]}, {"id": "T1190", "created": "2024-06-10T17:16:21.837", "modified": "2024-06-10T17:16:21.837", "type": "attack-pattern", "title": "Exploit Public-Facing Application", "description": "Attackers exploit publicly accessible applications, such as web servers, to gain access or launch attacks.", "killchain": "strike", "killchain_phases": ["A", "B", "C"], "related_object": {"relationship": "related", "id_ref": "cve-2024-25641"}}, {"id": "T1027", "created": "2024-06-10T17:16:21.837", "modified": "2024-06-10T17:16:21.837", "type": "attack-pattern", "title": "Remote File Copy", "description": "Attackers copy files from a remote location to a targeted system to establish persistence or facilitate other attacks.", "killchain": "strike", "killchain_phases": ["A", "B", "C"], "related_object": {"relationship": "related", "id_ref": "cve-2024-25641"}}, {"id": "T1036", "created": "2024-06-10T17:16:21.837", "modified": "2024-06-10T17:16:21.837", "type": "attack-pattern", "title": "File and Directory Discovery", "description": "Attackers explore and traverse a targeted system to identify sensitive files and directories.", "killchain": "exploit", "killchain_phases": ["A", "B", "C"], "related_object": {"relationship": "related", "id_ref": "cve-2024-25641"}}, {"id": "T1139", "created": "2024-06-10T17:16:21.837", "modified": "2024-06-10T17:16:21.837", "type": "attack-pattern", "title": "Command and Control \u2013 Custom Command", "description": "Attackers establish command and control (C2) communication with compromised systems and issue custom commands to manipulate or extract data.", "killchain": "exploit", "killchain_phases": ["A", "B", "C"], "related_object": {"relationship": "related", "id_ref": "cve-2024-25641"}}], "relationship": {"relationship_type": "related_to", "target_id": "cve-2024-25641", "source_id": "T1190", "start": "2024-06-10T17:16:21.837", "end": "2024-06-10T17:16:21.837"}}, "technical_analysis": {"Introduction": "CVE-2024-25641 is a remote code execution vulnerability in Cacti's 'Package Import' feature, allowing authenticated users with 'Import Templates' permission to execute arbitrary PHP code on the web server.", "Impact and Scope": "The vulnerability affects Cacti versions prior to 1.2.27, with a CVSS score of 9.1.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to multiple MITRE ATT&CK techniques, including T1190, T1223, T1036, T1027, and T1139.", "Technical Details": "The vulnerability is caused by an arbitrary file write vulnerability in the 'import_package()' function, allowing attackers to write or overwrite arbitrary files on the web server.", "Detection": "Defense against this vulnerability includes implementing secure coding practices, regular security assessments and penetration testing, as well as disabling unnecessary features and restricting access.", "Mitigation": "The vulnerability is mitigated by upgrading to Cacti version 1.2.27 or later, or by applying the patch provided by the vendor.", "Conclusion": "CVE-2024-25641 is a critical vulnerability that can be exploited by authenticated users with 'Import Templates' permission, highlighting the importance of regular security updates and vulnerability patching."}, "executive_analysis": {"Overview": "CVE-2024-25641 is a remote code execution vulnerability in Cacti's 'Package Import' feature, affecting authenticated users with 'Import Templates' permission.", "Business Impact": "The vulnerability can lead to the execution of arbitrary code, potentially resulting in data breaches, financial loss, or other security impacts.", "Technical Impact": "The vulnerability affects Cacti versions prior to 1.2.27, highlighting the importance of regular security updates and vulnerability patching.", "Mitigation Strategies": "To mitigate the vulnerability, organizations should upgrade to Cacti version 1.2.27 or later, or apply the patch provided by the vendor.", "Recommendations": "Executives should recommend regular security updates and vulnerability patching to IT teams, as well as implementing secure coding practices and conducting regular security assessments and penetration testing.", "Conclusions": "CVE-2024-25641 is a critical vulnerability that requires immediate attention and action from executives, IT teams, and security professionals."}}