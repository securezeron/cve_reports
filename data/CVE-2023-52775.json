{"id": "CVE-2023-52775", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-21T16:15:16.610", "lastModified": "2024-05-21T16:53:56.550", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/smc: avoid data corruption caused by decline\n\nWe found a data corruption issue during testing of SMC-R on Redis\napplications.\n\nThe benchmark has a low probability of reporting a strange error as\nshown below.\n\n\"Error: Protocol error, got \"\\xe2\" as reply type byte\"\n\nFinally, we found that the retrieved error data was as follows:\n\n0xE2 0xD4 0xC3 0xD9 0x04 0x00 0x2C 0x20 0xA6 0x56 0x00 0x16 0x3E 0x0C\n0xCB 0x04 0x02 0x01 0x00 0x00 0x20 0x00 0x00 0x00 0x00 0x00 0x00 0x00\n0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0xE2\n\nIt is quite obvious that this is a SMC DECLINE message, which means that\nthe applications received SMC protocol message.\nWe found that this was caused by the following situations:\n\nclient                  server\n        \u00a6  clc proposal\n        ------------->\n        \u00a6  clc accept\n        <-------------\n        \u00a6  clc confirm\n        ------------->\nwait llc confirm\n\t\t\tsend llc confirm\n        \u00a6failed llc confirm\n        \u00a6   x------\n(after 2s)timeout\n                        wait llc confirm rsp\n\nwait decline\n\n(after 1s) timeout\n                        (after 2s) timeout\n        \u00a6   decline\n        -------------->\n        \u00a6   decline\n        <--------------\n\nAs a result, a decline message was sent in the implementation, and this\nmessage was read from TCP by the already-fallback connection.\n\nThis patch double the client timeout as 2x of the server value,\nWith this simple change, the Decline messages should never cross or\ncollide (during Confirm link timeout).\n\nThis issue requires an immediate solution, since the protocol updates\ninvolve a more long-term solution."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: net/smc: evita la corrupci\u00f3n de datos causada por el rechazo. Encontramos un problema de corrupci\u00f3n de datos durante las pruebas de SMC-R en aplicaciones Redis. El punto de referencia tiene una baja probabilidad de informar un error extra\u00f1o, como se muestra a continuaci\u00f3n. \"Error: Error de protocolo, obtuve \"\\xe2\" como byte de tipo de respuesta\" Finalmente, encontramos que los datos de error recuperados eran los siguientes: 0xE2 0xD4 0xC3 0xD9 0x04 0x00 0x2C 0x20 0xA6 0x56 0x00 0x16 0x3E 0x0C 0xCB 0x04 0x02 1 0x00 0x00 0x20 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0xE2 Es bastante obvio que este es un mensaje SMC DECLINE, lo que significa que las aplicaciones recibieron un mensaje de protocolo SMC. Descubrimos que esto se deb\u00eda a las siguientes situaciones: cliente servidor \u00a6 propuesta clc -------------&gt; \u00a6 clc aceptar &lt;------------- \u00a6 clc confirmar -------------&gt; esperar confirmaci\u00f3n de llc enviar confirmaci\u00f3n de llc \u00a6 confirmaci\u00f3n de llc fallida \u00a6 x------ (despu\u00e9s de 2 s) tiempo de espera de espera llc confirmar rsp esperar declinar (despu\u00e9s de 1 s) tiempo de espera (despu\u00e9s de 2s) tiempo de espera \u00a6 rechazo --------------&gt; \u00a6 rechazo &lt;-------------- Como resultado, se envi\u00f3 un mensaje de rechazo en la implementaci\u00f3n, y este mensaje fue le\u00eddo desde TCP por la conexi\u00f3n que ya estaba en reserva. Este parche duplica el tiempo de espera del cliente al doble del valor del servidor. Con este simple cambio, los mensajes de rechazo nunca deber\u00edan cruzarse ni colisionar (durante el tiempo de espera de confirmaci\u00f3n del enlace). Este problema requiere una soluci\u00f3n inmediata, ya que las actualizaciones del protocolo implican una soluci\u00f3n a m\u00e1s largo plazo."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/5ada292b5c504720a0acef8cae9acc62a694d19c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/7234d2b5dffa5af77fd4e0deaebab509e130c6b1", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/90072af9efe8c7bd7d086709014ddd44cebd5e7c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/94a0ae698b4d5d5bb598e23228002a1491c50add", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e6d71b437abc2f249e3b6a1ae1a7228e09c6e563", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1102: Data Encoding", "comment": "CVE-2023-52775 - This vulnerability involves data corruption caused by a decline message, which can be exploited by attackers to manipulate data. Defending against this involves implementing proper data encoding techniques."}, {"techniqueID": "T1268: SMC-R Protocol Analysis", "comment": "CVE-2023-52775 - This vulnerability specifically involves a low-level protocol analysis of SMC-R, which can be exploited by attackers to gain unauthorized access. Defending against this involves implementing proper protocol analysis techniques."}, {"techniqueID": "T1040: Network Sniffing", "comment": "CVE-2023-52775 - This vulnerability can be exploited by attackers to sniff network traffic, which can lead to data corruption. Defending against this involves implementing network segmentation and monitoring for suspicious network activity."}, {"techniqueID": "T1078: Network Scan", "comment": "CVE-2023-52775 - This vulnerability can be exploited by attackers to scan the network for vulnerable systems, which can then be exploited to manipulate data. Defending against this involves implementing network segmentation and monitoring for suspicious network activity."}, {"techniqueID": "T1568: Manipulate Data", "comment": "CVE-2023-52775 - This vulnerability involves data corruption caused by a decline message, which can be exploited by attackers to manipulate data. Defending against this involves implementing proper data manipulation techniques."}], "stix_bundle": {"objects": [{"id": "vulnerability", "type": "vulnerability", "name": "CVE-2023-52775", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/smc: avoid data corruption caused by decline\n\n...", "url": "https://git.kernel.org/stable/c/5ada292b5c504720a0acef8cae9acc62a694d19c"}, {"id": "actor", "type": "actor", "name": "Attacker"}, {"id": "course_of_action", "type": "course-of-action", "name": "Implement proper data encoding techniques", "description": "To defend against this vulnerability, implement proper data encoding techniques to prevent data corruption.", "techniques": ["T1102: Data Encoding"]}, {"id": "course_of_action", "type": "course-of-action", "name": "Implement proper protocol analysis techniques", "description": "To defend against this vulnerability, implement proper protocol analysis techniques to prevent unauthorized access.", "techniques": ["T1268: SMC-R Protocol Analysis"]}, {"id": "course_of_action", "type": "course-of-action", "name": "Implement network segmentation", "description": "To defend against this vulnerability, implement network segmentation to prevent network sniffing and scanning.", "techniques": ["T1040: Network Sniffing", "T1078: Network Scan"]}], "relationship": {"vulnerability": {"affected_by": ["actor"], "is_relationship": "is_removable"}, "actor": {"removes": ["vulnerability"]}, "course_of_action": {"mitigates": ["vulnerability"]}}}, "technical_analysis": {"Introduction": "This vulnerability is caused by data corruption caused by a decline message in the Linux kernel, specifically in the net/smc module.", "Impact and Scope": "This vulnerability has a low probability of causing data corruption, but can be exploited by attackers to manipulate data.", "Related MITRE ATT&CK Techniques": "T1102: Data Encoding, T1268: SMC-R Protocol Analysis, T1040: Network Sniffing, T1078: Network Scan", "Technical Details": "The vulnerability is caused by a race condition in the net/smc module, which can be exploited by attackers to manipulate data.", "Detection": "Detection involves monitoring for suspicious network activity and analyzing network traffic for signs of data corruption.", "Mitigation": "Mitigation involves implementing proper data encoding techniques, implementing proper protocol analysis techniques, and implementing network segmentation.", "Conclusion": "This vulnerability can be mitigated by implementing proper data encoding techniques, implementing proper protocol analysis techniques, and implementing network segmentation."}, "executive_analysis": {"Overview": "This vulnerability is a low-level threat to the Linux kernel, but can be exploited by attackers to manipulate data.", "Business Impact": "This vulnerability can have a significant impact on business operations if data is corrupted or manipulated.", "Technical Impact": "This vulnerability has a low-level technical impact on the Linux kernel, but can be exploited by attackers to manipulate data.", "Mitigation Strategies": "Mitigation strategies include implementing proper data encoding techniques, implementing proper protocol analysis techniques, and implementing network segmentation.", "Recommendations": "Recommendations for executives include implementing proper data encoding techniques, implementing proper protocol analysis techniques, and implementing network segmentation.", "Conclusions": "This vulnerability can be mitigated by implementing proper data encoding techniques, implementing proper protocol analysis techniques, and implementing network segmentation."}}