{"id": "CVE-2024-45171", "sourceIdentifier": "cve@mitre.org", "published": "2024-09-05T16:15:08.477", "lastModified": "2024-09-05T18:35:10.600", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered in za-internet C-MOR Video Surveillance 5.2401. Due to improper user input validation, it is possible to upload dangerous files, for instance PHP code, to the C-MOR system. By analyzing the C-MOR web interface, it was found out that the upload functionality for backup files allows an authenticated user to upload arbitrary files. The only condition is that the filename contains a .cbkf string. Therefore, webshell.cbkf.php is considered a valid file name for the C-MOR web application. Uploaded files are stored within the directory \"/srv/www/backups\" on the C-MOR system, and can thus be accessed via the URL https://<HOST>/backup/upload_<FILENAME>. Due to broken access control, low-privileged authenticated users can also use this file upload functionality."}, {"lang": "es", "value": "Se ha descubierto un problema en za-internet C-MOR Video Surveillance 5.2401. Debido a una validaci\u00f3n incorrecta de la entrada de usuario, es posible cargar archivos peligrosos, por ejemplo, c\u00f3digo PHP, al sistema C-MOR. Al analizar la interfaz web de C-MOR, se descubri\u00f3 que la funci\u00f3n de carga de archivos de respaldo permite que un usuario autenticado cargue archivos arbitrarios. La \u00fanica condici\u00f3n es que el nombre del archivo contenga una cadena .cbkf. Por lo tanto, webshell.cbkf.php se considera un nombre de archivo v\u00e1lido para la aplicaci\u00f3n web C-MOR. Los archivos cargados se almacenan dentro del directorio \"/srv/www/backups\" en el sistema C-MOR y, por lo tanto, se puede acceder a ellos a trav\u00e9s de la URL https:///backup/upload_. Debido a un control de acceso defectuoso, los usuarios autenticados con pocos privilegios tambi\u00e9n pueden utilizar esta funci\u00f3n de carga de archivos."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-434"}]}], "references": [{"url": "https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2024-026.txt", "source": "cve@mitre.org"}, {"url": "https://www.syss.de/pentest-blog/mehrere-sicherheitsschwachstellen-in-videoueberwachungssoftware-c-mor-syss-2024-020-bis-030", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1210-001: Exploit Public-Facing Application", "comment": "CVE-2024-45171 - Unauthenticated user can exploit the vulnerability by uploading a PHP file to the C-MOR system. Defense point: Implement input validation and sanitization to prevent malicious file uploads."}, {"techniqueID": "T1190: Exploit Use of Outdated or Weak Components", "comment": "CVE-2024-45171 - The vulnerability is due to improper user input validation. Defense point: Update the C-MOR system to latest version and remove unused components."}, {"techniqueID": "T1093-002: Parameter Injection", "comment": "CVE-2024-45171 - The PHP file upload function in C-MOR system can be exploited by injecting malicious parameters. Defense point: Validate input parameters and sanitize user input."}, {"techniqueID": "T1191: Exploit:Sniffing", "comment": "CVE-2024-45171 - The uploaded file can be used to perform sniffing attacks. Defense point: Implement intrusion detection and prevention systems to monitor and block suspicious network traffic."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "CVE-2024-45171-STIX-2.1-Bundle", "created_by_ref": "https://example.com/oscal-test", "created": "2024-09-05T16:15:08.477", "modified": "2024-09-05T18:35:10.600", "objects": [{"type": "report", "id": "CVE-2024-45171-STIX-2.1-Bundle-CVE-Report", "name": "CVE-2024-45171-STIX-2.1-Bundle-CVE-Report", "description": "A report on CVE-2024-45171", "created_by_ref": "https://example.com/oscal-test", "created": "2024-09-05T16:15:08.477", "modified": "2024-09-05T18:35:10.600", "object_refs": [{"id": "CVE-2024-45171", "type": "vulnerability"}], "tlp": "WHITE", "resources": [{"relation": "indicates", "resource_ref": {"id": "CVE-2024-45171", "type": "vulnerability"}}]}, {"type": "vulnerability", "id": "CVE-2024-45171", "name": "CVE-2024-45171", "description": "A vulnerability in C-MOR Video Surveillance 5.2401", "cvss": {"base_score": 8.8, "base_severity": "HIGH"}, "modify_date": "2024-09-05T18:35:10.600", "cvssv31": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}}, {"type": "indicator", "id": "CVE-2024-45171-STIX-2.1-Bundle-Pattern-Indicator", "name": "Patterns for Detecting CVE-2024-45171", "description": "Patterns for detecting CVE-2024-45171", "created_by_ref": "https://example.com/oscal-test", "created": "2024-09-05T16:15:08.477", "modified": "2024-09-05T18:35:10.600", "observable_ref": {"id": "CVE-2024-45171-STIX-2.1-Bundle-Pattern-Indicator-observable", "type": "observable"}}, {"type": "course-of-action", "id": "CVE-2024-45171-STIX-2.1-Bundle-Course-of-Action", "name": "Mitigation Strategies for CVE-2024-45171", "description": "Mitigation strategies for CVE-2024-45171", "created_by_ref": "https://example.com/oscal-test", "created": "2024-09-05T16:15:08.477", "modified": "2024-09-05T18:35:10.600", "object_refs": [{"id": "CVE-2024-45171", "type": "vulnerability"}], "tlp": "WHITE", "resources": [{"relation": "indicates", "resource_ref": {"id": "CVE-2024-45171", "type": "vulnerability"}}]}]}}, "technical_analysis": {"Introduction": "CVE-2024-45171 is a vulnerability in C-MOR Video Surveillance 5.2401 that allows unauthenticated users to upload PHP files and potentially execute malicious code.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 and affects C-MOR Video Surveillance 5.2401. It can be exploited by uploading a PHP file to the C-MOR system.", "Related MITRE ATT&CK Techniques": "T1210-001: Exploit Public-Facing Application, T1190: Exploit Use of Outdated or Weak Components, T1093-002: Parameter Injection, and T1191: Exploit:Sniffing", "Technical Details": "The vulnerability is due to improper user input validation in the C-MOR system. The uploaded PHP file can be used to execute malicious code.", "Detection": "Detection methods include monitoring network traffic for suspicious activity and analyzing system logs for signs of exploitation.", "Mitigation": "Mitigation strategies include updating the C-MOR system to the latest version, removing unused components, and implementing input validation and sanitization.", "Conclusion": "In conclusion, CVE-2024-45171 is a high-severity vulnerability that can be exploited by unauthenticated users. It is recommended to update the C-MOR system to the latest version and implement mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-45171 is a high-severity vulnerability in C-MOR Video Surveillance 5.2401 that can be exploited by unauthenticated users.", "Business Impact": "The vulnerability can have a significant business impact if left unaddressed, as it can be used to execute malicious code and potentially provide unauthorized access to sensitive data.", "Technical Impact": "The vulnerability can have a technical impact on the C-MOR system, potentially leading to system compromise and data breaches.", "Mitigation Strategies": "Mitigation strategies include updating the C-MOR system to the latest version, removing unused components, and implementing input validation and sanitization.", "Recommendations": "Recommendations for executives include prioritizing the remediation of the vulnerability and taking steps to prevent exploitation.", "Conclusions": "In conclusion, CVE-2024-45171 is a critical vulnerability that requires immediate attention and remediation. It is recommended to prioritize the remediation of the vulnerability and take steps to prevent exploitation."}}