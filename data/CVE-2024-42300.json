{"id": "CVE-2024-42300", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-17T09:15:10.360", "lastModified": "2024-08-19T12:59:59.177", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nerofs: fix race in z_erofs_get_gbuf()\n\nIn z_erofs_get_gbuf(), the current task may be migrated to another\nCPU between `z_erofs_gbuf_id()` and `spin_lock(&gbuf->lock)`.\n\nTherefore, z_erofs_put_gbuf() will trigger the following issue\nwhich was found by stress test:\n\n<2>[772156.434168] kernel BUG at fs/erofs/zutil.c:58!\n..\n<4>[772156.435007]\n<4>[772156.439237] CPU: 0 PID: 3078 Comm: stress Kdump: loaded Tainted: G            E      6.10.0-rc7+ #2\n<4>[772156.439239] Hardware name: Alibaba Cloud Alibaba Cloud ECS, BIOS 1.0.0 01/01/2017\n<4>[772156.439241] pstate: 83400005 (Nzcv daif +PAN -UAO +TCO +DIT -SSBS BTYPE=--)\n<4>[772156.439243] pc : z_erofs_put_gbuf+0x64/0x70 [erofs]\n<4>[772156.439252] lr : z_erofs_lz4_decompress+0x600/0x6a0 [erofs]\n..\n<6>[772156.445958] stress (3127): drop_caches: 1\n<4>[772156.446120] Call trace:\n<4>[772156.446121]  z_erofs_put_gbuf+0x64/0x70 [erofs]\n<4>[772156.446761]  z_erofs_lz4_decompress+0x600/0x6a0 [erofs]\n<4>[772156.446897]  z_erofs_decompress_queue+0x740/0xa10 [erofs]\n<4>[772156.447036]  z_erofs_runqueue+0x428/0x8c0 [erofs]\n<4>[772156.447160]  z_erofs_readahead+0x224/0x390 [erofs]\n.."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: erofs: corrige la ejecuci\u00f3n en z_erofs_get_gbuf() En z_erofs_get_gbuf(), la tarea actual se puede migrar a otra CPU entre `z_erofs_gbuf_id()` y `spin_lock(&amp;gbuf-&gt;lock)` . Por lo tanto, z_erofs_put_gbuf() desencadenar\u00e1 el siguiente problema que se encontr\u00f3 en la prueba de estr\u00e9s: &lt;2&gt;[772156.434168] ERROR del kernel en fs/erofs/zutil.c:58. .. &lt;4&gt;[772156.435007] &lt;4&gt;[772156.439237] CPU: 0 PID: 3078 Comm: estr\u00e9s Kdump: cargado Contaminado: GE 6.10.0-rc7+ #2 &lt;4&gt;[772156.439239] Nombre de hardware: Alibaba Cloud Alibaba Cloud ECS , BIOS 1.0.0 01/01/2017 &lt;4&gt;[772156.439241] pstate: 83400005 (Nzcv daif +PAN -UAO +TCO +DIT -SSBS BTYPE=--) &lt;4&gt;[772156.439243] pc: z_erofs_put_gbuf+0x64/0x70 [erofs] &lt;4&gt;[772156.439252] lr: z_erofs_lz4_decompress+0x600/0x6a0 [erofs] .. &lt;6&gt;[772156.445958] estr\u00e9s (3127): drop_caches: 1 &lt;4&gt;[772156.446120] Rastreo de llamadas: &lt;4&gt;[772156. 446121] z_erofs_put_gbuf+0x64/0x70 [erofs] &lt;4&gt;[772156.446761] z_erofs_lz4_decompress+0x600/0x6a0 [erofs] &lt;4&gt;[772156.446897] z_erofs_decompress_queue+0x740/0xa10 [erofs &lt;4&gt;[ 772156.447036] z_erofs_runqueue+0x428/0x8c0 [erofs] &lt;4&gt;[772156.447160] z_erofs_readahead+0x224/0x390 [erofs] .."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/49b22e06a947727a6d1c802d2d9ad92420b90fc5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/7dc5537c3f8be87e005f0844a7626c987914f8fd", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-42300 - The vulnerability allows for potential data corruption and system instability. Attackers could exploit this vulnerability to achieve persistent access to the affected system."}, {"techniqueID": "T1210", "comment": "CVE-2024-42300 - The vulnerability appears to be related to a race condition in the erofs module, which could be exploited by an attacker to execute arbitrary code. This technique is used to inject malware onto a system."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve-2024-42300.stix", "spec_version": "2.1", "schema_version": "1.2.1", "objects": [{"type": "incident", "id": "https://example.com/Incident-1", "title": "CVE-2024-42300 Incident", "created_by_ref": "https://example.com/Sensor-1", "created": "2024-08-17T09:15:10.360", "modified": "2024-08-19T12:59:59.177", "description": "The erofs module in the Linux kernel has been found to contain a race condition vulnerability allowing data corruption and system instability.", "indicators": [{"type": "observable", "id": "https://example.com/Observable-1", "spec_version": "2.1", "schema_version": "1.2.1", "name": "CVE-2024-42300 Observable", "description": "The erofs module in the Linux kernel has been found to contain a race condition vulnerability allowing data corruption and system instability.", "first_seen": "2024-08-17T09:15:10.360", "last_seen": "2024-08-19T12:59:59.177", "generated_at": "2024-08-17T09:15:10.360", "handling_encounter": "https://example.com/Incident-1", "pattern": " pattern of potential data corruption and system instability"}], "course_of_action": [{"id": "https://example.com/Course-1", "type": "course_of_action", "name": "Containment", "description": "Isolate the affected system to prevent further data corruption and system instability."}, {"id": "https://example.com/Course-2", "type": "course_of_action", "name": "Remediate", "description": "Apply patches and updates to remediate the identified vulnerability."}]}], "relationships": [{"id": "https://example.com/Relationship-1", "type": "has-course-of-action", "src_ref": "https://example.com/Incident-1", "dst_ref": "https://example.com/Course-1"}]}, "technical_analysis": {"Introduction": "The CVE-2024-42300 vulnerability affects the erofs module in the Linux kernel, specifically in the z_erofs_get_gbuf() function. This vulnerability is a race condition that can lead to data corruption and system instability.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5 with a vector of AV:N/AC:H/Au:N/C:C/I:C/A:C. This means that it could be exploited by an attacker to achieve persistent access to the affected system.", "Related MITRE ATT&CK Techniques": "T1027 (Software Deployment) and T1210 (Exploitation of Remote Services)", "Technical Details": "The vulnerability is caused by a race condition in the z_erofs_get_gbuf() function, which can be exploited by an attacker to inject malware into the system. The attacker could then use this malware to persist on the system.", "Detection": "Detection of this vulnerability is challenging as it requires analyzing the system logs for signs of data corruption and system instability.", "Mitigation": "The recommended mitigation for this vulnerability is to apply patches and updates to the affected system.", "Conclusion": "In conclusion, the CVE-2024-42300 vulnerability is a critical issue that requires immediate attention. It is recommended that affected systems be patched and updated as soon as possible."}, "executive_analysis": {"Overview": "The CVE-2024-42300 vulnerability is a critical issue that affects the erofs module in the Linux kernel. It is a race condition that can lead to data corruption and system instability.", "Business Impact": "The business impact of this vulnerability is significant, as it could be exploited by an attacker to achieve persistent access to the affected system. This could lead to loss of sensitive data and compromise of the system.", "Technical Impact": "The technical impact of this vulnerability is significant, as it could be exploited by an attacker to inject malware into the system. The attacker could then use this malware to persist on the system.", "Mitigation Strategies": "The recommended mitigation strategy for this vulnerability is to apply patches and updates to the affected system as soon as possible.", "Recommendations": "Recommendations for executives include prioritizing patching and updating the affected system, and implementing additional security controls to prevent exploitation.", "Conclusions": "In conclusion, the CVE-2024-42300 vulnerability is a critical issue that requires immediate attention. It is recommended that affected systems be patched and updated as soon as possible."}}