{"id": "CVE-2024-5267", "sourceIdentifier": "zdi-disclosures@trendmicro.com", "published": "2024-06-06T18:15:19.477", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Sonos Era 100 SMB2 Message Handling Out-Of-Bounds Write Remote Code Execution Vulnerability. This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of Sonos Era 100 smart speakers. Authentication is not required to exploit this vulnerability.\n\nThe specific flaw exists within the handling of SMB2 messages. The issue results from the lack of proper validation of user-supplied data, which can result in a write past the end of an allocated buffer. An attacker can leverage this vulnerability to execute code in the context of root. Was ZDI-CAN-22384."}, {"lang": "es", "value": "Vulnerabilidad de ejecuci\u00f3n remota de c\u00f3digo de escritura fuera de los l\u00edmites en el manejo de mensajes de Sonos Era 100 SMB2. Esta vulnerabilidad permite a atacantes adyacentes a la red ejecutar c\u00f3digo arbitrario en las instalaciones afectadas de los altavoces inteligentes Sonos Era 100. No se requiere autenticaci\u00f3n para aprovechar esta vulnerabilidad. La falla espec\u00edfica existe en el manejo de mensajes SMB2. El problema se debe a la falta de una validaci\u00f3n adecuada de los datos proporcionados por el usuario, lo que puede provocar una escritura m\u00e1s all\u00e1 del final de un b\u00fafer asignado. Un atacante puede aprovechar esta vulnerabilidad para ejecutar c\u00f3digo en el contexto de la ra\u00edz. Era ZDI-CAN-22384."}], "metrics": {"cvssMetricV30": [{"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-787"}]}], "references": [{"url": "https://www.zerodayinitiative.com/advisories/ZDI-24-543/", "source": "zdi-disclosures@trendmicro.com"}], "techniques": [{"techniqueID": "TA0002", "comment": "CVE-2024-5267 - This technique is relevant as it represents a Network-based exploitation scenario, where the vulnerability is being exploited remotely via SMB2 messages, allowing an adversary to execute code in the context of root."}, {"techniqueID": "TA0013", "comment": "CVE-2024-5267 - This technique is relevant as it represents a use of Exploitation Tactics, where an adversary uses a previously unknown vulnerability to execute code, which can lead to code execution, data manipulation, and availability attacks."}, {"techniqueID": "TA0033", "comment": "CVE-2024-5267 - This technique is relevant as it represents a use of Local File Include (LFI) to execute code, which is a possible payload for this vulnerability."}, {"techniqueID": "TA0034", "comment": "CVE-2024-5267 - This technique is relevant as it represents a use of Remote File Inclusion (RFI) to execute code, which is a possible payload for this vulnerability."}, {"techniqueID": "TA0067", "comment": "CVE-2024-5267 - This technique is relevant as it represents a use of Indirect Command Execution, where an adversary uses a vulnerable service or software to execute arbitrary commands."}, {"techniqueID": "TA0077", "comment": "CVE-2024-5267 - This technique is relevant as it represents a use of Path Manipulation, where an adversary uses a vulnerable service or software to manipulate system paths and execute arbitrary commands."}, {"techniqueID": "TA0157", "comment": "CVE-2024-5267 - This technique is relevant as it represents a use of Executable Code in EIP, where an adversary executes code in the EIP (Expected Initial Program) register, which can lead to code execution."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "MITRE-2024-5267", "title": "MITRE-2024-5267 - Sonos Era 100 SMB2 Message Handling Out-of-Bounds Write Remote Code Execution Vulnerability", "created_by_ref": "https://www.mitre.org/att", "created": "2024-06-06T18:15:19.477", "modified": "2024-06-07T14:56:05.647", "objects": [{"type": "vulnerability", "spec_version": "2.1", "id": "MITRE-2024-5267-01", "title": "Sonos Era 100 SMB2 Message Handling Out-of-Bounds Write Remote Code Execution Vulnerability", "created_by_ref": "https://www.mitre.org/att", "created": "2024-06-06T18:15:19.477", "modified": "2024-06-07T14:56:05.647", "description": {"lang": "en", "value": "This vulnerability allows an attacker to execute arbitrary code on affected installations of Sonos Era 100 smart speakers."}, "cve_id": "CVE-2024-5267", "cwe_id": "CWE-787", "cvss_v30": {"version": "3.0", "vectorString": "CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}}, {"type": "course-of-action", "spec_version": "2.1", "id": "MITRE-2024-5267-02", "title": "Apply the latest security patches", "description": {"lang": "en", "value": "The vulnerability can be mitigated by applying the latest security patches released by Sonos."}, "published_tactic": "TA0002"}, {"type": "course-of-action", "spec_version": "2.1", "id": "MITRE-2024-5267-03", "title": "Disable SMB2", "description": {"lang": "en", "value": "Disabling SMB2 can mitigate the vulnerability."}, "published_tactic": "TA0013"}]}, "technical_analysis": {"Introduction": "The Sonos Era 100 SMB2 Message Handling Out-of-Bounds Write Remote Code Execution Vulnerability (CVE-2024-5267) is a remote code execution vulnerability that affects the Sonos Era 100 smart speakers. The vulnerability allows an attacker to execute arbitrary code on affected installations of Sonos Era 100 smart speakers.", "Impact and Scope": "The vulnerability has a CVSSv3 score of 8.8 and an attack vector of ADJACENT_NETWORK, which means that an attacker can exploit the vulnerability remotely without requiring any authentication.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including TA0002, TA0013, TA0033, TA0034, TA0067, TA0077, and TA0157.", "Technical Details": "The vulnerability is caused by an out-of-bounds write in the SMB2 message handling code, which allows an attacker to execute arbitrary code. The vulnerability can be exploited by sending a specially crafted SMB2 message to the affected Sonos Era 100 smart speakers.", "Detection": "The vulnerability can be detected by monitoring network traffic for suspicious SMB2 messages and by looking for unexpected behavior on the affected devices.", "Mitigation": "The vulnerability can be mitigated by applying the latest security patches released by Sonos, disabling SMB2, and implementing network segmentation.", "Conclusion": "The Sonos Era 100 SMB2 Message Handling Out-of-Bounds Write Remote Code Execution Vulnerability (CVE-2024-5267) is a significant remote code execution vulnerability that affects the Sonos Era 100 smart speakers. It is essential to apply the latest security patches and implement additional mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "The Sonos Era 100 SMB2 Message Handling Out-of-Bounds Write Remote Code Execution Vulnerability (CVE-2024-5267) is a critical remote code execution vulnerability that affects the Sonos Era 100 smart speakers.", "Business Impact": "The vulnerability has significant business implications, as it allows an attacker to execute arbitrary code on affected installations of Sonos Era 100 smart speakers.", "Technical Impact": "The vulnerability has a significant technical impact, as it allows an attacker to execute arbitrary code on affected devices.", "Mitigation Strategies": "The vulnerability can be mitigated by applying the latest security patches released by Sonos, disabling SMB2, and implementing network segmentation.", "Recommendations": "We recommend that all users of the Sonos Era 100 smart speakers apply the latest security patches and implement additional mitigation strategies to prevent exploitation.", "Conclusions": "The Sonos Era 100 SMB2 Message Handling Out-of-Bounds Write Remote Code Execution Vulnerability (CVE-2024-5267) is a significant remote code execution vulnerability that affects the Sonos Era 100 smart speakers. We recommend that all users take immediate action to mitigate the vulnerability."}}