{"id": "CVE-2024-30471", "sourceIdentifier": "security@apache.org", "published": "2024-07-17T09:15:02.640", "lastModified": "2024-08-01T13:50:08.403", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability in Apache StreamPipes in user self-registration.\nThis allows an attacker to potentially request the creation of multiple accounts with the same email address until the email address is registered, creating many identical users and corrupting StreamPipe's user management.\nThis issue affects Apache StreamPipes: through 0.93.0.\n\nUsers are recommended to upgrade to version 0.95.0, which fixes the issue.\n\n"}, {"lang": "es", "value": "Vulnerabilidad de condici\u00f3n de ejecuci\u00f3n de tiempo de verificaci\u00f3n de tiempo de uso (TOCTOU) en Apache StreamPipes en el registro autom\u00e1tico del usuario. Esto permite que un atacante solicite potencialmente la creaci\u00f3n de varias cuentas con la misma direcci\u00f3n de correo electr\u00f3nico hasta que se registre la direcci\u00f3n de correo electr\u00f3nico, lo que crea muchos usuarios id\u00e9nticos y corrompe la administraci\u00f3n de usuarios de StreamPipe. Este problema afecta a Apache StreamPipes: hasta 0.93.0. Se recomienda a los usuarios actualizar a la versi\u00f3n 0.95.0, que soluciona el problema."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.7, "baseSeverity": "LOW"}, "exploitabilityScore": 2.2, "impactScore": 1.4}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "security@apache.org", "type": "Primary", "description": [{"lang": "en", "value": "CWE-367"}]}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-367"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:streampipes:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.95.0", "matchCriteriaId": "B5EC9EC8-4988-4DAC-A92F-CCDED7F9CB52"}]}]}], "references": [{"url": "https://lists.apache.org/thread/8yodrmohgcybq900or3d4hc1msl230fr", "source": "security@apache.org", "tags": ["Mailing List", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1057", "comment": "CVE-2024-30471 - This vulnerability allows an attacker to create multiple accounts with the same email address, a classic example of a Time-of-Check Time-of-use (TOCTOU) Race Condition. 'Stalling' techniques like T1057 would allow an attacker to take advantage of this vulnerability. "}, {"techniqueID": "T1134", "comment": "CVE-2024-30471 - This vulnerability could be exploited by an attacker using a 'Wait-for-State' technique like T1134. This would allow the attacker to pause the registration process and wait for the user to complete the registration process. "}, {"techniqueID": "T1078", "comment": "CVE-2024-30471 - This vulnerability could also be exploited by an attacker using a 'Create Account' technique like T1078. This would allow the attacker to create multiple accounts with the same email address. "}], "stix_bundle": {"type": "bundle", "id": "cve-2024-30471-bundle", "created_by_ref": "admin", "created": "2024-07-17T09:15:02.640Z", "modified": "2024-08-01T13:50:08.403Z", "objects": [{"type": "indicator", "id": "apache-streampipes-indicator", "name": "Apache StreamPipes Indicator", "description": "Indicator for Apache StreamPipes Vulnerability", "modified": "2024-08-01T13:50:08.403Z", "created_by_ref": "admin", "created": "2024-07-17T09:15:02.640Z"}, {"type": "course-of-action", "id": "cve-2024-30471-coa", "name": "CVE-2024-30471 COA", "description": "Course of Action for CVE-2024-30471", "modified": "2024-08-01T13:50:08.403Z", "created_by_ref": "admin", "created": "2024-07-17T09:15:02.640Z", "related_object": {"target_ref": "cve-2024-30471-bundle", "relationship": "mitigates", "technique_ref": "T1057"}}, {"type": "course-of-action", "id": "cve-2024-30471-coa-2", "name": "CVE-2024-30471 COA (2)", "description": "Course of Action for CVE-2024-30471", "modified": "2024-08-01T13:50:08.403Z", "created_by_ref": "admin", "created": "2024-07-17T09:15:02.640Z", "related_object": {"target_ref": "cve-2024-30471-bundle", "relationship": "mitigates", "technique_ref": "T1134"}}, {"type": "course-of-action", "id": "cve-2024-30471-coa-3", "name": "CVE-2024-30471 COA (3)", "description": "Course of Action for CVE-2024-30471", "modified": "2024-08-01T13:50:08.403Z", "created_by_ref": "admin", "created": "2024-07-17T09:15:02.640Z", "related_object": {"target_ref": "cve-2024-30471-bundle", "relationship": "mitigates", "technique_ref": "T1078"}}]}, "technical_analysis": {"Introduction": "Apache StreamPipes is vulnerable to a TOCTOU Race Condition, allowing an attacker to create multiple accounts with the same email address.", "Impact and Scope": "The vulnerability affects Apache StreamPipes versions 0.93.0 and below, with a CVSS score of 5.3.", "Related MITRE ATT&CK Techniques": "T1057, T1134, T1078", "Technical Details": "The vulnerability occurs due to a TOCTOU Race Condition in the self-registration process of Apache StreamPipes.", "Detection": "Detection involves monitoring for multiple account creations with the same email address.", "Mitigation": "Upgrade to Apache StreamPipes version 0.95.0, which fixes the vulnerability.", "Conclusion": "In conclusion, the vulnerability highlights the importance of properly handling concurrent access and the need for timely updates."}, "executive_analysis": {"Overview": "The vulnerability in Apache StreamPipes allows an attacker to create multiple accounts with the same email address, posing a threat to the integrity of the system.", "Business Impact": "This vulnerability could lead to significant business disruptions and financial losses if exploited.", "Technical Impact": "The vulnerability poses technical risks, including data breaches and system compromise.", "Mitigation Strategies": "Implement proper authentication and authorization mechanisms, as well as regular software updates.", "Recommendations": "Recommend executives to prioritize software updates and implement robust security measures.", "Conclusions": "In conclusion, the vulnerability emphasizes the importance of prioritizing security and applying timely updates to mitigate potential risks."}}