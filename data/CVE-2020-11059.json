{"id": "CVE-2020-11059", "sourceIdentifier": "security-advisories@github.com", "published": "2020-05-27T21:15:11.127", "lastModified": "2021-10-07T17:20:56.270", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In AEgir greater than or equal to 21.7.0 and less than 21.10.1, aegir publish and aegir build may leak secrets from environment variables in the browser bundle published to npm. This has been fixed in 21.10.1."}, {"lang": "es", "value": "En AEgir versiones superiores o igual a 21.7.0 y versiones anteriores a la versi\u00f3n 21.10.1, la publicaci\u00f3n de aegir y la compilaci\u00f3n de aegir pueden filtrar secretos de las variables de entorno en el paquete del navegador publicado en npm. Esto ha sido corregido en versi\u00f3n 21.10.1."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.6, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.8, "impactScore": 6.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:aegir_project:aegir:*:*:*:*:*:node.js:*:*", "versionStartIncluding": "21.7.0", "versionEndExcluding": "21.10.1", "matchCriteriaId": "461D1779-F24F-46A8-9B5B-854A0041CE7E"}]}]}], "references": [{"url": "https://github.com/ipfs/aegir/security/advisories/GHSA-qfcv-5whw-7pcw", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1204", "comment": "In-progress command injection - This technique is relevant because it describes exploitation of the vulnerability by injecting commands into the environment variables. It is essential to monitor and log environment variables to detect commands being injected."}, {"techniqueID": "T1508", "comment": "Use of insecure environment variables - The vulnerability was caused by injecting secrets from environment variables into the browser bundle. It is crucial to identify and remediate these environments variables to prevent sensitive information from being leaked."}, {"techniqueID": "T1021", "comment": "Remote access to the system - The attack vector for this vulnerability is network-based, allowing the attacker to access the system remotely. It is essential to implement strict network access controls and monitor network traffic to detect and prevent unauthorized access."}, {"techniqueID": "T1210", "comment": "Exploit publicly known vulnerabilities - The vulnerability allows attackers to exploit the publicly known vulnerability (CVE-2020-11059) by injecting commands into environment variables. This underscores the importance of keeping software up-to-date with the latest security patches."}, {"techniqueID": "T1045", "comment": "Directory traversal - The vulnerability can be exploited by traversing directories to access sensitive information. It is essential to implement directory traversal protection mechanisms to prevent attackers from accessing unauthorized areas of the system."}], "stix_bundle": "STIX Bundle Follows", "technical_analysis": {"Introduction": "The vulnerable component is AEgir greater than or equal to 21.7.0 and less than 21.10.1. It is critical to identify and remediate these versions to prevent exploitation.", "Impact and Scope": "The vulnerability allows attackers to inject commands into environment variables, which can lead to the leakage of sensitive information. The CVSS score is 9.6, with a high severity rating.", "Related MITRE ATT&CK Techniques": "The related MITRE techniques are T1204, T1508, T1021, T1210, and T1045.", "Technical Details": "The vulnerability is caused by the injection of secrets from environment variables into the browser bundle. This allows attackers to access sensitive information remotely. To exploit this vulnerability, the attacker must first obtain access to the system.", "Detection": "Detection can be accomplished by monitoring environment variables and network traffic for suspicious activity.", "Mitigation": "To mitigate this vulnerability, it is essential to update AEgir to version 21.10.1 or later, monitor and log environment variables, and limit network access.", "Conclusion": "In conclusion, the vulnerability presents a significant risk to systems running AEgir greater than or equal to 21.7.0 and less than 21.10.1. It is critical to identify and remediate these versions to prevent exploitation."}, "executive_analysis": {"Overview": "The vulnerability presents a significant risk to systems running AEgir greater than or equal to 21.7.0 and less than 21.10.1.", "Business Impact": "The leakage of sensitive information and unauthorized access to the system can result in significant business disruption and reputational damage.", "Technical Impact": "The vulnerability allows attackers to inject commands into environment variables, which can lead to the leakage of sensitive information.", "Mitigation Strategies": "Implement strict network access controls, monitor and log environment variables, and update AEgir to version 21.10.1 or later.", "Recommendations": "Review software updates, implement configuration changes, and monitor system logs for suspicious activity.", "Conclusions": "In conclusion, the vulnerability presents a significant risk to systems running AEgir greater than or equal to 21.7.0 and less than 21.10.1. It is essential to identify and remediate these versions to prevent exploitation."}}