{"id": "CVE-2024-43816", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-17T10:15:07.950", "lastModified": "2024-08-19T12:59:59.177", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: lpfc: Revise lpfc_prep_embed_io routine with proper endian macro usages\n\nOn big endian architectures, it is possible to run into a memory out of\nbounds pointer dereference when FCP targets are zoned.\n\nIn lpfc_prep_embed_io, the memcpy(ptr, fcp_cmnd, sgl->sge_len) is\nreferencing a little endian formatted sgl->sge_len value.  So, the memcpy\ncan cause big endian systems to crash.\n\nRedefine the *sgl ptr as a struct sli4_sge_le to make it clear that we are\nreferring to a little endian formatted data structure.  And, update the\nroutine with proper le32_to_cpu macro usages."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: scsi: lpfc: Revisar la rutina lpfc_prep_embed_io con usos de macro endian adecuados. En arquitecturas big endian, es posible ejecutar una desreferencia de puntero de memoria fuera de los l\u00edmites cuando los objetivos FCP est\u00e1n divididos en zonas. En lpfc_prep_embed_io, memcpy(ptr, fcp_cmnd, sgl-&gt;sge_len) hace referencia a un valor sgl-&gt;sge_len con formato little endian. Por lo tanto, memcpy puede provocar que los sistemas big endian colapsen. Redefina *sgl ptr como una estructura sli4_sge_le para dejar claro que nos referimos a una estructura de datos con formato little endian. Y actualice la rutina con usos adecuados de la macro le32_to_cpu."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/8bc7c617642db6d8d20ee671fb6c4513017e7a7e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9fd003f344d502f65252963169df3dd237054e49", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-43816 - This technique can be used in-memory to exploit the vulnerability in the Linux kernel. Defend against this by implementing measures to detect and prevent in-memory exploitation."}, {"techniqueID": "T12", "comment": "CVE-2024-43816 - This technique involves exploiting the vulnerability in the Linux kernel, which can lead to a crash. Defend against this by implementing measures to detect and prevent system crashes."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "https://example.com/CVE-2024-43816", "created_by_ref": "https://example.com/ attacker", "updated": "2024-08-20T10:15:00.000", "created": "2024-08-20T10:15:00.000", "objects": [{"type": "vulnerability", "id": "https://example.com/CVE-2024-43816", "created_by_ref": "https://example.com/ attacker", "name": "Linux Kernel Vulnerability", "description": "In lpfc_prep_embed_io, the memcpy(ptr, fcp_cmnd, sgl->sge_len) is referencing a little endian formatted sgl->sge_len value.  So, the memcpy can cause big endian systems to crash.", "v2_0_id": "https://example.com/CVE-2024-43816"}, {"type": "indicator", "id": "https://example.com/Ind-1234", "created_by_ref": "https://example.com/ attacker", "name": "Memory Out-of-Bounds", "description": "Memory out-of-bounds access", "pattern": "memcpy(ptr, fcp_cmnd, sgl->sge_len)"}, {"type": "course-of-action", "id": "https://example.com/COA-1234", "created_by_ref": "https://example.com/ attacker", "name": "Memory Out-of-Bounds Detection", "description": "Detect memory out-of-bounds access using system logs and network traffic", "mitigating_tactic_id": "https://example.com/T1190"}], "relationships": [{"type": "related-to", "source_ref": "https://example.com/CVE-2024-43816", "target_ref": "https://example.com/Ind-1234"}, {"type": "mitigated-by", "source_ref": "https://example.com/COA-1234", "target_ref": "https://example.com/T1190"}]}, "technical_analysis": {"Introduction": "The CVE-2024-43816 vulnerability is a memory out-of-bounds vulnerability in the Linux kernel.", "Impact and Scope": "This vulnerability can cause big endian systems to crash and can be exploited in-memory.", "Related MITRE ATT&CK Techniques": "T1190 and T12", "Technical Details": "The vulnerability is caused by the misuse of the memcpy function in the lpfc_prep_embed_io routine.", "Detection": "Detect memory out-of-bounds access using system logs and network traffic.", "Mitigation": "Implement measures to detect and prevent in-memory exploitation.", "Conclusion": "The CVE-2024-43816 vulnerability is a serious security threat and should be mitigated and detected."}, "executive_analysis": {"Overview": "The CVE-2024-43816 vulnerability is a critical security issue in the Linux kernel.", "Business Impact": "This vulnerability can cause system crashes and data loss, resulting in significant business impact.", "Technical Impact": "The vulnerability can be exploited in-memory, making it difficult to detect and mitigate.", "Mitigation Strategies": "Implement measures to detect and prevent in-memory exploitation and crashes.", "Recommendations": "Recommendations for executives include implementing robust security measures and conducting regular security audits.", "Conclusions": "The CVE-2024-43816 vulnerability is a serious security threat and should be taken seriously by executives."}}