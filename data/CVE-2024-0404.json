{"id": "CVE-2024-0404", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-16T00:15:07.387", "lastModified": "2024-04-16T13:24:07.103", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A mass assignment vulnerability exists in the `/api/invite/:code` endpoint of the mintplex-labs/anything-llm repository, allowing unauthorized creation of high-privileged accounts. By intercepting and modifying the HTTP request during the account creation process via an invitation link, an attacker can add a `role` property with `admin` value, thereby gaining administrative access. This issue arises due to the lack of property allowlisting and blocklisting, enabling the attacker to exploit the system and perform actions as an administrator."}, {"lang": "es", "value": "Existe una vulnerabilidad de asignaci\u00f3n masiva en el endpoint `/api/invite/:code` del repositorio mintplex-labs/anything-llm, lo que permite la creaci\u00f3n no autorizada de cuentas con altos privilegios. Al interceptar y modificar la solicitud HTTP durante el proceso de creaci\u00f3n de la cuenta a trav\u00e9s de un enlace de invitaci\u00f3n, un atacante puede agregar una propiedad \"rol\" con valor \"admin\", obteniendo as\u00ed acceso administrativo. Este problema surge debido a la falta de listas de propiedades permitidas y bloqueadas, lo que permite al atacante explotar el sistema y realizar acciones como administrador."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-915"}]}], "references": [{"url": "https://github.com/mintplex-labs/anything-llm/commit/8cd3a92c660b202655d99bee90b2864694c99946", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/b4355bae-766a-4bb0-942b-607bc491b23d", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-0404 - This mass assignment vulnerability allows attackers to create high-privileged accounts by intercepting and modifying HTTP requests during the account creation process. Techniques like T1027 (Software Deployment) and T1036 (Masquerading) can be used to leverage this vulnerability."}, {"techniqueID": "T1036", "comment": "CVE-2024-0404 - This masquerading technique can be used to create a malicious invitation link that allows attackers to gain administrative access to the system."}, {"techniqueID": "T1204", "comment": "CVE-2024-0404 - This code injection technique can be used to inject malicious code into the system by modifying the HTTP request during the account creation process."}, {"techniqueID": "T1068", "comment": "CVE-2024-0404 - This exploit public-facing application technique can be used to exploit the mass assignment vulnerability in the mintplex-labs/anything-llm repository."}, {"techniqueID": "T1210", "comment": "CVE-2024-0404 - This software installation technique can be used to install malware on the system by creating a malicious invitation link that allows attackers to gain administrative access."}], "stix_bundle": {"bundle": {"@type": "stix:Bundle", "description": "Vulnerability Detection and Mitigation Bundle for CVE-2024-0404", "created_by_ref": " https://stix2.readthedocs.io/en/latest/examplebundle.html", "modified": "2024-04-16T00:15:07.387", "objects": [{"@type": "stix:Vulnerability", "id": "CVE-2024-0404", "description": "A mass assignment vulnerability exists in the `/api/invite/:code` endpoint of the mintplex-labs/anything-llm repository, allowing unauthorized creation of high-privileged accounts.", "title": "CVE-2024-0404: Mass Assignment Vulnerability in mintplex-labs/anything-llm", "severity": "CRITICAL", "impact": {"@type": "stix:CveImpact", "confidentiality": {"@type": "stix:Impact", "value": "HIGH", "impactDescription": "High Impact"}, "integrity": {"@type": "stix:Impact", "value": "HIGH", "impactDescription": "High Impact"}, "availability": {"@type": "stix:Impact", "value": "NONE", "impactDescription": "No Impact"}}, "affected_components": [{"@type": "stix:Component", "id": "mintplex-labs/anything-llm", "role": "Target", "relationship": "Vulnerable"}], "mitre_attack_id": "T1027", "mitre_attack_name": "Software Deployment"}, {"@type": "stix:Detect", "id": "CVE-2024-0404-Detect", "stix_layer": "Signature Detection", "feed_id": "Vulnerability", "patterns": [{"@type": "stix:Pattern", "pattern": "http://example.com/api/invite/:code"}], "recommendation": "This vulnerability can be detected by monitoring network traffic for HTTP requests to the `/api/invite/:code` endpoint."}, {"@type": "stix:Mitigate", "id": "CVE-2024-0404-Mitigate", "stix_layer": "Network Security", "feed_id": "Vulnerability", "steps": [{"@type": "stix:Step", "step": "Block HTTP requests to the `/api/invite/:code` endpoint at the network perimeter."}], "recommendation": "This vulnerability can be mitigated by blocking HTTP requests to the `/api/invite/:code` endpoint at the network perimeter."}]}}, "technical_analysis": {"Introduction": "This vulnerability is a mass assignment vulnerability in the `/api/invite/:code` endpoint of the mintplex-labs/anything-llm repository, allowing unauthorized creation of high-privileged accounts.", "Impact and Scope": "This vulnerability has a CVSS score of 9.1 (CRITICAL) and can have a significant impact on the confidentiality, integrity, and availability of the system.", "Related MITRE ATT&CK Techniques": "T1027, T1036, T1204, T1068, and T1210", "Technical Details": "This vulnerability is due to the lack of property allowlisting and blocklisting, enabling the attacker to exploit the system and perform actions as an administrator.", "Detection": "This vulnerability can be detected by monitoring network traffic for HTTP requests to the `/api/invite/:code` endpoint.", "Mitigation": "This vulnerability can be mitigated by blocking HTTP requests to the `/api/invite/:code` endpoint at the network perimeter.", "Conclusion": "This vulnerability is a critical issue that must be addressed immediately to prevent unauthorized access to high-privileged accounts."}, "executive_analysis": {"Overview": "This vulnerability is a mass assignment vulnerability in the `/api/invite/:code` endpoint of the mintplex-labs/anything-llm repository, allowing unauthorized creation of high-privileged accounts.", "Business Impact": "This vulnerability can have a significant impact on the business, as it can allow attackers to gain administrative access to the system.", "Technical Impact": "This vulnerability can have a significant technical impact, as it can allow attackers to exploit the system and perform actions as an administrator.", "Mitigation Strategies": "Blocking HTTP requests to the `/api/invite/:code` endpoint at the network perimeter and implementing property allowlisting and blocklisting can mitigate this vulnerability.", "Recommendations": "This vulnerability should be addressed immediately, and regular vulnerability scanning and penetration testing should be performed to identify and remediate vulnerabilities.", "Conclusions": "This vulnerability is a critical issue that must be addressed immediately to prevent unauthorized access to high-privileged accounts."}}