{"id": "CVE-2024-40945", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-12T13:15:16.853", "lastModified": "2024-07-12T16:34:58.687", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\niommu: Return right value in iommu_sva_bind_device()\n\niommu_sva_bind_device() should return either a sva bond handle or an\nERR_PTR value in error cases. Existing drivers (idxd and uacce) only\ncheck the return value with IS_ERR(). This could potentially lead to\na kernel NULL pointer dereference issue if the function returns NULL\ninstead of an error pointer.\n\nIn reality, this doesn't cause any problems because iommu_sva_bind_device()\nonly returns NULL when the kernel is not configured with CONFIG_IOMMU_SVA.\nIn this case, iommu_dev_enable_feature(dev, IOMMU_DEV_FEAT_SVA) will\nreturn an error, and the device drivers won't call iommu_sva_bind_device()\nat all."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: iommu: Devuelve el valor correcto en iommu_sva_bind_device() iommu_sva_bind_device() deber\u00eda devolver un identificador de enlace sva o un valor ERR_PTR en casos de error. Los controladores existentes (idxd y uacce) solo verifican el valor de retorno con IS_ERR(). Esto podr\u00eda provocar un problema de desreferencia del puntero NULL del kernel si la funci\u00f3n devuelve NULL en lugar de un puntero de error. En realidad, esto no causa ning\u00fan problema porque iommu_sva_bind_device() solo devuelve NULL cuando el kernel no est\u00e1 configurado con CONFIG_IOMMU_SVA. En este caso, iommu_dev_enable_feature(dev, IOMMU_DEV_FEAT_SVA) devolver\u00e1 un error y los controladores del dispositivo no llamar\u00e1n a iommu_sva_bind_device() en absoluto."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/2973b8e7d127754de9013177c41c0b5547406998", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/61a96da9649a6b6a1a5d5bde9374b045fdb5c12e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/700f564758882db7c039dfba9443fe762561a3f8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/7388ae6f26c0ba95f70cc96bf9c5d5cb06c908b6", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/89e8a2366e3bce584b6c01549d5019c5cda1205e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/cf34f8f66982a36e5cba0d05781b21ec9606b91e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-40945 - The vulnerability in the Linux kernel's iommu_sva_bind_device() function could potentially lead to a kernel NULL pointer dereference issue, making it a target for exploitation."}, {"techniqueID": "T1077", "comment": "CVE-2024-40945 - The vulnerable function returns an incorrect value, making it possible for attackers to manipulate the system and execute arbitrary code."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "https:// git.kernel.org/stable/c/2973b8e7d127754de9013177c41c0b5547406998", "created_by_ref": "https://mitre-attack.taxonome.dev/techniques/T1190", "relation_to_vulnerability": {"type": "characterizes", "description": "This technique can be used to exploit the vulnerability in the Linux kernel's iommu_sva_bind_device() function."}}, {"type": "vulnerability", "id": "https://git.kernel.org/stable/c/61a96da9649a6b6a1a5d5bde9374b045fdb5c12e", "created_by_ref": "https://mitre-attack.taxonome.dev/techniques/T1077", "relation_to_vulnerability": {"type": "detection", "description": "Defense strategies such as anomaly detection and network segmentation can help identify and prevent exploitation."}}], "bundle_type": "indicator", "bundle_label": "CVE-2024-40945- MITRE ATT&CK Techniques and D3FEND Tactics", "bundle_description": "MITRE ATT&CK Techniques and D3FEND Tactics for CVE-2024-40945, a vulnerability in the Linux kernel's iommu_sva_bind_device() function."}, "technical_analysis": {"Introduction": "CVE-2024-40945 is a vulnerability in the Linux kernel's iommu_sva_bind_device() function that could potentially lead to a kernel NULL pointer dereference issue.", "Impact and Scope": "The impact is a kernel NULL pointer dereference issue, making it possible for attackers to manipulate the system and execute arbitrary code. The scope is limited to Linux systems with the iommu_sva device enabled.", "Related MITRE ATT&CK Techniques": "T1190 and T1077", "Technical Details": "The vulnerable function returns an incorrect value, making it possible for attackers to manipulate the system and execute arbitrary code.", "Detection": "Anomaly detection and network segmentation can help identify and prevent exploitation.", "Mitigation": "Patch the vulnerable function and enable kernel memory protection.", "Conclusion": "Conclusion: CVE-2024-40945 is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-40945 is a critical vulnerability in the Linux kernel that could have serious consequences for the confidentiality, integrity, and availability of data.", "Business Impact": "The business impact of this vulnerability is significant, as it could allow attackers to manipulate systems and execute arbitrary code.", "Technical Impact": "The technical impact is a kernel NULL pointer dereference issue, making it possible for attackers to manipulate the system and execute arbitrary code.", "Mitigation Strategies": "Patch the vulnerable function and enable kernel memory protection.", "Recommendations": "Recommendations are to patch the vulnerable function and enable kernel memory protection, and to implement robust security measures to prevent exploitation.", "Conclusions": "Conclusions: CVE-2024-40945 is a critical vulnerability that requires immediate attention and mitigation."}}