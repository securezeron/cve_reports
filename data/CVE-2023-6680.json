{"id": "CVE-2023-6680", "sourceIdentifier": "cve@gitlab.com", "published": "2023-12-15T16:15:46.737", "lastModified": "2023-12-19T20:51:03.237", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An improper certificate validation issue in Smartcard authentication in GitLab EE affecting all versions from 11.6 prior to 16.4.4, 16.5 prior to 16.5.4, and 16.6 prior to 16.6.2 allows an attacker to authenticate as another user given their public key if they use Smartcard authentication. Smartcard authentication is an experimental feature and has to be manually enabled by an administrator."}, {"lang": "es", "value": "Un problema de validaci\u00f3n de certificado incorrecto en la autenticaci\u00f3n de tarjeta inteligente en GitLab EE que afecta a todas las versiones desde 11.6 anterior a 16.4.4, 16.5 anterior a 16.5.4 y 16.6 anterior a 16.6.2 permite a un atacante autenticarse como otro usuario dada su clave p\u00fablica si utilizar la autenticaci\u00f3n con tarjeta inteligente. La autenticaci\u00f3n con tarjeta inteligente es una funci\u00f3n experimental y un administrador debe habilitarla manualmente."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.9}, {"source": "cve@gitlab.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.2}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-295"}]}, {"source": "cve@gitlab.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-295"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "11.6", "versionEndExcluding": "16.4.4", "matchCriteriaId": "289EDE8D-E3DC-4000-A0BD-71E7389F631F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "16.5", "versionEndExcluding": "16.5.4", "matchCriteriaId": "B9D88266-872E-4BD9-B3DF-D1C540E66AFD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "16.6", "versionEndExcluding": "16.6.2", "matchCriteriaId": "D5C45787-C8C9-432E-8DAF-6F5264BBE0B3"}]}]}], "references": [{"url": "https://gitlab.com/gitlab-org/gitlab/-/issues/421607", "source": "cve@gitlab.com", "tags": ["Broken Link"]}], "techniques": [{"techniqueID": "T1196", "comment": "CVE-2023-6680 - Improper Certificate Validation in Smartcard Authentication, an attacker can authenticate as another user given their public key, if they use Smartcard authentication, which is an experimental feature that has to be manually enabled by an administrator. This allows an attacker to bypass authentication controls."}, {"techniqueID": "T1193", "comment": "CVE-2023-6680 - Authentication Bypass, an attacker can authenticate as another user given their public key, if they use Smartcard authentication, which is an experimental feature that has to be manually enabled by an administrator."}, {"techniqueID": "T1555", "comment": "CVE-2023-6680 - User Privilege Abuse, an attacker can authenticate as another user given their public key, if they use Smartcard authentication, which is an experimental feature that has to be manually enabled by an administrator, allowing the attacker to access sensitive data."}], "stix_bundle": {"objects": [{"id": "vulnerability:CVE-2023-6680", "type": "vulnerability", "name": "CVE-2023-6680: Improper Certificate Validation in Smartcard Authentication", "description": "An improper certificate validation issue in Smartcard authentication in GitLab EE, affecting all versions from 11.6 prior to 16.4.4, 16.5 prior to 16.5.4, and 16.6 prior to 16.6.2, allows an attacker to authenticate as another user given their public key if they use Smartcard authentication.", "score": 8.1, "cvss": {"environmental_score": 0, "attack_vector": "NETWORK", "attack_complexity": "HIGH", "privileges_required": "NONE", "user_interaction": "NONE", "scope": "UNCHANGED", "confidentiality_impact": "HIGH", "integrity_impact": "HIGH", "availability_impact": "HIGH"}, "weaknesses": [{"id": "weakness:CWE-295", "type": "weakness", "name": "CWE-295:Improper Certificate Verification", "description": "An improper certificate verification issue allows an attacker to authenticate as another user given their public key."}], "configurations": [{"id": "configuration:GitLab EE", "type": "configuration", "name": "GitLab EE Configuration", "description": "GitLab EE configuration vulnerable to CVE-2023-6680"}]}, {"id": "course-of-action:Defense Strategy", "type": "course-of-action", "name": "Defense Strategy", "description": "Implement a defense strategy that includes segmenting critical systems, implementing network segmentation, and restricting access to sensitive data.", "notes": [{"id": "note:restrict_access", "type": "note", "text": "Restrict access to sensitive data to minimize the impact of a potential attack."}]}, {"id": "techncal_control:Segmentation", "type": "technical_control", "name": "Segmentation", "description": "Implement network segmentation to isolate critical systems and prevent lateral movement.", ".mitigates": ["course-of-action:Defense Strategy"]}, {"id": "techncal_control:Access_Restriction", "type": "technical_control", "name": "Access Restriction", "description": "Implement access restriction to sensitive data to minimize the impact of a potential attack.", ".mitigates": ["course-of-action:Defense Strategy"]}], "relationships": [{"relationship": "affects", "object_id": "vulnerability:CVE-2023-6680", "related_id": "course-of-action:Defense Strategy"}, {"relationship": "mitigated_by", "object_id": "course-of-action:Defense Strategy", "related_id": "techncal_control:Segmentation"}, {"relationship": "mitigated_by", "object_id": "course-of-action:Defense Strategy", "related_id": "techncal_control:Access_Restriction"}]}, "technical_analysis": {"Introduction": "This technical analysis provides an in-depth look at the CVE-2023-6680 vulnerability in GitLab EE. The vulnerability allows an attacker to authenticate as another user given their public key if they use Smartcard authentication.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 8.1. The scope of the vulnerability is limited to GitLab EE users who use Smartcard authentication.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to MITRE ATT&CK techniques T1196, T1193, and T1555", "Technical Details": "The vulnerability is caused by an improper certificate validation issue in Smartcard authentication, allowing an attacker to authenticate as another user given their public key.", "Detection": "Detection of this vulnerability requires monitoring network traffic and system logs for suspicious activity.", "Mitigation": "To mitigate this vulnerability, implement a defense strategy that includes segmenting critical systems, implementing network segmentation, and restricting access to sensitive data.", "Conclusion": "In conclusion, this technical analysis provides an in-depth look at the CVE-2023-6680 vulnerability in GitLab EE. The vulnerability allows an attacker to authenticate as another user given their public key if they use Smartcard authentication, and is related to MITRE ATT&CK techniques T1196, T1193, and T1555."}, "executive_analysis": {"Overview": "This executive analysis provides a high-level overview of the CVE-2023-6680 vulnerability in GitLab EE.", "Business Impact": "The business impact of this vulnerability is high, as it allows an attacker to authenticate as another user given their public key if they use Smartcard authentication.", "Technical Impact": "The technical impact of this vulnerability is limited to GitLab EE users who use Smartcard authentication.", "Mitigation Strategies": "To mitigate this vulnerability, implement a defense strategy that includes segmenting critical systems, implementing network segmentation, and restricting access to sensitive data.", "Recommendations": "Recommendations for executives include implementing a defense strategy to mitigate this vulnerability and conducting regular security assessments to identify similar vulnerabilities.", "Conclusions": "In conclusion, this executive analysis provides a high-level overview of the CVE-2023-6680 vulnerability in GitLab EE. The vulnerability allows an attacker to authenticate as another user given their public key if they use Smartcard authentication, and is related to MITRE ATT&CK techniques T1196, T1193, and T1555."}}