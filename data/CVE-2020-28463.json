{"id": "CVE-2020-28463", "sourceIdentifier": "report@snyk.io", "published": "2021-02-18T16:15:12.707", "lastModified": "2023-11-07T03:21:22.187", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "All versions of package reportlab are vulnerable to Server-side Request Forgery (SSRF) via img tags. In order to reduce risk, use trustedSchemes & trustedHosts (see in Reportlab's documentation) Steps to reproduce by Karan Bamal: 1. Download and install the latest package of reportlab 2. Go to demos -> odyssey -> dodyssey 3. In the text file odyssey.txt that needs to be converted to pdf inject <img src=\"http://127.0.0.1:5000\" valign=\"top\"/> 4. Create a nc listener nc -lp 5000 5. Run python3 dodyssey.py 6. You will get a hit on your nc showing we have successfully proceded to send a server side request 7. dodyssey.py will show error since there is no img file on the url, but we are able to do SSRF"}, {"lang": "es", "value": "Todas las versiones del paquete reportlab son vulnerables a un ataque de tipo Server-side Request Forgery (SSRF) por medio de etiquetas img.&#xa0;Para reducir el riesgo, utilice TrustSchemes y TrustHosts (consulte la documentaci\u00f3n de Reportlab). Pasos para reproducir por Karan Bamal: 1. Descargue e instale el \u00faltimo paquete de reportlab 2. Vaya a demos -) odyssey -) dodyssey 3. En el archivo de texto odyssey.txt que necesita ser convertido a pdf inyecte (img src=\"http://127.0.0.1:5000\" valign= top\" /) 4. Cree un oyente nc nc -lp 5000 5. Ejecute python3 dodyssey.py 6. Recibir\u00e1 un resultado en su nc que muestra que hemos procedido con \u00e9xito a enviar una petici\u00f3n del lado del servidor 7. dodyssey.py mostrar\u00e1 un error ya que no contiene un archivo img en la URL, pero somos capaces de hacer un ataque de tipo SSRF"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "report@snyk.io", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-918"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:reportlab:reportlab:*:*:*:*:*:*:*:*", "matchCriteriaId": "96329C58-2A30-4D2E-A421-B7FF3BC6CF55"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*", "matchCriteriaId": "A930E247-0B43-43CB-98FF-6CE7B8189835"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*", "matchCriteriaId": "80E516C0-98A4-4ADE-B69F-66A772E2BAAA"}]}]}], "references": [{"url": "https://lists.debian.org/debian-lts-announce/2023/09/msg00037.html", "source": "report@snyk.io"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/HMUJA5GZTPQ5WRYUCCK2GEZM4W43N7HH/", "source": "report@snyk.io"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/YZQSFCID67K6BTC655EQY6MNOF35QI44/", "source": "report@snyk.io"}, {"url": "https://snyk.io/vuln/SNYK-PYTHON-REPORTLAB-1022145", "source": "report@snyk.io", "tags": ["Exploit", "Release Notes", "Third Party Advisory"]}, {"url": "https://www.reportlab.com/docs/reportlab-userguide.pdf", "source": "report@snyk.io", "tags": ["Product", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2020-28463 - ReportLab SSRF vulnerability allows an attacker to send server-side requests, potentially leading to remote code execution. Defend against this by ensuring trustedSchemes and trustedHosts are set in ReportLab's configuration."}, {"techniqueID": "T1190", "comment": " CVE-2020-28463 - ReportLab SSRF vulnerability could be used to perform reconnaissance and gather sensitive information. Detect suspicious network traffic and invalid requests to prevent exploitation."}, {"techniqueID": "T1214", "comment": "CVE-2020-28463 - ReportLab SSRF vulnerability can be used to pivot and gain access to internal systems. Implement network segmentation and strict access controls to mitigate the impact of this vulnerability."}, {"techniqueID": "T1558", "comment": "CVE-2020-28463 - ReportLab SSRF vulnerability can be used to perform command and control communication. Monitor for suspicious network traffic and implement network filtering to prevent exploitation."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "CVE-2020-28463", "created_by_ref": "report@snyk.io", "created": "2021-02-18T16:15:12.707Z", "modified": "2023-11-07T03:21:22.187Z", "objects": [{"type": "vulnerability", "id": "CVE-2020-28463", "description": "ReportLab SSRF vulnerability"}, {"type": "incident", "id": "ReportLab SSRF Incident", "description": "ReportLab SSRF vulnerability exploitation detected", "vulnerability_refs": ["CVE-2020-28463"]}, {"type": "indicator", "id": "ReportLab SSRF Indicator", "description": "Suspicious network traffic related to ReportLab SSRF vulnerability", "vulnerability_refs": ["CVE-2020-28463"], "observed_data_refs": ["ReportLab SSRF Observation"]}, {"type": "course_of_action", "id": "ReportLab SSRF Mitigation", "description": "Implement trustedSchemes and trustedHosts in ReportLab's configuration", "mitigates": ["CVE-2020-28463"]}, {"type": "course_of_action", "id": "ReportLab SSRF Detection", "description": "Monitor for suspicious network traffic and implement network filtering", "detects": ["CVE-2020-28463"]}], "relationships": [{"relationship_type": "vulnerability-exploited", "parent_ref": "CVE-2020-28463", "child_ref": "ReportLab SSRF Incident"}, {"relationship_type": "indicator-related", "parent_ref": "ReportLab SSRF Indicator", "child_ref": "CVE-2020-28463"}, {"relationship_type": "course_of_action-mitigates", "parent_ref": "ReportLab SSRF Mitigation", "child_ref": "CVE-2020-28463"}, {"relationship_type": "course_of_action-detects", "parent_ref": "ReportLab SSRF Detection", "child_ref": "CVE-2020-28463"}]}}, "technical_analysis": {"Introduction": "CVE-2020-28463 is a ReportLab SSRF vulnerability that can be exploited to send server-side requests, potentially leading to remote code execution.", "Impact and Scope": "The vulnerability affects all versions of ReportLab and has a CVSS score of 6.5 (MEDIUM). It can be used to perform reconnaissance, gather sensitive information, and pivot to gain access to internal systems.", "Related MITRE ATT&CK Techniques": "T1210, T1190, T1214, and T1558", "Technical Details": "The vulnerability is caused by the lack of validation of img tags in ReportLab's configuration. An attacker can use this to send server-side requests and potentially execute code.", "Detection": "Detect suspicious network traffic and invalid requests to prevent exploitation.", "Mitigation": "Implement trustedSchemes and trustedHosts in ReportLab's configuration and monitor for suspicious network traffic.", "Conclusion": "The CVE-2020-28463 vulnerability is a significant threat that can be exploited to gain access to internal systems. It is essential to implement mitigation strategies and monitor for suspicious activity."}, "executive_analysis": {"Overview": "The CVE-2020-28463 vulnerability is a critical issue that affects ReportLab and can be exploited to gain access to internal systems.", "Business Impact": "The vulnerability can be used to steal sensitive information, disrupt business operations, and compromise the confidentiality, integrity, and availability of data and systems.", "Technical Impact": "The vulnerability can be used to gain access to internal systems, steal sensitive information, and disrupt business operations.", "Mitigation Strategies": "Implement trustedSchemes and trustedHosts in ReportLab's configuration, monitor for suspicious network traffic, and restrict access to internal systems.", "Recommendations": "Recommend implementing additional security controls, such as network segmentation and strict access controls, and conducting regular security assessments to detect and respond to potential threats.", "Conclusions": "The CVE-2020-28463 vulnerability is a significant threat that requires immediate attention and action. Implementing mitigation strategies and monitoring for suspicious activity is crucial to preventing exploitation."}}