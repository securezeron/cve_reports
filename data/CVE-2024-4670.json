{"id": "CVE-2024-4670", "sourceIdentifier": "security@wordfence.com", "published": "2024-05-15T13:15:26.503", "lastModified": "2024-05-15T16:40:19.330", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The All-in-One Video Gallery plugin for WordPress is vulnerable to Local File Inclusion in all versions up to, and including, 3.6.5 via the aiovg_search_form shortcode. This makes it possible for authenticated attackers, with contributor-level access and above, to include and execute arbitrary files on the server, allowing the execution of any PHP code in those files. This can be used to bypass access controls, obtain sensitive data, or achieve code execution in cases where images and other \u201csafe\u201d file types can be uploaded and included."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "references": [{"url": "https://plugins.trac.wordpress.org/changeset/3085217/all-in-one-video-gallery", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/e2793547-5edf-4d2a-bc3b-fcaeed62963d?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "TA0001", "comment": " CVE-2024-4670 is a Local File Inclusion vulnerability, which is an attacker's dream come true. With the technique 'Initial Access', an attacker can exploit this vulnerability to gain access to the system and executes arbitrary PHP code. This can lead to the execution of any PHP code, bypassing access controls, obtaining sensitive data, or achieving code execution."}, {"techniqueID": "TA0003", "comment": "Once the attacker gains access to the system, they can use the 'Execution' technique to execute the arbitrary PHP code. This technique can be used to bypass access controls, obtain sensitive data, or achieve code execution."}, {"techniqueID": "TA0005", "comment": "The attacker can also use the ' Privilege Escalation' technique to escalate their privileges and execute sensitive files or move laterally within the network."}, {"techniqueID": "TA0012", "comment": "The 'Data Stewardship' technique can be used to exfiltrate sensitive data from the system."}], "stix_bundle": {"stix_bundles": [{"bundle_id": "cve-2024-4670-bundle", "bundle_name": "CVE-2024-4670: All-in-One Video Gallery Plugin for WordPress", "bundle_description": "This STIX bundle provides information about the All-in-One Video Gallery plugin for WordPress, including its vulnerability details, technical analysis, and mitigation strategies.", "bundle_created_by": "Jane Doe", "bundle_created": "2024-05-15T13:15:26.503", "bundle_modified_by": "John Smith", "bundle_modified": "2024-05-15T16:40:19.330", "bundle_ id_ref": {"id_type": "cve", "id_value": "CVE-2024-4670", "reference": ["https://plugins.trac.wordpress.org/changeset/3085217/all-in-one-video-gallery", "https://www.wordfence.com/threat-intel/vulnerabilities/id/e2793547-5edf-4d2a-bc3b-fcaeed62963d?source=cve"]}, "attack_pattern": {"attack_id": "cve-2024-4670-attack", "attack_name": "CVE-2024-4670: Local File Inclusion in All-in-One Video Gallery Plugin for WordPress", "attack_description": "This attack pattern provides information about the Local File Inclusion vulnerability in the All-in-One Video Gallery plugin for WordPress.", "attack_id_ref": {"id_type": "cve", "id_value": "CVE-2024-4670"}}, "indicator": {"indicator_id": "cve-2024-4670-indicator", "indicator_name": "CVE-2024-4670: All-in-One Video Gallery Plugin for WordPress", "indicator_description": "This indicator provides information about the indicator for the CVE-2024-4670 vulnerability in the All-in-One Video Gallery plugin for WordPress.", "indicator_ref": {"id_type": "cve", "id_value": "CVE-2024-4670"}}}]}, "technical_analysis": {"Introduction": "The All-in-One Video Gallery plugin for WordPress is vulnerable to Local File Inclusion due to the aiovg_search_form shortcode, allowing attackers to include and execute arbitrary files on the server.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 with a base severity of HIGH. It allows attackers to bypass access controls, obtain sensitive data, or achieve code execution.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are Initial Access, Execution, Privilege Escalation, and Data Stewardship.", "Technical Details": "The vulnerability occurs when the aiovg_search_form shortcode is used with an arbitrary file name, allowing attackers to include and execute that file.", "Detection": "Detection methods include monitoring system logs for suspicious file inclusion attempts and monitoring network traffic for anomalous behavior.", "Mitigation": "Mitigation strategies include updating the All-in-One Video Gallery plugin to a version less than or equal to 3.6.5, and blocking suspicious file inclusion attempts.", "Conclusion": "The vulnerability in the All-in-One Video Gallery plugin for WordPress is a significant threat and requires prompt attention to ensure the security of sensitive data."}, "executive_analysis": {"Overview": "The All-in-One Video Gallery plugin for WordPress is vulnerable to Local File Inclusion, allowing attackers to bypass access controls, obtain sensitive data, or achieve code execution.", "Business Impact": "The vulnerability can have significant business impacts, including data breaches, financial losses, and reputational damage.", "Technical Impact": "The vulnerability has a significant technical impact, allowing attackers to execute arbitrary code and potentially gain control of the system.", "Mitigation Strategies": "Mitigation strategies include updating the All-in-One Video Gallery plugin to a version less than or equal to 3.6.5 and blocking suspicious file inclusion attempts.", "Recommendations": "We recommend that all organizations using the All-in-One Video Gallery plugin for WordPress update to the latest version and monitor for any suspicious activity.", "Conclusions": "In conclusion, the vulnerability in the All-in-One Video Gallery plugin for WordPress is a significant threat that requires prompt attention to ensure the security of sensitive data."}}