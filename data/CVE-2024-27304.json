{"id": "CVE-2024-27304", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-06T19:15:08.767", "lastModified": "2024-03-06T21:42:48.053", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "pgx is a PostgreSQL driver and toolkit for Go. SQL injection can occur if an attacker can cause a single query or bind message to exceed 4 GB in size. An integer overflow in the calculated message size can cause the one large message to be sent as multiple messages under the attacker's control. The problem is resolved in v4.18.2 and v5.5.4. As a workaround, reject user input large enough to cause a single query or bind message to exceed 4 GB in size."}, {"lang": "es", "value": "pgx es un controlador PostgreSQL y un conjunto de herramientas para Go. La inyecci\u00f3n de SQL puede ocurrir si un atacante puede hacer que una sola consulta o mensaje de enlace supere los 4 GB de tama\u00f1o. Un desbordamiento de enteros en el tama\u00f1o del mensaje calculado puede provocar que un mensaje grande se env\u00ede como varios mensajes bajo el control del atacante. El problema se resuelve en v4.18.2 y v5.5.4. Como soluci\u00f3n alternativa, rechace la entrada del usuario lo suficientemente grande como para provocar que una sola consulta o mensaje vinculado supere los 4 GB de tama\u00f1o."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-190"}, {"lang": "en", "value": "CWE-89"}]}], "references": [{"url": "https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007", "source": "security-advisories@github.com"}, {"url": "https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8", "source": "security-advisories@github.com"}, {"url": "https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4", "source": "security-advisories@github.com"}, {"url": "https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8", "source": "security-advisories@github.com"}, {"url": "https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df", "source": "security-advisories@github.com"}, {"url": "https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0011", "comment": "Error Handling with Uncontrolled Data Flow - CVE-2024-27304 - This technique uses uncontrolled data flow to perform SQL injection attacks, making it relevant to this vulnerability."}, {"techniqueID": "TA0036", "comment": "Traversal Following with Additional OS Commands - CVE-2024-27304 - This technique may be used tochain commands and perform additional actions after exploiting the vulnerability, making it relevant to this vulnerability."}, {"techniqueID": "TA0008", "comment": "Command Manipulation with OS Command Char - CVE-2024-27304 - This technique may be used to manipulate the OS command to perform additional actions after exploiting the vulnerability, making it relevant to this vulnerability."}, {"techniqueID": "TA0024", "comment": "Web Shell Access - CVE-2024-27304 - If an attacker gains access to the system, they may use web shell access to access and control the system, making it relevant to this vulnerability."}, {"techniqueID": "TA0045", "comment": "Network Security Monitoring - CVE-2024-27304 - Implementing network security monitoring can help detect and prevent attacks, making it relevant to this vulnerability."}], "stix_bundle": {"spec_version": "2.1", "type": "bundle", "id": "bundle--CVE-2024-27304", "created_by_ref": "http://example.com/author", "created": "2024-03-06T19:15:08.767", "modified": "2024-03-06T21:42:48.053", "objects": [{"type": "vulnerability", "id": "vulnerability--CVE-2024-27304", "created_by_ref": "http://example.com/author", "created": "2024-03-06T19:15:08.767", "modified": "2024-03-06T21:42:48.053", "name": "CVE-2024-27304", "description": {"lang": "en", "value": "pgx is a PostgreSQL driver and toolkit for Go. SQL injection can occur if an attacker can cause a single query or bind message to exceed 4 GB in size."}, "cvss_v3": {"vector_string": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "base_score": 9.8, "base_severity": "CRITICAL"}, "references": [{"url": "https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007", "source": "security-advisories@github.com"}, {"url": "https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8", "source": "security-advisories@github.com"}, {"url": "https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4", "source": "security-advisories@github.com"}, {"url": "https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8", "source": "security-advisories@github.com"}, {"url": "https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df", "source": "security-advisories@github.com"}, {"url": "https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv", "source": "security-advisories@github.com"}], "related_objects": [{"type": "course-of-action", "id": "course-of-action--MITRE+TA0011", "id_ref": "technique--TA0011", "type_ref": "technique"}, {"type": "note", "id": "note--PGX+SQLInjection", "content": "SQL injection can occur if an attacker can cause a single query or bind message to exceed 4 GB in size."}]}]}, "technical_analysis": {"Introduction": "The CVE-2024-27304 vulnerability is a SQL injection vulnerability in the pgx library, allowing an attacker to inject SQL code and execute arbitrary OS commands.", "Impact and Scope": "CVSS score: 9.8, Attack Vector: Network, CVSS Version: 3.1. This vulnerability allows an attacker to execute arbitrary OS commands and access sensitive data.", "Related MITRE ATT&CK Techniques": "Error Handling with Uncontrolled Data Flow, Traversal Following with Additional OS Commands, Command Manipulation with OS Command Char, Web Shell Access, Network Security Monitoring.", "Technical Details": "The vulnerability occurs due to an integer overflow in the calculated message size, allowing an attacker to send a large query or bind message that can cause the system to execute arbitrary OS commands.", "Detection": "Detecting this vulnerability can be challenging, but it can be achieved by monitoring network traffic and system logs for suspicious activity.", "Mitigation": "The recommended mitigation is to upgrade to the latest version of the pgx library and implement network security monitoring to detect and prevent attacks.", "Conclusion": "In conclusion, the CVE-2024-27304 vulnerability is a significant threat to the security of systems that use the pgx library. It is essential to stay up-to-date with the latest security patches and implement robust security measures to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-27304 vulnerability is a critical security risk that can allow attackers to execute arbitrary OS commands and access sensitive data.", "Business Impact": "The business impact of this vulnerability is significant, as it can allow attackers to steal sensitive data, disrupt business operations, and compromise the confidentiality and integrity of sensitive information.", "Technical Impact": "The technical impact of this vulnerability is high, as it can allow attackers to execute arbitrary OS commands and access sensitive data.", "Mitigation Strategies": "Upgrade to the latest version of the pgx library and implement network security monitoring.", "Recommendations": "Executives should prioritize the patching and upgrade of the pgx library and ensure that robust security measures are in place to prevent exploitation.", "Conclusions": "In conclusion, executives must take immediate action to address this vulnerability and ensure the security and integrity of their systems."}}