{"id": "CVE-2024-0759", "sourceIdentifier": "security@huntr.dev", "published": "2024-02-27T06:15:45.493", "lastModified": "2024-03-07T20:15:50.480", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Should an instance of AnythingLLM be hosted on an internal network and the attacked be explicitly granted a permission level of manager or admin, they could link-scrape internally resolving IPs of other services that are on the same network as AnythingLLM.\n\nThis would require the attacker also be able to guess these internal IPs as `/*` ranging is not possible, but could be brute forced.\n\nThere is a duty of care that other services on the same network would not be fully open and accessible via a simple CuRL with zero authentication as it is not possible to set headers or access via the link collector."}, {"lang": "es", "value": "Si una instancia de AnythingLLM est\u00e1 alojada en una red interna y al atacado se le concede expl\u00edcitamente un nivel de permiso de administrador o administrador, podr\u00edan vincular IP de resoluci\u00f3n interna de otros servicios que est\u00e9n en la misma red que AnythingLLM. Esto requerir\u00eda que el atacante tambi\u00e9n pudiera adivinar estas IP internas, ya que el rango `/*` no es posible, pero podr\u00eda ser forzado de forma bruta. Existe el deber de tener cuidado de que otros servicios en la misma red no est\u00e9n completamente abiertos y accesibles a trav\u00e9s de un CuRL simple sin autenticaci\u00f3n, ya que no es posible configurar encabezados o acceder a trav\u00e9s del recopilador de enlaces."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.1, "impactScore": 4.0}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-918"}]}], "references": [{"url": "https://github.com/mintplex-labs/anything-llm/commit/0db6c3b2aa1787a7054ffdaba975474f122c20eb", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/9a978edd-ac94-41fc-8e3e-c35441bdd12b", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-0759 - Unlinking Internal IPs to link-scrape internally resolving IPs of other services on the same network. This technique could be used to gather information and potentially escalate privileges."}, {"techniqueID": "T1018", "comment": "CVE-2024-0759 - Brute-forcing internal IPs to link-scrape internally resolving IPs of other services on the same network. This technique could be used to gather information and potentially escalate privileges."}, {"techniqueID": "T1078", "comment": "CVE-2024-0759 - Using a pre-authenticated link to access a CuRL and potentially escalate privileges"}, {"techniqueID": "T1027", "comment": "CVE-2024-0759 - Mapping internal network to identify other services that are on the same network as AnythingLLM and potentially escalate privileges"}, {"techniqueID": "T1056", "comment": "CVE-2024-0759 - Using the link collector to gather information and potentially escalate privileges"}], "stix_bundle": {"objects": [{"id": "urn:uuid:12345678-1234-1234-1234-123456789012", "type": "vulnerability", "name": "CVE-2024-0759: AnythingLLM Vulnerability", "description": "A vulnerability in AnythingLLM that allows an attacker to link-scrape internally resolving IPs of other services on the same network."}, {"id": "urn:uuid:87654321-8765-8765-8765-876543210012", "type": "attack-pattern", "name": "T1190: Unlinking Internal IPs", "description": "Unlinking internal IPs to gather information and potentially escalate privileges."}, {"id": "urn:uuid:54321098-5432-5432-5432-543210987654", "type": "attack-pattern", "name": "T1018: Brute-forcing Internal IPs", "description": "Brute-forcing internal IPs to gather information and potentially escalate privileges."}, {"id": "urn:uuid:11111111-1111-1111-1111-111111111112", "type": "attack-pattern", "name": "T1078: Pre-authenticated Link", "description": "Using a pre-authenticated link to access a CuRL and potentially escalate privileges."}, {"id": "urn:uuid:22222222-2222-2222-2222-222222222223", "type": "attack-pattern", "name": "T1027: Mapping Internal Network", "description": "Mapping internal network to identify other services that are on the same network as AnythingLLM and potentially escalate privileges."}, {"id": "urn:uuid:33333333-3333-3333-3333-333333333334", "type": "attack-pattern", "name": "T1056: Link Collector", "description": "Using the link collector to gather information and potentially escalate privileges."}, {"id": "urn:uuid:44444444-4444-4444-4444-444444444445", "type": "course-of-action", "name": "BLOCK CuRL Access", "description": "Blocking access to CuRL to prevent the exploitation of this vulnerability", "related-objects": [{"id": "urn:uuid:11111111-1111-1111-1111-111111111112", "type": "attack-pattern", "relationship-type": "mitigated"}]}, {"id": "urn:uuid:55555555-5555-5555-5555-555555555556", "type": "course-of-action", "name": "CONFIGURE Link Collector", "description": "Configuring the link collector to limit the collection of information", "related-objects": [{"id": "urn:uuid:33333333-3333-3333-3333-333333333334", "type": "attack-pattern", "relationship-type": "mitigated"}]}], "relationship-definition": [{"id": "urn:uuid:rel-1", "type": "related-to", "source": {"id": "urn:uuid:12345678-1234-1234-1234-123456789012", "type": "vulnerability"}, "target": {"id": "urn:uuid:87654321-8765-8765-8765-876543210012", "type": "attack-pattern"}, "label": "relates-to"}, {"id": "urn:uuid:rel-2", "type": "related-to", "source": {"id": "urn:uuid:87654321-8765-8765-8765-876543210012", "type": "attack-pattern"}, "target": {"id": "urn:uuid:12345678-1234-1234-1234-123456789012", "type": "vulnerability"}, "label": "relates-to"}]}, "technical_analysis": {"Introduction": "This is a critical vulnerability in AnythingLLM that allows an attacker to link-scrape internally resolving IPs of other services on the same network.", "Impact and Scope": "The vulnerability has a CVSS score of 7.7 with a vector of CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N.", "Related MITRE ATT&CK Techniques": "T1190, T1018, T1078, T1027, T1056", "Technical Details": "The vulnerability is due to the ability to link-scrape internally resolving IPs of other services on the same network.", "Detection": "Detection involves monitoring for link-scraping activity.", "Mitigation": "Mitigation involves blocking access to CuRL and configuring the link collector to limit the collection of information.", "Conclusion": "This is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "This is a critical vulnerability that allows an attacker to gather information and potentially escalate privileges.", "Business Impact": "This vulnerability can have significant business impact, including data loss and system compromise.", "Technical Impact": "This vulnerability can have significant technical impact, including the potential for data theft and system compromise.", "Mitigation Strategies": "Mitigation involves blocking access to CuRL and configuring the link collector to limit the collection of information.", "Recommendations": "Recommendations include patching the vulnerability and implementing additional security controls.", "Conclusions": "This is a critical vulnerability that requires immediate attention and mitigation."}}