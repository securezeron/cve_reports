{"id": "CVE-2024-21631", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-03T17:15:12.790", "lastModified": "2024-01-10T18:40:48.587", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Vapor is an HTTP web framework for Swift. Prior to version 4.90.0, Vapor's `vapor_urlparser_parse` function uses `uint16_t` indexes when parsing a URI's components, which may cause integer overflows when parsing untrusted inputs. This vulnerability does not affect Vapor directly but could impact applications relying on the URI type for validating user input. The URI type is used in several places in Vapor. A developer may decide to use URI to represent a URL in their application (especially if that URL is then passed to the HTTP Client) and rely on its public properties and methods. However, URI may fail to properly parse a valid (albeit abnormally long) URL, due to string ranges being converted to 16-bit integers. An attacker may use this behavior to trick the application into accepting a URL to an untrusted destination. By padding the port number with zeros, an attacker can cause an integer overflow to occur when the URL authority is parsed and, as a result, spoof the host. Version 4.90.0 contains a patch for this issue. As a workaround, validate user input before parsing as a URI or, if possible, use Foundation's `URL` and `URLComponents` utilities.\n"}, {"lang": "es", "value": "Vapor es un framework web HTTP para Swift. Antes de la versi\u00f3n 4.90.0, la funci\u00f3n `vapor_urlparser_parse` de Vapor utiliza \u00edndices `uint16_t` al analizar los componentes de un URI, lo que puede causar desbordamientos de enteros al analizar entradas que no son de confianza. Esta vulnerabilidad no afecta a Vapor directamente, pero podr\u00eda afectar a las aplicaciones que dependen del tipo de URI para validar la entrada del usuario. El tipo URI se utiliza en varios lugares de Vapor. Un desarrollador puede decidir utilizar URI para representar una URL en su aplicaci\u00f3n (especialmente si esa URL luego se pasa al Cliente HTTP) y confiar en sus propiedades y m\u00e9todos p\u00fablicos. Sin embargo, es posible que el URI no pueda analizar correctamente una URL v\u00e1lida (aunque anormalmente larga), debido a que los rangos de cadenas se convierten a enteros de 16 bits. Un atacante puede utilizar este comportamiento para enga\u00f1ar a la aplicaci\u00f3n para que acepte una URL a un destino que no es de confianza. Al rellenar el n\u00famero de puerto con ceros, un atacante puede provocar un desbordamiento de enteros cuando se analiza la autoridad de la URL y, como resultado, falsificar el host. La versi\u00f3n 4.90.0 contiene un parche para este problema. Como workaround, valide la entrada del usuario antes de analizarla como URI o, si es posible, utilice las utilidades `URL` y `URLComponents` de Foundation."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-190"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1104"}, {"lang": "en", "value": "CWE-190"}, {"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:vapor:vapor:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.90.0", "matchCriteriaId": "D7A4A9F5-B5B1-480E-9922-AF35861D75AF"}]}]}], "references": [{"url": "https://github.com/vapor/vapor/commit/6db3d917b5ce5024a84eb265ef65691383305d70", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/vapor/vapor/security/advisories/GHSA-r6r4-5pr8-gjcp", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0002", "comment": " CVE-2024-21631 - This vulnerability allows an attacker to potentially manipulate the URL and conduct URL spoofing attacks, which can lead to information leakage. A defense strategy is to validate user input before parsing as a URI or use Foundation's `URL` and `URLComponents` utilities."}, {"techniqueID": "TA0003", "comment": "CVE-2024-21631 - Due to improper input validation, an attacker can inject malicious code into the system. Implementing input validation and sanitization can mitigate this threat."}, {"techniqueID": "TA0037", "comment": "CVE-2024-21631 - This vulnerability can lead to unawareness of the attacker-controlled endpoint. Implementing endpoint detection and response can help detect and respond to such attacks."}, {"techniqueID": "T1190", "comment": "CVE-2024-21631 - This vulnerability can lead to path manipulation. Implementing path validation and sanitization can help prevent exploitation of this vulnerability."}, {"techniqueID": "T1191", "comment": "CVE-2024-21631 - This vulnerability can lead to URL manipulation. Implementing URL validation and sanitization can help prevent exploitation of this vulnerability."}, {"techniqueID": "T1192", "comment": "CVE-2024-21631 - This vulnerability can lead to data tampering. Implementing data validation and sanitization can help prevent exploitation of this vulnerability."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/CVE-2024-21631-bundle", "name": "CVE-2024-21631 Bundle", "description": "STIX 2.1 bundle for CVE-2024-21631 vulnerability", "creatable": true, "modifiable": true, "deletable": true, "objects": [{"type": "indicator", "id": "https://example.com/CVE-2024-21631-indicator", "name": "CVE-2024-21631 Indicator", "description": "Indicator for CVE-2024-21631 vulnerability", "first_seen": "2024-01-03T17:15:12.790", "last_seen": "2024-01-10T18:40:48.587", "created_by_ref": " https://example.com/user-1", "modified_by_ref": "https://example.com/user-1", "object_marking_refs": [{"id": "https://example.com/markup-1"}], "object_refs": [{"id": "https://example.com/vulnerability-1"}], "sighting_refs": [{"id": "https://example.com/sighting-1"}]}, {"type": "vulnerability", "id": "https://example.com/CVE-2024-21631-vulnerability", "name": "CVE-2024-21631 Vulnerability", "description": "Vulnerability description", "cvss_v3": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5}, "mitre_attack_patterns": [{"technique_id": "TA0002"}, {"technique_id": "TA0003"}, {"technique_id": "TA0037"}, {"technique_id": "T1190"}, {"technique_id": "T1191"}, {"technique_id": "T1192"}], "course_of_action_refs": [{"id": "https://example.com/course-of-action-1"}], "techniques_refs": [{"id": "https://example.com/techniques"}]}, {"type": "course-of-action", "id": "https://example.com/course-of-action-1", "name": "Course of Action 1", "description": "This course of action can help to mitigate the impact of the CVE-2024-21631 vulnerability", "created_by_ref": "https://example.com/user-1", "modified_by_ref": "https://example.com/user-1", "object_marking_refs": [{"id": "https://example.com/markup-1"}], "object_refs": [{"id": "https://example.com/vulnerability-1"}]}]}, "technical_analysis": {"Introduction": "Introduction content.", "Impact and Scope": "Details on the impact and scope of the CVE, mention cvss score with version and attack vector.", "Related MITRE ATT&CK Techniques": "List of related MITRE ATT&CK Techniques and their relevance to the CVE.", "Technical Details": "In-depth technical details of the CVE.", "Detection": "Methods for detecting the CVE.", "Mitigation": "Mitigation strategies for the CVE.", "Conclusion": "Summary and conclusions."}, "executive_analysis": {"Overview": "Overview of the CVE.", "Business Impact": "Explanation of the business impact of the CVE.", "Technical Impact": "Explanation of the technical impact of the CVE.", "Mitigation Strategies": "High-level mitigation strategies.", "Recommendations": "Recommendations for executives.", "Conclusions": "Final conclusions and next steps."}}