{"id": "CVE-2023-6291", "sourceIdentifier": "secalert@redhat.com", "published": "2024-01-26T15:15:08.280", "lastModified": "2024-02-14T03:15:14.320", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "A flaw was found in the redirect_uri validation logic in Keycloak. This issue may allow a bypass of otherwise explicitly allowed hosts. A successful attack may lead to an access token being stolen, making it possible for the attacker to impersonate other users."}, {"lang": "es", "value": "Se encontr\u00f3 un fallo en la l\u00f3gica de validaci\u00f3n de redirect_uri en Keycloak. Este problema puede permitir la omisi\u00f3n de hosts permitidos expl\u00edcitamente. Un ataque exitoso puede provocar el robo de un token de acceso, lo que hace posible que el atacante se haga pasar por otros usuarios."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 7.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 3.7}, {"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 7.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 3.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-601"}]}, {"source": "secalert@redhat.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-601"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:keycloak:*:*:*:*:*:*:*:*", "versionEndExcluding": "22.0.7", "matchCriteriaId": "66A01C0F-CB27-4A62-9B86-C35CCD605AB6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:single_sign-on:-:*:*:*:text-only:*:*:*", "matchCriteriaId": "341E6313-20D5-44CB-9719-B20585DC5AD6"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform:4.11:*:*:*:*:*:*:*", "matchCriteriaId": "EA983F8C-3A06-450A-AEFF-9429DE9A3454"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform:4.12:*:*:*:*:*:*:*", "matchCriteriaId": "40449571-22F8-44FA-B57B-B43F71AB25E2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform_for_ibm_z:4.9:*:*:*:*:*:*:*", "matchCriteriaId": "01B0F191-ADDB-4AAE-A5C5-5CC16909E64A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform_for_ibm_z:4.10:*:*:*:*:*:*:*", "matchCriteriaId": "FD75BCB4-F0E1-4C05-A2D7-001503C805C9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform_for_linuxone:4.9:*:*:*:*:*:*:*", "matchCriteriaId": "B02036DD-4489-480B-B7D4-4EB08952377B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform_for_linuxone:4.10:*:*:*:*:*:*:*", "matchCriteriaId": "C7E78C55-45B6-4E01-9773-D3468F8EA9C3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform_for_power:4.9:*:*:*:*:*:*:*", "matchCriteriaId": "30E2CF79-2D56-48AB-952E-5DDAFE471073"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform_for_power:4.10:*:*:*:*:*:*:*", "matchCriteriaId": "54E24055-813B-4E6D-94B7-FAD5F78B8537"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "F4CFF558-3C47-480D-A2F0-BABF26042943"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:single_sign-on:7.6:*:*:*:*:*:*:*", "matchCriteriaId": "2DEC61BC-E699-456E-99B6-C049F2A5F23F"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "142AD0DD-4CF3-4D74-9442-459CE3347E3A"}, {"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "F4CFF558-3C47-480D-A2F0-BABF26042943"}, {"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "7F6FB57C-2BC7-487C-96DD-132683AEB35D"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:migration_toolkit_for_applications:6.0:*:*:*:*:*:*:*", "matchCriteriaId": "3C2E7E3C-A507-4AB2-97E5-4944D8775CF7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:migration_toolkit_for_applications:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "C6FE20CE-E1C9-4645-98B6-A22B81356642"}]}]}], "references": [{"url": "https://access.redhat.com/errata/RHSA-2023:7854", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2023:7855", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2023:7856", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2023:7857", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2023:7858", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2023:7860", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2023:7861", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://access.redhat.com/errata/RHSA-2024:0798", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:0799", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:0800", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:0801", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:0804", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/security/cve/CVE-2023-6291", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2251407", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1199", "comment": "CVE-2023-6291 - Why this is relevant and how to defend against it: The CVE-2023-6291 vulnerability in Keycloak allows an attacker to bypass redirect_uri validation logic, allowing them to steal access tokens and impersonate other users. Defenses include validating redirect URIs, using secure authentication protocols, and regularly updating Keycloak versions."}, {"techniqueID": "T1499", "comment": "Why this is relevant and how to defend against it: The vulnerability allows an attacker to exploit weak authentication and authorization mechanisms, making it possible to gain unauthorized access to systems and data."}, {"techniqueID": "T1078", "comment": "Why this is relevant and how to defend against it: The vulnerability allows an attacker to inject malicious code into Keycloak, potentially leading to unauthorized access, data theft, or system compromise. Defenses include regular code reviews, secure coding practices, and implementing security patches."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/stix_bundle/cve-2023-6291", "specification_version": "2.1", "objects": [{"type": "vulnerability", "id": "https://example.com/stix_object/cve-2023-6291", "label": "CVE-2023-6291", "name": "CES-2023-6291", "description": "A flaw was found in the redirect_uri validation logic in Keycloak. This issue may allow a bypass of otherwise explicitly allowed hosts. A successful attack may lead to an access token being stolen, making it possible for the attacker to impersonate other users.", "reported_by": {"type": "organization", "id": "https://example.com/stix_object/secalert-redhat", "name": "SecAlert Red Hat"}}, {"type": "technique", "id": "https://example.com/stix_object/t1199", "label": "T1199", "name": "Privileged Account Discovery", "description": "The adversary uses various means to identify and gather information about privileged accounts within the target network."}, {"type": "indicator", "id": "https://example.com/stix_object/indicator-1", "label": "Indicator 1", "name": "Keycloak redirect_uri validation logic bypass", "description": "A potential indicator of compromise that may indicate the presence of the CVE-2023-6291 vulnerability."}, {"type": "course_of_action", "id": "https://example.com/stix_object/course-1", "label": "Course of Action 1", "name": "Validate redirect URIs", "description": "Validate redirect URIs to prevent unauthorized access to Keycloak."}], "relationships": [{"type": "relates_to", "id": "https://example.com/stix_relationship/cve-2023-6291-t1199", "target": {"type": "technique", "id": "https://example.com/stix_object/t1199"}, "source": {"type": "vulnerability", "id": "https://example.com/stix_object/cve-2023-6291"}}, {"type": "relates_to", "id": "https://example.com/stix_relationship/cve-2023-6291-indicator-1", "target": {"type": "indicator", "id": "https://example.com/stix_object/indicator-1"}, "source": {"type": "vulnerability", "id": "https://example.com/stix_object/cve-2023-6291"}}, {"type": "relates_to", "id": "https://example.com/stix_relationship/cve-2023-6291-course-1", "target": {"type": "course_of_action", "id": "https://example.com/stix_object/course-1"}, "source": {"type": "vulnerability", "id": "https://example.com/stix_object/cve-2023-6291"}}]}, "technical_analysis": {"Introduction": "The CVE-2023-6291 vulnerability in Keycloak allows an attacker to bypass redirect_uri validation logic, making it possible to steal access tokens and impersonate other users.", "Impact and Scope": "The vulnerability has a CVSS score of 7.1 with a network attack vector. It affects Keycloak versions 6.0 and 7.6.", "Related MITRE ATT&CK Techniques": "T1199 - Privileged Account Discovery, T1499 - Exploit Public-Facing Application, T1078 - Exploit Public-Facing Application", "Technical Details": "The vulnerability is caused by an inadequate redirect_uri validation logic in Keycloak. An attacker can exploit this vulnerability by injecting malicious code into Keycloak.", "Detection": "Detection methods include monitoring for suspicious network traffic, analyzing access logs for unauthorized activity, and conducting regular security audits.", "Mitigation": "Mitigation strategies include validating redirect URIs, using secure authentication protocols, and regularly updating Keycloak versions.", "Conclusion": "The CVE-2023-6291 vulnerability is a critical threat to Keycloak security. Implementing the recommended mitigation strategies is crucial to preventing exploitation."}, "executive_analysis": {"Overview": "The CVE-2023-6291 vulnerability in Keycloak poses a significant risk to organizations that use the platform.", "Business Impact": "The vulnerability can lead to unauthorized access, data theft, and system compromise, resulting in significant reputational and financial damage.", "Technical Impact": "The vulnerability can be exploited by attackers to inject malicious code into Keycloak, potentially leading to a range of negative consequences.", "Mitigation Strategies": "Implementing the recommended mitigation strategies, including validated redirect URIs and secure authentication protocols, is crucial to preventing exploitation.", "Recommendations": "Organizations should prioritize patching Keycloak versions 6.0 and 7.6, and conduct regular security audits to identify and remediate potential vulnerabilities.", "Conclusions": "The CVE-2023-6291 vulnerability is a critical threat to Keycloak security. Executives should prioritize addressing this vulnerability to protect their organizations."}}