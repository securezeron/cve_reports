{"id": "CVE-2024-5187", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T19:16:06.100", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability in the `download_model_with_test_data` function of the onnx/onnx framework, version 1.16.0, allows for arbitrary file overwrite due to inadequate prevention of path traversal attacks in malicious tar files. This vulnerability enables attackers to overwrite any file on the system, potentially leading to remote code execution, deletion of system, personal, or application files, thus impacting the integrity and availability of the system. The issue arises from the function's handling of tar file extraction without performing security checks on the paths within the tar file, as demonstrated by the ability to overwrite the `/home/kali/.ssh/authorized_keys` file by specifying an absolute path in the malicious tar file."}, {"lang": "es", "value": "Una vulnerabilidad en la funci\u00f3n `download_model_with_test_data` del framework onnx/onnx, versi\u00f3n 1.16.0, permite la sobrescritura arbitraria de archivos debido a una prevenci\u00f3n inadecuada de ataques de path traversal en archivos tar maliciosos. Esta vulnerabilidad permite a los atacantes sobrescribir cualquier archivo en el sistema, lo que podr\u00eda provocar la ejecuci\u00f3n remota de c\u00f3digo y la eliminaci\u00f3n de archivos del sistema, personales o de aplicaciones, lo que afecta la integridad y disponibilidad del sistema. El problema surge del manejo de la funci\u00f3n de extracci\u00f3n de archivos tar sin realizar controles de seguridad en las rutas dentro del archivo tar, como lo demuestra la capacidad de sobrescribir el archivo `/home/kali/.ssh/authorized_keys` especificando una ruta absoluta en el archivo tar. archivo tar malicioso."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "references": [{"url": "https://huntr.com/bounties/50235ebd-3410-4ada-b064-1a648e11237e", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-5187 - Path traversal attacks can be used to overwrite arbitrary files, potentially leading to remote code execution. Defend against this by restricting file system access and implementing secure file handling practices."}, {"techniqueID": "T1059", "comment": "CVE-2024-5187 - Tar file extraction can be used to introduce malicious files into the system. Defend against this by validating file types and implementing robust file extraction mechanisms."}, {"techniqueID": "T1060", "comment": "CVE-2024-5187 - The vulnerability can be exploited to delete system, personal, or application files. Defend against this by implementing robust file backup and recovery mechanisms."}], "stix_bundle": {"$schema": "https://docs.oasis-open.org/stix2/2.1/stix2-schema.xsd", "type": "bundle", "id": "bundle--9e63f6f3-2e5a-4c50-a01d-34718f1b51e5", "spec_version": "2.1", "created_by_ref": "identity--1e61d98c-5ecc-446a-8db2-4f7a5f6fb6fe", "created": "2024-06-07T14:56:05.647", "updated": "2024-06-07T14:56:05.647", "objects": [{"type": "intrusion-set", "id": "intrusion-set--23a5c16c-63a9-455e-842f-6e4fe4e04e0a", "name": "Huntr Bounty Program"}, {"type": "malware", "id": "malware--93a81f66-d50a-43e3-a1c4-e94f7b8c5f9f", "name": "CVE-2024-5187 - Onnx Onnx Framework Vulnerability"}, {"type": "campaign", "id": "campaign--b24d6dca-54d3-4a3f-ba9c-d16b22f6e92b", "name": "Huntr Bounty Program"}, {"type": "file", "id": "observable--39d36b3e-34d2-432b-b9c5-7caf22d6c43f", "name": "malicious tar file", "first_seen": "2024-06-07T14:56:05.647", "last_seen": "2024-06-07T14:56:05.647"}], "relationships": [{"type": "uses", "id": "uses--a6f01c4b-cf4f-44a3-8d5e-43b5117b0bd1", "target_ref": "intrusion-set--23a5c16c-63a9-455e-842f-6e4fe4e04e0a", "source_ref": "malware--93a81f66-d50a-43e3-a1c4-e94f7b8c5f9f"}, {"type": "targets", "id": "targets--58c46c7b-b3f4-47ba-a9e7-1357a4d7c4f1", "target_ref": "observable--39d36b3e-34d2-432b-b9c5-7caf22d6c43f", "source_ref": "campaign--b24d6dca-54d3-4a3f-ba9c-d16b22f6e92b"}, {"type": "implies", "id": "implies--1a2d7d5e-ee3a-4429-8429-43b5117b0bd1", "target_ref": "related_activity--1a2d7d5e-ee3a-4429-8429-43b5117b0bd1", "source_ref": "observable--39d36b3e-34d2-432b-b9c5-7caf22d6c43f"}]}, "technical_analysis": {"Introduction": "The CVE-2024-5187 vulnerability is a path traversal attack that affects the onnx/onnx framework. The vulnerability allows attackers to overwrite arbitrary files, potentially leading to remote code execution, deletion of system, personal, or application files, and data tampering.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8, with an attack vector of NETWORK and attack complexity of LOW. This means that the vulnerability can be exploited remotely with a low level of technical skill.", "Related MITRE ATT&CK Techniques": "T1190, T1059, and T1060", "Technical Details": "The vulnerability arises from the `download_model_with_test_data` function of the onnx/onnx framework, which does not properly validate file paths. This allows attackers to overwrite arbitrary files by specifying absolute paths in the malicious tar file.", "Detection": "The vulnerability can be detected by monitoring file system access and looking for suspicious file overwrite activity. Additionally, verifying the integrity of system files and configuring strict file permissions can help prevent exploitation.", "Mitigation": "The vulnerability can be mitigated by restricting file system access, implementing secure file handling practices, and validating file types. Additionally, configuring strict file permissions and monitoring file system activity can help prevent exploitation.", "Conclusion": "In conclusion, the CVE-2024-5187 vulnerability is a serious flaw that can be exploited by attackers to overwrite arbitrary files and potentially compromise the system. It is essential to address this vulnerability as soon as possible to prevent potential attacks."}, "executive_analysis": {"Overview": "The CVE-2024-5187 vulnerability is a serious security flaw that affects the onnx/onnx framework. The vulnerability allows attackers to overwrite arbitrary files, potentially leading to remote code execution, deletion of system, personal, or application files, and data tampering.", "Business Impact": "The vulnerability can have significant business impact, including loss of data, system downtime, and reputational damage. It is essential to address this vulnerability to prevent potential attacks.", "Technical Impact": "The vulnerability can be exploited remotely with a low level of technical skill, making it a significant threat to system security.", "Mitigation Strategies": "Implementing strict file permissions, monitoring file system activity, and validating file types are essential mitigation strategies.", "Recommendations": "We recommend that organizations prioritize addressing this vulnerability, restrict file system access, and implement secure file handling practices.", "Conclusions": "In conclusion, the CVE-2024-5187 vulnerability is a serious security flaw that requires immediate attention. We urge organizations to take prompt action to prevent potential attacks and mitigate the risk of exploitation."}}