{"id": "CVE-2024-4315", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-12T01:15:49.490", "lastModified": "2024-06-13T18:36:09.013", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "parisneo/lollms version 9.5 is vulnerable to Local File Inclusion (LFI) attacks due to insufficient path sanitization. The `sanitize_path_from_endpoint` function fails to properly sanitize Windows-style paths (backward slash `\\`), allowing attackers to perform directory traversal attacks on Windows systems. This vulnerability can be exploited through various routes, including `personalities` and `/del_preset`, to read or delete any file on the Windows filesystem, compromising the system's availability."}, {"lang": "es", "value": "parisneo/lollms versi\u00f3n 9.5 es vulnerable a ataques de inclusi\u00f3n de archivos locales (LFI) debido a una sanitizaci\u00f3n insuficiente de la ruta. La funci\u00f3n `sanitize_path_from_endpoint` no sanitiza adecuadamente las rutas de estilo Windows (barra invertida `\\`), lo que permite a los atacantes realizar ataques de directory traversal en sistemas Windows. Esta vulnerabilidad se puede explotar a trav\u00e9s de varias rutas, incluidas `personalities` y `/del_preset`, para leer o eliminar cualquier archivo en el sistema de archivos de Windows, comprometiendo la disponibilidad del sistema."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-98"}]}], "references": [{"url": "https://github.com/parisneo/lollms/commit/95ad36eeffc6a6be3e3f35ed35a384d768f0ecf6", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/8a1b0197-2c36-4276-b92b-630a2a9bb09c", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-4315 - The vulnerability can be exploited through Local File Inclusion (LFI) attacks, which can be mitigated by implementing secure deserialization and whitelisting allowed file types and paths"}, {"techniqueID": "T1518", "comment": "CVE-2024-4315 - The lack of proper path sanitization can lead to directory traversal attacks, which can be mitigated by implementing strict path validation and sanitization"}, {"techniqueID": "T1560", "comment": "CVE-2024-4315 - The vulnerability can be exploited through various routes, including `personalities` and `/del_preset`, to read or delete any file on the Windows filesystem, which can be mitigated by implementing file access controls and monitoring"}], "stix_bundle": {"schema": "https://stix2.io/schema/2.1", "label": "Vulnerability Report", "description": "Vulnerability report for CVE-2024-4315", "objects": [{"id": "vulnerability:CVE-2024-4315", "type": "vulnerability", "name": "CVE-2024-4315: Parisneo Lollms LFI Vuln", "description": "Parisneo Lollms version 9.5 is vulnerable to Local File Inclusion (LFI) attacks due to insufficient path sanitization.", "created": "2024-06-12T01:15:49.490", "modified": "2024-06-13T18:36:09.013", "cve": {"id": "CVE-2024-4315", "references": {"href": "https://github.com/parisneo/lollms/commit/95ad36eeffc6a6be3e3f35ed35a384d768f0ecf6", "schema": "https://stix2.io/schema/2.1", "name": "ParisNewo Lollms Commit"}}, "effects": {"description": "The vulnerability can be exploited through Local File Inclusion (LFI) attacks, allowing attackers to read or delete any file on the Windows filesystem, compromising the system's availability and confidentiality.", "impact": {"confidentiality": "HIGH", "integrity": "NONE", "availability": "HIGH"}, "attack_vector": "NETWORK", "attack_complexity": "LOW", "privileges_required": "NONE", "user_interaction": "NONE", "scope": "UNCHANGED"}, "compromise": {"description": "The vulnerability can be exploited to read or delete any file on the Windows filesystem, compromising the system's availability and confidentiality.", "impact": {"confidentiality": "HIGH", "integrity": "NONE", "availability": "HIGH"}}}, {"id": "technique:T1190", "type": "technique", "name": "Local File Inclusion", "description": "The technique of including local files in an application, allowing attackers to read or execute files on the system.", "created": "2024-06-12T01:15:49.490", "modified": "2024-06-13T18:36:09.013", "related": {"href": "vulnerability:CVE-2024-4315"}}, {"id": "technique:T1518", "type": "technique", "name": "Directory Traversal", "description": "The technique of traversing directories to access files or directories outside the intended access scope.", "created": "2024-06-12T01:15:49.490", "modified": "2024-06-13T18:36:09.013", "related": {"href": "vulnerability:CVE-2024-4315"}}, {"id": "course_of_action:mitigate_lfi", "type": "course-of-action", "name": "Mitigate Local File Inclusion Attacks", "description": "Implement secure deserialization and whitelist allowed file types and paths to mitigate Local File Inclusion attacks.", "created": "2024-06-12T01:15:49.490", "modified": "2024-06-13T18:36:09.013", "related": {"href": "technique:T1190"}}, {"id": "course_of_action:mitigate_directory_traversal", "type": "course-of-action", "name": "Mitigate Directory Traversal Attacks", "description": "Implement strict path validation and sanitization to mitigate Directory Traversal attacks.", "created": "2024-06-12T01:15:49.490", "modified": "2024-06-13T18:36:09.013", "related": {"href": "technique:T1518"}}]}, "technical_analysis": {"Introduction": "This vulnerability, CVE-2024-4315, is a Local File Inclusion (LFI) vulnerability in Parisneo Lollms version 9.5.", "Impact and Scope": "The vulnerability can be exploited through LFI attacks, allowing attackers to read or delete any file on the Windows filesystem, compromising the system's availability and confidentiality.", "Related MITRE ATT&CK Techniques": "T1190: Local File Inclusion, T1518: Directory Traversal", "Technical Details": "The vulnerability occurs due to insufficient path sanitization in the `sanitize_path_from_endpoint` function, allowing attackers to perform directory traversal attacks.", "Detection": "Methods for detecting this vulnerability include monitoring for unusual file system activity, monitoring for malicious file inclusion, and implementing secure deserialization.", "Mitigation": "Mitigation strategies include implementing secure deserialization, whitelisting allowed file types and paths, and implementing strict path validation and sanitization.", "Conclusion": "In conclusion, this vulnerability is a serious security flaw that can be exploited to compromise the system's availability and confidentiality."}, "executive_analysis": {"Overview": "This vulnerability, CVE-2024-4315, is a Local File Inclusion (LFI) vulnerability in Parisneo Lollms version 9.5, which can be exploited to compromise the system's availability and confidentiality.", "Business Impact": "This vulnerability has significant business impact, as it can compromise the system's availability and confidentiality, causing data breaches and system downtime.", "Technical Impact": "The vulnerability has significant technical impact, as it can allow attackers to read or delete any file on the Windows filesystem, compromising the system's availability and confidentiality.", "Mitigation Strategies": "To mitigate this vulnerability, we recommend implementing secure deserialization, whitelisting allowed file types and paths, and implementing strict path validation and sanitization.", "Recommendations": "We recommend that executives take immediate action to address this vulnerability, as it poses a significant threat to the organization.", "Conclusions": "In conclusion, this vulnerability is a significant security risk that requires immediate attention and mitigation to ensure the organization's security and integrity."}}