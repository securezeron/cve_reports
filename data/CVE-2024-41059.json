{"id": "CVE-2024-41059", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-29T15:15:13.927", "lastModified": "2024-07-29T16:21:52.517", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nhfsplus: fix uninit-value in copy_name\n\n[syzbot reported]\nBUG: KMSAN: uninit-value in sized_strscpy+0xc4/0x160\n sized_strscpy+0xc4/0x160\n copy_name+0x2af/0x320 fs/hfsplus/xattr.c:411\n hfsplus_listxattr+0x11e9/0x1a50 fs/hfsplus/xattr.c:750\n vfs_listxattr fs/xattr.c:493 [inline]\n listxattr+0x1f3/0x6b0 fs/xattr.c:840\n path_listxattr fs/xattr.c:864 [inline]\n __do_sys_listxattr fs/xattr.c:876 [inline]\n __se_sys_listxattr fs/xattr.c:873 [inline]\n __x64_sys_listxattr+0x16b/0x2f0 fs/xattr.c:873\n x64_sys_call+0x2ba0/0x3b50 arch/x86/include/generated/asm/syscalls_64.h:195\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xcf/0x1e0 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nUninit was created at:\n slab_post_alloc_hook mm/slub.c:3877 [inline]\n slab_alloc_node mm/slub.c:3918 [inline]\n kmalloc_trace+0x57b/0xbe0 mm/slub.c:4065\n kmalloc include/linux/slab.h:628 [inline]\n hfsplus_listxattr+0x4cc/0x1a50 fs/hfsplus/xattr.c:699\n vfs_listxattr fs/xattr.c:493 [inline]\n listxattr+0x1f3/0x6b0 fs/xattr.c:840\n path_listxattr fs/xattr.c:864 [inline]\n __do_sys_listxattr fs/xattr.c:876 [inline]\n __se_sys_listxattr fs/xattr.c:873 [inline]\n __x64_sys_listxattr+0x16b/0x2f0 fs/xattr.c:873\n x64_sys_call+0x2ba0/0x3b50 arch/x86/include/generated/asm/syscalls_64.h:195\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xcf/0x1e0 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n[Fix]\nWhen allocating memory to strbuf, initialize memory to 0."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: hfsplus: corrige valor uninit en copy_name [syzbot inform\u00f3] ERROR: KMSAN: valor uninit en sized_strscpy+0xc4/0x160 sized_strscpy+0xc4/0x160 copy_name+0x2af/0x320 fs/hfsplus /xattr.c:411 hfsplus_listxattr+0x11e9/0x1a50 fs/hfsplus/xattr.c:750 vfs_listxattr fs/xattr.c:493 [en l\u00ednea] listxattr+0x1f3/0x6b0 fs/xattr.c:840 path_listxattr fs/xattr.c: 864 [en l\u00ednea] __do_sys_listxattr fs/xattr.c:876 [en l\u00ednea] __se_sys_listxattr fs/xattr.c:873 [en l\u00ednea] __x64_sys_listxattr+0x16b/0x2f0 fs/xattr.c:873 x64_sys_call+0x2ba0/0x3b5 0 arco/x86/incluir/generado /asm/syscalls_64.h:195 do_syscall_x64 arch/x86/entry/common.c:52 [en l\u00ednea] do_syscall_64+0xcf/0x1e0 arch/x86/entry/common.c:83 Entry_SYSCALL_64_after_hwframe+0x77/0x7f Uninit se cre\u00f3 en slab_post_alloc_ gancho mm/slub.c:3877 [en l\u00ednea] slab_alloc_node mm/slub.c:3918 [en l\u00ednea] kmalloc_trace+0x57b/0xbe0 mm/slub.c:4065 kmalloc include/linux/slab.h:628 [en l\u00ednea] hfsplus_listxattr+0x4cc/ 0x1a50 fs/hfsplus/xattr.c:699 vfs_listxattr fs/xattr.c:493 [en l\u00ednea] listxattr+0x1f3/0x6b0 fs/xattr.c:840 path_listxattr fs/xattr.c:864 [en l\u00ednea] __do_sys_listxattr fs/xattr.c :876 [en l\u00ednea] __se_sys_listxattr fs/xattr.c:873 [en l\u00ednea] __x64_sys_listxattr+0x16b/0x2f0 fs/xattr.c:873 x64_sys_call+0x2ba0/0x3b50 arch/x86/include/generated/asm/syscalls_64.h:1 95 do_syscall_x64 arco /x86/entry/common.c:52 [en l\u00ednea] do_syscall_64+0xcf/0x1e0 arch/x86/entry/common.c:83 Entry_SYSCALL_64_after_hwframe+0x77/0x7f [Soluci\u00f3n] Al asignar memoria a strbuf, inicialice la memoria a 0."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0570730c16307a72f8241df12363f76600baf57d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/22999936b91ba545ce1fbbecae6895127945e91c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/34f8efd2743f2d961e92e8e994de4c7a2f9e74a0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/72805debec8f7aa342da194fe0ed7bc8febea335", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ad57dc2caf1e0a3c0a9904400fae7afbc9f74bb2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c733e24a61cbcff10f660041d6d84d32bb7e4cb4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d02d8c1dacafb28930c39e16d48e40bb6e4cbc70", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f08956d8e0f80fd0d4ad84ec917302bb2f3a9c6a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1210", "comment": "This technique is relevant for this CVE as it demonstrates the use of kernel code execution, which is a common technique used to exploit kernel vulnerabilities like this one. To defend against this, it's essential to ensure that kernel code execution is properly controlled and monitored."}, {"techniqueID": "T1107", "comment": "This technique is relevant as it demonstrates the use of privilege escalation, which is often used in conjunction with kernel vulnerabilities like this one to gain elevated permissions. To defend against this, it's crucial to implement robust privilege escalation controls and monitoring."}, {"techniqueID": "T1190", "comment": "This technique is relevant as it demonstrates the use of exploitation of a vulnerable service, which is often used in conjunction with kernel vulnerabilities like this one to gain access to sensitive data. To defend against this, it's essential to ensure that vulnerable services are properly patched and monitored."}], "stix_bundle": {"spec_version": "2.1", "bundles": [{"type": "attack-pattern", "id": "apt1", "created_by_ref": "https://example.com/creator", "name": "Linux Kernel hfsplus Vulnerability CVE-2024-41059", "description": "Linux Kernel hfsplus vulnerability CVE-2024-41059", "objective_ref": "https://example.com/objective"}, {"type": "campaign", "id": "apt1", "created_by_ref": "https://example.com/creator", "name": "Linux Kernel Vulnerability Campaign", "description": "Linux Kernel vulnerability campaign"}, {"type": "indicator", "id": "ind1", "created_by_ref": "https://example.com/creator", "name": "Linux Kernel hfsplus Indicators", "description": "Linux Kernel hfsplus indicators"}, {"type": "course-of-action", "id": "coa1", "created_by_ref": "https://example.com/creator", "name": "Linux Kernel hfsplus mitigation", "description": "Linux Kernel hfsplus mitigation"}, {"type": "note", "id": "note1", "created_by_ref": "https://example.com/creator", "name": "Linux Kernel hfsplus note", "description": "Linux Kernel hfsplus note"}], "relationships": [{"relationship": "related", "source_ref": "apt1", "target_ref": "ind1"}, {"relationship": "related", "source_ref": "apt1", "target_ref": "coa1"}, {"relationship": "related", "source_ref": "ind1", "target_ref": "coa1"}, {"relationship": "related", "source_ref": "coa1", "target_ref": "note1"}]}, "technical_analysis": {"Introduction": "The Linux Kernel hfsplus vulnerability CVE-2024-41059 is a remote code execution vulnerability that allows attackers to execute arbitrary code on the system.", "Impact and Scope": "This vulnerability has a high impact and scope, as it affects multiple Linux distributions and allows attackers to execute arbitrary code.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1210, T1107, and T1190, which demonstrate the use of kernel code execution, privilege escalation, and exploitation of a vulnerable service.", "Technical Details": "The vulnerability is caused by a bug in the hfsplus file system, which allows attackers to execute arbitrary code by sending a crafted request.", "Detection": "Detecting this vulnerability is challenging, as it requires monitoring system calls and kernel activity.", "Mitigation": "The recommended mitigation is to apply the patch provided by the Linux kernel team and to implement robust monitoring and auditing tools.", "Conclusion": "In conclusion, the Linux Kernel hfsplus vulnerability CVE-2024-41059 is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The Linux Kernel hfsplus vulnerability CVE-2024-41059 is a critical vulnerability that affects multiple Linux distributions and allows attackers to execute arbitrary code.", "Business Impact": "This vulnerability has a significant business impact, as it can allow attackers to steal sensitive data and disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows attackers to execute arbitrary code and potentially gain elevated privileges.", "Mitigation Strategies": "The recommended mitigation strategies are to apply the patch provided by the Linux kernel team and to implement robust monitoring and auditing tools.", "Recommendations": "We recommend that all Linux systems be patched immediately and that regular security monitoring and auditing be performed.", "Conclusions": "In conclusion, the Linux Kernel hfsplus vulnerability CVE-2024-41059 is a critical vulnerability that requires immediate attention and mitigation."}}