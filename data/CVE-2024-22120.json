{"id": "CVE-2024-22120", "sourceIdentifier": "security@zabbix.com", "published": "2024-05-17T10:15:07.363", "lastModified": "2024-05-17T18:35:35.070", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Zabbix server can perform command execution for configured scripts. After command is executed, audit entry is added to \"Audit Log\". Due to \"clientip\" field is not sanitized, it is possible to injection SQL into \"clientip\" and exploit time based blind SQL injection."}, {"lang": "es", "value": "El servidor Zabbix puede realizar la ejecuci\u00f3n de comandos para scripts configurados. Despu\u00e9s de ejecutar el comando, la entrada de auditor\u00eda se agrega al \"Registro de auditor\u00eda\". Debido a que el campo \"clientip\" no est\u00e1 sanitizado, es posible inyectar SQL en \"clientip\" y explotar la inyecci\u00f3n SQL ciega basada en el tiempo."}], "metrics": {"cvssMetricV31": [{"source": "security@zabbix.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.3, "impactScore": 6.0}]}, "weaknesses": [{"source": "security@zabbix.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "https://support.zabbix.com/browse/ZBX-24505", "source": "security@zabbix.com"}], "techniques": [{"techniqueID": "T1203-001", "comment": "CVE-2024-22120 - This vulnerability can be exploited using SQL injection, a common attack technique. Defending against it involves sanitizing user input and implementing proper error handling to prevent code injection attacks."}, {"techniqueID": "T1566-001", "comment": "CVE-2024-22120 - The exploitation of this vulnerability involves command injection, a common tactic used in web attacks. To defend against this, implement strict input validation and escape special characters in user input."}], "stix_bundle": {"@stix_Bundle": {"id": "bundle--1", "type": "bundle", "created_by_ref": "identity--1", "created": "2022-01-01T00:00:00.000Z", "modified": "2022-01-01T00:00:00.000Z", "objects": [{"id": "identity--1", "type": "identity", "name": "Security Analyst", "label": "Security Analyst"}, {"id": "vulnerability--1", "type": "vulnerability", "name": "CVE-2024-22120", "label": "CVE-2024-22120"}, {"id": "note--1", "type": "note", "content": "CVE-2024-22120 is a command injection vulnerability in Zabbix Server.", "label": "Note"}, {"id": "campaign--1", "type": "campaign", "name": "Zabbix Server Exploitation", "label": "Zabbix Server Exploitation"}, {"id": "intrusion-set--1", "type": "intrusion-set", "name": "APT34", "label": "APT34"}, {"id": "relationship--1", "type": "relationship", "id_source": "vulnerability--1", "id_target": "technique--1", "description": "Exploits vulnerability CVE-2024-22120", "label": "relation"}, {"id": "relationship--2", "type": "relationship", "id_source": "technique--1", "id_target": "campaign--1", "description": "Exploits campaign Zabbix Server Exploitation", "label": "relation"}, {"id": "relationship--3", "type": "relationship", "id_source": "vulnerability--1", "id_target": "intrusion-set--1", "description": "Exploited by APT34", "label": "relation"}]}}, "technical_analysis": {"Introduction": "CVE-2024-22120 is a command injection vulnerability in Zabbix Server.", "Impact and Scope": "The vulnerability allows an attacker to inject arbitrary commands and execute them on the Zabbix Server. The impact is high, as it allows for privilege escalation, data tampering, and denial of service.", "Related MITRE ATT&CK Techniques": "T1203-001 and T1566-001", "Technical Details": "The vulnerability occurs due to the lack of proper input validation and sanitization in the Zabbix Server. This allows an attacker to inject malicious commands, which can be executed with elevated privileges.", "Detection": "Detection involves monitoring for suspicious command execution on the Zabbix Server and monitoring for unusual network traffic patterns.", "Mitigation": "Mitigation involves patching the Zabbix Server and implementing strict input validation and sanitization. Additionally, monitoring for suspicious command execution and network traffic patterns can help identify potential exploitation.", "Conclusion": "The vulnerability in Zabbix Server (CVE-2024-22120) is a critical issue that requires immediate attention. Patching and implementing defense-in-depth measures can help mitigate the risk of exploitation."}, "executive_analysis": {"Overview": "CVE-2024-22120 is a command injection vulnerability in Zabbix Server that requires immediate attention.", "Business Impact": "The vulnerability poses a high risk to the organization, as it allows for privilege escalation, data tampering, and denial of service.", "Technical Impact": "The vulnerability allows an attacker to inject and execute arbitrary commands on the Zabbix Server, which can have severe technical consequences.", "Mitigation Strategies": "Patch the Zabbix Server, implement strict input validation and sanitization, and monitor for suspicious command execution and network traffic patterns.", "Recommendations": "Implement a priority patching schedule, monitor network traffic and system logs, and conduct regular security assessments.", "Conclusions": "The vulnerability in Zabbix Server (CVE-2024-22120) is a critical issue that requires immediate attention. The recommended mitigation strategies and recommendations should be implemented as soon as possible."}}