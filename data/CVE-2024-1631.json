{"id": "CVE-2024-1631", "sourceIdentifier": "6b35d637-e00f-4228-858c-b20ad6e1d07b", "published": "2024-02-21T03:15:08.747", "lastModified": "2024-02-22T19:07:37.840", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Impact: The library offers a function to generate an ed25519 key pair via Ed25519KeyIdentity.generate with an optional param to provide a 32 byte seed value, which will then be used as the secret key. When no seed value is provided, it is expected that the library generates the secret key using secure randomness. However, a recent change broke this guarantee and uses an insecure seed for key pair generation. Since the private key of this identity (535yc-uxytb-gfk7h-tny7p-vjkoe-i4krp-3qmcl-uqfgr-cpgej-yqtjq-rqe) is compromised, one could lose funds associated with the principal on ledgers or lose access to a canister where this principal is the controller. \n"}, {"lang": "es", "value": "Impacto: la librer\u00eda ofrece una funci\u00f3n para generar un par de claves ed25519 a trav\u00e9s de Ed25519KeyIdentity.generate con un par\u00e1metro opcional para proporcionar un valor inicial de 32 bytes, que luego se utilizar\u00e1 como clave secreta. Cuando no se proporciona ning\u00fan valor inicial, se espera que la librer\u00eda genere la clave secreta mediante aleatoriedad segura. Sin embargo, un cambio reciente rompi\u00f3 esta garant\u00eda y utiliza una semilla insegura para la generaci\u00f3n del par de claves. Dado que la clave privada de esta identidad (535yc-uxytb-gfk7h-tny7p-vjkoe-i4krp-3qmcl-uqfgr-cpgej-yqtjq-rqe) est\u00e1 comprometida, se podr\u00edan perder fondos asociados con el principal en los libros de contabilidad o perder el acceso a un contenedor donde este principal es el controlador."}], "metrics": {"cvssMetricV31": [{"source": "6b35d637-e00f-4228-858c-b20ad6e1d07b", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "6b35d637-e00f-4228-858c-b20ad6e1d07b", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-321"}, {"lang": "en", "value": "CWE-330"}]}], "references": [{"url": "https://agent-js.icp.xyz/identity/index.html", "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b"}, {"url": "https://github.com/dfinity/agent-js", "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b"}, {"url": "https://github.com/dfinity/agent-js/pull/851", "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b"}, {"url": "https://github.com/dfinity/agent-js/security/advisories/GHSA-c9vv-fhgv-cjc3", "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b"}, {"url": "https://www.npmjs.com/package/@dfinity/identity/v/1.0.1", "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b"}], "techniques": [{"techniqueID": "T1177", "comment": "The vulnerability is related to malicious activity using insecure seed values, potentially leading to theft of cryptographic keys. Defenders should ensure secure randomness in key generation, and validate and verify public keys before usage. This is relevant due to the usage of Ed25519 key pair generation, which relies on secure randomness."}, {"techniqueID": "T1191", "comment": "The vulnerability is related to the use of insecure seeds, which could lead to predictable key generation. Defenders should use trusted and secure randomness sources, such as operating system-provided random number generators, and validate and verify public keys before usage. This is relevant due to the potential predictability of the private key."}, {"techniqueID": "T1193", "comment": "The vulnerability is related to the use of insecure seeds, which could lead to theft of cryptographic keys. Defenders should use key exchange algorithms that provide perfect forward secrecy, such as Diffie-Hellman key exchange, and regularly rotate public and private keys. This is relevant due to the potential compromise of the private key."}], "stix_bundle": {"$schema": "https://docs.oasis-open.org/soa-rm/srm-core/v1.0/schema/soarml-1.0.xsd", "id": "Vulnerability_ID", "type": "observed-data", "description": "This STIX Bundle represents a potential vulnerability in a cryptographic library.", "created": "2024-02-22T19:07:37.840Z", "modified": "2024-02-22T19:07:37.840Z", "handling": [{"header": "Object-Handle", "type": "identity", "value": "534c-534e-4953-4f4c-5c534c-4953-4c4b-534f-4556-5354"}], "objects": [{"id": "Vulnerability_ID", "type": "vulnerability", "description": "Impact: The library offers a function to generate an ed25519 key pair via Ed25519KeyIdentity.generate with an optional param to provide a 32 byte seed value, which will then be used as the secret key.", "cwe_identifiers": ["CWE-321", "CWE-330"], "cvss_v3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N"}, {"id": "Identity_ID", "type": "identity", "description": "A cryptographic key identity", "key IDENTIFIER": "535yc-uxytb-gfk7h-tny7p-vjkoe-i4krp-3qmcl-uqfgr-cpgej-yqtjq-rqe", "key_algorithm": "ed25519"}, {"id": "Reference_ID", "type": "reference", "source_name": "CVE-2024-1631", "source_description": "CVE-2024-1631 is a vulnerability in a cryptographic library that can compromise cryptographic keys due to insecure seed values", "description": "The vulnerability is related to the usage of insecure seed values for key generation"}], "report": [{"id": "Report_ID", "type": "report", "description": "This report represents an incident of suspected misbehavior in a cryptographic library"}]}, "technical_analysis": {"Introduction": "The vulnerability in the cryptographic library is related to the usage of insecure seed values for key generation, which can compromise cryptographic keys.", "Impact and Scope": "The vulnerability has an impact of HIGH confidentiality, integrity, and availability.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to techniques T1177, T1191, and T1193.", "Technical Details": "The vulnerability is related to the usage of insecure seed values, which can be exploited by an attacker to compromise cryptographic keys.", "Detection": "To detect this vulnerability, defenders should monitor for instances of the cryptographic library and check for insecure seed values.", "Mitigation": "Defenders should ensure secure randomness in key generation, use trusted and secure randomness sources, and regularly rotate public and private keys.", "Conclusion": "The vulnerability is relevant to cryptographic library users and defenders should ensure secure randomness in key generation and regularly rotate public and private keys."}, "executive_analysis": {"Overview": "The vulnerability in the cryptographic library is related to the usage of insecure seed values for key generation, which can compromise cryptographic keys.", "Business Impact": "The vulnerability has significant business impact, as it can compromise confidentiality, integrity, and availability of sensitive data.", "Technical Impact": "The vulnerability has significant technical impact, as it can be exploited by an attacker to compromise cryptographic keys.", "Mitigation Strategies": "To mitigate this vulnerability, defenders should ensure secure randomness in key generation, use trusted and secure randomness sources, and regularly rotate public and private keys.", "Recommendations": "Defenders should prioritize key generation security, monitor for vulnerable cryptographic libraries, and regularly rotate public and private keys.", "Conclusions": "The vulnerability is a high-priority issue that requires immediate attention, as it can compromise confidentiality, integrity, and availability of sensitive data."}}