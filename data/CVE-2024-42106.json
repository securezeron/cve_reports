{"id": "CVE-2024-42106", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-30T08:15:03.100", "lastModified": "2024-07-30T13:32:45.943", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ninet_diag: Initialize pad field in struct inet_diag_req_v2\n\nKMSAN reported uninit-value access in raw_lookup() [1]. Diag for raw\nsockets uses the pad field in struct inet_diag_req_v2 for the\nunderlying protocol. This field corresponds to the sdiag_raw_protocol\nfield in struct inet_diag_req_raw.\n\ninet_diag_get_exact_compat() converts inet_diag_req to\ninet_diag_req_v2, but leaves the pad field uninitialized. So the issue\noccurs when raw_lookup() accesses the sdiag_raw_protocol field.\n\nFix this by initializing the pad field in\ninet_diag_get_exact_compat(). Also, do the same fix in\ninet_diag_dump_compat() to avoid the similar issue in the future.\n\n[1]\nBUG: KMSAN: uninit-value in raw_lookup net/ipv4/raw_diag.c:49 [inline]\nBUG: KMSAN: uninit-value in raw_sock_get+0x657/0x800 net/ipv4/raw_diag.c:71\n raw_lookup net/ipv4/raw_diag.c:49 [inline]\n raw_sock_get+0x657/0x800 net/ipv4/raw_diag.c:71\n raw_diag_dump_one+0xa1/0x660 net/ipv4/raw_diag.c:99\n inet_diag_cmd_exact+0x7d9/0x980\n inet_diag_get_exact_compat net/ipv4/inet_diag.c:1404 [inline]\n inet_diag_rcv_msg_compat+0x469/0x530 net/ipv4/inet_diag.c:1426\n sock_diag_rcv_msg+0x23d/0x740 net/core/sock_diag.c:282\n netlink_rcv_skb+0x537/0x670 net/netlink/af_netlink.c:2564\n sock_diag_rcv+0x35/0x40 net/core/sock_diag.c:297\n netlink_unicast_kernel net/netlink/af_netlink.c:1335 [inline]\n netlink_unicast+0xe74/0x1240 net/netlink/af_netlink.c:1361\n netlink_sendmsg+0x10c6/0x1260 net/netlink/af_netlink.c:1905\n sock_sendmsg_nosec net/socket.c:730 [inline]\n __sock_sendmsg+0x332/0x3d0 net/socket.c:745\n ____sys_sendmsg+0x7f0/0xb70 net/socket.c:2585\n ___sys_sendmsg+0x271/0x3b0 net/socket.c:2639\n __sys_sendmsg net/socket.c:2668 [inline]\n __do_sys_sendmsg net/socket.c:2677 [inline]\n __se_sys_sendmsg net/socket.c:2675 [inline]\n __x64_sys_sendmsg+0x27e/0x4a0 net/socket.c:2675\n x64_sys_call+0x135e/0x3ce0 arch/x86/include/generated/asm/syscalls_64.h:47\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xd9/0x1e0 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nUninit was stored to memory at:\n raw_sock_get+0x650/0x800 net/ipv4/raw_diag.c:71\n raw_diag_dump_one+0xa1/0x660 net/ipv4/raw_diag.c:99\n inet_diag_cmd_exact+0x7d9/0x980\n inet_diag_get_exact_compat net/ipv4/inet_diag.c:1404 [inline]\n inet_diag_rcv_msg_compat+0x469/0x530 net/ipv4/inet_diag.c:1426\n sock_diag_rcv_msg+0x23d/0x740 net/core/sock_diag.c:282\n netlink_rcv_skb+0x537/0x670 net/netlink/af_netlink.c:2564\n sock_diag_rcv+0x35/0x40 net/core/sock_diag.c:297\n netlink_unicast_kernel net/netlink/af_netlink.c:1335 [inline]\n netlink_unicast+0xe74/0x1240 net/netlink/af_netlink.c:1361\n netlink_sendmsg+0x10c6/0x1260 net/netlink/af_netlink.c:1905\n sock_sendmsg_nosec net/socket.c:730 [inline]\n __sock_sendmsg+0x332/0x3d0 net/socket.c:745\n ____sys_sendmsg+0x7f0/0xb70 net/socket.c:2585\n ___sys_sendmsg+0x271/0x3b0 net/socket.c:2639\n __sys_sendmsg net/socket.c:2668 [inline]\n __do_sys_sendmsg net/socket.c:2677 [inline]\n __se_sys_sendmsg net/socket.c:2675 [inline]\n __x64_sys_sendmsg+0x27e/0x4a0 net/socket.c:2675\n x64_sys_call+0x135e/0x3ce0 arch/x86/include/generated/asm/syscalls_64.h:47\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xd9/0x1e0 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nLocal variable req.i created at:\n inet_diag_get_exact_compat net/ipv4/inet_diag.c:1396 [inline]\n inet_diag_rcv_msg_compat+0x2a6/0x530 net/ipv4/inet_diag.c:1426\n sock_diag_rcv_msg+0x23d/0x740 net/core/sock_diag.c:282\n\nCPU: 1 PID: 8888 Comm: syz-executor.6 Not tainted 6.10.0-rc4-00217-g35bb670d65fc #32\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.3-2.fc40 04/01/2014"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: inet_diag: inicializa el campo pad en la estructura inet_diag_req_v2 KMSAN inform\u00f3 acceso de valor uninit en raw_lookup() [1]. Diag para sockets sin formato utiliza el campo pad en struct inet_diag_req_v2 para el protocolo subyacente. Este campo corresponde al campo sdiag_raw_protocol en la estructura inet_diag_req_raw. inet_diag_get_exact_compat() convierte inet_diag_req en inet_diag_req_v2, pero deja el campo pad sin inicializar. Entonces el problema ocurre cuando raw_lookup() accede al campo sdiag_raw_protocol. Solucione este problema inicializando el campo pad en inet_diag_get_exact_compat(). Adem\u00e1s, haga la misma correcci\u00f3n en inet_diag_dump_compat() para evitar problemas similares en el futuro. [1] ERROR: KMSAN: valor uninit en raw_lookup net/ipv4/raw_diag.c:49 [en l\u00ednea] ERROR: KMSAN: valor uninit en raw_sock_get+0x657/0x800 net/ipv4/raw_diag.c:71 raw_lookup net/ipv4 /raw_diag.c:49 [en l\u00ednea] raw_sock_get+0x657/0x800 net/ipv4/raw_diag.c:71 raw_diag_dump_one+0xa1/0x660 net/ipv4/raw_diag.c:99 inet_diag_cmd_exact+0x7d9/0x980 inet_diag_get_exact_compat net/ipv4/ inet_diag.c :1404 [en l\u00ednea] inet_diag_rcv_msg_compat+0x469/0x530 net/ipv4/inet_diag.c:1426 sock_diag_rcv_msg+0x23d/0x740 net/core/sock_diag.c:282 netlink_rcv_skb+0x537/0x670. c:2564 sock_diag_rcv+0x35 /0x40 net/core/sock_diag.c:297 netlink_unicast_kernel net/netlink/af_netlink.c:1335 [en l\u00ednea] netlink_unicast+0xe74/0x1240 net/netlink/af_netlink.c:1361 netlink_sendmsg+0x10c6/0x1260 net/netlink/af_netlink.c :1905 sock_sendmsg_nosec net/socket.c:730 [en l\u00ednea] __sock_sendmsg+0x332/0x3d0 net/socket.c:745 ____sys_sendmsg+0x7f0/0xb70 net/socket.c:2585 ___sys_sendmsg+0x271/0x3b0 net/socket. c:2639 __sys_sendmsg net/socket.c:2668 [en l\u00ednea] __do_sys_sendmsg net/socket.c:2677 [en l\u00ednea] __se_sys_sendmsg net/socket.c:2675 [en l\u00ednea] __x64_sys_sendmsg+0x27e/0x4a0 net/socket.c:2675 x64_sys_call+0x13 5e/0x3ce0 arch/x86/include/generated/asm/syscalls_64.h:47 do_syscall_x64 arch/x86/entry/common.c:52 [en l\u00ednea] do_syscall_64+0xd9/0x1e0 arch/x86/entry/common.c:83 Entry_SYSCALL_64_after_hwframe+0x77/0x7f Uninit se almacen\u00f3 en la memoria en: raw_sock_get+0x650/0x800 net/ipv4/raw_diag.c:71 raw_diag_dump_one+0xa1/0x660 net/ipv4/raw_diag.c:99 inet_diag_cmd_exact+0x7d9/0x980 inet_diag_get_exact_compat net/ipv4/inet_diag .c:1404 [en l\u00ednea] inet_diag_rcv_msg_compat+0x469/0x530 net/ipv4/inet_diag.c:1426 sock_diag_rcv_msg+0x23d/0x740 net/core/sock_diag.c:282 netlink_rcv_skb+0x537/0x670 net/netlink/af_netlink.c:256 4 calcet\u00edn_diag_rcv+0x35/0x40 net/core/sock_diag.c:297 netlink_unicast_kernel net/netlink/af_netlink.c:1335 [en l\u00ednea] netlink_unicast+0xe74/0x1240 net/netlink/af_netlink.c:1361 netlink_sendmsg+0x10c6/0x1260 net/netlink/af_netlink.c:1905 sock_sendmsg_nosec net/socket.c:730 [en l\u00ednea] __sock_sendmsg+0x332/0x3d0 net/socket.c:745 ____sys_sendmsg+0x7f0/0xb70 net/socket.c:2585 ___sys_sendmsg+0x271/0x3b0 net/socket.c:263 9 __sys_sendmsg neto/ socket.c:2668 [en l\u00ednea] __do_sys_sendmsg net/socket.c:2677 [en l\u00ednea] __se_sys_sendmsg net/socket.c:2675 [en l\u00ednea] __x64_sys_sendmsg+0x27e/0x4a0 net/socket.c:2675 x64_sys_call+0x135e/ 0x3ce0 arch/x86 /include/generated/asm/syscalls_64.h:47 do_syscall_x64 arch/x86/entry/common.c:52 [en l\u00ednea] do_syscall_64+0xd9/0x1e0 arch/x86/entry/common.c:83 Entry_SYSCALL_64_after_hwframe+0x77/0x7f Variable local req.i creado en: inet_diag_get_exact_compat net/ipv4/inet_diag.c:1396 [en l\u00ednea] inet_diag_rcv_msg_compat+0x2a6/0x530 net/ipv4/inet_diag.c:1426 sock_diag_rcv_msg+0x23d/0x740 net/core/sock_diag.c: 282 procesadores: 1 PID: 8888 Comm: syz-executor.6 No contaminado 6.10.0-rc4-00217-g35bb670d65fc #32 Nombre del hardware: PC est\u00e1ndar QEMU (i440FX + PIIX, 1996), BIOS 1.16.3-2.fc40 01/04/2014"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0184bf0a349f4cf9e663abbe862ff280e8e4dfa2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/61cf1c739f08190a4cbf047b9fbb192a94d87e3f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/7094a5fd20ab66028f1da7f06e0f2692d70346f9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/76965648fe6858db7c5f3c700fef7aa5f124ca1c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/7ef519c8efde152e0d632337f2994f6921e0b7e4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8366720519ea8d322a20780debdfd23d9fc0904a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d6f487e0704de2f2d15f8dd5d7d723210f2b2fdb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f9b2010e8af49fac9d9562146fb81744d8a9b051", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1049", "comment": "CVE-2024-42106 - This technique is related to memory corruption vulnerability in Linux kernel, which can be exploited by attacker to inject malicious code or execute arbitrary code."}, {"techniqueID": "T1078", "comment": "CVE-2024-42106 - This technique is related to error handling vulnerability in Linux kernel, which can be exploited by attacker to manipulate the behavior of system and execute malicious code."}], "stix_bundle": {"type": "bundle", "id": "bundle-001", "created_by_ref": "user-001", "created": "2024-07-30T08:15:03.100Z", "modified": "2024-07-30T13:32:45.943Z", "name": "CVE-2024-42106 STIX Bundle", "description": "STIX Bundle for CVE-2024-42106: Memory Corruption Vulnerability in Linux Kernel", "objects": [{"type": "vulnerability", "id": "vulnerability-001", "created_by_ref": "user-001", "created": "2024-07-30T08:15:03.100Z", "modified": "2024-07-30T13:32:45.943Z", "name": "CVE-2024-42106: Memory Corruption Vulnerability in Linux Kernel", "description": "CVSS Score: 9.8 (AV:N/AC:L/Au:N/C:C/I:C/A:C)", "related_attack_patterns": ["T1049", "T1078"], "related_weaknesses": ["CWE-1193", "CWE-1354"], "related_exploits": ["Exploit-001", "Exploit-002"], "related_solutions": ["Solution-001", "Solution-002"], "related_course_of_action": ["COA-001", "COA-002"]}, {"type": "course_of_action", "id": "course_of_action-001", "created_by_ref": "user-001", "created": "2024-07-30T08:15:03.100Z", "modified": "2024-07-30T13:32:45.943Z", "name": "COA-001: Patching the Vulnerability", "description": "Apply the patch for the vulnerability to prevent exploitation", "related_course_of_action_techniques": ["T1049"], "related_course_of_action_tactics": ["defense-evasion"]}, {"type": "course_of_action", "id": "course_of_action-002", "created_by_ref": "user-001", "created": "2024-07-30T08:15:03.100Z", "modified": "2024-07-30T13:32:45.943Z", "name": "COA-002: Monitoring for Suspicious Activity", "description": "Monitor system logs for suspicious activity and anomalous behavior", "related_course_of_action_techniques": ["T1078"], "related_course_of_action_tactics": ["network-activity"]}]}, "technical_analysis": {"Introduction": "This is a memory corruption vulnerability in the Linux kernel, which can be exploited by an attacker to inject malicious code or execute arbitrary code.", "Impact and Scope": "The vulnerability has a CVSS Score of 9.8 and affects all versions of the Linux kernel before the patch is applied. The attack vector is network-based.", "Related MITRE ATT&CK Techniques": "T1049: Command and Scripting Interpreter, T1078: Error Handling", "Technical Details": "The vulnerability is caused by a memory corruption issue in the Linux kernel, which allows an attacker to inject malicious code or execute arbitrary code.", "Detection": "To detect this vulnerability, monitor system logs for suspicious activity and anomalous behavior.", "Mitigation": "Apply the patch for the vulnerability or use a firewall to block network-based attacks.", "Conclusion": "This vulnerability is a high-risk threat to Linux systems and should be patched as soon as possible."}, "executive_analysis": {"Overview": "This is a critical vulnerability in the Linux kernel that can allow an attacker to inject malicious code or execute arbitrary code.", "Business Impact": "The vulnerability has the potential to cause significant business disruptions and financial losses if not patched in a timely manner.", "Technical Impact": "The vulnerability affects the security and integrity of Linux systems, making it vulnerable to exploitation by attackers.", "Mitigation Strategies": "Implement a patch management process to quickly apply patches to Linux systems, and consider using a firewall to block network-based attacks.", "Recommendations": "It is recommended that organizations prioritize patching this vulnerability and implement additional security measures to prevent exploitation.", "Conclusions": "This vulnerability presents a significant risk to Linux systems and should be addressed as soon as possible."}}