{"id": "CVE-2024-23651", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-31T22:15:54.183", "lastModified": "2024-02-09T01:43:51.767", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "BuildKit is a toolkit for converting source code to build artifacts in an efficient, expressive and repeatable manner. Two malicious build steps running in parallel sharing the same cache mounts with subpaths could cause a race condition that can lead to files from the host system being accessible to the build container. The issue has been fixed in v0.12.5. Workarounds include, avoiding using BuildKit frontend from an untrusted source or building an untrusted Dockerfile containing cache mounts with --mount=type=cache,source=... options.\n"}, {"lang": "es", "value": "BuildKit es un conjunto de herramientas para convertir c\u00f3digo fuente para crear artefactos de manera eficiente, expresiva y repetible. Dos pasos de compilaci\u00f3n maliciosos que se ejecutan en paralelo y comparten los mismos montajes de cach\u00e9 con subrutas podr\u00edan causar una condici\u00f3n de ejecuci\u00f3n que puede hacer que los archivos del sistema host sean accesibles al contenedor de compilaci\u00f3n. El problema se solucion\u00f3 en v0.12.5. Los workarounds incluyen evitar el uso de la interfaz de BuildKit desde una fuente que no es de confianza o crear un Dockerfile que no sea de confianza que contenga montajes de cach\u00e9 con las opciones --mount=type=cache,source=...."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.2}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.8}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-362"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mobyproject:buildkit:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.12.5", "matchCriteriaId": "0AAE2F08-4E4D-4B85-8230-8D5BA7788D3D"}]}]}], "references": [{"url": "https://github.com/moby/buildkit/pull/4604", "source": "security-advisories@github.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://github.com/moby/buildkit/releases/tag/v0.12.5", "source": "security-advisories@github.com", "tags": ["Patch", "Release Notes"]}, {"url": "https://github.com/moby/buildkit/security/advisories/GHSA-m3r6-h7wv-7xxv", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-23651 - BuildKit race condition leading to file sharing between build steps. This is relevant due to the absence of proper permission controls, enabling attackers to access sensitive files. To defend against this, ensure proper permission controls are in place and reviews are conducted regularly."}, {"techniqueID": "T1210", "comment": "CVE-2024-23651 - BuildKit race condition exploiting file system vulnerabilities. This is relevant due to the potential for attackers to exploit file system vulnerabilities, leading to unauthorized access to sensitive files. To defend against this, implement strong file system permissions and regular security scans."}, {"techniqueID": "T1505", "comment": "CVE-2024-23651 - BuildKit race condition leading to code injection. This is relevant due to the potential for attackers to inject malicious code, leading to unauthorized access to sensitive data. To defend against this, implement strict code reviews and use of approved libraries."}], "stix_bundle": "...", "technical_analysis": {"Introduction": "BuildKit is a toolkit for converting source code to build artifacts in an efficient, expressive, and repeatable manner.", "Impact and Scope": "The vulnerability has a CVSS score of 7.4 (High) and affects all versions before 0.12.5, allowing attackers to access sensitive files. The attack vector is NETWORK, and the privilege required is NONE.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the BuildKit race condition, which is a form of file sharing between build steps.", "Technical Details": "The vulnerability occurs due to the absence of proper permission controls, enabling attackers to access sensitive files. The issue has been fixed in v0.12.5.", "Detection": "Detection methods include monitoring for suspicious file access and implementing regular security scans.", "Mitigation": "Mitigation strategies include implementing strong file system permissions, regular security scans, and strict code reviews.", "Conclusion": "The vulnerability highlights the importance of implementing proper permission controls and conducting regular security reviews."}, "executive_analysis": {"Overview": "BuildKit is a toolkit for converting source code to build artifacts in an efficient, expressive, and repeatable manner.", "Business Impact": "The vulnerability has a potential business impact of unauthorized access to sensitive data and unauthorized code execution.", "Technical Impact": "The vulnerability has a technical impact of potential code injection and file system vulnerabilities.", "Mitigation Strategies": "Implement strong file system permissions, regular security scans, and strict code reviews.", "Recommendations": "Recommendations include implementing proper permission controls, conducting regular security reviews, and ensuring patching of BuildKit to version 0.12.5.", "Conclusions": "The vulnerability emphasizes the importance of prioritizing security in software development and ensuring regular security reviews."}}