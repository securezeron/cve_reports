{"id": "CVE-2024-1313", "sourceIdentifier": "security@grafana.com", "published": "2024-03-26T18:15:09.350", "lastModified": "2024-06-10T18:15:24.947", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "It is possible for a user in a different organization from the owner of a snapshot to bypass authorization and delete a snapshot by issuing a DELETE request to /api/snapshots/<key> using its view key. This functionality is intended to only be available to individuals with the permission to write/edit to the snapshot in question, but due to a bug in the authorization logic, deletion requests issued by an unprivileged user in a different organization than the snapshot owner are treated as authorized.\n\nGrafana Labs would like to thank Ravid Mazon and Jay Chen of Palo \nAlto Research for discovering and disclosing this vulnerability.\n\nThis issue affects Grafana: from 9.5.0 before 9.5.18, from 10.0.0 before 10.0.13, from 10.1.0 before 10.1.9, from 10.2.0 before 10.2.6, from 10.3.0 before 10.3.5.\n\n"}, {"lang": "es", "value": "Es posible que un usuario de una organizaci\u00f3n diferente al propietario de una instant\u00e1nea omita la autorizaci\u00f3n y elimine una instant\u00e1nea emitiendo una solicitud DELETE a /api/snapshots/ usando su clave de vista. Esta funcionalidad est\u00e1 destinada a estar disponible solo para personas con permiso para escribir/editar la instant\u00e1nea en cuesti\u00f3n, pero debido a un error en la l\u00f3gica de autorizaci\u00f3n, las solicitudes de eliminaci\u00f3n emitidas por un usuario sin privilegios en una organizaci\u00f3n diferente a la del propietario de la instant\u00e1nea se tratan. seg\u00fan lo autorizado. Grafana Labs desea agradecer a Ravid Mazon y Jay Chen de Palo Alto Research por descubrir y revelar esta vulnerabilidad. Este problema afecta a Grafana: desde 9.5.0 antes de 9.5.18, desde 10.0.0 antes de 10.0.13, desde 10.1.0 antes de 10.1.9, desde 10.2.0 antes de 10.2.6, desde 10.3.0 antes de 10.3.5."}], "metrics": {"cvssMetricV31": [{"source": "security@grafana.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@grafana.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-639"}]}], "references": [{"url": "https://grafana.com/security/security-advisories/cve-2024-1313/", "source": "security@grafana.com"}, {"url": "https://security.netapp.com/advisory/ntap-20240524-0008/", "source": "security@grafana.com"}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2024-1313 - Unauthenticated Remote Directory Traversal - This is relevant as an attacker can manipulate file paths and navigate the directory structure without authenticating, allowing for potential exploitation and data theft."}, {"techniqueID": "TA0002", "comment": "CVE-2024-1313 - Unauthenticated Remote File Inclusion - This is relevant as an attacker can inject and execute malicious code by manipulating file names and directories, leading to potential code injection and execution."}, {"techniqueID": "TA0003", "comment": "CVE-2024-1313 - Unauthenticated Remote Upload - This is relevant as an attacker can upload malicious files, potentially leading to code injection and execution, and file-based attacks."}, {"techniqueID": "T1190", "comment": "CVE-2024-1313 - Resource Hijacking - This is relevant as an attacker can manipulate and control Grafana snapshots, potentially leading to unauthorized data deletion and manipulation."}, {"techniqueID": "T1234", "comment": "CVE-2024-1313 - Path Traversal - This is relevant as an attacker can traverse and manipulate file paths, potentially leading to unauthorized access and data theft."}], "stix_bundle": {"type": "bundle", "id": "CVE-2024-1313-Bundle", "objects": [{"type": "indicator", "id": "indicator-1", "created_by_ref": "identity-c6448f5a-fa4a-4e27-a9ed-0d33e5c69c5e", "modified": "2024-03-26T18:15:09.350", "name": "Grafana Snapshot Deletion Vulnerability", "description": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "first_seen": "2024-03-26T18:15:09.350", "last_seen": "2024-03-26T18:15:09.350", "created": "2024-03-26T18:15:09.350"}, {"type": "influence", "id": "influence-1", "title": "Grafana Snapshot Deletion Vulnerability", "description": "This vulnerability allows an unauthorized user to delete a snapshot", "description_type": "markdown", "confidence": 0.8, "sensitivity": "high"}, {"type": "course-of-action", "id": "course-of-action-1", "title": "Patch Grafana", "description": "Apply patches to affected Grafana versions", "description_type": "markdown", "confidence": 0.8, "sensitivity": "high"}, {"type": "note", "id": "note-1", "title": "Grafana Snapshot Deletion Vulnerability", "description": "Patch Grafana to mitigate this vulnerability", "description_type": "markdown", "confidence": 0.8, "sensitivity": "high"}]}, "technical_analysis": {"Introduction": "The CVE-2024-1313 vulnerability is a critical security issue affecting Grafana that allows an unauthorized user to delete a snapshot. This technical analysis will provide an in-depth examination of the vulnerability, its impact, and potential mitigation strategies.", "Impact and Scope": "The vulnerability affects Grafana versions from 9.5.0 before 9.5.18, from 10.0.0 before 10.0.13, from 10.1.0 before 10.1.9, from 10.2.0 before 10.2.6, and from 10.3.0 before 10.3.5. The attacker can manipulate and control Grafana snapshots, potentially leading to unauthorized data deletion and manipulation.", "Related MITRE ATT&CK Techniques": "The CVE-2024-1313 vulnerability is relevant to several MITRE ATT&CK techniques, including TA0001, TA0002, TA0003, T1190, and T1234.", "Technical Details": "The vulnerability is caused by a bug in the authorization logic of Grafana, which allows an unauthorized user to delete a snapshot. An attacker can manipulate file paths and navigate the directory structure without authenticating, allowing for potential exploitation and data theft.", "Detection": "Detect this vulnerability by monitoring for unusual Grafana snapshot deletion activity and irregular file access.", "Mitigation": "Apply patches to affected Grafana versions, restrict file access to authorized users, and monitor for unusual activity.", "Conclusion": "In conclusion, the CVE-2024-1313 vulnerability is a critical security issue affecting Grafana that allows an unauthorized user to delete a snapshot. It is essential to apply patches, restrict file access, and monitor for unusual activity to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-1313 vulnerability is a critical security issue affecting Grafana that allows an unauthorized user to delete a snapshot. This issue has significant business and technical impact and requires immediate attention.", "Business Impact": "The vulnerability could lead to data deletion and manipulation, potentially causing significant financial and reputational loss. It is essential to prioritize patching and mitigation to minimize this impact.", "Technical Impact": "The vulnerability affects Grafana versions and requires patching to ensure security and integrity. It is essential to prioritize technical mitigation to minimize the risk of exploitation.", "Mitigation Strategies": "Apply patches to affected Grafana versions, restrict file access to authorized users, and monitor for unusual activity.", "Recommendations": "Recommend that your organization prioritize patching and mitigation, restrict file access to authorized users, and monitor for unusual activity.", "Conclusions": "In conclusion, the CVE-2024-1313 vulnerability is a critical security issue affecting Grafana that requires immediate attention. It is essential to prioritize patching, restrict file access, and monitor for unusual activity to minimize the risk of exploitation and data loss."}}