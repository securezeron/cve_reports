{"id": "CVE-2024-4504", "sourceIdentifier": "cna@vuldb.com", "published": "2024-05-05T23:15:30.083", "lastModified": "2024-06-04T19:20:39.947", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability, which was classified as critical, has been found in Ruijie RG-UAC up to 20240428. Affected by this issue is some unknown functionality of the file /view/HAconfig/baseConfig/commit.php. The manipulation of the argument peer_ip/local_ip leads to os command injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. The identifier of this vulnerability is VDB-263108. NOTE: The vendor was contacted early about this disclosure but did not respond in any way."}, {"lang": "es", "value": "Una vulnerabilidad ha sido encontrada en Ruijie RG-UAC hasta 20240428 y clasificada como cr\u00edtica. Una funci\u00f3n desconocida del archivo /view/HAconfig/baseConfig/commit.php es afectada por esta vulnerabilidad. La manipulaci\u00f3n del argumento peer_ip/local_ip conduce a la inyecci\u00f3n de comandos del sistema operativo. El ataque puede lanzarse de forma remota. El exploit ha sido divulgado al p\u00fablico y puede utilizarse. El identificador de esta vulnerabilidad es VDB-263108. NOTA: Se contact\u00f3 primeramente con el proveedor sobre esta divulgaci\u00f3n, pero no respondi\u00f3 de ninguna manera."}], "metrics": {"cvssMetricV31": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:M/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "MULTIPLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 6.4, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-78"}]}], "references": [{"url": "https://github.com/h0e4a0r1t/-2x3J-1rPc-1-0-/blob/main/Ruijie%20RG-UAC%20Unified%20Internet%20Behavior%20Management%20Audit%20System%20Backend%20RCE%20Vulnerability-view_HAconfig_baseConfig_commit.php.pdf", "source": "cna@vuldb.com"}, {"url": "https://vuldb.com/?ctiid.263108", "source": "cna@vuldb.com"}, {"url": "https://vuldb.com/?id.263108", "source": "cna@vuldb.com"}, {"url": "https://vuldb.com/?submit.323814", "source": "cna@vuldb.com"}], "techniques": [{"techniqueID": "T1059.001 - Command and Scripting Interperter", "comment": "CVE-2024-4504 - This vulnerability allows remote code execution via os command injection. This technique can be used by attackers to maintain persistence and move laterally within a network."}, {"techniqueID": "T1047 - Windows Management Instrumentation (WMI)", "comment": "CVE-2024-4504 - WMI can be used to manipulate the victim's system, create files, registry keys, and execute commands. This technique can be used as a part of an attack chain to maintain persistence and elevate privileges."}, {"techniqueID": "T1112 - Modify Registry", "comment": "CVE-2024-4504 - Attackers can use this technique to modify the registry to maintain persistence and evade detection. This technique can be used to create a backdoor or a reverse shell."}, {"techniqueID": "T1027 - Remote File Copy", "comment": "CVE-2024-4504 - Attackers can use this technique to copy files from a remote server to the victim's system. This technique can be used to exfiltrate data or deliver additional malware."}, {"techniqueID": "T1547.006 - Web Shell", "comment": "CVE-2024-4504 - A web shell can be created to interact with the victim's system remotely. This technique can be used to send and receive commands, upload and download files, and maintain persistence."}], "stix_bundle": "[Your STIX Bundle Here]", "technical_analysis": {"Introduction": "The CVE-2024-4504 vulnerability is a critical flaw in Ruijie RG-UAC that allows remote code execution via os command injection.", "Impact and Scope": "The vulnerability has a CVSS score of 4.7 and can be exploited remotely. It allows attackers to execute arbitrary commands on the target system.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this CVE: T1059.001, T1047, T1112, T1027, and T1547.006.", "Technical Details": "The vulnerability exists in the /view/HAconfig/baseConfig/commit.php file of Ruijie RG-UAC. It can be triggered by manipulating the peer_ip/local_ip argument.", "Detection": "Detection methods for this CVE include monitoring for suspicious network traffic and system calls.", "Mitigation": "Mitigation strategies include updating the Ruijie RG-UAC software to the latest version and restricting access to the vulnerable file.", "Conclusion": "In conclusion, the CVE-2024-4504 vulnerability is a critical flaw that requires immediate attention. Organizations should prioritize patching and detection to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-4504 vulnerability is a critical flaw that allows remote code execution via os command injection.", "Business Impact": "This vulnerability can have significant business impacts, including data theft, ransomware attacks, and system compromise.", "Technical Impact": "The technical impacts of this vulnerability include the risk of remote code execution, data theft, and system compromise.", "Mitigation Strategies": "Mitigation strategies include updating the Ruijie RG-UAC software to the latest version, restricting access to the vulnerable file, and monitoring for suspicious network traffic and system calls.", "Recommendations": "Recommendations for executives include prioritizing patching, detecting potential exploits, and implementing incident response plans.", "Conclusions": "In conclusion, the CVE-2024-4504 vulnerability is a critical issue that requires immediate attention. Organizations should prioritize mitigating this vulnerability to protect against potential attacks."}}