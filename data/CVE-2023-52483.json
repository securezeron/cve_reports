{"id": "CVE-2023-52483", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-02-29T06:15:46.147", "lastModified": "2024-02-29T13:49:29.390", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmctp: perform route lookups under a RCU read-side lock\n\nOur current route lookups (mctp_route_lookup and mctp_route_lookup_null)\ntraverse the net's route list without the RCU read lock held. This means\nthe route lookup is subject to preemption, resulting in an potential\ngrace period expiry, and so an eventual kfree() while we still have the\nroute pointer.\n\nAdd the proper read-side critical section locks around the route\nlookups, preventing premption and a possible parallel kfree.\n\nThe remaining net->mctp.routes accesses are already under a\nrcu_read_lock, or protected by the RTNL for updates.\n\nBased on an analysis from Sili Luo <rootlab@huawei.com>, where\nintroducing a delay in the route lookup could cause a UAF on\nsimultaneous sendmsg() and route deletion."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: mctp: realiza b\u00fasquedas de rutas bajo un bloqueo del lado de lectura de RCU. Nuestras b\u00fasquedas de rutas actuales (mctp_route_lookup y mctp_route_lookup_null) atraviesan la lista de rutas de la red sin que se mantenga el bloqueo de lectura de RCU. Esto significa que la b\u00fasqueda de ruta est\u00e1 sujeta a preferencia, lo que resulta en una posible expiraci\u00f3n del per\u00edodo de gracia y, por lo tanto, en un eventual kfree() mientras todav\u00eda tenemos el puntero de ruta. Agregue los bloqueos de secci\u00f3n cr\u00edtica del lado de lectura adecuados alrededor de las b\u00fasquedas de rutas, evitando la preferencia y un posible kfree paralelo. Los accesos restantes a net-&gt;mctp.routes ya est\u00e1n bajo rcu_read_lock o protegidos por RTNL para actualizaciones. Basado en un an\u00e1lisis de Sili Luo , donde la introducci\u00f3n de un retraso en la b\u00fasqueda de rutas podr\u00eda causar una UAF en sendmsg() y eliminaci\u00f3n de rutas simult\u00e1neas."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/1db0724a01b558feb1ecae551782add1951a114a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/2405f64a95a7a094eb24cba9bcfaffd1ea264de4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5093bbfc10ab6636b32728e35813cbd79feb063c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6c52b12159049046483fdb0c411a0a1869c41a67", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1518", "comment": "CVE-2023-52483 - Improperly secured route lookups in Linux kernel, which can lead to use-after-free vulnerability. Adversaries can leverage this vulnerability to gain access and elevate privileges."}, {"techniqueID": "T1055", "comment": "CVE-2023-52483 - Discovery of sensitive information through route lookups in Linux kernel, which can be exploited by adversaries to gather valuable intelligence."}, {"techniqueID": "T1190", "comment": "CVE-2023-52483 - Masquerading as a legitimate route lookup in Linux kernel, which can be used by adversaries to gain trust and carry out subsequent attacks."}], "stix_bundle": {"bundle": {"type": "bundle", "spec_version": "2.1", "id": "CVE-2023-52483-STIX-Bundle", "created_by_ref": "https://www.mitre.org/", "created": "2024-02-29T13:49:29.390", "modified": "2024-02-29T13:49:29.390", "objects": [{"type": "incident", "id": "incident-1", "created_by_ref": "https://www.mitre.org/", "created": "2024-02-29T13:49:29.390", "modified": "2024-02-29T13:49:29.390", "name": "CVE-2023-52483 Incident", "description": "Use-after-free vulnerability in Linux kernel route lookups", "first_observable_data": "2024-02-29T06:15:46.147", "last_observable_data": "2024-02-29T13:49:29.390", "objects": [{"type": "observable", "id": "observable-1", "name": "Use-after-free vulnerability", "description": "Use-after-free vulnerability in Linux kernel route lookups", "data_type": "ttp", "data_format": "text", "observed_data": "Use-after-free vulnerability in Linux kernel route lookups", "created_by_ref": "https://www.mitre.org/", "created": "2024-02-29T13:49:29.390", "modified": "2024-02-29T13:49:29.390", "relations": [{"type": "has_part", "id": "hpp-1", "from": "observable-1", "to": "technique-1", "relation": "ttp_type"}]}]}, {"type": "attack_pattern", "id": "attack_pattern-1", "name": "Use-after-free vulnerability", "description": "Use-after-free vulnerability in Linux kernel route lookups", "created_by_ref": "https://www.mitre.org/", "created": "2024-02-29T13:49:29.390", "modified": "2024-02-29T13:49:29.390", "objects": [{"type": "courses_of_action", "id": "course_of_action-1", "name": "Defend against use-after-free vulnerability", "description": "Apply patches to Linux kernel to prevent use-after-free vulnerability", "created_by_ref": "https://www.mitre.org/", "created": "2024-02-29T13:49:29.390", "modified": "2024-02-29T13:49:29.390", "relations": [{"type": "relates_to", "id": "rt-1", "from": "attack_pattern-1", "to": "course_of_action-1", "relation": "mitigates"}]}]}]}}, "technical_analysis": {"Introduction": "The Linux kernel contains a use-after-free vulnerability in its route lookup functionality, allowing attackers to exploit the vulnerability and gain unauthorized access to the system.", "Impact and Scope": "CVSS score: 9.8/10. Attack vector: Network.", "Related MITRE ATT&CK Techniques": "T1518, T1055, T1190.", "Technical Details": "The vulnerability occurs when the Linux kernel's route lookup functionality fails to properly handle the situation where a route is deleted while a process is still referencing it, leading to a use-after-free condition.", "Detection": "Detecting the use-after-free vulnerability may require specialized tools and techniques, such as memory debuggers and capture-and-save analysis.", "Mitigation": "Applying patches to the Linux kernel can mitigate the vulnerability. Ensuring that the Linux kernel is up-to-date and configured with the latest security settings is also important.", "Conclusion": "The use-after-free vulnerability in the Linux kernel route lookup functionality is a significant concern for system administrators, as it can be exploited by attackers to gain unauthorized access to the system."}, "executive_analysis": {"Overview": "The Linux kernel contains a critical vulnerability in its route lookup functionality that can be exploited by attackers to gain unauthorized access to the system.", "Business Impact": "This vulnerability can lead to significant business disruptions and financial losses if not addressed promptly.", "Technical Impact": "This vulnerability can allow attackers to gain unauthorized access to the system, potentially leading to data breaches and other malicious activities.", "Mitigation Strategies": "Apply patches to the Linux kernel, ensure that the Linux kernel is up-to-date and configured with the latest security settings.", "Recommendations": "System administrators should apply patches to the Linux kernel as soon as possible and ensure that the Linux kernel is up-to-date and configured with the latest security settings.", "Conclusions": "The vulnerable Linux kernel route lookup functionality poses a significant threat to system security and should be addressed promptly."}}