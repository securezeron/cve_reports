{
    "id": "CVE-2010-3972",
    "sourceIdentifier": "secure@microsoft.com",
    "published": "2010-12-23T18:00:02.557",
    "lastModified": "2021-02-05T15:37:20.770",
    "vulnStatus": "Modified",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "Heap-based buffer overflow in the TELNET_STREAM_CONTEXT::OnSendData function in ftpsvc.dll in Microsoft FTP Service 7.0 and 7.5 for Internet Information Services (IIS) 7.0, and IIS 7.5, allows remote attackers to execute arbitrary code or cause a denial of service (daemon crash) via a crafted FTP command, aka \"IIS FTP Service Heap Buffer Overrun Vulnerability.\" NOTE: some of these details are obtained from third party information."
        },
        {
            "lang": "es",
            "value": "La funci\u00f3n  TELNET_STREAM_CONTEXT::OnSendData en el manejador de protocolo FTP (ftpsvc.dll) para Microsoft Internet Information Services (IIS) v7.5 permite a atacantes remoso causar una denegaci\u00f3n de servicio (ca\u00edda) y probablemente ejecutar c\u00f3digo de su elecci\u00f3n a trav\u00e9s de peticiones FTP manipuladas que provocan una corrupci\u00f3n de memoria. NOTA: algunos de estos detalles se han obtenido de informaci\u00f3n de terceros."
        }
    ],
    "metrics": {
        "cvssMetricV2": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "2.0",
                    "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
                    "accessVector": "NETWORK",
                    "accessComplexity": "LOW",
                    "authentication": "NONE",
                    "confidentialityImpact": "COMPLETE",
                    "integrityImpact": "COMPLETE",
                    "availabilityImpact": "COMPLETE",
                    "baseScore": 10.0
                },
                "baseSeverity": "HIGH",
                "exploitabilityScore": 10.0,
                "impactScore": 10.0,
                "acInsufInfo": false,
                "obtainAllPrivilege": false,
                "obtainUserPrivilege": false,
                "obtainOtherPrivilege": false,
                "userInteractionRequired": false
            }
        ]
    },
    "weaknesses": [
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-119"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:microsoft:internet_information_services:7.5:*:*:*:*:*:*:*",
                            "matchCriteriaId": "71E52EC5-854C-48E8-9203-F1EF2D847410"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "http://blogs.technet.com/b/srd/archive/2011/01/07/assessing-the-risk-of-public-issues-currently-being-tracked-by-the-msrc.aspx",
            "source": "secure@microsoft.com"
        },
        {
            "url": "http://secunia.com/advisories/42713",
            "source": "secure@microsoft.com",
            "tags": [
                "Vendor Advisory"
            ]
        },
        {
            "url": "http://www.exploit-db.com/exploits/15803",
            "source": "secure@microsoft.com",
            "tags": [
                "Exploit"
            ]
        },
        {
            "url": "http://www.kb.cert.org/vuls/id/842372",
            "source": "secure@microsoft.com",
            "tags": [
                "US Government Resource"
            ]
        },
        {
            "url": "http://www.securityfocus.com/bid/45542",
            "source": "secure@microsoft.com",
            "tags": [
                "Exploit"
            ]
        },
        {
            "url": "http://www.securitytracker.com/id?1024921",
            "source": "secure@microsoft.com"
        },
        {
            "url": "http://www.vupen.com/english/advisories/2010/3305",
            "source": "secure@microsoft.com",
            "tags": [
                "Vendor Advisory"
            ]
        },
        {
            "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-004",
            "source": "secure@microsoft.com"
        },
        {
            "url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/64248",
            "source": "secure@microsoft.com"
        },
        {
            "url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A12370",
            "source": "secure@microsoft.com"
        }
    ],
    "techniques": [
        {
            "techniqueID": "T1174",
            "comment": "CVE-2010-3972 - This vulnerability corresponds to a heap-based buffer overflow in the TELNET_STREAM_CONTEXT::OnSendData function in ftpsvc.dll, allowing remote attackers to execute arbitrary code or cause a denial of service via a crafted FTP command. This technique can be used for exploitation, and detection of T1174 can help prevent this attack."
        },
        {
            "techniqueID": "T1190",
            "comment": "CVE-2010-3972 - The vulnerability can be used for data theft by exploiting the heap-based buffer overflow and executing arbitrary code. T1190 is used to transfer data between systems. Detection of T1190 can help prevent data theft."
        },
        {
            "techniqueID": "T1203",
            "comment": "CVE-2010-3972 - The vulnerability can be used for remote code execution, allowing an attacker to execute arbitrary code on the system. T1203 is used to transfer data between systems. Detection of T1203 can help prevent remote code execution."
        },
        {
            "techniqueID": "T1569",
            "comment": "CVE-2010-3972 - The vulnerability can be used to cause a denial of service, crashing the daemon. T1569 is used to cause a denial of service. Detection of T1569 can help prevent the crash of the daemon."
        }
    ],
    "stix_bundle": {
        "id": "https://example.com/stix_bundle",
        "stype": "bundle",
        "status": "new",
        "published": "2020-01-01T12:00:00.000Z",
        "created": "2020-01-01T12:00:00.000Z",
        "modified": "2020-01-01T12:00:00.000Z",
        "type": "Bundle",
        "idref": "CVE-2010-3972",
        "name": "STIX Bundle for CVE-2010-3972",
        "description": "STIX Bundle for CVE-2010-3972",
        "created_by_ref": "https://example.com/user",
        "object_refs": [
            {
                "id": "https://example.com/object",
                "stype": "indicator",
                "type": "indicator",
                "confidence": "high",
                "created": "2020-01-01T12:00:00.000Z",
                "modified": "2020-01-01T12:00:00.000Z",
                "name": "Indicator for CVE-2010-3972",
                "description": "Indicator for CVE-2010-3972",
                "target_refs": [
                    {
                        "id": "https://example.com/attack-pattern",
                        "stype": "attack-pattern",
                        "type": "attack-pattern",
                        "name": "CVE-2010-3972 Attack Pattern",
                        "description": "CVE-2010-3972 Attack Pattern"
                    }
                ]
            }
        ],
        "observables": [
            {
                "id": "https://example.com/observable",
                "stype": " observable",
                "type": "observable",
                "confidence": "high",
                "created": "2020-01-01T12:00:00.000Z",
                "modified": "2020-01-01T12:00:00.000Z",
                "name": "Observable for CVE-2010-3972",
                "description": "Observable for CVE-2010-3972",
                "data_type": "http_request",
                "data": "http://example.com/information/page",
                "related_id": "https://example.com/indicator"
            }
        ],
        "cCoursesOfAction": [
            {
                "course_of_action_id": "AC-1",
                "course_of_action_name": "Course of Action 1",
                "mitigates_techid": "T1174",
                "notes": "This course of action mitigates T1174"
            },
            {
                "course_of_action_id": "AC-2",
                "course_of_action_name": "Course of Action 2",
                "mitigates_techid": "T1190",
                "notes": "This course of action mitigates T1190"
            }
        ]
    },
    "technical_analysis": {
        "Introduction": "CVE-2010-3972 is a heap-based buffer overflow vulnerability in the TELNET_STREAM_CONTEXT::OnSendData function in ftpsvc.dll, allowing remote attackers to execute arbitrary code or cause a denial of service via a crafted FTP command.",
        "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 10.0. It can be exploited remotely by an unauthenticated attacker, allowing for code execution, data theft, and denial of service.",
        "Related MITRE ATT&CK Techniques": "This vulnerability corresponds to T1174, T1190, T1203, and T1569.",
        "Technical Details": "The heap-based buffer overflow occurs when a crafted FTP command is sent to the TELNET_STREAM_CONTEXT::OnSendData function, causing the function to write data to memory outside its allocated boundary.",
        "Detection": "Detection of this vulnerability involves monitoring for suspicious FTP commands and anomalies in the network traffic.",
        "Mitigation": "The vulnerability can be mitigated by updating to a patched version of the FTP Service, or by blocking traffic to the TELNET_STREAM_CONTEXT::OnSendData function.",
        "Conclusion": "This vulnerability poses a significant risk to organizations that use the FTP Service, and it is essential to take immediate action to mitigate its impact."
    },
    "executive_analysis": {
        "Overview": "The CVE-2010-3972 vulnerability is a heap-based buffer overflow in the TELNET_STREAM_CONTEXT::OnSendData function in ftpsvc.dll, allowing remote attackers to execute arbitrary code or cause a denial of service.",
        "Business Impact": "The business impact of this vulnerability is high, with potential data theft and system compromise.",
        "Technical Impact": "The technical impact is high, with potential code execution, data theft, and denial of service.",
        "Mitigation Strategies": "Mitigation strategies include updating to a patched version of the FTP Service or blocking traffic to the TELNET_STREAM_CONTEXT::OnSendData function.",
        "Recommendations": "We recommend that organizations with FTP Service 7.0 and 7.5 for IIS 7.0 and IIS 7.5 update to a patched version of the FTP Service as soon as possible.",
        "Conclusions": "In summary, the CVE-2010-3972 vulnerability poses a significant risk to organizations that use the FTP Service, and it is essential to take immediate action to mitigate its impact."
    }
}