{"id": "CVE-2024-25121", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-13T23:15:09.080", "lastModified": "2024-02-14T13:59:35.580", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "TYPO3 is an open source PHP based web content management system released under the GNU GPL. In affected versions of TYPO3 entities of the File Abstraction Layer (FAL) could be persisted directly via `DataHandler`. This allowed attackers to reference files in the fallback storage directly and retrieve their file names and contents. The fallback storage (\"zero-storage\") is used as a backward compatibility layer for files located outside properly configured file storages and within the public web root directory. Exploiting this vulnerability requires a valid backend user account. Users are advised to update to TYPO3 version 8.7.57 ELTS, 9.5.46 ELTS, 10.4.43 ELTS, 11.5.35 LTS, 12.4.11 LTS, or 13.0.1 which fix the problem described. When persisting entities of the File Abstraction Layer directly via DataHandler, `sys_file` entities are now denied by default, and `sys_file_reference` & `sys_file_metadata` entities are not permitted to reference files in the fallback storage anymore. When importing data from secure origins, this must be explicitly enabled in the corresponding DataHandler instance by using `$dataHandler->isImporting = true;`.\n\n\n"}, {"lang": "es", "value": "TYPO3 es un sistema de gesti\u00f3n de contenido web basado en PHP de c\u00f3digo abierto publicado bajo GNU GPL. En las versiones afectadas de TYPO3, las entidades de la capa de abstracci\u00f3n de archivos (FAL) se pod\u00edan conservar directamente a trav\u00e9s de `DataHandler`. Esto permiti\u00f3 a los atacantes hacer referencia a archivos en el almacenamiento alternativo directamente y recuperar sus nombres y contenidos. El almacenamiento alternativo (\"almacenamiento cero\") se utiliza como capa de compatibilidad con versiones anteriores para archivos ubicados fuera de los almacenamientos de archivos configurados correctamente y dentro del directorio ra\u00edz web p\u00fablico. Para explotar esta vulnerabilidad se requiere una cuenta de usuario backend v\u00e1lida. Se recomienda a los usuarios que actualicen a TYPO3 versi\u00f3n 8.7.57 ELTS, 9.5.46 ELTS, 10.4.43 ELTS, 11.5.35 LTS, 12.4.11 LTS o 13.0.1, que solucionan el problema descrito. Cuando se persisten entidades de la capa de abstracci\u00f3n de archivos directamente a trav\u00e9s de DataHandler, las entidades `sys_file` ahora est\u00e1n denegadas de forma predeterminada, y las entidades `sys_file_reference` y `sys_file_metadata` ya no pueden hacer referencia a archivos en el almacenamiento alternativo. Al importar datos desde or\u00edgenes seguros, esto debe habilitarse expl\u00edcitamente en la instancia de DataHandler correspondiente usando `$dataHandler-&gt;isImporting = true;`."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 7.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}, {"lang": "en", "value": "CWE-284"}]}], "references": [{"url": "https://github.com/TYPO3/typo3/security/advisories/GHSA-rj3x-wvc6-5j66", "source": "security-advisories@github.com"}, {"url": "https://typo3.org/security/advisory/typo3-core-sa-2024-006", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-25121 - Directly involving the DataHandler module, which can potentially exploit the ' Tyler-3 ' vulnerability, where an adversary can retrieve a file's name and content. This could result in sensitive data exposure."}, {"techniqueID": "T1190", "comment": "CVE-2024-25121 - As a backend user, an attacker could potentially escalate privileges, gain access to sensitive files/storages, then obtain confidential information, ultimately leading to a data breach."}, {"techniqueID": "T1569", "comment": "CVE-2024-25121 - Identifying an existing vulnerability, exploiting the ' Tyler-3 ' weakness. This bypasses file-local security features and allows attackers to access sensitive data within the fallback storage."}, {"techniqueID": "T1070", "comment": "CVE-2024-25121 - Persistence mechanism, compromising backend storages/cache. Malware can be concealed in previously accessed files and could easily evade detection by exploiting recent access patterns."}, {"techniqueID": "T1083", "comment": "CVE-2024-25121 - An adversary can use the DataHandler module to manipulate/deposit files, permitting them to overwrite or modify stored data, leading to potential data tampering and manipulation."}, {"techniqueID": "T1063", "comment": "CVE-2024-25121 - Disabling security features, such as DataHandler, allows attackers to exploit the weakness and retrieve sensitive data; this is an example of ' Tyler-3 ' vulnerability exploitation."}], "technical_analysis": {"Introduction": "CVE-2024-25121 is an identified vulnerability in the TYPO3 PHP-based web content management system, where the DataHandler module is vulnerable to file data exposure.", "Impact and Scope": "The affected versions of TYPO3 (8.7.57 ELTS, 9.5.46 ELTS, 10.4.43 ELTS, 11.5.35 LTS, 12.4.11 LTS, and 13.0.1) allow exploitation by attackers with valid backend user accounts, potentially accessing sensitive files and data. CVSS score: 7.1, Attack Vector: Network, Attack Complexity: Low, Privileges Required: Low, User Interaction: None, Scope: Unchanged, Confidentiality Impact: High, Integrity Impact: Low, Availability Impact: None.", "Related MITRE ATT&CK Techniques": "The identified techniques related to this CVE include Direct System Access, Exploitation of Public-Facing Applications, Data Storage, Data Manipulation, and Malware to Include Botnets.", "Technical Details": "The vulnerability arises from the persistence of FAL entities using DataHandler, allowing attacks to reference files directly and retrieve their names and contents. To mitigate this, users should update to the recommended versions and enable explicit DataHandler flag.", "Detection": "To detect potential attacks using this CVE, monitoring of system access, file changes, and modifications should be done; also, monitoring DataHandler functionality.", "Mitigation": "Proper system configuration, timely software updates, clear documentation, and regular security checks will help prevent and mitigate attacks."}, "executive_analysis": {"Overview": "CVE-2024-25121 is an identified vulnerability in the TYPO3 PHP-based web content management system, which can be exploited by attackers with valid backend user accounts.", "Business Impact": "This CVE could lead to sensitive data exposure, unauthorized access, and potential data breaches, potentially disrupting critical operations.", "Technical Impact": "This affects the security, reliability, and transparency of the TYPO3 system, potentially compromising data integrity and confidentiality.", "Mitigation Strategies": "Implement timely software updates, regular security checks, and system configuration strategies to prevent misconfiguration.", "Recommendations": "Executive stakeholders should immediately address this vulnerability by implementing necessary measures, allocating necessary resources, and ensuring compliance with security protocols.", "Conclusions": "The CVE-2024-25121 is a critical vulnerability in the TYPO3 system, and immediate action is necessary to prevent exploitation."}}