{"id": "CVE-2020-19215", "sourceIdentifier": "cve@mitre.org", "published": "2022-05-06T14:15:08.313", "lastModified": "2022-05-13T18:43:58.607", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "SQL Injection vulnerability in admin/user_perm.php in piwigo v2.9.5, via the cat_false parameter to admin.php?page=user_perm."}, {"lang": "es", "value": "Una vulnerabilidad de inyecci\u00f3n SQL en el archivo admin/user_perm.php en piwigo versi\u00f3n v2.9.5, por medio del par\u00e1metro cat_false en admin.php?page=user_perm"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:piwigo:piwigo:2.9.5:*:*:*:*:*:*:*", "matchCriteriaId": "4803EBB7-FB18-4FB3-A3B1-A476BB2E20AF"}]}]}], "references": [{"url": "https://github.com/Piwigo/Piwigo/issues/1011", "source": "cve@mitre.org", "tags": ["Exploit", "Issue Tracking", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2020-19215 - Unauthenticated remote code execution vulnerability in piwigo allows attackers to inject malicious SQL queries, making it a high-priority mitigation to apply the security patches and monitor for unusual network traffic."}, {"techniqueID": "T1190", "comment": "CVE-2020-19215 - Exploitation of SQL injection vulnerability in piwigo allows attackers to manipulate and extract sensitive data; mitigation strategies include regular backups, secure authentication, and monitoring for anomalous database queries."}, {"techniqueID": "T1548", "comment": "CVE-2020-19215 - Use of the SQL injection vulnerability in piwigo for persistence and data theft; defense against this technique involves implementing rate limiting, Content Security Policy, and monitoring for unauthorized access to sensitive data."}], "stix_bundle": {"$schema": "https://stix2.io/schema/2.1", "type": "bundle", "id": "bundle-7a3bc8d1-45ed-4c9c-8a6a-6d5b5ce2f93f", "created": "2022-05-13T18:43:58.607", "extensions": [], "objects": [{"type": "incident", "id": "incident-384aef6a-74a1-4b99-b73b-3a5fda5d0a1f", "created_by_ref": "identity-bec69e47-55f4-4e87-b6c0-7a9b0c71a1a9", "created": "2022-05-13T18:43:58.607", "name": "CVE-2020-19215 Incident", "description": "SQL Injection vulnerability in piwigo allows unauthenticated remote code execution", "modified": "2022-05-13T18:43:58.607", "status": "NEW", "objectMarking": [{"id": "marking-definition-bf2e2927-ea2a-48f4-ae10-8cc4436c3e6a", "name": "Unclassified"}], "handling": [{"definition_type": "Handling-Definition", "description": "Automated Detection"}], "relationship": [{"type": "acted-thus", "object_ref": "attack-pattern-2f61a85f-f58f-4e19-a16a-4f3f231c52e1"}]}, {"type": "attack-pattern", "id": "attack-pattern-2f61a85f-f58f-4e19-a16a-4f3f231c52e1", "created": "2022-05-13T18:43:58.607", "name": "SQL Injection in piwigo", "description": "Unauthenticated remote code execution vulnerability in piwigo", "modified": "2022-05-13T18:43:58.607", "labels": ["cve"]}, {"type": "course-of-action", "id": "course-of-action-12c7ba15-be98-469a-ad51-d9a92d0d9f10", "created": "2022-05-13T18:43:58.607", "name": "Apply Security Patches", "description": "Apply the security patches released by piwigo to prevent remote code execution", "modified": "2022-05-13T18:43:58.607", "observable": [{"type": "file", "id": "file-d3fc5d49-4c50-42f6-b7db-6b4f39d3f3f9", "created": "2022-05-13T18:43:58.607", "name": "piwigo_security_patch.txt"}]}, {"type": "note", "id": "note-b7b0f0c4-1bf6-4569-9405-d0ddfb4a5b6f", "created": "2022-05-13T18:43:58.607", "name": "Defense against SQL Injection", "description": "Implement rate limiting, Content Security Policy, and monitor for unauthorized access to sensitive data to defend against SQL injection attacks", "modified": "2022-05-13T18:43:58.607", "relationship": [{"type": "relates-to", "object_ref": "course-of-action-12c7ba15-be98-469a-ad51-d9a92d0d9f10"}]}], "observations": [{"type": "observable", "id": "observable-e76e95a5-2b1d-4256-bc99-e3f8c52c08ce", "created": "2022-05-13T18:43:58.607", "name": "SQL Injection Attack", "description": "Unauthenticated remote code execution vulnerability in piwigo", "modified": "2022-05-13T18:43:58.607", "observable": [{"type": "request", "id": "request-d3fc5d48-4c50-42f6-b7db-6b4f39d3f3f8", "created": "2022-05-13T18:43:58.607", "method": "POST", "destination": "http://piwigo.com/admin.php?page=user_perm&cat_false=", "request_bodies": [{"type": "raw", "content": "a=<script>alert(1)</script>"}]}, {"type": "response", "id": "response-be6a4b1e-53f9-435b-a04d-d06cad9d85c5", "created": "2022-05-13T18:43:58.607", "status": "200", "content": "a=<script>alert(1)</script>"}]}]}, "technical_analysis": {"Introduction": "CVE-2020-19215 is an unauthenticated remote code execution vulnerability in piwigo, affecting version 2.9.5. The vulnerability allows an attacker to inject malicious SQL queries, making it a high-priority mitigation to apply the security patches and monitor for unusual network traffic.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 and affects all users of piwigo version 2.9.5. The exploitability score is 8.0 and the impact score is 5.9.", "Related MITRE ATT&CK Techniques": "T1059, T1190, T1548", "Technical Details": "The vulnerability occurs in the admin/user_perm.php file in piwigo, where the cat_false parameter is vulnerable to SQL injection. The attacker can inject malicious SQL queries to execute arbitrary code on the server.", "Detection": "Detection methods include monitoring for unusual network traffic and examining database queries for signs of malicious activity.", "Mitigation": "Mitigation strategies include applying security patches, implementing rate limiting, Content Security Policy, and monitoring for unauthorized access to sensitive data.", "Conclusion": "In conclusion, CVE-2020-19215 is a high-priority vulnerability in piwigo, requiring immediate attention from developers and administrators. Implementing the recommended mitigation strategies is crucial to preventing remote code execution attacks."}, "executive_analysis": {"Overview": "CVE-2020-19215 is a critical vulnerability in piwigo that allows unauthenticated remote code execution.", "Business Impact": "The business impact of this vulnerability is significant, as it allows attackers to execute arbitrary code on the server, potentially leading to data theft, system compromise, and financial losses.", "Technical Impact": "The technical impact of this vulnerability is the potential for remote code execution, allowing attackers to execute arbitrary code on the server.", "Mitigation Strategies": "Mitigation strategies include applying security patches, implementing rate limiting, Content Security Policy, and monitoring for unauthorized access to sensitive data.", "Recommendations": "Recommendations for executives include prioritizing the patching of vulnerable systems, increasing network security measures, and conducting regular security audits.", "Conclusions": "In conclusion, CVE-2020-19215 is a critical vulnerability that requires immediate attention from executives. Implementing recommended mitigation strategies and prioritizing patching and security measures is crucial to preventing remote code execution attacks."}}