{"id": "CVE-2024-26756", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-03T17:15:52.150", "lastModified": "2024-04-03T17:24:18.150", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmd: Don't register sync_thread for reshape directly\n\nCurrently, if reshape is interrupted, then reassemble the array will\nregister sync_thread directly from pers->run(), in this case\n'MD_RECOVERY_RUNNING' is set directly, however, there is no guarantee\nthat md_do_sync() will be executed, hence stop_sync_thread() will hang\nbecause 'MD_RECOVERY_RUNNING' can't be cleared.\n\nLast patch make sure that md_do_sync() will set MD_RECOVERY_DONE,\nhowever, following hang can still be triggered by dm-raid test\nshell/lvconvert-raid-reshape.sh occasionally:\n\n[root@fedora ~]# cat /proc/1982/stack\n[<0>] stop_sync_thread+0x1ab/0x270 [md_mod]\n[<0>] md_frozen_sync_thread+0x5c/0xa0 [md_mod]\n[<0>] raid_presuspend+0x1e/0x70 [dm_raid]\n[<0>] dm_table_presuspend_targets+0x40/0xb0 [dm_mod]\n[<0>] __dm_destroy+0x2a5/0x310 [dm_mod]\n[<0>] dm_destroy+0x16/0x30 [dm_mod]\n[<0>] dev_remove+0x165/0x290 [dm_mod]\n[<0>] ctl_ioctl+0x4bb/0x7b0 [dm_mod]\n[<0>] dm_ctl_ioctl+0x11/0x20 [dm_mod]\n[<0>] vfs_ioctl+0x21/0x60\n[<0>] __x64_sys_ioctl+0xb9/0xe0\n[<0>] do_syscall_64+0xc6/0x230\n[<0>] entry_SYSCALL_64_after_hwframe+0x6c/0x74\n\nMeanwhile mddev->recovery is:\nMD_RECOVERY_RUNNING |\nMD_RECOVERY_INTR |\nMD_RECOVERY_RESHAPE |\nMD_RECOVERY_FROZEN\n\nFix this problem by remove the code to register sync_thread directly\nfrom raid10 and raid5. And let md_check_recovery() to register\nsync_thread."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: md: No registre sync_thread para remodelar directamente Actualmente, si se interrumpe el proceso de remodelaci\u00f3n, volver a ensamblar la matriz registrar\u00e1 sync_thread directamente desde pers-&gt;run(), en este caso 'MD_RECOVERY_RUNNING ' se configura directamente, sin embargo, no hay garant\u00eda de que md_do_sync() se ejecute, por lo tanto, stop_sync_thread() se bloquear\u00e1 porque 'MD_RECOVERY_RUNNING' no se puede borrar. En el \u00faltimo parche, aseg\u00farese de que md_do_sync() establezca MD_RECOVERY_DONE; sin embargo, dm-raid test shell/lvconvert-raid-reshape.sh ocasionalmente puede activar el siguiente bloqueo: [root@fedora ~]# cat /proc/1982/stack [&lt;0&gt;] stop_sync_thread+0x1ab/0x270 [md_mod] [&lt;0&gt;] md_frozen_sync_thread+0x5c/0xa0 [md_mod] [&lt;0&gt;] raid_presuspend+0x1e/0x70 [dm_raid] [&lt;0&gt;] dm_table_presuspend_targets+0x40/0xb0 [ dm_mod] [&lt;0&gt;] __dm_destroy+0x2a5/0x310 [dm_mod] [&lt;0&gt;] dm_destroy+0x16/0x30 [dm_mod] [&lt;0&gt;] dev_remove+0x165/0x290 [dm_mod] [&lt;0&gt;] ctl_ioctl+0x4bb/ 0x7b0 [dm_mod] [&lt;0&gt;] dm_ctl_ioctl+0x11/0x20 [dm_mod] [&lt;0&gt;] vfs_ioctl+0x21/0x60 [&lt;0&gt;] __x64_sys_ioctl+0xb9/0xe0 [&lt;0&gt;] do_syscall_64+0xc6/0x230 [&lt;0 &gt;] Entry_SYSCALL_64_after_hwframe+0x6c/0x74 Mientras tanto mddev-&gt;recovery es: MD_RECOVERY_RUNNING | MD_RECOVERY_INTR | MD_RECOVERY_RESHAPE | MD_RECOVERY_FROZEN Solucione este problema eliminando el c\u00f3digo para registrar sync_thread directamente desde raid10 y raid5. Y deje que md_check_recovery() registre sync_thread."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/13b520fb62b772e408f9b79c5fe18ad414e90417", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ad39c08186f8a0f221337985036ba86731d6aafe", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1189", "comment": "CVE-2024-26756 - This vulnerability allows an attacker to hang the system by registering sync_thread directly from pers-run(), which can lead to a denial-of-service. Defense strategy: Implement proper recovery mechanisms and ensure that md_do_sync() is executed before setting MD_RECOVERY_DONE."}, {"techniqueID": "T1204", "comment": "CVE-2024-26756 - The vulnerability allows an attacker to inject code by exploiting the incorrect handling of the reshape operation, allowing for unauthorized access. Defense strategy: Implement proper access controls and ensure that reshape operations are properly validated."}, {"techniqueID": "T1211", "comment": "CVE-2024-26756 - The vulnerability allows an attacker to execute unauthorized code by exploiting the incorrect handling of the reshape operation, allowing for privilege escalation. Defense strategy: Implement proper access controls and ensure that reshape operations are properly validated."}, {"techniqueID": "T1518", "comment": "CVE-2024-26756 - The vulnerability allows an attacker to crash the system by exploiting the incorrect handling of the reshape operation, allowing for denial-of-service. Defense strategy: Implement proper recovery mechanisms and ensure that reshape operations are properly validated."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "indicator--b1d4c6b8-27c6-4b4c-9bd3-1f1e1f11db6a", "created_by_ref": "organization--76bf7a37-9cd4-46ce-8ac1-44e43556dd14", "modified": "2024-04-03T17:24:18.150", "name": "CVE-2024-26756", "description": "Indicates a vulnerability in the Linux kernel that allows for denial-of-service and privilege escalation.", "first_seen": "2024-04-03T17:15:52.150", "last_seen": "2024-04-03T17:24:18.150", "observed_data": [{"type": "network-traffic", "id": "network-traffic--c1d4c6b8-27c6-4b4c-9bd3-1f1e1f11db6b", "created_by_ref": "organization--76bf7a37-9cd4-46ce-8ac1-44e43556dd14", "modified": "2024-04-03T17:24:18.150", "name": "md-reshape-traffic", "description": "Indicates unusual traffic patterns related to the md-reshape operation."}]}, {"type": "course-of-action", "id": "course-of-action--c1d4c6b8-27c6-4b4c-9bd3-1f1e1f11db6c", "created_by_ref": "organization--76bf7a37-9cd4-46ce-8ac1-44e43556dd14", "modified": "2024-04-03T17:24:18.150", "name": "Patch and Update", "description": "Apply the latest patches and updates to mitigate the vulnerability."}, {"type": "sighting", "id": "sighting--c1d4c6b8-27c6-4b4c-9bd3-1f1e1f11db6d", "created_by_ref": "organization--76bf7a37-9cd4-46ce-8ac1-44e43556dd14", "modified": "2024-04-03T17:24:18.150", "name": "CVE-2024-26756 Sighting", "description": "A sighting of the CVE-2024-26756 vulnerability."}]}, "technical_analysis": {"Introduction": "The CVE-2024-26756 vulnerability is a critical flaw in the Linux kernel that allows for denial-of-service and privilege escalation.", "Impact and Scope": "The vulnerability affects Linux systems running kernel version 5.0 and above, with a CVSS score of 8.8.", "Related MITRE ATT&CK Techniques": "T1189, T1204, T1211, T1518", "Technical Details": "The vulnerability is related to the incorrect handling of the reshape operation, which allows an attacker to inject code and execute unauthorized actions.", "Detection": "Detection involves monitoring system logs for unusual traffic patterns and system behavior.", "Mitigation": "Mitigation strategies include applying patches and updates, configuring access controls, and implementing proper recovery mechanisms.", "Conclusion": "The CVE-2024-26756 vulnerability is a critical concern that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2024-26756 vulnerability is a critical flaw in the Linux kernel that affects Linux systems running kernel version 5.0 and above.", "Business Impact": "The vulnerability could lead to data breaches, system crashes, and unauthorized access to sensitive data.", "Technical Impact": "The vulnerability allows attackers to execute unauthorized code, leading to privilege escalation and denial-of-service.", "Mitigation Strategies": "Apply patches and updates, configure access controls, and implement proper recovery mechanisms.", "Recommendations": "The vulnerability requires immediate attention and mitigation from executives and IT teams.", "Conclusions": "The CVE-2024-26756 vulnerability is a critical concern that requires immediate attention and mitigation."}}