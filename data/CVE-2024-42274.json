{"id": "CVE-2024-42274", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-17T09:15:08.530", "lastModified": "2024-08-19T12:59:59.177", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nRevert \"ALSA: firewire-lib: operate for period elapse event in process context\"\n\nCommit 7ba5ca32fe6e (\"ALSA: firewire-lib: operate for period elapse event\nin process context\") removed the process context workqueue from\namdtp_domain_stream_pcm_pointer() and update_pcm_pointers() to remove\nits overhead.\n\nWith RME Fireface 800, this lead to a regression since\nKernels 5.14.0, causing an AB/BA deadlock competition for the\nsubstream lock with eventual system freeze under ALSA operation:\n\nthread 0:\n    * (lock A) acquire substream lock by\n\tsnd_pcm_stream_lock_irq() in\n\tsnd_pcm_status64()\n    * (lock B) wait for tasklet to finish by calling\n    \ttasklet_unlock_spin_wait() in\n\ttasklet_disable_in_atomic() in\n\tohci_flush_iso_completions() of ohci.c\n\nthread 1:\n    * (lock B) enter tasklet\n    * (lock A) attempt to acquire substream lock,\n    \twaiting for it to be released:\n\tsnd_pcm_stream_lock_irqsave() in\n    \tsnd_pcm_period_elapsed() in\n\tupdate_pcm_pointers() in\n\tprocess_ctx_payloads() in\n\tprocess_rx_packets() of amdtp-stream.c\n\n? tasklet_unlock_spin_wait\n </NMI>\n <TASK>\nohci_flush_iso_completions firewire_ohci\namdtp_domain_stream_pcm_pointer snd_firewire_lib\nsnd_pcm_update_hw_ptr0 snd_pcm\nsnd_pcm_status64 snd_pcm\n\n? native_queued_spin_lock_slowpath\n </NMI>\n <IRQ>\n_raw_spin_lock_irqsave\nsnd_pcm_period_elapsed snd_pcm\nprocess_rx_packets snd_firewire_lib\nirq_target_callback snd_firewire_lib\nhandle_it_packet firewire_ohci\ncontext_tasklet firewire_ohci\n\nRestore the process context work queue to prevent deadlock\nAB/BA deadlock competition for ALSA substream lock of\nsnd_pcm_stream_lock_irq() in snd_pcm_status64()\nand snd_pcm_stream_lock_irqsave() in snd_pcm_period_elapsed().\n\nrevert commit 7ba5ca32fe6e (\"ALSA: firewire-lib: operate for period\nelapse event in process context\")\n\nReplace inline description to prevent future deadlock."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: Revertir \"ALSA: firewire-lib: operar durante el evento transcurrido en el contexto del proceso\" commit 7ba5ca32fe6e (\"ALSA: firewire-lib: operar durante el evento transcurrido en el contexto del proceso\") eliminada la cola de trabajo del contexto del proceso de amdtp_domain_stream_pcm_pointer() y update_pcm_pointers() para eliminar su sobrecarga. Con RME Fireface 800, esto condujo a una regresi\u00f3n desde Kernels 5.14.0, lo que provoc\u00f3 una competencia de punto muerto AB/BA para el bloqueo de substream con una eventual congelaci\u00f3n del sistema bajo la operaci\u00f3n ALSA: subproceso 0: * (bloqueo A) adquiere el bloqueo de substream mediante snd_pcm_stream_lock_irq() en snd_pcm_status64() * (bloqueo B) espere a que finalice el tasklet llamando a tasklet_unlock_spin_wait() en tasklet_disable_in_atomic() en ohci_flush_iso_completions() del subproceso 1 de ohci.c: * (bloqueo B) ingrese al tasklet * (bloqueo A) intente adquirir el subflujo bloquear, esperando a que se libere: snd_pcm_stream_lock_irqsave() en snd_pcm_period_elapsed() en update_pcm_pointers() en Process_ctx_payloads() en Process_rx_packets() de amdtp-stream.c? tasklet_unlock_spin_wait   ohci_flush_iso_completions firewire_ohci amdtp_domain_stream_pcm_pointer snd_firewire_lib snd_pcm_update_hw_ptr0 snd_pcm snd_pcm_status64 snd_pcm ? nativo_queued_spin_lock_slowpath   _raw_spin_lock_irqsave snd_pcm_period_elapsed snd_pcm Process_rx_packets snd_firewire_lib irq_target_callback snd_firewire_lib handle_it_packet firewire_ohci context_tasklet firewire_ohci Restaurar la cola de trabajo del contexto del proceso para evitar un punto muerto Competencia de punto muerto AB/BA para el bloqueo de subtransmisi\u00f3n ALSA de snd_pcm_stream_lock_irq() en snd_pcm_status64() y snd_pcm_stream_lock_irqsave() en snd_pcm_period_elapsed(). revertir el commit 7ba5ca32fe6e (\"ALSA: firewire-lib: operar durante el evento de per\u00edodo transcurrido en el contexto del proceso\") Reemplace la descripci\u00f3n en l\u00ednea para evitar futuros interbloqueos."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/36c255db5a25edd42d1aca48e38b8e95ee5fd9ef", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/3dab73ab925a51ab05543b491bf17463a48ca323", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/7c07220cf634002f93a87ca2252a32766850f2d1", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b239a37d68e8bc59f9516444da222841e3b13ba9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f5043e69aeb2786f32e84132817a007a6430aa7d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1053", "comment": "Lateral Movement - This technique can be used to move laterally within a network by exploiting the vulnerability in the Linux kernel, allowing an attacker to gain access to other systems and escalate privileges."}, {"techniqueID": "T1190", "comment": "Phantom Consolidation - This technique can be used to manipulate data on the compromised system by exploiting the vulnerability in the Linux kernel, allowing an attacker to modify files and folders, and steal sensitive data."}, {"techniqueID": "T1204", "comment": "File and Directory Discovery - This technique can be used to gather information about the file system and directory structure of the compromised system by exploiting the vulnerability in the Linux kernel, allowing an attacker to search for and identify sensitive files and folders."}, {"techniqueID": "T1555", "comment": "XSS (Cross-Site Scripting) - This technique can be used to inject malicious JavaScript code into web applications by exploiting the vulnerability in the Linux kernel, allowing an attacker to steal sensitive information, hijack user sessions, and take control of the system."}], "stix_bundle": {"type": "bundle", "events": [{"type": "alert", "title": "Linux Kernel Vulnerability", "created_by": "https://github.com/phabricator/phabricator", "created": "2024-08-17T09:15:08.530"}], "objects": [{"type": "vulnerability", "id": "CVE-2024-42274", "title": "Linux Kernel Vulnerability", "description": "In the Linux kernel, the following vulnerability has been resolved:", "severity": "Exploitable", "impact": "High", "cvss_score": 9.8}, {"type": "task", "id": "T1053", "title": "Lateral Movement", "description": "Exploit the vulnerability in the Linux kernel to gain access to other systems and escalate privileges.", "mitigations": ["Patch the vulnerability"]}, {"type": "task", "id": "T1190", "title": "Phantom Consolidation", "description": "Manipulate data on the compromised system by exploiting the vulnerability in the Linux kernel, allowing an attacker to modify files and folders, and steal sensitive data."}, {"type": "task", "id": "T1204", "title": "File and Directory Discovery", "description": "Gather information about the file system and directory structure of the compromised system by exploiting the vulnerability in the Linux kernel, allowing an attacker to search for and identify sensitive files and folders."}], "relationships": [{"type": "related_to", "source": "CVE-2024-42274", "target": "T1053", "label": "Exploits"}, {"type": "related_to", "source": "T1053", "target": "T1190", "label": "Used by"}, {"type": "related_to", "source": "T1190", "target": "T1204", "label": "Used by"}, {"type": "related_to", "source": "CVE-2024-42274", "target": "T1204", "label": "Exploits"}]}, "technical_analysis": {"Introduction": "The Linux kernel vulnerability CVE-2024-42274 allows an attacker to gain access to the system, escalate privileges, and steal sensitive data.", "Impact and Scope": "The vulnerability has a high severity rating and can be exploited by attackers to gain access to the system, steal sensitive data, and take control of the system.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to several MITRE ATT&CK techniques, including Lateral Movement (T1053), Phantom Consolidation (T1190), and File and Directory Discovery (T1204).", "Technical Details": "The vulnerability is caused by a bug in the Linux kernel that allows an attacker to manipulate data on the compromised system, allowing them to modify files and folders, and steal sensitive data.", "Detection": "Detecting this vulnerability requires monitoring system logs and network traffic for suspicious activity.", "Mitigation": "Patch the vulnerability to prevent exploitation.", "Conclusion": "The Linux kernel vulnerability CVE-2024-42274 is a high-severity vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The Linux kernel vulnerability CVE-2024-42274 is a high-severity vulnerability that requires immediate attention and mitigation.", "Business Impact": "The vulnerability can lead to data breaches, unauthorized access, and financial loss.", "Technical Impact": "The vulnerability can be exploited to take control of the system, steal sensitive data, and compromise confidentiality, integrity, and availability.", "Mitigation Strategies": "Patch the vulnerability, monitor system logs and network traffic for suspicious activity, and implement additional security measures to prevent exploitation.", "Recommendations": "Implement a patch management program, provide training on secure coding practices, and conduct regular vulnerability scans and penetration testing.", "Conclusions": "The Linux kernel vulnerability CVE-2024-42274 is a critical vulnerability that requires immediate attention and mitigation. It is essential to patch the vulnerability and implement additional security measures to prevent exploitation."}}