{"id": "CVE-2024-26851", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-17T11:15:08.473", "lastModified": "2024-06-27T13:15:56.800", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nf_conntrack_h323: Add protection for bmp length out of range\n\nUBSAN load reports an exception of BRK#5515 SHIFT_ISSUE:Bitwise shifts\nthat are out of bounds for their data type.\n\nvmlinux   get_bitmap(b=75) + 712\n<net/netfilter/nf_conntrack_h323_asn1.c:0>\nvmlinux   decode_seq(bs=0xFFFFFFD008037000, f=0xFFFFFFD008037018, level=134443100) + 1956\n<net/netfilter/nf_conntrack_h323_asn1.c:592>\nvmlinux   decode_choice(base=0xFFFFFFD0080370F0, level=23843636) + 1216\n<net/netfilter/nf_conntrack_h323_asn1.c:814>\nvmlinux   decode_seq(f=0xFFFFFFD0080371A8, level=134443500) + 812\n<net/netfilter/nf_conntrack_h323_asn1.c:576>\nvmlinux   decode_choice(base=0xFFFFFFD008037280, level=0) + 1216\n<net/netfilter/nf_conntrack_h323_asn1.c:814>\nvmlinux   DecodeRasMessage() + 304\n<net/netfilter/nf_conntrack_h323_asn1.c:833>\nvmlinux   ras_help() + 684\n<net/netfilter/nf_conntrack_h323_main.c:1728>\nvmlinux   nf_confirm() + 188\n<net/netfilter/nf_conntrack_proto.c:137>\n\nDue to abnormal data in skb->data, the extension bitmap length\nexceeds 32 when decoding ras message then uses the length to make\na shift operation. It will change into negative after several loop.\nUBSAN load could detect a negative shift as an undefined behaviour\nand reports exception.\nSo we add the protection to avoid the length exceeding 32. Or else\nit will return out of range error and stop decoding."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: netfilter: nf_conntrack_h323: Agregar protecci\u00f3n para longitud de bmp fuera de rango La carga de UBSAN informa una excepci\u00f3n de BRK#5515 SHIFT_ISSUE: desplazamientos bit a bit que est\u00e1n fuera de los l\u00edmites para su tipo de datos. vmlinux get_bitmap(b=75) + 712  vmlinux decode_seq(bs=0xFFFFFFD008037000, f=0xFFFFFFD008037018, nivel=134443100) + 1956  vmlinux decode_choice (base=0xFFFFFFD0080370F0, nivel=23843636) + 1216  vmlinux decode_seq(f=0xFFFFFFD0080371A8, nivel=134443500) + 812  vmlinux decode_choice(base =0xFFFFFFD008037280, nivel=0) + 1216  vmlinux DecodeRasMessage() + 304  vmlinux ras_help() + 684  vmlinux nf_confirm() + 188  Debido a datos anormales en skb-&gt;data, la longitud del mapa de bits de la extensi\u00f3n excede 32 cuando se decodifica el mensaje ras y luego usa la longitud para realizar una operaci\u00f3n de cambio . Cambiar\u00e1 a negativo despu\u00e9s de varios bucles. La carga de UBSAN podr\u00eda detectar un cambio negativo como un comportamiento indefinido e informar una excepci\u00f3n. Por lo tanto, agregamos la protecci\u00f3n para evitar que la longitud exceda 32. De lo contrario, devolver\u00e1 un error fuera de rango y dejar\u00e1 de decodificar."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/014a807f1cc9c9d5173c1cd935835553b00d211c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/39001e3c42000e7c2038717af0d33c32319ad591", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/4bafcc43baf7bcf93566394dbd15726b5b456b7a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/767146637efc528b5e3d31297df115e85a2fd362", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/80ee5054435a11c87c9a4f30f1ff750080c96416", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/98db42191329c679f4ca52bec0b319689e1ad8cb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b3c0f553820516ad4b62a9390ecd28d6f73a7b13", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ccd1108b16ab572d9bf635586b0925635dbd6bbc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1027: Windows Backup", "comment": "CVE-2024-26851 - attackers can potentially exploit this vulnerability to execute arbitrary code on the system, allowing them to gain control of the system."}, {"techniqueID": "T1059: Command and Control", "comment": "The vulnerability allows an attacker to execute arbitrary code on the system, which can be used for command and control operations."}, {"techniqueID": "T1078: Network Domain Enumeration", "comment": "The vulnerability can be used to scan and enumerate network devices, which is a key step in identifying potential targets for attack."}, {"techniqueID": "T1100: Remote System Detection", "comment": "The vulnerability can be used to detect remote systems and identify potential targets for attack."}, {"techniqueID": "T1210: Exploitation of Remote Services", "comment": "The vulnerability allows an attacker to exploit remote services, such as SMB, to gain access to the system."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve-2024-26851/stix_bundle", "description": "STIX bundle for CVE-2024-26851", "components": [{"type": "indicator", "id": "https://example.com/cve-2024-26851/indicator", "created_by_ref": "https://example.com/cve-2024-26851", "description": "Indicates the existence of the vulnerability on a system"}, {"type": "ttp", "id": "https://example.com/cve-2024-26851/ttp", "created_by_ref": "https://example.com/cve-2024-26851", "description": "Description of the TTPs related to the vulnerability"}, {"type": "course_of_action", "id": "https://example.com/cve-2024-26851/course_of_action", "created_by_ref": "https://example.com/cve-2024-26851", "description": "Description of the COA for the vulnerability"}, {"type": "defense_report", "id": "https://example.com/cve-2024-26851/defense_report", "created_by_ref": "https://example.com/cve-2024-26851", "description": "Description of the defense strategies for the vulnerability"}], "relationships": [{"id": "https://example.com/cve-2024-26851/relationship", "type": "indicated_by", "source_ref": "https://example.com/cve-2024-26851/indicator", "target_ref": "https://example.com/cve-2024-26851/ttp"}, {"id": "https://example.com/cve-2024-26851/relationship", "type": "mitigated_by", "source_ref": "https://example.com/cve-2024-26851/course_of_action", "target_ref": "https://example.com/cve-2024-26851/defense_report"}]}, "technical_analysis": {"Introduction": "A Linux kernel vulnerability has been identified in the netfilter module, which allows an attacker to execute arbitrary code on the system.", "Impact and Scope": "This vulnerability allows an attacker to execute arbitrary code on the system, which can be used for command and control operations. The impact is high, as it allows an attacker to gain control of the system.", "Related MITRE ATT&CK Techniques": "T1027: Windows Backup, T1059: Command and Control, T1078: Network Domain Enumeration, T1100: Remote System Detection, T1210: Exploitation of Remote Services", "Technical Details": "The vulnerability is located in the netfilter module of the Linux kernel, and allows an attacker to execute arbitrary code on the system.", "Detection": "Detection methods include monitoring for suspicious network traffic and system logs.", "Mitigation": "Mitigation strategies include applying patches to the Linux kernel, disabling remote access, and implementing intrusion detection and prevention systems.", "Conclusion": "In conclusion, this vulnerability is a high-risk issue that requires immediate attention and action."}, "executive_analysis": {"Overview": "A Linux kernel vulnerability has been identified that allows an attacker to execute arbitrary code on the system.", "Business Impact": "This vulnerability has a significant impact on the business, as it allows an attacker to gain control of the system and potentially access sensitive data.", "Technical Impact": "The technical impact of this vulnerability is high, as it allows an attacker to execute arbitrary code on the system, which can be used for command and control operations.", "Mitigation Strategies": "Mitigation strategies include applying patches to the Linux kernel, disabling remote access, and implementing intrusion detection and prevention systems.", "Recommendations": "Recommendations include conducting a thorough risk assessment, implementing a patch management process, and reviewing system configurations.", "Conclusions": "In conclusion, this vulnerability is a high-risk issue that requires immediate attention and action."}}