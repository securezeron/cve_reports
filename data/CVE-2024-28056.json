{"id": "CVE-2024-28056", "sourceIdentifier": "cve@mitre.org", "published": "2024-04-15T18:15:10.723", "lastModified": "2024-08-15T19:35:07.857", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Amazon AWS Amplify CLI before 12.10.1 incorrectly configures the role trust policy of IAM roles associated with Amplify projects. When the Authentication component is removed from an Amplify project, a Condition property is removed but \"Effect\":\"Allow\" remains present, and consequently sts:AssumeRoleWithWebIdentity would be available to threat actors with no conditions. Thus, if Amplify CLI had been used to remove the Authentication component from a project built between August 2019 and January 2024, an \"assume role\" may have occurred, and may have been leveraged to obtain unauthorized access to an organization's AWS resources. NOTE: the problem could only occur if an authorized AWS user removed an Authentication component. (The vulnerability did not give a threat actor the ability to remove an Authentication component.) However, in realistic situations, an authorized AWS user may have removed an Authentication component, e.g., if the objective were to stop using built-in Cognito resources, or move to a completely different identity provider."}, {"lang": "es", "value": "La CLI de Amazon AWS Amplify anterior a 12.10.1 configura incorrectamente la pol\u00edtica de confianza de roles de los roles de IAM asociados con proyectos de Amplify. Cuando se elimina el componente Autenticaci\u00f3n de un proyecto de Amplify, se elimina una propiedad Condici\u00f3n, pero \"Efecto\": \"Permitir\" permanece presente y, en consecuencia, sts:AssumeRoleWithWebIdentity estar\u00eda disponible para los actores de amenazas sin condiciones. Por lo tanto, si se hubiera utilizado la CLI de Amplify para eliminar el componente de autenticaci\u00f3n de un proyecto creado entre agosto de 2019 y enero de 2024, es posible que se haya producido una \"asumici\u00f3n de rol\" y que se haya aprovechado para obtener acceso no autorizado a los recursos de AWS de una organizaci\u00f3n. NOTA: el problema solo podr\u00eda ocurrir si un usuario autorizado de AWS elimin\u00f3 un componente de autenticaci\u00f3n. (La vulnerabilidad no le dio al actor de amenazas la capacidad de eliminar un componente de autenticaci\u00f3n). Sin embargo, en situaciones realistas, un usuario autorizado de AWS puede haber eliminado un componente de autenticaci\u00f3n, por ejemplo, si el objetivo fuera dejar de usar los recursos integrados de Cognito, o cambiar a un proveedor de identidad completamente diferente."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "references": [{"url": "https://aws.amazon.com/security/security-bulletins/AWS-2024-003/", "source": "cve@mitre.org"}, {"url": "https://github.com/aws-amplify/amplify-cli/blob/8ad57bf99a404f3c92547c8a175458016f682fac/packages/amplify-provider-awscloudformation/resources/update-idp-roles-cfn.json", "source": "cve@mitre.org"}, {"url": "https://github.com/aws-amplify/amplify-cli/commit/73b08dc424db2fb60399c5343c314e02e849d4a1", "source": "cve@mitre.org"}, {"url": "https://github.com/aws-amplify/amplify-cli/releases/tag/v12.10.1", "source": "cve@mitre.org"}, {"url": "https://securitylabs.datadoghq.com/articles/amplified-exposure-how-aws-flaws-made-amplify-iam-roles-vulnerable-to-takeover/", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1110", "comment": "Abuse of Functionality - The vulnerability allows an unauthorized actor to assume the role of an IAM role, an Attack Actor using this functionality to gain unauthorized access."}, {"techniqueID": "T1133", "comment": "File and Directory Discovery - An attacker may use this vulnerability to discover and access AWS resources, potentially leading to elevated privileges and increased attack capability."}, {"techniqueID": "T1208", "comment": "Data Encoding - The vulnerability potentially allows an attacker to encode and decode data in order to manipulate or hide malicious intent."}, {"techniqueID": "T1565", "comment": "ModOperator - The vulnerability enables an attacker to modify the configuration of IAM roles, potentially allowing command and control functionality or data exfiltration."}, {"techniqueID": "T1505", "comment": "Cryptographic Attacks - The vulnerability may be used to attack AWS IAM roles, potentially allowing an attacker to obtain unauthorized access or manipulate sensitive data."}], "stix_bundle": {"type": "stix-2.1", "spec_version": "2.1", "id": "CVE-2024-28056-vulnerability", "created_by_ref": "https://example.com", "created": "2024-08-15T19:35:07.857", "modified": "2024-08-15T19:35:07.857", "objects": [{"type": "note", "id": "notes-1", "description": "Vulnerability Description", "created_by_ref": "https://example.com", "created": "2024-08-15T19:35:07.857"}, {"type": "bundle", "id": "bundle-1", "spec_version": "2.1", "description": "STIX Bundle for CVE-2024-28056", "created_by_ref": "https://example.com", "created": "2024-08-15T19:35:07.857", "objects": [{"type": "event", "id": "event-1", "description": "Vulnerability Detection", "created_by_ref": "https://example.com", "created": "2024-08-15T19:35:07.857"}, {"type": "course-of-action", "id": "course-of-action-1", "description": "Patch and Update Amplify CLI", "created_by_ref": "https://example.com", "created": "2024-08-15T19:35:07.857"}]}], "relationship": [{"from": "notes-1", "to": "bundle-1", "type": "contains"}]}, "technical_analysis": {"Introduction": "CVE-2024-28056 is a vulnerability in Amazon AWS Amplify CLI before 12.10.1 that allows an unauthorized actor to assume the role of an IAM role.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and affects Amplify CLI users who used the Authentication component before January 2024.", "Related MITRE ATT&CK Techniques": "T1110, T1133, T1208, T1565, T1505", "Technical Details": "The vulnerability occurs when the Authentication component is removed from an Amplify project, leaving the role trust policy unchanged.", "Detection": "Detection methods include monitoring for unusual AWS IAM role activity and logging events related to role assumption.", "Mitigation": "Mitigation strategies include patching and updating Amplify CLI, restricting IAM role access, and monitoring for unusual activity.", "Conclusion": "CVE-2024-28056 is a critical vulnerability that highlights the importance of regular software updates and monitoring for unusual activity."}, "executive_analysis": {"Overview": "CVE-2024-28056 is a critical vulnerability in Amazon AWS Amplify CLI that can allow unauthorized actors to assume IAM roles.", "Business Impact": "The vulnerability has significant business implications, including increased risk of data breaches and unauthorized access to AWS resources.", "Technical Impact": "The vulnerability affects Amplify CLI users who used the Authentication component before January 2024 and may allow attackers to obtain unauthorized access to AWS resources.", "Mitigation Strategies": "Patching and updating Amplify CLI, restricting IAM role access, and monitoring for unusual activity are recommended mitigation strategies.", "Recommendations": "Executives should recommend that organizations patch and update Amplify CLI, restrict IAM role access, and monitor for unusual activity to mitigate the vulnerability.", "Conclusions": "CVE-2024-28056 is a critical vulnerability that requires immediate attention and monitoring to prevent unauthorized access to AWS resources."}}