{"id": "CVE-2009-4358", "sourceIdentifier": "cve@mitre.org", "published": "2009-12-20T02:30:00.547", "lastModified": "2009-12-21T05:00:00.000", "vulnStatus": "Analyzed", "cveTags": [], "evaluatorSolution": "Per: http://security.freebsd.org/advisories/FreeBSD-SA-09:17.freebsd-update.asc\r\n\r\n\"2) To patch your present system:\r\n\r\nThe following patch has been verified to apply to FreeBSD 6.3, 6.4,\r\n7.1, 7.2, and 8.0 systems.\r\n\r\na) Download the relevant patch from the location below, and verify the\r\ndetached PGP signature using your PGP utility.\r\n\r\n# fetch http://security.FreeBSD.org/patches/SA-09:17/freebsd-update.patch\r\n# fetch http://security.FreeBSD.org/patches/SA-09:17/freebsd-update.patch.asc\"", "descriptions": [{"lang": "en", "value": "freebsd-update in FreeBSD 8.0, 7.2, 7.1, 6.4, and 6.3 uses insecure permissions in its working directory (/var/db/freebsd-update by default), which allows local users to read copies of sensitive files after a (1) freebsd-update fetch (fetch) or (2) freebsd-update upgrade (upgrade) operation."}, {"lang": "es", "value": "FreeBSD-update en FreeBSD v8.0, v7.2, v7.1, v6.4, y v6.3 utiliza permisos inseguros en su directorio de trabajo (/var/db/Freebsd-update por defecto), lo que permite leer las copias de archivos confidenciales a usuarios locales  despu\u00e9s de una operacion de actualizaci\u00f3n (1) freebsd-update (fetch) o (2) freebsd-update (upgrade)."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:C/I:N/A:N", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.7}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 6.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:6.3:*:*:*:*:*:*:*", "matchCriteriaId": "F702C46F-CA02-4FA2-B7D6-C61C2C095679"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:6.4:*:*:*:*:*:*:*", "matchCriteriaId": "A4F7F02A-C845-40BF-8490-510A070000F3"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.1:*:*:*:*:*:*:*", "matchCriteriaId": "803EFA9F-B7CB-4511-B1C1-381170CA9A23"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.2:*:*:*:*:*:*:*", "matchCriteriaId": "F948527C-A01E-4315-80B6-47FACE18A34F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "3CF1F9EF-01AF-4708-AE02-765360AF3D66"}]}]}], "references": [{"url": "http://secunia.com/advisories/37575", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://security.freebsd.org/advisories/FreeBSD-SA-09:17.freebsd-update.asc", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/37190", "source": "cve@mitre.org", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1110", "comment": "Use Another Vector - This technique is relevant to CVE-2009-4358 as it allows an attacker to use insecure permissions in the freebsd-update working directory to access sensitive files. Defend against it by restricting access to the working directory and monitoring for unauthorized access."}, {"techniqueID": "T1210", "comment": "Exploitation of Public-Facing Application - This technique is relevant to CVE-2009-4358 as it allows an attacker to exploit a public-facing application (freebsd-update) to access sensitive files. Defend against it by securing public-facing applications and monitoring for unauthorized access."}], "stix_bundle": {"type": "bundle", "id": "b-00001", "title": "CVE-2009-4358 Mitre ATT&CK and D3FEND Bundle", "created_by_ref": "a-00001", "created": "2022-01-01T12:00:00.000", "modified": "2022-01-01T12:00:00.000", "objects": [{"type": "vulnerability", "id": "v-00001", "name": "CVE-2009-4358", "description": "freebsd-update in FreeBSD 8.0, 7.2, 7.1, 6.4, and 6.3 uses insecure permissions in its working directory (/var/db/freebsd-update by default), which allows local users to read copies of sensitive files after a (1) freebsd-update fetch (fetch) or (2) freebsd-update upgrade (upgrade) operation."}, {"type": "attack_pattern", "id": "ap-00001", "name": "Use Another Vector", "description": "Use another vector to bypass security controls or gain access to systems.", "related_vulnerabilities": ["v-00001"]}, {"type": "attack_pattern", "id": "ap-00002", "name": "Exploitation of Public-Facing Application", "description": "Exploit a public-facing application to gain access to systems.", "related_vulnerabilities": ["v-00001"]}, {"type": "course_of_action", "id": "coa-00001", "name": "Restrict Access to Working Directory", "description": "Restrict access to the freebsd-update working directory to prevent unauthorized access.", "related_attack_patterns": ["ap-00001"]}, {"type": "course_of_action", "id": "coa-00002", "name": "Secure Public-Facing Applications", "description": "Secure public-facing applications to prevent exploitation.", "related_attack_patterns": ["ap-00002"]}], "relationships": [{"type": "relates_to", "id": "r-00001", "from": "v-00001", "to": "ap-00001"}, {"type": "relates_to", "id": "r-00002", "from": "v-00001", "to": "ap-00002"}]}, "technical_analysis": {"Introduction": "The vulnerability CVE-2009-4358 in freebsd-update in multiple versions of FreeBSD allows local users to read copies of sensitive files due to insecure permissions. This vulnerability is exploited by attackers using the Use Another Vector and Exploitation of Public-Facing Application techniques.", "Impact and Scope": "The impact of this vulnerability is moderate, with a CVSS score of 4.7 with a version of 2.0.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are Use Another Vector and Exploitation of Public-Facing Application.", "Technical Details": "The freebsd-update working directory is not properly secured, allowing local users to access sensitive files.", "Detection": "Detection of this vulnerability is challenging, as it requires monitoring for unauthorized access to the working directory.", "Mitigation": "Restricting access to the working directory and securing public-facing applications are effective mitigation strategies.", "Conclusion": "In conclusion, this vulnerability is significant and requires prompt attention to prevent exploitation."}, "executive_analysis": {"Overview": "The vulnerability CVE-2009-4358 is a serious security issue that affects multiple versions of FreeBSD.", "Business Impact": "This vulnerability can allow unauthorized access to sensitive files, which can lead to significant business consequences.", "Technical Impact": "The technical impact of this vulnerability is the potential for local users to access sensitive files.", "Mitigation Strategies": "Restricting access to the working directory and securing public-facing applications are effective mitigation strategies.", "Recommendations": "Implement the recommended mitigation strategies to prevent exploitation of this vulnerability.", "Conclusions": "In conclusion, prompt attention is required to prevent exploitation of this vulnerability and protect business assets."}}