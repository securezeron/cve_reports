{"id": "CVE-2024-27917", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-06T20:15:48.120", "lastModified": "2024-03-06T21:42:48.053", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Shopware is an open commerce platform based on Symfony Framework and Vue. The Symfony Session Handler pops the Session Cookie and assigns it to the Response. Since Shopware 6.5.8.0, the 404 pages are cached to improve the performance of 404 pages. So the cached Response which contains a Session Cookie when the Browser accessing the 404 page, has no cookies yet. The Symfony Session Handler is in use, when no explicit Session configuration has been done. When Redis is in use for Sessions using the PHP Redis extension, this exploiting code is not used. Shopware version 6.5.8.7 contains a patch for this issue. As a workaround, use Redis for Sessions, as this does not trigger the exploit code."}, {"lang": "es", "value": "Shopware es una plataforma de comercio abierta basada en Symfony Framework y Vue. El controlador de sesi\u00f3n de Symfony genera la cookie de sesi\u00f3n y la asigna a la respuesta. Desde Shopware 6.5.8.0, las 404 p\u00e1ginas se almacenan en cach\u00e9 para mejorar el rendimiento de las 404 p\u00e1ginas. Entonces, la respuesta almacenada en cach\u00e9 que contiene una cookie de sesi\u00f3n cuando el navegador accede a la p\u00e1gina 404 a\u00fan no tiene cookies. El controlador de sesi\u00f3n de Symfony est\u00e1 en uso cuando no se ha realizado ninguna configuraci\u00f3n de sesi\u00f3n expl\u00edcita. Cuando Redis se utiliza para sesiones que utilizan la extensi\u00f3n PHP Redis, este c\u00f3digo de explotaci\u00f3n no se utiliza. La versi\u00f3n 6.5.8.7 de Shopware contiene un parche para este problema. Como soluci\u00f3n alternativa, utilice Redis para sesiones, ya que esto no activa el c\u00f3digo de explotaci\u00f3n."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-524"}]}], "references": [{"url": "https://github.com/shopware/shopware/commit/7d9cb03225efca5f97e69b800d8747598dd15ce3", "source": "security-advisories@github.com"}, {"url": "https://github.com/shopware/shopware/releases/tag/v6.5.8.7", "source": "security-advisories@github.com"}, {"url": "https://github.com/shopware/shopware/security/advisories/GHSA-c2f9-4jmm-v45m", "source": "security-advisories@github.com"}, {"url": "https://github.com/shopware/storefront/commit/3477e4a425d3c54b4bfae82d703fe3838dc21d3e", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-27917 - This is an example of session management vulnerability that allows attackers to steal session cookies, this is a common technique used in web applications attacks, it is important to identify and defend against it using WAF and web application firewalls."}, {"techniqueID": "T1040", "comment": "CVE-2024-27917 - This is an example of network service exploitation, attackers can exploit this vulnerability to steal sensitive information, it is important to identify and defend against it using network segmentation and access control."}, {"techniqueID": "T1179", "comment": "CVE-2024-27917 - This is an example of session hijacking, attackers can use this vulnerability to steal session cookies and takeover user sessions, it is important to identify and defend against it using session management best practices and secure session handling."}, {"techniqueID": "T1193", "comment": "CVE-2024-27917 - This is an example of web shells and other web-based attacks, attackers can use this vulnerability to upload web shells and execute malicious code, it is important to identify and defend against it using web application firewalls and file integrity monitoring."}], "stix_bundle": {"type": "bundle", "-spec-version": "2.1", "id": "CVE-2024-27917-STIX-Bundle", "name": "Shopware 6.5.8.0 Session Cookie Stealing Vulnerability", "created_by": "cybersecurity-expert", "created": "2024-03-06T20:15:48.120", "modified": "2024-03-06T21:42:48.053", "version": "1.0", "objects": [{"id": "CVE-2024-27917", "type": "vulnerability", "name": "Shopware 6.5.8.0 Session Cookie Stealing Vulnerability", "description": "Shopware is an open commerce platform based on Symfony Framework and Vue. The Symfony Session Handler pops the Session Cookie and assigns it to the Response. Since Shopware 6.5.8.0, the 404 pages are cached to improve the performance of 404 pages.", "baseScore": 7.5, "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE"}, {"id": "T1190", "type": "technique", "name": "Input Validation Weakness", "description": "This is a technique where an attacker can steal session cookies by manipulating user input, it is essential to validate user input to prevent this attack."}, {"id": "T1040", "type": "technique", "name": "Network Service Scanning", "description": "This is a technique used by attackers to identify open network services, it is essential to identify and block these services to prevent attacks."}, {"id": "T1179", "type": "technique", "name": "Session Hijacking", "description": "This is a technique where an attacker can steal session cookies and takeover user sessions, it is essential to use secure session handling and monitor session activity."}, {"id": "T1193", "type": "technique", "name": "Web Shell", "description": "This is a technique used by attackers to upload web shells and execute malicious code, it is essential to detect and block web shells."}], "relationships": [{"type": "related_to", "id": "CVE-2024-27917", "target_id": "T1190", "relationship_type": "vulnerability_utilizes_technique"}, {"type": "related_to", "id": "CVE-2024-27917", "target_id": "T1040", "relationship_type": "vulnerability_vulnerable_to_technique"}, {"type": "related_to", "id": "CVE-2024-27917", "target_id": "T1179", "relationship_type": "vulnerability_vulnerable_to_technique"}, {"type": "related_to", "id": "CVE-2024-27917", "target_id": "T1193", "relationship_type": "vulnerability_vulnerable_to_technique"}]}, "technical_analysis": {"Introduction": "This vulnerability is a session management vulnerability in Shopware 6.5.8.0 that allows attackers to steal session cookies, it is essential to identify and defend against this vulnerability.", "Impact and Scope": "The impact of this vulnerability is moderate as it allows attackers to steal sensitive information, it is essential to identify and defend against it.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190, T1040, T1179, T1193, it is essential to identify and defend against these techniques.", "Technical Details": "The vulnerability occurs when the Symfony Session Handler pops the Session Cookie and assigns it to the Response, it is essential to validate session cookies and monitor session activity.", "Detection": "To detect this vulnerability, it is essential to monitor session activity and validate session cookies, it is also essential to use web application firewalls and network security tools.", "Mitigation": "To mitigate this vulnerability, it is essential to patch Shopware to version 6.5.8.7, it is also essential to use secure session handling and validate session cookies, it is also essential to use web application firewalls and network security tools.", "Conclusion": "This is a summary of the technical analysis of the vulnerability, it is essential to identify and defend against this vulnerability."}, "executive_analysis": {"Overview": "This is an overview of the vulnerability, it is essential to understand the impact and scope of the vulnerability.", "Business Impact": "The business impact of this vulnerability is moderate as it allows attackers to steal sensitive information, it is essential to understand the business impact of this vulnerability.", "Technical Impact": "The technical impact of this vulnerability is moderate as it allows attackers to steal sensitive information, it is essential to understand the technical impact of this vulnerability.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are to patch Shopware to version 6.5.8.7, use secure session handling, validate session cookies, use web application firewalls and network security tools.", "Recommendations": "The recommendations for executives are to patch Shopware to version 6.5.8.7, use secure session handling, validate session cookies, use web application firewalls and network security tools.", "Conclusions": "This is a summary of the executive analysis of the vulnerability, it is essential to understand the business and technical impact of the vulnerability."}}