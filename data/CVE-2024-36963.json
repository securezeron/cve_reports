{"id": "CVE-2024-36963", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-03T08:15:09.820", "lastModified": "2024-06-03T14:46:24.250", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ntracefs: Reset permissions on remount if permissions are options\n\nThere's an inconsistency with the way permissions are handled in tracefs.\nBecause the permissions are generated when accessed, they default to the\nroot inode's permission if they were never set by the user. If the user\nsets the permissions, then a flag is set and the permissions are saved via\nthe inode (for tracefs files) or an internal attribute field (for\neventfs).\n\nBut if a remount happens that specify the permissions, all the files that\nwere not changed by the user gets updated, but the ones that were are not.\nIf the user were to remount the file system with a given permission, then\nall files and directories within that file system should be updated.\n\nThis can cause security issues if a file's permission was updated but the\nadmin forgot about it. They could incorrectly think that remounting with\npermissions set would update all files, but miss some.\n\nFor example:\n\n # cd /sys/kernel/tracing\n # chgrp 1002 current_tracer\n # ls -l\n[..]\n -rw-r-----  1 root root 0 May  1 21:25 buffer_size_kb\n -rw-r-----  1 root root 0 May  1 21:25 buffer_subbuf_size_kb\n -r--r-----  1 root root 0 May  1 21:25 buffer_total_size_kb\n -rw-r-----  1 root lkp  0 May  1 21:25 current_tracer\n -rw-r-----  1 root root 0 May  1 21:25 dynamic_events\n -r--r-----  1 root root 0 May  1 21:25 dyn_ftrace_total_info\n -r--r-----  1 root root 0 May  1 21:25 enabled_functions\n\nWhere current_tracer now has group \"lkp\".\n\n # mount -o remount,gid=1001 .\n # ls -l\n -rw-r-----  1 root tracing 0 May  1 21:25 buffer_size_kb\n -rw-r-----  1 root tracing 0 May  1 21:25 buffer_subbuf_size_kb\n -r--r-----  1 root tracing 0 May  1 21:25 buffer_total_size_kb\n -rw-r-----  1 root lkp     0 May  1 21:25 current_tracer\n -rw-r-----  1 root tracing 0 May  1 21:25 dynamic_events\n -r--r-----  1 root tracing 0 May  1 21:25 dyn_ftrace_total_info\n -r--r-----  1 root tracing 0 May  1 21:25 enabled_functions\n\nEverything changed but the \"current_tracer\".\n\nAdd a new link list that keeps track of all the tracefs_inodes which has\nthe permission flags that tell if the file/dir should use the root inode's\npermission or not. Then on remount, clear all the flags so that the\ndefault behavior of using the root inode's permission is done for all\nfiles and directories."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: tracefs: restablece los permisos al volver a montar si los permisos son opciones. Hay una inconsistencia en la forma en que se manejan los permisos en tracefs. Debido a que los permisos se generan cuando se accede a ellos, de forma predeterminada son los permisos del inodo ra\u00edz si el usuario nunca los configur\u00f3. Si el usuario establece los permisos, entonces se establece una bandera y los permisos se guardan a trav\u00e9s del inodo (para archivos tracefs) o un campo de atributo interno (para eventfs). Pero si ocurre un reinicio que especifica los permisos, todos los archivos que no fueron modificados por el usuario se actualizan, pero los que s\u00ed no lo fueron. Si el usuario volviera a montar el sistema de archivos con un permiso determinado, entonces todos los archivos y directorios dentro de ese sistema de archivos deber\u00edan actualizarse. Esto puede causar problemas de seguridad si se actualiz\u00f3 el permiso de un archivo pero el administrador lo olvid\u00f3. Podr\u00edan pensar incorrectamente que volver a montar con los permisos establecidos actualizar\u00eda todos los archivos, pero perder\u00eda algunos. Por ejemplo: # cd /sys/kernel/tracing # chgrp 1002 current_tracer # ls -l [..] -rw-r----- 1 ra\u00edz ra\u00edz 0 1 de mayo 21:25 buffer_size_kb -rw-r---- - 1 ra\u00edz ra\u00edz 0 1 de mayo 21:25 buffer_subbuf_size_kb -r--r----- 1 ra\u00edz ra\u00edz 0 1 de mayo 21:25 buffer_total_size_kb -rw-r----- 1 ra\u00edz lkp 0 1 de mayo 21:25 current_tracer -rw-r----- 1 ra\u00edz ra\u00edz 0 1 de mayo 21:25 Dynamic_events -r--r----- 1 ra\u00edz ra\u00edz 0 1 de mayo 21:25 dyn_ftrace_total_info -r--r----- 1 root root 0 1 de mayo 21:25 enable_functions Donde current_tracer ahora tiene el grupo \"lkp\". # montar -o remontar, gid=1001. # ls -l -rw-r----- 1 rastreo de ra\u00edz 0 1 de mayo 21:25 buffer_size_kb -rw-r----- 1 rastreo de ra\u00edz 0 1 de mayo 21:25 buffer_subbuf_size_kb -r--r--- -- 1 rastreo de ra\u00edz 0 1 de mayo 21:25 buffer_total_size_kb -rw-r----- 1 rastreo de ra\u00edz 0 1 de mayo 21:25 current_tracer -rw-r----- 1 rastreo de ra\u00edz 0 1 de mayo 21:25 Dynamic_events -r--r----- 1 rastreo de ra\u00edz 0 1 de mayo 21:25 dyn_ftrace_total_info -r--r----- 1 rastreo de ra\u00edz 0 1 de mayo 21:25 enable_functions Todo cambi\u00f3 excepto el \"current_tracer\". Agregue una nueva lista de enlaces que realice un seguimiento de todos los tracefs_inodes que tienen indicadores de permiso que indican si el archivo/directorio debe usar el permiso del inodo ra\u00edz o no. Luego, al volver a montar, borre todas las banderas para que el comportamiento predeterminado de usar el permiso del inodo ra\u00edz se realice para todos los archivos y directorios."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/414fb08628143203d29ccd0264b5a83fb9523c03", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5f91fc82794d4a6e41cdcd02d00baa377d94ca78", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/baa23a8d4360d981a49913841a726edede5cdd54", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-36963 - This technique can be used for lateral movement by manipulating file permissions during a remount operation."}, {"techniqueID": "T1190", "comment": "CVE-2024-36963 - The vulnerability can be exploited to gain elevated privileges by modifying file permissions during a remount operation."}, {"techniqueID": "T1078", "comment": "CVE-2024-36963 - The vulnerability can be used to move laterally by remounting the file system with different permissions."}, {"techniqueID": "T1210", "comment": "CVE-2024-36963 - The vulnerability can be used to create a persistence mechanism by modifying file permissions during a remount operation."}], "stix_bundle": "{\"bundle\": {\"generated_timestamp\": \"2024-06-03T14:46:24.250\", \"description\": \"MITRE ATT&CK STIX Bundle for CVE-2024-36963\", \"objects\": [\"vulnerability:vulnerability_1\", \"technique:technique_1\", \"course_of_action:course_of_action_1\"], \"relationships\": [\"vulnerability:vulnerability_1\" related_to \"technique:technique_1\"], \"threat_actor_files\": [], \"notes\": [\"Note 1: The vulnerability can be exploited to gain elevated privileges.\", \"Note 2: The vulnerability can be used to move laterally.\"]}}\"", "technical_analysis": {"Introduction": "CVE-2024-36963 is a Linux kernel vulnerability that affects the tracefs feature. It allows attackers to manipulate file permissions during a remount operation, which can be used for lateral movement, privilege escalation, and persistence.", "Impact and Scope": "CVSS Score: 8.8, Version: 3.1, Attack Vector: NETWORK. The vulnerability affects Linux kernel version 5.17 and later.", "Related MITRE ATT&CK Techniques": "T1027, T1190, T1078, T1210", "Technical Details": "The vulnerability occurs in the tracefs feature of the Linux kernel. When a remount operation is performed with different permissions, the vulnerability can be exploited to manipulate file permissions.", "Detection": "Detection methods include monitoring for unusual file permission changes during a remount operation.", "Mitigation": "Mitigation strategies include disabling the tracefs feature, restricting access to the remount operation, and implementing monitoring for unusual file permission changes.", "Conclusion": "In conclusion, CVE-2024-36963 is a significant vulnerability that can be exploited for lateral movement, privilege escalation, and persistence. It is essential to apply patches and implement mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-36963 is a critical vulnerability in the Linux kernel that can be exploited for devastating attacks.", "Business Impact": "The vulnerability can lead to compromised data, system downtime, and reputational damage.", "Technical Impact": "The vulnerability can be exploited to gain elevated privileges, move laterally, and create a persistence mechanism.", "Mitigation Strategies": "Apply patches, restrict access to the remount operation, and implement monitoring for unusual file permission changes.", "Recommendations": "Recommendations for executives include prioritizing patching and implementing mitigation strategies to prevent exploitation.", "Conclusions": "In conclusion, CVE-2024-36963 is a critical vulnerability that requires immediate attention. It is essential to prioritize patching and implement mitigation strategies to prevent exploitation and minimize damage."}}