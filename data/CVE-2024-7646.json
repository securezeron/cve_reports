{"id": "CVE-2024-7646", "sourceIdentifier": "jordan@liggitt.net", "published": "2024-08-16T18:15:10.970", "lastModified": "2024-08-19T13:00:23.117", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A security issue was discovered in ingress-nginx where an actor with permission to create Ingress objects (in the `networking.k8s.io` or `extensions` API group) can bypass annotation validation to inject arbitrary commands and obtain the credentials of the ingress-nginx controller. In the default configuration, that credential has access to all secrets in the cluster."}, {"lang": "es", "value": "Se descubri\u00f3 un problema de seguridad en ingress-nginx donde un actor con permiso para crear objetos de Ingress (en el grupo API `networking.k8s.io` o `extensions`) puede omitir la validaci\u00f3n de anotaciones para inyectar comandos arbitrarios y obtener las credenciales del controlador ingress-nginx. En la configuraci\u00f3n predeterminada, esa credencial tiene acceso a todos los secretos del cl\u00faster."}], "metrics": {"cvssMetricV31": [{"source": "jordan@liggitt.net", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "jordan@liggitt.net", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "https://github.com/kubernetes/ingress-nginx/pull/11719", "source": "jordan@liggitt.net"}, {"url": "https://github.com/kubernetes/ingress-nginx/pull/11721", "source": "jordan@liggitt.net"}, {"url": "https://github.com/kubernetes/kubernetes/issues/126744", "source": "jordan@liggitt.net"}, {"url": "https://groups.google.com/g/kubernetes-security-announce/c/a1__cKjWkfA", "source": "jordan@liggitt.net"}], "techniques": [{"techniqueID": "T1096", "comment": "CVE-2024-7646 - This vulnerability allows an actor with permission to create Ingress objects to inject arbitrary commands and obtain the credentials of the ingress-nginx controller. This is relevant because it allows for a potential privilege escalation and ability to manipulate system components."}, {"techniqueID": "T1190", "comment": "CVE-2024-7646 - This vulnerability also allows an actor to bypass annotation validation and inject arbitrary commands, which is relevant because it highlights the importance of proper input validation and sanitization."}, {"techniqueID": "T1218", "comment": "CVE-2024-7646 - The vulnerability's use of Ingress objects to inject commands and obtain credentials is similar to other techniques, such as T1218. This is relevant because it indicates that the vulnerability is part of a larger category of techniques that rely on exploiting Ingress objects."}], "stix_bundle": {"id": "bundle-1234", "type": "bundle", "objects": [{"id": "vulnerability-1234", "type": "vulnerability", "name": "CVE-2024-7646", "description": "A security issue was discovered in ingress-nginx where an actor with permission to create Ingress objects can bypass annotation validation to inject arbitrary commands and obtain the credentials of the ingress-nginx controller.", "references": [{"id": "reference-1234", "type": "reference", "href": "https://github.com/kubernetes/ingress-nginx/pull/11719"}, {"id": "reference-5678", "type": "reference", "href": "https://groups.google.com/g/kubernetes-security-announce/c/a1__cKjWkfA"}], "mitre_attack_descriptions": [{"id": "mitre_attack_description-1234", "type": "mitre_attack_description", "technique_id": "T1096", "description": "This technique is relevant because it allows for a potential privilege escalation and ability to manipulate system components."}, {"id": "mitre_attack_description-5678", "type": "mitre_attack_description", "technique_id": "T1190", "description": "This technique is relevant because it highlights the importance of proper input validation and sanitization."}]}, {"id": "course_of_action-1234", "type": "course_of_action", "name": "Implement input validation and sanitization", "description": "Implementing input validation and sanitization can help prevent the exploitation of this vulnerability.", "mitre_attack_techniques": [{"id": "mitre_attack_technique-1234", "type": "mitre_attack_technique", "technique_id": "T1190", "description": "This technique helps prevent the exploitation of this vulnerability by validating and sanitizing input."}]}], "relationships": [{"source_id": "vulnerability-1234", "target_id": "course_of_action-1234", "type": "mitigates"}]}, "technical_analysis": {"Introduction": "A security issue was discovered in ingress-nginx where an actor with permission to create Ingress objects can bypass annotation validation to inject arbitrary commands and obtain the credentials of the ingress-nginx controller.", "Impact and Scope": "The vulnerability affects all versions of ingress-nginx and allows for potential privilege escalation and system manipulation.", "Related MITRE ATT&CK Techniques": "T1096, T1190, T1218", "Technical Details": "The vulnerability can be exploited by creating an Ingress object with a malicious annotation, which allows the attacker to inject arbitrary commands and obtain the credentials of the ingress-nginx controller.", "Detection": "Detection techniques include monitoring for unusual network traffic or system behavior, as well as logging and analyzing system calls.", "Mitigation": "Mitigation strategies include implementing input validation and sanitization, as well as restricting access to system components.", "Conclusion": "The vulnerability highlights the importance of proper input validation and sanitization, as well as restriction of access to system components."}, "executive_analysis": {"Overview": "A security issue was discovered in ingress-nginx that could allow for potential privilege escalation and system manipulation.", "Business Impact": "The vulnerability could potentially allow an attacker to gain control of system components and manipulate system behavior, which could impact business operations.", "Technical Impact": "The vulnerability affects all versions of ingress-nginx and could potentially allow an attacker to gain control of system components and manipulate system behavior.", "Mitigation Strategies": "Implementing input validation and sanitization, as well as restricting access to system components, can help prevent the exploitation of this vulnerability.", "Recommendations": "Executives should prioritize the mitigation of this vulnerability and ensure that proper security measures are in place.", "Conclusions": "The vulnerability highlights the importance of proper input validation and sanitization, as well as restriction of access to system components."}}