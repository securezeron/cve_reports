{"id": "CVE-2024-3185", "sourceIdentifier": "cve@rapid7.com", "published": "2024-04-23T09:15:07.023", "lastModified": "2024-04-23T12:52:09.397", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": " A key used in logging.json does not follow the least privilege principle by default and is exposed to local users in the Rapid7 Platform.  This allows an attacker with local access to a machine with the logging.json file to use that key to authenticate to the platform with high privileges.  This was fixed in the Rapid7 platform starting 3 April 2024 via the introduction of a restricted role and the removal of automatic API key generation on installation of an agent."}, {"lang": "es", "value": "Una clave utilizada en logging.json no sigue el principio de privilegio m\u00ednimo de forma predeterminada y est\u00e1 expuesta a los usuarios locales en la plataforma Rapid7. Esto permite que un atacante con acceso local a una m\u00e1quina con el archivo logging.json use esa clave para autenticarse en la plataforma con altos privilegios. Esto se solucion\u00f3 en la plataforma Rapid7 a partir del 3 de abril de 2024 mediante la introducci\u00f3n de una funci\u00f3n restringida y la eliminaci\u00f3n de la generaci\u00f3n autom\u00e1tica de claves API al instalar un agente."}], "metrics": {"cvssMetricV31": [{"source": "cve@rapid7.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 5.5}]}, "weaknesses": [{"source": "cve@rapid7.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1284"}]}], "references": [{"url": "https://docs.rapid7.com/insightidr/configure-the-insight-agent-to-send-logs/", "source": "cve@rapid7.com"}], "techniques": [{"techniqueID": "TA0001", "comment": "This CVE allows an attacker with local access to exploit the system, which is a classic example of 'Local Privilege Escalation' (LPE) as per TA0001. An attacker can utilize this vulnerability to escalate their privileges on the system and eventually gain administrative access."}, {"techniqueID": "TA0008", "comment": "The vulnerability's high impact on integrity and availability suggests that an attacker could utilize this as part of 'Defense Evasion' (TA0008) tactics to gain initial access to the system."}, {"techniqueID": "T1190", "comment": "The attacker could use this vulnerability as part of 'Exploitation of Remote Services' (T1190) to gain initial access to the system, as the vulnerability allows for remote code execution."}], "stix_bundle": {"objects": {"vulnerability": {"id": "urn:vulnerability:CVE-2024-3185", "description": "A key used in logging.json does not follow the least privilege principle by default and is exposed to local users in the Rapid7 Platform.  This allows an attacker with local access to a machine with the logging.json file to use that key to authenticate to the platform with high privileges.", "schema_version": "2.1", "created": "2024-04-23T09:15:07.023", "modified": "2024-04-23T12:52:09.397", "labels": ["vulnerability", "cve"], "objects": []}, "attack_pattern": {"id": "urn:attack-pattern:TA0008", "name": "Defense Evasion", "description": "An attack pattern where an attacker hides their attack traces to avoid detection.", "schema_version": "2.1", "created": "2024-04-23T09:15:07.023", "modified": "2024-04-23T12:52:09.397", "labels": ["attack-pattern", "defense-evasion"]}, "intrusion_set": {"id": "urn:intrusion-set:T1190", "name": "Exploitation of Remote Services", "description": "An intrusion set that exploits remote services to gain initial access to the system.", "schema_version": "2.1", "created": "2024-04-23T09:15:07.023", "modified": "2024-04-23T12:52:09.397", "labels": ["intrusion-set", "exploitation-of-remote-services"]}, "course-of-action": {"id": "urn:course-of-action:COA-2", "name": "Restrict API Key Generation", "description": "Restrict API key generation to prevent unauthorized access.", "schema_version": "2.1", "created": "2024-04-23T09:15:07.023", "modified": "2024-04-23T12:52:09.397", "labels": ["course-of-action", "restrict-api-key-generation"]}}, "relationships": {"vulnerability": {"exploited_by": ["urn:attack-pattern:TA0001", "urn:attack-pattern:TA0008", "urn:intrusion-set:T1190"]}, "attack_pattern": {"exploits": ["urn:vulnerability:CVE-2024-3185"]}, "intrusion_set": {"exploits": ["urn:vulnerability:CVE-2024-3185"]}, "course-of-action": {"mitigates": ["urn:vulnerability:CVE-2024-3185"]}}}, "technical_analysis": {"Introduction": "This CVE allows local users with access to the logging.json file to authenticate to the Rapid7 platform with high privileges, which is a prime example of 'Local Privilege Escalation' (LPE).", "Impact and Scope": "CVSS 3.1: 6.8, Attack Vector: LOCAL, Attack Complexity: LOW, Privileges Required: LOW, User Interaction: REQUIRED", "Related MITRE ATT&CK Techniques": "TA0001, TA0008, T1190", "Technical Details": "The vulnerability lies in the default configuration of the logging.json file, where the key used is not following the least privilege principle, allowing local users to access the platform with high privileges.", "Detection": "Monitor for suspicious authentication attempts to the Rapid7 platform, especially those with elevated privileges.", "Mitigation": "Update the Rapid7 platform to the latest version, restrict API key generation, and monitor authentication attempts.", "Conclusion": "This CVE highlights the importance of following the least privilege principle and applying security best practices to prevent local privilege escalation attacks."}, "executive_analysis": {"Overview": "This CVE poses a moderate risk to organizations that use the Rapid7 platform, as it allows local users to escalate their privileges and access sensitive data.", "Business Impact": "The business impact of this CVE is significant, as it can lead to the exposure of sensitive data and compromise of organizational security.", "Technical Impact": "The technical impact of this CVE is moderate, as it allows local users to gain elevated privileges and access sensitive data.", "Mitigation Strategies": "Update the Rapid7 platform to the latest version, restrict API key generation, and monitor authentication attempts.", "Recommendations": "C-level executives should prioritize the immediate patching and vulnerability assessment of their Rapid7 platform to minimize the risk of exploitation.", "Conclusions": "In conclusion, this CVE highlights the importance of maintaining a secure and up-to-date Rapid7 platform, adhering to security best practices, and monitoring for suspicious activity."}}