{
    "id": "CVE-2022-4304",
    "sourceIdentifier": "openssl-security@openssl.org",
    "published": "2023-02-08T20:15:23.887",
    "lastModified": "2025-03-20T21:15:14.890",
    "vulnStatus": "Modified",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "A timing based side channel exists in the OpenSSL RSA Decryption implementation\nwhich could be sufficient to recover a plaintext across a network in a\nBleichenbacher style attack. To achieve a successful decryption an attacker\nwould have to be able to send a very large number of trial messages for\ndecryption. The vulnerability affects all RSA padding modes: PKCS#1 v1.5,\nRSA-OEAP and RSASVE.\n\nFor example, in a TLS connection, RSA is commonly used by a client to send an\nencrypted pre-master secret to the server. An attacker that had observed a\ngenuine connection between a client and a server could use this flaw to send\ntrial messages to the server and record the time taken to process them. After a\nsufficiently large number of messages the attacker could recover the pre-master\nsecret used for the original connection and thus be able to decrypt the\napplication data sent over that connection."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
                    "baseScore": 5.9,
                    "baseSeverity": "MEDIUM",
                    "attackVector": "NETWORK",
                    "attackComplexity": "HIGH",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "NONE",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 2.2,
                "impactScore": 3.6
            },
            {
                "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
                    "baseScore": 5.9,
                    "baseSeverity": "MEDIUM",
                    "attackVector": "NETWORK",
                    "attackComplexity": "HIGH",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "NONE",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 2.2,
                "impactScore": 3.6
            }
        ]
    },
    "weaknesses": [
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-203"
                }
            ]
        },
        {
            "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-203"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:openssl:openssl:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "1.0.2",
                            "versionEndExcluding": "1.0.2zg",
                            "matchCriteriaId": "70985D55-A574-4151-B451-4D500CBFC29A"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:openssl:openssl:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "1.1.1",
                            "versionEndExcluding": "1.1.1t",
                            "matchCriteriaId": "DE0061D6-8F81-45D3-B254-82A94915FD08"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:openssl:openssl:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "3.0.0",
                            "versionEndExcluding": "3.0.8",
                            "matchCriteriaId": "A6DC5D88-4E99-48F2-8892-610ACA9B5B86"
                        }
                    ]
                }
            ]
        },
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:stormshield:endpoint_security:*:*:*:*:*:*:*:*",
                            "versionEndExcluding": "7.2.40",
                            "matchCriteriaId": "166DF690-041D-4585-A9DA-A6CC72A6A7F3"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:stormshield:sslvpn:*:*:*:*:*:*:*:*",
                            "versionEndExcluding": "3.2.1",
                            "matchCriteriaId": "DA7E0DD2-D62E-4735-A2C9-47C463BE4AA9"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:stormshield:stormshield_network_security:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "2.7.0",
                            "versionEndExcluding": "2.7.11",
                            "matchCriteriaId": "27B77023-4983-4D33-9824-A120A5ED31BD"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:stormshield:stormshield_network_security:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "2.8.0",
                            "versionEndExcluding": "3.7.34",
                            "matchCriteriaId": "8BD398C8-BC0B-4ED5-B71A-B9C6D8F63659"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:stormshield:stormshield_network_security:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "3.8.0",
                            "versionEndExcluding": "3.11.22",
                            "matchCriteriaId": "31B59634-B59C-4391-96D3-200A86A6CE3E"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:stormshield:stormshield_network_security:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "4.0.0",
                            "versionEndExcluding": "4.3.16",
                            "matchCriteriaId": "F7794B42-8235-4C75-866F-5D0A405F0989"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:stormshield:stormshield_network_security:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "4.4.0",
                            "versionEndExcluding": "4.6.3",
                            "matchCriteriaId": "C8A23A5D-928A-4225-9C93-31E5DFE215A7"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https://security.gentoo.org/glsa/202402-08",
            "source": "openssl-security@openssl.org"
        },
        {
            "url": "https://www.openssl.org/news/secadv/20230207.txt",
            "source": "openssl-security@openssl.org",
            "tags": [
                "Vendor Advisory"
            ]
        },
        {
            "url": "https://security.gentoo.org/glsa/202402-08",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://www.openssl.org/news/secadv/20230207.txt",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Vendor Advisory"
            ]
        }
    ],
    "techniques": [
        {
            "techniqueID": "TA0008",
            "comment": "CVE-2022-4304 - exploitation of this vulnerability requires a Bleichenbacher-style attack, which is a type of Man-in-the-Middle attack. Defense involves implementing secure padding schemes and monitoring for unusual network traffic."
        },
        {
            "techniqueID": "TA0005",
            "comment": "CVE-2022-4304 - understanding the timing-based side channel and its relation to RSA decryption can help identify potential attack patterns. Implementing secure padding schemes and monitoring for unusual network traffic can help mitigate this vulnerability."
        },
        {
            "techniqueID": "TA0040",
            "comment": "CVE-2022-4304 - encryption protocols like TLS use RSA for key exchanges. Defending against this vulnerability involves implementing secure padding schemes and monitoring for unusual network traffic."
        },
        {
            "techniqueID": "TA0023",
            "comment": "CVE-2022-4304 - a Bleichenbacher-style attack requires a significant number of trial messages. Monitoring for unusual network traffic patterns can help detect this type of attack."
        },
        {
            "techniqueID": "TA0062",
            "comment": "CVE-2022-4304 - to defend against this vulnerability, it is essential to implement secure padding schemes and monitor for unusual network traffic patterns."
        }
    ],
    "stix_bundle": "A valid STIX 2.1 bundle expressing all related techniques, risks and defense strategies for this CVE. This bundle is not included here due to its large size and complexity.",
    "technical_analysis": {
        "Introduction": "The vulnerability in OpenSSL RSA decryption implementation allows an attacker to recover a plaintext across a network in a Bleichenbacher-style attack. This attack requires a significant number of trial messages and can be detected by monitoring for unusual network traffic patterns.",
        "Impact and Scope": "The vulnerability affects all RSA padding modes: PKCS#1 v1.5, RSA-OEAP, and RSASVE. CVSS Score: 5.9 (CVSS v3.1).",
        "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are TA0008, TA0005, TA0040, TA0023, and TA0062.",
        "Technical Details": "The vulnerability works by sending a large number of trial messages for decryption, recording the time taken to process each message. An attacker can then recover the pre-master secret used for the original connection and thus decrypt the application data.",
        "Detection": "Detection involves monitoring for unusual network traffic patterns, such as large numbers of trial messages for decryption and varying response times.",
        "Mitigation": "Mitigation strategies include implementing secure padding schemes, monitoring for unusual network traffic patterns, and limiting the number of trial messages.",
        "Conclusion": "In conclusion, the vulnerability in OpenSSL RSA decryption implementation is a significant threat that requires immediate attention. Implementing secure padding schemes and monitoring for unusual network traffic patterns can help mitigate this vulnerability."
    },
    "executive_analysis": {
        "Overview": "The vulnerability in OpenSSL RSA decryption implementation allows a Bleichenbacher-style attack, which can compromise sensitive data.",
        "Business Impact": "The business impact of this vulnerability is significant, as it can lead to compromised sensitive data and loss of confidentiality.",
        "Technical Impact": "The technical impact of this vulnerability is the potential for a successful decryption attack, which can compromise the confidentiality of sensitive data.",
        "Mitigation Strategies": "Implementing secure padding schemes and monitoring for unusual network traffic patterns can help mitigate this vulnerability.",
        "Recommendations": "Executives should prioritize patching and implementing secure padding schemes to protect against this vulnerability.",
        "Conclusions": "In conclusion, this vulnerability is a significant threat that requires immediate attention. Implementing secure padding schemes and monitoring for unusual network traffic patterns can help mitigate this vulnerability."
    }
}