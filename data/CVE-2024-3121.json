{"id": "CVE-2024-3121", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-24T00:15:09.680", "lastModified": "2024-06-24T12:57:36.513", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A remote code execution vulnerability exists in the create_conda_env function of the parisneo/lollms repository, version 5.9.0. The vulnerability arises from the use of shell=True in the subprocess.Popen function, which allows an attacker to inject arbitrary commands by manipulating the env_name and python_version parameters. This issue could lead to a serious security breach as demonstrated by the ability to execute the 'whoami' command among potentially other harmful commands."}, {"lang": "es", "value": "Existe una vulnerabilidad de ejecuci\u00f3n remota de c\u00f3digo en la funci\u00f3n create_conda_env del repositorio parisneo/lollms, versi\u00f3n 5.9.0. La vulnerabilidad surge del uso de shell=True en la funci\u00f3n subprocess.Popen, que permite a un atacante inyectar comandos arbitrarios manipulando los par\u00e1metros env_name y python_version. Este problema podr\u00eda provocar una grave violaci\u00f3n de la seguridad, como lo demuestra la capacidad de ejecutar el comando \"whoami\" entre otros comandos potencialmente da\u00f1inos."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "PHYSICAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://huntr.com/bounties/db57c343-9b80-4c1c-9ab0-9eef92c9b27b", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1204.001", "comment": "CVE-2024-3121 - The use of shell=True in the subprocess.Popen function allows remote attackers to inject arbitrary commands, which can lead to remote code execution. This technique is relevant as it highlights the importance of proper configuration of subprocess functions in Python scripts."}, {"techniqueID": "T1505.003", "comment": "CVE-2024-3121 - The vulnerability in the create_conda_env function allows attackers to manipulate the env_name and python_version parameters. This technique is relevant as it highlights the importance of input validation and sanitization in Python scripts."}, {"techniqueID": "T1059.001", "comment": "CVE-2024-3121 - The remote code execution vulnerability allows attackers to execute arbitrary commands on the system. This technique is relevant as it highlights the importance of secure coding practices and limiting system privileges."}], "stix_bundle": {"$schema": "https://stix.lang/v2.1/stix-core", "stix_bundle": {"ID": "bundle-1", "modules": [{"indicator": {"id": "indicator--a67b63c9-3c71-43ea-9f3f-85d3c09f6efc", "description": "CVE-2024-3121", "modified": "2024-02-14T14:15:20.000Z", "created": "2024-02-14T14:15:20.000Z", "labels": ["cve", "vulnerability"], "objects": [{"id": "vulnerability--a67b63c9-3c71-43ea-9f3f-85d3c09f6efc", "description": "A remote code execution vulnerability exists in the create_conda_env function of the parisneo/lollms repository, version 5.9.0.", "modified": "2024-02-14T14:15:20.000Z", "created": "2024-02-14T14:15:20.000Z", "severity": "MEDIUM", "products": ["parisneo/lollms"], "references": [{"id": "reference--a67b63c9-3c71-43ea-9f3f-85d3c09f6efc", "source_name": "huntr.dev", "url": "https://huntr.com/bounties/db57c343-9b80-4c1c-9ab0-9eef92c9b27b", "description": "A remote code execution vulnerability exists in the create_conda_env function of the parisneo/lollms repository, version 5.9.0."}]}]}}, {"course_of_action": {"id": "course-of-action--a67b63c9-3c71-43ea-9f3f-85d3c09f6efc", "description": "Update the create_conda_env function to use parameterized inputs and validate user input.", "modified": "2024-02-14T14:15:20.000Z", "created": "2024-02-14T14:15:20.000Z", "techniques": ["T1204.001", "T1505.003"], "impact": "MITIGATES REMOTE CODE EXECUTION", "notes": ["This course of action mitigates the remote code execution vulnerability by validating user input and using parameterized inputs."]}}, {"intrusion_set": {"id": "intrusion-set--a67b63c9-3c71-43ea-9f3f-85d3c09f6efc", "description": "A group of threat actors exploiting the CVE-2024-3121 vulnerability to gain remote code execution.", "modified": "2024-02-14T14:15:20.000Z", "created": "2024-02-14T14:15:20.000Z", "labels": ["threat-actor"], "objects": [{"id": "attack_pattern--a67b63c9-3c71-43ea-9f3f-85d3c09f6efc", "description": "Exploit the create_conda_env function to gain remote code execution.", "modified": "2024-02-14T14:15:20.000Z", "created": "2024-02-14T14:15:20.000Z", "techniques": ["T1204.001", "T1505.003"]}]}}]}}, "technical_analysis": {"Introduction": "The CVE-2024-3121 vulnerability is a remote code execution vulnerability in the create_conda_env function of the parisneo/lollms repository, version 5.9.0.", "Impact and Scope": "The vulnerability has a CVSS score of 6.8, with a medium severity rating. It allows attackers to execute arbitrary commands on the system, which can lead to significant business impact.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1204.001, T1505.003, and T1059.001.", "Technical Details": "The vulnerability arises from the use of shell=True in the subprocess.Popen function, which allows attackers to inject arbitrary commands by manipulating the env_name and python_version parameters.", "Detection": "The vulnerability can be detected by monitoring for suspicious subprocess calls and validating user input.", "Mitigation": "The vulnerability can be mitigated by validating user input and using parameterized inputs, and by updating the create_conda_env function to use the secure coding practices.", "Conclusion": "The CVE-2024-3121 vulnerability is a serious remote code execution vulnerability that can have significant business and technical impact. It is recommended to update the create_conda_env function and implement the mitigation strategies described in this report."}, "executive_analysis": {"Overview": "The CVE-2024-3121 vulnerability is a remote code execution vulnerability in the create_conda_env function of the parisneo/lollms repository, version 5.9.0.", "Business Impact": "The vulnerability can lead to significant business impact, including loss of sensitive data and system downtime.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary commands on the system, which can lead to technical impact, including system compromise and data breaches.", "Mitigation Strategies": "Update the create_conda_env function to use parameterized inputs and validate user input, and implement secure coding practices.", "Recommendations": "Recommendations include updating the create_conda_env function, implementing secure coding practices, and conducting regular vulnerability scanning and penetration testing.", "Conclusions": "The CVE-2024-3121 vulnerability is a serious remote code execution vulnerability that requires immediate attention and mitigation."}}