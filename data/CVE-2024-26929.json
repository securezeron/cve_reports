{"id": "CVE-2024-26929", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-01T06:15:07.380", "lastModified": "2024-08-08T16:35:06.543", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: qla2xxx: Fix double free of fcport\n\nThe server was crashing after LOGO because fcport was getting freed twice.\n\n -----------[ cut here ]-----------\n kernel BUG at mm/slub.c:371!\n invalid opcode: 0000 1 SMP PTI\n CPU: 35 PID: 4610 Comm: bash Kdump: loaded Tainted: G OE --------- - - 4.18.0-425.3.1.el8.x86_64 #1\n Hardware name: HPE ProLiant DL360 Gen10/ProLiant DL360 Gen10, BIOS U32 09/03/2021\n RIP: 0010:set_freepointer.part.57+0x0/0x10\n RSP: 0018:ffffb07107027d90 EFLAGS: 00010246\n RAX: ffff9cb7e3150000 RBX: ffff9cb7e332b9c0 RCX: ffff9cb7e3150400\n RDX: 0000000000001f37 RSI: 0000000000000000 RDI: ffff9cb7c0005500\n RBP: fffff693448c5400 R08: 0000000080000000 R09: 0000000000000009\n R10: 0000000000000000 R11: 0000000000132af0 R12: ffff9cb7c0005500\n R13: ffff9cb7e3150000 R14: ffffffffc06990e0 R15: ffff9cb7ea85ea58\n FS: 00007ff6b79c2740(0000) GS:ffff9cb8f7ec0000(0000) knlGS:0000000000000000\n CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n CR2: 000055b426b7d700 CR3: 0000000169c18002 CR4: 00000000007706e0\n DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\n DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\n PKRU: 55555554\n Call Trace:\n kfree+0x238/0x250\n qla2x00_els_dcmd_sp_free+0x20/0x230 [qla2xxx]\n ? qla24xx_els_dcmd_iocb+0x607/0x690 [qla2xxx]\n qla2x00_issue_logo+0x28c/0x2a0 [qla2xxx]\n ? qla2x00_issue_logo+0x28c/0x2a0 [qla2xxx]\n ? kernfs_fop_write+0x11e/0x1a0\n\nRemove one of the free calls and add check for valid fcport. Also use\nfunction qla2x00_free_fcport() instead of kfree()."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: scsi: qla2xxx: Correcci\u00f3n doble liberaci\u00f3n de fcport El servidor fallaba despu\u00e9s de LOGO porque fcport se liberaba dos veces. -----------[ cortar aqu\u00ed ]----------- \u00a1ERROR del kernel en mm/slub.c:371! c\u00f3digo de operaci\u00f3n no v\u00e1lido: 0000 1 SMP PTI CPU: 35 PID: 4610 Comm: bash Kdump: cargado Contaminado: G OE --------- - - 4.18.0-425.3.1.el8.x86_64 #1 Nombre de hardware: HPE ProLiant DL360 Gen10/ProLiant DL360 Gen10, BIOS U32 03/09/2021 RIP: 0010:set_freepointer.part.57+0x0/0x10 RSP: 0018:ffffb07107027d90 EFLAGS: 00010246 RAX: RBX: ffff9cb7e332b9c0 RCX: ffff9cb7e3150400 RDX: 0000000000001f37 RSI : 0000000000000000 RDI: ffff9cb7c0005500 RBP: fffff693448c5400 R08: 0000000080000000 R09: 00000000000000009 R10: 0000000000000000 R11: 0000000132af0 R12: ffff9cb7c0005500 R13: ffff9cb7e3150000 R14: ffffffffc06990e0 R15: ffff9cb7ea85ea58 FS: 00007ff6b79c2740(0000) GS:ffff9cb8f7ec0000(000) 0) knlGS:0000000000000000 CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 000055b426b7d700 CR3: 0000000169c18002 CR4: 00000000007706e0 DR0: 0000000000000000 DR1: 00000000000 DR2: 0000000000000000 DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400 PKRU: 55555554 Seguimiento de llamadas: kfree+0x238/0x250 _els_dcmd_sp_free+0x20 /0x230 [qla2xxx] ? qla24xx_els_dcmd_iocb+0x607/0x690 [qla2xxx] qla2x00_issue_logo+0x28c/0x2a0 [qla2xxx] ? qla2x00_issue_logo+0x28c/0x2a0 [qla2xxx] ? kernfs_fop_write+0x11e/0x1a0 Elimine una de las llamadas gratuitas y agregue una verificaci\u00f3n de fcport v\u00e1lido. Utilice tambi\u00e9n la funci\u00f3n qla2x00_free_fcport() en lugar de kfree()."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.5, "impactScore": 5.2}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-415"}]}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-415"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.15.154", "matchCriteriaId": "131A208A-4C74-498A-BFFB-240B45FE2C0C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.16", "versionEndExcluding": "6.1.84", "matchCriteriaId": "834D9BD5-42A6-4D74-979E-4D6D93F630FD"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2", "versionEndExcluding": "6.6.24", "matchCriteriaId": "8018C1D0-0A5F-48D0-BC72-A2B33FDDA693"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.7.12", "matchCriteriaId": "6BE9771A-BAFD-4624-95F9-58D536540C53"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartExcluding": "6.8", "versionEndExcluding": "6.8.3", "matchCriteriaId": "1649B701-9DF9-4E5D-AA4B-6A7071BF05D6"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.9:rc1:*:*:*:*:*:*", "matchCriteriaId": "22BEDD49-2C6D-402D-9DBF-6646F6ECD10B"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/282877633b25d67021a34169c5b5519b1d4ef65e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/82f522ae0d97119a43da53e0f729275691b9c525", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/846fb9f112f618ec6ae181d8dae7961652574774", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/9b43d2884b54d415caab48878b526dfe2ae9921b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/b03e626bd6d3f0684f56ee1890d70fc9ca991c04", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/f85af9f1aa5e2f53694a6cbe72010f754b5ff862", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-26929 - Double-free vulnerability in kernel, attackers can manipulate the system and cause a denial-of-service."}, {"techniqueID": "T1190", "comment": "CVE-2024-26929 - Valid account exploitation, attackers can use this vulnerability to access a vulnerable Linux system."}, {"techniqueID": "T1027", "comment": "CVE-2024-26929 - Data from other systems might be sent to attacker-controlled systems, attackers can use this vulnerability to exfiltrate data."}, {"techniqueID": "T1485", "comment": "CVE-2024-26929 - Impersonation, attackers can impersonate kernel components to execute malicious code."}, {"techniqueID": "T1196", "comment": "CVE-2024-26929 - Files may be deleted or modified, attackers can use this vulnerability to delete or modify critical system files."}, {"techniqueID": "T1225", "comment": "CVE-2024-26929 - Injecting a shellcode into a running system, attackers can use this vulnerability to inject a malicious payload."}, {"techniqueID": "T1482", "comment": "CVE-2024-26929 - Commonly targeted software installed on the system may be updated or modified, attackers can use this vulnerability to install malware."}, {"techniqueID": "T1070", "comment": "CVE-2024-26929 - Accessing system logs, attackers can use this vulnerability to access system logs."}, {"techniqueID": "T1490", "comment": "CVE-2024-26929 - Service exploitation, attackers can use this vulnerability to exploit a vulnerable service on the system."}, {"techniqueID": "T1222", "comment": "CVE-2024-26929 - Root persistence, attackers can use this vulnerability to persist on the system."}, {"techniqueID": "T1046", "comment": "CVE-2024-26929 - Scheduling, attackers can use this vulnerability to schedule malicious activities."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "https://example.com/cve-2024-26929", "created_by_ref": "https://example.com/created_by", "created": "2022-05-02T14:30:00.000Z", "modified": "2022-05-02T14:30:00.000Z", "names": [{"value": "CVE-2024-26929"}], "description": "Double-free vulnerability in the Linux kernel's SCSI driver.", "objects": [{"type": "vulnerability", "id": "https://example.com/cve-2024-26929", "created_by_ref": "https://example.com/created_by", "created": "2022-05-02T14:30:00.000Z", "modified": "2022-05-02T14:30:00.000Z", "name": "CVE-2024-26929", "description": "Double-free vulnerability in the Linux kernel's SCSI driver.", "cve": [{"id": "CVE-2024-26929"}], "affected_components": [{"type": "software", "id": "https://example.com/linux_kernel"}], "mitigation": [{"type": "mitigation", "id": "https://example.com/update_linux_kernel"}], "notes": [{"content": "Double-free vulnerability in the Linux kernel's SCSI driver. Update the Linux kernel to the latest version to mitigate this vulnerability."}]}, {"type": " technique", "id": "https://example.com/T1210", "created_by_ref": "https://example.com/created_by", "created": "2022-05-02T14:30:00.000Z", "modified": "2022-05-02T14:30:00.000Z", "name": "T1210", "description": "Double-free vulnerability in kernel, attackers can manipulate the system and cause a denial-of-service.", "technique_category": "exploitation", "exploited_product": [{"type": "software", "id": "https://example.com/linux_kernel"}]}], " relationships": [{"type": "has_vulnerability", "id": "https://example.com/cve-2024-26929/has_vulnerability/T1210", "to_ref": "https://example.com/T1210"}]}}, "technical_analysis": {"Introduction": "The Linux kernel's SCSI driver has been found to contain a double-free vulnerability, which allows attackers to manipulate the system and cause a denial-of-service.", "Impact and Scope": "The vulnerability affects Linux kernel versions prior to 5.15.154, and has a CVSS score of 7.8 with a high severity rating.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1210, T1190, T1027, T1485, T1196, T1225, T1482, T1070, T1490, and T1222.", "Technical Details": "The vulnerability occurs when the scsi driver frees a pointer that has already been freed, leading to a double-free scenario. This can cause the system to crash or become unstable.", "Detection": "Detection of this vulnerability is challenging, as it requires monitoring for unusual system behavior and kernel crashes.", "Mitigation": "The vulnerability can be mitigated by updating the Linux kernel to the latest version, which includes a patch for this issue.", "Conclusion": "In conclusion, the Linux kernel's SCSI driver has been found to contain a double-free vulnerability, which can be exploited by attackers to manipulate the system and cause a denial-of-service. It is recommended that affected systems be updated to the latest version of the Linux kernel to mitigate this vulnerability."}, "executive_analysis": {"Overview": "This vulnerability affects Linux kernel versions prior to 5.15.154, and has a CVSS score of 7.8 with a high severity rating.", "Business Impact": "This vulnerability can result in a denial-of-service, which can affect business operations and impact customer trust.", "Technical Impact": "This vulnerability can also result in the compromise of sensitive data, which can lead to a loss of intellectual property and competitive advantage.", "Mitigation Strategies": "The recommended mitigation is to update the Linux kernel to the latest version, which includes a patch for this issue.", "Recommendations": "It is recommended that systems be updated to the latest version of the Linux kernel as soon as possible to mitigate this vulnerability.", "Conclusions": "In conclusion, this vulnerability has significant business and technical impact, and it is recommended that systems be updated to the latest version of the Linux kernel to mitigate this vulnerability."}}