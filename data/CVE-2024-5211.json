{"id": "CVE-2024-5211", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-12T12:15:10.520", "lastModified": "2024-06-13T18:36:09.010", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A path traversal vulnerability in mintplex-labs/anything-llm allowed a manager to bypass the `normalizePath()` function, intended to defend against path traversal attacks. This vulnerability enables the manager to read, delete, or overwrite the 'anythingllm.db' database file and other files stored in the 'storage' directory, such as internal communication keys and .env secrets. Exploitation of this vulnerability could lead to application compromise, denial of service (DoS) attacks, and unauthorized admin account takeover. The issue stems from improper validation of user-supplied input in the process of setting a custom logo for the app, which can be manipulated to achieve arbitrary file read, deletion, or overwrite, and to execute a DoS attack by deleting critical files required for the application's operation."}, {"lang": "es", "value": "Una vulnerabilidad de path traversal en mintplex-labs/anything-llm permiti\u00f3 a un administrador omitir la funci\u00f3n `normalizePath()`, destinada a defenderse contra ataques de path traversal. Esta vulnerabilidad permite al administrador leer, eliminar o sobrescribir el archivo de base de datos 'anythingllm.db' y otros archivos almacenados en el directorio de 'almacenamiento', como claves de comunicaci\u00f3n interna y secretos .env. La explotaci\u00f3n de esta vulnerabilidad podr\u00eda comprometer la aplicaci\u00f3n, ataques de denegaci\u00f3n de servicio (DoS) y apropiaci\u00f3n no autorizada de cuentas de administrador. El problema surge de la validaci\u00f3n inadecuada de la entrada proporcionada por el usuario en el proceso de configuraci\u00f3n de un logotipo personalizado para la aplicaci\u00f3n, que puede manipularse para lograr lectura, eliminaci\u00f3n o sobrescritura arbitraria de archivos, y para ejecutar un ataque DoS eliminando archivos cr\u00edticos necesarios para el funcionamiento de la aplicaci\u00f3n."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.3, "impactScore": 6.0}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-29"}]}], "references": [{"url": "https://github.com/mintplex-labs/anything-llm/commit/e208074ef4c240fe03e4147ab097ec3b52b97619", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/38f282cb-7226-435e-9832-2d4a102dad4b", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-5211 - Manipulation of Code to Include Execute-Able File: An attacker can manipulate the user-supplied input in the process of setting a custom logo for the app to include an execute-able file, which can lead to arbitrary file read, deletion, or overwrite."}, {"techniqueID": "T1027", "comment": "CVE-2024-5211 - Obfuscated Files or Information: The vulnerability enables the attacker to bypass the `normalizePath()` function, allowing for path traversal attacks and compromising the application's integrity."}, {"techniqueID": "T1102", "comment": "CVE-2024-5211 - Binary Data Files: The vulnerability affects the 'anythingllm.db' database file and other files stored in the 'storage' directory, making them vulnerable to deletion or overwrite."}, {"techniqueID": "T1574", "comment": "CVE-2024-5211 - OS Credential Dumping: The vulnerability allows the attacker to exploit the path traversal vulnerability to dump the OS credentials stored in the application."}, {"techniqueID": "T1190", "comment": "CVE-2024-5211 - Exposte: The vulnerability can be exploited to perform a DoS attack by deleting critical files required for the application's operation."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "https://example.com/cve-2024-5211.stix_bundle", "created_by_ref": "https://example.com/creators", "modified": "2024-06-13T18:36:09.010", "name": "CVE-2024-5211 STIX Bundle", "description": "STIX Bundle for CVE-2024-5211", "objects": [{"type": "vulnerability", "id": "https://example.com/cve-2024-5211", "created_by_ref": "https://example.com/creators", "modified": "2024-06-13T18:36:09.010", "name": "CVE-2024-5211", "description": "Path Traversal Vulnerability in mintplex-labs/anything-llm", "severity": "High", "cwe": "CWE-29", "cvssV3": {"vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "references": [{"type": "reference", "id": "https://github.com/mintplex-labs/anything-llm/commit/e208074ef4c240fe03e4147ab097ec3b52b97619"}, {"type": "reference", "id": "https://huntr.com/bounties/38f282cb-7226-435e-9832-2d4a102dad4b"}], "related_ids": [{"type": "attack-pattern", "id": "https://example.com/T1210", "relationship": "exploits"}, {"type": "attack-pattern", "id": "https://example.com/T1027", "relationship": "exploits"}, {"type": "attack-pattern", "id": "https://example.com/T1102", "relationship": "exploits"}, {"type": "attack-pattern", "id": "https://example.com/T1574", "relationship": "exploits"}, {"type": "attack-pattern", "id": "https://example.com/T1190", "relationship": "exploits"}]}, {"type": "attack-pattern", "id": "https://example.com/T1210", "created_by_ref": "https://example.com/creators", "modified": "2024-06-13T18:36:09.010", "name": "Manipulation of Code to Include Execute-Able File", "description": "Manipulate the user-supplied input in the process of setting a custom logo for the app to include an execute-able file", " kill_chain_phases": [{"type": "kill-chain-phase", "id": "https://example.com/discovery", "relationship": "exploits"}]}, {"type": "attack-pattern", "id": "https://example.com/T1027", "created_by_ref": "https://example.com/creators", "modified": "2024-06-13T18:36:09.010", "name": "Obfuscated Files or Information", "description": "Bypass the `normalizePath()` function to perform path traversal attacks", "kill_chain_phases": [{"type": "kill-chain-phase", "id": "https://example.com/discovery", "relationship": "exploits"}]}, {"type": "attack-pattern", "id": "https://example.com/T1102", "created_by_ref": "https://example.com/creators", "modified": "2024-06-13T18:36:09.010", "name": "Binary Data Files", "description": "Affect the 'anythingllm.db' database file and other files stored in the 'storage' directory", "kill_chain_phases": [{"type": "kill-chain-phase", "id": "https://example.com/discovery", "relationship": "exploits"}]}, {"type": "attack-pattern", "id": "https://example.com/T1574", "created_by_ref": "https://example.com/creators", "modified": "2024-06-13T18:36:09.010", "name": "OS Credential Dumping", "description": "Exploit the path traversal vulnerability to dump OS credentials", "kill_chain_phases": [{"type": "kill-chain-phase", "id": "https://example.com/discovery", "relationship": "exploits"}]}, {"type": "attack-pattern", "id": "https://example.com/T1190", "created_by_ref": "https://example.com/creators", "modified": "2024-06-13T18:36:09.010", "name": "Exposte", "description": "Exploit the path traversal vulnerability to perform a DoS attack", "kill_chain_phases": [{"type": "kill-chain-phase", "id": "https://example.com/discovery", "relationship": "exploits"}]}, {"type": "kill-chain-phase", "id": "https://example.com/discovery", "name": "Discovery", "description": "Initial reconnaissance and information gathering"}]}}, "technical_analysis": {"Introduction": "The vulnerability CVE-2024-5211 is a path traversal vulnerability in mintplex-labs/anything-llm that allows an attacker to read, delete, or overwrite arbitrary files on the system.", "Impact and Scope": "The vulnerability has a CVSS score of 9.1 and an attack vector of NETWORK. It can be exploited by an attacker with HIGH privileges.", "Related MITRE ATT&CK Techniques": "T1210, T1027, T1102, T1574, T1190", "Technical Details": "The vulnerability occurs when the `normalizePath()` function is bypassed, allowing for path traversal attacks.", "Detection": "Detection methods include monitoring for unusual file access patterns and inspecting system logs for suspicious activity.", "Mitigation": "Mitigation strategies include disabling directory traversal, implementing input validation, and restricting access to sensitive files.", "Conclusion": "The vulnerability CVE-2024-5211 is a critical threat to system security and should be addressed immediately."}, "executive_analysis": {"Overview": "The vulnerability CVE-2024-5211 is a critical security threat that poses a significant risk to system security.", "Business Impact": "The vulnerability could result in the exposure of sensitive data, financial loss, and reputational damage.", "Technical Impact": "The vulnerability could allow an attacker to gain unauthorized access to sensitive files and data.", "Mitigation Strategies": "Implementing input validation, disabling directory traversal, and restricting access to sensitive files can help mitigate the risk.", "Recommendations": "Improve security practices, conduct regular vulnerability assessments, and implement disaster recovery plans.", "Conclusions": "The vulnerability CVE-2024-5211 is a critical security threat that requires immediate attention and action."}}