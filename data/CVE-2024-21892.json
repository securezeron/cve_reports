{"id": "CVE-2024-21892", "sourceIdentifier": "support@hackerone.com", "published": "2024-02-20T02:15:50.567", "lastModified": "2024-05-01T18:15:13.610", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "On Linux, Node.js ignores certain environment variables if those may have been set by an unprivileged user while the process is running with elevated privileges with the only exception of CAP_NET_BIND_SERVICE.\nDue to a bug in the implementation of this exception, Node.js incorrectly applies this exception even when certain other capabilities have been set.\nThis allows unprivileged users to inject code that inherits the process's elevated privileges."}, {"lang": "es", "value": "En Linux, Node.js ignora ciertas variables de entorno si pueden haber sido configuradas por un usuario sin privilegios mientras el proceso se ejecuta con privilegios elevados con la \u00fanica excepci\u00f3n de CAP_NET_BIND_SERVICE. Debido a un error en la implementaci\u00f3n de esta excepci\u00f3n, Node.js aplica incorrectamente esta excepci\u00f3n incluso cuando se han configurado otras capacidades. Esto permite a los usuarios sin privilegios inyectar c\u00f3digo que hereda los privilegios elevados del proceso."}], "metrics": {"cvssMetricV30": [{"source": "support@hackerone.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.1, "impactScore": 5.8}]}, "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/03/11/1", "source": "support@hackerone.com"}, {"url": "https://hackerone.com/reports/2237545", "source": "support@hackerone.com"}, {"url": "https://security.netapp.com/advisory/ntap-20240322-0003/", "source": "support@hackerone.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-21892 - This vulnerability allows an unprivileged user to inject code that inherits elevated privileges, which is a common tactic used by attackers. Defending against this requires strict access control and monitoring of environment variables."}, {"techniqueID": "T1078", "comment": "CVE-2024-21892 - This vulnerability can be exploited to evade detection by hiding malicious code in environment variables, which is a common tactic used by attackers. Defending against this requires advanced threat detection and anomaly-based monitoring."}, {"techniqueID": "T1210", "comment": "CVE-2024-21892 - This vulnerability allows an attacker to set environment variables that can be used to control the behavior of a process, which is a common tactic used by attackers. Defending against this requires strict access control and monitoring of environment variables."}], "stix_bundle": {"$schema": "http://timetraveler.iso/strict", "type": "bundle", "spec_version": "2.1", "id": "cve-2024-21892.stix", "metadata": {"created_by_ref": "https://example.com/defenses", "created": "2022-01-01T12:00:00.000Z", "modified": "2022-01-02T14:30:00.000Z"}, "objects": [{"id": "cve-2024-21892", "type": "vulnerability", "name": "CVE-2024-21892: Node.js Environment Variable Vulnerability", "description": "On Linux, Node.js ignores certain environment variables if those may have been set by an unprivileged user while the process is running with elevated privileges with the only exception of CAP_NET_BIND_SERVICE.", "published": "2024-02-20T02:15:50.567", "last_modified": "2024-05-01T18:15:13.610"}, {"id": "T1190", "type": "attack-pattern", "name": "Local Privilege Escalation: Environment Variable Manipulation", "description": "An adversary manipulates environment variables to escalate privileges on a local system."}, {"id": "T1078", "type": "attack-pattern", "name": "Exploitation of System Capabilities", "description": "An adversary exploits system capabilities to gain unauthorized access to system resources."}, {"id": "T1210", "type": "attack-pattern", "name": "Exploitation of System Privileges", "description": "An adversary exploits system privileges to gain unauthorized access to system resources."}, {"id": "nodejs-environment-variable-defense", "type": "indicator", "name": "Node.js Environment Variable Defense", "description": "This indicator monitors for suspicious environment variable manipulation."}], "relationships": [{"id": "cve-2024-21892-T1190", "type": "related", "object_ref": "T1190", "since_version": "2.1", "relationship_identifier": "mitigated-by"}, {"id": "cve-2024-21892-T1078", "type": "related", "object_ref": "T1078", "since_version": "2.1", "relationship_identifier": "related-to"}, {"id": "cve-2024-21892-T1210", "type": "related", "object_ref": "T1210", "since_version": "2.1", "relationship_identifier": "related-to"}, {"id": "T1190-nodejs-environment-variable-defense", "type": "used-by", "object_ref": "nodejs-environment-variable-defense", "since_version": "2.1", "relationship_identifier": "uses"}]}, "technical_analysis": {"Introduction": "CVE-2024-21892 is a vulnerability in Node.js that allows an unprivileged user to inject code that inherits elevated privileges. This vulnerability can be exploited to gain unauthorized access to system resources.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 7.5. It affects Node.js versions 14 and 16 on Linux systems.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1190, T1078, and T1210.", "Technical Details": "The vulnerability is due to a bug in the implementation of CAP_NET_BIND_SERVICE in Node.js. An attacker can exploit this bug by setting environment variables that can be used to control the behavior of a process.", "Detection": "This vulnerability can be detected using advanced threat detection techniques, such as API hooks and system call monitoring.", "Mitigation": "Mitigating this vulnerability requires strict access control and monitoring of environment variables. Node.js users should update to the latest version and implement defense-in-depth strategies to prevent exploitation.", "Conclusion": "In conclusion, CVE-2024-21892 is a critical vulnerability in Node.js that requires immediate attention. Defending against this vulnerability requires a multi-faceted approach that includes strict access control, monitoring, and defense-in-depth strategies."}, "executive_analysis": {"Overview": "CVE-2024-21892 is a critical vulnerability in Node.js that allows an unprivileged user to inject code that inherits elevated privileges. This vulnerability has a high impact on business operations and requires immediate attention.", "Business Impact": "The business impact of this vulnerability is high, as it can be exploited to gain unauthorized access to system resources and data. This can lead to significant financial and reputational losses.", "Technical Impact": "The technical impact of this vulnerability is high, as it requires a complex exploit to be executed. However, the vulnerability is still exploitable and requires immediate attention.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include updating to the latest version of Node.js, implementing strict access control, and monitoring environment variables. Node.js users should also implement defense-in-depth strategies to prevent exploitation.", "Recommendations": "In conclusion, we recommend that Node.js users update to the latest version and implement defense-in-depth strategies to prevent exploitation. We also recommend conducting regular vulnerability scans and implementing strict access control to detect and prevent potential attacks.", "Conclusions": "In conclusion, CVE-2024-21892 is a critical vulnerability that requires immediate attention. Node.js users should take immediate action to mitigate this vulnerability and protect their systems from potential attacks."}}