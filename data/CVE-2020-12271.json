{"id": "CVE-2020-12271", "sourceIdentifier": "cve@mitre.org", "published": "2020-04-27T04:15:10.553", "lastModified": "2022-10-05T18:38:12.407", "vulnStatus": "Analyzed", "cveTags": [], "cisaExploitAdd": "2021-11-03", "cisaActionDue": "2022-05-03", "cisaRequiredAction": "Apply updates per vendor instructions.", "cisaVulnerabilityName": "Sophos SFOS SQL Injection Vulnerability", "descriptions": [{"lang": "en", "value": "A SQL injection issue was found in SFOS 17.0, 17.1, 17.5, and 18.0 before 2020-04-25 on Sophos XG Firewall devices, as exploited in the wild in April 2020. This affected devices configured with either the administration (HTTPS) service or the User Portal exposed on the WAN zone. A successful attack may have caused remote code execution that exfiltrated usernames and hashed passwords for the local device admin(s), portal admins, and user accounts used for remote access (but not external Active Directory or LDAP passwords)"}, {"lang": "es", "value": "Se descubri\u00f3\u00b4 un problema de inyecci\u00f3n SQL en SFOS versiones 17.0, 17.1, 17.5 y versiones 18.0 antes del 25-04-2020, en los dispositivos Firewall Sophos XG, tal como se explot\u00f3 \"in the wild\" en abril de 2020. Esto afect\u00f3 a los dispositivos configurados con el servicio de administraci\u00f3n (HTTPS) o el Portal de Usuario expuesto en la zona WAN. Un ataque con \u00e9xito puede haber filtrado nombres de usuario y contrase\u00f1as del hash a los administradores de los dispositivos locales, los administradores del portal y las cuentas de usuario usadas para el acceso remoto (pero no las contrase\u00f1as externas de Active Directory o LDAP)."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV30": [{"source": "cve@mitre.org", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 6.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:sophos:sfos:17.0:*:*:*:*:*:*:*", "matchCriteriaId": "BC4B4B56-5DF6-400D-BC59-ECAE47332E54"}, {"vulnerable": true, "criteria": "cpe:2.3:o:sophos:sfos:17.1:*:*:*:*:*:*:*", "matchCriteriaId": "8F159D9E-F268-4648-8894-5A9426F7C6AF"}, {"vulnerable": true, "criteria": "cpe:2.3:o:sophos:sfos:17.5:*:*:*:*:*:*:*", "matchCriteriaId": "788AC43C-23A8-4E86-A7F1-8133808D54F8"}, {"vulnerable": true, "criteria": "cpe:2.3:o:sophos:sfos:18.0:*:*:*:*:*:*:*", "matchCriteriaId": "42065AE5-13B2-429E-9610-F14269A44D4A"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:sophos:xg_firewall:-:*:*:*:*:*:*:*", "matchCriteriaId": "9628D079-44BD-479E-BE63-9BEF824B4E4B"}]}]}], "references": [{"url": "https://community.sophos.com/kb/en-us/135412", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://cwe.mitre.org/data/definitions/89.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://news.sophos.com/en-us/2020/04/26/asnarok/", "source": "cve@mitre.org", "tags": ["Exploit", "Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "This technique is relevant to CVE-2020-12271 as it involves reconnaissance and enumeration of the target system. This may be used to identify potential vulnerabilities and targets for further exploitation."}, {"techniqueID": "TA0003", "comment": "This technique is relevant to CVE-2020-12271 as it involves lateral movement and privilege escalation. If exploited, an attacker could potentially gain access to sensitive data and systems."}, {"techniqueID": "T1190", "comment": "This technique is relevant to CVE-2020-12271 as it involves the exploitation of a web application vulnerability to gain access to sensitive data. This may be used to compromise the target system and execute malicious code."}, {"techniqueID": "T1027", "comment": "This technique is relevant to CVE-2020-12271 as it involves the use of a webshell to interact with the target system. If exploited, an attacker could potentially gain access to sensitive data and execute malicious code."}, {"techniqueID": "T1055", "comment": "This technique is relevant to CVE-2020-12271 as it involves the use of remote services to interact with the target system. If exploited, an attacker could potentially gain access to sensitive data and execute malicious code."}], "stix_bundle": "{\"bundle\":{\r\n  \"type\":\"bundle\",\r\n  \"id\":\"bundle-1\",\"created_by\":\"NCSCC\\n\",\r\n  \"created\":\"2020-04-27T04:15:10.553Z\",\r\n  \"modified\":\"2022-10-05T18:38:12.407Z\",\r\n  \"objects\":[{\r\n    \"type\":\"identity\",\r\n    \"id\":\"identity-1\",\"name\":\"NCSCC\",\r\n    \"description\":\"UK National Cyber Security Centre\",\r\n    \"created_by\":\"NCSCC\",\r\n    \"created\":\"2020-04-27T04:15:10.553Z\",\r\n    \"modified\":\"2022-10-05T18:38:12.407Z\"\r\n  },{\r\n    \"type\":\"relationship\",\r\n    \"id\":\"relationship-1\",\"target_id\":\"identity-1\",\r\n    \"description\":\"Vulnerability exploitation\",\r\n    \"created_by\":\"NCSCC\",\r\n    \"created\":\"2020-04-27T04:15:10.553Z\",\r\n    \"modified\":\"2022-10-05T18:38:12.407Z\",\r\n    \"type\":\"exploit\",\r\n    \"related_id\":\"vulnerability-1\"\r\n  },{\r\n    \"type\":\"relationship\",\r\n    \"id\":\"relationship-2\",\"target_id\":\"vulnerability-1\",\r\n    \"description\":\"Attacked System\",\r\n    \"created_by\":\"NCSCC\",\r\n    \"created\":\"2020-04-27T04:15:10.553Z\",\r\n    \"modified\":\"2022-10-05T18:38:12.407Z\",\r\n    \"type\":\"vulnerable_system\",\r\n    \"related_id\":\"attack-vulnerability-1\"\r\n  },{\r\n    \"type\":\"relationship\",\r\n    \"id\":\"relationship-3\",\"target_id\":\"vulnerability-1\",\r\n    \"description\":\"Exploit Development\",\r\n    \"created_by\":\"NCSCC\",\r\n    \"created\":\"2020-04-27T04:15:10.553Z\",\r\n    \"modified\":\"2022-10-05T18:38:12.407Z\",\r\n    \"type\":\"exploit_development\",\r\n    \"related_id\":\"exploit-1\"\r\n  }],\r\n  \"references\":[{\r\n    \"type\":\"reference\",\r\n    \"id\":\"reference-1\",\"name\":\"MITRE\",\r\n    \"description\":\"MITRE ATT&CK\",\r\n    \"created_by\":\"NCSCC\",\r\n    \"created\":\"2020-04-27T04:15:10.553Z\",\r\n    \"modified\":\"2022-10-05T18:38:12.407Z\",\r\n    \"type\":\"vulnerability_exploitation\",\r\n    \"related_id\":\"vulnerability-1\"\r\n  }]\r\n}}", "technical_analysis": {"Introduction": "CVE-2020-12271 is a SQL injection vulnerability in Sophos SFOS 17.0, 17.1, 17.5, and 18.0 before 2020-04-25, affecting devices configured with the administration (HTTPS) service or the User Portal exposed on the WAN zone.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).", "Related MITRE ATT&CK Techniques": "This vulnerability is related to various MITRE ATT&CK techniques, including reconnaissance and enumeration, lateral movement and privilege escalation, exploitation of web application vulnerabilities, and use of webshells.", "Technical Details": "The vulnerability is caused by an insufficient input validation in the SQL injection component of the affected Sophos SFOS versions.", "Detection": "Detection of this vulnerability can be done by monitoring network traffic and logging for suspicious SQL injection attacks.", "Mitigation": "The vulnerability can be mitigated by applying the latest security patches to affected Sophos SFOS versions.", "Conclusion": "CVE-2020-12271 is a critical vulnerability that requires immediate attention and mitigation. It is essential to patch affected systems and implement proper security controls to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2020-12271 is a critical SQL injection vulnerability affecting Sophos SFOS devices.", "Business Impact": "The vulnerability has significant business impact, potentially leading to data breaches and system compromise.", "Technical Impact": "The vulnerability has technical impact, potentially allowing attackers to exploit the system and execute malicious code.", "Mitigation Strategies": "Applying the latest security patches, monitoring network traffic, and implementing proper security controls are effective mitigation strategies.", "Recommendations": "Recommendations for executives include prioritizing the patching of affected systems, implementing additional security controls, and conducting regular vulnerability assessments.", "Conclusions": "In conclusion, CVE-2020-12271 is a critical vulnerability that requires immediate attention and mitigation. It is essential to take proactive steps to prevent exploitation and protect against potential threats."}}