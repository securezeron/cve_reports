{"id": "CVE-2020-14161", "sourceIdentifier": "cve@mitre.org", "published": "2021-08-26T11:15:09.553", "lastModified": "2021-09-07T17:33:53.573", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "It is possible to inject HTML and/or JavaScript in the HTML to PDF conversion in Gotenberg through 6.2.1 via the /convert/html endpoint."}, {"lang": "es", "value": "Es posible inyectar HTML y/o JavaScript en la conversi\u00f3n de HTML a PDF en Gotenberg versiones hasta 6.2.1, por medio del endpoint /convert/html."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:thecodingmachine:gotenberg:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.2.1", "matchCriteriaId": "B023F305-FA25-4E60-AA64-C7327F034F9F"}]}]}], "references": [{"url": "https://github.com/gotenberg/gotenberg/issues/215", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/gotenberg/gotenberg/pull/319", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/thecodingmachine/gotenberg/releases", "source": "cve@mitre.org", "tags": ["Release Notes", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1027", "comment": "CVSS 6.1, Medium severity - HTML Injection via /convert/html endpoint. This technique is used in various attacks like Cross-Site Scripting (XSS), Server-Side Request Forgery (SSRF), Cross-Site Request Forgery (CSRF)."}, {"techniqueID": "T1505", "comment": "CVSS 4.3, Medium severity - Weakness in the HTML to PDF conversion. This technique is used in various attacks like Injecting malicious content, Bypassing security features."}, {"techniqueID": "T1190", "comment": "CVSS 6.1, Medium severity - Web Shell upload via HTML injection. This technique is used in various attacks like Elevating privileges, Backdoors, Command injection."}], "stix_bundle": {" objects": [{"type": "identity", "id": "identity--1", "created_by_ref": "organization--1", "name": "Gotenberg", "description": "Gotenberg HTML to PDF conversion vulnerability"}, {"type": "vulnerability", "id": "vulnerability--1", "created_by_ref": "identity--1", "name": "Gotenberg HTML to PDF conversion vulnerability", "description": "It is possible to inject HTML and/or JavaScript in the HTML to PDF conversion in Gotenberg through /convert/html endpoint.", "references": [{"source_name": "nvd@nist.gov", "reference_url": "https://nvd.nist.gov/vuln/detail/CVE-2020-14161"}]}, {"type": "attack-pattern", "id": "attack-pattern--1", "name": "HTML Injection via /convert/html endpoint", "description": "HTML injection exploit using /convert/html endpoint in Gotenberg"}, {"type": "attack-pattern", "id": "attack-pattern--2", "name": "Weakness in HTML to PDF conversion", "description": "Weakness in the HTML to PDF conversion in Gotenberg"}, {"type": "intrusion-set", "id": "intrusion-set--1", "name": "Unknown", "description": "Unknown intrusion set exploiting the Gotenberg vulnerability"}, {"type": "course-of-action", "id": "course-of-action--1", "name": "Patch and update Gotenberg", "description": "Patch the vulnerability by updating Gotenberg to a version higher than 6.2.1", "related_technique_refs": ["technique--1", "technique--2"]}, {"type": "note", "id": "note--1", "content": "Detect the vulnerability using web application scanners and patch it promptly.", "published": "2021-08-26T11:15:09.553"}], "relationship": [{"id": "relationship--1", "type": "related-to", "id_ref": "vulnerability--1", "related_id": "attack-pattern--1", "relationship_type": "exploits"}, {"id": "relationship--2", "type": "related-to", "id_ref": "vulnerability--1", "related_id": "attack-pattern--2", "relationship_type": "involves"}, {"id": "relationship--3", "type": "part-of", "id_ref": "course-of-action--1", "related_id": "cvss-v3--1", "relationship_type": " fixes"}]}, "technical_analysis": {"Introduction": "The CVE-2020-14161 is a vulnerability in the HTML to PDF conversion feature of Gotenberg. It allows an attacker to inject HTML and/or JavaScript code, which can lead to arbitrary code execution and other attacks.", "Impact and Scope": "The vulnerability has a CVSS score of 6.1 and is categorized as a Medium severity vulnerability. It affects all versions of Gotenberg up to and including 6.2.1. An attacker can exploit this vulnerability to inject malicious code, elevate privileges, and execute arbitrary code.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1027, T1505, and T1190. These techniques are used to exploit the vulnerability and gain unauthorized access to the system.", "Technical Details": "The vulnerability occurs due to the improper sanitization of user input in the /convert/html endpoint. An attacker can send a malformed HTML request to this endpoint, which can be used to inject malicious code.", "Detection": "Detecting this vulnerability requires the use of web application scanners and manual testing. The scanners can detect the existence of the endpoint and the absence of proper input validation.", "Mitigation": "The mitigation for this vulnerability is to patch the vulnerability by updating Gotenberg to a version higher than 6.2.1. Additionally, it is recommended to manually validate the input data in the /convert/html endpoint.", "Conclusion": "In conclusion, the CVE-2020-14161 is a severe vulnerability that requires prompt patching and mitigation. It is essential to detect and remediate this vulnerability to prevent attacks and ensure the security of the system."}, "executive_analysis": {"Overview": "The CVE-2020-14161 is a vulnerability in the HTML to PDF conversion feature of Gotenberg. It can be exploited to gain unauthorized access to the system, execute arbitrary code, and inject malicious code.", "Business Impact": "This vulnerability can have significant business impact, particularly if it is exploited by an attacker to gain unauthorized access or compromise sensitive data.", "Technical Impact": "The technical impact of this vulnerability is significant, as it can allow an attacker to elevate privileges, execute arbitrary code, and inject malicious code.", "Mitigation Strategies": "To mitigate this vulnerability, urgent patching of Gotenberg is recommended. Additionally, manual validation of input data and regular security testing should be performed.", "Recommendations": "We recommend that executives take immediate action to patch the vulnerability and ensure that manual validation of input data and regular security testing are performed.", "Conclusions": "In conclusion, the CVE-2020-14161 is a severe vulnerability that requires prompt action to mitigate the risk. Executive support is essential in ensuring the security of the system and preventing attacks."}}