{
    "id": "CVE-2021-32786",
    "sourceIdentifier": "security-advisories@github.com",
    "published": "2021-07-22T22:15:08.233",
    "lastModified": "2024-11-21T06:07:44.207",
    "vulnStatus": "Modified",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "mod_auth_openidc is an authentication/authorization module for the Apache 2.x HTTP server that functions as an OpenID Connect Relying Party, authenticating users against an OpenID Connect Provider. In versions prior to 2.4.9, `oidc_validate_redirect_url()` does not parse URLs the same way as most browsers do. As a result, this function can be bypassed and leads to an Open Redirect vulnerability in the logout functionality. This bug has been fixed in version 2.4.9 by replacing any backslash of the URL to redirect with slashes to address a particular breaking change between the different specifications (RFC2396 / RFC3986 and WHATWG). As a workaround, this vulnerability can be mitigated by configuring `mod_auth_openidc` to only allow redirection whose destination matches a given regular expression."
        },
        {
            "lang": "es",
            "value": "mod_auth_openidc es un m\u00f3dulo de autenticaci\u00f3n/autorizaci\u00f3n para el servidor HTTP Apache versi\u00f3n 2.x que funciona como un OpenID Connect Relying Party, autenticando a usuarios contra un OpenID Connect Provider. En versiones anteriores a 2.4.9, \"oidc_validate_redirect_url()\" no analiza las URLs de la misma manera que la mayor\u00eda de los navegadores. Como resultado, esta funci\u00f3n puede ser omitida y conlleva a una vulnerabilidad de Redirecci\u00f3n Abierta en la funcionalidad logout. Este bug ha sido corregido en versi\u00f3n 2.4.9 al reemplazar cualquier barra invertida de la URL a redirigir por barras inclinadas para solucionar un cambio particular de ruptura entre las diferentes especificaciones (RFC2396 / RFC3986 y WHATWG). Como soluci\u00f3n, esta vulnerabilidad puede ser mitigada configurando \"mod_auth_openidc\" para que s\u00f3lo permita la redirecci\u00f3n cuyo destino coincida con una expresi\u00f3n regular determinada"
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "security-advisories@github.com",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N",
                    "baseScore": 4.7,
                    "baseSeverity": "MEDIUM",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "REQUIRED",
                    "scope": "CHANGED",
                    "confidentialityImpact": "NONE",
                    "integrityImpact": "LOW",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 2.8,
                "impactScore": 1.4
            },
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
                    "baseScore": 6.1,
                    "baseSeverity": "MEDIUM",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "REQUIRED",
                    "scope": "CHANGED",
                    "confidentialityImpact": "LOW",
                    "integrityImpact": "LOW",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 2.8,
                "impactScore": 2.7
            }
        ],
        "cvssMetricV2": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "2.0",
                    "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:N",
                    "baseScore": 5.8,
                    "accessVector": "NETWORK",
                    "accessComplexity": "MEDIUM",
                    "authentication": "NONE",
                    "confidentialityImpact": "PARTIAL",
                    "integrityImpact": "PARTIAL",
                    "availabilityImpact": "NONE"
                },
                "baseSeverity": "MEDIUM",
                "exploitabilityScore": 8.6,
                "impactScore": 4.9,
                "acInsufInfo": false,
                "obtainAllPrivilege": false,
                "obtainUserPrivilege": false,
                "obtainOtherPrivilege": false,
                "userInteractionRequired": true
            }
        ]
    },
    "weaknesses": [
        {
            "source": "security-advisories@github.com",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-601"
                }
            ]
        },
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-601"
                }
            ]
        }
    ],
    "configurations": [
        {
            "operator": "AND",
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:openidc:mod_auth_openidc:*:*:*:*:*:*:*:*",
                            "versionEndExcluding": "2.4.9",
                            "matchCriteriaId": "FAEFDBA2-55AD-410B-95C4-D2524C65B4A8"
                        }
                    ]
                },
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": false,
                            "criteria": "cpe:2.3:a:apache:http_server:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "2.0.0",
                            "versionEndIncluding": "2.4.48",
                            "matchCriteriaId": "BC9C65B5-0989-4D64-9BED-1E391AD971AE"
                        }
                    ]
                }
            ]
        },
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*",
                            "matchCriteriaId": "E460AA51-FCDA-46B9-AE97-E6676AA5E194"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*",
                            "matchCriteriaId": "A930E247-0B43-43CB-98FF-6CE7B8189835"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https://daniel.haxx.se/blog/2017/01/30/one-url-standard-please/",
            "source": "security-advisories@github.com",
            "tags": [
                "Exploit",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/commit/3a115484eb927bc6daa5737dd84f88ff4bbc5544",
            "source": "security-advisories@github.com",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/releases/tag/v2.4.9",
            "source": "security-advisories@github.com",
            "tags": [
                "Release Notes",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/security/advisories/GHSA-xm4c-5wm5-jqv7",
            "source": "security-advisories@github.com",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://lists.debian.org/debian-lts-announce/2023/04/msg00034.html",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FZVF6BSJLRQZ7PFFR4X5JSU6KUJYNOCU/",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QXAWKPT5LXZSUTFSJ6IWSZC7RMYYQXQD/",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://security.netapp.com/advisory/ntap-20210902-0001/",
            "source": "security-advisories@github.com",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
            "source": "security-advisories@github.com",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://daniel.haxx.se/blog/2017/01/30/one-url-standard-please/",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Exploit",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/commit/3a115484eb927bc6daa5737dd84f88ff4bbc5544",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/releases/tag/v2.4.9",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Release Notes",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/security/advisories/GHSA-xm4c-5wm5-jqv7",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://lists.debian.org/debian-lts-announce/2023/04/msg00034.html",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FZVF6BSJLRQZ7PFFR4X5JSU6KUJYNOCU/",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QXAWKPT5LXZSUTFSJ6IWSZC7RMYYQXQD/",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://security.netapp.com/advisory/ntap-20210902-0001/",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        }
    ],
    "techniques": [
        {
            "techniqueID": "T1046",
            "comment": "Open Redirect - mod_auth_openidc is vulnerable to open redirect, which can be used to trick users into divulging sensitive information. To defend against this, ensure that `mod_auth_openidc` is configured to only allow redirection to trusted URLs"
        },
        {
            "techniqueID": "T1557",
            "comment": "Server-Side Request Forgery (SSRF) - The lack of proper URL parsing in `oidc_validate_redirect_url()` function can also be exploited for SSRF attacks. To defend against this, patch the mod_auth_openidc module to the latest version (2.4.9) or implement a proper URL whitelisting mechanism"
        },
        {
            "techniqueID": "T1190",
            "comment": "Cross-Site Scripting (XSS) - While not directly related to the Open Redirect vulnerability, XSS attacks can be used to exploit the mod_auth_openidc's incomplete URL parsing. To defend against this, ensure that user input is properly sanitized and validated for client-side scripts"
        }
    ],
    "technical_analysis": {
        "Introduction": "The mod_auth_openidc module for Apache 2.x is vulnerable to Open Redirect and SSRF attacks due to incomplete URL parsing in the `oidc_validate_redirect_url()` function.",
        "Impact and Scope": "Attackers can use this vulnerability to trick users into divulging sensitive information and exploit server-side resources. CVSS Score: 4.7, CVSS Version: 3.1, Attack Vector: NETWORK",
        "Related MITRE ATT&CK Techniques": "T1046, T1557, T1190",
        "Technical Details": "The vulnerability occurs when `oidc_validate_redirect_url()` fails to parse URLs correctly, allowing attackers to craft malicious redirect URLs.",
        "Detection": "Monitor Apache logs for unusual redirect attempts and implement URL whitelisting mechanisms.",
        "Mitigation": "Patch mod_auth_openidc to version 2.4.9 or higher, implement URL whitelisting, and ensure proper input sanitization and validation.",
        "Conclusion": "The mod_auth_openidc module requires immediate attention to prevent exploitation of Open Redirect and SSRF attacks."
    },
    "executive_analysis": {
        "Overview": "mod_auth_openidc, a widely used Apache module, is vulnerable to Open Redirect and SSRF attacks due to incomplete URL parsing.",
        "Business Impact": "This vulnerability can compromise user data, intellectual property, and sensitive business information.",
        "Technical Impact": "Attackers can exploit this vulnerability to gain unauthorized access to server-side resources and manipulate user sessions.",
        "Mitigation Strategies": "Implement patching, URL whitelisting, and input sanitization strategies to mitigate the risks.",
        "Recommendations": "Advise IT teams to prioritize patching and implement URL whitelisting mechanisms to prevent exploitation.",
        "Conclusions": "Immediate action is required to mitigate the risks associated with this vulnerability and ensure the security of organization's data."
    }
}