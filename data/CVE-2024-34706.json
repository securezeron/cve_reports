{"id": "CVE-2024-34706", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-14T15:39:29.990", "lastModified": "2024-05-14T16:12:23.490", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Valtimo is an open source business process and case management platform. When opening a form in Valtimo, the access token (JWT) of the user is exposed to `api.form.io` via the the `x-jwt-token` header. An attacker can retrieve personal information from this token, or use it to execute requests to the Valtimo REST API on behalf of the logged-in user. This issue is caused by a misconfiguration of the Form.io component.\n\nThe following conditions have to be met in order to perform this attack: An attacker needs to have access to the network traffic on the `api.form.io` domain; the content of the `x-jwt-token` header is logged or otherwise available to the attacker; an attacker needs to have network access to the Valtimo API; and an attacker needs to act within the time-to-live of the access token. The default TTL in Keycloak is 5 minutes.\n\nVersions 10.8.4, 11.1.6 and 11.2.2 have been patched."}, {"lang": "es", "value": "Valtimo es una plataforma de gesti\u00f3n de casos y procesos empresariales de c\u00f3digo abierto. Al abrir un formulario en Valtimo, el token de acceso (JWT) del usuario se expone a `api.form.io` a trav\u00e9s del encabezado `x-jwt-token`. Un atacante puede recuperar informaci\u00f3n personal de este token o utilizarlo para ejecutar solicitudes a la API REST de Valtimo en nombre del usuario que ha iniciado sesi\u00f3n. Este problema se debe a una mala configuraci\u00f3n del componente Form.io. Se deben cumplir las siguientes condiciones para realizar este ataque: Un atacante debe tener acceso al tr\u00e1fico de red en el dominio `api.form.io`; el contenido del encabezado `x-jwt-token` est\u00e1 registrado o disponible de otro modo para el atacante; un atacante necesita tener acceso de red a la API de Valtimo; y un atacante debe actuar dentro del tiempo de vida del token de acceso. El TTL predeterminado en Keycloak es 5 minutos. Se han parcheado las versiones 10.8.4, 11.1.6 y 11.2.2."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-532"}]}], "references": [{"url": "https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/1aaba5ef5750dafebbc7476fb08bf2375a25f19e", "source": "security-advisories@github.com"}, {"url": "https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/8c2dbf2a41180d2b0358d878290e4d37168f0fb6", "source": "security-advisories@github.com"}, {"url": "https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/d65e05fd2784bd4a628778b34a5b79ce2f0cef8c", "source": "security-advisories@github.com"}, {"url": "https://github.com/valtimo-platform/valtimo-frontend-libraries/security/advisories/GHSA-xcp4-62vj-cq3r", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1218", "comment": "CVE-2024-34706 - Exposed JWT Token in Form.io due to misconfiguration, allowing unauthorized access to personal information and API requests on behalf of the logged-in user"}, {"techniqueID": "T1204", "comment": "CVE-2024-34706 - Network traffic sniffing to capture the exposed JWT token or conduct reconnaissance on the targeted network"}, {"techniqueID": "T1027", "comment": "CVE-2024-34706 - Network access to the Valtimo API using the captured JWT token to execute unauthorized requests"}, {"techniqueID": "T1189", "comment": "CVE-2024-34706 - Publicly available information gathering to discover the vulnerable application version and exploit the misconfigured Form.io component"}], "stix_bundle": {"id": "CVE-2024-34706-STIX-Bundle", "type": "bundle", "spec_version": "2.1", "objects": [{"id": "CVE-2024-34706", "type": "vulnerability", "name": "Exposure of JWT Token in Valtimo Form.io", "description": "CVE-2024-34706 - Valtimo is an open-source business process and case management platform that exposes the access token (JWT) of the user to \"api.form.io\" via the \"x-jwt-token\" header when opening a form. This issue is caused by a misconfiguration of the Form.io component.", "related_object": {"type": "identity", "id": "Valtimo", "name": "Valtimo"}, "references": [{"id": "github-commit-1", "type": "github-commit", "href": "https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/1aaba5ef5750dafebbc7476fb08bf2375a25f19e"}, {"id": "github-commit-2", "type": "github-commit", "href": "https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/8c2dbf2a41180d2b0358d878290e4d37168f0fb6"}, {"id": "github-commit-3", "type": "github-commit", "href": "https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/d65e05fd2784bd4a628778b34a5b79ce2f0cef8c"}, {"id": "github-advisory-1", "type": "github-advisory", "href": "https://github.com/valtimo-platform/valtimo-frontend-libraries/security/advisories/GHSA-xcp4-62vj-cq3r"}]}, {"id": "T1218", "type": "attack-pattern", "name": "Exfiltration Over Command and Control Channel", "description": "Exfiltration over command and control channel using various protocols such as HTTP, HTTPS, and others.", "related_object": {"type": "vulnerability", "id": "CVE-2024-34706", "name": "Exposure of JWT Token in Valtimo Form.io"}}, {"id": "T1204", "type": "attack-pattern", "name": "Network Sniffing", "description": "Capturing network traffic to gather information, such as credit card numbers, passwords, and other sensitive data.", "related_object": {"type": "vulnerability", "id": "CVE-2024-34706", "name": "Exposure of JWT Token in Valtimo Form.io"}}, {"id": "T1027", "type": "attack-pattern", "name": "Remote Access Tools", "description": "tools such as RDP, SSH, or other tools to gain unauthorized access to systems remotely.", "related_object": {"type": "vulnerability", "id": "CVE-2024-34706", "name": "Exposure of JWT Token in Valtimo Form.io"}}, {"id": "T1189", "type": "attack-pattern", "name": "Publicly Available Information", "description": "Gathering publicly available information about a target, such as social media profiles, online behavior, and other publicly available data.", "related_object": {"type": "vulnerability", "id": "CVE-2024-34706", "name": "Exposure of JWT Token in Valtimo Form.io"}}]}, "technical_analysis": {"Introduction": "Valtimo is an open-source business process and case management platform. When opening a form in Valtimo, the access token (JWT) of the user is exposed to \"api.form.io\" via the \"x-jwt-token\" header.", "Impact and Scope": "This issue is caused by a misconfiguration of the Form.io component. The cvss score is 9.8 with a version of 3.1 and attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "The related techniques are T1218, T1204, T1027, and T1189.", "Technical Details": "The JWT token is exposed to \"api.form.io\" via the \"x-jwt-token\" header when opening a form in Valtimo.", "Detection": "Detecting this issue involves monitoring network traffic for the exposed JWT token and analyzing the API requests made to the Valtimo API.", "Mitigation": "Mitigating this issue involves patching the vulnerable versions of Valtimo and configuring the Form.io component correctly.", "Conclusion": "Summary and conclusions."}, "executive_analysis": {"Overview": "Exposure of JWT Token in Valtimo Form.io is a critical vulnerability that allows unauthorized access to personal information and API requests on behalf of the logged-in user.", "Business Impact": "This vulnerability has significant business impact as it allows unauthorized access to sensitive data and API requests.", "Technical Impact": "This vulnerability has significant technical impact as it allows attackers to exploit the misconfigured Form.io component.", "Mitigation Strategies": "Patching the vulnerable versions of Valtimo and configuring the Form.io component correctly are the recommended mitigation strategies.", "Recommendations": "Recommendations for executives to address this vulnerability include prioritizing patching and configuration changes, conducting regular security assessments, and developing incident response plans.", "Conclusions": "Final conclusions and next steps."}}