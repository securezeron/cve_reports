{"id": "CVE-2024-41039", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-29T15:15:12.393", "lastModified": "2024-07-29T16:21:52.517", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nfirmware: cs_dsp: Fix overflow checking of wmfw header\n\nFix the checking that firmware file buffer is large enough for the\nwmfw header, to prevent overrunning the buffer.\n\nThe original code tested that the firmware data buffer contained\nenough bytes for the sums of the size of the structs\n\n\twmfw_header + wmfw_adsp1_sizes + wmfw_footer\n\nBut wmfw_adsp1_sizes is only used on ADSP1 firmware. For ADSP2 and\nHalo Core the equivalent struct is wmfw_adsp2_sizes, which is\n4 bytes longer. So the length check didn't guarantee that there\nare enough bytes in the firmware buffer for a header with\nwmfw_adsp2_sizes.\n\nThis patch splits the length check into three separate parts. Each\nof the wmfw_header, wmfw_adsp?_sizes and wmfw_footer are checked\nseparately before they are used."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: firmware: cs_dsp: corrige la verificaci\u00f3n de desbordamiento del encabezado wmfw. Se corrige la verificaci\u00f3n de que el b\u00fafer del archivo de firmware sea lo suficientemente grande para el encabezado wmfw, para evitar que se sobrecargue el b\u00fafer. El c\u00f3digo original prob\u00f3 que el b\u00fafer de datos del firmware conten\u00eda suficientes bytes para las sumas del tama\u00f1o de las estructuras wmfw_header + wmfw_adsp1_sizes + wmfw_footer. Pero wmfw_adsp1_sizes solo se usa en el firmware ADSP1. Para ADSP2 y Halo Core, la estructura equivalente es wmfw_adsp2_sizes, que es 4 bytes m\u00e1s larga. Por lo tanto, la verificaci\u00f3n de longitud no garantiza que haya suficientes bytes en el b\u00fafer del firmware para un encabezado con wmfw_adsp2_sizes. Este parche divide el control de longitud en tres partes separadas. Cada uno de los wmfw_header, wmfw_adsp?_sizes y wmfw_footer se verifican por separado antes de usarse."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/3019b86bce16fbb5bc1964f3544d0ce7d0137278", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/49a79f344d0a17c6a5eef53716cc76fcdbfca9ba", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9c9877a96e033bf6c6470b3b4f06106d91ace11e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/fd035f0810b33c2a8792effdb82bf35920221565", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1003.005", "comment": "Code injection using firmware update mechanism - CVE-2024-41039 - This vulnerability allows an attacker to inject arbitrary code into the Linux kernel through a firmware update mechanism."}, {"techniqueID": "T1078", "comment": "Exploitation of legitimate functions or services - CVE-2024-41039 - This vulnerability can be exploited by an attacker to execute arbitrary code on a Linux system by exploiting a firmware update mechanism."}], "stix_bundle": "[\n  {\n    \"_type\": \"indicator\",\n    \"created_by_ref\": \"416baaa9-dc9f-4396-8d5f-8c081fb06d67\",\n    \"modified\": \"2024-07-29T16:21:52.517\",\n    \"created\": \"2024-07-29T15:15:12.393\",\n    \"name\": \"CVE-2024-41039 Firmware Update Mechanism Code Injection\",\n    \"description\": \"This indicator represents a potential code injection attack against the Linux kernel using the firmware update mechanism.\",\n    \"type\": \"server software\",\n    \"resource_ref\": \"416baaa9-dc9f-4396-8d5f-8c081fb06d67\",\n    \"object_ref\": \"416baaa9-dc9f-4396-8d5f-8c081fb06d67\",\n    \"relationship\": {\n      \"target_ref\": \"416baaa9-dc9f-4396-8d5f-8c081fb06d67\",\n      \"type\": \"related to\",\n      \"description\": \"This indicator is related to a potential exploitation of the CVE-2024-41039 vulnerability.\"\n    }\n  },\n  {\n    \"_type\": \"malware\"", "technical_analysis": {"Introduction": "CVE-2024-41039 is a vulnerability in the Linux kernel's firmware update mechanism that allows an attacker to inject arbitrary code into the kernel.", "Impact and Scope": "CVSS score is 8.1, attack vector is local.", "Related MITRE ATT&CK Techniques": "T1003.005, T1078", "Technical Details": "The vulnerability occurs because the firmware update mechanism does not properly validate the contents of the firmware update package.", "Detection": "Detection is difficult without proper system monitoring and logging.", "Mitigation": "Apply the patch provided by the Linux kernel developers.", "Conclusion": "Conclusion is that the CVE-2024-41039 vulnerability is a significant threat to Linux systems and should be prioritized for patching."}, "executive_analysis": {"Overview": "CVE-2024-41039 is a vulnerability in the Linux kernel's firmware update mechanism that allows an attacker to inject arbitrary code into the kernel.", "Business Impact": "The vulnerability could allow an attacker to compromise sensitive data or disrupt business operations.", "Technical Impact": "The vulnerability could allow an attacker to gain elevated privileges and execute arbitrary code on the system.", "Mitigation Strategies": "Apply the patch provided by the Linux kernel developers.", "Recommendations": "Recommendations for executives include prioritizing patching this vulnerability and conducting a thorough risk assessment.", "Conclusions": "Conclusion is that the CVE-2024-41039 vulnerability is a significant threat to Linux systems and should be prioritized for patching."}}