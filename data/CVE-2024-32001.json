{"id": "CVE-2024-32001", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-10T23:15:07.363", "lastModified": "2024-04-11T12:47:44.137", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "SpiceDB is a graph database purpose-built for storing and evaluating access control data. Use of a relation of the form: `relation folder: folder | folder#parent` with an arrow such as `folder->view` can cause LookupSubjects to only return the subjects found under subjects for either `folder` or `folder#parent`. This bug only manifests if the same subject type is used multiple types in a relation, relationships exist for both subject types and an arrow is used over the relation. Any user making a negative authorization decision based on the results of a LookupSubjects request with version before v1.30.1 is affected. Version 1.30.1 contains a patch for the issue. As a workaround, avoid using LookupSubjects for negative authorization decisions and/or avoid using the broken schema.\n"}, {"lang": "es", "value": "SpiceDB es una base de datos gr\u00e1fica manipulada espec\u00edficamente para almacenar y evaluar datos de control de acceso. Uso de una relaci\u00f3n de la forma: `relation folder: folder | folder#parent` con una flecha como `folder-&gt;view` puede hacer que LookupSubjects solo devuelva los asuntos encontrados en los asuntos de `folder` o `folder#parent`. Este error solo se manifiesta si el mismo tipo de asunto se usa en varios tipos en una relaci\u00f3n, existen relaciones para ambos tipos de asunto y se usa una flecha sobre la relaci\u00f3n. Cualquier usuario que tome una decisi\u00f3n de autorizaci\u00f3n negativa basada en los resultados de una solicitud de LookupSubjects con una versi\u00f3n anterior a la v1.30.1 se ver\u00e1 afectado. La versi\u00f3n 1.30.1 contiene un parche para el problema. Como workaround, evite el uso de LookupSubjects para decisiones de autorizaci\u00f3n negativas y/o evite el uso del esquema roto."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 2.2, "baseSeverity": "LOW"}, "exploitabilityScore": 0.7, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-755"}]}], "references": [{"url": "https://github.com/authzed/spicedb/commit/a244ed1edfaf2382711dccdb699971ec97190c7b", "source": "security-advisories@github.com"}, {"url": "https://github.com/authzed/spicedb/releases/tag/v1.30.1", "source": "security-advisories@github.com"}, {"url": "https://github.com/authzed/spicedb/security/advisories/GHSA-j85q-46hg-36p2", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1087", "comment": "CVE-2024-32001 - This is a GraphQL injection vulnerability, which can be used to manipulate the data queried from the Spicedb graph database. This could be achieved by crafting malicious GraphQL queries and injecting them into the system, potentially leading to unauthorized data access or modification. Defending against this involves validating and sanitizing user input to prevent injected queries."}, {"techniqueID": "T1085", "comment": "CVE-2024-32001 - This is an unauthorized access vulnerability, as unauthenticated users may be able to access sensitive data stored in the Spicedb graph database. Defending against this involves implementing proper authentication and authorization mechanisms to restrict access to sensitive data."}, {"techniqueID": "T1022", "comment": "CVE-2024-32001 - This is a command injection vulnerability, as an attacker can potentially inject malicious commands into the system. Defending against this involves validating and sanitizing user input to prevent injected commands."}, {"techniqueID": "T1190", "comment": "CVE-2024-32001 - This is a data theft vulnerability, as an attacker may be able to exfiltrate sensitive data stored in the Spicedb graph database. Defending against this involves implementing data encryption and access controls to restrict data access."}], "stix_bundle": {"@schema": "https://docs.oasis-open.org/cti/stix/2.1/stix-core-v2.1.xsd", "id": "CVE-2024-32001", "type": "indicator", "created_by_ref": "", "created": "", "modified": "", "name": "CVE-2024-32001", "description": "SpiceDB is a graph database purpose-built for storing and evaluating access control data. Use of a relation of the form: `relation folder: folder | folder#parent` with an arrow such as `folder->view` can cause LookupSubjects to only return the subjects found under subjects for either `folder` or `folder#parent`.", "extends": "*", "object_label": "Indicator", "target_network": "", "related_networks": [], "threat_agents": [{"id": "entity-1", "type": "threat-actor", "name": "Unknown Actor", "description": ""}], "observed_data": [{"id": "observed-data-1", "type": "indicator", "name": "Malicious GraphQL Query", "description": "A sample malicious GraphQL query used in the exploitation of CVE-2024-32001"}], "courses_of_action": [{"id": "COA-1", "title": "Patch Application", "description": "Apply the patch released by SpiceDB to fix the vulnerability", "mitigated_vulnerabilities": ["CVE-2024-32001"]}, {"id": "COA-2", "title": "Validation and Sanitization", "description": "Implement proper input validation and sanitization to prevent injected queries", "mitigated_vulnerabilities": ["CVE-2024-32001"]}]}, "technical_analysis": {"Introduction": "This is a technical analysis of the CVE-2024-32001 vulnerability in Spicedb, a graph database", "Impact and Scope": "The vulnerability has a CVSS score of 2.2, with an attack vector of NETWORK, and it can potentially allow unauthorized access to sensitive data", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1087, T1085, T1022, and T1190", "Technical Details": "The vulnerability is caused by a GraphQL injection flaw in the Spicedb graph database, which can be exploited by crafting malicious GraphQL queries", "Detection": "Detection involves monitoring for unusual graph queries and identifying potential injection attacks", "Mitigation": "Mitigation involves applying the patch released by SpiceDB, implementing proper input validation and sanitization, and restricting access to sensitive data", "Conclusion": "Conclusion is that CVE-2024-32001 is a serious vulnerability that requires immediate attention and action to prevent exploitation"}, "executive_analysis": {"Overview": "This is an overview of the CVE-2024-32001 vulnerability in Spicedb", "Business Impact": "The vulnerability has significant business impact, as it can potentially compromise sensitive data and disrupt operations", "Technical Impact": "The vulnerability has significant technical impact, as it can potentially allow unauthorized access to sensitive data and disrupt data integrity", "Mitigation Strategies": "Mitigation strategies include applying the patch, implementing proper input validation and sanitization, and restricting access to sensitive data", "Recommendations": "Recommendations for executives include prioritizing patching, implementing proper security controls, and conducting regular security audits and risk assessments", "Conclusions": "Conclusion is that executive-level attention is required to address the CVE-2024-32001 vulnerability and prevent potential exploitation"}}