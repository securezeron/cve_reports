{"id": "CVE-2024-24762", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-05T15:15:09.260", "lastModified": "2024-02-17T02:15:52.700", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "`python-multipart` is a streaming multipart parser for Python. When using form data, `python-multipart` uses a Regular Expression to parse the HTTP `Content-Type` header, including options. An attacker could send a custom-made `Content-Type` option that is very difficult for the RegEx to process, consuming CPU resources and stalling indefinitely (minutes or more) while holding the main event loop. This means that process can't handle any more requests, leading to regular expression denial of service. This vulnerability has been patched in version 0.0.7."}, {"lang": "es", "value": "FastAPI es un framework web para crear API con Python 3.8+ basado en sugerencias de tipo est\u00e1ndar de Python. Cuando se utilizan datos de formulario, `python-multipart` usa una expresi\u00f3n regular para analizar el encabezado HTTP `Content-Type`, incluidas las opciones. Un atacante podr\u00eda enviar una opci\u00f3n de \"Tipo de contenido\" personalizada que es muy dif\u00edcil de procesar para RegEx, consumiendo recursos de CPU y deteni\u00e9ndose indefinidamente (minutos o m\u00e1s) mientras se mantiene el bucle de evento principal. Esto significa que el proceso no puede manejar m\u00e1s solicitudes. Es un ReDoS (expresi\u00f3n regular de denegaci\u00f3n de servicio), solo se aplica a aquellos que leen datos del formulario usando `python-multipart`. Esta vulnerabilidad ha sido parcheada en la versi\u00f3n 0.109.0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-1333"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-400"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:tiangolo:fastapi:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.109.1", "matchCriteriaId": "8B47D84E-D97C-4E52-91AE-270FCFA34800"}]}]}], "references": [{"url": "https://github.com/Kludex/python-multipart/commit/20f0ef6b4e4caf7d69a667c54dff57fe467109a4", "source": "security-advisories@github.com"}, {"url": "https://github.com/Kludex/python-multipart/security/advisories/GHSA-2jv5-9r88-3w3p", "source": "security-advisories@github.com"}, {"url": "https://github.com/andrew-d/python-multipart/blob/d3d16dae4b061c34fe9d3c9081d9800c49fc1f7a/multipart/multipart.py#L72-L74", "source": "security-advisories@github.com"}, {"url": "https://github.com/encode/starlette/commit/13e5c26a27f4903924624736abd6131b2da80cc5", "source": "security-advisories@github.com"}, {"url": "https://github.com/encode/starlette/security/advisories/GHSA-93gm-qmq6-w238", "source": "security-advisories@github.com"}, {"url": "https://github.com/tiangolo/fastapi/commit/9d34ad0ee8a0dfbbcce06f76c2d5d851085024fc", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/tiangolo/fastapi/releases/tag/0.109.1", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://github.com/tiangolo/fastapi/security/advisories/GHSA-qf9m-vfgh-m389", "source": "security-advisories@github.com", "tags": ["Exploit", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-24762 - An attacker may use this vulnerability to conduct a regular expression denial of service (ReDoS) attack against a targeted system, consuming CPU resources and gaining a Denial of Service."}, {"techniqueID": "T1069", "comment": "CVE-2024-24762 - An attacker may utilize this vulnerability to conduct a HTTP Request Smuggling attack, potentially leading to unauthorized access to sensitive data or system manipulation."}, {"techniqueID": "T1059", "comment": "CVE-2024-24762 - An attacker may leverage this vulnerability to conduct a Web Service attack, potentially leading to unauthorized access to sensitive data or system manipulation."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2024-24762", "name": "python-multipart Regular Expression Denial of Service Vulnerability", "description": "A vulnerability in python-multipart that allows an attacker to perform a regular expression denial of service (ReDoS) attack.", "published": "2024-02-05T15:15:09.260", "modified": "2024-02-17T02:15:52.700"}], "relationship": [{"relationship": "indicates", "source_id": "CVE-2024-24762", "source_label": "Vulnerability", "target_id": "T1190", "target_label": "T1190:Exploit Public-Facing Application"}]}, "technical_analysis": {"Introduction": "The CVE-2024-24762 is a Regular Expression Denial of Service (ReDoS) vulnerability in python-multipart, a Python library used for parsing multipart form data.", "Impact and Scope": "The vulnerability allows an attacker to send a custom-made HTTP Content-Type option that is difficult for the regular expression to process, consuming CPU resources and stalling indefinitely.", "Related MITRE ATT&CK Techniques": "T1190:Exploit Public-Facing Application, T1069:Web Application Exploit, T1059:Web Service", "Technical Details": "The vulnerability is caused by the regular expression patterns used in the library's parsing mechanism.", "Detection": "Detection of this vulnerability may involve monitoring for unusual patterns in HTTP traffic, such as long or malformed requests.", "Mitigation": "Mitigation strategies for this vulnerability include updating to the latest version of python-multipart, or implementing rate limiting and request validation mechanisms.", "Conclusion": "The CVE-2024-24762 is a significant vulnerability that could have serious consequences for systems that rely on python-multipart."}, "executive_analysis": {"Overview": "The CVE-2024-24762 is a Regular Expression Denial of Service (ReDoS) vulnerability in python-multipart, a Python library used for parsing multipart form data.", "Business Impact": "The vulnerability could allow an attacker to consume CPU resources and stall the system, potentially leading to loss of revenue or data.", "Technical Impact": "The vulnerability could allow an attacker to perform a ReDoS attack, potentially leading to system crashes or downtime.", "Mitigation Strategies": "Updating to the latest version of python-multipart, implementing rate limiting and request validation mechanisms.", "Recommendations": "Recommendations for executives include implementing a vulnerability management program and staying up-to-date with the latest security patches.", "Conclusions": "The CVE-2024-24762 is a significant vulnerability that requires immediate attention from IT and management teams."}}