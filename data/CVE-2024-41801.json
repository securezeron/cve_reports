{"id": "CVE-2024-41801", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-25T17:15:11.423", "lastModified": "2024-08-26T16:35:49.930", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "OpenProject is open source project management software. Prior to version 14.3.0, using a forged HOST header in the default configuration of packaged installations and using the \"Login required\" setting, an attacker could redirect to a remote host to initiate a phishing attack against an OpenProject user's account. This vulnerability affects default packaged installation of OpenProject without any additional configuration or modules on Apache (such as mod_security, manually setting a host name, having a fallthrough VirtualHost). It might also affect other installations that did not take care to fix the HOST/X-Forwarded-Host headers. Version 14.3.0 includes stronger protections for the hostname from within the application using the HostAuthorization middleware of Rails to reject any requests with a host name that does not match the configured one. Also, all generated links by the application are now ensured to use the built-in hostname. Users who aren't able to upgrade immediately may use mod_security for Apache2 or manually fix the Host and X-Forwarded-Host headers in their proxying application before reaching the application server of OpenProject. Alternatively, they can manually apply the patch to opt-in to host header protections in previous versions of OpenProject."}, {"lang": "es", "value": "OpenProject es un software de gesti\u00f3n de proyectos de c\u00f3digo abierto. Antes de la versi\u00f3n 14.3.0, al usar un encabezado HOST falsificado en la configuraci\u00f3n predeterminada de las instalaciones empaquetadas y usar la configuraci\u00f3n \"Login required\", un atacante pod\u00eda redirigir a un host remoto para iniciar un ataque de phishing contra la cuenta de un usuario de OpenProject. Esta vulnerabilidad afecta la instalaci\u00f3n empaquetada predeterminada de OpenProject sin ninguna configuraci\u00f3n o m\u00f3dulos adicionales en Apache (como mod_security, configurar manualmente un nombre de host, tener un VirtualHost alternativo). Tambi\u00e9n podr\u00eda afectar a otras instalaciones que no se preocuparon de arreglar los encabezados HOST/X-Fordered-Host. La versi\u00f3n 14.3.0 incluye protecciones m\u00e1s s\u00f3lidas para el nombre de host desde la aplicaci\u00f3n utilizando el middleware HostAuthorization de Rails para rechazar cualquier solicitud con un nombre de host que no coincida con el configurado. Adem\u00e1s, ahora se garantiza que todos los enlaces generados por la aplicaci\u00f3n utilicen el nombre de host integrado. Los usuarios que no puedan actualizar inmediatamente pueden usar mod_security para Apache2 o arreglar manualmente los encabezados Host y X-Forwarded-Host en su aplicaci\u00f3n de proxy antes de llegar al servidor de aplicaciones de OpenProject. Alternativamente, pueden aplicar manualmente el parche para optar por las protecciones del encabezado del host en versiones anteriores de OpenProject."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-601"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-601"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:openproject:openproject:*:*:*:*:*:*:*:*", "versionEndExcluding": "14.3.0", "matchCriteriaId": "B8DD5240-5B99-4F0D-8DE1-05F110DF2BAD"}]}]}], "references": [{"url": "https://github.com/opf/openproject/security/advisories/GHSA-g92v-vrq6-4fpw", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/user-attachments/files/16371759/host-protection.patch", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://www.openproject.org/docs/release-notes/14-3-0", "source": "security-advisories@github.com", "tags": ["Release Notes"]}], "techniques": [{"techniqueID": "T1046", "comment": "CVE-2024-41801 - This technique involves Redirecting the output of an executable or a shell. An attacker can use this technique to redirect a user to a malicious website to initiate a phishing attack."}, {"techniqueID": "T1505", "comment": "CVE-2024-41801 - This technique involves Using OS commands for code execution with redirects. An attacker can use this technique to execute OS commands using the HOST header vulnerability."}, {"techniqueID": "T1190", "comment": "CVE-2024-41801 - This technique involves Phishing as a penetration testing technique using the forged HOST header in the default configuration of packaged installations and using the 'Login required' setting."}], "stix_bundle": {"stix-bundle": {"generator-id": "https://example.com", "validity-period": {"start": "2024-07-25T17:15:11.423", "end": "2024-08-26T16:35:49.930"}, "objects": [{"type": "vulnerability", "id": "CVE-2024-41801", "created_by_ref": "org.cve.type.cve.CVEType", ".modified": "2024-08-26T16:35:49.930", "description": "CVE-2024-41801: OpenProject is open source project management software. Prior to version 14.3.0, using a forged HOST header in the default configuration of packaged installations and using the 'Login required' setting, an attacker could redirect to a remote host to initiate a phishing attack against an OpenProject user's account.", "severity": "MEDIUM", "base_score": 6.1, "references": [{"href": "https://github.com/user-attachments/files/16371759/host-protection.patch", "type": "fix", "description": "Host protection patch"}, {"href": "https://www.openproject.org/docs/release-notes/14-3-0", "type": "vulnerability-disclosure", "description": "OpenProject 14.3.0 release notes"}, {"href": "https://github.com/opf/openproject/security/advisories/GHSA-g92v-vrq6-4fpw", "type": "vulnerability-disclosure", "description": "OpenProject advisory"}]}], "relationships": [{"id": "relationship-1", "type": "object-object", "source_ref": "CVE-2024-41801", "target_ref": "T1046", "relationship_type": "uses"}, {"id": "relationship-2", "type": "object-object", "source_ref": "CVE-2024-41801", "target_ref": "T1505", "relationship_type": "uses"}, {"id": "relationship-3", "type": "object-object", "source_ref": "CVE-2024-41801", "target_ref": "T1190", "relationship_type": "uses"}]}}, "technical_analysis": {"Introduction": "CVE-2024-41801 is a medium-severity vulnerability in OpenProject that allows an attacker to redirect a user to a malicious website to initiate a phishing attack. This vulnerability occurs when a forged HOST header is used in the default configuration of packaged installations and the 'Login required' setting is enabled.", "Impact and Scope": {"rvss_score": "6.1", "attack_vector": "NETWORK", "attack_complexity": "LOW"}, "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1046, T1505, and T1190.", "Technical Details": "The vulnerability occurs when a forged HOST header is used in the default configuration of packaged installations and the 'Login required' setting is enabled.", "Detection": "Detection for this vulnerability involves verifying if the HOST and X-Forwarded-Host headers are properly secured.", "Mitigation": "Mitigation involves using mod_security for Apache2 or manually fixing the HOST and X-Forwarded-Host headers in the proxying application before reaching the application server.", "Conclusion": "This vulnerability is a medium-severity issue that requires immediate attention to prevent potential phishing attacks."}, "executive_analysis": {"Overview": "CVE-2024-41801 is a vulnerability in OpenProject that allows an attacker to redirect a user to a malicious website to initiate a phishing attack.", "Business Impact": "This vulnerability can result in the theft of sensitive data and the compromise of business-sensitive information.", "Technical Impact": "This vulnerability can be used to launch a phishing attack against an OpenProject user's account.", "Mitigation Strategies": "To mitigate this vulnerability, use mod_security for Apache2 or manually fix the HOST and X-Forwarded-Host headers in the proxying application before reaching the application server.", "Recommendations": "Upgrade to OpenProject 14.3.0 or apply the host protection patch.", "Conclusions": "This vulnerability is a serious issue that requires immediate attention to prevent potential phishing attacks."}}