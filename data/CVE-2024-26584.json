{"id": "CVE-2024-26584", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-02-21T15:15:09.420", "lastModified": "2024-05-25T15:15:08.847", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: tls: handle backlogging of crypto requests\n\nSince we're setting the CRYPTO_TFM_REQ_MAY_BACKLOG flag on our\nrequests to the crypto API, crypto_aead_{encrypt,decrypt} can return\n -EBUSY instead of -EINPROGRESS in valid situations. For example, when\nthe cryptd queue for AESNI is full (easy to trigger with an\nartificially low cryptd.cryptd_max_cpu_qlen), requests will be enqueued\nto the backlog but still processed. In that case, the async callback\nwill also be called twice: first with err == -EINPROGRESS, which it\nseems we can just ignore, then with err == 0.\n\nCompared to Sabrina's original patch this version uses the new\ntls_*crypt_async_wait() helpers and converts the EBUSY to\nEINPROGRESS to avoid having to modify all the error handling\npaths. The handling is identical."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net: tls: manejar el retraso de solicitudes criptogr\u00e1ficas Dado que estamos configurando el indicador CRYPTO_TFM_REQ_MAY_BACKLOG en nuestras solicitudes a la API criptogr\u00e1fica, crypto_aead_{encrypt,decrypt} puede devolver -EBUSY en lugar de - EINPROGRESS en situaciones v\u00e1lidas. Por ejemplo, cuando la cola cryptd para AESNI est\u00e1 llena (f\u00e1cil de activar con un cryptd.cryptd_max_cpu_qlen artificialmente bajo), las solicitudes se pondr\u00e1n en cola en el trabajo pendiente, pero a\u00fan as\u00ed se procesar\u00e1n. En ese caso, la devoluci\u00f3n de llamada as\u00edncrona tambi\u00e9n se llamar\u00e1 dos veces: primero con err == -EINPROGRESS, que parece que podemos ignorar, luego con err == 0. En comparaci\u00f3n con el parche original de Sabrina, esta versi\u00f3n usa el nuevo tls_*crypt_async_wait( ) ayuda y convierte EBUSY a EINPROGRESS para evitar tener que modificar todas las rutas de manejo de errores. El manejo es id\u00e9ntico."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-755"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.16.0", "versionEndExcluding": "6.1.84", "matchCriteriaId": "6F1F2625-29D5-4FED-B7F5-6087227ABCB3"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2.0", "versionEndExcluding": "6.6.18", "matchCriteriaId": "A5CC150E-F35C-4CF7-ADF5-422D32C511C2"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7.0", "versionEndExcluding": "6.7.6", "matchCriteriaId": "0C8D1FAD-4D5D-4A25-B058-2AD15082710E"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/13eca403876bbea3716e82cdfe6f1e6febb38754", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/3ade391adc584f17b5570fd205de3ad029090368", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8590541473188741055d27b955db0777569438e3", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/ab6397f072e5097f267abf5cb08a8004e6b17694", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/cd1bbca03f3c1d845ce274c0d0a66de8e5929f72", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1190 - Exploit PUBLIC-FACING APPLICATION", "comment": "CVE-2024-26584 - Linux Kernel TLS Crypto Request Handling Vulnerability - Attackers can exploit this vulnerability to execute arbitrary code on Linux systems by sending specially crafted TLS packets."}, {"techniqueID": "T1027 - Remote Services", "comment": "CVE-2024-26584 - Linux Kernel TLS Crypto Request Handling Vulnerability - An attacker can establish a remote connection to a vulnerable Linux system and execute code on it."}, {"techniqueID": "T1210 - Exploitation of Remote Services", "comment": "CVE-2024-26584 - Linux Kernel TLS Crypto Request Handling Vulnerability - An attacker can exploit this vulnerability to execute arbitrary code on Linux systems by sending specially crafted TLS packets."}, {"techniqueID": "T1563.005 - Command and Control - Application Layer", "comment": "CVE-2024-26584 - Linux Kernel TLS Crypto Request Handling Vulnerability - An attacker can use this vulnerability to establish a command and control channel with the compromised system."}, {"techniqueID": "T1497 - Audio/Video Encoding", "comment": "CVE-2024-26584 - Linux Kernel TLS Crypto Request Handling Vulnerability - An attacker can use this vulnerability to inject malicious audio/video data into a Linux system."}], "technical_analysis": {"Introduction": "The CVE-2024-26584 vulnerability is a Linux kernel vulnerability that allows an attacker to execute arbitrary code on Linux systems by sending specially crafted TLS packets.", "Impact and Scope": {"CVSS": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "Score": "5.5", "Attack Vector": "LOCAL"}, "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190, T1027, T1210, T1563.005, and T1497.", "Technical Details": "The vulnerability is due to the way the Linux kernel handles TLS crypto requests. An attacker can send a specially crafted TLS packet that triggers the vulnerability, allowing them to execute arbitrary code on the system.", "Detection": "The vulnerability can be detected by monitoring system calls and network traffic.", "Mitigation": "The vulnerability can be mitigated by updating the Linux kernel to a version that is not affected by the vulnerability.", "Conclusion": "The CVE-2024-26584 vulnerability is a serious vulnerability that allows an attacker to execute arbitrary code on Linux systems. It is highly recommended that Linux administrators update their systems to a version that is not affected by the vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-26584 vulnerability is a critical vulnerability in the Linux kernel that allows an attacker to execute arbitrary code on Linux systems.", "Business Impact": "The vulnerability can have a significant business impact if not addressed promptly.", "Technical Impact": "The vulnerability can allow an attacker to gain unauthorized access to sensitive data and systems.", "Mitigation Strategies": "The mitigation strategies are to update the Linux kernel to a version that is not affected by the vulnerability and to implement additional security measures such as network segmentation and access controls.", "Recommendations": "It is recommended that Linux administrators update their systems to a version that is not affected by the vulnerability and implement additional security measures.", "Conclusions": "The CVE-2024-26584 vulnerability is a critical vulnerability that requires immediate attention and action. It is highly recommended that Linux administrators take immediate action to mitigate the vulnerability."}}