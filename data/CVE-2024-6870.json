{"id": "CVE-2024-6870", "sourceIdentifier": "security@wordfence.com", "published": "2024-08-22T10:15:05.620", "lastModified": "2024-08-22T12:48:02.790", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Responsive Lightbox & Gallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting via file uploads in all versions up to, and including, 2.4.7 due to insufficient input sanitization and output escaping affecting the rl_upload_image AJAX endpoint. This makes it possible for authenticated attackers, with Author-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses the 3gp2 file."}, {"lang": "es", "value": "El complemento Responsive Lightbox &amp; Gallery para WordPress es vulnerable a Cross-Site Scripting Almacenado a trav\u00e9s de la carga de archivos en todas las versiones hasta la 2.4.7 incluida debido a una desinfecci\u00f3n de entrada insuficiente y un escape de salida que afecta el endpoint rl_upload_image AJAX. Esto hace posible que atacantes autenticados, con acceso de nivel de autor y superior, inyecten scripts web arbitrarios en p\u00e1ginas que se ejecutar\u00e1n cada vez que un usuario acceda al archivo 3gp2."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.1, "impactScore": 2.7}]}, "weaknesses": [{"source": "security@wordfence.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "references": [{"url": "https://plugins.trac.wordpress.org/browser/responsive-lightbox/tags/2.4.7/includes/class-remote-library.php#L261", "source": "security@wordfence.com"}, {"url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3137531%40responsive-lightbox&new=3137531%40responsive-lightbox&sfp_email=&sfph_mail=", "source": "security@wordfence.com"}, {"url": "https://wordpress.org/plugins/responsive-lightbox/#developers", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/e4d55309-d178-4b3d-9de6-2cf2769b76fe?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-6870: This stored cross-site scripting vulnerability in the Responsive Lightbox & Gallery plugin for WordPress can be exploited by an authenticated attacker with Author-level access or above to inject arbitrary web scripts that will execute whenever a user accesses a file. A remediation is to properly sanitize and escape user input data."}, {"techniqueID": "T1191", "comment": "CVE-2024-6870: This vulnerability also exhibits a lack of input validation and output escaping. An attacker with author-level access or above can inject malicious script tags in file names, which can be executed by unsuspecting users accessing the files. Applying strict input validation and output escaping can help mitigate this vulnerability."}, {"techniqueID": "T1538", "comment": "CVE-2024-6870: The vulnerability can also be exploited by uploading malicious files, which can be executed by users with lower privileges. Implementing strict file permissions and validating file types can help prevent this exploitation."}, {"techniqueID": "T1059", "comment": "CVE-2024-6870: This vulnerability can be used for cross-site scripting (XSS) attacks. Implementing CSP policies and validating user input data can help prevent XSS attacks."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "vulnerability--5c8f34a1-9ab4-4c78-b94b-2c6e6e4a5c3f", "name": "CVE-2024-6870 - Stored Cross-Site Scripting in Responsive Lightbox & Gallery Plugin", "description": "The Responsive Lightbox & Gallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting via file uploads in all versions up to, and including, 2.4.7 due to insufficient input sanitization and output escaping affecting the rl_upload_image AJAX endpoint.", "description_type": "definition", "created_by": null, "created": "2024-08-22T10:15:05.620", "modified": "2024-08-22T12:48:02.790", "labels": ["vulnerability", "cve"]}, {"type": "campaign", "id": "campaign--cf3e5f51-4a34-4e6f-b21a-d07e22f5e01c", "name": "AWS: CVE-2024-6870 Stored Cross-Site Scripting", "description": "A vulnerability in the Responsive Lightbox & Gallery plugin for WordPress has been discovered.", "description_type": "definition", "created_by": null, "created": "2024-08-22T10:15:05.620", "modified": "2024-08-22T12:48:02.790", "labels": ["campaign", "cve"]}, {"type": "intrusion-set", "id": "intrusion-set--c6a7f86c-d3da-432d-85f5-c5f5af05d0e3", "name": "Author-Low", "description": "An attacker with Author-level access or above can exploit this vulnerability.", "description_type": "definition", "created_by": null, "created": "2024-08-22T10:15:05.620", "modified": "2024-08-22T12:48:02.790", "labels": ["author", "cve"]}, {"type": "indicator", "id": "indicator--01f2ee45-1c64-4097-8e5f-6b4d5f8d5aaa", "name": "Responsive Lightbox & Gallery Plugin Stored Cross-Site Scripting Indicator", "description": "An indicator of the Responsive Lightbox & Gallery plugin stored cross-site scripting vulnerability.", "description_type": "definition", "created_by": null, "created": "2024-08-22T10:15:05.620", "modified": "2024-08-22T12:48:02.790", "labels": ["indicator", "cve"]}], "incomings": [{"type": "has-member", "id": "campaign--cf3e5f51-4a34-4e6f-b21a-d07e22f5e01c", "relationship": "has-member", "object": "vulnerability--5c8f34a1-9ab4-4c78-b94b-2c6e6e4a5c3f"}], "outgoings": [{"type": "has-member", "id": "intrusion-set--c6a7f86c-d3da-432d-85f5-c5f5af05d0e3", "relationship": "has-member", "object": "vulnerability--5c8f34a1-9ab4-4c78-b94b-2c6e6e4a5c3f"}]}, "technical_analysis": {"Introduction": "The Responsive Lightbox & Gallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting via file uploads in all versions up to, and including, 2.4.7 due to insufficient input sanitization and output escaping affecting the rl_upload_image AJAX endpoint.", "Impact and Scope": "The vulnerability has an attack vector of NETWORK, an attack complexity of LOW, requires privileges of LOW, does not require user interaction, and has an impact of CONFIDENTIALITY and INTEGRITY.", "Related MITRE ATT&CK Techniques": "T1190, T1191, T1538, and T1059 are the related MITRE ATT&CK techniques.", "Technical Details": "The vulnerability is due to the lack of input validation and output escaping in the rl_upload_image AJAX endpoint, allowing an attacker to inject malicious script tags in file names. The rl_upload_image AJAX endpoint isulnerable to Stored Cross-Site Scripting.", "Detection": "Detection can be performed by looking for suspicious file uploads and executions, and applying content security policies to validate user input data.", "Mitigation": "Mitigation strategies include applying strict input validation and output escaping, implementing CSP policies, and restricting file permissions and types.", "Conclusion": "In conclusion, the Responsive Lightbox & Gallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting via file uploads, and applying remediation strategies and mitigation techniques can help prevent exploitation."}, "executive_analysis": {"Overview": "The Responsive Lightbox & Gallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting via file uploads in all versions up to, and including, 2.4.7 due to insufficient input sanitization and output escaping affecting the rl_upload_image AJAX endpoint.", "Business Impact": "The business impact of this vulnerability is the potential compromise of sensitive data and unauthorized access to files.", "Technical Impact": "The technical impact is the potential for cross-site scripting attacks and unauthorized file access.", "Mitigation Strategies": "Implementing strict input validation and output escaping, enforcing CSP policies, and restricting file permissions and types can help mitigate this vulnerability.", "Recommendations": "Recommendations include updating to the latest version of the plugin, implementing robust security measures, and conducting regular security audits and testing.", "Conclusions": "In conclusion, it is essential to take immediate action to remediate and mitigate the vulnerability in the Responsive Lightbox & Gallery plugin for WordPress to prevent exploitation."}}