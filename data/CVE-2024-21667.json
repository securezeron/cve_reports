{"id": "CVE-2024-21667", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-11T01:15:45.810", "lastModified": "2024-01-18T13:12:45.593", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "pimcore/customer-data-framework is the Customer Management Framework for management of customer data within Pimcore. An authenticated and unauthorized user can access the GDPR data extraction feature and query over the information returned, leading to customer data exposure. Permissions are not enforced when reaching the `/admin/customermanagementframework/gdpr-data/search-data-objects` endpoint allowing an authenticated user without the permissions to access the endpoint and query the data available there. An unauthorized user can access PII data from customers. This vulnerability has been patched in version 4.0.6.\n"}, {"lang": "es", "value": "pimcore/customer-data-framework es el Customer Management Framework para la gesti\u00f3n de datos de clientes dentro de Pimcore. Un usuario autenticado y no autorizado puede acceder a la funci\u00f3n de extracci\u00f3n de datos del RGPD y consultar la informaci\u00f3n devuelta, lo que lleva a la exposici\u00f3n de los datos del cliente. Los permisos no se aplican al llegar al endpoint `/admin/customermanagementframework/gdpr-data/search-data-objects`, lo que permite a un usuario autenticado sin permisos acceder al endpoint y consultar los datos disponibles all\u00ed. Un usuario no autorizado puede acceder a los datos PII de los clientes. Esta vulnerabilidad ha sido parcheada en la versi\u00f3n 4.0.6."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-284"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:pimcore:customer_management_framework:*:*:*:*:*:pimcore:*:*", "versionEndExcluding": "4.0.6", "matchCriteriaId": "09473711-86C6-485C-B865-015EEF9172BE"}]}]}], "references": [{"url": "https://github.com/pimcore/customer-data-framework/blob/b4af625ef327c58d05ef7cdf145fa749d2d4195e/src/Controller/Admin/GDPRDataController.php#L38", "source": "security-advisories@github.com", "tags": ["Issue Tracking"]}, {"url": "https://github.com/pimcore/customer-data-framework/commit/6c34515be2ba39dceee7da07a1abf246309ccd77", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/pimcore/customer-data-framework/security/advisories/GHSA-g273-wppx-82w4", "source": "security-advisories@github.com", "tags": ["Exploit", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1133", "comment": " CVE-2024-21667 - An attacker may use this vulnerability to access customer data and extract PII information without proper permissions. To defend against this, ensure that permissions are properly configured and enforced."}, {"techniqueID": "T1033", "comment": " CVE-2024-21667 - An attacker may use this vulnerability to exploit the GDPR data extraction feature and access sensitive customer data. To defend against this, restrict access to the feature and implement proper access controls."}, {"techniqueID": "T1190", "comment": " CVE-2024-21667 - An attacker may use this vulnerability to conduct reconnaissance on a target system and extract sensitive customer data. To defend against this, implement encryption and access controls on sensitive data."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle--cve-2024-21667", "created_by_ref": "identification--security-center", "created": "2024-01-11T01:15:45.810", "modified": "2024-01-18T13:12:45.593", "generated_by_ref": "identity--default", "handling": {" producer": "pimcore", "definition": "security-advisories@github.com"}, "objects": [{"type": "vulnerability", "spec_version": "2.1", "id": "vulnerability--cve-2024-21667", "created_by_ref": "identification--security-center", "created": "2024-01-11T01:15:45.810", "modified": "2024-01-18T13:12:45.593", "attributes": {"Name": "CVE-2024-21667", "Summary": "Pimcore Customer Management Framework allows unauthorized access to GDPR data extraction feature", "Description": "An authenticated and unauthorized user can access the GDPR data extraction feature and query over the information returned, leading to customer data exposure.", "CVSSv3 Severity": "MEDIUM", "CVSSv3 VectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"}, "events": [{"type": "created", "time": "2024-01-11T01:15:45.810", "ref": "identification--security-center"}]}, {"type": "attack_pattern", "spec_version": "2.1", "id": "attack-pattern--t1133", "created_by_ref": "identification--security-center", "created": "2024-01-11T01:15:45.810", "modified": "2024-01-18T13:12:45.593", "attributes": {"Name": "Credentials in File", "Description": "Retrieve the contents of files that are not properly secured, potentially revealing sensitive data or credentials."}}, {"type": "course_of_action", "spec_version": "2.1", "id": "course-of-action--fix-vulnerability", "created_by_ref": "identification--security-center", "created": "2024-01-11T01:15:45.810", "modified": "2024-01-18T13:12:45.593", "attributes": {"Name": "Fix Vulnerability", "Description": "Patch the vulnerability in the Pimcore Customer Management Framework."}}, {"type": "indicator", "spec_version": "2.1", "id": "indicator--sensitive-data", "created_by_ref": "identification--security-center", "created": "2024-01-11T01:15:45.810", "modified": "2024-01-18T13:12:45.593", "attributes": {"Name": "Sensitive Data", "Description": "Data and information that is sensitive and should be protected."}}], "relationships": [{"type": "has-part", "object_ref": "vulnerability--cve-2024-21667"}, {"type": "part-of", "object_ref": "attack-pattern--t1133", "relationship": "uses"}, {"type": "part-of", "object_ref": "course-of-action--fix-vulnerability", "relationship": "fixes"}, {"type": "has-part", "object_ref": "indicator--sensitive-data"}]}, "technical_analysis": {"Introduction": "The CVE-2024-21667 vulnerability is a privilege escalation vulnerability in the Pimcore Customer Management Framework that allows authenticated users to access sensitive customer data.", "Impact and Scope": "This vulnerability is rated 6.5 on the CVSSv3 scale and has a base severity of MEDIUM.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1133, T1033, and T1190.", "Technical Details": "The vulnerability is due to improper permissions enforcement in the GDPR data extraction feature.", "Detection": "Detection methods include monitoring for unusual access patterns to the GDPR data extraction feature.", "Mitigation": "Mitigation strategies include configuring proper permissions and access controls, and implementing encryption on sensitive data.", "Conclusion": "In conclusion, the CVE-2024-21667 vulnerability is a medium-severity vulnerability that can allow authenticated users to access sensitive customer data."}, "executive_analysis": {"Overview": "The CVE-2024-21667 vulnerability is a significant vulnerability in the Pimcore Customer Management Framework that affects the GDPR data extraction feature.", "Business Impact": "This vulnerability can result in the exposure of sensitive customer data, which can have significant business implications.", "Technical Impact": "Technical impacts include the potential for unauthorized access to sensitive data and the potential for data breaches.", "Mitigation Strategies": "Mitigation strategies include implementing proper permissions and access controls, and conducting regular security audits.", "Recommendations": "Recommendations include prioritizing patching the vulnerability as soon as possible, and conducting regular security audits to detect and respond to potential breaches.", "Conclusions": "In conclusion, the CVE-2024-21667 vulnerability is a significant vulnerability that requires immediate attention and mitigation."}}