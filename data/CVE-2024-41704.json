{"id": "CVE-2024-41704", "sourceIdentifier": "cve@mitre.org", "published": "2024-07-22T05:15:03.537", "lastModified": "2024-08-22T21:15:17.050", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "LibreChat through 0.7.4-rc1 does not validate the normalized pathnames of images."}, {"lang": "es", "value": " LibreChat hasta 0.7.4-rc1 no valida las rutas de acceso normalizadas de las im\u00e1genes. (El trabajo en una versi\u00f3n fija comenz\u00f3 en PR 3363.)"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:librechat:librechat:*:*:*:*:*:*:*:*", "versionEndIncluding": "0.7.3", "matchCriteriaId": "07976B79-F984-49AC-A56D-F3989BCB7916"}, {"vulnerable": true, "criteria": "cpe:2.3:a:librechat:librechat:0.7.4:rc1:*:*:*:*:*:*", "matchCriteriaId": "92F06C4A-1DE2-4DB8-B652-7E920751ABCF"}]}]}], "references": [{"url": "https://github.com/danny-avila/LibreChat/discussions/3315#discussioncomment-10074284", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://github.com/danny-avila/LibreChat/pull/3363", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://github.com/realestate-com-au/vulnerability-disclosures/blob/main/LibreChat/CVE-2024-41704.md", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-41704 - The vulnerability in LibreChat allows for potential image file inclusion attacks. This technique is relevant because it demonstrates the importance of validating user input in the context of web applications."}, {"techniqueID": "T1438", "comment": "CVE-2024-41704 - The vulnerability in LibreChat allows for potential arbitrary file inclusion and potential remote code execution. This technique is relevant because it highlights the importance of ensuring user input is properly sanitized."}, {"techniqueID": "T1048", "comment": "CVE-2024-41704 - The vulnerability in LibreChat allows for potential file inclusion attacks, which can lead to arbitrary code execution. This technique is relevant because it emphasizes the need for proper input validation and sanitization."}], "stix_bundle": {"Bundle": {"type": "bundle", "created_by_ref": "https://github.com/danny-avila/LibreChat", "created": "2024-07-22T05:15:03.537", "modified": "2024-08-22T21:15:17.050", "objects": [{"type": "vulnerability", "id": "CVE-2024-41704", "name": "LibreChat Image File Inclusion Vulnerability", "description": [{"lang": "en", "value": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}], "cvss": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}, "impact": "HIGH", "exploitability": "HIGH", " threat_actor": "Unknown", "data_source": "cve@mitre.org", "published": "2024-07-22T05:15:03.537", "modified": "2024-08-22T21:15:17.050"}, {"type": "course-of-action", "id": "COA-1", "name": "Validate User Input", "description": [{"lang": "en", "value": "Validate user input to prevent malicious data from being processed."}], "mitigates": [{"id_ref": "CVE-2024-41704", "relationship": "mitigated_by"}]}, {"type": "course-of-action", "id": "COA-2", "name": "Sanitize User Input", "description": [{"lang": "en", "value": "Sanitize user input to prevent malicious data from being processed."}], "mitigates": [{"id_ref": "CVE-2024-41704", "relationship": "mitigated_by"}]}, {"type": " indicator", "id": "Indicator-1", "name": "HTTP Request Payload", "description": [{"lang": "en", "value": "Monitor HTTP request payloads for suspicious data."}], "detection": [{"id_ref": "COA-1", "relationship": "preceeds"}]}]}}, "technical_analysis": {"Introduction": "The LibreChat image file inclusion vulnerability allows an attacker to include arbitrary files in the request, which can lead to remote code execution.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).", "Related MITRE ATT&CK Techniques": "T1190, T1438, T1048", "Technical Details": "The vulnerability occurs due to a lack of validation of user input in the context of image file inclusion.", "Detection": "Monitor HTTP request payloads for suspicious data.", "Mitigation": "Validate user input and sanitize user input.", "Conclusion": "The LibreChat image file inclusion vulnerability highlights the importance of proper input validation and sanitization in web applications."}, "executive_analysis": {"Overview": "The LibreChat image file inclusion vulnerability is a critical weakness in the web application that can lead to remote code execution.", "Business Impact": "The vulnerability can compromise the confidentiality, integrity, and availability of sensitive data, leading to financial losses and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to bypass security controls and execute arbitrary code, potentially leading to persistent backdoors and escalated privileges.", "Mitigation Strategies": "Implement input validation and sanitization in the web application.", "Recommendations": "Prioritize remediation of the vulnerability, and implement additional security controls to detect and prevent future attacks.", "Conclusions": "The LibreChat image file inclusion vulnerability is a critical threat that must be addressed promptly to ensure the confidentiality, integrity, and availability of sensitive data."}}