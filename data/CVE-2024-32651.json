{"id": "CVE-2024-32651", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-26T00:15:08.550", "lastModified": "2024-06-07T17:15:50.990", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "changedetection.io is an open source web page change detection, website watcher, restock monitor and notification service. There is a Server Side Template Injection (SSTI) in Jinja2 that allows Remote Command Execution on the server host. Attackers can run any system command without any restriction and they could use a reverse shell. The impact is critical as the attacker can completely takeover the server machine. This can be reduced if changedetection is behind a login page, but this isn't required by the application (not by default and not enforced)."}, {"lang": "es", "value": "changetection.io es un servicio de detecci\u00f3n de cambios de p\u00e1ginas web, seguimiento de sitios web, monitor de reabastecimiento y notificaci\u00f3n de c\u00f3digo abierto. Hay una inyecci\u00f3n de plantilla del lado del servidor (SSTI) en Jinja2 que permite la ejecuci\u00f3n remota de comandos en el host del servidor. Los atacantes pueden ejecutar cualquier comando del sistema sin ninguna restricci\u00f3n y podr\u00edan usar un shell inverso. El impacto es cr\u00edtico ya que el atacante puede apoderarse completamente de la m\u00e1quina servidor. Esto se puede reducir si la detecci\u00f3n de cambios est\u00e1 detr\u00e1s de una p\u00e1gina de inicio de sesi\u00f3n, pero la aplicaci\u00f3n no lo requiere (no es de forma predeterminada ni obligatorio)."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1336"}]}], "references": [{"url": "https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/", "source": "security-advisories@github.com"}, {"url": "https://github.com/dgtlmoon/changedetection.io/releases/tag/0.45.21", "source": "security-advisories@github.com"}, {"url": "https://github.com/dgtlmoon/changedetection.io/security/advisories/GHSA-4r7v-whpg-8rx3", "source": "security-advisories@github.com"}, {"url": "https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-32651 - Server-side template injection (SSTI) vulnerability in Jinja2 allows remote command execution, enabling post-exploitation activities such as data exfiltration, lateral movement, and persistence. Defend against this by validating and sanitizing user input, using secure templates, and regularly updating software dependencies."}, {"techniqueID": "T1212", "comment": "CVE-2024-32651 - Attackers can use the SSTI vulnerability to inject arbitrary commands, enabling remote execution of system commands and potential takeover of the server. Defend against this by restricting access to sensitive areas, using role-based access control, and implementing logging and auditing."}, {"techniqueID": "T1204", "comment": "CVE-2024-32651 - The vulnerability allows attackers to execute system commands remotely, enabling data exfiltration, persistence, and potential takeover of the server. Defend against this by implementing input validation and sanitization, using secure coding practices, and regularly updating software dependencies."}], "stix_bundle": {"type": "bundle", "objects": [{"type": "vulnerability", "id": "CVE-2024-32651", "created_by_ref": "https://example.com/ stix-users", "modified": "2024-04-26T00:15:08.550", "name": "changedetection.io Jinja2 SSTI Vulnerability", "description": "Server-side template injection (SSTI) vulnerability in Jinja2 allows remote command execution, enabling post-exploitation activities", "identification": {"v2v:version": "3.1", "v2v:vector_string": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "v2v:attack_vector": "NETWORK", "v2v:attack_complexity": "LOW", "v2v:privileges_required": "NONE", "v2v:user_interaction": "NONE", "v2v:scope": "CHANGED", "v2v:confidentiality_impact": "HIGH", "v2v:integrity_impact": "HIGH", "v2v:availability_impact": "HIGH", "v2v:base_score": 10.0, "v2v:base_severity": "CRITICAL"}, "references": [{"reference_data_group_ref": "https://example.com/ stix-users", "url": "https://blog.hacktivesecurity.com/index.php/2024/05/08/cve-2024-32651-server-side-template-injection-changedetection-io/"}, {"reference_data_group_ref": "https://example.com/ stix-users", "url": "https://github.com/dgtlmoon/changedetection.io/releases/tag/0.45.21"}, {"reference_data_group_ref": "https://example.com/ stix-users", "url": "https://github.com/dgtlmoon/changedetection.io/security/advisories/GHSA-4r7v-whpg-8rx3"}, {"reference_data_group_ref": "https://example.com/ stix-users", "url": "https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2"}], "published": "2024-04-26T00:15:08.550", "analysis": {"cwe": [{"cwe_id": "1336"}]}}, {"type": "course-of-action", "id": "coa-01", "created_by_ref": "https://example.com/ stix-users", "name": "Validate and sanitize user input", "description": "Implement input validation and sanitization to prevent SSTI attacks", "related_tactics": [{"id_ref": "T1190"}]}, {"type": "course-of-action", "id": "coa-02", "created_by_ref": "https://example.com/ stix-users", "name": "Use secure templates", "description": "Use secure templates to prevent SSTI attacks", "related_tactics": [{"id_ref": "T1190"}]}, {"type": "course-of-action", "id": "coa-03", "created_by_ref": "https://example.com/ stix-users", "name": "Regularly update software dependencies", "description": "Regularly update software dependencies to prevent exploitation of known vulnerabilities", "related_tactics": [{"id_ref": "T1204"}]}]}, "technical_analysis": {"Introduction": "The vulnerability exists in the Jinja2 template engine used by changedetection.io, allowing attackers to execute arbitrary system commands.", "Impact and Scope": "The vulnerability has a CVSS score of 10.0, indicating a critical severity. It has a network attack vector and can be exploited with low complexity.", "Related MITRE ATT&CK Techniques": "T1190, T1212, T1204", "Technical Details": "The vulnerability allows attackers to inject arbitrary commands, enabling remote execution of system commands.", "Detection": "Detection methods include monitoring for suspicious system commands and tracking changes to system files.", "Mitigation": "Mitigation strategies include implementing input validation and sanitization, using secure templates, and regularly updating software dependencies.", "Conclusion": "The vulnerability poses a critical risk to affected systems and should be addressed promptly."}, "executive_analysis": {"Overview": "The vulnerability in changedetection.io presents a critical risk to affected systems.", "Business Impact": "The vulnerability can lead to data exfiltration, persistence, and potential takeover of the server, resulting in significant business disruption and financial loss.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary system commands, enabling remote execution of system commands and potential takeover of the server.", "Mitigation Strategies": "Implement input validation and sanitization, use secure templates, and regularly update software dependencies.", "Recommendations": "Recommendations include prioritizing remediation of the vulnerability and implementing additional security controls to mitigate the risk.", "Conclusions": "The vulnerability presents a critical risk to affected systems and should be addressed promptly."}}