{"id": "CVE-2024-42126", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-30T08:15:04.743", "lastModified": "2024-08-19T05:15:06.927", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc: Avoid nmi_enter/nmi_exit in real mode interrupt.\n\nnmi_enter()/nmi_exit() touches per cpu variables which can lead to kernel\ncrash when invoked during real mode interrupt handling (e.g. early HMI/MCE\ninterrupt handler) if percpu allocation comes from vmalloc area.\n\nEarly HMI/MCE handlers are called through DEFINE_INTERRUPT_HANDLER_NMI()\nwrapper which invokes nmi_enter/nmi_exit calls. We don't see any issue when\npercpu allocation is from the embedded first chunk. However with\nCONFIG_NEED_PER_CPU_PAGE_FIRST_CHUNK enabled there are chances where percpu\nallocation can come from the vmalloc area.\n\nWith kernel command line \"percpu_alloc=page\" we can force percpu allocation\nto come from vmalloc area and can see kernel crash in machine_check_early:\n\n[    1.215714] NIP [c000000000e49eb4] rcu_nmi_enter+0x24/0x110\n[    1.215717] LR [c0000000000461a0] machine_check_early+0xf0/0x2c0\n[    1.215719] --- interrupt: 200\n[    1.215720] [c000000fffd73180] [0000000000000000] 0x0 (unreliable)\n[    1.215722] [c000000fffd731b0] [0000000000000000] 0x0\n[    1.215724] [c000000fffd73210] [c000000000008364] machine_check_early_common+0x134/0x1f8\n\nFix this by avoiding use of nmi_enter()/nmi_exit() in real mode if percpu\nfirst chunk is not embedded."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: powerpc: Evite nmi_enter/nmi_exit en interrupci\u00f3n en modo real. nmi_enter()/nmi_exit() toca variables por CPU que pueden provocar un fallo del kernel cuando se invoca durante el manejo de interrupciones en modo real (por ejemplo, el controlador de interrupciones HMI/MCE temprano) si la asignaci\u00f3n de percpu proviene del \u00e1rea vmalloc. Los primeros controladores HMI/MCE se llaman a trav\u00e9s del contenedor DEFINE_INTERRUPT_HANDLER_NMI() que invoca llamadas nmi_enter/nmi_exit. No vemos ning\u00fan problema cuando la asignaci\u00f3n de percpu proviene del primer fragmento integrado. Sin embargo, con CONFIG_NEED_PER_CPU_PAGE_FIRST_CHUNK habilitado, hay posibilidades de que la asignaci\u00f3n de percpu pueda provenir del \u00e1rea vmalloc. Con la l\u00ednea de comando del kernel \"percpu_alloc=page\" podemos forzar que la asignaci\u00f3n de percpu provenga del \u00e1rea vmalloc y podemos ver el fallo del kernel en machine_check_early: [1.215714] NIP [c000000000e49eb4] rcu_nmi_enter+0x24/0x110 [1.215717] LR [c0000000000461a0] check_early+0xf0/ 0x2c0 [1.215719] --- interrupci\u00f3n: 200 [ 1.215720] [c000000fffd73180] [0000000000000000] 0x0 (no confiable) [ 1.215722] [c000000fffd731b0] 000] 0x0 [ 1.215724] [c000000fffd73210] [c000000000008364] machine_check_early_common+0x134/0x1f8 Solucionar esto mediante evitando el uso de nmi_enter()/nmi_exit() en modo real si el primer fragmento de percpu no est\u00e1 incrustado."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0db880fc865ffb522141ced4bfa66c12ab1fbb70", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/0f37946c62c48a907625348cbc720a7a0c547d1e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/2c78c9411e685dbc9eac8c2845111b03501975b8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8d3f83dfb23674540c827a8d65fba20aa300b252", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e2afb26615adf6c3ceaaa7732aa839bcd587a057", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/fb6675db04c4b79883373edc578d5df7bbc84848", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1198", "comment": "CVE-2024-42126 - PowerPC Linux kernel NMI handling vulnerability can lead to kernel crashes. This can be exploited by attackers to gain privileged access, therefore, it is essential to patch impacted systems and implement proper network segmentation."}, {"techniqueID": "T1190", "comment": "CVE-2024-42126 - The vulnerability can be exploited by an attacker to achieve execution of arbitrary code, this is mitigated by patching the system and configuring it to prevent unwanted modifications."}, {"techniqueID": "T1499", "comment": "CVE-2024-42126 - PowerPC Linux kernel NMI handling vulnerability can be exploited by an attacker to achieve persistence, therefore it is essential to have a robust backup strategy and monitoring solution in place."}, {"techniqueID": "T1075", "comment": "CVE-2024-42126 - The vulnerability can be exploited by an attacker to achieve command and control communication, this is mitigated by patching the system and configuring it to prevent unwanted outbound connections."}], "stix_bundle": {"id": "https://example.com/STIX-Bundle-CVE-2024-42126", "version": "2.1", "type": "bundle", "objects": [{"id": "https://example.com/Vulnerability-CVE-2024-42126", "type": "vulnerability", "name": "CVE-2024-42126 - PowerPC Linux kernel NMI handling vulnerability", "description": "PowerPC Linux kernel NMI handling vulnerability can lead to kernel crashes.", "exploit_CVE_0": "https://example.com/Exploit-CVE-2024-42126"}, {"id": "https://example.com/Exploit-CVE-2024-42126", "type": "exploit", "name": "Exploit for CVE-2024-42126", "description": "Exploit to exploit PowerPC Linux kernel NMI handling vulnerability", "attack_techniques": [{"id": "https://example.com/Attack-Technique-T1198", "type": "attack-technique", "name": "T1198", "description": "Exploitation of PowerPC Linux kernel NMI handling vulnerability"}]}, {"id": "https://example.com/Attack-Technique-T1198", "type": "attack-technique", "name": "T1198", "description": "Exploitation of PowerPC Linux kernel NMI handling vulnerability"}, {"id": "https://example.com/Defense-Strategy-1", "type": "defense-strategy", "name": "Defense Strategy 1", "description": "Patch impacted systems and configure network segmentation", "mitigates": [{"id": "https://example.com/Attack-Technique-T1198", "type": "attack-technique", "name": "T1198"}]}], "relationships": [{"id": "https://example.com/Relationship-1", "type": "has-part", "object_ref": "https://example.com/Vulnerability-CVE-2024-42126", "object": "https://example.com/Exploit-CVE-2024-42126"}, {"id": "https://example.com/Relationship-2", "type": "uses", "object_ref": "https://example.com/Exploit-CVE-2024-42126", "object": "https://example.com/Attack-Technique-T1198"}, {"id": "https://example.com/Relationship-3", "type": "mitigates", "object_ref": "https://example.com/Attack-Technique-T1198", "object": "https://example.com/Defense-Strategy-1"}]}, "technical_analysis": {"Introduction": "The PowerPC Linux kernel NMI handling vulnerability (CVE-2024-42126) is a security weakness that can be exploited by attackers to gain privileged access.", "Impact and Scope": "The vulnerability can be exploited to gain execution of arbitrary code, persistence, and command and control communication.", "Related MITRE ATT&CK Techniques": "T1198, T1190, T1499, T1075", "Technical Details": "The vulnerability occurs in the Linux kernel NMI handling code and can be exploited by an attacker to execute arbitrary code, gain persistence, and achieve command and control communication.", "Detection": "Detection of this vulnerability is possible through network monitoring and system logging.", "Mitigation": "Patching the system, configuring network segmentation, and implementing a robust backup strategy are essential to mitigate this vulnerability.", "Conclusion": "In conclusion, the PowerPC Linux kernel NMI handling vulnerability is a serious security threat that requires immediate attention and action."}, "executive_analysis": {"Overview": "This vulnerability is a critical security issue that requires immediate action.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to unauthorized access to sensitive data and systems.", "Technical Impact": "The technical impact of this vulnerability is significant, as it can lead to persistence, command and control communication, and execution of arbitrary code.", "Mitigation Strategies": "Patch impacted systems, configure network segmentation, and implement a robust backup strategy.", "Recommendations": "Recommendations include patching impacted systems, configuring network segmentation, and implementing a robust backup strategy.", "Conclusions": "In conclusion, immediate action is required to mitigate this vulnerability and protect against potential attacks."}}