{"id": "CVE-2024-1789", "sourceIdentifier": "security@wordfence.com", "published": "2024-04-26T09:15:09.213", "lastModified": "2024-04-26T12:58:17.720", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The WP SMTP plugin for WordPress is vulnerable to SQL Injection via the 'search' parameter in versions 1.2 to 1.2.6 due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query.  This makes it possible for authenticated attackers, with administrator-level access and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database."}, {"lang": "es", "value": "El complemento WP SMTP para WordPress es vulnerable a la inyecci\u00f3n SQL a trav\u00e9s del par\u00e1metro 'b\u00fasqueda' en las versiones 1.2 a 1.2.6 debido a un escape insuficiente en el par\u00e1metro proporcionado por el usuario y a la falta de preparaci\u00f3n suficiente en la consulta SQL existente. Esto hace posible que atacantes autenticados, con acceso de nivel de administrador y superior, agreguen consultas SQL adicionales a consultas ya existentes que pueden usarse para extraer informaci\u00f3n confidencial de la base de datos."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}]}, "references": [{"url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3076663%40wp-smtp&new=3076663%40wp-smtp&sfp_email=&sfph_mail=", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/ee269bc7-2822-4a07-be91-6763c1cf6cf2?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-1789 - This vulnerability allows authenticated attackers to inject and execute arbitrary SQL queries, which can be used to extract sensitive information from the database. Defend against this by validating and sanitizing user input, and ensuring that all SQL queries are properly prepared and parameterized."}, {"techniqueID": "T1047", "comment": "CVE-2024-1789 - This vulnerability allows attackers to inject and execute arbitrary SQL queries, which can be used to extract sensitive information from the database. Defend against this by validating and sanitizing user input, and ensuring that all SQL queries are properly prepared and parameterized."}, {"techniqueID": "T1190", "comment": "CVE-2024-1789 - This vulnerability allows attackers to inject and execute arbitrary SQL queries, which can be used to extract sensitive information from the database. Defend against this by validating and sanitizing user input, and ensuring that all SQL queries are properly prepared and parameterized."}, {"techniqueID": "T1509", "comment": "CVE-2024-1789 - This vulnerability allows attackers to inject and execute arbitrary SQL queries, which can be used to extract sensitive information from the database. Defend against this by validating and sanitizing user input, and ensuring that all SQL queries are properly prepared and parameterized."}], "stix_bundle": {"type": "bundle", "std_sid": "bdae23a5-4ee3-45d9-a3ac-9bd8e4d2c8a5", "id": "https://example.com/stix/bundle/bdae23a5-4ee3-45d9-a3ac-9bd8e4d2c8a5", "created_by_ref": "https://example.com/stix/user/alice", "created": "2024-04-26T09:15:09.213", "modified": "2024-04-26T12:58:17.720", "objects": [{"type": "vulnerability", "id": "https://example.com/stix/vulnerability/st-75f5dab5-d5c1-4c92-b7f9-43e3f93c8d4a", "created_by_ref": "https://example.com/stix/user/alice", "created": "2024-04-26T09:15:09.213", "modified": "2024-04-26T12:58:17.720", "name": "CVE-2024-1789", "description": "The WP SMTP plugin for WordPress is vulnerable to SQL Injection via the 'search' parameter in versions 1.2 to 1.2.6 due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query.", "metrics": [{"type": "cvss", "score": 7.2}], "references": [{"id": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3076663%40wp-smtp&new=3076663%40wp-smtp&sfp_email=&sfph_mail=", "type": "change_set"}, {"id": "https://www.wordfence.com/threat-intel/vulnerabilities/id/ee269bc7-2822-4a07-be91-6763c1cf6cf2?source=cve", "type": "threat_intel_report"}]}, {"type": "course_of_action", "id": "https://example.com/stix/course_of_action/st-75f5dab5-d5c1-4c92-b7f9-43e3f93c8d4a", "created_by_ref": "https://example.com/stix/user/alice", "created": "2024-04-26T09:15:09.213", "modified": "2024-04-26T12:58:17.720", "name": " Defence Strategy", "description": " Validate and sanitize user input, ensure that all SQL queries are properly prepared and parameterized, and limit database access to authorized sources", "related_tactic": "https://example.com/stix/tactic/t-0003", "related_technique": "https://example.com/stix/technique/t-1059"}], "relationships": [{"type": "vulnerability-course_of_action", "id": "https://example.com/stix/relationship/st-75f5dab5-d5c1-4c92-b7f9-43e3f93c8d4a", "created_by_ref": "https://example.com/stix/user/alice", "created": "2024-04-26T09:15:09.213", "modified": "2024-04-26T12:58:17.720", "vulnerability_ref": "https://example.com/stix/vulnerability/st-75f5dab5-d5c1-4c92-b7f9-43e3f93c8d4a", "course_of_action_ref": "https://example.com/stix/course_of_action/st-75f5dab5-d5c1-4c92-b7f9-43e3f93c8d4a"}]}, "technical_analysis": {"Introduction": "The WP SMTP plugin for WordPress is vulnerable to SQL Injection due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query.", "Impact and Scope": "This vulnerability allows authenticated attackers to inject and execute arbitrary SQL queries, which can be used to extract sensitive information from the database.", "Related MITRE ATT&CK Techniques": ["T1059", "T1047", "T1190", "T1509"], "Technical Details": "The vulnerability is present in the 'search' parameter in the WP SMTP plugin for WordPress, which allows attackers to inject and execute arbitrary SQL queries.", "Detection": "Detection can be done by monitoring database queries and logging database access.", "Mitigation": "Defend against this vulnerability by validating and sanitizing user input, and ensuring that all SQL queries are properly prepared and parameterized.", "Conclusion": "The vulnerability in the WP SMTP plugin for WordPress allows attackers to extract sensitive information from the database. It is recommended to update to the latest version of the plugin and to follow defense strategies mentioned above."}, "executive_analysis": {"Overview": "The WP SMTP plugin for WordPress is vulnerable to SQL Injection due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query.", "Business Impact": "This vulnerability could allow attackers to extract sensitive business information, such as customer data, credit card information, and financial records.", "Technical Impact": "This vulnerability could allow attackers to gain unauthorized access to the database and extract sensitive information.", "Mitigation Strategies": "Update to the latest version of the plugin, validate and sanitize user input, and ensure that all SQL queries are properly prepared and parameterized.", "Recommendations": "Recommendation to executives is to immediately update to the latest version of the plugin and to review and strengthen their security controls.", "Conclusions": "In conclusion, the vulnerability in the WP SMTP plugin for WordPress is a serious security threat and immediate action is required to mitigate the risk."}}