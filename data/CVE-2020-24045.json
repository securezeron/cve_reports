{"id": "CVE-2020-24045", "sourceIdentifier": "cve@mitre.org", "published": "2020-09-17T17:15:15.677", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A sandbox escape issue was discovered in TitanHQ SpamTitan Gateway 7.07. It limits the admin user to a restricted shell, allowing execution of a small number of tools of the operating system. The restricted shell can be bypassed by presenting a fake vmware-tools ISO image to the guest virtual machine running SpamTitan Gateway. This ISO image should contain a valid Perl script at the vmware-freebsd-tools/vmware-tools-distrib/vmware-install.pl path. The fake ISO image will be mounted and the script wmware-install.pl will be executed with super-user privileges as soon as the hidden option to install VMware Tools is selected in the main menu of the restricted shell (option number 5). The contents of the script can be whatever the attacker wants, including a backdoor or similar."}, {"lang": "es", "value": "Se detect\u00f3 un problema de escape del sandbox en TitanHQ SpamTitan Gateway versi\u00f3n 7.07.&#xa0;Limita al usuario administrador a un shell restringido, permitiendo una ejecuci\u00f3n de un peque\u00f1o n\u00famero de herramientas del sistema operativo.&#xa0;El shell restringido puede ser omitido al presentar una imagen ISO vmware-tools falsa en la m\u00e1quina virtual invitada que ejecuta SpamTitan Gateway.&#xa0;Esta imagen ISO debe contener un script Perl v\u00e1lido en la ruta vmware-freebsd-tools/vmware-tools-distrib/vmware-install.pl.&#xa0;La imagen ISO falsa se montar\u00e1 y el script wmware-install.pl ser\u00e1 ejecutado con privilegios de superusuario tan pronto como se seleccione la opci\u00f3n oculta para instalar VMware Tools en el men\u00fa principal del shell restringido (opci\u00f3n n\u00famero 5).&#xa0;El contenido del script puede ser lo que quiera el atacante, incluyendo una puerta trasera o similar"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-345"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:titanhq:spamtitan:7.07:*:*:*:*:*:*:*", "matchCriteriaId": "237E0708-6807-472F-A18C-E72871D7C74D"}]}]}], "references": [{"url": "https://github.com/felmoltor", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://sensepost.com/blog/2020/clash-of-the-spamtitan/", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://twitter.com/felmoltor", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.titanhq.com/", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210 - Exploitation of Remote Services", "comment": "CVE-2020-24045 - The vulnerability allows an attacker to bypass the restricted shell and execute arbitrary code, which can be exploited by presenting a fake VMware ISO image to the guest virtual machine. This can be defended against by properly configuring and validating the VMware ISO images and restricting access to the system."}, {"techniqueID": "T1077 - Windows-Based Remote Services", "comment": "CVE-2020-24045 - The vulnerability is a sandbox escape issue that allows an attacker to execute arbitrary code on the system, which can be exploited by presenting a fake VMware ISO image to the guest virtual machine. This can be defended against by configuring and validating the VMware ISO images and restricting access to the system."}, {"techniqueID": "T1190 - Exploit Public-Facing Application", "comment": "CVE-2020-24045 - The vulnerability is a remote services vulnerability that allows an attacker to execute arbitrary code on the system, which can be exploited by presenting a fake VMware ISO image to the guest virtual machine. This can be defended against by configuring and validating the VMware ISO images and restricting access to the system."}], "stix_bundle": {"marking_DEFINITION": [], "assessment": {"objective": "To assess the vulnerability", "status": "Completed", "confidence": 0, "weakness": "CWE-345"}, "identity": {"schema_version": "2.1", "id": "https://example.com/cve-2020-24045.stix", "type": "bundle"}, "objects": [{"id": "https://example.com/cve-2020-24045", "type": "vulnerability", "created": "2020-09-17T17:15:15.677", "lastUpdated": "2021-07-21T11:39:23.747", "description": "A sandbox escape issue was discovered in TitanHQ SpamTitan Gateway 7.07.", "object_refs": ["https://example.com/cve-2020-24045"]}, {"id": "https://example.com/technique-t1210", "type": "attack_pattern", "techniques": ["https://example.com/technique-t1210"], "description": "T1210: Exploitation of Remote Services", "object_refs": ["https://example.com/cve-2020-24045"]}, {"id": "https://example.com/technique-t1077", "type": "attack_pattern", "techniques": ["https://example.com/technique-t1077"], "description": "T1077: Windows-Based Remote Services", "object_refs": ["https://example.com/cve-2020-24045"]}, {"id": "https://example.com/technique-t1190", "type": "attack_pattern", "techniques": ["https://example.com/technique-t1190"], "description": "T1190: Exploit Public-Facing Application", "object_refs": ["https://example.com/cve-2020-24045"]}], " relationships": [{"id": "https://example.com/cve-2020-24045-technique-t1210", "type": "related_to", "object_ids": ["https://example.com/cve-2020-24045", "https://example.com/technique-t1210"]}, {"id": "https://example.com/cve-2020-24045-technique-t1077", "type": "related_to", "object_ids": ["https://example.com/cve-2020-24045", "https://example.com/technique-t1077"]}, {"id": "https://example.com/cve-2020-24045-technique-t1190", "type": "related_to", "object_ids": ["https://example.com/cve-2020-24045", "https://example.com/technique-t1190"]}]}, "technical_analysis": {"Introduction": "CVE-2020-24045 is a sandbox escape issue in TitanHQ SpamTitan Gateway 7.07 that allows an attacker to execute arbitrary code on the system.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2, with a medium-high impact and a high severity. It affects the SpamTitan Gateway 7.07 and can be exploited through the presentation of a fake VMware ISO image.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1210: Exploitation of Remote Services, T1077: Windows-Based Remote Services, and T1190: Exploit Public-Facing Application.", "Technical Details": "The vulnerability allows an attacker to bypass the restricted shell and execute arbitrary code on the system.", "Detection": "The vulnerability can be detected through the use of vulnerability scanners and penetration testing tools.", "Mitigation": "The vulnerability can be mitigated by configuring and validating the VMware ISO images and restricting access to the system.", "Conclusion": "CVE-2020-24045 is a serious vulnerability that affects the SpamTitan Gateway 7.07 and allows an attacker to execute arbitrary code on the system."}, "executive_analysis": {"Overview": "CVE-2020-24045 is a critical vulnerability in the SpamTitan Gateway 7.07 that allows an attacker to execute arbitrary code on the system.", "Business Impact": "The vulnerability can lead to data breaches and financial loss, and can also compromise the confidentiality, integrity, and availability of the system.", "Technical Impact": "The vulnerability allows an attacker to bypass the restricted shell and execute arbitrary code on the system.", "Mitigation Strategies": "The vulnerability can be mitigated by configuring and validating the VMware ISO images and restricting access to the system.", "Recommendations": "Implementing the mitigation strategies and conducting regular vulnerability scans and penetration testing can help prevent the exploitation of this vulnerability.", "Conclusions": "CVE-2020-24045 is a serious vulnerability that requires immediate attention and mitigation."}}