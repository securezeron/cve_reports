{"id": "CVE-2007-0787", "sourceIdentifier": "cve@mitre.org", "published": "2007-02-06T19:28:00.000", "lastModified": "2017-07-29T01:30:24.860", "vulnStatus": "Modified", "cveTags": [], "evaluatorSolution": "Successful exploitation requires that \"register_globals\" is enabled and \"magic_quotes_gpc\" is disabled.", "descriptions": [{"lang": "en", "value": "PHP remote file inclusion vulnerability in controller.php in Simple Invoices before 20070202 allows remote attackers to execute arbitrary PHP code via a URL in the (1) module or (2) view parameter.  NOTE: some of these details are obtained from third party information."}, {"lang": "es", "value": "Vulnerabilidad de inclusi\u00f3n remota de archivo PHP en controller.php en Simple Invoices anterior al 02/02/2007 permite a atacantes remotos ejecutar c\u00f3digo PHP de su elecci\u00f3n mediante una URL en los par\u00e1metros (1) module o (2) view. NOTA: algunos de estos detalles han sido obtenidos de informaci\u00f3n de terceros."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:simple_invoices:simple_invoices:2007-02-02:*:*:*:*:*:*:*", "matchCriteriaId": "07A4935F-05F9-4C93-8ED4-40811C9DF55D"}]}]}], "references": [{"url": "http://osvdb.org/31796", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/24040", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/22389", "source": "cve@mitre.org"}, {"url": "http://www.simpleinvoices.org/index.php?news=25", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/0481", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/32207", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1086", "comment": "CVE-2007-0787 - Remote File Inclusion Vulnerability, T1086: Subsequent events that indicate the initial compromise has been successful, such as creation of new accounts or malicious execution of system commands."}, {"techniqueID": "T1499", "comment": "CVE-2007-0787 - Remote File Inclusion Vulnerability, T1499: Execution through malware, such as web shells, to carry out system commands or execute arbitrary code."}, {"techniqueID": "T1179", "comment": "CVE-2007-0787 - Remote File Inclusion Vulnerability, T1179: Malware to maintain persistence, allow for command and control (C2), or to conduct lateral movement."}], "stix_bundle": {"objects": [{"id": "vulnerability", "type": "vulnerability", "spec_version": "2.1", "stix_id": "CVE-2007-0787", "created": "2021-11-27T01:30:24.860", "modified": "2021-11-27T01:30:24.860", "extensions": [{"id": " Threat Actors", "type": " Threat Actors", "role": "actor", "relationships": [{"id": " Threat Actors-actor-245", "type": "actor", "stix_id": "actor-245"}]}], "names": [{"value": "PHP Remote File Inclusion Vulnerability", "lang": "en"}], "descriptions": [{"value": "PHP remote file inclusion vulnerability in controller.php in Simple Invoices before 20070202 allows remote attackers to execute arbitrary PHP code via a URL in the (1) module or (2) view parameter.", "lang": "en"}], "references": [{"href": "http://osvdb.org/31796", "role": "reference"}, {"href": "http://secunia.com/advisories/24040", "role": "reference"}, {"href": "http://www.securityfocus.com/bid/22389", "role": "reference"}, {"href": "http://www.simpleinvoices.org/index.php?news=25", "role": "reference"}, {"href": "http://www.vupen.com/english/advisories/2007/0481", "role": "reference"}, {"href": "https://exchange.xforce.ibmcloud.com/vulnerabilities/32207", "role": "reference"}], "mitre ATT&CK Tactics": [{"id": "TA0001", "name": "Initial Access", "description": "An attacker gains access to a network, system, or application."}, {"id": "TA0002", "name": "Execution", "description": "An attacker executes code on the compromised system or network."}], "mitre ATT&CK Techniques": [{"id": "T1086", "name": "PowerShell Command Prompt", "description": "An attacker uses PowerShell to execute system commands or download malware."}, {"id": "T1499", "name": "PowerShell C2", "description": "An attacker uses PowerShell to establish command and control (C2) communications with a server."}, {"id": "T1179", "name": "PowerShell Persistence", "description": "An attacker uses PowerShell to maintain persistence on a compromised system."}]}]}, "technical_analysis": {"Introduction": "CVE-2007-0787 is a remote file inclusion vulnerability in PHP, allowing attackers to execute arbitrary PHP code. This vulnerability affects Simple Invoices before 20070202.", "Impact and Scope": "CVSS Score: 6.8, Attack Vector: NETWORK, CVSS v2.0: AV:N/AC:M/Au:N/C:P/I:P/A:P", "Related MITRE ATT&CK Techniques": "T1086, T1499, T1179", "Technical Details": "The vulnerability occurs due to the failure to validate and sanitize user input, allowing an attacker to send a malicious URL that includes the path to a PHP file. This allows an attacker to execute arbitrary PHP code.", "Detection": "Detecting this vulnerability can be done by monitoring for suspicious file inclusion attacks on PHP-based applications.", "Mitigation": "To mitigate this vulnerability, PHP developers should ensure that 'register_globals' is disabled and 'magic_quotes_gpc' is enabled.", "Conclusion": "CVE-2007-0787 is a remote file inclusion vulnerability in PHP, allowing attackers to execute arbitrary PHP code. It is essential to patch the affected application and implement mitigations to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2007-0787 is a remote file inclusion vulnerability in PHP, affecting Simple Invoices before 20070202.", "Business Impact": "Exploitation of this vulnerability can lead to unauthorized code execution, data theft, and system compromise, resulting in financial losses and reputational damage.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary PHP code, giving them full control over the system.", "Mitigation Strategies": "Disable 'register_globals', enable 'magic_quotes_gpc', and patch the affected application.", "Recommendations": "Executives should prioritize this vulnerability and ensure that it is remediated as soon as possible.", "Conclusions": "CVE-2007-0787 is a critical vulnerability that requires immediate attention. Executives should work with their security teams to implement mitigations and remediate the vulnerability."}}