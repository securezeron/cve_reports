{"id": "CVE-2023-52906", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-21T07:15:06.663", "lastModified": "2024-08-21T12:30:33.697", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/sched: act_mpls: Fix warning during failed attribute validation\n\nThe 'TCA_MPLS_LABEL' attribute is of 'NLA_U32' type, but has a\nvalidation type of 'NLA_VALIDATE_FUNCTION'. This is an invalid\ncombination according to the comment above 'struct nla_policy':\n\n\"\nMeaning of `validate' field, use via NLA_POLICY_VALIDATE_FN:\n   NLA_BINARY           Validation function called for the attribute.\n   All other            Unused - but note that it's a union\n\"\n\nThis can trigger the warning [1] in nla_get_range_unsigned() when\nvalidation of the attribute fails. Despite being of 'NLA_U32' type, the\nassociated 'min'/'max' fields in the policy are negative as they are\naliased by the 'validate' field.\n\nFix by changing the attribute type to 'NLA_BINARY' which is consistent\nwith the above comment and all other users of NLA_POLICY_VALIDATE_FN().\nAs a result, move the length validation to the validation function.\n\nNo regressions in MPLS tests:\n\n # ./tdc.py -f tc-tests/actions/mpls.json\n [...]\n # echo $?\n 0\n\n[1]\nWARNING: CPU: 0 PID: 17743 at lib/nlattr.c:118\nnla_get_range_unsigned+0x1d8/0x1e0 lib/nlattr.c:117\nModules linked in:\nCPU: 0 PID: 17743 Comm: syz-executor.0 Not tainted 6.1.0-rc8 #3\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\nrel-1.13.0-48-gd9c812dda519-prebuilt.qemu.org 04/01/2014\nRIP: 0010:nla_get_range_unsigned+0x1d8/0x1e0 lib/nlattr.c:117\n[...]\nCall Trace:\n <TASK>\n __netlink_policy_dump_write_attr+0x23d/0x990 net/netlink/policy.c:310\n netlink_policy_dump_write_attr+0x22/0x30 net/netlink/policy.c:411\n netlink_ack_tlv_fill net/netlink/af_netlink.c:2454 [inline]\n netlink_ack+0x546/0x760 net/netlink/af_netlink.c:2506\n netlink_rcv_skb+0x1b7/0x240 net/netlink/af_netlink.c:2546\n rtnetlink_rcv+0x18/0x20 net/core/rtnetlink.c:6109\n netlink_unicast_kernel net/netlink/af_netlink.c:1319 [inline]\n netlink_unicast+0x5e9/0x6b0 net/netlink/af_netlink.c:1345\n netlink_sendmsg+0x739/0x860 net/netlink/af_netlink.c:1921\n sock_sendmsg_nosec net/socket.c:714 [inline]\n sock_sendmsg net/socket.c:734 [inline]\n ____sys_sendmsg+0x38f/0x500 net/socket.c:2482\n ___sys_sendmsg net/socket.c:2536 [inline]\n __sys_sendmsg+0x197/0x230 net/socket.c:2565\n __do_sys_sendmsg net/socket.c:2574 [inline]\n __se_sys_sendmsg net/socket.c:2572 [inline]\n __x64_sys_sendmsg+0x42/0x50 net/socket.c:2572\n do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n do_syscall_64+0x2b/0x70 arch/x86/entry/common.c:80\n entry_SYSCALL_64_after_hwframe+0x63/0xcd"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net/sched: act_mpls: Advertencia de correcci\u00f3n durante la validaci\u00f3n fallida del atributo El atributo 'TCA_MPLS_LABEL' es de tipo 'NLA_U32', pero tiene un tipo de validaci\u00f3n de 'NLA_VALIDATE_FUNCTION'. Esta es una combinaci\u00f3n no v\u00e1lida seg\u00fan el comentario anterior 'struct nla_policy': \" Significado del campo `validar', util\u00edcelo a trav\u00e9s de NLA_POLICY_VALIDATE_FN: NLA_BINARY Funci\u00f3n de validaci\u00f3n llamada para el atributo. Todos los dem\u00e1s no utilizados, pero tenga en cuenta que es una uni\u00f3n \" Esto puede desencadenar la advertencia [1] en nla_get_range_unsigned() cuando falla la validaci\u00f3n del atributo. A pesar de ser del tipo 'NLA_U32', los campos 'min'/'max' asociados en la pol\u00edtica son negativos ya que tienen un alias del campo 'validate'. Para solucionarlo, cambie el tipo de atributo a 'NLA_BINARY', que es coherente con el comentario anterior y con todos los dem\u00e1s usuarios de NLA_POLICY_VALIDATE_FN(). Como resultado, mueva la validaci\u00f3n de longitud a la funci\u00f3n de validaci\u00f3n. No hay regresiones en las pruebas MPLS: # ./tdc.py -f tc-tests/actions/mpls.json [...] # echo $? 0 [1] ADVERTENCIA: CPU: 0 PID: 17743 en lib/nlattr.c:118 nla_get_range_unsigned+0x1d8/0x1e0 lib/nlattr.c:117 M\u00f3dulos vinculados en: CPU: 0 PID: 17743 Comm: syz-executor.0 No tainted 6.1.0-rc8 #3 Nombre del hardware: PC est\u00e1ndar QEMU (i440FX + PIIX, 1996), BIOS rel-1.13.0-48-gd9c812dda519-prebuilt.qemu.org 01/04/2014 RIP: 0010:nla_get_range_unsigned+0x1d8 /0x1e0 lib/nlattr.c:117 [...] Seguimiento de llamadas:  __netlink_policy_dump_write_attr+0x23d/0x990 net/netlink/policy.c:310 netlink_policy_dump_write_attr+0x22/0x30 net/netlink/policy.c:411 netlink_ack_tlv_fill net /netlink/af_netlink.c:2454 [en l\u00ednea] netlink_ack+0x546/0x760 net/netlink/af_netlink.c:2506 netlink_rcv_skb+0x1b7/0x240 net/netlink/af_netlink.c:2546 rtnetlink_rcv+0x18/0x20 net/core/rtnetlink. c:6109 netlink_unicast_kernel net/netlink/af_netlink.c:1319 [en l\u00ednea] netlink_unicast+0x5e9/0x6b0 net/netlink/af_netlink.c:1345 netlink_sendmsg+0x739/0x860 net/netlink/af_netlink.c:1921 sock_sendmsg_nosec net/socket.c :714 [en l\u00ednea] sock_sendmsg net/socket.c:734 [en l\u00ednea] ____sys_sendmsg+0x38f/0x500 net/socket.c:2482 ___sys_sendmsg net/socket.c:2536 [en l\u00ednea] __sys_sendmsg+0x197/0x230 net/socket.c: 2565 __do_sys_sendmsg net/socket.c:2574 [en l\u00ednea] __se_sys_sendmsg net/socket.c:2572 [en l\u00ednea] __x64_sys_sendmsg+0x42/0x50 net/socket.c:2572 do_syscall_x64 arch/x86/entry/common.c:50 [en l\u00ednea] do_syscall_64+0x2b/0x70 arch/x86/entry/common.c:80 Entry_SYSCALL_64_after_hwframe+0x63/0xcd"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/2b157c3c5d6b8ddca48d53c9e662032f65af8d61", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/453277feb41c2235cf2c0de9209eef962c401457", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8a97b544b98e44f596219ebb290fd2ba2fd5d644", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9e17f99220d111ea031b44153fdfe364b0024ff2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9e2c38827cdc6fdd3bb375c8607fc04d289756f9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1174", "comment": "The CVE-2023-52906 vulnerability allows an attacker to disrupt the functionality of the Linux kernel, potentially leading to a denial-of-service (DoS) attack. This technique is relevant to this vulnerability as it allows an attacker to exploit the vulnerability and cause a denial-of-service attack."}, {"techniqueID": "T1190", "comment": "The CVE-2023-52906 vulnerability allows an attacker to manipulate the Linux kernel, potentially leading to elevation of privileges. This technique is relevant to this vulnerability as it allows an attacker to exploit the vulnerability and gain elevated privileges."}], "stix_bundle": [{"type": "indicator", "id": "indicator--d0d1a9c7-dbd8-11e5-b85f-0800278f6e96", "created_by_ref": "identity--7f441c85-da42-11e4-8b3c-0800278f6e96", "modified": "2024-08-21T07:15:06+00:00", "created": "2024-08-21T07:15:06+00:00", "name": "CVE-2023-52906", "description": "Linux kernel vulnerability", "labels": ["vulnerability", "kernel"], "objects": [{"type": "vulnerability", "id": "vulnerability--d0d1a9c7-dbd8-11e5-b85f-0800278f6e96", "name": "CVE-2023-52906", "description": "Linux kernel vulnerability"}], "objects_relation_refs": [{"type": "relates_to", "id": "relates_to--d0d1a9c7-dbd8-11e5-b85f-0800278f6e96", "from": "indicator--d0d1a9c7-dbd8-11e5-b85f-0800278f6e96", "to": "vulnerability--d0d1a9c7-dbd8-11e5-b85f-0800278f6e96"}]}, {"type": "course_of_action", "id": "course_of_action--d0d1a9c7-dbd8-11e5-b85f-0800278f6e96", "created_by_ref": "identity--7f441c85-da42-11e4-8b3c-0800278f6e96", "modified": "2024-08-21T07:15:06+00:00", "created": "2024-08-21T07:15:06+00:00", "name": "Mitigation Strategy 1", "description": "Patch the Linux kernel", "mitigates": [{"type": "mitigates", "id": "mitigates--d0d1a9c7-dbd8-11e5-b85f-0800278f6e96", "from": "course_of_action--d0d1a9c7-dbd8-11e5-b85f-0800278f6e96", "to": "vulnerability--d0d1a9c7-dbd8-11e5-b85f-0800278f6e96"}]}], "technical_analysis": {"Introduction": "The CVE-2023-52906 vulnerability is a Linux kernel vulnerability that allows an attacker to disrupt the functionality of the Linux kernel, potentially leading to a denial-of-service (DoS) attack or elevation of privileges.", "Impact and Scope": "The impact of this vulnerability is significant, as it allows an attacker to disrupt the functionality of the Linux kernel, potentially leading to a denial-of-service (DoS) attack or elevation of privileges. The scope of this vulnerability is all Linux kernel versions that are affected by this vulnerability.", "Related MITRE ATT&CK Techniques": "The CVE-2023-52906 vulnerability is relevant to the following MITRE ATT&CK techniques: T1174, T1190.", "Technical Details": "The vulnerability is caused by a bug in the Linux kernel's network stack, which allows an attacker to manipulate the kernel's network stack and cause it to crash. The vulnerability requires an attacker to send a specially crafted packet to the kernel's network stack.", "Detection": "Detection of this vulnerability can be done by monitoring for signs of unusual network activity or kernel crashes.", "Mitigation": "The mitigation of this vulnerability is to patch the Linux kernel or disable the affected functionality.", "Conclusion": "The CVE-2023-52906 vulnerability is a significant vulnerability that requires prompt attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2023-52906 vulnerability is a Linux kernel vulnerability that allows an attacker to disrupt the functionality of the Linux kernel, potentially leading to a denial-of-service (DoS) attack or elevation of privileges.", "Business Impact": "The business impact of this vulnerability is significant, as it can cause downtime and data loss, potentially leading to financial loss and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is significant, as it can cause kernel crashes and denial-of-service attacks, potentially leading to system compromise and data theft.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are to patch the Linux kernel or disable the affected functionality.", "Recommendations": "Recommendations for executives include patching the Linux kernel or disabling the affected functionality, monitoring for signs of unusual network activity or kernel crashes, and developing a plan for responding to potential incidents.", "Conclusions": "The CVE-2023-52906 vulnerability is a significant vulnerability that requires prompt attention and mitigation. It is essential to take proactive measures to mitigate this vulnerability and protect against potential attacks."}}