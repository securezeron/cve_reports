{"id": "CVE-2020-13821", "sourceIdentifier": "cve@mitre.org", "published": "2020-08-26T16:15:12.447", "lastModified": "2020-12-23T15:43:39.817", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered in HiveMQ Broker Control Center 4.3.2. A crafted clientid parameter in an MQTT packet (sent to the Broker) is reflected in the client section of the management console. The attacker's JavaScript is loaded in a browser, which can lead to theft of the session and cookie of the administrator's account of the Broker."}, {"lang": "es", "value": "Se detect\u00f3 un problema en HiveMQ Broker Control Center versi\u00f3n 4.3.2. Un par\u00e1metro clientid dise\u00f1ado en un paquete MQTT (enviado al Broker) es reflejado en la secci\u00f3n del cliente de la consola de administraci\u00f3n. El JavaScript del atacante es cargado en un navegador, lo que puede conllevar el robo de la sesi\u00f3n y una cookie de la cuenta del administrador del Broker"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hivemq:broker_control_center:4.3.2:*:*:*:*:*:*:*", "matchCriteriaId": "AAD15DD3-F8EA-4692-88D6-C646D051DB21"}]}]}], "references": [{"url": "https://payatu.com/advisory/hivemq-mqtt-broker---xss-over-mqtt", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.hivemq.com/blog/hivemq-4-3-3-released/", "source": "cve@mitre.org", "tags": ["Release Notes", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2020-13821 - This vulnerability can be exploited via an MQTT packet (sent to the Broker) that contains a crafted clientid parameter, which is reflected in the client section of the management console, allowing an attacker to load their JavaScript in a browser, leading to potential theft of the session and cookie of the administrator's account of the Broker. This can be prevented by implementing input validation and sanitization mechanisms."}, {"techniqueID": "T1078", "comment": "CVE-2020-13821 - Attackers may use this vulnerability to inject malicious JavaScript code into the management console, which can be executed in the context of the administrator's account. This can be detected by monitoring for unusual traffic patterns and analyzing the command and control (C2) communication."}, {"techniqueID": "T1190", "comment": "CVE-2020-13821 - This vulnerability can be used to expand the attack surface of the targeted system, allowing an attacker to steal sensitive information. Defense strategies may include implementing secure coding practices, restriction of access to sensitive areas and regular security audits and testing."}, {"techniqueID": "T1562", "comment": "CVE-2020-13821 - This vulnerability can be used to conduct further attacks such as phishing, malware, and lateral movement. Mitigation strategies may include implementing secure authentication and authorization mechanisms, restricting unnecessary access and regular security audits and testing."}], "technical_analysis": {"Introduction": "The CVE-2020-13821 vulnerability affects HiveMQ Broker Control Center version 4.3.2. It allows attackers to inject malicious JavaScript code into the management console, steal the session and cookie of the administrator's account, and expand the attack surface of the system.", "Impact and Scope": "The vulnerability has a CVSS score of 5.4 with a severity of MEDIUM. It can be exploited via an MQTT packet (sent to the Broker) that contains a crafted clientid parameter.", "Related MITRE ATT&CK Techniques": ["T1059", "T1078", "T1190", "T1562"], "Technical Details": "The vulnerability affects the MQTT packet processing mechanism in HiveMQ Broker Control Center version 4.3.2.", "Detection": "This vulnerability can be detected by monitoring for unusual traffic patterns and analyzing the command and control (C2) communication.", "Mitigation": "Implementing input validation and sanitization mechanisms, secure coding practices, restriction of access to sensitive areas, and regular security audits and testing can help mitigate the vulnerability.", "Conclusion": "The CVE-2020-13821 vulnerability is a significant security risk that requires immediate attention."}, "executive_analysis": {"Overview": "The CVE-2020-13821 vulnerability is a critical security risk that allows attackers to inject malicious JavaScript code into the management console and steal sensitive information.", "Business Impact": "This vulnerability can lead to theft of sensitive information, compromise of sensitive data, and potential financial losses.", "Technical Impact": "The vulnerability affects the MQTT packet processing mechanism in HiveMQ Broker Control Center version 4.3.2.", "Mitigation Strategies": "Implementing secure coding practices, restriction of access to sensitive areas, and regular security audits and testing can help mitigate the vulnerability.", "Recommendations": "Executives should prioritize the patching of the affected system and implement additional security measures to prevent potential attacks.", "Conclusions": "The CVE-2020-13821 vulnerability is a significant security risk that requires immediate attention and priority action."}}