{"id": "CVE-2024-5131", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T19:16:05.060", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "An Improper Access Control vulnerability exists in the lunary-ai/lunary repository, affecting versions up to and including 1.2.2. The vulnerability allows unauthorized users to view any prompts in any projects by supplying a specific prompt ID to an endpoint that does not adequately verify the ownership of the prompt ID. This issue was fixed in version 1.2.25."}, {"lang": "es", "value": "Existe una vulnerabilidad de control de acceso inadecuado en el repositorio lunary-ai/lunary, que afecta a las versiones hasta la 1.2.2 incluida. La vulnerabilidad permite a usuarios no autorizados ver cualquier mensaje en cualquier proyecto al proporcionar un ID de mensaje espec\u00edfico a un endpoint que no verifica adecuadamente la propiedad del ID de mensaje. Este problema se solucion\u00f3 en la versi\u00f3n 1.2.25."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-284"}]}], "references": [{"url": "https://github.com/lunary-ai/lunary/commit/ddfd497afd017a6946c582a1a806687fdac888bf", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/52c129f2-114e-492f-aee8-32c78f75ac4f", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-5131 - Improper access control in lunary-ai/lunary repository, an attacker could access projects and prompts without proper verification, mitigated by proper authentication and authorization mechanisms, related to T1203: Exploit Public-Facing Application"}, {"techniqueID": "T1203", "comment": "CVE-2024-5131 - Public-facing application vulnerability in lunary-ai/lunary repository, an attacker could exploit the vulnerability to access restricted data, mitigated by regular software updates and vulnerability patches"}, {"techniqueID": "T1190", "comment": "CVE-2024-5131 - Lateral movement through compromised systems, potentially allowing an attacker to access and manipulate sensitive data, mitigated by monitoring user activity and implementing access controls"}, {"techniqueID": "T1194", "comment": "CVE-2024-5131 - Data exfiltration through the compromised system, allowing an attacker to steal or manipulate sensitive data, mitigated by data encryption and access controls"}, {"techniqueID": "T1040", "comment": "CVE-2024-5131 - Network access, an attacker could access the exploited system remotely, mitigated by network segmentation and monitoring"}, {"techniqueID": "TA0005", "comment": "CVE-2024-5131 - Defense Evasion, attackers could access and exploit the vulnerability to hide their presence and evade detection, mitigated by monitoring system logs and implementing incident response"}, {"techniqueID": "TA0001", "comment": "CVE-2024-5131 - Initial Access, an attacker could exploit the vulnerability to gain initial access to the system, mitigated by regular software updates and vulnerability patches"}, {"techniqueID": "TA0040", "comment": "CVE-2024-5131 - Execution, an attacker could execute code on the compromised system, mitigated by implementing application whitelisting and monitoring process creation"}], "stix_bundle": {"stixbundle": {"type": "bundle", "id": "Bundle for CVE-2024-5131", "label": "CVE-2024-5131", "description": "Bundle for CVE-2024-5131 - Improper access control in lunary-ai/lunary repository", "objects": [{"type": "vulnerability", "id": "CVE-2024-5131", "label": "CVE-2024-5131", "description": "Improper access control in lunary-ai/lunary repository"}, {"type": "note", "id": "technique_ta0005", "label": "Defense Evasion", "description": "Defensive evasion techniques to mitigate this vulnerability"}, {"type": "note", "id": "technique_ta0001", "label": "Initial Access", "description": "Initial access techniques for this vulnerability"}, {"type": "note", "id": "technique_ta0040", "label": "Execution", "description": "Execution techniques for this vulnerability"}, {"type": "note", "id": "technique_t1027", "label": "Exploit Public-Facing Application", "description": "Exploit public-facing application techniques to mitigate this vulnerability"}, {"type": "note", "id": "technique_t1040", "label": "Network Access", "description": "Network access techniques to mitigate this vulnerability"}, {"type": "note", "id": "technique_t1190", "label": "Lateral Movement", "description": "Lateral movement techniques to mitigate this vulnerability"}, {"type": "note", "id": "technique_t1194", "label": "Data Exfiltration", "description": "Data exfiltration techniques to mitigate this vulnerability"}, {"type": "note", "id": "technique_t1203", "label": "Public-Facing Application", "description": "Public-facing application techniques to mitigate this vulnerability"}], "relationships": [{"type": "related_to", "id": "CVE-2024-5131", "from_id": "technique_ta0005", "label": "Mitigates"}, {"type": "related_to", "id": "CVE-2024-5131", "from_id": "technique_ta0001", "label": "Exploited"}, {"type": "related_to", "id": "CVE-2024-5131", "from_id": "technique_ta0040", "label": "Mitigates"}, {"type": "related_to", "id": "CVE-2024-5131", "from_id": "technique_t1027", "label": "Mitigates"}, {"type": "related_to", "id": "CVE-2024-5131", "from_id": "technique_t1040", "label": "Mitigates"}, {"type": "related_to", "id": "CVE-2024-5131", "from_id": "technique_t1190", "label": "Mitigates"}, {"type": "related_to", "id": "CVE-2024-5131", "from_id": "technique_t1194", "label": "Mitigates"}, {"type": "related_to", "id": "CVE-2024-5131", "from_id": "technique_t1203", "label": "Exploited"}]}}, "technical_analysis": {"Introduction": "The CVE-2024-5131 vulnerability is an improper access control vulnerability in the lunary-ai/lunary repository, affecting versions up to and including 1.2.2. This vulnerability allows unauthorized users to view any prompts in any projects by supplying a specific prompt ID to an endpoint that does not adequately verify the ownership of the prompt ID.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5, with an attack vector of NETWORK and attack complexity of LOW. It has a confidentiality impact of HIGH, integrity impact of NONE, and availability impact of NONE.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including T1027: Exploit Public-Facing Application, T1203: Exploit Public-Facing Application, T1190: Lateral Movement, T1194: Data Exfiltration, T1040: Network Access, and TA0005: Defense Evasion.", "Technical Details": "The vulnerability is caused by an improper access control mechanism in the lunary-ai/lunary repository, which allows unauthorized users to access project prompts. This is due to the lack of proper verification of the ownership of the prompt ID.", "Detection": "The vulnerability can be detected by monitoring system logs for abnormal access patterns and implementing security information and event management (SIEM) systems.", "Mitigation": "The vulnerability can be mitigated by implementing proper authentication and authorization mechanisms, regularly updating software, and configuring firewalls to block unauthorized access.", "Conclusion": "In conclusion, the CVE-2024-5131 vulnerability is a serious security flaw that can be exploited by attackers to gain unauthorized access to sensitive data. It is essential to implement proper security controls and monitoring to detect and mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-5131 vulnerability is a critical security flaw in the lunary-ai/lunary repository that can allow unauthorized access to project prompts.", "Business Impact": "The vulnerability has significant business impact, as it can allow attackers to access sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability has a significant technical impact, as it allows attackers to exploit the system and gain unauthorized access.", "Mitigation Strategies": "The vulnerability can be mitigated by implementing proper security controls and monitoring, regularly updating software, and configuring firewalls to block unauthorized access.", "Recommendations": "Recommendations for executives include implementing proper security controls and monitoring, regularly updating software, and configuring firewalls to block unauthorized access.", "Conclusions": "In conclusion, the CVE-2024-5131 vulnerability is a critical security flaw that requires immediate attention and mitigation."}}