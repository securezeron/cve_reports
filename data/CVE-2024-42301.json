{"id": "CVE-2024-42301", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-17T09:15:10.423", "lastModified": "2024-08-22T16:31:18.667", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndev/parport: fix the array out-of-bounds risk\n\nFixed array out-of-bounds issues caused by sprintf\nby replacing it with snprintf for safer data copying,\nensuring the destination buffer is not overflowed.\n\nBelow is the stack trace I encountered during the actual issue:\n\n[ 66.575408s] [pid:5118,cpu4,QThread,4]Kernel panic - not syncing: stack-protector:\nKernel stack is corrupted in: do_hardware_base_addr+0xcc/0xd0 [parport]\n[ 66.575408s] [pid:5118,cpu4,QThread,5]CPU: 4 PID: 5118 Comm:\nQThread Tainted: G S W O 5.10.97-arm64-desktop #7100.57021.2\n[ 66.575439s] [pid:5118,cpu4,QThread,6]TGID: 5087 Comm: EFileApp\n[ 66.575439s] [pid:5118,cpu4,QThread,7]Hardware name: HUAWEI HUAWEI QingYun\nPGUX-W515x-B081/SP1PANGUXM, BIOS 1.00.07 04/29/2024\n[ 66.575439s] [pid:5118,cpu4,QThread,8]Call trace:\n[ 66.575469s] [pid:5118,cpu4,QThread,9] dump_backtrace+0x0/0x1c0\n[ 66.575469s] [pid:5118,cpu4,QThread,0] show_stack+0x14/0x20\n[ 66.575469s] [pid:5118,cpu4,QThread,1] dump_stack+0xd4/0x10c\n[ 66.575500s] [pid:5118,cpu4,QThread,2] panic+0x1d8/0x3bc\n[ 66.575500s] [pid:5118,cpu4,QThread,3] __stack_chk_fail+0x2c/0x38\n[ 66.575500s] [pid:5118,cpu4,QThread,4] do_hardware_base_addr+0xcc/0xd0 [parport]"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: dev/parport: corrige el riesgo de que la matriz est\u00e9 fuera de los l\u00edmites. Se corrigieron los problemas de matriz fuera de los l\u00edmites causados por sprintf reemplaz\u00e1ndolo con snprintf para una copia de datos m\u00e1s segura, garantizando el b\u00fafer de destino no est\u00e1 desbordado. A continuaci\u00f3n se muestra el seguimiento de la pila que encontr\u00e9 durante el problema real: [66.575408s] [pid:5118,cpu4,QThread,4]P\u00e1nico en el kernel: no se sincroniza: stack-protector: la pila del kernel est\u00e1 da\u00f1ada en: do_hardware_base_addr+0xcc/0xd0 [parport ] [ 66.575408s] [pid:5118,cpu4,QThread,5]CPU: 4 PID: 5118 Comunicaci\u00f3n: QThread contaminado: GSWO 5.10.97-arm64-desktop #7100.57021.2 [ 66.575439s] [pid:5118,cpu4, QThread,6]TGID: 5087 Comm: EFileApp [66.575439s] [pid:5118,cpu4,QThread,7]Nombre del hardware: HUAWEI HUAWEI QingYun PGUX-W515x-B081/SP1PANGUXM, BIOS 1.00.07 29/04/2024 [66.575439 s] [pid:5118,cpu4,QThread,8]Rastreo de llamadas: [66.575469s] [pid:5118,cpu4,QThread,9] dump_backtrace+0x0/0x1c0 [66.575469s] [pid:5118,cpu4,QThread,0 ] show_stack+0x14/0x20 [ 66.575469s] [pid:5118,cpu4,QThread,1] dump_stack+0xd4/0x10c [ 66.575500s] [pid:5118,cpu4,QThread,2] p\u00e1nico+0x1d8/0x3bc [ 66.575500s] [pid:5118,cpu4,QThread,3] __stack_chk_fail+0x2c/0x38 [66.575500s] [pid:5118,cpu4,QThread,4] do_hardware_base_addr+0xcc/0xd0 [parport]"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-129"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.19.320", "matchCriteriaId": "0B4EF915-550B-45E5-B2CA-648FEACD60FC"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.20", "versionEndExcluding": "5.4.282", "matchCriteriaId": "A8961D98-9ACF-4188-BA88-44038B14BC28"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.5", "versionEndExcluding": "5.10.224", "matchCriteriaId": "5CCEDF13-293D-4E64-B501-4409D0365AFE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.11", "versionEndExcluding": "5.15.165", "matchCriteriaId": "B4E2B568-3171-41DE-B519-F2B1A3600D94"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.16", "versionEndExcluding": "6.1.103", "matchCriteriaId": "E45EAC72-8329-4F99-8276-86AF9BB3496A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2", "versionEndExcluding": "6.6.44", "matchCriteriaId": "CC912330-6B41-4C6B-99AF-F3857FBACB6A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.10.3", "matchCriteriaId": "92D388F2-1EAF-4CFA-AC06-5B26D762EA7D"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/166a0bddcc27de41fe13f861c8348e8e53e988c8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/47b3dce100778001cd76f7e9188944b5cb27a76d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/7789a1d6792af410aa9b39a1eb237ed24fa2170a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/7f4da759092a1a6ce35fb085182d02de8cc4cc84", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/a44f88f7576bc1916d8d6293f5c62fbe7cbe03e0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/ab11dac93d2d568d151b1918d7b84c2d02bacbd5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/b579ea3516c371ecf59d073772bc45dfd28c8a0e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/c719b393374d3763e64900ee19aaed767d5a08d6", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-42301 - This vulnerability can be exploited using a Local File Inclusion (LFI) attack, where an attacker can upload a malicious file to the system to execute arbitrary code. This is a prime example of why input validation and sanitization are crucial in preventing such attacks."}, {"techniqueID": "T1225", "comment": "CVE-2024-42301 - The vulnerability can also be exploited using a file inclusion attack, where an attacker can trick the system into executing a malicious file. This demonstrates the importance of proper file handling and validation mechanisms to prevent such attacks."}, {"techniqueID": "T1204", "comment": "CVE-2024-42301 - The vulnerability allows an attacker to execute system-level commands, demonstrating the need for proper access control and least privilege principles to prevent attacks like this."}], "stix_bundle": {"stix": [{"Object": {"id": "cve-2024-42301", "type": "vulnerability", "created_by_ref": "https://localhost:8443/stix-instance/v2.1/identity", "modified": "2024-08-22T16:31:18.667", "name": "CVE-2024-42301", "description": {"lang": "en", "value": "CWE-129 - Output manipulation vulnerability"}}, "Relationships": [{"type": "indicated_by", "Object1": "cve-2024-42301", "Object2": "T1190", "relationship": "Related to"}, {"type": "indicated_by", "Object1": "cve-2024-42301", "Object2": "T1225", "relationship": "Related to"}, {"type": "indicated_by", "Object1": "cve-2024-42301", "Object2": "T1204", "relationship": "Related to"}]}]}, "technical_analysis": {"Introduction": "CVE-2024-42301 is an output manipulation vulnerability that allows an attacker to inject arbitrary commands, demonstrating the importance of proper input validation and sanitization.", "Impact and Scope": "The vulnerability has a CVSSv3 score of 7.8 and an attack vector of Local (L). It affects Linux systems of version 4.19.320 and later.", "Related MITRE ATT&CK Techniques": "T1190, T1225, T1204", "Technical Details": "The vulnerability is caused by an output manipulation vulnerability in the Linux kernel, specifically in the dev/parport module. This vulnerability can be exploited using a Local File Inclusion (LFI) attack.", "Detection": "Detect the vulnerability by monitoring system logs for suspicious command execution or file inclusion events.", "Mitigation": "Mitigate the vulnerability by ensuring that input validation and sanitization mechanisms are in place and updating the Linux kernel to a version prior to 4.19.320.", "Conclusion": "In conclusion, CVE-2024-42301 is a serious vulnerability that highlights the importance of proper input validation and sanitization mechanisms in preventing output manipulation attacks."}, "executive_analysis": {"Overview": "CVE-2024-42301 is a critical vulnerability that affects Linux systems and allows an attacker to inject arbitrary commands.", "Business Impact": "The vulnerability can lead to data breaches, system compromise, and unauthorized access, resulting in significant financial losses and reputational damage.", "Technical Impact": "The vulnerability requires the attacker to have local access to the system, making it a high-priority threat.", "Mitigation Strategies": "Implement robust input validation and sanitization mechanisms and keep the Linux kernel up-to-date.", "Recommendations": "Recommend that users update their Linux systems immediately and apply patching for this vulnerability.", "Conclusions": "In conclusion, CVE-2024-42301 is a high-priority vulnerability that requires immediate attention to prevent potential attacks."}}