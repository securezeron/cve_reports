{"id": "CVE-2024-41950", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-31T16:15:04.797", "lastModified": "2024-08-01T12:42:36.933", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Haystack is an end-to-end LLM framework that allows you to build applications powered by LLMs, Transformer models, vector search and more. Haystack clients that let their users create and run Pipelines from scratch are vulnerable to remote code executions. Certain Components in Haystack use Jinja2 templates, if anyone can create and render that template on the client machine they run any code. The vulnerability has been fixed with Haystack `2.3.1`."}, {"lang": "es", "value": "Haystack es un framework LLM de un extremo a otro que le permite crear aplicaciones impulsadas por LLM, modelos Transformer, b\u00fasqueda vectorial y m\u00e1s. Los clientes Haystack que permiten a sus usuarios crear y ejecutar Pipelines desde cero son vulnerables a ejecuciones remotas de c\u00f3digo. Ciertos componentes en Haystack usan plantillas Jinja2, si alguien puede crear y representar esa plantilla en la m\u00e1quina cliente, ejecuta cualquier c\u00f3digo. La vulnerabilidad se ha solucionado con Haystack `2.3.1`."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.6, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1336"}]}], "references": [{"url": "https://github.com/deepset-ai/haystack/commit/3fed1366c448b02189851bf08166c1f6477a02b0", "source": "security-advisories@github.com"}, {"url": "https://github.com/deepset-ai/haystack/commit/6c25a5c73e83aa32c3241ba84a5cbb3ac0e8a89e", "source": "security-advisories@github.com"}, {"url": "https://github.com/deepset-ai/haystack/pull/8095", "source": "security-advisories@github.com"}, {"url": "https://github.com/deepset-ai/haystack/pull/8096", "source": "security-advisories@github.com"}, {"url": "https://github.com/deepset-ai/haystack/releases/tag/v2.3.1", "source": "security-advisories@github.com"}, {"url": "https://github.com/deepset-ai/haystack/security/advisories/GHSA-hx9v-6r9f-w677", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1118", "comment": "CVE-2024-41950 - Jinja2 Template Injection using Haystack Pipeline. This technique can be used to inject arbitrary code on the client machine. Defend against this by isolating Haystack pipeline creation and preventing Jinja2 template injection."}, {"techniqueID": "T1518", "comment": "CVE-2024-41950 - Remote Code Execution using Haystack Pipeline. This technique exploits the vulnerable Jinja2 template injection, allowing remote code execution. Defend against this by patching Haystack to version 2.3.1 and limiting pipe creation."}], "stix_bundle": {"id": "Vulnerability:CVE-2024-41950", "type": "vulnerability", "created_by_ref": "identity:security- analyst", "created": "2024-08-01T12:42:36.933", "modified": "2024-08-01T12:42:36.933", "name": "CVE-2024-41950: Haystack Remote Code Execution", "description": "Haystack is an end-to-end LLM framework that allows you to build applications powered by LLMs, Transformer models, vector search and more. Haystack clients that let their users create and run Pipelines from scratch are vulnerable to remote code executions.", "cvssV31": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "baseSeverity": "HIGH", "baseScore": 7.5}, "weaknesses": [{"weakness_id": "CWE-1336", "type": "Secondary", "description": "CWE-1336: Code Injection"}], "related_objects": [{"type": " incident", "id": "incident:Remote-Code-Execution-Haystack", "role": "affected"}, {"type": " analystsnote", "id": "analysts-note:Mitigation-Strategy-Haystack", "role": "mitigated_by"}]}, "technical_analysis": {"Introduction": "CVE-2024-41950 is a remote code execution vulnerability in Haystack, an end-to-end LLM framework. This vulnerability allows attackers to inject arbitrary code on the client machine by exploiting the Jinja2 template injection.", "Impact and Scope": "The impact of this vulnerability is High, with a CVSS score of 7.5. The attack vector is Network, and the privileges required are Low. The confidentiality, integrity, and availability impact are all High.", "Related MITRE ATT&CK Techniques": "T1118: Jinja2 Template Injection, T1518: Remote Code Execution", "Technical Details": "The vulnerability is due to Haystack's use of Jinja2 templates, which can be exploited by attackers to inject arbitrary code. The vulnerability is patched in Haystack version 2.3.1.", "Detection": "Detection involves monitoring for suspicious pipeline creation and Jinja2 template injection. Implementing a web application firewall and monitoring for unusual network traffic can also help detect this vulnerability.", "Mitigation": "Patching Haystack to version 2.3.1, isolating Haystack pipeline creation, and preventing Jinja2 template injection are recommended mitigation strategies.", "Conclusion": "CVE-2024-41950 is a serious remote code execution vulnerability in Haystack. Implementing effective mitigation strategies is essential to protect against this vulnerability."}, "executive_analysis": {"Overview": "CVE-2024-41950 is a critical remote code execution vulnerability in Haystack, an end-to-end LLM framework.", "Business Impact": "The business impact of this vulnerability is High, with potential financial losses and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is High, with potential compromise of sensitive data and systems.", "Mitigation Strategies": "Patching Haystack, isolating Haystack pipeline creation, and preventing Jinja2 template injection are recommended mitigation strategies.", "Recommendations": "It is recommended that Haystack be patched to version 2.3.1, and that measures be taken to isolate Haystack pipeline creation and prevent Jinja2 template injection.", "Conclusions": "CVE-2024-41950 is a critical vulnerability that requires immediate attention and mitigation. Regular monitoring and patching are essential to protect against this vulnerability."}}