{"id": "CVE-2024-26152", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-22T22:15:47.310", "lastModified": "2024-02-23T02:42:54.547", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "### Summary\nOn all Label Studio versions prior to 1.11.0, data imported via file upload feature is not properly sanitized prior to being rendered within a [`Choices`](https://labelstud.io/tags/choices) or [`Labels`](https://labelstud.io/tags/labels) tag, resulting in an XSS vulnerability.\n\n### Details\nNeed permission to use the \"data import\" function. This was reproduced on Label Studio 1.10.1.\n\n### PoC\n\n1. Create a project.\n![Create a project](https://github.com/HumanSignal/label-studio/assets/3943358/9b1536ad-feac-4238-a1bd-ca9b1b798673)\n\n2. Upload a file containing the payload using the \"Upload Files\" function.\n![2  Upload a file containing the payload using the Upload Files function](https://github.com/HumanSignal/label-studio/assets/3943358/26bb7af1-1cd2-408f-9adf-61e31a5b7328)\n![3  complete](https://github.com/HumanSignal/label-studio/assets/3943358/f2f62774-1fa6-4456-9e6f-8fa1ca0a2d2e)\n\nThe following are the contents of the files used in the PoC\n```\n{\n  \"data\": {\n    \"prompt\": \"labelstudio universe image\",\n    \"images\": [\n      {\n        \"value\": \"id123#0\",\n        \"style\": \"margin: 5px\",\n        \"html\": \"<img width='400' src='https://labelstud.io/_astro/images-tab.64279c16_ZaBSvC.avif' onload=alert(document.cookie)>\"\n      }\n    ]\n  }\n}\n```\n\n3. Select the text-to-image generation labeling template of Ranking and scoring\n![3  Select the text-to-image generation labelling template for Ranking and scoring](https://github.com/HumanSignal/label-studio/assets/3943358/f227f49c-a718-4738-bc2a-807da4f97155)\n![5  save](https://github.com/HumanSignal/label-studio/assets/3943358/9b529f8a-8e99-4bb0-bdf6-bb7a95c9b75d)\n\n4. Select a task\n![4  Select a task](https://github.com/HumanSignal/label-studio/assets/3943358/71856b7a-2b1f-44ea-99ab-fc48bc20caa7)\n\n5. Check that the script is running\n![5  Check that the script is running](https://github.com/HumanSignal/label-studio/assets/3943358/e396ae7b-a591-4db7-afe9-5bab30b48cb9)\n\n### Impact\nMalicious scripts can be injected into the code, and when linked with vulnerabilities such as CSRF, it can cause even greater damage. In particular, It can become a source of further attacks, especially when linked to social engineering.\n"}, {"lang": "es", "value": "### Resumen En todas las versiones de Label Studio anteriores a la 1.11.0, los datos importados mediante la funci\u00f3n de carga de archivos no se desinfectan adecuadamente antes de procesarse dentro de [`Choices`](https://labelstud.io/tags/choices) o [`Labels`](https://labelstud.io/tags/labels), lo que genera una vulnerabilidad XSS. ### Detalles Necesita permiso para utilizar la funci\u00f3n \"importaci\u00f3n de datos\". Esto fue reproducido en Label Studio 1.10.1. ### PoC 1. Cree un proyecto. ![Crear un proyecto](https://github.com/HumanSignal/label-studio/assets/3943358/9b1536ad-feac-4238-a1bd-ca9b1b798673) 2. Cargue un archivo que contenga la carga \u00fatil usando la funci\u00f3n \"Cargar archivos\" . ![2 Cargue un archivo que contenga la carga \u00fatil usando la funci\u00f3n Cargar archivos](https://github.com/HumanSignal/label-studio/assets/3943358/26bb7af1-1cd2-408f-9adf-61e31a5b7328) ![3 completo]( https://github.com/HumanSignal/label-studio/assets/3943358/f2f62774-1fa6-4456-9e6f-8fa1ca0a2d2e) Los siguientes son los contenidos de los archivos utilizados en el PoC ``` { \"data\": { \" Prompt\": \"imagen del universo de labelstudio\", \"images\": [ { \"value\": \"id123#0\", \"style\": \"margin: 5px\", \"html\": \"\" } ] } } ``` 3. Seleccione la plantilla de etiquetado de generaci\u00f3n de texto a imagen de Clasificaci\u00f3n y puntuaci\u00f3n![3 Seleccione la plantilla de etiquetado de generaci\u00f3n de texto a imagen para Clasificaci\u00f3n y puntuaci\u00f3n](https://github.com/HumanSignal/label-studio/assets/3943358/f227f49c-a718-4738-bc2a-807da4f97155)![ 5 guardar](https://github.com/HumanSignal/label-studio/assets/3943358/9b529f8a-8e99-4bb0-bdf6-bb7a95c9b75d) 4. \u00a1Seleccione una tarea! [4 Seleccione una tarea](https://github.com/HumanSignal/label-studio/assets/3943358/71856b7a-2b1f-44ea-99ab-fc48bc20caa7) 5. \u00a1Compruebe que el script se est\u00e9 ejecutando! [5 Compruebe que el script se est\u00e9 ejecutando](https://github.com/ HumanSignal/label-studio/assets/3943358/e396ae7b-a591-4db7-afe9-5bab30b48cb9) ### Impacto Se pueden inyectar scripts maliciosos en el c\u00f3digo y, cuando se vinculan con vulnerabilidades como CSRF, pueden causar un da\u00f1o a\u00fan mayor. En particular, puede convertirse en una fuente de nuevos ataques, especialmente cuando se vincula a la ingenier\u00eda social."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "references": [{"url": "https://github.com/HumanSignal/label-studio/commit/5df9ae3828b98652e9fa290a19f4deedf51ef6c8", "source": "security-advisories@github.com"}, {"url": "https://github.com/HumanSignal/label-studio/pull/5232", "source": "security-advisories@github.com"}, {"url": "https://github.com/HumanSignal/label-studio/releases/tag/1.11.0", "source": "security-advisories@github.com"}, {"url": "https://github.com/HumanSignal/label-studio/security/advisories/GHSA-6xv9-957j-qfhg", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0003 - Command and Control", "comment": "CVE-2024-26152 - Unvalidated user input in Label Studio allows for remote code execution, which can be leveraged for command and control attacks."}, {"techniqueID": "TA0001 - Initial Access", "comment": "CVE-2024-26152 - Malicious scripts injected into Label Studio can be used for initial access attacks."}, {"techniqueID": "T1190 - Rootkit", "comment": "CVE-2024-26152 - Compromised Label Studio instance with a malicious script can be used to hide malware or other malicious activity, making it a rootkit."}, {"techniqueID": "T1572 - Hardware Discovery", "comment": "CVE-2024-26152 - Adversaries may use the compromised Label Studio instance to discover and exploit hardware vulnerabilities."}, {"techniqueID": "T1190 - Memory Patching", "comment": "CVE-2024-26152 - Malicious scripts injected into Label Studio can modify memory to plant malware or other malicious code."}, {"techniqueID": "T1027 - Application Layer Protocol", "comment": "CVE-2024-26152 - Adversaries may use the compromised Label Studio instance to communicate with other systems or targets over HTTP or HTTPS."}, {"techniqueID": "T1040 - Network Service Scanning", "comment": "CVE-2024-26152 - Adversaries may use the compromised Label Studio instance to scan and identify network services or hosts."}], "stix_bundle": {"bundle_title": " CVE-2024-26152 - Label Studio XSS Vulnerability", "bundle_description": "This bundle includes data related to the CVE-2024-26152 Label Studio XSS vulnerability, including the vulnerability itself, associated MITRE ATT&CK techniques, and mitigation strategies.", "objects": [{"id": "vulnerability", "type": "vulnerability", "name": "CVE-2024-26152 - Label Studio XSS Vulnerability", "description": "A Cross-Site Scripting (XSS) vulnerability has been identified in Label Studio, affecting all versions prior to 1.11.0.", "severity": "Medium", "exploitability": "High", "impact": "High", "references": [{"url": "https://github.com/HumanSignal/label-studio/commit/5df9ae3828b98652e9fa290a19f4deedf51ef6c8"}, {"url": "https://github.com/HumanSignal/label-studio/pull/5232"}, {"url": "https://github.com/HumanSignal/label-studio/releases/tag/1.11.0"}]}, {"id": "technique", "type": "technique", "name": "Command and Control", "description": "Command and Control is a technique used by adversaries to communicate with compromised systems or targets.", "relevance": "High", "related": [{"id": "vulnerability", "role": "caused_by"}]}, {"id": "mitigation", "type": "mitigation", "name": "Upgrade to Label Studio 1.11.0 or later", "description": "Upgrade to Label Studio 1.11.0 or a later version to address this vulnerability.", "relevance": "High", "related": [{"id": "vulnerability", "role": "mitigates"}]}, {"id": "course_of_action", "type": "course_of_action", "name": "Monitor for suspicious network traffic", "description": "Monitor for suspicious network traffic patterns emanating from your Label Studio instances to detect potential exploitation.", "relevance": "High", "related": [{"id": "technique", "role": "mitigates"}]}]}, "technical_analysis": {"Introduction": "The CVE-2024-26152 vulnerability is a Cross-Site Scripting (XSS) vulnerability in Label Studio, affecting all versions prior to 1.11.0. This vulnerability allows an attacker to inject malicious scripts into the application and potentially exploit sensitive information.", "Impact and Scope": "The vulnerability has a CVSS score of 4.7, with a high severity rating. It can be exploited through unvalidated user input, and a successful attack could result in remote code execution, data theft, or other malicious activities.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including Command and Control, Initial Access, and Rootkit.", "Technical Details": "The vulnerability is in the data import feature of Label Studio, which fails to properly sanitize user input. An attacker can inject malicious scripts into the application by uploading a specially crafted file.", "Detection": "Detection of this vulnerability involves monitoring for suspicious network traffic and known malicious scripts. IDS/IPS rules can be created to detect and block suspicious traffic.", "Mitigation": "The vulnerability can be mitigated by upgrading to Label Studio 1.11.0 or later. Additionally, implementing web application firewall (WAF) rules and monitoring for suspicious network traffic can help detect and prevent exploitation.", "Conclusion": "The CVE-2024-26152 vulnerability is a significant risk to Label Studio users. To mitigate this risk, it is essential to upgrade to a patched version of the application and implement additional security measures."}, "executive_analysis": {"Overview": "The CVE-2024-26152 vulnerability is a serious security risk for Label Studio users. It allows an attacker to inject malicious scripts into the application, potentially leading to remote code execution, data theft, or other malicious activities.", "Business Impact": "The vulnerability could result in significant business impacts, including data breaches, reputational damage, and financial losses.", "Technical Impact": "The vulnerability could also have technical impacts, including the need for costly remediation and reconstruction of compromised data.", "Mitigation Strategies": "The primary mitigation strategy is to upgrade to Label Studio 1.11.0 or later. Additionally, implementing web application firewall (WAF) rules and monitoring for suspicious network traffic can help detect and prevent exploitation.", "Recommendations": "We recommend that all Label Studio users upgrade to the latest patched version and implement additional security measures to detect and prevent exploitation.", "Conclusions": "The CVE-2024-26152 vulnerability is a serious security risk that requires immediate attention. We urge all Label Studio users to take necessary steps to mitigate this risk and protect their data and applications."}}