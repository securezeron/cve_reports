{"id": "CVE-2024-45304", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-31T00:15:05.493", "lastModified": "2024-09-03T12:59:02.453", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Cairo-Contracts are OpenZeppelin Contracts written in Cairo for Starknet, a decentralized ZK Rollup. This vulnerability can lead to unauthorized ownership transfer, contrary to the original owner's intention of leaving the contract without an owner. It introduces a security risk where an unintended party (pending owner) can gain control of the contract after the original owner has renounced ownership. This could also be used by a malicious owner to simulate leaving a contract without an owner, to later regain ownership by previously having proposed himself as a pending owner. This issue has been addressed in release version 0.16.0. All users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Los contratos Cairo son contratos OpenZeppelin escritos en Cairo para Starknet, un ZK Rollup descentralizado. Esta vulnerabilidad puede provocar una transferencia de propiedad no autorizada, contraria a la intenci\u00f3n del propietario original de dejar el contrato sin propietario. Introduce un riesgo de seguridad en el que una parte no deseada (propietario pendiente) puede obtener el control del contrato despu\u00e9s de que el propietario original haya renunciado a la propiedad. Esto tambi\u00e9n podr\u00eda ser utilizado por un propietario malintencionado para simular que deja un contrato sin propietario, para luego recuperar la propiedad habi\u00e9ndose propuesto previamente como propietario pendiente. Este problema se ha solucionado en la versi\u00f3n de lanzamiento 0.16.0. Se recomienda a todos los usuarios que actualicen. No existen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-670"}]}], "references": [{"url": "https://github.com/OpenZeppelin/cairo-contracts/commit/ef87d7847980e0cf83f4b7f3ff23e6590fb643ec", "source": "security-advisories@github.com"}, {"url": "https://github.com/OpenZeppelin/cairo-contracts/releases/tag/v0.16.0", "source": "security-advisories@github.com"}, {"url": "https://github.com/OpenZeppelin/cairo-contracts/security/advisories/GHSA-w2px-25pm-2cf9", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2024-45304 - This vulnerability is a classic example of a privilege escalation vulnerability, allowing an attacker to gain control of the Cairo-Contracts contract. This is a common tactic used by attackers to gain unauthorized access to sensitive data and systems."}, {"techniqueID": "TA0002", "comment": "CVE-2024-45304 - This vulnerability is a great example of how a flawed implementation of a critical functionality can lead to unintended consequences. In this case, the vulnerable contract can be exploited to transfer ownership of the contract to an unintended party, leading to unauthorized access and potential data breaches."}, {"techniqueID": "T1199", "comment": "CVE-2024-45304 - An attacker could potentially exploit this vulnerability by crafting a malicious contract that takes advantage of the flawed transfer-of-ownership functionality, leading to unauthorized access and control of the affected contract."}, {"techniqueID": "T1068", "comment": "CVE-2024-45304 - An attacker could potentially use this vulnerability to launch a privilege escalation attack, gaining unauthorized access to sensitive data and systems by exploiting the flawed transfer-of-ownership functionality."}], "stix_bundle": {"id": "CVE-2024-45304", "type": "bundle", "spec_version": "2.1", "objects": [{"id": "CVE-2024-45304", "type": "vulnerability", "name": "Cairo-Contracts Transfer-of-Ownership Vulnerability", "description": "A vulnerability in the Cairo-Contracts library allows an attacker to transfer ownership of a contract to an unintended party, leading to unauthorized access and potential data breaches.", "severity": "medium", "references": [{"id": "https://github.com/OpenZeppelin/cairo-contracts/commit/ef87d7847980e0cf83f4b7f3ff23e6590fb643ec"}]}, {"id": "T1199", "type": "attack-pattern", "name": "Contract Takeover", "description": "An attacker crafts a malicious contract that takes advantage of the flawed transfer-of-ownership functionality, leading to unauthorized access and control of the affected contract.", "kill_chain_phase": "execution", "kill_chain_name": "Mitre ATT&CK"}, {"id": "T1068", "type": "attack-pattern", "name": "Privilege Escalation", "description": "An attacker exploits the flawed transfer-of-ownership functionality to gain unauthorized access to sensitive data and systems, leading to further attacks and data breaches.", "kill_chain_phase": "execution", "kill_chain_name": "Mitre ATT&CK"}]}, "technical_analysis": {"Introduction": "The Cairo-Contracts library is a widely used library for building decentralized applications on the Starknet network. However, a vulnerability in the library's transfer-of-ownership functionality can allow an attacker to gain unauthorized access and control of a contract.", "Impact and Scope": "The vulnerability has a medium severity rating, with a CVSS score of 5.3. It can be exploited by an attacker to gain unauthorized access and control of a contract, leading to potential data breaches and unauthorized transactions.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including TA0001, TA0002, T1199, and T1068.", "Technical Details": "The vulnerability is caused by a flawed implementation of the transfer-of-ownership functionality in the Cairo-Contracts library. An attacker can exploit this vulnerability by crafting a malicious contract that takes advantage of the flawed functionality.", "Detection": "Detection of this vulnerability can be challenging, as it requires analyzing the contract's code and identifying the flawed transfer-of-ownership functionality.", "Mitigation": "The vulnerability can be mitigated by updating to the latest version of the Cairo-Contracts library, which includes a fix for the flawed transfer-of-ownership functionality.", "Conclusion": "The Cairo-Contracts transfer-of-ownership vulnerability is a significant security risk for users of the library. It is essential to update to the latest version of the library to mitigate this risk."}, "executive_analysis": {"Overview": "The Cairo-Contracts transfer-of-ownership vulnerability is a serious security risk for users of the library, allowing an attacker to gain unauthorized access and control of a contract.", "Business Impact": "The vulnerability can lead to unauthorized transactions, data breaches, and potential financial losses for users of the library.", "Technical Impact": "The vulnerability is a technical security risk that requires immediate attention and action to mitigate.", "Mitigation Strategies": "The mitigation strategy is to update to the latest version of the Cairo-Contracts library, which includes a fix for the flawed transfer-of-ownership functionality.", "Recommendations": "We recommend that users of the Cairo-Contracts library update to the latest version as soon as possible to mitigate this risk.", "Conclusions": "The Cairo-Contracts transfer-of-ownership vulnerability is a significant security risk that requires immediate attention and action to mitigate. We recommend that users of the library update to the latest version and implement additional security measures to protect against this vulnerability."}}