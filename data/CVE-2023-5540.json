{"id": "CVE-2023-5540", "sourceIdentifier": "patrick@puiterwijk.org", "published": "2023-11-09T20:15:09.103", "lastModified": "2023-11-16T19:00:37.257", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A remote code execution risk was identified in the IMSCP activity. By default this was only available to teachers and managers."}, {"lang": "es", "value": "Se identific\u00f3 un riesgo de ejecuci\u00f3n remota de c\u00f3digo en la actividad IMSCP. Por defecto, esto s\u00f3lo estaba disponible para profesores y directivos."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "patrick@puiterwijk.org", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}, {"source": "patrick@puiterwijk.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.9.24", "matchCriteriaId": "A2A8D2D9-48FE-417F-8062-65794AA65706"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.11.0", "versionEndExcluding": "3.11.17", "matchCriteriaId": "7C058D38-D206-4BEC-B647-4CD1808A1FC8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.0.11", "matchCriteriaId": "4827B277-0EC2-4254-B6DF-F18475A6253C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.1.0", "versionEndExcluding": "4.1.6", "matchCriteriaId": "E660C47C-2CB3-4B06-B98A-F8EE211F798A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.2.0", "versionEndExcluding": "4.2.3", "matchCriteriaId": "C65020B8-B78E-4B59-B894-3F223D769078"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:fedoraproject:extra_packages_for_enterprise_linux:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "3D9C7598-4BB4-442A-86DF-EEDE041A4CC7"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:38:*:*:*:*:*:*:*", "matchCriteriaId": "CC559B26-5DFC-4B7A-A27C-B77DE755DFF9"}]}]}], "references": [{"url": "http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-79409", "source": "patrick@puiterwijk.org", "tags": ["Patch"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2243432", "source": "patrick@puiterwijk.org", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://moodle.org/mod/forum/discuss.php?d=451581", "source": "patrick@puiterwijk.org", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1027: Remote Service Session Manipulation", "comment": "CVE-2023-5540 is a vulnerability in Moodle's IMSCP activity, allowing remote code execution. This can be exploited using GET requests, making it an attractive target for attackers. Defending against this requires monitoring for suspicious GET requests and implementing rate limiting."}, {"techniqueID": "T1190: Data Validation Errors", "comment": "The vulnerability in IMSCP activity allows for remote code execution. This can be exploited by sending malicious requests, making it essential to validate all incoming data and prevent unwanted execution."}, {"techniqueID": "T1485: Web Shell", "comment": "The vulnerability in IMSCP activity can be used to deploy a web shell, allowing attackers to execute arbitrary code on the server. To prevent this, it's crucial to monitor for web shells and restrict access to sensitive areas of the server."}], "stix_bundle": "Insert STIX 2.1 bundle here", "technical_analysis": {"Introduction": "CVE-2023-5540 is a remote code execution vulnerability in Moodle's IMSCP activity, which allows attackers to execute arbitrary code on the server.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8, with an attack vector of NETWORK and privileges required being LOW. This makes it a high-risk vulnerability, with a high potential for exploitation.", "Related MITRE ATT&CK Techniques": "T1027: Remote Service Session Manipulation, T1190: Data Validation Errors, T1485: Web Shell", "Technical Details": "The vulnerability occurs due to a data validation error in the IMSCP activity, allowing attackers to execute arbitrary code on the server.", "Detection": "Monitor for suspicious GET requests and implement rate limiting to prevent exploitation.", "Mitigation": "Implement rate limiting, monitor for web shells, and restrict access to sensitive areas of the server to prevent exploitation.", "Conclusion": ""}, "executive_analysis": {"Overview": "CVE-2023-5540 is a high-risk vulnerability in Moodle's IMSCP activity, allowing remote code execution and exposing the server to potential attacks.", "Business Impact": "Exploitation of this vulnerability can lead to data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary code on the server, gaining full control over the system.", "Mitigation Strategies": "Implement rate limiting, monitor for web shells, and restrict access to sensitive areas of the server.", "Recommendations": "Update Moodle to a patched version, implement rate limiting, and regularly monitor for suspicious activity.", "Conclusions": "It's essential to prioritize this vulnerability and update Moodle promptly to prevent exploitation and potential attacks."}}