{"id": "CVE-2024-36936", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-30T16:15:16.713", "lastModified": "2024-05-30T18:18:58.870", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nefi/unaccepted: touch soft lockup during memory accept\n\nCommit 50e782a86c98 (\"efi/unaccepted: Fix soft lockups caused by\nparallel memory acceptance\") has released the spinlock so other CPUs can\ndo memory acceptance in parallel and not triggers softlockup on other\nCPUs.\n\nHowever the softlock up was intermittent shown up if the memory of the\nTD guest is large, and the timeout of softlockup is set to 1 second:\n\n RIP: 0010:_raw_spin_unlock_irqrestore\n Call Trace:\n ? __hrtimer_run_queues\n <IRQ>\n ? hrtimer_interrupt\n ? watchdog_timer_fn\n ? __sysvec_apic_timer_interrupt\n ? __pfx_watchdog_timer_fn\n ? sysvec_apic_timer_interrupt\n </IRQ>\n ? __hrtimer_run_queues\n <TASK>\n ? hrtimer_interrupt\n ? asm_sysvec_apic_timer_interrupt\n ? _raw_spin_unlock_irqrestore\n ? __sysvec_apic_timer_interrupt\n ? sysvec_apic_timer_interrupt\n accept_memory\n try_to_accept_memory\n do_huge_pmd_anonymous_page\n get_page_from_freelist\n __handle_mm_fault\n __alloc_pages\n __folio_alloc\n ? __tdx_hypercall\n handle_mm_fault\n vma_alloc_folio\n do_user_addr_fault\n do_huge_pmd_anonymous_page\n exc_page_fault\n ? __do_huge_pmd_anonymous_page\n asm_exc_page_fault\n __handle_mm_fault\n\nWhen the local irq is enabled at the end of accept_memory(), the\nsoftlockup detects that the watchdog on single CPU has not been fed for\na while. That is to say, even other CPUs will not be blocked by\nspinlock, the current CPU might be stunk with local irq disabled for a\nwhile, which hurts not only nmi watchdog but also softlockup.\n\nChao Gao pointed out that the memory accept could be time costly and\nthere was similar report before. Thus to avoid any softlocup detection\nduring this stage, give the softlockup a flag to skip the timeout check\nat the end of accept_memory(), by invoking touch_softlockup_watchdog()."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: efi/unaccepted: toque el bloqueo suave durante la aceptaci\u00f3n de la memoria. El commit 50e782a86c98 (\"efi/unaccepted: solucione los bloqueos suaves causados por la aceptaci\u00f3n de la memoria paralela\") ha liberado el bloqueo de giro para que otras CPU puedan usar la memoria. aceptaci\u00f3n en paralelo y no activa el bloqueo suave en otras CPU. Sin embargo, el bloqueo suave se mostr\u00f3 de forma intermitente si la memoria del TD invitado es grande y el tiempo de espera del bloqueo suave se establece en 1 segundo: RIP: 0010:_raw_spin_unlock_irqrestore Seguimiento de llamadas:? __hrtimer_run_queues ? hrtimer_interrupt? watchdog_timer_fn? __sysvec_apic_timer_interrupt? __pfx_watchdog_timer_fn? sysvec_apic_timer_interrupt  ? __hrtimer_run_queues ? hrtimer_interrupt? asm_sysvec_apic_timer_interrupt? _raw_spin_unlock_irqrestore? __sysvec_apic_timer_interrupt? sysvec_apic_timer_interrupt aceptar_memoria try_to_accept_memory do_huge_pmd_anonymous_page get_page_from_freelist __handle_mm_fault __alloc_pages __folio_alloc? __tdx_hypercall handle_mm_fault vma_alloc_folio do_user_addr_fault do_huge_pmd_anonymous_page exc_page_fault? __do_huge_pmd_anonymous_page asm_exc_page_fault __handle_mm_fault Cuando el irq local est\u00e1 habilitado al final de Accept_memory(), el bloqueo suave detecta que el mecanismo de vigilancia en una sola CPU no ha sido alimentado por un tiempo. Es decir, incluso otras CPU no ser\u00e1n bloqueadas por spinlock, la CPU actual podr\u00eda apestar con el irq local deshabilitado por un tiempo, lo que perjudica no solo al nmi watchdog sino tambi\u00e9n al softlockup. Chao Gao se\u00f1al\u00f3 que la aceptaci\u00f3n de la memoria podr\u00eda llevar mucho tiempo y hubo un informe similar antes. Por lo tanto, para evitar cualquier detecci\u00f3n de softlocup durante esta etapa, proporcione al softlockup una bandera para omitir la verificaci\u00f3n del tiempo de espera al final de Accept_memory(), invocando touch_softlockup_watchdog()."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/1c5a1627f48105cbab81d25ec2f72232bfaa8185", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/781e34b736014188ba9e46a71535237313dcda81", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-36936 - This technique is used to manipulate the Linux kernel, creating a situation where the soft lockup detection is skipped. This can be used as an initial vector for further exploitation."}, {"techniqueID": "T1053", "comment": "CVE-2024-36936 - The lack of timeout check in the watchdog timer can be exploited, allowing an attacker to run arbitrary code in the kernel context."}, {"techniqueID": "T1027", "comment": "CVE-2024-36936 - The vulnerability in the Linux kernel allows an attacker to gain control over the system by manipulating the spinlock mechanism."}, {"techniqueID": "T1134", "comment": "CVE-2024-36936 - The vulnerability in the Linux kernel can be used to create a denial-of-service condition by causing the system to hang indefinitely."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/stix_bundle", "title": "CVE-2024-36936 Bundle", "description": "Bundle for the CVE-2024-36936 vulnerability", "created": "2024-05-30T16:15:16.713", "modified": "2024-05-30T18:18:58.870", "objects": [{"type": "indicator", "id": "https://example.com/indicator", "title": "CVE-2024-36936 Indicator", "description": "Indicator for the CVE-2024-36936 vulnerability", "created": "2024-05-30T16:15:16.713", "modified": "2024-05-30T18:18:58.870", "patternSyntax": "stix_cybox", "pattern": "efi/unaccepted: touch soft lockup during memory accept", "published": true, "granular_markings": [{"category": "identity", "marking_ref": "https://example.com/markref"}]}, {"type": "course_of_action", "id": "https://example.com/course_of_action", "title": "CVE-2024-36936 Course of Action", "description": "Course of action for the CVE-2024-36936 vulnerability", "created": "2024-05-30T16:15:16.713", "modified": "2024-05-30T18:18:58.870", "course_of_action_type": "stop", "targets": [{"type": "identity", "id": "https://example.com/identity"}]}, {"type": "attack_pattern", "id": "https://example.com/attack_pattern", "title": "CVE-2024-36936 Attack Pattern", "description": "Attack pattern for the CVE-2024-36936 vulnerability", "created": "2024-05-30T16:15:16.713", "modified": "2024-05-30T18:18:58.870", "behavior_stream": [{"type": "behavior", "id": "https://example.com/behavior"}]}], "relationship": [{"type": "has_indicator", "id": "https://example.com/relationship", "object_id": "https://example.com/indicator", "related_object_id": "https://example.com/attack_pattern", "relationship_type": "observed-behavior"}]}, "technical_analysis": {"Introduction": "The CVE-2024-36936 vulnerability is a critical issue in the Linux kernel that allows an attacker to manipulate the spinlock mechanism and gain control over the system.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 and an attack vector of network exploit. It affects all systems running the Linux kernel.", "Related MITRE ATT&CK Techniques": "T1190, T1053, T1027, T1134", "Technical Details": "The vulnerability is caused by a lack of timeout check in the watchdog timer, which can be exploited to run arbitrary code in the kernel context.", "Detection": "Detection can be done using tools that monitor system calls and detect malicious behavior.", "Mitigation": "Mitigation strategies include disabling the watchdog timer, updating the Linux kernel, and implementing additional security measures.", "Conclusion": "The CVE-2024-36936 vulnerability is a critical issue that requires immediate attention and action to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-36936 vulnerability is a critical issue that affects all systems running the Linux kernel and has the potential to allow an attacker to gain control over the system.", "Business Impact": "The vulnerability has the potential to impact business operations and data integrity.", "Technical Impact": "The vulnerability has the potential to allow an attacker to gain control over the system and exploit the system for malicious purposes.", "Mitigation Strategies": "Disabling the watchdog timer, updating the Linux kernel, and implementing additional security measures.", "Recommendations": "Recommendations for executives include prioritizing patching and updating the Linux kernel, implementing additional security measures, and monitoring system activity.", "Conclusions": "The CVE-2024-36936 vulnerability is a critical issue that requires immediate attention and action to prevent exploitation."}}