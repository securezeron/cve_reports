{"id": "CVE-2024-28185", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-18T15:15:29.283", "lastModified": "2024-04-18T18:25:55.267", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Judge0 is an open-source online code execution system. The application does not account for symlinks placed inside the sandbox directory, which can be leveraged by an attacker to write to arbitrary files and gain code execution outside of the sandbox. When executing a submission, Judge0 writes a `run_script` to the sandbox directory. The security issue is that an attacker can create a symbolic link (symlink) at the path `run_script` before this code is executed, resulting in the `f.write` writing to an arbitrary file on the unsandboxed system. An attacker can leverage this vulnerability to overwrite scripts on the system and gain code execution outside of the sandbox.\n"}, {"lang": "es", "value": "Judge0 es un sistema de ejecuci\u00f3n de c\u00f3digo en l\u00ednea de c\u00f3digo abierto. La aplicaci\u00f3n no tiene en cuenta los enlaces simb\u00f3licos colocados dentro del directorio de la zona de pruebas, que un atacante puede aprovechar para escribir en archivos arbitrarios y obtener la ejecuci\u00f3n de c\u00f3digo fuera de la zona de pruebas. Al ejecutar un env\u00edo, Judge0 escribe un `run_script` en el directorio sandbox. El problema de seguridad es que un atacante puede crear un enlace simb\u00f3lico (enlace simb\u00f3lico) en la ruta `run_script` antes de que se ejecute este c\u00f3digo, lo que da como resultado que `f.write` escriba en un archivo arbitrario en el sistema sin espacio aislado. Un atacante puede aprovechar esta vulnerabilidad para sobrescribir scripts en el sistema y obtener la ejecuci\u00f3n del c\u00f3digo fuera del entorno limitado."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-59"}, {"lang": "en", "value": "CWE-61"}]}], "references": [{"url": "https://github.com/judge0/judge0/blob/v1.13.0/app/jobs/isolate_job.rb#L197-L201", "source": "security-advisories@github.com"}, {"url": "https://github.com/judge0/judge0/commit/846d5839026161bb299b7a35fd3b2afb107992fc", "source": "security-advisories@github.com"}, {"url": "https://github.com/judge0/judge0/security/advisories/GHSA-h9g2-45c8-89cf", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0005", "comment": "CVE-2024-28185 - The vulnerability can be exploited by attackers using the 'Command and PowerShell' technique. This technique allows the attacker to run arbitrary commands on the compromised system, which can lead to code execution, data theft, and other malicious activities. Defense against this technique can be achieved by implementing strict access controls, monitoring system logs, and detecting and preventing suspicious command execution."}, {"techniqueID": "T1210", "comment": "CVE-2024-28185 - The vulnerability can also be exploited by attackers using the 'File and Directory Discovery' technique. This technique allows the attacker to discover and extract sensitive information from the compromised system, which can be used to further compromise the system or launch subsequent attacks. Defense against this technique can be achieved by implementing strict access controls, monitoring system logs, and detecting and preventing suspicious file and directory access."}, {"techniqueID": "T1078", "comment": "CVE-2024-28185 - The vulnerability can also be exploited by attackers using the 'Exploitation of Public-Facing Application' technique. This technique allows the attacker to exploit publicly facing applications, such as Judge0, to gain access to the compromised system. Defense against this technique can be achieved by implementing robust application security, monitoring application logs, and detecting and preventing suspicious activity."}, {"techniqueID": "T1190", "comment": "CVE-2024-28185 - The vulnerability can also be exploited by attackers using the 'Exploit Public-Facing Application' technique. This technique allows the attacker to exploit publicly facing applications, such as Judge0, to gain access to the compromised system. Defense against this technique can be achieved by implementing robust application security, monitoring application logs, and detecting and preventing suspicious activity."}, {"techniqueID": "T1077", "comment": "CVE-2024-28185 - The vulnerability can also be exploited by attackers using the 'Windows Management Instrumentation (WMI) Execution' technique. This technique allows the attacker to execute arbitrary WMI scripts on the compromised system, which can lead to code execution, data theft, and other malicious activities. Defense against this technique can be achieved by implementing strict access controls, monitoring system logs, and detecting and preventing suspicious WMI activity."}], "stix_bundle": {"type": "stix:Bundle", "id": "https://example.com/CVE-2024-28185", "title": "CVE-2024-28185: Vulnerability in Judge0", "created": "2024-04-18T18:25:55.267", "modified": "2024-04-18T18:25:55.267", "objects": [{"type": "stix:Vulnerability", "id": "https://example.com/CVE-2024-28185", "title": "CVE-2024-28185: Vulnerability in Judge0", "description": "Judge0 is an open-source online code execution system. The application does not account for symlinks placed inside the sandbox directory, which can be leveraged by an attacker to write to arbitrary files and gain code execution outside of the sandbox.", "cwe": ["CWE-59", "CWE-61"], "cvss": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "refs": [{"type": "stix:RelatedObject", "id": "https://example.com/CVE-2024-28185/related-object-1", "relationship": "related_to", "object_ref": "https://example.com/CVE-2024-28185"}]}, {"type": "stix:KillChainPhases", "id": "https://example.com/CVE-2024-28185/kill-chain-phases", "title": "Kill Chain Phases for CVE-2024-28185", "phases": [{"type": "stix:KillChainPhase", "id": "https://example.com/CVE-2024-28185/kill-chain-phase-1", "phase_type": "initial_access", "name": "Initial Access"}, {"type": "stix:KillChainPhase", "id": "https://example.com/CVE-2024-28185/kill-chain-phase-2", "phase_type": "execution", "name": "Execution"}, {"type": "stix:KillChainPhase", "id": "https://example.com/CVE-2024-28185/kill-chain-phase-3", "phase_type": "pivot", "name": "Pivot"}]}, {"type": "stix:CoursesOfAction", "id": "https://example.com/CVE-2024-28185/courses-of-action", "title": "Courses of Action for CVE-2024-28185", "courses_of_action": [{"type": "stix:CourseOfAction", "id": "https://example.com/CVE-2024-28185/course-of-action-1", "name": "Apply patch", "description": "Apply the patch provided by the vendor to fix the vulnerability.", "techniques": ["TA0005", "T1210", "T1078", "T1190", "T1077"]}, {"type": "stix:CourseOfAction", "id": "https://example.com/CVE-2024-28185/course-of-action-2", "name": "Implement mitigations", "description": "Implement mitigations, such as strict access controls and monitoring system logs, to detect and prevent the exploitation of the vulnerability.", "techniques": ["TA0005", "T1210", "T1078", "T1190", "T1077"]}]}]}, "technical_analysis": {"Introduction": "The vulnerability, CVE-2024-28185, is a remote code execution vulnerability in Judge0. The vulnerability allows an attacker to write to arbitrary files on the system, gain code execution outside of the sandbox, and potentially take control of the system.", "Impact and Scope": "The impact and scope of the vulnerability are significant. An attacker can exploit the vulnerability to gain control of the system, steal sensitive information, and launch further attacks.", "Related MITRE ATT&CK Techniques": "The vulnerability can be exploited using various MITRE ATT&CK techniques, including TA0005, T1210, T1078, T1190, and T1077.", "Technical Details": "The vulnerability is due to the lack of proper input validation in Judge0. An attacker can exploit the vulnerability by sending a carefully crafted input to Judge0, which can lead to the execution of arbitrary code on the system.", "Detection": "The detection of the vulnerability is challenging. However, it can be detected by monitoring system logs, monitoring for suspicious network traffic, and detecting and preventing suspicious file and directory access.", "Mitigation": "The mitigation of the vulnerability is essential. It can be achieved by applying the patch provided by the vendor, implementing strict access controls, monitoring system logs, and detecting and preventing suspicious file and directory access.", "Conclusion": "In conclusion, the vulnerability, CVE-2024-28185, is a significant vulnerability that can be exploited by attackers to gain control of the system, steal sensitive information, and launch further attacks. The mitigation of the vulnerability is essential, and it can be achieved by applying the patch provided by the vendor, implementing strict access controls, monitoring system logs, and detecting and preventing suspicious file and directory access."}, "executive_analysis": {"Overview": "The vulnerability, CVE-2024-28185, is a remote code execution vulnerability in Judge0 that can be exploited by attackers to gain control of the system, steal sensitive information, and launch further attacks.", "Business Impact": "The business impact of the vulnerability is significant. It can lead to the loss of sensitive information, downtime, and financial losses.", "Technical Impact": "The technical impact of the vulnerability is significant. It can lead to the compromise of sensitive information, unauthorized access to systems, and further attacks.", "Mitigation Strategies": "The mitigation of the vulnerability requires swift action. Implementing strict access controls, monitoring system logs, and detecting and preventing suspicious file and directory access can help prevent the exploitation of the vulnerability.", "Recommendations": "Recommendations for executives include implementing mitigation strategies, monitoring system logs, and detecting and preventing suspicious file and directory access. It is also essential to ensure that the system is up-to-date with the latest patches and security updates.", "Conclusions": "In conclusion, the vulnerability, CVE-2024-28185, is a significant vulnerability that requires swift mitigation. The business and technical impacts of the vulnerability are significant, and it is essential to take action to prevent the exploitation of the vulnerability."}}