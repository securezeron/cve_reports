{"id": "CVE-2024-31460", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-14T15:25:26.897", "lastModified": "2024-06-10T17:16:26.390", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Cacti provides an operational monitoring and fault management framework. Prior to version 1.2.27, some of the data stored in `automation_tree_rules.php` is not thoroughly checked and is used to concatenate the SQL statement in `create_all_header_nodes()`  function from `lib/api_automation.php` , finally resulting in SQL injection. Using SQL based secondary injection technology, attackers can modify the contents of the Cacti database, and based on the modified content, it may be possible to achieve further impact, such as arbitrary file reading, and even remote code execution through arbitrary file writing. Version 1.2.27 contains a patch for the issue."}, {"lang": "es", "value": "Cacti proporciona un framework de monitoreo operativo y gesti\u00f3n de fallas. Antes de la versi\u00f3n 1.2.27, algunos de los datos almacenados en `automation_tree_rules.php` no se verifican minuciosamente y se usan para concatenar la declaraci\u00f3n SQL en la funci\u00f3n `create_all_header_nodes()` de `lib/api_automation.php`, lo que finalmente da como resultado SQL inyecci\u00f3n. Al utilizar la tecnolog\u00eda de inyecci\u00f3n secundaria basada en SQL, los atacantes pueden modificar el contenido de la base de datos de Cacti y, en funci\u00f3n del contenido modificado, es posible lograr un mayor impacto, como la lectura de archivos arbitrarios e incluso la ejecuci\u00f3n remota de c\u00f3digo mediante la escritura de archivos arbitrarios. La versi\u00f3n 1.2.27 contiene un parche para el problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-89"}]}], "references": [{"url": "https://github.com/Cacti/cacti/security/advisories/GHSA-cx8g-hvq8-p2rv", "source": "security-advisories@github.com"}, {"url": "https://github.com/Cacti/cacti/security/advisories/GHSA-gj3f-p326-gh8r", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/RBEOAFKRARQHTDIYSL723XAFJ2Q6624X/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-31460 - Insufficient Input Validation allows remote attackers to inject SQL code, leading to arbitrary file reading and writing, and potentially remote code execution."}, {"techniqueID": "T1055", "comment": "CVE-2024-31460 - Successful exploitation of this vulnerability may lead to the exfiltration of sensitive data, which may be used to further tactics such as spear phishing or identity theft."}, {"techniqueID": "T1190", "comment": "CVE-2024-31460 - Defenders can use techniques such as Web Application Firewalls (WAF) to block malicious traffic and prevent SQL injection attacks."}, {"techniqueID": "T1204", "comment": "CVE-2024-31460 - Network defenders can monitor for unusual database queries and detect signs of SQL injection attacks."}], "stix_bundle": {"type": "bundle", "id": "bundle--14b7e68e-76e7-46e4-a7d5-3b1f3c67ce91", "created_by_ref": "identity--302aeb74-f2b3-4a9d-b4ca-b9464f6b7a3a", "modified": "2024-06-10T17:16:26.390", "objects": [{"type": "vulnerability", "id": "vulnerability--cve-2024-31460", "name": "CWE-89 SQL Injection", "description": "CWE-89 SQL Injection in Cacti prior to version 1.2.27", "severity": "MEDIUM", "risk_factor": "HIGH", "published": "2024-05-14T15:25:26.897", "updated": "2024-06-10T17:16:26.390", "malware_refs": [], "exploit_refs": []}, {"type": "campaign", "id": "campaign--sql-injection-campaign", "name": "SQL Injection Campaign", "description": "Campaign targeting SQL Injection vulnerabilities", "start_date": "2024-05-14T15:25:26.897", "end_date": null, "target_desc": "Cacti servers prior to version 1.2.27", "notes": "This campaign is detected through monitoring SQL injection attacks"}], "relationships": [{"type": "related_to", "id": "rel--cve-2024-31460-related-to-sql-injection-campaign", "source_ref": "vulnerability--cve-2024-31460", "target_ref": "campaign--sql-injection-campaign", "relationship_type": "related_to"}]}, "technical_analysis": {"Introduction": "CWE-89 SQL Injection in Cacti prior to version 1.2.27", "Impact and Scope": "CVE-2024-31460 - CVSS score 6.5, attack vector NETWORK, confidentiality impact NONE, integrity impact HIGH, availability impact NONE", "Related MITRE ATT&CK Techniques": "T1027, T1055, T1190, T1204", "Technical Details": "In-depth technical details of the CVE-2024-31460", "Detection": "Methods for detecting the CVE-2024-31460", "Mitigation": "Mitigation strategies for CVE-2024-31460", "Conclusion": "Summary and conclusions."}, "executive_analysis": {"Overview": "Overview of the CVE-2024-31460", "Business Impact": "Explanation of the business impact of the CVE-2024-31460", "Technical Impact": "Explanation of the technical impact of the CVE-2024-31460", "Mitigation Strategies": "High-level mitigation strategies", "Recommendations": "Recommendations for executives", "Conclusions": "Final conclusions and next steps"}}