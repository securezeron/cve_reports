{"id": "CVE-2023-52743", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-21T16:15:14.157", "lastModified": "2024-05-21T16:53:56.550", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nice: Do not use WQ_MEM_RECLAIM flag for workqueue\n\nWhen both ice and the irdma driver are loaded, a warning in\ncheck_flush_dependency is being triggered. This is due to ice driver\nworkqueue being allocated with the WQ_MEM_RECLAIM flag and the irdma one\nis not.\n\nAccording to kernel documentation, this flag should be set if the\nworkqueue will be involved in the kernel's memory reclamation flow.\nSince it is not, there is no need for the ice driver's WQ to have this\nflag set so remove it.\n\nExample trace:\n\n[  +0.000004] workqueue: WQ_MEM_RECLAIM ice:ice_service_task [ice] is flushing !WQ_MEM_RECLAIM infiniband:0x0\n[  +0.000139] WARNING: CPU: 0 PID: 728 at kernel/workqueue.c:2632 check_flush_dependency+0x178/0x1a0\n[  +0.000011] Modules linked in: bonding tls xt_CHECKSUM xt_MASQUERADE xt_conntrack ipt_REJECT nf_reject_ipv4 nft_compat nft_cha\nin_nat nf_nat nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 nf_tables nfnetlink bridge stp llc rfkill vfat fat intel_rapl_msr intel\n_rapl_common isst_if_common skx_edac nfit libnvdimm x86_pkg_temp_thermal intel_powerclamp coretemp kvm_intel kvm irqbypass crct1\n0dif_pclmul crc32_pclmul ghash_clmulni_intel rapl intel_cstate rpcrdma sunrpc rdma_ucm ib_srpt ib_isert iscsi_target_mod target_\ncore_mod ib_iser libiscsi scsi_transport_iscsi rdma_cm ib_cm iw_cm iTCO_wdt iTCO_vendor_support ipmi_ssif irdma mei_me ib_uverbs\nib_core intel_uncore joydev pcspkr i2c_i801 acpi_ipmi mei lpc_ich i2c_smbus intel_pch_thermal ioatdma ipmi_si acpi_power_meter\nacpi_pad xfs libcrc32c sd_mod t10_pi crc64_rocksoft crc64 sg ahci ixgbe libahci ice i40e igb crc32c_intel mdio i2c_algo_bit liba\nta dca wmi dm_mirror dm_region_hash dm_log dm_mod ipmi_devintf ipmi_msghandler fuse\n[  +0.000161]  [last unloaded: bonding]\n[  +0.000006] CPU: 0 PID: 728 Comm: kworker/0:2 Tainted: G S                 6.2.0-rc2_next-queue-13jan-00458-gc20aabd57164 #1\n[  +0.000006] Hardware name: Intel Corporation S2600WFT/S2600WFT, BIOS SE5C620.86B.02.01.0010.010620200716 01/06/2020\n[  +0.000003] Workqueue: ice ice_service_task [ice]\n[  +0.000127] RIP: 0010:check_flush_dependency+0x178/0x1a0\n[  +0.000005] Code: 89 8e 02 01 e8 49 3d 40 00 49 8b 55 18 48 8d 8d d0 00 00 00 48 8d b3 d0 00 00 00 4d 89 e0 48 c7 c7 e0 3b 08\n9f e8 bb d3 07 01 <0f> 0b e9 be fe ff ff 80 3d 24 89 8e 02 00 0f 85 6b ff ff ff e9 06\n[  +0.000004] RSP: 0018:ffff88810a39f990 EFLAGS: 00010282\n[  +0.000005] RAX: 0000000000000000 RBX: ffff888141bc2400 RCX: 0000000000000000\n[  +0.000004] RDX: 0000000000000001 RSI: dffffc0000000000 RDI: ffffffffa1213a80\n[  +0.000003] RBP: ffff888194bf3400 R08: ffffed117b306112 R09: ffffed117b306112\n[  +0.000003] R10: ffff888bd983088b R11: ffffed117b306111 R12: 0000000000000000\n[  +0.000003] R13: ffff888111f84d00 R14: ffff88810a3943ac R15: ffff888194bf3400\n[  +0.000004] FS:  0000000000000000(0000) GS:ffff888bd9800000(0000) knlGS:0000000000000000\n[  +0.000003] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[  +0.000003] CR2: 000056035b208b60 CR3: 000000017795e005 CR4: 00000000007706f0\n[  +0.000003] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\n[  +0.000003] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\n[  +0.000002] PKRU: 55555554\n[  +0.000003] Call Trace:\n[  +0.000002]  <TASK>\n[  +0.000003]  __flush_workqueue+0x203/0x840\n[  +0.000006]  ? mutex_unlock+0x84/0xd0\n[  +0.000008]  ? __pfx_mutex_unlock+0x10/0x10\n[  +0.000004]  ? __pfx___flush_workqueue+0x10/0x10\n[  +0.000006]  ? mutex_lock+0xa3/0xf0\n[  +0.000005]  ib_cache_cleanup_one+0x39/0x190 [ib_core]\n[  +0.000174]  __ib_unregister_device+0x84/0xf0 [ib_core]\n[  +0.000094]  ib_unregister_device+0x25/0x30 [ib_core]\n[  +0.000093]  irdma_ib_unregister_device+0x97/0xc0 [irdma]\n[  +0.000064]  ? __pfx_irdma_ib_unregister_device+0x10/0x10 [irdma]\n[  +0.000059]  ? up_write+0x5c/0x90\n[  +0.000005]  irdma_remove+0x36/0x90 [irdma]\n[  +0.000062]  auxiliary_bus_remove+0x32/0x50\n[  +0.000007]  device_r\n---truncated---"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: ice: no utilice el indicador WQ_MEM_RECLAIM para la cola de trabajo. Cuando se cargan ice y el controlador irdma, se activa una advertencia en check_flush_dependency. Esto se debe a que la cola de trabajo del controlador de hielo est\u00e1 asignada con el indicador WQ_MEM_RECLAIM y el de irdma no. Seg\u00fan la documentaci\u00f3n del kernel, este indicador debe establecerse si la cola de trabajo participar\u00e1 en el flujo de recuperaci\u00f3n de memoria del kernel. Como no es as\u00ed, no es necesario que el WQ del conductor de hielo tenga esta bandera configurada, as\u00ed que elim\u00ednela. Seguimiento de ejemplo: [+0.000004] cola de trabajo: WQ_MEM_RECLAIM ice:ice_service_task [ice] se est\u00e1 vaciando! WQ_MEM_RECLAIM infiniband:0x0 [+0.000139] ADVERTENCIA: CPU: 0 PID: 728 en kernel/workqueue.c:2632 check_flush_dependency+0x178/0x1a0 [ + 0.000011] M\u00f3dulos vinculados en: vinculaci\u00f3n tls xt_CHECKSUM xt_MASQUERADE xt_conntrack ipt_REJECT nf_reject_ipv4 nft_compat nft_cha in_nat nf_nat nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 nf_tables nfnetlink bridge stp llc fkill vfat fat intel_rapl_msr intel _rapl_common isst_if_common skx_edac nfit libnvdimm x86_pkg_temp_thermal intel_powerclamp coretemp kvm_intel kvm irqbypass crct1 0dif_pclmul crc32_pclmul ghash_clmulni_intel rapl intel_cstate rpcrdma sunrpc ucm ib_srpt ib_isert iscsi_target_mod target_ core_mod ib_iser libiscsi scsi_transport_iscsi rdma_cm ib_cm iw_cm iTCO_wdt iTCO_vendor_support ipmi_ssif irdma mei_me ib_uverbs ib_core intel_uncore joydev pcspkr i2c_i801 acpi_ipmi mei lpc_ich i2c_smbus intel_pch_thermal ioatdma ipmi_si acpi_power_meter acpi_pad xfs libcrc32c sd_mod t10_pi crc64_rocksoft crc64 sg ahci ixgbe libahci ice i40e igb crc32c_intel mdio i2c_algo_bit liba ta dca wmi dm_mirror dm_region_hash dm_log dm_mod ipmi_devintf ipmi_msghandler fuse [+0.000161] [\u00faltima descarga: uni\u00f3n] [+0.000006] CPU: 0 PID: 728 Comm: kworker/0:2 Contaminado: GS 6.2.0-rc2_next-queue-13jan-0045 8- gc20aabd57164 #1 [ +0.000006] Nombre del hardware: Intel Corporation S2600WFT/S2600WFT, BIOS SE5C620.86B.02.01.0010.010620200716 06/01/2020 [ +0.000003] Cola de trabajo: ice ice_service_task [ice] [ +0.00 0127] RIP: 0010:check_flush_dependency+ 0x178/0x1a0 [ +0.000005] C\u00f3digo: 89 8e 02 01 e8 49 3d 40 00 49 8b 55 18 48 8d 8d d0 00 00 00 48 8d b3 d0 00 00 00 4d 89 e0 48 c7 c7 e0 3b 08 9f e8 bb d3 07 01 &lt;0f&gt; 0b e9 be fe ff ff 80 3d 24 89 8e 02 00 0f 85 6b ff ff ff e9 06 [ +0.000004] RSP: 0018:ffff88810a39f990 EFLAGS: 00010282 [ +0.000005] RAX: 000000000000000 RBX: ffff888141bc2400 RCX: 0000000000000000 [ +0.000004] RDX: 0000000000000001 RSI: dffffc0000000000 RDI: ffffffffa1213a80 [ +0.000003] RBP: ffff888194bf3400 R08: fffffed117b306112 R09: 306112 [ +0.000003] R10: ffff888bd983088b R11: ffffed117b306111 R12: 0000000000000000 [ +0.000003] R13: ffff888111f84d00 R14: 15 : ffff888194bf3400 [ +0.000004] FS: 0000000000000000(0000) GS:ffff888bd9800000(0000) knlGS:00000000000000000 [ +0.000003] CS: 0010 DS: 0000 0000 CR0: 0000000080050033 [+0.000003] CR2: 000056035b208b60 CR3: 000000017795e005 CR4: 00000000007706f0 [ +0.000003] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 [ +0.000003] DR3: 00000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400 [ +0.000002] PKRU: 55555554 [ +0.000003] Seguimiento de llamadas: [ +0.000002]  [ +0.000003 ] __flush_workqueue+0x203/0x840 [ +0.000006] ? mutex_unlock+0x84/0xd0 [+0.000008]? __pfx_mutex_unlock+0x10/0x10 [+0.000004]? __pfx___flush_workqueue+0x10/0x10 [+0.000006]? mutex_lock+0xa3/0xf0 [ +0.000005] ib_cache_cleanup_one+0x39/0x190 [ib_core] [ +0.000174] __ib_unregister_device+0x84/0xf0 [ib_core] [ +0.000094] ib_unregister_device+0x25/0x30 [ib_core] [ + 0.000093] irdma_ib_unregister_device+0x97/0xc0 [irdma] [ +0.000064] ? __pfx_irdma_ib_unregister_device+0x10/0x10 [irdma] [ +0.000059] ? up_write+0x5c/0x90 [ +0.000005] irdma_remove+0x36/0x90 [irdma] [ +0.000062] auxiliar_bus_remove+0x32/0x50 [ +0.000007] dispositivo_r ---truncado---"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/1ad4112c9fcf0bc08222b2b1614fba52ffd12255", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/4d159f7884f78b1aacb99b4fc37d1e3cb1194e39", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/87a5e3fc8416106e290c448fc8a6dd50ab24c634", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ca834a017851c50464c25a85f3cb2daefff7bede", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/df59e05401450973c8c7e96fd74b49e24442dc1f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1110", "comment": "CVE-2023-52743 - This technique can be used to elevate privileges by exploiting the vulnerability in the Linux kernel, allowing an attacker to regain control of the system."}, {"techniqueID": "T1078", "comment": "CVE-2023-52743 - This technique can be used to disable security tools and services, making it easier for an attacker to maintain persistence on the system."}, {"techniqueID": "T1490", "comment": "CVE-2023-52743 - This technique can be used to conceal actions and payloads, making it harder for defenders to detect the attack."}], "stix_bundle": "{\"stype\":\"bundle\",\"id\":\"CVE-2023-52743\",\"objects\":[{\n\"type\":\"indicator\",\"id\":\"ind-1\",\"name\":\"CVE-2023-52743\",\"description\":\"Linux kernel vulnerability\",\"external_references\":{\"src\":{\"value\":\"https://git.kernel.org/stable/c/1ad4112c9fcf0bc08222b2b1614fba52ffd12255\"},\"source_name\":\"416baaa9-dc9f-4396-8d5f-8c081fb06d67\"}\n},{\"type\":\"attack_pattern\",\"id\":\"ap-1\",\"name\":\"Elevate Privileges\",\"description\":\"Technique used to elevate privileges on a system\",\" kill_chain_phases\":[{\"id\":\"Phase1\",\"name\":\"Reconnaissance\"}],\"external_references\":{\"src\":{\"value\":\"https://attack.mitre.org/techniques/T1110\"},\"source_name\":\"MITRE\"}\n},{\"type\":\"attack_pattern\",\"id\":\"ap-2\",\"name\":\"Disable Security Tools\",\"description\":\"Technique used to disable security tools and services on a system\",\"kill_chain_phases\":[{\"id\":\"Phase1\",\"name\":\"Delivery\"}],\"external_references\":{\"src\":{\"value\":\"https://attack.mitre.org/techniques/T1078\"},\"source_name\":\"MITRE\"}\n},{\"type\":\"attack_pattern\",\"id\":\"ap-3\",\"name\":\"Conceal Actions\",\"description\":\"Technique used to conceal actions and payloads on a system\",\"kill_chain_phases\":[{\"id\":\"Phase1\",\"name\":\"Command and Control\"}],\"external_references\":{\"src\":{\"value\":\"https://attack.mitre.org/techniques/T1490\"},\"source_name\":\"MITRE\"}\n},{\"type\":\"course_of_action\",\"id\":\"coa-1\",\"name\":\"Detect and Monitor\",\"title\":\"Detect and monitor system activities to identify suspicious behavior\",\"description\":\"Use logging and monitoring tools to detect and alert on suspicious system activities.\",\"kill_chain_phases\":[{\"id\":\"Phase1\",\"name\":\"Reconnaissance\"}],\"notes\":[{\"id\":\"note-1\",\"text\":\"Use logs from system services and network traffic to identify suspicious behavior\"}],\"external_references\":{\"src\":{\"value\":\"https://attack.mitre.org/mitigation/Detect-and-Monitor\"},\"source_name\":\"MITRE\"}\n},{\"type\":\"course_of_action\",\"id\":\"coa-2\",\"name\":\"Implement Security Patches\",\"title\":\"Implement security patches for vulnerable systems\",\"description\":\"Apply security patches to vulnerable systems to prevent exploitation.\",\"kill_chain_phases\":[{\"id\":\"Phase1\",\"name\":\"Vulnerability\"}],\"notes\":[{\"id\":\"note-2\",\"text\":\"Regularly apply security patches to stay up-to-date with the latest security fixes\"}],\"external_references\":{\"src\":{\"value\":\"https://attack.mitre.org/mitigation/Implement-Security-Patches\"},\"source_name\":\"MITRE\"}\n}],\"relationship\":\"part_of\",\"version\":\"2.1\"}", "technical_analysis": {"Introduction": "The CVE-2023-52743 vulnerability in the Linux kernel allows an attacker to exploit a privilege escalation vulnerability, which can be used to gain elevated privileges on a system.", "Impact and Scope": "CVSS Score: 7.8, CVSS Version: 3.1, Attack Vector: Network, Impact: Partial.", "Related MITRE ATT&CK Techniques": "T1110, T1078, T1490", "Technical Details": "The vulnerability occurs in the Linux kernel's workqueue management code, allowing an attacker to exploit a privilege escalation vulnerability.", "Detection": "Monitor system logs for suspicious activity, such as unusual changes to system configurations or access to sensitive data.", "Mitigation": "Apply security patches to vulnerable systems, implement logging and monitoring tools, and restrict access to sensitive data.", "Conclusion": "In conclusion, the CVE-2023-52743 vulnerability in the Linux kernel is a critical vulnerability that can be exploited to gain elevated privileges on a system. It is essential to apply security patches and implement logging and monitoring tools to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2023-52743 vulnerability in the Linux kernel poses a significant risk to system security and data integrity.", "Business Impact": "The vulnerability can be exploited to gain elevated privileges on a system, which can lead to unauthorized access to sensitive data and disruption of business operations.", "Technical Impact": "The vulnerability occurs in the Linux kernel's workqueue management code, making it a critical vulnerability that requires immediate attention.", "Mitigation Strategies": "Apply security patches, implement logging and monitoring tools, and restrict access to sensitive data.", "Recommendations": "CISOs and IT leaders should prioritize the application of security patches and implementation of logging and monitoring tools to prevent exploitation.", "Conclusions": "In conclusion, the CVE-2023-52743 vulnerability in the Linux kernel is a critical vulnerability that requires immediate attention and action to prevent exploitation."}}