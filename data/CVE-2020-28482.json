{"id": "CVE-2020-28482", "sourceIdentifier": "report@snyk.io", "published": "2021-01-19T15:15:12.153", "lastModified": "2022-06-28T14:11:45.273", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "This affects the package fastify-csrf before 3.0.0. 1. The generated cookie used insecure defaults, and did not have the httpOnly flag on: cookieOpts: { path: '/', sameSite: true } 2. The CSRF token was available in the GET query parameter"}, {"lang": "es", "value": "Esto afecta al paquete fastify-csrf versiones anteriores a 3.0.0.&#xa0;1. La cookie generada us\u00f3 valores predeterminados no seguros y no ten\u00eda el flag httpOnly en: cookieOpts: { path: '/', sameSite: true } 2. El token CSRF estaba disponible en el par\u00e1metro de consulta GET"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "report@snyk.io", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 4.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}, {"lang": "en", "value": "CWE-732"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:fastify:fastify-csrf:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "3.0.0", "matchCriteriaId": "C8D8AE42-616B-4879-BD90-1E9BA68DFF46"}]}]}], "references": [{"url": "https://github.com/fastify/fastify-csrf/pull/26", "source": "report@snyk.io", "tags": ["Third Party Advisory"]}, {"url": "https://snyk.io/vuln/SNYK-JS-FASTIFYCSRF-1062044", "source": "report@snyk.io", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-28482 - This vulnerability can be exploited by an attacker to gain unauthorized access to fastify-csrf, allowing them to steal sensitive data or inject malicious code. This technique can be mitigated by properly configuring cookie options and ensuring the CSRF token is not available in the GET query parameter."}, {"techniqueID": "T1567.2", "comment": "CVE-2020-28482 - This technique can be used by attackers to exploit the vulnerability and inject malicious code or steal sensitive data. Proper configuration of cookie options and ensuring the CSRF token is not available in the GET query parameter can help mitigate this technique."}, {"techniqueID": "T1189", "comment": "CVE-2020-28482 - This technique can be used by attackers to exploit the vulnerability and gain unauthorized access to sensitive data. Proper configuration of cookie options and ensuring the CSRF token is not available in the GET query parameter can help mitigate this technique."}], "technical_analysis": {"Introduction": "CVE-2020-28482 is a vulnerability in the fastify-csrf package that allows attackers to steal sensitive data or inject malicious code by exploiting the insecure default configuration of the cookie options and the availability of the CSRF token in the GET query parameter.", "Impact and Scope": "This vulnerability has a CVSS score of 8.8 and an attack vector of NETWORK. It has a high impact on confidentiality, integrity, and availability.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190, T1567.2, and T1189, which can be used by attackers to exploit the vulnerability and gain unauthorized access to sensitive data.", "Technical Details": "The vulnerability is caused by the insecure default configuration of the cookie options and the availability of the CSRF token in the GET query parameter. This allows attackers to steal sensitive data or inject malicious code.", "Detection": "The vulnerability can be detected by monitoring for suspicious network traffic and inspecting cookie options and query parameters.", "Mitigation": "The vulnerability can be mitigated by properly configuring cookie options and ensuring the CSRF token is not available in the GET query parameter.", "Conclusion": "CVE-2020-28482 is a high-severity vulnerability that can be exploited by attackers to gain unauthorized access to sensitive data. Proper configuration of cookie options and ensuring the CSRF token is not available in the GET query parameter can help mitigate this vulnerability."}, "executive_analysis": {"Overview": "CVE-2020-28482 is a vulnerability in the fastify-csrf package that allows attackers to steal sensitive data or inject malicious code.", "Business Impact": "This vulnerability can have a significant impact on the business, as it can allow attackers to steal sensitive data or inject malicious code, which can compromise the security and integrity of the organization.", "Technical Impact": "The vulnerability can have a high impact on the technical aspects of the organization, as it can allow attackers to gain unauthorized access to sensitive data and inject malicious code.", "Mitigation Strategies": "Proper configuration of cookie options and ensuring the CSRF token is not available in the GET query parameter can help mitigate this vulnerability.", "Recommendations": "The recommended course of action is to properly configure cookie options and ensure the CSRF token is not available in the GET query parameter.", "Conclusions": "CVE-2020-28482 is a high-severity vulnerability that requires immediate attention and action to mitigate the risk of exploitation."}}