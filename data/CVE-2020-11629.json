{"id": "CVE-2020-11629", "sourceIdentifier": "cve@mitre.org", "published": "2020-04-08T00:15:11.393", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered in EJBCA before 6.15.2.6 and 7.x before 7.3.1.2. The External Command Certificate Validator, which allows administrators to upload external linters to validate certificates, is supposed to save uploaded test certificates to the server. An attacker who has gained access to the CA UI could exploit this to upload malicious scripts to the server. (Risks associated with this issue alone are negligible unless a malicious user already has gained access to the CA UI through other means, as a trusted user is already trusted to upload scripts by virtue of having access to the validator.)"}, {"lang": "es", "value": "Se detect\u00f3  un problema en EJBCA versiones anteriores a 6.15.2.6 y versiones 7.x anteriores a 7.3.1.2.  El External Command Certificate Validator, permite a administradores cargar linters externos para comprobar certificados, es de suponer que guarda los certificados de prueba cargados en el servidor. Un atacante que haya conseguido acceso a la Interfaz de Usuario de CA podr\u00eda explotar esto para cargar scripts maliciosos en el servidor. (Los riesgos asociados con este problema por s\u00ed solos son insignificantes a menos que un usuario malicioso ya haya conseguido acceso a la Interfaz de Usuario de CA mediante otros medios, ya que un usuario confiable ya es confiable para cargar scripts en virtud de tener acceso al comprobador)."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-522"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:primekey:ejbca:*:*:*:*:enterprise:*:*:*", "versionEndExcluding": "6.15.2.6", "matchCriteriaId": "736F366E-25F7-4366-A522-35127922E74E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:primekey:ejbca:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "7.0.0", "versionEndExcluding": "7.3.1.2", "matchCriteriaId": "948B0043-AAFB-48B4-A120-2683A3831AB3"}]}]}], "references": [{"url": "https://support.primekey.com/news/primekey-announcements", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1204", "comment": "CVE-2020-11629 - Command Injection: An attacker who has gained access to the CA UI could exploit this to upload malicious scripts to the server, which could lead to arbitrary code execution. This technique is relevant to this CVE as it allows an attacker to execute arbitrary code on the server, which could potentially lead to data breaches or system compromise."}, {"techniqueID": "T1047", "comment": "CVE-2020-11629 - Web Shell: An attacker who has gained access to the CA UI could upload a web shell to the server, which would allow them to execute arbitrary commands on the server, access sensitive data, or take control of the server."}], "stix_bundle": {"stix_violations": [{"id": "cve-2020-11629", "type": "vulnerability", "name": "EJBCA Before 6.15.2.6 and 7.x Before 7.3.1.2 Certificate Validator Remote Code Execution Vulnerability", "description": "An issue was discovered in EJBCA before 6.15.2.6 and 7.x before 7.3.1.2. The External Command Certificate Validator, which allows administrators to upload external linters to validate certificates, is supposed to save uploaded test certificates to the server. An attacker who has gained access to the CA UI could exploit this to upload malicious scripts to the server.", "severity": "high", "references": [{"id": "CVE-2020-11629", "url": "https://support.primekey.com/news/primekey-announcements", "category": "Vendor Advisory"}], "relationships": {"exploited_by": {"technique": {"id": "T1204", "description": "Command Injection"}}}, "d3fend_tactics": {" Mitigation": {"identify": {"technique": {"id": "Evasion Technique", "description": "Evasion Technique"}}}}}]}, "technical_analysis": {"Introduction": "The CVE-2020-11629 vulnerability is a remote code execution vulnerability in EJBCA before 6.15.2.6 and 7.x before 7.3.1.2.", "Impact and Scope": "The vulnerability allows an attacker who has gained access to the CA UI to upload malicious scripts to the server, which could lead to arbitrary code execution, data breaches, or system compromise.", "Related MITRE ATT&CK Techniques": "T1204 and T1047", "Technical Details": "The vulnerability occurs in the External Command Certificate Validator, which allows administrators to upload external linters to validate certificates.", "Detection": "Detection may be challenging as the attacker may use different techniques to bypass detection.", "Mitigation": "Mitigation strategies include identifying and isolating vulnerable systems, patching systems, and implementing network segmentation.", "Conclusion": "The CVE-2020-11629 vulnerability requires immediate attention as it could lead to significant security risks."}, "executive_analysis": {"Overview": "The CVE-2020-11629 vulnerability is a critical remote code execution vulnerability in EJBCA.", "Business Impact": "The vulnerability could lead to data breaches, system compromise, or disruptions to business operations.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary code on the server, access sensitive data, or take control of the server.", "Mitigation Strategies": "Implement patching and network segmentation to prevent exploitation.", "Recommendations": "Ensure immediate patching and network segmentation to prevent exploitation.", "Conclusions": "The CVE-2020-11629 vulnerability requires immediate attention and action to prevent potential security risks."}}