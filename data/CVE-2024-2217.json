{"id": "CVE-2024-2217", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-10T17:15:54.440", "lastModified": "2024-04-10T19:49:51.183", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "gaizhenbiao/chuanhuchatgpt is vulnerable to improper access control, allowing unauthorized access to the `config.json` file. This vulnerability is present in both authenticated and unauthenticated versions of the application, enabling attackers to obtain sensitive information such as API keys (`openai_api_key`, `google_palm_api_key`, `xmchat_api_key`, etc.), configuration details, and user credentials. The issue stems from the application's handling of HTTP requests for the `config.json` file, which does not properly restrict access based on user authentication."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-284"}]}], "references": [{"url": "https://github.com/gaizhenbiao/chuanhuchatgpt/commit/c5ae3b5ae6b47259e0ce8730e0a47e85121f4a7d", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/e4df74bf-b2ee-490f-a9c9-e5c8010b8b29", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1078", "comment": "Credentials from Known Command History - CVE-2024-2217 - The attacker can obtain sensitive information such as API keys, configuration details, and user credentials. Defend against this by monitoring and auditing command history, implementing file integrity monitoring, and restricting access to sensitive files."}, {"techniqueID": "T1037", "comment": "Windows Management Instrumentation (WMI) Group Policy Obfuscation - CVE-2024-2217 - The vulnerability may allow attackers to access the `config.json` file, which contains sensitive information, without authentication. Defend against this by implementing WMI hardening, restricting WMI access, and monitoring for suspicious WMI activity."}, {"techniqueID": "T1197", "comment": "Web Shell - CVE-2024-2217 - The vulnerability may allow attackers to upload and execute arbitrary files, including web shells. Defend against this by implementing web application firewalls, monitoring for suspicious network activity, and disabling unknown or untrusted files."}], "technical_analysis": {"Introduction": "The CVE-2024-2217 vulnerability is a remote code execution vulnerability in the gaizhenbiao/chuanhuchatgpt application.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5, with a low attack complexity and high confidentiality impact.", "Related MITRE ATT&CK Techniques": "Related techniques include Credentials from Known Command History (T1078), Windows Management Instrumentation (WMI) Group Policy Obfuscation (T1037), and Web Shell (T1197).", "Technical Details": "The vulnerability occurs when the application fails to properly restrict access to the `config.json` file, allowing unauthorized access to sensitive information.", "Detection": "Techniques for detecting this vulnerability include monitoring for suspicious network activity, monitoring command history, and implementing file integrity monitoring.", "Mitigation": "Mitigation strategies include implementing file integrity monitoring, restricting access to sensitive files, and monitoring for suspicious WMI activity.", "Conclusion": "The CVE-2024-2217 vulnerability highlights the importance of properly restricting access to sensitive files and implementing robust security measures to prevent remote code execution attacks."}, "executive_analysis": {"Overview": "The CVE-2024-2217 vulnerability is a remote code execution vulnerability in the gaizhenbiao/chuanhuchatgpt application.", "Business Impact": "The vulnerability has significant business implications, including potential data breaches and financial losses.", "Technical Impact": "The vulnerability has significant technical implications, including potential code execution and data theft.", "Mitigation Strategies": "Mitigation strategies include implementing file integrity monitoring, restricting access to sensitive files, and monitoring for suspicious WMI activity.", "Recommendations": "Recommendations for executives include prioritizing security awareness, implementing robust security measures, and conducting regular security audits.", "Conclusions": "The CVE-2024-2217 vulnerability highlights the importance of robust security measures and prioritizing security awareness."}}