{"id": "CVE-2024-29735", "sourceIdentifier": "security@apache.org", "published": "2024-03-26T17:15:47.380", "lastModified": "2024-08-29T20:36:39.460", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Improper Preservation of Permissions vulnerability in Apache Airflow.This issue affects Apache Airflow from 2.8.2 through 2.8.3.\n\nAirflow's local file task handler in Airflow incorrectly set permissions for all parent folders of log folder, in default configuration adding write access to Unix group\u00a0of the folders. In the case Airflow is run with the root user (not recommended) it added group write permission to all folders up to the root of the filesystem.\n\nIf your log files are stored in the home directory, these permission changes might impact your ability to run SSH operations after your home directory becomes group-writeable.\n\nThis issue does not affect users who use or extend Airflow using Official Airflow Docker reference images ( https://hub.docker.com/r/apache/airflow/ ) - those images require to have group write permission set anyway.\n\nYou are affected only if you install Airflow using local installation / virtualenv or other Docker images, but the issue has no impact if docker containers are used as intended, i.e. where Airflow components do not share containers with other applications and users.\n\nAlso you should not be affected if your umask is 002 (group write enabled) - this is the default on many linux systems.\n\nRecommendation for users using Airflow outside of the containers:\n\n  *  if you are using root to run Airflow, change your Airflow user to use non-root\n  *  upgrade Apache Airflow to 2.8.4 or above\n  *  If you prefer not to upgrade, you can change the  https://airflow.apache.org/docs/apache-airflow/stable/configurations-ref.html#file-task-handler-new-folder-permissions \u00a0to 0o755 (original value 0o775).\n  *  if you already ran Airflow tasks before and your default umask is 022 (group write disabled) you should stop Airflow components, check permissions of AIRFLOW_HOME/logs\u00a0in all your components and all parent directories of this directory and remove group write access for all the parent directories\n\n"}, {"lang": "es", "value": "Vulnerabilidad de conservaci\u00f3n inadecuada de permisos en Apache Airflow. Este problema afecta a Apache Airflow desde la versi\u00f3n 2.8.2 hasta la 2.8.3. El controlador de tareas de archivos locales de Airflow en Airflow configur\u00f3 incorrectamente permisos para todas las carpetas principales de la carpeta de registro, en la configuraci\u00f3n predeterminada agrega acceso de escritura al grupo de carpetas de Unix. En el caso de que Airflow se ejecute con el usuario root (no recomendado), agreg\u00f3 permiso de escritura grupal a todas las carpetas hasta la ra\u00edz del sistema de archivos. Si sus archivos de registro est\u00e1n almacenados en el directorio de inicio, estos cambios de permisos pueden afectar su capacidad para ejecutar operaciones SSH despu\u00e9s de que su directorio de inicio se pueda escribir en grupo. Este problema no afecta a los usuarios que usan o ampl\u00edan Airflow utilizando im\u00e1genes de referencia oficiales de Airflow Docker (https://hub.docker.com/r/apache/airflow/); de todos modos, esas im\u00e1genes requieren tener configurado el permiso de escritura grupal. Solo se ver\u00e1 afectado si instala Airflow usando la instalaci\u00f3n local/virtualenv u otras im\u00e1genes de Docker, pero el problema no tiene ning\u00fan impacto si los contenedores de Docker se usan seg\u00fan lo previsto, es decir, cuando los componentes de Airflow no comparten contenedores con otras aplicaciones y usuarios. Adem\u00e1s, no deber\u00eda verse afectado si su umask es 002 (escritura en grupo habilitada); este es el valor predeterminado en muchos sistemas Linux. Recomendaci\u00f3n para usuarios que usan Airflow fuera de los contenedores: * si est\u00e1 usando root para ejecutar Airflow, cambie su usuario de Airflow para usar no root * actualice Apache Airflow a 2.8.4 o superior * Si prefiere no actualizar, puede cambiar los https://airflow.apache.org/docs/apache-airflow/stable/configurations-ref.html#file-task-handler-new-folder-permissions a 0o755 (valor original 0o775). * si ya ejecut\u00f3 tareas de Airflow antes y su umask predeterminada es 022 (escritura grupal deshabilitada), debe detener los componentes de Airflow, verificar los permisos de AIRFLOW_HOME/logs en todos sus componentes y todos los directorios principales de este directorio y eliminar el acceso de escritura grupal para todos los directorios principales"}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@apache.org", "type": "Primary", "description": [{"lang": "en", "value": "CWE-281"}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/03/26/2", "source": "security@apache.org"}, {"url": "https://github.com/apache/airflow/pull/37310", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread/8khb1rtbznh100o325fb8xw5wjvtv536", "source": "security@apache.org"}], "techniques": [{"techniqueID": "T1208.005", "comment": "CVE-2024-29735 - Improper file and directory permissions can lead to unwanted access and control. Defending against this involves enforcing proper permissions and access controls."}, {"techniqueID": "T1059.007", "comment": "CVE-2024-29735 - Unvalidated user input can lead to the execution of unintended code. Protecting against this requires validating user input and sanitizing user data."}, {"techniqueID": "T1190", "comment": "CVE-2024-29735 - The vulnerability in Apache Airflow's local file task handler can be exploited to gain unauthorized access to the system. Defending against this involves configuring the handler properly and limiting access to sensitive areas."}], "stix_bundle": {"@context": "https://stix2.mitre.org/XMLSchema/2.1", "bundle": {"type": "bundle", "id": "CVE-2024-29735-Bundle", "created_by_ref": "https://stix2.mitre.org/XMLSchema/2.1/identity#stix2-mitre", "objects": [{"type": "vulnerability", "id": "CVE-2024-29735_Vulnerability", "created_by_ref": "https://stix2.mitre.org/XMLSchema/2.1/identity#stix2-mitre", "name": "Apache Airflow Local File Task Handler Permission Vulnerability", "description": "Improper Preservation of Permissions vulnerability in Apache Airflow. This issue affects Apache Airflow from 2.8.2 through 2.8.3.", "exploit_TARGETS": [{"type": "opportunities", "id": "CVE-2024-29735_Exploit_Target", "related_opportunities": [{"type": "vulnerability", "id": "CVE-2024-29735_Vulnerability"}], "opportunities": [{"type": "attack_pattern", "id": "CVE-2024-29735_Attack_Pattern", "name": "Apache Airflow Local File Task Handler Unauthenticated Remote Code Execution", "description": "An attacker can leverage this vulnerability to execute arbitrary code on the system without authentication."}]}]}, {"type": "course_of_action", "id": "CVE-2024-29735_Course_of_Action", "related_objects": [{"type": "vulnerability", "id": "CVE-2024-29735_Vulnerability"}], "name": "Upgrade Apache Airflow to 2.8.4 or above", "description": "Upgrading to a patched version of Apache Airflow will remediate this vulnerability."}], "relationships": [{"type": "has_operation", "id": "CVE-2024-29735_Exploit_Target_Has_operation", "left_ref": "CVE-2024-29735_Exploit_Target", "right_ref": "CVE-2024-29735_Attack_Pattern"}]}}, "technical_analysis": {"Introduction": "The Apache Airflow Local File Task Handler Permission Vulnerability, tracked as CVE-2024-29735, is a critical security issue that affects Apache Airflow from 2.8.2 through 2.8.3.", "Impact and Scope": {"cvss_score": 5.3, "cvss_version": "3.1", "attack_vector": "NETWORK"}, "Related MITRE ATT&CK Techniques": "T1208.005, T1059.007, T1190", "Technical Details": "The vulnerability is caused by improper preservation of permissions in the local file task handler of Apache Airflow.", "Detection": "Detection involves monitoring for unauthorized access to the system and anomalous file permissions.", "Mitigation": "Mitigation involves upgrading to a patched version of Apache Airflow and configuring the handler properly.", "Conclusion": "The Apache Airflow Local File Task Handler Permission Vulnerability is a serious security issue that requires immediate attention."}, "executive_analysis": {"Overview": "The Apache Airflow Local File Task Handler Permission Vulnerability is a critical security issue that affects Apache Airflow from 2.8.2 through 2.8.3.", "Business Impact": "This vulnerability has the potential to cause significant business disruption and data loss.", "Technical Impact": "The vulnerability can be exploited to gain unauthorized access to the system and execute arbitrary code.", "Mitigation Strategies": "Upgrade to a patched version of Apache Airflow and configure the handler properly.", "Recommendations": "Executives should prioritize the remediation of this vulnerability and ensure that all relevant systems are updated promptly.", "Conclusions": "The Apache Airflow Local File Task Handler Permission Vulnerability is a critical security issue that requires immediate attention from executives and IT teams."}}