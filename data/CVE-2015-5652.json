{"id": "CVE-2015-5652", "sourceIdentifier": "vultures@jpcert.or.jp", "published": "2015-10-06T01:59:27.250", "lastModified": "2016-11-28T19:35:04.873", "vulnStatus": "Modified", "cveTags": [], "evaluatorComment": "<a href=\"https://cwe.mitre.org/data/definitions/426.html\">CWE-426: Untrusted Search Path</a>", "descriptions": [{"lang": "en", "value": "Untrusted search path vulnerability in python.exe in Python through 3.5.0 on Windows allows local users to gain privileges via a Trojan horse readline.pyd file in the current working directory.  NOTE: the vendor says \"It was determined that this is a longtime behavior of Python that cannot really be altered at this point.\""}, {"lang": "es", "value": "Vulnerabilidad de busqueda de ruta no confiable en python.exe en Python hasta la versi\u00f3n 3.5.0 en Windows, permite a usuarios locales obtener privilegios a trav\u00e9s de un Troyano en el archivo readline.pyd en el directorio de trabajo actual. NOTA: el vendedor afirma 'Est\u00e1 determinado que es un comportamiento antiguo de Python que en realidad no puede ser alterado en estos momentos'."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:python:python:*:*:*:*:*:*:*:*", "versionEndIncluding": "3.5.0", "matchCriteriaId": "B2F93287-0BD8-498E-9D3B-88DB351B1E84"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows:*:*:*:*:*:*:*:*", "matchCriteriaId": "2CF61F35-5905-4BA9-AD7E-7DB261D2F256"}]}]}], "references": [{"url": "http://jvn.jp/en/jp/JVN49503705/995204/index.html", "source": "vultures@jpcert.or.jp", "tags": ["Vendor Advisory"]}, {"url": "http://jvn.jp/en/jp/JVN49503705/index.html", "source": "vultures@jpcert.or.jp", "tags": ["Vendor Advisory"]}, {"url": "http://jvndb.jvn.jp/jvndb/JVNDB-2015-000141", "source": "vultures@jpcert.or.jp", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/76929", "source": "vultures@jpcert.or.jp"}, {"url": "https://h20566.www2.hpe.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c05324755", "source": "vultures@jpcert.or.jp"}], "techniques": [{"techniqueID": "T1222", "comment": "CVE-2015-5652 - This technique can be used to exploit the vulnerability by creating a malicious Trojan horse file in the current working directory that can be executed when the Python interpreter searches for modules."}, {"techniqueID": "T1210", "comment": "CVE-2015-5652 - This technique can be used to exploit the vulnerability by using the untrusted search path to inject and execute arbitrary code."}, {"techniqueID": "T1204", "comment": "CVE-2015-5652 - This technique can be used to exploit the vulnerability by creating a malicious environment variable that can be used to inject and execute arbitrary code."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle--f5e1b4a8-7a5d-46f5-9e4c-5675ea9f2e5e", "created": "2021-01-01T12:00:00.000Z", "modified": "2021-01-01T12:00:00.000Z", "objects": [{"type": "vulnerability", "id": "vulnerability--a99f2c1f-f84b-44f3-b3c6-73cfc9e71c55", "created": "2021-01-01T12:00:00.000Z", "modified": "2021-01-01T12:00:00.000Z", "name": "CVE-2015-5652", "description": "Untrusted search path vulnerability in python.exe in Python through 3.5.0 on Windows allows local users to gain privileges via a Trojan horse readline.pyd file in the current working directory.", "cve": {"id": "CVE-2015-5652", "versions": ["3.5.0"]}, "related_object": {"type": "attack-pattern", "id": "attack-pattern--9f9ca5a7-1e3d-48d4-ac15-53d81f3d9a7e", "name": "CWE-426: Untrusted Search Path"}}, {"type": "attack-pattern", "id": "attack-pattern--9f9ca5a7-1e3d-48d4-ac15-53d81f3d9a7e", "created": "2021-01-01T12:00:00.000Z", "modified": "2021-01-01T12:00:00.000Z", "name": "CWE-426: Untrusted Search Path", "description": "This attack pattern involves exploiting a vulnerability in the untrusted search path of a system, allowing an attacker to execute arbitrary code.", "note": "This technique can be used to exploit the vulnerability by creating a malicious Trojan horse file in the current working directory that can be executed when the Python interpreter searches for modules."}, {"type": "course-of-action", "id": "course-of-action--1412c3d7-ef4e-4e34-874f-7f3f3c17f2f8", "created": "2021-01-01T12:00:00.000Z", "modified": "2021-01-01T12:00:00.000Z", "name": "Mitigate Untrusted Search Path Vulnerability", "description": "This course of action involves updating the Python interpreter to a version that no longer uses the untrusted search path, and ensuring that only trusted modules are executed.", "related_attack_pattern": {"type": "attack-pattern", "id": "attack-pattern--9f9ca5a7-1e3d-48d4-ac15-53d81f3d9a7e"}}]}, "technical_analysis": {"Introduction": "This vulnerability, CVE-2015-5652, is a classic example of a path manipulation attack. It allows an attacker to execute arbitrary code by creating a malicious Trojan horse file in the current working directory.", "Impact and Scope": "This vulnerability has a severity score of 7.2, and affects Python versions 3.0 to 3.5.0 on Windows. It allows local users to gain privileges, which can lead to a full compromise of the system.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to techniques such as T1222, T1210, and T1204, which all involve exploiting path manipulation vulnerabilities.", "Technical Details": "The vulnerability is caused by the Python interpreter's use of the untrusted search path when searching for modules. This allows an attacker to inject and execute arbitrary code by creating a malicious Trojan horse file.", "Detection": "Detection of this vulnerability involves monitoring for suspicious file creation and modification in the current working directory, as well as checking for unusual module execution.", "Mitigation": "Mitigation of this vulnerability involves updating the Python interpreter to a version that no longer uses the untrusted search path, and ensuring that only trusted modules are executed.", "Conclusion": "This vulnerability is a classic example of a path manipulation attack, and demonstrates the importance of proper security controls and mitigations."}, "executive_analysis": {"Overview": "This vulnerability, CVE-2015-5652, is a critical security issue that affects Python versions 3.0 to 3.5.0 on Windows. It allows local users to gain privileges, which can lead to a full compromise of the system.", "Business Impact": "This vulnerability has a significant business impact, as it allows an attacker to gain unauthorized access to sensitive data and systems. This can lead to financial losses, reputational damage, and legal issues.", "Technical Impact": "The technical impact of this vulnerability is moderate to high, as it allows an attacker to execute arbitrary code on the system.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include updating the Python interpreter to a version that no longer uses the untrusted search path, and ensuring that only trusted modules are executed.", "Recommendations": "Recommendations for executives include prioritizing software updates, implementing proper security controls, and conducting regular security audits and assessments.", "Conclusions": "This vulnerability highlights the importance of proper security controls and mitigations in preventing path manipulation attacks. It is crucial for organizations to prioritize software updates and implement proper security measures to prevent exploitation."}}