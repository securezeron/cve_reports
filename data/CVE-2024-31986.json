{"id": "CVE-2024-31986", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-10T21:15:06.917", "lastModified": "2024-04-11T12:47:44.137", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "XWiki Platform is a generic wiki platform. Starting in version 3.1 and prior to versions 4.10.19, 15.5.4, and 15.10-rc-1, by creating a document with a special crafted documented reference and an `XWiki.SchedulerJobClass` XObject, it is possible to execute arbitrary code on the server whenever an admin visits the scheduler page or the scheduler page is referenced, e.g., via an image in a comment on a page in the wiki. The vulnerability has been fixed in XWiki 14.10.19, 15.5.5, and 15.9. As a workaround, apply the patch manually by modifying the `Scheduler.WebHome` page."}, {"lang": "es", "value": "XWiki Platform es una plataforma wiki gen\u00e9rica. A partir de la versi\u00f3n 3.1 y anteriores a las versiones 4.10.19, 15.5.4 y 15.10-rc-1, al crear un documento con una referencia documentada especialmente manipulada y un XObject `XWiki.SchedulerJobClass`, es posible ejecutar c\u00f3digo arbitrario en el servidor cada vez que un administrador visita la p\u00e1gina del programador o se hace referencia a la p\u00e1gina del programador, por ejemplo, a trav\u00e9s de una imagen en un comentario en una p\u00e1gina de la wiki. La vulnerabilidad se solucion\u00f3 en XWiki 14.10.19, 15.5.5 y 15.9. Como workaround, aplique el parche manualmente modificando la p\u00e1gina `Scheduler.WebHome`."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.3, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-352"}, {"lang": "en", "value": "CWE-95"}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/8a92cb4bef7e5f244ae81eed3e64fe9be95827cf", "source": "security-advisories@github.com"}, {"url": "https://github.com/xwiki/xwiki-platform/commit/efd3570f3e5e944ec0ad0899bf799bf9563aef87", "source": "security-advisories@github.com"}, {"url": "https://github.com/xwiki/xwiki-platform/commit/f30d9c641750a3f034b5910c6a3a7724ae8f2269", "source": "security-advisories@github.com"}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-37m4-hqxv-w26g", "source": "security-advisories@github.com"}, {"url": "https://jira.xwiki.org/browse/XWIKI-21416", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210 - Exploitation of Remote Services", "comment": "CVE-2024-31986 - This vulnerability allows remote exploitation, an attacker can create a special crafted document with an 'XWiki.SchedulerJobClass' XObject to execute arbitrary code, so it's essential to patch the vulnerable versions and consider implementing additional security measures, such as web application firewalls and intrusion detection systems, to prevent remote exploitation."}, {"techniqueID": "T1222 - Cross-Site Scripting (XSS)", "comment": "CVE-2024-31986 - This vulnerability can also be used to conduct cross-site scripting (XSS) attacks, allowing an attacker to inject malicious scripts into the scheduler page, which can result in arbitrary code execution, so it's crucial to implement input validation, escaping and sanitization mechanisms to prevent XSS attacks."}, {"techniqueID": "T1130 - Databases", "comment": "CVE-2024-31986 - Since the vulnerability is related to the scheduler page, it's also important to consider the databases being used, as an attacker could potentially use the malicious XObject to execute arbitrary SQL queries, this highlights the importance of proper database security and access controls."}, {"techniqueID": "T1190 - Exploit Public-Facing Application", "comment": "CVE-2024-31986 - As this vulnerability affects a public-facing application, it's essential to limit public access to the scheduler page and implement strict authentication and authorization mechanisms to prevent unauthorized access."}, {"techniqueID": "T1566 - Phishing", "comment": "CVE-2024-31986 - This vulnerability can also be used as part of a phishing attack, where an attacker would trick an admin into visiting the scheduler page, which could lead to arbitrary code execution, so it's crucial to have a robust security awareness program and train admins to recognize and report suspicious activities."}], "stix_bundle": {"bundle": {"id": "CVE-2024-31986-STIX-Bundle", "type": "bundle", "spec_version": "2.1", "created_by_ref": "https://example.com/actor", "created": "2024-04-12T12:00:00Z", "modified": "2024-04-12T12:00:00Z", "description": "STIX Bundle for CVE-2024-31986", "objects": [{"id": "CVE-2024-31986", "type": "vulnerability", "created_by_ref": "https://example.com/actor", "created": "2024-04-12T12:00:00Z", "modified": "2024-04-12T12:00:00Z", "name": "CVE-2024-31986", "description": "CWE-352 and CWE-95", "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H", "impact_score": 6.0, "exploit_score": 2.3, "cve_data_type": "CVE"}, {"id": "T1210", "type": "technique", "created_by_ref": "https://example.com/actor", "created": "2024-04-12T12:00:00Z", "modified": "2024-04-12T12:00:00Z", "name": "Exploitation of Remote Services", "description": "A technique used to exploit remote services without requiring interaction from the targeted user."}, {"id": "T1222", "type": "technique", "created_by_ref": "https://example.com/actor", "created": "2024-04-12T12:00:00Z", "modified": "2024-04-12T12:00:00Z", "name": "Cross-Site Scripting (XSS)", "description": "A technique used to inject malicious scripts into the scheduler page."}, {"id": "T1130", "type": "technique", "created_by_ref": "https://example.com/actor", "created": "2024-04-12T12:00:00Z", "modified": "2024-04-12T12:00:00Z", "name": "Databases", "description": "A technique used to interact with databases."}, {"id": "T1190", "type": "technique", "created_by_ref": "https://example.com/actor", "created": "2024-04-12T12:00:00Z", "modified": "2024-04-12T12:00:00Z", "name": "Exploit Public-Facing Application", "description": "A technique used to exploit public-facing applications."}, {"id": "T1566", "type": "technique", "created_by_ref": "https://example.com/actor", "created": "2024-04-12T12:00:00Z", "modified": "2024-04-12T12:00:00Z", "name": "Phishing", "description": "A technique used to trick admins into visiting the scheduler page."}], " relationships": [{"id": "CVE-2024-31986-CWE-352", "type": "relationship", "from": "CVE-2024-31986", "to": "CWE-352", "relationship_type": "related_to"}, {"id": "CVE-2024-31986-CWE-95", "type": "relationship", "from": "CVE-2024-31986", "to": "CWE-95", "relationship_type": "related_to"}, {"id": "CVE-2024-31986-T1210", "type": "relationship", "from": "CVE-2024-31986", "to": "T1210", "relationship_type": "mitigates"}, {"id": "CVE-2024-31986-T1222", "type": "relationship", "from": "CVE-2024-31986", "to": "T1222", "relationship_type": "mitigates"}, {"id": "CVE-2024-31986-T1130", "type": "relationship", "from": "CVE-2024-31986", "to": "T1130", "relationship_type": "mitigates"}, {"id": "CVE-2024-31986-T1190", "type": "relationship", "from": "CVE-2024-31986", "to": "T1190", "relationship_type": "mitigates"}, {"id": "CVE-2024-31986-T1566", "type": "relationship", "from": "CVE-2024-31986", "to": "T1566", "relationship_type": "mitigates"}]}}, "technical_analysis": {"Introduction": "The CVE-2024-31986 vulnerability is a remote code execution vulnerability in XWiki Platform, affecting versions 3.1 and prior to versions 4.10.19, 15.5.4, and 15.10-rc-1. This vulnerability allows attackers to execute arbitrary code on the server whenever an admin visits the scheduler page or the scheduler page is referenced.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 9.0. The vulnerability is remotely exploitable and can be used to execute arbitrary code on the server. The scope of the vulnerability includes all systems running affected versions of XWiki Platform.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1210, T1222, T1130, T1190, and T1566.", "Technical Details": "The vulnerability is caused by the lack of proper validation and sanitization of user input in the scheduler page. An attacker can create a special crafted document with an 'XWiki.SchedulerJobClass' XObject to execute arbitrary code on the server.", "Detection": "Detection of this vulnerability involves checking the version of XWiki Platform being used and looking for signs of exploitation, such as suspicious requests to the scheduler page.", "Mitigation": "The mitigation strategies for this vulnerability include patching affected versions of XWiki Platform, implementing web application firewalls and intrusion detection systems to prevent remote exploitation, and restricting access to the scheduler page.", "Conclusion": "In conclusion, the CVE-2024-31986 vulnerability is a high-severity remote code execution vulnerability in XWiki Platform. It is essential to patch affected versions of XWiki Platform, implement additional security measures, and restrict access to the scheduler page to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-31986 vulnerability is a significant risk to organizations that use XWiki Platform. It allows attackers to execute arbitrary code on the server, which can result in sensitive data being compromised or system availability being disrupted.", "Business Impact": "The business impact of this vulnerability is high, as it can result in financial losses, damage to reputation, and legal liability. It is essential to take immediate action to patch affected versions of XWiki Platform and implement additional security measures.", "Technical Impact": "The technical impact of this vulnerability is high, as it can allow attackers to execute arbitrary code on the server. This can result in system availability being disrupted, sensitive data being compromised, and unauthorized access to system resources.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include patching affected versions of XWiki Platform, implementing web application firewalls and intrusion detection systems to prevent remote exploitation, and restricting access to the scheduler page.", "Recommendations": "We recommend that organizations take immediate action to patch affected versions of XWiki Platform and implement additional security measures. We also recommend that organizations restrict access to the scheduler page and monitor system activity for signs of exploitation.", "Conclusions": "In conclusion, the CVE-2024-31986 vulnerability is a high-severity remote code execution vulnerability in XWiki Platform. It is essential to take immediate action to patch affected versions of XWiki Platform and implement additional security measures to prevent exploitation."}}