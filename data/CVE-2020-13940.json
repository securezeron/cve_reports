{"id": "CVE-2020-13940", "sourceIdentifier": "security@apache.org", "published": "2020-10-01T20:15:13.097", "lastModified": "2020-10-05T23:43:06.557", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Apache NiFi 1.0.0 to 1.11.4, the notification service manager and various policy authorizer and user group provider objects allowed trusted administrators to inadvertently configure a potentially malicious XML file. The XML file has the ability to make external calls to services (via XXE)."}, {"lang": "es", "value": "En Apache NiFi versiones 1.0.0 hasta 1.11.4, el administrador del servicio de notificaci\u00f3n y varios objetos del autorizador de pol\u00edticas y proveedor de grupos de usuarios permitieron a los administradores confiables configurar inadvertidamente un archivo XML potencialmente malicioso.&#xa0;El archivo XML tiene la capacidad de hacer llamadas externas a servicios (por medio de XXE)"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-611"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:nifi:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.0.0", "versionEndIncluding": "1.11.4", "matchCriteriaId": "43022122-9397-48D7-BD86-925042103633"}]}]}], "references": [{"url": "https://nifi.apache.org/security#CVE-2020-13940", "source": "security@apache.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-13940 - XXE injection attack to execute external XML files, utilizing the notification service manager in Apache NiFi, may lead to unauthorized data access and privilege escalation."}, {"techniqueID": "T1210", "comment": "CVE-2020-13940 - Discovery of the XXE vulnerability in Apache NiFi, which allows the attacker to read files on the system, access sensitive data, and potentially escalate privileges."}, {"techniqueID": "T1192", "comment": "CVE-2020-13940 - Exploitation of the XXE vulnerability in Apache NiFi, enabling remote code execution, data exfiltration, and potentially leading to full compromise of the system."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "indicator--1", "name": "Apache NiFi XXE Injection", "created_by_ref": "user--1", "modified": "2022-02-22T14:30:00.000Z", "created": "2022-02-22T14:30:00.000Z", "related_object_refs": ["vulnerability--1"], "pattern_terms": ["Apache NiFi XML external entity injection"]}, {"type": "vulnerability", "id": "vulnerability--1", "name": "Apache NiFi XXE Injection", "description": "The XXE vulnerability in Apache NiFi allows an attacker to read files on the system, access sensitive data, and potentially escalate privileges.", "first_observed": "2020-09-10T14:30:00.000Z", "last_observed": "2022-02-22T14:30:00.000Z", "modified": "2022-02-22T14:30:00.000Z", "created": "2022-02-22T14:30:00.000Z", "related_object_refs": ["indicator--1"]}, {"type": "action", "id": "action--1", "name": "Fix Apache NiFi XXE Injection", "description": "Update Apache NiFi to version 1.12.0 or later", "status": "completed", "modified": "2022-02-22T14:30:00.000Z", "created": "2022-02-22T14:30:00.000Z", "directed_by": "vulnerability--1"}, {"type": "course-of-action", "id": "course-of-action--1", "name": "Detect Apache NiFi XXE Injection", "description": "Configure threat detection systems to identify XXE injection attempts in Apache NiFi", "status": "in-progress", "modified": "2022-02-22T14:30:00.000Z", "created": "2022-02-22T14:30:00.000Z", "related_sensors": ["sensor--1"], "related_course_of_action_refs": ["action--1"]}], "relationship": [{"kind": "indicates", "relationship_type": "indicates", "id": "rel--1", "source_ref": "indicator--1", "destination_ref": "vulnerability--1"}, {"kind": "vulnerability", "relationship_type": "vulnerability", "id": "rel--2", "source_ref": "vulnerability--1", "destination_ref": "action--1"}, {"kind": "part-of", "relationship_type": "part-of", "id": "rel--3", "source_ref": "course-of-action--1", "destination_ref": "action--1"}]}, "technical_analysis": {"Introduction": "The XXE injection vulnerability in Apache NiFi version 1.0.0 to 1.11.4 allows an attacker to read files on the system, access sensitive data, and potentially escalate privileges. This vulnerability can be exploited by simply sending an XML file to the Apache NiFi notification service manager.", "Impact and Scope": "The vulnerability has a CVSS score of 5.5 (Medium) and an attack vector of LOCAL. This vulnerability is exploitable on Apache NiFi versions 1.0.0 to 1.11.4.", "Related MITRE ATT&CK Techniques": "T1190, T1210, T1192", "Technical Details": "The XXE injection vulnerability is exploitable by sending a specially crafted XML file to the Apache NiFi notification service manager. This vulnerability can be exploited to read files on the system, access sensitive data, and potentially escalate privileges.", "Detection": "Configure threat detection systems to identify XXE injection attempts in Apache NiFi", "Mitigation": "Update Apache NiFi to version 1.12.0 or later", "Conclusion": "The XXE injection vulnerability in Apache NiFi requires immediate attention and remediation to prevent exploitation."}, "executive_analysis": {"Overview": "The XXE injection vulnerability in Apache NiFi version 1.0.0 to 1.11.4 is a critical vulnerability that can be exploited to access sensitive data and escalate privileges.", "Business Impact": "The vulnerability can result in the theft of sensitive business data and potentially disrupt business operations.", "Technical Impact": "The vulnerability can be exploited by sending a specially crafted XML file to the Apache NiFi notification service manager.", "Mitigation Strategies": "Update Apache NiFi to version 1.12.0 or later", "Recommendations": "Execute a thorough vulnerability assessment to identify other potential vulnerabilities in the environment, and implement the necessary remediation measures.", "Conclusions": "The XXE injection vulnerability in Apache NiFi requires immediate attention and remediation to prevent exploitation."}}