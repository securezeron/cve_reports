{"id": "CVE-2024-42491", "sourceIdentifier": "security-advisories@github.com", "published": "2024-09-05T18:15:05.707", "lastModified": "2024-09-06T12:08:21.290", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Asterisk is an open-source private branch exchange (PBX). Prior to versions 18.24.3, 20.9.3, and 21.4.3 of Asterisk and versions 18.9-cert12 and 20.7-cert2 of certified-asterisk, if Asterisk attempts to send a SIP request to a URI whose host portion starts with `.1` or `[.1]`, and res_resolver_unbound is loaded, Asterisk will crash with a SEGV. To receive a patch, users should upgrade to one of the following versions: 18.24.3, 20.9.3, 21.4.3, certified-18.9-cert12, certified-20.7-cert2. Two workarounds are available. Disable res_resolver_unbound by setting `noload = res_resolver_unbound.so` in modules.conf, or set `rewrite_contact = yes` on all PJSIP endpoints. NOTE: This may not be appropriate for all Asterisk configurations."}, {"lang": "es", "value": "Asterisk es una centralita privada (PBX) de c\u00f3digo abierto. En versiones anteriores a las 18.24.3, 20.9.3 y 21.4.3 de Asterisk y las versiones 18.9-cert12 y 20.7-cert2 de certificate-asterisk, si Asterisk intenta enviar una solicitud SIP a una URI cuya parte de host comienza con `.1` o `[.1]`, y res_resolver_unbound est\u00e1 cargado, Asterisk se bloquear\u00e1 con un SEGV. Para recibir un parche, los usuarios deben actualizar a una de las siguientes versiones: 18.24.3, 20.9.3, 21.4.3, certificate-18.9-cert12, certificate-20.7-cert2. Hay dos workarounds disponibles. Deshabilite res_resolver_unbound configurando `noload = res_resolver_unbound.so` en modules.conf, o configure `rewrite_contact = yes` en todos los endpoints PJSIP. NOTA: Esto puede no ser apropiado para todas las configuraciones de Asterisk."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-252"}, {"lang": "en", "value": "CWE-476"}]}], "references": [{"url": "https://github.com/asterisk/asterisk/commit/42a2f4ccfa2c7062a15063e765916b3332e34cc4", "source": "security-advisories@github.com"}, {"url": "https://github.com/asterisk/asterisk/commit/4f01669c7c41c9184f3cce9a3cf1b2ebf6201742", "source": "security-advisories@github.com"}, {"url": "https://github.com/asterisk/asterisk/commit/50bf8d4d3064930d28ecf1ce3397b14574d514d2", "source": "security-advisories@github.com"}, {"url": "https://github.com/asterisk/asterisk/commit/7a0090325bfa9d778a39ae5f7d0a98109e4651c8", "source": "security-advisories@github.com"}, {"url": "https://github.com/asterisk/asterisk/commit/a15050650abf09c10a3c135fab148220cd41d3a0", "source": "security-advisories@github.com"}, {"url": "https://github.com/asterisk/asterisk/security/advisories/GHSA-v428-g3cw-7hv9", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1203", "comment": "CVE-2024-42491 - A remote code execution vulnerability in Asterisk (T1203) - A remote attacker can exploit this vulnerability by sending a specially crafted SIP request to the Asterisk server."}, {"techniqueID": "T1210", "comment": "CVE-2024-42491 - A remote code execution vulnerability in Asterisk (T1210) - An attacker can exploit this vulnerability by sending a specially crafted SIP request to the Asterisk server and leveraging the res_resolver_unbound functionality."}, {"techniqueID": "T1211", "comment": "CVE-2024-42491 - A remote code execution vulnerability in Asterisk (T1211) - An attacker can exploit this vulnerability by sending a specially crafted SIP request to the Asterisk server and leveraging the res_resolver_unbound functionality to execute arbitrary code."}], "stix_bundle": {"bundle": {"id": "CVE-2024-42491", "type": "bundle", "created": "2024-09-05T18:15:05.707", "modified": "2024-09-06T12:08:21.290", "name": "Asterisk Remote Code Execution Vulnerability", "description": "A remote code execution vulnerability in Asterisk (PBX) that can be exploited by sending a specially crafted SIP request to the Asterisk server.", "published": "2024-09-05T18:15:05.707", "vulnerability": {"id": "CVE-2024-42491", "type": "vulnerability", "description": "A remote code execution vulnerability in Asterisk (PBX) that can be exploited by sending a specially crafted SIP request to the Asterisk server."}, "references": [{"href": "https://github.com/asterisk/asterisk/commit/42a2f4ccfa2c7062a15063e765916b3332e34cc4", "type": "reference", "description": "The commit that introduces the vulnerability."}, {"href": "https://github.com/asterisk/asterisk/commit/4f01669c7c41c9184f3cce9a3cf1b2ebf6201742", "type": "reference", "description": "The commit that introduces the vulnerability."}, {"href": "https://github.com/asterisk/asterisk/commit/50bf8d4d3064930d28ecf1ce3397b14574d514d2", "type": "reference", "description": "The commit that introduces the vulnerability."}, {"href": "https://github.com/asterisk/asterisk/commit/7a0090325bfa9d778a39ae5f7d0a98109e4651c8", "type": "reference", "description": "The commit that introduces the vulnerability."}, {"href": "https://github.com/asterisk/asterisk/commit/a15050650abf09c10a3c135fab148220cd41d3a0", "type": "reference", "description": "The commit that introduces the vulnerability."}], "x_openctivx_has_seen": true, "x_openctivx_sev_weight": 3.6, "x_openctivx_sev_great_weight": 5.7, "x_openctivx_attack_vector": "NETWORK", "x_opencti vx_cwe": "CWE-252, CWE-476", "x_opencti vx_cvssv3": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:H"}}, "technical_analysis": {"Introduction": "Asterisk is an open-source private branch exchange (PBX) with a vulnerability in the res_resolver_unbound function. The vulnerability allows attackers to send malicious SIP requests, leading to remote code execution. The vulnerability is mitigated by disabling the res_resolver_unbound function or setting rewrite_contact to yes on all PJSIP endpoints.", "Impact and Scope": "The vulnerability affects all Asterisk versions prior to 18.24.3, 20.9.3, and 21.4.3. It can be exploited by sending malicious SIP requests, leading to remote code execution.", "Related MITRE ATT&CK Techniques": "T1203, T1210, T1211", "Technical Details": "The vulnerability is caused by the lack of input validation in the res_resolver_unbound function. Attackers can exploit this vulnerability to send malicious SIP requests that can lead to arbitrary code execution.", "Detection": "To detect this vulnerability, you can review your Asterisk log for suspicious activity, such as unexpected SIP requests.", "Mitigation": "To mitigate this vulnerability, you can disable the res_resolver_unbound function or set rewrite_contact to yes on all PJSIP endpoints. You can also upgrade to a supported version of Asterisk.", "Conclusion": "In conclusion, the vulnerability in Asterisk presents a significant risk to users. It is recommended that you implement mitigations to prevent exploitation."}, "executive_analysis": {"Overview": "A vulnerability was discovered in Asterisk, a popular open-source PBX software. The vulnerability can be exploited remotely, leading to code execution.", "Business Impact": "This vulnerability can have significant business impact if not mitigated. It can lead to data breaches, unauthorized access, and disruption of business operations.", "Technical Impact": "The vulnerability is caused by a lack of input validation in the res_resolver_unbound function. This makes it possible for attackers to send malicious SIP requests, leading to remote code execution.", "Mitigation Strategies": "To mitigate this vulnerability, it is recommended to disable the res_resolver_unbound function or set rewrite_contact to yes on all PJSIP endpoints. You can also upgrade to a supported version of Asterisk.", "Recommendations": "It is recommended that you prioritize the mitigation of this vulnerability. You can also consider implementing additional security measures to prevent exploitation.", "Conclusions": "In conclusion, the vulnerability in Asterisk presents a significant risk to users. It is recommended that you implement mitigations to prevent exploitation."}}