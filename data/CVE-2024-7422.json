{"id": "CVE-2024-7422", "sourceIdentifier": "security@wordfence.com", "published": "2024-08-16T04:15:07.497", "lastModified": "2024-08-19T13:00:23.117", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Theme My Login plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 7.1.7. This is due to missing or incorrect nonce validation on the tml_admin_save_ms_settings() function. This makes it possible for unauthenticated attackers to update the theme's settings via a forged request granted they can trick a site administrator into performing an action such as clicking on a link. Please note that this only affects multi-site instances."}, {"lang": "es", "value": " El complemento Theme My Login para WordPress es vulnerable a Cross-Site Request Forgery en todas las versiones hasta la 7.1.7 incluida. Esto se debe a una validaci\u00f3n nonce faltante o incorrecta en la funci\u00f3n tml_admin_save_ms_settings(). Esto hace posible que atacantes no autenticados actualicen la configuraci\u00f3n del tema a trav\u00e9s de una solicitud falsificada, siempre que puedan enga\u00f1ar al administrador del sitio para que realice una acci\u00f3n como hacer clic en un enlace. Tenga en cuenta que esto solo afecta a instancias de m\u00faltiples sitios."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "security@wordfence.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-352"}]}], "references": [{"url": "https://plugins.trac.wordpress.org/changeset/3135854/theme-my-login/trunk/admin/settings.php", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/0fb8e956-3a95-4e55-9816-be7eddb5835d?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-7422 - This CSRF vulnerability allows an unauthenticated attacker to update the theme's settings via a forged request, making it possible to trick a site administrator into performing a malicious action."}, {"techniqueID": "T1193", "comment": "CVE-2024-7422 - This vector string indicates that the vulnerability is exploitable via a network-based attack and requires user interaction to execute."}], "stix_bundle": {"bundle-type": "STIX_BUNDLE", "bundle-version": "2.1", "objects": [{"type": "indicator", "id": "indicator--1", "created": "2024-08-16T04:15:07.497", "name": "Theme My Login CSRF Vulnerability", "description": "A Cross-Site Request Forgery (CSRF) vulnerability in the Theme My Login plugin for WordPress that allows an unauthenticated attacker to update the theme's settings via a forged request.", "confidence": 0.8, "valid-from": "2024-08-16T04:15:07.497", "valid-until": "2099-12-31T23:59:59.999", "Observable": {"type": "relationship", "id": "relationship--1", "object-label": "Category", "object-ref": "category--1", "relationship-type": "INDICATES"}}, {"type": "attack-pattern", "id": "attack-pattern--1", "name": "CSRF Attack", "description": "A Cross-Site Request Forgery (CSRF) attack against the Theme My Login plugin for WordPress.", "created": "2024-08-16T04:15:07.497", "modified": "2024-08-19T13:00:23.117", "objects": [{"type": "indicator", "id": "indicator--1"}]}, {"type": "course-of-action", "id": "course-of-action--1", "name": "Enable CSRF Protection", "description": "Enable the CSRF protection feature in the Theme My Login plugin to prevent CSRF attacks.", "created": "2024-08-16T04:15:07.497", "modified": "2024-08-19T13:00:23.117", "recommendation": "HIGH", "mitigated-by": ["attack-pattern--1"]}], "relationships": [{"type": "indicates", "id": "indicating-relationship--1", "source-ref": "indicator--1", "target-ref": "attack-pattern--1", "label": "INDICATES"}, {"type": "mitigates", "id": "mitigating-relationship--2", "source-ref": "course-of-action--1", "target-ref": "attack-pattern--1", "label": "MITIGATES"}]}, "technical_analysis": {"Introduction": "The Theme My Login plugin for WordPress is vulnerable to Cross-Site Request Forgery attacks due to missing or incorrect nonce validation on the tml_admin_save_ms_settings() function.", "Impact and Scope": "The vulnerability allows an unauthenticated attacker to update the theme's settings via a forged request, making it possible to trick a site administrator into performing a malicious action.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to MITRE ATT&CK techniques T1190 and T1193.", "Technical Details": "The vulnerability occurs due to the missing or incorrect nonce validation on the tml_admin_save_ms_settings() function.", "Detection": "Detection consists of checking for missing or incorrect nonce validation on the tml_admin_save_ms_settings() function.", "Mitigation": "Mitigation involves enabling the CSRF protection feature in the Theme My Login plugin.", "Conclusion": "In conclusion, the Theme My Login plugin for WordPress is vulnerable to CSRF attacks and enabling the CSRF protection feature is recommended to prevent these attacks."}, "executive_analysis": {"Overview": "The Theme My Login plugin for WordPress is vulnerable to CSRF attacks due to missing or incorrect nonce validation on the tml_admin_save_ms_settings() function.", "Business Impact": "This vulnerability has a moderate business impact, as it allows an unauthenticated attacker to update the theme's settings via a forged request.", "Technical Impact": "This vulnerability has a moderate technical impact, as it requires user interaction to execute and can be detected by checking for missing or incorrect nonce validation on the tml_admin_save_ms_settings() function.", "Mitigation Strategies": "Enabling the CSRF protection feature in the Theme My Login plugin is recommended to prevent CSRF attacks.", "Recommendations": "Executives should recommend enabling the CSRF protection feature in the Theme My Login plugin and educating site administrators on how to detect and prevent CSRF attacks.", "Conclusions": "In conclusion, the Theme My Login plugin for WordPress is vulnerable to CSRF attacks and enabling the CSRF protection feature is recommended to prevent these attacks."}}