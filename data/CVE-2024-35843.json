{"id": "CVE-2024-35843", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-17T15:15:21.313", "lastModified": "2024-07-03T02:02:16.580", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\niommu/vt-d: Use device rbtree in iopf reporting path\n\nThe existing I/O page fault handler currently locates the PCI device by\ncalling pci_get_domain_bus_and_slot(). This function searches the list\nof all PCI devices until the desired device is found. To improve lookup\nefficiency, replace it with device_rbtree_find() to search the device\nwithin the probed device rbtree.\n\nThe I/O page fault is initiated by the device, which does not have any\nsynchronization mechanism with the software to ensure that the device\nstays in the probed device tree. Theoretically, a device could be released\nby the IOMMU subsystem after device_rbtree_find() and before\niopf_get_dev_fault_param(), which would cause a use-after-free problem.\n\nAdd a mutex to synchronize the I/O page fault reporting path and the IOMMU\nrelease device path. This lock doesn't introduce any performance overhead,\nas the conflict between I/O page fault reporting and device releasing is\nvery rare."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: iommu/vt-d: use el rbtree del dispositivo en la ruta de informes iopf. El controlador de fallos de la p\u00e1gina de E/S existente actualmente ubica el dispositivo PCI llamando a pci_get_domain_bus_and_slot(). Esta funci\u00f3n busca en la lista de todos los dispositivos PCI hasta encontrar el dispositivo deseado. Para mejorar la eficiencia de la b\u00fasqueda, reempl\u00e1celo con device_rbtree_find() para buscar el dispositivo dentro del rbtree del dispositivo probado. El fallo de la p\u00e1gina de E/S la inicia el dispositivo, que no tiene ning\u00fan mecanismo de sincronizaci\u00f3n con el software para garantizar que el dispositivo permanezca en el \u00e1rbol de dispositivos analizados. En teor\u00eda, el subsistema IOMMU podr\u00eda liberar un dispositivo despu\u00e9s de device_rbtree_find() y antes de iopf_get_dev_fault_param(), lo que causar\u00eda un problema de uso despu\u00e9s de la liberaci\u00f3n. Agregue un mutex para sincronizar la ruta de informe de fallos de la p\u00e1gina de E/S y la ruta del dispositivo de liberaci\u00f3n IOMMU. Este bloqueo no introduce ninguna sobrecarga de rendimiento, ya que el conflicto entre el informe de fallos de la p\u00e1gina de E/S y la liberaci\u00f3n del dispositivo es muy raro."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.5, "impactScore": 4.2}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-416"}]}], "references": [{"url": "https://git.kernel.org/stable/c/3d39238991e745c5df85785604f037f35d9d1b15", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/def054b01a867822254e1dda13d587f5c7a99e2a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1174", "comment": "CVE-2024-35843 - This is a memory corruption vulnerability in the Linux kernel, which can be exploited by an attacker to execute arbitrary code. This vulnerability is related to the 'System Service' technique, which involves compromising a system by exploiting services running on it."}, {"techniqueID": "T1199", "comment": "CVE-2024-35843 - This is a use-after-free vulnerability in the Linux kernel, which can be exploited by an attacker to execute arbitrary code. This vulnerability is related to the 'Exploitation of Resource Limitation' technique, which involves exploiting limitations in system resources to achieve a compromise."}, {"techniqueID": "T1501", "comment": "CVE-2024-35843 - This is a kernel module exploit that can be used by an attacker to inject arbitrary code into the kernel. This vulnerability is related to the 'System Modification' technique, which involves modifying system components to achieve a compromise."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "cve-2024-35843-stix-bundle", "title": "CVE-2024-35843: Linux kernel memory corruption vulnerability", "objects": [{"type": "vulnerability", "id": "cve-2024-35843", "title": "Linux kernel memory corruption vulnerability", "description": "This vulnerability is a memory corruption issue in the Linux kernel that can be exploited by an attacker to execute arbitrary code.", "relations": [{"type": "indicates", "object_ref": "mitre-technique:T1174", "relationship": "exploited-by"}, {"type": "indicates", "object_ref": "mitre-technique:T1199", "relationship": "exploited-by"}, {"type": "indicates", "object_ref": "mitre-technique:T1501", "relationship": "exploited-by"}]}, {"type": "mitre-technique", "id": "mitre-technique:T1174", "title": "System Service", "description": "Compromise a system by exploiting services running on it."}, {"type": "mitre-technique", "id": "mitre-technique:T1199", "title": "Exploitation of Resource Limitation", "description": "Exploit limitations in system resources to achieve a compromise."}, {"type": "mitre-technique", "id": "mitre-technique:T1501", "title": "System Modification", "description": "Modify system components to achieve a compromise."}, {"type": "course-of-action", "id": "cpe-2024-35843-mitigation", "title": "Mitigation", "description": "Apply the patches provided by the vendor to address the vulnerability.", "relationships": [{"type": "mitigates", "object_ref": "mitre-technique:T1174", "relationship": "vulnerable-to"}, {"type": "mitigates", "object_ref": "mitre-technique:T1199", "relationship": "vulnerable-to"}, {"type": "mitigates", "object_ref": "mitre-technique:T1501", "relationship": "vulnerable-to"}]}]}, "technical_analysis": {"Introduction": "The vulnerability in the Linux kernel is a memory corruption issue that can be exploited by an attacker to execute arbitrary code. This vulnerability is related to the exploitation of services running on the system and can be mitigated by applying the patches provided by the vendor.", "Impact and Scope": "The impact of this vulnerability is a compromise of the system, which can lead to the execution of arbitrary code. The scope of this vulnerability is limited to the Linux kernel and can be exploited by an attacker with access to the system.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1174, T1199, and T1501, which involve exploitation of services running on the system, exploitation of resource limitations, and system modification, respectively.", "Technical Details": "The vulnerability is a memory corruption issue that occurs when the Linux kernel is used to allocate memory for an object. An attacker can exploit this vulnerability by calling a function that allocates memory for the object, thereby causing the memory to be corrupted.", "Detection": "The detection of this vulnerability can be done by analyzing the system logs for suspicious activity and by using tools such as memory analyzers to detect memory corruption.", "Mitigation": "The mitigation of this vulnerability can be done by applying the patches provided by the vendor and by implementing additional security measures such as memory protection and isolation.", "Conclusion": "In conclusion, the vulnerability in the Linux kernel is a serious issue that can be exploited by an attacker to execute arbitrary code. The exploitation of this vulnerability can be mitigated by applying the patches provided by the vendor and by implementing additional security measures."}, "executive_analysis": {"Overview": "This vulnerability is a memory corruption issue in the Linux kernel that can be exploited by an attacker to execute arbitrary code. This vulnerability is related to the exploitation of services running on the system and can be mitigated by applying the patches provided by the vendor.", "Business Impact": "The business impact of this vulnerability is a compromise of the system, which can lead to the execution of arbitrary code. This can result in the loss of confidential data, disruption of business operations, and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is a compromise of the system, which can lead to the execution of arbitrary code. This can result in the loss of system integrity, unauthorized access to system resources, and the execution of malicious code.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include applying the patches provided by the vendor, implementing additional security measures such as memory protection and isolation, and monitoring system logs for suspicious activity.", "Recommendations": "The recommendations for executives are to apply the patches provided by the vendor, implement additional security measures, and monitor system logs for suspicious activity.", "Conclusions": "In conclusion, the vulnerability in the Linux kernel is a serious issue that requires immediate attention and action. The exploitation of this vulnerability can be mitigated by applying the patches provided by the vendor and by implementing additional security measures."}}