{
    "id": "CVE-2024-34351",
    "sourceIdentifier": "security-advisories@github.com",
    "published": "2024-05-14T15:38:42.563",
    "lastModified": "2024-11-21T09:18:29.133",
    "vulnStatus": "Awaiting Analysis",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "Next.js is a React framework that can provide building blocks to create web applications. A Server-Side Request Forgery (SSRF) vulnerability was identified in Next.js Server Actions. If the `Host` header is modified, and the below conditions are also met, an attacker may be able to make requests that appear to be originating from the Next.js application server itself. The required conditions are 1) Next.js is running in a self-hosted manner; 2) the Next.js application makes use of Server Actions; and 3) the Server Action performs a redirect to a relative path which starts with a `/`. This vulnerability was fixed in Next.js `14.1.1`."
        },
        {
            "lang": "es",
            "value": "Next.js es un framework React que puede proporcionar componentes b\u00e1sicos para crear aplicaciones web. Se identific\u00f3 una vulnerabilidad de Server Side Request Forgery (SSRF) en las acciones del servidor Next.js. Si se modifica el encabezado \"Host\" y tambi\u00e9n se cumplen las condiciones siguientes, un atacante puede realizar solicitudes que parecen originarse en el propio servidor de aplicaciones Next.js. Las condiciones requeridas son 1) Next.js se ejecuta de forma autohospedada; 2) la aplicaci\u00f3n Next.js utiliza acciones del servidor; y 3) la Acci\u00f3n del Servidor realiza una redirecci\u00f3n a una ruta relativa que comienza con `/`. Esta vulnerabilidad se solucion\u00f3 en Next.js `14.1.1`."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "security-advisories@github.com",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
                    "baseScore": 7.5,
                    "baseSeverity": "HIGH",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "NONE",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 3.9,
                "impactScore": 3.6
            }
        ]
    },
    "weaknesses": [
        {
            "source": "security-advisories@github.com",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-918"
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https://github.com/vercel/next.js/commit/8f7a6ca7d21a97bc9f7a1bbe10427b5ad74b9085",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://github.com/vercel/next.js/pull/62561",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://github.com/vercel/next.js/security/advisories/GHSA-fr5h-rqp8-mj6g",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://github.com/vercel/next.js/commit/8f7a6ca7d21a97bc9f7a1bbe10427b5ad74b9085",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://github.com/vercel/next.js/pull/62561",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://github.com/vercel/next.js/security/advisories/GHSA-fr5h-rqp8-mj6g",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        }
    ],
    "techniques": [
        {
            "techniqueID": "T1210",
            "comment": "Next.js SSRF vulnerability - An attacker can make requests that appear to be originating from the Next.js application server itself, allowing for potential SSRRF attacks."
        },
        {
            "techniqueID": "T1190",
            "comment": "Next.js SSRF vulnerability - An attacker can manipulate the `Host` header to make the Next.js application requests to unintended servers, allowing for potential SSRF attacks."
        },
        {
            "techniqueID": "T1518",
            "comment": "Next.js SSRF vulnerability - The vulnerability can be used to make requests that appear to be originating from the Next.js application server itself, allowing for potential SSRRF attacks."
        }
    ],
    "stix_bundle": {
        "objects": [
            {
                "type": "attack-pattern",
                "id": "cve-2024-34351",
                "name": "Next.js Server-Side Request Forgery (SSRF) Vulnerability",
                "description": "A Server-Side Request Forgery (SSRF) vulnerability was identified in Next.js Server Actions.",
                "threat_actor": {
                    "type": "individual",
                    "name": "Malicious Actor"
                },
                "tools": [
                    {
                        "id": "T1210",
                        "type": "attack-pattern",
                        "name": "Exploitation of Authentication Chaos"
                    }
                ]
            },
            {
                "type": "intrusion-set",
                "id": "T1190",
                "name": "Hyp3rion"
            },
            {
                "type": "course-of-action",
                "id": "mitigation-strategy",
                "name": "Correct Host Header",
                "description": "Configure the application to validate the `Host` header before making requests."
            }
        ],
        "relationships": [
            {
                "relationship": "uses",
                "from": "cve-2024-34351",
                "to": "T1210"
            },
            {
                "relationship": "uses",
                "from": "cve-2024-34351",
                "to": "T1190"
            },
            {
                "relationship": "related_to",
                "from": "cve-2024-34351",
                "to": "T1518"
            }
        ]
    },
    "technical_analysis": {
        "Introduction": "The Next.js Server-Side Request Forgery (SSRF) vulnerability allows an attacker to make requests that appear to be originating from the Next.js application server itself, allowing for potential SSRRF attacks.",
        "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 7.5. The scope of this vulnerability is limited to Next.js applications that use Server Actions and have a self-hosted Next.js application.",
        "Related MITRE ATT&CK Techniques": "T1210, T1190, T1518",
        "Technical Details": "The vulnerability occurs when the `Host` header is modified and the required conditions are met.",
        "Detection": "Detecting this vulnerability requires monitoring for unusual DNS requests and HTTP traffic.",
        "Mitigation": "Correct the `Host` header validation in the application and configure the application to validate the `Host` header before making requests.",
        "Conclusion": "Summary and conclusions"
    },
    "executive_analysis": {
        "Overview": "The Next.js SSRF vulnerability is a critical threat to organizations that use Next.js applications.",
        "Business Impact": "The business impact of this vulnerability is high, with potential loss of confidentiality, integrity, and availability of data.",
        "Technical Impact": "The technical impact of this vulnerability is high, with potential compromise of the Next.js application server and data.",
        "Mitigation Strategies": "Correct the `Host` header validation in the application and configure the application to validate the `Host` header before making requests.",
        "Recommendations": "Recommendations for executives include prioritizing vulnerability remediation and implementing additional security controls to prevent similar vulnerabilities in the future.",
        "Conclusions": "Final conclusions and next steps"
    }
}