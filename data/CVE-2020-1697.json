{"id": "CVE-2020-1697", "sourceIdentifier": "secalert@redhat.com", "published": "2020-02-10T15:15:21.497", "lastModified": "2023-11-07T03:19:27.053", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "It was found in all keycloak versions before 9.0.0 that links to external applications (Application Links) in the admin console are not validated properly and could allow Stored XSS attacks. An authed malicious user could create URLs to trick users in other realms, and possibly conduct further attacks."}, {"lang": "es", "value": "Se encontr\u00f3 en todas las versiones de keycloak anteriores a 9.0.0 que los enlaces de aplicaciones externas (Application Links) en la consola de administraci\u00f3n no est\u00e1n validados apropiadamente y podr\u00edan permitir ataques de tipo XSS almacenado. Un usuario malicioso autorizado podr\u00eda crear una URL para enga\u00f1ar a los usuarios en otras esferas y posiblemente conducir nuevos ataques."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "secalert@redhat.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:keycloak:*:*:*:*:*:*:*:*", "versionEndExcluding": "9.0.0", "matchCriteriaId": "5BB41E7C-AE34-41FF-AD28-573D002945FB"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:single_sign-on:7.3:*:*:*:*:*:*:*", "matchCriteriaId": "E939A0E0-3437-459E-9FAB-FE42811B1D32"}]}]}], "references": [{"url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2020-1697", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-1697 - Stored XSS attacks may occur due to the lack of validation in the admin console, leading to potential further attacks. To defend against this, ensure proper input validation and sanitization in your application."}, {"techniqueID": "T1193", "comment": "CVE-2020-1697 - The vulnerability in the admin console's link creation mechanism can lead to Stored XSS attacks. Implement secure coding practices and ensure that all user input is properly validated and sanitized to prevent such attacks."}, {"techniqueID": "T1199", "comment": "CVE-2020-1697 - The lack of validation in the admin console's link creation mechanism can lead to Stored XSS attacks. Include proper security checks and input validation in your application to prevent such attacks."}], "stix_bundle": {"type": "bundle", "id": "bundle-UUID", "spec_version": "2.1", "idref": "CVE-2020-1697", "created_by_ref": "your-username", "objects": [{"type": "vulnerability", "id": "vulnerability-UUID", "created_by_ref": "your-username", "name": "CVE-2020-1697", "description": "Stored XSS attacks may occur due to the lack of validation in the admin console.", "baseScore": 5.4, "baseSeverity": "MEDIUM", "modified": "2023-11-07T03:19:27.053", "objectMarking": [{"idref": "your-marking-criterion", "definition": "Your marking definition"}]}, {"type": "indicator", "id": "indicator-UUID", "created_by_ref": "your-username", "name": "Indicator for CVE-2020-1697", "description": "Indicator for CVE-2020-1697", "modified": "2023-11-07T03:19:27.053", "uniquifier": "Your uniquifier", "pattern": "Your pattern"}, {"type": "report", "id": "report-UUID", "created_by_ref": "your-username", "name": "Report for CVE-2020-1697", "description": "This report provides information about the vulnerability CVE-2020-1697", "modified": "2023-11-07T03:19:27.053", "object_marking": [{"idref": "your-marking-criterion", "definition": "Your marking definition"}]}, {"type": "course-of-action", "id": "course-of-action-UUID", "created_by_ref": "your-username", "name": "Course of Action for CVE-2020-1697", "description": "This course of action provides steps to mitigate CVE-2020-1697", "modified": "2023-11-07T03:19:27.053", "object_marking": [{"idref": "your-marking-criterion", "definition": "Your marking definition"}]}], "relationships": [{"type": "has-part", "idref": "vulnerability-UUID", "object": "indicator-UUID"}, {"type": "has-part", "idref": "vulnerability-UUID", "object": "report-UUID"}, {"type": "mitigates", "idref": "course-of-action-UUID", "object": "vulnerability-UUID"}]}, "technical_analysis": {"Introduction": "The CVE-2020-1697 vulnerability in Keycloak affects all versions before 9.0.0, allowing Stored XSS attacks due to the lack of validation in the admin console's link creation mechanism.", "Impact and Scope": "The vulnerability has a CVSS score of 5.4, with a medium severity rating. It can potentially allow attackers to conduct further attacks.", "Related MITRE ATT&CK Techniques": "T1190, T1193, and T1199", "Technical Details": "The vulnerability occurs due to the lack of validation in the admin console's link creation mechanism, which can lead to Stored XSS attacks.", "Detection": "Monitor for unusual activity in the admin console's link creation mechanism.", "Mitigation": "Implement proper security checks and input validation to prevent Stored XSS attacks.", "Conclusion": "The CVE-2020-1697 vulnerability is a high-risk flaw that can lead to Stored XSS attacks and potential further attacks. It is essential to upgrade to the latest version and implement proper security measures."}, "executive_analysis": {"Overview": "CVE-2020-1697 is a Stored XSS vulnerability in Keycloak's admin console, affecting all versions before 9.0.0.", "Business Impact": "The vulnerability can lead to potential data breaches and compromise of sensitive information.", "Technical Impact": "The vulnerability can allow attackers to conduct further attacks and compromise the security of the system.", "Mitigation Strategies": "Upgrade to the latest version of Keycloak, implement proper security checks, and input validation.", "Recommendations": "Apply the necessary security patches, conduct regular security audits, and implement incident response plans.", "Conclusions": "The CVE-2020-1697 vulnerability is a critical security flaw that requires immediate attention and action to prevent potential attacks."}}