{"id": "CVE-2024-40632", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-15T22:15:03.017", "lastModified": "2024-07-16T13:43:58.773", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Linkerd is an open source, ultralight, security-first service mesh for Kubernetes. In affected versions when the application being run by linkerd is susceptible to SSRF, an attacker could potentially trigger a denial-of-service (DoS) attack by making requests to localhost:4191/shutdown. Linkerd could introduce an optional environment variable to control a token that must be passed as a header. Linkerd should reject shutdown requests that do not include this header. This issue has been addressed in release version edge-24.6.2 and all users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Linkerd es una malla de servicios de c\u00f3digo abierto, ultraligera y que prioriza la seguridad para Kubernetes. En las versiones afectadas, cuando la aplicaci\u00f3n que ejecuta Linkerd es susceptible a SSRF, un atacante podr\u00eda desencadenar un ataque de denegaci\u00f3n de servicio (DoS) al realizar solicitudes a localhost:4191/shutdown. Linkerd podr\u00eda introducir una variable de entorno opcional para controlar un token que debe pasarse como encabezado. Linkerd deber\u00eda rechazar las solicitudes de cierre que no incluyan este encabezado. Este problema se solucion\u00f3 en la versi\u00f3n edge-24.6.2 y se recomienda a todos los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 3.7, "baseSeverity": "LOW"}, "exploitabilityScore": 2.2, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-918"}]}], "references": [{"url": "https://github.com/linkerd/linkerd2-proxy/blob/46957de49f25fd4661af7b7c52659148f4d6dd27/linkerd/app/admin/src/server.rs", "source": "security-advisories@github.com"}, {"url": "https://github.com/linkerd/linkerd2/commit/35fb2d6d11ef6520ae516dd717790529f85224fa", "source": "security-advisories@github.com"}, {"url": "https://github.com/linkerd/linkerd2/security/advisories/GHSA-6v94-gj6x-jqj7", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1568", "comment": "CVE-2024-40632 - SSRF vector in Linkerd, potential DoS attack. Defend against it by implementing an optional environment variable to control a token that must be passed as a header."}, {"techniqueID": "T1218", "comment": "CVE-2024-40632 - SSRF vector in Linkerd, potential DoS attack. Defend against it by regularly checking and updating the Linkerd version to ensure you're running a patched version (e.g., edge-24.6.2)."}, {"techniqueID": "T1036", "comment": "CVE-2024-40632 - SSRF vector in Linkerd, potential DoS attack. Defend against it by configuring Linkerd to reject shutdown requests that do not include the required header."}], "stix_bundle": {"stix_2_1_bundle": {"bundle": {"id": "https://example.com/cve-2024-40632", "type": "bundle", "created_by_ref": "https://example.com/creators", "created": "2024-07-15T22:15:03.017", "modified": "2024-07-16T13:43:58.773", "description": "Linkerd SSRF vulnerability CVE-2024-40632", "objects": [{"id": "https://example.com/cve-2024-40632", "type": "vulnerability", "name": "Linkerd SSRF vulnerability CVE-2024-40632", "description": "Linkerd SSRF vulnerability CVE-2024-40632", "attributes": [{"name": "CVSS_score", "value": "3.7", "type": "string"}], "relationships": [{"type": "includes", "id": "linkerd_ssrf_attack_pattern", "object_ref": "https://example.com/linkerd_ssrf_attack_pattern"}]}, {"id": "https://example.com/linkerd_ssrf_attack_pattern", "type": "attack-pattern", "name": "Linkerd SSRF attack pattern", "description": "Linkerd SSRF attack pattern", "attributes": [{"name": "attack_vectors", "value": "SSRF", "type": "string"}], "relationships": [{"type": "uses", "id": "linkerd_ssrf_tactic", "object_ref": "https://example.com/linkerd_ssrf_tactic"}]}, {"id": "https://example.com/linkerd_ssrf_tactic", "type": "tactic", "name": "Linkerd SSRF tactic", "description": "Linkerd SSRF tactic", "attributes": [{"name": "tactics", "value": "Initial Access", "type": "string"}]}, {"id": "https://example.com/linkerd_ssrf_course_of_action", "type": "course-of-action", "name": "Linkerd SSRF course of action", "description": "Linkerd SSRF course of action", "attributes": [{"name": "status", "value": "Recommended", "type": "string"}]}, {"id": "https://example.com/linkerd_ssrf_counter_measure", "type": "counter_measure", "name": "Linkerd SSRF counter measure", "description": "Linkerd SSRF counter measure", "attributes": [{"name": "type", "value": "Network Traffic Analysis", "type": "string"}]}]}}}, "technical_analysis": {"Introduction": "This vulnerability allows an attacker to trigger a DoS attack by making requests to localhost:4191/shutdown.", "Impact and Scope": "The vulnerability has a CVSS score of 3.7, with an attack vector of NETWORK and an impact of LOW.", "Related MITRE ATT&CK Techniques": "T1568, T1218, and T1036 are the relevant MITRE ATT&CK techniques for this vulnerability.", "Technical Details": "The vulnerability exists due to the lack of an optional environment variable to control a token that must be passed as a header.", "Detection": " Detection can be done by monitoring network traffic for requests to localhost:4191/shutdown and verifying if the required header is present.", "Mitigation": "Regularly checking and updating the Linkerd version to ensure you're running a patched version (e.g., edge-24.6.2) and configuring Linkerd to reject shutdown requests that do not include the required header.", "Conclusion": "The vulnerability can be mitigated by implementing an optional environment variable, regularly updating Linkerd, and configuring Linkerd to reject shutdown requests that do not include the required header."}, "executive_analysis": {"Overview": "This vulnerability in Linkerd allows an attacker to trigger a DoS attack.", "Business Impact": "The business impact of this vulnerability is that it can lead to a loss of productivity and revenue due to downtime.", "Technical Impact": "The technical impact of this vulnerability is that it can lead to unauthorized access and disruption of services.", "Mitigation Strategies": "Regularly updating Linkerd and configuring it to reject shutdown requests that do not include the required header are the recommended mitigation strategies.", "Recommendations": "We recommend that organizations prioritize patching and updating their Linkerd versions as soon as possible.", "Conclusions": "This vulnerability highlights the importance of regular security patching and updates to prevent potential security breaches."}}