{"id": "CVE-2023-5421", "sourceIdentifier": "security@otrs.com", "published": "2023-10-16T09:15:11.940", "lastModified": "2023-10-19T20:19:21.313", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An attacker who is logged into OTRS as an user with privileges to create and change customer user data may manipulate the CustomerID field to execute JavaScript code that runs \nimmediatly after the data is saved.The issue onlyoccurs if the configuration for AdminCustomerUser::UseAutoComplete was changed before.\nThis issue affects OTRS: from 7.0.X before 7.0.47, from 8.0.X before 8.0.37; ((OTRS)) Community Edition: from 6.0.X through 6.0.34.\n\n"}, {"lang": "es", "value": "Un atacante que haya iniciado sesi\u00f3n en OTRS como usuario con privilegios para crear y cambiar datos de usuario del cliente puede manipular el campo CustomerID para ejecutar c\u00f3digo JavaScript que se ejecuta inmediatamente despu\u00e9s de guardar los datos. El problema solo ocurre si se cambi\u00f3 la configuraci\u00f3n de AdminCustomerUser::UseAutoComplete antes. Este problema afecta a OTRS: desde 7.0.X anterior a 7.0.47, desde 8.0.X anterior a 8.0.37; ((OTRS)) Community Edition: desde 6.0.X hasta 6.0.34."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security@otrs.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 0.9, "impactScore": 2.5}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security@otrs.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:otrs:otrs:*:*:*:*:community:*:*:*", "versionStartIncluding": "6.0.0", "versionEndIncluding": "6.0.34", "matchCriteriaId": "F933EBB8-2E51-4E24-BB9E-64FBE0FCBFDB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:otrs:otrs:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.0.0", "versionEndExcluding": "7.0.47", "matchCriteriaId": "B1C07539-E637-4A14-97EE-9FE4CB60644F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:otrs:otrs:*:*:*:*:*:*:*:*", "versionStartIncluding": "8.0.0", "versionEndExcluding": "8.0.37", "matchCriteriaId": "400DD972-B06D-44C6-BD88-737BA162B3E1"}]}]}], "references": [{"url": "https://otrs.com/release-notes/otrs-security-advisory-2023-09/", "source": "security@otrs.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059.003", "comment": "CVE-2023-5421 - Phishing with injected script tags directly in the POST request, similar technique is used to inject JavaScript code which executes immediately after the data is saved."}, {"techniqueID": "T1082", "comment": "CVE-2023-5421 - Web Application Manipulation, an attacker can manipulate the CustomerID field to execute JavaScript code that runs immediately after the data is saved."}, {"techniqueID": "T1040", "comment": "CVE-2023-5421 - Network Sniffing, attacker can sniff the traffic to inject the malicious code and execute it using the existing session."}], "technical_analysis": {"Introduction": "The vulnerability CVE-2023-5421 in OTRS allows an attacker to execute JavaScript code by manipulating the CustomerID field. This can be done by logging into OTRS as a user with privileges to create and change customer user data.", "Impact and Scope": "The vulnerability has a high impact as it allows an attacker to execute arbitrary code without needing to authenticate as an administrator. It affects OTRS versions from 7.0.X before 7.0.47, from 8.0.X before 8.0.37, and ((OTRS)) Community Edition: from 6.0.X through 6.0.34.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1059.003, T1082, and T1040.", "Technical Details": "The vulnerability is caused by the lack of proper input validation in the CustomerID field, allowing an attacker to inject JavaScript code that executes immediately after the data is saved.", "Detection": "Detection of this vulnerability is challenging as it requires logging into OTRS as a user with privileges to create and change customer user data.", "Mitigation": "The vulnerability can be mitigated by patching the affected versions of OTRS, or by implementing additional security measures such as input validation and security headers.", "Conclusion": "CVE-2023-5421 is a critical vulnerability that requires immediate attention and patching to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2023-5421 is a critical vulnerability in OTRS that allows an attacker to execute arbitrary code without needing to authenticate as an administrator.", "Business Impact": "The vulnerability can significantly impact the security and integrity of the OTRS system, and may lead to unauthorized access and data theft.", "Technical Impact": "The vulnerability is related to the lack of proper input validation in the CustomerID field, allowing an attacker to inject JavaScript code that executes immediately after the data is saved.", "Mitigation Strategies": "Patching the affected versions of OTRS and implementing additional security measures such as input validation and security headers are recommended.", "Recommendations": "Immediate action is required to patch the vulnerability and implement additional security measures to prevent exploitation.", "Conclusions": "CVE-2023-5421 is a critical vulnerability that requires immediate attention and patching to prevent exploitation."}}