{"id": "CVE-2024-6834", "sourceIdentifier": "zowe-security@lists.openmainframeproject.org", "published": "2024-07-17T15:15:14.970", "lastModified": "2024-08-01T14:00:44.750", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability in APIML Spring Cloud Gateway which leverages user privileges by unexpected signing proxied request by Zowe's client certificate. This allows access to a user to the endpoints requiring an internal client certificate without any credentials. It could lead to managing components in there and allow an attacker to handle the whole communication including user credentials."}, {"lang": "es", "value": "Una vulnerabilidad en APIML Spring Cloud Gateway que aprovecha los privilegios del usuario mediante una solicitud de firma inesperada mediante proxy por parte del certificado de cliente de Zowe. Esto permite el acceso de un usuario a los endpoints que requieren un certificado de cliente interno sin ninguna credencial. Podr\u00eda llevar a administrar componentes all\u00ed y permitir que un atacante maneje toda la comunicaci\u00f3n, incluidas las credenciales del usuario."}], "metrics": {"cvssMetricV31": [{"source": "zowe-security@lists.openmainframeproject.org", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.2, "impactScore": 6.0}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-250"}]}], "references": [{"url": "https://github.com/zowe/api-layer", "source": "zowe-security@lists.openmainframeproject.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-6834 - A vulnerability in APIML Spring Cloud Gateway allows an attacker to leverage user privileges by signing proxied requests with a Zowe client certificate, enabling access to internal client certificate-protected endpoints without credentials."}, {"techniqueID": "T1027", "comment": "CVE-2024-6834 - The vulnerability can be exploited by an attacker to manage components and handle communication, including user credentials, without providing any credentials."}, {"techniqueID": "T1568", "comment": "CVE-2024-6834 - The attack vector is NETWORK, indicating that the vulnerability can be exploited remotely, and the attack complexity is HIGH, requiring significant expertise."}, {"techniqueID": "T1196", "comment": "CVE-2024-6834 - The vulnerability can be used to access internal client certificate-protected endpoints, allowing an attacker to execute malicious actions."}], "stix_bundle": {"spec_version": "2.1", "id": "CVE-2024-6834", "type": "bundle", "objects": [{"id": "CVE-2024-6834", "type": "vulnerability", "name": "CVE-2024-6834", "description": "A vulnerability in APIML Spring Cloud Gateway which leverages user privileges by unexpected signing proxied request by Zowe's client certificate. This allows access to a user to the endpoints requiring an internal client certificate without any credentials. It could lead to managing components in there and allow an attacker to handle the whole communication including user credentials.", "references": [{"id": "https://github.com/zowe/api-layer", "type": "Reference", "url": "https://github.com/zowe/api-layer"}]}, {"id": "T1190", "type": "attack-pattern", "name": "Default Traffic for HTTP", "description": "A technique to redirect network traffic to a known target, in this case, the vulnerable endpoint.", "related_objects": [{"id": "CVE-2024-6834", "type": "vulnerability", "role": "implied_by"}]}, {"id": "T1027", "type": "attack-pattern", "name": "Web Shell", "description": "A technique to upload and execute code on a web server, in this case, the vulnerable endpoint.", "related_objects": [{"id": "CVE-2024-6834", "type": "vulnerability", "role": "implied_by"}]}, {"id": "T1568", "type": "attack-pattern", "name": "Network Traffic Modification", "description": "A technique to modify network traffic, in this case, appending malicious headers to the request.", "related_objects": [{"id": "CVE-2024-6834", "type": "vulnerability", "role": "implied_by"}]}, {"id": "T1196", "type": "attack-pattern", "name": "Data Encryption", "description": "A technique to encrypt data, in this case, encrypting the communication with the vulnerable endpoint.", "related_objects": [{"id": "CVE-2024-6834", "type": "vulnerability", "role": "implied_by"}]}, {"id": "detection-1", "type": "indicator", "name": "Detection for CVE-2024-6834", "description": "A detection indicator for the CVE-2024-6834 vulnerability.", "related_objects": [{"id": "CVE-2024-6834", "type": "vulnerability", "role": "observed-by"}]}, {"id": "mitigation-1", "type": "indicator", "name": "Mitigation for CVE-2024-6834", "description": "A mitigation indicator for the CVE-2024-6834 vulnerability.", "related_objects": [{"id": "CVE-2024-6834", "type": "vulnerability", "role": "mitigated-by"}]}]}, "technical_analysis": {"Introduction": "CVE-2024-6834 is a vulnerability in APIML Spring Cloud Gateway that allows an attacker to leverage user privileges by signing proxied requests with a Zowe client certificate, enabling access to internal client certificate-protected endpoints without credentials.", "Impact and Scope": "The vulnerability has a CVSS score of 9.0 with a version of 3.1 and an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK T1190, T1027, T1568, and T1196.", "Technical Details": "The vulnerability occurs when a user with valid credentials signs a proxied request with a Zowe client certificate, allowing access to internal client certificate-protected endpoints without providing any credentials.", "Detection": "Detection methods include monitoring network traffic for suspicious requests and analyzing system logs for indications of unauthorized access.", "Mitigation": "Mitigation strategies include disabling access to internal client certificate-protected endpoints for users without valid credentials and implementing robust authentication and authorization mechanisms.", "Conclusion": "CVE-2024-6834 is a critical vulnerability that requires immediate attention to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-6834 is a critical vulnerability in APIML Spring Cloud Gateway that allows an attacker to leverage user privileges and access internal client certificate-protected endpoints without credentials.", "Business Impact": "The vulnerability poses a significant risk to confidentiality, integrity, and availability of data and systems.", "Technical Impact": "The vulnerability is exploitable remotely and requires significant expertise, making it a high-priority threat.", "Mitigation Strategies": "Implementing robust authentication and authorization mechanisms and disabling access to internal client certificate-protected endpoints for users without valid credentials can help mitigate the vulnerability.", "Recommendations": "Immediately patch the vulnerability and conduct a thorough risk assessment to identify potential impact and implement mitigation strategies.", "Conclusions": "CVE-2024-6834 is a critical vulnerability that requires immediate attention and action to prevent exploitation."}}