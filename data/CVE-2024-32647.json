{"id": "CVE-2024-32647", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-25T18:15:08.963", "lastModified": "2024-04-26T12:58:17.720", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Vyper is a pythonic Smart Contract Language for the Ethereum virtual machine. In versions 0.3.10 and prior, using the `create_from_blueprint` builtin can result in a double eval vulnerability when `raw_args=True` and the `args` argument has side-effects. It can be seen that the `_build_create_IR` function of the `create_from_blueprint` builtin doesn't cache the mentioned `args` argument to the stack. As such, it can be evaluated multiple times (instead of retrieving the value from the stack). No vulnerable production contracts were found. Additionally, double evaluation of side-effects should be easily discoverable in client tests. As such, the impact is low. As of time of publication, no fixed versions exist.\n"}, {"lang": "es", "value": "Vyper es un lenguaje de contrato inteligente pit\u00f3nico para la m\u00e1quina virtual Ethereum. En las versiones 0.3.10 y anteriores, el uso de la funci\u00f3n incorporada `create_from_blueprint` puede resultar en una vulnerabilidad de doble evaluaci\u00f3n cuando `raw_args=True` y el argumento `args` tienen efectos secundarios. Se puede ver que la funci\u00f3n `_build_create_IR` del incorporado `create_from_blueprint` no almacena en cach\u00e9 el argumento `args` mencionado en la pila. Como tal, se puede evaluar varias veces (en lugar de recuperar el valor de la pila). No se encontraron contratos de producci\u00f3n vulnerables. Adem\u00e1s, la doble evaluaci\u00f3n de los efectos secundarios deber\u00eda poder descubrirse f\u00e1cilmente en las pruebas de los clientes. Como tal, el impacto es bajo. Al momento de la publicaci\u00f3n, no existen versiones fijas."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-95"}]}], "references": [{"url": "https://github.com/vyperlang/vyper/blob/cedf7087e68e67c7bfbd47ae95dcb16b81ad2e02/vyper/builtins/functions.py#L1847", "source": "security-advisories@github.com"}, {"url": "https://github.com/vyperlang/vyper/security/advisories/GHSA-3whq-64q2-qfj6", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-32647 - Double Eval Vulnerability in Vyper Contract Language can lead to potential exploitation. Defence strategy is to review and validate input parameters for side effects."}, {"techniqueID": "T1210", "comment": "CVE-2024-32647 - The `create_from_blueprint` function in Vyper Contract Language can lead to potential exploitation. Defence strategy is to review and validate input parameters for side effects."}, {"techniqueID": "T1204", "comment": "CVE-2024-32647 - The use of `raw_args=True` in `_build_create_IR` function in Vyper Contract Language can lead to potential exploitation. Defence strategy is to review and validate input parameters for side effects."}], "stix_bundle": {"id": "bundle-cve-2024-32647", "type": "bundle", "description": "MITRE ATT&CK Techniques for CVE-2024-32647", "name": "Vyper Contract Language Double Eval Vulnerability", "objects": [{"type": "vulnerability", "id": "vuln-cve-2024-32647", "description": "Double Eval Vulnerability in Vyper Contract Language", "cve_id": "CVE-2024-32647", "cvss_v31": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N", "baseScore": 5.3, "baseSeverity": "MEDIUM"}}, {"type": "threat_actor", "id": "threat_actor-cve-2024-32647", "name": "Potential Exploiters", "description": "Threat actors that may exploit CVE-2024-32647"}, {"type": "technique", "id": "tec-t1190", "name": "Double Evaulation", "description": "Double evaulation of side effects in Vyper Contract Language"}, {"type": "course_of_action", "id": "coa-cve-2024-32647", "name": "Review and Validate Input Parameters", "description": "Review and validate input parameters for side effects", "related_techniques": ["tec-t1190"]}, {"type": "note", "id": "note-cve-2024-32647", "content": "Defence strategy is to review and validate input parameters for side effects."}], "relationships": [{"type": "vulnerability-threat_actor", "id": "rel-vuln-threat-actor", "description": "This vulnerability may be exploited by the specified threat actors"}, {"type": "course_of_action-technique", "id": "rel-coa-tec", "description": "This course of action is related to the specified technique"}, {"type": "course_of_action-vulnerability", "id": "rel-coa-vuln", "description": "This course of action is related to the specified vulnerability"}]}, "technical_analysis": {"Introduction": "The CVE-2024-32647 is a double eval vulnerability in Vyper Contract Language that can lead to potential exploitation.", "Impact and Scope": "The impact of this vulnerability is low, but it can still lead to unauthorized access or data corruption.", "Related MITRE ATT&CK Techniques": "T1190, T1210, T1204", "Technical Details": "The vulnerability is caused by the use of `raw_args=True` in the `_build_create_IR` function, which can lead to double evaluation of side effects.", "Detection": "Detection of this vulnerability can be done by reviewing and validating input parameters for side effects.", "Mitigation": "Mitigation of this vulnerability can be done by reviewing and validating input parameters for side effects and implementing appropriate security measures.", "Conclusion": "In conclusion, the CVE-2024-32647 is a double eval vulnerability in Vyper Contract Language that can lead to potential exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-32647 is a double eval vulnerability in Vyper Contract Language that can lead to potential exploitation.", "Business Impact": "The business impact of this vulnerability is low, but it can still lead to unauthorized access or data corruption.", "Technical Impact": "The technical impact of this vulnerability is high, as it can lead to potential exploitation.", "Mitigation Strategies": "Mitigation of this vulnerability can be done by reviewing and validating input parameters for side effects and implementing appropriate security measures.", "Recommendations": "Recommendations for executives include reviewing and validating input parameters for side effects, implementing appropriate security measures, and staying up to date with the latest security patches.", "Conclusions": "In conclusion, the CVE-2024-32647 is a double eval vulnerability in Vyper Contract Language that can lead to potential exploitation, and it is recommended that executives take steps to mitigate this vulnerability."}}