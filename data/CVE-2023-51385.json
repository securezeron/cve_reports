{
    "id": "CVE-2023-51385",
    "sourceIdentifier": "cve@mitre.org",
    "published": "2023-12-18T19:15:08.773",
    "lastModified": "2024-03-13T21:15:55.100",
    "vulnStatus": "Modified",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "In ssh in OpenSSH before 9.6, OS command injection might occur if a user name or host name has shell metacharacters, and this name is referenced by an expansion token in certain situations. For example, an untrusted Git repository can have a submodule with shell metacharacters in a user name or host name."
        },
        {
            "lang": "es",
            "value": "En ssh en OpenSSH anterior a 9.6, la inyecci\u00f3n de comandos del sistema operativo puede ocurrir si un nombre de usuario o nombre de host tiene metacaracteres de shell, y un token de expansi\u00f3n hace referencia a este nombre en ciertas situaciones. Por ejemplo, un repositorio Git que no es de confianza puede tener un subm\u00f3dulo con metacaracteres de shell en un nombre de usuario o nombre de host."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "LOW",
                    "integrityImpact": "LOW",
                    "availabilityImpact": "NONE",
                    "baseScore": 6.5,
                    "baseSeverity": "MEDIUM"
                },
                "exploitabilityScore": 3.9,
                "impactScore": 2.5
            }
        ]
    },
    "weaknesses": [
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-78"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:openbsd:openssh:*:*:*:*:*:*:*:*",
                            "versionEndExcluding": "9.6",
                            "matchCriteriaId": "5308FBBB-F738-41C5-97A4-E40118E957CD"
                        }
                    ]
                }
            ]
        },
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*",
                            "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*",
                            "matchCriteriaId": "FA6FEEC2-9F11-4643-8827-749718254FED"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:debian:debian_linux:12.0:*:*:*:*:*:*:*",
                            "matchCriteriaId": "46D69DCC-AE4D-4EA5-861C-D60951444C6C"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "http://seclists.org/fulldisclosure/2024/Mar/21",
            "source": "cve@mitre.org"
        },
        {
            "url": "http://www.openwall.com/lists/oss-security/2023/12/26/4",
            "source": "cve@mitre.org",
            "tags": [
                "Mailing List",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/openssh/openssh-portable/commit/7ef3787c84b6b524501211b11a26c742f829af1a",
            "source": "cve@mitre.org",
            "tags": [
                "Patch"
            ]
        },
        {
            "url": "https://lists.debian.org/debian-lts-announce/2023/12/msg00017.html",
            "source": "cve@mitre.org",
            "tags": [
                "Mailing List",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://security.gentoo.org/glsa/202312-17",
            "source": "cve@mitre.org",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://security.netapp.com/advisory/ntap-20240105-0005/",
            "source": "cve@mitre.org"
        },
        {
            "url": "https://support.apple.com/kb/HT214084",
            "source": "cve@mitre.org"
        },
        {
            "url": "https://vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html",
            "source": "cve@mitre.org",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://www.debian.org/security/2023/dsa-5586",
            "source": "cve@mitre.org",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://www.openssh.com/txt/release-9.6",
            "source": "cve@mitre.org",
            "tags": [
                "Release Notes"
            ]
        },
        {
            "url": "https://www.openwall.com/lists/oss-security/2023/12/18/2",
            "source": "cve@mitre.org",
            "tags": [
                "Mailing List",
                "Release Notes"
            ]
        }
    ],
    "techniques": [
        {
            "techniqueID": "T1059.007",
            "comment": "CVE-2023-51385 - OS command injection vulnerability in OpenSSH allows an attacker to inject operating system commands. This can be achieved through the use of shell metacharacters in a user name or host name, which can be referenced by an expansion token in certain situations. This technique is relevant and can be utilized by attackers to compromise the system."
        },
        {
            "techniqueID": "T1190",
            "comment": "CVE-2023-51385 - The vulnerability can be exploited by an attacker to conduct further reconnaissance and potentially exfiltrate sensitive data, which is a critical aspect of the attacker's Kill Chain. This technique is relevant and can be utilized by attackers to continue their attack campaign."
        },
        {
            "techniqueID": "T1027",
            "comment": "CVE-2023-51385 - The vulnerability is identified as a CWE-78 (Command Injection) vulnerability, which can be exploited by an attacker to inject operating system commands, thus compromising the system. This technique is relevant and can be utilized by attackers to exploit this vulnerability."
        },
        {
            "techniqueID": "T1452",
            "comment": "CVE-2023-51385 - The vulnerability in OpenSSH can be exploited by an attacker to establish persistent access to the system, which can be used to conduct further malicious activities. This technique is relevant and can be utilized by attackers to achieve persistent access."
        },
        {
            "techniqueID": "T1518.001",
            "comment": "CVE-2023-51385 - The vulnerability can be exploited by an attacker to conduct a command injection attack, which can result in the execution of arbitrary commands on the system. This technique is relevant and can be utilized by attackers to conduct a command injection attack."
        }
    ],
    "technical_analysis": {
        "Introduction": "The OpenSSH vulnerability, CVE-2023-51385, is a command injection vulnerability that can be exploited by an attacker to inject operating system commands. This vulnerability can be triggered by using shell metacharacters in a user name or host name, which can be referenced by an expansion token in certain situations.",
        "Impact and Scope": "The vulnerability is identified as CWE-78 (Command Injection) and has a CVSS score of 6.5. The attack vector is remote and the vulnerability can be exploited through the use of shell metacharacters in a user name or host name.",
        "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are relevant to this vulnerability: T1059.007, T1190, T1027, T1452, T1518.001",
        "Technical Details": "The vulnerability is identified in the expansion token feature of OpenSSH, which allows users to reference expansion tokens in certain situations. An attacker can use this feature to inject operating system commands by using shell metacharacters in a user name or host name.",
        "Detection": "The vulnerability can be detected by monitoring for unusual command execution activity, such as the execution of arbitrary commands or the use of shell metacharacters in user names or host names.",
        "Mitigation": "The vulnerability can be mitigated by disabling the expansion token feature in OpenSSH or by restricting the use of shell metacharacters in user names or host names.",
        "Conclusion": "The OpenSSH vulnerability, CVE-2023-51385, is a high-risk vulnerability that can be exploited by attackers to inject operating system commands. It is essential to apply the necessary mitigations and monitor for unusual command execution activity to prevent this vulnerability from being exploited."
    },
    "executive_analysis": {
        "Overview": "The OpenSSH vulnerability, CVE-2023-51385, is a critical security vulnerability that has significant business and technical implications.",
        "Business Impact": "The vulnerability can be exploited by attackers to compromise sensitive data and disrupt business operations.",
        "Technical Impact": "The vulnerability can be exploited by attackers to inject operating system commands and compromise system security.",
        "Mitigation Strategies": "It is essential to apply the necessary mitigations to prevent this vulnerability from being exploited, including disabling the expansion token feature in OpenSSH or restricting the use of shell metacharacters in user names or host names.",
        "Recommendations": "Executives should take immediate action to apply mitigations and monitor for unusual command execution activity to prevent this vulnerability from being exploited.",
        "Conclusions": "The OpenSSH vulnerability, CVE-2023-51385, is a high-risk vulnerability that requires immediate attention and mitigation to prevent exploitation."
    }
}