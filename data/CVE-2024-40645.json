{"id": "CVE-2024-40645", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-31T19:15:11.870", "lastModified": "2024-09-05T17:09:16.947", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "FOG is a cloning/imaging/rescue suite/inventory management system. An improperly restricted file upload feature allows authenticated users to execute arbitrary code on the fogproject server. The Rebranding feature has a check on the client banner image requiring it to be 650 pixels wide and 120 pixels high. Apart from that, there are no checks on things like file extensions. This can be abused by appending a PHP webshell to the end of the image and changing the extension to anything the PHP web server will parse. This vulnerability is fixed in 1.5.10.41."}, {"lang": "es", "value": "FOG es un sistema de gesti\u00f3n de inventario, clonaci\u00f3n, im\u00e1genes, suite de rescate. Una funci\u00f3n de carga de archivos restringida incorrectamente permite a los usuarios autenticados ejecutar c\u00f3digo arbitrario en el servidor de fogproject. La funci\u00f3n de cambio de marca tiene una verificaci\u00f3n en la imagen del banner del cliente que requiere que tenga 650 p\u00edxeles de ancho y 120 p\u00edxeles de alto. Aparte de eso, no hay controles sobre cosas como las extensiones de archivos. Se puede abusar de esto agregando un webshell PHP al final de la imagen y cambiando la extensi\u00f3n a cualquier cosa que el servidor web PHP analice. Esta vulnerabilidad se solucion\u00f3 en 1.5.10.41."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-434"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-434"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:fogproject:fogproject:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.5.10", "versionEndIncluding": "1.5.10.41", "matchCriteriaId": "DDC1FAD4-EE15-41FF-BDF0-685E7885E4F6"}]}]}], "references": [{"url": "https://github.com/FOGProject/fogproject/blob/a4bb1bf39ac53c3cbe623576915fbc3b5c80a00f/packages/web/lib/pages/fogconfigurationpage.class.php#L2860-L2896", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://github.com/FOGProject/fogproject/commit/9469606a18bf8887740cceed6593a2e0380b5e0c", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/FOGProject/fogproject/security/advisories/GHSA-59mq-q8g5-2f4f", "source": "security-advisories@github.com", "tags": ["Exploit"]}], "techniques": [{"techniqueID": "T1078", "comment": "CVE-2024-40645 - Unrestricted File Upload, allowing authenticated users to execute arbitrary code. A classic example of a file upload vulnerability that can be abused to inject malicious PHP code."}, {"techniqueID": "T1190", "comment": "CVE-2024-40645 - Web Shell Execution, allowing attackers to execute arbitrary code on the FOGproject server. This technique is often employed in post-exploitation activities to maintain persistence and escalate privileges."}, {"techniqueID": "T1618", "comment": "CVE-2024-40645 - File and Directory Discovery, as attackers can use this vulnerability to upload and execute arbitrary files, leading to potential lateral movement and discovery of new attack surfaces."}, {"techniqueID": "T1210", "comment": "CVE-2024-40645 - Command and Control, as attackers can use this vulnerability to execute arbitrary commands and establish command and control channels for further exploitation and data exfiltration."}, {"techniqueID": "T1075", "comment": "CVE-2024-40645 - Data Staged, as attackers can use this vulnerability to stage data for exfiltration or further exploitation, increasing the potential impact of the attack."}, {"techniqueID": "T1592", "comment": "CVE-2024-40645 - Defense Evasion, as attackers can use this vulnerability to evade detection by hiding malicious files or code within seemingly innocuous files, making it harder to detect and respond to the attack."}, {"techniqueID": "T1204", "comment": "CVE-2024-40645 - File and Directory Discovery, as attackers can use this vulnerability to discover new attack surfaces and traverse the file system to move laterally and execute commands."}, {"techniqueID": "T1083", "comment": "CVE-2024-40645 - File and Directory Discovery, as attackers can use this vulnerability to discover and steal sensitive files or data, leading to potential data breaches and impact."}, {"techniqueID": "T1490", "comment": "CVE-2024-40645 - Abuse Elevation of Privilege, as attackers can use this vulnerability to execute arbitrary code and potentially escalate privileges, increasing the potential impact of the attack."}], "stix_bundle": "...", "technical_analysis": {"Introduction": "Introduction content.", "Impact and Scope": "Details on the impact and scope of the CVE, mentioning cvss score with version and attack vector.", "Related MITRE ATT&CK Techniques": "List of related MITRE ATT&CK Techniques and their relevance to the CVE.", "Technical Details": "In-depth technical details of the CVE.", "Detection": "Methods for detecting the CVE.", "Mitigation": "Mitigation strategies for the CVE.", "Conclusion": "Summary and conclusions."}, "executive_analysis": {"Overview": "Overview of the CVE.", "Business Impact": "Explanation of the business impact of the CVE.", "Technical Impact": "Explanation of the technical impact of the CVE.", "Mitigation Strategies": "High-level mitigation strategies.", "Recommendations": "Recommendations for executives.", "Conclusions": "Final conclusions and next steps."}}