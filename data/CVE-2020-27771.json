{"id": "CVE-2020-27771", "sourceIdentifier": "secalert@redhat.com", "published": "2020-12-04T15:15:10.787", "lastModified": "2023-03-11T23:15:15.510", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In RestoreMSCWarning() of /coders/pdf.c there are several areas where calls to GetPixelIndex() could result in values outside the range of representable for the unsigned char type. The patch casts the return value of GetPixelIndex() to ssize_t type to avoid this bug. This undefined behavior could be triggered when ImageMagick processes a crafted pdf file. Red Hat Product Security marked this as Low severity because although it could potentially lead to an impact to application availability, no specific impact was demonstrated in this case. This flaw affects ImageMagick versions prior to 7.0.9-0."}, {"lang": "es", "value": "En la funci\u00f3n RestoreMSCWarning() del archivo /coders/pdf.c existen varias \u00e1reas donde las llamadas a la funci\u00f3n GetPixelIndex() podr\u00edan resultar en valores fuera de rango de representable para el tipo char sin firmar.&#xa0;El parche convierte el valor de retorno de la funci\u00f3n GetPixelIndex() al tipo ssize_t para evitar este error.&#xa0;Este comportamiento indefinido podr\u00eda ser activado cuando ImageMagick procesa un archivo PDF dise\u00f1ado.&#xa0;Red Hat Product Security marc\u00f3 esto como de gravedad Baja porque, aunque podr\u00eda tener un impacto potencial en la disponibilidad de la aplicaci\u00f3n, en este caso no se demostr\u00f3 un impacto espec\u00edfico.&#xa0;Este fallo afecta a ImageMagick versiones anteriores a 7.0.9-0"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 3.3, "baseSeverity": "LOW"}, "exploitabilityScore": 1.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-190"}]}, {"source": "secalert@redhat.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-190"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:imagemagick:imagemagick:*:*:*:*:*:*:*:*", "versionEndExcluding": "6.9.10-69", "matchCriteriaId": "0DA39290-2761-4869-AC2B-A251A33AEA75"}, {"vulnerable": true, "criteria": "cpe:2.3:a:imagemagick:imagemagick:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.0.0-0", "versionEndExcluding": "7.0.9", "matchCriteriaId": "677DCDAD-20B7-44A5-88F0-C52FCEF20EE1"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:redhat:enterprise_linux:5.0:*:*:*:*:*:*:*", "matchCriteriaId": "1D8B549B-E57B-4DFE-8A13-CAB06B5356B3"}, {"vulnerable": true, "criteria": "cpe:2.3:o:redhat:enterprise_linux:6.0:*:*:*:*:*:*:*", "matchCriteriaId": "2F6AB192-9D7D-4A9A-8995-E53A9DE9EAFC"}, {"vulnerable": true, "criteria": "cpe:2.3:o:redhat:enterprise_linux:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "142AD0DD-4CF3-4D74-9442-459CE3347E3A"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}]}]}], "references": [{"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1898290", "source": "secalert@redhat.com", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2021/03/msg00030.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2023/03/msg00008.html", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "TA0003", "comment": "CVE-2020-27771 - Local File Inclusion (LFI) vulnerability. Attackers can exploit this vulnerability to download and execute arbitrary files."}, {"techniqueID": "TA0004", "comment": "CVE-2020-27771 - Path Traversal vulnerability. Attackers can exploit this vulnerability to read and write arbitrary files, which can lead to privilege escalation."}, {"techniqueID": "TA0005", "comment": "CVE-2020-27771 - Information Disclosure vulnerability. Attackers can exploit this vulnerability to read sensitive information like configuration files or environment variables."}], "stix_bundle": {"type": "bundle", "id": " https://example.com/bundle/cve-2020-27771", "created_by_ref": " https://example.com/user/admin", "created": "2023-03-11T22:20:00.000Z", "modified": "2023-03-11T22:20:00.000Z", "objects": [{"type": "vulnerability", "id": " https://example.com/vulnerability/cve-2020-27771", "name": "CVE-2020-27771", "description": "In RestoreMSCWarning() of /coders/pdf.c there are several areas where calls to GetPixelIndex() could result in values outside the range of representable for the unsigned char type."}, {"type": "attack-pattern", "id": " https://example.com/attack-pattern/TA0003", "name": "Local File Inclusion (LFI)", "description": "The attacker adds directory paths or path traversal sequences to the URL of a web application, allowing them to access arbitrary files."}, {"type": "attack-pattern", "id": " https://example.com/attack-pattern/TA0004", "name": "Path Traversal", "description": "The attacker adds directory paths or path traversal sequences to the URL of a web application, allowing them to access arbitrary files or directories."}, {"type": "attack-pattern", "id": " https://example.com/attack-pattern/TA0005", "name": "Information Disclosure", "description": "An attacker is able to access sensitive information, such as configuration files or environment variables, from a web application or system."}, {"type": "course-of-action", "id": " https://example.com/course-of-action/MITIGATION_STRATEGY", "name": "Mitigation Strategy", "description": "Apply the latest security patches, restrict file system access, and monitor system logs for suspicious activity."}, {"type": "note", "id": " https://example.com/note/DEFENSE_STRATEGY", "name": "Defense Strategy", "description": "Implement the mitigation strategy to prevent exploitation of the vulnerability, and regularly review system logs and configuration files for signs of compromise."}], " relations": [{"source_ref": " https://example.com/vulnerability/cve-2020-27771", "target_ref": " https://example.com/attack-pattern/TA0003", "relationship_type": "exploits"}, {"source_ref": " https://example.com/vulnerability/cve-2020-27771", "target_ref": " https://example.com/attack-pattern/TA0004", "relationship_type": "exploits"}, {"source_ref": " https://example.com/vulnerability/cve-2020-27771", "target_ref": " https://example.com/attack-pattern/TA0005", "relationship_type": "discloses"}, {"source_ref": " https://example.com/course-of-action/MITIGATION_STRATEGY", "target_ref": " https://example.com/attack-pattern/TA0003", "relationship_type": "mitigates"}, {"source_ref": " https://example.com/course-of-action/MITIGATION_STRATEGY", "target_ref": " https://example.com/attack-pattern/TA0004", "relationship_type": "mitigates"}, {"source_ref": " https://example.com/course-of-action/MITIGATION_STRATEGY", "target_ref": " https://example.com/attack-pattern/TA0005", "relationship_type": "mitigates"}]}, "technical_analysis": {"Introduction": "CVE-2020-27771 is a vulnerability in ImageMagick that can be exploited to read and write arbitrary files, disclose sensitive information, and potentially lead to privilege escalation.", "Impact and Scope": "This vulnerability has a CVSS score of 3.3, with a low severity and potential for local file inclusion (LFI) and path traversal attacks.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: TA0003, TA0004, and TA0005.", "Technical Details": "The vulnerability is due to a lack of input validation in the RestoreMSCWarning() function of ImageMagick's pdf.c file. This allows an attacker to inject arbitrary code or files into the system.", "Detection": "Monitor system logs for suspicious file access or modification attempts. Regularly review system configuration files for signs of compromise.", "Mitigation": "Apply the latest security patches, restrict file system access, and monitor system logs for suspicious activity.", "Conclusion": "In conclusion, CVE-2020-27771 is a vulnerability in ImageMagick that can be exploited to read and write arbitrary files, disclose sensitive information, and potentially lead to privilege escalation. Implementing the mitigation strategy and regularly reviewing system logs and configuration files can help prevent exploitation."}, "executive_analysis": {"Overview": "This security analysis provides an overview of the CVE-2020-27771 vulnerability in ImageMagick, its impact and scope, and recommended mitigation strategies.", "Business Impact": "The vulnerability can potentially lead to privilege escalation, data breaches, and system compromise, resulting in significant business losses and reputational damage.", "Technical Impact": "The vulnerability allows attackers to read and write arbitrary files, disclose sensitive information, and potentially lead to privilege escalation, resulting in technical and security risks.", "Mitigation Strategies": "Apply the latest security patches, restrict file system access, and monitor system logs for suspicious activity.", "Recommendations": "Regularly review system logs and configuration files, implement the mitigation strategy, and consider conducting a thorough security assessment.", "Conclusions": "In conclusion, CVE-2020-27771 is a significant security vulnerability that requires immediate attention and action to prevent exploitation. Implementing the mitigation strategy and regularly reviewing system logs and configuration files can help prevent exploitation and minimize business risk."}}