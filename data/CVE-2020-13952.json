{"id": "CVE-2020-13952", "sourceIdentifier": "security@apache.org", "published": "2020-09-30T21:15:12.807", "lastModified": "2020-10-16T16:08:36.030", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the course of work on the open source project it was discovered that authenticated users running queries against Hive and Presto database engines could access information via a number of templated fields including the contents of query description metadata database, the hashed version of the authenticated users\u2019 password, and access to connection information including the plaintext password for the current connection. It would also be possible to run arbitrary methods on the database connection object for the Presto or Hive connection, allowing the user to bypass security controls internal to Superset. This vulnerability is present in every Apache Superset version < 0.37.2."}, {"lang": "es", "value": "En el curso del trabajo en el proyecto de c\u00f3digo abierto, se detect\u00f3 que los usuarios autenticados que ejecutaban consultas en los motores de base de datos de Hive y Presto pod\u00edan acceder a la informaci\u00f3n por medio de una serie de campos con plantilla, incluyendo el contenido de la base de datos de metadatos de descripci\u00f3n de consultas, la versi\u00f3n hash de las contrase\u00f1a de usuarios autenticados y acceso a informaci\u00f3n de conexi\u00f3n, incluyendo la contrase\u00f1a de texto plano para la conexi\u00f3n actual.&#xa0;Tambi\u00e9n ser\u00eda posible ejecutar m\u00e9todos arbitrarios en el objeto de conexi\u00f3n de la base de datos para la conexi\u00f3n de Presto o Hive, permitiendo al usuario omitir los controles de seguridad internos para Superset.&#xa0;Esta vulnerabilidad est\u00e1 presente en todas las versiones de Apache Superset versiones anteriores a 0.37.2"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:superset:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.37.2", "matchCriteriaId": "1751398E-8080-45B5-8C3A-6C403738CE59"}]}]}], "references": [{"url": "https://lists.apache.org/thread.html/rf1faa368f580d2cb691576bee1277855f769667f3114d5df1dacbea6%40%3Cdev.superset.apache.org%3E", "source": "security@apache.org", "tags": ["Mailing List", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1078: Exploit Public-Facing Application", "comment": "CVE-2020-13952 - Apache Superset SQL Injection vulnerability that allows authenticated users to access sensitive information and execute arbitrary methods on the database connection object. This technique can be used to exploit this vulnerability and execute malicious code.\n"}, {"techniqueID": "T1190: Exploit-As-You-Go", "comment": "CVE-2020-13952 - Apache Superset SQL Injection vulnerability that allows attackers to exploit the vulnerability in real-time, gathering information and executing commands without the need for a pre-existing exploit.\n"}, {"techniqueID": "T1194: Create or Modify System Process", "comment": "CVE-2020-13952 - Apache Superset SQL Injection vulnerability that allows authenticated users to execute arbitrary methods on the database connection object, potentially creating or modifying system processes.\n"}], "stix_bundle": "...", "technical_analysis": {"Introduction": "Apache Superset is an open-source data visualization platform that provides a flexible and scalable solution for data exploration and visualization. However, a vulnerability was discovered in Apache Superset versions prior to 0.37.2 that allows authenticated users to access sensitive information and execute arbitrary methods on the database connection object.\n", "Impact and Scope": "The vulnerability has a CVSS score of 8.1 (High) and an attack vector of NETWORK. It allows authentication users to access confidential information, compromise the integrity of the database, and potentially execute arbitrary code with high privileges.\n", "Related MITRE ATT&CK Techniques": "T1078, T1190, T1194", "Technical Details": "The vulnerability is due to a flawed security implementation in Apache Superset that allows authenticated users to access sensitive information and execute arbitrary methods on the database connection object. The vulnerable code is part of the query processing logic in the Hive and Presto database engines.\n", "Detection": "To detect this vulnerability, security monitoring systems should be configured to monitor for unauthorized database queries and detection of suspicious activity in the system logs.\n", "Mitigation": "To mitigate this vulnerability, Apache Superset should be updated to version 0.37.2 or later. Additionally, security monitoring systems should be configured to monitor for unauthorized database queries and detection of suspicious activity in the system logs.\n", "Conclusion": "The Apache Superset SQL Injection vulnerability poses a significant risk to organizations that rely on this data visualization platform. It is essential to quickly patch this vulnerability and implement monitoring and detection mechanisms to prevent future attacks.\n"}, "executive_analysis": {"Overview": "Apache Superset is an open-source data visualization platform that provides a flexible and scalable solution for data exploration and visualization.\n", "Business Impact": "This vulnerability poses a significant risk to the security and integrity of sensitive information stored in Apache Superset.\n", "Technical Impact": "The vulnerability allows authenticated users to access confidential information, compromise the integrity of the database, and potentially execute arbitrary code with high privileges.\n", "Mitigation Strategies": "Patch Apache Superset to version 0.37.2 or later, implement monitoring and detection mechanisms to detect suspicious activity, and restrict access to sensitive information.\n", "Recommendations": "Executives should prioritize patching this vulnerability, implement monitoring and detection mechanisms, and restrict access to sensitive information.\n", "Conclusions": "The Apache Superset SQL Injection vulnerability is a critical security risk that requires immediate attention. Executives should take swift action to mitigate this vulnerability and protect their organization's sensitive information.\n"}}