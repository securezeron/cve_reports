{"id": "CVE-2024-39685", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-22T16:15:03.417", "lastModified": "2024-07-24T12:55:13.223", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Bert-VITS2 is the VITS2 Backbone with multilingual bert. User input supplied to the data_dir variable is used directly in a command executed with subprocess.run(cmd, shell=True) in the resample function, which leads to arbitrary command execution. This affects fishaudio/Bert-VITS2 2.3 and earlier."}, {"lang": "es", "value": "Bert-VITS2 es la columna vertebral de VITS2 con bert multiling\u00fce. La entrada del usuario proporcionada a la variable data_dir se usa directamente en un comando ejecutado con subprocess.run(cmd, shell=True) en la funci\u00f3n resample, lo que conduce a la ejecuci\u00f3n de un comando arbitrario. Esto afecta a fishaudio/Bert-VITS2 2.3 y versiones anteriores."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-78"}]}], "references": [{"url": "https://github.com/fishaudio/Bert-VITS2/blob/3f8c537f4aeb281df3fb3c455eed9a1b64871a81/webui_preprocess.py#L46-L52", "source": "security-advisories@github.com"}, {"url": "https://github.com/fishaudio/Bert-VITS2/blob/76653b5b6d657143721df2ed6c5c246b4b1d9277/webui_preprocess.py#L130-L133", "source": "security-advisories@github.com"}, {"url": "https://securitylab.github.com/advisories/GHSL-2024-045_GHSL-2024-047_fishaudio_Bert-VITS2/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1059.001", "comment": "CVE-2024-39685 - Unquoted Service Path - Abusing the unquoted service path vulnerability in the webui_preprocess.py file to execute arbitrary commands."}, {"techniqueID": "T1059.002", "comment": "CVE-2024-39685 - Unquoted Service Path - Failing to sanitize user input in the data_dir variable, leading to command injection."}, {"techniqueID": "T1210", "comment": "CVE-2024-39685 - Exploit code execution - Using user input to execute arbitrary commands in the resample function."}, {"techniqueID": "T1190", "comment": "CVE-2024-39685 - Exploit code execution - Subprocess execution using subprocess.run(cmd, shell=True) to execute arbitrary commands."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle--CVE-2024-39685", "spec_version": "2.1"}, "objects": [{"type": "vulnerability", "id": "vulnerability--CVE-2024-39685", "name": "Unquoted Service Path in Bert-VITS2", "description": "A vulnerability in Bert-VITS2 allows an attacker to execute arbitrary commands by using user input to call subprocesses.", "published": "2024-07-22T16:15:03.417", "Modified": "2024-07-24T12:55:13.223", "references": [{"url": "https://github.com/fishaudio/Bert-VITS2/blob/3f8c537f4aeb281df3fb3c455eed9a1b64871a81/webui_preprocess.py#L46-L52", "source": "security-advisories@github.com"}, {"url": "https://github.com/fishaudio/Bert-VITS2/blob/76653b5b6d657143721df2ed6c5c246b4b1d9277/webui_preprocess.py#L130-L133", "source": "security-advisories@github.com"}, {"url": "https://securitylab.github.com/advisories/GHSL-2024-045_GHSL-2024-047_fishaudio_Bert-VITS2/", "source": "security-advisories@github.com"}], "roles": [{"type": "relationship", "id": "relationship--CVE-2024-39685", "role": "related_to", "source": "vulnerability--CVE-2024-39685", "target": "technique--T1059.001"}]}, {"type": "technique", "id": "technique--T1059.001", "name": "Unquoted Service Path", "description": "A technique for executing arbitrary commands on a system through unquoted service paths.", "version": "1"}]}, "technical_analysis": {"Introduction": "Bert-VITS2 is a vulnerable Python package that allows executing arbitrary commands through an unquoted service path.", "Impact and Scope": "The vulnerability has a high CVSS score of 9.8, indicating a high severity and potential impact. The attack vector is network-based.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques such as T1059.001, T1059.002, T1210, and T1190.", "Technical Details": "The vulnerability occurs in the webui_preprocess.py file, where user input is used directly in a command executed with subprocess.run(cmd, shell=True).", "Detection": "Detection involves monitoring the execution of subprocesses and checking for suspicious commands.", "Mitigation": "Mitigation involves sanitizing user input and using quoted service paths.", "Conclusion": "The vulnerability can be exploited to execute arbitrary commands, and proper mitigation strategies are necessary to prevent it."}, "executive_analysis": {"Overview": "The vulnerability in Bert-VITS2 allows attackers to execute arbitrary commands, posing a high risk to the system and data.", "Business Impact": "The vulnerability can lead to data breaches, system compromise, and business disruption.", "Technical Impact": "The vulnerability allows attackers to bypass security controls and execute malicious code.", "Mitigation Strategies": "Implementing input sanitization and quoted service paths, as well as monitoring subprocess execution, can mitigate the vulnerability.", "Recommendations": "Recommendations include updating the vulnerable package, implementing input validation, and monitoring system logs.", "Conclusions": "Proper mitigation strategies are necessary to prevent the exploitation of this vulnerability."}}