{"id": "CVE-2023-5345", "sourceIdentifier": "cve-coordination@google.com", "published": "2023-10-03T03:15:09.750", "lastModified": "2024-08-27T15:26:15.777", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A use-after-free vulnerability in the Linux kernel's fs/smb/client component can be exploited to achieve local privilege escalation.\n\nIn case of an error in smb3_fs_context_parse_param, ctx->password was freed but the field was not set to NULL which could lead to double free.\n\nWe recommend upgrading past commit e6e43b8aa7cd3c3af686caf0c2e11819a886d705.\n\n"}, {"lang": "es", "value": "Se puede explotar una vulnerabilidad de use-after-free en el componente fs/smb/client del kernel de Linux para lograr una escalada de privilegios local. En caso de un error en smb3_fs_context_parse_param, se liber\u00f3 ctx-&gt;password pero el campo no se configur\u00f3 en NULL, lo que podr\u00eda provocar una doble liberaci\u00f3n. Recomendamos actualizar al commit anterior e6e43b8aa7cd3c3af686caf0c2e11819a886d705."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}, {"source": "cve-coordination@google.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-416"}]}, {"source": "cve-coordination@google.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-416"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.0.16", "versionEndExcluding": "6.1.56", "matchCriteriaId": "1D9FAA11-D32A-471A-A6A4-218A6F40B983"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2", "versionEndExcluding": "6.5.6", "matchCriteriaId": "870FC772-173A-4A0F-B1AF-7976AD6057D3"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.6:rc1:*:*:*:*:*:*", "matchCriteriaId": "84267A4F-DBC2-444F-B41D-69E15E1BEC97"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.6:rc2:*:*:*:*:*:*", "matchCriteriaId": "FB440208-241C-4246-9A83-C1715C0DAA6C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.6:rc3:*:*:*:*:*:*", "matchCriteriaId": "0DC421F1-3D5A-4BEF-BF76-4E468985D20B"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:37:*:*:*:*:*:*:*", "matchCriteriaId": "E30D0E6F-4AE8-4284-8716-991DFA48CC5D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:38:*:*:*:*:*:*:*", "matchCriteriaId": "CC559B26-5DFC-4B7A-A27C-B77DE755DFF9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:39:*:*:*:*:*:*:*", "matchCriteriaId": "B8EDB836-4E6A-4B71-B9B2-AA3E03E0F646"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/177029/Kernel-Live-Patch-Security-Notice-LSN-0100-1.html", "source": "cve-coordination@google.com", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=e6e43b8aa7cd3c3af686caf0c2e11819a886d705", "source": "cve-coordination@google.com", "tags": ["Mailing List", "Patch"]}, {"url": "https://kernel.dance/e6e43b8aa7cd3c3af686caf0c2e11819a886d705", "source": "cve-coordination@google.com", "tags": ["Mailing List", "Patch"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GISYSL3F6WIEVGHJGLC2MFNTUXHPTKQH/", "source": "cve-coordination@google.com", "tags": ["Mailing List"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/GPMICQ2HVZO5UAM5KPXHAZKA2U3ZDOO6/", "source": "cve-coordination@google.com", "tags": ["Mailing List"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/V5PDNWPKAP3WL5RQZ4RIDS6MG32OHH5R/", "source": "cve-coordination@google.com", "tags": ["Mailing List"]}], "techniques": [{"techniqueID": "T1134", "comment": " CVE-2023-5345 - A use-after-free vulnerability in the Linux kernel's fs/smb/client component can be exploited to achieve local privilege escalation. This technique can be used to trigger the vulnerability and gain unauthorized access to the system."}, {"techniqueID": "T1190", "comment": " CVE-2023-5345 - The vulnerability can be exploited using the SMB protocol. This technique can be used to craft a malicious SMB request to trigger the vulnerability."}, {"techniqueID": "T1204", "comment": " CVE-2023-5345 - The vulnerability can be detected by monitoring the system's memory for signs of the vulnerability. This technique can be used to identify potential exploitation attempts."}], "stix_bundle": {"stix2Bundle": {"bundleDesc": "MITRE ATT&CK and D3FEND analysis for CVE-2023-5345", "packages": [{"name": "vulnerability", "id": "vulnerability-cve-2023-5345", "type": "vulnerability", "description": "A use-after-free vulnerability in the Linux kernel's fs/smb/client component can be exploited to achieve local privilege escalation.", "severity": "high", "cvssV3": {"baseSeverity": "high", "baseScore": 7.8}, "references": [{"href": "http://packetstormsecurity.com/files/177029/Kernel-Live-Patch-Security-Notice-LSN-0100-1.html", "type": "url"}]}], "relationship": [{"id": "exploit", "type": "has-exploit", "from": {"id": "vulnerability-cve-2023-5345", "type": "vulnerability"}, "to": {"id": "T1190", "type": "attack-pattern"}}, {"id": "detection", "type": "x-detected-ttl", "from": {"id": "vulnerability-cve-2023-5345", "type": "vulnerability"}, "to": {"id": "T1204", "type": "attack-pattern"}}]}}, "technical_analysis": {"Introduction": "CVE-2023-5345 is a use-after-free vulnerability in the Linux kernel's fs/smb/client component that allows for local privilege escalation.", "Impact and Scope": "The vulnerability allows an attacker to trigger a use-after-free condition, resulting in a potential local privilege escalation. The CVSSv3 score for this vulnerability is 7.8, with a high base severity.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to multiple MITRE ATT&CK techniques, including T1134, T1190, and T1204.", "Technical Details": "The vulnerability occurs in the Linux kernel's fs/smb/client component due to a use-after-free condition. This can be exploited by crafting a malicious SMB request.", "Detection": "The vulnerability can be detected by monitoring the system's memory for signs of the vulnerability.", "Mitigation": "The vulnerability can be mitigated by upgrading past commit e6e43b8aa7cd3c3af686caf0c2e11819a886d705.", "Conclusion": "CVE-2023-5345 is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2023-5345 is a critical vulnerability in the Linux kernel's fs/smb/client component that can lead to local privilege escalation.", "Business Impact": "The vulnerability can result in unauthorized access to sensitive data and systems, potentially leading to significant financial losses and reputational damage.", "Technical Impact": "The vulnerability can be exploited by crafting a malicious SMB request, making it a high-priority threat.", "Mitigation Strategies": "Upgrade past commit e6e43b8aa7cd3c3af686caf0c2e11819a886d705 to mitigate the vulnerability.", "Recommendations": "All organizations should prioritize upgrading their systems to the latest version to minimize the risk of exploitation.", "Conclusions": "CVE-2023-5345 is a critical vulnerability that requires immediate attention and mitigation to protect against potential exploitation."}}