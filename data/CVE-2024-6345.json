{"id": "CVE-2024-6345", "sourceIdentifier": "security@huntr.dev", "published": "2024-07-15T01:15:01.730", "lastModified": "2024-07-15T13:00:34.853", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability in the package_index module of pypa/setuptools versions up to 69.1.1 allows for remote code execution via its download functions. These functions, which are used to download packages from URLs provided by users or retrieved from package index servers, are susceptible to code injection. If these functions are exposed to user-controlled inputs, such as package URLs, they can execute arbitrary commands on the system. The issue is fixed in version 70.0."}, {"lang": "es", "value": "Una vulnerabilidad en el m\u00f3dulo package_index de las versiones de pypa/setuptools hasta 69.1.1 permite la ejecuci\u00f3n remota de c\u00f3digo a trav\u00e9s de sus funciones de descarga. Estas funciones, que se utilizan para descargar paquetes desde URL proporcionadas por los usuarios o recuperadas de servidores de \u00edndice de paquetes, son susceptibles a la inyecci\u00f3n de c\u00f3digo. Si estas funciones est\u00e1n expuestas a entradas controladas por el usuario, como las URL de paquetes, pueden ejecutar comandos arbitrarios en el sistema. El problema se solucion\u00f3 en la versi\u00f3n 70.0."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://github.com/pypa/setuptools/commit/88807c7062788254f654ea8c03427adc859321f0", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/d6362117-ad57-4e83-951f-b8141c6e7ca5", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-6345 - Why this is relevant and how to defend against it: The technique used is command injection, which is a classic attack vector. This can be prevented by validating user input and using strong output encoding."}, {"techniqueID": "T1055", "comment": "CVE-2024-6345 - Why this is relevant and how to defend against it: The technique used is remote code execution, which is a high-severity attack. This can be prevented by validating user input and using strong input validation."}, {"techniqueID": "T1137", "comment": "CVE-2024-6345 - Why this is relevant and how to defend against it: The technique used is command injection, which is a common attack vector. This can be prevented by validating user input and using strong output encoding."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle--CVE-2024-6345", "created_by_ref": "identity--my-identity", "handlers": [{"type": "handling", "revoked": false, "spec_version": "2.1"}], "objects": [{"type": "vulnerability", "id": "vulnerability--CVE-2024-6345", "created_by_ref": "identity--my-identity", "description": "A vulnerability in the package_index module of pypa/setuptools versions up to 69.1.1 allows for remote code execution via its download functions.", "name": "CVE-2024-6345", "cvss_v3": {"vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "base_severity": "High", "base_score": 8.8, "exploit_score": 2.8, "impact_score": 5.9}, "related_packages": [{"type": "package", "id": "package--setuptools", "name": "setuptools"}], "related_versions": [{"type": "software_version", "id": "software_version--setuptools-69.1.1", "software_id": "package--setuptools", "version": "69.1.1"}], "related_resources": [{"type": "resource", "id": "resource--https://github.com/pypa/setuptools/commit/88807c7062788254f654ea8c03427adc859321f0", "mime_type": "text/x-github-commit", "name": "GitHub commit"}]}, {"type": "course_of_action", "id": "course_of_action--CA-1", "created_by_ref": "identity--my-identity", "description": "Validate user input and use strong output encoding.", "related_techniques": [{"type": "attack_pattern", "id": "attack_pattern--T1210", "name": "Command Injection"}]}, {"type": "course_of_action", "id": "course_of_action--CA-2", "created_by_ref": "identity--my-identity", "description": "Validate user input and use strong input validation.", "related_techniques": [{"type": "attack_pattern", "id": "attack_pattern--T1055", "name": "Remote Code Execution"}]}], " relationships": [{"type": "relates", "id": "relates--CVE-2024-6345--CA-1", "from": "vulnerability--CVE-2024-6345", "to": "course_of_action--CA-1"}, {"type": "relates", "id": "relates--CVE-2024-6345--CA-2", "from": "vulnerability--CVE-2024-6345", "to": "course_of_action--CA-2"}]}, "technical_analysis": {"Introduction": "The CVE-2024-6345 is a vulnerability in the package_index module of pypa/setuptools versions up to 69.1.1 that allows for remote code execution via its download functions. This vulnerability can be exploited by injecting malicious code into the package's download functions.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 8.8. The scope of the vulnerability is limited to the package_index module of pypa/setuptools versions up to 69.1.1.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1210, T1055, and T1137.", "Technical Details": "The vulnerability is caused by a command injection vulnerability in the package_index module's download functions. This vulnerability allows an attacker to inject malicious code into the package's download functions, which can then be executed on the system.", "Detection": "Detection of this vulnerability can be done by analyzing the package_index module's download functions for signs of malicious code injection.", "Mitigation": "The mitigation strategy for this vulnerability is to validate user input and use strong output encoding.", "Conclusion": "In conclusion, the CVE-2024-6345 is a high-severity vulnerability that can be exploited by injecting malicious code into the package's download functions. The related MITRE ATT&CK techniques are T1210, T1055, and T1137. Detection of this vulnerability can be done by analyzing the package_index module's download functions for signs of malicious code injection. The mitigation strategy is to validate user input and use strong output encoding."}, "executive_analysis": {"Overview": "The CVE-2024-6345 is a high-severity vulnerability that affects the package_index module of pypa/setuptools versions up to 69.1.1.", "Business Impact": "The business impact of this vulnerability is high, as it can allow an attacker to inject malicious code into the package's download functions, which can then be executed on the system.", "Technical Impact": "The technical impact of this vulnerability is high, with a CVSS score of 8.8. The scope of the vulnerability is limited to the package_index module of pypa/setuptools versions up to 69.1.1.", "Mitigation Strategies": "The mitigation strategy for this vulnerability is to validate user input and use strong output encoding.", "Recommendations": "The executive team should recommend that all vulnerable systems be updated to the latest version of the package_index module.", "Conclusions": "In conclusion, the CVE-2024-6345 is a high-severity vulnerability that affects the package_index module of pypa/setuptools versions up to 69.1.1. The business and technical impacts are high. The mitigation strategy is to validate user input and use strong output encoding. We recommend that all vulnerable systems be updated to the latest version of the package_index module."}}