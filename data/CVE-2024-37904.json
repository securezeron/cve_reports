{"id": "CVE-2024-37904", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-18T17:15:52.337", "lastModified": "2024-06-20T12:44:01.637", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Minder is an open source Software Supply Chain Security Platform. Minder's Git provider is vulnerable to a denial of service from a maliciously configured GitHub repository. The Git provider clones users repositories using the `github.com/go-git/go-git/v5` library on lines `L55-L89`. The Git provider does the following on the lines `L56-L62`. First, it sets the `CloneOptions`, specifying the url, the depth etc. It then validates the options. It then sets up an in-memory filesystem, to which it clones and Finally, it clones the repository. The `(g *Git) Clone()` method is vulnerable to a DoS attack: A Minder user can instruct Minder to clone a large repository which will exhaust memory and crash the Minder server. The root cause of this vulnerability is a combination of the following conditions: 1. Users can control the Git URL which Minder clones, 2. Minder does not enforce a size limit to the repository, 3. Minder clones the entire repository into memory. This issue has been addressed in commit `7979b43` which has been included in release version v0.0.52. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Minder es una plataforma de seguridad de la cadena de suministro de software de c\u00f3digo abierto. El proveedor Git de Minder es vulnerable a una denegaci\u00f3n de servicio desde un repositorio GitHub configurado maliciosamente. El proveedor de Git clona los repositorios de los usuarios utilizando la librer\u00eda `github.com/go-git/go-git/v5` en las l\u00edneas `L55-L89`. El proveedor de Git hace lo siguiente en las l\u00edneas \"L56-L62\". Primero, establece `CloneOptions`, especificando la URL, la profundidad, etc. Luego valida las opciones. Luego configura un sistema de archivos en memoria, al cual clona y, finalmente, clona el repositorio. El m\u00e9todo `(g *Git) Clone()` es vulnerable a un ataque DoS: un usuario de Minder puede indicarle a Minder que clone un repositorio grande que agotar\u00e1 la memoria y bloquear\u00e1 el servidor de Minder. La causa principal de esta vulnerabilidad es una combinaci\u00f3n de las siguientes condiciones: 1. Los usuarios pueden controlar la URL de Git que Minder clona, 2. Minder no impone un l\u00edmite de tama\u00f1o al repositorio, 3. Minder clona todo el repositorio en la memoria. Este problema se solucion\u00f3 en el commit `7979b43` que se incluy\u00f3 en la versi\u00f3n v0.0.52. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-400"}]}], "references": [{"url": "https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L55-L89", "source": "security-advisories@github.com"}, {"url": "https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L56-L62", "source": "security-advisories@github.com"}, {"url": "https://github.com/stacklok/minder/commit/7979b43", "source": "security-advisories@github.com"}, {"url": "https://github.com/stacklok/minder/security/advisories/GHSA-hpcg-xjq5-g666", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0040", "comment": "The `github.com/go-git/go-git/v5` library is vulnerable to a denial of service as a result of large repository cloning. This is a relevant attack vector as it allows for exhausting of memory and server crash. To defend against this, it is recommended to implement rate limiting for repository clone operations."}, {"techniqueID": "TA0048", "comment": "Minder does not enforce a size limit for cloned repositories. This can be exploited by an attacker to clone large repositories, leading to denial of service. Implementing a size limit for repository clones is recommended to mitigate this risk."}, {"techniqueID": "TA0012", "comment": "The Minder Git provider does not validate the CloneOptions before cloning a repository. This can allow for arbitrary repository clones. Implementing input validation for CloneOptions can help prevent this attack."}, {"techniqueID": "TA0058", "comment": "The vulnerability in the Minder Git provider allows for a maliciously configured GitHub repository to be used for denial of service attacks. Implementing controls to detect and prevent malicious repository configurations is recommended."}], "stix_bundle": {"@context": "https://github.com/oasis-open/cti/stix2.1", "bundle": {"id": "bundle-1", "type": "bundle", "created_by_ref": "https://github.com/stacklok/minder", "created": "2024-06-18T17:15:52.337", "modified": "2024-06-20T12:44:01.637", "objects": [{"id": "minder-vulnerability", "type": "indicator", "description": "Minder is vulnerable to a denial of service from a maliciously configured GitHub repository.", "created": "2024-06-18T17:15:52.337", "modified": "2024-06-20T12:44:01.637", "name": "Minder Vulnerability"}, {"id": "git-provider-vulnerability", "type": "indicator", "description": "The Minder Git provider is vulnerable to a denial of service from a maliciously configured GitHub repository.", "created": "2024-06-18T17:15:52.337", "modified": "2024-06-20T12:44:01.637", "name": "Git Provider Vulnerability"}, {"id": "CVE-2024-37904", "type": "vulnerability", "description": "CVE-2024-37904: Minder is vulnerable to a denial of service from a maliciously configured GitHub repository.", "created": "2024-06-18T17:15:52.337", "modified": "2024-06-20T12:44:01.637", "name": "CVE-2024-37904"}, {"id": "mitigation-strategy", "type": "course-of-action", "name": "Mitigation Strategy", "description": "Implement rate limiting for repository clone operations, enforce a size limit for cloned repositories, and validate CloneOptions before cloning a repository.", "related_object_ref": "CVE-2024-37904"}, {"id": "defense-point-1", "type": "note", "content": "Implement rate limiting for repository clone operations.", "created": "2024-06-18T17:15:52.337", "modified": "2024-06-20T12:44:01.637", "related_object_ref": "mitigation-strategy"}, {"id": "defense-point-2", "type": "note", "content": "Enforce a size limit for cloned repositories.", "created": "2024-06-18T17:15:52.337", "modified": "2024-06-20T12:44:01.637", "related_object_ref": "mitigation-strategy"}, {"id": "defense-point-3", "type": "note", "content": "Validate CloneOptions before cloning a repository.", "created": "2024-06-18T17:15:52.337", "modified": "2024-06-20T12:44:01.637", "related_object_ref": "mitigation-strategy"}]}}, "technical_analysis": {"Introduction": "Minder is an open source Software Supply Chain Security Platform. The Minder Git provider is vulnerable to a denial of service from a maliciously configured GitHub repository.", "Impact and Scope": "The vulnerability allows for exhaustion of memory and server crash when cloning large repositories.", "Related MITRE ATT&CK Techniques": "TA0040, TA0048, TA0012, and TA0058.", "Technical Details": "The vulnerability is caused by a combination of factors, including the ability to control the Git URL, the lack of enforcement of a size limit for cloned repositories, and the cloning of entire repositories into memory.", "Detection": "Detecting the vulnerability involves monitoring for large repository clones and investigating any unusual activity.", "Mitigation": "Implementing rate limiting for repository clone operations, enforcing a size limit for cloned repositories, and validating CloneOptions before cloning a repository can help mitigate this risk.", "Conclusion": "The vulnerability in the Minder Git provider is a serious risk that requires immediate attention. Implementing the recommended mitigation strategies can help reduce the risk of exploitation."}, "executive_analysis": {"Overview": "The Minder Git provider is vulnerable to a denial of service from a maliciously configured GitHub repository.", "Business Impact": "This vulnerability has the potential to cause significant downtime and financial losses.", "Technical Impact": "The vulnerability allows for exhaustion of memory and server crash when cloning large repositories.", "Mitigation Strategies": "Implementing rate limiting for repository clone operations, enforcing a size limit for cloned repositories, and validating CloneOptions before cloning a repository.", "Recommendations": "Immediately update to the latest version of Minder and implement the recommended mitigation strategies.", "Conclusions": "The vulnerability in the Minder Git provider is a serious risk that requires immediate attention. Implementing the recommended mitigation strategies can help reduce the risk of exploitation."}}