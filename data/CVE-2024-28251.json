{"id": "CVE-2024-28251", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-14T00:15:33.630", "lastModified": "2024-03-14T12:52:16.723", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Querybook is a Big Data Querying UI, combining collocated table metadata and a simple notebook interface. Querybook's datadocs functionality works by using a Websocket Server. The client talks to this WSS whenever updating/deleting/reading any cells as well as for watching the live status of query executions. Currently the CORS setting allows all origins, which could result in cross-site websocket hijacking and allow attackers to read/edit/remove datadocs of the user. This issue has been addressed in version 3.32.0. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Querybook es una interfaz de usuario de consulta de Big Data que combina metadatos de tablas colocadas y una interfaz de cuaderno simple. La funcionalidad de documentos de datos de Querybook funciona mediante un servidor Websocket. El cliente habla con este WSS cada vez que actualiza, elimina o lee cualquier celda, as\u00ed como para observar el estado en vivo de las ejecuciones de consultas. Actualmente, la configuraci\u00f3n CORS permite todos los or\u00edgenes, lo que podr\u00eda resultar en el secuestro de websocket entre sitios y permitir a los atacantes leer/editar/eliminar documentos de datos del usuario. Este problema se solucion\u00f3 en la versi\u00f3n 3.32.0. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.6, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.2, "impactScore": 3.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-345"}]}], "references": [{"url": "https://github.com/pinterest/querybook/pull/1425", "source": "security-advisories@github.com"}, {"url": "https://github.com/pinterest/querybook/security/advisories/GHSA-5349-j4c9-x767", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210 - Exploitation of Remote Services", "comment": "CVE-2024-28251 - The vulnerability allows for cross-site WebSocket hijacking, which exploits the datadocs functionality of Querybook. This technique can be used to compromise user data, allowing attackers to read, edit, or remove datadocs."}, {"techniqueID": "T1068 - Exploitation of Remote Services", "comment": "CVE-2024-28251 - The vulnerability exploits the Websocket Server of Querybook, allowing attackers to establish a connection and compromise user data, as described by CWE-345."}, {"techniqueID": "T1190 - Exploitation of Remote Services", "comment": "CVE-2024-28251 - The vulnerability allows for exploitation of cross-site WebSocket hijacking, enabling attackers to remotely steal sensitive data, as described by CVE-2024-28251."}, {"techniqueID": "T1508 - DNS Query", "comment": "CVE-2024-28251 - Although not directly related, DNS queries may be used to detect the presence of the vulnerable Querybook system, providing an opportunity for defense."}], "stix_bundle": {"type": "bundle", "ID": "https://example.com/cve-2024-28251", "created_by_ref": "https://example.com/analyst", "created": "2024-03-14T12:52:16.723", "modified": "2024-03-14T12:52:16.723", "objects": [{"type": "vulnerability", "ID": "https://example.com/cve-2024-28251", "name": "CVE-2024-28251", "description": "Cross-site WebSocket hijacking in Querybook", "severity": "MEDIUM", "cvss_score": "5.6", "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L"}, {"type": "indicator", "ID": "https://example.com/indicator-dns-query", "name": "DNS Query Indicator", "description": "Potential indicator of a vulnerable Querybook system", "pattern": "DNS query for WebSocket Server"}, {"type": "course_of_action", "ID": "https://example.com/defend-against-cve-2024-28251", "name": "Defend Against CVE-2024-28251", "description": "Upgrade to version 3.32.0 or later and restrict Websocket Server access", "mitigates": {"related_object": "https://example.com/cve-2024-28251", "link_label": "mitigates"}}]}, "technical_analysis": {"Introduction": "CVE-2024-28251 is a vulnerability in Querybook that allows for cross-site WebSocket hijacking, enabling attackers to compromise user data.", "Impact and Scope": "The vulnerability has a CVSS score of 5.6, indicating a medium severity, and affects users of Querybook 3.31.0 and earlier.", "Related MITRE ATT&CK Techniques": "T1210, T1068, T1190, and potentially T1508", "Technical Details": "The vulnerability is caused by an incorrect CORS configuration, allowing attackers to bypass Same-Origin Policy and steal or modify sensitive data.", "Detection": "Detection of the vulnerability requires monitoring for abnormal WebSocket activity and inspecting data for signs of unauthorized access.", "Mitigation": "Upgrade to version 3.32.0 or later, restrict Websocket Server access, and implement strict CORS configuration.", "Conclusion": "CVE-2024-28251 is a serious vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-28251 is a vulnerability that can compromise user data in Querybook.", "Business Impact": "The vulnerability can lead to financial loss, reputational damage, and regulatory non-compliance if not properly addressed.", "Technical Impact": "The vulnerability can be exploited by attackers to steal or modify sensitive data, potentially leading to data breaches and unauthorized access.", "Mitigation Strategies": "Upgrade to version 3.32.0 or later, restrict Websocket Server access, and implement strict CORS configuration.", "Recommendations": "Executives should prioritize upgrading Querybook to the latest version and restricting access to the Websocket Server to minimize the risk of data compromise.", "Conclusions": "CVE-2024-28251 is a critical vulnerability that demands immediate attention and action to mitigate the risks associated with it."}}