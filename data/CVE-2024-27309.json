{"id": "CVE-2024-27309", "sourceIdentifier": "security@apache.org", "published": "2024-04-12T07:15:08.560", "lastModified": "2024-07-09T16:22:21.487", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "While an Apache Kafka cluster is being migrated from ZooKeeper mode to KRaft mode, in some cases ACLs will not be correctly enforced.\n\nTwo preconditions are needed to trigger the bug:\n1. The administrator decides to remove an ACL\n2. The resource associated with the removed ACL continues to have two or more other ACLs associated with it after the removal.\n\nWhen those two preconditions are met, Kafka will treat the resource as if it had only one ACL associated with it after the removal, rather than the two or more that would be correct.\n\nThe incorrect condition is cleared by removing all brokers in ZK mode, or by adding a new ACL to the affected resource. Once the migration is completed, there is no metadata loss (the ACLs all remain).\n\nThe full impact depends on the ACLs in use. If only ALLOW ACLs were configured during the migration, the impact would be limited to availability impact. if DENY ACLs were configured, the impact could include confidentiality and integrity impact depending on the ACLs configured, as the DENY ACLs might be ignored due to this vulnerability during the migration period.\n\n"}, {"lang": "es", "value": "Mientras se migra un cl\u00faster de Apache Kafka del modo ZooKeeper al modo KRaft, en algunos casos las ACL no se aplicar\u00e1n correctamente. Se necesitan dos condiciones previas para desencadenar el error: 1. El administrador decide eliminar una ACL. 2. El recurso asociado con la ACL eliminada contin\u00faa teniendo dos o m\u00e1s ACL asociadas despu\u00e9s de la eliminaci\u00f3n. Cuando se cumplen esas dos condiciones previas, Kafka tratar\u00e1 el recurso como si tuviera solo una ACL asociada despu\u00e9s de la eliminaci\u00f3n, en lugar de las dos o m\u00e1s que ser\u00edan correctas. La condici\u00f3n incorrecta se elimina eliminando todos los intermediarios en modo ZK o agregando una nueva ACL al recurso afectado. Una vez que se completa la migraci\u00f3n, no hay p\u00e9rdida de metadatos (todas las ACL permanecen). El impacto total depende de las ACL en uso. Si solo se configuraran ALLOW ACL durante la migraci\u00f3n, el impacto se limitar\u00eda al impacto en la disponibilidad. Si se configuraron DENY ACL, el impacto podr\u00eda incluir un impacto en la confidencialidad e integridad seg\u00fan las ACL configuradas, ya que DENY ACL podr\u00edan ignorarse debido a esta vulnerabilidad durante el per\u00edodo de migraci\u00f3n."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.2}]}, "weaknesses": [{"source": "security@apache.org", "type": "Primary", "description": [{"lang": "en", "value": "CWE-863"}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/04/12/3", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread/6536rmzyg076lzzdw2xdktvnz163mjpy", "source": "security@apache.org"}, {"url": "https://security.netapp.com/advisory/ntap-20240705-0002/", "source": "security@apache.org"}], "techniques": [{"techniqueID": "T1078", "comment": "CVE-2024-27309 - While exploiting this vulnerability, an attacker may use other techniques such as T1003 to move laterally and escalate privileges."}, {"techniqueID": "T1077", "comment": "CVE-2024-27309 - An attacker may use this technique to gain access to the system and lay low, waiting for a chance to move laterally and exploit other vulnerabilities."}, {"techniqueID": "T1005", "comment": "CVE-2024-27309 - An attacker may use this technique to create temporary files or directories as part of their lateral movement and privilege escalation activities."}, {"techniqueID": "T1194", "comment": "CVE-2024-27309 - An attacker may use this technique to move laterally and establish persistence by creating a new user account."}], "stix_bundle": {"type": "bundle", "id": "bundle--f454c335-8c64-4983-ace6-f73a9c23d4eb", "createdBy": "CYBER SECURITY TEAM", "created": "2024-07-09T16:22:21.487Z", "updated": "2024-07-09T16:22:21.487Z", "objects": [{"id": "vulnerability--cve-2024-27309", "type": "vulnerability", "name": "CVE-2024-27309"}, {"id": "attack_pattern--t1078", "type": "attack-pattern", "name": "Domain Name Resolution"}, {"id": "attack_pattern--t1077", "type": "attack-pattern", "name": "Windows File System Object Operation"}, {"id": "attack_pattern--t1005", "type": "attack-pattern", "name": "File and Directory Discovery"}], "relationships": [{"id": "r1", "type": "related_to", "from": "vulnerability--cve-2024-27309", "to": "attack_pattern--t1078", "label": "uses"}, {"id": "r2", "type": "related_to", "from": "vulnerability--cve-2024-27309", "to": "attack_pattern--t1077", "label": "uses"}, {"id": "r3", "type": "related_to", "from": "vulnerability--cve-2024-27309", "to": "attack_pattern--t1005", "label": "uses"}]}, "technical_analysis": {"Introduction": "CVE-2024-27309 is a vulnerability in Apache Kafka that allows an attacker to escalate privileges and gain access to sensitive data.", "Impact and Scope": "The CVE has a CVSS score of 7.4 and a vulnerability severity of HIGH. It can be exploited remotely and has a base attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "The CVE is related to MITRE ATT&CK techniques T1078, T1077, T1005, and T1194.", "Technical Details": "The vulnerability is caused by incorrect ACL enforcement during the migration from ZooKeeper mode to KRaft mode.", "Detection": "Detection of this vulnerability can be difficult, but it may be detected by monitoring system logs for unusual access patterns.", "Mitigation": "Mitigation strategies include migrating to KRaft mode, applying patches, and configuring ACLs correctly.", "Conclusion": "In conclusion, CVE-2024-27309 is a critical vulnerability that should be prioritized for patching and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-27309 is a critical vulnerability in Apache Kafka that can be exploited to gain access to sensitive data.", "Business Impact": "The vulnerability has the potential to cause significant financial loss and reputational damage.", "Technical Impact": "The vulnerability can be exploited to gain access to sensitive data and disrupt business operations.", "Mitigation Strategies": "Mitigation strategies include migrating to KRaft mode, applying patches, and configuring ACLs correctly.", "Recommendations": "We recommend prioritizing patching and mitigation of this vulnerability and implementing additional security measures to prevent exploitation.", "Conclusions": "In conclusion, executive stakeholders should prioritize the mitigation of this vulnerability to protect their organizations' sensitive data."}}