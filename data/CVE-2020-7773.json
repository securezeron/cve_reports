{"id": "CVE-2020-7773", "sourceIdentifier": "report@snyk.io", "published": "2020-11-16T12:15:14.463", "lastModified": "2020-12-01T13:23:29.497", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "This affects the package markdown-it-highlightjs before 3.3.1. It is possible insert malicious JavaScript as a value of lang in the markdown-it-highlightjs Inline code highlighting feature. const markdownItHighlightjs = require(\"markdown-it-highlightjs\"); const md = require('markdown-it'); const reuslt_xss = md() .use(markdownItHighlightjs, { inline: true }) .render('console.log(42){.\">js}'); console.log(reuslt_xss);"}, {"lang": "es", "value": "Esto afecta al paquete markdown-it-highlightjs versiones anteriores a 3.3.1.&#xa0;Es posible insertar JavaScript malicioso como valor de lang en la funcionalidad de resaltado de c\u00f3digo en l\u00ednea markdown-it-highlightjs.&#xa0;const markdownItHighlightjs = require(\"markdown-it-highlightjs\");&#xa0;const md = require(\"markdown-it\");&#xa0;const reuslt_xss = md() .use(markdownItHighlightjs, {inline: true}) .render(\"console.log(42){.\")js}'); console.log(reuslt_xss)"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "report@snyk.io", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:markdown-it-highlightjs_project:markdown-it-highlightjs:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "3.3.1", "matchCriteriaId": "0E6E72E4-63FE-41AA-BBE5-19C53DD52AD1"}]}]}], "references": [{"url": "https://github.com/valeriangalliat/markdown-it-highlightjs/blob/v3.3.0/index.js%23L52", "source": "report@snyk.io", "tags": ["Broken Link"]}, {"url": "https://github.com/valeriangalliat/markdown-it-highlightjs/pull/14", "source": "report@snyk.io", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://snyk.io/vuln/SNYK-JS-MARKDOWNITHIGHLIGHTJS-1040461", "source": "report@snyk.io", "tags": ["Mitigation", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "T1190 - Exploit Public-Facing Application - This technique is relevant because the vulnerability CVE-2020-7773 allows an attacker to insert malicious JavaScript as a value of lang in the markdown-it-highlightjs Inline code highlighting feature. This can lead to cross-site scripting attacks, which can be exploited by an attacker to steal sensitive information, inject malware, or elevate privileges."}, {"techniqueID": "T1059", "comment": "T1059 - Command and Control - This technique is relevant because the attacker could use the vulnerability to gain control of the application and execute arbitrary commands. Malware or other malicious code could be injected into the application, allowing the attacker to steal sensitive data, conduct reconnaissance, or disrupt the application."}, {"techniqueID": "T1068", "comment": "T1068 - Exfiltration Over Command and Control Channel - This technique is relevant because the attacker could use the vulnerability to exfiltrate sensitive data from the application to an external server, using a command and control channel to transmit the data."}, {"techniqueID": "T1199", "comment": "T1199 - Exploitation of Public-Facing Application - This technique is relevant because the vulnerability CVE-2020-7773 affects the markdown-it-highlightjs package, which is a public-facing application, making it vulnerable to exploitation by an attacker."}], "stix_bundle": {"objects": [{"id": "b3f77aa7-4d53-4c9c-b48a-9bfcfbc92c45", "type": "vulnerability", "created_by_ref": "admin", "modified": "2021-01-01T12:00:00.000Z", "description": "CVE-2020-7773 - markdown-it-highlightjs before 3.3.1 Cross-Site Scripting Vulnerability", "background": "markdown-it-highlightjs is an inline code highlighting library for Markdown-it.\r\n\r\nA cross-site scripting vulnerability occurs when an attacker injects malicious JavaScript code into a web page, allowing them to steal sensitive information, inject malware, or elevate privileges. In this case, the attacker could inject malicious JavaScript code as a value of lang in the markdown-it-highlightjs inline code highlighting feature, allowing them to execute arbitrary code on the server or client-side.", "exploits": [{"id": "68f7a2e9-4da5-4834-ae65-d7e4b5de2b3b", "type": "exploit", "created_by_ref": "admin", "modified": "2021-01-01T12:00:00.000Z", "description": "An attacker crafts a malicious request to the markdown-it-highlightjs library, injecting malicious JavaScript code as a value of lang in the inline code highlighting feature.", "tactics": [{"id": "T1190", "type": "tactic", "description": "Exploit Public-Facing Application"}]}], "mitigations": [{"id": "a8c9b6c5-4347-4e5a-955c-3c7ffa6f1c3c", "type": "mitigation", "created_by_ref": "admin", "modified": "2021-01-01T12:00:00.000Z", "description": "Upgrade markdown-it-highlightjs to version 3.3.1 or later to prevent exploitation of this vulnerability.", "mitigates": [{"id": "T1190", "type": "tactic", "description": "Exploit Public-Facing Application"}]}]}]}, "technical_analysis": {"Introduction": "markdown-it-highlightjs is a popular JavaScript library for inlining code highlighting in Markdown-it. The vulnerability in question affects all versions of markdown-it-highlightjs prior to version 3.3.1.", "Impact and Scope": "The vulnerability allows an attacker to inject malicious JavaScript code as a value of lang in the markdown-it-highlightjs inline code highlighting feature, potentially allowing them to execute arbitrary code on the server or client-side.", "Related MITRE ATT&CK Techniques": ["T1190 - Exploit Public-Facing Application", "T1059 - Command and Control", "T1068 - Exfiltration Over Command and Control Channel", "T1199 - Exploitation of Public-Facing Application"], "Technical Details": "The vulnerability arises from the use of unvalidated user input in the markdown-it-highlightjs inline code highlighting feature. An attacker could inject malicious JavaScript code as a value of lang in the feature, allowing them to execute arbitrary code on the server or client-side.", "Detection": "Detection of this vulnerability is challenging, as it relies on identifying malicious JavaScript code injected into the markdown-it-highlightjs inline code highlighting feature.", "Mitigation": "The recommended mitigation is to upgrade markdown-it-highlightjs to version 3.3.1 or later to prevent exploitation of this vulnerability.", "Conclusion": "The vulnerability in markdown-it-highlightjs affects all versions prior to 3.3.1 and allows an attacker to inject malicious JavaScript code, potentially allowing them to execute arbitrary code on the server or client-side."}, "executive_analysis": {"Overview": "The markdown-it-highlightjs library is a popular JavaScript library for inlining code highlighting in Markdown-it. A vulnerability in this library allows an attacker to inject malicious JavaScript code, potentially allowing them to execute arbitrary code on the server or client-side.", "Business Impact": "The impact of this vulnerability could be significant, as it could allow an attacker to steal sensitive information, inject malware, or elevate privileges.", "Technical Impact": "The technical impact of this vulnerability is that it allows an attacker to inject malicious JavaScript code, potentially allowing them to execute arbitrary code on the server or client-side.", "Mitigation Strategies": "The recommended mitigation is to upgrade markdown-it-highlightjs to version 3.3.1 or later to prevent exploitation of this vulnerability.", "Recommendations": "We recommend that you upgrade markdown-it-highlightjs to the latest version and ensure that your application is properly configured to prevent exploitation of this vulnerability.", "Conclusions": "In conclusion, the vulnerability in markdown-it-highlightjs is a significant threat that requires immediate attention. We recommend that you upgrade the library to the latest version and ensure that your application is properly configured to prevent exploitation of this vulnerability."}}