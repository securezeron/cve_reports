{"id": "CVE-2024-40648", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-18T17:15:05.427", "lastModified": "2024-07-19T13:01:44.567", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "matrix-rust-sdk is an implementation of a Matrix client-server library in Rust. The `UserIdentity::is_verified()` method in the matrix-sdk-crypto crate before version 0.7.2 doesn't take into account the verification status of the user's own identity while performing the check and may as a result return a value contrary to what is implied by its name and documentation. If the method is used to decide whether to perform sensitive operations towards a user identity, a malicious homeserver could manipulate the outcome in order to make the identity appear trusted. This is not a typical usage of the method, which lowers the impact. The method itself is not used inside the `matrix-sdk-crypto` crate. The 0.7.2 release of the `matrix-sdk-crypto` crate includes a fix. All users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Matrix-rust-sdk es una implementaci\u00f3n de una librer\u00eda cliente-servidor Matrix en Rust. El m\u00e9todo `UserIdentity::is_verified()` en la caja Matrix-sdk-crypto anterior a la versi\u00f3n 0.7.2 no tiene en cuenta el estado de verificaci\u00f3n de la propia identidad del usuario al realizar la verificaci\u00f3n y, como resultado, puede devolver un valor contrario. a lo que implica su nombre y documentaci\u00f3n. Si el m\u00e9todo se utiliza para decidir si se realizan operaciones confidenciales con respecto a la identidad de un usuario, un servidor dom\u00e9stico malicioso podr\u00eda manipular el resultado para que la identidad parezca confiable. Este no es un uso t\u00edpico del m\u00e9todo, lo que reduce el impacto. El m\u00e9todo en s\u00ed no se utiliza dentro de la caja `matrix-sdk-crypto`. La versi\u00f3n 0.7.2 de la caja `matrix-sdk-crypto` incluye una soluci\u00f3n. Se recomienda a todos los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-287"}]}], "references": [{"url": "https://github.com/matrix-org/matrix-rust-sdk/commit/76a7052149bb8f722df12da915b3a06d19a6695a", "source": "security-advisories@github.com"}, {"url": "https://github.com/matrix-org/matrix-rust-sdk/security/advisories/GHSA-4qg4-cvh2-crgg", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-40648 - In this technique, the attacker may manipulate the verification status of the user's own identity to make it appear trusted, which could potentially allow sensitive operations to be performed towards the user. This technique can be mitigated by ensuring the `UserIdentity::is_verified()` method is used correctly and verifying the identity of users before performing sensitive operations."}, {"techniqueID": "T1191", "comment": "CVE-2024-40648 - The vulnerability in the `matrix-sdk-crypto` crate allows an attacker to manipulate the verification status of the user's own identity. This technique can be mitigated by upgrading to a version of the crate that includes a fix for this vulnerability."}], "technical_analysis": {"Introduction": "The CVE-2024-40648 vulnerability is a CWE-287 weakness in the matrix-rust-sdk library, affecting versions of the library prior to 0.7.2. This weakness allows an attacker to manipulate the verification status of a user's own identity.", "Impact and Scope": "The vulnerability has a CVSS score of 5.4 with a base severity of medium and an attack vector of NETWORK. It affects the `UserIdentity::is_verified()` method in the matrix-sdk-crypto crate, which is used to check if a user's identity is verified.", "Related MITRE ATT&CK Techniques": "T1190 and T1191", "Technical Details": "The vulnerability occurs because the `UserIdentity::is_verified()` method does not take into account the verification status of the user's own identity. This allows an attacker to manipulate the verification status and make the user's identity appear trusted.", "Detection": "Detection of this vulnerability is challenging, as it relies on manual inspection of the user's identity verification status. Detection can be improved by implementing automated tests to verify the identity of users.", "Mitigation": "Mitigation strategies include upgrading to a version of the crate that includes a fix for this vulnerability, as well as implementing automated tests to verify the identity of users.", "Conclusion": "In conclusion, the CVE-2024-40648 vulnerability is a CWE-287 weakness in the matrix-rust-sdk library that allows an attacker to manipulate the verification status of a user's own identity. This vulnerability can be mitigated by upgrading to a fixed version of the library and implementing automated tests to verify the identity of users."}, "executive_analysis": {"Overview": "The CVE-2024-40648 vulnerability is a CWE-287 weakness in the matrix-rust-sdk library that affects the verification status of user identities.", "Business Impact": "The vulnerability could allow an attacker to manipulate the verification status of a user's own identity, potentially allowing sensitive operations to be performed towards the user.", "Technical Impact": "The vulnerability affects the `UserIdentity::is_verified()` method in the matrix-sdk-crypto crate, which is used to check if a user's identity is verified.", "Mitigation Strategies": "Upgrade to a fixed version of the library, implement automated tests to verify the identity of users, and ensure the `UserIdentity::is_verified()` method is used correctly.", "Recommendations": "Upgrade to a fixed version of the library, implement automated tests to verify the identity of users, and ensure the `UserIdentity::is_verified()` method is used correctly.", "Conclusions": "In conclusion, the CVE-2024-40648 vulnerability is a significant risk that requires immediate attention. It is recommended to upgrade to a fixed version of the library, implement automated tests to verify the identity of users, and ensure the `UserIdentity::is_verified()` method is used correctly."}}