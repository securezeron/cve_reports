{"id": "CVE-2007-4560", "sourceIdentifier": "cve@mitre.org", "published": "2007-08-28T01:17:00.000", "lastModified": "2018-10-15T21:36:04.763", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "clamav-milter in ClamAV before 0.91.2, when run in black hole mode, allows remote attackers to execute arbitrary commands via shell metacharacters that are used in a certain popen call, involving the \"recipient field of sendmail.\""}, {"lang": "es", "value": "clamav-milter en ClamAV anterior a 0.91.2, cuando funciona en modo agujero negro (black hole), permite a atacantes remotos ejecutar comandos de su elecci\u00f3n a trav\u00e9s de metacaract\u00e9res del int\u00e9rprete de comandos que es utilizado en ciertas llamadas popen, afectando a \"el campo recipiente de sendmail\"."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:H/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "HIGH", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.6}, "baseSeverity": "HIGH", "exploitabilityScore": 4.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:clam_anti-virus:clamav:*:*:*:*:*:*:*:*", "versionEndIncluding": "0.91.1", "matchCriteriaId": "D5A4D304-EEF9-46C3-B058-EC234F815824"}]}]}], "references": [{"url": "http://docs.info.apple.com/article.html?artnum=307562", "source": "cve@mitre.org"}, {"url": "http://lists.apple.com/archives/security-announce/2008/Mar/msg00001.html", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/26654", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/26674", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/26683", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/26751", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/26822", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/26916", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/29420", "source": "cve@mitre.org"}, {"url": "http://security.gentoo.org/glsa/glsa-200709-14.xml", "source": "cve@mitre.org"}, {"url": "http://securityreason.com/securityalert/3063", "source": "cve@mitre.org"}, {"url": "http://www.debian.org/security/2007/dsa-1366", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDKSA-2007:172", "source": "cve@mitre.org"}, {"url": "http://www.novell.com/linux/security/advisories/2007_18_sr.html", "source": "cve@mitre.org"}, {"url": "http://www.nruns.com/security_advisory_clamav_remote_code_exection.php", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://www.securityfocus.com/archive/1/477723/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/25439", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://www.securitytracker.com/id?1018610", "source": "cve@mitre.org"}, {"url": "http://www.trustix.org/errata/2007/0026/", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2008/0924/references", "source": "cve@mitre.org"}, {"url": "https://www.redhat.com/archives/fedora-package-announce/2007-September/msg00104.html", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1033", "comment": "CVE-2007-4560 - This is a Command and Control (C2) server implementation technique used by attackers to control compromised machines. It allows the attacker to execute arbitrary commands on the targeted system. Defending against this technique can be done by implementing effective backup and restore procedures, implementing strong access controls, and keeping systems and software up-to-date."}, {"techniqueID": "T1041", "comment": "CVE-2007-4560 - This is a Remote File Copy technique used by attackers to move data from a targeted system to an attacker-controlled location. It allows the attacker to steal sensitive data. Defending against this technique can be done by implementing effective data backup and restore procedures, implementing strong access controls, and monitoring network traffic for suspicious activity."}, {"techniqueID": "T1190", "comment": "CVE-2007-4560 - This is a Exploit Public-Facing Application technique used by attackers to compromise a vulnerable system. It allows the attacker to execute arbitrary code on the targeted system. Defending against this technique can be done by implementing effective vulnerability management, implementing strong access controls, and keeping systems and software up-to-date."}], "stix_bundle": {"cybox-observable": [{"id": "STIX \ubd09\uace0 1.0", "type": "bundle", "spec_version": "2.1", "idref": "STIX-1.0", "title": "CVE-2007-4560 STIX Bundle", "description": "STIX bundle related to CVE-2007-4560 vulnerability", "objects": [{"type": "identity", "idref": "ident_1", "name": "CVE-2007-4560", "description": "CVE-2007-4560 - ClamAV 0.91.1 Black Hole Shell Code Execution Vulnerability", "long_description": "A vulnerability in ClamAV 0.91.1 allows remote attackers to execute arbitrary commands via shell metacharacters in the recipient field of sendmail when the milter is in black hole mode.", "risk_problems": [{"type": "vulnerability", "idref": "vuln_1", "name": "ClamAV 0.91.1 Black Hole Shell Code Execution Vulnerability", "description": "A vulnerability in ClamAV 0.91.1 allows remote attackers to execute arbitrary commands via shell metacharacters in the recipient field of sendmail when the milter is in black hole mode.", "long_description": "A vulnerability in ClamAV 0.91.1 allows remote attackers to execute arbitrary commands via shell metacharacters in the recipient field of sendmail when the milter is in black hole mode."}], "observed_data": [{"type": "observe", "idref": "obs_1", "component_name": "ClamAV", "component_version": "0.91.1", "component_type": "vulnerability", "description": "ClamAV 0.91.1 Black Hole Shell Code Execution Vulnerability"}]}]}], "mitre_attack": {"attack_pattern": [{"id": "T1033", "name": "Windows Command Shell", "description": "Attempting to use command-line interface [cmd.exe, command.com]"}, {"id": "T1041", "name": "Remote File Copy", "description": "Attempting to copy [file] from [location] to [location]"}, {"id": "T1190", "name": "Exploit Public-FacingApplication", "description": "Attempting to exploit public-facing application [(ClamAV) with a remote code execution vulnerability]"}]}}, "technical_analysis": {"Introduction": "CVE-2007-4560 is a remote code execution vulnerability in ClamAV 0.91.1, which allows attackers to execute arbitrary commands via shell metacharacters in the recipient field of sendmail when the milter is in black hole mode.", "Impact and Scope": "The vulnerability has a CVSS score of 7.6 out of 10, with a high severity ranking and a moderate attack vector. It can be exploited remotely and has been identified in ClamAV versions 0.91.1 and earlier.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: TA0011-Initial Access, TA0012-Delivery, TA0013-Execution, TA0014-Command and Control, TA0015-Lateral Movement, and TA0016-Exploitation of Phasing and Persistence", "Technical Details": "The vulnerability is caused by a buffer overflow in the ClamAV milter when it processes the recipient field of sendmail in black hole mode. An attacker can exploit this vulnerability by sending a specially crafted email with shell metacharacters in the recipient field.", "Detection": "Detection of this vulnerability can be done by monitoring network traffic for suspicious email activity, monitoring system logs for unusual command execution, and conducting regular vulnerability assessments and penetration testing.", "Mitigation": "Mitigating this vulnerability can be done by applying the appropriate patches, configuring the ClamAV milter to not process the recipient field of sendmail in black hole mode, and implementing a vulnerability management program to monitor for and respond to vulnerabilities.", "Conclusion": "In conclusion, CVE-2007-4560 is a remote code execution vulnerability in ClamAV 0.91.1 that can be exploited by sending a specially crafted email with shell metacharacters in the recipient field. It is important to apply the appropriate patches, configure the ClamAV milter to not process the recipient field of sendmail in black hole mode, and implement a vulnerability management program to monitor for and respond to vulnerabilities."}, "executive_analysis": {"Overview": "CVE-2007-4560 is a critical vulnerability in ClamAV 0.91.1 that allows remote attackers to execute arbitrary commands via shell metacharacters in the recipient field of sendmail when the milter is in black hole mode.", "Business Impact": "The vulnerability has a significant business impact as it can compromise the confidentiality, integrity, and availability of sensitive data, and can alsolead to reputational damage and financial losses.", "Technical Impact": "The vulnerability has a moderate technical impact as it requires the attacker to have access to the email server and to have the ability to send a specially crafted email.", "Mitigation Strategies": "Mitigating this vulnerability requires implementing effective patches, configuring the ClamAV milter to not process the recipient field of sendmail in black hole mode, and implementing a vulnerability management program to monitor for and respond to vulnerabilities.", "Recommendations": "We recommend that organizations apply the appropriate patches, configure the ClamAV milter to not process the recipient field of sendmail in black hole mode, and implement a vulnerability management program to monitor for and respond to vulnerabilities.", "Conclusions": "In conclusion, CVE-2007-4560 is a critical vulnerability in ClamAV 0.91.1 that requires immediate attention and remediation to prevent attacks and minimize business impact."}}