{"id": "CVE-2024-40898", "sourceIdentifier": "security@apache.org", "published": "2024-07-18T10:15:03.217", "lastModified": "2024-08-08T16:02:40.887", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "SSRF in Apache HTTP Server on Windows with mod_rewrite in server/vhost context, allows to potentially leak NTML hashes to a malicious server via SSRF and malicious requests.\n\nUsers are recommended to upgrade to version 2.4.62 which fixes this issue.\u00a0"}, {"lang": "es", "value": "SSRF en el servidor Apache HTTP en Windows con mod_rewrite en el contexto de servidor/vhost, permite potencialmente filtrar hashes NTML a un servidor malicioso a trav\u00e9s de SSRF y solicitudes maliciosas. Se recomienda a los usuarios actualizar a la versi\u00f3n 2.4.62, que soluciona este problema."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "security@apache.org", "type": "Primary", "description": [{"lang": "en", "value": "CWE-918"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:http_server:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.4.62", "matchCriteriaId": "305E43F5-3253-4B7B-A8B0-E6F937986C55"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows:-:*:*:*:*:*:*:*", "matchCriteriaId": "A2572D17-1DE6-457B-99CC-64AFD54487EA"}]}]}], "references": [{"url": "https://httpd.apache.org/security/vulnerabilities_24.html", "source": "security@apache.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-40898 - This SSRF vulnerability could be exploited by an attacker to potentially leak NTML hashes to a malicious server via malicious requests. Defend against this by configuring mod_rewrite settings to prevent SSRF attacks."}, {"techniqueID": "T1218", "comment": "CVE-2024-40898 - This vulnerability could be used by an attacker to execute SSRF requests which could lead to sensitive data disclosure. Defend against this by implementing controls to restrict external data sources and monitoring for suspicious requests."}, {"techniqueID": "T1590", "comment": "CVE-2024-40898 - This SSRF vulnerability could be used by an attacker to perform lateral movement. Defend against this by implementing controls to restrict unauthorized access and monitoring for suspicious network traffic."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "b-2024-40898", "created_by_ref": "stix-author", "created": "2024-08-08T16:02:40.887Z", "modified": "2024-08-08T16:02:40.887Z", "objects": [{"type": "vulnerability", "id": "v-2024-40898", "name": "Apache HTTP Server SSRF Vulnerability", "description": "The Apache HTTP Server is vulnerable to a SSRF vulnerability.", "published": "2024-07-18T10:15:03.217Z", "last_modified": "2024-08-08T16:02:40.887Z", "vuln_status": "Analyzed", "cve_tags": [], "descriptions": [{"lang": "en", "value": "SSRF in Apache HTTP Server on Windows with mod_rewrite in server/vhost context, allows to potentially leak NTML hashes to a malicious server via SSRF and malicious requests."}], "metrics": {"cvss_metric_v31": [{"source": "nvd@nist.gov", "type": "Primary", "cvss_data": {"version": "3.1", "vector_string": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"}}]}, "weaknesses": [{"source": "security@apache.org", "type": "Primary", "description": [{"lang": "en", "value": "CWE-918"}]}]}, {"type": "course_of_action", "id": "coa-2024-40898-1", "name": "Configure mod_rewrite settings", "description": "Configure mod_rewrite settings to prevent SSRF attacks.", "recommended_by_ref": "v-2024-40898", "mitigated_by_technique_ids": ["T1190"]}, {"type": "course_of_action", "id": "coa-2024-40898-2", "name": "Implement controls to restrict external data sources", "description": "Implement controls to restrict external data sources and monitor for suspicious requests.", "recommended_by_ref": "v-2024-40898", "mitigated_by_technique_ids": ["T1218"]}, {"type": "course_of_action", "id": "coa-2024-40898-3", "name": "Implement controls to restrict unauthorized access", "description": "Implement controls to restrict unauthorized access and monitor for suspicious network traffic.", "recommended_by_ref": "v-2024-40898", "mitigated_by_technique_ids": ["T1590"]}], "relationships": [{"type": "vulnerable_to", "id": "v-2024-40898-vulnerable-to-t1190", "source_ref": "v-2024-40898", "target_ref": "technique-id:T1190", "relationship_type": "intrastep"}, {"type": "vulnerable_to", "id": "v-2024-40898-vulnerable-to-t1218", "source_ref": "v-2024-40898", "target_ref": "technique-id:T1218", "relationship_type": "intrastep"}, {"type": "vulnerable_to", "id": "v-2024-40898-vulnerable-to-t1590", "source_ref": "v-2024-40898", "target_ref": "technique-id:T1590", "relationship_type": "intrastep"}]}, "technical_analysis": {"Introduction": "The Apache HTTP Server SSRF vulnerability affects the Apache HTTP Server on Windows with mod_rewrite in server/vhost context. This vulnerability allows an attacker to potentially leak NTML hashes to a malicious server via SSRF and malicious requests.", "Impact and Scope": "The impact of this vulnerability is HIGH, with a CVSS score of 7.5. The scope of this vulnerability is LIMITED to Apache HTTP Server on Windows with mod_rewrite in server/vhost context.", "Related MITRE ATT&CK Techniques": "T1190, T1218, T1590", "Technical Details": "The vulnerability occurs because of a weakness in the mod_rewrite module. This weakness allows an attacker to exploit the SSRF vulnerability and potentially leak NTML hashes.", "Detection": "Detection of this vulnerability can be done by monitoring the Apache HTTP Server logs for suspicious requests.", "Mitigation": "Mitigation of this vulnerability can be done by configuring mod_rewrite settings to prevent SSRF attacks, implementing controls to restrict external data sources, and implementing controls to restrict unauthorized access.", "Conclusion": "In conclusion, the Apache HTTP Server SSRF vulnerability is a critical vulnerability that requires immediate attention. It is essential to protect against this vulnerability by configuring mod_rewrite settings, implementing controls to restrict external data sources, and implementing controls to restrict unauthorized access."}, "executive_analysis": {"Overview": "The Apache HTTP Server SSRF vulnerability is a critical vulnerability that affects the Apache HTTP Server on Windows with mod_rewrite in server/vhost context.", "Business Impact": "The impact of this vulnerability is significant, as it allows an attacker to potentially leak NTML hashes to a malicious server via SSRF and malicious requests.", "Technical Impact": "The technical impact of this vulnerability is HIGH, with a CVSS score of 7.5.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability are configuring mod_rewrite settings to prevent SSRF attacks, implementing controls to restrict external data sources, and implementing controls to restrict unauthorized access.", "Recommendations": "It is recommended to upgrade to version 2.4.62, which fixes this issue.", "Conclusions": "In conclusion, the Apache HTTP Server SSRF vulnerability is a critical vulnerability that requires immediate attention. It is essential to protect against this vulnerability by configuring mod_rewrite settings, implementing controls to restrict external data sources, and implementing controls to restrict unauthorized access."}}