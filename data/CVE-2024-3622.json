{"id": "CVE-2024-3622", "sourceIdentifier": "secalert@redhat.com", "published": "2024-04-25T18:15:09.747", "lastModified": "2024-04-26T12:58:17.720", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A flaw was found when using mirror-registry to install Quay. It uses a default secret, which is stored in plain-text format in one of the configuration template files. This issue may lead to all instances of Quay deployed using mirror-registry to have the same secret key. This flaw allows a malicious actor to craft session cookies and as a consequence, it may lead to gaining access to the affected Quay instance."}, {"lang": "es", "value": "Se encontr\u00f3 una falla al usar el registro espejo para instalar Quay. Utiliza un secreto predeterminado, que se almacena en formato de texto plano en uno de los archivos de plantilla de configuraci\u00f3n. Este problema puede provocar que todas las instancias de Quay implementadas mediante el registro espejo tengan la misma clave secreta. Esta falla permite que un actor malicioso cree cookies de sesi\u00f3n y, como consecuencia, puede conducir a obtener acceso a la instancia de Quay afectada."}], "metrics": {"cvssMetricV31": [{"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-256"}]}], "references": [{"url": "https://access.redhat.com/security/cve/CVE-2024-3622", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2274400", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1568", "comment": "CVE-2024-3622 - This vulnerability can be exploited using the technique T1568: Web Shellcode, where an attacker can use the default secret key to craft session cookies and gain access to the affected Quay instance. Defending against this vulnerability requires implementing proper secret key rotation and storage practices."}, {"techniqueID": "T1190", "comment": "CVE-2024-3622 - This vulnerability can also be exploited using the technique T1190: Exploitation of Authentication Mechanism, where an attacker can use the default secret key to authenticate to the affected Quay instance."}, {"techniqueID": "T1003", "comment": "CVE-2024-3622 - This vulnerability can be used to gather credentials and authentication data using the technique T1003: Credential Dumping, which can be used to gain unauthorized access to the affected Quay instance."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle--cve-2024-3622", "created_by_ref": "https://example.com", "created": "2024-04-26T12:58:17.720", "modified": "2024-04-26T12:58:17.720", "objects": [{"type": "indicator", "id": "indicator--quay-session-cookie", "created_by_ref": "https://example.com", "created": "2024-04-26T12:58:17.720", "modified": "2024-04-26T12:58:17.720", "name": "Quay Session Cookie", "description": "Quay session cookie used for authentication", "valid_from": "2024-04-25T18:15:09.747", "valid_until": "2024-12-31T23:59:59.999", "labels": ["cve-2024-3622", "quay", "session-cookie"]}, {"type": "identity", "id": "identity--quay-instance", "created_by_ref": "https://example.com", "created": "2024-04-26T12:58:17.720", "modified": "2024-04-26T12:58:17.720", "name": "Quay Instance", "description": "Quay instance affected by CVE-2024-3622", "roles": ["affected-quay-instance"], "labels": ["cve-2024-3622", "quay", "instance"]}, {"type": "used-for-authentication", "id": "relationship--quay-session-cookie-to-quay-instance", "created_by_ref": "https://example.com", "created": "2024-04-26T12:58:17.720", "modified": "2024-04-26T12:58:17.720", "source_ref": "indicator--quay-session-cookie", "target_ref": "identity--quay-instance"}, {"type": "course-of-action", "id": "course-of-action--rotate-secret-key", "created_by_ref": "https://example.com", "created": "2024-04-26T12:58:17.720", "modified": "2024-04-26T12:58:17.720", "description": "Rotate the default secret key used by Quay", "status": "recommended", "labels": ["cve-2024-3622", "quay", "secret-key-rotation"]}, {"type": "course-of-action", "id": "course-of-action--implement-strict-ssl", "created_by_ref": "https://example.com", "created": "2024-04-26T12:58:17.720", "modified": "2024-04-26T12:58:17.720", "description": "Implement strict SSL/TLS configuration for Quay", "status": "recommended", "labels": ["cve-2024-3622", "quay", "ssl-strict-configuration"]}], " relationships": [{"type": "affected-by", "id": "affected-by--cve-2024-3622-to-quay-instance", "created_by_ref": "https://example.com", "created": "2024-04-26T12:58:17.720", "modified": "2024-04-26T12:58:17.720", "source_ref": "cve-2024-3622", "target_ref": "identity--quay-instance"}, {"type": "mitigated-by", "id": "mitigated-by--rotate-secret-key-to-cve-2024-3622", "created_by_ref": "https://example.com", "created": "2024-04-26T12:58:17.720", "modified": "2024-04-26T12:58:17.720", "source_ref": "course-of-action--rotate-secret-key", "target_ref": "cve-2024-3622"}]}}, "technical_analysis": {"Introduction": "CVE-2024-3622 is a vulnerability in Quay that allows an attacker to craft session cookies and gain access to the affected instance.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 8.8 and an attack vector of NETWORK. The scope of this vulnerability is limited to instances of Quay deployed using mirror-registry.", "Related MITRE ATT&CK Techniques": "T1568: Web Shellcode, T1190: Exploitation of Authentication Mechanism, T1003: Credential Dumping", "Technical Details": "The vulnerability is caused by the use of a default secret key in Quay's configuration template files.", "Detection": "Detection of this vulnerability requires monitoring for unusual authentication activity and checking for the presence of the default secret key.", "Mitigation": "Mitigation of this vulnerability requires implementing proper secret key rotation and storage practices, as well as implementing strict SSL/TLS configuration for Quay.", "Conclusion": "In conclusion, CVE-2024-3622 is a high-impact vulnerability that can be exploited using various MITRE ATT&CK techniques. Proper mitigation and detection strategies are essential to preventing attacks."}, "executive_analysis": {"Overview": "CVE-2024-3622 is a critical vulnerability in Quay that can be exploited by an attacker to gain unauthorized access to the affected instance.", "Business Impact": "The business impact of this vulnerability is significant, as it could allow an attacker to steal sensitive information or disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is also significant, as it could allow an attacker to escalate their privileges and gain control of the affected instance.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include implementing proper secret key rotation and storage practices, as well as implementing strict SSL/TLS configuration for Quay.", "Recommendations": "Recommendations for executives include monitoring for unusual authentication activity and implementing security controls to prevent attacks.", "Conclusions": "In conclusion, CVE-2024-3622 is a critical vulnerability that requires immediate attention and mitigation. Executives should prioritize implementing security controls and monitoring for unusual activity to prevent attacks."}}