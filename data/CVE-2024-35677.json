{"id": "CVE-2024-35677", "sourceIdentifier": "audit@patchstack.com", "published": "2024-06-10T16:15:15.533", "lastModified": "2024-06-12T17:50:33.367", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') vulnerability in StylemixThemes MegaMenu allows PHP Local File Inclusion.This issue affects MegaMenu: from n/a through 2.3.12."}, {"lang": "es", "value": "La limitaci\u00f3n inadecuada de un nombre de ruta a una vulnerabilidad de directorio restringido (\"Path Traversal\") en StylemixThemes MegaMenu permite la inclusi\u00f3n de archivos locales PHP. Este problema afecta a MegaMenu: desde n/a hasta 2.3.12."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "audit@patchstack.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.2, "impactScore": 6.0}]}, "weaknesses": [{"source": "audit@patchstack.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:stylemixthemes:mega_menu:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "2.3.13", "matchCriteriaId": "FE95B0C3-49D4-445C-92C2-377101BCCFCD"}]}]}], "references": [{"url": "https://patchstack.com/database/vulnerability/stm-megamenu/wordpress-megamenu-plugin-2-3-12-unauthenticated-local-file-inclusion-vulnerability?_s_id=cve", "source": "audit@patchstack.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-35677 - Utilization of a Path Traversal to breach internal file system"}, {"techniqueID": "T1555", "comment": "CVE-2024-35677 - Unauthenticated Local File Inclusion to read or write sensitive information"}, {"techniqueID": "T1408", "comment": "CVE-2024-35677 - Using PHP Local File Inclusion to include malicious files from the local file system"}, {"techniqueID": "T1222", "comment": "CVE-2024-35677 - PHP Code Injection to inject malicious code into the system"}], "stix_bundle": {"type": "bundle", "id": "b-1", "created_by_ref": "a-1", "created": "2024-06-12T17:50:33.367", "modified": "2024-06-12T17:50:33.367", "objects": [{"type": "vulnerability", "id": "v-v-1", "name": "CVE-2024-35677", "description": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') vulnerability in StylemixThemes MegaMenu allows PHP Local File Inclusion.", "severity": "HIGH", "published": "2024-06-10T16:15:15.533", "last_modified": "2024-06-12T17:50:33.367", "/mitre-attack-techniques": [{"x_opencti_object_ref": "t-1", "role": "Attack Pattern"}, {"x_opencti_object_ref": "t-2", "role": "Initial Access Vector"}, {"x_opencti_object_ref": "t-3", "role": "Command and Control"}], "relationships": [{"type": "has-mitre-technique", "id": "r-1", "object_ref": "t-1"}, {"type": "has-mitre-technique", "id": "r-2", "object_ref": "t-2"}, {"type": "has-mitre-technique", "id": "r-3", "object_ref": "t-3"}]}, {"type": "indicator", "id": "i-1", "name": "MegaMenu Plugin Unauthenticated Local File Inclusion", "description": "Indication of Compromise (IOCs) for CVE-2024-35677", "pattern": "PHP Local File Inclusion in MegaMenu Plugin"}, {"type": "course-of-action", "id": "coa-1", "name": "Defense - PHP Code Execution Prevention", "description": "Disable PHP Code Execution in MegaMenu Plugin", "mitigates": {"id": "t-1", "role": "Attack Pattern"}}, {"type": "course-of-action", "id": "coa-2", "name": "Defense - File Access Controls", "description": "Implement File Access Controls to restrict PHP File Inclusion", "mitigates": {"id": "t-2", "role": "Initial Access Vector"}}]}, "technical_analysis": {"Introduction": "This vulnerability allows for unauthenticated local file inclusion in MegaMenu Plugin, which can lead to code execution and data theft.", "Impact and Scope": "The impact of this vulnerability is HIGH, with a CVSS score of 9.8. The scope is NETWORK.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190, T1555, T1408, and T1222.", "Technical Details": "The vulnerability occurs when the MegaMenu Plugin allows PHP Local File Inclusion without proper validation and sanitization, allowing an attacker to include malicious files from the local file system.", "Detection": "Detection of this vulnerability involves monitoring for PHP Local File Inclusion in MegaMenu Plugin and inspecting the included files.", "Mitigation": "Mitigation strategies involve disabling PHP Code Execution in MegaMenu Plugin, implementing File Access Controls to restrict PHP File Inclusion, and scanning for and removing malicious files.", "Conclusion": "In conclusion, this vulnerability poses a significant risk to security and should be addressed accordingly."}, "executive_analysis": {"Overview": "This vulnerability is a critical security risk that allows for unauthenticated local file inclusion in MegaMenu Plugin.", "Business Impact": "The business impact of this vulnerability is significant, as it allows for unauthorized access to sensitive data and can lead to code execution and data theft.", "Technical Impact": "The technical impact of this vulnerability is HIGH, with a CVSS score of 9.8. The scope is NETWORK.", "Mitigation Strategies": "The mitigation strategies for this vulnerability involve disabling PHP Code Execution in MegaMenu Plugin, implementing File Access Controls to restrict PHP File Inclusion, and scanning for and removing malicious files.", "Recommendations": "We recommend that all MegaMenu Plugin users update to the latest version and implement the recommended mitigation strategies.", "Conclusions": "In conclusion, this vulnerability is a critical security risk that should be addressed as soon as possible."}}