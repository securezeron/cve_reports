{"id": "CVE-2007-0659", "sourceIdentifier": "cve@mitre.org", "published": "2007-02-01T22:28:00.000", "lastModified": "2023-11-07T02:00:10.330", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "download.php in the MuddyDogPaws FileDownload snippet before 2.5 for MODx allows remote attackers to download arbitrary files, as demonstrated by downloading config.inc.php to obtain database credentials."}, {"lang": "es", "value": "download.php en el fragmento de c\u00f3digo MuddyDogPaws FileDownload versiones anteriores   a 2.5 para MODx, permite a atacantes remotos descargar ficheros de su elecci\u00f3n, como se demuestra descargando config.inc.php para obtener credenciales de base de datos."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:modxcms:filedownload:1.7:*:*:*:*:*:*:*", "matchCriteriaId": "937EE7D7-CA62-4F9B-8E74-FCB03A198F6B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:modxcms:filedownload:2.0:*:*:*:*:*:*:*", "matchCriteriaId": "8AC24837-C4B0-403F-8BA1-497508752BF8"}]}]}], "references": [{"url": "http://modxcms.com/forums/index.php/topic%2C10470.0.html", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/23953", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.muddydogpaws.com/Home.html", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/22327", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://www.vupen.com/english/advisories/2007/0426", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0001: Initial Access", "comment": "CVE-2007-0659 - Remote attackers can use this vulnerability to access the affected MODx system, which could potentially lead to further exploitation."}, {"techniqueID": "TA0002: Execution", "comment": "CVE-2007-0659 - The arbitrary file download capability can be used to execute malicious files."}, {"techniqueID": "TA0034: Command and Control", "comment": "CVE-2007-0659 - The arbitrary file download capability can be used to download and execute command and control malware."}, {"techniqueID": "TA0046: Persistence", "comment": "CVE-2007-0659 - The vulnerability can be used to persist on the system by downloading and executing malware that persists the connection."}, {"techniqueID": "TA0065: Communication Exfiltration Data to Command and Control", "comment": "CVE-2007-0659 - The arbitrary file download capability can be used to exfiltrate data to command and control servers."}, {"techniqueID": "T1204: User Execution", "comment": "CVE-2007-0659 - The vulnerability can be used to trick users into executing malicious files."}, {"techniqueID": "T1205: Remote File Copy", "comment": "CVE-2007-0659 - The arbitrary file download capability can be used to copy files remotely."}], "stix_bundle": {"*": {"type": "bundle", "id": "https://example.com/bundle", "spec_version": "2.1", "events": [{"type": "vulnerability", "id": "https://example.com/vulnerability", "description": "Remote attackers can download arbitrary files and potentially execute them to gain unauthorized access to the affected MODx system."}], "objects": [{"type": "vulnerability", "id": "https://example.com/vulnerability", "description": "Remote attackers can download arbitrary files and potentially execute them to gain unauthorized access to the affected MODx system."}, {"type": "technique", "id": "https://example.com/technique", "name": "TA0001: Initial Access", "description": "Remote attackers can use this vulnerability to access the affected MODx system, which could potentially lead to further exploitation."}, {"type": "technique", "id": "https://example.com/technique", "name": "TA0002: Execution", "description": "The arbitrary file download capability can be used to execute malicious files."}, {"type": "technique", "id": "https://example.com/technique", "name": "TA0034: Command and Control", "description": "The arbitrary file download capability can be used to download and execute command and control malware."}, {"type": "technique", "id": "https://example.com/technique", "name": "TA0046: Persistence", "description": "The vulnerability can be used to persist on the system by downloading and executing malware that persists the connection."}, {"type": "technique", "id": "https://example.com/technique", "name": "TA0065: Communication Exfiltration Data to Command and Control", "description": "The arbitrary file download capability can be used to exfiltrate data to command and control servers."}, {"type": "technique", "id": "https://example.com/technique", "name": "T1204: User Execution", "description": "The vulnerability can be used to trick users into executing malicious files."}, {"type": "technique", "id": "https://example.com/technique", "name": "T1205: Remote File Copy", "description": "The arbitrary file download capability can be used to copy files remotely."}]}}, "technical_analysis": {"Introduction": "The CVE-2007-0659 vulnerability in MODx's FileDownload snippet allows remote attackers to download arbitrary files, potentially executing them to gain unauthorized access.", "Impact and Scope": "The impact of this vulnerability is the potential for remote code execution and data exfiltration. The scope of this vulnerability is MODx systems that use the FileDownload snippet.", "Related MITRE ATT&CK Techniques": "TA0001, TA0002, TA0034, TA0046, TA0065, T1204, T1205", "Technical Details": "The vulnerability is caused by a lack of input validation and sanitization in the download.php script. An attacker can provide a custom file name and path to download and execute arbitrary files.", "Detection": "Detection can be performed by monitoring for suspicious file download and execution activity.", "Mitigation": "The vulnerability can be mitigated by updating to a patched version of MODx, disabling the FileDownload snippet, or implementing additional input validation and sanitization mechanisms.", "Conclusion": "The CVE-2007-0659 vulnerability is a significant risk to affected MODx systems and should be addressed promptly."}, "executive_analysis": {"Overview": "The CVE-2007-0659 vulnerability in MODx's FileDownload snippet allows remote attackers to download and execute arbitrary files, potentially gaining unauthorized access.", "Business Impact": "The impact of this vulnerability is the potential for unauthorized access to sensitive data and systems.", "Technical Impact": "The vulnerability can be used to remotely execute malicious code and exfiltrate data.", "Mitigation Strategies": " Updating to a patched version of MODx, disabling the FileDownload snippet, and implementing additional input validation and sanitization mechanisms.", "Recommendations": "Executives are recommended to prioritize the mitigation of this vulnerability and ensure that all MODx systems are updated or configured securely.", "Conclusions": "The CVE-2007-0659 vulnerability is a significant risk to affected MODx systems and should be addressed promptly."}}