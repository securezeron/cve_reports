{"id": "CVE-2024-24758", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-16T22:15:08.160", "lastModified": "2024-05-01T18:15:14.833", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Undici is an HTTP/1.1 client, written from scratch for Node.js. Undici already cleared Authorization headers on cross-origin redirects, but did not clear `Proxy-Authentication` headers. This issue has been patched in versions 5.28.3 and 6.6.1. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Undici es un cliente HTTP/1.1, escrito desde cero para Node.js. Undici ya borr\u00f3 los encabezados de Autorizaci\u00f3n en redirecciones de origen cruzado, pero no borr\u00f3 los encabezados \"Proxy-Authentication\". Este problema se solucion\u00f3 en las versiones 5.28.3 y 6.6.1. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 3.9, "baseSeverity": "LOW"}, "exploitabilityScore": 0.5, "impactScore": 3.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/03/11/1", "source": "security-advisories@github.com"}, {"url": "https://github.com/nodejs/undici/commit/b9da3e40f1f096a06b4caedbb27c2568730434ef", "source": "security-advisories@github.com"}, {"url": "https://github.com/nodejs/undici/security/advisories/GHSA-3787-6prv-h9w3", "source": "security-advisories@github.com"}, {"url": "https://security.netapp.com/advisory/ntap-20240419-0007/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-24758 - This vulnerability allows an attackers to conduct HTTP proxy authentication, which can lead to unauthorized access to sensitive data. This can be mitigated by upgrading to patched versions 5.28.3 and 6.6.1."}, {"techniqueID": "T1055", "comment": "CVE-2024-24758 - This vulnerability allows an attacker to manipulate HTTP proxy authentication headers, which can be used to conduct man-in-the-middle attacks. Defending against this requires implementing proper authentication and authorization mechanisms."}, {"techniqueID": "T1075", "comment": "CVE-2024-24758 - This vulnerability can be exploited to establish a proxy connection to an attacker-controlled server, allowing further exploitation. Defending against this requires implementing strict network segmentation and monitoring."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve-2024-24758.stix", "created": "2024-02-19T14:30:00.000Z", "modified": "2024-02-19T14:30:00.000Z", "objects": [{"type": "attack-pattern", "id": "https://example.com/T1190", "name": "HTTP Proxy Authentication Hijacking"}, {"type": "attack-pattern", "id": "https://example.com/T1055", "name": "HTTP Proxy Header Manipulation"}, {"type": "attack-pattern", "id": "https://example.com/T1075", "name": "Proxy Connection Establishment"}, {"type": "indicator", "id": "https://example.com/indicator-1", "name": "HTTP Proxy Authentication Hijacking Detection"}, {"type": "indicator", "id": "https://example.com/indicator-2", "name": "HTTP Proxy Header Manipulation Detection"}, {"type": "course-of-action", "id": "https://example.com/COA-1", "name": "Upgrade to Patched Versions"}, {"type": "course-of-action", "id": "https://example.com/COA-2", "name": "Implement Proper Authentication and Authorization"}, {"type": "course-of-action", "id": "https://example.com/COA-3", "name": "ImplementStrict Network Segmentation and Monitoring"}], " relationships": [{"type": "related-to", "id": "https://example.com/relationship-1", "source_node": "https://example.com/T1190", "target_node": "https://example.com/indicator-1", "relationship_type": "detection"}, {"type": "related-to", "id": "https://example.com/relationship-2", "source_node": "https://example.com/T1055", "target_node": "https://example.com/indicator-2", "relationship_type": "detection"}, {"type": "related-to", "id": "https://example.com/relationship-3", "source_node": "https://example.com/T1075", "target_node": "https://example.com/COA-3", "relationship_type": "mitigation"}]}, "technical_analysis": {"Introduction": "Undici is an HTTP/1.1 client that allows unauthorized access due to a vulnerability in the HTTP proxy authentication mechanism.", "Impact and Scope": "The vulnerability allows an attacker to conduct HTTP proxy authentication, which can lead to unauthorized access to sensitive data, with a CVSS score of 3.9 (HIGH) and an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "T1190, T1055, T1075", "Technical Details": "The vulnerability occurs due to the lack of proper authentication and authorization mechanisms in the HTTP proxy authentication mechanism.", "Detection": "Detection methods include monitoring for suspicious HTTP proxy authentication requests and examining network logs for signs of unauthorized access.", "Mitigation": "Mitigation strategies include upgrading to patched versions 5.28.3 and 6.6.1, implementing proper authentication and authorization mechanisms, and implementing strict network segmentation and monitoring.", "Conclusion": "The vulnerability in Undici's HTTP proxy authentication mechanism is a high-risk vulnerability that requires prompt mitigation."}, "executive_analysis": {"Overview": "The vulnerability in Undici's HTTP proxy authentication mechanism allows unauthorized access to sensitive data, which can have significant business and technical impacts.", "Business Impact": "The vulnerability can lead to unauthorized access to sensitive data, which can result in data breaches, financial losses, and reputational damage.", "Technical Impact": "The vulnerability can also lead to man-in-the-middle attacks, which can compromise the confidentiality and integrity of data.", "Mitigation Strategies": "Mitigation strategies include upgrading to patched versions 5.28.3 and 6.6.1, implementing proper authentication and authorization mechanisms, and implementing strict network segmentation and monitoring.", "Recommendations": "Recommendations for executives include prioritizing patching and upgrading vulnerable systems, implementing robust security controls, and conducting regular security assessments.", "Conclusions": "In conclusion, the vulnerability in Undici's HTTP proxy authentication mechanism is a significant security risk that requires prompt mitigation to protect sensitive data and prevent unauthorized access."}}