{"id": "CVE-2020-15111", "sourceIdentifier": "security-advisories@github.com", "published": "2020-07-20T18:15:12.000", "lastModified": "2021-10-07T17:14:07.447", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Fiber before version 1.12.6, the filename that is given in c.Attachment() (https://docs.gofiber.io/ctx#attachment) is not escaped, and therefore vulnerable for a CRLF injection attack. I.e. an attacker could upload a custom filename and then give the link to the victim. With this filename, the attacker can change the name of the downloaded file, redirect to another site, change the authorization header, etc. A possible workaround is to serialize the input before passing it to ctx.Attachment()."}, {"lang": "es", "value": "En Fiber versiones anteriores a 1.12.6, el nombre de archivo que se proporciona en la funci\u00f3n c.Attachment() (https://docs.gofiber.io/ctx#attachment) no es escapado y, por lo tanto, es vulnerable a un ataque de inyecci\u00f3n CRLF. Es decir, un atacante podr\u00eda cargar un nombre de archivo personalizado y luego darle el enlace a la v\u00edctima. Con este nombre de archivo, el atacante puede cambiar el nombre del archivo descargado, redireccionar a otro sitio, cambiar el encabezado de autorizaci\u00f3n, etc. Una posible soluci\u00f3n es serializar la entrada antes de pasarla hacia la funci\u00f3n ctx.Attachment()"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.5}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.2, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 2.5}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-74"}, {"lang": "en", "value": "CWE-93"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gofiber:fiber:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.12.6", "matchCriteriaId": "951C1396-5CA3-475A-8AA8-D007A63B0CBE"}]}]}], "references": [{"url": "https://github.com/gofiber/fiber/pull/579/commits/f698b5d5066cfe594102ae252cd58a1fe57cf56f", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/gofiber/fiber/security/advisories/GHSA-9cx9-x2gp-9qvh", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1117", "comment": "CVE-2020-15111 - An attacker could inject custom filenames to perform CRLF attacks, by providing a file name that is not escaped, it allows an attacker to upload a custom file name and then give the link to the victim, leading to potential data exfiltration and unauthorized access. Defending against this technique requires proper input validation and sanitization of file names."}, {"techniqueID": "T1190", "comment": "CVE-2020-15111 - An unvalidated user input in the filename parameter of the ctx.Attachment() function allows an attacker to perform a CRLF injection attack, leading to potential data exfiltration and unauthorized access. Defending against this technique requires implementing a web application firewall (WAF) and configuring it to block suspicious traffic."}, {"techniqueID": "T1505", "comment": "CVE-2020-15111 - The vulnerability allows an attacker to perform a path traversal attack, by injecting a custom filename that contains special characters, this can lead to accessing unauthorized files and directories. Defending against this technique requires implementing a proper path validation and sanitization mechanism."}], "stix_bundle": "coming soon", "technical_analysis": {"Introduction": "The CVE-2020-15111 vulnerability is a CRLF injection vulnerability in the Fiber framework, which allows an attacker to inject custom filenames and perform various malicious activities.", "Impact and Scope": "The vulnerability has a CVSS score of 5.4 (MEDIUM) and affects Fiber versions prior to 1.12.6, it allows an attacker to perform CRLF injection attacks, which can lead to potential data exfiltration and unauthorized access.", "Related MITRE ATT&CK Techniques": "T1117, T1190 and T1505", "Technical Details": "The vulnerability occurs due to the lack of proper input validation and sanitization of the filename parameter in the ctx.Attachment() function, which allows an attacker to inject custom filenames and perform various malicious activities.", "Detection": "Detecting this vulnerability requires monitoring for suspicious traffic patterns, such as requests with unusual filenames or paths, and implementing security tools that can detect and block CRLF injection attacks.", "Mitigation": "Mitigating this vulnerability requires updating to a patched version of Fiber, implementing a web application firewall (WAF) to block suspicious traffic, and configuring proper input validation and sanitization mechanisms.", "Conclusion": "In conclusion, CVE-2020-15111 is a significant vulnerability that requires immediate attention, and mitigating it requires a combination of technical and organizational measures."}, "executive_analysis": {"Overview": "CVE-2020-15111 is a CRLF injection vulnerability in the Fiber framework that allows an attacker to perform various malicious activities.", "Business Impact": "This vulnerability can lead to data exfiltration and unauthorized access, which can result in significant financial and reputational losses.", "Technical Impact": "The vulnerability affects Fiber versions prior to 1.12.6, and its exploitation can lead to potential data exfiltration and unauthorized access.", "Mitigation Strategies": "Updating to a patched version of Fiber, implementing a WAF, and configuring proper input validation and sanitization mechanisms are the recommended mitigation strategies.", "Recommendations": "We recommend that executives prioritize this vulnerability and implement the recommended mitigation strategies to prevent potential attacks.", "Conclusions": "In conclusion, CVE-2020-15111 is a significant vulnerability that requires immediate attention and mitigation, and we recommend that executives prioritize it to prevent potential attacks."}}