{"id": "CVE-2024-21366", "sourceIdentifier": "secure@microsoft.com", "published": "2024-02-13T18:15:53.913", "lastModified": "2024-05-29T00:15:29.073", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability"}, {"lang": "es", "value": "Proveedor Microsoft WDAC OLE DB para la vulnerabilidad de ejecuci\u00f3n remota de c\u00f3digo de SQL Server"}], "metrics": {"cvssMetricV31": [{"source": "secure@microsoft.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "secure@microsoft.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-122"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1507:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.10240.20469", "matchCriteriaId": "448534CE-1C07-4DF1-8EDD-C43C3492898B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1607:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.14393.6709", "matchCriteriaId": "2D282E53-ABBF-4832-9C93-A988586AE96E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1809:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.17763.5458", "matchCriteriaId": "A1689DFD-D52D-4121-BFD7-DBF2BE4E7DE8"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_21h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.19044.4046", "matchCriteriaId": "C78776CC-3A9C-41A3-8BEB-D71D92F6579D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_22h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.19045.4046", "matchCriteriaId": "806CA6D2-42B2-4244-A5ED-D23E6DD56772"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_21h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22000.2777", "matchCriteriaId": "3F7F8173-9E59-48E4-98C9-4BEB6AE79451"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_22h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22621.3155", "matchCriteriaId": "84EDBE52-EFE0-4D6D-AA76-698B6F9687D1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_23h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22631.3155", "matchCriteriaId": "900D1DA2-6DA7-4681-966A-B9973B1329EA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:-:sp2:*:*:*:*:*:*", "matchCriteriaId": "5F422A8C-2C4E-42C8-B420-E0728037E15C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:r2:*:*:*:*:*:*:*", "matchCriteriaId": "36559BC0-44D7-48B3-86FF-1BFF0257B5ED"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:-:*:*:*:*:*:*:*", "matchCriteriaId": "A7DF96F8-BA6A-4780-9CA3-F719B3F81074"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:r2:*:*:*:*:*:*:*", "matchCriteriaId": "DB18C4CE-5917-401E-ACF7-2747084FD36E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2016:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.14393.6709", "matchCriteriaId": "14F86494-7001-40DB-A99E-34A9490F5B58"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2019:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.17763.5458", "matchCriteriaId": "A9098F92-79E7-4762-A37C-99B4CFA8CDD1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.20348.2322", "matchCriteriaId": "5C8F0436-3AFE-48BD-AE92-8F8392DD0A1D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022_23h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.25398.709", "matchCriteriaId": "B6FCF1A0-6B8E-457A-AB6A-2DE939B9D18B"}]}]}], "references": [{"url": "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-21366", "source": "secure@microsoft.com", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-21366 - Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability. This vulnerability can be exploited using the Microsoft WDAC OLE DB provider for SQL Server, which is a trusted installer for Windows. Defense strategy against this can be to disable or restrict the use of the Microsoft WDAC OLE DB provider for SQL Server."}, {"techniqueID": "T1210", "comment": "CVE-2024-21366 - Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability. Similar to the previous technique, this vulnerability can also be exploited using the Microsoft WDAC OLE DB provider for SQL Server, which is a trusted installer for Windows."}, {"techniqueID": "T1566", "comment": "CVE-2024-21366 - Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability. This vulnerability can be exploited using the Microsoft WDAC OLE DB provider for SQL Server, which is a trusted installer for Windows, and could potentially be used to gain access to Windows systems."}], "stix_bundle": {"bundle": {"$id": "https://stix-ioa.idesio.com/bundles/cve-2024-21366", "version": "2.1", "title": "CVE-2024-21366 Bundle", "description": "Bundle containing information about the CVE-2024-21366 vulnerability and related techniques, risks, and defense strategies.", "objects": [{"type": "vulnerability", "id": "https://stix-ioa.idesio.com/objects/cve-2024-21366", "name": "Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability", "description": "A remote code execution vulnerability in the Microsoft WDAC OLE DB provider for SQL Server allows an attacker to execute arbitrary code on the system.", "severity": "HIGH", "impact_type": "EXECUTION", "affected_packages": [{"name": "Windows 10", "cpe23Uri": "cpe:2.3:o:microsoft:windows_10:10.0:*:*:*:*:*:*:*:*", "affected_versions": ["10.0.10240.20469"]}]}, {"type": "course-of-action", "id": "https://stix-ioa.idesio.com/objects/cve-2024-21366-defense-1", "name": "Disable Microsoft WDAC OLE DB provider for SQL Server", "description": "Disabling the Microsoft WDAC OLE DB provider for SQL Server can help prevent exploitation of this vulnerability.", "mitigates": ["https://stix-ioa.idesio.com/objects/cve-2024-21366"]}, {"type": "indicative", "id": "https://stix-ioa.idesio.com/objects/cve-2024-21366-indication", "name": "Indication of Compromise", "description": "An indication of compromise for this vulnerability can be identified by monitoring for unusual system activity or network traffic.", "detects": ["https://stix-ioa.idesio.com/objects/cve-2024-21366"], "course_of_actions": ["https://stix-ioa.idesio.com/objects/cve-2024-21366-defense-1"]}], "relationships": [{"relationship": "Mitigates", "sobject_ref": "https://stix-ioa.idesio.com/objects/cve-2024-21366-defense-1", "object_ref": "https://stix-ioa.idesio.com/objects/cve-2024-21366"}]}}, "technical_analysis": {"Introduction": "Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability is a remote code execution vulnerability in the Microsoft WDAC OLE DB provider for SQL Server that allows an attacker to execute arbitrary code on the system.", "Impact and Scope": "The vulnerability is rated as HIGH and affects Windows 10 systems with versions 10.0.10240.20469.", "Related MITRE ATT&CK Techniques": "The vulnerability can be exploited using the Microsoft WDAC OLE DB provider for SQL Server and could potentially be used to gain access to Windows systems.", "Technical Details": "The vulnerability occurs when the Microsoft WDAC OLE DB provider for SQL Server is not properly validated, allowing an attacker to execute arbitrary code on the system.", "Detection": "The vulnerability can be detected by monitoring for unusual system activity or network traffic.", "Mitigation": "Disabling the Microsoft WDAC OLE DB provider for SQL Server can help prevent exploitation of this vulnerability.", "Conclusion": "The Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability is a significant vulnerability that requires prompt attention and mitigation."}, "executive_analysis": {"Overview": "The Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability is a critical vulnerability that can be exploited to gain access to Windows systems.", "Business Impact": "Exploitation of this vulnerability can result in significant business disruption and financial loss.", "Technical Impact": "The vulnerability can be exploited using the Microsoft WDAC OLE DB provider for SQL Server, which is a trusted installer for Windows.", "Mitigation Strategies": "Disabling the Microsoft WDAC OLE DB provider for SQL Server and implementing regular security patches can help prevent exploitation of this vulnerability.", "Recommendations": "Executives should prioritize the mitigation of this vulnerability and ensure that regular security patches are implemented.", "Conclusions": "The Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability is a critical vulnerability that requires immediate attention and mitigation."}}