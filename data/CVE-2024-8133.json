{"id": "CVE-2024-8133", "sourceIdentifier": "cna@vuldb.com", "published": "2024-08-24T19:15:05.963", "lastModified": "2024-08-27T15:35:20.063", "vulnStatus": "Analyzed", "cveTags": [{"sourceIdentifier": "cna@vuldb.com", "tags": ["unsupported-when-assigned"]}], "descriptions": [{"lang": "en", "value": "A vulnerability was found in D-Link DNS-120, DNR-202L, DNS-315L, DNS-320, DNS-320L, DNS-320LW, DNS-321, DNR-322L, DNS-323, DNS-325, DNS-326, DNS-327L, DNR-326, DNS-340L, DNS-343, DNS-345, DNS-726-4, DNS-1100-4, DNS-1200-05 and DNS-1550-04 up to 20240814. It has been declared as critical. This vulnerability affects the function cgi_FMT_R5_SpareDsk_DiskMGR of the file /cgi-bin/hd_config.cgi of the component HTTP POST Request Handler. The manipulation of the argument f_source_dev leads to command injection. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. NOTE: This vulnerability only affects products that are no longer supported by the maintainer. NOTE: Vendor was contacted early and confirmed that the product is end-of-life. It should be retired and replaced."}, {"lang": "es", "value": "Se encontr\u00f3 una vulnerabilidad en D-Link DNS-120, DNR-202L, DNS-315L, DNS-320, DNS-320L, DNS-320LW, DNS-321, DNR-322L, DNS-323, DNS-325, DNS- 326, DNS-327L, DNR-326, DNS-340L, DNS-343, DNS-345, DNS-726-4, DNS-1100-4, DNS-1200-05 y DNS-1550-04 hasta 20240814. Ha sido declarada cr\u00edtica. Esta vulnerabilidad afecta a la funci\u00f3n cgi_FMT_R5_SpareDsk_DiskMGR del archivo /cgi-bin/hd_config.cgi del componente HTTP POST Request Handler. La manipulaci\u00f3n del argumento f_source_dev conduce a la inyecci\u00f3n de comandos. El ataque se puede iniciar de forma remota. El exploit ha sido divulgado al p\u00fablico y puede utilizarse. NOTA: Esta vulnerabilidad solo afecta a productos que ya no son compatibles con el fabricante. NOTA: Se contact\u00f3 primeramente con el proveedor y se confirm\u00f3 que el producto ha llegado al final de su vida \u00fatil. Deber\u00eda retirarse y reemplazarse."}], "metrics": {"cvssMetricV40": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "attackVector": "NETWORK", "attackComplexity": "LOW", "attackRequirements": "NONE", "privilegesRequired": "LOW", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "LOW", "vulnerableSystemIntegrity": "LOW", "vulnerableSystemAvailability": "LOW", "subsequentSystemConfidentiality": "NONE", "subsequentSystemIntegrity": "NONE", "subsequentSystemAvailability": "NONE", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NOT_DEFINED", "recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED", "baseScore": 5.3, "baseSeverity": "MEDIUM"}}], "cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-77"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-1550-04_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "B2C1EF70-AD9B-48D7-8DF6-A6416C517F12"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-1550-04:-:*:*:*:*:*:*:*", "matchCriteriaId": "E691E775-382C-4BA9-AA44-FBC3148D3E54"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-1200-05_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "42DA6DEB-3578-44A5-916F-1628141F0DDE"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-1200-05:-:*:*:*:*:*:*:*", "matchCriteriaId": "D042C75D-6731-46B2-B11E-A009B9029B3F"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-1100-4_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "7CAFE1E3-B705-4CF1-AEB9-A474432B6D34"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-1100-4:-:*:*:*:*:*:*:*", "matchCriteriaId": "D5D08ED7-3E7F-4D30-890E-6535F6C34682"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-726-4_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "2A74D270-9076-474D-A06F-C915FCEA2164"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-726-4:-:*:*:*:*:*:*:*", "matchCriteriaId": "75E5010F-21BA-4B6B-B00C-2688268FD67B"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-345_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "12C5E2D7-018E-4ED1-92C7-B5B1D8CC6990"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-345:-:*:*:*:*:*:*:*", "matchCriteriaId": "C7E56821-7EA0-4CA1-BA17-7FD4ED9F794C"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-343_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "DD656642-EDD4-4EB2-81AB-04207BC14196"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-343:-:*:*:*:*:*:*:*", "matchCriteriaId": "F968791D-D3BD-442C-818E-4E878B12776D"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-340l_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "39FF9666-8493-4A36-A199-1190AD8FAF3D"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-340l:-:*:*:*:*:*:*:*", "matchCriteriaId": "0646B20C-5642-4CEA-A96C-7E82AD94A281"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dnr-326_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "816E5F34-CE76-49E5-91F3-8CC84C561558"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dnr-326:-:*:*:*:*:*:*:*", "matchCriteriaId": "33CB308B-CF82-4E40-B2DC-23EBD48CD130"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-327l_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "172D5EFF-E0DF-4A99-8499-71450A46A86C"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-327l:-:*:*:*:*:*:*:*", "matchCriteriaId": "DB305B29-7F89-4A52-9ECF-3DB0BDD2350D"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-326_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "B5E6F048-D865-4378-87C7-B0E528134276"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-326:-:*:*:*:*:*:*:*", "matchCriteriaId": "D26F4F77-A6E3-4D7D-A781-BEB5FF7BC44F"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-325_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "16954393-3449-438A-978C-265EE3A35FF8"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-325:-:*:*:*:*:*:*:*", "matchCriteriaId": "8042169D-D9FA-4BD6-90D1-E0DE269E42B9"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-323_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "641CB5F1-3DE0-480B-95A4-FC42A8FF3C97"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-323:-:*:*:*:*:*:*:*", "matchCriteriaId": "94ED678A-AB4C-4637-B0D8-C232A0BB5D5F"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dnr-322l_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "AD3AD5EE-8E1E-4336-A1AB-AB028CC71286"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dnr-322l:-:*:*:*:*:*:*:*", "matchCriteriaId": "5DAF62A4-2429-4B89-8FAD-8B23EF15E050"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-321_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "DC28053F-88A9-4CA1-A2A2-CC90FEEA68FC"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-321:-:*:*:*:*:*:*:*", "matchCriteriaId": "2A278BC9-6197-43D9-93C2-3DF760856FB7"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-320lw_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "8FE78C5B-2A98-47EE-BF67-CF58AFE50A37"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-320lw:-:*:*:*:*:*:*:*", "matchCriteriaId": "45467ABC-BAA9-4EB0-9F97-92E31854CA8B"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-320l_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "4599D769-0210-4D49-9896-9AD1376A037E"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-320l:-:*:*:*:*:*:*:*", "matchCriteriaId": "6C677E53-6885-4EC4-A7CC-E24E8F445F59"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-320_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "4452F9A4-3A0A-4773-9818-04C94CF9F8E7"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-320:-:*:*:*:*:*:*:*", "matchCriteriaId": "A0F5355E-F68D-49FE-9793-1FD9BD9AF3E1"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-315l_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "A8CFCD7B-EFFB-4FAB-9537-46AC7B567126"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-315l:-:*:*:*:*:*:*:*", "matchCriteriaId": "03C5CED7-55A7-4026-95CD-A2ADB5853823"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dnr-202l_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "96195649-172A-4C21-AA15-7B05F86C5CEC"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dnr-202l:-:*:*:*:*:*:*:*", "matchCriteriaId": "07A92F2C-16FD-4A53-8066-83FEC2818DF5"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dns-120_firmware:-:*:*:*:*:*:*:*", "matchCriteriaId": "C44BE2C6-BF3E-43C3-B32F-2DCE756F94BC"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dns-120:-:*:*:*:*:*:*:*", "matchCriteriaId": "6E161E54-2FE9-4359-9B2D-8700D00DE8E7"}]}]}], "references": [{"url": "https://github.com/BuaaIOTTeam/Iot_Dlink_NAS/blob/main/DNS_cgi_FMT_R5_SpareDsk_DiskMGR.md", "source": "cna@vuldb.com", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://supportannouncement.us.dlink.com/security/publication.aspx?name=SAP10383", "source": "cna@vuldb.com", "tags": ["Vendor Advisory"]}, {"url": "https://vuldb.com/?ctiid.275704", "source": "cna@vuldb.com", "tags": ["Permissions Required", "VDB Entry"]}, {"url": "https://vuldb.com/?id.275704", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory", "VDB Entry"]}, {"url": "https://vuldb.com/?submit.396295", "source": "cna@vuldb.com", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://www.dlink.com/", "source": "cna@vuldb.com", "tags": ["Product"]}], "techniques": [{"techniqueID": "T1008", "comment": "CVE-2024-8133 - CGI RCE through crafted queries. This highlights the importance of validating user input and securing HTTP requests which are parsed by CGI scripts."}, {"techniqueID": "T1047", "comment": "CVE-2024-8133 - Insecure communication channel between devices. This emphasizes the need for secure connectivity between devices, especially when it involves sensitive data transfer."}, {"techniqueID": "T1504", "comment": "CVE-2024-8133 - Command injection through crafted queries. This demonstrates the risk of injecting malicious commands through vulnerable inputs and the importance of proper input validation."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle--dlink_dns_vuln", "objects": [{"type": "vulnerability", "id": "vulnerability--dlink_dns", "name": "D-Link DNS Vulnerability", "description": "A vulnerability in D-Link DNS devices allows for remote code execution", "severity": "HIGH", "cvss": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "score": 9.8}, "exploitability": {"score": 3.9}, "attacks": [{"id": "attack--cgi_rce", "description": "CGI RCE through crafted queries"}], "mitigations": [{"id": "mitigation--input_validation", "description": "Input validation on all user-provided data"}], "notes": [{"id": "note--secure_communication", "description": "Use secure communication channels between devices"}]}, {"type": "attack-pattern", "id": "attack_pattern--cgi_rce", "name": "CGI RCE", "description": "Exploit CGI RCE through crafted queries", "tactics": [{"id": "tactic--defense_evasion", "name": "Defense Evasion"}], "techniques": [{"id": "technique--T1008", "name": "CGI RCE through crafted queries"}]}, {"type": "mitigation", "id": "mitigation--input_validation", "name": "Input Validation", "description": "Input validation on all user-provided data", "mitigates": [{"id": "vulnerability--dlink_dns"}]}], "relationships": [{"id": "relationship--attack_pattern_to_vulnerability", "type": "attack-pattern", "id_ref": "vulnerability--dlink_dns", "type_ref": "vulnerability", "label": "Exploited By"}, {"id": "relationship--mitigation_to_vulnerability", "type": "mitigation", "id_ref": "vulnerability--dlink_dns", "type_ref": "vulnerability", "label": "Mitigates"}]}, "technical_analysis": {"Introduction": "D-Link DNS devices are vulnerable to remote code execution through crafted queries. This vulnerability allows an attacker to inject malicious commands and execute them on the affected device.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and is rated as HIGH severity. It allows for remote code execution and can lead to a complete takeover of the affected device.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1008, T1047, and T1504.", "Technical Details": "The vulnerability occurs due to unvalidated user input in the CGI scripts of the affected devices. An attacker can craft a malicious query and inject it into the CGI script, allowing for remote code execution.", "Detection": "Detection of this vulnerability is challenging, but it can be done by monitoring network traffic and looking for suspicious CGI queries.", "Mitigation": "The vulnerability can be mitigated by implementing input validation on all user-provided data. This can be done by configuring the affected devices to only allow trusted input and monitoring network traffic for suspicious activity.", "Conclusion": "The D-Link DNS vulnerability is a HIGH-severity vulnerability that can lead to remote code execution. It is essential to implement input validation and monitor network traffic to prevent exploitation."}, "executive_analysis": {"Overview": "A vulnerability has been discovered in D-Link DNS devices that can allow for remote code execution.", "Business Impact": "This vulnerability can lead to unauthorized access and data theft, and can result in significant financial losses.", "Technical Impact": "The vulnerability has a CVSS score of 9.8 and is rated as HIGH severity. It can lead to a complete takeover of the affected device and can result in significant technical harm.", "Mitigation Strategies": "Implement input validation on all user-provided data, and monitor network traffic for suspicious activity.", "Recommendations": "Recommend that all affected devices be updated with the latest firmware, and that input validation be implemented on all user-provided data.", "Conclusions": "The D-Link DNS vulnerability is a significant risk and requires immediate attention. Implementing input validation and monitoring network traffic are essential to preventing exploitation."}}