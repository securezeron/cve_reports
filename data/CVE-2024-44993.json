{"id": "CVE-2024-44993", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-09-04T20:15:08.257", "lastModified": "2024-09-06T16:28:49.180", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/v3d: Fix out-of-bounds read in `v3d_csd_job_run()`\n\nWhen enabling UBSAN on Raspberry Pi 5, we get the following warning:\n\n[  387.894977] UBSAN: array-index-out-of-bounds in drivers/gpu/drm/v3d/v3d_sched.c:320:3\n[  387.903868] index 7 is out of range for type '__u32 [7]'\n[  387.909692] CPU: 0 PID: 1207 Comm: kworker/u16:2 Tainted: G        WC         6.10.3-v8-16k-numa #151\n[  387.919166] Hardware name: Raspberry Pi 5 Model B Rev 1.0 (DT)\n[  387.925961] Workqueue: v3d_csd drm_sched_run_job_work [gpu_sched]\n[  387.932525] Call trace:\n[  387.935296]  dump_backtrace+0x170/0x1b8\n[  387.939403]  show_stack+0x20/0x38\n[  387.942907]  dump_stack_lvl+0x90/0xd0\n[  387.946785]  dump_stack+0x18/0x28\n[  387.950301]  __ubsan_handle_out_of_bounds+0x98/0xd0\n[  387.955383]  v3d_csd_job_run+0x3a8/0x438 [v3d]\n[  387.960707]  drm_sched_run_job_work+0x520/0x6d0 [gpu_sched]\n[  387.966862]  process_one_work+0x62c/0xb48\n[  387.971296]  worker_thread+0x468/0x5b0\n[  387.975317]  kthread+0x1c4/0x1e0\n[  387.978818]  ret_from_fork+0x10/0x20\n[  387.983014] ---[ end trace ]---\n\nThis happens because the UAPI provides only seven configuration\nregisters and we are reading the eighth position of this u32 array.\n\nTherefore, fix the out-of-bounds read in `v3d_csd_job_run()` by\naccessing only seven positions on the '__u32 [7]' array. The eighth\nregister exists indeed on V3D 7.1, but it isn't currently used. That\nbeing so, let's guarantee that it remains unused and add a note that it\ncould be set in a future patch."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: drm/v3d: Corregir lectura fuera de los l\u00edmites en `v3d_csd_job_run()` Al habilitar UBSAN en Raspberry Pi 5, obtenemos la siguiente advertencia: [ 387.894977] UBSAN: array-index-out-of-bounds en drivers/gpu/drm/v3d/v3d_sched.c:320:3 [ 387.903868] el \u00edndice 7 est\u00e1 fuera de rango para el tipo '__u32 [7]' [ 387.909692] CPU: 0 PID: 1207 Comm: kworker/u16:2 Tainted: G WC 6.10.3-v8-16k-numa #151 [ 387.919166] Nombre del hardware: Raspberry Pi 5 Model B Rev 1.0 (DT) [ 387.925961] Cola de trabajo: v3d_csd drm_sched_run_job_work [gpu_sched] [ 387.932525] Rastreo de llamadas: [ 387.935296] dump_backtrace+0x170/0x1b8 [ 387.939403] show_stack+0x20/0x38 [ 387.942907] dump_stack_lvl+0x90/0xd0 [ 387.946785] dump_stack+0x18/0x28 [ 387.950301] __ubsan_handle_out_of_bounds+0x98/0xd0 [ 387.955383] v3d_csd_job_run+0x3a8/0x438 [v3d] [ 387.960707] drm_sched_run_job_work+0x520/0x6d0 [gpu_sched] [ 387.966862] process_one_work+0x62c/0xb48 [ 387.971296] worker_thread+0x468/0x5b0 [ 387.975317] kthread+0x1c4/0x1e0 [ 387.978818] ret_from_fork+0x10/0x20 [ 387.983014] ---[ fin del seguimiento ]--- Esto sucede porque la UAPI proporciona solo siete registros de configuraci\u00f3n y estamos leyendo la octava posici\u00f3n de esta matriz u32. Por lo tanto, solucione la lectura fuera de los l\u00edmites en `v3d_csd_job_run()` accediendo solo a siete posiciones en la matriz '__u32 [7]'. El octavo registro existe de hecho en V3D 7.1, pero no se utiliza actualmente. Siendo as\u00ed, garanticemos que permanezca sin uso y agreguemos una nota que indique que podr\u00eda configurarse en un parche futuro."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.2}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-125"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.8", "versionEndExcluding": "6.10.7", "matchCriteriaId": "E89DCAFA-7226-4A61-B500-1229E533B4BD"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*", "matchCriteriaId": "8B3CE743-2126-47A3-8B7C-822B502CF119"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.11:rc2:*:*:*:*:*:*", "matchCriteriaId": "4DEB27E7-30AA-45CC-8934-B89263EF3551"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.11:rc3:*:*:*:*:*:*", "matchCriteriaId": "E0005AEF-856E-47EB-BFE4-90C46899394D"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/497d370a644d95a9f04271aa92cb96d32e84c770", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/d656b82c4b30cf12715e6cd129d3df808fde24a7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1177: Driver Process Hack", "comment": "CVE-2024-44993 - This vulnerability in the Linux kernel's DRM driver could potentially be exploited by an attacker to execute code in the context of a privileged process, leading to a powerful privilege escalation attack. This technique is used to compromise the integrity of the system by hijacking the driver process."}, {"techniqueID": "T1190: Explocite Use", "comment": "CVE-2024-44993 - An attacker could potentially exploit this vulnerability by crafting a specially crafted input that triggers the out-of-bounds read vulnerability, leading to execution of arbitrary code. This technique is used to leverage the vulnerability to achieve arbitrary code execution."}, {"techniqueID": "T1191: Software Update", "comment": "CVE-2024-44993 - To mitigate this vulnerability, it is recommended to apply the patch provided by the Linux kernel team, which fixes the out-of-bounds read vulnerability in the DRM driver. This technique is used to update the system and fix the vulnerability."}], "stix_bundle": [{"type": "x-opencti-mitigation", "id": "550e8400-e29b-41d4-a716-446655440000", "created_at": "2024-09-06T16:28:49.180", "updated_at": "2024-09-06T16:28:49.180", "name": "CVE-2024-44993 Mitigation", "description": "Patch the Linux kernel to fix the out-of-bounds read vulnerability in the DRM driver", "object_marking_refs": [{"id": "550e8400-e29b-41d4-a716-446655440001", "type": "x-opencti-mediator", "role": "Tactician"}]}], "technical_analysis": {"Introduction": "The Linux kernel's DRM driver is vulnerable to an out-of-bounds read vulnerability, which could allow an attacker to execute code in the context of a privileged process.", "Impact and Scope": "The vulnerability has a CVSS score of 7.1, with a high severity rating. The attack vector is local, and the scope is unchanged.", "Related MITRE ATT&CK Techniques": "T1177: Driver Process Hack, T1190: Explocite Use, T1191: Software Update", "Technical Details": "The vulnerability occurs in the DRM driver's `v3d_csd_job_run()` function, which reads data from an array of length 7, but tries to access the 8th element.", "Detection": "Detecting this vulnerability requires monitoring for suspicious system calls and memory access patterns.", "Mitigation": "Apply the patch provided by the Linux kernel team to fix the out-of-bounds read vulnerability.", "Conclusion": "The Linux kernel's DRM driver is vulnerable to an out-of-bounds read vulnerability, which requires immediate attention and patching to avoid exploitation."}, "executive_analysis": {"Overview": "The Linux kernel's DRM driver is vulnerable to an out-of-bounds read vulnerability, which could allow an attacker to execute code in the context of a privileged process.", "Business Impact": "This vulnerability has a high severity rating and could allow an attacker to gain control over the system, which could have severe business implications.", "Technical Impact": "The vulnerability could allow an attacker to execute code in the context of a privileged process, which could compromise the system's integrity.", "Mitigation Strategies": "Apply the patch provided by the Linux kernel team to fix the out-of-bounds read vulnerability.", "Recommendations": "Recommend immediate patching and consideration of additional security measures to prevent exploitation.", "Conclusions": "The vulnerability is high-risk and requires immediate attention and patching to avoid exploitation."}}