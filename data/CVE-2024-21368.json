{"id": "CVE-2024-21368", "sourceIdentifier": "secure@microsoft.com", "published": "2024-02-13T18:15:54.263", "lastModified": "2024-05-29T00:15:29.413", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability"}, {"lang": "es", "value": "Proveedor Microsoft WDAC OLE DB para la vulnerabilidad de ejecuci\u00f3n remota de c\u00f3digo de SQL Server"}], "metrics": {"cvssMetricV31": [{"source": "secure@microsoft.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "secure@microsoft.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-122"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1507:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.10240.20469", "matchCriteriaId": "448534CE-1C07-4DF1-8EDD-C43C3492898B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1607:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.14393.6709", "matchCriteriaId": "2D282E53-ABBF-4832-9C93-A988586AE96E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1809:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.17763.5458", "matchCriteriaId": "A1689DFD-D52D-4121-BFD7-DBF2BE4E7DE8"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_21h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.19044.4046", "matchCriteriaId": "C78776CC-3A9C-41A3-8BEB-D71D92F6579D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_22h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.19045.4046", "matchCriteriaId": "806CA6D2-42B2-4244-A5ED-D23E6DD56772"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_21h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22000.2777", "matchCriteriaId": "3F7F8173-9E59-48E4-98C9-4BEB6AE79451"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_22h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22621.3155", "matchCriteriaId": "84EDBE52-EFE0-4D6D-AA76-698B6F9687D1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_23h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22631.3155", "matchCriteriaId": "900D1DA2-6DA7-4681-966A-B9973B1329EA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:-:sp2:*:*:*:*:*:*", "matchCriteriaId": "5F422A8C-2C4E-42C8-B420-E0728037E15C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:r2:*:*:*:*:*:*:*", "matchCriteriaId": "36559BC0-44D7-48B3-86FF-1BFF0257B5ED"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:-:*:*:*:*:*:*:*", "matchCriteriaId": "A7DF96F8-BA6A-4780-9CA3-F719B3F81074"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:r2:*:*:*:*:*:*:*", "matchCriteriaId": "DB18C4CE-5917-401E-ACF7-2747084FD36E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2016:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.14393.6709", "matchCriteriaId": "14F86494-7001-40DB-A99E-34A9490F5B58"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2019:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.17763.5458", "matchCriteriaId": "A9098F92-79E7-4762-A37C-99B4CFA8CDD1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.20348.2322", "matchCriteriaId": "5C8F0436-3AFE-48BD-AE92-8F8392DD0A1D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022_23h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.25398.709", "matchCriteriaId": "B6FCF1A0-6B8E-457A-AB6A-2DE939B9D18B"}]}]}], "references": [{"url": "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-21368", "source": "secure@microsoft.com", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-21368 - This technique can be used to exploit the vulnerable OLE DB provider in Microsoft WDAC, allowing an attacker to execute remote code. Defending against this involves configuring the OLE DB provider correctly and implementing appropriate security measures."}, {"techniqueID": "T1210", "comment": "CVE-2024-21368 - This technique can be used to exploit the vulnerable OLE DB provider in Microsoft WDAC, allowing an attacker to execute remote code. Defending against this involves configuring the OLE DB provider correctly and implementing appropriate security measures."}, {"techniqueID": "T1196", "comment": "CVE-2024-21368 - This technique can be used to exploit the vulnerable OLE DB provider in Microsoft WDAC, allowing an attacker to execute remote code. Defending against this involves configuring the OLE DB provider correctly and implementing appropriate security measures."}], "stix_bundle": "{\"bundle\": {\"generated_by\": \"[ Your System ]\", \"schema_version\": \"2.1\", \"id\": \"[ Your System ]:CVE-2024-21368\", \"type\": \"bundle\", \"created_by_ref\": \"vulnerability:CVE-2024-21368\", \"created\": \"2024-02-13T18:15:54.263\", \"modified\": \"2024-05-29T00:15:29.413\", \"stix_core_components\": [\"vulnerability:CVE-2024-21368\"], \"vulnerability:CVE-2024-21368\": {\"id\": \"CVE-2024-21368\", \"type\": \"vulnerability\", \"confidence\": \"high\", \"difficulty\": \"medium\", \"created\": \"2024-02-13T18:15:54.263\", \"modified\": \"2024-05-29T00:15:29.413\", \"description\": \"Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability\"}, \"notes\": [\"This vulnerability affects multiple Windows versions, including Windows 10, Windows 11, Windows Server 2008, Windows Server 2012, Windows Server 2016, and Windows Server 2022.\", \"It is recommended to apply the available patches and to configure the OLE DB provider correctly to mitigate this vulnerability.\", \"Vulnerability scanners and threat intelligence platforms should be updated to detect this vulnerability.\", \"The exploitability score is 2.8 out of 10, and the impact score is 5.9 out of 10.\", \"The vulnerability is rated 8.8 out of 10 in terms of CVSS score.\"]}", "technical_analysis": {"Introduction": "The Microsoft WDAC OLE DB provider for SQL Server is vulnerable to remote code execution due to an out-of-bounds write in the OLE DB provider\\'s handling of OLE DB requests. This vulnerability is considered critical and should be treated as high-priority.", "Impact and Scope": "This vulnerability affects multiple Windows versions, including Windows 10, Windows 11, Windows Server 2008, Windows Server 2012, Windows Server 2016, and Windows Server 2022. It is rated 8.8 out of 10 in terms of CVSS score, and the exploitability score is 2.8 out of 10, and the impact score is 5.9 out of 10.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to several MITRE ATT&CK techniques, including T1190, T1210, and T1196.", "Technical Details": "The vulnerability occurs due to an out-of-bounds write in the OLE DB provider's handling of OLE DB requests. An attacker can exploit this vulnerability by crafting a malicious OLE DB request that results in a buffer overflow, allowing them to execute arbitrary code.", "Detection": "Detecting this vulnerability involves monitoring for suspicious access to the OLE DB provider and monitoring for attempts to execute arbitrary code. This can be achieved through the use of vulnerability scanners and threat intelligence platforms.", "Mitigation": "The best way to mitigate this vulnerability is to apply the available patches and to configure the OLE DB provider correctly. This can be achieved through the use of Microsoft's recommended mitigation steps.", "Conclusion": "In conclusion, the Microsoft WDAC OLE DB provider for SQL Server is vulnerable to remote code execution due to an out-of-bounds write in the OLE DB provider's handling of OLE DB requests. This vulnerability is considered critical and should be treated as high-priority."}, "executive_analysis": {"Overview": "The Microsoft WDAC OLE DB provider for SQL Server is vulnerable to remote code execution due to an out-of-bounds write in the OLE DB provider's handling of OLE DB requests.", "Business Impact": "This vulnerability has significant business impact as it allows an attacker to execute arbitrary code, potentially leading to data theft or manipulation.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows an attacker to execute arbitrary code, potentially leading to data theft or manipulation.", "Mitigation Strategies": "The best way to mitigate this vulnerability is to apply the available patches and to configure the OLE DB provider correctly.", "Recommendations": "We recommend that all organizations that use the OLE DB provider implement the recommended mitigation steps as soon as possible.", "Conclusions": "In conclusion, the Microsoft WDAC OLE DB provider for SQL Server is vulnerable to remote code execution due to an out-of-bounds write in the OLE DB provider's handling of OLE DB requests. This vulnerability is considered critical and should be treated as high-priority."}}