{"id": "CVE-2024-24577", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-06T22:16:15.270", "lastModified": "2024-02-27T10:15:08.137", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "libgit2 is a portable C implementation of the Git core methods provided as a linkable library with a solid API, allowing to build Git functionality into your application. Using well-crafted inputs to `git_index_add` can cause heap corruption that could be leveraged for arbitrary code execution. There is an issue in the `has_dir_name` function in `src/libgit2/index.c`, which frees an entry that should not be freed. The freed entry is later used and overwritten with potentially bad actor-controlled data leading to controlled heap corruption. Depending on the application that uses libgit2, this could lead to arbitrary code execution. This issue has been patched in version 1.6.5 and 1.7.2."}, {"lang": "es", "value": "libgit2 es una implementaci\u00f3n C port\u00e1til de los m\u00e9todos principales de Git proporcionada como una librer\u00eda vinculable con una API s\u00f3lida, que permite incorporar la funcionalidad de Git en su aplicaci\u00f3n. El uso de entradas bien manipuladas para `git_index_add` puede provocar da\u00f1os en el almacenamiento din\u00e1mico que podr\u00edan aprovecharse para la ejecuci\u00f3n de c\u00f3digo arbitrario. Hay un problema en la funci\u00f3n `has_dir_name` en `src/libgit2/index.c`, que libera una entrada que no deber\u00eda liberarse. La entrada liberada se utiliza posteriormente y se sobrescribe con datos controlados por actores potencialmente malos, lo que conduce a una corrupci\u00f3n controlada de almacenamiento din\u00e1mico. Dependiendo de la aplicaci\u00f3n que utilice libgit2, esto podr\u00eda provocar la ejecuci\u00f3n de c\u00f3digo arbitrario. Este problema se solucion\u00f3 en las versiones 1.6.5 y 1.7.2."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 8.6, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 4.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-122"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:libgit2:libgit2:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.6.5", "matchCriteriaId": "AB8F928B-1059-4B60-877B-AAECE739B575"}, {"vulnerable": true, "criteria": "cpe:2.3:a:libgit2:libgit2:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.7.0", "versionEndExcluding": "1.7.2", "matchCriteriaId": "E036286C-1FDD-47D7-89BA-5A436B2E72DF"}]}]}], "references": [{"url": "https://github.com/libgit2/libgit2/releases/tag/v1.6.5", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/libgit2/libgit2/releases/tag/v1.7.2", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/libgit2/libgit2/security/advisories/GHSA-j2v7-4f6v-gpg8", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2024/02/msg00012.html", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4M3P7WIEPXNRLBINQRJFXUSTNKBCHYC7/", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/7CNDW3PF6NHO7OXNM5GN6WSSGAMA7MZE/", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/S635BGHHZUMRPI7QOXOJ45QHDD5FFZ3S/", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/Z6MXOX7I43OWNN7R6M54XLG6U5RXY244/", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZGNHOEE2RBLH7KCJUPUNYG4CDTW4HTBT/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-24577 - This vulnerability could be exploited using Heap-based Buffer Overflow, which is a common vector of attack. Defense strategies include using memory protection mechanisms like ASLR, DEP, and stack canary."}, {"techniqueID": "T1224", "comment": "CVE-2024-24577 - The vulnerability in the `has_dir_name` function can be exploited using memory corruption techniques. Defense strategies include performing memory sanitization and validation checks."}, {"techniqueID": "T1076", "comment": "CVE-2024-24577 - The vulnerability might be used to execute arbitrary code, which is a common goal of many attackers. Defense strategies include limiting system privileges and implementing a strict memory access control policy."}, {"techniqueID": "T1201", "comment": "CVE-2024-24577 - The vulnerability can be exploited using a crafted input to the `git_index_add` function. Defense strategies include implementing input validation and sanitization checks."}], "technical_analysis": {"Introduction": "CVE-2024-24577 is a heap corruption vulnerability in libgit2's index functions. It can be exploited using crafted inputs to the `git_index_add` function.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). It can be exploited by an attacker to execute arbitrary code, which could potentially allow them to gain access to sensitive data or control the system.", "Related MITRE ATT&CK Techniques": "T1190, T1224, T1076, and T1201", "Technical Details": "The vulnerability occurs in the `has_dir_name` function in `src/libgit2/index.c`, which frees an entry that should not be freed, leading to a heap corruption.", "Detection": "Detecting this vulnerability will require a combination of static and dynamic analysis of the affected code. Static analysis can identify potential vulnerabilities, while dynamic analysis can detect exploitation attempts.", "Mitigation": "Mitigation strategies include patching the affected code, restricting system privileges, and implementing memory protection mechanisms like ASLR, DEP, and stack canary.", "Conclusion": "In conclusion, CVE-2024-24577 is a critical vulnerability that requires immediate attention. Early patching and mitigation efforts can help prevent exploitation and minimize potential damage."}, "executive_analysis": {"Overview": "CVE-2024-24577 is a critical heap corruption vulnerability in libgit2 that can be exploited to execute arbitrary code.", "Business Impact": "This vulnerability has significant business implications, as it can be exploited to gain access to sensitive data or control the system. It is essential to prioritize patching and mitigation efforts to minimize potential damage.", "Technical Impact": "The vulnerability can have significant technical implications, as it can impact the security and integrity of affected systems.", "Mitigation Strategies": "High-level mitigation strategies include patching the affected code, restricting system privileges, and implementing memory protection mechanisms like ASLR, DEP, and stack canary.", "Recommendations": "Recommendations for executives include prioritizing patching and mitigation efforts, conducting regular vulnerability assessments, and implementing memory protection mechanisms.", "Conclusions": "In conclusion, CVE-2024-24577 is a critical vulnerability that requires immediate attention and priority action. Executives should ensure that patching and mitigation efforts are prioritized to minimize potential damage."}}