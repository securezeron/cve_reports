{"id": "CVE-2015-4116", "sourceIdentifier": "cve@mitre.org", "published": "2016-05-16T10:59:04.720", "lastModified": "2023-11-07T02:25:47.093", "vulnStatus": "Modified", "cveTags": [], "evaluatorComment": "<a href=\"http://cwe.mitre.org/data/definitions/416.html\">CWE 416: Use After Free</a>", "descriptions": [{"lang": "en", "value": "Use-after-free vulnerability in the spl_ptr_heap_insert function in ext/spl/spl_heap.c in PHP before 5.5.27 and 5.6.x before 5.6.11 allows remote attackers to execute arbitrary code by triggering a failed SplMinHeap::compare operation."}, {"lang": "es", "value": "Vulnerabilidad de uso despu\u00e9s de liberaci\u00f3n de memoria en la funci\u00f3n spl_ptr_heap_insert en ext/spl/spl_heap.c en PHP en versiones anteriores a 5.5.27 y 5.6.x en versiones anteriores a 5.6.11 permite a atacantes remotos ejecutar c\u00f3digo arbitrario desencadenando una operaci\u00f3n SplMinHeap::compare fallida."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": true, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:42.1:*:*:*:*:*:*:*", "matchCriteriaId": "4863BE36-D16A-4D75-90D9-FD76DB5B48B7"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionEndIncluding": "5.5.26", "matchCriteriaId": "C5DF38E1-F412-425F-A7CB-1AB4C2CEE523"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.6.0:*:*:*:*:*:*:*", "matchCriteriaId": "CE65D0D4-CB56-4946-AB44-2EF554602A96"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.6.1:*:*:*:*:*:*:*", "matchCriteriaId": "F1F13E2D-A8F7-4B74-8D03-7905C81672C9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.6.2:*:*:*:*:*:*:*", "matchCriteriaId": "AE18933A-5FE6-41C7-B1B6-DA3E762C3FB6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.6.3:*:*:*:*:*:*:*", "matchCriteriaId": "9AE1289F-03A6-4621-B387-5F5ADAC4AE92"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.6.4:*:*:*:*:*:*:*", "matchCriteriaId": "383697F5-D29E-475A-84F3-46B54A928889"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.6.5:*:*:*:*:*:*:*", "matchCriteriaId": "786ED182-5D71-4197-9196-12AB5CF05F85"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.6.6:*:*:*:*:*:*:*", "matchCriteriaId": "BF90980D-74AD-44AA-A7C5-A0B294CCE4F8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.6.7:*:*:*:*:*:*:*", "matchCriteriaId": "48D6B69C-8F27-4F4C-B953-67A7F9C2FBA5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.6.8:*:*:*:*:*:*:*", "matchCriteriaId": "B53DC0C3-EA19-4465-B65A-BC7CDB10D8BF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.6.9:*:*:*:*:*:*:*", "matchCriteriaId": "BEA4DFC1-6C0C-42FB-9F47-E3E1AA9E47E0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.6.10:*:*:*:*:*:*:*", "matchCriteriaId": "D904E21A-4B3B-4D96-850C-0C0315F14E6D"}]}]}], "references": [{"url": "http://git.php.net/?p=php-src.git%3Ba=commit%3Bh=1cbd25ca15383394ffa9ee8601c5de4c0f2f90e1", "source": "cve@mitre.org"}, {"url": "http://lists.opensuse.org/opensuse-updates/2016-06/msg00027.html", "source": "cve@mitre.org"}, {"url": "http://php.net/ChangeLog-5.php", "source": "cve@mitre.org"}, {"url": "https://bugs.php.net/bug.php?id=69737", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://www.htbridge.com/advisory/HTB23262", "source": "cve@mitre.org", "tags": ["Exploit"]}], "techniques": [{"techniqueID": "T1194", "comment": "CVE-2015-4116 - A use-after-free vulnerability can be exploited by an attacker to execute arbitrary code. This technique is relevant because it shows how an attacker can leverage a vulnerable application to execute malicious code. Defending against this technique involves patching the vulnerable application and restricting access to sensitive areas of the application."}, {"techniqueID": "T1188", "comment": "CVE-2015-4116 - An unauthenticated attacker can trigger a SplMinHeap::compare operation, which can be used to execute arbitrary code. This technique is relevant because it highlights the importance of proper input validation and sanitization in preventing use-after-free attacks."}, {"techniqueID": "T1027", "comment": "CVE-2015-4116 - A vulnerable PHP application can be exploited to execute arbitrary code, allowing an attacker to gain control of the system. This technique is relevant because it emphasizes the importance of keeping software up-to-date and applying security patches."}, {"techniqueID": "T1190", "comment": "CVE-2015-4116 - An attacker can exploit a use-after-free vulnerability in a PHP application to execute arbitrary code. This technique is relevant because it shows how an attacker can leverage a vulnerable application to pivot to other systems or applications."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "Indicator--1", "created_by_ref": "identity--1", "modified": "2023-11-07T02:25:47.093", "name": "CVE-2015-4116 Indicator", "description": "Indicator for CVE-2015-4116", "created": "2016-05-16T10:59:04.720", "modified_by_ref": "identity--1", "relationships": [{"type": "has_note", "attribute": "note"}], "notes": [{"type": "note", "id": "Note--1", "text": "This indicator detects potential exploitation of CVE-2015-4116"}]}, {"type": "course_of_action", "id": "Course_of_Action--1", "created_by_ref": "identity--1", "modified": "2023-11-07T02:25:47.093", "name": "Apply Security Patch for CVE-2015-4116", "description": "Apply security patch for CVE-2015-4116", "created": "2016-05-16T10:59:04.720", "modified_by_ref": "identity--1", "relationships": [{"type": "mitigates", "technique_id": "T1194"}]}]}, "technical_analysis": {"Introduction": "CVE-2015-4116 is a use-after-free vulnerability in PHP's spl_ptr_heap_insert function, which can be exploited by an attacker to execute arbitrary code.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8, indicating a high severity impact. The attack vector is Network, and the privileges required are None.", "Related MITRE ATT&CK Techniques": "T1194, T1188, T1027, and T1190", "Technical Details": "The vulnerability occurs when a session is closed, freeing memory, and then an attacker can trigger the SplMinHeap::compare operation, causing the freed memory to be overwritten, allowing an attacker to execute arbitrary code.", "Detection": "Detection involves monitoring process memory and network traffic for suspicious patterns.", "Mitigation": "Apply security patch for CVE-2015-4116 and restrict access to sensitive areas of the application.", "Conclusion": "CVE-2015-4116 is a high-severity vulnerability that can be exploited to execute arbitrary code, and it is essential to apply security patches and restrict access to sensitive areas of the application."}, "executive_analysis": {"Overview": "CVE-2015-4116 is a high-severity vulnerability in PHP that can be exploited to execute arbitrary code.", "Business Impact": "This vulnerability could potentially lead to significant business disruptions and data breaches if exploited.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary code, which can lead to a loss of sensitive data and compromise of system integrity.", "Mitigation Strategies": "Apply security patches and restrict access to sensitive areas of the application.", "Recommendations": "All PHP applications should be updated to the latest version, and access to sensitive areas of the application should be restricted.", "Conclusions": "CVE-2015-4116 is a critical vulnerability that requires immediate attention and action to prevent exploitation."}}