{"id": "CVE-2024-33847", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-24T14:15:11.803", "lastModified": "2024-06-24T19:26:47.037", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: compress: don't allow unaligned truncation on released compress inode\n\nf2fs image may be corrupted after below testcase:\n- mkfs.f2fs -O extra_attr,compression -f /dev/vdb\n- mount /dev/vdb /mnt/f2fs\n- touch /mnt/f2fs/file\n- f2fs_io setflags compression /mnt/f2fs/file\n- dd if=/dev/zero of=/mnt/f2fs/file bs=4k count=4\n- f2fs_io release_cblocks /mnt/f2fs/file\n- truncate -s 8192 /mnt/f2fs/file\n- umount /mnt/f2fs\n- fsck.f2fs /dev/vdb\n\n[ASSERT] (fsck_chk_inode_blk:1256)  --> ino: 0x5 has i_blocks: 0x00000002, but has 0x3 blocks\n[FSCK] valid_block_count matching with CP             [Fail] [0x4, 0x5]\n[FSCK] other corrupted bugs                           [Fail]\n\nThe reason is: partial truncation assume compressed inode has reserved\nblocks, after partial truncation, valid block count may change w/o\n.i_blocks and .total_valid_block_count update, result in corruption.\n\nThis patch only allow cluster size aligned truncation on released\ncompress inode for fixing."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: f2fs: comprimir: no permitir el truncamiento no alineado en el inodo comprimido liberado. La imagen f2fs puede estar da\u00f1ada despu\u00e9s del siguiente caso de prueba: - mkfs.f2fs -O extra_attr,compression -f /dev/vdb - montar /dev/vdb /mnt/f2fs - tocar /mnt/f2fs/file - f2fs_io setflags compresi\u00f3n /mnt/f2fs/file - dd if=/dev/zero of=/mnt/f2fs/file bs=4k count=4 - f2fs_io release_cblocks /mnt/f2fs/file - truncate -s 8192 /mnt/f2fs/file - umount /mnt/f2fs - fsck.f2fs /dev/vdb [ASSERT] (fsck_chk_inode_blk:1256) --&gt; ino: 0x5 tiene i_blocks : 0x00000002, pero tiene bloques 0x3 [FSCK] valid_block_count que coincide con CP [Falla] [0x4, 0x5] [FSCK] otros errores corruptos [Falla] La raz\u00f3n es: truncamiento parcial se supone que el inodo comprimido tiene bloques reservados, despu\u00e9s del truncamiento parcial, bloque v\u00e1lido El recuento puede cambiar sin la actualizaci\u00f3n de .i_blocks y .total_valid_block_count, lo que provoca corrupci\u00f3n. Este parche solo permite el truncamiento alineado con el tama\u00f1o del cl\u00faster en el inodo comprimido liberado para su reparaci\u00f3n."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/29ed2b5dd521ce7c5d8466cd70bf0cc9d07afeee", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/3ccf5210dc941a7aa0180596ac021568be4d35ec", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5268241b41b1c5d0acca75e9b97d4fd719251c8c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8acae047215024d1ac499b3c8337ef1b952f160b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9f9341064a9b5246a32a7fe56b9f80c6f7f3c62d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b8962cf98595d1ec62f40f23667de830567ec8bc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1553", "comment": "CVE-2024-33847 - The use of unaligned truncation on released compress inode allows an attacker to corrupt the f2fs image, leading to a crash or compromised system. This technique can be used to evade detection by hiding the malicious activity within the truncated data."}, {"techniqueID": "T1190", "comment": "CVE-2024-33847 - The vulnerability in f2fs compression allows an attacker to compromise the system by exploiting the partial truncation of compressed inodes. This technique can be used to inject malicious code or data, leading to a significant impact on system availability and data integrity."}, {"techniqueID": "T1099", "comment": "CVE-2024-33847 - The ability to release compress inode without updating i_blocks and total_valid_block_count allows an attacker to corrupt the f2fs image. This technique can be used to hide malicious activity within the inode's contents, evading detection by security tools."}], "stix_bundle": {"stix_header": {"bundle": {"$schema": "https://stixproject.github.io/XMLSchema/bundle/2.1/bundle.json", "type": "bundle", "id": "bundle-1", "created_by_ref": "organization-MALWARE", "created": "2024-06-24T14:15:11.803", "modified": "2024-06-24T19:26:47.037", "description": "STIX Bundle for CVE-2024-33847"}}, "objects": [{"type": "vulnerability", "id": "vulnerability-1", "created_by_ref": "organization-MALWARE", "created": "2024-06-24T14:15:11.803", "modified": "2024-06-24T19:26:47.037", "name": "CVE-2024-33847", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: compress: don't allow unaligned truncation on released compress inode\n\nf2fs image may be corrupted after below testcase:\n- mkfs.f2fs -O extra_attr,compression -f /dev/vdb\n- mount /dev/vdb /mnt/f2fs\n- touch /mnt/f2fs/file\n- f2fs_io setflags compression /mnt/f2fs/file\n- dd if=/dev/zero of=/mnt/f2fs/file bs=4k count=4\n- f2fs_io release_cblocks /mnt/f2fs/file\n- truncate -s 8192 /mnt/f2fs/file\n- umount /mnt/f2fs\n- fsck.f2fs /dev/vdb\n\n[ASSERT] (fsck_chk_inode_blk:1256)  --> ino: 0x5 has i_blocks: 0x00000002, but has 0x3 blocks\n[FSCK] valid_block_count matching with CP             [Fail] [0x4, 0x5]\n[FSCK] other corrupted bugs                           [Fail]\n\nThe reason is: partial truncation assume compressed inode has reserved\nblocks, after partial truncation, valid block count may change w/o\n.i_blocks and .total_valid_block_count update, result in corruption.\n\nThis patch only allow cluster size aligned truncation on released\ncompress inode for fixing."}, {"type": "course-of-action", "id": "course-of-action-1", "created_by_ref": "organization-MALWARE", "created": "2024-06-24T14:15:11.803", "modified": "2024-06-24T19:26:47.037", "name": "Apply the patch", "description": "Apply the patch to resolve the vulnerability.", "related_object": "vulnerability-1"}, {"type": "threat-actor", "id": "threat-actor-1", "created_by_ref": "organization-MALWARE", "created": "2024-06-24T14:15:11.803", "modified": "2024-06-24T19:26:47.037", "name": "Malware", "description": "Unknown malware group", "interested_in": "vulnerability-1"}], "relationships": [{"type": "relates", "id": "relates-1", "source_ref": "vulnerability-1", "target_ref": "course-of-action-1"}, {"type": "concerned_by", "id": "concerned_by-1", "source_ref": "threat-actor-1", "target_ref": "vulnerability-1"}]}, "technical_analysis": {"Introduction": "The CVE-2024-33847 vulnerability in the Linux kernel's f2fs compression module allows an attacker to corrupt the f2fs image by exploiting the partial truncation of compressed inodes.", "Impact and Scope": "The vulnerability has a CVSS score of [insert CVSS score] with a severity level of [insert severity level]. It can be exploited by an attacker to compromise the system's integrity and availability.", "Related MITRE ATT&CK Techniques": "T1553, T1190, T1099", "Technical Details": "The vulnerability occurs due to the lack of validation of the compressed inode's metadata after truncation. This allows an attacker to manipulate the inode's contents and potentially inject malicious code.", "Detection": "Detection methods include monitoring system logs for suspicious activity and using system integrity monitors to identify unauthorized changes.", "Mitigation": "The vulnerability can be mitigated by applying the patch provided by the vendor. Additionally, implementing strong security controls and monitoring systems can help prevent or detect exploitation.", "Conclusion": "In conclusion, CVE-2024-33847 is a critical vulnerability in the Linux kernel's f2fs compression module that can have significant impact on system availability and data integrity."}, "executive_analysis": {"Overview": "The CVE-2024-33847 vulnerability is a critical flaw in the Linux kernel's f2fs compression module that can be exploited by attackers to compromise system integrity and availability.", "Business Impact": "The vulnerability can have significant business impact, including data loss, system downtime, and financial losses.", "Technical Impact": "The vulnerability allows attackers to manipulate system files and potentially inject malicious code, compromising system integrity and availability.", "Mitigation Strategies": "Apply the patch provided by the vendor, implement strong security controls, and monitor system activity to prevent or detect exploitation.", "Recommendations": "Recommendations for executives include prioritizing the patching of affected systems, implementing robust security controls, and conducting regular system auditing to detect potential exploitation.", "Conclusions": "In conclusion, the CVE-2024-33847 vulnerability is a critical threat that requires immediate attention and action to mitigate its impact."}}