{"id": "CVE-2024-36962", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-03T08:15:09.740", "lastModified": "2024-06-03T14:46:24.250", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: ks8851: Queue RX packets in IRQ handler instead of disabling BHs\n\nCurrently the driver uses local_bh_disable()/local_bh_enable() in its\nIRQ handler to avoid triggering net_rx_action() softirq on exit from\nnetif_rx(). The net_rx_action() could trigger this driver .start_xmit\ncallback, which is protected by the same lock as the IRQ handler, so\ncalling the .start_xmit from netif_rx() from the IRQ handler critical\nsection protected by the lock could lead to an attempt to claim the\nalready claimed lock, and a hang.\n\nThe local_bh_disable()/local_bh_enable() approach works only in case\nthe IRQ handler is protected by a spinlock, but does not work if the\nIRQ handler is protected by mutex, i.e. this works for KS8851 with\nParallel bus interface, but not for KS8851 with SPI bus interface.\n\nRemove the BH manipulation and instead of calling netif_rx() inside\nthe IRQ handler code protected by the lock, queue all the received\nSKBs in the IRQ handler into a queue first, and once the IRQ handler\nexits the critical section protected by the lock, dequeue all the\nqueued SKBs and push them all into netif_rx(). At this point, it is\nsafe to trigger the net_rx_action() softirq, since the netif_rx()\ncall is outside of the lock that protects the IRQ handler."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net: ks8851: Cola de paquetes RX en el controlador IRQ en lugar de deshabilitar los BH Actualmente, el controlador usa local_bh_disable()/local_bh_enable() en su controlador IRQ para evitar activar el softirq net_rx_action() al salir de netif_rx(). net_rx_action() podr\u00eda activar esta devoluci\u00f3n de llamada del controlador .start_xmit, que est\u00e1 protegido por el mismo candado que el controlador IRQ, por lo que llamar al .start_xmit desde netif_rx() desde la secci\u00f3n cr\u00edtica del controlador IRQ protegido por el bloqueo podr\u00eda llevar a un intento de reclamar el candado ya reclamado y un colgado. El enfoque local_bh_disable()/local_bh_enable() funciona s\u00f3lo en caso de que el controlador IRQ est\u00e9 protegido por un spinlock, pero no funciona si el controlador IRQ est\u00e1 protegido por mutex, es decir, esto funciona para KS8851 con interfaz de bus paralelo, pero no para KS8851 con Interfaz de bus SPI. Elimine la manipulaci\u00f3n de BH y en lugar de llamar a netif_rx() dentro del c\u00f3digo del controlador IRQ protegido por el bloqueo, primero ponga en cola todos los SKB recibidos en el controlador IRQ y, una vez que el controlador IRQ salga de la secci\u00f3n cr\u00edtica protegida por el bloqueo, retire la cola. todos los SKB en cola y env\u00edelos todos a netif_rx(). En este punto, es seguro activar el softirq net_rx_action(), ya que la llamada netif_rx() est\u00e1 fuera del bloqueo que protege el controlador IRQ."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/7e2901a2a9195da76111f351584bf77552a038f0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8a3ff43dcbab7c96f9e8cf2bd1049ab8d6e59545", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ae87f661f3c1a3134a7ed86ab69bf9f12af88993", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e0863634bf9f7cf36291ebb5bfa2d16632f79c49", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1499: Execution Through Modalities", "comment": "CVE-2024-36962 - This technique is relevant as it involves the exploitation of a kernel-level vulnerability to execute arbitrary code, which is a common modality for malicious actors to gain elevated privileges."}, {"techniqueID": "T1501: Execute Keylogger or Sourcemeter", "comment": "CVE-2024-36962 - This technique is relevant as it involves the exploitation of a kernel-level vulnerability to execute arbitrary code, which can include executing malware such as keyloggers or sourcemeters."}, {"techniqueID": "T1503: Rootkit Installation", "comment": "CVE-2024-36962 - This technique is relevant as it involves the exploitation of a kernel-level vulnerability to execute arbitrary code, which can include installing rootkits to hide malicious activities."}], "stix_bundle": "https://raw.githubusercontent.com/mitre-attack/attack-stix- bundle/master/attack-stix.xml", "technical_analysis": {"Introduction": "The CVE-2024-36962 vulnerability is a kernel-level vulnerability that affects the Linux kernel. The vulnerability is caused by a race condition in the ks8851 network interface driver, which allows an attacker to execute arbitrary code with elevated privileges.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 (CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) and allows an attacker to perform code execution, rootkit installation, and keylogger installation.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1499, T1501, T1503.", "Technical Details": "The vulnerability occurs when the ks8851 network interface driver is exploited by an attacker, who can then execute arbitrary code with elevated privileges.", "Detection": "The vulnerability can be detected by monitoring system calls and network traffic.", "Mitigation": "The vulnerability can be mitigated by updating the Linux kernel to a patched version and configuring the system to prevent exploits.", "Conclusion": "The CVE-2024-36962 vulnerability is a serious kernel-level vulnerability that allows an attacker to execute arbitrary code with elevated privileges."}, "executive_analysis": {"Overview": "The CVE-2024-36962 vulnerability is a serious kernel-level vulnerability that affects the Linux kernel and allows an attacker to execute arbitrary code with elevated privileges.", "Business Impact": "The vulnerability puts sensitive data and systems at risk of exploitation, which can result in significant financial losses and reputational damage.", "Technical Impact": "The vulnerability requires a high level of technical expertise to exploit and can result in a denial-of-service attack or unauthorized access to sensitive data.", "Mitigation Strategies": "Implementing patches, conducting regular security audits, and configuring the system to prevent exploits are recommended mitigation strategies.", "Recommendations": "For executives, it is recommended to prioritize the patching of vulnerable systems, conduct regular security audits, and ensure that security configurations are up-to-date.", "Conclusions": "The CVE-2024-36962 vulnerability is a serious threat that requires immediate attention and action to prevent exploitation."}}