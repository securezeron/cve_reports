{"id": "CVE-2024-39462", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-25T15:15:14.580", "lastModified": "2024-07-03T02:05:49.283", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nclk: bcm: dvp: Assign ->num before accessing ->hws\n\nCommit f316cdff8d67 (\"clk: Annotate struct clk_hw_onecell_data with\n__counted_by\") annotated the hws member of 'struct clk_hw_onecell_data'\nwith __counted_by, which informs the bounds sanitizer about the number\nof elements in hws, so that it can warn when hws is accessed out of\nbounds. As noted in that change, the __counted_by member must be\ninitialized with the number of elements before the first array access\nhappens, otherwise there will be a warning from each access prior to the\ninitialization because the number of elements is zero. This occurs in\nclk_dvp_probe() due to ->num being assigned after ->hws has been\naccessed:\n\n  UBSAN: array-index-out-of-bounds in drivers/clk/bcm/clk-bcm2711-dvp.c:59:2\n  index 0 is out of range for type 'struct clk_hw *[] __counted_by(num)' (aka 'struct clk_hw *[]')\n\nMove the ->num initialization to before the first access of ->hws, which\nclears up the warning."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: clk: bcm: dvp: Assign -&gt;num before accessing -&gt;hws Commit f316cdff8d67 (\"clk: Annotate struct clk_hw_onecell_data with __counted_by\") anot\u00f3 el miembro hws de 'struct clk_hw_onecell_data' con __counted_by, que informa al sanitizante de los l\u00edmites sobre la cantidad de elementos en hws, para que pueda advertir cuando se accede a hws fuera de los l\u00edmites. Como se se\u00f1al\u00f3 en ese cambio, el miembro __counted_by debe inicializarse con la cantidad de elementos antes de que ocurra el primer acceso a la matriz; de lo contrario, habr\u00e1 una advertencia de cada acceso antes de la inicializaci\u00f3n porque la cantidad de elementos es cero. Esto ocurre en clk_dvp_probe() debido a que -&gt;num se asigna despu\u00e9s de que se haya accedido a -&gt;hws: UBSAN: array-index-out-of-bounds in drivers/clk/bcm/clk-bcm2711-dvp.c:59:2 El \u00edndice 0 est\u00e1 fuera del rango para el tipo 'struct clk_hw *[] __counted_by(num)' (tambi\u00e9n conocido como 'struct clk_hw *[]'). Mueva la inicializaci\u00f3n -&gt;num antes del primer acceso de -&gt;hws, lo que borra la advertencia. ."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-400"}]}], "references": [{"url": "https://git.kernel.org/stable/c/0dc913217fb79096597005bba9ba738e2db5cd02", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9368cdf90f52a68120d039887ccff74ff33b4444", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/a1dd92fca0d6b58b55ed0484f75d4205dbb77010", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-39462 - The patch fixes a bug in the Linux kernel's clock subsystem, which could allow an attacker to access memory outside the bounds of an array, potentially leading to a denial-of-service (DoS) or escalating privileges"}], "stix_bundle": {"type": "bundle", "id": "bundle-1", "spec_version": "2.1", "created_by_ref": "https://stix.example.com/author", "created": "2024-07-03T02:05:49.283", "modified": "2024-07-03T02:05:49.283", "objects": [{"type": "vulnerability", "id": "vulnerability-1", "spec_version": "2.1", "created_by_ref": "https://stix.example.com/author", "created": "2024-07-03T02:05:49.283", "modified": "2024-07-03T02:05:49.283", "name": "CVE-2024-39462", "description": "A bug in the Linux kernel's clock subsystem that allows an attacker to access memory outside the bounds of an array.", "cve": "CVE-2024-39462", "cwe": "CWE-400", "cvss": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "baseScore": 9.8, "baseSeverity": "CRITICAL"}}, {"type": "indicator", "id": "indicator-1", "spec_version": "2.1", "created_by_ref": "https://stix.example.com/author", "created": "2024-07-03T02:05:49.283", "modified": "2024-07-03T02:05:49.283", "name": "Bounds Sanitizer Warning", "description": "A warning generated by the Bounds Sanitizer in the Linux kernel due to an array index out-of-bounds.", "pattern": "Bounds Sanitizer Warning: array-index-out-of-bounds"}, {"type": "observable", "id": "observable-1", "spec_version": "2.1", "created_by_ref": "https://stix.example.com/author", "created": "2024-07-03T02:05:49.283", "modified": "2024-07-03T02:05:49.283", "name": "Uninitialized Variable Access", "description": "An uninitialized variable is accessed in the clk_dvp_probe() function in the Linux kernel.", "data_type": "generic", "Observable Type": "code"}, {"type": "campaign", "id": "campaign-1", "spec_version": "2.1", "created_by_ref": "https://stix.example.com/author", "created": "2024-07-03T02:05:49.283", "modified": "2024-07-03T02:05:49.283", "name": "Linux Kernel Bug Exploitation", "description": "A campaign to exploit vulnerabilities in the Linux kernel, including CVE-2024-39462, to gain unauthorized access to systems."}], "relationships": [{"type": "associated-with", "id": "association-1", "source_ref": "vulnerability-1", "target_ref": "indicator-1"}, {"type": "exploited-by", "id": "exploitation-1", "source_ref": "campaign-1", "target_ref": "vulnerability-1"}, {"type": "uses", "id": "use-1", "source_ref": "observable-1", "target_ref": "vulnerability-1"}]}, "technical_analysis": {"Introduction": "The CVE-2024-39462 vulnerability is a bug in the Linux kernel's clock subsystem that allows an attacker to access memory outside the bounds of an array, potentially leading to a denial-of-service (DoS) or escalating privileges. This analysis provides a technical overview of the vulnerability, its impact, and recommended mitigation strategies.", "Impact and Scope": "The vulnerability affects Linux kernel versions prior to 5.18 and has a CVSS score of 9.8. It is a critical vulnerability that can be exploited remotely and possibly without user interaction.", "Related MITRE ATT&CK Techniques": "T1190 - Exploit Public-Facing Application", "Technical Details": "The vulnerability occurs due to an array index out-of-bounds in the clk_dvp_probe() function in the Linux kernel. This allows an attacker to access memory outside the bounds of the array, potentially leading to a denial-of-service (DoS) or escalating privileges.", "Detection": "The vulnerability can be detected using tools such as the Bounds Sanitizer or by monitoring system logs for evidence of out-of-bounds memory access.", "Mitigation": "The vulnerability can be mitigated by applying the patch provided by the Linux kernel developers. Additionally, enabling the Bounds Sanitizer can help detect and prevent future instances of this vulnerability.", "Conclusion": "In conclusion, the CVE-2024-39462 vulnerability is a critical bug in the Linux kernel's clock subsystem that allows an attacker to access memory outside the bounds of an array. It is essential to apply the patch provided by the Linux kernel developers and enable the Bounds Sanitizer to prevent exploitation of this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-39462 vulnerability is a critical bug in the Linux kernel's clock subsystem that allows an attacker to access memory outside the bounds of an array, potentially leading to a denial-of-service (DoS) or escalating privileges. This analysis provides an executive-level overview of the vulnerability, its business impact, and recommended mitigation strategies.", "Business Impact": "The vulnerability affects Linux-based systems and devices, including servers, workstations, and embedded devices, potentially leading to significant business disruptions and losses.", "Technical Impact": "The vulnerability can be exploited remotely and possibly without user interaction, potentially leading to data breaches, theft, or corruption.", "Mitigation Strategies": "Apply the patch provided by the Linux kernel developers and enable the Bounds Sanitizer to prevent exploitation of this vulnerability.", "Recommendations": "Executive leadership should ensure that the organization's IT department prioritizes the patching and mitigation of this vulnerability. Additionally, executive leadership should consider conducting a thorough risk assessment and implementing additional security measures to protect against future vulnerabilities.", "Conclusions": "In conclusion, the CVE-2024-39462 vulnerability is a critical security threat that requires immediate attention and action from both IT and executive leadership. It is essential to prioritize the patching and mitigation of this vulnerability to prevent future exploitation and potential business disruptions."}}