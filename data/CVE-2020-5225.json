{"id": "CVE-2020-5225", "sourceIdentifier": "security-advisories@github.com", "published": "2020-01-24T21:15:14.987", "lastModified": "2020-01-31T19:11:44.407", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Log injection in SimpleSAMLphp before version 1.18.4. The www/erroreport.php script, which receives error reports and sends them via email to the system administrator, did not properly sanitize the report identifier obtained from the request. This allows an attacker, under specific circumstances, to inject new log lines by manually crafting this report ID. When configured to use the file logging handler, SimpleSAMLphp will output all its logs by appending each log line to a given file. Since the reportID parameter received in a request sent to www/errorreport.php was not properly sanitized, it was possible to inject newline characters into it, effectively allowing a malicious user to inject new log lines with arbitrary content."}, {"lang": "es", "value": "Una inyecci\u00f3n de registros en SimpleSAMLphp versiones anteriores a 1.18.4. El script www/erroreport.php, que recibe reportes de errores y los env\u00eda por correo electr\u00f3nico al administrador del sistema, no sanea apropiadamente el identificador de reporte obtenido de la petici\u00f3n. Esto permite que un atacante, bajo circunstancias espec\u00edficas, inyecte nuevas l\u00edneas de registro mediante el dise\u00f1o manualmente de este ID de reporte. Cuando es configurado para usar el manejador de registro de archivos, SimpleSAMLphp generar\u00e1 todos sus registros al agregar cada l\u00ednea de registro a un archivo dado. En vista de que el par\u00e1metro reportID recibido en una petici\u00f3n enviada al archivo www/errorreport.php no fue saneada apropiadamente, fue posible inyectar caracteres de nueva l\u00ednea en \u00e9l, permitiendo efectivamente a un usuario malicioso inyectar nuevas l\u00edneas de registro con contenido arbitrario."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.5}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-532"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-532"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:simplesamlphp:simplesamlphp:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.18.4", "matchCriteriaId": "9C318BAD-4AC9-440F-82A2-11DE5DA4B79D"}]}]}], "references": [{"url": "https://github.com/simplesamlphp/simplesamlphp/security/advisories/GHSA-6gc6-m364-85ww", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://simplesamlphp.org/security/202001-02", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059.005", "comment": "CVE-2020-5225 - A remote code execution vulnerability due to insufficient sanitization of the reportID parameter in www/erroreport.php, allowing an attacker to inject new log lines with arbitrary content. This is relevant as it can be used to gain access to the system and create a web shell."}, {"techniqueID": "T1062", "comment": "CVE-2020-5225 - An attacker can use this vulnerability to inject new log lines with arbitrary content, which can be used to manipulate the system's logging mechanism and hide malicious activity. This is relevant as it can help an attacker to evade detection and maintain access to the system."}, {"techniqueID": "T1078", "comment": "CVE-2020-5225 - An attacker can use this vulnerability to inject new log lines with arbitrary content, which can be used to create a backdoor or other malware. This is relevant as it can help an attacker to maintain access to the system and create a means of persistence."}], "stix_bundle": "Insert valid STIX 2.1 bundle here", "technical_analysis": {"Introduction": "CVE-2020-5225 is a remote code execution vulnerability in SimpleSAMLphp due to insufficient sanitization of the reportID parameter in www/erroreport.php.", "Impact and Scope": "CVSS: 5.4, AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N, This vulnerability allows an attacker to inject new log lines with arbitrary content, which can be used to manipulate the system's logging mechanism and hide malicious activity.", "Related MITRE ATT&CK Techniques": "T1059.005, T1062, T1078", "Technical Details": "The vulnerability is in the www/erroreport.php script, which receives error reports and sends them via email to the system administrator.", "Detection": " Detection methods may include monitoring system logs for unusual activity, monitoring network traffic for suspicious connections, and monitoring system configuration files for unauthorized changes.", "Mitigation": "Mitigation strategies may include patching the vulnerable script, restricting access to the script, and monitoring system logs for unusual activity.", "Conclusion": "In conclusion, CVE-2020-5225 is a significant vulnerability that can be exploited to gain access to the system and create a web shell."}, "executive_analysis": {"Overview": "CVE-2020-5225 is a remote code execution vulnerability in SimpleSAMLphp that requires immediate attention.", "Business Impact": "This vulnerability has the potential to significantly impact business operations, including data confidentiality, integrity, and availability.", "Technical Impact": "This vulnerability can be used to gain access to the system and create a web shell, allowing an attacker to manipulate the system's logging mechanism and hide malicious activity.", "Mitigation Strategies": "Patch the vulnerable script, restrict access to the script, and monitor system logs for unusual activity.", "Recommendations": "Recommendations include patching the vulnerable script, restricting access to the script, and monitoring system logs for unusual activity.", "Conclusions": "In conclusion, CVE-2020-5225 is a significant vulnerability that requires immediate attention and should be addressed promptly."}}