{"id": "CVE-2020-8554", "sourceIdentifier": "jordan@liggitt.net", "published": "2021-01-21T17:15:13.843", "lastModified": "2023-11-07T03:26:37.237", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Kubernetes API server in all versions allow an attacker who is able to create a ClusterIP service and set the spec.externalIPs field, to intercept traffic to that IP address. Additionally, an attacker who is able to patch the status (which is considered a privileged operation and should not typically be granted to users) of a LoadBalancer service can set the status.loadBalancer.ingress.ip to similar effect."}, {"lang": "es", "value": "El servidor de la API de Kubernetes en todas las versiones permite a un atacante que puede crear un servicio ClusterIP y establecer el campo spec.externalIPs, interceptar el tr\u00e1fico a esa direcci\u00f3n IP. Adicionalmente, un atacante que sea capaz de parchear el estado (que se considera una operaci\u00f3n privilegiada y no se debe t\u00edpicamente otorgar a los usuarios) de un servicio LoadBalancer puede configurar el status.loadBalancer.ingress.ip con un efecto similar"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.0, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.4}, {"source": "jordan@liggitt.net", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 6.8, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "jordan@liggitt.net", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-283"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*", "matchCriteriaId": "044D3402-749F-4BEA-9F7E-16F7839654FE"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:oracle:communications_cloud_native_core_network_slice_selection_function:1.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "ADE6EF8F-1F05-429B-A916-76FDB20CEB81"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:communications_cloud_native_core_policy:1.15.0:*:*:*:*:*:*:*", "matchCriteriaId": "B4367D9B-BF81-47AD-A840-AC46317C774D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:communications_cloud_native_core_service_communication_proxy:1.14.0:*:*:*:*:*:*:*", "matchCriteriaId": "0AB059F2-FEC4-4180-8A90-39965495055E"}]}]}], "references": [{"url": "https://github.com/kubernetes/kubernetes/issues/97076", "source": "jordan@liggitt.net", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://groups.google.com/g/kubernetes-security-announce/c/iZWsF9nbKE8", "source": "jordan@liggitt.net", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.apache.org/thread.html/r0c76b3d0be348f788cd947054141de0229af00c540564711e828fd40%40%3Ccommits.druid.apache.org%3E", "source": "jordan@liggitt.net"}, {"url": "https://lists.apache.org/thread.html/r1975078e44d96f2a199aa90aa874b57a202eaf7f25f2fde6d1c44942%40%3Ccommits.druid.apache.org%3E", "source": "jordan@liggitt.net"}, {"url": "https://lists.apache.org/thread.html/rcafa485d63550657f068775801aeb706b7a07140a8ebbdef822b3bb3%40%3Ccommits.druid.apache.org%3E", "source": "jordan@liggitt.net"}, {"url": "https://lists.apache.org/thread.html/rdb223e1b82e3d7d8e4eaddce8dd1ab87252e3935cc41c859f49767b6%40%3Ccommits.druid.apache.org%3E", "source": "jordan@liggitt.net"}, {"url": "https://www.oracle.com//security-alerts/cpujul2021.html", "source": "jordan@liggitt.net", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://www.oracle.com/security-alerts/cpuapr2022.html", "source": "jordan@liggitt.net", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://www.oracle.com/security-alerts/cpujan2022.html", "source": "jordan@liggitt.net", "tags": ["Patch", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1406", "comment": "CVE-2020-8554 - An attacker can intercept traffic to a ClusterIP service and set the status.loadBalancer.ingress.ip for a LoadBalancer, this can lead to lateral movement and data exfiltration. This can be defended against by implementing strict access controls and monitoring for suspicious activity."}, {"techniqueID": "T1009", "comment": "CVE-2020-8554 - An attacker can create a ClusterIP service to intercept traffic and set the spec.externalIPs field, this can lead to data exfiltration and lateral movement. This can be defended against by implementing strict access controls and monitoring for suspicious activity."}, {"techniqueID": "T1556", "comment": "CVE-2020-8554 - An attacker can set the status.loadBalancer.ingress.ip for a LoadBalancer service, this can lead to data exfiltration and lateral movement. This can be defended against by implementing strict access controls and monitoring for suspicious activity."}], "stix_bundle": {"id": "CVE-2020-8554", "type": "bundle", "spec_version": "2.1", "description": "MITRE ATT&CK Techniques and Defense Strategies for CVE-2020-8554", "objects": [{"id": "CVE-2020-8554", "type": "indicator", "name": "CVE-2020-8554", "description": "CVE-2020-8554: Kubernetes API server allows attack", "created_by_ref": "https://mitre ATTACK.com/actors", "modified": "2023-11-07T03:26:37.237", "labels": ["vulnerability", "mitre ATT&CK"], "related_objects": []}, {"id": "T1406", "type": "attack_pattern", "name": "T1406", "description": "Accessing, with escalated privileges, to enable execution", "created_by_ref": "https://mitre ATTACK.com/attack_patters", "modified": "2023-11-07T03:26:37.237", "labels": ["mitre ATT&CK-", "lateral movement"], "related_objects": [{"s_ref": "CVE-2020-8554", "r_type": "indicates_attack_pattern"}]}, {"id": "T1009", "type": "attack_pattern", "name": "T1009", "description": "Command and Scripting Interpreter", "created_by_ref": "https://mitre ATTACK.com/attack_patters", "modified": "2023-11-07T03:26:37.237", "labels": ["mitre ATT&CK-", "lateral movement"], "related_objects": [{"s_ref": "CVE-2020-8554", "r_type": "indicates_attack_pattern"}]}, {"id": "T1556", "type": "attack_pattern", "name": "T1556", "description": "Modify Registry Run Keys / Startup folders", "created_by_ref": "https://mitre ATTACK.com/attack_patters", "modified": "2023-11-07T03:26:37.237", "labels": ["mitre ATT&CK-", "lateral movement"], "related_objects": [{"s_ref": "CVE-2020-8554", "r_type": "indicates_attack_pattern"}]}, {"id": "CVE-2020-8554-defense", "type": "-course-of-action", "name": "CVE-2020-8554-defense", "description": "Defense Strategy for CVE-2020-8554", "created_by_ref": "https://mitre ATTACK.com/actors", "modified": "2023-11-07T03:26:37.237", "labels": ["mitre ATT&CK-", "defense"], "related_objects": [{"s_ref": "T1406", "r_type": "mitigates_attack_pattern"}, {"s_ref": "T1009", "r_type": "mitigates_attack_pattern"}, {"s_ref": "T1556", "r_type": "mitigates_attack_pattern"}]}]}, "technical_analysis": {"Introduction": "The Kubernetes API server allows an attacker to intercept traffic and set status.loadBalancer.ingress.ip for a LoadBalancer, leading to data exfiltration and lateral movement.", "Impact and Scope": "CVSS Score: 5.0 (CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L), Attack Vector: Network, Impact: Data Exfiltration and Lateral Movement.", "Related MITRE ATT&CK Techniques": "T1406, T1009, T1556", "Technical Details": "The vulnerability allows an attacker to create a ClusterIP service, set the spec.externalIPs field, and intercept traffic to that IP address.", "Detection": "Monitor for suspicious activity and implement strict access controls.", "Mitigation": "Implement strict access controls and monitor for suspicious activity.", "Conclusion": "The Kubernetes API server vulnerability allows an attacker to intercept traffic and set status.loadBalancer.ingress.ip for a LoadBalancer, leading to data exfiltration and lateral movement. Implementing strict access controls and monitoring for suspicious activity can help mitigate this vulnerability."}, "executive_analysis": {"Overview": "The Kubernetes API server vulnerability (CVE-2020-8554) allows an attacker to intercept traffic and set status.loadBalancer.ingress.ip for a LoadBalancer, leading to data exfiltration and lateral movement.", "Business Impact": "The vulnerability can lead to data exfiltration and lateral movement, compromising business data and intellectual property.", "Technical Impact": "The vulnerability allows an attacker to intercept traffic and set status.loadBalancer.ingress.ip for a LoadBalancer, leading to data exfiltration and lateral movement.", "Mitigation Strategies": "Implement strict access controls and monitor for suspicious activity.", "Recommendations": "Executives should recommend implementing strict access controls and monitoring for suspicious activity to mitigate this vulnerability.", "Conclusions": "The Kubernetes API server vulnerability is a critical security risk and should be addressed immediately."}}