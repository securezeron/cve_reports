{"id": "CVE-2024-2044", "sourceIdentifier": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007", "published": "2024-03-07T21:15:08.767", "lastModified": "2024-08-01T13:49:39.293", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "pgAdmin <= 8.3 is affected by a path-traversal vulnerability while deserializing users\u2019 sessions in the session handling code. If the server is running on Windows, an unauthenticated attacker can load and deserialize remote pickle objects and gain code execution. If the server is running on POSIX/Linux, an authenticated attacker can upload pickle objects, deserialize them, and gain code execution.\n"}, {"lang": "es", "value": "pgAdmin 4 utiliza un enfoque de gesti\u00f3n de sesiones basado en archivos. Los archivos de sesi\u00f3n se guardan en el disco como objetos pickle. Cuando un usuario realiza una solicitud, el valor de la cookie de sesi\u00f3n 'pga4_session' se utiliza para recuperar el archivo, luego se deserializa su contenido y finalmente se verifica su firma. El valor de la cookie se divide en 2 partes en el primer '!' personaje. La primera parte es el ID de la sesi\u00f3n (sid), mientras que la segunda es el resumen de la sesi\u00f3n. La vulnerabilidad radica en las versiones de pgAdmin anteriores a la 8.4, donde un m\u00e9todo carga archivos de sesi\u00f3n concatenando la carpeta de sesiones, ubicada dentro de pgAdmin 4 DATA_DIR, con el ID de sesi\u00f3n. Precisamente, los dos valores se concatenan usando la funci\u00f3n ['os.path.join']. No establece una ruta base confiable de la que no se debe escapar"}], "metrics": {"cvssMetricV31": [{"source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.9, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.1, "impactScore": 6.0}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-31"}]}], "references": [{"url": "https://github.com/pgadmin-org/pgadmin4/issues/7258", "source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LUYN2JXKKHFSVTASH344TBRGWDH64XQV/", "source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007"}, {"url": "https://www.shielder.com/advisories/pgadmin-path-traversal_leads_to_unsafe_deserialization_and_rce/", "source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007"}], "techniques": [{"techniqueID": "T1190", "comment": "Remote File Copy - CVE-2024-2044 is a path-traversal vulnerability where an unauthenticated attacker can load and deserialize remote pickle objects, gaining code execution."}, {"techniqueID": "T1036", "comment": "Upload and Execute - CVE-2024-2044 is a path-traversal vulnerability where an authenticated attacker can upload pickle objects, deserialize them, and gain code execution."}, {"techniqueID": "T1197", "comment": "File and Directory Discovery - CVE-2024-2044 is a path-traversal vulnerability where an attacker can traverse the file system and upload files, potentially leading to code execution."}, {"techniqueID": "T1059", "comment": "Command and Scripting Interpreter - CVE-2024-2044 is a path-traversal vulnerability where an attacker can upload and execute malicious code."}, {"techniqueID": "T1140", "comment": "Deobfuscate/Decode Files or Information - CVE-2024-2044 is a path-traversal vulnerability where an attacker can upload and deserialize pickle objects, which can be used to gain code execution."}], "technical_analysis": {"Introduction": "CVE-2024-2044 is a path-traversal vulnerability in pgAdmin 4, a free GUI tool for managing PostgreSQL databases. The vulnerability allows an unauthenticated attacker to load and deserialize remote pickle objects, gaining code execution.", "Impact and Scope": "CVSS 3.1 score: 9.9 (CRITICAL) - Attack Vector: NETWORK - Attack Complexity: LOW - Privileges Required: LOW - User Interaction: NONE - Scope: CHANGED - Confidentiality Impact: HIGH - Integrity Impact: HIGH - Availability Impact: HIGH", "Related MITRE ATT&CK Techniques": "T1190, T1036, T1197, T1059, T1140", "Technical Details": "The vulnerability is caused by the use of unrestricted file paths in the session handling code, allowing an attacker to load and deserialize remote pickle objects.", "Detection": "Network traffic monitoring can help detect attempts to load and deserialize remote pickle objects. File system monitoring can help detect suspicious file uploads.", "Mitigation": "Update to a patched version of pgAdmin 4, restrict access to file paths, and monitor network traffic and file system activity.", "Conclusion": "CVE-2024-2044 is a critical vulnerability in pgAdmin 4 that allows code execution without authentication. It is essential to update to a patched version and implement security measures to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-2044 is a critical vulnerability in pgAdmin 4 that allows an unauthenticated attacker to gain code execution, potentially leading to data loss or breaches.", "Business Impact": "The vulnerability can lead to unauthorized data access, data breaches, and reputational damage.", "Technical Impact": "The vulnerability affects pgAdmin 4, a widely-used tool for managing PostgreSQL databases, and can be exploited by an unauthenticated attacker, making it a critical risk.", "Mitigation Strategies": "Update to a patched version of pgAdmin 4, restrict access to file paths, and implement security measures to prevent exploitation.", "Recommendations": "Immediately update to a patched version of pgAdmin 4, prioritize vulnerability remediation, and consider conducting a security assessment to identify and address similar vulnerabilities.", "Conclusions": "CVE-2024-2044 is a critical vulnerability that requires immediate attention and remediation. Implementing security measures and prioritizing vulnerability remediation is essential to preventing exploitation."}}