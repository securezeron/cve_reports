{"id": "CVE-2024-2296", "sourceIdentifier": "security@wordfence.com", "published": "2024-04-06T09:15:07.883", "lastModified": "2024-04-08T18:48:40.217", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Photo Gallery by 10Web \u2013 Mobile-Friendly Image Gallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting via SVG file uploads in all versions up to, and including, 1.8.21 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with administrator-level access, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page. This only affects multi-site installations and installations where unfiltered_html has been disabled."}, {"lang": "es", "value": "El complemento Photo Gallery by 10Web \u2013 Mobile-Friendly Image Gallery para WordPress es vulnerable a cross-site scripting almacenado a trav\u00e9s de cargas de archivos SVG en todas las versiones hasta la 1.8.21 incluida debido a una sanitizaci\u00f3n de entrada y un escape de salida insuficientes. Esto hace posible que atacantes autenticados, con acceso a nivel de administrador, inyecten scripts web arbitrarios en p\u00e1ginas que se ejecutar\u00e1n cada vez que un usuario acceda a una p\u00e1gina inyectada. Esto solo afecta a las instalaciones multisitio y a las instalaciones en las que se ha deshabilitado unfiltered_html."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}]}, "references": [{"url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3058445%40photo-gallery&new=3058445%40photo-gallery&sfp_email=&sfph_mail=", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/994a044d-db69-4f2d-9027-cf3665446ed3?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-2296 - Stored Cross-Site Scripting (XSS) vulnerability in Photo Gallery plugin for WordPress. Attackers can inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page."}, {"techniqueID": "T1190", "comment": "CVE-2024-2296 - Lack of input sanitization and output escaping in Photo Gallery plugin for WordPress, allowing attackers to inject malicious code. Defending against this requires validating and sanitizing user input and ensuring proper output escaping."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "Bundle-1", "_objects": [{"type": "vulnerability", "id": "Vulnerability-1", "name": "Photo Gallery Plugin Stored Cross-Site Scripting", "description": "The Photo Gallery by 10Web \u2013 Mobile-Friendly Image Gallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting (XSS) attacks due to insufficient input sanitization and output escaping.", "published": "2024-04-06T09:15:07.883", "modified": "2024-04-08T18:48:40.217", "references": [{"type": "reference", "id": "Reference-1", "url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3058445%40photo-gallery&new=3058445%40photo-gallery&sfp_email=&sfph_mail=", "source": "security@wordfence.com"}, {"type": "reference", "id": "Reference-2", "url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/994a044d-db69-4f2d-9027-cf3665446ed3?source=cve", "source": "security@wordfence.com"}], "related_indicators": [{"type": "indicator", "id": "Indicator-1", "category": "network_traffic", "description": "Network traffic containing SVG file uploads and unfiltered_html in WordPress multisite installations", "filter_commands": ["tcp dump -i any -f 80 -w 10"]}], "related_courses_of_action": [{"type": "course_of_action", "id": "Course-of-Action-1", "name": "Update Photo Gallery plugin to version 1.8.22 or higher", "description": "Updating the Photo Gallery plugin to the latest version (1.8.22 or higher) will fix the vulnerability.", "mitigates": [{"type": " technique", "id": "T1059"}]}], "related_defense_techniques": [{"type": "defense_technique", "id": "Defense-Technique-1", "name": "Validate and Sanitize User Input", "description": "Validating and sanitizing user input will help prevent XSS attacks.", "notes": ["Use a reputable WAF or Web Application Firewall to detect and block XSS attacks."]}]}]}, "technical_analysis": {"Introduction": "The Photo Gallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting attacks due to insufficient input sanitization and output escaping.", "Impact and Scope": "The vulnerability affects all versions of the Photo Gallery plugin up to and including 1.8.21, and only applies to multi-site WordPress installations where unfiltered_html has been disabled.", "Related MITRE ATT&CK Techniques": "T1059, T1190", "Technical Details": "The vulnerability is caused by the plugin's failure to properly sanitize and escape input from SVG file uploads, allowing attackers to inject malicious code.", "Detection": "Detected by monitoring network traffic for suspicious SVG file uploads and unfiltered_html in WordPress multisite installations.", "Mitigation": "Updating the Photo Gallery plugin to the latest version (1.8.22 or higher) and validating and sanitizing user input will mitigate the vulnerability.", "Conclusion": "The Photo Gallery plugin vulnerability is a significant risk to WordPress multisite installations, and immediate action is recommended to update the plugin and implement proper input validation and sanitization."}, "executive_analysis": {"Overview": "The Photo Gallery plugin for WordPress has a vulnerability that allows for Stored Cross-Site Scripting attacks.", "Business Impact": "The vulnerability poses a significant risk to WordPress multisite installations, potentially allowing attackers to inject malicious code and steal sensitive data.", "Technical Impact": "The vulnerability affects all versions of the Photo Gallery plugin up to and including 1.8.21, and only applies to multi-site WordPress installations where unfiltered_html has been disabled.", "Mitigation Strategies": "Updating the Photo Gallery plugin to the latest version (1.8.22 or higher) and implementing proper input validation and sanitization will mitigate the vulnerability.", "Recommendations": "To minimize the risk of a Stored Cross-Site Scripting attack, we recommend updating the Photo Gallery plugin to the latest version and implementing proper input validation and sanitization.", "Conclusions": "Immediate action is recommended to update the Photo Gallery plugin and implement proper input validation and sanitization to mitigate the vulnerability."}}