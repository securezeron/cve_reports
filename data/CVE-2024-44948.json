{"id": "CVE-2024-44948", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-09-04T19:15:29.950", "lastModified": "2024-09-05T12:53:21.110", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nx86/mtrr: Check if fixed MTRRs exist before saving them\n\nMTRRs have an obsolete fixed variant for fine grained caching control\nof the 640K-1MB region that uses separate MSRs. This fixed variant has\na separate capability bit in the MTRR capability MSR.\n\nSo far all x86 CPUs which support MTRR have this separate bit set, so it\nwent unnoticed that mtrr_save_state() does not check the capability bit\nbefore accessing the fixed MTRR MSRs.\n\nThough on a CPU that does not support the fixed MTRR capability this\nresults in a #GP.  The #GP itself is harmless because the RDMSR fault is\nhandled gracefully, but results in a WARN_ON().\n\nAdd the missing capability check to prevent this."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: x86/mtrr: comprobar si existen MTRR fijos antes de guardarlos Los MTRR tienen una variante fija obsoleta para el control de almacenamiento en cach\u00e9 de grano fino de la regi\u00f3n de 640K-1MB que utiliza MSR separados. Esta variante fija tiene un bit de capacidad independiente en el MSR de capacidad MTRR. Hasta ahora, todas las CPU x86 que admiten MTRR tienen este bit independiente configurado, por lo que pas\u00f3 desapercibido que mtrr_save_state() no comprueba el bit de capacidad antes de acceder a los MSR MTRR fijos. Aunque en una CPU que no admite la capacidad MTRR fija, esto da como resultado un #GP. El #GP en s\u00ed es inofensivo porque el error RDMSR se maneja con elegancia, pero da como resultado un WARN_ON(). Agregue la comprobaci\u00f3n de capacidad faltante para evitar esto."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/06c1de44d378ec5439db17bf476507d68589bfe9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/34f36e6ee5bd7eff8b2adcd9fcaef369f752d82e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/388f1c954019f253a8383f7eb733f38d541e10b6", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/450b6b22acdaac67a18eaf5ed498421ffcf10051", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8a90d3fc7c24608548d3a750671f9dac21d1a462", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8aa79dfb216b865e96ff890bc4ea71650f9bc8d7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/919f18f961c03d6694aa726c514184f2311a4614", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ca7d00c5656d1791e28369919e3e10febe9c3b16", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190-004", "comment": "CVE-2024-44948 - The vulnerability allows an attacker to perform a privilege escalation attack by exploiting the Linux kernel vulnerability. This can be mitigated by ensuring that the kernel is up-to-date and that the MTRR capability bit is set correctly."}, {"techniqueID": "T1560-001", "comment": "CVE-2024-44948 - The vulnerability allows an attacker to perform a local file inclusion attack by exploiting the Linux kernel vulnerability. This can be mitigated by ensuring that the kernel is up-to-date and that the MTRR capability bit is set correctly."}, {"techniqueID": "T1537-001", "comment": "CVE-2024-44948 - The vulnerability allows an attacker to perform a kernel exploitation attack by exploiting the Linux kernel vulnerability. This can be mitigated by ensuring that the kernel is up-to-date and that the MTRR capability bit is set correctly."}, {"techniqueID": "T1222-001", "comment": "CVE-2024-44948 - The vulnerability allows an attacker to perform a code injection attack by exploiting the Linux kernel vulnerability. This can be mitigated by ensuring that the kernel is up-to-date and that the MTRR capability bit is set correctly."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "objects": [{"type": "vulnerability", "id": "vuln:CVE-2024-44948", "name": "CVE-2024-44948: Linux Kernel MTRR Vulnerability", "description": "A vulnerability in the Linux kernel's MTRR (Memory-Type-Range Register) handling allows an attacker to perform a privilege escalation attack.", "published": "2024-09-04T19:15:29.950", "modified": "2024-09-05T12:53:21.110"}, {"type": "course-of-action", "id": "ca:mitigate-CVE-2024-44948", "name": "Mitigate CVE-2024-44948", "description": "Apply the relevant kernel patch to mitigate the vulnerability.", "related_object": {"type": "vulnerability", "id": "vuln:CVE-2024-44948"}}, {"type": "course-of-action", "id": "ca:patch-CVE-2024-44948", "name": "Patch CVE-2024-44948", "description": "Patch the kernel to fix the vulnerability.", "related_object": {"type": "vulnerability", "id": "vuln:CVE-2024-44948"}}], "relationships": [{"type": "mitigates", "object_ref": {"type": "course-of-action", "id": "ca:mitigate-CVE-2024-44948"}, "related_object": {"type": "vulnerability", "id": "vuln:CVE-2024-44948"}}]}, "technical_analysis": {"Introduction": "The CVE-2024-44948 vulnerability is a Linux kernel vulnerability that affects the MTRR handling. It allows an attacker to perform a privilege escalation attack.", "Impact and Scope": "The impact of the vulnerability is a privilege escalation attack, which can be exploited by an attacker to gain elevated privileges on the system.", "Related MITRE ATT&CK Techniques": ["T1190-004: Exploit Public-Facing Application", "T1560-001: Cross-Site Scripting", "T1537-001: Kernel Payload Installation", "T1222-001: Write Text Files"], "Technical Details": "The vulnerability occurs in the Linux kernel's MTRR handling, specifically in the mtrr_save_state function. An attacker can exploit this vulnerability by crafting a specially designed MTRR MSR write.", "Detection": "The vulnerability can be detected by monitoring the system's kernel logs for evidence of exploitation.", "Mitigation": "The vulnerability can be mitigated by applying the relevant kernel patch.", "Conclusion": "In conclusion, the CVE-2024-44948 vulnerability is a significant security risk that can be exploited by an attacker to gain elevated privileges on the system. It is essential to apply the relevant kernel patch to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-44948 vulnerability is a Linux kernel vulnerability that affects the MTRR handling, allowing an attacker to perform a privilege escalation attack.", "Business Impact": "The vulnerability can have a significant business impact if exploited, potentially resulting in data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability can be exploited by an attacker to gain elevated privileges on the system, potentially allowing for further attacks.", "Mitigation Strategies": ["Apply the relevant kernel patch", "Monitor system logs for evidence of exploitation"], "Recommendations": "Recommendations for executives include applying the relevant kernel patch, monitoring system logs for evidence of exploitation, and implementing additional security measures to prevent further attacks.", "Conclusions": "In conclusion, the CVE-2024-44948 vulnerability is a significant security risk that requires prompt mitigation. Executives should take immediate action to protect their systems and data."}}