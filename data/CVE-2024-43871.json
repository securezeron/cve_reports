{"id": "CVE-2024-43871", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-21T01:15:11.680", "lastModified": "2024-09-03T13:39:19.553", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndevres: Fix memory leakage caused by driver API devm_free_percpu()\n\nIt will cause memory leakage when use driver API devm_free_percpu()\nto free memory allocated by devm_alloc_percpu(), fixed by using\ndevres_release() instead of devres_destroy() within devm_free_percpu()."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: devres: corrige la p\u00e9rdida de memoria causada por la API del controlador devm_free_percpu(). Causar\u00e1 una p\u00e9rdida de memoria cuando se usa la API del controlador devm_free_percpu() para liberar la memoria asignada por devm_alloc_percpu(), solucionada usando devres_release( ) en lugar de devres_destroy() dentro de devm_free_percpu()."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-401"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.10", "versionEndExcluding": "4.19.320", "matchCriteriaId": "8E49FBAD-00F1-4B80-8C39-C5E194F4B39F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.20", "versionEndExcluding": "5.4.282", "matchCriteriaId": "A8961D98-9ACF-4188-BA88-44038B14BC28"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.5", "versionEndExcluding": "5.10.224", "matchCriteriaId": "5CCEDF13-293D-4E64-B501-4409D0365AFE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.11", "versionEndExcluding": "5.15.165", "matchCriteriaId": "B4E2B568-3171-41DE-B519-F2B1A3600D94"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.16", "versionEndExcluding": "6.1.103", "matchCriteriaId": "E45EAC72-8329-4F99-8276-86AF9BB3496A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2", "versionEndExcluding": "6.6.44", "matchCriteriaId": "CC912330-6B41-4C6B-99AF-F3857FBACB6A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.10.3", "matchCriteriaId": "92D388F2-1EAF-4CFA-AC06-5B26D762EA7D"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/3047f99caec240a88ccd06197af2868da1af6a96", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/3dcd0673e47664bc6c719ad47dadac6d55d5950d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/700e8abd65b10792b2f179ce4e858f2ca2880f85", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/95065edb8ebb27771d5f1e898eef6ab43dc6c87c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/b044588a16a978cd891cb3d665dd7ae06850d5bf", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/b67552d7c61f52f1271031adfa7834545ae99701", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/bd50a974097bb82d52a458bd3ee39fb723129a0c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/ef56dcdca8f2a53abc3a83d388b8336447533d85", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-43871 - This is an example of an insidious vulnerability where memory leakage occurs due to driver API devm_free_percpu() used for allocating memory by devm_alloc_percpu() and causing a memory leak. This can lead to system crashes and data corruption. Techniques like 'Exploitation of Heap Spraying' and 'Memory Corruption' can be related to this vulnerability."}, {"techniqueID": "T1212", "comment": "CVE-2024-43871 - Memory corruption can occur due to improper handling of devm_alloc_percpu() and devm_free_percpu(). This can lead to system instability and data loss. Techniques like 'Exploitation of Memory Corruption' and 'Data Tampering' can be related to this vulnerability."}, {"techniqueID": "T1195", "comment": "CVE-2024-43871 - A kernel driver can be exploited to achieve code execution by manipulating the kernel memory and exploiting the devm_free_percpu() and devm_alloc_percpu() APIs. This can lead to system compromise and data theft. Techniques like 'Exploitation of Kernel Driver Vulnerability' and 'Code Injection' can be related to this vulnerability."}, {"techniqueID": "T1494", "comment": "CVE-2024-43871 - Disabling the vulnerable kernel module or driver can prevent exploitation. Techniques like 'Disabling Vulnerable Component' and 'Removing Malware' can be used to mitigate this vulnerability."}], "stix_bundle": {"type": "bundle", "id": "bundle-1", "spec_version": "2.1", "objects": [{"type": "vulnerability", "id": "vulnerability-1", "title": "Linux Kernel Driver Vulnerability", "description": "A vulnerability exists in the Linux kernel driver.", "severity": "MEDIUM", "cvssV3": {"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}}, {"type": "attack-pattern", "id": "attack-pattern-1", "title": "Exploitation of Heap Spraying", "description": "Exploiting a system by identifying and overwriting memory chunks."}, {"type": "attack-pattern", "id": "attack-pattern-2", "title": "Memory Corruption", "description": "Modifying the contents of allocated memory in such a way as to exploit vulnerabilities in the handling of memory."}, {"type": "attack-pattern", "id": "attack-pattern-3", "title": "Exploitation of Kernel Driver Vulnerability", "description": "Exploiting a vulnerable kernel driver to achieve code execution."}, {"type": "course-of-action", "id": "course-of-action-1", "title": "Disabling Vulnerable Component", "description": "Disabling the vulnerable kernel module or driver to prevent exploitation."}], "relationships": [{"type": "has-part", "object_ref": "vulnerability-1", "relationship": "has_part"}, {"type": "has-part", "object_ref": "attack-pattern-1", "relationship": "has_part"}, {"type": "has-part", "object_ref": "attack-pattern-2", "relationship": "has_part"}, {"type": "has-part", "object_ref": "attack-pattern-3", "relationship": "has_part"}, {"type": "mitigated-by", "object_ref": "course-of-action-1", "relationship": "mitigates"}]}, "technical_analysis": {"Introduction": "The Linux kernel driver vulnerability CVE-2024-43871 is a memory leakage issue due to improper handling of devm_alloc_percpu() and devm_free_percpu().", "Impact and Scope": "The vulnerability can lead to system crashes and data corruption due to memory leakage.", "Related MITRE ATT&CK Techniques": "T1210, T1212, T1195", "Technical Details": "The vulnerability occurs due to the misuse of devm_free_percpu() and devm_alloc_percpu() APIs, leading to memory leakage.", "Detection": "Detection can be done using memory analysis tools and system logs.", "Mitigation": "Disabling the vulnerable kernel module or driver can prevent exploitation.", "Conclusion": "The vulnerability is a significant threat to system stability and data integrity."}, "executive_analysis": {"Overview": "The Linux kernel driver vulnerability CVE-2024-43871 is a significant security risk that requires immediate attention.", "Business Impact": "The vulnerability can lead to system crashes and data corruption, resulting in business disruption and financial loss.", "Technical Impact": "The vulnerability can compromise system security, allowing attackers to execute malicious code and steal sensitive data.", "Mitigation Strategies": "Disabling the vulnerable kernel module or driver and implementing memory analysis tools can mitigate the vulnerability.", "Recommendations": "Executives should prioritize implementing robust security measures to prevent exploitation.", "Conclusions": "The vulnerability is a high-priority threat that requires immediate action to prevent system compromise and data theft."}}