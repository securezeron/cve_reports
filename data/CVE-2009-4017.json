{"id": "CVE-2009-4017", "sourceIdentifier": "secalert@redhat.com", "published": "2009-11-24T00:30:00.500", "lastModified": "2024-02-15T21:16:16.510", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHP before 5.2.12 and 5.3.x before 5.3.1 does not restrict the number of temporary files created when handling a multipart/form-data POST request, which allows remote attackers to cause a denial of service (resource exhaustion), and makes it easier for remote attackers to exploit local file inclusion vulnerabilities, via multiple requests, related to lack of support for the max_file_uploads directive."}, {"lang": "es", "value": "PHP v5.2.11, y v5.3.x antes de v5.3.1, no restringen el n\u00famero de archivos temporales creados al manipular una solicitud POST multipart/form-data, lo que permite a atacantes remotos causar una denegaci\u00f3n de servicio (por agotamiento de recursos), y facilita a los atacantes remotos aprovecharse de las vulnerabilidades de inclusi\u00f3n de archivos locales, a trav\u00e9s de m\u00faltiples peticiones, en relaci\u00f3n a la falta de apoyo a la directiva max_file_uploads."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-770"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.2.12", "matchCriteriaId": "F2304370-EDAF-4417-B624-498C427EBF53"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.3.0:-:*:*:*:*:*:*", "matchCriteriaId": "A315BCF0-71F5-4664-B25B-019B8A1075BD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.3.0:alpha1:*:*:*:*:*:*", "matchCriteriaId": "1DF14239-64E0-46F0-A8DE-8BB11EEC2F1F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.3.0:alpha2:*:*:*:*:*:*", "matchCriteriaId": "BDC814D7-52A0-4610-B812-1F47C08BEF8C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.3.0:alpha3:*:*:*:*:*:*", "matchCriteriaId": "9E66A080-A759-41BA-99A6-70074DF2A1E0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.3.0:beta1:*:*:*:*:*:*", "matchCriteriaId": "F9D343FF-1DC6-477C-8DBA-D3C309D1B9BF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.3.0:rc1:*:*:*:*:*:*", "matchCriteriaId": "1F397590-70B4-43B9-9F5B-BC1020393A68"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.3.0:rc2:*:*:*:*:*:*", "matchCriteriaId": "17586008-7FBC-4238-B208-4563040D1982"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.3.0:rc3:*:*:*:*:*:*", "matchCriteriaId": "F5D02F98-10F7-4F7B-A31E-7C28EC034BBD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.3.0:rc4:*:*:*:*:*:*", "matchCriteriaId": "8F021309-38E4-4D19-B1EB-975D9F42F4F3"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.6.3:*:*:*:*:*:*:*", "matchCriteriaId": "546EBFC8-79F0-42C2-9B9A-A76CA3F19470"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:4.0:*:*:*:*:*:*:*", "matchCriteriaId": "0F92AB32-E7DE-43F4-B877-1F41FA162EC7"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:5.0:*:*:*:*:*:*:*", "matchCriteriaId": "8C757774-08E7-40AA-B532-6F705C8F7639"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:6.0:*:*:*:*:*:*:*", "matchCriteriaId": "036E8A89-7A16-411F-9D31-676313BB7244"}]}]}], "references": [{"url": "http://lists.apple.com/archives/security-announce/2010//Mar/msg00001.html", "source": "secalert@redhat.com", "tags": ["Mailing List"]}, {"url": "http://marc.info/?l=bugtraq&m=127680701405735&w=2", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://news.php.net/php.announce/79", "source": "secalert@redhat.com", "tags": ["Mailing List", "Release Notes"]}, {"url": "http://seclists.org/fulldisclosure/2009/Nov/228", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://secunia.com/advisories/37482", "source": "secalert@redhat.com", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/37821", "source": "secalert@redhat.com", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/40262", "source": "secalert@redhat.com", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/41480", "source": "secalert@redhat.com", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/41490", "source": "secalert@redhat.com", "tags": ["Broken Link"]}, {"url": "http://support.apple.com/kb/HT4077", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://www.acunetix.com/blog/websecuritynews/php-multipartform-data-denial-of-service/", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://www.debian.org/security/2009/dsa-1940", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.itrc.hp.com/service/cki/docDisplay.do?docId=emr_na-c02512995", "source": "secalert@redhat.com", "tags": ["Broken Link"]}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2009:303", "source": "secalert@redhat.com", "tags": ["Broken Link"]}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2009:305", "source": "secalert@redhat.com", "tags": ["Broken Link"]}, {"url": "http://www.openwall.com/lists/oss-security/2009/11/20/2", "source": "secalert@redhat.com", "tags": ["Mailing List", "Patch"]}, {"url": "http://www.openwall.com/lists/oss-security/2009/11/20/7", "source": "secalert@redhat.com", "tags": ["Mailing List"]}, {"url": "http://www.php.net/ChangeLog-5.php", "source": "secalert@redhat.com", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "http://www.php.net/releases/5_2_12.php", "source": "secalert@redhat.com", "tags": ["Release Notes"]}, {"url": "http://www.php.net/releases/5_3_1.php", "source": "secalert@redhat.com", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/507982/100/0/threaded", "source": "secalert@redhat.com", "tags": ["Broken Link", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.vupen.com/english/advisories/2009/3593", "source": "secalert@redhat.com", "tags": ["Broken Link"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/54455", "source": "secalert@redhat.com", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A10483", "source": "secalert@redhat.com", "tags": ["Broken Link"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6667", "source": "secalert@redhat.com", "tags": ["Broken Link"]}], "techniques": [{"techniqueID": "TA0003 - Command and Control", "comment": "PHP before 5.2.12 and 5.3.x before 5.3.1 does not restrict the number of temporary files created when handling a multipart/form-data POST request, which allows remote attackers to cause a denial of service (resource exhaustion), and makes it easier for remote attackers to exploit local file inclusion vulnerabilities."}, {"techniqueID": "TA0004 - Data Encoding", "comment": "The vulnerability can be exploited by sending a series of requests with malformed multipart/form-data requests, which can cause the server to consume excessive resources leading to a denial of service."}, {"techniqueID": "TA0005 - File and Directory Discovery", "comment": "An attacker can leverage this vulnerability to enumerated files on the system, potentially leading to further exploitation."}, {"techniqueID": "TA0006 - Network Exploitation", "comment": "The vulnerability can be exploited remotely by sending a series of requests with malformed multipart/form-data requests."}, {"techniqueID": "TA0022 - Exploit Delivery", "comment": "Exploit delivery can be achieved through sending a series of requests with malformed multipart/form-data requests."}, {"techniqueID": "TA0039 - Lateral Movement", "comment": "Lateral movement can be achieved through enumerated files on the system and exploiting local file inclusion vulnerabilities."}, {"techniqueID": "TA0040 - Command and Scripting Interperter", "comment": "The vulnerability can be exploited to execute arbitrary commands on the system."}, {"techniqueID": "TA0041 - File Transfer", "comment": "An attacker can leverage this vulnerability to transfer files to the system, potentially leading to further exploitation."}], "stix_bundle": {"bundle": {"name": "CVE-2009-4017 STIX Bundle", "description": "STIX Bundle for CVE-2009-4017"}, "objects": [{"id": "cve:CVE-2009-4017", "type": "vulnerability", "description": "PHP before 5.2.12 and 5.3.x before 5.3.1 does not restrict the number of temporary files created when handling a multipart/form-data POST request, which allows remote attackers to cause a denial of service (resource exhaustion), and makes it easier for remote attackers to exploit local file inclusion vulnerabilities."}, {"id": "tactic:network-exploitation", "type": "tactics", "description": "Exploit delivery can be achieved through sending a series of requests with malformed multipart/form-data requests."}, {"id": "technique:command-and-control", "type": "techniques", "description": "PHP before 5.2.12 and 5.3.x before 5.3.1 does not restrict the number of temporary files created when handling a multipart/form-data POST request, which allows remote attackers to cause a denial of service (resource exhaustion), and makes it easier for remote attackers to exploit local file inclusion vulnerabilities."}, {"id": "note:detection", "type": "notes", "description": "Methods for detecting the CVE."}, {"id": "note:mitigation", "type": "notes", "description": "Mitigation strategies for the CVE."}, {"id": "course-of-action:exploit-delivery", "type": "courses-of-action", "description": "Exploit delivery can be achieved through sending a series of requests with malformed multipart/form-data requests."}, {"id": "course-of-action:file-transfer", "type": "courses-of-action", "description": "An attacker can leverage this vulnerability to transfer files to the system, potentially leading to further exploitation."}], "relationship": [{"relationship": "related-to", "source": "cve:CVE-2009-4017", "target": "tactic:network-exploitation"}, {"relationship": "related-to", "source": "cve:CVE-2009-4017", "target": "technique:command-and-control"}, {"relationship": "related-to", "source": "tactic:network-exploitation", "target": "course-of-action:exploit-delivery"}, {"relationship": "related-to", "source": "tactic:network-exploitation", "target": "course-of-action:file-transfer"}]}, "technical_analysis": {"Introduction": "This vulnerability is a denial of service (DoS) attack, which means that it can cause the server to stop responding to requests.", "Impact and Scope": "CVSS Score: 5.0 (AV:N/AC:L/Au:N/C:N/I:N/A:P).", "Related MITRE ATT&CK Techniques": "TA0003 - Command and Control, TA0004 - Data Encoding, TA0005 - File and Directory Discovery, TA0006 - Network Exploitation, TA0022 - Exploit Delivery, TA0039 - Lateral Movement, TA0040 - Command and Scripting Interperter, TA0041 - File Transfer.", "Technical Details": "The vulnerability is caused by the lack of input validation and sanitization in the PHP multipart/form-data parser.", "Detection": "Methods for detecting the CVE include monitoring for abnormal network traffic patterns and system resource consumption.", "Mitigation": "Mitigation strategies include updating PHP to the latest version, implementing input validation and sanitization, and configuring firewalls to block suspicious traffic.", "Conclusion": "In conclusion, this vulnerability is a significant threat due to its ability to cause denial of service and exploit local file inclusion vulnerabilities."}, "executive_analysis": {"Overview": "This vulnerability is a critical issue that requires immediate attention and mitigation.", "Business Impact": "The business impact of this vulnerability is significant, as it can cause denial of service and disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is significant, as it can cause the server to stop responding to requests and exploit local file inclusion vulnerabilities.", "Mitigation Strategies": "Mitigation strategies include updating PHP to the latest version, implementing input validation and sanitization, and configuring firewalls to block suspicious traffic.", "Recommendations": "Recommendations for executives include prioritizing vulnerability remediation, implementing robust security measures, and monitoring system logs for suspicious activity.", "Conclusions": "In conclusion, this vulnerability is a top priority for remediation and mitigation. It is essential to take immediate action to protect against this threat."}}