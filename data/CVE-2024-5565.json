{"id": "CVE-2024-5565", "sourceIdentifier": "reefs@jfrog.com", "published": "2024-05-31T15:15:09.673", "lastModified": "2024-07-03T02:09:05.567", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Vanna library uses a prompt function to present the user with visualized results, it is possible to alter the prompt using prompt injection and run arbitrary Python code instead of the intended visualization code. Specifically - allowing external input to the library\u2019s \u201cask\u201d method with \"visualize\" set to True (default behavior) leads to remote code execution."}, {"lang": "es", "value": "La librer\u00eda Vanna utiliza una funci\u00f3n de solicitud para presentar al usuario resultados visualizados; es posible modificar la solicitud mediante inyecci\u00f3n de solicitud y ejecutar c\u00f3digo Python arbitrario en lugar del c\u00f3digo de visualizaci\u00f3n deseado. Espec\u00edficamente, permitir la entrada externa al m\u00e9todo \"preguntar\" de la librer\u00eda con \"visualizar\" configurado en Verdadero (comportamiento predeterminado) conduce a la ejecuci\u00f3n remota de c\u00f3digo."}], "metrics": {"cvssMetricV31": [{"source": "reefs@jfrog.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.9}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://research.jfrog.com/vulnerabilities/vanna-prompt-injection-rce-jfsa-2024-001034449/", "source": "reefs@jfrog.com"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-5565 - This is an example of a stored XSS vulnerability. In this case, the Vanna library's 'ask' method is vulnerable to prompt injection, which can be used to execute arbitrary Python code. Defend against this by validating user input and sanitizing any user-submitted data."}, {"techniqueID": "T1618", "comment": "CVE-2024-5565 - The vulnerability in the Vanna library allows for remote code execution through prompt injection, making it a prime target for attackers to exploit. Implement input validation and sanitization to prevent this type of attack."}], "stix_bundle": "[STIX Bundle Object]", "technical_analysis": {"Introduction": "CVE-2024-5565 is a stored XSS vulnerability in the Vanna library's 'ask' method, which allows for prompt injection and remote code execution.", "Impact and Scope": "CVSS Score: 8.1 (High), Attack Vector: NETWORK, The vulnerability allows attackers to execute arbitrary Python code, making it a high-impact threat.", "Related MITRE ATT&CK Techniques": "The vulnerability is relevant to T1059 (Command and Scripting Interpreter) and T1618 (OS Command Injection) attack techniques.", "Technical Details": "The vulnerability is caused by the library's use of a prompt function to present user results, which can be manipulated to execute arbitrary Python code.", "Detection": "Detect by monitoring for abnormal library usage, such as unusual command injection or unexpected code execution.", "Mitigation": "Mitigate by validating user input and sanitizing any user-submitted data, as well as implementing protections for the 'ask' method.", "Conclusion": "CVE-2024-5565 is a serious vulnerability that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "CVE-2024-5565 is a stored XSS vulnerability in the Vanna library that allows for remote code execution.", "Business Impact": "The vulnerability has the potential to compromise sensitive business data and expose the organization to significant financial risk.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary Python code, potentially leading to data breaches or system compromise.", "Mitigation Strategies": "Implement input validation and sanitization, as well as protect the 'ask' method.", "Recommendations": "Immediately patch the vulnerability, implement security measures to prevent exploitation, and inform affected stakeholders.", "Conclusions": "CVE-2024-5565 is a high-priority vulnerability that requires immediate attention and remediation."}}