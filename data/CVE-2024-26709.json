{"id": "CVE-2024-26709", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-03T15:15:53.440", "lastModified": "2024-04-03T17:24:18.150", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc/iommu: Fix the missing iommu_group_put() during platform domain attach\n\nThe function spapr_tce_platform_iommu_attach_dev() is missing to call\niommu_group_put() when the domain is already set. This refcount leak\nshows up with BUG_ON() during DLPAR remove operation as:\n\n  KernelBug: Kernel bug in state 'None': kernel BUG at arch/powerpc/platforms/pseries/iommu.c:100!\n  Oops: Exception in kernel mode, sig: 5 [#1]\n  LE PAGE_SIZE=64K MMU=Radix SMP NR_CPUS=8192 NUMA pSeries\n  <snip>\n  Hardware name: IBM,9080-HEX POWER10 (raw) 0x800200 0xf000006 of:IBM,FW1060.00 (NH1060_016) hv:phyp pSeries\n  NIP:  c0000000000ff4d4 LR: c0000000000ff4cc CTR: 0000000000000000\n  REGS: c0000013aed5f840 TRAP: 0700   Tainted: G          I         (6.8.0-rc3-autotest-g99bd3cb0d12e)\n  MSR:  8000000000029033 <SF,EE,ME,IR,DR,RI,LE>  CR: 44002402  XER: 20040000\n  CFAR: c000000000a0d170 IRQMASK: 0\n  ...\n  NIP iommu_reconfig_notifier+0x94/0x200\n  LR  iommu_reconfig_notifier+0x8c/0x200\n  Call Trace:\n    iommu_reconfig_notifier+0x8c/0x200 (unreliable)\n    notifier_call_chain+0xb8/0x19c\n    blocking_notifier_call_chain+0x64/0x98\n    of_reconfig_notify+0x44/0xdc\n    of_detach_node+0x78/0xb0\n    ofdt_write.part.0+0x86c/0xbb8\n    proc_reg_write+0xf4/0x150\n    vfs_write+0xf8/0x488\n    ksys_write+0x84/0x140\n    system_call_exception+0x138/0x330\n    system_call_vectored_common+0x15c/0x2ec\n\nThe patch adds the missing iommu_group_put() call."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: powerpc/iommu: corrige el iommu_group_put() que falta durante la conexi\u00f3n del dominio de la plataforma. Falta la funci\u00f3n spapr_tce_platform_iommu_attach_dev() para llamar a iommu_group_put() cuando el dominio ya est\u00e1 configurado. Esta fuga de recuento aparece con BUG_ON() durante la operaci\u00f3n de eliminaci\u00f3n de DLPAR como: KernelBug: Error del kernel en estado 'Ninguno': ERROR del kernel en arch/powerpc/platforms/pseries/iommu.c:100. Vaya: Excepci\u00f3n en modo kernel, sign: 5 [#1] LE PAGE_SIZE=64K MMU=Radix SMP NR_CPUS=8192 NUMA pSeries  Nombre de hardware: IBM,9080-HEX POWER10 (sin formato) 0x800200 0xf000006 of:IBM,FW1060. 00 (NH1060_016) hv:phyp pSeries NIP: c0000000000ff4d4 LR: c0000000000ff4cc CTR: 0000000000000000 REGS: c0000013aed5f840 TRAP: 0700 Contaminado: GI (6.8.0-rc3-autotest-g9 9bd3cb0d12e) MSR: 8000000000029033  CR: 44002402 XER: 20040000 CFAR: c000000000a0d170 IRQMASK: 0 ... NIP iommu_reconfig_notifier+0x94/0x200 LR iommu_reconfig_notifier+0x8c/0x200 Seguimiento de llamadas: iommu_reconfig_notifier+0x8c/0x2 00 (no confiable) notifier_call_chain+0xb8/0x19c blocking_notifier_call_chain+ 0x64/0x98 of_reconfig_notify+0x44/0xdc of_detach_node+0x78/0xb0 ofdt_write.part.0+0x86c/0xbb8 proc_reg_write+0xf4/0x150 vfs_write+0xf8/0x488 ksys_write+0x84/0x140 system_call_exception+0x1 38/0x330 system_call_vectored_common+0x15c/0x2ec El parche agrega la llamada faltante a iommu_group_put()."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0846dd77c8349ec92ca0079c9c71d130f34cb192", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c90fdea9cac9eb419fc266e75d625cb60c8f7f6c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-26709 - This technique is relevant as it demonstrates a lack of proper memory management which can be exploited by an attacker. A defense strategy would be to implement memory protection measures such as Address Space Layout Randomization (ASLR) and Data Execution Prevention (DEP)."}, {"techniqueID": "T1210", "comment": "CVE-2024-26709 - This technique is relevant as it shows an insecure coding practice that can be used by an attacker for exploitation. A defense strategy would be to implement secure coding practices such as input validation, error handling and logging to detect potential vulnerabilities."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "CVE-2024-26709", "description": "CVE-2024-26709: PowerPC IOMMU vulnerability in the Linux kernel", "created_by_ref": "https://example.com/stix-server", "created": "2024-04-03T15:15:53.440", "modified": "2024-04-03T17:24:18.150", "objects": [{"type": "vulnerability", "id": "CVE-2024-26709", "description": "In the Linux kernel, the following vulnerability has been resolved: powerpc/iommu: Fix the missing iommu_group_put() during platform domain attach"}, {"type": "indicator", "id": "CVE-2024-26709-indicator", "description": "Unused IOMMU domain attached", "created_by_ref": "https://example.com/stix-server", "created": "2024-04-03T15:15:53.440", "modified": "2024-04-03T17:24:18.150", "relationships": [{"type": "related_to", "object_ref": "CVE-2024-26709", "relationship": "is associated with"}]}, {"type": "course_of_action", "id": "CVE-2024-26709-course-of-action", "description": "Implement memory protection measures such as Address Space Layout Randomization (ASLR) and Data Execution Prevention (DEP)", "created_by_ref": "https://example.com/stix-server", "created": "2024-04-03T15:15:53.440", "modified": "2024-04-03T17:24:18.150", "relationships": [{"type": "mitigates", "object_ref": "CVE-2024-26709", "relationship": "mitigates"}]}]}}, "technical_analysis": {"Introduction": "The CVE-2024-26709 vulnerability in the Linux kernel is a critical issue that allows an attacker to exploit the IOMMU domain without proper security measures.", "Impact and Scope": "The impact of this vulnerability is severe, as it allows an attacker to access and manipulate sensitive data. The scope of this vulnerability includes Linux systems using the affected kernel version.", "Related MITRE ATT&CK Techniques": "T1190 and T1210", "Technical Details": "The vulnerability arises due to a missing iommu_group_put() call during platform domain attach. This allows an attacker to add a new IOMMU domain to the system without proper security checks.", "Detection": "Detection of this vulnerability involves monitoring system logs for suspicious activity and monitoring for potential exploitation.", "Mitigation": "Mitigation strategies include implementing memory protection measures such as ASLR and DEP, and regularly updating the Linux kernel.", "Conclusion": "The CVE-2024-26709 vulnerability is a critical issue that requires immediate attention. Implementing mitigation strategies and regularly updating the Linux kernel can help prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-26709 vulnerability in the Linux kernel is a critical issue that affects the integrity and security of the system.", "Business Impact": "This vulnerability can lead to significant financial losses, reputational damage, and regulatory compliance issues.", "Technical Impact": "The technical impact of this vulnerability is severe, as it allows an attacker to access and manipulate sensitive data.", "Mitigation Strategies": "Implementing memory protection measures such as ASLR and DEP, and regularly updating the Linux kernel are critical to preventing exploitation.", "Recommendations": "The executive team should prioritize patching and updating the Linux kernel as soon as possible, and conduct regular security audits to identify and address potential vulnerabilities.", "Conclusions": "The CVE-2024-26709 vulnerability is a critical issue that requires immediate attention. Executives should prioritize security and implement mitigation strategies to prevent exploitation."}}