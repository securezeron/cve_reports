{"id": "CVE-2020-15682", "sourceIdentifier": "security@mozilla.org", "published": "2020-10-22T21:15:13.433", "lastModified": "2020-10-30T13:15:19.680", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "When a link to an external protocol was clicked, a prompt was presented that allowed the user to choose what application to open it in. An attacker could induce that prompt to be associated with an origin they didn't control, resulting in a spoofing attack. This was fixed by changing external protocol prompts to be tab-modal while also ensuring they could not be incorrectly associated with a different origin. This vulnerability affects Firefox < 82."}, {"lang": "es", "value": "Cuando se hac\u00eda clic en un enlace a un protocolo externo, se presentaba un mensaje que le permit\u00eda al usuario elegir en qu\u00e9 aplicaci\u00f3n lo abriera. Un atacante pod\u00eda inducir que ese mensaje se asociara con un origen que no controlaba, lo que resultaba en un ataque de suplantaci\u00f3n de identidad.&#xa0;Esto se corrigi\u00f3 cambiando las indicaciones del protocolo externo para que sean tab-modal y, al mismo tiempo, se asegur\u00f3 de que no pudieran asociarse incorrectamente con un origen diferente.&#xa0;Esta vulnerabilidad afecta a Firefox versiones anteriores a 82"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-346"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:*:*:*:*:*:*:*:*", "versionEndExcluding": "82.0", "matchCriteriaId": "A99DBC67-F226-4E09-B6C2-1B4346AEC802"}]}]}], "references": [{"url": "https://bugzilla.mozilla.org/show_bug.cgi?id=1636654", "source": "security@mozilla.org", "tags": ["Issue Tracking", "Permissions Required", "Vendor Advisory"]}, {"url": "https://www.mozilla.org/security/advisories/mfsa2020-45/", "source": "security@mozilla.org", "tags": ["Release Notes", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-15682 - This vulnerability is related to External Protocol Unlinking, where an attacker could induce that prompt to be associated with an origin they didn't control, resulting in a spoofing attack. To defend against this, implement protocol handlers to check the origin of the request before processing it."}, {"techniqueID": "T1191", "comment": "CVE-2020-15682 - This vulnerability is related to Parameter Injection, where an attacker could inject malicious parameters into the protocol handler. To defend against this, implement input validation and whitelisting for protocol handler parameters."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle-02c5f2f8-e4e3-4697-8c6c-c6bf456f22be", "spec_version": "2.1", "objects": [{"Object": {"type": "vulnerability", "id": "vuln-03eb20e6-2dfe-411e-aeee-6c98a7bb7e35", "name": "CVE-2020-15682", "description": "When a link to an external protocol was clicked, a prompt was presented that allowed the user to choose what application to open it in. An attacker could induce that prompt to be associated with an origin they didn't control, resulting in a spoofing attack.", "severity": "MEDIUM", "cvssV3": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N"}, "references": [{"type": "reference", "id": "ref-1", "href": "https://bugzilla.mozilla.org/show_bug.cgi?id=1636654", "rel": "issue tracking"}, {"type": "reference", "id": "ref-2", "href": "https://www.mozilla.org/security/advisories/mfsa2020-45/", "rel": "release notes"}], "related_objects": [{"type": "technique", "id": "tech-1190", "rel": "uses", "note": "External Protocol Unlinking"}, {"type": "technique", "id": "tech-1191", "rel": "uses", "note": "Parameter Injection"}, {"type": "tactic", "id": "tactic-4", "rel": "mitigates", "note": "Defense Evasion"}]}}, {"Object": {"type": "technique", "id": "tech-1190", "name": "External Protocol Unlinking", "description": "An attacker could induce that prompt to be associated with an origin they didn't control, resulting in a spoofing attack."}}, {"Object": {"type": "technique", "id": "tech-1191", "name": "Parameter Injection", "description": "An attacker could inject malicious parameters into the protocol handler."}}, {"Object": {"type": "tactic", "id": "tactic-4", "name": "Defense Evasion", "description": "A tactic used by attackers to evade detection."}}]}}, "technical_analysis": {"Introduction": "This vulnerability is related to External Protocol Unlinking, where an attacker could induce that prompt to be associated with an origin they didn't control, resulting in a spoofing attack.", "Impact and Scope": "This vulnerability affects Firefox versions earlier than 82 with a CVSSv3 score of 6.5 (MEDIUM) and a CVSSv2 score of 4.3 (MEDIUM).", "Related MITRE ATT&CK Techniques": "T1190 - External Protocol Unlinking, T1191 - Parameter Injection", "Technical Details": "The vulnerability occurs when a link to an external protocol is clicked, presenting a prompt to choose what application to open it in.", "Detection": "To detect this vulnerability, implement protocol handlers to check the origin of the request before processing it.", "Mitigation": "Implement input validation and whitelisting for protocol handler parameters to prevent Parameter Injection attacks.", "Conclusion": "This vulnerability is a medium-severity vulnerability that affects Firefox versions earlier than 82."}, "executive_analysis": {"Overview": "This vulnerability is a medium-severity vulnerability that affects Firefox versions earlier than 82.", "Business Impact": "This vulnerability can lead to a spoofing attack, which could result in unauthorized access to sensitive data.", "Technical Impact": "This vulnerability is related to External Protocol Unlinking, where an attacker could induce that prompt to be associated with an origin they didn't control.", "Mitigation Strategies": "Implement input validation and whitelisting for protocol handler parameters to prevent Parameter Injection attacks.", "Recommendations": "Keep Firefox updated to the latest version, and implement protocol handlers to check the origin of the request before processing it.", "Conclusions": "This vulnerability is a medium-severity vulnerability that affects Firefox versions earlier than 82, and it is recommended to implement mitigation strategies to prevent attacks."}}