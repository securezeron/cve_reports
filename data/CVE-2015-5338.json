{"id": "CVE-2015-5338", "sourceIdentifier": "secalert@redhat.com", "published": "2016-02-22T05:59:16.517", "lastModified": "2020-12-01T14:54:45.183", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple cross-site request forgery (CSRF) vulnerabilities in the lesson module in Moodle through 2.6.11, 2.7.x before 2.7.11, 2.8.x before 2.8.9, and 2.9.x before 2.9.3 allow remote attackers to hijack the authentication of arbitrary users for requests to (1) mod/lesson/mediafile.php or (2) mod/lesson/view.php."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de CSRF en el m\u00f3dulo lesson en Moodle hasta la versi\u00f3n 2.6.11, 2.7.x en versiones anteriores a 2.7.11, 2.8.x en versiones anteriores a 2.8.9 y 2.9.x en versiones anteriores a 2.9.3 permiten a atacantes remotos secuestrar la autenticaci\u00f3n de usuarios arbitrarios en peticiones a (1) mod/lesson/mediafile.php o (2) mod/lesson/view.php."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.6.11", "matchCriteriaId": "9F3E36CA-026A-4262-8CB7-73E0FC315A45"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.0:*:*:*:*:*:*:*", "matchCriteriaId": "4E051AAC-EB40-491F-AF0E-EE8143C12567"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.1:*:*:*:*:*:*:*", "matchCriteriaId": "FADBE87F-1855-453B-B958-0CB8A7908A06"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.2:*:*:*:*:*:*:*", "matchCriteriaId": "1B53A7D2-BDA2-4185-97C3-977A04876A37"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.3:*:*:*:*:*:*:*", "matchCriteriaId": "A51DFFA8-DFF0-429C-B697-F82F41621FEE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.4:*:*:*:*:*:*:*", "matchCriteriaId": "19FD1565-0DA1-4BA8-A501-86F13D3D29ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.5:*:*:*:*:*:*:*", "matchCriteriaId": "6D82CFE8-C38D-4FF3-BC4F-6C27AD64D9A3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.6:*:*:*:*:*:*:*", "matchCriteriaId": "FEB754AF-3DA4-4459-A53B-3BC7B78CE313"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.7:*:*:*:*:*:*:*", "matchCriteriaId": "F57E8383-C3F3-480C-B9A9-49633DAAEC18"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.8:*:*:*:*:*:*:*", "matchCriteriaId": "645E8B7B-1AE6-4F46-AFA9-7506685CD571"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.9:*:*:*:*:*:*:*", "matchCriteriaId": "0316A26A-8B51-4226-8D56-4A798A2D798D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.10:*:*:*:*:*:*:*", "matchCriteriaId": "DF5A44BF-A70E-4AEF-9A3C-E03809744AB3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.0:*:*:*:*:*:*:*", "matchCriteriaId": "12737AF4-B2D5-4661-B06A-6A06FE95EC2D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.1:*:*:*:*:*:*:*", "matchCriteriaId": "88C59A94-D225-478A-B23E-41C4324BC643"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.2:*:*:*:*:*:*:*", "matchCriteriaId": "192EA69B-A1E1-4E0D-8E73-76EB74CCDE49"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.3:*:*:*:*:*:*:*", "matchCriteriaId": "D88385B1-EEFB-4825-BD8F-215C39FD86DA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.4:*:*:*:*:*:*:*", "matchCriteriaId": "A3BE2782-D167-4237-B57D-2E4C04571524"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.5:*:*:*:*:*:*:*", "matchCriteriaId": "F277F979-12FA-47A5-B0A5-D174C2127A7D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.6:*:*:*:*:*:*:*", "matchCriteriaId": "38498617-8E45-4E73-AE9F-C7A0D18FDE47"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.7:*:*:*:*:*:*:*", "matchCriteriaId": "C9047769-BFF4-42DB-8B19-F6D16FA910A1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.8:*:*:*:*:*:*:*", "matchCriteriaId": "73A75ACE-FED2-4830-B259-744ABF25463E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.9.0:*:*:*:*:*:*:*", "matchCriteriaId": "C9224D94-1C48-468C-A39B-B2694ED178F4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.9.1:*:*:*:*:*:*:*", "matchCriteriaId": "1C7EE9AD-E122-4288-9416-6D8F8790D75D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.9.2:*:*:*:*:*:*:*", "matchCriteriaId": "C4FC2CC1-787B-480F-BC41-538CE2507CB7"}]}]}], "references": [{"url": "http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-48109", "source": "secalert@redhat.com"}, {"url": "https://moodle.org/mod/forum/discuss.php?d=323233", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2015-5338 - This technique is used to manipulate user input to perform unauthorized actions. The vulnerable module in Moodle allows an attacker to hijack the authentication of arbitrary users for requests to certain URLs, allowing them to perform unauthorized actions."}, {"techniqueID": "T1190", "comment": "CVE-2015-5338 - This technique is used to exploit user input to inject malicious code. The vulnerable module in Moodle allows an attacker to inject malicious code by manipulating the URL."}, {"techniqueID": "T1036", "comment": "CVE-2015-5338 - This technique is used to use alternate authentication methods. The vulnerable module in Moodle allows an attacker to hijack the authentication of arbitrary users for requests to certain URLs, allowing them to use alternate authentication methods."}], "stix_bundle": {"objects": [{"id": "vuln:CVE-2015-5338", "type": "vulnerability", "name": "CVE-2015-5338: Cross-Site Request Forgery (CSRF) Vulnerability in Moodle", "description": "Moodle has been found to have a CSRF vulnerability that allows an attacker to hijack the authentication of arbitrary users for requests to certain URLs.", "created": "2023-02-22T14:30:00.000Z", "modified": "2023-02-22T14:30:00.000Z", "relates_to": [{"id": "tec:T1059", "type": "technique-technique-relationship", "relationship": "related"}, {"id": "tec:T1190", "type": "technique-technique-relationship", "relationship": "related"}, {"id": "tec:T1036", "type": "technique-technique-relationship", "relationship": "related"}, {"id": "def:defense-evasion", "type": "course-of-action-technique-relationship", "relationship": "mitigates"}]}, {"id": "tec:T1059", "type": "technique", "name": "T1059: Command and Scripting Interpreter", "description": "Command and Scripting Interpreter", "created": "2023-02-22T14:30:00.000Z", "modified": "2023-02-22T14:30:00.000Z", "notes": [{"text": "The vulnerable module in Moodle allows an attacker to inject malicious code by manipulating the URL."}]}, {"id": "tec:T1190", "type": "technique", "name": "T1190: Exploit Public-Facing Application", "description": "Exploit Public-Facing Application", "created": "2023-02-22T14:30:00.000Z", "modified": "2023-02-22T14:30:00.000Z", "notes": [{"text": "The vulnerable module in Moodle allows an attacker to manipulate user input to perform unauthorized actions."}]}, {"id": "tec:T1036", "type": "technique", "name": "T1036: Web Service ", "description": "Web Service", "created": "2023-02-22T14:30:00.000Z", "modified": "2023-02-22T14:30:00.000Z", "notes": [{"text": "The vulnerable module in Moodle allows an attacker to hijack the authentication of arbitrary users for requests to certain URLs, allowing them to use alternate authentication methods."}]}, {"id": "def:defense-evasion", "type": "course-of-action", "name": "Defense Evasion", "description": "Defense Evasion", "created": "2023-02-22T14:30:00.000Z", "modified": "2023-02-22T14:30:00.000Z", "mitigates": [{"id": "tec:T1059", "type": "technique-course-of-action-relationship", "relationship": "mitigates"}, {"id": "tec:T1190", "type": "technique-course-of-action-relationship", "relationship": "mitigates"}, {"id": "tec:T1036", "type": "technique-course-of-action-relationship", "relationship": "mitigates"}]}]}, "technical_analysis": {"Introduction": "The CVE-2015-5338 vulnerability in Moodle allows an attacker to hijack the authentication of arbitrary users for requests to certain URLs, facilitating unauthorized access and potentially leading to information theft, data exfiltration, or other malicious activities.", "Impact and Scope": "The vulnerability affects multiple versions of Moodle, including 2.6.11, 2.7.x before 2.7.11, 2.8.x before 2.8.9, and 2.9.x before 2.9.3.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1059, T1190, T1036.", "Technical Details": "The vulnerability occurs when the vulnerable module in Moodle fails to validate user input properly, allowing an attacker to manipulate the URL and inject malicious code.", "Detection": "Detection of this vulnerability typically involves monitoring network traffic for suspicious activity and analyzing system logs for signs of unauthorized access.", "Mitigation": "Mitigation strategies include updating to the latest version of Moodle, implementing input validation and sanitization, and configuring the web application firewall to block suspicious traffic.", "Conclusion": "The CVE-2015-5338 vulnerability in Moodle is a significant security risk that can be exploited by attackers to gain unauthorized access to sensitive data and systems. It is essential to prioritize patching and implementing mitigations to protect against this threat."}, "executive_analysis": {"Overview": "The CVE-2015-5338 vulnerability in Moodle is a critical security risk that can lead to unauthorized access and data theft.", "Business Impact": "This vulnerability has significant business implications, including the potential for data breaches, reputational damage, and financial losses.", "Technical Impact": "The vulnerability affects the confidentiality, integrity, and availability of data stored in the Moodle system.", "Mitigation Strategies": "The recommended mitigation strategies are updating to the latest version of Moodle, implementing input validation and sanitization, and configuring the web application firewall to block suspicious traffic.", "Recommendations": "Executives should prioritize patching and implementing mitigations to protect against this threat, and also ensure that the organization has a robust incident response plan in place.", "Conclusions": "The CVE-2015-5338 vulnerability in Moodle is a serious security risk that requires immediate attention and action to protect against unauthorized access and data theft."}}