{"id": "CVE-2020-12718", "sourceIdentifier": "cve@mitre.org", "published": "2020-05-08T00:15:11.987", "lastModified": "2020-05-14T15:53:08.527", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In administration/comments.php in PHP-Fusion 9.03.50, an authenticated attacker can take advantage of a stored XSS vulnerability in the Preview Comment feature. The protection mechanism can be bypassed by using HTML event handlers such as ontoggle."}, {"lang": "es", "value": "En el archivo administration/comments.php en PHP-Fusion versi\u00f3n 9.03.50, un atacante autenticado puede tomar ventaja de una vulnerabilidad de tipo XSS almacenado en la funcionalidad Preview Comment. El mecanismo de protecci\u00f3n pueda ser omitido por medio del uso de controladores de eventos HTML, tal y como ontoggle."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php-fusion:php-fusion:9.03.50:*:*:*:*:*:*:*", "matchCriteriaId": "0AB488D1-637D-4E18-A136-036994F7035F"}]}]}], "references": [{"url": "https://github.com/php-fusion/PHP-Fusion/issues/2309", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-12718 - This stored XSS vulnerability in PHP-Fusion's Preview Comment feature allows an authenticated attacker to bypass protection mechanisms using HTML event handlers. Defending against this requires validating and sanitizing user-input comments."}, {"techniqueID": "T1059", "comment": "CVE-2020-12718 - This vulnerability can be exploited by an attacker using HTML event handlers to bypass protection mechanisms, which may lead to multiple attacks including phishing, spear phishing, and other types of social engineering attacks. Defending against this requires detecting and blocking suspicious HTML code."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle--a4b0d0b5-7a4e-4f3b-8a4c-6b4b7abdb5f8", "created_by_ref": "identity--bb09e134-36e9-4aa9-a4f7-5b5fdd6b56d8", "created": "2023-03-15T14:30:00.000Z", "modified": "2023-03-15T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "vulnerability--8ce8aa31-90ea-41f4-a4a1-8dd38f2ca175", "created_by_ref": "identity--bb09e134-36e9-4aa9-a4f7-5b5fdd6b56d8", "created": "2023-03-15T14:30:00.000Z", "modified": "2023-03-15T14:30:00.000Z", "title": "Stored XSS vulnerability in PHP-Fusion's Preview Comment feature", "description": "A stored XSS vulnerability in PHP-Fusion's Preview Comment feature allows an authenticated attacker to bypass protection mechanisms using HTML event handlers.", "objectMarking": [{"id": "marker--9e1c9a11-544f-49c0-a4e0-5d3c7dff9d6d", "extension": "marker", "type": "MARKING_DEFINITION", "created_by_ref": "identity--bb09e134-36e9-4aa9-a4f7-5b5fdd6b56d8", "created": "2023-03-15T14:30:00.000Z", "modified": "2023-03-15T14:30:00.000Z"}]}, {"type": "course-of-action", "id": "course-of-action--f6c2f9c5-c93e-49a4-87d5-44e3f0b37e15", "created_by_ref": "identity--bb09e134-36e9-4aa9-a4f7-5b5fdd6b56d8", "created": "2023-03-15T14:30:00.000Z", "modified": "2023-03-15T14:30:00.000Z", "title": "Validate and sanitize user-input comments", "description": "Validate and sanitize user-input comments to prevent storage of malicious HTML code.", "related_s kills": [{"id": "s kill--7e2e8f74-77f0-439d-a5a8-bd4401ca5a6e", "type": "s kill", "created_by_ref": "identity--bb09e134-36e9-4aa9-a4f7-5b5fdd6b56d8", "created": "2023-03-15T14:30:00.000Z", "modified": "2023-03-15T14:30:00.000Z", "title": "Technical security testing", "description": "Perform technical security testing to validate and sanitize user-input comments."}]}, {"type": "file", "id": "file--5f24a19d-4ada-4615-aff9-35dea1addb74", "created_by_ref": "identity--bb09e134-36e9-4aa9-a4f7-5b5fdd6b56d8", "created": "2023-03-15T14:30:00.000Z", "modified": "2023-03-15T14:30:00.000Z", "size": 12345, "name": "PHP-Fusion's Preview Comment feature", "description": "The stored XSS vulnerability is located in the Preview Comment feature of PHP-Fusion.", "data": {"encoding": "base64", "data": "QmFzZTY0IGEgZGVsYXkg..."}}], " relationships": [{"id": "r--8ce8aa31-90ea-41f4-a4a1-8dd38f2ca175", "type": "vulnerability-application", "vulnerability_ref": "vulnerability--8ce8aa31-90ea-41f4-a4a1-8dd38f2ca175", "application_ref": "f6c2f9c5-c93e-49a4-87d5-44e3f0b37e15"}]}, "technical_analysis": {"Introduction": "The stored XSS vulnerability in PHP-Fusion's Preview Comment feature allows an authenticated attacker to bypass protection mechanisms using HTML event handlers.", "Impact and Scope": "The vulnerability has a CVSS score of 5.4 with a version of 3.1, and the attack vector is NETWORK.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to the T1190 and T1059 techniques.", "Technical Details": "The vulnerability occurs in the administration/comments.php file of PHP-Fusion 9.03.50, where an authenticated attacker can take advantage of a stored XSS vulnerability in the Preview Comment feature.", "Detection": "The vulnerability can be detected by monitoring for suspicious HTML code in user-input comments.", "Mitigation": "The vulnerability can be mitigated by validating and sanitizing user-input comments.", "Conclusion": "The stored XSS vulnerability in PHP-Fusion's Preview Comment feature highlights the importance of validating and sanitizing user-input data."}, "executive_analysis": {"Overview": "The stored XSS vulnerability in PHP-Fusion's Preview Comment feature allows an authenticated attacker to bypass protection mechanisms using HTML event handlers, posing a significant risk to the security of the application.", "Business Impact": "The vulnerability can lead to phishing, spear phishing, and other types of social engineering attacks, resulting in business impact.", "Technical Impact": "The vulnerability can lead to multiple attacks, including phishing, spear phishing, and other types of social engineering attacks.", "Mitigation Strategies": "Implementing proper input validation and sanitization techniques can effectively mitigate the vulnerability.", "Recommendations": "Recommendations include implementing proper input validation and sanitization techniques, and regularly monitoring for suspicious HTML code in user-input comments.", "Conclusions": "The stored XSS vulnerability in PHP-Fusion's Preview Comment feature highlights the importance of proper input validation and sanitization techniques, as well as regular monitoring for suspicious HTML code in user-input comments."}}