{"id": "CVE-2009-4411", "sourceIdentifier": "cve@mitre.org", "published": "2009-12-24T16:30:00.343", "lastModified": "2017-08-17T01:31:34.367", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The (1) setfacl and (2) getfacl commands in XFS acl 2.2.47, when running in recursive (-R) mode, follow symbolic links even when the --physical (aka -P) or -L option is specified, which might allow local users to modify the ACL for arbitrary files or directories via a symlink attack."}, {"lang": "es", "value": "Los comandos (1) setfacl y (2) getfacl en XFS acl v2.2.47, cuando corre en modo recursivo (-R), sigue enlaces simb\u00f3licos incluso cuando la opci\u00f3n f\u00edsica -- (como -P) o -L est\u00e1 especificada,lo que puede permitir a usuarios locales modificar el ACL por ficheros o directorios de su elecci\u00f3n a trav\u00e9s de un ataque sumlink."}], "vendorComments": [{"organization": "Red Hat", "comment": "Not vulnerable. This issue did not affect the versions of acl as shipped with Red Hat Enterprise Linux 3, 4, or 5.", "lastModified": "2010-01-21T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:H/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "HIGH", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 3.7}, "baseSeverity": "LOW", "exploitabilityScore": 1.9, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xfs:acl:2.2.47:*:*:*:*:*:*:*", "matchCriteriaId": "EF932DC1-59DD-45D4-A8F4-CA1BADB45565"}]}]}], "references": [{"url": "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=499076", "source": "cve@mitre.org"}, {"url": "http://git.savannah.gnu.org/cgit/acl.git/commit/?id=63451a0", "source": "cve@mitre.org"}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2010-02/msg00000.html", "source": "cve@mitre.org"}, {"url": "http://oss.sgi.com/bugzilla/show_bug.cgi?id=790", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/61302", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/37907", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/38420", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2009:345", "source": "cve@mitre.org"}, {"url": "http://www.openwall.com/lists/oss-security/2009/12/23/2", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/37455", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/55004", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1083", "comment": "CVE-2009-4411 - This technique is used to demonstrate the local file inclusion vulnerability, where an attacker can modify the ACL for arbitrary files or directories via a symbolic link attack. A defense point is to disable the -R option for setfacl and getfacl commands, and to restrict access to important files and directories."}, {"techniqueID": "T1036", "comment": "CVE-2009-4411 - This technique is used for file and directory discovery, where an attacker can exploit the local file inclusion vulnerability to identify important files and directories and use them for further attacks. A defense point is to implement strong access controls and monitoring on sensitive files and directories."}, {"techniqueID": "T1134", "comment": "CVE-2009-4411 - This technique is used for privilege escalation, where an attacker can use the local file inclusion vulnerability to gain elevated privileges and execute arbitrary commands. A defense point is to restrict user privileges and monitor for suspicious activities."}, {"techniqueID": "T1040", "comment": "CVE-2009-4411 - This technique is used for command and control, where an attacker can use the local file inclusion vulnerability to establish a command and control channel with the affected system. A defense point is to implement network-level monitoring and intrusion detection systems to detect and block suspicious network traffic."}], "stix_bundle": "//Insert STIX 2.1 bundle here, showing all the related techniques, risks, and defense strategies for this CVE.", "technical_analysis": {"Introduction": "The XFS ACL implementation in XFS acl 2.2.47 allows local users to modify the ACL for arbitrary files or directories via symbolic link attack, leading to a partial confidentiality, integrity, and availability impact.", "Impact and Scope": "CVSS 2.0 metrics: Attack vector: Local, Access complexity: High, Authentication: None, Confidentiality impact: Partial, Integrity impact: Partial, Availability impact: Partial. CVSS 2.0 score: 3.7.", "Related MITRE ATT&CK Techniques": "T1083, T1036, T1134, T1040", "Technical Details": "The vulnerability occurs when using the -R option for setfacl and getfacl commands, which allows the affected system to follow symbolic links even when the --physical (aka -P) or -L option is specified.", "Detection": "Methods for detecting this CVE include monitoring for suspicious activity on affected systems and implementing network-level monitoring and intrusion detection systems.", "Mitigation": "Mitigation strategies for this CVE include disabling the -R option for setfacl and getfacl commands, restricting access to important files and directories, implementing strong access controls, and monitoring for suspicious activities.", "Conclusion": "In conclusion, the CVE-2009-4411 vulnerability in XFS ACL 2.2.47 is a local file inclusion vulnerability that allows local users to modify the ACL for arbitrary files or directories via symbolic link attack. It is essential to implement strong access controls and monitoring on sensitive files and directories to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The XFS ACL implementation in XFS acl 2.2.47 has a local file inclusion vulnerability that allows local users to modify the ACL for arbitrary files or directories via symbolic link attack.", "Business Impact": "This vulnerability can lead to unauthorized access to sensitive files and directories, resulting in potential data breaches and compromised business operations.", "Technical Impact": "This vulnerability can also lead to privilege escalation, allowing attackers to execute arbitrary commands and gain elevated privileges.", "Mitigation Strategies": "Implement strong access controls and monitoring on sensitive files and directories, disable the -R option for setfacl and getfacl commands.", "Recommendations": "For executives, it is recommended to prioritize the mitigation of this vulnerability, especially in critical systems and infrastructure.", "Conclusions": "In conclusion, the CVE-2009-4411 vulnerability in XFS ACL 2.2.47 requires immediate attention and mitigation to avoid potential security risks and business disruptions."}}