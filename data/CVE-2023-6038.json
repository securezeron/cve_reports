{"id": "CVE-2023-6038", "sourceIdentifier": "security@huntr.dev", "published": "2023-11-16T17:15:09.373", "lastModified": "2024-04-16T12:15:08.780", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "A Local File Inclusion (LFI) vulnerability exists in the h2o-3 REST API, allowing unauthenticated remote attackers to read arbitrary files on the server with the permissions of the user running the h2o-3 instance. This issue affects the default installation and does not require user interaction. The vulnerability can be exploited by making specific GET or POST requests to the ImportFiles and ParseSetup endpoints, respectively. This issue was identified in version 3.40.0.4 of h2o-3."}, {"lang": "es", "value": "Un atacante puede leer cualquier archivo en el servidor que aloja el panel de H2O sin ninguna autenticaci\u00f3n."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 9.3, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 4.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-862"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-862"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:h2o:h2o:-:*:*:*:*:*:*:*", "matchCriteriaId": "794A8437-AAB6-4D58-8086-6DA65B54BFD5"}]}]}], "references": [{"url": "https://huntr.com/bounties/380fce33-fec5-49d9-a101-12c972125d8c", "source": "security@huntr.dev", "tags": ["Exploit"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2023-6038 - Local File Inclusion vulnerability can be exploited by making specific GET or POST requests to the ImportFiles and ParseSetup endpoints, allowing unauthenticated remote attackers to read arbitrary files on the server with the permissions of the user running the h2o-3 instance. This can be mitigated by restricting access to these endpoints and implementing Input Validation and Sanitization."}, {"techniqueID": "T1043", "comment": "CVE-2023-6038 - The vulnerability can be exploited by making specific GET or POST requests to the ImportFiles and ParseSetup endpoints, allowing unauthenticated remote attackers to read arbitrary files on the server with the permissions of the user running the h2o-3 instance. This can be detected by monitoring network traffic and system logs for suspicious requests."}, {"techniqueID": "T1055", "comment": "CVE-2023-6038 - The vulnerability can be exploited by making specific GET or POST requests to the ImportFiles and ParseSetup endpoints, allowing unauthenticated remote attackers to read arbitrary files on the server with the permissions of the user running the h2o-3 instance. This can be mitigated by implementing File System Redirection and Whitelisting."}], "stix_bundle": {"@type": "bundle", "id": "bundle--f49f37da-645b-4a2e-a53f-9e0f19b86f5e", "created_by_ref": "identity--8cd5eee9-dc04-4554-8cc5-aa8c44a6c51c", "generated_by_ref": "tool--f03a43f2-dbaa-4626-a14a-b4a9b98a8f6a", "modified": "2023-11-16T17:15:09.373Z", "objects": [{"@type": "vulnerability", "id": "vulnerability--f49f37da-645b-4a2e-a53f-9e0f19b86f5e", "type": "Local File Inclusion", "description": "A Local File Inclusion (LFI) vulnerability exists in the h2o-3 REST API, allowing unauthenticated remote attackers to read arbitrary files on the server with the permissions of the user running the h2o-3 instance.", "cwe": ["CWE-862"], "cvss_v3": {"base_score": 7.5, "base_severity": "HIGH"}, "cvss_v30": {"base_score": 9.3, "base_severity": "CRITICAL"}, "references": [{"@type": "reference", "id": "reference--f49f37da-645b-4a2e-a53f-9e0f19b86f5e", "type": "Exploit", "url": "https://huntr.com/bounties/380fce33-fec5-49d9-a101-12c972125d8c", "source": "security@huntr.dev"}], "mitigations": [{"@type": "course_of_action", "id": "course_of_action--f49f37da-645b-4a2e-a53f-9e0f19b86f5e", "description": "Restrict access to the ImportFiles and ParseSetup endpoints", "technique_refs": ["T1190"]}, {"@type": "course_of_action", "id": "course_of_action--f49f37da-645b-4a2e-a53f-9e0f19b86f5e", "description": "Implement Input Validation and Sanitization", "technique_refs": ["T1190"]}], "detection_ads": [{"@type": "indicator", "id": "indicator--f49f37da-645b-4a2e-a53f-9e0f19b86f5e", "type": "Network Traffic", "description": "Monitor network traffic for suspicious requests to the ImportFiles and ParseSetup endpoints", "technique_refs": ["T1043"]}]}]}, "technical_analysis": {"Introduction": "CVE-2023-6038 is a Local File Inclusion vulnerability in the h2o-3 REST API, allowing unauthenticated remote attackers to read arbitrary files on the server with the permissions of the user running the h2o-3 instance.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 (HIGH) and 9.3 (CRITICAL) in version 3.1 and 3.0 respectively, with an attack vector of NETWORK. It affects the default installation of h2o-3 and does not require user interaction.", "Related MITRE ATT&CK Techniques": "T1190, T1043, T1055", "Technical Details": "The vulnerability can be exploited by making specific GET or POST requests to the ImportFiles and ParseSetup endpoints.", "Detection": "Monitor network traffic and system logs for suspicious requests to the ImportFiles and ParseSetup endpoints.", "Mitigation": "Restrict access to the ImportFiles and ParseSetup endpoints, implement Input Validation and Sanitization, and consider implementing File System Redirection and Whitelisting.", "Conclusion": "CVE-2023-6038 is a serious vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2023-6038 is a critical vulnerability in the h2o-3 REST API that allows unauthenticated remote attackers to read arbitrary files on the server.", "Business Impact": "The vulnerability poses a significant risk to the confidentiality, integrity, and availability of sensitive data.", "Technical Impact": "The vulnerability has the potential to lead to unauthorized access, data theft, and disruption of business operations.", "Mitigation Strategies": "Implement a robust security posture, restrict access to the ImportFiles and ParseSetup endpoints, and consider implementing additional security controls.", "Recommendations": "Prioritize patching and mitigation, and develop a comprehensive incident response plan.", "Conclusions": "CVE-2023-6038 is a critical vulnerability that requires immediate attention and mitigation to protect business operations and sensitive data."}}