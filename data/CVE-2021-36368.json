{
    "id": "CVE-2021-36368",
    "sourceIdentifier": "cve@mitre.org",
    "published": "2022-03-13T00:15:07.937",
    "lastModified": "2024-08-04T01:15:42.867",
    "vulnStatus": "Modified",
    "cveTags": [
        {
            "sourceIdentifier": "cve@mitre.org",
            "tags": [
                "disputed"
            ]
        }
    ],
    "descriptions": [
        {
            "lang": "en",
            "value": "An issue was discovered in OpenSSH before 8.9. If a client is using public-key authentication with agent forwarding but without -oLogLevel=verbose, and an attacker has silently modified the server to support the None authentication option, then the user cannot determine whether FIDO authentication is going to confirm that the user wishes to connect to that server, or that the user wishes to allow that server to connect to a different server on the user's behalf. NOTE: the vendor's position is \"this is not an authentication bypass, since nothing is being bypassed."
        },
        {
            "lang": "es",
            "value": "** EN DISPUTA ** Se ha detectado un problema en OpenSSH versiones anteriores a 8.9. Si un cliente est\u00e1 usando autenticaci\u00f3n de clave p\u00fablica con reenv\u00edo de agentes pero sin -oLogLevel=verbose, y un atacante ha modificado silenciosamente el servidor para que soporte la opci\u00f3n de autenticaci\u00f3n None, entonces el usuario no puede determinar si la autenticaci\u00f3n FIDO va a confirmar que el usuario desea conectarse a ese servidor, o que el usuario desea permitir que ese servidor sea conectado a un servidor diferente en nombre del usuario. NOTA: la posici\u00f3n del proveedor es que \"esto no es una omisi\u00f3n de la autenticaci\u00f3n, ya que no est\u00e1 omiti\u00e9ndose nada\""
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N",
                    "attackVector": "NETWORK",
                    "attackComplexity": "HIGH",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "LOW",
                    "integrityImpact": "NONE",
                    "availabilityImpact": "NONE",
                    "baseScore": 3.7,
                    "baseSeverity": "LOW"
                },
                "exploitabilityScore": 2.2,
                "impactScore": 1.4
            }
        ],
        "cvssMetricV2": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "2.0",
                    "vectorString": "AV:N/AC:H/Au:N/C:P/I:N/A:N",
                    "accessVector": "NETWORK",
                    "accessComplexity": "HIGH",
                    "authentication": "NONE",
                    "confidentialityImpact": "PARTIAL",
                    "integrityImpact": "NONE",
                    "availabilityImpact": "NONE",
                    "baseScore": 2.6
                },
                "baseSeverity": "LOW",
                "exploitabilityScore": 4.9,
                "impactScore": 2.9,
                "acInsufInfo": false,
                "obtainAllPrivilege": false,
                "obtainUserPrivilege": false,
                "obtainOtherPrivilege": false,
                "userInteractionRequired": false
            }
        ]
    },
    "weaknesses": [
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-287"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:openbsd:openssh:*:*:*:*:*:*:*:*",
                            "versionEndExcluding": "8.9",
                            "matchCriteriaId": "E32FF036-1293-4C11-85EB-ACAD8ACBAC2C"
                        }
                    ]
                }
            ]
        },
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*",
                            "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*",
                            "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*",
                            "matchCriteriaId": "FA6FEEC2-9F11-4643-8827-749718254FED"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https://bugzilla.mindrot.org/show_bug.cgi?id=3316",
            "source": "cve@mitre.org",
            "tags": [
                "Issue Tracking",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://docs.ssh-mitm.at/trivialauth.html",
            "source": "cve@mitre.org",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/openssh/openssh-portable/pull/258",
            "source": "cve@mitre.org",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://security-tracker.debian.org/tracker/CVE-2021-36368",
            "source": "cve@mitre.org",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://www.openssh.com/security.html",
            "source": "cve@mitre.org",
            "tags": [
                "Vendor Advisory"
            ]
        }
    ],
    "techniques": [
        {
            "techniqueID": "T1136",
            "comment": "CVE-2021-36368 - This technique is related to the vulnerability as it involves exploiting agent forwarding without logging, which allows an attacker to silently modify the server and potentially bypass authentication checks."
        },
        {
            "techniqueID": "T1497",
            "comment": "CVE-2021-36368 - This technique is related to the vulnerability as it involves exploiting the lack of logging in OpenSSH agent forwarding, which allows an attacker to remain undetected and potentially gain unauthorized access."
        },
        {
            "techniqueID": "T1556",
            "comment": "CVE-2021-36368 - This technique is related to the vulnerability as it involves exploiting the trust relationship between the OpenSSH client and server, which allows an attacker to silently modify the server and potentially gain unauthorized access."
        }
    ],
    "technical_analysis": {
        "Introduction": "CVE-2021-36368 is a vulnerability in OpenSSH that allows an attacker to silently modify the server and potentially bypass authentication checks. This vulnerability affects OpenSSH versions prior to 8.9 and is classified as a moderate CVSS score of 3.7.",
        "Impact and Scope": "The impact of this CVE is moderate, with a CVSS score of 3.7. The attack vector is not complex, and the vulnerability affects OpenSSH versions prior to 8.9. The vulnerability allows an attacker to silently modify the server and potentially bypass authentication checks, which can lead to unauthorized access.",
        "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques identified for this CVE are T1136, T1497, and T1556.",
        "Technical Details": "The vulnerability occurs when an attacker has silently modified the server to support the None authentication option and an OpenSSH client using public-key authentication with agent forwarding but without logging connects to the server.",
        "Detection": "Detection of this CVE can be difficult as the attacker may remain undetected by modifying the server silently. However, detection can be improved by enabling logging and monitoring for unusual server activity.",
        "Mitigation": "The mitigation strategy for this CVE is to ensure that all OpenSSH clients and servers are updated to version 8.9 or later and to enable logging and monitoring for unusual server activity.",
        "Conclusion": "The CVE-2021-36368 vulnerability highlights the importance of regular security updates and enabling logging and monitoring to detect and prevent unauthorized access."
    },
    "executive_analysis": {
        "Overview": "CVE-2021-36368 is a moderate severity vulnerability in OpenSSH that affects versions prior to 8.9 and allows an attacker to silently modify the server.",
        "Business Impact": "The business impact of this CVE is moderate, with the potential for unauthorized access and data breaches.",
        "Technical Impact": "The technical impact of this CVE is significant, with the potential for unauthorized access and data breaches.",
        "Mitigation Strategies": "The recommended mitigation strategy is to ensure that all OpenSSH clients and servers are updated to version 8.9 or later and to enable logging and monitoring for unusual server activity.",
        "Recommendations": "Executives should ensure that their organization has a plan in place for regular security updates and monitoring to detect and prevent unauthorized access.",
        "Conclusions": "The CVE-2021-36368 vulnerability highlights the importance of regular security updates, monitoring, and logging to prevent unauthorized access and data breaches."
    }
}