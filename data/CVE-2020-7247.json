{"id": "CVE-2020-7247", "sourceIdentifier": "cve@mitre.org", "published": "2020-01-29T16:15:12.897", "lastModified": "2024-07-16T17:40:26.627", "vulnStatus": "Analyzed", "cveTags": [], "cisaExploitAdd": "2022-03-25", "cisaActionDue": "2022-04-15", "cisaRequiredAction": "Apply updates per vendor instructions.", "cisaVulnerabilityName": "OpenSMTPD Remote Code Execution Vulnerability", "descriptions": [{"lang": "en", "value": "smtp_mailaddr in smtp_session.c in OpenSMTPD 6.6, as used in OpenBSD 6.6 and other products, allows remote attackers to execute arbitrary commands as root via a crafted SMTP session, as demonstrated by shell metacharacters in a MAIL FROM field. This affects the \"uncommented\" default configuration. The issue exists because of an incorrect return value upon failure of input validation."}, {"lang": "es", "value": "La funci\u00f3n smtp_mailaddr en el archivo smtp_session.c en OpenSMTPD versi\u00f3n 6.6, como es usado en OpenBSD versi\u00f3n 6.6 y otros productos, permite a atacantes remotos ejecutar comandos arbitrarios como root por medio de una sesi\u00f3n SMTP dise\u00f1ada, como es demostrado por metacaracteres de shell en un campo MAIL FROM. Esto afecta la configuraci\u00f3n predeterminada \"uncommented\". El problema se presenta debido a un valor de retorno incorrecto tras un fallo en la comprobaci\u00f3n de entrada."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-755"}, {"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:opensmtpd:6.6:*:*:*:*:*:*:*", "matchCriteriaId": "E2D1D6E5-21BA-40CC-870F-A940DD814532"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*", "matchCriteriaId": "36D96259-24BD-44E2-96D9-78CE1D41F956"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*", "matchCriteriaId": "23A7C53F-B80F-4E6A-AFA9-58EEA84BE11D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:19.10:*:*:*:*:*:*:*", "matchCriteriaId": "A31C8344-3E02-4EB8-8BD8-4C84B7959624"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/156137/OpenBSD-OpenSMTPD-Privilege-Escalation-Code-Execution.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://packetstormsecurity.com/files/156145/OpenSMTPD-6.6.2-Remote-Code-Execution.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://packetstormsecurity.com/files/156249/OpenSMTPD-MAIL-FROM-Remote-Code-Execution.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://packetstormsecurity.com/files/156295/OpenSMTPD-6.6.1-Local-Privilege-Escalation.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://packetstormsecurity.com/files/162093/OpenBSD-OpenSMTPD-6.6-Remote-Code-Execution.html", "source": "cve@mitre.org", "tags": ["Broken Link", "Third Party Advisory", "VDB Entry"]}, {"url": "http://seclists.org/fulldisclosure/2020/Jan/49", "source": "cve@mitre.org", "tags": ["Exploit", "Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2020/01/28/3", "source": "cve@mitre.org", "tags": ["Exploit", "Mailing List", "Third Party Advisory"]}, {"url": "https://github.com/openbsd/src/commit/9dcfda045474d8903224d175907bfc29761dcb45", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/OPH4QU4DNVHA7ACFXMYFCEP5PSXXPN4E/", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://seclists.org/bugtraq/2020/Jan/51", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/4268-1/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2020/dsa-4611", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://www.kb.cert.org/vuls/id/390745", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "US Government Resource"]}, {"url": "https://www.openbsd.org/security.html", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-7247 - OpenSMTPD Server Execution to Remote Code Execution, a Network-based exploit that allows an attacker to execute arbitrary commands as root. To defend against this, ensure that OpenSMTPD is kept up-to-date with the latest security patches, and consider implementing network-based detection and prevention controls to identify and block suspicious traffic."}, {"techniqueID": "T1046", "comment": "CVE-2020-7247 - OpenSMTPD Server Execution to Remote Code Execution, leveraging a known vulnerability to establish a foothold on the network. To defend against this, ensure that OpenSMTPD is kept up-to-date with the latest security patches, and consider implementing network-based detection and prevention controls to identify and block suspicious traffic."}, {"techniqueID": "T1497", "comment": "CVE-2020-7247 - OpenSMTPD Server Execution to Remote Code Execution, leveraging a known vulnerability to escalate privileges on the target system. To defend against this, ensure that OpenSMTPD is kept up-to-date with the latest security patches, and consider implementing privilege escalation detection and prevention controls to identify and block suspicious activity."}], "stix_bundle": {"bundle": {"id": "CVE-2020-7247", "type": "bundle", "spec_version": "2.1", "idref": "-1", "created_by_ref": "user1", "created": "2022-10-10T14:30:00.000Z", "modified": "2022-10-10T14:30:00.000Z", "description": "OpenSMTPD Server Execution to Remote Code Execution", "objects": [{"id": "CVE-2020-7247-vulnerability", "type": "vulnerability", "created_by_ref": "user1", "created": "2022-10-10T14:30:00.000Z", "modified": "2022-10-10T14:30:00.000Z", "name": "OpenSMTPD Server Execution to Remote Code Execution", "description": "OpenSMTPD Server Execution to Remote Code Execution", "modified_by_ref": "user1", "impact_level": "HIGH", "severity": "CRITICAL", "references": [{"url": "http://packetstormsecurity.com/files/156137/OpenBSD-OpenSMTPD-Privilege-Escalation-Code-Execution.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}]}, {"id": "T1190-technique", "type": "attack_pattern", "created_by_ref": "user1", "created": "2022-10-10T14:30:00.000Z", "modified": "2022-10-10T14:30:00.000Z", "name": "Hidden Cobra-APT37-Exploit", "description": "Hidden Cobra-APT37-Exploit", "modified_by_ref": "user1", "technique_id": "T1190"}, {"id": "T1046-technique", "type": "attack_pattern", "created_by_ref": "user1", "created": "2022-10-10T14:30:00.000Z", "modified": "2022-10-10T14:30:00.000Z", "name": "Hidden Cobra-APT37-Exploit", "description": "Hidden Cobra-APT37-Exploit", "modified_by_ref": "user1", "technique_id": "T1046"}, {"id": "T1497-technique", "type": "attack_pattern", "created_by_ref": "user1", "created": "2022-10-10T14:30:00.000Z", "modified": "2022-10-10T14:30:00.000Z", "name": "Hidden Cobra-APT37-Exploit", "description": "Hidden Cobra-APT37-Exploit", "modified_by_ref": "user1", "technique_id": "T1497"}], "relationship": [{"type": "related_to", "idref": "CVE-2020-7247-vulnerability", "object": "T1190-technique"}, {"type": "related_to", "idref": "CVE-2020-7247-vulnerability", "object": "T1046-technique"}, {"type": "related_to", "idref": "CVE-2020-7247-vulnerability", "object": "T1497-technique"}]}}, "technical_analysis": {"Introduction": "CVE-2020-7247 is a remote code execution vulnerability in OpenSMTPD, a popular open-source mail transfer agent.", "Impact and Scope": "The vulnerability allows an attacker to execute arbitrary commands as root, giving them full control over the system. The attack vector is over the network, making it a potential threat to organizations with Remote Access capabilities.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1046, and T1497.", "Technical Details": "The vulnerability exists due to an incorrect return value upon failure of input validation in the smtp_mailaddr function in the smtp_session.c file of OpenSMTPD.", "Detection": "Detection of this vulnerability can be done through network-based detection systems, such as intrusion detection systems or security information and event management systems (SIEMs).", "Mitigation": "The vulnerability can be mitigated by keeping OpenSMTPD up-to-date with the latest security patches, and considering implementing network-based detection and prevention controls to identify and block suspicious traffic.", "Conclusion": "In conclusion, CVE-2020-7247 is a critical vulnerability that allows remote code execution and highlights the importance of keeping software up-to-date and implementing robust security controls to protect against network-based attacks."}, "executive_analysis": {"Overview": "CVE-2020-7247 is a critical remote code execution vulnerability in OpenSMTPD that allows attackers to execute arbitrary commands as root.", "Business Impact": "This vulnerability could lead to significant business disruption and data breaches if exploited.", "Technical Impact": "The vulnerability allows attackers to gain full control over the system, giving them access to sensitive data and systems.", "Mitigation Strategies": "Implementing network-based detection and prevention controls, as well as keeping OpenSMTPD up-to-date with the latest security patches, can help mitigate the risk of this vulnerability being exploited.", "Recommendations": "Executives should prioritize patching OpenSMTPD and implementing robust security controls to protect against network-based attacks.", "Conclusions": "In conclusion, the executives should prioritize addressing this vulnerability and implementing robust security controls to protect against network-based attacks and minimize the risk of data breaches."}}