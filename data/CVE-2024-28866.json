{"id": "CVE-2024-28866", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-14T15:14:46.727", "lastModified": "2024-05-14T16:13:02.773", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "GoCD is a continuous delivery server. GoCD versions from 19.4.0 to 23.5.0 (inclusive) are potentially vulnerable to a reflected cross-site scripting vulnerability on the loading page displayed while GoCD is starting, via abuse of a `redirect_to` query parameter with inadequate validation.\n\nAttackers could theoretically abuse the query parameter to steal session tokens or other values from the user's browser. In practice exploiting this to perform privileged actions is likely rather difficult to exploit because the target user would need to be triggered to open an attacker-crafted link in the period where the server is starting up (but not completely started), requiring chaining with a separate denial-of-service vulnerability. Additionally, GoCD server restarts invalidate earlier session tokens (i.e GoCD does not support persistent sessions), so a stolen session token would be unusable once the server has completed restart, and executed XSS would be done within a logged-out context.\n\nThe issue is fixed in GoCD 24.1.0. As a workaround, it is technically possible in earlier GoCD versions to override the loading page with an earlier version which is not vulnerable, by starting GoCD with the Java system property override as either `-Dloading.page.resource.path=/loading_pages/default.loading.page.html` (simpler early version of loading page without GoCD introduction) or `-Dloading.page.resource.path=/does_not_exist.html` (to display a simple message with no interactivity)."}, {"lang": "es", "value": "GoCD es un servidor de entrega continua. Las versiones de GoCD de 19.4.0 a 23.5.0 (incluida) son potencialmente vulnerables a una vulnerabilidad de Cross Site Scripting reflejado en la p\u00e1gina de carga que se muestra mientras se inicia GoCD, a trav\u00e9s del abuso de un par\u00e1metro de consulta `redirect_to` con validaci\u00f3n inadecuada. En teor\u00eda, los atacantes podr\u00edan abusar del par\u00e1metro de consulta para robar tokens de sesi\u00f3n u otros valores del navegador del usuario. En la pr\u00e1ctica, explotar esto para realizar acciones privilegiadas probablemente sea bastante dif\u00edcil de explotar porque el usuario objetivo necesitar\u00eda ser activado para abrir un enlace creado por el atacante en el per\u00edodo en el que el servidor se est\u00e1 iniciando (pero no completamente iniciado), lo que requiere encadenamiento con un vulnerabilidad de denegaci\u00f3n de servicio separada. Adem\u00e1s, los reinicios del servidor GoCD invalidan los tokens de sesi\u00f3n anteriores (es decir, GoCD no admite sesiones persistentes), por lo que un token de sesi\u00f3n robado quedar\u00eda inutilizable una vez que el servidor haya completado el reinicio, y el XSS ejecutado se realizar\u00eda dentro de un contexto de cierre de sesi\u00f3n. El problema se solucion\u00f3 en GoCD 24.1.0. Como workaround, es t\u00e9cnicamente posible en versiones anteriores de GoCD anular la p\u00e1gina de carga con una versi\u00f3n anterior que no sea vulnerable, iniciando GoCD con la propiedad del sistema Java anulada como `-Dloading.page.resource.path=/loading_pages/ default.loading.page.html` (versi\u00f3n inicial m\u00e1s simple de la p\u00e1gina de carga sin introducci\u00f3n de GoCD) o `-Dloading.page.resource.path=/does_not_exist.html` (para mostrar un mensaje simple sin interactividad)."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.1, "baseSeverity": "LOW"}, "exploitabilityScore": 1.6, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "references": [{"url": "https://github.com/gocd/gocd/commit/388d8893ec4cac51d2b76e923cc9b55c7703e402", "source": "security-advisories@github.com"}, {"url": "https://github.com/gocd/gocd/releases/tag/24.1.0", "source": "security-advisories@github.com"}, {"url": "https://github.com/gocd/gocd/security/advisories/GHSA-q882-q6mm-mgvh", "source": "security-advisories@github.com"}, {"url": "https://www.gocd.org/releases/#24-1-0", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1082", "comment": "CVE-2024-28866 - This vulnerability in GoCD is related to reflected cross-site scripting, where an attacker can steal session tokens or other values from a user's browser. Defending against this involves ensuring proper validation on the redirect_to query parameter."}, {"techniqueID": "T1437", "comment": "CVE-2024-28866 - This vulnerability also involves the use of a denial-of-service vulnerability to chain with the reflected cross-site scripting, making it more difficult to defend against. Defending against this involves identifying and mitigating denial-of-service attacks on GoCD servers."}, {"techniqueID": "T1566", "comment": "CVE-2024-28866 - This vulnerability can be exploited by an attacker to steal session tokens or other values from a user's browser. Defending against this involves implementing measures to detect and prevent session token theft, such as monitoring for unauthorized access to session tokens."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "indicator--54a1c48c-87fa-4a17-b2ce-0f85c89f0ed2", "created": "2024-05-14T15:14:46.727", "modified": "2024-05-14T16:13:02.773", "name": "GoCD Reflected Cross-Site Scripting", "description": "CVE-2024-28866: GoCD Reflected Cross-Site Scripting", "labels": ["cross-site scripting", "GoCD", "reflected"], "grouping": ["Indicator"], "observables": ["The 'redirect_to' query parameter in GoCD is not properly validated"], "core_ordering": 1}, {"type": "note", "id": "note--54a1c48c-87fa-4a17-b2ce-0f85c89f0ed3", "created": "2024-05-14T15:14:46.727", "modified": "2024-05-14T16:13:02.773", "name": "Defense against Cross-Site Scripting", "description": "Improper validation of the 'redirect_to' query parameter allows cross-site scripting attacks. To defend against this, ensure proper validation of this parameter to prevent attackers from abusing it.", "labels": ["defense", "cross-site scripting"], "body": "Validation of the 'redirect_to' query parameter is crucial in preventing cross-site scripting attacks.", "core_ordering": 2}], "relationship": {"indicator": {"note": {"relationship_type": "is_related_to"}}}}, "technical_analysis": {"Introduction": "GoCD is a continuous delivery server that is potentially vulnerable to a reflected cross-site scripting vulnerability.", "Impact and Scope": "The vulnerability allows attackers to steal session tokens or other values from a user's browser. The impact is moderate, with a CVSS score of 3.1.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the use of reflected cross-site scripting and denial-of-service attacks.", "Technical Details": "The vulnerability occurs when the 'redirect_to' query parameter is not properly validated. This allows attackers to steal session tokens or other values from a user's browser.", "Detection": "Detection involves monitoring for unauthorized access to session tokens or other values from a user's browser.", "Mitigation": "Mitigation involves implementing proper validation of the 'redirect_to' query parameter to prevent attackers from abusing it.", "Conclusion": "The vulnerability is a moderate risk and can be mitigated through proper validation of the 'redirect_to' query parameter."}, "executive_analysis": {"Overview": "GoCD is a continuous delivery server that is potentially vulnerable to a reflected cross-site scripting vulnerability.", "Business Impact": "The vulnerability allows attackers to steal sensitive information and potentially disrupt business operations.", "Technical Impact": "The vulnerability allows attackers to steal session tokens or other values from a user's browser.", "Mitigation Strategies": "Implement proper validation of the 'redirect_to' query parameter to prevent attackers from abusing it.", "Recommendations": "Recommendations include ensuring proper validation of the 'redirect_to' query parameter and monitoring for unauthorized access to session tokens or other values from a user's browser.", "Conclusions": "The vulnerability is a moderate risk and should be addressed through proper validation of the 'redirect_to' query parameter."}}