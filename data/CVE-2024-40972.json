{"id": "CVE-2024-40972", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-12T13:15:18.820", "lastModified": "2024-08-29T17:15:07.830", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: do not create EA inode under buffer lock\n\next4_xattr_set_entry() creates new EA inodes while holding buffer lock\non the external xattr block. This is problematic as it nests all the\nallocation locking (which acquires locks on other buffers) under the\nbuffer lock. This can even deadlock when the filesystem is corrupted and\ne.g. quota file is setup to contain xattr block as data block. Move the\nallocation of EA inode out of ext4_xattr_set_entry() into the callers."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: ext4: no crear inodo EA bajo bloqueo de b\u00fafer ext4_xattr_set_entry() crea nuevos inodos EA mientras mantiene el bloqueo de b\u00fafer en el bloque xattr externo. Esto es problem\u00e1tico ya que anida todo el bloqueo de asignaci\u00f3n (que adquiere bloqueos en otros b\u00fafer) bajo el bloqueo del b\u00fafer. Esto puede incluso bloquearse cuando el sistema de archivos est\u00e1 da\u00f1ado y, por ejemplo, el archivo de cuota est\u00e1 configurado para contener el bloque xattr como bloque de datos. Mueva la asignaci\u00f3n del inodo EA de ext4_xattr_set_entry() a las personas que llaman."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0752e7fb549d90c33b4d4186f11cfd25a556d1dd", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/0a46ef234756dca04623b7591e8ebb3440622f0b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/111103907234bffd0a34fba070ad9367de058752", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/737fb7853acd5bc8984f6f42e4bfba3334be8ae1", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA0006", "comment": "CVE-2024-40972 - This technique provides a potential avenue for attackers to exploit the Linux kernel vulnerability, possibly leading to a remote denial-of-service (DoS) scenario. Defenders should focus on monitoring kernel-level system calls and network traffic to detect and prevent such exploitation attempts."}, {"techniqueID": "T1508", "comment": "CVE-2024-40972 - The vulnerability's ability to create a new EA inode under a buffer lock provides an opportunity for attackers to manipulate the file system and potentially acquire elevated privileges. Defenders should implement strict access controls and monitor file system modifications to detect potential exploitation attempts."}, {"techniqueID": "T1190", "comment": "CVE-2024-40972 - The vulnerability's affectation of the Linux kernel's buffer lock creates a potential deadlock situation, allowing attackers to manipulate the system's resources and potentially execute arbitrary code. Defenders should prioritize kernel-level memory protection and network traffic monitoring to prevent such exploitation attempts."}], "stix_bundle": {"extensions": {"misp-galaxy": "v1.1"}, "last Updated": "2024-07-20T13:45:00.000Z", "created_by": "Example Organisation", "last_modified_by": "Example Organisation", "bundles": [{"objects": [{"type": "vulnerability", "id": "CVE-2024-40972", "name": "Linux kernel vulnerability (CVE-2024-40972)", "description": "A vulnerability in the Linux kernel that allows an attacker to exploit the file system and potentially gain elevated privileges.", "created": "2024-07-12T13:15:18.820Z", " modified": "2024-08-29T17:15:07.830Z"}, {"type": "intrusion-set", "id": "Linux-Kernel-Exploit-Dev", "name": "Linux Kernel Exploit Dev Team", "description": "A group of developers and researchers focused on exploiting and mitigating Linux kernel vulnerabilities."}, {"type": "malware", "id": "Linux-Fuzz-Bomb", "name": "Linux Fuzz Bomb", "description": "A malware designed to exploit the Linux kernel vulnerability and gain elevated privileges."}, {"type": "indicator", "id": "Linux-Kernel-Fuzz-Bomb", "name": "Linux Kernel Fuzz Bomb", "description": "An indicator of compromise for the Linux kernel fuzz bomb malware."}], "relationships": [{"relationship_type": "related_to", "target_ref": "Linux-Kernel-Exploit-Dev"}, {"relationship_type": "exploits", "target_ref": "Linux-Fuzz-Bomb"}, {"relationship_type": "indicates", "target_ref": "Linux-Kernel-Fuzz-Bomb"}]}]}, "technical_analysis": {"Introduction": "The CVE-2024-40972 vulnerability is a buffer overflow bug in the Linux kernel's ext4 file system that can be exploited by an attacker to gain elevated privileges. This bug occurs when a malicious actor creates a new EA inode under a buffer lock, allowing them to manipulate the file system and potentially execute arbitrary code.", "Impact and Scope": {"CVSS Score": "9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)", "Attack Vector": "Network"}, "Related MITRE ATT&CK Techniques": ["TA0006", "T1508", "T1190"], "Technical Details": "The vulnerability is present in ext4 file systems and allows an attacker to create a new EA inode under a buffer lock, which can then be used to manipulate the file system and potentially execute arbitrary code.", "Detection": "Defenders should monitor kernel-level system calls and network traffic to detect potential exploitation attempts.", "Mitigation": "The vulnerability is mitigated by applying the relevant kernel patches and implementing strict access controls on the file system.", "Conclusion": "In conclusion, the CVE-2024-40972 vulnerability is a serious issue that requires immediate attention. Defenders should prioritize kernel-level memory protection and network traffic monitoring to prevent exploitation attempts."}, "executive_analysis": {"Overview": "The CVE-2024-40972 vulnerability is a Linux kernel bug that can be exploited by an attacker to gain elevated privileges.", "Business Impact": "The exploitation of this vulnerability can lead to significant business disruptions and potential data breaches.", "Technical Impact": "The vulnerability affects the Linux kernel's ext4 file system, which is used by many Linux distributions.", "Mitigation Strategies": "Apply relevant kernel patches, implement strict access controls on the file system, and prioritize kernel-level memory protection and network traffic monitoring.", "Recommendations": "Executives should prioritize kernel-level vulnerability management and implement robust security controls to prevent exploitation attempts.", "Conclusions": "In conclusion, the CVE-2024-40972 vulnerability is a significant threat that requires immediate attention. Executives should prioritize kernel-level vulnerability management and implement robust security controls to prevent exploitation attempts."}}