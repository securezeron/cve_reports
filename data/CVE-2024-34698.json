{"id": "CVE-2024-34698", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-14T15:39:27.840", "lastModified": "2024-05-14T16:12:23.490", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "FreeScout is a free, self-hosted help desk and shared mailbox. Versions of FreeScout prior to 1.8.139 contain a Prototype Pollution vulnerability in the `/public/js/main.js` source file. The Prototype Pollution arises because the `getQueryParam` Function recursively merges an object containing user-controllable properties into an existing object (For URL Query Parameters Parsing), without first sanitizing the keys. This can allow an attacker to inject a property with a key `__proto__`, along with arbitrarily nested properties. The merge operation assigns the nested properties to the `params` object's prototype instead of the target object itself. As a result, the attacker can pollute the prototype with properties containing harmful values, which are then inherited by user-defined objects and subsequently used by the application dangerously. The vulnerability lets an attacker control properties of objects that would otherwise be inaccessible. If the application subsequently handles an attacker-controlled property in an unsafe way, this can potentially be chained with other vulnerabilities like DOM-based XSS, Open Redirection, Cookie Manipulation, Link Manipulation, HTML Injection, etc. Version 1.8.139 contains a patch for the issue."}, {"lang": "es", "value": "FreeScout es un servicio de asistencia gratuito y un buz\u00f3n de correo compartido autohospedado. Las versiones de FreeScout anteriores a la 1.8.139 contienen una vulnerabilidad de contaminaci\u00f3n de prototipo en el archivo fuente `/public/js/main.js`. La contaminaci\u00f3n del prototipo surge porque la funci\u00f3n `getQueryParam` fusiona recursivamente un objeto que contiene propiedades controlables por el usuario en un objeto existente (para el an\u00e1lisis de par\u00e1metros de consulta de URL), sin sanitizar primero las claves. Esto puede permitir a un atacante inyectar una propiedad con una clave `__proto__`, junto con propiedades anidadas arbitrariamente. La operaci\u00f3n de fusi\u00f3n asigna las propiedades anidadas al prototipo del objeto `params` en lugar del propio objeto de destino. Como resultado, el atacante puede contaminar el prototipo con propiedades que contienen valores da\u00f1inos, que luego son heredados por objetos definidos por el usuario y posteriormente utilizados peligrosamente por la aplicaci\u00f3n. La vulnerabilidad permite a un atacante controlar propiedades de objetos que de otro modo ser\u00edan inaccesibles. Si posteriormente la aplicaci\u00f3n maneja una propiedad controlada por un atacante de forma insegura, esto puede potencialmente encadenarse con otras vulnerabilidades como XSS basado en DOM, redirecci\u00f3n abierta, manipulaci\u00f3n de cookies, manipulaci\u00f3n de enlaces, inyecci\u00f3n de HTML, etc. La versi\u00f3n 1.8.139 contiene un parche para el tema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.6, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1321"}]}], "references": [{"url": "https://github.com/freescout-helpdesk/freescout/commit/2614514bc6d6c4ad563202a1c9cae5a97b195cc5", "source": "security-advisories@github.com"}, {"url": "https://github.com/freescout-helpdesk/freescout/security/advisories/GHSA-rx6j-4c33-9h3r", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1169", "comment": "CVE-2024-34698 - Attacker can inject a property with a key __proto__, and arbitrarily nested properties, allowing them to pollute the prototype with malicious values, which are then inherited by user-defined objects."}, {"techniqueID": "T1190", "comment": "CVE-2024-34698 - Prototype pollution vulnerability allows an attacker to control properties of objects that would otherwise be inaccessible, potentially leading to further vulnerabilities being chained."}, {"techniqueID": "T1191", "comment": "CVE-2024-34698 - Application handling of attacker-controlled properties in an unsafe way can potentially be chained with other vulnerabilities."}, {"techniqueID": "T1193", "comment": "CVE-2024-34698 - An attacker can manipulate URL query parameters to inject malicious data, which is then used to pollute the prototype."}], "stix_bundle": {"type": "bundle", "id": "bundle--CVE-2024-34698", "label": "CVE-2024-34698 Bundle", "created_by_ref": "user--security-expert", "created": "2024-05-14T15:39:27.840", "modified": "2024-05-14T16:12:23.490", "objects": [{"type": "vulnerability", "id": "vulnerability--CVE-2024-34698", "created_by_ref": "user--security-expert", "created": "2024-05-14T15:39:27.840", "modified": "2024-05-14T16:12:23.490", "name": "FreeScout Prototype Pollution", "description": {"lang": "en", "value": "FreeScout is a free, self-hosted help desk and shared mailbox. Versions of FreeScout prior to 1.8.139 contain a Prototype Pollution vulnerability in the /public/js/main.js source file."}}, {"type": "attack-pattern", "id": "attack-pattern--T1169", "created_by_ref": "user--security-expert", "created": "2024-05-14T15:39:27.840", "modified": "2024-05-14T16:12:23.490", "name": "Prototype Pollution", "description": {"lang": "en", "value": "An attacker can inject a property with a key __proto__, and arbitrarily nested properties, allowing them to pollute the prototype with malicious values, which are then inherited by user-defined objects."}}, {"type": "attack-pattern", "id": "attack-pattern--T1190", "created_by_ref": "user--security-expert", "created": "2024-05-14T15:39:27.840", "modified": "2024-05-14T16:12:23.490", "name": "Chained Vulnerabilities", "description": {"lang": "en", "value": "Prototype pollution vulnerability allows an attacker to control properties of objects that would otherwise be inaccessible, potentially leading to further vulnerabilities being chained."}}, {"type": "course-of-action", "id": "course-of-action--mitigation-strategy", "created_by_ref": "user--security-expert", "created": "2024-05-14T15:39:27.840", "modified": "2024-05-14T16:12:23.490", "name": "Mitigation Strategy", "description": {"lang": "en", "value": "Upgrade to version 1.8.139 or later, patch the vulnerability, or use a Content Security Policy (CSP) to restrict the execution of JavaScript."}}, {"type": "note", "id": "note--CVE-2024-34698", "created_by_ref": "user--security-expert", "created": "2024-05-14T15:39:27.840", "modified": "2024-05-14T16:12:23.490", "name": "Detection and Mitigation", "description": {"lang": "en", "value": "Detection can be done using a web application scanner or by analyzing the application's source code. Mitigation involves updating the application to the latest version or using a Content Security Policy (CSP) to restrict the execution of JavaScript."}}], "relationships": [{"type": "has-vulnerability", "id": "bundle--CVE-2024-34698 has-vulnerability:vulnerability--CVE-2024-34698", "sourced_id": "vulnerability--CVE-2024-34698", "target_id": "bundle--CVE-2024-34698"}, {"type": "relates-to", "id": "bundle--CVE-2024-34698 relates-to:attack-pattern--T1169", "sourced_id": "attack-pattern--T1169", "target_id": "bundle--CVE-2024-34698"}, {"type": "relates-to", "id": "bundle--CVE-2024-34698 relates-to:attack-pattern--T1190", "sourced_id": "attack-pattern--T1190", "target_id": "bundle--CVE-2024-34698"}, {"type": "relates-to", "id": "bundle--CVE-2024-34698 relates-to:course-of-action--mitigation-strategy", "sourced_id": "course-of-action--mitigation-strategy", "target_id": "bundle--CVE-2024-34698"}, {"type": "relates-to", "id": "bundle--CVE-2024-34698 relates-to:note--CVE-2024-34698", "sourced_id": "note--CVE-2024-34698", "target_id": "bundle--CVE-2024-34698"}]}, "technical_analysis": {"Introduction": "FreeScout is a free, self-hosted help desk and shared mailbox that contains a Prototype Pollution vulnerability.", "Impact and Scope": "The vulnerability affects versions of FreeScout prior to 1.8.139 and has a CVSS score of 4.6.", "Related MITRE ATT&CK Techniques": "T1169, T1190, T1191, T1193", "Technical Details": "The vulnerability arises because the getQueryParam function recursively merges an object containing user-controllable properties into an existing object without sanitizing the keys.", "Detection": "Detection can be done using a web application scanner or by analyzing the application's source code.", "Mitigation": "Mitigation involves updating the application to the latest version or using a Content Security Policy (CSP) to restrict the execution of JavaScript.", "Conclusion": "The vulnerability is a serious security risk and should be patched as soon as possible."}, "executive_analysis": {"Overview": "FreeScout is a free, self-hosted help desk and shared mailbox that contains a Prototype Pollution vulnerability.", "Business Impact": "The vulnerability can lead to further vulnerabilities being chained, resulting in a significant business impact.", "Technical Impact": "The vulnerability has a CVSS score of 4.6 and affects versions of FreeScout prior to 1.8.139.", "Mitigation Strategies": "Update to the latest version, use a Content Security Policy (CSP) to restrict the execution of JavaScript.", "Recommendations": "Recommend upgrading to the latest version or using a Content Security Policy (CSP) to restrict the execution of JavaScript.", "Conclusions": "The vulnerability is a serious security risk and should be patched as soon as possible."}}