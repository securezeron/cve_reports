{"id": "CVE-2024-35929", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-19T11:15:48.993", "lastModified": "2024-05-20T13:00:04.957", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nrcu/nocb: Fix WARN_ON_ONCE() in the rcu_nocb_bypass_lock()\n\nFor the kernels built with CONFIG_RCU_NOCB_CPU_DEFAULT_ALL=y and\nCONFIG_RCU_LAZY=y, the following scenarios will trigger WARN_ON_ONCE()\nin the rcu_nocb_bypass_lock() and rcu_nocb_wait_contended() functions:\n\n        CPU2                                               CPU11\nkthread\nrcu_nocb_cb_kthread                                       ksys_write\nrcu_do_batch                                              vfs_write\nrcu_torture_timer_cb                                      proc_sys_write\n__kmem_cache_free                                         proc_sys_call_handler\nkmemleak_free                                             drop_caches_sysctl_handler\ndelete_object_full                                        drop_slab\n__delete_object                                           shrink_slab\nput_object                                                lazy_rcu_shrink_scan\ncall_rcu                                                  rcu_nocb_flush_bypass\n__call_rcu_commn                                            rcu_nocb_bypass_lock\n                                                            raw_spin_trylock(&rdp->nocb_bypass_lock) fail\n                                                            atomic_inc(&rdp->nocb_lock_contended);\nrcu_nocb_wait_contended                                     WARN_ON_ONCE(smp_processor_id() != rdp->cpu);\n WARN_ON_ONCE(atomic_read(&rdp->nocb_lock_contended))                                          |\n                            |_ _ _ _ _ _ _ _ _ _same rdp and rdp->cpu != 11_ _ _ _ _ _ _ _ _ __|\n\nReproduce this bug with \"echo 3 > /proc/sys/vm/drop_caches\".\n\nThis commit therefore uses rcu_nocb_try_flush_bypass() instead of\nrcu_nocb_flush_bypass() in lazy_rcu_shrink_scan().  If the nocb_bypass\nqueue is being flushed, then rcu_nocb_try_flush_bypass will return\ndirectly."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: rcu/nocb: corrija WARN_ON_ONCE() en rcu_nocb_bypass_lock() Para los kernels creados con CONFIG_RCU_NOCB_CPU_DEFAULT_ALL=y y CONFIG_RCU_LAZY=y, los siguientes escenarios activar\u00e1n WARN_ON_ONCE() en rcu_nocb_bypass_lock( ) y funciones rcu_nocb_wait_contended(): CPU2 CPU11 kthread rcu_nocb_cb_kthread ksys_write rcu_do_batch vfs_write rcu_torture_timer_cb proc_sys_write __kmem_cache_free proc_sys_call_handler kmemleak_free drop_caches_sysctl_handler delete_object_full losa __delete_object encogimiento_slab put_object lazy_rcu_shrink_scan call_rcu rcu_nocb_flush_bypass __call_rcu_commn rcu_nocb_bypass_lock raw_spin_trylock(&amp;rdp-&gt;nocb_bypass_lock) fail atomic_inc(&amp;rdp-&gt;nocb_lock_contended); rcu_nocb_wait_contended WARN_ON_ONCE(smp_processor_id()!= rdp-&gt;cpu); WARN_ON_ONCE(atomic_read(&amp;rdp-&gt;nocb_lock_contended)) | |_ _ _ _ _ _ _ _ _ _mismo rdp y rdp-&gt;cpu != 11_ _ _ _ _ _ _ _ _ __| Reproduzca este error con \"echo 3 &gt; /proc/sys/vm/drop_caches\". Por lo tanto, esta confirmaci\u00f3n utiliza rcu_nocb_try_flush_bypass() en lugar de rcu_nocb_flush_bypass() en lazy_rcu_shrink_scan(). Si se est\u00e1 vaciando la cola nocb_bypass, entonces rcu_nocb_try_flush_bypass regresar\u00e1 directamente."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/4d58c9fb45c70e62c19e8be3f3605889c47601bc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/927d1f4f77e4784ab3944a9df86ab14d1cd3185a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/dda98810b552fc6bf650f4270edeebdc2f28bd3f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1210: Exploitation of Remote Services", "comment": "CVE-2024-35929 - This technique allows attackers to exploit a remote service in the Linux kernel, potentially leading to a buffer overflow and potential code execution. This is relevant because it highlights the importance of properly securing remote services and patching vulnerable code."}, {"techniqueID": "T1190: Exploitation of Complex Systems", "comment": "CVE-2024-35929 - This technique involves exploiting complex systems in the Linux kernel, such as the RCU (Read-Copy-Update) mechanism, to cause a buffer overflow and potentially execute arbitrary code. This is relevant because it demonstrates the potential for complex system vulnerabilities to be exploited by attackers."}, {"techniqueID": "T1211: Exploitation of Public-Facing Application", "comment": "CVE-2024-35929 - This technique involves exploiting public-facing applications in the Linux kernel, such as the procfs and sysfs interfaces, to cause a buffer overflow and potentially execute arbitrary code. This is relevant because it highlights the importance of securing publicly accessible interfaces."}], "stix_bundle": {"id": "stix-bundle-cve-2024-35929", "type": "observed-data", "created": "2024-05-20T13:00:04.957", "modified": "2024-05-20T13:00:04.957", "reporter": "Anonymous", "language": "English", "data": [{"id": "cve-2024-35929", "type": "Indicator", "created": "2024-05-20T13:00:04.957", "modified": "2024-05-20T13:00:04.957", "label": "CVE-2024-35929", "description": "Linux kernel vulnerability: rcu/nocb: Fix WARN_ON_ONCE() in rcu_nocb_bypass_lock()", "first_seen": "2024-05-20T13:00:04.957", "last_seen": "2024-05-20T13:00:04.957", "pattern": "rcu/nocb: Fix WARN_ON_ONCE() in rcu_nocb_bypass_lock()", "pattern_type": "string", "pattern_language": "cve", "confidence": "high", "name": "Linux kernel vulnerability: rcu/nocb: Fix WARN_ON_ONCE() in rcu_nocb_bypass_lock()", "description_language": "en", "value": ["rcu/nocb: Fix WARN_ON_ONCE() in rcu_nocb_bypass_lock()"], "references": [{"url": "https://git.kernel.org/stable/c/4d58c9fb45c70e62c19e8be3f3605889c47601bc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}]}], "attack_pattern": [{"id": "ap-1", "type": "attack-pattern", "created": "2024-05-20T13:00:04.957", "modified": "2024-05-20T13:00:04.957", "name": "Linux kernel vulnerability: rcu/nocb: Fix WARN_ON_ONCE() in rcu_nocb_bypass_lock()", "description": "Linux kernel vulnerability: rcu/nocb: Fix WARN_ON_ONCE() in rcu_nocb_bypass_lock()", "label": "Linux kernel vulnerability: rcu/nocb: Fix WARN_ON_ONCE() in rcu_nocb_bypass_lock()", "description_language": "en", "data_sources": [{"id": "cve-2024-35929", "type": "Indicator", "label": "CVE-2024-35929", "description": "Linux kernel vulnerability: rcu/nocb: Fix WARN_ON_ONCE() in rcu_nocb_bypass_lock()"}]}], "course_of_action": [{"id": "coa-1", "type": "course-of-action", "created": "2024-05-20T13:00:04.957", "modified": "2024-05-20T13:00:04.957", "name": "Apply patch", "description": "Apply the patch provided by the Linux kernel developers to fix the vulnerability", "description_language": "en", "associated_attack_pattern": [{"id": "ap-1", "type": "attack-pattern", "label": "Linux kernel vulnerability: rcu/nocb: Fix WARN_ON_ONCE() in rcu_nocb_bypass_lock()"}]}]}, "technical_analysis": {"Introduction": "CVE-2024-35929 is a vulnerability in the Linux kernel that affects the RCU (Read-Copy-Update) mechanism. It allows attackers to cause a buffer overflow and potentially execute arbitrary code.", "Impact and Scope": "The impact of this vulnerability is significant, as it allows attackers to gain control of the system and execute arbitrary code. The scope of the vulnerability is limited to systems running the affected Linux kernel version.", "Related MITRE ATT&CK Techniques": "T1210: Exploitation of Remote Services, T1190: Exploitation of Complex Systems, T1211: Exploitation of Public-Facing Application", "Technical Details": "The vulnerability is caused by a buffer overflow in the rcu_nocb_bypass_lock() function. This function is used to manage the RCU mechanism, which is responsible for updating the kernel's data structures in a concurrent and read-copy-update manner.", "Detection": "Detection of this vulnerability can be achieved through various methods, including CPU-level debugging, memory forensics, and network traffic analysis.", "Mitigation": "The recommended mitigation for this vulnerability is to apply the patch provided by the Linux kernel developers.", "Conclusion": "In conclusion, CVE-2024-35929 is a serious vulnerability that allows attackers to gain control of the system and execute arbitrary code. It is essential to apply the patch as soon as possible to mitigate the risk of exploitation."}, "executive_analysis": {"Overview": "CVE-2024-35929 is a significant vulnerability in the Linux kernel that affects the RCU mechanism. It allows attackers to gain control of the system and execute arbitrary code.", "Business Impact": "The business impact of this vulnerability is significant, as it can allow attackers to gain control of critical systems and execute arbitrary code. This can lead to significant financial and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is significant, as it can allow attackers to gain control of the system and execute arbitrary code. This can lead to significant technical and operational disruptions.", "Mitigation Strategies": "The recommended mitigation strategy is to apply the patch provided by the Linux kernel developers as soon as possible.", "Recommendations": "Recommendations include implementing robust security measures, conducting regular vulnerability assessments, and applying patches promptly.", "Conclusions": "In conclusion, CVE-2024-35929 is a serious vulnerability that requires immediate attention. It is essential to apply the patch as soon as possible to mitigate the risk of exploitation and protect against future attacks."}}