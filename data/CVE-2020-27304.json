{"id": "CVE-2020-27304", "sourceIdentifier": "vuln@vdoo.com", "published": "2021-10-21T16:15:07.737", "lastModified": "2022-06-14T11:15:09.047", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The CivetWeb web library does not validate uploaded filepaths when running on an OS other than Windows, when using the built-in HTTP form-based file upload mechanism, via the mg_handle_form_request API. Web applications that use the file upload form handler, and use parts of the user-controlled filename in the output path, are susceptible to directory traversal"}, {"lang": "es", "value": "La biblioteca web CivetWeb no comprueba las rutas de los archivos cargados cuando se ejecuta en un sistema operativo distinto de Windows, cuando es usado el mecanismo incorporado de carga de archivos basado en formularios HTTP, por medio de la API mg_handle_form_request. Las aplicaciones web que usan el manejador de formularios de carga de archivos, y usan partes del nombre de archivo controlado por el usuario en la ruta de salida, son susceptibles a un salto de directorio"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}, {"source": "vuln@vdoo.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-23"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:civetweb_project:civetweb:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.8", "versionEndExcluding": "1.15", "matchCriteriaId": "86B4245C-5C12-424B-A771-E04CE3516108"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:siemens:sinec_infrastructure_network_services:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.0.1.1", "matchCriteriaId": "B0F46497-4AB0-49A7-9453-CC26837BF253"}]}]}], "references": [{"url": "https://cert-portal.siemens.com/productcert/pdf/ssa-222547.pdf", "source": "vuln@vdoo.com"}, {"url": "https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf", "source": "vuln@vdoo.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://groups.google.com/g/civetweb/c/yPBxNXdGgJQ", "source": "vuln@vdoo.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://jfrog.com/blog/cve-2020-27304-rce-via-directory-traversal-in-civetweb-http-server/", "source": "vuln@vdoo.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1204", "comment": "Using the CIS-CVentures system to generate cross-site scripting exploits, where a GET request is made to a URL parameter, allowing an attacker to inject malicious JavaScript and take control of the user's session. - CVE-2020-27304 may use similar tactics to exploit directory traversal vulnerability."}, {"techniqueID": "T1210", "comment": "Using the CivetWeb web library's file upload mechanism to deliver malicious files, allowing an attacker to execute arbitrary code. - CVE-2020-27304 may use similar tactics to exploit file upload vulnerability."}, {"techniqueID": "T1190", "comment": "Using directory traversal to access files and directories outside of the intended scope, allowing an attacker to steal sensitive files or inject malicious code. - CVE-2020-27304 uses directory traversal to access files outside of the intended scope."}, {"techniqueID": "T1191", "comment": "Using user-controlled data to construct a directory traversal payload, allowing an attacker to access arbitrary files and directories. - CVE-2020-27304 uses user-controlled data to construct directory traversal payloads."}, {"techniqueID": "T1199", "comment": "Exploiting a web application's file upload mechanism to deliver malware or execute arbitrary code. - CVE-2020-27304 uses file upload mechanism to deliver malicious files."}], "technical_analysis": {"Introduction": "CVE-2020-27304 is a remote code execution vulnerability in the CivetWeb web library, allowing attackers to exploit directory traversal and file upload mechanisms.", "Impact and Scope": "CVSS score 9.8 (Critical) with a CVSS:3.1 base score of 9.8, attack vector NETWORK, and attack complexity LOW.", "Related MITRE ATT&CK Techniques": "T1204, T1210, T1190, T1191, and T1199", "Technical Details": "CVE-2020-27304 allows attackers to exploit directory traversal and file upload mechanisms, potentially leading to remote code execution. The CivetWeb web library's file upload mechanism is vulnerable to directory traversal attacks when an attacker uploads a malicious file.", "Detection": "Using intrusion detection systems (IDS) to monitor for suspicious network traffic and file access patterns.", "Mitigation": "Implementing rate limiting and IP blocking to prevent brute-force attacks, using whitelisting to restrict file uploads, and regularly updating the CivetWeb web library to the latest version.", "Conclusion": "CVE-2020-27304 is a severe vulnerability that requires immediate attention and action to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2020-27304 is a critical vulnerability in the CivetWeb web library that allows remote code execution and requires immediate attention.", "Business Impact": "Exploitation of this vulnerability could lead to significant financial losses, reputational damage, and legal action.", "Technical Impact": "CVE-2020-27304 allows attackers to execute arbitrary code, steal sensitive files, and inject malicious code, making it a high-priority vulnerability to address.", "Mitigation Strategies": "Implementing rate limiting and IP blocking, using whitelisting to restrict file uploads, and regularly updating the CivetWeb web library.", "Recommendations": "Immediately apply security patches, implement robust security controls, and conduct regular vulnerability assessments and penetration testing.", "Conclusions": "CVE-2020-27304 is a critical vulnerability that requires immediate attention and action to prevent exploitation. Executives should prioritize this vulnerability and take swift action to mitigate its risks."}}