{"id": "CVE-2024-26586", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-02-22T17:15:08.890", "lastModified": "2024-06-25T21:15:57.593", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmlxsw: spectrum_acl_tcam: Fix stack corruption\n\nWhen tc filters are first added to a net device, the corresponding local\nport gets bound to an ACL group in the device. The group contains a list\nof ACLs. In turn, each ACL points to a different TCAM region where the\nfilters are stored. During forwarding, the ACLs are sequentially\nevaluated until a match is found.\n\nOne reason to place filters in different regions is when they are added\nwith decreasing priorities and in an alternating order so that two\nconsecutive filters can never fit in the same region because of their\nkey usage.\n\nIn Spectrum-2 and newer ASICs the firmware started to report that the\nmaximum number of ACLs in a group is more than 16, but the layout of the\nregister that configures ACL groups (PAGT) was not updated to account\nfor that. It is therefore possible to hit stack corruption [1] in the\nrare case where more than 16 ACLs in a group are required.\n\nFix by limiting the maximum ACL group size to the minimum between what\nthe firmware reports and the maximum ACLs that fit in the PAGT register.\n\nAdd a test case to make sure the machine does not crash when this\ncondition is hit.\n\n[1]\nKernel panic - not syncing: stack-protector: Kernel stack is corrupted in: mlxsw_sp_acl_tcam_group_update+0x116/0x120\n[...]\n dump_stack_lvl+0x36/0x50\n panic+0x305/0x330\n __stack_chk_fail+0x15/0x20\n mlxsw_sp_acl_tcam_group_update+0x116/0x120\n mlxsw_sp_acl_tcam_group_region_attach+0x69/0x110\n mlxsw_sp_acl_tcam_vchunk_get+0x492/0xa20\n mlxsw_sp_acl_tcam_ventry_add+0x25/0xe0\n mlxsw_sp_acl_rule_add+0x47/0x240\n mlxsw_sp_flower_replace+0x1a9/0x1d0\n tc_setup_cb_add+0xdc/0x1c0\n fl_hw_replace_filter+0x146/0x1f0\n fl_change+0xc17/0x1360\n tc_new_tfilter+0x472/0xb90\n rtnetlink_rcv_msg+0x313/0x3b0\n netlink_rcv_skb+0x58/0x100\n netlink_unicast+0x244/0x390\n netlink_sendmsg+0x1e4/0x440\n ____sys_sendmsg+0x164/0x260\n ___sys_sendmsg+0x9a/0xe0\n __sys_sendmsg+0x7a/0xc0\n do_syscall_64+0x40/0xe0\n entry_SYSCALL_64_after_hwframe+0x63/0x6b"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: mlxsw: espectro_acl_tcam: corrige la corrupci\u00f3n de la pila Cuando los filtros tc se agregan por primera vez a un dispositivo de red, el puerto local correspondiente se vincula a un grupo ACL en el dispositivo. El grupo contiene una lista de ACL. A su vez, cada ACL apunta a una regi\u00f3n TCAM diferente donde se almacenan los filtros. Durante el reenv\u00edo, las ACL se eval\u00faan secuencialmente hasta que se encuentra una coincidencia. Una raz\u00f3n para colocar filtros en diferentes regiones es cuando se agregan con prioridades decrecientes y en orden alterno, de modo que dos filtros consecutivos nunca puedan caber en la misma regi\u00f3n debido a su uso clave. En Spectrum-2 y ASIC m\u00e1s nuevos, el firmware comenz\u00f3 a informar que la cantidad m\u00e1xima de ACL en un grupo es superior a 16, pero el dise\u00f1o del registro que configura los grupos de ACL (PAGT) no se actualiz\u00f3 para tener en cuenta eso. Por lo tanto, es posible sufrir da\u00f1os en la pila [1] en el raro caso de que se requieran m\u00e1s de 16 ACL en un grupo. Se soluciona limitando el tama\u00f1o m\u00e1ximo del grupo de ACL al m\u00ednimo entre lo que informa el firmware y las ACL m\u00e1ximas que caben en el registro PAGT. Agregue un caso de prueba para asegurarse de que la m\u00e1quina no falle cuando se cumpla esta condici\u00f3n. [1] P\u00e1nico del kernel - no se sincroniza: stack-protector: La pila del kernel est\u00e1 da\u00f1ada en: mlxsw_sp_acl_tcam_group_update+0x116/0x120 [...] dump_stack_lvl+0x36/0x50 p\u00e1nico+0x305/0x330 __stack_chk_fail+0x15/0x20 mlxsw_sp_acl_tcam_group_update+ 0x116/0x120 mlxsw_sp_acl_tcam_group_region_attach +0x69/0x110 mlxsw_sp_acl_tcam_vchunk_get+0x492/0xa20 mlxsw_sp_acl_tcam_ventry_add+0x25/0xe0 mlxsw_sp_acl_rule_add+0x47/0x240 mlxsw_sp_flower_replace+0x1a9/0x1d0 tc_setup_cb _add+0xdc/0x1c0 fl_hw_replace_filter+0x146/0x1f0 fl_change+0xc17/0x1360 tc_new_tfilter+0x472/0xb90 rtnetlink_rcv_msg+0x313/0x3b0 netlink_rcv_skb +0x58/0x100 netlink_unicast+0x244/0x390 netlink_sendmsg+0x1e4/0x440 ____sys_sendmsg+0x164/0x260 ___sys_sendmsg+0x9a/0xe0 __sys_sendmsg+0x7a/0xc0 do_syscall_64+0x 40/0xe0 entrada_SYSCALL_64_after_hwframe+0x63/0x6b"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-787"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.19.0", "versionEndExcluding": "5.10.209", "matchCriteriaId": "5245A999-9650-493B-AC31-51FA3157651F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.11.0", "versionEndExcluding": "5.15.148", "matchCriteriaId": "E25E1389-4B0F-407A-9C94-5908FF3EE88B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.16.0", "versionEndExcluding": "6.1.79", "matchCriteriaId": "3B0A907E-1010-4294-AEFE-0EB5684AF52C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2.0", "versionEndExcluding": "6.6.14", "matchCriteriaId": "BDBBEB0E-D13A-4567-8984-51C5375350B9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7.0", "versionEndExcluding": "6.7.2", "matchCriteriaId": "0EA3778C-730B-464C-8023-18CA6AC0B807"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/2f5e1565740490706332c06f36211d4ce0f88e62", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/348112522a35527c5bcba933b9fefb40a4f44f15", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/483ae90d8f976f8339cf81066312e1329f2d3706", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/56750ea5d15426b5f307554e7699e8b5f76c3182", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/6fd24675188d354b1cad47462969afa2ab09d819", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/a361c2c1da5dbb13ca67601cf961ab3ad68af383", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00016.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-26586 - The kernel panic highlights the potential for stack-based buffer overflow exploitation, which can be mitigated by implementing memory protection mechanisms. Additionally, the use of ASLR and StackGuard can help to prevent the exploitation of this vulnerability."}, {"techniqueID": "T1050", "comment": "CVE-2024-26586 - The vulnerability is a stack-based buffer overflow in the Linux kernel's mlxsw driver, making it exploitable by an unauthenticated attacker. This can be mitigated by implementing memory protection mechanisms and using ASLR to randomize the location of sensitive data in memory."}, {"techniqueID": "T1190", "comment": "CVE-2024-26586 - The vulnerability is a kernel-mode exploit, making it a high-severity issue. It can be mitigated by implementing kernel hardening mechanisms such as DEP, ASLR, and SEHOP."}], "stix_bundle": "{\"bundle\": {\"objects\": [{\"id\": \"CVE-2024-26586\", \"type\": \"vulnerability\", \"created_by_ref\": \"416baaa9-dc9f-4396-8d5f-8c081fb06d67\", \"modified\": \"2024-06-25T21:15:57.593\", \"published\": \"2024-02-22T17:15:08.890\", \"title\": \"CVE-2024-26586 - Linux kernel mlxsw driver stack-based buffer overflow\", \"description\": \"In the Linux kernel, the \"mlxsw: spectrum_acl_tcam: Fix stack corruption\" vulnerability has been resolved.\", \"references\": [{\"url\": \"https://git.kernel.org/stable/c/2f5e1565740490706332c06f36211d4ce0f88e62\", \"source\": \"416baaa9-dc9f-4396-8d5f-8c081fb06d67\", \"tags\": [\"Patch\"]}, {\"url\": \"https://git.kernel.org/stable/c/348112522a35527c5bcba933b9fefb40a4f44f15\", \"source\": \"416baaa9-dc9f-4396-8d5f-8c081fb06d67\", \"tags\": [\"Patch\"]}, {\"url\": \"https://git.kernel.org/stable/c/483ae90d8f976f8339cf81066312e1329f2d3706\", \"source\": \"416baaa9-dc9f-4396-8d5f-8c081fb06d67\", \"tags\": [\"Patch\"]}, {\"url\": \"https://git.kernel.org/stable/c/56750ea5d15426b5f307554e7699e8b5f76c3182\", \"source\": \"416baaa9-dc9f-4396-8d5f-8c081fb06d67\", \"tags\": [\"Patch\"]}, {\"url\": \"https://git.kernel.org/stable/c/6fd24675188d354b1cad47462969afa2ab09d819\", \"source\": \"416baaa9-dc9f-4396-8d5f-8c081fb06d67\", \"tags\": [\"Patch\"]}, {\"url\": \"https://git.kernel.org/stable/c/a361c2c1da5dbb13ca67601cf961ab3ad68af383\", \"source\": \"416baaa9-dc9f-4396-8d5f-8c081fb06d67\"}, {\"url\": \"https://lists.debian.org/debian-lts-announce/2024/06/msg00016.html\", \"source\": \"416baaa9-dc9f-4396-8d5f-8c081fb06d67\"}], \"cwe\": [{\"source\": \"nvd@nist.gov\", \"type\": \"Primary\", \"description\": [{\"lang\": \"en\", \"value\": \"CWE-787\"}]}], \"metrics\": [{\"source\": \"nvd@nist.gov\", \"type\": \"Primary\", \"cvssData\": {\"version\": \"3.1\", \"vectorString\": \"CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H\", \"attackVector\": \"LOCAL\", \"attackComplexity\": \"LOW\", \"privilegesRequired\": \"HIGH\", \"userInteraction\": \"NONE\", \"scope\": \"UNCHANGED\", \"confidentialityImpact\": \"HIGH\", \"integrityImpact\": \"HIGH\", \"availabilityImpact\": \"HIGH\", \"baseScore\": 6.7, \"baseSeverity\": \"MEDIUM\"}, \"exploitabilityScore\": 0.8, \"impactScore\": 5.9}]}, {\"type\": \"relationship\", \"id\": \"REL-1\", \"from\": \"CVE-2024-26586\", \"to\": \"T1027\", \"relationship\": \"related\"}, {\"type\": \"relationship\", \"id\": \"REL-2\", \"from\": \"CVE-2024-26586\", \"to\": \"T1050\", \"relationship\": \"related\"}, {\"type\": \"relationship\", \"id\": \"REL-3\", \"from\": \"CVE-2024-26586\", \"to\": \"T1190\", \"relationship\": \"related\"}]}", "technical_analysis": {"Introduction": "The CVE-2024-26586 vulnerability is a stack-based buffer overflow in the Linux kernel's mlxsw driver, which can be exploited by an unauthenticated attacker. This vulnerability has a high severity and a high CVSS score of 6.7.", "Impact and Scope": "The impact of this vulnerability is high, as it can be exploited to allow attackers to execute arbitrary code on the device. The scope of the vulnerability is limited to Linux kernel versions 4.19.0 to 5.16.0.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1027, T1050, and T1190, which are all related to exploitation of kernel-level vulnerabilities.", "Technical Details": "The vulnerability occurs when the mlxsw driver is used to handle incoming packets and the stack-based buffer overflow occurs. This can be mitigated by implementing memory protection mechanisms such as ASLR and StackGuard.", "Detection": "Detection of this vulnerability can be achieved by using tools such as Falco and Cuckoo Sandbox.", "Mitigation": "Mitigation of this vulnerability can be achieved by updating the Linux kernel to a version that is not affected by the vulnerability, implementing memory protection mechanisms such as ASLR and StackGuard, and disabling unused kernel modules.", "Conclusion": "In conclusion, the CVE-2024-26586 vulnerability is a high-severity vulnerability that can be exploited to allow attackers to execute arbitrary code on the device. It is essential to update the Linux kernel to a version that is not affected by the vulnerability and implement memory protection mechanisms such as ASLR and StackGuard."}, "executive_analysis": {"Overview": "The CVE-2024-26586 vulnerability is a high-severity vulnerability that can be exploited to allow attackers to execute arbitrary code on the device. It is essential to update the Linux kernel to a version that is not affected by the vulnerability and implement memory protection mechanisms such as ASLR and StackGuard.", "Business Impact": "The business impact of this vulnerability is significant, as it can be exploited to gain unauthorized access to sensitive data and disrupt critical systems.", "Technical Impact": "The technical impact of this vulnerability is high, as it can be exploited to execute arbitrary code on the device.", "Mitigation Strategies": "Mitigation strategies include updating the Linux kernel to a version that is not affected by the vulnerability, implementing memory protection mechanisms such as ASLR and StackGuard, and disabling unused kernel modules.", "Recommendations": "Recommendations include implementing memory protection mechanisms such as ASLR and StackGuard, disabling unused kernel modules, and updating the Linux kernel to a version that is not affected by the vulnerability.", "Conclusions": "In conclusion, the CVE-2024-26586 vulnerability is a high-severity vulnerability that requires immediate attention. It is essential to update the Linux kernel to a version that is not affected by the vulnerability and implement memory protection mechanisms such as ASLR and StackGuard."}}