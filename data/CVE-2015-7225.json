{"id": "CVE-2015-7225", "sourceIdentifier": "cve@mitre.org", "published": "2017-09-06T21:29:00.957", "lastModified": "2017-09-21T18:57:10.310", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Tinfoil Devise-two-factor before 2.0.0 does not strictly follow section 5.2 of RFC 6238 and does not \"burn\" a successfully validated one-time password (aka OTP), which allows remote or physically proximate attackers with a target user's login credentials to log in as said user by obtaining the OTP through performing a man-in-the-middle attack between the provider and verifier, or shoulder surfing, and replaying the OTP in the current time-step."}, {"lang": "es", "value": "Tinfoil Devise-two-factor, en versiones anteriores a la 2.0.0, no sigue de manera estricta la secci\u00f3n 5.2 de la norma RFC 6238 y no \"consume\" una contrase\u00f1a de un solo uso (tambi\u00e9n llamada OTP) correctamente validada. Esto permite que atacantes remotos o que se encuentren f\u00edsicamente cerca inicien sesi\u00f3n como un usuario utilizando sus credenciales de acceso. Esto se llevar\u00eda a cabo realizando un ataque Man-in-the-Middle (MitM) entre el proveedor y el verificador u observando f\u00edsicamente (lo que se conoce como shoulder surfing) y repitiendo la contrase\u00f1a OTP en el intervalo de tiempo actual."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-254"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:tinfoilsecurity:devise-two-factor:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.1.0", "matchCriteriaId": "9796BE8B-A754-4A3A-9B61-C40420C0E53A"}]}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2015/06/20/4", "source": "cve@mitre.org", "tags": ["Mailing List", "VDB Entry"]}, {"url": "http://www.openwall.com/lists/oss-security/2015/09/17/2", "source": "cve@mitre.org", "tags": ["Mailing List", "VDB Entry"]}, {"url": "http://www.securityfocus.com/bid/76789", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=798466", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://github.com/tinfoil/devise-two-factor/blob/master/UPGRADING.md", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/tinfoil/devise-two-factor/issues/45#issuecomment-139335608", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0001: Initial Access", "comment": "Tinfoil Devise-two-factor before 2.0.0 does not strictly follow section 5.2 of RFC 6238, allowing remote or physically proximate attackers to log in as said user. - This vulnerability allows attackers to gain initial access to the system."}, {"techniqueID": "TA0002: Execution", "comment": "The vulnerability allows attackers to obtain the OTP through a man-in-the-middle attack between the provider and verifier, or shoulder surfing, and replaying the OTP in the current time-step. - This technique involves executing the attack to gain access to the system."}, {"techniqueID": "TA0021: Ingress Tool Transfer", "comment": "Attackers can obtain the OTP and use it to log in as said user. - This technique involves transferring the tool to get the OTP and use it for login."}, {"techniqueID": "T1078: Exploitation of Authentication Mechanism", "comment": "The vulnerability allows attackers to exploit the authentication mechanism in Tinfoil Devise-two-factor. - This technique involves exploiting the authentication mechanism to gain access."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "CVE-2015-7225-STIX-Bundle", "created_by_ref": " https://cve.mitre.org/data/downloads/", "created": "2017-09-06T21:29:00.957", "modified": "2017-09-21T18:57:10.310", "objs": [{"type": "vulnerability", "id": "CVE-2015-7225", "name": "Tinfoil Devise-two-factor before 2.0.0 Two-Factor Implementation Bypass", "description": "Tinfoil Devise-two-factor before 2.0.0 does not strictly follow section 5.2 of RFC 6238 and does not 'burn' a successfully validated one-time password (aka OTP), which allows remote or physically proximate attackers with a target user's login credentials to log in as said user by obtaining the OTP through performing a man-in-the-middle attack between the provider and verifier, or shoulder surfing, and replaying the OTP in the current time-step.", "modified": "2017-09-21T18:57:10.310", "created": "2017-09-06T21:29:00.957", "external_references": [{"source_name": "cve@mitre.org", "external_id": "CVE-2015-7225"}]}, {"type": "attack_pattern", "id": "Tinfoil Devise-two-factor before 2.0.0 Two-Factor Implementation Bypass", "name": "Tinfoil Devise-two-factor before 2.0.0 Two-Factor Implementation Bypass", "description": "The vulnerability allows attackers to bypass the two-factor implementation in Tinfoil Devise-two-factor before 2.0.0 by obtaining the OTP through a man-in-the-middle attack between the provider and verifier, or shoulder surfing, and replaying the OTP in the current time-step.", "modified": "2017-09-21T18:57:10.310", "created": "2017-09-06T21:29:00.957", "kill_chain_phases": [{"kill_chain_name": "ATT&CK", "kill_chainPhase_name": "Initial Access"}]}, {"type": "attack_pattern", "id": "Man-in-the-Middle Attack", "name": "Man-in-the-Middle Attack", "description": "The attacker performs a man-in-the-middle attack between the provider and verifier to obtain the OTP.", "modified": "2017-09-21T18:57:10.310", "created": "2017-09-06T21:29:00.957", "kill_chain_phases": [{"kill_chain_name": "ATT&CK", "kill_chainPhase_name": "Initial Access"}]}, {"type": "course_of_action", "id": "Update to Tinfoil Devise-two-factor 2.0.0", "name": "Update to Tinfoil Devise-two-factor 2.0.0", "description": "Update to Tinfoil Devise-two-factor 2.0.0 to fix the vulnerability.", "modified": "2017-09-21T18:57:10.310", "created": "2017-09-06T21:29:00.957"}, {"type": "note", "id": "Defeat Man-in-the-Middle Attack", "name": "Defeat Man-in-the-Middle Attack", "description": "Use encryption and secure communication channels to defeat man-in-the-middle attacks.", "modified": "2017-09-21T18:57:10.310", "created": "2017-09-06T21:29:00.957"}], "relationships": [{"relationship_type": "related_to", "from_ref": "CVE-2015-7225", "to_ref": "Tinfoil Devise-two-factor before 2.0.0 Two-Factor Implementation Bypass", "id": "Tinfoil Devise-two-factor before 2.0.0 Two-Factor Implementation Bypass-related-vulnerability"}, {"relationship_type": "mitigated_by", "from_ref": "CVE-2015-7225", "to_ref": "Update to Tinfoil Devise-two-factor 2.0.0", "id": "CVE-2015-7225-mitigated-by-Update-to-Tinfoil-Devtwo-factor-2.0.0"}, {"relationship_type": "defends_against", "from_ref": "CVE-2015-7225", "to_ref": "Defeat Man-in-the-Middle Attack", "id": "CVE-2015-7225-defends-against-Defeat-Man-in-the-Middle-Attack"}]}, "technical_analysis": {"Introduction": "The vulnerability allows attackers to bypass the two-factor implementation in Tinfoil Devise-two-factor before 2.0.0 by obtaining the OTP through a man-in-the-middle attack between the provider and verifier, or shoulder surfing, and replaying the OTP in the current time-step.", "Impact and Scope": "This vulnerability affects Tinfoil Devise-two-factor before 2.0.0 and allows attackers to gain unauthorized access to the system by bypassing the two-factor authentication mechanism.", "Related MITRE ATT&CK Techniques": "TA0001: Initial Access, TA0002: Execution, TA0021: Ingress Tool Transfer, T1078: Exploitation of Authentication Mechanism", "Technical Details": "The vulnerability arises from the fact that Tinfoil Devise-two-factor before 2.0.0 does not strictly follow section 5.2 of RFC 6238 and does not 'burn' a successfully validated one-time password (aka OTP), which allows remote or physically proximate attackers with a target user's login credentials to log in as said user by obtaining the OTP through performing a man-in-the-middle attack between the provider and verifier, or shoulder surfing, and replaying the OTP in the current time-step.", "Detection": "Detection of this vulnerability can be done by monitoring the network traffic and system logs for suspicious activity and by conducting penetration testing to identify potential vulnerabilities.", "Mitigation": "The vulnerability can be mitigated by updating to Tinfoil Devise-two-factor 2.0.0 and by implementing encryption and secure communication channels to defeat man-in-the-middle attacks.", "Conclusion": "In conclusion, the vulnerability in Tinfoil Devise-two-factor before 2.0.0 allows attackers to bypass the two-factor authentication mechanism and gain unauthorized access to the system. This can be mitigated by updating to the latest version and implementing secure communication channels."}, "executive_analysis": {"Overview": "The vulnerability in Tinfoil Devise-two-factor before 2.0.0 allows attackers to bypass the two-factor authentication mechanism and gain unauthorized access to the system, which could lead to significant financial and reputational losses.", "Business Impact": "This vulnerability has significant business implications, as it could lead to unauthorized access to sensitive information and systems, which could result in financial losses, reputational damage, and regulatory non-compliance.", "Technical Impact": "The vulnerability allows attackers to bypass the two-factor authentication mechanism, which could lead to unauthorized access to sensitive information and systems, resulting in technical and reputational damage.", "Mitigation Strategies": "Implementing encryption and secure communication channels, updating to Tinfoil Devise-two-factor 2.0.0, and conducting regular penetration testing can help mitigate the vulnerability.", "Recommendations": "Executives should prioritize implementing secure communication channels, updating to the latest version of Tinfoil Devise-two-factor, and conducting regular penetration testing to ensure the security of the system.", "Conclusions": "In conclusion, the vulnerability in Tinfoil Devise-two-factor before 2.0.0 is a significant threat that requires immediate attention and mitigation. Executives should prioritize implementing secure communication channels, updating to the latest version, and conducting regular penetration testing to ensure the security of the system."}}