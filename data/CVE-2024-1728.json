{"id": "CVE-2024-1728", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-10T17:15:53.097", "lastModified": "2024-04-10T19:49:51.183", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "gradio-app/gradio is vulnerable to a local file inclusion vulnerability due to improper validation of user-supplied input in the UploadButton component. Attackers can exploit this vulnerability to read arbitrary files on the filesystem, such as private SSH keys, by manipulating the file path in the request to the `/queue/join` endpoint. This issue could potentially lead to remote code execution. The vulnerability is present in the handling of file upload paths, allowing attackers to redirect file uploads to unintended locations on the server."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "references": [{"url": "https://github.com/gradio-app/gradio/commit/16fbe9cd0cffa9f2a824a0165beb43446114eec7", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/9bb33b71-7995-425d-91cc-2c2a2f2a068a", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "TA0006", "comment": " CVE-2024-1728 - This local file inclusion vulnerability can be exploited by an adversary to read arbitrary files on the filesystem, potentially leading to remote code execution. Defending against this involves validating user-supplied input in the UploadButton component."}, {"techniqueID": "TA0003", "comment": " CVE-2024-1728 - This vulnerability allows an attacker to manipulate file upload paths, redirecting files to unintended locations on the server. Defending against this involves ensuring proper file path validation in the UploadButton component."}, {"techniqueID": "TA0037", "comment": " CVE-2024-1728 - The vulnerability's presence in the handling of file upload paths allows an attacker to redirect file uploads. Defending against this involves validating file uploads and ensuring proper path handling."}], "stix_bundle": {"bson": "5.4.0", "type": "bundle", "spec_version": "2.1", "id": "urn:uuid:22f3eb93-93be-42e4-b9da-3f3b9d8d3f5a", "name": "CVE-2024-1728 STIX Bundle", "objects": [{"type": "intrusion-set", "id": "urn:uuid:23f3eb93-93be-42e4-b9da-3f3b9d8d3f5a", "name": "Gradio App Vulnerability"}, {"type": "course-of-action", "id": "urn:uuid:2233eb93-93be-42e4-b9da-3f3b9d8d3f5a", "name": "Validate User-Supplied Input"}, {"type": "course-of-action", "id": "urn:uuid:2234eb93-93be-42e4-b9da-3f3b9d8d3f5a", "name": "Ensure Proper File Path Validation"}, {"type": "identity", "id": "urn:uuid:2235eb93-93be-42e4-b9da-3f3b9d8d3f5a", "name": "Gradio App Development Team"}, {"type": "indicator", "id": "urn:uuid:2236eb93-93be-42e4-b9da-3f3b9d8d3f5a", "name": "Unvalidated Input Indicator"}, {"type": "indicator", "id": "urn:uuid:2237eb93-93be-42e4-b9da-3f3b9d8d3f5a", "name": "Unvalidated File Path Indicator"}, {"type": "vulnerability", "id": "urn:uuid:2238eb93-93be-42e4-b9da-3f3b9d8d3f5a", "name": "CVE-2024-1728"}], "relationship": [{"type": "has-part", "id": "urn:uuid:23f3eb93-93be-42e4-b9da-3f3b9d8d3f5a", "relationship_type": "intrusion-set", "source_ref": "urn:uuid:2238eb93-93be-42e4-b9da-3f3b9d8d3f5a"}, {"type": "is-related-to", "id": "urn:uuid:2239eb93-93be-42e4-b9da-3f3b9d8d3f5a", "relationship_type": "course-of-action", "source_ref": "urn:uuid:2238eb93-93be-42e4-b9da-3f3b9d8d3f5a", "target_ref": "urn:uuid:2233eb93-93be-42e4-b9da-3f3b9d8d3f5a"}, {"type": "is-related-to", "id": "urn:uuid:223aeb93-93be-42e4-b9da-3f3b9d8d3f5a", "relationship_type": "course-of-action", "source_ref": "urn:uuid:2238eb93-93be-42e4-b9da-3f3b9d8d3f5a", "target_ref": "urn:uuid:2234eb93-93be-42e4-b9da-3f3b9d8d3f5a"}]}, "technical_analysis": {"Introduction": "CVE-2024-1728 is a local file inclusion vulnerability in the Gradio App that allows an attacker to read arbitrary files on the filesystem. This vulnerability has a CVSS score of 7.5 (HIGH) with an attack vector of NETWORK.", "Impact and Scope": "This vulnerability could potentially lead to remote code execution if exploited. The impact is HIGH due to the severity of the vulnerability and the possibility of data being accessed.", "Related MITRE ATT&CK Techniques": "TA0006, TA0003, and TA0037", "Technical Details": "The vulnerability is present in the handling of file upload paths, allowing an attacker to redirect file uploads to unintended locations on the server.", "Detection": "This vulnerability can be detected by monitoring file uploads and validating user-supplied input.", "Mitigation": "Validating user-supplied input and ensuring proper file path validation are effective mitigation strategies for this vulnerability.", "Conclusion": "This vulnerability has significant potential for exploitation and should be addressed as soon as possible."}, "executive_analysis": {"Overview": "CVE-2024-1728 is a critical vulnerability in the Gradio App that allows an attacker to read arbitrary files on the filesystem. This vulnerability has significant potential for exploitation and should be addressed as soon as possible.", "Business Impact": "This vulnerability could potentially lead to data breaches and compromise sensitive information.", "Technical Impact": "This vulnerability has a CVSS score of 7.5 (HIGH) with an attack vector of NETWORK, making it a high-priority vulnerability to address.", "Mitigation Strategies": "Implementing proper input validation and ensuring secure file path handling are effective mitigation strategies.", "Recommendations": "Immediate action should be taken to address this vulnerability, including validating user-supplied input and ensuring proper file path validation.", "Conclusions": "This vulnerability has significant potential for exploitation and should be addressed as soon as possible to maintain the security and integrity of the Gradio App."}}