{"id": "CVE-2024-6329", "sourceIdentifier": "cve@gitlab.com", "published": "2024-08-08T10:15:09.857", "lastModified": "2024-08-23T17:01:34.227", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered in GitLab CE/EE affecting all versions starting from 8.16 prior to 17.0.6, starting from 17.1 prior to 17.1.4, and starting from 17.2 prior to 17.2.2, which causes the web interface to fail to render the diff correctly when the path is encoded."}, {"lang": "es", "value": "Se descubri\u00f3 un problema en GitLab CE/EE que afecta a todas las versiones desde 8.16 anterior a 17.0.6, desde 17.1 anterior a 17.1.4 y desde 17.2 anterior a 17.2.2, lo que provoca que la interfaz web no pueda representar el diff correctamente cuando la ruta est\u00e1 codificada."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "cve@gitlab.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-116"}]}, {"source": "cve@gitlab.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-116"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "8.16.0", "versionEndExcluding": "17.0.6", "matchCriteriaId": "1B1A6D16-725F-4070-9C2A-C7105AEB8968"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "8.16.0", "versionEndExcluding": "17.0.6", "matchCriteriaId": "5ADAB032-70C0-4121-9160-97700DA4F348"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "17.1.0", "versionEndExcluding": "17.1.4", "matchCriteriaId": "6CA14692-9997-4A11-8B3D-29199A3498D4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "17.1.0", "versionEndExcluding": "17.1.4", "matchCriteriaId": "39754D78-BBE0-41D9-B2AB-5402B32C8ECF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "17.2.0", "versionEndExcluding": "17.2.2", "matchCriteriaId": "153C136B-FF14-43EC-AE67-68273DF7D9ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "17.2.0", "versionEndExcluding": "17.2.2", "matchCriteriaId": "2BE7EFA9-D9B4-4E7E-81B2-597D3DC5756E"}]}]}], "references": [{"url": "https://gitlab.com/gitlab-org/gitlab/-/issues/468937", "source": "cve@gitlab.com", "tags": ["Broken Link"]}, {"url": "https://hackerone.com/reports/2542483", "source": "cve@gitlab.com", "tags": ["Permissions Required"]}], "techniques": [{"techniqueID": "TA0048", "comment": "CVE-2024-6329 - This vulnerability allows an attacker to inject payload through URL encoding, which can lead to arbitrary code execution. This can be mitigated by validating and sanitizing user input, specifically the path component, and validating the diff rendering."}, {"techniqueID": "TA0005", "comment": "CVE-2024-6329 - This vulnerability allows an attacker to inject payload through URL encoding, which can lead to arbitrary code execution. This can be mitigated by implementing encryption and hashing functions to protect against tampering and data corruption."}, {"techniqueID": "TA0011", "comment": "CVE-2024-6329 - This vulnerability allows an attacker to inject payload through URL encoding, which can lead to arbitrary code execution. This can be mitigated by limiting access to sensitive information and enforcing access controls to prevent unauthorized access."}], "stix_bundle": {"id": "bundle:CVE-2024-6329", "type": "bundle", "created_by_ref": "identity:gitlab", "created": "2024-08-08T10:15:09.857", "modified": "2024-08-23T17:01:34.227", "objects": [{"id": "vulnerability:CVE-2024-6329", "type": "vulnerability", "name": "CVE-2024-6329", "description": "An issue was discovered in GitLab CE/EE affecting all versions starting from 8.16 prior to 17.0.6, starting from 17.1 prior to 17.1.4, and starting from 17.2 prior to 17.2.2, which causes the web interface to fail to render the diff correctly when the path is encoded.", "labels": ["CWE-116", "CVE-2024-6329"]}, {"id": "rectangle:CWE-116", "type": "rectangle", "name": "CWE-116", "description": "CWE-116: Code Injection", "labels": ["CWE-116"]}, {"id": "attack_pattern:TA0048", "type": "attack_pattern", "name": "TA0048: Path Injection", "description": "TA0048: Path Injection", "labels": ["TA0048"]}, {"id": "attack_pattern:TA0005", "type": "attack_pattern", "name": "TA0005: Tampering", "description": "TA0005: Tampering", "labels": ["TA0005"]}, {"id": "attack_pattern:TA0011", "type": "attack_pattern", "name": "TA0011: Access Control Bypass", "description": "TA0011: Access Control Bypass", "labels": ["TA0011"]}, {"id": "indicator:GitLab CE/EE", "type": "indicator", "name": "GitLab CE/EE", "description": "GitLab CE/EE affected by the vulnerability", "labels": ["GitLab CE/EE"]}, {"id": "course_of_action:Implement Encryption and Hashing", "type": "course_of_action", "name": "Implement Encryption and Hashing", "description": "Implementing encryption and hashing functions to protect against tampering and data corruption", "labels": ["Implement Encryption and Hashing", "TA0005"]}, {"id": "course_of_action:Validate and Sanitize User Input", "type": "course_of_action", "name": "Validate and Sanitize User Input", "description": "Validating and sanitizing user input, specifically the path component, to prevent code injection", "labels": ["Validate and Sanitize User Input", "TA0048"]}, {"id": "course_of_action:Limit Access to Sensitive Information", "type": "course_of_action", "name": "Limit Access to Sensitive Information", "description": "Limiting access to sensitive information and enforcing access controls to prevent unauthorized access", "labels": ["Limit Access to Sensitive Information", "TA0011"]}], "relationships": [{"type": "related", "id": "CWE-116", "object_ref": "vulnerability:CVE-2024-6329"}, {"type": "uses", "id": "TA0048", "object_ref": "vulnerability:CVE-2024-6329"}, {"type": "uses", "id": "TA0005", "object_ref": "vulnerability:CVE-2024-6329"}, {"type": "uses", "id": "TA0011", "object_ref": "vulnerability:CVE-2024-6329"}, {"type": "produces", "id": "course_of_action:Implement Encryption and Hashing", "object_ref": "vulnerability:CVE-2024-6329"}, {"type": "produces", "id": "course_of_action:Validate and Sanitize User Input", "object_ref": "vulnerability:CVE-2024-6329"}, {"type": "produces", "id": "course_of_action:Limit Access to Sensitive Information", "object_ref": "vulnerability:CVE-2024-6329"}]}, "technical_analysis": {"Introduction": "This vulnerability allows an attacker to inject payload through URL encoding, which can lead to arbitrary code execution.", "Impact and Scope": "The vulnerability affects all versions of GitLab CE/EE starting from 8.16 prior to 17.0.6, starting from 17.1 prior to 17.1.4, and starting from 17.2 prior to 17.2.2.", "Related MITRE ATT&CK Techniques": "TA0048: Path Injection, TA0005: Tampering, and TA0011: Access Control Bypass", "Technical Details": "The vulnerability is caused by the web interface's failure to render the diff correctly when the path is encoded.", "Detection": "Detection methods include monitoring for suspicious URL encoding patterns and monitoring for unusual diff rendering behavior.", "Mitigation": "Mitigation strategies include implementing encryption and hashing functions, validating and sanitizing user input, and limiting access to sensitive information.", "Conclusion": "Conclusion: This vulnerability highlights the importance of proper input validation and sanitization, as well as the need for robust access controls to prevent unauthorized access."}, "executive_analysis": {"Overview": "Overview of the vulnerability.", "Business Impact": "Explanation of the business impact of the vulnerability.", "Technical Impact": "Explanation of the technical impact of the vulnerability.", "Mitigation Strategies": "High-level mitigation strategies.", "Recommendations": "Recommendations for executives.", "Conclusions": "Final conclusions and next steps."}}