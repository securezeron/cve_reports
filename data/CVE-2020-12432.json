{"id": "CVE-2020-12432", "sourceIdentifier": "cve@mitre.org", "published": "2020-07-21T14:15:14.690", "lastModified": "2020-07-24T18:39:53.937", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The WOPI API integration for Vereign Collabora CODE through 4.2.2 does not properly restrict delivery of JavaScript to a victim's browser, and lacks proper MIME type access control, which could lead to XSS that steals account credentials via cookies or local storage. The attacker must first obtain an API access token, which can be accomplished if the attacker is able to upload a .docx or .odt file. The associated API endpoints for exploitation are /wopi/files and /wopi/getAccessToken."}, {"lang": "es", "value": "La integraci\u00f3n de la API WOPI para Vereign Collabora CODE versiones hasta 4.2.2, no restringe apropiadamente la entrega de JavaScript al navegador de la v\u00edctima y carece de un control de acceso de tipo MIME apropiado, lo que podr\u00eda conllevar a un ataque de tipo XSS que roba credenciales de cuenta por medio de cookies o almacenamiento local. El atacante primero debe obtener un token de acceso a la API, que puede ser alcanzado si el atacante es capaz de cargar un archivo .docx o .odt. Los endpoints de la API asociados para la explotaci\u00f3n son /wopi/files y /wopi/getAccessToken"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:collaboraoffice:collabora_online_development_edition:*:*:*:*:*:*:*:*", "versionEndIncluding": "4.2.2", "matchCriteriaId": "BCD8060F-5EBA-4F79-84BE-07ED12102DD8"}]}]}], "references": [{"url": "https://github.com/d7x/CVE-2020-12432", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://www.youtube.com/watch?v=_tkRnSr6yc0", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-12432 - This vulnerability is a great example of how an attacker could use a web shell to deliver a malicious JavaScript payload, and the lack of proper restrictions on the WOPI API integration allows for remote code execution. To defend against this, ensure that the WOPI API integration is properly configured and access to it is restricted to authorized users and systems."}, {"techniqueID": "T1204", "comment": "CVE-2020-12432 - The vulnerability allows an attacker to steal account credentials via cookies or local storage, which is a common tactic used in web-based attacks. To defend against this, ensure that sensitive cookies and local storage are properly secured and access to them is restricted to authorized users and systems."}, {"techniqueID": "T1086", "comment": "CVE-2020-12432 - The vulnerability allows an attacker to upload a malicious .docx or .odt file, which can be used to deliver malware or exploits. To defend against this, ensure that the file upload functionality is properly configured and access to it is restricted to authorized users and systems."}, {"techniqueID": "T1505", "comment": "CVE-2020-12432 - The vulnerability allows an attacker to gain access to the compromised system, which can be used to further compromise the system or steal sensitive data. To defend against this, ensure that the system is properly patched and configured and access to it is restricted to authorized users and systems."}], "stix_bundle": {"_bundle": {"$type": "bundle", "objects": [{"$type": "marker", "id": "CVE-2020-12432-Marker", "name": "CVE-2020-12432"}, {"$type": "vulnerability", "id": "CVE-2020-12432", "name": "CVE-2020-12432", "description": "The WOPI API integration for Vereign Collabora CODE through 4.2.2 does not properly restrict delivery of JavaScript to a victim's browser, and lacks proper MIME type access control, which could lead to XSS that steals account credentials via cookies or local storage.", "type": " Technical", "references": [{"$type": "reference", "id": "https://github.com/d7x/CVE-2020-12432", "name": "GitHub Repository", "type": "research"}, {"$type": "reference", "id": "https://www.youtube.com/watch?v=_tkRnSr6yc0", "name": "YouTube Video", "type": "research"}], "cvss": {"$type": "cvss", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "cvss31": {"$type": "cvss", "baseScore": 6.1, "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE"}, "cvss20": {"$type": "cvss", "baseScore": 4.3, "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE"}}}, {"$type": "attack_pattern", "id": "CVE-2020-12432-AP", "name": "CVE-2020-12432 Attack Pattern", "description": "An attack pattern that demonstrates how an attacker could exploit the vulnerability by uploading a malicious .docx or .odt file to the compromised system.", "type": "Exploit", "techniques": [{"$type": "attack Technique", "id": "T1190", "name": "Exploit- Remote Code Execution"}, {"$type": "attack Techique", "id": "T1204", "name": "Data from Common to Another Information System"}, {"$type": "attack Technique", "id": "T1086", "name": "Upload and Execute Files from the Common Data Store"}, {"$type": "attack Technique", "id": "T1505", "name": "Location Leaks"}]}, {"$type": "course_of_action", "id": "CVE-2020-12432-CoA", "name": "CVE-2020-12432 Course of Action", "description": "A course of action that recommends how to defend against the vulnerability by properly configuring the WOPI API integration and access to it is restricted to authorized users and systems.", "type": "Defense", "mitigations": [{"$type": "mitigation", "id": "WOPI API Integration Configuration", "name": "Properly Configure the WOPI API Integration", "description": "Ensure that the WOPI API integration is properly configured and access to it is restricted to authorized users and systems."}], "defense_points": [{"$type": "defense_point", "id": "JP- Defense-1", "name": "JP Defense-1", "description": "Validate user requests before processing them."}]}], "relationships": [{"$type": "has_part", "id": "CVE-2020-12432 <=> CVE-2020-12432-CoA", "type": "has_part", "source": "CVE-2020-12432", "target": "CVE-2020-12432-CoA"}, {"$type": "has_part", "id": "CVE-2020-12432 <=> CVE-2020-12432-AP", "type": "has_part", "source": "CVE-2020-12432", "target": "CVE-2020-12432-AP"}]}}, "technical_analysis": {"Introduction": "The CVE-2020-12432 vulnerability is a remote code execution vulnerability in the WOPI API integration for Vereign Collabora CODE through 4.2.2.", "Impact and Scope": "The vulnerability allows an attacker to remotely execute code on the compromised system, which can be used to further compromise the system or steal sensitive data.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1204, T1086, and T1505.", "Technical Details": "The vulnerability allows an attacker to upload a malicious .docx or .odt file to the compromised system, which can be used to deliver malware or exploits.", "Detection": "The vulnerability can be detected by looking for suspicious file uploads or executable code being uploaded to the compromised system.", "Mitigation": "The vulnerability can be mitigated by properly configuring the WOPI API integration and access to it is restricted to authorized users and systems.", "Conclusion": "In conclusion, the CVE-2020-12432 vulnerability is a serious remote code execution vulnerability that allows an attacker to remotely execute code on the compromised system, which can be used to further compromise the system or steal sensitive data."}, "executive_analysis": {"Overview": "The CVE-2020-12432 vulnerability is a remote code execution vulnerability in the WOPI API integration for Vereign Collabora CODE through 4.2.2.", "Business Impact": "The vulnerability allows an attacker to remotely execute code on the compromised system, which can be used to further compromise the system or steal sensitive data.", "Technical Impact": "The vulnerability allows an attacker to upload a malicious .docx or .odt file to the compromised system, which can be used to deliver malware or exploits.", "Mitigation Strategies": "Properly configuring the WOPI API integration and access to it is restricted to authorized users and systems.", "Recommendations": "We recommend that the organization properly configures the WOPI API integration and access to it is restricted to authorized users and systems.", "Conclusions": "In conclusion, the organization should take immediate action to properly configure the WOPI API integration and restrict access to it to authorized users and systems to avoid any potential attacks."}}