{"id": "CVE-2024-1173", "sourceIdentifier": "security@wordfence.com", "published": "2024-05-02T17:15:10.393", "lastModified": "2024-05-02T18:00:37.360", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The WP ERP | Complete HR solution with recruitment & job listings | WooCommerce CRM & Accounting plugin for WordPress is vulnerable to time-based SQL Injection via the id parameter in all versions up to, and including, 1.13.1 due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query.  This makes it possible for authenticated attackers, with accounting manager or admin access, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database."}, {"lang": "es", "value": "El complemento WP ERP | Complete HR solution with recruitment &amp; job listings | WooCommerce CRM &amp; Accounting para WordPress es vulnerable a la inyecci\u00f3n SQL basada en tiempo a trav\u00e9s del par\u00e1metro id en todas las versiones hasta la 1.13.1 incluida debido a un escape insuficiente en el par\u00e1metro proporcionado por el usuario y a la falta de preparaci\u00f3n suficiente en la consulta SQL existente. Esto hace posible que atacantes autenticados, con acceso de administrador o administrador de contabilidad, agreguen consultas SQL adicionales a consultas ya existentes que pueden usarse para extraer informaci\u00f3n confidencial de la base de datos."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}]}, "references": [{"url": "https://plugins.trac.wordpress.org/browser/erp/trunk/modules/accounting/includes/functions/people.php#L262", "source": "security@wordfence.com"}, {"url": "https://plugins.trac.wordpress.org/changeset/3071807/erp/trunk/modules/accounting/includes/functions/people.php", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/94772de9-6ab8-45ff-8b56-19b50a81b66f?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1059: Command and Control", "comment": "CVE-2024-1173 - Unauthenticated attackers can execute arbitrary SQL queries on the database, allowing them to extract sensitive information, create, modify, or delete data. This is a significant risk, especially for companies that store sensitive data."}, {"techniqueID": "T1132: SQL Injection", "comment": "CVE-2024-1173 - The vulnerability allows attackers to inject malicious SQL code, which can be used to extract sensitive data, create backdoors, or elevate privileges. Defense strategies include input validation and filtering, parameterized queries, and using prepared statements."}, {"techniqueID": "T1055: Command Injection", "comment": "CVE-2024-1173 - The SQL injection vulnerability can also be used to inject operating system commands, allowing attackers to execute arbitrary system commands, read, write, or delete files, and issue operating system level commands."}, {"techniqueID": "T1060: Account Manipulation", "comment": "CVE-2024-1173 - Attackers can use the SQL injection vulnerability to manipulate user accounts, creating, modifying, or deleting accounts, and potentially escalating privileges."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle--a296b6e1-1416-4754-9f4e-fb3b6e1f7eaf", "objects": [{"type": "vulnerability", "id": "vulnerability--a296b6e1-1416-4754-9f4e-fb3b6e1f7eaf", "name": "WP ERP vulnerability", "description": "The WP ERP plugin is vulnerable to SQL injection attacks due to insufficient escaping on user-supplied parameters and lack of sufficient preparation on existing SQL queries.", "extent": "moderate", "impact": "high"}, {"type": "attack-pattern", "id": "attack-pattern--a296b6e1-1416-4754-9f4e-fb3b6e1f7eaf", "name": "SQL Injection", "description": "The act of injecting SQL code into an application to extract data, create backdoors, or elevate privileges.", "kill_chain_phases": [{"kill_chain_name": "mitre_attack", "phase_name": "lateral_movement"}]}, {"type": "indicator", "id": "indicator--a296b6e1-1416-4754-9f4e-fb3b6e1f7eaf", "name": "WP ERP SQL Injection Indicator", "description": "An indicator of WP ERP SQL injection attacks", "pattern": "SELECT * FROM table WHERE user=' admin'"}, {"type": "relationship", "id": "relationship--a296b6e1-1416-4754-9f4e-fb3b6e1f7eaf", "source_id": "vulnerability--a296b6e1-1416-4754-9f4e-fb3b6e1f7eaf", "target_id": "attack-pattern--a296b6e1-1416-4754-9f4e-fb3b6e1f7eaf", "relationship_type": "associated_with"}, {"type": "relationship", "id": "relationship--a296b6e1-1416-4754-9f4e-fb3b6e1f7eaf", "source_id": "attack-pattern--a296b6e1-1416-4754-9f4e-fb3b6e1f7eaf", "target_id": "indicator--a296b6e1-1416-4754-9f4e-fb3b6e1f7eaf", "relationship_type": "associated_with"}]}, "technical_analysis": {"Introduction": "The WP ERP plugin is vulnerable to SQL injection attacks due to insufficient escaping on user-supplied parameters and lack of sufficient preparation on existing SQL queries.", "Impact and Scope": "The vulnerability is present in all versions of the WP ERP plugin up to and including 1.13.1, and can be exploited by unauthenticated attackers with accounting manager or admin access.", "Related MITRE ATT&CK Techniques": "T1059: Command and Control, T1132: SQL Injection, T1055: Command Injection, and T1060: Account Manipulation.", "Technical Details": "The vulnerability is caused by a lack of sufficient escaping on user-supplied parameters and lack of sufficient preparation on existing SQL queries, allowing attackers to inject and execute arbitrary SQL code.", "Detection": "Detection methods include analyzing database logs for suspicious activity, monitoring for unusual user behavior, and implementing security patches.", "Mitigation": "Mitigation strategies include input validation and filtering, parameterized queries, and using prepared statements."}, "executive_analysis": {"Overview": "The WP ERP plugin is vulnerable to SQL injection attacks due to insufficient escaping on user-supplied parameters and lack of sufficient preparation on existing SQL queries.", "Business Impact": "The vulnerability could result in data breaches, unauthorized access, and other significant business risks.", "Technical Impact": "The vulnerability allows attackers to extract sensitive data, create backdoors, or elevate privileges.", "Mitigation Strategies": "Implement input validation and filtering, parameterized queries, and using prepared statements.", "Recommendations": "Recommendations for executives include implementing a robust security patch management process, regularly monitoring for suspicious activity, and implementing robust incident response and disaster recovery plans.", "Conclusions": "The WP ERP plugin vulnerability is a significant risk that requires immediate attention. Implementing mitigation strategies and regularly monitoring for suspicious activity can help prevent exploitation and minimize the impact of an attack."}}