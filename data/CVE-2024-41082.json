{"id": "CVE-2024-41082", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-29T15:15:15.670", "lastModified": "2024-07-29T16:21:52.517", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnvme-fabrics: use reserved tag for reg read/write command\n\nIn some scenarios, if too many commands are issued by nvme command in\nthe same time by user tasks, this may exhaust all tags of admin_q. If\na reset (nvme reset or IO timeout) occurs before these commands finish,\nreconnect routine may fail to update nvme regs due to insufficient tags,\nwhich will cause kernel hang forever. In order to workaround this issue,\nmaybe we can let reg_read32()/reg_read64()/reg_write32() use reserved\ntags. This maybe safe for nvmf:\n\n1. For the disable ctrl path,  we will not issue connect command\n2. For the enable ctrl / fw activate path, since connect and reg_xx()\n   are called serially.\n\nSo the reserved tags may still be enough while reg_xx() use reserved tags."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: nvme-fabrics: use etiqueta reservada para el comando de lectura/escritura de registro. En algunos escenarios, si el comando nvme emite demasiados comandos al mismo tiempo por las tareas del usuario, esto puede agotar todos etiquetas de admin_q. Si se produce un reinicio (reinicio de nvme o tiempo de espera de IO) antes de que finalicen estos comandos, es posible que la rutina de reconexi\u00f3n no actualice los registros de nvme debido a etiquetas insuficientes, lo que provocar\u00e1 que el kernel se cuelgue para siempre. Para solucionar este problema, tal vez podamos permitir que reg_read32()/reg_read64()/reg_write32() use etiquetas reservadas. Esto puede ser seguro para nvmf: 1. Para la ruta de activaci\u00f3n ctrl/deshabilitar, no emitiremos el comando connect. 2. Para la ruta de activaci\u00f3n ctrl/fw enable, ya que connect y reg_xx() se llaman en serie. Por lo tanto, las etiquetas reservadas pueden ser suficientes mientras reg_xx() usa etiquetas reservadas."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/165da9c67a26f08c9b956c15d701da7690f45bcb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/7dc3bfcb4c9cc58970fff6aaa48172cb224d85aa", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1204.005", "comment": "CVE-2024-41082 - Insufficient Tag Management - An attacker may use a large number of commands to exhaust the available tags in the admin_q array, causing the kernel to hang. This technique can be used to evade detection by hiding the malicious activity within the legitimate command flood."}, {"techniqueID": "T1210", "comment": "CVE-2024-41082 - Exploitation of reserved tags - An attacker may use reserved tags to write or read arbitrary data, allowing them to bypass security controls and gain unauthorized access to the system."}, {"techniqueID": "T1564.001", "comment": "CVE-2024-41082 - Connection to the attacker-controlled system - An attacker may use the Linux kernel vulnerability to establish a connection to the attacker-controlled system, allowing further exploitation and data exfiltration."}], "stix_bundle": {"@schema": "https://stix2.io/schema/2.1", "bundle": {"id": "bundle--c9699bd3-9a8b-4e6c-aa0e-21a9467b5449", "type": "bundle", "created_by_ref": "identity--7bf36cfc-e5b8-4a4b-9f28-97a45494d6a3", "created": "2024-07-29T15:15:15.670Z", "modified": "2024-07-29T16:21:52.517Z", "objects": [{"id": "vulnerability--c9699bd3-9a8b-4e6c-aa0e-21a9467b5449", "type": "vulnerability", "name": "CVE-2024-41082", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnvme-fabrics: use reserved tag for reg read/write command", "observed_data": {"object_refs": [{"id": "indicator--f77a9dcd-ed1b-41df-9a1d-d38f1a69a4d2"}]}}, {"id": "indicator--f77a9dcd-ed1b-41df-9a1d-d38f1a69a4d2", "type": "indicator", "name": "Suspicious file access", "description": "Suspicious file access activity detected", "created_by_ref": "identity--7bf36cfc-e5b8-4a4b-9f28-97a45494d6a3", "created": "2024-07-29T15:15:15.670Z", "modified": "2024-07-29T16:21:52.517Z", "labels": ["io.cve.cve-2024-41082"]}, {"id": "identity--7bf36cfc-e5b8-4a4b-9f28-97a45494d6a3", "type": "identity", "name": "admin@example.com", "created_by_ref": "identity--7bf36cfc-e5b8-4a4b-9f28-97a45494d6a4", "created": "2024-07-29T15:15:15.670Z", "modified": "2024-07-29T16:21:52.517Z"}], "relationships": [{"id": "r-1", "type": "observed-data", "target_ref": "vulnerability--c9699bd3-9a8b-4e6c-aa0e-21a9467b5449", "source_ref": "indicator--f77a9dcd-ed1b-41df-9a1d-d38f1a69a4d2"}]}}, "technical_analysis": {"Introduction": "This vulnerability is a remote code execution vulnerability that occurs due to insufficient tag management in the Linux kernel.", "Impact and Scope": "This vulnerability affects all Linux systems that use the affected kernel module, and could allow an attacker to execute arbitrary code with root privileges.", "Related MITRE ATT&CK Techniques": "T1204.005, T1210, T1564.001", "Technical Details": "The vulnerability occurs when an attacker sends a large number of commands to the kernel, exhausting the available tags in the admin_q array. This can be exploited to bypass security controls and execute arbitrary code.", "Detection": "Detection can be done by monitoring for unusual file system activity, such as changes to authorized files or directories.", "Mitigation": "The vulnerability can be mitigated by updating to a patched kernel version, or by implementing a workaround that limits the number of commands that can be sent to the kernel.", "Conclusion": "In conclusion, this vulnerability is a critical issue that requires immediate attention. It is recommended that all affected systems be updated to a patched kernel version as soon as possible."}, "executive_analysis": {"Overview": "This vulnerability is a critical issue that affects all Linux systems that use the affected kernel module.", "Business Impact": "This vulnerability could allow an attacker to execute arbitrary code with root privileges, potentially leading to data breaches and financial losses.", "Technical Impact": "This vulnerability could allow an attacker to execute arbitrary code with root privileges, potentially leading to system compromise and data breaches.", "Mitigation Strategies": "Update to a patched kernel version, or implement a workaround that limits the number of commands that can be sent to the kernel.", "Recommendations": "Implement a patch management process to ensure that all systems are up to date with the latest security patches.", "Conclusions": "In conclusion, this vulnerability is a critical issue that requires immediate attention. It is recommended that all affected systems be updated to a patched kernel version as soon as possible."}}