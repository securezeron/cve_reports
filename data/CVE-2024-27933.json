{"id": "CVE-2024-27933", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-21T02:52:22.197", "lastModified": "2024-03-21T12:58:51.093", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Deno is a JavaScript, TypeScript, and WebAssembly runtime. In version 1.39.0, use of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors, allowing standard input to be re-opened as a different resource resulting in permission prompt bypass. Node child_process IPC relies on the JS side to pass the raw IPC file descriptor to `op_node_ipc_pipe()`, which returns a `IpcJsonStreamResource` ID associated with the file descriptor. On closing the resource, the raw file descriptor is closed together.\n\nUse of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors. This allow standard input (fd 0) to be closed and re-opened for a different resource, which allows a silent permission prompt bypass. This is exploitable by an attacker controlling the code executed inside a Deno runtime to obtain arbitrary code execution on the host machine regardless of permissions.\n\nThis bug is known to be exploitable. There is a working exploit that achieves arbitrary code execution by bypassing prompts from zero permissions, additionally abusing the fact that Cache API lacks filesystem permission checks. The attack can be conducted silently as stderr can also be closed, suppressing all prompt outputs.\n\nVersion 1.39.1 fixes the bug.\n"}, {"lang": "es", "value": "Deno es un tiempo de ejecuci\u00f3n de JavaScript, TypeScript y WebAssembly. En la versi\u00f3n 1.39.0, el uso de descriptores de archivos sin formato en `op_node_ipc_pipe()` conduce al cierre prematuro de descriptores de archivos arbitrarios, lo que permite volver a abrir la entrada est\u00e1ndar como un recurso diferente, lo que da como resultado la omisi\u00f3n de la solicitud de permiso. El nodo child_process IPC depende del lado JS para pasar el descriptor de archivo IPC sin formato a `op_node_ipc_pipe()`, que devuelve un ID de `IpcJsonStreamResource` asociado con el descriptor de archivo. Al cerrar el recurso, el descriptor del archivo sin formato se cierra junto. El uso de descriptores de archivos sin formato en `op_node_ipc_pipe()` conduce al cierre prematuro de descriptores de archivos arbitrarios. Esto permite cerrar y volver a abrir la entrada est\u00e1ndar (fd 0) para un recurso diferente, lo que permite omitir la solicitud de permiso silenciosa. Esto es explotable por un atacante que controla el c\u00f3digo ejecutado dentro de un tiempo de ejecuci\u00f3n de Deno para obtener la ejecuci\u00f3n de c\u00f3digo arbitrario en la m\u00e1quina host, independientemente de los permisos. Se sabe que este error es explotable. Existe un exploit funcional que logra la ejecuci\u00f3n de c\u00f3digo arbitrario al evadir solicitudes de permisos cero, abusando adem\u00e1s del hecho de que la API de cach\u00e9 carece de comprobaciones de permisos del sistema de archivos. El ataque se puede realizar de forma silenciosa ya que stderr tambi\u00e9n se puede cerrar, suprimiendo todas las salidas de aviso. La versi\u00f3n 1.39.1 corrige el error."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.5, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-863"}]}], "references": [{"url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L214", "source": "security-advisories@github.com"}, {"url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L220", "source": "security-advisories@github.com"}, {"url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L225", "source": "security-advisories@github.com"}, {"url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L241", "source": "security-advisories@github.com"}, {"url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L256", "source": "security-advisories@github.com"}, {"url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L265", "source": "security-advisories@github.com"}, {"url": "https://github.com/denoland/deno/blob/v1.39.0/runtime/permissions/prompter.rs#L99", "source": "security-advisories@github.com"}, {"url": "https://github.com/denoland/deno/commit/55fac9f5ead6d30996400e8597c969b675c5a22b", "source": "security-advisories@github.com"}, {"url": "https://github.com/denoland/deno/commit/5a91a065b882215dde209baf626247e54c21a392", "source": "security-advisories@github.com"}, {"url": "https://github.com/denoland/deno/security/advisories/GHSA-6q4w-9x56-rmwq", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-27933 - Use of raw file descriptors in Deno's op_node_ipc_pipe() function can lead to premature close of arbitrary file descriptors, allowing standard input to be reopened as a different resource, resulting in permission prompt bypass. This can be exploited by an attacker to obtain arbitrary code execution on the host machine regardless of permissions."}, {"techniqueID": "T1027", "comment": "CVE-2024-27933 - The vulnerability allows an attacker to bypass permissions checks, which can be used to access unauthorized resources. This can be exploited to steal sensitive data or disrupt critical systems."}, {"techniqueID": "T1210", "comment": "CVE-2024-27933 - The use of raw file descriptors in Deno's op_node_ipc_pipe() function can be exploited to disrupt system calls, allowing an attacker to manipulate system resources and gain unauthorized access."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "urn:mitre:cvss:v3.1:cvssscores:8.2", "definition": "Deno is a JavaScript, TypeScript, and WebAssembly runtime. In version 1.39.0, use of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors, allowing standard input to be re-opened as a different resource resulting in permission prompt bypass.", "scores": {"cvss-v3.1": {"base_score": 8.2, "base_severity": "High"}}}, {"type": "attack_pattern", "id": "urn:mitre:attack:technique:T1190", "name": "Exploit Public-Facing Application", "description": "Use of raw file descriptors in Deno's op_node_ipc_pipe() function can lead to premature close of arbitrary file descriptors, allowing standard input to be reopened as a different resource, resulting in permission prompt bypass."}, {"type": "attack_pattern", "id": "urn:mitre:attack:technique:T1027", "name": "Remote Services Remote File Include", "description": "The vulnerability allows an attacker to bypass permissions checks, which can be used to access unauthorized resources."}, {"type": "attack_pattern", "id": "urn:mitre:attack:technique:T1210", "name": "Exploit Other System Components", "description": "The use of raw file descriptors in Deno's op_node_ipc_pipe() function can be exploited to disrupt system calls, allowing an attacker to manipulate system resources and gain unauthorized access."}, {"type": "indicator", "id": "urn:mitre:indicator:12345", "name": "CVE-2024-27933 POC Code Execution", "description": " Code execution exploiting CVE-2024-27933", "patterns": ["POC code execution"]}], "relationships": [{"type": "related_to", "source_object_id": "urn:mitre:cvss:v3.1:cvssscores:8.2", "destination_object_id": "urn:mitre:attack:technique:T1190"}, {"type": "related_to", "source_object_id": "urn:mitre:cvss:v3.1:cvssscores:8.2", "destination_object_id": "urn:mitre:attack:technique:T1027"}, {"type": "related_to", "source_object_id": "urn:mitre:cvss:v3.1:cvssscores:8.2", "destination_object_id": "urn:mitre:attack:technique:T1210"}, {"type": "related_to", "source_object_id": "urn:mitre:indicator:12345", "destination_object_id": "urn:mitre:attack:technique:T1190"}]}, "technical_analysis": {"Introduction": "The vulnerability in Deno's op_node_ipc_pipe() function allows an attacker to bypass permissions checks, leading to code execution with escalated privileges.", "Impact and Scope": "The vulnerability affects Deno version 1.39.0 and has a CVSS score of 8.2.", "Related MITRE ATT&CK Techniques": "T1190, T1027, and T1210", "Technical Details": "The vulnerability is caused by the use of raw file descriptors in Deno's op_node_ipc_pipe() function, which can lead to premature close of arbitrary file descriptors, allowing standard input to be reopened as a different resource, resulting in permission prompt bypass.", "Detection": "Detection can be performed by monitoring system calls and network traffic for suspicious activity.", "Mitigation": "Mitigation strategies include enabling security features, patching vulnerable systems, and implementing monitoring and detection systems.", "Conclusion": "The vulnerability in Deno's op_node_ipc_pipe() function is a significant threat, and prompt action is necessary to prevent exploitation and minimize damage."}, "executive_analysis": {"Overview": "The vulnerability in Deno's op_node_ipc_pipe() function can lead to code execution with escalated privileges, resulting in significant business and technical risk.", "Business Impact": "The vulnerability can result in data breaches, financial loss, and reputational damage.", "Technical Impact": "The vulnerability can result in system compromise, data corruption, and loss of confidentiality, integrity, and availability.", "Mitigation Strategies": "Patch vulnerable systems, enable security features, and implement monitoring and detection systems.", "Recommendations": "Recommendations include conducting vulnerability assessments, implementing security controls, and increasing incident response preparedness.", "Conclusions": "Prompt action is necessary to prevent exploitation and minimize damage from this vulnerability."}}