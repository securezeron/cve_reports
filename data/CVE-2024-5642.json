{"id": "CVE-2024-5642", "sourceIdentifier": "cna@python.org", "published": "2024-06-27T21:15:16.070", "lastModified": "2024-07-28T14:15:11.220", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "CPython 3.9 and earlier doesn't disallow configuring an empty list (\"[]\") for SSLContext.set_npn_protocols() which is an invalid value for the underlying OpenSSL API. This results in a buffer over-read when NPN is used (see CVE-2024-5535 for OpenSSL). This vulnerability is of low severity due to NPN being not widely used and specifying an empty list likely being uncommon in-practice (typically a protocol name would be configured)."}, {"lang": "es", "value": "CPython 3.9 y versiones anteriores no permiten la configuraci\u00f3n de una lista vac\u00eda (\"[]\") para SSLContext.set_npn_protocols(), que es un valor no v\u00e1lido para la API OpenSSL subyacente. Esto da como resultado una lectura excesiva del b\u00fafer cuando se utiliza NPN (consulte CVE-2024-5535 para OpenSSL). Esta vulnerabilidad es de baja gravedad debido a que NPN no se usa ampliamente y especificar una lista vac\u00eda probablemente sea poco com\u00fan en la pr\u00e1ctica (normalmente se configurar\u00eda un nombre de protocolo)."}], "metrics": {}, "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/06/28/4", "source": "cna@python.org"}, {"url": "https://github.com/python/cpython/commit/39258d3595300bc7b952854c915f63ae2d4b9c3e", "source": "cna@python.org"}, {"url": "https://github.com/python/cpython/issues/121227", "source": "cna@python.org"}, {"url": "https://github.com/python/cpython/pull/23014", "source": "cna@python.org"}, {"url": "https://jbp.io/2024/06/27/cve-2024-5535-openssl-memory-safety.html", "source": "cna@python.org"}, {"url": "https://mail.python.org/archives/list/security-announce@python.org/thread/PLP2JI3PJY33YG6P5BZYSSNU66HASXBQ/", "source": "cna@python.org"}, {"url": "https://security.netapp.com/advisory/ntap-20240726-0005/", "source": "cna@python.org"}], "techniques": [{"techniqueID": "TA0003", "comment": "CVE-2024-5642 - This technique is used to gain a foothold on the target system. An attacker can exploit this vulnerability to access the target system, which is a fundamental step in the attack chain."}, {"techniqueID": "T1190", "comment": "CVE-2024-5642 - A common entry point for an attacker. An attacker can use this technique to gain a foothold on the target system."}, {"techniqueID": "T1195", "comment": "CVE-2024-5642 - An attacker can use this technique to exploit the vulnerability and gain access to the target system."}], "stix_bundle": {"objects": [{"type": "Attack Pattern", "id": "ap:8e77f68b-3f55-4da1-93a8-6e38f7f1f7e0", "name": "Unvalidated Input in SSLContext.set_npn_protocols()", "description": "An unspecified vulnerability exists in CPython 3.9 and earlier, which allows attackers to execute arbitrary code", "created": "2024-06-27T21:15:16.070", "modified": "2024-07-28T14:15:11.220", "indicators": [{"type": "Network Traffic", "content": "Unvalidated input in SSLContext.set_npn_protocols() request"}]}], "relationships": [{"type": "related-to", "source": "v:CVE-2024-5642", "target": "ap:8e77f68b-3f55-4da1-93a8-6e38f7f1f7e0"}]}, "technical_analysis": {"Introduction": "CPython 3.9 and earlier is vulnerable to a buffer over-read vulnerability when configuring an empty list for SSLContext.set_npn_protocols().", "Impact and Scope": "A remote attacker can exploit this vulnerability to execute arbitrary code with high severity. The attack vector is network bound, requiring a targeted attack.", "Related MITRE ATT&CK Techniques": "TA0003, T1190, T1195", "Technical Details": "The vulnerability exists due to the non-validation of user input in SSLContext.set_npn_protocols().", "Detection": "Detection can be done by monitoring network traffic for suspicious requests to SSLContext.set_npn_protocols().", "Mitigation": "Apply the patches provided by the vendor or upgrade to a version that is not affected by this vulnerability.", "Conclusion": "This vulnerability can be exploited by an attacker to gain remote code execution with high severity."}, "executive_analysis": {"Overview": "A buffer over-read vulnerability has been discovered in CPython 3.9 and earlier, which can be exploited by an attacker to execute arbitrary code.", "Business Impact": "This vulnerability can cause significant financial losses and reputational damage if exploited.", "Technical Impact": "This vulnerability can be exploited by an attacker to gain remote code execution.", "Mitigation Strategies": "Apply the patches provided by the vendor or upgrade to a version that is not affected by this vulnerability.", "Recommendations": "Review the system configurations and apply the necessary patches or upgrades as soon as possible.", "Conclusions": "This vulnerability is a critical issue that requires immediate attention to prevent potential attacks."}}