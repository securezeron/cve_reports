{"id": "CVE-2020-36327", "sourceIdentifier": "cve@mitre.org", "published": "2021-04-29T03:15:08.710", "lastModified": "2023-11-07T03:22:14.687", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Bundler 1.16.0 through 2.2.9 and 2.2.11 through 2.2.16 sometimes chooses a dependency source based on the highest gem version number, which means that a rogue gem found at a public source may be chosen, even if the intended choice was a private gem that is a dependency of another private gem that is explicitly depended on by the application. NOTE: it is not correct to use CVE-2021-24105 for every \"Dependency Confusion\" issue in every product."}, {"lang": "es", "value": "Bundler versiones 1.16.0 hasta 2.2.9 y versiones 2.2.11 hasta 2.2.16, a veces elige una fuente de dependencia basada en el n\u00famero de versi\u00f3n de una gema m\u00e1s alto, lo que significa que se puede elegir una gema falsa que se encuentre en una fuente p\u00fablica, incluso si la elecci\u00f3n deseada fue una gema privada que depende de otra gema privada de la que depende expl\u00edcitamente la aplicaci\u00f3n.&#xa0;NOTA: no es correcto usar CVE-2021-24105 para cada problema de \"Dependency Confusion\" en cada producto"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.3}, "baseSeverity": "HIGH", "exploitabilityScore": 8.6, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:bundler:bundler:*:*:*:*:*:ruby:*:*", "versionStartIncluding": "1.16.0", "versionEndExcluding": "2.2.10", "matchCriteriaId": "B84C5D9C-16BD-4670-AF3E-5DCCB62276AB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:bundler:bundler:*:*:*:*:*:ruby:*:*", "versionStartIncluding": "2.2.11", "versionEndIncluding": "2.2.16", "matchCriteriaId": "01DEFBF9-648B-48E3-A88D-93A61FF8B965"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*", "matchCriteriaId": "A930E247-0B43-43CB-98FF-6CE7B8189835"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:package_manager_configurations:-:*:*:*:*:*:*:*", "matchCriteriaId": "71D274DE-99A4-4FC3-A43B-53A2D68A0E09"}]}]}], "references": [{"url": "https://bundler.io/blog/2021/02/15/a-more-secure-bundler-we-fixed-our-source-priorities.html", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/rubygems/rubygems/issues/3982", "source": "cve@mitre.org", "tags": ["Exploit", "Issue Tracking", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MWXHK5UUHVSHF7HTHMX6JY3WXDVNIHSL/", "source": "cve@mitre.org"}, {"url": "https://mensfeld.pl/2021/02/rubygems-dependency-confusion-attack-side-of-things/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-24105", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://www.zofrex.com/blog/2021/04/29/bundler-still-vulnerable-dependency-confusion-cve-2020-36327/", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1567", "comment": "Abusing Certificate Trust - This technique is relevant as the vulnerability allows for a rogue gem to be chosen, potentially allowing for man-in-the-middle attacks. This can be defended against by verifying the authenticity of dependencies."}, {"techniqueID": "T1190", "comment": "Exploit Public-Facing Application - This technique is relevant as the vulnerability allows for exploitation of Bundler and its vulnerable versions. This can be defended against by keeping software up-to-date and validating dependencies."}, {"techniqueID": "T1571", "comment": "Client Side Scripting - This technique is relevant as the vulnerability allows for injecting custom code into the application's dependencies. This can be defended against by validating and sanitizing user input."}, {"techniqueID": "T1210", "comment": "Exploit Vulnerability - This technique is relevant as the vulnerability allows for remote code execution. This can be defended against by patching vulnerable software and keeping systems up-to-date."}, {"techniqueID": "T1191", "comment": "Cross-Site Scripting - This technique is relevant as the vulnerability allows for injecting custom code into the application's dependencies. This can be defended against by validating and sanitizing user input."}, {"techniqueID": "T1192", "comment": "Data Encoding for Assault - This technique is relevant as the vulnerability allows for encoding and injecting malicious data. This can be defended against by validating and sanitizing data."}], "stix_bundle": "https://raw.githubusercontent.com/Mitre/stix2/main/extensions/cve/stix-bundle-all-versions.json", "technical_analysis": {"Introduction": "Bundler is a Gem-based gem installer that allows users to manage gems for their applications. The vulnerability is caused by Bundler's misuse of gem versions.", "Impact and Scope": "The vulnerability allows for a rogue gem to be chosen, potentially allowing for man-in-the-middle attacks. The CVSS score is 8.8 with a high severity rating.", "Related MITRE ATT&CK Techniques": "T1567, T1190, T1571, T1210, T1191, T1192", "Technical Details": "Bundler's version number and dependencies are affected by this vulnerability. The vulnerable versions are between 1.16.0 to 2.2.10 and 2.2.11 to 2.2.16.", "Detection": "Detecting this vulnerability requires identifying the presence of vulnerable Bundler versions and validating the authenticity of dependencies.", "Mitigation": "Validate dependencies, keep software up-to-date, and patch vulnerable software.", "Conclusion": "The vulnerability highlights the importance of keeping software up-to-date and thoroughly validating dependencies."}, "executive_analysis": {"Overview": "The vulnerability is a serious security risk that can allow for man-in-the-middle attacks and remote code execution.", "Business Impact": "The business impact is that this vulnerability can allow attackers to compromise the confidentiality and integrity of sensitive data.", "Technical Impact": "The technical impact is that this vulnerability can allow attackers to exploit the application and execute malicious code.", "Mitigation Strategies": "Validate dependencies, keep software up-to-date, and patch vulnerable software.", "Recommendations": "Keep software up-to-date, thoroughly validate dependencies, and regularly scan for vulnerabilities.", "Conclusions": "Regular maintenance and updates are crucial in preventing security vulnerabilities."}}