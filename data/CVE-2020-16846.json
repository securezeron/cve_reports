{"id": "CVE-2020-16846", "sourceIdentifier": "cve@mitre.org", "published": "2020-11-06T08:15:13.283", "lastModified": "2024-07-26T19:53:20.137", "vulnStatus": "Analyzed", "cveTags": [], "cisaExploitAdd": "2021-11-03", "cisaActionDue": "2022-05-03", "cisaRequiredAction": "Apply updates per vendor instructions.", "cisaVulnerabilityName": "SaltStack Salt Shell Injection Vulnerability", "descriptions": [{"lang": "en", "value": "An issue was discovered in SaltStack Salt through 3002. Sending crafted web requests to the Salt API, with the SSH client enabled, can result in shell injection."}, {"lang": "es", "value": "Se detect\u00f3 un problema en SaltStack Salt versiones hasta 3002. El env\u00edo de peticiones web dise\u00f1adas a la Salt API, con el cliente SSH habilitado, puede resultar en una inyecci\u00f3n shell"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*", "versionEndExcluding": "2015.8.10", "matchCriteriaId": "0F9405E3-F2B0-41BA-A39D-61BB38475A59"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*", "versionStartIncluding": "2015.8.11", "versionEndExcluding": "2015.8.13", "matchCriteriaId": "A35C23D3-82D4-46E7-BF08-9229C04C0C3D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*", "versionStartIncluding": "2016.3.0", "versionEndExcluding": "2016.3.4", "matchCriteriaId": "B4741BD5-4C40-48BC-A2C1-E6AB33818201"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*", "versionStartIncluding": "2016.3.5", "versionEndExcluding": "2016.3.6", "matchCriteriaId": "7D28A2B5-316A-45DC-AC85-A0F743C4B3C4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*", "versionStartIncluding": "2016.3.7", "versionEndExcluding": "2016.3.8", "matchCriteriaId": "17C96153-85C1-45DC-A48B-46A3900246E2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*", "versionStartIncluding": "2016.11.0", "versionEndExcluding": "2016.11.3", "matchCriteriaId": "B0A54497-D7E2-4A2C-9719-4D992B296498"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*", "versionStartIncluding": "2016.11.4", "versionEndExcluding": "2016.11.6", "matchCriteriaId": "920C57AF-6E88-465A-83FA-AB947D4C6F0B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*", "versionStartIncluding": "2016.11.7", "versionEndExcluding": "2016.11.10", "matchCriteriaId": "11D84847-0C8A-473A-9186-46FABD7BB59A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*", "versionStartIncluding": "2017.5.0", "versionEndExcluding": "2017.7.4", "matchCriteriaId": "C45ACC11-CA9B-4451-B6DD-BD784349CDE8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*", "versionStartIncluding": "2017.7.5", "versionEndExcluding": "2017.7.8", "matchCriteriaId": "BD998745-FA62-4894-A4FC-767F0DE131B9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*", "versionStartIncluding": "2018.2.0", "versionEndExcluding": "2018.3.5", "matchCriteriaId": "9747884A-8B29-42C9-BF5E-5B6D883A78E3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*", "versionStartIncluding": "2019.2.0", "versionEndExcluding": "2019.2.5", "matchCriteriaId": "F7A2912C-7F48-465D-B7F2-93ECD0D0CB74"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:*:*:*:*:*:*:*:*", "versionStartIncluding": "3000.0", "versionEndExcluding": "3000.3", "matchCriteriaId": "D64191C4-C3D3-4615-B7D5-26ADA8BD7C7B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:3001:*:*:*:*:*:*:*", "matchCriteriaId": "74CAD70E-E77C-4010-B224-CEE3968CB6A2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:saltstack:salt:3002:*:*:*:*:*:*:*", "matchCriteriaId": "F5D7215A-820E-446C-844C-DC4C61BD1884"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:31:*:*:*:*:*:*:*", "matchCriteriaId": "80F0FA5D-8D3B-4C0E-81E2-87998286AF33"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-11/msg00029.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://packetstormsecurity.com/files/160039/SaltStack-Salt-REST-API-Arbitrary-Command-Execution.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/saltstack/salt/releases", "source": "cve@mitre.org", "tags": ["Release Notes"]}, {"url": "https://lists.debian.org/debian-lts-announce/2020/12/msg00007.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2022/01/msg00000.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TPOGB2F6XUAIGFDTOCQDNB2VIXFXHWMA/", "source": "cve@mitre.org", "tags": ["Release Notes"]}, {"url": "https://security.gentoo.org/glsa/202011-13", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2021/dsa-4837", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://www.saltstack.com/blog/on-november-3-2020-saltstack-publicly-disclosed-three-new-cves/", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "https://www.zerodayinitiative.com/advisories/ZDI-20-1379/", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://www.zerodayinitiative.com/advisories/ZDI-20-1380/", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://www.zerodayinitiative.com/advisories/ZDI-20-1381/", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://www.zerodayinitiative.com/advisories/ZDI-20-1382/", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://www.zerodayinitiative.com/advisories/ZDI-20-1383/", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-16846 - Exploitation of SaltStack Salt Shell Injection Vulnerability to execute arbitrary commands. Defend against it by implementing rate limiting and access controls on the Salt API."}, {"techniqueID": "T1568.001", "comment": "CVE-2020-16846 - Execution of arbitrary commands through SaltStack Salt Shell Injection Vulnerability. Defend against it by restricting access to the Salt API and implementing strong authentication."}, {"techniqueID": "T1190", "comment": "CVE-2020-16846 - Exploitation of SaltStack Salt Shell Injection Vulnerability to inject malicious code. Defend against it by implementing input validation on the Salt API and restricting access to unauthorized users."}, {"techniqueID": "T1550", "comment": "CVE-2020-16846 - Command injection through SaltStack Salt Shell Injection Vulnerability. Defend against it by implementing output encoding and restricting access to the Salt API."}, {"techniqueID": "T1191", "comment": "CVE-2020-16846 - Insecure deserialization of user input through SaltStack Salt Shell Injection Vulnerability. Defend against it by implementing secure deserialization of user input and restricting access to the Salt API."}], "stix_bundle": {"stix_bundle": {"bundle_type": "Bundle", "objects": [{"id": "http://stix.example.com/uuid@c73a6d3b-e4ee-4868-a51f-9f9f03a65e79", "type": "Vulnerability", "created_by_ref": "http://stix.example.com/uuid@24f4307e-cf5c-4c44-a1a5-0f8a4d511c44", "modified": "2020-11-06T08:15:13.283", "name": "SaltStack Salt Shell Injection Vulnerability", "description": "An issue was discovered in SaltStack Salt through 3002. Sending crafted web requests to the Salt API, with the SSH client enabled, can result in shell injection.", "identifiers": [{"schema": "http://stix.example.com/json", "value": "CVE-2020-16846"}]}, {"id": "http://stix.example.com/uuid@d15cfaa8-9b90-4da5-94b5-1ec6a58c4db5", "type": "ThreatActor", "created_by_ref": "http://stix.example.com/uuid@24f4307e-cf5c-4c44-a1a5-0f8a4d511c44", "modified": "2020-11-06T08:15:13.283", "name": "Attackers", "description": "Attackers can exploit this vulnerability to execute arbitrary commands on the vulnerable system."}, {"id": "http://stix.example.com/uuid@6eb9f83f-e91e-46b5-b79b-1b9f0c74f0f4", "type": "Indicator", "created_by_ref": "http://stix.example.com/uuid@24f4307e-cf5c-4c44-a1a5-0f8a4d511c44", "modified": "2020-11-06T08:15:13.283", "name": "Malicious HTTP Requests", "description": "Malicious HTTP requests can be used to exploit this vulnerability.", "Observable": "HTTP/1.1 200 OK\r\nContent-Type: text/html\r\n\r\n<html><body>alert('Exploit executed');</body></html>"}, {"id": "http://stix.example.com/uuid@3b74e4a3-9e83-43f5-9638-9ce3e85c9edd", "type": "Course_of_Action", "created_by_ref": "http://stix.example.com/uuid@24f4307e-cf5c-4c44-a1a5-0f8a4d511c44", "modified": "2020-11-06T08:15:13.283", "name": "Fix the vulnerability", "description": "Implement the necessary patches to fix the vulnerability.", "associated_Course_of_Action_ref": "http://stix.example.com/uuid@24f4307e-cf5c-4c44-a1a5-0f8a4d511c44"}, {"id": "http://stix.example.com/uuid@24f4307e-cf5c-4c44-a1a5-0f8a4d511c44", "type": "Course_of_Action", "created_by_ref": "http://stix.example.com/uuid@24f4307e-cf5c-4c44-a1a5-0f8a4d511c44", "modified": "2020-11-06T08:15:13.283", "name": "Monitor for suspicious activity", "description": "Monitor the system for suspicious activity and log any unusual behavior.", "associated_Course_of_Action_ref": "http://stix.example.com/uuid@24f4307e-cf5c-4c44-a1a5-0f8a4d511c44"}], " relationships": [{"from_ref": "http://stix.example.com/uuid@c73a6d3b-e4ee-4868-a51f-9f9f03a65e79", "to_ref": "http://stix.example.com/uuid@d15cfaa8-9b90-4da5-94b5-1ec6a58c4db5", "relationship_type": "exploited_by"}, {"from_ref": "http://stix.example.com/uuid@c73a6d3b-e4ee-4868-a51f-9f9f03a65e79", "to_ref": "http://stix.example.com/uuid@6eb9f83f-e91e-46b5-b79b-1b9f0c74f0f4", "relationship_type": "indicated_by"}, {"from_ref": "http://stix.example.com/uuid@6eb9f83f-e91e-46b5-b79b-1b9f0c74f0f4", "to_ref": "http://stix.example.com/uuid@3b74e4a3-9e83-43f5-9638-9ce3e85c9edd", "relationship_type": "indicates"}, {"from_ref": "http://stix.example.com/uuid@c73a6d3b-e4ee-4868-a51f-9f9f03a65e79", "to_ref": "http://stix.example.com/uuid@3b74e4a3-9e83-43f5-9638-9ce3e85c9edd", "relationship_type": "related_to"}]}}, "technical_analysis": {"Introduction": "SaltStack Salt through 3002 has a shell injection vulnerability that can be exploited by sending crafted web requests to the Salt API.", "Impact and Scope": "The vulnerability affects systems that use SaltStack Salt through 3002.", "Related MITRE ATT&CK Techniques": "T1190, T1568.001, T1191, T1550", "Technical Details": "The vulnerability is caused by the lack of input validation on the Salt API, allowing attackers to inject malicious code.", "Detection": "Monitor the system for suspicious activity and log any unusual behavior.", "Mitigation": "Implement the necessary patches to fix the vulnerability.", "Conclusion": "This vulnerability allows attackers to inject malicious code and execute arbitrary commands, which can result in a range of negative impacts including data breaches and unauthorized access."}, "executive_analysis": {"Overview": "The SaltStack Salt shell injection vulnerability poses a significant risk to organizations that use SaltStack Salt through 3002.", "Business Impact": "The vulnerability can result in data breaches, unauthorized access, and disruption of business operations.", "Technical Impact": "The vulnerability allows attackers to inject malicious code and execute arbitrary commands, which can result in a range of technical impacts including system compromise and data corruption.", "Mitigation Strategies": "Implement the necessary patches to fix the vulnerability, monitor the system for suspicious activity, and restrict access to the Salt API.", "Recommendations": "Organizations should prioritize patching and monitoring, and restrict access to the Salt API.", "Conclusions": "The SaltStack Salt shell injection vulnerability is a critical issue that requires immediate attention and action."}}