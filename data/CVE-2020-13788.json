{"id": "CVE-2020-13788", "sourceIdentifier": "cve@mitre.org", "published": "2020-07-15T21:15:12.300", "lastModified": "2020-07-22T17:35:04.203", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Harbor prior to 2.0.1 allows SSRF with this limitation: an attacker with the ability to edit projects can scan ports of hosts accessible on the Harbor server's intranet."}, {"lang": "es", "value": "Harbor versiones anteriores a 2.0.1, permite un ataque de tipo SSRF con esta limitaci\u00f3n: un atacante con la capacidad de editar proyectos puede escanear puertos de hosts accesibles en la intranet del servidor Harbor"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-918"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:linuxfoundation:harbor:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.0.1", "matchCriteriaId": "49E675AC-61F8-448D-A981-752BB48390A8"}]}]}], "references": [{"url": "https://github.com/goharbor/harbor/releases", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.soluble.ai/blog/harbor-ssrf-cve-2020-13788", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://www.youtube.com/watch?v=v8Isqy4yR3Q", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1204.001", "comment": "CVE-2020-13788 - This SSRF vulnerability can be exploited to scan ports of hosts accessible on the Harbor server's intranet, potentially leading to lateral movement and data exfiltration. Defend against this by implementing Web Application Firewall (WAF) rules and IP blocking."}, {"techniqueID": "T1190", "comment": "This vulnerability can be used to conduct reconnaissance and gather information about the Harbor server's intranet, allowing an attacker to identify potential targets for further exploitation. Defend against this by monitoring network traffic and implementing intrusion detection systems (IDS)."}, {"techniqueID": "T1567.002", "comment": "An attacker with the ability to edit projects can use this vulnerability to conduct further exploitation, such as Lateral Movement or Data Exfiltration. Defend against this by implementing access controls and monitoring system logs."}, {"techniqueID": "T1191", "comment": "This vulnerability can be used to conduct Command and Control (C2) communication, allowing an attacker to send and receive commands and data between the Harbor server and the attacker's C2 server. Defend against this by monitoring network traffic and implementing intrusion detection systems (IDS)."}], "stix_bundle": {"bundle_version": "2.1", "bundle_id": "CVE-2020-13788-STIX-Bundle", "bundle_title": "STIX Bundle for CVE-2020-13788", "objects": [{"type": "vulnerability", "id": "CVE-2020-13788", "description": ["Harbor prior to 2.0.1 allows SSRF with this limitation: an attacker with the ability to edit projects can scan ports of hosts accessible on the Harbor server's intranet."], "cvss_v3": {"base_score": 4.3, "vector_string": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"}, "cm": {"objects": [{"type": "indicator", "id": "CVE-2020-13788-Indicator", "description": ["SSRF vulnerable URLs"], "pattern": [" Pattern matching vulnerable URLs"], "timestamp": 1594927922}]}, "defense_actors": [{"type": "organization", "role": "defender", "description": ["Organizations that use Harbor 2.0.1 or earlier"]}], "remediations": [{"role": "defender", "description": ["Update Harbor to version 2.0.1 or later"], "source": ["CVE-2020-13788-Remediation"]}]}, {"type": "course-of-action", "id": "CVE-2020-13788-COA", "description": ["Remediation steps for CVE-2020-13788"], "mitigation": ["Update Harbor to version 2.0.1 or later"], "notes": ["Implementing access controls and monitoring system logs can help detect and prevent future exploitation"]}]}, "technical_analysis": {"Introduction": "Harbor prior to 2.0.1 allows SSRF with this limitation: an attacker with the ability to edit projects can scan ports of hosts accessible on the Harbor server's intranet.", "Impact and Scope": "This vulnerability has a CVSS 3.1 score of 4.3, with an attack vector of Network and attack complexity of Low.", "Related MITRE ATT&CK Techniques": "T1204.001, T1190, T1567.002, T1191", "Technical Details": "The vulnerability allows SSRF with this limitation: an attacker with the ability to edit projects can scan ports of hosts accessible on the Harbor server's intranet.", "Detection": "Detect SSRF vulnerable URLs using pattern matching and monitor system logs for suspicious activity.", "Mitigation": "Update Harbor to version 2.0.1 or later and implement access controls and monitoring system logs.", "Conclusion": "CVE-2020-13788 is a critical vulnerability and should be remediated as soon as possible."}, "executive_analysis": {"Overview": "This vulnerability is critical due to its potential for lateral movement and data exfiltration.", "Business Impact": "The potential for data exfiltration and lateral movement poses a significant risk to organizations that use Harbor 2.0.1 or earlier.", "Technical Impact": "The vulnerability allows SSRF and can be used to conduct reconnaissance, gather information, and potentially exploit further.", "Mitigation Strategies": "Implement Web Application Firewall (WAF) rules and IP blocking, and update Harbor to version 2.0.1 or later.", "Recommendations": "Remediate the vulnerability as soon as possible and implement access controls and monitoring system logs.", "Conclusions": "Organizations that use Harbor 2.0.1 or earlier should take immediate action to remediate the vulnerability."}}