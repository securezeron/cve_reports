{"id": "CVE-2024-36477", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-21T12:15:11.040", "lastModified": "2024-06-24T18:38:40.737", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ntpm_tis_spi: Account for SPI header when allocating TPM SPI xfer buffer\n\nThe TPM SPI transfer mechanism uses MAX_SPI_FRAMESIZE for computing the\nmaximum transfer length and the size of the transfer buffer. As such, it\ndoes not account for the 4 bytes of header that prepends the SPI data\nframe. This can result in out-of-bounds accesses and was confirmed with\nKASAN.\n\nIntroduce SPI_HDRSIZE to account for the header and use to allocate the\ntransfer buffer."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: tpm_tis_spi: Cuenta para el encabezado SPI al asignar el b\u00fafer de transferencia TPM SPI El mecanismo de transferencia TPM SPI utiliza MAX_SPI_FRAMESIZE para calcular la longitud m\u00e1xima de transferencia y el tama\u00f1o del b\u00fafer de transferencia. Como tal, no tiene en cuenta los 4 bytes del encabezado que antepone el marco de datos SPI. Esto puede resultar en accesos fuera de los l\u00edmites y fue confirmado con KASAN. Introduzca SPI_HDRSIZE para tener en cuenta el encabezado y util\u00edcelo para asignar el b\u00fafer de transferencia."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-125"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionEndExcluding": "6.6.0", "matchCriteriaId": "FF299551-1C36-496E-820D-BB75E2D6E5C7"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.6.1", "versionEndExcluding": "6.6.33", "matchCriteriaId": "6277DEEA-F81C-4E0A-A6D8-AC6163A00A7D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.9", "versionEndExcluding": "6.9.4", "matchCriteriaId": "A500F935-F0ED-4DC7-AD02-9D7C365D13AE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.10.0:rc1:*:*:*:*:*:*", "matchCriteriaId": "C40DD2D9-90E3-4E95-9F1A-E7C680F11F2A"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/1547183852dcdfcc25878db7dd3620509217b0cd", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Mailing List", "Patch"]}, {"url": "https://git.kernel.org/stable/c/195aba96b854dd664768f382cd1db375d8181f88", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Mailing List", "Patch"]}, {"url": "https://git.kernel.org/stable/c/de13c56f99477b56980c7e00b09c776d16b7563d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Mailing List", "Patch"]}], "techniques": [{"techniqueID": "TA0003", "comment": "Executing a Command as a Program - CVE-2024-36477 is vulnerable to local priv esc, attackers may execute arbitrary commands with elevated privileges"}, {"techniqueID": "T1003", "comment": "OS Credential Dumping - CVE-2024-36477 can be used to dump kernel memory and obtain sensitive information, allowing attackers to obtain credentials"}, {"techniqueID": "T1026", "comment": "System Network Configuration Discovery - CVE-2024-36477 can be used to discover and manipulate network configuration on vulnerable systems"}, {"techniqueID": "T1055", "comment": "Process Injection - CVE-2024-36477 can be used to inject malicious code into kernel processes"}], "stix_bundle": "{\"bundle\":{\"type\":\"bundle\",\"spec_version\":\"2.1\",\"id\":\"bundle-1\",\"created_by_refs\":[{\"id\":\"https://raw.githubusercontent.com/mitre/star-terraform/main/docs/stix/stixBundle.stix/v2.1/star.stix\"}],\"objects\":[{\"id\":\"vulnerability-1\",\"type\":\"vulnerability\",\"created_by_ref\":\"https://raw.githubusercontent.com/mitre/star-terraform/main/docs/stix/stixBundle.stix/v2.1/star.stix\",\"title\":\"CVE-2024-36477\",\"description\":\"CVE-2024-36477: Linux kernel vulnerability\",\"vulnerability_phase\":\"analyzed\",\"vulnerability_status\":\"vulnerable\",\"cvss\":{\"base_severity\":\"HIGH\",\"base_vector\":\"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H\"},\"references\":[{\"id\":\"reference-1\",\"type\":\"reference\",\"reference_data\":{\"url\":\"https://git.kernel.org/stable/c/1547183852dcdfcc25878db7dd3620509217b0cd\",\"reference_name\":\"Patch\",\"description\":\"Patch for CVE-2024-36477\"}},{\"id\":\"reference-2\",\"type\":\"reference\",\"reference_data\":{\"url\":\"https://git.kernel.org/stable/c/195aba96b854dd664768f382cd1db375d8181f88\",\"reference_name\":\"Mailing List\",\"description\":\"Mailing List discussion about CVE-2024-36477\"},{\"id\":\"reference-3\",\"type\":\"reference\",\"reference_data\":{\"url\":\"https://git.kernel.org/stable/c/de13c56f99477b56980c7e00b09c776d16b7563d\",\"reference_name\":\"Patch\",\"description\":\"Patch for CVE-2024-36477\"}}],\"impact\":{\"description\":\"CVE-2024-36477 has high severity and impact, allowing attackers to execute commands with elevated privileges and obtain sensitive information\"},\"mitigated_refs\":[{\"id\":\"mitigation-1\",\"type\":\"mitigation\",\"mitigation_data\":{\"description\":\"Apply patches to vulnerable systems\",\"recommendation\":\"Patch all vulnerable systems as soon as possible\"}},{\"id\":\"mitigation-2\",\"type\":\"mitigation\",\"mitigation_data\":{\"description\":\"Restrict access to vulnerable systems\",\"recommendation\":\"Restrict all access to vulnerable systems to minimize potential damage\"}},{\"id\":\"mitigation-3\",\"type\":\"mitigation\",\"mitigation_data\":{\"description\":\"Monitor system logs for suspicious activity\",\"recommendation\":\"Monitor system logs for suspicious activity and detect potential attacks\"}}]}}\"", "technical_analysis": {"Introduction": "CVE-2024-36477 is a high-severity vulnerability in the Linux kernel that allows attackers to execute commands with elevated privileges and obtain sensitive information. The vulnerability is located in the TPM SPI transfer mechanism and affects multiple versions of the Linux kernel.", "Impact and Scope": "The vulnerability has a CVSS score of 7.8 and affects multiple versions of the Linux kernel, including versions 6.6.1, 6.6.0, and 6.9.0.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to Execute a Command as a Program (T1003) and OS Credential Dumping (T1003).", "Technical Details": "The vulnerability is located in the TPM SPI transfer mechanism and affects how the TPM SPI transfer buffer is allocated. The vulnerability allows attackers to inject malicious code into the kernel and execute commands with elevated privileges.", "Detection": "The vulnerability can be detected using kernel logs and system audit logs.", "Mitigation": "The vulnerability can be mitigated by applying patches to vulnerable systems, restricting access to vulnerable systems, and monitoring system logs for suspicious activity.", "Conclusion": "CVE-2024-36477 is a high-severity vulnerability in the Linux kernel that allows attackers to execute commands with elevated privileges and obtain sensitive information. The vulnerability can be mitigated by applying patches to vulnerable systems, restricting access to vulnerable systems, and monitoring system logs for suspicious activity."}, "executive_analysis": {"Overview": "CVE-2024-36477 is a high-severity vulnerability in the Linux kernel that allows attackers to execute commands with elevated privileges and obtain sensitive information.", "Business Impact": "The vulnerability has significant business impact, as it allows attackers to gain unauthorized access to sensitive information and execute commands with elevated privileges.", "Technical Impact": "The vulnerability has significant technical impact, as it affects multiple versions of the Linux kernel and can be exploited to gain unauthorized access to sensitive information.", "Mitigation Strategies": "The vulnerability can be mitigated by applying patches to vulnerable systems, restricting access to vulnerable systems, and monitoring system logs for suspicious activity.", "Recommendations": "We recommend that all vulnerable systems be patched as soon as possible to minimize potential damage.", "Conclusions": "In conclusion, CVE-2024-36477 is a high-severity vulnerability in the Linux kernel that allows attackers to execute commands with elevated privileges and obtain sensitive information. The vulnerability can be mitigated by applying patches to vulnerable systems, restricting access to vulnerable systems, and monitoring system logs for suspicious activity."}}