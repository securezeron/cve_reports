{"id": "CVE-2024-38555", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-19T14:15:15.720", "lastModified": "2024-08-27T19:54:04.720", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/mlx5: Discard command completions in internal error\n\nFix use after free when FW completion arrives while device is in\ninternal error state. Avoid calling completion handler in this case,\nsince the device will flush the command interface and trigger all\ncompletions manually.\n\nKernel log:\n------------[ cut here ]------------\nrefcount_t: underflow; use-after-free.\n...\nRIP: 0010:refcount_warn_saturate+0xd8/0xe0\n...\nCall Trace:\n<IRQ>\n? __warn+0x79/0x120\n? refcount_warn_saturate+0xd8/0xe0\n? report_bug+0x17c/0x190\n? handle_bug+0x3c/0x60\n? exc_invalid_op+0x14/0x70\n? asm_exc_invalid_op+0x16/0x20\n? refcount_warn_saturate+0xd8/0xe0\ncmd_ent_put+0x13b/0x160 [mlx5_core]\nmlx5_cmd_comp_handler+0x5f9/0x670 [mlx5_core]\ncmd_comp_notifier+0x1f/0x30 [mlx5_core]\nnotifier_call_chain+0x35/0xb0\natomic_notifier_call_chain+0x16/0x20\nmlx5_eq_async_int+0xf6/0x290 [mlx5_core]\nnotifier_call_chain+0x35/0xb0\natomic_notifier_call_chain+0x16/0x20\nirq_int_handler+0x19/0x30 [mlx5_core]\n__handle_irq_event_percpu+0x4b/0x160\nhandle_irq_event+0x2e/0x80\nhandle_edge_irq+0x98/0x230\n__common_interrupt+0x3b/0xa0\ncommon_interrupt+0x7b/0xa0\n</IRQ>\n<TASK>\nasm_common_interrupt+0x22/0x40"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net/mlx5: descartar la finalizaci\u00f3n de comandos en caso de error interno. Se corrige el use-after-free cuando llega la finalizaci\u00f3n del FW mientras el dispositivo est\u00e1 en estado de error interno. Evite llamar al controlador de finalizaci\u00f3n en este caso, ya que el dispositivo limpiar\u00e1 la interfaz de comando y activar\u00e1 todas las finalizaciones manualmente. Registro del kernel: ------------[ cortar aqu\u00ed ]------------ refcount_t: underflow; use-after-free. ... RIP: 0010:refcount_warn_saturate+0xd8/0xe0 ... Seguimiento de llamadas: ? __advertir+0x79/0x120 ? refcount_warn_saturate+0xd8/0xe0? report_bug+0x17c/0x190? handle_bug+0x3c/0x60? exc_invalid_op+0x14/0x70? asm_exc_invalid_op+0x16/0x20? refcount_warn_saturate+0xd8/0xe0 cmd_ent_put+0x13b/0x160 [mlx5_core] mlx5_cmd_comp_handler+0x5f9/0x670 [mlx5_core] cmd_comp_notifier+0x1f/0x30 [mlx5_core] notifier_call_chain+0x35/0xb0 cadena+0x16/0x20 mlx5_eq_async_int+0xf6/0x290 [mlx5_core] notifier_call_chain+0x35 /0xb0 atomic_notifier_call_chain+0x16/0x20 irq_int_handler+0x19/0x30 [mlx5_core] __handle_irq_event_percpu+0x4b/0x160 handle_irq_event+0x2e/0x80 handle_edge_irq+0x98/0x230 __common_interrupt+0x3b/0 xa0 interrupci\u00f3n_com\u00fan+0x7b/0xa0   asm_interrupci\u00f3n_com\u00fan+0x22 /0x40"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-416"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.10.20", "versionEndExcluding": "5.10.219", "matchCriteriaId": "12848580-6A3F-4069-9B0A-78AAA5E79BE7"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.12", "versionEndExcluding": "5.15.161", "matchCriteriaId": "A5A5A54E-7208-43CC-811F-57A4B7A4488D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.16", "versionEndExcluding": "6.1.93", "matchCriteriaId": "EEFB78EE-F990-4197-BF1C-156760A55667"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2", "versionEndExcluding": "6.6.33", "matchCriteriaId": "FCE796DF-3B50-4DC6-BAE5-95271068FC9E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.8.12", "matchCriteriaId": "80550309-67AB-4FD1-AC07-3DED5C4F01B2"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.9", "versionEndExcluding": "6.9.3", "matchCriteriaId": "E07124C1-19E8-4D21-828D-9932A01D3011"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/1337ec94bc5a9eed250e33f5f5c89a28a6bfabdb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/1d5dce5e92a70274de67a59e1e674c3267f94cd7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/3cb92b0ad73d3f1734e812054e698d655e9581b0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/7ac4c69c34240c6de820492c0a28a0bd1494265a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/bf8aaf0ae01c27ae3c06aa8610caf91e50393396", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/db9b31aa9bc56ff0d15b78f7e827d61c4a096e40", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/f6fbb8535e990f844371086ab2c1221f71f993d3", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-38555 - This technique is relevant as it involves using a use-after-free vulnerability to execute arbitrary code, similar to this vulnerability. Defending against this technique involves implementing proper input validation and memory management techniques."}, {"techniqueID": "T1055", "comment": "CVE-2024-38555 - This technique is relevant as it involves exploiting a kernel mode vulnerability, similar to this vulnerability. Defending against this technique involves implementing proper kernel mode vulnerability protections and memory management techniques."}, {"techniqueID": "T1199", "comment": "CVE-2024-38555 - This technique is relevant as it involves using a kernel mode vulnerability to elevate privileges, similar to this vulnerability. Defending against this technique involves implementing proper kernel mode vulnerability protections and access control list (ACL) management techniques."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve-2024-38555", "version": "2.1", "objects": [{"type": "incident", "id": "https://example.com/cve-2024-38555/incident", "created_by_ref": "https://example.com/user/admin", "created": "2024-08-20T14:15:15.000Z", "modified": "2024-08-20T14:15:15.000Z", "description": "CVE-2024-38555 incident report", "labels": ["cve", "use-after-free", "kernel mode vulnerability"]}, {"type": "threat_actor", "id": "https://example.com/cve-2024-38555/threat-actor", "name": "Authenticated Users", "description": "Authenticated users who have access to the system", "roles": ["actor", "actor:authenticated"]}, {"type": "attack_pattern", "id": "https://example.com/cve-2024-38555/attack-pattern", "name": "USE-AFTER-FREE", "description": "An attack pattern where an attacker uses a use-after-free vulnerability to execute arbitrary code", "labels": ["cve", "use-after-free", "kernel mode vulnerability"]}, {"type": "course_of_action", "id": "https://example.com/cve-2024-38555/course-of-action", "name": "Implement proper input validation and memory management", "description": "To mitigate the vulnerability, implement proper input validation and memory management techniques", "objects": [{"type": "note", "id": "https://example.com/cve-2024-38555/course-of-action/note", "content": "Implementing proper input validation and memory management techniques can help prevent the use-after-free vulnerability"}]}], "relationships": [{"type": "related_to", "id": "https://example.com/cve-2024-38555/relationship", "from": "https://example.com/cve-2024-38555/incident", "to": "https://example.com/cve-2024-38555/threat-actor"}, {"type": "related_to", "id": "https://example.com/cve-2024-38555/relationship", "from": "https://example.com/cve-2024-38555/incident", "to": "https://example.com/cve-2024-38555/attack_pattern"}, {"type": "uses", "id": "https://example.com/cve-2024-38555/relationship", "from": "https://example.com/cve-2024-38555/course-of-action", "to": "https://example.com/cve-2024-38555/attack_pattern"}]}, "technical_analysis": {"Introduction": "The CVE-2024-38555 vulnerability is a use-after-free vulnerability in the Linux kernel that allows an authenticated user to execute arbitrary code with elevated privileges.", "Impact and Scope": "The vulnerability affects Linux kernel versions 5.10.20 to 5.10.219, 5.12 to 5.15.161, 5.16 to 6.1.93, 6.2 to 6.6.33, and 6.7 to 6.8.12.", "Related MITRE ATT&CK Techniques": "T1190, T1055, and T1199", "Technical Details": "The vulnerability occurs when the Linux kernel fails to properly validate user input, leading to a use-after-free condition.", "Detection": "Detection involves monitoring system logs for signs of unauthorized access or suspicious activity.", "Mitigation": "Mitigation involves implementing proper input validation and memory management techniques, as well as restricting access to sensitive areas of the system.", "Conclusion": "The CVE-2024-38555 vulnerability is a significant threat to Linux systems and requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2024-38555 vulnerability is a critical security issue that affects Linux systems.", "Business Impact": "The vulnerability has the potential to compromise sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary code with elevated privileges, potentially leading to system compromise.", "Mitigation Strategies": "Implementing proper input validation and memory management techniques, restrict access to sensitive areas of the system, and detect and respond to suspicious activity.", "Recommendations": "Implement patching and upgrading to the latest Linux kernel version, conduct regular security audits and testing, and train staff on security best practices.", "Conclusions": "The CVE-2024-38555 vulnerability is a critical issue that requires immediate attention and mitigation to prevent potential security breaches."}}