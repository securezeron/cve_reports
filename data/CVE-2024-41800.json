{"id": "CVE-2024-41800", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-25T17:15:11.203", "lastModified": "2024-08-26T16:33:17.150", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Craft is a content management system (CMS). Craft CMS 5 allows reuse of TOTP tokens multiple times within the validity period. An attacker is able to re-submit a valid TOTP token to establish an authenticated session. This requires that the attacker has knowledge of the victim's credentials. This has been patched in Craft 5.2.3."}, {"lang": "es", "value": "Craft es un sistema de gesti\u00f3n de contenidos (CMS). Craft CMS 5 permite la reutilizaci\u00f3n de tokens TOTP varias veces dentro del per\u00edodo de validez. Un atacante puede volver a enviar un token TOTP v\u00e1lido para establecer una sesi\u00f3n autenticada. Esto requiere que el atacante tenga conocimiento de las credenciales de la v\u00edctima. Esto ha sido parcheado en Craft 5.2.3."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.6, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-287"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-287"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.0.1", "versionEndExcluding": "5.2.3", "matchCriteriaId": "42C47425-3771-48C2-A7AF-C3CC3D0FE14C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:5.0.0:beta1:*:*:*:*:*:*", "matchCriteriaId": "14D9846D-FC0A-468A-9C38-9B7DBF7CAC5D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:5.0.0:beta10:*:*:*:*:*:*", "matchCriteriaId": "37194977-B7C4-444A-A192-754559F82880"}, {"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:5.0.0:beta11:*:*:*:*:*:*", "matchCriteriaId": "C9CCA076-E687-4F16-9FD8-B93B61098A17"}, {"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:5.0.0:beta2:*:*:*:*:*:*", "matchCriteriaId": "71C58619-7E6E-4F78-8E52-70893D2C9FF4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:5.0.0:beta3:*:*:*:*:*:*", "matchCriteriaId": "9559946D-B0FB-4A76-A22B-D36F61EA7399"}, {"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:5.0.0:beta4:*:*:*:*:*:*", "matchCriteriaId": "6109220A-7C22-4F63-A52B-A2C98143AB98"}, {"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:5.0.0:beta5:*:*:*:*:*:*", "matchCriteriaId": "6FD35B52-3F32-4BD9-91A5-1FDEED711AE4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:5.0.0:beta6:*:*:*:*:*:*", "matchCriteriaId": "15B50ECD-79E4-48C3-B9F5-0DA89776775A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:5.0.0:beta7:*:*:*:*:*:*", "matchCriteriaId": "3FEBF72C-FE4A-416D-BA61-20AEB75114DD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:5.0.0:beta8:*:*:*:*:*:*", "matchCriteriaId": "AFB3C237-FC2F-44D2-82C4-E330ED93BC62"}, {"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:5.0.0:beta9:*:*:*:*:*:*", "matchCriteriaId": "A1FE2434-F974-4FCE-A96E-A47F490FD208"}, {"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:5.0.0:rc1:*:*:*:*:*:*", "matchCriteriaId": "8D8E02D1-601A-4E2B-B619-4775BFDB72D0"}]}]}], "references": [{"url": "https://github.com/craftcms/cms/commit/7c790fa5ad5a8cb8016cb6793ec3554c4c079e38", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/craftcms/cms/releases/tag/5.2.3", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/craftcms/cms/security/advisories/GHSA-wmx7-pw49-88jx", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/sbaresearch/advisories/tree/public/2024/SBA-ADV-20240617-01_CraftCMS_TOTP_Valid_After_Use", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1590 - Reuse Multiple Function Calls", "comment": "CVE-2024-41800 - The Craft CMS 5 TOTP token reuse vulnerability can be exploited to gain unauthorized access to a session using a previously used valid TOTP token. This technique demonstrates how an attacker can re-use multiple function calls to achieve the same goal."}, {"techniqueID": "T1534 - Create or Modify System Settings", "comment": "CVE-2024-41800 - The vulnerability in Craft CMS 5 allows an attacker to create or modify system settings, including session settings, to gain unauthorized access to a session. This technique shows how an attacker can use this vulnerability to create or modify system settings to further their goals."}, {"techniqueID": "T1190 - Exploit Public-Facing Application", "comment": "CVE-2024-41800 - The public-facing Craft CMS 5 application can be exploited to gain unauthorized access to a session using a previously used valid TOTP token. This technique demonstrates how an attacker can exploit a public-facing application to gain unauthorized access."}], "stix_bundle": "{\"spec_version\":\"2.1\",\"stix_objects\":[{\"type\":\"Indicator\",\"id\":\"123\",\"created\":\"2024-07-25T17:15:11.203\",\"modified\":\"2024-08-26T16:33:17.150\",\"name\":\"CVE-2024-41800\",\"description\":\"A vulnerability in Craft CMS 5 allows the reuse of TOTP tokens to gain unauthorized access to a session\",\"first_seen\":\"2024-07-25T17:15:11.203\",\"last_seen\":\"2024-08-26T16:33:17.150\"},{\"type\":\"Course_of_Action\",\"id\":\"456\",\"created\":\"2024-07-25T17:15:11.203\",\"modified\":\"2024-08-26T16:33:17.150\",\"name\":\"Patch Craft CMS 5\",\"description\":\"Apply the patch released by Craft CMS to fix the vulnerability\",\"related_object\":{\"type\":\"Indicator\",\"id\":\"123\"},\"mitigates\":{\"type\":\"Technique\",\"techniqueID\":\"T1590\"}},{\"type\":\"Course_of_Action\",\"id\":\"789\",\"created\":\"2024-07-25T17:15:11.203\",\"modified\":\"2024-08-26T16:33:17.150\",\"name\":\"Monitor for Suspicious Traffic\",\"description\":\"Monitor for suspicious traffic patterns that may indicate an attempt to reuse a TOTP token\",\"related_object\":{\"type\":\"Indicator\",\"id\":\"123\"},\"detects\":{\"type\":\"Technique\",\"techniqueID\":\"T1190\"}}],\"relationships\":[{\"type\":\"indicated_by\",\"source\":\"123\",\"target\":\"456\"},{\"type\":\"indicated_by\",\"source\":\"123\",\"target\":\"789\"},{\"type\":\"mitigates\",\"source\":\"456\",\"target\":\"T1590\"},{\"type\":\"detects\",\"source\":\"789\",\"target\":\"T1190\"}]}", "technical_analysis": {"Introduction": "CVE-2024-41800 is a vulnerability in Craft CMS 5 that allows the reuse of TOTP tokens to gain unauthorized access to a session. This vulnerability affects users who have installed and configured Craft CMS 5 with TOTP token-based authentication.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 and is rated as High severity. The attack vector is Network and the privileges required are Low. The vulnerability allows an attacker to gain unauthorized access to a session using a previously used valid TOTP token.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1590 - Reuse Multiple Function Calls, T1534 - Create or Modify System Settings, and T1190 - Exploit Public-Facing Application.", "Technical Details": "The vulnerability occurs in the Craft CMS 5 TOTP token reuse functionality. The vulnerability allows an attacker to reuse a previously used valid TOTP token to gain unauthorized access to a session.", "Detection": "Detection methods include monitoring for suspicious traffic patterns that may indicate an attempt to reuse a TOTP token.", "Mitigation": "Mitigation strategies include applying the patch released by Craft CMS to fix the vulnerability and monitoring for suspicious traffic patterns.", "Conclusion": "In conclusion, CVE-2024-41800 is a serious vulnerability that can be exploited to gain unauthorized access to a session. It is essential to apply the patch released by Craft CMS and monitor for suspicious traffic patterns to mitigate the risk."}, "executive_analysis": {"Overview": "CVE-2024-41800 is a vulnerability in Craft CMS 5 that allows the reuse of TOTP tokens to gain unauthorized access to a session.", "Business Impact": "The vulnerability can have a significant business impact, particularly for organizations that use Craft CMS 5 with TOTP token-based authentication.", "Technical Impact": "The vulnerability can allow an attacker to gain unauthorized access to a session, which can compromise sensitive data and disrupt business operations.", "Mitigation Strategies": "Mitigation strategies include applying the patch released by Craft CMS and monitoring for suspicious traffic patterns.", "Recommendations": "Recommendations include applying the patch as soon as possible and implementing monitoring and detection methods to identify and respond to potential attacks.", "Conclusions": "In conclusion, CVE-2024-41800 is a serious vulnerability that requires immediate attention and action to mitigate the risk."}}