{"id": "CVE-2020-15186", "sourceIdentifier": "security-advisories@github.com", "published": "2020-09-17T22:15:12.520", "lastModified": "2021-11-18T17:50:44.500", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Helm before versions 2.16.11 and 3.3.2 plugin names are not sanitized properly. As a result, a malicious plugin author could use characters in a plugin name that would result in unexpected behavior, such as duplicating the name of another plugin or spoofing the output to `helm --help`. This issue has been patched in Helm 3.3.2. A possible workaround is to not install untrusted Helm plugins. Examine the `name` field in the `plugin.yaml` file for a plugin, looking for characters outside of the [a-zA-Z0-9._-] range."}, {"lang": "es", "value": "En Helm versiones anteriores a 2.16.11 y 3.3.2, los nombres de los plugins no son saneados apropiadamente.&#xa0;Como resultado, un autor de plugin malicioso podr\u00eda usar caracteres en un nombre de plugin que resultar\u00eda en un comportamiento inesperado, como duplicar el nombre de otro plugin o falsificar la salida en \"helm --help\".&#xa0;Este problema ha sido corregido en Helm versi\u00f3n 3.3.2.&#xa0;Una posible soluci\u00f3n es no instalar plugins de Helm que no son de confianza.&#xa0;Examine el campo \"name\" en el archivo \"plugin.yaml\" en busca de un plugin, buscando caracteres fuera del rango [a-zA-Z0-9 ._-]"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 2.7, "baseSeverity": "LOW"}, "exploitabilityScore": 1.2, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.4, "baseSeverity": "LOW"}, "exploitabilityScore": 1.6, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:helm:helm:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.0.0", "versionEndExcluding": "2.16.11", "matchCriteriaId": "455BCCE5-1D43-4E59-9591-E84B52DAAF0B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:helm:helm:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.0.0", "versionEndExcluding": "3.3.2", "matchCriteriaId": "B462D769-3FC0-4079-8B48-863F013662EF"}]}]}], "references": [{"url": "https://github.com/helm/helm/commit/809e2d999e2c33e20e77f6bff30652d79c287542", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/helm/helm/security/advisories/GHSA-m54r-vrmv-hw33", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "type": "object", "techniques": [{"techniqueID": "T1199", "comment": "Cross-Site Request Forgery (CSRF) - A plugin author could use characters in a plugin name that would result in unexpected behavior"}, {"techniqueID": "T1195", "comment": "SQL Injection - Unsanitized plugin names can lead to malicious behavior"}, {"techniqueID": "T1082", "comment": "Web Shell - Malicious plugins can be used to execute commands remotely"}, {"techniqueID": "T1425", "comment": "Fork Bomb - Unsanitized plugin names can lead to unexpected behavior"}], "technical_analysis": {"Introduction": "Helm before versions 2.16.11 and 3.3.2 are vulnerable to several web vulnerabilities, including Cross-Site Request Forgery (CSRF), SQL Injection, and Web Shell attacks.", "Impact and Scope": "CVE-2020-15186 is a remote vulnerability with a CVSS score of 2.7 (low) and 3.4 (low) for the primary and secondary CVSS metrics respectively. The attack vector is NETWORK and the user interaction required is NONE.", "Related MITRE ATT&CK Techniques": "T1199, T1195, T1082, and T1425.", "Technical Details": "The vulnerability occurs due to the lack of sanitization of plugin names, allowing malicious authors to use characters that result in unexpected behavior.", "Detection": "Detecting this vulnerability can be challenging, as it requires monitoring for suspicious plugin names and commands.", "Mitigation": "Patching to Helm 3.3.2 or later versions is the recommended mitigation strategy. Additional defense-in-depth measures include using a reputable helm plugin repository and monitoring for suspicious plugin activity.", "Conclusion": "The vulnerability highlights the importance of proper sanitization of user input and the need for timely patching of vulnerabilities."}, "executive_analysis": {"Overview": "CVE-2020-15186 is a web vulnerability in Helm that allows malicious authors to execute commands remotely.", "Business Impact": "The business impact of this vulnerability is minimal, but it highlights the importance of proper security practices in software development.", "Technical Impact": "The technical impact of this vulnerability is moderate, as it could potentially result in unauthorized access to sensitive data or systems.", "Mitigation Strategies": "Patching to Helm 3.3.2 or later versions is the recommended mitigation strategy. Additional defense-in-depth measures include using a reputable helm plugin repository and monitoring for suspicious plugin activity.", "Recommendations": "Executive management is recommended to prioritize timely patching of vulnerabilities and implement additional security measures to prevent future occurrences.", "Conclusions": "The vulnerability highlights the importance of proper security practices in software development, and the need for timely patching of vulnerabilities."}}