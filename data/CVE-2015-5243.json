{"id": "CVE-2015-5243", "sourceIdentifier": "secalert@redhat.com", "published": "2018-08-20T21:29:00.417", "lastModified": "2019-06-26T12:48:15.740", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "phpWhois allows remote attackers to execute arbitrary code via a crafted whois record."}, {"lang": "es", "value": "hpWhois permite que los atacantes remotos ejecuten c\u00f3digo arbitrario mediante un registro whois manipulado."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpwhois_project:phpwhois:*:*:*:*:*:*:*:*", "versionEndIncluding": "4.2.2", "matchCriteriaId": "84F1A53F-EBC8-4644-B45C-5312B5F512A8"}]}]}], "references": [{"url": "https://blog.nettitude.com/uk/cve-2015-5243-phpwhois-remote-code-execution", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/Gemorroj/phpwhois/commit/91c937e03c876ba1290b6de2a3ad953d2105fdd0", "source": "secalert@redhat.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/jsmitty12/phpWhois/blob/master/CHANGELOG.md", "source": "secalert@redhat.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/jsmitty12/phpWhois/issues/19", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/sbaresearch/advisories/tree/public/2018/SBA-ADV-20180425-01_phpWhois_Code_Execution", "source": "secalert@redhat.com", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/sparc/phpWhois.org/commit/5cc572490c9053d46598ec9348a11e36a5a33a46#diff-f150ae17da7341bf6c2eff928684b3a3", "source": "secalert@redhat.com", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2015-5243 - PHPWhois allows remote attackers to execute arbitrary code via a crafted whois record. This technique can be used for code execution and may allow an attacker to gain control of the affected system. Defend against this by ensuring the web application is properly configured and updated with the latest security patches."}, {"techniqueID": "T1033", "comment": "CVE-2015-5243 - This vulnerability allows remote attackers to execute arbitrary code on the server, potentially leading to a complete takeover of the system. Defend against this by using a web application firewall (WAF) to block suspicious traffic and ensuring the web application is properly configured and updated with the latest security patches."}, {"techniqueID": "T1210", "comment": "CVE-2015-5243 - This vulnerability allows remote attackers to execute arbitrary code on the server, potentially leading to a complete takeover of the system. Defend against this by using a network-based IDS/IPS to monitor traffic and block suspicious activity, as well as ensuring the web application is properly configured and updated with the latest security patches."}, {"techniqueID": "T1190", "comment": "CVE-2015-5243 - This vulnerability allows remote attackers to execute arbitrary code on the server, potentially leading to a complete takeover of the system. Defend against this by using a threat intelligence platform to monitor for suspicious activity and ensure the web application is properly configured and updated with the latest security patches."}], "technical_analysis": {"Introduction": "The PHPWhois module in the open-source PHP library allows remote attackers to execute arbitrary code via a crafted whois record, potentially leading to a complete takeover of the system. This vulnerability was discovered in 2015 and has since been patched in the latest version of the PHP library.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 9.8 and an attack vector of network access. This vulnerability allows remote attackers to execute arbitrary code, potentially leading to a complete takeover of the system.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1059, T1033, T1210, and T1190. These techniques all relate to the execution of arbitrary code on the server and the potential for a complete takeover of the system.", "Technical Details": "The vulnerability is caused by a flaw in the PHPWhois module that allows attackers to execute arbitrary code via a crafted whois record. This flaw can be exploited by remote attackers to gain control of the affected system.", "Detection": "The vulnerability can be detected using a combination of network-based IDS/IPS, network traffic analysis, and system monitoring. The PHP library should be updated to the latest version to ensure the vulnerability is patched.", "Mitigation": "The mitigation for this vulnerability is to ensure the web application is properly configured and updated with the latest security patches. A web application firewall (WAF) can also be used to block suspicious traffic and prevent exploitation of the vulnerability.", "Conclusion": "The PHPWhois vulnerability is a high-severity vulnerability that allows remote attackers to execute arbitrary code on the server, potentially leading to a complete takeover of the system. Defend against this vulnerability by ensuring the web application is properly configured and updated with the latest security patches, using a WAF to block suspicious traffic, and monitoring for suspicious activity."}, "executive_analysis": {"Overview": "The PHPWhois vulnerability is a critical security flaw that can be exploited by remote attackers to execute arbitrary code on the server, potentially leading to a complete takeover of the system.", "Business Impact": "The impact of this vulnerability on the business is significant, with potential losses ranging from reputational damage to financial losses.", "Technical Impact": "The technical impact of this vulnerability is also significant, with potential losses ranging from loss of confidentiality to compromise of the entire system.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are to ensure the web application is properly configured and updated with the latest security patches, using a WAF to block suspicious traffic, and monitoring for suspicious activity.", "Recommendations": "Executives are recommended to implement the mitigation strategies outlined above and to monitor for suspicious activity on their systems.", "Conclusions": "In conclusion, the PHPWhois vulnerability is a critical security flaw that requires immediate attention and mitigation. Executives should take immediate action to protect their systems from this vulnerability."}}