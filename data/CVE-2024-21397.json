{"id": "CVE-2024-21397", "sourceIdentifier": "secure@microsoft.com", "published": "2024-02-13T18:15:58.060", "lastModified": "2024-05-29T00:15:33.057", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Microsoft Azure File Sync Elevation of Privilege Vulnerability"}, {"lang": "es", "value": "Vulnerabilidad de elevaci\u00f3n de privilegios de sincronizaci\u00f3n de archivos de Microsoft Azure"}], "metrics": {"cvssMetricV31": [{"source": "secure@microsoft.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:L", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 4.2}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "secure@microsoft.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-59"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:azure_file_sync:*:*:*:*:*:*:*:*", "versionStartIncluding": "14.0.0.0", "versionEndExcluding": "16.2.0.0", "matchCriteriaId": "6261A3F3-0997-433E-BB66-E181585027E1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:azure_file_sync:17.0.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "EF3C7374-606F-4634-8456-DD47335F7613"}]}]}], "references": [{"url": "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-21397", "source": "secure@microsoft.com", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-21397 - Elevation of Privilege vulnerability in Azure File Sync, exploitability possible through LOCAL attack vector, relevance to subsequent Command and Control (C2) operations."}, {"techniqueID": "T1068", "comment": "CVE-2024-21397 - Privilege escalation in Azure File Sync, adversaries can use this to gain elevated privileges and maintain persistence, relevance to subsequent Privilege Escalation (PRIVILEGE_ESCALATION) and Defense Evasion techniques."}, {"techniqueID": "T1548", "comment": "CVE-2024-21397 - Weak credentials stored in Azure File Sync, adversaries can obtain these to access the system, relevance to subsequent Credential Access (CREDENTIAL_ACCESS) and Defense Evasion techniques."}, {"techniqueID": "T1567", "comment": "CVE-2024-21397 - System configuration changes in Azure File Sync, adversaries can use this to maintain persistence and evade detection, relevance to subsequent Privilege Escalation (PRIVILEGE_ESCALATION), Defense Evasion, and Command and Control (C2) operations."}], "stix_bundle": {"id": "f4b745a1-a77c-452b-a5e6-bfa6d7dbff8c", "type": "bundle", "created_by_ref": "https://stix-validator.opencti.io/user", "updated": "2024-02-13T18:15:58.060", "objects": [{"id": "f4b745a1-a77c-452b-a5e6-bfa6d7dbff8c", "type": "Observable", "name": "CVE-2024-21397", "created_by_ref": "https://stix-validator.opencti.io/user", "modified": "2024-02-13T18:15:58.060", "description": "Microsoft Azure File Sync Elevation of Privilege Vulnerability", "last_seen": "2024-02-13T18:15:58.060"}, {"id": "2d5b39a1-b71c-425a-a30c-f1de5a4f8c86", "type": "Indicator", "name": "Azure File Sync Elevation of Privilege", "created_by_ref": "https://stix-validator.opencti.io/user", "modified": "2024-02-13T18:15:58.060", "description": "Indicates the presence of an Elevation of Privilege vulnerability in Azure File Sync", "indicator_types": ["Network traffic"], "observable_refs": ["f4b745a1-a77c-452b-a5e6-bfa6d7dbff8c"]}, {"id": "5f4a7c1f-fd3a-4c52-b18d-b7bd185c8cbe", "type": "Course of Action", "name": "Remediate Azure File Sync Elevation of Privilege", "created_by_ref": "https://stix-validator.opencti.io/user", "modified": "2024-02-13T18:15:58.060", "description": "Apply the provided patch to remediate the Elevation of Privilege vulnerability in Azure File Sync", "course_of_action_types": ["Patch management"], "techniques_refs": ["T1190"]}, {"id": "6f4e1a1f-6e4f-40f9-8b4c-f0b7a86f5c2c", "type": "Note", "name": "Defense in Depth", "created_by_ref": "https://stix-validator.opencti.io/user", "modified": "2024-02-13T18:15:58.060", "description": "Implement additional defense measures such as network segmentation and monitoring to detect and prevent exploitation of the Elevation of Privilege vulnerability in Azure File Sync", "note_types": ["Defense in depth"], "techniques_refs": ["T1068"]}], " relationships": [{"id": "f4b745a1-a77c-452b-a5e6-bfa6d7dbff8c", "type": "related_to", "from": "f4b745a1-a77c-452b-a5e6-bfa6d7dbff8c", "to": "2d5b39a1-b71c-425a-a30c-f1de5a4f8c86"}, {"id": "5f4a7c1f-fd3a-4c52-b18d-b7bd185c8cbe", "type": "related_to", "from": "5f4a7c1f-fd3a-4c52-b18d-b7bd185c8cbe", "to": "f4b745a1-a77c-452b-a5e6-bfa6d7dbff8c"}, {"id": "6f4e1a1f-6e4f-40f9-8b4c-f0b7a86f5c2c", "type": "related_to", "from": "6f4e1a1f-6e4f-40f9-8b4c-f0b7a86f5c2c", "to": "f4b745a1-a77c-452b-a5e6-bfa6d7dbff8c"}]}, "technical_analysis": {"Introduction": "This technical analysis provides an in-depth review of the CVE-2024-21397 Elevation of Privilege vulnerability in Azure File Sync.", "Impact and Scope": "The vulnerability has a CVSS score of 5.3 with a attack vector of LOCAL, allowing an attacker to escalate privileges and maintain persistence.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including T1190, T1068, T1548, and T1567.", "Technical Details": "The vulnerability arises from the use of weak credentials in Azure File Sync, allowing an attacker to access and manipulate system configuration.", "Detection": "Detection of this vulnerability may involve monitoring system logs for unusual privilege escalation activity and analyzing network traffic for signs of Command and Control (C2) communication.", "Mitigation": " Mitigation strategies include applying the provided patch, implementing additional defense measures such as network segmentation and monitoring, and restricting access to sensitive system configuration settings.", "Conclusion": "In conclusion, the CVE-2024-21397 Elevation of Privilege vulnerability in Azure File Sync poses a significant threat to enterprise security, requiring immediate attention and remediation."}, "executive_analysis": {"Overview": "This executive analysis provides a high-level overview of the CVE-2024-21397 Elevation of Privilege vulnerability in Azure File Sync and its potential impact on enterprise security.", "Business Impact": "The impact of this vulnerability on business operations is significant, with the potential for unauthorized access and system compromise.", "Technical Impact": "The technical impact of this vulnerability is also significant, with the potential for system compromise and data theft.", "Mitigation Strategies": "Mitigation strategies include applying the provided patch, implementing additional defense measures, and restricting access to sensitive system configuration settings.", "Recommendations": "Recommendations for executives include prioritizing patching and implementing additional defense measures to protect against exploitation of this vulnerability.", "Conclusions": "In conclusion, executives must take immediate action to protect their enterprise against the CVE-2024-21397 Elevation of Privilege vulnerability in Azure File Sync."}}