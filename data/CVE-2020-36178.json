{"id": "CVE-2020-36178", "sourceIdentifier": "cve@mitre.org", "published": "2021-01-06T21:15:14.317", "lastModified": "2021-01-12T14:38:08.807", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "oal_ipt_addBridgeIsolationRules on TP-Link TL-WR840N 6_EU_0.9.1_4.16 devices allows OS command injection because a raw string entered from the web interface (an IP address field) is used directly for a call to the system library function (for iptables). NOTE: oal_ipt_addBridgeIsolationRules is not the only function that calls util_execSystem."}, {"lang": "es", "value": "oal_ipt_addBridgeIsolationRules en dispositivos TP-Link TL-WR840N versi\u00f3n 6_EU_0.9.1_4.16, permite una inyecci\u00f3n de comandos del Sistema Operativo porque una cadena sin procesar ingresada desde la interfaz web (un campo de direcci\u00f3n IP) es usada directamente para una llamada a la funci\u00f3n de biblioteca del sistema (para iptables)"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:tp-link:tl-wr840n_firmware:6_eu_0.9.1_4.16:*:*:*:*:*:*:*", "matchCriteriaId": "55DB5240-AABB-4179-AFDA-C090849ED6C9"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:tp-link:tl-wr840n:-:*:*:*:*:*:*:*", "matchCriteriaId": "AF3078F3-4CD5-4157-9A2D-7E338B6C7058"}]}]}], "references": [{"url": "https://github.com/therealunicornsecurity/therealunicornsecurity.github.io/blob/master/_posts/2020-10-11-TPLink.md", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://therealunicornsecurity.github.io/TPLink/", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://www.tp-link.com/fr/support/download/tl-wr840n/v6/#Firmware", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059.007", "comment": "CVE-2020-36178 - This technique can be used to inject OS commands on a TP-Link router device, allowing an attacker to execute arbitrary commands with root privileges. This can be prevented by implementing a secure configuration for the device and restricting the permissions of the web interface."}, {"techniqueID": "T1190", "comment": "CVE-2020-36178 - This technique can be used to perform OS command injection on the IP address field, allowing an attacker to execute arbitrary commands with root privileges. This can be prevented by implementing input validation and sanitization for user-generated input."}, {"techniqueID": "T1027", "comment": "CVE-2020-36178 - This technique can be used to obtain a shell on the device, allowing an attacker to execute arbitrary commands with root privileges. This can be prevented by implementing strong access controls and monitoring for suspicious activity."}, {"techniqueID": "T1210", "comment": "CVE-2020-36178 - This technique can be used to perform command injection on the iptables command, allowing an attacker to inject arbitrary commands. This can be prevented by implementing secure coding practices and restricting the permissions of the `iptables` command."}], "stix_bundle": {"type": "bundle", "id": "CVE-2020-36178", "title": "CVE-2020-36178 - TP-Link Router Vulnerability", "created_by_ref": "urn:stix:cybox:identity:username", "created": "2021-01-06T21:15:14.317", "modified": "2021-01-12T14:38:08.807", "objects": [{"type": "vulnerability", "id": "CVE-2020-36178", "title": "CVE-2020-36178 - TP-Link Router Vulnerability", "description": "oal_ipt_addBridgeIsolationRules on TP-Link TL-WR840N 6_EU_0.9.1_4.16 devices allows OS command injection because a raw string entered from the web interface (an IP address field) is used directly for a call to the system library function (for iptables).", "cve_id": "CVE-2020-36178", "cvss": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}, "references": [{"type": "reference", "url": "https://github.com/therealunicornsecurity/therealunicornsecurity.github.io/blob/master/_posts/2020-10-11-TPLink.md"}]}, {"type": "identity", "id": "TP-Link TL-WR840N", "title": "TP-Link TL-WR840N", "description": "The TP-Link TL-WR840N is a wireless router device manufactured by TP-Link."}, {"type": "tool", "id": "oal_ipt_addBridgeIsolationRules", "title": "oal_ipt_addBridgeIsolationRules", "description": "The oal_ipt_addBridgeIsolationRules tool is a component of the TP-Link router firmware that allows administrators to configure the router's network settings."}, {"type": "course_of_action", "id": "Disable oal_ipt_addBridgeIsolationRules", "title": "Disable oal_ipt_addBridgeIsolationRules", "description": "Disable the oal_ipt_addBridgeIsolationRules tool to prevent exploitation.", "mitigates_ref": "CVE-2020-36178", "relates_to_ref": "TP-Link TL-WR840N", "phase": "Prevention"}, {"type": "recommendation", "id": "Implement secure configuration", "title": "Implement Secure Configuration", "description": "Implement a secure configuration for the device, including restrictions on the web interface and strong access controls.", "mitigates_ref": "CVE-2020-36178", "relates_to_ref": "TP-Link TL-WR840N", "phase": "Prevention"}]}, "technical_analysis": {"Introduction": "The CVE-2020-36178 vulnerability is a remote command injection vulnerability in the oal_ipt_addBridgeIsolationRules tool on TP-Link TL-WR840N devices.", "Impact and Scope": "The vulnerability affects devices running firmware version 6_EU_0.9.1_4.16 and allows an attacker to inject arbitrary commands with root privileges. The attack vector is through the web interface.", "Related MITRE ATT&CK Techniques": "T1059.007, T1190, T1027, T1210", "Technical Details": "The vulnerability occurs because the oal_ipt_addBridgeIsolationRules tool does not properly validate and sanitize user-generated input, allowing an attacker to inject arbitrary commands.", "Detection": "Detection is difficult due to the remote nature of the vulnerability and the lack of visible indicators of compromise.", "Mitigation": "Implement a secure configuration for the device, including restrictions on the web interface and strong access controls. Disable the oal_ipt_addBridgeIsolationRules tool.", "Conclusion": "The CVE-2020-36178 vulnerability is a critical vulnerability that allows an attacker to inject arbitrary commands with root privileges. Implementing a secure configuration and disabling the oal_ipt_addBridgeIsolationRules tool are effective mitigation strategies."}, "executive_analysis": {"Overview": "The CVE-2020-36178 vulnerability is a critical remote command injection vulnerability in the oal_ipt_addBridgeIsolationRules tool on TP-Link TL-WR840N devices.", "Business Impact": "The vulnerability poses a significant risk to the confidentiality, integrity, and availability of sensitive data and systems.", "Technical Impact": "The vulnerability allows an attacker to inject arbitrary commands with root privileges, affecting the device's security and integrity.", "Mitigation Strategies": "Implementing a secure configuration and disabling the oal_ipt_addBridgeIsolationRules tool are effective mitigation strategies.", "Recommendations": "Recommendations for executives include prioritizing the patching and configuration of affected devices, implementing strong access controls, and conducting regular security audits.", "Conclusions": "The CVE-2020-36178 vulnerability is a critical vulnerability that requires immediate attention and action to prevent exploitation and minimize the risk of data breaches."}}