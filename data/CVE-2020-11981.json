{"id": "CVE-2020-11981", "sourceIdentifier": "security@apache.org", "published": "2020-07-17T00:15:10.400", "lastModified": "2020-07-24T18:19:48.787", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was found in Apache Airflow versions 1.10.10 and below. When using CeleryExecutor, if an attacker can connect to the broker (Redis, RabbitMQ) directly, it is possible to inject commands, resulting in the celery worker running arbitrary commands."}, {"lang": "es", "value": "Se encontr\u00f3 un problema en Apache Airflow versiones 1.10.10 y posteriores. Cuando se usa la funci\u00f3n CeleryExecutor, si un atacante puede conectarse directamente al broker (Redis, RabbitMQ), es posible inyectar comandos, resultando que el trabajador de celery ejecuta comandos arbitrarios"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:airflow:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.10.10", "matchCriteriaId": "BA641E62-CF59-49E4-B776-0ABB7844A56D"}]}]}], "references": [{"url": "https://lists.apache.org/thread.html/r7255cf0be3566f23a768e2a04b40fb09e52fcd1872695428ba9afe91%40%3Cusers.airflow.apache.org%3E", "source": "security@apache.org", "tags": ["Mailing List", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1504", "comment": "CVE-2020-11981 - Using T1504 to inject commands and execute arbitrary code on the affected system."}, {"techniqueID": "T1059", "comment": "CVE-2020-11981 - Using T1059 to execute commands and collect information on the affected system."}, {"techniqueID": "T1210", "comment": "CVE-2020-11981 - Using T1210 to launch an unauthorized discovery of a system or network."}, {"techniqueID": "T1055", "comment": "CVE-2020-11981 - Using T1055 to transfer data and execute commands on the affected system."}], "technical_analysis": {"Introduction": "Apache Airflow's CeleryExecutor allows an attacker to inject commands, resulting in the celery worker running arbitrary code. This vulnerability allows an attacker to execute commands and collect information on the affected system.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and can result in the execution of arbitrary code on the affected system. The attack vector is NETWORK.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques include T1504, T1059, T1210, and T1055.", "Technical Details": "The vulnerability is caused by the improper handling of user input in the CeleryExecutor. An attacker can inject commands and execute arbitrary code on the affected system.", "Detection": "Detection can be done using network traffic analysis and system logs.", "Mitigation": "Mitigation can be done by updating Apache Airflow to a fixed version and disabling direct connections to the broker.", "Conclusion": "The vulnerability allows an attacker to execute commands and collect information on the affected system, making it a critical vulnerability."}, "executive_analysis": {"Overview": "The vulnerability in Apache Airflow's CeleryExecutor allows an attacker to execute commands and collect information on the affected system.", "Business Impact": "The vulnerability can result in the unauthorized disclosure of sensitive data, disruption of business operations, and other business impacts.", "Technical Impact": "The vulnerability allows an attacker to execute commands and collect information on the affected system, making it a critical vulnerability.", "Mitigation Strategies": "Updating Apache Airflow to a fixed version and disabling direct connections to the broker are recommended.", "Recommendations": "Executives should prioritize the mitigation of this vulnerability and ensure that the affected systems are updated as soon as possible.", "Conclusions": "The vulnerability in Apache Airflow's CeleryExecutor is a critical vulnerability that requires immediate attention and mitigation."}}