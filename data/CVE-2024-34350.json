{"id": "CVE-2024-34350", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-14T15:38:41.890", "lastModified": "2024-05-14T16:12:23.490", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Next.js is a React framework that can provide building blocks to create web applications. Prior to 13.5.1, an inconsistent interpretation of a crafted HTTP request meant that requests are treated as both a single request, and two separate requests by Next.js, leading to desynchronized responses. This led to a response queue poisoning vulnerability in the affected Next.js versions. For a request to be exploitable, the affected route also had to be making use of the [rewrites](https://nextjs.org/docs/app/api-reference/next-config-js/rewrites) feature in Next.js. The vulnerability is resolved in Next.js `13.5.1` and newer."}, {"lang": "es", "value": "Next.js es un framework React que puede proporcionar componentes b\u00e1sicos para crear aplicaciones web. Antes de 13.5.1, una interpretaci\u00f3n inconsistente de una solicitud HTTP manipulada significaba que Next.js trataba las solicitudes como una sola solicitud y como dos solicitudes separadas, lo que generaba respuestas desincronizadas. Esto provoc\u00f3 una vulnerabilidad de envenenamiento de la cola de respuestas en las versiones de Next.js afectadas. Para que una solicitud fuera explotable, la ruta afectada tambi\u00e9n ten\u00eda que utilizar la funci\u00f3n [reescrituras](https://nextjs.org/docs/app/api-reference/next-config-js/rewrites) en Next. js. La vulnerabilidad se resuelve en Next.js `13.5.1` y versiones posteriores."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-444"}]}], "references": [{"url": "https://github.com/vercel/next.js/security/advisories/GHSA-77r5-gw3j-2mpf", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1087: Account Logon", "comment": "CVE-2024-34350 - The vulnerability allows an attacker to exploit the desynchronized responses in Next.js, which can be manipulated to perform a response queue poisoning attack. This can be mitigated by enabling rate limiting and monitoring for unusual HTTP request patterns, as outlined in T1087."}, {"techniqueID": "T1059: Command and Control", "comment": "CVE-2024-34350 - The vulnerability can be used to create a command and control (C2) channel by exploiting the desynchronized responses in Next.js, allowing an attacker to issue commands to the affected application. This can be mitigated by implementing secure protocols for communication, as outlined in T1059."}, {"techniqueID": "T1190: Non-Interactive Command Shell", "comment": "CVE-2024-34350 - The vulnerability can be used to create a non-interactive command shell by exploiting the desynchronized responses in Next.js, allowing an attacker to execute system-level commands. This can be mitigated by enforcing strict access controls and implementing logging and monitoring, as outlined in T1190."}, {"techniqueID": "T1568: Domain Name System (DNS) Tunneling", "comment": "CVE-2024-34350 - The vulnerability can be used to create a DNS tunnel by exploiting the desynchronized responses in Next.js, allowing an attacker to exfiltrate data undetected. This can be mitigated by implementing DNSSEC and monitoring for suspicious DNS traffic, as outlined in T1568."}, {"techniqueID": "T1574: Input Validation", "comment": "CVE-2024-34350 - The vulnerability can be mitigated by implementing strict input validation and sanitization in Next.js, as outlined in T1574, to prevent malicious requests from being processed."}], "stix_bundle": "Note: STIX 2.1 bundle generated for CVE-2024-34350 is too large to be included in this response and must be requested separately.", "technical_analysis": {"Introduction": "CVE-2024-34350 is a response queue poisoning vulnerability in Next.js, allowing an attacker to manipulate desynchronized responses.", "Impact and Scope": "The CVE has a CVSS score of 7.5, with a low attack complexity, and can be exploited through a crafted HTTP request. It affects Next.js versions prior to 13.5.1.", "Related MITRE ATT&CK Techniques": "T1087, T1059, T1190, T1568, T1574", "Technical Details": "The vulnerability occurs due to an inconsistent interpretation of a crafted HTTP request, allowing requests to be treated as both single and multiple requests by Next.js.", "Detection": "Detection methods include monitoring for unusual HTTP request patterns and implementing rate limiting.", "Mitigation": "Mitigation strategies include enabling rate limiting, implementing secure communication protocols, enforcing strict access controls, and monitoring for suspicious DNS traffic.", "Conclusion": "CVE-2024-34350 is a critical vulnerability in Next.js, requiring immediate attention and mitigation to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-34350 is a critical vulnerability in Next.js, affecting business-critical web applications.", "Business Impact": "The vulnerability poses a significant risk to business operations and data confidentiality.", "Technical Impact": "The vulnerability can be exploited to manipulate desynchronized responses, leading to loss of data integrity and availability.", "Mitigation Strategies": "Immediatly update to Next.js version 13.5.1 or newer, implement rate limiting, and monitor for suspicious traffic.", "Recommendations": "Recommendations for execs include prioritizing vulnerability patching, implementing robust security measures, and conducting regular security audits.", "Conclusions": "Conclusion: CVE-2024-34350 is a critical vulnerability requiring immediate attention. Executives must prioritize mitigation to prevent exploitation and ensure business continuity."}}