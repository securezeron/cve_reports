{"id": "CVE-2024-45063", "sourceIdentifier": "secteam@freebsd.org", "published": "2024-09-05T05:15:13.830", "lastModified": "2024-09-06T17:35:18.370", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The function ctl_write_buffer incorrectly set a flag which resulted in a kernel Use-After-Free when a command finished processing.\n\nMalicious software running in a guest VM that exposes virtio_scsi can exploit the vulnerabilities to achieve code execution on the host in the bhyve userspace process, which typically runs as root.  Note that bhyve runs in a Capsicum sandbox, so malicious code is constrained by the capabilities available to the bhyve process.  A malicious iSCSI initiator could achieve remote code execution on the iSCSI target host."}, {"lang": "es", "value": "La funci\u00f3n ctl_write_buffer estableci\u00f3 incorrectamente un indicador que result\u00f3 en un uso posterior a la liberaci\u00f3n del n\u00facleo cuando finaliz\u00f3 el procesamiento de un comando. El software malintencionado que se ejecuta en una m\u00e1quina virtual invitada que expone virtio_scsi puede explotar las vulnerabilidades para lograr la ejecuci\u00f3n de c\u00f3digo en el host en el proceso de espacio de usuario bhyve, que normalmente se ejecuta como ra\u00edz. Tenga en cuenta que bhyve se ejecuta en un entorno aislado de Capsicum, por lo que el c\u00f3digo malintencionado est\u00e1 limitado por las capacidades disponibles para el proceso bhyve. Un iniciador iSCSI malintencionado podr\u00eda lograr la ejecuci\u00f3n remota de c\u00f3digo en el host de destino iSCSI."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.0, "impactScore": 6.0}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-416"}]}, {"source": "secteam@freebsd.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-416"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:*:*:*:*:*:*:*:*", "versionStartIncluding": "13.0", "versionEndExcluding": "13.3", "matchCriteriaId": "E82CE719-C11D-4C34-BDF9-5AA704884289"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:-:*:*:*:*:*:*", "matchCriteriaId": "17DAE911-21E1-4182-85A0-B9F0059DDA7F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:p1:*:*:*:*:*:*", "matchCriteriaId": "ABEA48EC-24EA-4106-9465-CE66B938635F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:p2:*:*:*:*:*:*", "matchCriteriaId": "8DFB5BD0-E777-4CAA-B2E0-3F3357D06D01"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:p3:*:*:*:*:*:*", "matchCriteriaId": "BC8C769C-A23E-4F61-AC42-4DA64421B096"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:p4:*:*:*:*:*:*", "matchCriteriaId": "45B0589E-2E7D-4516-A8A0-88F30038EAB0"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:p5:*:*:*:*:*:*", "matchCriteriaId": "C5CD8EF6-B119-488F-A278-8E9740E3E482"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.4:beta3:*:*:*:*:*:*", "matchCriteriaId": "2F52349C-6051-4CB9-8659-763A22C31640"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:-:*:*:*:*:*:*", "matchCriteriaId": "FA25530A-133C-4D7C-8993-D5C42D79A0B5"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:beta5:*:*:*:*:*:*", "matchCriteriaId": "DB7B021E-F4AD-44AC-96AB-8ACAF8AB1B88"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p1:*:*:*:*:*:*", "matchCriteriaId": "69A72B5A-2189-4700-8E8B-1E5E7CA86C40"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p2:*:*:*:*:*:*", "matchCriteriaId": "5771F187-281B-4680-B562-EFC7441A8F88"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p3:*:*:*:*:*:*", "matchCriteriaId": "0A4437F5-9DDA-4769-974E-23BFA085E0DB"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p4:*:*:*:*:*:*", "matchCriteriaId": "A9C3A3D4-C9F4-41EB-B532-821AF83470B1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p5:*:*:*:*:*:*", "matchCriteriaId": "878A1F0A-087F-47D7-9CA5-A54BB8D6676A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p6:*:*:*:*:*:*", "matchCriteriaId": "CE73CDC3-B5A7-4921-89C6-8F9DC426CB3E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p7:*:*:*:*:*:*", "matchCriteriaId": "50A5E650-31FB-45BE-8827-641B58A83E45"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p8:*:*:*:*:*:*", "matchCriteriaId": "D59CFDD3-AEC3-43F1-A620-0B1F0BAD9048"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p9:*:*:*:*:*:*", "matchCriteriaId": "44B8A489-6314-460D-90DA-AFB54298C8E6"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:rc3:*:*:*:*:*:*", "matchCriteriaId": "038E5B85-7F60-4D71-8D3F-EDBF6E036CE0"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:rc4-p1:*:*:*:*:*:*", "matchCriteriaId": "BF309824-D379-4749-A1FA-BCB2987DD671"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.1:-:*:*:*:*:*:*", "matchCriteriaId": "79D770C6-7A57-4A49-8164-C55391F62301"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.1:p1:*:*:*:*:*:*", "matchCriteriaId": "AA813990-8C8F-4EE8-9F2B-9F73C510A7B2"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.1:p2:*:*:*:*:*:*", "matchCriteriaId": "D4DFA201-27D5-4C01-B90F-E24778943C3B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.1:p3:*:*:*:*:*:*", "matchCriteriaId": "01DD321B-E5E2-49F7-86A1-D40B13E257C7"}]}]}], "references": [{"url": "https://security.freebsd.org/advisories/FreeBSD-SA-24:11.ctl.asc", "source": "secteam@freebsd.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1133", "comment": "CVE-2024-45063 - Use of uninitialized memory, a classic Use-After-Free vulnerability, which can lead to arbitrary code execution if exploited successfully. This CVE is relevant and how to defend against it by ensuring memory initialization and proper error handling."}, {"techniqueID": "T1018", "comment": "CVE-2024-45063 - A Use-After-Free vulnerability that can be exploited to gain arbitrary code execution, this is a critical vulnerability that requires immediate attention and remediation to prevent attacks."}, {"techniqueID": "T1190", "comment": "CVE-2024-45063 - A remote code execution vulnerability in the iSCSI target, which can be exploited by a malicious iSCSI initiator to execute arbitrary code on the target host."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "https://example.com/bundle/CVE-2024-45063", "created_by_ref": "https://example.com/identity/user@example.com", "created": "2024-09-05T05:15:13.830", "modified": "2024-09-06T17:35:18.370", "name": "CVE-2024-45063 Bundle", "description": "A bundle expressing the vulnerability CVE-2024-45063 and related techniques, risks and defense strategies.", "objects": [{"type": "report", "id": "https://example.com/report/CVE-2024-45063", "created_by_ref": "https://example.com/identity/user@example.com", "created": "2024-09-05T05:15:13.830", "modified": "2024-09-06T17:35:18.370", "name": "CVE-2024-45063 Report", "description": "A report expressing the vulnerability CVE-2024-45063 and related techniques, risks and defense strategies.", "title": "CVE-2024-45063 Vulnerability", "objects": [{"type": "vulnerability", "id": "https://example.com/vulnerability/CVE-2024-45063", "created_by_ref": "https://example.com/identity/user@example.com", "created": "2024-09-05T05:15:13.830", "modified": "2024-09-06T17:35:18.370", "name": "CVE-2024-45063 Vulnerability", "description": "A vulnerability related to a Use-After-Free in the ctl_write_buffer function of the bhyve virtualization platform.", "cvss_score": 8.8, "attack_vector": "LOCAL", "attack_complexity": "LOW", "privileges_required": "LOW", "user_interaction": "NONE", "scope": "CHANGED", "confidentiality_impact": "HIGH", "integrity_impact": "HIGH", "availability_impact": "HIGH"}, {"type": "relationship", "id": "https://example.com/relationship/CVE-2024-45063-T1133", "created_by_ref": "https://example.com/identity/user@example.com", "created": "2024-09-05T05:15:13.830", "modified": "2024-09-06T17:35:18.370", "rel_type": "uses", "from": "https://example.com/vulnerability/CVE-2024-45063", "to": "https://example.com/technique/T1133"}, {"type": "relationship", "id": "https://example.com/relationship/CVE-2024-45063-T1018", "created_by_ref": "https://example.com/identity/user@example.com", "created": "2024-09-05T05:15:13.830", "modified": "2024-09-06T17:35:18.370", "rel_type": "uses", "from": "https://example.com/vulnerability/CVE-2024-45063", "to": "https://example.com/technique/T1018"}, {"type": "relationship", "id": "https://example.com/relationship/CVE-2024-45063-T1190", "created_by_ref": "https://example.com/identity/user@example.com", "created": "2024-09-05T05:15:13.830", "modified": "2024-09-06T17:35:18.370", "rel_type": "uses", "from": "https://example.com/vulnerability/CVE-2024-45063", "to": "https://example.com/technique/T1190"}]}]}}, "technical_analysis": {"Introduction": "The CVE-2024-45063 vulnerability is a critical remote code execution vulnerability in the iSCSI target of the bhyve virtualization platform.", "Impact and Scope": "The vulnerability allows an attacker to execute arbitrary code on the target host, which can lead to a complete compromise of the system. The vulnerability has a CVSS score of 8.8 and an attack vector of LOCAL.", "Related MITRE ATT&CK Techniques": "The vulnerability is exploited by three MITRE ATT&CK techniques: T1133, T1018, and T1190.", "Technical Details": "The vulnerability is related to a Use-After-Free in the ctl_write_buffer function of the bhyve virtualization platform. The vulnerability can be exploited by a malicious iSCSI initiator to execute arbitrary code on the target host.", "Detection": "Detection of the vulnerability requires monitoring for suspicious network traffic and memory access patterns.", "Mitigation": "Mitigation of the vulnerability requires applying patches and configuring firewalls to restrict access to the vulnerable services.", "Conclusion": "The CVE-2024-45063 vulnerability is a critical vulnerability that requires immediate attention and remediation to prevent attacks."}, "executive_analysis": {"Overview": "The CVE-2024-45063 vulnerability is a critical remote code execution vulnerability in the iSCSI target of the bhyve virtualization platform.", "Business Impact": "The vulnerability can allow an attacker to compromise the system, which can lead to a significant business impact, including data breach, financial loss, and reputational damage.", "Technical Impact": "The vulnerability can allow an attacker to execute arbitrary code on the target host, which can lead to a complete compromise of the system.", "Mitigation Strategies": "Mitigation of the vulnerability requires applying patches and configuring firewalls to restrict access to the vulnerable services.", "Recommendations": "Recommendations for executives include reviewing security policies, implementing patch management procedures, and conducting regular security assessments.", "Conclusions": "The CVE-2024-45063 vulnerability is a critical vulnerability that requires immediate attention and remediation to prevent attacks."}}