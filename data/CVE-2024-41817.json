{"id": "CVE-2024-41817", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-29T16:15:05.360", "lastModified": "2024-07-29T16:21:52.517", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "ImageMagick is a free and open-source software suite, used for editing and manipulating digital images. The `AppImage` version `ImageMagick` might use an empty path when setting `MAGICK_CONFIGURE_PATH` and `LD_LIBRARY_PATH` environment variables while executing, which might lead to arbitrary code execution by loading malicious configuration files or shared libraries in the current working directory while executing `ImageMagick`. The vulnerability is fixed in 7.11-36."}, {"lang": "es", "value": " ImageMagick es un paquete de software gratuito y de c\u00f3digo abierto que se utiliza para editar y manipular im\u00e1genes digitales. La versi\u00f3n `AppImage` `ImageMagick` puede usar una ruta vac\u00eda al configurar las variables de entorno `MAGICK_CONFIGURE_PATH` y `LD_LIBRARY_PATH` durante la ejecuci\u00f3n, lo que podr\u00eda llevar a la ejecuci\u00f3n de c\u00f3digo arbitrario al cargar archivos de configuraci\u00f3n maliciosos o librer\u00edas compartidas en el directorio de trabajo actual mientras se ejecuta ` ImagenMagick`. La vulnerabilidad se solucion\u00f3 en 7.11-36."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.0, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.0, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-427"}]}], "references": [{"url": "https://github.com/ImageMagick/ImageMagick/blob/3b22378a23d59d7517c43b65b1822f023df357a0/app-image/AppRun#L11-L14", "source": "security-advisories@github.com"}, {"url": "https://github.com/ImageMagick/ImageMagick/commit/6526a2b28510ead6a3e14de711bb991ad9abff38", "source": "security-advisories@github.com"}, {"url": "https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-8rxc-922v-phg8", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1198", "comment": "T1198 - Code Execution - {CVE-2024-41817} - This vulnerability allows attackers to execute arbitrary code on the system through the configuration file, making it a potential entry point for attackers to gain control over the system. To defend against this, ensure that only trusted files are executed and configure the system to restrict file execution from arbitrary directories."}, {"techniqueID": "T1210", "comment": "T1210 - Exploitation of Remote Services - {CVE-2024-41817} - This vulnerability allows attackers to exploit the ImageMagick service to execute arbitrary code on the system, highlighting the importance of securing remote services and implementing proper access controls."}, {"techniqueID": "T1222", "comment": "T1222 - Data Encoding - {CVE-2024-41817} - The vulnerability allows attackers to load malicious configuration files or shared libraries in the current working directory, making data encoding a critical aspect of defense."}], "stix_bundle": {"type": "bundle", "objects": [{"type": "vulnerability", "id": "vuln:-1", "name": "ImageMagick Vulnerability CVE-2024-41817", "description": "ImageMagick is a free and open-source software suite, used for editing and manipulating digital images. The AppImage version ImageMagick might use an empty path when setting MAGICK_CONFIGURE_PATH and LD_LIBRARY_PATH environment variables while executing, which might lead to arbitrary code execution by loading malicious configuration files or shared libraries in the current working directory while executing ImageMagick.", "score": {"cvssMetricV31": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"}}}, {"type": "course-of-action", "id": "coa:-1", "name": "Patch Installation", "description": "Install the patched version of ImageMagick to remediate the vulnerability.", "relationships": [{"type": "mitigates", "id": "rel:-1", "objectReference": {"href": "#vuln:-1"}}]}, {"type": "course-of-action", "id": "coa:-2", "name": "Environmental Variable Configuration", "description": "Configure the system to restrict environment variables to trusted values.", "relationships": [{"type": "mitigates", "id": "rel:-2", "objectReference": {"href": "#vuln:-1"}}]}, {"type": "indicator", "id": "indicator:-1", "name": "Malicious Configuration Files", "description": "Detect and block any attempts to load malicious configuration files or shared libraries in the current working directory.", "relationships": [{"type": "implies", "id": "rel:-3", "objectReference": {"href": "#coa:-2"}}]}], "relations": [{"type": "related-to", "id": "rel:-4", "source": {"href": "#vuln:-1"}, "target": {"href": "#indicator:-1"}}]}, "technical_analysis": {"Introduction": "ImageMagick is a free and open-source software suite, used for editing and manipulating digital images. The AppImage version ImageMagick might use an empty path when setting MAGICK_CONFIGURE_PATH and LD_LIBRARY_PATH environment variables while executing, which might lead to arbitrary code execution by loading malicious configuration files or shared libraries in the current working directory while executing ImageMagick.", "Impact and Scope": "The vulnerability has a CVSS score of 7.0 and allows attackers to execute arbitrary code on the system through the configuration file, making it a potential entry point for attackers to gain control over the system.", "Related MITRE ATT&CK Techniques": "T1198, T1210, and T1222", "Technical Details": "The vulnerability occurs when the environment variables MAGICK_CONFIGURE_PATH and LD_LIBRARY_PATH are set to empty values, allowing attackers to load malicious configuration files or shared libraries in the current working directory.", "Detection": "Detect and block any attempts to load malicious configuration files or shared libraries in the current working directory.", "Mitigation": "Install the patched version of ImageMagick, configure the system to restrict environment variables to trusted values, and implement proper access controls.", "Conclusion": "The vulnerability highlights the importance of securing remote services and implementing proper access controls, as well as configuring the system to restrict environment variables to trusted values and detecting and blocking any attempts to load malicious configuration files or shared libraries in the current working directory."}, "executive_analysis": {"Overview": "The vulnerability in ImageMagick's AppImage version allows attackers to execute arbitrary code on the system, which has significant implications for the organization's security.", "Business Impact": "The vulnerability has the potential to lead to data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability has a CVSS score of 7.0, which highlights its severity and potential impact.", "Mitigation Strategies": "Implementing the patched version of ImageMagick, restricting environment variables to trusted values, and implementing proper access controls are essential mitigation strategies.", "Recommendations": "Install the patched version of ImageMagick, and implement proper access controls and monitoring.", "Conclusions": "The vulnerability is critical and requires immediate attention, and implementing the recommended mitigation strategies will help minimize the risk of exploitation."}}