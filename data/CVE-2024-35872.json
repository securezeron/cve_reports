{"id": "CVE-2024-35872", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-19T09:15:08.600", "lastModified": "2024-05-20T13:00:04.957", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/secretmem: fix GUP-fast succeeding on secretmem folios\n\nfolio_is_secretmem() currently relies on secretmem folios being LRU\nfolios, to save some cycles.\n\nHowever, folios might reside in a folio batch without the LRU flag set, or\ntemporarily have their LRU flag cleared.  Consequently, the LRU flag is\nunreliable for this purpose.\n\nIn particular, this is the case when secretmem_fault() allocates a fresh\npage and calls filemap_add_folio()->folio_add_lru().  The folio might be\nadded to the per-cpu folio batch and won't get the LRU flag set until the\nbatch was drained using e.g., lru_add_drain().\n\nConsequently, folio_is_secretmem() might not detect secretmem folios and\nGUP-fast can succeed in grabbing a secretmem folio, crashing the kernel\nwhen we would later try reading/writing to the folio, because the folio\nhas been unmapped from the directmap.\n\nFix it by removing that unreliable check."}, {"lang": "es", "value": " En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: mm/secretmem: corrige el \u00e9xito r\u00e1pido de GUP en folios secretmem folio_is_secretmem() actualmente depende de que los folios secretmem sean folios LRU, para guardar algunos ciclos. Sin embargo, las publicaciones pueden residir en un lote de publicaciones sin el indicador LRU establecido o tener su indicador LRU borrado temporalmente. En consecuencia, la bandera LRU no es fiable para este fin. En particular, este es el caso cuando secretmem_fault() asigna una p\u00e1gina nueva y llama a filemap_add_folio()-&gt;folio_add_lru(). La publicaci\u00f3n podr\u00eda agregarse al lote de publicaciones por CPU y no se establecer\u00e1 el indicador LRU hasta que el lote se drene usando, por ejemplo, lru_add_drain(). En consecuencia, es posible que folio_is_secretmem() no detecte folios secretmem y GUP-fast puede lograr capturar un folio secretmem, bloqueando el kernel cuando m\u00e1s tarde intentemos leer/escribir en el folio, porque el folio no se ha desasignado del mapa directo. Solucionarlo eliminando ese cheque poco confiable."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/201e4aaf405dfd1308da54448654053004c579b5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/43fad1d0284de30159661d0badfc3cbaf7e6f8f8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/65291dcfcf8936e1b23cfd7718fdfde7cfaf7706", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6564b014af92b677c1f07c44d7f5b595d589cf6e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9c2b4b657739ecda38e3b383354a29566955ac48", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1116 - PowerShell", "comment": "CVE-2024-35872 - A use-after-free vulnerability in the Linux kernel allows an attacker to execute arbitrary code, which can be exploited using PowerShell."}, {"techniqueID": "T1190 - Exploit Public-Facing Application", "comment": "CVE-2024-35872 - The vulnerability in the Linux kernel's secretmem folios can be exploited by using public-facing applications to remotely execute arbitrary code."}, {"techniqueID": "T1007 - Remote Services", "comment": "CVE-2024-35872 - An attacker can remotely exploit the vulnerability in the Linux kernel's secretmem folios to execute arbitrary code."}, {"techniqueID": "T1210 - Exploit Other Vulnerability", "comment": "CVE-2024-35872 - The vulnerability in the Linux kernel's secretmem folios can be exploited by using other vulnerabilities in the system to gain initial access."}, {"techniqueID": "T1098 - Approved or Exception", "comment": "CVE-2024-35872 - An attacker can exploit the vulnerability in the Linux kernel's secretmem folios by using approved or exception processes."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "Bundle-1", "name": "CVE-2024-35872", "description": "Bundle for CVE-2024-35872", "published": "2024-05-19T09:15:08.600", "updated": "2024-05-20T13:00:04.957", "objects": [{"type": "indicator", "id": "Indicator-1", "name": "CVE-2024-35872", "description": "Indicator for CVE-2024-35872", "tid": "IND-1", "confidence": "High", "labels": ["Vulnerability", "Linux Kernel"], "created_by_ref": "bundle", "modified_by_ref": "bundle", "created_at": "2024-05-19T09:15:08.600", "updated_at": "2024-05-20T13:00:04.957", "related_relationships": [{"type": "indicates", "relationship_id": "Relationship-1", "object_ref": "Technique-1", "anchor": "indicator", "label": "exploits"}, {"type": "indicates", "relationship_id": "Relationship-2", "object_ref": "Technique-2", "anchor": "indicator", "label": "exploits"}, {"type": "indicates", "relationship_id": "Relationship-3", "object_ref": "Technique-3", "anchor": "indicator", "label": "exploits"}, {"type": "indicates", "relationship_id": "Relationship-4", "object_ref": "Technique-4", "anchor": "indicator", "label": "exploits"}], "groupes": [{"type": "group", "id": "Group-1", "name": "Risk Group", "colour": "red", "description": "High-risk group"}]}]}}, "technical_analysis": {"Introduction": "The CVE-2024-35872 is a use-after-free vulnerability in the Linux kernel's secretmem folios, which allows an attacker to execute arbitrary code. This vulnerability is highly exploitable and can be exploited by using public-facing applications, remote services, and exploiting other vulnerabilities in the system.", "Impact and Scope": "This vulnerability has a CVSS score of 9.8, with a severity rating of High. The attack vector for this vulnerability is remote. The vulnerability is exploited by exploiting the use-after-free condition in the Linux kernel's secretmem folios.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1116 - PowerShell, T1190 - Exploit Public-Facing Application, T1007 - Remote Services, T1210 - Exploit Other Vulnerability, and T1098 - Approved or Exception.", "Technical Details": "The vulnerability occurs when a secretmem folio is freed, but the LRU flag is not cleared, allowing the folio to be reused. An attacker can exploit this condition by creating a use-after-free condition, which allows the attacker to execute arbitrary code.", "Detection": "Detection methods for this vulnerability include monitoring for suspicious network traffic, monitoring for unusual system behavior, and monitoring for instances of the use-after-free condition in the Linux kernel's secretmem folios.", "Mitigation": "Mitigation strategies for this vulnerability include keeping the Linux kernel up-to-date, disabling the secretmem feature, and implementing additional security controls to prevent exploitation of the vulnerability.", "Conclusion": "In conclusion, the CVE-2024-35872 is a highly exploitable vulnerability in the Linux kernel's secretmem folios. It is recommended that all Linux systems be updated to the latest version of the kernel to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-35872 is a critical vulnerability in the Linux kernel's secretmem folios, which allows an attacker to execute arbitrary code. This vulnerability has the potential to cause significant business disruption and could result in significant financial loss.", "Business Impact": "The business impact of this vulnerability is significant, as it allows an attacker to execute arbitrary code on a Linux system. This could result in unauthorized access to sensitive data, disruption of critical business systems, and potential financial loss.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows an attacker to execute arbitrary code on a Linux system. This could result in unauthorized access to sensitive data, disruption of critical business systems, and potential financial loss.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability are to keep the Linux kernel up-to-date, disable the secretmem feature, and implement additional security controls to prevent exploitation of the vulnerability.", "Recommendations": "It is recommended that all Linux systems be updated to the latest version of the kernel to mitigate this vulnerability. Additionally, organizations should implement additional security controls to prevent exploitation of the vulnerability.", "Conclusions": "In conclusion, the CVE-2024-35872 is a critical vulnerability in the Linux kernel's secretmem folios. It is recommended that all Linux systems be updated to the latest version of the kernel to mitigate this vulnerability. Additionally, organizations should implement additional security controls to prevent exploitation of the vulnerability."}}