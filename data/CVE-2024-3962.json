{"id": "CVE-2024-3962", "sourceIdentifier": "security@wordfence.com", "published": "2024-04-26T09:15:12.337", "lastModified": "2024-04-26T12:58:17.720", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Product Addons & Fields for WooCommerce plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the ppom_upload_file function in all versions up to, and including, 32.0.18. This makes it possible for unauthenticated attackers to upload arbitrary files on the affected site's server which may make remote code execution possible. Successful exploitation requires the PPOM Pro plugin to be installed along with a WooCommerce product that contains a file upload field to retrieve the correct nonce."}, {"lang": "es", "value": "El complemento Product Addons &amp; Fields for WooCommerce para WordPress es vulnerable a cargas de archivos arbitrarias debido a la falta de validaci\u00f3n del tipo de archivo en la funci\u00f3n ppom_upload_file en todas las versiones hasta la 32.0.18 incluida. Esto hace posible que atacantes no autenticados carguen archivos arbitrarios en el servidor del sitio afectado, lo que puede hacer posible la ejecuci\u00f3n remota de c\u00f3digo. La explotaci\u00f3n exitosa requiere que se instale el complemento PPOM Pro junto con un producto WooCommerce que contenga un campo de carga de archivos para recuperar el nonce correcto."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "references": [{"url": "https://plugins.trac.wordpress.org/changeset/3075669/woocommerce-product-addon", "source": "security@wordfence.com"}, {"url": "https://themeisle.com/plugins/ppom-pro/", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/4f95bcc3-354e-4016-9a17-945569b076b6?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "TA0001", "comment": "This vulnerability is related to the TTP Technique TA0001 - Initial Access using Social Engineering. The attacker can upload a malicious file to the vulnerable website and use it to launch a further attack. Defending against this would involve using techniques such as educating users on how to recognize and avoid social engineering attacks."}, {"techniqueID": "TA0002", "comment": "This vulnerability is related to the TTP Technique TA0002 - Execution of Remote Code within a Specific Service. The attacker can upload a malicious file to the server and execute remote code. Defending against this would involve using techniques such as configuring the server to only allow trusted uploads and controlling the type of files that can be uploaded."}, {"techniqueID": "TA0002.006", "comment": "This vulnerability is related to the TTP Technique TA0002.006 - Scheduled Job Execution. The attacker can create a scheduled job to execute the remote code at a later time. Defending against this would involve using techniques such as limiting the permissions of the user account used by the script and monitoring the job queue."}, {"techniqueID": "TA0011", "comment": "This vulnerability is related to the TTP Technique TA0011 - Valid Accounts. The attacker can use the uploaded malicious file to steal the credentials of an authenticated user. Defending against this would involve using techniques such as auditing user activity and detecting unusual login patterns."}, {"techniqueID": "TA0027", "comment": "This vulnerability is related to the TTP Technique TA0027 - File and Directory Discovery. The attacker can use the uploaded malicious file to gather information about the server's file system. Defending against this would involve using techniques such as monitoring the file system for unusual changes and detecting anomalies in file access."}, {"techniqueID": "TA0028", "comment": "This vulnerability is related to the TTP Technique TA0028 - Relative Path Traversal. The attacker can use the uploaded malicious file to traverse the file system and access sensitive files. Defending against this would involve using techniques such as configuring the server to only allow absolute paths in file uploads and monitoring the file system for unusual changes."}], "technical_analysis": {"Introduction": "The Product Addons & Fields for WooCommerce plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the ppom_upload_file function in all versions up to, and including, 32.0.18.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8, with a base severity of CRITICAL. It allows unauthenticated attackers to upload arbitrary files on the affected site's server, which may make remote code execution possible.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including TA0001, TA0002, TA0002.006, TA0011, TA0027, and TA0028.", "Technical Details": "The vulnerability occurs due to missing file type validation in the ppom_upload_file function in the Product Addons & Fields for WooCommerce plugin.", "Detection": "Detection of this vulnerability involves monitoring the file system for unusual changes and detecting anomalies in file access.", "Mitigation": "Mitigation strategies for this vulnerability include configuring the server to only allow trusted uploads, controlling the type of files that can be uploaded, and monitoring the file system for unusual changes.", "Conclusion": "In conclusion, this vulnerability is a critical security risk that can allow attackers to upload and execute malicious code on the affected site's server."}, "executive_analysis": {"Overview": "The Product Addons & Fields for WooCommerce plugin for WordPress contains a critical vulnerability that allows unauthenticated attackers to upload and execute arbitrary code on the affected site's server.", "Business Impact": "The vulnerability has significant business impact, as it allows attackers to compromise sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability has significant technical impact, as it allows attackers to execute arbitrary code on the affected site's server and potentially gain access to sensitive data.", "Mitigation Strategies": "To mitigate this vulnerability, organizations should configure their servers to only allow trusted uploads, control the type of files that can be uploaded, and monitor the file system for unusual changes.", "Recommendations": "Organizations should prioritize patching and updating the affected plugin, as well as conducting thorough penetration testing and vulnerability assessments to identify and remediate other potential vulnerabilities.", "Conclusions": "In conclusion, this vulnerability is a critical security risk that requires immediate attention and remediation to prevent exploitation and potential data breaches."}}