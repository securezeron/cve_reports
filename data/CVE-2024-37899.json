{"id": "CVE-2024-37899", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-20T23:15:52.460", "lastModified": "2024-06-21T11:22:01.687", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. When an admin disables a user account, the user's profile is executed with the admin's rights. This allows a user to place malicious code in the user profile before getting an admin to disable the user account. To reproduce, as a user without script nor programming rights, edit the about section of your user profile and add `{{groovy}}services.logging.getLogger(\"attacker\").error(\"Hello from Groovy!\"){{/groovy}}`.\nAs an admin, go to the user profile and click the \"Disable this account\" button. Then, reload the page. If the logs show `attacker - Hello from Groovy!` then the instance is vulnerable. This has been patched in XWiki 14.10.21, 15.5.5, 15.10.6 and 16.0.0. Users are advised to upgrade. There are no known workarounds for this vulnerability.\n\n### Workarounds\nWe're not aware of any workaround except upgrading.\n\n### References\n* https://jira.xwiki.org/browse/XWIKI-21611\n* https://github.com/xwiki/xwiki-platform/commit/f89c8f47fad6e5cc7e68c69a7e0acde07f5eed5a\n"}, {"lang": "es", "value": "XWiki Platform es una plataforma wiki gen\u00e9rica que ofrece servicios de ejecuci\u00f3n para aplicaciones creadas sobre ella. Cuando un administrador desactiva una cuenta de usuario, el perfil del usuario se ejecuta con los derechos de administrador. Esto permite a un usuario colocar c\u00f3digo malicioso en el perfil de usuario antes de que un administrador desactive la cuenta de usuario. Para reproducir, como usuario sin script ni derechos de programaci\u00f3n, edite la secci\u00f3n Acerca de de su perfil de usuario y agregue `{{groovy}}services.logging.getLogger(\"attacker\").error(\"Hello from Groovy!\"){{ /maravilloso}}`. Como administrador, vaya al perfil de usuario y haga clic en el bot\u00f3n \"Desactivar esta cuenta\". Luego, recarga la p\u00e1gina. Si los registros muestran \"atacante - \u00a1Hola desde Groovy!\", entonces la instancia es vulnerable. Esto ha sido parcheado en XWiki 14.10.21, 15.5.5, 15.10.6 y 16.0.0. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad. ### Workarounds no conocemos ning\u00fan workarounds excepto la actualizaci\u00f3n. ### Referencias * https://jira.xwiki.org/browse/XWIKI-21611 * https://github.com/xwiki/xwiki-platform/commit/f89c8f47fad6e5cc7e68c69a7e0acde07f5eed5a"}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.3, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/f89c8f47fad6e5cc7e68c69a7e0acde07f5eed5a", "source": "security-advisories@github.com"}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-j584-j2vj-3f93", "source": "security-advisories@github.com"}, {"url": "https://jira.xwiki.org/browse/XWIKI-21611", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0001", "comment": "Account Discovery - CVE-2024-37899 - This technique is relevant as it involves exploiting a vulnerable account to gain access to a system. Defenders should monitor system logs for suspicious account login attempts and implement strong authentication controls."}, {"techniqueID": "TA0002", "comment": "Credential Dumping - CVE-2024-37899 - The vulnerability allows an attacker to execute code with elevated privileges, making it a prime target for credential dumping. Defenders should implement robust access controls and limit sensitive data access to only trusted users."}, {"techniqueID": "TA0021", "comment": "Execution - CVE-2024-37899 - The vulnerability allows an attacker to execute code with elevated privileges, making it a prime target for code execution. Defenders should monitor system logs for suspicious process creation and implement secure coding practices."}, {"techniqueID": "TA0035", "comment": "Data Encoding - CVE-2024-37899 - The vulnerability allows an attacker to inject malicious code, making it a prime target for data encoding. Defenders should implement robust input validation and sanitization mechanisms."}, {"techniqueID": "T1033", "comment": "Invalid Packages - CVE-2024-37899 - The vulnerability allows an attacker to execute malicious code, making it a prime target for invalid package exploitation. Defenders should monitor system logs for suspicious package installation and implement secure package management practices."}], "technical_analysis": {"Introduction": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. When an admin disables a user account, the user's profile is executed with the admin's rights, allowing an attacker to place malicious code in the user profile before getting an admin to disable the user account.", "Impact and Scope": "The impact of this vulnerability is HIGH CVSS 3.1 Severity: CRITICAL with a base score of 9.0. The scope of the vulnerability is NETWORK.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK Techniques for this vulnerability are TA0001, TA0002, TA0021, TA0035, and T1033.", "Technical Details": "The vulnerability is caused by the execution of a malicious user profile with elevated privileges, allowing an attacker to inject malicious code and execute it with elevated privileges.", "Detection": "Methods for detecting this vulnerability include monitoring system logs for suspicious user account login attempts, monitoring system logs for suspicious process creation, and implementing robust input validation and sanitization mechanisms.", "Mitigation": "Mitigation strategies for this vulnerability include upgrading to a patched version of XWiki, implementing robust access controls and limiting sensitive data access to only trusted users, and monitoring system logs for suspicious activity.", "Conclusion": "In conclusion, the CVE-2024-37899 vulnerability is a critical vulnerability in the XWiki Platform allowing an attacker to inject malicious code and execute it with elevated privileges. Defenders should take immediate action to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-37899 vulnerability is a critical vulnerability in the XWiki Platform allowing an attacker to inject malicious code and execute it with elevated privileges.", "Business Impact": "The business impact of this vulnerability is HIGH as it allows an attacker to inject malicious code and execute it with elevated privileges, potentially leading to data breaches and loss of system integrity.", "Technical Impact": "The technical impact of this vulnerability is HIGH as it allows an attacker to execute malicious code with elevated privileges, potentially leading to complete system compromise.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include upgrading to a patched version of XWiki, implementing robust access controls, and monitoring system logs for suspicious activity.", "Recommendations": "Recommendations for executives include implementing robust vulnerability management procedures, conducting regular security audits, and providing regular security training to employees.", "Conclusions": "In conclusion, the CVE-2024-37899 vulnerability is a critical vulnerability that requires immediate attention and action to mitigate. Defenders should take a proactive approach to identify and patch vulnerable systems."}}