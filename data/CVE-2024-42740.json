{"id": "CVE-2024-42740", "sourceIdentifier": "cve@mitre.org", "published": "2024-08-13T14:15:14.203", "lastModified": "2024-08-13T17:11:53.553", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In TOTOLINK X5000r v9.1.0cu.2350_b20230313, the file /cgi-bin/cstecgi.cgi contains an OS command injection vulnerability in setLedCfg. Authenticated Attackers can send malicious packet to execute arbitrary commands."}, {"lang": "es", "value": "En TOTOLINK X5000r v9.1.0cu.2350_b20230313, el archivo /cgi-bin/cstecgi.cgi contiene una vulnerabilidad de inyecci\u00f3n de comandos del sistema operativo en setLedCfg. Los atacantes autenticados pueden enviar paquetes maliciosos para ejecutar comandos arbitrarios."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-78"}]}], "references": [{"url": "https://github.com/HouseFuzz/reports/blob/main/totolink/x5000r/setLedCfg/setLedCfg.md", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-42740 - This is a classic command injection attack, attackers can execute arbitrary commands and take control of the system. Defend against this by restricting input, validating user input, and using secure coding practices."}, {"techniqueID": "T1190", "comment": "CVE-2024-42740 - This technique is also related to command injection, as attackers can also inject shellcode. Defend against this by implementing memory protection controls and validating user input."}, {"techniqueID": "T1068", "comment": "CVE-2024-42740 - This technique is related to command and control, as attackers can use this vulnerability to establish a command and control channel. Defend against this by detecting and blocking suspicious traffic."}], "stix_bundle": {"bundle": {"id": "CVE-2024-42740", "type": "bundle", "created_by_ref": "identity--634f09a0-5cda-4635-94c4-415b8a6d32f4", "created": "2024-08-13T14:15:14.203Z", "updated": "2024-08-13T17:11:53.553Z", "name": "CVE-2024-42740 bundle", "description": "Bundle containing the details of the CVE-2024-42740 vulnerability", "objects": [{"id": "CVE-2024-42740", "type": "vulnerability", "created_by_ref": "identity--634f09a0-5cda-4635-94c4-415b8a6d32f4", "created": "2024-08-13T14:15:14.203Z", "updated": "2024-08-13T17:11:53.553Z", "name": "CVE-2024-42740", "description": "TOTOLINK X5000r v9.1.0cu.2350_b20230313 file /cgi-bin/cstecgi.cgi OS command injection vulnerability", "weaknesses": [{"type": "weakness", "id": "cbaef9a2-94a5-4256-8151-3c35a7ff6ed1", "name": "CWE-78", "description": {"lang": "en", "value": "CWE-78 - Code Injection"}}], "references": [{"url": "https://github.com/HouseFuzz/reports/blob/main/totolink/x5000r/setLedCfg/setLedCfg.md", "source": "cve@mitre.org"}]}, {"id": "T1210", "type": "attack-pattern", "created_by_ref": "identity--634f09a0-5cda-4635-94c4-415b8a6d32f4", "created": "2024-08-13T14:15:14.203Z", "updated": "2024-08-13T17:11:53.553Z", "name": "Command Injection", "description": {"lang": "en", "value": "Command Injection"}, "kill_chain_phases": [{"kill_chain_name": "Attack Matrix", "kill_chain_phase_name": "Reconnaissance"}]}, {"id": "T1190", "type": "attack-pattern", "created_by_ref": "identity--634f09a0-5cda-4635-94c4-415b8a6d32f4", "created": "2024-08-13T14:15:14.203Z", "updated": "2024-08-13T17:11:53.553Z", "name": "Shellcode Injection", "description": {"lang": "en", "value": "Shellcode Injection"}, "kill_chain_phases": [{"kill_chain_name": "Attack Matrix", "kill_chain_phase_name": "Reconnaissance"}]}, {"id": "T1068", "type": "attack-pattern", "created_by_ref": "identity--634f09a0-5cda-4635-94c4-415b8a6d32f4", "created": "2024-08-13T14:15:14.203Z", "updated": "2024-08-13T17:11:53.553Z", "name": "Command and Control Server", "description": {"lang": "en", "value": "Command and Control Server"}, "kill_chain_phases": [{"kill_chain_name": "Attack Matrix", "kill_chain_phase_name": "Command and Control"}]}], "relationships": [{"id": "r1", "type": "has-participant", "source_ref": "CVE-2024-42740", "target_ref": "T1210", "relationship_type": "related_to"}, {"id": "r2", "type": "has-participant", "source_ref": "CVE-2024-42740", "target_ref": "T1190", "relationship_type": "related_to"}, {"id": "r3", "type": "has-participant", "source_ref": "CVE-2024-42740", "target_ref": "T1068", "relationship_type": "related_to"}]}}, "technical_analysis": {"Introduction": "TOTOLINK X5000r v9.1.0cu.2350_b20230313 has been found to have a file /cgi-bin/cstecgi.cgi OS command injection vulnerability. This vulnerability allows authenticated attackers to send malicious packets to execute arbitrary commands.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 6.8. The vulnerability allows attackers to execute arbitrary commands, which can result in the compromise of sensitive data or the taking of control of the system.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1210, T1190, and T1068.", "Technical Details": "The vulnerability is caused by the lack of input validation in the setLedCfg function in the file /cgi-bin/cstecgi.cgi. Attackers can send malicious packets to the function to execute arbitrary commands.", "Detection": " Detection of this vulnerability can be done by monitoring for suspicious traffic, such as packets sent to the setLedCfg function.", "Mitigation": "Mitigation of this vulnerability can be done by restricting input, validating user input, and using secure coding practices.", "Conclusion": "In conclusion, the TOTOLINK X5000r v9.1.0cu.2350_b20230313 has been found to have a file /cgi-bin/cstecgi.cgi OS command injection vulnerability. This vulnerability allows authenticated attackers to send malicious packets to execute arbitrary commands."}, "executive_analysis": {"Overview": "The TOTOLINK X5000r v9.1.0cu.2350_b20230313 has been found to have a file /cgi-bin/cstecgi.cgi OS command injection vulnerability.", "Business Impact": "The business impact of this vulnerability is high, as it allows attackers to compromise sensitive data or take control of the system.", "Technical Impact": "The technical impact of this vulnerability is the compromise of sensitive data or the taking of control of the system.", "Mitigation Strategies": "Mitigation strategies include restricting input, validating user input, and using secure coding practices.", "Recommendations": "Recommendations include patching the vulnerability, implementing input validation, and using secure coding practices.", "Conclusions": "In conclusion, the TOTOLINK X5000r v9.1.0cu.2350_b20230313 has been found to have a file /cgi-bin/cstecgi.cgi OS command injection vulnerability. It is recommended that patching, input validation, and secure coding practices be implemented to mitigate the vulnerability."}}