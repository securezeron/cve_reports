{"id": "CVE-2024-1560", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-16T00:15:08.713", "lastModified": "2024-04-16T13:24:07.103", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A path traversal vulnerability exists in the mlflow/mlflow repository, specifically within the artifact deletion functionality. Attackers can bypass path validation by exploiting the double decoding process in the `_delete_artifact_mlflow_artifacts` handler and `local_file_uri_to_path` function, allowing for the deletion of arbitrary directories on the server's filesystem. This vulnerability is due to an extra unquote operation in the `delete_artifacts` function of `local_artifact_repo.py`, which fails to properly sanitize user-supplied paths. The issue is present up to version 2.9.2, despite attempts to fix a similar issue in CVE-2023-6831."}, {"lang": "es", "value": "Existe una vulnerabilidad de path traversal en el repositorio mlflow/mlflow, espec\u00edficamente dentro de la funcionalidad de eliminaci\u00f3n de artefactos. Los atacantes pueden eludir la validaci\u00f3n de rutas explotando el proceso de doble decodificaci\u00f3n en el controlador `_delete_artifact_mlflow_artifacts` y la funci\u00f3n `local_file_uri_to_path`, lo que permite la eliminaci\u00f3n de directorios arbitrarios en el sistema de archivos del servidor. Esta vulnerabilidad se debe a una operaci\u00f3n adicional entre comillas en la funci\u00f3n `delete_artifacts` de `local_artifact_repo.py`, que no sanitiza adecuadamente las rutas proporcionadas por el usuario. El problema est\u00e1 presente hasta la versi\u00f3n 2.9.2, a pesar de los intentos de solucionar un problema similar en CVE-2023-6831."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-22"}]}], "references": [{"url": "https://huntr.com/bounties/4a34259c-3c8f-4872-b178-f27fbc876b98", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1002", "comment": "CVE-2024-1560 - Path traversal vulnerability which can be used to delete arbitrary directories, affecting mlflow/mlflow up to version 2.9.2. To defend against this, implement proper input validation and sanitization of user-supplied paths."}, {"techniqueID": "T1190", "comment": "CVE-2024-1560 - Use of the deleted artifacts feature to delete arbitrary directories, demonstrating a lack of proper path validation. To mitigate this, restrict access to critical system directories and monitor system calls for unusual activity."}, {"techniqueID": "T1193", "comment": "CVE-2024-1560 - Exploitation of path traversal vulnerability by exploiting the double decoding process in the `_delete_artifact_mlflow_artifacts` handler and `local_file_uri_to_path` function. To detect this, monitor system calls for unusual activity related to file system operations."}], "stix_bundle": {"$schema": "https://stix2.io/schema/2.1/stix-core-definition/stix-bundle.json", "type": "bundle", "id": "bundle--fc55d3ad-15f8-42f1-a9c1-1f5c5c56ebd0", "created_by_ref": "identity--0aae7a31-3b5b-4a91-9f14-5b9a1d9a8b0a", "objects": [{"type": "vulnerability", "id": "vulnerability--3a37f9a8-d5d6-443e-83ad-1e9ba78b9a6a", "name": "CVE-2024-1560", "description": "A path traversal vulnerability exists in the mlflow/mlflow repository, specifically within the artifact deletion functionality.", "published": "2024-04-16T00:15:08.713", "last_modified": "2024-04-16T13:24:07.103", "cvssv3": {"vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H", "baseScore": 8.1}}, {"type": "course-of-action", "id": "course-of-action--18f7a40b-92c5-4d1c-b5e9-5116f0c2a5cd", "name": "Implement proper input validation and sanitization of user-supplied paths", "description": "To defend against CVE-2024-1560, implement proper input validation and sanitization of user-supplied paths.", "related_techniques": ["T1002"]}, {"type": "course-of-action", "id": "course-of-action--45ec9ac4-b115-4c10-b6e0-3cc7cbb58644", "name": "Restrict access to critical system directories", "description": "To mitigate CVE-2024-1560, restrict access to critical system directories.", "related_techniques": ["T1190"]}, {"type": ".course-of-action", "id": "course-of-action--c99d2e34-9f8d-4e7f-bc4f-de2c26eeeff4", "name": "Monitor system calls for unusual activity", "description": "To detect CVE-2024-1560, monitor system calls for unusual activity related to file system operations.", "related_techniques": ["T1193"]}], "relationships": [{"from": "vulnerability--3a37f9a8-d5d6-443e-83ad-1e9ba78b9a6a", "to": "course-of-action--18f7a40b-92c5-4d1c-b5e9-5116f0c2a5cd", "type": "mitigated-by"}, {"from": "vulnerability--3a37f9a8-d5d6-443e-83ad-1e9ba78b9a6a", "to": "course-of-action--45ec9ac4-b115-4c10-b6e0-3cc7cbb58644", "type": "mitigated-by"}, {"from": "vulnerability--3a37f9a8-d5d6-443e-83ad-1e9ba78b9a6a", "to": "course-of-action--c99d2e34-9f8d-4e7f-bc4f-de2c26eeeff4", "type": "detected-by"}]}, "technical_analysis": {"Introduction": "CVE-2024-1560 is a path traversal vulnerability affecting mlflow/mlflow up to version 2.9.2.", "Impact and Scope": "CVE-2024-1560 has a CVSS score of 8.1 with a high attack vector, allowing attackers to delete arbitrary directories on the server's filesystem.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1002 (Path Mismatch), T1190 (URL Modification), and T1193 (File System Modification).", "Technical Details": "The vulnerability occurs due to an extra unquote operation in the `delete_artifacts` function of `local_artifact_repo.py`, which fails to properly sanitize user-supplied paths.", "Detection": "The vulnerability can be detected by monitoring system calls for unusual activity related to file system operations.", "Mitigation": "To mitigate CVE-2024-1560, implement proper input validation and sanitization of user-supplied paths, restrict access to critical system directories, and monitor system calls for unusual activity.", "Conclusion": "CVE-2024-1560 highlights the importance of proper path validation and sanitization in software development."}, "executive_analysis": {"Overview": "CVE-2024-1560 is a critical vulnerability affecting the mlflow/mlflow repository.", "Business Impact": "The vulnerability can be used to delete arbitrary directories on the server's filesystem, potentially leading to data loss and system downtime.", "Technical Impact": "The vulnerability has a high attack vector and can be exploited by attackers to gain unauthorized access to the system.", "Mitigation Strategies": "Implement proper input validation and sanitization of user-supplied paths, restrict access to critical system directories, and monitor system calls for unusual activity.", "Recommendations": "Executives should ensure that software development teams follow secure coding practices and implement proper validation and sanitization of user-supplied inputs.", "Conclusions": "CVE-2024-1560 emphasizes the importance of secure coding practices and highlights the need for proactive measures to prevent vulnerabilities."}}