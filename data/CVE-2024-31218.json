{"id": "CVE-2024-31218", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-05T15:15:07.863", "lastModified": "2024-04-08T18:49:25.863", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Webhood is a self-hosted URL scanner used analyzing phishing and malicious sites. Webhood's backend container images in versions 0.9.0 and earlier are subject to Missing Authentication for Critical Function vulnerability. This vulnerability allows an unauthenticated attacker to send a HTTP request to the database (Pocketbase) admin API to create an admin account. The Pocketbase admin API does not check for authentication/authorization when creating an admin account when no admin accounts have been added. In its default deployment, Webhood does not create a database admin account. Therefore, unless users have manually created an admin account in the database, an admin account will not exist in the deployment and the deployment is vulnerable. Versions starting from 0.9.1 are patched. The patch creates a randomly generated admin account if admin accounts have not already been created i.e. the vulnerability is exploitable in the deployment. As a workaround, users can disable access to URL path starting with `/api/admins` entirely. With this workaround, the vulnerability is not exploitable via network."}, {"lang": "es", "value": "Webhood es un esc\u00e1ner de URL autohospedado que se utiliza para analizar sitios maliciosos y de phishing. Las im\u00e1genes del contenedor backend de Webhood en las versiones 0.9.0 y anteriores est\u00e1n sujetas a una vulnerabilidad de autenticaci\u00f3n faltante para funciones cr\u00edticas. Esta vulnerabilidad permite que un atacante no autenticado env\u00ede una solicitud HTTP a la API de administraci\u00f3n de la base de datos (Pocketbase) para crear una cuenta de administrador. La API de administraci\u00f3n de Pocketbase no verifica la autenticaci\u00f3n/autorizaci\u00f3n al crear una cuenta de administrador cuando no se han agregado cuentas de administrador. En su implementaci\u00f3n predeterminada, Webhood no crea una cuenta de administrador de base de datos. Por lo tanto, a menos que los usuarios hayan creado manualmente una cuenta de administrador en la base de datos, no existir\u00e1 una cuenta de administrador en la implementaci\u00f3n y la implementaci\u00f3n es vulnerable. Las versiones a partir de 0.9.1 est\u00e1n parcheadas. El parche crea una cuenta de administrador generada aleatoriamente si a\u00fan no se han creado cuentas de administrador, es decir, la vulnerabilidad se puede explotar en la implementaci\u00f3n. Como workaround, los usuarios pueden deshabilitar completamente el acceso a la ruta URL que comienza con `/api/admins`. Con esta workaround, la vulnerabilidad no se puede explotar a trav\u00e9s de la red."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-306"}]}], "references": [{"url": "https://github.com/webhood-io/webhood/commit/735e7fa2814edeec9a2c07778ed51b3c018609f9", "source": "security-advisories@github.com"}, {"url": "https://github.com/webhood-io/webhood/security/advisories/GHSA-h533-rxhm-73j2", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1059.001", "comment": "CVE-2024-31218 - Unauthenticated Remote Command Execution via Missing Authentication for Critical Function in Webhood. This is relevant as it allows an attacker to create an admin account without authentication, providing an entry point for further exploitation."}, {"techniqueID": "T1027.001", "comment": "CVE-2024-31218 - Execution through the creation of an admin account without authentication. This is relevant as it allows an attacker to execute code without authentication."}, {"techniqueID": "T1078", "comment": "CVE-2024-31218 - Exploitation of a Missing Authentication for Critical Function in Webhood. This is relevant as it allows an attacker to create an admin account without authentication."}], "stix_bundle": {"stix_header": {"type": "bundle", "id": "urn:stix:bundle:cve-2024-31218", "created_by_ref": "https://stix.io"}, "objects": [{"type": "indicator", "id": "indicator--CVE-2024-31218", "created_by_ref": "https://stix.io", "modified": "2024-04-08T18:49:25.863", "name": "CVE-2024-31218 - Unauthenticated Remote Command Execution", "description": "Unauthenticated remote command execution vulnerability in Webhood through the creation of an admin account without authentication.", "first_seen": "2024-04-05T15:15:07.863", "last_seen": "2024-04-08T18:49:25.863", " kill_chain_phases": [{"kill_chain_name": " Mitre ATT&CK", "phase_name": "Execution"}]}, {"type": "analysis", "id": "analysis--CVE-2024-31218", "created_by_ref": "https://stix.io", "modified": "2024-04-08T18:49:25.863", "name": "Analysis of CVE-2024-31218", "description": "This analysis is related to the CVE-2024-31218 vulnerability in Webhood.", "results": [{"finding": [{"id": "finding--T1059.001", "type": "finding", "name": "Unauthenticated Remote Command Execution", "description": "Unauthenticated remote command execution vulnerability in Webhood through the creation of an admin account without authentication."}]}]}, {"type": "course_of_action", "id": "course_of_action--CVE-2024-31218", "created_by_ref": "https://stix.io", "modified": "2024-04-08T18:49:25.863", "name": "Mitigation of CVE-2024-31218", "description": "Mitigation strategies for CVE-2024-31218", "analysis_refs": [{"id": "analysis--CVE-2024-31218"}], "mitigated_threat_ids": [{"id": "indicator--CVE-2024-31218"}], "mitigation_approach": "Patch Webhood to version 0.9.1 or later."}]}, "technical_analysis": {"Introduction": "The CVE-2024-31218 vulnerability is a Missing Authentication for Critical Function vulnerability in Webhood versions 0.9.0 and earlier.", "Impact and Scope": "This vulnerability allows an unauthenticated attacker to send a HTTP request to the database (Pocketbase) admin API to create an admin account. The CVSS score is 9.8 with a version of 3.1 and an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "T1059.001, T1027.001, T1078.", "Technical Details": "The vulnerability is in the Packetbase admin API, which does not check for authentication/authorization when creating an admin account when no admin accounts have been added.", "Detection": "Detecting this vulnerability requires monitoring for unauthorized admin account creations.", "Mitigation": "Patch Webhood to version 0.9.1 or later or disable access to the URL path starting with `/api/admins` entirely.", "Conclusion": "This vulnerability provides an entry point for further exploitation and should be mitigated as soon as possible."}, "executive_analysis": {"Overview": "The CVE-2024-31218 vulnerability is a critical vulnerability in Webhood that allows an unauthenticated attacker to create an admin account.", "Business Impact": "This vulnerability could allow an attacker to gain access to sensitive information and compromise the confidentiality, integrity, and availability of the system.", "Technical Impact": "This vulnerability could allow an attacker to execute code without authentication.", "Mitigation Strategies": "Patch Webhood to version 0.9.1 or later or disable access to the URL path starting with `/api/admins` entirely.", "Recommendations": "Recommend patching Webhood to version 0.9.1 or later or disabling access to the URL path starting with `/api/admins` entirely.", "Conclusions": "This vulnerability should be mitigated as soon as possible to prevent unauthorized access to the system."}}