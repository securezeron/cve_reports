{"id": "CVE-2024-38612", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-19T14:15:21.060", "lastModified": "2024-07-15T07:15:12.673", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nipv6: sr: fix invalid unregister error path\n\nThe error path of seg6_init() is wrong in case CONFIG_IPV6_SEG6_LWTUNNEL\nis not defined. In that case if seg6_hmac_init() fails, the\ngenl_unregister_family() isn't called.\n\nThis issue exist since commit 46738b1317e1 (\"ipv6: sr: add option to control\nlwtunnel support\"), and commit 5559cea2d5aa (\"ipv6: sr: fix possible\nuse-after-free and null-ptr-deref\") replaced unregister_pernet_subsys()\nwith genl_unregister_family() in this error path."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: ipv6: sr: corrige la ruta de error de cancelaci\u00f3n de registro no v\u00e1lida La ruta de error de seg6_init() es incorrecta en caso de que CONFIG_IPV6_SEG6_LWTUNNEL no est\u00e9 definido. En ese caso, si seg6_hmac_init() falla, no se llama a genl_unregister_family(). Este problema existe desde que el commit 46738b1317e1 (\"ipv6: sr: agregar opci\u00f3n para controlar la compatibilidad con lwtunnel\") y el commit 5559cea2d5aa (\"ipv6: sr: corregir posible use-after-free y null-ptr-deref\") reemplaz\u00f3 unregister_pernet_subsys() con genl_unregister_family() en esta ruta de error."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-416"}, {"lang": "en", "value": "CWE-476"}]}], "references": [{"url": "https://git.kernel.org/stable/c/00e6335329f23ac6cf3105931691674e28bc598c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/10610575a3ac2a702bf5c57aa931beaf847949c7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/160e9d2752181fcf18c662e74022d77d3164cd45", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/1a63730fb315bb1bab97edd69ff58ad45e04bb01", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/3398a40dccb88d3a7eef378247a023a78472db66", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/646cd236c55e2cb5f146fc41bbe4034c4af5b2a4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/85a70ff1e572160f1eeb096ed48d09a1c9d4d89a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c04d6a914e890ccea4a9d11233009a2ee7978bf4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e77a3ec7ada84543e75722a1283785a6544de925", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-38612 - Unquoted Service Path - This technique is potentially relevant because the vulnerability is related to an invalid unregister error path, which can lead to a use-after-free scenario. Defending against this technique involves ensuring that all script and configuration files are properly quoted and that system components are updated to the latest versions."}, {"techniqueID": "T1055", "comment": "CVE-2024-38612 - Remote File Copy - This technique is potentially relevant because the vulnerability is related to an invalid unregister error path, which can lead to a use-after-free scenario. Defending against this technique involves ensuring that all script and configuration files are properly quoted and that system components are updated to the latest versions."}, {"techniqueID": "T1190", "comment": "CVE-2024-38612 - Exploit Public-Facing Application - This technique is potentially relevant because the vulnerability is related to an invalid unregister error path, which can lead to a use-after-free scenario. Defending against this technique involves ensuring that all script and configuration files are properly quoted and that system components are updated to the latest versions."}], "stix_bundle": "Replace Me", "technical_analysis": {"Introduction": "The CVE-2024-38612 vulnerability in the Linux kernel affects the IPv6 networking stack and can cause a use-after-free scenario when the seg6_init() function is called.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and an attack vector of NETWORK. It has the potential to cause HIGH impact to confidentiality, integrity, and availability.", "Related MITRE ATT&CK Techniques": "T1210, T1055, T1190", "Technical Details": "The vulnerability occurs when the seg6_init() function is called with an invalid argument, causing the kernel to attempt to free memory that has already been freed.", "Detection": "Detection may involve monitoring for unusual network traffic patterns or signs of exploitation.", "Mitigation": "Mitigating the vulnerability involves updating the kernel to a patched version or disabling IPv6 support.", "Conclusion": "The CVE-2024-38612 vulnerability is a critical vulnerability that requires prompt attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2024-38612 vulnerability in the Linux kernel presents a significant risk to confidentiality, integrity, and availability.", "Business Impact": "The vulnerability has the potential to cause significant business disruption and financial loss.", "Technical Impact": "The vulnerability has a high technical impact, with the potential to compromise system security and stability.", "Mitigation Strategies": "Updating the kernel to a patched version or disabling IPv6 support", "Recommendations": "Performing a risk assessment to determine the potential impact of the vulnerability on the organization.", "Conclusions": "The vulnerability requires prompt attention and mitigation to reduce the risk of exploitation."}}