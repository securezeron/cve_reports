{"id": "CVE-2024-27103", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-28T18:15:45.940", "lastModified": "2024-02-29T13:49:47.277", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Querybook is a Big Data Querying UI. When a user searches for their queries, datadocs, tables and lists, the search result is marked and highlighted, and this feature uses dangerouslySetInnerHTML which means that if the highlighted result has an XSS payload it will trigger. While the input to dangerouslySetInnerHTML is not sanitized for the data inside of queries which leads to an XSS vulnerability. During the \"query auto-suggestion\" the name of the suggested tables are set with innerHTML which leads to the XSS vulnerability. A patch to rectify this issue has been introduced in Querybook version 3.31.2."}, {"lang": "es", "value": "Querybook es una interfaz de usuario de consulta de Big Data. Cuando un usuario busca sus consultas, documentos de datos, tablas y listas, el resultado de la b\u00fasqueda se marca y resalta, y esta funci\u00f3n utiliza peligrosamente SetInnerHTML, lo que significa que si el resultado resaltado tiene una carga \u00fatil XSS, se activar\u00e1. Mientras que la entrada a peligrosamenteSetInnerHTML no est\u00e1 desinfectada para los datos dentro de las consultas, lo que conduce a una vulnerabilidad XSS. Durante la \"sugerencia autom\u00e1tica de consultas\", el nombre de las tablas sugeridas se configura con internalHTML, lo que conduce a la vulnerabilidad XSS. Se introdujo un parche para rectificar este problema en la versi\u00f3n 3.31.2 de Querybook."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "references": [{"url": "https://github.com/pinterest/querybook/commit/449bdc9e7d679e042c3718b7ed07d2ffa3c46a8f", "source": "security-advisories@github.com"}, {"url": "https://github.com/pinterest/querybook/security/advisories/GHSA-3hjm-9277-5c88", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-27103 - This vulnerability can be exploited using a cross-site scripting (XSS) attack, where an attacker can inject malicious scripts into a user's web browser. This can be prevented by validating and sanitizing user input, and using Content Security Policy (CSP) to define which sources of content are allowed to be executed."}, {"techniqueID": "T1035", "comment": "CVE-2024-27103 - The vulnerable component in Querybook uses internally-generated HTML to set innerHTML, which can be exploited by an attacker to inject malicious code. To defend against this, implement input validation and sanitization, and limit the ability to set innerHTML."}, {"techniqueID": "T1018", "comment": "CVE-2024-27103 - An attacker can exploit this vulnerability by injecting malicious scripts into a user's web browser, potentially leading to the theft of sensitive information. To mitigate this risk, ensure that all user input is sanitized and validated, and implement a Content Security Policy (CSP) to define which sources of content are allowed to be executed."}, {"techniqueID": "T1204", "comment": "CVE-2024-27103 - Cross-site scripting (XSS) attacks can be used to inject malicious scripts into a user's web browser, potentially leading to the theft of sensitive information. To defend against this, ensure that all user input is sanitized and validated, and implement a Content Security Policy (CSP) to define which sources of content are allowed to be executed."}], "stix_bundle": {"type": "bundle", "id": "bundle--3c7bf7ba-91d5-44f0-96f8-7d345f6b7edd", "created_by_ref": "identity--5c2e5993-f96c-4c2f-aeee-10d28c70f8f1", "modified": "2024-02-28T18:15:45.940Z", "created": "2024-02-28T18:15:45.940Z", "objects": [{"type": "vulnerability", "id": "vulnerability--ebedd35d-3456-4a6f-ab8c-59a5c48c8eef", "created_by_ref": "identity--5c2e5993-f96c-4c2f-aeee-10d28c70f8f1", "modified": "2024-02-28T18:15:45.940Z", "created": "2024-02-28T18:15:45.940Z", "name": "Querybook Cross-Site Scripting Vulnerability", "description": "Querybook is vulnerable to a cross-site scripting (XSS) attack when setting innerHTML without proper sanitization.", "exploit_maturity": "known", "exploit_range": "Remote", "affected_systems": [{"type": "system", "id": "system--ebedd35d-3456-4a6f-ab8c-59a5c48c8eef", "name": "Querybook", "description": "Querybook is a Big Data Querying UI."}], "weaknesses": [{"type": "weakness", "id": "weakness--ebedd35d-3456-4a6f-ab8c-59a5c48c8eef", "created_by_ref": "identity--5c2e5993-f96c-4c2f-aeee-10d28c70f8f1", "modified": "2024-02-28T18:15:45.940Z", "created": "2024-02-28T18:15:45.940Z", "name": "CWE-79", "description": "Cross-Site Scripting"}], "threat_agents": [{"type": "threat_agent", "id": "threat_agent--ebedd35d-3456-4a6f-ab8c-59a5c48c8eef", "created_by_ref": "identity--5c2e5993-f96c-4c2f-aeee-10d28c70f8f1", "modified": "2024-02-28T18:15:45.940Z", "created": "2024-02-28T18:15:45.940Z", "name": "Attackers", "description": "Attackers can exploit this vulnerability to inject malicious scripts into a user's web browser, potentially leading to the theft of sensitive information."}]}, {"type": "attack_pattern", "id": "attack_pattern--f2b5a14d-dc68-4028-8f53-f5e49b6b6ff1", "created_by_ref": "identity--5c2e5993-f96c-4c2f-aeee-10d28c70f8f1", "modified": "2024-02-28T18:15:45.940Z", "created": "2024-02-28T18:15:45.940Z", "name": "Cross-Site Scripting Attack", "description": "An attacker injects malicious scripts into a user's web browser to steal sensitive information."}, {"type": "course_of_action", "id": "course_of_action--d3e25f19-135c-4356-8d13-e6bd43a86b59", "created_by_ref": "identity--5c2e5993-f96c-4c2f-aeee-10d28c70f8f1", "modified": "2024-02-28T18:15:45.940Z", "created": "2024-02-28T18:15:45.940Z", "name": "Validate and Sanitize User Input", "description": "Validate and sanitize user input to prevent XSS attacks."}, {"type": "course_of_action", "id": "course_of_action--e55eb8f8-d9a1-49a2-a63c-4b5e4d92db2c", "created_by_ref": "identity--5c2e5993-f96c-4c2f-aeee-10d28c70f8f1", "modified": "2024-02-28T18:15:45.940Z", "created": "2024-02-28T18:15:45.940Z", "name": "Implement Content Security Policy (CSP)", "description": "Implement a Content Security Policy (CSP) to define which sources of content are allowed to be executed."}], "relationships": [{"relationship_type": "is_based_on", "source_ref": "vulnerability--ebedd35d-3456-4a6f-ab8c-59a5c48c8eef", "target_ref": "attack_pattern--f2b5a14d-dc68-4028-8f53-f5e49b6b6ff1"}, {"relationship_type": "is_implemented_by", "source_ref": "vulnerability--ebedd35d-3456-4a6f-ab8c-59a5c48c8eef", "target_ref": "course_of_action--d3e25f19-135c-4356-8d13-e6bd43a86b59"}, {"relationship_type": "is_implemented_by", "source_ref": "vulnerability--ebedd35d-3456-4a6f-ab8c-59a5c48c8eef", "target_ref": "course_of_action--e55eb8f8-d9a1-49a2-a63c-4b5e4d92db2c"}]}, "technical_analysis": {"Introduction": "Querybook is vulnerable to a cross-site scripting (XSS) attack when setting innerHTML without proper sanitization. This vulnerability can be exploited by an attacker to inject malicious scripts into a user's web browser, potentially leading to the theft of sensitive information.", "Impact and Scope": "The impact of this vulnerability is high, as it can lead to the theft of sensitive information. The scope is remote, as it can be exploited by an attacker from anywhere.", "Related MITRE ATT&CK Techniques": "T1190, T1035, T1018, T1204", "Technical Details": "The vulnerable component in Querybook uses internally-generated HTML to set innerHTML, which can be exploited by an attacker to inject malicious code.", "Detection": "Detection of this vulnerability can be done by monitoring for malicious scripts being injected into the web browser.", "Mitigation": "Mitigation strategies include validating and sanitizing user input, implementing Content Security Policy (CSP), and limiting the ability to set innerHTML.", "Conclusion": "In conclusion, Querybook is vulnerable to a cross-site scripting (XSS) attack, which can lead to the theft of sensitive information. To mitigate this risk, it is recommended to validate and sanitize user input, implement Content Security Policy (CSP), and limit the ability to set innerHTML."}, "executive_analysis": {"Overview": "Querybook is vulnerable to a cross-site scripting (XSS) attack, which can lead to the theft of sensitive information.", "Business Impact": "The impact on the business is significant, as sensitive information can be stolen by an attacker.", "Technical Impact": "The technical impact is high, as it can lead to the theft of sensitive information.", "Mitigation Strategies": "To mitigate this risk, we recommend validating and sanitizing user input, implementing Content Security Policy (CSP), and limiting the ability to set innerHTML.", "Recommendations": "We recommend that all instances of Querybook be updated to the latest version, and that all users be educated on how to protect themselves from XSS attacks.", "Conclusions": "In conclusion, Querybook is vulnerable to a cross-site scripting (XSS) attack, which can lead to the theft of sensitive information. To mitigate this risk, it is recommended to take the recommended mitigation strategies."}}