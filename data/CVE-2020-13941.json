{"id": "CVE-2020-13941", "sourceIdentifier": "security@apache.org", "published": "2020-08-17T13:15:12.037", "lastModified": "2023-11-07T03:17:01.470", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Reported in SOLR-14515 (private) and fixed in SOLR-14561 (public), released in Solr version 8.6.0. The Replication handler (https://lucene.apache.org/solr/guide/8_6/index-replication.html#http-api-commands-for-the-replicationhandler) allows commands backup, restore and deleteBackup. Each of these take a location parameter, which was not validated, i.e you could read/write to any location the solr user can access."}, {"lang": "es", "value": "Reportado en SOLR-14515 (privado) y corregido en SOLR-14561 (p\u00fablico), publicado en Solr versi\u00f3n 8.6.0. El manejador de Replicaci\u00f3n (https://lucene.apache.org/solr/guide/8_6/index-replication.html#http-api-commands-for-the-replicationhandler) permite una copia de seguridad, restauraci\u00f3n y eliminaci\u00f3n de copias de seguridad de los comandos. Cada uno de estos toma un par\u00e1metro de ubicaci\u00f3n, que no fue comprobado, es decir, podr\u00eda leer y escribir en cualquier ubicaci\u00f3n a la que pueda acceder el usuario de solr."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:solr:*:*:*:*:*:*:*:*", "versionEndExcluding": "8.6.0", "matchCriteriaId": "B83D4025-72BD-48B7-BF4E-C5A5EDC611E0"}]}]}], "references": [{"url": "https://lists.apache.org/thread.html/r1d4a247329a8478073163567bbc8c8cb6b49c6bfc2bf58153a857af1%40%3Ccommits.druid.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/rbcd9dff009ed19ffcc2b09784595fc1098fc802a5472f81795f893be%40%3Ccommits.lucene.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/rc400db37710ee79378b6c52de3640493ff538c2beb41cefdbbdf2ab8%40%3Ccommits.submarine.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/rf54e7912b7d2b72c63ec54a7afa4adcbf16268dcc63253767dd67d60%40%3Cgeneral.lucene.apache.org%3E", "source": "security@apache.org", "tags": ["Mailing List", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1055", "comment": "CVE-2020-13941 - Unvalidated input for the Replication handler allows for remote command execution and backup/restore manipulation, relevant to Enterprise Hacking for Business profit, and can be defended against by validating user input and limiting access to sensitive areas"}, {"techniqueID": "T1505", "comment": "CVE-2020-13941 - The Replication handler's ability to backup and restore allows for data tampering and exfiltration, relevant to Insider Threat and can be defended against by auditing data access and implementing data encryption"}, {"techniqueID": "T1190", "comment": "CVE-2020-13941 - The Replication handler's lack of input validation allows for remote command execution and potential privilege escalation, relevant to Spearphishing and can be defended against by patching and monitoring for suspicious activity"}, {"techniqueID": "TA0013", "comment": "CVE-2020-13941 - The Replication handler's ability to execute commands allows for remote exploitation, relevant to Command and Control and can be defended against by limiting network access and monitoring for suspicious activity"}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "https://example.org/CVE-2020-13941", "created_by_ref": "https://example.org/ Organisation", "modified": "2023-11-07T03:17:01.470", "name": "Apache Solr Replication Handler Remote Command Execution", "description": "CVE-2020-13941 reported in SOLR-14515 and fixed in SOLR-14561, released in Solr version 8.6.0. The Replication handler allows commands backup, restore and deleteBackup. Each of these take a location parameter, which was not validated, i.e you could read/write to any location the solr user can access.", "severity": "HIGH", "base_score": 8.8}, {"type": "attack_pattern", "id": "https://example.org/attack-pattern/T1055", "created_by_ref": "https://example.org/ Organisation", "modified": "2023-11-07T03:17:01.470", "name": "Command Injection", "description": "Unvalidated input for the Replication handler allows for remote command execution.", "kill_chain_id": "https://example.org/kill-chain/insider-threat"}, {"type": "intrusion_set", "id": "https://example.org/intrusion-set/ Insidious", "created_by_ref": "https://example.org/ Organisation", "modified": "2023-11-07T03:17:01.470", "name": "Insidious", "remark": "Intrusion set using Apache Solr Replication Handler Remote Command Execution"}, {"type": "course-of-action", "id": "https://example.org/course-of-action/COC-1", "created_by_ref": "https://example.org/ Organisation", "modified": "2023-11-07T03:17:01.470", "name": "Patch Apache Solr", "description": "Apply the patch released in Solr version 8.6.0", "mitigates": "https://example.org/attack-pattern/T1055"}], "relationship": [{"relationship_type": "related_to", "from": "https://example.org/vulnerability/CVE-2020-13941", "to": "https://example.org/attack-pattern/T1055"}, {"relationship_type": "mitigated_by", "from": "https://example.org/attack-pattern/T1055", "to": "https://example.org/course-of-action/COC-1"}]}, "technical_analysis": {"Introduction": "Apache Solr Replication Handler Remote Command Execution allows an attacker to execute commands with elevated privileges, resulting in data tampering and exfiltration.", "Impact and Scope": "CVSSv3.1: (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H) CVSSv2: (AV:N/AC:L/Au:S/C:P/I:P/A:P). This vulnerability affects Apache Solr version 8.6.0 and below.", "Related MITRE ATT&CK Techniques": "T1055, T1505, T1190, TA0013", "Technical Details": "The Replication handler's lack of input validation allows for remote command execution and potential privilege escalation.", "Detection": "Monitor for suspicious network activity and review system logs for signs of exploitation.", "Mitigation": "Patch Apache Solr and limit access to sensitive areas.", "Conclusion": "This vulnerability is a significant threat to enterprise security and should be prioritized for remediation."}, "executive_analysis": {"Overview": "Apache Solr Replication Handler Remote Command Execution is a high-severity vulnerability that allows attackers to execute commands with elevated privileges.", "Business Impact": "This vulnerability could result in data tampering and exfiltration, potentially causing significant financial losses and reputational damage.", "Technical Impact": "This vulnerability affects Apache Solr version 8.6.0 and below, meaning that all affected systems are at risk of exploitation.", "Mitigation Strategies": "Implement a patch management program to ensure timely updates, and restrict access to sensitive areas.", "Recommendations": "Prioritize remediation of this vulnerability, and consider conducting a thorough security assessment to identify other potential risks.", "Conclusions": "This vulnerability is a critical security risk that requires immediate attention and remediation."}}