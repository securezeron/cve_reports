{"id": "CVE-2020-15607", "sourceIdentifier": "zdi-disclosures@trendmicro.com", "published": "2020-07-28T17:15:13.977", "lastModified": "2023-01-24T18:57:12.680", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "This vulnerability allows remote attackers to execute arbitrary code on affected installations of CentOS Web Panel cwp-e17.0.9.8.923. Authentication is not required to exploit this vulnerability. The specific flaw exists within ajax_admin_apis.php. When parsing the line parameter, the process does not properly validate a user-supplied string before using it to execute a system call. An attacker can leverage this vulnerability to execute code in the context of root. Was ZDI-CAN-9721."}, {"lang": "es", "value": "Esta vulnerabilidad permite a atacantes remotos ejecutar c\u00f3digo arbitrario en las instalaciones afectadas de CentOS Web Panel versi\u00f3n cwp-e17.0.9.8.923. No es requerida una autenticaci\u00f3n para explotar esta vulnerabilidad. El fallo espec\u00edfico se presenta dentro del archivo ajax_admin_apis.php. Cuando se analiza el par\u00e1metro line, el proceso no comprueba apropiadamente una cadena suministrada por el usuario antes de usarla para ejecutar una llamada del sistema. Un atacante puede aprovechar esta vulnerabilidad para ejecutar c\u00f3digo en el contexto de root. Fue ZDI-CAN-9721"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV30": [{"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "zdi-disclosures@trendmicro.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:control-webpanel:webpanel:0.9.8.923:*:*:*:*:*:*:*", "matchCriteriaId": "CF0BE231-2D95-4605-B989-85EF6D5B1216"}]}]}], "references": [{"url": "https://www.zerodayinitiative.com/advisories/ZDI-20-754/", "source": "zdi-disclosures@trendmicro.com", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-15607 - Lateral movement and code execution can be achieved through exploitation of the 'ajax_admin_apis.php' vulnerability in CentOS Web Panel."}, {"techniqueID": "T1036", "comment": "CVE-2020-15607 - The vulnerability in 'ajax_admin_apis.php' allows an attacker to execute system calls as root, enabling command execution."}, {"techniqueID": "T1210", "comment": "CVE-2020-15607 - The 'line' parameter is vulnerable to command injection, enabling an attacker to execute arbitrary code on the affected system."}, {"techniqueID": "T1088", "comment": "CVE-2020-15607 - The vulnerability in 'ajax_admin_apis.php' enables remote code execution, which can be used for further exploitation and privilege escalation."}, {"techniqueID": "T1027", "comment": "CVE-2020-15607 - The vulnerability in 'ajax_admin_apis.php' enables an attacker to execute system calls as root, enabling discovery of confidential information."}], "stix_bundle": {"": {"type": "bundle", "spec_version": "2.1", "objects": [{"type": "Observable", "id": "observable-1", "name": "CVE-2020-15607"}, {"type": "Indicator", "id": "indicator-1", "name": "Vulnerable CentOS Web Panel installation", "description": "An vulnerable installation of CentOS Web Panel cwp-e17.0.9.8.923 with unpatched 'ajax_admin_apis.php' file is detected", "created": "2020-07-28T17:15:13.977"}, {"type": "TTP", "id": "ttp-1", "name": "Exploitation of 'ajax_admin_apis.php' vulnerability", "description": "Exploitation of the 'ajax_admin_apis.php' vulnerability in CentOS Web Panel to execute arbitrary code as root", "created": "2020-07-28T17:15:13.977"}, {"type": "Course-of-Action", "id": "coa-1", "name": "Apply patch to 'ajax_admin_apis.php' file", "description": "Apply a patch to the 'ajax_admin_apis.php' file to remediate the vulnerability", "created": "2020-07-28T17:15:13.977"}, {"type": "Course-of-Action", "id": "coa-2", "name": "Upgrade to a patched version of CentOS Web Panel", "description": "Upgrade to a patched version of CentOS Web Panel to remediate the vulnerability", "created": "2020-07-28T17:15:13.977"}], " relationships": [{"type": "observed-by", "id": "observed-by-1", "from": "observable-1", "to": "indicator-1"}, {"type": "exploited-by", "id": "exploited-by-1", "from": "indicator-1", "to": "ttp-1"}, {"type": " mitigates", "id": "mitigates-1", "from": "ttp-1", "to": "coa-1"}, {"type": "mitigates", "id": "mitigates-2", "from": "ttp-1", "to": "coa-2"}]}}, "technical_analysis": {"Introduction": "The CentOS Web Panel cwp-e17.0.9.8.923 has a vulnerability in the 'ajax_admin_apis.php' file, allowing remote attackers to execute arbitrary code as root.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) and affects all versions of CentOS Web Panel cwp-e17.0.9.8.923.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE technique IDs T1190, T1036, T1210, T1088, and T1027.", "Technical Details": "The vulnerability is a command injection vulnerability, allowing an attacker to execute arbitrary system calls as root.", "Detection": "The vulnerability can be detected by scanning for vulnerable instances of CentOS Web Panel cwp-e17.0.9.8.923 and checking for the presence of the 'ajax_admin_apis.php' file.", "Mitigation": "The vulnerability can be mitigated by applying a patch to the 'ajax_admin_apis.php' file or upgrading to a patched version of CentOS Web Panel.", "Conclusion": "The vulnerability in CentOS Web Panel cwp-e17.0.9.8.923 is a critical vulnerability that requires immediate attention to prevent exploitation."}, "executive_analysis": {"Overview": "The CentOS Web Panel cwp-e17.0.9.8.923 has a critical vulnerability in the 'ajax_admin_apis.php' file, allowing remote attackers to execute arbitrary code as root.", "Business Impact": "The vulnerability has the potential to lead to significant business disruption and data loss if exploited.", "Technical Impact": "The vulnerability has a CVSS score of 9.8, indicating a high risk of exploitation and potential impact.", "Mitigation Strategies": "The vulnerability can be mitigated by applying a patch to the 'ajax_admin_apis.php' file or upgrading to a patched version of CentOS Web Panel.", "Recommendations": "We recommend applying a patch to the 'ajax_admin_apis.php' file as soon as possible and upgrading to a patched version of CentOS Web Panel.", "Conclusions": "The vulnerability in CentOS Web Panel cwp-e17.0.9.8.923 is a critical vulnerability that requires immediate attention to prevent exploitation and protect business interests."}}