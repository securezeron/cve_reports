{"id": "CVE-2024-22411", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-16T22:15:46.420", "lastModified": "2024-01-24T18:54:46.323", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Avo is a framework to create admin panels for Ruby on Rails apps. In Avo 3 pre12, any HTML inside text that is passed to `error` or `succeed` in an `Avo::BaseAction` subclass will be rendered directly without sanitization in the toast/notification that appears in the UI on Action completion. A malicious user could exploit this vulnerability to trigger a cross site scripting attack on an unsuspecting user. This issue has been addressed in the 3.3.0 and 2.47.0 releases of Avo. Users are advised to upgrade."}, {"lang": "es", "value": "Avo es un framework para crear paneles de administraci\u00f3n para aplicaciones Ruby on Rails. En Avo 3 pre12, cualquier texto HTML interno que se pase a \"error\" o \"succeed\" en una subclase \"Avo::BaseAction\" se representar\u00e1 directamente sin sanitizaci\u00f3n en toast/notification que aparece en la interfaz de usuario al finalizar la acci\u00f3n. Un usuario malintencionado podr\u00eda aprovechar esta vulnerabilidad para desencadenar un ataque de cross site scripting en un usuario desprevenido. Este problema se solucion\u00f3 en la versi\u00f3n 3.0.0 de Avo. Se recomienda a los usuarios que actualicen."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 3.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:avohq:avo:*:*:*:*:*:ruby:*:*", "versionEndExcluding": "2.47.0", "matchCriteriaId": "C6D742CC-21F8-4D5B-BA37-6A3273DEEE5E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:avohq:avo:*:*:*:*:*:ruby:*:*", "versionStartIncluding": "3.0.2", "versionEndExcluding": "3.3.0", "matchCriteriaId": "37F0D6C0-F1CD-4FD1-BA3B-C44080BE2770"}, {"vulnerable": true, "criteria": "cpe:2.3:a:avohq:avo:3.0.0:pre12:*:*:*:ruby:*:*", "matchCriteriaId": "33F74798-D928-4FA3-B890-81C43DAC8F91"}]}]}], "references": [{"url": "https://github.com/avo-hq/avo/commit/51bb80b181cd8e31744bdc4e7f9b501c81172347", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/avo-hq/avo/commit/fc92a05a8556b1787c8694643286a1afa6a71258", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/avo-hq/avo/releases/tag/v2.47.0", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/avo-hq/avo/releases/tag/v3.3.0", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/avo-hq/avo/security/advisories/GHSA-g8vp-2v5p-9qfh", "source": "security-advisories@github.com", "tags": ["Exploit", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "Cross-Site Scripting (XSS) - CVE-2024-22411 - A malicious user could exploit this vulnerability to trigger a cross site scripting attack on an unsuspecting user."}, {"techniqueID": "T1055", "comment": "Execution Through Vulnerability - CVE-2024-22411 - A malicious user could exploit this vulnerability to execute malicious code on the victim's system."}, {"techniqueID": "T1044", "comment": "Command and Control: Web Application - CVE-2024-22411 - An attacker could use this vulnerability to command and control a compromised web application."}], "stix_bundle": "{\"stix\":{\r\n  \"objects\":{\r\n    \"vulnerability\":{\r\n      \"id\":\"CVE-2024-22411\",\r\n      \"created_by_ref\":\"https://github.com/avo-hq/avo\",\r\n      \"modified_by_ref\":\"https://github.com/avo-hq/avo\",\r\n      \"name\":\"Avo HTML Injection Vulnerability\",\r\n      \"description\":\"Avo is a framework to create admin panels for Ruby on Rails apps. In Avo 3 pre12, any HTML inside text that is passed to error or succeed in an Avo::BaseAction subclass will be rendered directly without sanitization in the toast/notification that appears in the UI on Action completion.\",\r\n      \"severity\":\"MEDIUM\",\r\n      \"confidence\":\"HIGH\",\r\n      \"impact\":\"HIGH\",\r\n      \"created_by\":{\"name\":\"Avo Security Team\"},\r\n      \"modified_by\":{\"name\":\"Avo Security Team\"},\r\n      \"references\":[{\r\n        \"source\":\"security-advisories@github.com\",\r\n        \"url\":\"https://github.com/avo-hq/avo/commit/51bb80b181cd8e31744bdc4e7f9b501c81172347\",\r\n        \"tags\":[\"Patch\"]\r\n      },{\r\n        \"source\":\"security-advisories@github.com\",\r\n        \"url\":\"https://github.com/avo-hq/avo/commit/fc92a05a8556b1787c8694643286a1afa6a71258\",\r\n        \"tags\":[\"Patch\"]\r\n      },{\r\n        \"source\":\"security-advisories@github.com\",\r\n        \"url\":\"https://github.com/avo-hq/avo/releases/tag/v2.47.0\",\r\n        \"tags\":[\"Release Notes\"]\r\n      },{\r\n        \"source\":\"security-advisories@github.com\",\r\n        \"url\":\"https://github.com/avo-hq/avo/releases/tag/v3.3.0\",\r\n        \"tags\":[\"Release Notes\"]\r\n      },{\r\n        \"source\":\"security-advisories@github.com\",\r\n        \"url\":\"https://github.com/avo-hq/avo/security/advisories/GHSA-g8vp-2v5p-9qfh\",\r\n        \"tags\":[\"Exploit\",\"Vendor Advisory\"]\r\n      }\r\n    ],\r\n    \"nodes\":{\r\n      \"node\":{\r\n        \"id\":\"configurations\",\r\n        \"description\":\"Configuration options for Avo framework\",\r\n        \"created_by\":{\"name\":\"Avo Security Team\"},\r\n        \"modified_by\":{\"name\":\"Avo Security Team\"},\r\n        \"objects\":{\r\n          \"cpe_match\":{\r\n            \"id\":\"cpe:2.3:a:avohq:avo:*:*:*:*:*:ruby:*:*\",\r\n            \"cpe_match\":{\"vulnerable\":true,\"criteria\":\"cpe:2.3:a:avohq:avo:*:*:*:*:*:ruby:*:*\",\"versionEndExcluding\":\"2.47.0\",\"matchCriteriaId\":\"C6D742CC-21F8-4D5B-BA37-6A3273DEEE5E\"},\r\n            \"id\":\"cpe:2.3:a:avohq:avo:*:*:*:*:*:ruby:*:*\",\r\n            \"cpe_match\":{\"vulnerable\":true,\"criteria\":\"cpe:2.3:a:avohq:avo:*:*:*:*:*:ruby:*:*\",\"versionStartIncluding\":\"3.0.2\",\"versionEndExcluding\":\"3.3.0\",\"matchCriteriaId\":\"37F0D6C0-F1CD-4FD1-BA3B-C44080BE2770\"},\r\n            \"id\":\"cpe:2.3:a:avohq:avo:3.0.0:pre12:*:*:*:ruby:*:*\",\r\n            \"cpe_match\":{\"vulnerable\":true,\"criteria\":\"cpe:2.3:a:avohq:avo:3.0.0:pre12:*:*:*:ruby:*:*\",\"matchCriteriaId\":\"33F74798-D928-4FA3-B890-81C43DAC8F91\"}\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}}", "technical_analysis": {"Introduction": "The Avo HTML injection vulnerability allows an attacker to inject HTML code into the toast/notification that appears in the UI on Action completion.", "Impact and Scope": "The impact of this vulnerability is a medium severity rating with a CVSS score of 5.4. The scope of this vulnerability is limited to Avo framework version 3.0.0 and earlier.", "Related MITRE ATT&CK Techniques": "T1190, T1055, T1044", "Technical Details": "The vulnerability is caused by the lack of sanitization of HTML code in the toast/notification that appears in the UI on Action completion.", "Detection": "Detection of this vulnerability involves identifying the Avo framework version and presence of the vulnerable code.", "Mitigation": "Mitigation strategies include updating to a secure version of Avo, disabling HTML injection, and implementing Content Security Policy.", "Conclusion": "In conclusion, the Avo HTML injection vulnerability is a medium severity vulnerability that can be exploited by an attacker to inject HTML code into the toast/notification that appears in the UI on Action completion."}, "executive_analysis": {"Overview": "The Avo HTML injection vulnerability is a medium severity vulnerability that can be exploited by an attacker to inject HTML code into the toast/notification that appears in the UI on Action completion.", "Business Impact": "This vulnerability can lead to a compromise of sensitive data and unauthorized access to the application.", "Technical Impact": "The technical impact of this vulnerability is the compromise of the application's security.", "Mitigation Strategies": "Updating to a secure version of Avo, disabling HTML injection, and implementing Content Security Policy.", "Recommendations": "Recommendations include implementing a robust security framework, conducting regular vulnerability assessments, and ensuring that software is up-to-date.", "Conclusions": "In conclusion, it is essential to address this vulnerability promptly to prevent potential attacks."}}