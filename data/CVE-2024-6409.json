{"id": "CVE-2024-6409", "sourceIdentifier": "secalert@redhat.com", "published": "2024-07-08T18:15:09.487", "lastModified": "2024-08-22T13:15:05.147", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A race condition vulnerability was discovered in how signals are handled by OpenSSH's server (sshd). If a remote attacker does not authenticate within a set time period, then sshd's SIGALRM handler is called asynchronously. However, this signal handler calls various functions that are not async-signal-safe, for example, syslog(). As a consequence of a successful attack, in the worst case scenario, an attacker may be able to perform a remote code execution (RCE) as an unprivileged user running the sshd server."}, {"lang": "es", "value": "Se encontr\u00f3 una vulnerabilidad de condici\u00f3n de ejecuci\u00f3n del controlador de se\u00f1ales en el servidor de OpenSSH (sshd), donde un cliente no se autentica dentro de los segundos de LoginGraceTime (120 de forma predeterminada, 600 en versiones anteriores de OpenSSH), luego se llama al controlador SIGALRM de sshd de forma asincr\u00f3nica. Sin embargo, este controlador de se\u00f1ales llama a varias funciones que no son seguras para se\u00f1ales as\u00edncronas, por ejemplo, syslog(). Este problema lo deja vulnerable a una condici\u00f3n de ejecuci\u00f3n del controlador de se\u00f1ales en la funci\u00f3n cleanup_exit(), que introduce la misma vulnerabilidad que CVE-2024-6387 en el hijo sin privilegios del servidor SSHD."}], "metrics": {"cvssMetricV31": [{"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "HIGH", "baseScore": 7.0, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 4.7}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-364"}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/07/08/2", "source": "secalert@redhat.com"}, {"url": "http://www.openwall.com/lists/oss-security/2024/07/09/2", "source": "secalert@redhat.com"}, {"url": "http://www.openwall.com/lists/oss-security/2024/07/09/5", "source": "secalert@redhat.com"}, {"url": "http://www.openwall.com/lists/oss-security/2024/07/10/1", "source": "secalert@redhat.com"}, {"url": "http://www.openwall.com/lists/oss-security/2024/07/10/2", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:4457", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:4613", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:4716", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:4910", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:4955", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:4960", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:5444", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/security/cve/CVE-2024-6409", "source": "secalert@redhat.com"}, {"url": "https://almalinux.org/blog/2024-07-09-cve-2024-6409/", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2295085", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.suse.com/show_bug.cgi?id=1227217", "source": "secalert@redhat.com"}, {"url": "https://explore.alas.aws.amazon.com/CVE-2024-6409.html", "source": "secalert@redhat.com"}, {"url": "https://github.com/openela-main/openssh/commit/c00da7741d42029e49047dd89e266d91dcfbffa0", "source": "secalert@redhat.com"}, {"url": "https://security-tracker.debian.org/tracker/CVE-2024-6409", "source": "secalert@redhat.com"}, {"url": "https://security.netapp.com/advisory/ntap-20240712-0003/", "source": "secalert@redhat.com"}, {"url": "https://sig-security.rocky.page/issues/CVE-2024-6409/", "source": "secalert@redhat.com"}, {"url": "https://ubuntu.com/security/CVE-2024-6409", "source": "secalert@redhat.com"}, {"url": "https://www.suse.com/security/cve/CVE-2024-6409.html", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1177: Lateral Movement", "comment": "CVE-2024-6409 - An attacker may use this vulnerability to execute arbitrary code as an unprivileged user and then move laterally within the network, using techniques such as T1078: Exploitation of Remote Services or T1027: Obfuscated Files or Information"}, {"techniqueID": "T1568: Post Exploitation", "comment": "CVE-2024-6409 - After gaining a foothold on the system, an attacker may use this vulnerability to perform post-exploitation activities such as data exfiltration, privilege escalation, and credential harvesting"}, {"techniqueID": "T1655: Encryption", "comment": "CVE-2024-6409 - An attacker may use this vulnerability to encrypt data to avoid detection or to communicate with command and control servers"}, {"techniqueID": "T1491: Screen Scrape", "comment": "CVE-2024-6409 - An attacker may use this vulnerability to gather sensitive information by screen scraping, once they have gained a foothold on the system"}, {"techniqueID": "T1210: Exploitation of Remote Services", "comment": "CVE-2024-6409 - This vulnerability may be exploited using remote services, making it a potential entry point for an attacker to gain access to a system"}, {"techniqueID": "T1662: Split-Tunneling", "comment": "CVE-2024-6409 - An attacker may use this vulnerability to establish a split tunnel, allowing them to communicate with command and control servers undetected"}], "technical_analysis": {"Introduction": "This is a race condition vulnerability in OpenSSH's server, where the SIGALRM signal handler calls non-async-signal-safe functions, making it vulnerable to remote code execution.", "Impact and Scope": "CVSS Score: 7.0, Attack Vector: Network, CVSS Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:H", "Related MITRE ATT&CK Techniques": "T1177: Lateral Movement, T1568: Post Exploitation, T1655: Encryption, T1491: Screen Scrape, T1210: Exploitation of Remote Services, T1662: Split-Tunneling", "Technical Details": "The vulnerability is caused by a race condition when handling signals, allowing an attacker to execute arbitrary code as an unprivileged user.", "Detection": "Monitor system logs for unusual connections and suspicious activity.", "Mitigation": "Apply the relevant security patches, restrict access to the system, and monitor for suspicious activity.", "Conclusion": "The CVE-2024-6409 vulnerability is a serious threat that requires immediate attention."}, "executive_analysis": {"Overview": "This is a race condition vulnerability in OpenSSH's server that can lead to remote code execution.", "Business Impact": "This vulnerability could compromise sensitive data and enable attacker lateral movement, potentially leading to financial losses and reputational damage.", "Technical Impact": "This vulnerability can lead to remote code execution and data exfiltration, creating a high-risk situation.", "Mlitigation Strategies": "Apply security patches, restrict access, and monitor for suspicious activity.", "Recommendations": "Implement a vulnerability management program, conduct regular security assessments, and ensure proper patch management.", "Conclusions": "Immediate action is required to mitigate this vulnerability and ensure the security of the system."}}