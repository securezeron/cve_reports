{"id": "CVE-2024-6027", "sourceIdentifier": "security@wordfence.com", "published": "2024-06-21T10:15:12.437", "lastModified": "2024-06-24T19:17:50.240", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Themify \u2013 WooCommerce Product Filter plugin for WordPress is vulnerable to time-based SQL Injection via the \u2018conditions\u2019 parameter in all versions up to, and including, 1.4.9 due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query.  This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database."}, {"lang": "es", "value": "El complemento Themify \u2013 WooCommerce Product Filter para WordPress es vulnerable a la inyecci\u00f3n SQL basada en tiempo a trav\u00e9s del par\u00e1metro 'condiciones' en todas las versiones hasta la 1.4.9 incluida debido a un escape insuficiente en el par\u00e1metro proporcionado por el usuario y a la falta de preparaci\u00f3n suficiente en la consulta SQL existente. Esto hace posible que atacantes no autenticados agreguen consultas SQL adicionales a consultas ya existentes que pueden usarse para extraer informaci\u00f3n confidencial de la base de datos."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:themify:product_filter:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "1.5.0", "matchCriteriaId": "3A41AFF5-93BB-4FF6-96C3-6BBFEE4F4FA2"}]}]}], "references": [{"url": "https://plugins.trac.wordpress.org/browser/themify-wc-product-filter/trunk/public/class-wpf-public.php#L604", "source": "security@wordfence.com", "tags": ["Product"]}, {"url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=3104239%40themify-wc-product-filter%2Ftrunk&old=3100861%40themify-wc-product-filter%2Ftrunk&sfp_email=&sfph_mail=#file2", "source": "security@wordfence.com", "tags": ["Product"]}, {"url": "https://themify.org/changelogs/themify-wc-product-filter.txt", "source": "security@wordfence.com", "tags": ["Release Notes"]}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/451db756-9d62-4c8e-b735-e5e5207b81e3?source=cve", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-6027 - The vulnerability allows for time-based SQL injection, enabling an attacker to inject additional SQL queries into the database."}, {"techniqueID": "T1210", "comment": "CVE-2024-6027 - The lack of input validation and sanitization on the 'conditions' parameter makes it possible for an attacker to inject malicious SQL code."}, {"techniqueID": "T1064", "comment": "CVE-2024-6027 - The vulnerability can be exploited by sending a crafted HTTP request to the 'conditions' parameter, allowing an attacker to inject SQL queries."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve/2024-6027", "Object": {"type": "vulnerability", "id": "https://example.com/cve/2024-6027", "title": "Themify \u2013 WooCommerce Product Filter Plugin SQL Injection", "description": "The Themify \u2013 WooCommerce Product Filter plugin for WordPress is vulnerable to time-based SQL Injection via the 'conditions' parameter due to insufficient escaping on the user-supplied parameter and lack of sufficient preparation on the existing SQL query.", "score": 9.8, "cvss": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}, "related_attack_patterns": [{"type": "attack-pattern", "id": "https://example.com/attack/T1059", "_title": "SQL Injection"}], "related_courses_of_action": [{"type": "course-of-action", "id": "https://example.com/course/T1524", "title": "Remove Unnecessary Code"}], "related defenders": [{"type": "indicator", "id": "https://example.com/indicator/T1511", "title": "Untrusted SQL Code"}]}, "Relations": {"contains": {"vulnerability": {"type": "vulnerability", "id": "https://example.com/cve/2024-6027"}}, "related_to": {"attack-pattern": {"type": "attack-pattern", "id": "https://example.com/attack/T1059", "title": "SQL Injection"}}, "mades_vulnerable_by": {"course-of-action": {"type": "course-of-action", "id": "https://example.com/course/T1524", "title": "Remove Unnecessary Code"}}, "defeated_by": {"indicator": {"type": "indicator", "id": "https://example.com/indicator/T1511", "title": "Untrusted SQL Code"}}}}, "technical_analysis": {"Introduction": "The Themify \u2013 WooCommerce Product Filter plugin for WordPress contains a vulnerability that allows for time-based SQL injection attacks.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8, allowing for high-impact attacks, and can be exploited by sending a crafted HTTP request to the 'conditions' parameter.", "Related MITRE ATT&CK Techniques": "T1059, T1210, T1064", "Technical Details": "The plugin does not perform sufficient input validation and sanitization on the 'conditions' parameter, making it possible for an attacker to inject malicious SQL code.", "Detection": "Detection involves monitoring for unusual activity in the database and monitoring for SQL injection attempts.", "Mitigation": "Mitigation strategies include removing unnecessary code, validating and sanitizing user input, and implementing a web application firewall.", "Conclusion": "In conclusion, this vulnerability poses a significant risk to affected WordPress sites and requires immediate attention to prevent exploitation."}, "executive_analysis": {"Overview": "The Themify \u2013 WooCommerce Product Filter plugin for WordPress contains a critical vulnerability that allows for time-based SQL injection attacks, posing a significant risk to affected websites.", "Business Impact": "The vulnerability can result in the compromise of sensitive data, including customer information, financial data, and intellectual property.", "Technical Impact": "The vulnerability allows an attacker to inject malicious SQL code, potentially leading to a complete takeover of the database and website.", "Mitigation Strategies": "Implementing a web application firewall, removing unnecessary code, and validating and sanitizing user input are key mitigation strategies.", "Recommendations": "We recommend that all affected websites update to the latest version of the plugin and implement additional security measures to prevent exploitation.", "Conclusions": "In conclusion, this vulnerability requires immediate attention to prevent exploitation and protect affected websites."}}