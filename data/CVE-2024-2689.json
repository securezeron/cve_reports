{"id": "CVE-2024-2689", "sourceIdentifier": "security@temporal.io", "published": "2024-04-03T22:15:07.290", "lastModified": "2024-04-04T12:48:41.700", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Denial of Service in Temporal Server prior to version 1.20.5, 1.21.6, and 1.22.7 allows an authenticated user who has permissions to interact with workflows and has crafted an invalid UTF-8 string for submission to potentially cause a crashloop. If left unchecked, the task containing the invalid UTF-8 will become stuck in the queue, causing an increase in queue lag. Eventually, all processes handling these queues will become stuck and the system will run out of resources. The workflow ID of the failing task will be visible in the logs, and can be used to remove that workflow as a mitigation. Version 1.23 is not impacted.\u00a0In this context, a user is an operator of Temporal Server.\n"}, {"lang": "es", "value": "La denegaci\u00f3n de servicio en Temporal Server anterior a las versiones 1.20.5, 1.21.6 y 1.22.7 permite que un usuario autenticado que tenga permisos para interactuar con flujos de trabajo y haya creado una cadena UTF-8 no v\u00e1lida para su env\u00edo pueda provocar un bucle de bloqueo. Si no se marca, la tarea que contiene el UTF-8 no v\u00e1lido quedar\u00e1 atascada en la cola, lo que provocar\u00e1 un aumento en el retraso de la cola. Con el tiempo, todos los procesos que manejan estas colas se atascar\u00e1n y el sistema se quedar\u00e1 sin recursos. El ID del flujo de trabajo de la tarea fallida ser\u00e1 visible en los registros y se puede utilizar para eliminar ese flujo de trabajo como mitigaci\u00f3n. La versi\u00f3n 1.23 no se ve afectada. En este contexto, un usuario es un operador de Temporal Server."}], "metrics": {"cvssMetricV31": [{"source": "security@temporal.io", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 4.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.7, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@temporal.io", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "https://github.com/temporalio/temporal/releases", "source": "security@temporal.io"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-2689 - This technique can be used to cause a Denial of Service (DoS) attack by exploiting the vulnerability in the Temporal Server. An attacker can craft an invalid UTF-8 string to submit to the server, causing a crashloop and eventually leading to a system-wide denial of service."}, {"techniqueID": "T1090", "comment": "CVE-2024-2689 - This technique can be used to conduct a denial of service attack by continuously submitting invalid UTF-8 strings to the Temporal Server, causing it to become unresponsive. This technique could be used as part of a larger attack to disrupt the operation of the targeted system."}, {"techniqueID": "T1501", "comment": "CVE-2024-2689 - This technique can be used to exploit the weak sanitization of user-controllable input in the Temporal Server, allowing an attacker to cause a denial of service. This technique can be used as part of a larger attack to compromise the targeted system."}], "stix_bundle": {"objects": [{"id": "vulnerability--CVE-2024-2689", "type": "vulnerability", "name": "CVE-2024-2689", "description": "Denial of Service in Temporal Server prior to version 1.20.5, 1.21.6, and 1.22.7 allows an authenticated user who has permissions to interact with workflows and has crafted an invalid UTF-8 string for submission to potentially cause a crashloop.", "object_refs": ["attack-pattern--T1190", "attack-pattern--T1090", "attack-pattern--T1501"]}, {"id": "attack-pattern--T1190", "type": "attack-pattern", "name": "Exploit of Crafted Invalid UTF-8 String", "description": "An attacker crafts an invalid UTF-8 string and submits it to the Temporal Server, causing a crashloop and eventually leading to a system-wide denial of service.", "data_sources": ["indicator--CVE-2024-2689"]}, {"id": "attack-pattern--T1090", "type": "attack-pattern", "name": "Continuous Submission of Invalid UTF-8 Strings", "description": "An attacker continuously submits invalid UTF-8 strings to the Temporal Server, causing it to become unresponsive and eventually leading to a system-wide denial of service.", "data_sources": ["indicator--CVE-2024-2689"]}, {"id": "attack-pattern--T1501", "type": "attack-pattern", "name": "Weak Sanitization of User-Controllable Input", "description": "An attacker exploits the weak sanitization of user-controllable input in the Temporal Server to cause a denial of service.", "data_sources": ["indicator--CVE-2024-2689"]}, {"id": "indicator--CVE-2024-2689", "type": "indicator", "name": "CVE-2024-2689", "description": "Identification of CVE-2024-2689 vulnerability in Temporal Server", "pattern_max_count": "1"}], "relationship": [{"relationship": "related_to", "id_ref": "vulnerability--CVE-2024-2689", "id_object": "attack-pattern--T1190"}, {"relationship": "related_to", "id_ref": "vulnerability--CVE-2024-2689", "id_object": "attack-pattern--T1090"}, {"relationship": "related_to", "id_ref": "vulnerability--CVE-2024-2689", "id_object": "attack-pattern--T1501"}]}, "technical_analysis": {"Introduction": "The Temporal Server prior to version 1.20.5, 1.21.6, and 1.22.7 contains a vulnerability that allows an authenticated user who has permissions to interact with workflows and has crafted an invalid UTF-8 string for submission to potentially cause a crashloop.", "Impact and Scope": "The vulnerability has a CVSS score of 4.4 and an attack vector of NETWORK. It allows an attacker to conduct a denial of service attack by submitting an invalid UTF-8 string to the server.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the MITRE ATT&CK techniques T1190, T1090, and T1501.", "Technical Details": "The vulnerability occurs when the Temporal Server processes an invalid UTF-8 string and becomes stuck in a loop, eventually leading to a denial of service.", "Detection": "Detection of this vulnerability can be done by monitoring the server logs for crashloops and examining the workflow IDs of the tasks that are stuck in the queue.", "Mitigation": "Mitigation strategies include patching the server to the latest version, restricting the permissions of users who can interact with workflows, and implementing additional logging and monitoring to detect and prevent denial of service attacks.", "Conclusion": "The vulnerability in the Temporal Server is critical and requires immediate attention to prevent denial of service attacks."}, "executive_analysis": {"Overview": "The Temporal Server contains a critical vulnerability that allows an attacker to conduct a denial of service attack.", "Business Impact": "The vulnerability can cause significant business disruption and loss of revenue by preventing the Temporal Server from processing workflows and tasks.", "Technical Impact": "The vulnerability has a significant technical impact by allowing an attacker to crash the server and prevent it from processing tasks and workflows.", "Mitigation Strategies": "The recommended mitigation strategies include patching the server, restricting user permissions, and implementing additional logging and monitoring.", "Recommendations": "Recommendations include prioritizing the patching of the server, conducting a thorough risk assessment, and implementing additional security measures to prevent denial of service attacks.", "Conclusions": "The vulnerability in the Temporal Server is critical and requires immediate attention to prevent denial of service attacks."}}