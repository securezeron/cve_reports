{"id": "CVE-2024-6640", "sourceIdentifier": "secteam@freebsd.org", "published": "2024-08-12T13:38:39.380", "lastModified": "2024-08-12T13:41:36.517", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In ICMPv6 Neighbor Discovery (ND), the ID is always 0.  When pf is configured to allow ND and block incoming Echo Requests, a crafted Echo Request packet after a Neighbor Solicitation (NS) can trigger an Echo Reply.  The packet has to come from the same host as the NS and have a zero as identifier to match the state created by the Neighbor Discovery and allow replies to be generated.\n\nICMPv6 packets with identifier value of zero bypass firewall rules written on the assumption that the incoming packets are going to create a state in the state table."}, {"lang": "es", "value": "En ICMPv6 Neighbor Discovery (ND), el ID es siempre 0. Cuando pf est\u00e1 configurado para permitir ND y bloquear solicitudes de eco entrantes, un paquete de solicitud de eco manipulado despu\u00e9s de una solicitud de vecino (NS) puede desencadenar una respuesta de eco. El paquete debe provenir del mismo host que el NS y tener un cero como identificador para coincidir con el estado creado por Neighbor Discovery y permitir que se generen respuestas. Paquetes ICMPv6 con valor de identificador de reglas de firewall de omisi\u00f3n cero escritos bajo el supuesto de que los paquetes entrantes crear\u00e1n un estado en la tabla de estados."}], "metrics": {}, "references": [{"url": "https://security.freebsd.org/advisories/FreeBSD-SA-24:05.pf.asc", "source": "secteam@freebsd.org"}], "techniques": [{"techniqueID": "T1184:ICMP-Redirect-ARP", "comment": "CVE-2024-6640 - Allows an attacker to bypass firewall rules using crafted ICMPv6 packets with identifier value of zero. Defend against this by configuring pf to only allow incoming Echo Requests from trusted hosts."}, {"techniqueID": "T1047:Network-Sniffing", "comment": "CVE-2024-6640 - Allows an attacker to bypass firewall rules using crafted ICMPv6 packets with identifier value of zero. Defend against this by configuring pf to only allow incoming Echo Requests from trusted hosts and configuring network sniffing detection."}, {"techniqueID": "T1040:Network-Exploitation", "comment": "CVE-2024-6640 - Allows an attacker to bypass firewall rules using crafted ICMPv6 packets with identifier value of zero. Defend against this by configuring pf to only allow incoming Echo Requests from trusted hosts and configuring network exploitation detection."}, {"techniqueID": "T1078:Adjacent-Network-Scan", "comment": "CVE-2024-6640 - Allows an attacker to bypass firewall rules using crafted ICMPv6 packets with identifier value of zero. Defend against this by configuring pf to only allow incoming Echo Requests from trusted hosts and configuring adjacent network scan detection."}], "stix_bundle": null, "technical_analysis": {"Introduction": "The CVE-2024-6640 vulnerability allows an attacker to bypass firewall rules using crafted ICMPv6 packets with identifier value of zero. This vulnerability affects systems running FreeBSD.", "Impact and Scope": "The impact of this vulnerability is the ability for an attacker to bypass firewall rules and potentially gain unauthorized access to the system.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1184:ICMP-Redirect-ARP, T1047:Network-Sniffing, T1040:Network-Exploitation, and T1078:Adjacent-Network-Scan.", "Technical Details": "The vulnerability occurs when pf is configured to allow incoming Echo Requests from any host, allowing an attacker to bypass firewall rules using crafted ICMPv6 packets with identifier value of zero.", "Detection": "Detection can be achieved by monitoring network traffic for suspicious ICMPv6 packets with identifier value of zero.", "Mitigation": "Mitigation strategies include configuring pf to only allow incoming Echo Requests from trusted hosts and configuring network sniffing and adjacent network scan detection.", "Conclusion": "The CVE-2024-6640 vulnerability allows an attacker to bypass firewall rules using crafted ICMPv6 packets with identifier value of zero, and must be addressed by configuring pf to only allow incoming Echo Requests from trusted hosts and configuring network sniffing and adjacent network scan detection."}, "executive_analysis": {"Overview": "The CVE-2024-6640 vulnerability allows an attacker to bypass firewall rules using crafted ICMPv6 packets with identifier value of zero, potentially granting unauthorized access to the system.", "Business Impact": "The business impact of this vulnerability is the potential loss of sensitive data and disruption of critical systems.", "Technical Impact": "The technical impact of this vulnerability is the potential compromise of system security and integrity.", "Mitigation Strategies": "Mitigation strategies include configuring pf to only allow incoming Echo Requests from trusted hosts and configuring network sniffing and adjacent network scan detection.", "Recommendations": "We recommend that system administrators/configurators promptly address this vulnerability by applying the recommended mitigation strategies.", "Conclusions": "The CVE-2024-6640 vulnerability is a critical security risk that must be addressed promptly to prevent unauthorized access to the system."}}