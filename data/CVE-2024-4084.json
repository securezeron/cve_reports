{"id": "CVE-2024-4084", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-05T00:15:09.840", "lastModified": "2024-06-11T16:44:49.090", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A Server-Side Request Forgery (SSRF) vulnerability exists in the latest version of mintplex-labs/anything-llm, allowing attackers to bypass the official fix intended to restrict access to intranet IP addresses and protocols. Despite efforts to filter out intranet IP addresses starting with 192, 172, 10, and 127 through regular expressions and limit access protocols to HTTP and HTTPS, attackers can still bypass these restrictions using alternative representations of IP addresses and accessing other ports running on localhost. This vulnerability enables attackers to access any asset on the internal network, attack web services on the internal network, scan hosts on the internal network, and potentially access AWS metadata endpoints. The vulnerability is due to insufficient validation of user-supplied URLs, which can be exploited to perform SSRF attacks."}, {"lang": "es", "value": "Existe una vulnerabilidad de server-side request forgery (SSRF) en la \u00faltima versi\u00f3n de mintplex-labs/anything-llm, lo que permite a los atacantes eludir la soluci\u00f3n oficial destinada a restringir el acceso a las direcciones IP y protocolos de la intranet. A pesar de los esfuerzos por filtrar las direcciones IP de la intranet que comienzan con 192, 172, 10 y 127 mediante expresiones regulares y limitar los protocolos de acceso a HTTP y HTTPS, los atacantes a\u00fan pueden eludir estas restricciones utilizando representaciones alternativas de direcciones IP y accediendo a otros puertos que se ejecutan en localhost. Esta vulnerabilidad permite a los atacantes acceder a cualquier activo en la red interna, atacar servicios web en la red interna, escanear hosts en la red interna y potencialmente acceder a puntos finales de metadatos de AWS. La vulnerabilidad se debe a una validaci\u00f3n insuficiente de las URL proporcionadas por el usuario, que pueden explotarse para realizar ataques SSRF."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.1, "impactScore": 4.0}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-918"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mintplexlabs:anythingllm:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.5.4", "matchCriteriaId": "2150524B-91AA-4171-B8B0-B8207DB9C243"}]}]}], "references": [{"url": "https://huntr.com/bounties/bf44517e-a07d-4f54-89b4-3b05fca2a008", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-4084 - Server-Side Request Forgery (SSRF) vulnerability allows attackers to bypass restrictions on internal network access, potentially leading to data theft or system compromise."}, {"techniqueID": "T1037", "comment": "CVE-2024-4084 - Weakness in validation of user-supplied URLs makes it vulnerable to SSRF attacks, which can be used to access internal network resources."}, {"techniqueID": "T1078", "comment": "CVE-2024-4084 - SSRF vulnerability can be used to scan hosts on internal network, attack web services on internal network, and potentially access AWS metadata endpoints."}, {"techniqueID": "T1191", "comment": "CVE-2024-4084 - Inadequate validation of user-supplied URLs makes it vulnerable to SSRF attacks, which can be used to bypass internal network restrictions and access sensitive data."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve-2024-4084", "objects": {"Vulnerability": {"type": "vulnerability", "id": "https://example.com/cve-2024-4084", "description": "CVE-2024-4084 - Server-Side Request Forgery (SSRF) vulnerability in mintplex-labs/anything-llm allows attackers to bypass restrictions on internal network access, potentially leading to data theft or system compromise.", "related_incident_identifiers": [{"id": "https://example.com/incident-123"}]}, "Network_Exploitation": {"type": "attack-pattern", "id": "https://example.com/network-exploitation", "name": "Network Exploitation", "description": "Network exploitation is a known technique where an attacker compromises a network resource to gain access to a system."}, "SSRF_Attack": {"type": "attack-pattern", "id": "https://example.com/ssrf-attack", "name": "Server-Side Request Forgery (SSRF) Attack", "description": "Server-Side Request Forgery (SSRF) is an attack technique where an attacker tricks a server into making a request to an unintended location."}}, "kill_chain_phases": [{"id": "https://example.com/kill-chain-1", "phase": "Reconnaissance", "mitigations": {"technical": [{"id": "https://example.com/mitigation-1", "name": "Mitigation 1", "description": "Mitigation 1 description"}]}}]}, "technical_analysis": {"Introduction": "The CVE-2024-4084 vulnerability in mintplex-labs/anything-llm allows attackers to bypass internal network restrictions, potentially leading to data theft or system compromise.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 (HIGH) with an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "T1190, T1037, T1078, T1191", "Technical Details": "The vulnerability occurs due to insufficient validation of user-supplied URLs, which can be exploited to perform SSRF attacks.", "Detection": "Detecting this vulnerability involves monitoring network traffic for suspicious requests and checking for signs of SSRF attacks.", "Mitigation": "Mitigating this vulnerability involves validating user-supplied URLs to prevent SSRF attacks and restricting access to internal network resources.", "Conclusion": "The CVE-2024-4084 vulnerability is a critical security risk and should be addressed as soon as possible."}, "executive_analysis": {"Overview": "The CVE-2024-4084 vulnerability is a high-severity risk that can compromise internal network security and put sensitive data at risk.", "Business Impact": "The vulnerability could lead to data theft, system compromise, or financial losses for the organization.", "Technical Impact": "The vulnerability allows attackers to bypass internal network restrictions and access sensitive data, which can be used to compromise the organization's systems and data.", "Mitigation Strategies": "Implementing URL validation and restricting access to internal network resources are effective mitigation strategies.", "Recommendations": "Organizations should prioritize patching and updating to the latest version of mintplex-labs/anything-llm to prevent exploitation of this vulnerability.", "Conclusions": "The organization should take immediate action to patch and update to the latest version of mintplex-labs/anything-llm and review internal network security policies to prevent exploitation of this vulnerability."}}