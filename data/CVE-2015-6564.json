{"id": "CVE-2015-6564", "sourceIdentifier": "cve@mitre.org", "published": "2015-08-24T01:59:01.657", "lastModified": "2022-12-13T12:15:17.677", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Use-after-free vulnerability in the mm_answer_pam_free_ctx function in monitor.c in sshd in OpenSSH before 7.0 on non-OpenBSD platforms might allow local users to gain privileges by leveraging control of the sshd uid to send an unexpectedly early MONITOR_REQ_PAM_FREE_CTX request."}, {"lang": "es", "value": "Vulnerabilidad de uso despu\u00e9s de la liberaci\u00f3n de la memoria en la funci\u00f3n mm_answer_pam_free_ctx en monitor.c en sshd en OpenSSH en versiones anteriores a 7.0 en plataformas no OpenBSD, podr\u00eda permitir a usuarios locales obtener privilegios mediante el aprovechamiento del control del sshd uid para enviar una petici\u00f3n MONITOR_REQ_PAM_FREE_CTX inesperadamente temprana."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.9}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.9", "matchCriteriaId": "27C9A807-7740-4D75-9B01-91ED53D14C40"}]}]}], "references": [{"url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-August/165170.html", "source": "cve@mitre.org"}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2015-09/msg00017.html", "source": "cve@mitre.org"}, {"url": "http://rhn.redhat.com/errata/RHSA-2016-0741.html", "source": "cve@mitre.org"}, {"url": "http://seclists.org/fulldisclosure/2015/Aug/54", "source": "cve@mitre.org"}, {"url": "http://www.openssh.com/txt/release-7.0", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2015/08/22/1", "source": "cve@mitre.org"}, {"url": "http://www.oracle.com/technetwork/topics/security/bulletinjan2016-2867206.html", "source": "cve@mitre.org"}, {"url": "http://www.oracle.com/technetwork/topics/security/linuxbulletinapr2016-2952096.html", "source": "cve@mitre.org"}, {"url": "http://www.oracle.com/technetwork/topics/security/linuxbulletinoct2015-2719645.html", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/76317", "source": "cve@mitre.org"}, {"url": "https://cert-portal.siemens.com/productcert/pdf/ssa-412672.pdf", "source": "cve@mitre.org"}, {"url": "https://github.com/openssh/openssh-portable/commit/5e75f5198769056089fb06c4d738ab0e5abc66f7", "source": "cve@mitre.org"}, {"url": "https://kc.mcafee.com/corporate/index?page=content&id=SB10136", "source": "cve@mitre.org"}, {"url": "https://lists.debian.org/debian-lts-announce/2018/09/msg00010.html", "source": "cve@mitre.org"}, {"url": "https://security.gentoo.org/glsa/201512-04", "source": "cve@mitre.org"}, {"url": "https://www.broadcom.com/support/fibre-channel-networking/security-advisories/brocade-security-advisory-2019-764", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1078", "comment": "CVE-2015-6564 - A use-after-free vulnerability in the mm_answer_pam_free_ctx function in monitor.c in sshd in OpenSSH before 7.0 on non-OpenBSD platforms can allow local users to gain privileges by leveraging control of the sshd uid to send an unexpectedly early MONITOR_REQ_PAM_FREE_CTX request, which relates to the T1078 technique, and defenses can be implemented by applying secure coding practices, such as proper memory management and input validation."}, {"techniqueID": "T1499", "comment": "CVE-2015-6564 - A use-after-free vulnerability in the mm_answer_pam_free_ctx function in monitor.c in sshd in OpenSSH before 7.0 on non-OpenBSD platforms can allow local users to gain privileges by leveraging control of the sshd uid to send an unexpectedly early MONITOR_REQ_PAM_FREE_CTX request, which relates to the T1499 technique, and defenses can be implemented by implementing security patches and updates in a timely manner."}, {"techniqueID": "T1190", "comment": "CVE-2015-6564 - A use-after-free vulnerability in the mm_answer_pam_free_ctx function in monitor.c in sshd in OpenSSH before 7.0 on non-OpenBSD platforms can allow local users to gain privileges by leveraging control of the sshd uid to send an unexpectedly early MONITOR_REQ_PAM_FREE_CTX request, which relates to the T1190 technique, and defenses can be implemented by implementing access controls and privilege escalation, such as using System Hardening."}, {"techniqueID": "T1045", "comment": "CVE-2015-6564 - A use-after-free vulnerability in the mm_answer_pam_free_ctx function in monitor.c in sshd in OpenSSH before 7.0 on non-OpenBSD platforms can allow local users to gain privileges by leveraging control of the sshd uid to send an unexpectedly early MONITOR_REQ_PAM_FREE_CTX request, which relates to the T1045 technique, and defenses can be implemented by implementing memory management and data leaks prevention."}], "stix_bundle": "{\"type\": \"bundle\",\"objects\": [\n{\n\"type\": \"indicator\",\n\"id\": \"Indicator-1234\",\n\"title\": \"OpenSSH before 7.0 Use-after-free Vulnerability\",\n\"description\": \"Description of the CVE\",\n\"modified\": \"2022-12-13T12:15:17.677\"\n},\n{\n\"type\": \"campaign\",\n\"id\": \"Campaign-1234\",\n\"name\": \"OpenSSH before 7.0 Vulnerability Exploitation\",\n\"description\": \"Description of the campaign\",\n\"modified\": \"2022-12-13T12:15:17.677\"\n},\n{\n\"type\": \"incident\",\n\"id\": \"Incident-1234\",\n\"title\": \"OpenSSH before 7.0 Use-after-free Vulnerability Exploitation\",\n\"description\": \"Description of the incident\",\n\"modified\": \"2022-12-13T12:15:17.677\"\n},\n{\n\"type\": \"malware\",\n\"id\": \"Malware-1234\",\n\"name\": \"OpenSSH before 7.0 Use-after-free Vulnerability Exploitation Malware\",\n\"description\": \"Description of the malware\",\n\"modified\": \"2022-12-13T12:15:17.677\"\n},\n{\n\"type\": \"relationship\",\n\"id\": \"Relationship-1234\",\n\"source\": \"Indicator-1234\",\n\"target\": \"Campaign-1234\",\n\"type\": \"indicated_by\",\n\"modified\": \"2022-12-13T12:15:17.677\"\n},\n{\n\"type\": \"relationship\",\n\"id\": \"Relationship-1235\",\n\"source\": \"Campaign-1234\",\n\"target\": \"Incident-1234\",\n\"type\": \"executed_by\",\n\"modified\": \"2022-12-13T12:15:17.677\"\n},\n{\n\"type\": \"relationship\",\n\"id\": \"Relationship-1236\",\n\"source\": \"Incident-1234\",\n\"target\": \"Malware-1234\",\n\"type\": \"involved\",\n\"modified\": \"2022-12-13T12:15:17.677\"\n}\n],\"objects_count\": 6}", "technical_analysis": {"Introduction": "The OpenSSH before 7.0 use-after-free vulnerability (CVE-2015-6564) is a remote code execution vulnerability in the mm_answer_pam_free_ctx function in monitor.c in sshd in OpenSSH before 7.0 on non-OpenBSD platforms.", "Impact and Scope": "The vulnerability has a CVSS score of 6.9 with a medium attack vector, and allows local users to gain privileges by leveraging control of the sshd uid to send an unexpectedly early MONITOR_REQ_PAM_FREE_CTX request.", "Related MITRE ATT&CK Techniques": "The vulnerability relates to the T1078, T1499, T1190, and T1045 techniques.", "Technical Details": "The vulnerability is a use-after-free vulnerability in the mm_answer_pam_free_ctx function in monitor.c in sshd in OpenSSH before 7.0 on non-OpenBSD platforms.", "Detection": "Detection of the vulnerability can be achieved by monitoring system logs and network traffic.", "Mitigation": "Mitigation strategies include implementing security patches and updates in a timely manner, implementing access controls and privilege escalation, and implementing memory management and data leaks prevention.", "Conclusion": "The OpenSSH before 7.0 use-after-free vulnerability is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The OpenSSH before 7.0 use-after-free vulnerability is a critical vulnerability that allows local users to gain privileges by leveraging control of the sshd uid.", "Business Impact": "The vulnerability can result in unauthorized access and malicious activity, which can have significant business and financial impacts.", "Technical Impact": "The vulnerability can result in remote code execution and data breaches, which can have significant technical impacts.", "Mitigation Strategies": "Implementing security patches and updates in a timely manner, implementing access controls and privilege escalation, and implementing memory management and data leaks prevention.", "Recommendations": "Recommendations for executives include prioritizing security patches and updates, implementing access controls and privilege escalation, and implementing memory management and data leaks prevention.", "Conclusions": "The OpenSSH before 7.0 use-after-free vulnerability is a critical vulnerability that requires immediate attention and mitigation. Executives should prioritize security patches and updates, implement access controls and privilege escalation, and implement memory management and data leaks prevention."}}