{"id": "CVE-2007-0166", "sourceIdentifier": "secteam@freebsd.org", "published": "2007-01-11T20:28:00.000", "lastModified": "2008-11-15T06:39:05.280", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The jail rc.d script in FreeBSD 5.3 up to 6.2 does not verify pathnames when writing to /var/log/console.log during a jail start-up, or when file systems are mounted or unmounted, which allows local root users to overwrite arbitrary files, or mount/unmount files, outside of the jail via a symlink attack."}, {"lang": "es", "value": "El script de c\u00e1rcel rc.d en FreeBSD 5.3 hasta to 6.2 no verifica nombres de ruta cuando escribe en /var/log/console.log durante un arranque de c\u00e1rcel, o cuando ficheros del sistema est\u00e1n montados o desmontados, lo cual permite a atacantes remotos sobre-escribir ficheros de su elecci\u00f3n, o montar y desmontar ficheros, fuera de la c\u00e1rcel mediante un ataque de enlaces simb\u00f3licos"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:S/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.6}, "baseSeverity": "MEDIUM", "exploitabilityScore": 2.7, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.2", "matchCriteriaId": "9946D111-48AA-4467-88E2-45BDC951FD52"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:5.3:*:*:*:*:*:*:*", "matchCriteriaId": "D8A80E6A-6502-4A33-83BA-7DCC606D79AA"}]}]}], "references": [{"url": "http://osvdb.org/32726", "source": "secteam@freebsd.org"}, {"url": "http://secunia.com/advisories/23730", "source": "secteam@freebsd.org"}, {"url": "http://security.freebsd.org/advisories/FreeBSD-SA-07:01.jail.asc", "source": "secteam@freebsd.org", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "http://securitytracker.com/id?1017505", "source": "secteam@freebsd.org"}, {"url": "http://www.securityfocus.com/bid/22011", "source": "secteam@freebsd.org"}], "techniques": [{"techniqueID": "TA0001", "comment": "TTPs related to Reconnaissance. In this case, OS command injection could be used to execute system commands, which can be used for reconnaissance purposes. {CVE-2007-0166} - An attacker can execute arbitrary commands on the system without proper verification, which can aid in reconnaissance and provide a foothold for further attacks."}, {"techniqueID": "TA0002", "comment": "TTPs related to Initial Access. The vulnerability can be exploited to gain initial access to the system, executing commands that can be used to maintain persistence, move laterally, or conduct further attacks."}, {"techniqueID": "TA0011", "comment": "TTPs related to Data Encoding. The vulnerability involves unvalidated user input, which can be used to craft malicious inputs to exploit the vulnerability and execute arbitrary commands."}, {"techniqueID": "TA0021", "comment": "TTPs related to Execution. The vulnerability can be exploited to execute arbitrary commands on the system, which can be used to move laterally, conduct further attacks, or maintain persistence."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "cve-2007-0166-stix-bundle", "created_by_ref": "x_x_x", "created": "2022-01-20T10:00:00.000Z"}, "objects": [{"type": "vulnerability", "id": "CVE-2007-0166", "created_by_ref": "x_x_x", "created": "2022-01-20T10:00:00.000Z", "description": [{"lang": "en", "value": "The jail rc.d script in FreeBSD 5.3 up to 6.2 does not verify pathnames when writing to /var/log/console.log during a jail start-up, or when file systems are mounted or unmounted, which allows local root users to overwrite arbitrary files, or mount/unmount files, outside of the jail via a symlink attack."}]}, {"type": "course-of-action", "id": "COA-CVE-2007-0166", "created_by_ref": "x_x_x", "created": "2022-01-20T10:00:00.000Z", "description": [{"lang": "en", "value": "Disable the jail rc.d script or modify it to properly verify pathnames when writing to /var/log/console.log."}]}, {"type": "indicator", "id": "IND-CVE-2007-0166", "created_by_ref": "x_x_x", "created": "2022-01-20T10:00:00.000Z", "description": [{"lang": "en", "value": "Suspicious files or directories outside the jail with names matching /var/log/console.log."}]}], "relationships": [{"sourced_id": "CVE-2007-0166", "target_id": "COA-CVE-2007-0166", "type": "mitigates", "relationship_type": "mitigates"}, {"sourced_id": "COA-CVE-2007-0166", "target_id": "IND-CVE-2007-0166", "type": "relates_to", "relationship_type": "relates_to"}]}, "technical_analysis": {"Introduction": "The vulnerability is an OS command injection vulnerability in the jail rc.d script of FreeBSD 5.3 up to 6.2. This vulnerability can be exploited by local root users to overwrite arbitrary files, mount/unmount files outside of the jail, and execute arbitrary commands.", "Impact and Scope": "The impact of this vulnerability is a complete loss of confidentiality, integrity, and availability. The vulnerability can be exploited by local root users to execute arbitrary commands, allowing for a complete compromise of the system.", "Related MITRE ATT&CK Techniques": "TA0001, TA0002, TA0011, TA0021", "Technical Details": "The vulnerability is caused by the lack of proper verification of pathnames when writing to /var/log/console.log. This allows an attacker to overwrite arbitrary files, mount/unmount files outside of the jail, and execute arbitrary commands.", "Detection": "Detection can be done by monitoring logs for suspicious file access or execution of commands outside of the jail.", "Mitigation": "Mitigation strategies include disabling the jail rc.d script, modifying it to properly verify pathnames, and monitoring logs for suspicious file access or execution of commands outside of the jail.", "Conclusion": "In conclusion, the vulnerability is a significant risk to system security and should be mitigated as soon as possible."}, "executive_analysis": {"Overview": "The vulnerability in the jail rc.d script of FreeBSD 5.3 up to 6.2 can be exploited by local root users to compromise the system.", "Business Impact": "The vulnerability can lead to a complete loss of confidentiality, integrity, and availability, resulting in significant business losses and reputational damage.", "Technical Impact": "The vulnerability can be exploited to execute arbitrary commands, allowing for a complete compromise of the system.", "Mitigation Strategies": "Disable the jail rc.d script, modify it to properly verify pathnames, and monitor logs for suspicious file access or execution of commands outside of the jail.", "Recommendations": "Recommendations include deploying a patch, if available, or implementing a workaround to mitigate the vulnerability.", "Conclusions": "In conclusion, the vulnerability is a significant risk to system security and should be mitigated as soon as possible."}}