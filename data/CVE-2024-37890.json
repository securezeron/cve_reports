{"id": "CVE-2024-37890", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-17T20:15:13.203", "lastModified": "2024-06-20T12:44:22.977", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "ws is an open source WebSocket client and server for Node.js. A request with a number of headers exceeding theserver.maxHeadersCount threshold could be used to crash a ws server. The vulnerability was fixed in ws@8.17.1 (e55e510) and backported to ws@7.5.10 (22c2876), ws@6.2.3 (eeb76d3), and ws@5.2.4 (4abd8f6). In vulnerable versions of ws, the issue can be mitigated in the following ways: 1. Reduce the maximum allowed length of the request headers using the --max-http-header-size=size and/or the maxHeaderSize options so that no more headers than the server.maxHeadersCount limit can be sent. 2. Set server.maxHeadersCount to 0 so that no limit is applied."}, {"lang": "es", "value": "ws es un cliente y servidor WebSocket de c\u00f3digo abierto para Node.js. Una solicitud con una cantidad de encabezados que exceda el umbral server.maxHeadersCount podr\u00eda usarse para bloquear un servidor ws. La vulnerabilidad se solucion\u00f3 en ws@8.17.1 (e55e510) y se actualiz\u00f3 a ws@7.5.10 (22c2876), ws@6.2.3 (eeb76d3) y ws@5.2.4 (4abd8f6). En versiones vulnerables de ws, el problema se puede mitigar de las siguientes maneras: 1. Reduzca la longitud m\u00e1xima permitida de los encabezados de solicitud usando las opciones --max-http-header-size=size y/o maxHeaderSize para que no haya m\u00e1s Se pueden enviar encabezados superiores al l\u00edmite server.maxHeadersCount. 2. Establezca server.maxHeadersCount en 0 para que no se aplique ning\u00fan l\u00edmite."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-476"}]}], "references": [{"url": "https://github.com/websockets/ws/commit/22c28763234aa75a7e1b76f5c01c181260d7917f", "source": "security-advisories@github.com"}, {"url": "https://github.com/websockets/ws/commit/4abd8f6de4b0b65ef80b3ff081989479ed93377e", "source": "security-advisories@github.com"}, {"url": "https://github.com/websockets/ws/commit/e55e5106f10fcbaac37cfa89759e4cc0d073a52c", "source": "security-advisories@github.com"}, {"url": "https://github.com/websockets/ws/commit/eeb76d313e2a00dd5247ca3597bba7877d064a63", "source": "security-advisories@github.com"}, {"url": "https://github.com/websockets/ws/issues/2230", "source": "security-advisories@github.com"}, {"url": "https://github.com/websockets/ws/pull/2231", "source": "security-advisories@github.com"}, {"url": "https://github.com/websockets/ws/security/advisories/GHSA-3h5v-q93c-6h6q", "source": "security-advisories@github.com"}, {"url": "https://nodejs.org/api/http.html#servermaxheaderscount", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1493", "comment": "CVE-2024-37890 - This is an example of a buffer overflow vulnerability in the ws library, allowing an attacker to send a large number of headers to crash the server. To defend against this, set server.maxHeadersCount to 0 to prevent any header limits or reduce the maximum allowed length of request headers."}, {"techniqueID": "T1190", "comment": "CVE-2024-37890 - This is an example of a denial of service vulnerability, allowing an attacker to crash the server by sending a large number of headers. To defend against this, implement rate limiting and add a security layer to limit the number of headers that can be sent."}, {"techniqueID": "T1120", "comment": "CVE-2024-37890 - This is an example of a buffer overflow vulnerability, allowing an attacker to send a large number of headers to crash the server. To defend against this, use a secure web server implementation and implement rate limiting."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "https://example.com/STIX-Bundle", "objects": [{"type": "incident", "id": "https://example.com/Incident-1", "created_by": "user@example.com", "objects": [{"type": "vulnerability", "id": "https://example.com/Vulnerability-1", "description": "Buffer overflow vulnerability in ws library", "platform": "Node.js", "cwe": "476", "cvss_v3": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"}}, {"type": "tool", "id": "https://example.com/Tool-1", "name": "ws library", "version": "8.17.1"}], "attacks": [{"type": "attack_pattern", "id": "https://example.com/Attack-Pattern-1", "name": "Buffer Overflow", "description": "Send a large number of headers to crash the server"}]}], "links": [{"relationship": "related_to", "source": "https://example.com/Incident-1", "target": "https://example.com/Vulnerability-1"}]}, "technical_analysis": {"Introduction": "This is an in-depth analysis of the CVE-2024-37890 buffer overflow vulnerability in the ws library.", "Impact and Scope": "The vulnerability allows an attacker to send a large number of headers to crash the server, affecting the availability of the system. The cvss score is 7.5, with an attack vector of NETWORK and an attack complexity of LOW.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including T1493, T1190, and T1120.", "Technical Details": "The vulnerability occurs when a large number of headers are sent to the server, causing a buffer overflow and allowing the attacker to crash the server.", "Detection": "The vulnerability can be detected by monitoring for unusual network traffic patterns and implementing rate limiting to prevent large numbers of headers from being sent.", "Mitigation": "The vulnerability can be mitigated by setting server.maxHeadersCount to 0 to prevent any header limits or reducing the maximum allowed length of request headers.", "Conclusion": "In conclusion, the CVE-2024-37890 buffer overflow vulnerability in the ws library is a high-impact vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "This vulnerability is a high-priority security issue that requires immediate attention and mitigation.", "Business Impact": "The vulnerability has a significant impact on the business, as it can cause the server to crash and affect the availability of the system.", "Technical Impact": "The vulnerability has a technical impact on the system, as it requires a patch to fix and potentially affects system performance.", "Mitigation Strategies": "Recommend implementing rate limiting and adding a security layer to limit the number of headers that can be sent.", "Recommendations": "Recommend prioritizing the mitigation of this vulnerability and assessing the impact on the business.", "Conclusions": "In conclusion, this vulnerability requires immediate attention and mitigation to protect the system and the business."}}