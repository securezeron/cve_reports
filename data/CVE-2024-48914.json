{
    "id": "CVE-2024-48914",
    "sourceIdentifier": "security-advisories@github.com",
    "published": "2024-10-15T16:15:06.270",
    "lastModified": "2024-10-16T16:38:43.170",
    "vulnStatus": "Awaiting Analysis",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "Vendure is an open-source headless commerce platform. Prior to versions 3.0.5 and 2.3.3, a vulnerability in Vendure's asset server plugin allows an attacker to craft a request which is able to traverse the server file system and retrieve the contents of arbitrary files, including sensitive data such as configuration files, environment variables, and other critical data stored on the server. In the same code path is an additional vector for crashing the server via a malformed URI. Patches are available in versions 3.0.5 and 2.3.3. Some workarounds are also available. One may use object storage rather than the local file system, e.g. MinIO or S3, or define middleware which detects and blocks requests with urls containing `/../`."
        },
        {
            "lang": "es",
            "value": "Vendure es una plataforma de comercio sin interfaz gr\u00e1fica de c\u00f3digo abierto. Antes de las versiones 3.0.5 y 2.3.3, una vulnerabilidad en el complemento de servidor de activos de Vendure permit\u00eda a un atacante crear una solicitud que pudiera atravesar el sistema de archivos del servidor y recuperar el contenido de archivos arbitrarios, incluidos datos confidenciales como archivos de configuraci\u00f3n, variables de entorno y otros datos cr\u00edticos almacenados en el servidor. En la misma ruta de c\u00f3digo hay un vector adicional para hacer que el servidor se bloquee mediante una URL mal formada. Hay parches disponibles en las versiones 3.0.5 y 2.3.3. Tambi\u00e9n hay algunos workarounds disponibles. Se puede utilizar el almacenamiento de objetos en lugar del sistema de archivos local, por ejemplo, MinIO o S3, o definir un middleware que detecte y bloquee las solicitudes con URL que contengan `/../`."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "security-advisories@github.com",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H",
                    "baseScore": 9.1,
                    "baseSeverity": "CRITICAL",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "NONE",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 3.9,
                "impactScore": 5.2
            }
        ]
    },
    "weaknesses": [
        {
            "source": "security-advisories@github.com",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-20"
                },
                {
                    "lang": "en",
                    "value": "CWE-22"
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https://github.com/vendure-ecommerce/vendure/blob/801980e8f599c28c5059657a9d85dd03e3827992/packages/asset-server-plugin/src/plugin.ts#L352-L358",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://github.com/vendure-ecommerce/vendure/commit/e2ee0c43159b3d13b51b78654481094fdd4850c5",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://github.com/vendure-ecommerce/vendure/commit/e4b58af6822d38a9c92a1d8573e19288b8edaa1c",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://github.com/vendure-ecommerce/vendure/security/advisories/GHSA-r9mq-3c9r-fmjq",
            "source": "security-advisories@github.com"
        }
    ],
    "techniques": [
        {
            "techniqueID": "T1027",
            "comment": "CVE-2024-48914 - An attacker can exploit this vulnerability to traverse the server file system and retrieve sensitive data, which is a common technique used for data exfiltration. Defending against this involves monitoring and blocking suspicious file access requests."
        },
        {
            "techniqueID": "T1210",
            "comment": "CVE-2024-48914 - An attacker can also use this vulnerability to crash the server, which is a denial-of-service attack technique. Defending against this involves implementing measures to prevent and detect such attacks, such as rate limiting and anomaly detection."
        },
        {
            "techniqueID": "T1190",
            "comment": "CVE-2024-48914 - This vulnerability can be used as an initial access technique, allowing an attacker to gain unauthorized access to the server. Defending against this involves implementing robust access controls and monitoring for suspicious activity."
        }
    ],
    "stix_bundle": "{\"type\":\"bundle\",\"id\":\"CVE-2024-48914\",\"objects\":[{\"type\":\"indicator\",\"id\":\"T1027\",\"createdBy\":\"CyberSecurity\",\"modified\":\"1643723100\",\"name\":\"Traversing File System\",\"description\":\"An attacker can exploit this vulnerability to traverse the server file system and retrieve sensitive data.\",\"first_seen\":\"1643723100\",\"last_seen\":\"1643723100\",\"touches\":{\"node\":\"linux_file_system\"}},{\"type\":\"indicator\",\"id\":\"T1210\",\"createdBy\":\"CyberSecurity\",\"modified\":\"1643723100\",\"name\":\"Crashing Server\",\"description\":\"An attacker can also use this vulnerability to crash the server, which is a denial-of-service attack technique.\",\"first_seen\":\"1643723100\",\"last_seen\":\"1643723100\",\"touches\":{\"node\":\"server_crash\"}},{\"type\":\"indicator\",\"id\":\"T1190\",\"createdBy\":\"CyberSecurity\",\"modified\":\"1643723100\",\"name\":\"Initial Access\",\"description\":\"This vulnerability can be used as an initial access technique, allowing an attacker to gain unauthorized access to the server.\",\"first_seen\":\"1643723100\",\"last_seen\":\"1643723100\",\"touches\":{\"node\":\"unauthorized_access\"}}]}.",
    "technical_analysis": {
        "Introduction": "Vendure is an open-source headless commerce platform that has been found to have a vulnerability in its asset server plugin, allowing an attacker to traverse the server file system and retrieve sensitive data.",
        "Impact and Scope": "The vulnerability has a CVSS score of 9.1 (3.1) and affects versions prior to 3.0.5 and 2.3.3. It allows an attacker to retrieve sensitive data and crash the server.",
        "Related MITRE ATT&CK Techniques": "The vulnerability can be used to execute T1027, T1210, and T1190.",
        "Technical Details": "The vulnerability is caused by a lack of proper validation of user input in the asset server plugin, allowing an attacker to craft a request that traverses the server file system.",
        "Detection": "Detection involves monitoring for suspicious file access requests and anomaly detection.",
        "Mitigation": "Mitigation involves patching affected versions, defining middleware to detect and block malicious requests, and using object storage instead of the local file system.",
        "Conclusion": "The vulnerability is a high-risk vulnerability that requires immediate attention and mitigation."
    },
    "executive_analysis": {
        "Overview": "Vendure has a critical vulnerability in its asset server plugin that allows unauthorized access to sensitive data and server crashes.",
        "Business Impact": "Business operations may be disrupted, and sensitive business information may be compromised.",
        "Technical Impact": "The vulnerability allows an attacker to gain unauthorized access to the server and retrieve sensitive data.",
        "Mitigation Strategies": "Implement patches, define middleware, and use object storage.",
        "Recommendations": "Prioritize patching and implementing mitigation strategies.",
        "Conclusions": "Immediate mitigation is required to prevent exploitation of this vulnerability."
    }
}