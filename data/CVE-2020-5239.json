{"id": "CVE-2020-5239", "sourceIdentifier": "security-advisories@github.com", "published": "2020-02-13T01:15:11.047", "lastModified": "2020-02-18T19:35:44.453", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Mailu before version 1.7, an authenticated user can exploit a vulnerability in Mailu fetchmail script and gain full access to a Mailu instance. Mailu servers that have open registration or untrusted users are most impacted. The master and 1.7 branches are patched on our git repository. All Docker images published on docker.io/mailu for tags 1.5, 1.6, 1.7 and master are patched. For detailed instructions about patching and securing the server afterwards, see https://github.com/Mailu/Mailu/issues/1354"}, {"lang": "es", "value": "En Mailu versiones anteriores a 1.7, un usuario autenticado puede explotar una vulnerabilidad en el script fetchmail de Mailu y obtener acceso completo a una instancia de Mailu. Los servidores de Mailu que tienen registro abierto o usuarios no confiables son los m\u00e1s afectados. El master y las derivaciones versi\u00f3n 1.7 est\u00e1n parcheadas en nuestro repositorio git. Todas las im\u00e1genes publicadas de Docker en docker.io/mailu para las etiquetas 1.5, 1.6, 1.7 y master est\u00e1n parcheadas. Para obtener instrucciones detalladas sobre c\u00f3mo parchar y proteger el servidor posteriormente, consulte https://github.com/Mailu/Mailu/issues/1354"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.3, "impactScore": 5.8}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-863"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mailu:mailu:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.7", "matchCriteriaId": "5CD1E230-BB0F-4184-84B0-A67EAA9D97B0"}]}]}], "references": [{"url": "https://github.com/Mailu/Mailu/issues/1354", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/Mailu/Mailu/security/advisories/GHSA-2467-p5gv-58q6", "source": "security-advisories@github.com", "tags": ["Mitigation", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059.002: Remote System Discovery (Mailu)", "comment": "CVE-2020-5239 - Remote system discovery attack via Mailu's fetchmail script, using an authenticated user's credentials"}, {"techniqueID": "T1027: Obfuscated Files or Information", "comment": "CVE-2020-5239 - Mailu's fetchmail script can be obfuscated to evade detection, making it harder for security controls to identify the vulnerability"}, {"techniqueID": "T1210: Exploitation of Remote Services", "comment": "CVE-2020-5239 - Remote exploitation of Mailu's fetchmail script by an authenticated user, allowing for further attacks"}, {"techniqueID": "T1024: Service Identity Authentication", "comment": "CVE-2020-5239 - Authentication bypass using Mailu's fetchmail script, allowing unauthorized access to the Mailu instance"}, {"techniqueID": "T1077: Windows Service Discovery", "comment": "CVE-2020-5239 - Discovery of vulnerable Mailu instances on the network, using an authenticated user's credentials"}, {"techniqueID": "T1218: Signed Binary Proxy Execution", "comment": "CVE-2020-5239 - Use of Mailu's fetchmail script to execute malicious commands with elevated privileges, bypassing security controls"}], "stix_bundle": {"id": "https://example.com/cve-2020-5239", "type": "Bundle", "label": "CVE-2020-5239 - Mailu Fetchmail Script Vulnerability", "description": "A bundle expressing the related techniques, risks, and defense strategies for this CVE.", "objects": [{"id": "https://example.com/vulnerability/cve-2020-5239", "type": "Vulnerability", "description": "Mailu Fetchmail Script Vulnerability", "severity": "HIGH", "exploitability_score": 8.8, "impact_score": 5.9}, {"id": "https://example.com/attack-pattern/T1059.002", "type": "Attack-Pattern", "name": "Remote System Discovery", "description": "An attacker uses a vulnerability in a remote system to gather information about the system or its configuration."}, {"id": "https://example.com/attack-pattern/T1027", "type": "Attack-Pattern", "name": "Obfuscated Files or Information", "description": "An attacker conceals their malicious activity by using obfuscation techniques to make their files or information difficult to detect."}, {"id": "https://example.com/attack-pattern/T1210", "type": "Attack-Pattern", "name": "Exploitation of Remote Services", "description": "An attacker exploits a vulnerability in a remote service to gain access to the system or to launch further attacks."}, {"id": "https://example.com/attack-pattern/T1024", "type": "Attack-Pattern", "name": "Service Identity Authentication", "description": "An attacker authenticates to a system or service using a stolen or guessable identity."}, {"id": "https://example.com/course-of-action/Course-Of-Action-1", "type": "Course-Of-Action", "description": "Update Mailu to a patched version", "related_technique": "https://example.com/attack-pattern/T1059.002"}, {"id": "https://example.com/course-of-action/Course-Of-Action-2", "type": "Course-Of-Action", "description": "Disable Mailu's fetchmail script", "related_technique": "https://example.com/attack-pattern/T1027"}]}, "technical_analysis": {"Introduction": "The Mailu fetchmail script vulnerability is a critical remote code execution vulnerability that allows an authenticated user to exploit the system.", "Impact and Scope": "The vulnerability allows an attacker to gain full access to the Mailu instance, with a CVSS score of 8.8 and a high attack vector.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1059.002, T1027, T1210, T1024, and T1077", "Technical Details": "The vulnerability exists in Mailu's fetchmail script, which is executed by authenticated users. The script can be exploited to execute arbitrary commands with elevated privileges.", "Detection": "Detection of the vulnerability can be done by monitoring for unusual network traffic and system logs.", "Mitigation": "The vulnerability can be mitigated by updating Mailu to a patched version and disabling the fetchmail script.", "Conclusion": "The Mailu fetchmail script vulnerability is a critical vulnerability that requires immediate attention. Updating Mailu to a patched version and disabling the fetchmail script are the recommended mitigation strategies."}, "executive_analysis": {"Overview": "The Mailu fetchmail script vulnerability is a critical vulnerability that allows an attacker to gain full access to the Mailu instance.", "Business Impact": "The vulnerability can lead to significant data compromise and business disruption.", "Technical Impact": "The vulnerability can be exploited to execute arbitrary commands with elevated privileges.", "Mitigation Strategies": "The recommended mitigation strategies are updating Mailu to a patched version and disabling the fetchmail script.", "Recommendations": "Executives should implement the recommended mitigation strategies and monitor for unusual network traffic and system logs.", "Conclusions": "The Mailu fetchmail script vulnerability is a critical vulnerability that requires immediate attention. Executives should prioritize the implementation of the recommended mitigation strategies."}}