{"id": "CVE-2020-17519", "sourceIdentifier": "security@apache.org", "published": "2021-01-05T12:15:12.680", "lastModified": "2024-08-14T20:09:41.593", "vulnStatus": "Analyzed", "cveTags": [], "cisaExploitAdd": "2024-05-23", "cisaActionDue": "2024-06-13", "cisaRequiredAction": "Apply mitigations per vendor instructions or discontinue use of the product if mitigations are unavailable.", "cisaVulnerabilityName": "Apache Flink Improper Access Control Vulnerability", "descriptions": [{"lang": "en", "value": "A change introduced in Apache Flink 1.11.0 (and released in 1.11.1 and 1.11.2 as well) allows attackers to read any file on the local filesystem of the JobManager through the REST interface of the JobManager process. Access is restricted to files accessible by the JobManager process. All users should upgrade to Flink 1.11.3 or 1.12.0 if their Flink instance(s) are exposed. The issue was fixed in commit b561010b0ee741543c3953306037f00d7a9f0801 from apache/flink:master."}, {"lang": "es", "value": "Un cambio introducido en Apache Flink versi\u00f3n 1.11.0 (y lanzado en versiones 1.11.1 y 1.11.2 tambi\u00e9n) permite a atacantes leer cualquier archivo en el sistema de archivos local de JobManager por medio de la interfaz REST del proceso JobManager.&#xa0;El acceso est\u00e1 restringido a los archivos accesibles por medio del proceso de JobManager.&#xa0;Todos los usuarios deben actualizar a Flink versi\u00f3n 1.11.3 o 1.12.0 si sus instancias de Flink est\u00e1n expuestas.&#xa0;El problema se corrigi\u00f3 en el commit b561010b0ee741543c3953306037f00d7a9f0801 de apache/flink:master"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-552"}]}, {"source": "security@apache.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-552"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:flink:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.11.0", "versionEndExcluding": "1.11.3", "matchCriteriaId": "17DBFDC8-023D-4816-97AB-88F17ABB2CFC"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/160849/Apache-Flink-1.11.0-Arbitrary-File-Read-Directory-Traversal.html", "source": "security@apache.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.openwall.com/lists/oss-security/2021/01/05/2", "source": "security@apache.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.apache.org/thread.html/r0a433be10676f4fe97ca423d08f914e0ead341c901216f292d2bbe83%40%3Cissues.flink.apache.org%3E", "source": "security@apache.org", "tags": ["Mailing List"]}, {"url": "https://lists.apache.org/thread.html/r1125f3044a0946d1e7e6f125a6170b58d413ebd4a95157e4608041c7%40%3Cannounce.apache.org%3E", "source": "security@apache.org", "tags": ["Mailing List"]}, {"url": "https://lists.apache.org/thread.html/r229167538863518738e02f4c1c5a8bb34c1d45dadcc97adf6676b0c1%40%3Cdev.flink.apache.org%3E", "source": "security@apache.org", "tags": ["Issue Tracking"]}, {"url": "https://lists.apache.org/thread.html/r26fcdd4fe288323006253437ebc4dd6fdfadfb5e93465a0e4f68420d%40%3Cuser-zh.flink.apache.org%3E", "source": "security@apache.org", "tags": ["Issue Tracking"]}, {"url": "https://lists.apache.org/thread.html/r28f17e564950d663e68cc6fe75756012dda62ac623766bb9bc5e7034%40%3Cissues.flink.apache.org%3E", "source": "security@apache.org", "tags": ["Issue Tracking"]}, {"url": "https://lists.apache.org/thread.html/r2fc60b30557e4a537c2a6293023049bd1c49fd92b518309aa85a0398%40%3Cissues.flink.apache.org%3E", "source": "security@apache.org", "tags": ["Issue Tracking"]}, {"url": "https://lists.apache.org/thread.html/r4e1b72bfa789ea5bc20b8afe56119200ed25bdab0eb80d664fa5bfe2%40%3Cdev.flink.apache.org%3E", "source": "security@apache.org", "tags": ["Vendor Advisory"]}, {"url": "https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d%40%3Cannounce.apache.org%3E", "source": "security@apache.org", "tags": ["Vendor Advisory"]}, {"url": "https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d%40%3Cdev.flink.apache.org%3E", "source": "security@apache.org", "tags": ["Mailing List", "Vendor Advisory"]}, {"url": "https://lists.apache.org/thread.html/r6843202556a6d0bce9607ebc02e303f68fc88e9038235598bde3b50d%40%3Cuser.flink.apache.org%3E", "source": "security@apache.org", "tags": ["Issue Tracking"]}, {"url": "https://lists.apache.org/thread.html/r88b55f3ebf1f8f4e1cc61f030252aaef4b77060b56557a243abb92a1%40%3Cissues.flink.apache.org%3E", "source": "security@apache.org", "tags": ["Vendor Advisory"]}, {"url": "https://lists.apache.org/thread.html/r88f427865fb6aa6e6378efe07632a1906b430365e15e3b9621aabe1d%40%3Cissues.flink.apache.org%3E", "source": "security@apache.org", "tags": ["Vendor Advisory"]}, {"url": "https://lists.apache.org/thread.html/r90890afea72a9571d666820b2fe5942a0a5f86be406fa31da3dd0922%40%3Cannounce.apache.org%3E", "source": "security@apache.org", "tags": ["Not Applicable"]}, {"url": "https://lists.apache.org/thread.html/ra8c96bf3ccb4e491f9ce87ba35f134b4449beb2a38d1ce28fd89001f%40%3Cdev.flink.apache.org%3E", "source": "security@apache.org", "tags": ["Issue Tracking"]}], "techniques": [{"techniqueID": "T1133", "comment": "This technique could be used to exploit the Apache Flink Improper Access Control Vulnerability by reading arbitrary files on the JobManager's local filesystem. It is relevant in this case because an attacker could use this technique to access sensitive information or cause data breaches. Defending against this technique involves installing patches, disabling unnecessary services, and configuring permissions and access controls."}], "stix_bundle": {"type": "bundle", "id": "bundle-12345", "spec_version": "2.1", "contents": [{"type": "vulnerability", "id": "vuln-12345", "created_by_ref": "user-1", "modified": "2021-01-05T12:15:12.680", "name": "Apache Flink Improper Access Control Vulnerability", "description": "A change introduced in Apache Flink 1.11.0 (and released in 1.11.1 and 1.11.2 as well) allows attackers to read any file on the local filesystem of the JobManager through the REST interface of the JobManager process.", "severity": "high", "impact": "high", "cvssv3 vectors": ["CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"], "references": [{"type": "reference", "id": "ref-12345", "href": "http://packetstormsecurity.com/files/160849/Apache-Flink-1.11.0-Arbitrary-File-Read-Directory-Traversal.html"}]}, {"type": "tactic", "id": "tactic-12345", "name": "Lateral Movement", "description": "The attacker uses this technique to move laterally in the network in order to reach the JobManager process and exploit the vulnerability."}, {"type": "technique", "id": "technique-12345", "name": "Command and Control", "description": "The attacker uses this technique to establish a command and control channel with the compromised system and download malware from the internet."}, {"type": "course-of-action", "id": "coa-12345", "name": "Patch Installation", "description": "Install the patch to fix the Apache Flink Improper Access Control Vulnerability.", "technique_ref": "technique-12345"}]}, "technical_analysis": {"Introduction": "The Apache Flink Improper Access Control Vulnerability is a remote code execution vulnerability that affects the Apache Flink system.", "Impact and Scope": "The vulnerability has a CVSSv3 score of 7.5 and can allow an attacker to read any file on the local filesystem of the JobManager process.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to T1133: Exploit Public-Facing Application.", "Technical Details": "The vulnerability is due to a change introduced in Apache Flink 1.11.0 (and released in 1.11.1 and 1.11.2 as well) that allows attackers to read any file on the local filesystem of the JobManager through the REST interface of the JobManager process.", "Detection": "Detect the vulnerability by monitoring for unexpected access to the JobManager process and checking for the presence of malicious code.", "Mitigation": "Install the patch to fix the Apache Flink Improper Access Control Vulnerability, disable unnecessary services, and configure permissions and access controls.", "Conclusion": "The Apache Flink Improper Access Control Vulnerability is a serious vulnerability that can allow an attacker to gain unauthorized access to sensitive information. Installing the patch and configuring permissions and access controls are crucial to mitigating this vulnerability."}, "executive_analysis": {"Overview": "The Apache Flink Improper Access Control Vulnerability is a critical vulnerability that can allow an attacker to gain unauthorized access to sensitive information.", "Business Impact": "This vulnerability can have a significant business impact if it is exploited, potentially leading to data breaches, financial losses, and reputational damage.", "Technical Impact": "The vulnerability has a technical impact on the Apache Flink system, requiring patches and configuration changes to mitigate.", "Mitigation Strategies": "To mitigate this vulnerability, install the patch, disable unnecessary services, and configure permissions and access controls.", "Recommendations": "Recommend that administrators install the patch and configure permissions and access controls to mitigate this vulnerability.", "Conclusions": "The Apache Flink Improper Access Control Vulnerability is a critical vulnerability that requires prompt mitigation to prevent unauthorized access to sensitive information."}}