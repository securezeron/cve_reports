{"id": "CVE-2020-2497", "sourceIdentifier": "security@qnapsecurity.com.tw", "published": "2020-12-10T04:15:11.987", "lastModified": "2021-06-22T21:00:59.687", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "If exploited, this cross-site scripting vulnerability could allow remote attackers to inject malicious code in System Connection Logs. QANP have already fixed these vulnerabilities in the following versions of QTS and QuTS hero. QuTS hero h4.5.1.1472 build 20201031 and later QTS 4.5.1.1456 build 20201015 and later QTS 4.4.3.1354 build 20200702 and later QTS 4.3.6.1333 build 20200608 and later QTS 4.3.4.1368 build 20200703 and later QTS 4.3.3.1315 build 20200611 and later QTS 4.2.6 build 20200611 and later"}, {"lang": "es", "value": "Si era explotada, esta vulnerabilidad de tipo cross-site scripting podr\u00eda permitir a atacantes remotos inyectar c\u00f3digo malicioso en System Connection Logs.&#xa0;QNAP ya ha corregido estas vulnerabilidades en las siguientes versiones de QTS y QuTS hero.&#xa0;QuTS hero versi\u00f3n h4.5.1.1472 build 20201031 y posterior, QTS versi\u00f3n 4.5.1.1456 build 20201015 y posterior, QTS versi\u00f3n 4.4.3.1354 build 20200702 y posterior, QTS versi\u00f3n 4.3.6.1333 build 20200608 y posterior, QTS versi\u00f3n 4.3.4.1368 build 20200703 y posterior, QTS versi\u00f3n 4.3.3.1315 build 20200611 y posterior, QTS versi\u00f3n 4.2.6 build 20200611 y posterior"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security@qnapsecurity.com.tw", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}, {"lang": "en", "value": "CWE-80"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:quts_hero:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.5.1.1472", "matchCriteriaId": "ACABFEAE-2A93-4E81-9F73-706FEE68C1DF"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:qts:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.5.1.1456", "matchCriteriaId": "0DF58F11-5E71-4EFB-8039-B4EA21C2C810"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:qts:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.4.3.1354", "matchCriteriaId": "5C993531-A910-4F15-ABD3-31261D560C76"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:qts:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.3.6.1333", "matchCriteriaId": "CED08145-C2CF-484B-B66D-5469591040E8"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:qts:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.3.4.1368", "matchCriteriaId": "BA15CC08-00FA-4682-8DD9-0B1AF10E40E7"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:qts:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.3.3.1315", "matchCriteriaId": "87533C7A-38F8-4487-A753-EBB911F2A76C"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:qts:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.2.6", "matchCriteriaId": "3777F6CC-9189-4BC0-B336-62BA1EFB91A7"}]}]}], "references": [{"url": "https://www.qnap.com/en/security-advisory/qsa-20-12", "source": "security@qnapsecurity.com.tw", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-2497 - This is a cross-site scripting vulnerability, T1190 is a common attack vector used to exploit these types of vulnerabilities."}, {"techniqueID": "T1068", "comment": "CVE-2020-2497 - This is a cross-site scripting vulnerability, T1068 is another attack vector used to exploit these types of vulnerabilities."}, {"techniqueID": "T1204", "comment": "CVE-2020-2497 - This is a cross-site scripting vulnerability, T1204 is a technique used to inject malicious code in System Connection Logs."}, {"techniqueID": "T1043", "comment": "CVE-2020-2497 - This is a cross-site scripting vulnerability, T1043 is a technique used to inject malicious code remotely."}], "stix_bundle": {"objects": [{"id": "vulnerability:CVE-2020-2497", "type": "vulnerability", "name": "CVE-2020-2497: QNAP QTS and QuTS hero Cross-Site Scripting Vulnerability", "description": [{"lang": "en", "value": "CVE-2020-2497: QNAP QTS and QuTS hero Cross-Site Scripting Vulnerability"}], "scores": {"cvssV3": {"base_score": 6.1, "base_severity": "MEDIUM", "exploitability_score": 2.8, "impact_score": 2.7}, "cvssV2": {"base_score": 4.3, "base_severity": "MEDIUM", "exploitability_score": 8.6, "impact_score": 2.9}}, "risk_stix_objects": {"objects": []}, "related_modules": {"objects": []}}], "relationship": [{"id": "vulnerability:CVE-2020-2497", "type": "has-part", "object_ref": "technique:T1190"}, {"id": "vulnerability:CVE-2020-2497", "type": "has-part", "object_ref": "technique:T1068"}, {"id": "vulnerability:CVE-2020-2497", "type": "has-part", "object_ref": "technique:T1204"}, {"id": "vulnerability:CVE-2020-2497", "type": "has-part", "object_ref": "technique:T1043"}]}, "technical_analysis": {"Introduction": "CVE-2020-2497 is a cross-site scripting vulnerability in QNAP QTS and QuTS hero. This vulnerability allows remote attackers to inject malicious code in System Connection Logs.", "Impact and Scope": "This vulnerability has a CVSS score of 6.1 (MEDIUM). The attack vector is NETWORK, and user interaction is required.", "Related MITRE ATT&CK Techniques": "T1190, T1068, T1204, and T1043 are all related to this vulnerability.", "Technical Details": "This vulnerability occurs when user input is not properly sanitized, allowing attackers to inject malicious code in System Connection Logs.", "Detection": "Detection methods include monitoring for unusual activity in System Connection Logs and monitoring for JavaScript injection.", "Mitigation": "Mitigation strategies include updating to patched versions of QNAP QTS and QuTS hero, disabling JavaScript injection in System Connection Logs, and monitoring for suspicious activity.", "Conclusion": "CVE-2020-2497 is a significant vulnerability in QNAP QTS and QuTS hero. It is recommended that users update to patched versions and monitor for suspicious activity."}, "executive_analysis": {"Overview": "CVE-2020-2497 is a cross-site scripting vulnerability in QNAP QTS and QuTS hero. This vulnerability allows remote attackers to inject malicious code in System Connection Logs.", "Business Impact": "This vulnerability has significant business impact, including potential compromise of sensitive data and disruption of business operations.", "Technical Impact": "This vulnerability has significant technical impact, including the potential for attackers to inject malware and disrupt system functionality.", "Mitigation Strategies": "Update to patched versions of QNAP QTS and QuTS hero, disable JavaScript injection in System Connection Logs, and monitor for suspicious activity.", "Recommendations": "It is recommended that users update to patched versions of QNAP QTS and QuTS hero and monitor for suspicious activity.", "Conclusions": "CVE-2020-2497 is a critical vulnerability that requires immediate attention and action."}}