{"id": "CVE-2024-28189", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-18T15:15:29.480", "lastModified": "2024-04-18T18:25:55.267", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Judge0 is an open-source online code execution system. The application uses the UNIX chown command on an untrusted file within the sandbox. An attacker can abuse this by creating a symbolic link (symlink) to a file outside the sandbox, allowing the attacker to run chown on arbitrary files outside of the sandbox. This vulnerability is not impactful on it's own, but it can be used to bypass the patch for CVE-2024-28185 and obtain a complete sandbox escape. This vulnerability is fixed in 1.13.1."}, {"lang": "es", "value": "Judge0 es un sistema de ejecuci\u00f3n de c\u00f3digo en l\u00ednea de c\u00f3digo abierto. La aplicaci\u00f3n utiliza el comando chown de UNIX en un archivo que no es de confianza dentro del entorno limitado. Un atacante puede abusar de esto creando un enlace simb\u00f3lico (enlace simb\u00f3lico) a un archivo fuera del entorno sandbox, lo que le permite ejecutar chown en archivos arbitrarios fuera del entorno sandbox. Esta vulnerabilidad no tiene un impacto por s\u00ed sola, pero se puede utilizar para omitir el parche CVE-2024-28185 y obtener un escape completo de la zona de pruebas. Esta vulnerabilidad se solucion\u00f3 en 1.13.1."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-59"}, {"lang": "en", "value": "CWE-61"}]}], "references": [{"url": "https://github.com/judge0/judge0/blob/v1.13.0/app/jobs/isolate_job.rb#L232", "source": "security-advisories@github.com"}, {"url": "https://github.com/judge0/judge0/commit/f3b8547b3b67863e4ea0ded3adcb963add56addd", "source": "security-advisories@github.com"}, {"url": "https://github.com/judge0/judge0/security/advisories/GHSA-3xpw-36v7-2cmg", "source": "security-advisories@github.com"}, {"url": "https://github.com/judge0/judge0/security/advisories/GHSA-h9g2-45c8-89cf", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210: Exploit Public-Facing Application", "comment": "CVE-2024-28189 - An attacker can exploit the vulnerability by creating a symbolic link to a file outside the sandbox, allowing them to run chown on arbitrary files outside of the sandbox. This can be used to bypass the patch for CVE-2024-28185 and obtain a complete sandbox escape."}, {"techniqueID": "T1190: Path Manipulation", "comment": "CVE-2024-28189 - An attacker can manipulate the path to a file outside the sandbox by creating a symbolic link, allowing them to read/write files outside of the sandbox."}], "stix_bundle": {"Bundle": {"id": "ed4543c0-bf4f-47db-8f15-f94e3b9d25c3", "type": "bundle", "name": "Judge0 CVE-2024-28189 Security Advisory", "created_by_ref": "https://example.com/john.doe", "created": "2024-04-18T15:15:29.480", "modified": "2024-04-18T18:25:55.267", "objects": [{"id": "f3b8547b-3b67-863e-4ea0-ded3-adcb963add56", "type": "vulnerability", "name": "CVE-2024-28189: Judge0 Chown Vulnerability", "description": "Judge0 is an open-source online code execution system. The application uses the UNIX chown command on an untrusted file within the sandbox. An attacker can abuse this by creating a symbolic link (symlink) to a file outside the sandbox, allowing the attacker to run chown on arbitrary files outside of the sandbox.", "published": "2024-04-18T15:15:29.480", "last_modified": "2024-04-18T18:25:55.267", "cvss_score": 10.0, "attack_vector": "NETWORK", "attack_complexity": "LOW", "privileges_required": "NONE", "user_interaction": "NONE", "scope": "CHANGED", "confidentiality_impact": "HIGH", "integrity_impact": "HIGH", "availability_impact": "HIGH"}, {"id": "2afa43c0-2f4f-47db-8f15-f94e3b9d25c3", "type": "course_of_action", "name": "Apply patch 1.13.1", "description": "Apply the patch 1.13.1 to fix the vulnerability", "mitigates": {"relationship": "mitigates", "target_ref": "f3b8547b-3b67-863e-4ea0-ded3-adcb963add56"}}], "relationship": []}}, "technical_analysis": {"Introduction": "Judge0 is an open-source online code execution system that uses the UNIX chown command on an untrusted file within the sandbox. This vulnerability allows an attacker to create a symbolic link (symlink) to a file outside the sandbox, allowing them to run chown on arbitrary files outside of the sandbox.", "Impact and Scope": "The impact of this vulnerability is HIGH, with a CVSS score of 10.0. The attack vector is NETWORK, and the attack complexity is LOW.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1210: Exploit Public-Facing Application and T1190: Path Manipulation.", "Technical Details": "The vulnerability occurs when an attacker creates a symbolic link to a file outside the sandbox, allowing them to run chown on arbitrary files outside of the sandbox.", "Detection": "Detection can be done by monitoring the system calls for the chown command and detecting any unusual behavior.", "Mitigation": "The mitigation for this vulnerability is to apply the patch 1.13.1, which fixes the issue.", "Conclusion": "In conclusion, the CVE-2024-28189 vulnerability is a severe security issue that requires immediate attention. The recommended mitigation is to apply the patch 1.13.1."}, "executive_analysis": {"Overview": "The CVE-2024-28189 vulnerability is a critical security issue that affects Judge0, an open-source online code execution system.", "Business Impact": "The business impact of this vulnerability is significant, as it allows an attacker to obtain a complete sandbox escape and potentially gain unauthorized access to sensitive data.", "Technical Impact": "The technical impact of this vulnerability is severe, as it allows an attacker to manipulate the path to a file outside the sandbox, allowing them to read/write files outside of the sandbox.", "Mitigation Strategies": "The recommended mitigation strategy is to apply the patch 1.13.1, which fixes the issue.", "Recommendations": "We recommend that organizations using Judge0 apply the patch 1.13.1 as soon as possible to mitigate this vulnerability.", "Conclusions": "In conclusion, the CVE-2024-28189 vulnerability is a critical security issue that requires immediate attention. Organizations using Judge0 should take immediate action to mitigate this vulnerability."}}