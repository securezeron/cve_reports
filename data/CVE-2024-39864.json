{"id": "CVE-2024-39864", "sourceIdentifier": "security@apache.org", "published": "2024-07-05T14:15:03.203", "lastModified": "2024-07-08T15:47:10.990", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The CloudStack integration API service allows running its unauthenticated API server (usually on port 8096 when configured and enabled via integration.api.port global setting) for internal portal integrations and for testing purposes. By default, the integration API service port is disabled and is considered disabled when integration.api.port is set to 0 or negative. Due to an improper initialisation logic, the integration API service would listen on a random port when its port value is set to 0 (default value).\u00a0An attacker that can access the CloudStack management network could scan and find the randomised integration API service port and exploit it to perform unauthorised administrative actions and perform remote code execution on CloudStack managed hosts and result in complete\u00a0compromise of the confidentiality, integrity, and availability of CloudStack managed infrastructure.\n\nUsers are recommended to restrict the network access on the CloudStack management server hosts to only essential ports. Users are recommended to upgrade to version 4.18.2.1, 4.19.0.2 or later, which addresses this issue.\n\n"}, {"lang": "es", "value": "El servicio API de integraci\u00f3n de CloudStack permite ejecutar su servidor API no autenticado (generalmente en el puerto 8096 cuando se configura y habilita a trav\u00e9s de la configuraci\u00f3n global Integration.api.port) para integraciones de portales internos y con fines de prueba. De forma predeterminada, el puerto del servicio API de integraci\u00f3n est\u00e1 deshabilitado y se considera deshabilitado cuando Integration.api.port se establece en 0 o negativo. Debido a una l\u00f3gica de inicializaci\u00f3n incorrecta, el servicio API de integraci\u00f3n escuchar\u00eda en un puerto aleatorio cuando su valor de puerto se establece en 0 (valor predeterminado). Un atacante que pueda acceder a la red de administraci\u00f3n de CloudStack podr\u00eda escanear y encontrar el puerto de servicio API de integraci\u00f3n aleatoria y explotarlo para realizar acciones administrativas no autorizadas y ejecutar c\u00f3digo remoto en hosts administrados de CloudStack y comprometer completamente la confidencialidad, integridad y disponibilidad de Infraestructura gestionada por CloudStack. Se recomienda a los usuarios restringir el acceso a la red en los hosts del servidor de administraci\u00f3n de CloudStack solo a los puertos esenciales. Se recomienda a los usuarios actualizar a la versi\u00f3n 4.18.2.1, 4.19.0.2 o posterior, que soluciona este problema."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@apache.org", "type": "Primary", "description": [{"lang": "en", "value": "CWE-665"}, {"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:cloudstack:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.18.2.1", "matchCriteriaId": "3838B737-9231-4333-9777-8B49CBACC754"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:cloudstack:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.19.0.0", "versionEndExcluding": "4.19.0.2", "matchCriteriaId": "1155DE75-1275-454F-9461-6DF70C73D1E2"}]}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/07/05/1", "source": "security@apache.org", "tags": ["Mailing List"]}, {"url": "https://cloudstack.apache.org/blog/security-release-advisory-4.19.0.2-4.18.2.1", "source": "security@apache.org", "tags": ["Release Notes"]}, {"url": "https://lists.apache.org/thread/6l51r00csrct61plkyd3qg3fj99215d1", "source": "security@apache.org", "tags": ["Mailing List"]}, {"url": "https://www.shapeblue.com/shapeblue-security-advisory-apache-cloudstack-security-releases-4-18-2-1-and-4-19-0-2/", "source": "security@apache.org", "tags": ["Release Notes"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-39864 - The vulnerability allows an attacker to scan and find the randomised integration API service port, exploit it to perform unauthorized administrative actions and perform remote code execution on CloudStack managed hosts."}, {"techniqueID": "T1190", "comment": "CVE-2024-39864 - An attacker could use the vulnerability to scan and find the randomised integration API service port, exploit it to perform unauthorized administrative actions and perform remote code execution on CloudStack managed hosts."}, {"techniqueID": "T1078", "comment": "CVE-2024-39864 - An attacker could use the vulnerability to scan and find the randomised integration API service port, exploit it to perform unauthorized administrative actions and perform remote code execution on CloudStack managed hosts."}, {"techniqueID": "T1077", "comment": "CVE-2024-39864 - An attacker could use the vulnerability to scan and find the randomised integration API service port, exploit it to perform unauthorized administrative actions and perform remote code execution on CloudStack managed hosts."}, {"techniqueID": "T1595", "comment": "CVE-2024-39864 - An attacker could use the vulnerability to scan and find the randomised integration API service port, exploit it to perform unauthorized administrative actions and perform remote code execution on CloudStack managed hosts."}, {"techniqueID": "T1191", "comment": "CVE-2024-39864 - An attacker could use the vulnerability to scan and find the randomised integration API service port, exploit it to perform unauthorized administrative actions and perform remote code execution on CloudStack managed hosts."}, {"techniqueID": "T1204", "comment": "CVE-2024-39864 - An attacker could use the vulnerability to scan and find the randomised integration API service port, exploit it to perform unauthorized administrative actions and perform remote code execution on CloudStack managed hosts."}], "stix_bundle": {"type": "bundle", "id": "my_bundle", "created_by_ref": "user:my_user", "created": "2024-07-05T14:15:03.203", "modified": "2024-07-08T15:47:10.990", "labels": ["Apache", "CloudStack", "API"], "objects": [{"type": "vulnerability", "id": "my_vulnerability", "created_by_ref": "user:my_user", "created": "2024-07-05T14:15:03.203", "modified": "2024-07-08T15:47:10.990", "labels": ["Apache", "CloudStack", "API"], "description": "The CloudStack integration API service allows running its unauthenticated API server (usually on port 8096 when configured and enabled via integration.api.port global setting)", "references": [{"source_name": "security@apache.org", "source_ref": "http://www.openwall.com/lists/oss-security/2024/07/05/1", "description": "Security advisory"}]}, {"type": "indicator", "id": "my_indicator", "created_by_ref": "user:my_user", "created": "2024-07-05T14:15:03.203", "modified": "2024-07-08T15:47:10.990", "labels": ["Apache", "CloudStack", "API"], "description": "Ports 8096 and 0", "pattern": "Source port is not set to 0", "objective_ref": "my_vulnerability"}], " relationships": [{"from": "my_vulnerability", "to": "my_indicator", "type": "related_to"}]}, "technical_analysis": {"Introduction": "The vulnerability is a remote code execution vulnerability in the CloudStack integration API service.", "Impact and Scope": "The vulnerability allows an attacker to perform unauthorized administrative actions and perform remote code execution on CloudStack managed hosts.", "Related MITRE ATT&CK Techniques": "T1210, T1190, T1078, T1077, T1595, T1191, T1204", "Technical Details": "The vulnerability is caused by an improper initialisation logic in the integration API service, allowing an attacker to scan and find the randomised integration API service port.", "Detection": "Detection methods include monitoring for traffic on ports 8096 and 0, and monitoring for unusual or suspicious API requests.", "Mitigation": "Mitigation strategies include applying patches, configuring the integration API service to only listen on specific ports, and restricting network access to the CloudStack management server hosts.", "Conclusion": "The vulnerability can be exploited by an attacker to perform unauthorized administrative actions and perform remote code execution on CloudStack managed hosts, highlighting the importance of timely patching and secure configuration."}, "executive_analysis": {"Overview": "The vulnerability is a remote code execution vulnerability in the CloudStack integration API service.", "Business Impact": "The vulnerability could lead to unauthorized administrative actions and remote code execution on CloudStack managed hosts, resulting in the potential for data breaches, financial loss, and reputational damage.", "Technical Impact": "The vulnerability affects the CloudStack integration API service, which is used by CloudStack managed hosts.", "Mitigation Strategies": "Potential mitigation strategies include applying patches, configuring the integration API service to only listen on specific ports, and restricting network access to the CloudStack management server hosts.", "Recommendations": "Executives are recommended to prioritize patching and secure configuration, and to consult with IT staff and stakeholders to develop a comprehensive mitigation strategy.", "Conclusions": "The vulnerability highlights the importance of timely patching and secure configuration, and emphasizes the need for ongoing monitoring and maintenance of the CloudStack integration API service."}}