{"id": "CVE-2024-5751", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-27T19:15:16.160", "lastModified": "2024-06-27T19:25:12.067", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "BerriAI/litellm version v1.35.8 contains a vulnerability where an attacker can achieve remote code execution. The vulnerability exists in the `add_deployment` function, which decodes and decrypts environment variables from base64 and assigns them to `os.environ`. An attacker can exploit this by sending a malicious payload to the `/config/update` endpoint, which is then processed and executed by the server when the `get_secret` function is triggered. This requires the server to use Google KMS and a database to store a model."}, {"lang": "es", "value": "BerriAI/litellm versi\u00f3n v1.35.8 contiene una vulnerabilidad donde un atacante puede lograr la ejecuci\u00f3n remota de c\u00f3digo. La vulnerabilidad existe en la funci\u00f3n `add_deployment`, que decodifica y descifra variables de entorno de base64 y las asigna a `os.environ`. Un atacante puede aprovechar esto enviando una carga maliciosa al endpoint `/config/update`, que luego es procesada y ejecutada por el servidor cuando se activa la funci\u00f3n `get_secret`. Esto requiere que el servidor utilice Google KMS y una base de datos para almacenar un modelo."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://huntr.com/bounties/ae623c2f-b64b-4245-9ed4-f13a0a5824ce", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1190 - Exploit Public-Facing Application", "comment": "CVE-2024-5751 - The vulnerability allows remote code execution by sending a malicious payload to the `/config/update` endpoint, which is a public-facing application. This technique is relevant because it highlights the importance of securing public-facing applications to prevent exploitation."}, {"techniqueID": "T1210 - Exploitation of Remote Services", "comment": "CVE-2024-5751 - The vulnerability allows an attacker to execute remote code by sending a malicious payload to the server. This technique is relevant because it highlights the importance of securing remote services to prevent exploitation."}, {"techniqueID": "T1228 - Execute File with Untered Arguments", "comment": "CVE-2024-5751 - The vulnerability allows an attacker to execute a file with untrusted arguments, which can lead to remote code execution. This technique is relevant because it highlights the importance of properly validating user input to prevent execution of malicious code."}], "stix_bundle": {"@layer": "package", "id": "test", "type": "bundle", "spec_version": "2.1", "idref": "", "objects": [{"id": "example-1", "type": "incident", "created_by_ref": "example-2", "modified": "2024-06-27T19:20:00.000Z", "published": "2024-06-27T19:20:00.000Z", "name": "CVE-2024-5751 - Remote Code Execution", "severity": "medium", "created": "2024-06-27T19:20:00.000Z", "modified_by_ref": "example-2", "type_labels": ["attack-pattern"], "/packages": ["vulnerability"], "data_sensitivity": ["confidential"]}, {"id": "example-2", "type": "actor", "type_labels": ["person", "group", "organization"], "name": "BerriAI/litellm", "description": "BerriAI/litellm is a company that has developed a machine learning model.", "initial_auto_generated_timestamp": "2024-06-27T19:20:00.000Z"}, {"id": "example-3", "type": "relationship", "source_ref": "example-1", "target_ref": "example-2", "relationship_type": "exploited-by"}]}, "technical_analysis": {"Introduction": "CVE-2024-5751 is a remote code execution vulnerability in BerriAI/litellm's `add_deployment` function. This vulnerability allows an attacker to send a malicious payload to the `/config/update` endpoint, which is then processed and executed by the server.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 9.8. Attack vectors include sending a malicious payload to the `/config/update` endpoint. The scope of the vulnerability is limited to the `/config/update` endpoint.", "Related MITRE ATT&CK Techniques": "The vulnerability related MITRE ATT&CK techniques include T1190, T1210, and T1228.", "Technical Details": "The vulnerability exists in the `add_deployment` function, which decodes and decrypts environment variables from base64 and assigns them to `os.environ`. An attacker can exploit this by sending a malicious payload to the `/config/update` endpoint, which is then processed and executed by the server.", "Detection": "Detection methods include monitoring for suspicious requests to the `/config/update` endpoint and monitoring for abnormal system behavior.", "Mitigation": "Mitigation strategies include validating user input, validating environment variables, and monitoring for suspicious requests to the `/config/update` endpoint.", "Conclusion": "In conclusion, CVE-2024-5751 is a remote code execution vulnerability in BerriAI/litellm's `add_deployment` function. This vulnerability allows an attacker to send a malicious payload to the `/config/update` endpoint, which is then processed and executed by the server."}, "executive_analysis": {"Overview": "CVE-2024-5751 is a remote code execution vulnerability in BerriAI/litellm's `add_deployment` function. This vulnerability allows an attacker to send a malicious payload to the `/config/update` endpoint, which is then processed and executed by the server.", "Business Impact": "This vulnerability has a high business impact, as it allows an attacker to execute remote code on the server.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows an attacker to execute remote code on the server.", "Mitigation Strategies": "Mitigation strategies include validating user input, validating environment variables, and monitoring for suspicious requests to the `/config/update` endpoint.", "Recommendations": "Recommendations include patching the vulnerable code, validating user input, and monitoring for suspicious requests to the `/config/update` endpoint.", "Conclusions": "In conclusion, CVE-2024-5751 is a remote code execution vulnerability in BerriAI/litellm's `add_deployment` function. This vulnerability allows an attacker to send a malicious payload to the `/config/update` endpoint, which is then processed and executed by the server. Mitigation strategies include validating user input, validating environment variables, and monitoring for suspicious requests to the `/config/update` endpoint."}}