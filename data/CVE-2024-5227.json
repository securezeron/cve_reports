{"id": "CVE-2024-5227", "sourceIdentifier": "zdi-disclosures@trendmicro.com", "published": "2024-05-23T22:15:12.727", "lastModified": "2024-05-24T01:15:30.977", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "TP-Link Omada ER605 PPTP VPN username Command Injection Remote Code Execution Vulnerability. This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of TP-Link Omada ER605 routers. Authentication is not required to exploit this vulnerability. However, devices are only vulnerable if configured to use a PPTP VPN with LDAP authentication.\n\nThe specific flaw exists within the handling of the username parameter provided to the /usr/bin/pppd endpoint. The issue results from the lack of proper validation of a user-supplied string before using it to execute a system call. An attacker can leverage this vulnerability to execute code in the context of root. Was ZDI-CAN-22446."}, {"lang": "es", "value": "Vulnerabilidad de ejecuci\u00f3n remota de c\u00f3digo de inyecci\u00f3n de comando de nombre de usuario de TP-Link Omada ER605 PPTP VPN. Esta vulnerabilidad permite a atacantes adyacentes a la red ejecutar c\u00f3digo arbitrario en las instalaciones afectadas de los enrutadores TP-Link Omada ER605. No se requiere autenticaci\u00f3n para aprovechar esta vulnerabilidad. Sin embargo, los dispositivos s\u00f3lo son vulnerables si est\u00e1n configurados para usar una VPN PPTP con autenticaci\u00f3n LDAP. La falla espec\u00edfica existe en el manejo del par\u00e1metro de nombre de usuario proporcionado al endpoint /usr/bin/pppd. El problema se debe a la falta de validaci\u00f3n adecuada de una cadena proporcionada por el usuario antes de usarla para ejecutar una llamada al sistema. Un atacante puede aprovechar esta vulnerabilidad para ejecutar c\u00f3digo en el contexto de la ra\u00edz. Era ZDI-CAN-22446."}], "metrics": {"cvssMetricV30": [{"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.6, "impactScore": 5.9}]}, "weaknesses": [{"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-78"}]}], "references": [{"url": "https://www.zerodayinitiative.com/advisories/ZDI-24-499/", "source": "zdi-disclosures@trendmicro.com"}], "techniques": [{"techniqueID": "T1204.001", "comment": "CVE-2024-5227 - This technique is relevant because it involves command injection, which could be used to execute arbitrary code. Defending against this technique involves validating user input and using secure coding practices."}, {"techniqueID": "T1190", "comment": "CVE-2024-5227 - This technique is relevant because it involves exploiting a known vulnerability, which could be used to gain unauthorized access. Defending against this technique involves patching the vulnerability, using intrusion detection systems, and implementing secure configurations."}, {"techniqueID": "T1068", "comment": "CVE-2024-5227 - This technique is relevant because it involves code execution, which could be used to compromise the system. Defending against this technique involves using secure coding practices, validating user input, and implementing access controls."}, {"techniqueID": "T1130", "comment": "CVE-2024-5227 - This technique is relevant because it involves web shell exposure, which could be used to gain unauthorized access. Defending against this technique involves staying up-to-date with software patches, using web application firewalls, and implementing secure configurations."}], "stix_bundle": {"stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2024-5227", "name": "TP-Link Omada ER605 PPTP VPN username Command Injection Remote Code Execution Vulnerability", "description": "CWE-78: Command Injection", "created_byReference": "https://www.zerodayinitiative.com/advisories/ZDI-24-499/", "labels": ["cve", "vulnerability"], "objects": [{"type": "relationship", "id": "Relationship-to-technique", "from": "CVE-2024-5227", "to": "T1204.001", "relationship_type": "Exploits"}, {"type": "relationship", "id": "Relationship-to-technique", "from": "CVE-2024-5227", "to": "T1190", "relationship_type": "Exploited_by"}, {"type": "relationship", "id": "Relationship-to-technique", "from": "CVE-2024-5227", "to": "T1068", "relationship_type": "Exploits"}, {"type": "relationship", "id": "Relationship-to-technique", "from": "CVE-2024-5227", "to": "T1130", "relationship_type": "Exploits"}]}]}}, "technical_analysis": {"Introduction": "The CVE-2024-5227 vulnerability is a remote code execution vulnerability in the TP-Link Omada ER605 PPTP VPN.", "Impact and Scope": "The vulnerability affects the TP-Link Omada ER605 router and allows an attacker to execute arbitrary code with root privileges. The attack vector is network-based and requires network adjacency.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1204.001, T1190, T1068, and T1130, which involve command injection, exploiting a known vulnerability, code execution, and web shell exposure.", "Technical Details": "The vulnerability occurs due to the lack of input validation in the /usr/bin/pppd endpoint. An attacker can send a specially crafted HTTP request to execute arbitrary code on the affected device.", "Detection": "Detection can be done by monitoring network traffic for suspicious activity and monitoring system logs for signs of exploitation.", "Mitigation": "Mitigation can be done by applying the patch, disabling the PPTP VPN, and implementing secure configurations.", "Conclusion": "The CVE-2024-5227 vulnerability is a critical remote code execution vulnerability that requires immediate attention."}, "executive_analysis": {"Overview": "The CVE-2024-5227 vulnerability is a critical remote code execution vulnerability that affects the TP-Link Omada ER605 router.", "Business Impact": "The vulnerability can allow an attacker to cause significant business disruption and data loss.", "Technical Impact": "The vulnerability can allow an attacker to execute arbitrary code on the affected device, which can result in a complete loss of control.", "Mitigation Strategies": "Applying the patch, disabling the PPTP VPN, and implementing secure configurations are recommended mitigation strategies.", "Recommendations": "Executives should prioritize patching the vulnerability and implementing secure configurations to prevent exploitation.", "Conclusions": "The CVE-2024-5227 vulnerability is a critical vulnerability that requires immediate attention and action."}}