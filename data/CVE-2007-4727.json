{"id": "CVE-2007-4727", "sourceIdentifier": "cve@mitre.org", "published": "2007-09-12T19:17:00.000", "lastModified": "2018-10-15T21:37:01.843", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Buffer overflow in the fcgi_env_add function in mod_proxy_backend_fastcgi.c in the mod_fastcgi extension in lighttpd before 1.4.18 allows remote attackers to overwrite arbitrary CGI variables and execute arbitrary code via an HTTP request with a long content length, as demonstrated by overwriting the SCRIPT_FILENAME variable, aka a \"header overflow.\""}, {"lang": "es", "value": "Desbordamiento de b\u00fafer en la funci\u00f3n fcgi_env_add de mod_proxy_backend_fastcgi.c en la extensi\u00f3n mod_fastcgi en lighttpd anterior a 1.4.18 permite a atacantes remotos sobrescribir variables CGI de su elecci\u00f3n y ejecutar c\u00f3digo de su elecci\u00f3n mediante una petici\u00f3n HTTP con una longitud de contenido larga, como se ha demostrado sobrescribiendo la variable SCRIPT_FILENAME, tambi\u00e9n conocido como \"desbordamiento de cabecera\"."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": true, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:lighttpd:lighttpd:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.4.15", "matchCriteriaId": "280F8BA1-34E8-4A93-871C-49E6F6826F2C"}]}]}], "references": [{"url": "http://fedoranews.org/updates/FEDORA-2007-213.shtml", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/26732", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/26794", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/26824", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/26997", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27229", "source": "cve@mitre.org"}, {"url": "http://securityreason.com/securityalert/3127", "source": "cve@mitre.org"}, {"url": "http://secweb.se/en/advisories/lighttpd-fastcgi-remote-vulnerability/", "source": "cve@mitre.org"}, {"url": "http://trac.lighttpd.net/trac/changeset/1986", "source": "cve@mitre.org"}, {"url": "http://www.gentoo.org/security/en/glsa/glsa-200709-16.xml", "source": "cve@mitre.org"}, {"url": "http://www.lighttpd.net/assets/2007/9/9/lighttpd_sa_2007_12.txt", "source": "cve@mitre.org"}, {"url": "http://www.novell.com/linux/security/advisories/2007_20_sr.html", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/479763/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/25622", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/3110", "source": "cve@mitre.org"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=284511", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/36526", "source": "cve@mitre.org"}, {"url": "https://issues.rpath.com/browse/RPL-1715", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2007-4727: Buffer overflow in mod_proxy_backend_fastcgi.c in Lighttpd - This technique demonstrates how the attacker can exploit the buffer overflow vulnerability to execute arbitrary code. The comment provides details on how to defend against this technique."}, {"techniqueID": "T1048", "comment": "CVE-2007-4727: Buffer overflow in mod_proxy_backend_fastcgi.c in Lighttpd - This technique demonstrates how the attacker can exploit the buffer overflow vulnerability to overwrite CGI variables and execute arbitrary code. The comment provides details on how to defend against this technique."}, {"techniqueID": "T1210", "comment": "CVE-2007-4727: Buffer overflow in mod_proxy_backend_fastcgi.c in Lighttpd - This technique demonstrates how the attacker can exploit the buffer overflow vulnerability to execute arbitrary code. The comment provides details on how to defend against this technique."}], "technical_analysis": {"Introduction": "CVE-2007-4727 is a buffer overflow vulnerability in mod_proxy_backend_fastcgi.c in Lighttpd, which allows an attacker to execute arbitrary code.", "Impact and Scope": "The CVSS score for this vulnerability is 6.8, with a high severity rating. The attack vector is network-based, making it a critical vulnerability that requires immediate attention.", "Related MITRE ATT&CK Techniques": "T1190, T1048, T1210", "Technical Details": "The buffer overflow occurs when a specifically crafted HTTP request is sent to the Lighttpd server, causing the fcgi_env_add function to overflow its buffer. This allows the attacker to overwrite arbitrary CGI variables and execute arbitrary code.", "Detection": "Detection of this vulnerability involves monitoring for HTTP requests with large content lengths and unusual CGI variable settings.", "Mitigation": "The vulnerability can be mitigated by updating to a version of Lighttpd that is not affected by this vulnerability, or by implementing additional security measures such as a web application firewall.", "Conclusion": "CVE-2007-4727 is a serious buffer overflow vulnerability that requires immediate attention to prevent exploitation and minimize potential damage."}, "executive_analysis": {"Overview": "CVE-2007-4727 is a critical buffer overflow vulnerability in Lighttpd that allows an attacker to execute arbitrary code.", "Business Impact": "This vulnerability poses a significant risk to businesses that rely on Lighttpd for their online presence, as it could potentially allow an attacker to steal sensitive data or disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is high, as it allows an attacker to execute arbitrary code, which could potentially compromise the integrity of the system.", "Mitigation Strategies": "Implementing additional security measures such as a web application firewall and updating to a version of Lighttpd that is not affected by this vulnerability are recommended.", "Recommendations": "Executives should prioritize the mitigation of this vulnerability and ensure that their organization is taking the necessary steps to prevent exploitation.", "Conclusions": "CVE-2007-4727 is a critical vulnerability that requires immediate attention to prevent exploitation and minimize potential damage."}}