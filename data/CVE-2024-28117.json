{"id": "CVE-2024-28117", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-21T22:15:11.820", "lastModified": "2024-03-22T12:45:36.130", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Grav is an open-source, flat-file content management system. Prior to version 1.7.45, Grav validates accessible functions through the Utils::isDangerousFunction function, but does not impose restrictions on twig functions like twig_array_map, allowing attackers to bypass the validation and execute arbitrary commands. Twig processing of static pages can be enabled in the front matter by any administrative user allowed to create or edit pages. As the Twig processor runs unsandboxed, this behavior can be used to gain arbitrary code execution and elevate privileges on the instance. Upgrading to patched version 1.7.45 can mitigate this issue.\n"}, {"lang": "es", "value": "Grav es un sistema de gesti\u00f3n de contenidos de archivos planos de c\u00f3digo abierto. Antes de la versi\u00f3n 1.7.45, Grav valida funciones accesibles a trav\u00e9s de la funci\u00f3n Utils::isDangerousFunction, pero no impone restricciones a funciones de twig como twig_array_map, lo que permite a los atacantes eludir la validaci\u00f3n y ejecutar comandos arbitrarios. El procesamiento Twig de p\u00e1ginas est\u00e1ticas puede ser habilitado en la portada por cualquier usuario administrativo autorizado a crear o editar p\u00e1ginas. Como el procesador Twig se ejecuta sin entorno de pruebas, este comportamiento se puede utilizar para obtener la ejecuci\u00f3n de c\u00f3digo arbitrario y elevar los privilegios en la instancia. La actualizaci\u00f3n a la versi\u00f3n parcheada 1.7.45 puede mitigar este problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://github.com/getgrav/grav/commit/de1ccfa12dbcbf526104d68c1a6bc202a98698fe", "source": "security-advisories@github.com"}, {"url": "https://github.com/getgrav/grav/security/advisories/GHSA-qfv4-q44r-g7rv", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1201", "comment": "CVE-2024-28117 - Unvalidated or incorrectly validated user input allows the execution of arbitrary code. Defenders can mitigate this risk by properly validating user input to prevent the execution of malicious code."}, {"techniqueID": "T1027", "comment": "CVE-2024-28117 - Execution of arbitrary code allows attackers to bypass security controls. Defenders can mitigate this risk by hardening systems and implementing security controls to limit the risks associated with the execution of arbitrary code."}, {"techniqueID": "T1190", "comment": "CVE-2024-28117 - Authorization bypass allows attackers to execute code with elevated privileges. Defenders can mitigate this risk by implementing proper authorization controls to prevent the bypass of security restrictions."}], "stix_bundle": {"type": "bundle", "id": "bundle--CVE-2024-28117", "spec_version": "2.1", "title": "CVE-2024-28117 Bundle", "description": "A bundle describing the CVE-2024-28117 vulnerability and its related techniques, risks, and defense strategies.", "entities": [{"type": " incident", "id": "incident--CVE-2024-28117", "name": "CVE-2024-28117 Incident"}, {"type": "indicator", "id": "indicator--CVE-2024-28117", "name": "CVE-2024-28117 Indicator"}, {"type": "attack-pattern", "id": "attack-pattern--CVE-2024-28117", "name": "CVE-2024-28117 Attack Pattern"}, {"type": "malware", "id": "malware--CVE-2024-28117", "name": "CVE-2024-28117 Malware"}], "relationships": [{"type": "incident", "id": "incident--CVE-2024-28117", "role": "target"}, {"type": "indicator", "id": "indicator--CVE-2024-28117", "role": "target"}, {"type": "attack-pattern", "id": "attack-pattern--CVE-2024-28117", "role": "target"}, {"type": "malware", "id": "malware--CVE-2024-28117", "role": "target"}]}, "technical_analysis": {"Introduction": "CVE-2024-28117 is an Unvalidated User Input vulnerability in Grav, a popular open-source content management system. This vulnerability allows attackers to execute arbitrary code on the affected system.", "Impact and Scope": "The vulnerability affects Grav version 1.7.45 and earlier, with an CVSS score of 8.8 and an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "T1201, T1027, and T1190", "Technical Details": "CVE-2024-28117 allows attackers to execute arbitrary code on the affected system by bypassing the validation mechanism of Grav. This is achieved by exploiting the Twig processor's ability to execute unsandboxed code.", "Detection": "Detection methods include monitoring for suspicious network traffic and analyzing system logs for signs of code execution.", "Mitigation": "Mitigation strategies include updating Grav to the latest version, disabling Twig processing on static pages, and implementing network segmentation and access control measures.", "Conclusion": "In conclusion, CVE-2024-28117 is a critical vulnerability that requires immediate attention. It is recommended that administrators take immediate action to mitigate the risk associated with this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-28117 vulnerability is a critical security issue that affects the open-source content management system Grav. This vulnerability allows attackers to execute arbitrary code on the affected system, making it a major risk to data security.", "Business Impact": "The impact of this vulnerability on business operations is significant. It can lead to data breaches and financial loss, making it essential to address this vulnerability promptly.", "Technical Impact": "The technical impact of this vulnerability is that it compromises the security of the Grav system, allowing attackers to execute arbitrary code and gain unauthorized access to sensitive data.", "Mitigation Strategies": "Mitigation strategies include updating Grav to the latest version, disabling Twig processing on static pages, and implementing network segmentation and access control measures.", "Recommendations": "It is recommended that administrators take immediate action to mitigate the risk associated with this vulnerability. This includes updating Grav, disabling Twig processing on static pages, and implementing network segmentation and access control measures.", "Conclusions": "In conclusion, CVE-2024-28117 is a critical vulnerability that requires immediate attention. It is essential to prioritize the mitigation of this vulnerability to protect against potential security risks."}}