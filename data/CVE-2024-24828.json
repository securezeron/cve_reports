{"id": "CVE-2024-24828", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-09T23:15:09.837", "lastModified": "2024-02-16T13:43:33.407", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "pkg is tool design to bundle Node.js projects into an executables. Any native code packages built by `pkg` are written to a hardcoded directory. On unix systems, this is `/tmp/pkg/*` which is a shared directory for all users on the same local system. There is no uniqueness to the package names within this directory, they are predictable. An attacker who has access to the same local system has the ability to replace the genuine executables in the shared directory with malicious executables of the same name. A user may then run the malicious executable without realising it has been modified. This package is deprecated. Therefore, there will not be a patch provided for this vulnerability. To check if your executable build by pkg depends on native code and is vulnerable, run the executable and check if `/tmp/pkg/` was created. Users should transition to actively maintained alternatives. We would recommend investigating Node.js 21\u2019s support for single executable applications. Given the decision to deprecate the pkg package, there are no official workarounds or remediations provided by our team. Users should prioritize migrating to other packages that offer similar functionality with enhanced security."}, {"lang": "es", "value": "pkg es una herramienta de dise\u00f1o para agrupar proyectos de Node.js en archivos ejecutables. Cualquier paquete de c\u00f3digo nativo creado por `pkg` se escribe en un directorio codificado. En sistemas Unix, este es `/tmp/pkg/*` que es un directorio compartido para todos los usuarios en el mismo sistema local. Los nombres de los paquetes dentro de este directorio no son \u00fanicos, son predecibles. Un atacante que tiene acceso al mismo sistema local tiene la capacidad de reemplazar los ejecutables genuinos en el directorio compartido con ejecutables maliciosos del mismo nombre. Luego, un usuario puede ejecutar el ejecutable malicioso sin darse cuenta de que ha sido modificado. Este paquete est\u00e1 en desuso. Por lo tanto, no se proporcionar\u00e1 ning\u00fan parche para esta vulnerabilidad. Para verificar si su ejecutable compilado por pkg depende del c\u00f3digo nativo y es vulnerable, ejecute el ejecutable y verifique si se cre\u00f3 `/tmp/pkg/`. Los usuarios deben hacer la transici\u00f3n a alternativas mantenidas activamente. Recomendamos investigar la compatibilidad de Node.js 21 con aplicaciones ejecutables \u00fanicas. Dada la decisi\u00f3n de dejar de usar el paquete pkg, nuestro equipo no ha proporcionado soluciones ni soluciones oficiales. Los usuarios deben priorizar la migraci\u00f3n a otros paquetes que ofrezcan funciones similares con seguridad mejorada."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.6, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 5.2}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-276"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:vercel:pkg:*:*:*:*:*:node.js:*:*", "versionEndIncluding": "5.8.1", "matchCriteriaId": "A83852BC-5291-4916-A376-52D0CB5766AE"}]}]}], "references": [{"url": "https://github.com/vercel/pkg/security/advisories/GHSA-22r3-9w55-cj54", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://nodejs.org/api/single-executable-applications.html", "source": "security-advisories@github.com", "tags": ["Product"]}], "techniques": [{"techniqueID": "T1203", "comment": "CVE-2024-24828 - This vulnerability is potentially exploitable through a local privilege escalation attack, demonstrating the ease of replacement of executables. This technique is relevant to this CVE as it showcases how an attacker can achieve local escalation of privileges, thus highlighting the importance of proper access control and native code package management."}, {"techniqueID": "T1193", "comment": "CVE-2024-24828 - This vulnerability can be used to conduct file execution, allowing an attacker to replace legitimate executables with malicious ones. This demonstrates the potential for a file execution technique against this CVE, further emphasizing the importance of secure package management and executables."}, {"techniqueID": "T1027", "comment": "CVE-2024-24828 - This vulnerability reveals the possibility of Data from Local System, where an attacker can modify executables in a shared directory, highlighting the potential for data manipulation through local system accessibility."}], "stix_bundle": {"objects": [{"id": "vulnerability:cve-2024-24828", "type": "vulnerability", "description": "pkg is a tool designed to bundle Node.js projects into executables. Any native code packages built by `pkg` are written to a hardcoded directory. On Unix systems, this is `/tmp/pkg/*`, which is a shared directory for all users on the same local system... For more details, check STIX bundle."}, {"id": "attack-pattern:t1203", "type": "attack-pattern", "description": "Local Privilege Escalation", "name": "LPE Through Replacement of Executables"}, {"id": "attack-pattern:t1193", "type": "attack-pattern", "description": "File Execution", "name": "Replaced Executable File Execution"}, {"id": "attack-pattern:t1027", "type": "attack-pattern", "description": "Data from Local System", "name": "Local Data Modification"}, {"id": "course-of-action:mitigate-executable-modification", "type": "course-of-action", "description": "Implement secure package management and executable handling practices, such as migrating to actively maintained alternatives", "name": "Mitigate Executable Modification"}, {"id": "indicator:pkg-insecure-executable-modification", "type": "indicator", "description": "Indicates insecure executable modification through `pkg`", "name": "Insecure Executable Modification"}], "relationships": [{"id": "cve-2024-24828-attack-pattern-t1203", "type": "has_attack_pattern", "from": "vulnerability:cve-2024-24828", "to": "attack-pattern:t1203", "relationship_type": "related_attack_patterns"}, {"id": "cve-2024-24828-attack-pattern-t1193", "type": "has_attack_pattern", "from": "vulnerability:cve-2024-24828", "to": "attack-pattern:t1193", "relationship_type": "related_attack_patterns"}, {"id": "cve-2024-24828-attack-pattern-t1027", "type": "has_attack_pattern", "from": "vulnerability:cve-2024-24828", "to": "attack-pattern:t1027", "relationship_type": "related_attack_patterns"}, {"id": "mitigate-executable-modification-course-of-action", "type": "mitigates", "from": "course-of-action:mitigate-executable-modification", "to": "attack-pattern:t1203", "relationship_type": "mitigates"}, {"id": "pkg-insecure-executable-modification-indicator", "type": "indicates", "from": "indicator:pkg-insecure-executable-modification", "to": "attack-pattern:t1193", "relationship_type": "indicates"}]}, "technical_analysis": {"Introduction": "CVE-2024-24828 is a vulnerability affecting the `pkg` tool, which bundles Node.js projects into executables. Any native code packages built by `pkg` are written to a hardcoded directory, making it vulnerable to local privilege escalation attacks.", "Impact and Scope": "This vulnerability has a CVSS 3.1 score of 7.8, demonstrating its severity. The vulnerability can be exploited through local file execution, revealing Data from Local System.", "Related MITRE ATT&CK Techniques": "T1203, T1193, and T1027 are related to this CVE, as they demonstrate the potential for local privilege escalation, file execution, and Data from Local System.", "Technical Details": "pike", "Detection": "pike", "Mitigation": "Implement secure package management and executable handling practices, such as migrating to actively maintained alternatives.", "Conclusion": "This vulnerability emphasizes the importance of proper access control and native code package management."}, "executive_analysis": {"Overview": "CVE-2024-24828 is a vulnerability affecting the `pkg` tool, which bundles Node.js projects into executables.", "Business Impact": "This vulnerability has significant business implications, as it can result in data breaches and unauthorized access.", "Technical Impact": "The vulnerability affects the security and integrity of the executables, exposing the system to potential attacks.", "Mitigation Strategies": "Implement secure package management and executable handling practices, such as migrating to actively maintained alternatives.", "Recommendations": "Migrate to actively maintained alternatives, ensure proper access control, and implement secure package management practices.", "Conclusions": "This vulnerability highlights the importance of proper software development practices and underscores the need for continued investment in security research and development."}}