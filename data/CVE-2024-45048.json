{"id": "CVE-2024-45048", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-28T21:15:06.817", "lastModified": "2024-09-04T17:27:31.517", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHPSpreadsheet is a pure PHP library for reading and writing spreadsheet files. Affected versions are subject to a bypassing of a filter which allows for an XXE-attack. This in turn allows attacker to obtain contents of local files, even if error reporting is muted. This vulnerability has been addressed in release version 2.2.1. All users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "PHPSpreadsheet es una librer\u00eda PHP pura para leer y escribir archivos de hojas de c\u00e1lculo. Las versiones afectadas est\u00e1n sujetas a la omisi\u00f3n de un filtro que permite un ataque XXE. Esto, a su vez, permite al atacante obtener el contenido de los archivos locales, incluso si el informe de errores est\u00e1 silenciado. Esta vulnerabilidad se ha solucionado en la versi\u00f3n 2.2.1. Se recomienda a todos los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-611"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-611"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpoffice:phpspreadsheet:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.29.1", "matchCriteriaId": "520A70B7-2C60-4064-B452-538ED7A8D30E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpoffice:phpspreadsheet:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.0.0", "versionEndExcluding": "2.2.1", "matchCriteriaId": "3D7E4C35-4E3A-42DB-884B-73F028D4A6D6"}]}]}], "references": [{"url": "https://github.com/PHPOffice/PhpSpreadsheet/commit/bea2d4b30f24bcc8a7712e208d1359e603b45dda", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-ghg6-32f9-2jp7", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-45048 - This vulnerability allows an attacker to bypass a filter and conduct an XXE-attack to obtain local file contents, even if error reporting is muted. This is relevant as it allows for lateral movement and data exfiltration. Defending against this involves implementing proper XML parsing and filtering."}, {"techniqueID": "T1191", "comment": "CVE-2024-45048 - XXE-attacks can be used to read and write local files. This is relevant as it allows for persistence and privilege escalation. Defending against this involves implementing proper XML parsing and filtering."}, {"techniqueID": "T1027", "comment": "CVE-2024-45048 - This vulnerability can be used to conduct an XXE-attack to obtain local file contents. This is relevant as it allows for data exfiltration. Defending against this involves implementing proper XML parsing and filtering."}, {"techniqueID": "T1192", "comment": "CVE-2024-45048 - XXE-attacks can be used to read and write local files. This is relevant as it allows for data manipulation. Defending against this involves implementing proper XML parsing and filtering."}], "stix_bundle": "[STIX Bundle Object omitted for brevity]", "technical_analysis": {"Introduction": "CVE-2024-45048 is a vulnerability in the PHPSpreadsheet library that allows attackers to bypass a filter and conduct an XXE-attack to obtain local file contents, even if error reporting is muted.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5/8.8 and an attack vector of NETWORK. It can be exploited by an attacker to obtain local file contents, allowing for lateral movement and data exfiltration.", "Related MITRE ATT&CK Techniques": "T1190, T1191, T1027, T1192", "Technical Details": "The vulnerability occurs due to a bypassing of a filter in the PHPSpreadsheet library, allowing for XXE-attacks to be conducted. The library is vulnerable to versions 2.0.0 to 2.2.0.", "Detection": "Detection involves monitoring for suspicious XML requests and filtering out malicious traffic.", "Mitigation": "Mitigation involves upgrading to version 2.2.1 and implementing proper XML parsing and filtering.", "Conclusion": "In conclusion, CVE-2024-45048 is a significant vulnerability that allows attackers to bypass a filter and conduct an XXE-attack to obtain local file contents. Defending against this involves implementing proper XML parsing and filtering and upgrading to a mitigated version."}, "executive_analysis": {"Overview": "CVE-2024-45048 is a vulnerability in the PHPSpreadsheet library that allows attackers to bypass a filter and conduct an XXE-attack to obtain local file contents, even if error reporting is muted.", "Business Impact": "The vulnerability can allow attackers to steal sensitive data, disrupt business operations, and compromise sensitive information.", "Technical Impact": "The vulnerability can be exploited by an attacker to obtain local file contents, allowing for lateral movement and data exfiltration.", "Mitigation Strategies": "Upgrade to a mitigated version, implement proper XML parsing and filtering, and monitor for suspicious traffic.", "Recommendations": "Recommend upgrading to a mitigated version, implementing proper XML parsing and filtering, and conducting regular security audits.", "Conclusions": "In conclusion, CVE-2024-45048 is a significant vulnerability that requires immediate attention and action to mitigate the risks and impact."}}