{"id": "CVE-2024-4201", "sourceIdentifier": "cve@gitlab.com", "published": "2024-06-12T23:15:49.887", "lastModified": "2024-07-18T19:39:50.667", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A cross-site scripting issue has been discovered in GitLab affecting all versions starting from 5.1 before 16.10.7, all versions starting from 16.11 before 16.111.4, all versions starting from 17.0 before 17.0.2. When viewing an XML file in a repository in raw mode, it can be made to render as HTML if viewed under specific circumstances."}, {"lang": "es", "value": "Se descubri\u00f3 un problema de cross-site scripting en GitLab que afecta a todas las versiones desde 5.1 anteriores a 16.10.7, todas las versiones desde 16.11 anteriores a 16.111.4, todas las versiones desde 17.0 anteriores a 17.0.2. Al visualizar un archivo XML en un repositorio en modo sin formato, se puede hacer que se represente como HTML si se ve en circunstancias espec\u00edficas."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 2.7}, {"source": "cve@gitlab.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "cve@gitlab.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "5.1", "versionEndExcluding": "16.10.7", "matchCriteriaId": "A3B5490D-4A8C-4F9F-810A-59979BE2D892"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "5.1", "versionEndExcluding": "16.10.7", "matchCriteriaId": "2E166198-556D-4D69-B39E-DDCF2849BEC9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "16.11.0", "versionEndExcluding": "16.111.4", "matchCriteriaId": "541F26D8-667C-4826-AC9D-334A76B4C9F2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "16.11.0", "versionEndExcluding": "16.111.4", "matchCriteriaId": "6DF27F17-916C-44ED-A038-5199A875F163"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "17.0.0", "versionEndExcluding": "17.0.2", "matchCriteriaId": "A0182874-BBFB-467F-9850-C29C4890AB4D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "17.0.0", "versionEndExcluding": "17.0.2", "matchCriteriaId": "D9165657-47FB-42AB-8D7D-0556F342C296"}]}]}], "references": [{"url": "https://about.gitlab.com/releases/2024/06/12/patch-release-gitlab-17-0-2-released/#xss-and-content-injection-when-viewing-raw-xhtml-files-on-ios-devices", "source": "cve@gitlab.com", "tags": ["Release Notes"]}, {"url": "https://gitlab.com/gitlab-org/gitlab/-/issues/458229", "source": "cve@gitlab.com", "tags": ["Vendor Advisory"]}, {"url": "https://hackerone.com/reports/2473886", "source": "cve@gitlab.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-4201 - The vulnerability allows for cross-site scripting (XSS) attacks, which can be exploited by an attacker to steal user data, inject malicious scripts, or manipulate the website's behavior. This can be prevented by validating user-input data and using a Content Security Policy (CSP) to define which sources of content are allowed to execute."}, {"techniqueID": "T1048", "comment": "CVE-2024-4201 - The vulnerability allows for unauthorized access to sensitive data, which can be exploited by an attacker to steal or manipulate sensitive information. This can be prevented by implementing proper access control measures and encrypting sensitive data."}, {"techniqueID": "T1562", "comment": "CVE-2024-4201 - The vulnerability allows for command injection, which can be exploited by an attacker to execute arbitrary commands, potentially leading to unauthorized changes to the system or data. This can be prevented by validating and sanitizing user-input data and implementing proper input validation and sanitization."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle-cve-2024-4201", "created_by_ref": "test", "created": "2024-07-18T19:39:50.667", "objects": [{"type": "vulnerability", "id": "vulnerability-cve-2024-4201", "description": "A cross-site scripting issue has been discovered in GitLab affecting all versions starting from 5.1 before 16.10.7, all versions starting from 16.11 before 16.111.4, all versions starting from 17.0 before 17.0.2.", "threats": [{"type": "attack-pattern", "id": "attack-pattern-T1190", "description": "Cross-Site Scripting (XSS) attacks"}], "required_security_controls": [{"type": "security-control", "id": "security-control-CSP", "description": "Content Security Policy (CSP)"}, {"type": "security-control", "id": "security-control-Access-Control", "description": "Access Control"}], "mitigations": [{"type": "course-of-action", "id": "course-of-action- validate-and-sanitize-input-data", "description": "Validate and sanitize user-input data"}]}, {"type": "attack-pattern", "id": "attack-pattern-T1048", "description": "Unauthorized Access"}, {"type": "attack-pattern", "id": "attack-pattern-T1562", "description": "Command Injection"}]}}, "technical_analysis": {"Introduction": "A cross-site scripting issue has been discovered in GitLab affecting all versions starting from 5.1 before 16.10.7, all versions starting from 16.11 before 16.111.4, all versions starting from 17.0 before 17.0.2. This vulnerability allows for cross-site scripting (XSS) attacks, which can be exploited by an attacker to steal user data, inject malicious scripts, or manipulate the website's behavior.", "Impact and Scope": "The impact of this vulnerability is high, as it allows for unauthorized access to sensitive data and can be exploited by an attacker to execute arbitrary commands. The scope of the vulnerability is all versions of GitLab starting from 5.1 before 16.10.7, all versions starting from 16.11 before 16.111.4, and all versions starting from 17.0 before 17.0.2.", "Related MITRE ATT&CK Techniques": "T1190, T1048, T1562", "Technical Details": "The vulnerability occurs when viewing an XML file in a repository in raw mode, which can be made to render as HTML if viewed under specific circumstances. This allows an attacker to inject malicious scripts or steal user data.", "Detection": "Detection methods include monitoring for suspicious network traffic, monitoring for unusual system behavior, and logging and auditing system activities.", "Mitigation": "Mitigation strategies include validating and sanitizing user-input data, implementing a Content Security Policy (CSP) to define which sources of content are allowed to execute, and encrypting sensitive data.", "Conclusion": "In conclusion, this vulnerability is a significant risk and requires immediate attention. It is essential to validate and sanitize user-input data, implement a Content Security Policy (CSP), and encrypt sensitive data to prevent exploitation."}, "executive_analysis": {"Overview": "A cross-site scripting issue has been discovered in GitLab affecting all versions starting from 5.1 before 16.10.7, all versions starting from 16.11 before 16.111.4, all versions starting from 17.0 before 17.0.2.", "Business Impact": "The impact of this vulnerability on business is significant, as it allows for unauthorized access to sensitive data and can be exploited by an attacker to execute arbitrary commands. This can lead to financial loss, reputational damage, and loss of customer trust.", "Technical Impact": "The technical impact of this vulnerability is the potential for unauthorized access to sensitive data and execution of arbitrary commands.", "Mitigation Strategies": "Mitigation strategies include validating and sanitizing user-input data, implementing a Content Security Policy (CSP) to define which sources of content are allowed to execute, and encrypting sensitive data.", "Recommendations": "Recommended actions include validating and sanitizing user-input data, implementing a Content Security Policy (CSP), encrypting sensitive data, and regularly updating and patching systems.", "Conclusions": "In conclusion, this vulnerability is a significant risk and requires immediate attention. It is essential to take immediate action to mitigate this vulnerability and prevent exploitation."}}