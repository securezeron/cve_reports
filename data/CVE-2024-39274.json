{"id": "CVE-2024-39274", "sourceIdentifier": "responsibledisclosure@mattermost.com", "published": "2024-08-01T15:15:12.150", "lastModified": "2024-08-23T14:39:29.247", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Mattermost versions 9.9.x <= 9.9.0, 9.5.x <= 9.5.6, 9.7.x <= 9.7.5 and 9.8.x <= 9.8.1 fail to properly validate that\u00a0the channel that comes from the sync message is a shared channel, when shared channels are enabled, which allows a malicious remote to add users to arbitrary teams and channels"}, {"lang": "es", "value": " Las versiones de Mattermost 9.9.x &lt;= 9.9.0, 9.5.x &lt;= 9.5.6, 9.7.x &lt;= 9.7.5 y 9.8.x &lt;= 9.8.1 no validan correctamente que el canal que proviene del mensaje de sincronizaci\u00f3n es un canal compartido, cuando los canales compartidos est\u00e1n habilitados, lo que permite que un control remoto malicioso agregue usuarios a equipos y canales arbitrarios"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.3, "impactScore": 5.8}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-284"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.5.0", "versionEndExcluding": "9.5.7", "matchCriteriaId": "0942D308-9462-4C2A-A9FE-838EB5842E02"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.7.0", "versionEndExcluding": "9.7.6", "matchCriteriaId": "642355DC-0EF1-4631-89D0-694AB7C9EF78"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.8.0", "versionEndExcluding": "9.8.2", "matchCriteriaId": "00E80458-F38E-46EB-98FD-1CADD3FCE335"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:9.9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DA215755-4D08-4B4D-9736-DAF54D2F0B9C"}]}]}], "references": [{"url": "https://mattermost.com/security-updates", "source": "responsibledisclosure@mattermost.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-39274 - Exploitation of unvalidated user data from the sync message, allowing a malicious remote user to add users to arbitrary teams and channels. This can lead to privileged account access and data exfiltration. Defend against this by validating user input and implementing strict access controls."}, {"techniqueID": "T1082", "comment": "CVE-2024-39274 - Using the vulnerable shared channel feature to add users to arbitrary teams and channels. This can be done by crafting a malicious sync message. Defend against this by limiting the number of users that can be added to a team or channel and implementing strict access controls."}, {"techniqueID": "T1048", "comment": "CVE-2024-39274 - Exploiting the lack of validation when processing user input from the sync message. This can lead to arbitrary code execution. Defend against this by validating and sanitizing user input."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/stix_bundle.casa", "created_by_ref": "https://example.com/ creator", "modified": "2024-08-01T15:15:12.150", "objects": [{"type": "vulnerability", "id": "https://example.com/vulnerability", "created_by_ref": "https://example.com/ creator", "modified": "2024-08-01T15:15:12.150", "name": "CVE-2024-39274", "description": "Mattermost versions 9.9.x <= 9.9.0, 9.5.x <= 9.5.6, 9.7.x <= 9.7.5 and 9.8.x <= 9.8.1 fail to properly validate that the channel that comes from the sync message is a shared channel, when shared channels are enabled, which allows a malicious remote user to add users to arbitrary teams and channels.", "severity": "High", "cvss": {"score": 8.7, "version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N"}, "references": [{"type": "reference", "id": "https://mattermost.com/security-updates", "url": "https://mattermost.com/security-updates", "source_name": "mattermost"}]}, {"type": "indicator", "id": "https://example.com/indicator", "created_by_ref": "https://example.com/ creator", "modified": "2024-08-01T15:15:12.150", "name": "Shared Channel Add User", "description": "Attempting to add users to arbitrary teams and channels using the shared channel feature.", "pattern": "adding users to arbitrary teams and channels using the shared channel feature", "valid_from": "2024-08-01T15:15:12.150", "valid_until": "2024-08-23T14:39:29.247", "created_at": "2024-08-01T15:15:12.150", "updated_at": "2024-08-23T14:39:29.247"}, {"type": "indicator", "id": "https://example.com/indicator", "created_by_ref": "https://example.com/ creator", "modified": "2024-08-01T15:15:12.150", "name": "Unvalidated User Data", "description": "Attempting to exploit unvalidated user data from the sync message.", "pattern": "unvalidated user data from the sync message", "valid_from": "2024-08-01T15:15:12.150", "valid_until": "2024-08-23T14:39:29.247", "created_at": "2024-08-01T15:15:12.150", "updated_at": "2024-08-23T14:39:29.247"}, {"type": "course_of_action", "id": "https://example.com/course_of_action", "created_by_ref": "https://example.com/ creator", "modified": "2024-08-01T15:15:12.150", "name": "Add User to Team", "description": "Adding a user to a team to gain access and control.", "mitigated_by": [{"type": " technique", "id": "https://example.com/technique"}]}]}, "technical_analysis": {"Introduction": "CVE-2024-39274 is a vulnerability in Mattermost that allows a malicious user to add users to arbitrary teams and channels by exploiting the shared channel feature and unvalidated user data from the sync message.", "Impact and Scope": "This vulnerability has an impact of HIGH, as it allows a malicious user to gain access and control of the systems and data.", "Related MITRE ATT&CK Techniques": "T1190, T1082, T1048", "Technical Details": "The vulnerability occurs when Mattermost fails to properly validate the channel that comes from the sync message, allowing a malicious user to add users to arbitrary teams and channels.", "Detection": "Detection of this vulnerability can be done by monitoring system logs for suspicious activity and identifying users who are added to teams and channels without administrative approval.", "Mitigation": "Mitigation strategies include validating user input and implementing strict access controls, as well as monitoring system logs for suspicious activity and identifying users who are added to teams and channels without administrative approval.", "Conclusion": "In conclusion, CVE-2024-39274 is a vulnerability that allows a malicious user to add users to arbitrary teams and channels by exploiting the shared channel feature and unvalidated user data from the sync message. This vulnerability has an impact of HIGH and requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-39274 is a critical vulnerability in Mattermost that has the potential to compromise the security and integrity of the system.", "Business Impact": "This vulnerability has a significant business impact, as it can compromise the confidentiality, integrity, and availability of data, as well as the confidentiality and integrity of the system.", "Technical Impact": "The technical impact of this vulnerability is the potential for unauthorized access and control of the system, as well as data exfiltration and manipulation.", "Mitigation Strategies": "Implementing strict access controls, validating user input, and monitoring system logs for suspicious activity are the recommended mitigation strategies.", "Recommendations": "Recommendations for executives include verifying the security posture of the system, implementing regular security audits and vulnerability assessments, and being aware of the potential for security incidents.", "Conclusions": "In conclusion, CVE-2024-39274 is a critical vulnerability that requires immediate attention and mitigation to prevent potential security incidents."}}