{"id": "CVE-2024-29037", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-20T21:15:32.040", "lastModified": "2024-03-21T12:58:51.093", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "datahub-helm provides the Kubernetes Helm charts for deploying Datahub and its dependencies on a Kubernetes cluster. Starting in version 0.1.143 and prior to version 0.2.182, due to configuration issues in the helm chart, if there was a successful initial deployment during a limited window of time, personal access tokens were possibly created with a default secret key. Since the secret key is a static, publicly available value, someone could inspect the algorithm used to generate personal access tokens and generate their own for an instance. Deploying with Metadata Service Authentication enabled would have been difficult during window of releases. If someone circumvented the helm settings and manually set Metadata Service Authentication to be enabled using environment variables directly, this would skip over the autogeneration logic for the Kubernetes Secrets and DataHub GMS would default to the signing key specified statically in the application.yml. Most deployments probably did not attempt to circumvent the helm settings to enable Metadata Service Authentication during this time, so impact is most likely limited. Any deployments with Metadata Service Authentication enabled should ensure that their secret values are properly randomized. Version 0.2.182 contains a patch for this issue. As a workaround, one may reset the token signing key to be a random value, which will invalidate active personal access tokens."}, {"lang": "es", "value": "datahub-helm proporciona los gr\u00e1ficos de Kubernetes Helm para implementar Datahub y sus dependencias en un cl\u00faster de Kubernetes. A partir de la versi\u00f3n 0.1.143 y antes de la versi\u00f3n 0.2.182, debido a problemas de configuraci\u00f3n en el gr\u00e1fico de tim\u00f3n, si hab\u00eda una implementaci\u00f3n inicial exitosa durante un per\u00edodo de tiempo limitado, posiblemente se creaban tokens de acceso personal con una clave secreta predeterminada. Dado que la clave secreta es un valor est\u00e1tico y disponible p\u00fablicamente, alguien podr\u00eda inspeccionar el algoritmo utilizado para generar tokens de acceso personal y generar los suyos propios para una instancia. La implementaci\u00f3n con la autenticaci\u00f3n del servicio de metadatos habilitada habr\u00eda sido dif\u00edcil durante la ventana de lanzamientos. Si alguien eludi\u00f3 la configuraci\u00f3n del tim\u00f3n y configur\u00f3 manualmente la autenticaci\u00f3n del servicio de metadatos para que se habilite usando variables de entorno directamente, esto omitir\u00eda la l\u00f3gica de generaci\u00f3n autom\u00e1tica para Kubernetes Secrets y DataHub GMS usar\u00eda de forma predeterminada la clave de firma especificada est\u00e1ticamente en application.yml. La mayor\u00eda de las implementaciones probablemente no intentaron eludir la configuraci\u00f3n del tim\u00f3n para habilitar la autenticaci\u00f3n del servicio de metadatos durante este tiempo, por lo que el impacto probablemente sea limitado. Cualquier implementaci\u00f3n con la autenticaci\u00f3n del servicio de metadatos habilitada debe garantizar que sus valores secretos est\u00e9n correctamente aleatorizados. La versi\u00f3n 0.2.182 contiene un parche para este problema. Como workaround, se puede restablecer la clave de firma del token para que sea un valor aleatorio, lo que invalidar\u00e1 los tokens de acceso personal activos."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1394"}]}], "references": [{"url": "https://github.com/acryldata/datahub-helm/commit/ea8a17860f053c63387b8309e1f77c0e1462a1b3", "source": "security-advisories@github.com"}, {"url": "https://github.com/acryldata/datahub-helm/security/advisories/GHSA-82p6-9h7m-9h8j", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1110", "comment": "Using default or weak keys - CVE-2024-29037: CWE-1394 datahub-helm provides the Kubernetes Helm charts for deploying Datahub and its dependencies on a Kubernetes cluster. Starting in version 0.1.143 and prior to version 0.2.182, due to configuration issues in the helm chart, if there was a successful initial deployment during a limited window of time, personal access tokens were possibly created with a default secret key."}, {"techniqueID": "T1046", "comment": "Network Service Scanning - CVE-2024-29037: CWE-1394 datahub-helm provides the Kubernetes Helm charts for deploying Datahub and its dependencies on a Kubernetes cluster. Starting in version 0.1.143 and prior to version 0.2.182, due to configuration issues in the helm chart, if there was a successful initial deployment during a limited window of time, personal access tokens were possibly created with a default secret key."}, {"techniqueID": "T1560", "comment": "Asymmetric Cryptography - CVE-2024-29037: CWE-1394 datahub-helm provides the Kubernetes Helm charts for deploying Datahub and its dependencies on a Kubernetes cluster. Starting in version 0.1.143 and prior to version 0.2.182, due to configuration issues in the helm chart, if there was a successful initial deployment during a limited window of time, personal access tokens were possibly created with a default secret key."}], "stix_bundle": ["@stix-1-2-1.ova", "bundle", [{"id": "bundle-1-2-1", "type": "bundle", "created_by_ref": "https://gitlab.com/creators", "created": "2024-03-20T21:15:32.040", "modified": "2024-03-21T12:58:51.093", "label": "datahub-helm", "description": "Datahub-helm is a Helm chart for deploying Datahub on a Kubernetes cluster.", "contributed": "true", "package_versions": [{"name": "datahub-helm", "version": "0.2.182"}], "components": [{"id": "indicator-1-2-1", "type": "indicator", "created_by_ref": "https://gitlab.com/creators", "created": "2024-03-20T21:15:32.040", "modified": "2024-03-21T12:58:51.093", "label": "Personal Access Tokens", "description": "Access tokens potentially created with a default secret key.", "patternInfos": [{"type": "wildcard", "value": "*"}], "observed_data": [{"type": "file", "path": "application.yml"}]}], "CoursesOfAction": [{"id": "courses-of-action-1-2-1", "type": "courses-of-action", "name": "Reset Token Signing Key", "description": "Reset the token signing key to a random value to invalidate active personal access tokens.", "related_objects": [{"id": "technique-1-2-1", "type": "technique", "technique_id": "T1110"}]}]}]], "technical_analysis": {"Introduction": "datahub-helm provides the Kubernetes Helm charts for deploying Datahub and its dependencies on a Kubernetes cluster.", "Impact and Scope": "The CVE has a CVSS score of 9.1 and attack vector of NETWORK. It potentially affects personal access tokens created with a default secret key.", "Related MITRE ATT&CK Techniques": "T1110, T1046, T1560", "Technical Details": "Datahub-helm provides the Kubernetes Helm charts for deploying Datahub and its dependencies on a Kubernetes cluster. Starting in version 0.1.143 and prior to version 0.2.182, due to configuration issues in the helm chart, if there was a successful initial deployment during a limited window of time, personal access tokens were possibly created with a default secret key.", "Detection": "Detection methods include monitoring for abnormal authentication attempts and checking for default secret key usage.", "Mitigation": "Mitigation strategies include resetting the token signing key to a random value and ensuring that secret values are properly randomized.", "Conclusion": "In conclusion, the CVE has the potential to create personal access tokens with a default secret key, which can be used for unauthorized access. Implementing mitigation strategies is essential to prevent attacks."}, "executive_analysis": {"Overview": "datahub-helm provides the Kubernetes Helm charts for deploying Datahub and its dependencies on a Kubernetes cluster. The CVE has a potential impact on personal access tokens created with a default secret key.", "Business Impact": "The CVE has the potential to compromise datahub-helm deployments and create unauthorized access to sensitive data.", "Technical Impact": "The CVE affects datahub-helm deployments and creates a potential for unauthorized access to sensitive data.", "Mitigation Strategies": "Implementing mitigation strategies is essential to prevent attacks on datahub-helm deployments.", "Recommendations": "Recommendations include ensuring that secret values are properly randomized and regularly monitoring for abnormal authentication attempts.", "Conclusions": "In conclusion, the CVE has the potential to create unauthorized access to sensitive data. Implementing mitigation strategies is essential to prevent attacks."}}