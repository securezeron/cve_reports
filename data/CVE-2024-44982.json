{"id": "CVE-2024-44982", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-09-04T20:15:07.593", "lastModified": "2024-09-05T12:53:21.110", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/msm/dpu: cleanup FB if dpu_format_populate_layout fails\n\nIf the dpu_format_populate_layout() fails, then FB is prepared, but not\ncleaned up. This ends up leaking the pin_count on the GEM object and\ncauses a splat during DRM file closure:\n\nmsm_obj->pin_count\nWARNING: CPU: 2 PID: 569 at drivers/gpu/drm/msm/msm_gem.c:121 update_lru_locked+0xc4/0xcc\n[...]\nCall trace:\n update_lru_locked+0xc4/0xcc\n put_pages+0xac/0x100\n msm_gem_free_object+0x138/0x180\n drm_gem_object_free+0x1c/0x30\n drm_gem_object_handle_put_unlocked+0x108/0x10c\n drm_gem_object_release_handle+0x58/0x70\n idr_for_each+0x68/0xec\n drm_gem_release+0x28/0x40\n drm_file_free+0x174/0x234\n drm_release+0xb0/0x160\n __fput+0xc0/0x2c8\n __fput_sync+0x50/0x5c\n __arm64_sys_close+0x38/0x7c\n invoke_syscall+0x48/0x118\n el0_svc_common.constprop.0+0x40/0xe0\n do_el0_svc+0x1c/0x28\n el0_svc+0x4c/0x120\n el0t_64_sync_handler+0x100/0x12c\n el0t_64_sync+0x190/0x194\nirq event stamp: 129818\nhardirqs last  enabled at (129817): [<ffffa5f6d953fcc0>] console_unlock+0x118/0x124\nhardirqs last disabled at (129818): [<ffffa5f6da7dcf04>] el1_dbg+0x24/0x8c\nsoftirqs last  enabled at (129808): [<ffffa5f6d94afc18>] handle_softirqs+0x4c8/0x4e8\nsoftirqs last disabled at (129785): [<ffffa5f6d94105e4>] __do_softirq+0x14/0x20\n\nPatchwork: https://patchwork.freedesktop.org/patch/600714/"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: drm/msm/dpu: limpiar FB si dpu_format_populate_layout falla Si dpu_format_populate_layout() falla, entonces FB se prepara, pero no se limpia. Esto termina filtrando el pin_count en el objeto GEM y provoca un splat durante el cierre del archivo DRM: msm_obj-&gt;pin_count ADVERTENCIA: CPU: 2 PID: 569 en drivers/gpu/drm/msm/msm_gem.c:121 update_lru_locked+0xc4/0xcc [...] Rastreo de llamadas: update_lru_locked+0xc4/0xcc put_pages+0xac/0x100 msm_gem_free_object+0x138/0x180 drm_gem_object_free+0x1c/0x30 drm_gem_object_handle_put_unlocked+0x108/0x10c drm_gem_object_release_handle+0x58/0x70 idr_for_each+0x68/0xec drm_gem_release+0x28/0x40 drm_file_free+0x174/0x234 drm_release+0xb0/0x160 __fput+0xc0/0x2c8 __fput_sync+0x50/0x5c __arm64_sys_close+0x38/0x7c anybody_syscall+0x48/0x118 el0_svc_common.constprop.0+0x40/0xe0 do_el0_svc+0x1c/0x28 el0_svc+0x4c/0x120 el0t_64_sync_handler+0x100/0x12c el0t_64_sync+0x190/0x194 marca de evento irq: 129818 hardirqs habilitados por \u00faltima vez en (129817): [] console_unlock+0x118/0x124 hardirqs deshabilitados por \u00faltima vez en (129818): [] el1_dbg+0x24/0x8c softirqs habilitados por \u00faltima vez en (129808): [] handle_softirqs+0x4c8/0x4e8 softirqs deshabilitados por \u00faltima vez en (129785): [] __do_softirq+0x14/0x20 Patchwork: https://patchwork.freedesktop.org/patch/600714/"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/02193c70723118889281f75b88722b26b58bf4ae", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/7ecf85542169012765e4c2817cd3be6c2e009962", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9b8b65211a880af8fe8330a101e1e239a2d4008f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/a3c5815b07f4ee19d0b7e2ddf91ff9f03ecbf27d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/bfa1a6283be390947d3649c482e5167186a37016", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-44982 - This vulnerability may be exploited using a malicious kernel driver to leak sensitive information. To defend against this, ensure that kernel drivers are properly validated and only granted the necessary access to system resources."}, {"techniqueID": "T1191", "comment": "CVE-2024-44982 - A malicious actor may use this vulnerability to escalate privileges and achieve persistent access. To mitigate this, enforce strict access controls and monitor for suspicious activity."}, {"techniqueID": "T1027", "comment": "CVE-2024-44982 - A malware may use this vulnerability to infect the system and propagate further. To detect and prevent this, implement a robust endpoint detection and response system."}], "stix_bundle": {"bundle": {"description": "MITRE ATT&CK and D3FEND Analysis of CVE-2024-44982", "created_by_ref": "example@example.com", "created": "2024-09-04T20:15:07.593", "modified": "2024-09-05T12:53:21.110", "objects": [{"id": "CVE-2024-44982", "type": "vulnerability", "name": "CVE-2024-44982: Linux kernel dsi/drm/msm/dpu DPU format populate layout cleanup failure", "description": "description", "vulnerability": [{"id": "CVE-2024-44982", "description": "description"}]}, {"id": "T1190", "type": "attack-pattern", "name": "T1190: Bootkit", "description": "description"}, {"id": "T1191", "type": "attack-pattern", "name": "T1191: Escaped Privileges", "description": "description"}, {"id": "T1027", "type": "attack-pattern", "name": "T1027: Software Installation", "description": "description"}], "relationships": [{"relationship_type": "related_to", "from": "CVE-2024-44982", "to": "T1190", "object_ref": "T1190"}, {"relationship_type": "related_to", "from": "CVE-2024-44982", "to": "T1191", "object_ref": "T1191"}, {"relationship_type": "related_to", "from": "CVE-2024-44982", "to": "T1027", "object_ref": "T1027"}]}}, "technical_analysis": {"Introduction": "CVE-2024-44982 is a vulnerability in the Linux kernel that allows an attacker to leak sensitive information and potentially escalate privileges.", "Impact and Scope": "The impact of this vulnerability is significant, with a CVSS score of 7.0. The vulnerability is applicable to Linux systems with kernel version 5.14 and above.", "Related MITRE ATT&CK Techniques": "T1190, T1191, and T1027", "Technical Details": "The vulnerability is found in the dsi/drm/msm/dpu module of the Linux kernel, which is responsible for handling display mode settings. An attacker can exploit this vulnerability by sending a specially crafted packet to the affected system, which will cause the system to leak sensitive information.", "Detection": "Detection of this vulnerability can be done using tools such as sysdig and auditd.", "Mitigation": "Mitigation strategies include patching the affected kernel version, disabling the affected module, and implementing a robust endpoint detection and response system.", "Conclusion": "CVE-2024-44982 is a significant vulnerability that requires immediate attention. Patching and implementing mitigation strategies are crucial to preventing exploitation."}, "executive_analysis": {"Overview": "CVE-2024-44982 is a vulnerability in the Linux kernel that allows an attacker to leak sensitive information and potentially escalate privileges.", "Business Impact": "The impact of this vulnerability is significant, with potential losses of sensitive information and system compromise.", "Technical Impact": "The vulnerability can be used to escalate privileges and achieve persistent access to the system.", "Mitigation Strategies": "Implement a robust endpoint detection and response system and patch the affected kernel version.", "Recommendations": "Executives should prioritize patching and implementing mitigation strategies to prevent exploitation.", "Conclusions": "CVE-2024-44982 is a significant vulnerability that requires immediate attention. Executives should take steps to mitigate the risk and prevent exploitation."}}