{"id": "CVE-2024-45389", "sourceIdentifier": "security-advisories@github.com", "published": "2024-09-03T20:15:08.217", "lastModified": "2024-09-04T13:05:36.067", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Pagefind, a fully static search library, initializes its dynamic JavaScript and WebAssembly files relative to the location of the first script the user loads. This information is gathered by looking up the value of `document.currentScript.src`. Prior to Pagefind version 1.1.1, it is possible to \"clobber\" this lookup with otherwise benign HTML on the page. This will cause `document.currentScript.src` to resolve as an external domain, which will then be used by Pagefind to load dependencies. This exploit would only work in the case that an attacker could inject HTML to a live, hosted, website. In these cases, this would act as a way to escalate the privilege available to an attacker. This assumes they have the ability to add some elements to the page (for example, `img` tags with a `name` attribute), but not others, as adding a `script` to the page would itself be the cross-site scripting vector. Pagefind has tightened this resolution in version 1.1.1 by ensuring the source is loaded from a valid script element. There are no reports of this being exploited in the wild via Pagefind."}, {"lang": "es", "value": "Pagefind, una librer\u00eda de b\u00fasqueda completamente est\u00e1tica, inicializa sus archivos din\u00e1micos de JavaScript y WebAssembly en relaci\u00f3n con la ubicaci\u00f3n del primer script que carga el usuario. Esta informaci\u00f3n se obtiene buscando el valor de `document.currentScript.src`. Antes de la versi\u00f3n 1.1.1 de Pagefind, era posible \"bloquear\" esta b\u00fasqueda con HTML benigno en la p\u00e1gina. Esto har\u00e1 que `document.currentScript.src` se resuelva como un dominio externo, que luego ser\u00e1 utilizado por Pagefind para cargar dependencias. Esta vulnerabilidad solo funcionar\u00eda en el caso de que un atacante pudiera inyectar HTML en un sitio web alojado y en vivo. En estos casos, esto actuar\u00eda como una forma de escalar el privilegio disponible para un atacante. Esto supone que tienen la capacidad de agregar algunos elementos a la p\u00e1gina (por ejemplo, etiquetas `img` con un atributo `name`), pero no otros, ya que agregar un `script` a la p\u00e1gina ser\u00eda en s\u00ed mismo el vector de cross-site scripting. Pagefind ha mejorado esta resoluci\u00f3n en la versi\u00f3n 1.1.1 al garantizar que la fuente se cargue desde un elemento de script v\u00e1lido. No hay informes de que esto se haya explotado en la pr\u00e1ctica a trav\u00e9s de Pagefind."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "HIGH", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 4.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "references": [{"url": "https://github.com/CloudCannon/pagefind/commit/14ec96864eabaf1d7d809d5da0186a8856261eeb", "source": "security-advisories@github.com"}, {"url": "https://github.com/CloudCannon/pagefind/security/advisories/GHSA-gprj-6m2f-j9hx", "source": "security-advisories@github.com"}, {"url": "https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1059.003", "comment": "CVE-2024-45389 - This vulnerability can be exploited through the injection of malicious HTML into a hosted website, allowing an attacker to escalate privileges. This is relevant to defend against web-based attacks."}, {"techniqueID": "T1190", "comment": "CVE-2024-45389 - This vulnerability can be used as a vector for cross-site scripting (XSS) attacks, which can lead to the injection of malicious scripts into a website. This is relevant to defend against web-based attacks."}, {"techniqueID": "T1191", "comment": "CVE-2024-45389 - This vulnerability can be used to load external scripts and execute malicious code in a browser, allowing an attacker to compromise the victim's system. This is relevant to defend against web-based attacks."}, {"techniqueID": "T1651", "comment": "CVE-2024-45389 - This vulnerability can be used to escalate privileges and gain additional access to a compromised system. This is relevant to defend against web-based attacks."}], "stix_bundle": {"@doc": "https://docs.oasis-open.org/cti/stix/2.1/stix-core-v2.1.json", "bundle": {"id": "https://example.com/cve-2024-45389", "type": "bundle", "created_by_ref": "https://example.com/user", "created": "2024-09-04T13:05:36.067", "description": "Vulnerability Analysis for CVE-2024-45389", "objects": [{"id": "https://example.com/cve-2024-45389", "type": "vulnerability", "name": "CVE-2024-45389", "description": "Pagefind before 1.1.1 allows HTML injection, which can be used for privilege escalation.", "valid_from": "2024-09-03T20:15:08.217", "valid_until": "2024-09-04T13:05:36.067", "exploit_complexity": "HIGH", "exploit_vector": "NETWORK", "base_score": 6.4, "base_severity": "MEDIUM"}, {"id": "https://example.com/t1059.003", "type": "attack_pattern", "name": "T1059.003", "description": "Command and Control - Device Phishing", "kills_chain_id": "https://example.com/cve-2024-45389"}, {"id": "https://example.com/t1190", "type": "attack_pattern", "name": "T1190", "description": "Exploitation of Trusted Relationship", "kills_chain_id": "https://example.com/cve-2024-45389"}, {"id": "https://example.com/t1191", "type": "attack_pattern", "name": "T1191", "description": "Exploitation of Remote Services Execution", "kills_chain_id": "https://example.com/cve-2024-45389"}, {"id": "https://example.com/t1651", "type": "attack_pattern", "name": "T1651", "description": "Privilege Escalation - Token Impersonation", "kills_chain_id": "https://example.com/cve-2024-45389"}]}}, "technical_analysis": {"Introduction": "This analysis provides an overview of the vulnerability CVE-2024-45389 and its potential impact on an organization's systems and applications.", "Impact and Scope": "This vulnerability has a base score of 6.4 and a severity of MEDIUM, with a CVSS 3.1 vector of 'CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H'.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are relevant to this vulnerability: T1059.003, T1190, T1191, and T1651.", "Technical Details": "Pagefind before 1.1.1 allows HTML injection, which can be used for privilege escalation. An attacker can inject malicious HTML into a hosted website, allowing them to escalate privileges.", "Detection": "Detection methods include monitoring for suspicious traffic to the affected web application, as well as monitoring for unexpected changes to the system or application.", "Mitigation": "Mitigation strategies include applying the latest patches to the affected web application, as well as implementing additional security controls such as web application firewalls and intrusion detection systems.", "Conclusion": "In conclusion, CVE-2024-45389 is a significant vulnerability that can be exploited by an attacker to escalate privileges. It is essential to apply the latest patches and implement additional security controls to mitigate this threat."}, "executive_analysis": {"Overview": "This vulnerability report provides an overview of the vulnerability CVE-2024-45389 and its potential impact on an organization's systems and applications.", "Business Impact": "This vulnerability has the potential to allow an attacker to escalate privileges, which can lead to unauthorized access to sensitive data and systems.", "Technical Impact": "The technical impact of this vulnerability is the potential for an attacker to compromise the confidentiality, integrity, and availability of the affected system or application.", "Mitigation Strategies": "Mitigation strategies include applying the latest patches, implementing additional security controls, and monitoring for suspicious traffic to the affected web application.", "Recommendations": "We recommend that all affected systems and applications be patched immediately, and that additional security controls be implemented to mitigate this threat.", "Conclusions": "In conclusion, CVE-2024-45389 is a serious vulnerability that requires prompt attention and mitigation to protect against potential attacks."}}