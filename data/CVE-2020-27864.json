{"id": "CVE-2020-27864", "sourceIdentifier": "zdi-disclosures@trendmicro.com", "published": "2021-02-12T00:15:12.720", "lastModified": "2021-03-25T19:17:08.377", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of D-Link DAP-1860 firmware version 1.04B03 WiFi extenders. Authentication is not required to exploit this vulnerability. The specific flaw exists within the HNAP service, which listens on TCP port 80 by default. When parsing the Authorization request header, the process does not properly validate a user-supplied string before using it to execute a system call. An attacker can leverage this vulnerability to execute code in the context of the device. Was ZDI-CAN-10880."}, {"lang": "es", "value": "Esta vulnerabilidad permite a atacantes adyacentes a la red ejecutar c\u00f3digo arbitrario en las instalaciones afectadas de los extensores de WiFi D-Link DAP-1860 versi\u00f3n de firmware 1.04B03. No es requerida una autenticaci\u00f3n para explotar esta vulnerabilidad. El fallo espec\u00edfico se presenta dentro del servicio HNAP, que escucha en el puerto TCP 80 por defecto. Cuando se analiza el encabezado de la petici\u00f3n de autorizaci\u00f3n, el proceso no comprueba apropiadamente una cadena suministrada por el usuario antes de usarla para ejecutar una llamada de sistema. Un atacante puede aprovechar esta vulnerabilidad para ejecutar c\u00f3digo en el contexto del dispositivo. Era ZDI-CAN-10880"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV30": [{"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 8.3}, "baseSeverity": "HIGH", "exploitabilityScore": 6.5, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "zdi-disclosures@trendmicro.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-77"}]}, {"source": "nvd@nist.gov", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-77"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:dlink:dap-1860_firmware:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.04b03", "matchCriteriaId": "AC51840A-E03D-453E-823A-9C45DFF3184E"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:dlink:dap-1860:ax:*:*:*:*:*:*:*", "matchCriteriaId": "3327B4BA-90C2-42CC-A0E0-0180A7C7A359"}]}]}], "references": [{"url": "https://supportannouncement.us.dlink.com/announcement/publication.aspx?name=SAP10197", "source": "zdi-disclosures@trendmicro.com", "tags": ["Vendor Advisory"]}, {"url": "https://www.zerodayinitiative.com/advisories/ZDI-20-1428/", "source": "zdi-disclosures@trendmicro.com", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2020-27864 - This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of D-Link DAP-1860 firmware version 1.04B03 WiFi extenders. Authentication is not required to exploit this vulnerability, which is used in the HNAP service."}, {"techniqueID": "T1210", "comment": "This vulnerability can be exploited by an attacker who can send a crafted Authorization request header to the HNAP service. The service does not properly validate the input, allowing an attacker to execute arbitrary code on the device."}, {"techniqueID": "T1505", "comment": "An attacker can leverage this vulnerability to execute code in the context of the device, which allows them to execute arbitrary code, read and write files, or even gain access to the device's network."}], "stix_bundle": [{"id": "https://stix-2.1.xliff", "type": "bundle", "created": "2021-02-12 00:15:12.720", "modified": "2021-03-25 19:17:08.377", "objects": [{"id": "https://stix-2.1.xliff/ZDI-CAN-10880", "type": "vulnerability", "description": {"lang": "en", "value": "This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of D-Link DAP-1860 firmware version 1.04B03 WiFi extenders."}, "mitre_techniques": [{"technique_id": "T1027", "technique_name": "Remote Services"}, {"technique_id": "T1210", "technique_name": "Exploit Public-Facing Application"}, {"technique_id": "T1505", "technique_name": "Security Misconfiguration"}], "mitre_tactics": [{"tactic_id": "TA0003", "tactic_name": "Persistence"}, {"tactic_id": "TA0004", "tactic_name": "Defense Evaluation"}, {"tactic_id": "TA0005", "tactic_name": "Impact"}], "vulnerable_configuration": [{"cpe_match": "cpe:2.3:o:dlink:dap-1860_firmware:*:*:*:*:*:*:*:*"}]}]}], "technical_analysis": {"Introduction": "CVE-2020-27864 is a vulnerability in the HNAP service of D-Link DAP-1860 WiFi extenders that allows network-adjacent attackers to execute arbitrary code.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 with a base severity of high, and an attacker can exploit it to gain code execution, read and write files, or gain access to the device's network.", "Related MITRE ATT&CK Techniques": "T1027, T1210, and T1505 are the related MITRE ATT&CK techniques that are used in this vulnerability.", "Technical Details": "The vulnerability occurs when the HNAP service does not properly validate the input in the Authorization request header.", "Detection": "Detection methods include monitoring for unusual network traffic and analyzing logs for signs of exploitation.", "Mitigation": "Mitigation strategies include patching the vulnerable service, restricting network access, and monitoring for unusual network traffic.", "Conclusion": "CVE-2020-27864 is a critical vulnerability that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "CVE-2020-27864 is a vulnerability in D-Link DAP-1860 WiFi extenders that allows attackers to execute arbitrary code, which could result in data breaches, unauthorized access, or other serious consequences.", "Business Impact": "The severity of this vulnerability is high and requires immediate attention to prevent potential data breaches and unauthorized access.", "Technical Impact": "The vulnerability can be exploited to gain code execution, read and write files, or gain access to the device's network, which could result in serious consequences.", "Mitigation Strategies": "Patching the vulnerable service and restricting network access are the recommended mitigation strategies.", "Recommendations": "It is recommended to patch the vulnerable service and restrict network access to prevent exploitation of this vulnerability.", "Conclusions": "CVE-2020-27864 is a critical vulnerability that requires immediate attention and remediation to prevent potential data breaches and unauthorized access."}}