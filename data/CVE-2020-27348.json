{"id": "CVE-2020-27348", "sourceIdentifier": "security@ubuntu.com", "published": "2020-12-04T03:15:12.413", "lastModified": "2020-12-14T20:36:00.067", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In some conditions, a snap package built by snapcraft includes the current directory in LD_LIBRARY_PATH, allowing a malicious snap to gain code execution within the context of another snap if both plug the home interface or similar. This issue affects snapcraft versions prior to 4.4.4, prior to 2.43.1+16.04.1, and prior to 2.43.1+18.04.1."}, {"lang": "es", "value": "En algunas condiciones, un paquete snap creado por snapcraft incluye el directorio actual en LD_LIBRARY_PATH, permitiendo a un snap malicioso conseguir una ejecuci\u00f3n de c\u00f3digo dentro del contexto de otro snap si ambos conectan la interfaz de inicio o similar.&#xa0;Este problema afecta a Snapcraft versiones anteriores a 4.4.4, anteriores a 2.43.1+16.04.1 y anteriores a 2.43.1+18.04.1"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 5.5}, {"source": "security@ubuntu.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 5.5}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.4}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-427"}]}, {"source": "security@ubuntu.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-427"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:canonical:snapcraft:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.4.4", "matchCriteriaId": "68DD1264-E95B-4BFB-8E25-EE5AB9090693"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:*:*:*:*", "matchCriteriaId": "712507AC-DAB8-4FFE-9426-08282919411F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:*:*:*:*", "matchCriteriaId": "B85E9B9B-ADDB-4D2F-A857-685BD30CE856"}]}]}], "references": [{"url": "https://bugs.launchpad.net/bugs/1901572", "source": "security@ubuntu.com", "tags": ["Exploit", "Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/snapcore/snapcraft/pull/3345", "source": "security@ubuntu.com", "tags": ["Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/usn/usn-4661-1", "source": "security@ubuntu.com", "tags": ["Patch", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1552.001 - Abuse Elevation of Privilege", "comment": "CVE-2020-27348 allows a malicious snap to gain code execution within the context of another snap by exploiting the LD_LIBRARY_PATH. Defend against this vulnerability by limiting who can code to elevated privileges."}, {"techniqueID": "T1174 - File and Directory Discovery", "comment": "The vulnerability reveals the current directory in LD_LIBRARY_PATH, making it easier for attackers to discover and exploit file and directory structures."}, {"techniqueID": "T1212 - Exploitation of Remote Services", "comment": "A local attacker can exploit the vulnerability to gain elevated privileges, potentially allowing remote access to the system."}, {"techniqueID": "T1082 - System Network Configuration Discovery", "comment": "The vulnerability can provide attackers with information about the system's network configuration, allowing them to map the environment."}], "stix_bundle": "{\"spec_version\":\"2.1\",\"stix\":{\r\n  \"objects\": [\r\n    {\r\n      \"id\":\"cve-2020-27348\",\r\n      \"type\":\"vulnerability\",\r\n      \"created_by_ref\":\"<your_sire_ref>\",\r\n      \"description\":{\"value\":\"In some conditions, a snap package built by snapcraft includes the current directory in LD_LIBRARY_PATH, allowing a malicious snap to gain code execution within the context of another snap if both plug the home interface or similar.\"},\r\n      \" afecta\": [\r\n        {\r\n          \"id\":\"snapcraft\",\r\n          \"type\":\"affected-product\",\r\n          \"vulnerable_configuration\": \"*:*:*:*:*:*:*:*\"\r\n        },\r\n        {\r\n          \"id\":\"ubuntu_linux\",\r\n          \"type\":\"affected-product\",\r\n          \"vulnerable_configuration\": \"16.04:*:*:*:*:*:*:*\"},{\"id\":\"ubuntu_linux\",\"type\":\"affected-product\",\"vulnerable_configuration\": \"18.04:*:*:*:*:*:*:*\"}\r\n      ],\r\n      \"related_indicators\": [\r\n        {\r\n          \"id\":\"indicator_1\",\r\n          \"type\":\"indicator\",\r\n          \"related_objects\": \"cve-2020-27348\",\r\n          \"description\":{\"value\":\"Indicates presence of CVE-2020-27348\"},\r\n          \"x_open_phish_type\":\"Indicate\",\r\n          \"x_open_phish_subtype\":\"Vulnerability\"\r\n        }\r\n      ],\r\n      \"related_course_of_action\": [\r\n        {\r\n          \"id\":\"COA_1\",\r\n          \"type\":\"course_of_action\",\r\n          \"related_objects\": \"T1552.001\",\r\n          \"description\":{\"value\":\"Limit elevation of privilege access\"},\r\n          \"x_open_phish_type\":\"Mitigates\",\r\n          \"x_open_phish_subtype\":\"Vulnerability\"\r\n        },\r\n        {\r\n          \"id\":\"COA_2\",\r\n          \"type\":\"course_of_action\",\r\n          \"related_objects\": \"T1082\",\r\n          \"description\":{\"value\":\"Limit access to network configuration\"},\r\n          \"x_open_phish_type\":\"Mitigates\",\r\n          \"x_open_phish_subtype\":\"Vulnerability\"\r\n        }\r\n      ],\r\n      \"related_implementation\": [\r\n        {\r\n          \"id\":\"I_1\",\r\n          \"type\":\"implementation\",\r\n          \"related_objects\": \"cve-2020-27348\",\r\n          \"description\":{\"value\":\"Updated snapcraft version\"},\r\n          \"x_open_phish_type\":\"Replaces\",\r\n          \"x_open_phish_subtype\":\"Vulnerability\"\r\n        }\r\n      ],\r\n      \"related_note\": [\r\n        {\r\n          \"id\":\"N_1\",\r\n          \"type\":\"note\",\r\n          \"related_objects\": \"cve-2020-27348\",\r\n          \"description\":{\"value\":\"Limited access to network configuration\"},\r\n          \"x_open_phish_type\":\"Note\",\r\n          \"x_open_phish_subtype\":\"Vulnerability\"\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}}", "technical_analysis": {"Introduction": "CVE-2020-27348 is a vulnerability in snapcraft that allows a malicious snap to gain code execution within the context of another snap. This vulnerability is relevant to organizations that use snapcraft and could potentially allow attackers to gain elevated privileges.", "Impact and Scope": "The vulnerability has a CVSS score of 6.8 with a high severity rating, indicating significant potential impact. The vulnerability affects snapcraft versions prior to 4.4.4, and Ubuntu Linux versions 16.04 and 18.04.", "Related MITRE ATT&CK Techniques": "T1552.001, T1174, T1212, T1082", "Technical Details": "The vulnerability occurs when snapcraft includes the current directory in LD_LIBRARY_PATH, allowing a malicious snap to execute code within the context of another snap.", "Detection": "Detect the vulnerability by monitoring for unusual system configuration changes and unusual network activity.", "Mitigation": "Mitigate the vulnerability by limiting elevation of privilege access, limiting access to network configuration, and updating snapcraft to the latest version.", "Conclusion": "The vulnerability poses a significant risk to organizations that use snapcraft and could potentially allow attackers to gain elevated privileges. It is essential to take immediate action to detect and mitigate the vulnerability."}, "executive_analysis": {"Overview": "CVE-2020-27348 is a vulnerability in snapcraft that could potentially allow attackers to gain elevated privileges.", "Business Impact": "The vulnerability could lead to significant financial losses and reputational damage if exploited.", "Technical Impact": "The vulnerability has a high severity rating and could potentially allow attackers to gain elevated privileges.", "Mitigation Strategies": "Limit elevation of privilege access, limit access to network configuration, and update snapcraft to the latest version.", "Recommendations": "Implement the mitigation strategies immediately to protect against the vulnerability.", "Conclusions": "The vulnerability poses a significant risk to organizations that use snapcraft. It is essential to take immediate action to detect and mitigate the vulnerability."}}