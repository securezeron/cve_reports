{"id": "CVE-2024-38474", "sourceIdentifier": "security@apache.org", "published": "2024-07-01T19:15:04.760", "lastModified": "2024-08-21T15:03:30.407", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Substitution encoding issue in mod_rewrite in Apache HTTP Server 2.4.59 and earlier allows attacker to execute scripts in\ndirectories permitted by the configuration but not directly reachable by any\u00a0URL or source disclosure of scripts meant to only to be executed as CGI.\n\nUsers are recommended to upgrade to version 2.4.60, which fixes this issue.\n\nSome RewriteRules that capture and substitute unsafely will now fail unless rewrite flag \"UnsafeAllow3F\" is specified."}, {"lang": "es", "value": "El problema de codificaci\u00f3n de sustituci\u00f3n en mod_rewrite en Apache HTTP Server 2.4.59 y versiones anteriores permite al atacante ejecutar scripts en directorios permitidos por la configuraci\u00f3n pero a los que no se puede acceder directamente mediante ninguna URL o divulgaci\u00f3n de fuente de scripts destinados a ejecutarse \u00fanicamente como CGI. Se recomienda a los usuarios actualizar a la versi\u00f3n 2.4.60, que soluciona este problema. Algunas RewriteRules que capturan y sustituyen de forma insegura ahora fallar\u00e1n a menos que se especifique el indicador de reescritura \"UnsafeAllow3F\"."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@apache.org", "type": "Primary", "description": [{"lang": "en", "value": "CWE-116"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:http_server:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.4.0", "versionEndExcluding": "2.4.60", "matchCriteriaId": "13126636-FD76-4E3E-B949-14A5082DE02A"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:netapp:clustered_data_ontap:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "C3ED302E-F464-40DE-A976-FD518E42D95D"}]}]}], "references": [{"url": "https://httpd.apache.org/security/vulnerabilities_24.html", "source": "security@apache.org", "tags": ["Vendor Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20240712-0001/", "source": "security@apache.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059: Command and Control", "comment": "CVE-2024-38474 - This vulnerability can allow an attacker to execute scripts in directories permitted by the configuration, potentially leading to command and control activity. Defending against this involves restricting access to sensitive directories and implementing robust configuration management."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "CVE-2024-38474 - This vulnerability can be exploited by an attacker to access sensitive information in public-facing applications. Defending against this involves ensuring that all public-facing applications are up-to-date with the latest security patches and implementing robust application security controls."}, {"techniqueID": "T1191: Cross-Site Scripting", "comment": "CVE-2024-38474 - This vulnerability can be exploited by an attacker to inject malicious scripts into a web application, potentially leading to cross-site scripting. Defending against this involves implementing robust input validation and sanitization controls in web applications."}, {"techniqueID": "T1204: User Execution", "comment": "CVE-2024-38474 - This vulnerability can be exploited by an attacker to trick a user into executing a malicious script, potentially leading to user-level execution. Defending against this involves implementing robust user authentication and authorization controls and educating users to avoid executing unfamiliar scripts."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "vulnerability-CVE-2024-38474", "name": "CVE-2024-38474", "description": "CWE-116: Untrusted Data", "severity": "High", "modified": "2024-08-21T15:03:30.407", "created": "2024-07-01T19:15:04.760"}, {"type": "indicator", "id": "indicator-ModRewrite", "name": "Apache HTTP Server ModRewrite Vulnerability", "description": "Indication of Apache HTTP Server ModRewrite vulnerability", "created": "2024-07-01T19:15:04.760", "modified": "2024-08-21T15:03:30.407"}, {"type": "course-of-action", "id": "course-of-action-UpgradeApache", "name": "Upgrade Apache HTTP Server to 2.4.60", "description": "Upgrade Apache HTTP Server to version 2.4.60 to mitigate CVE-2024-38474", "created": "2024-07-01T19:15:04.760", "modified": "2024-08-21T15:03:30.407", "related_techniques": ["T1059", "T1190"]}, {"type": "course-of-action", "id": "course-of-action-RestrictAccess", "name": "Restrict Access to Sensitive Directories", "description": "Restrict access to sensitive directories to prevent command and control activity", "created": "2024-07-01T19:15:04.760", "modified": "2024-08-21T15:03:30.407", "related_techniques": ["T1059", "T1190"]}], "relationships": [{"from": "vulnerability-CVE-2024-38474", "to": "indicator-ModRewrite", "relationship": "indicates"}, {"from": "vulnerability-CVE-2024-38474", "to": "course-of-action-UpgradeApache", "relationship": "mitigates"}, {"from": "vulnerability-CVE-2024-38474", "to": "course-of-action-RestrictAccess", "relationship": "mitigates"}]}, "technical_analysis": {"Introduction": "Apache HTTP Server ModRewrite vulnerability (CVE-2024-38474) allows an attacker to execute scripts in directories permitted by the configuration.", "Impact and Scope": "This vulnerability has a CVSS score of 9.8, impacting Apache HTTP Server 2.4.59 and earlier versions, and can potentially lead to command and control activity, user-level execution, and cross-site scripting.", "Related MITRE ATT&CK Techniques": "T1059: Command and Control, T1190: Exploit Public-Facing Application, T1191: Cross-Site Scripting, T1204: User Execution", "Technical Details": "The vulnerability is caused by a substitution encoding issue in mod_rewrite, allowing an attacker to execute scripts in directories permitted by the configuration.", "Detection": "Detecting this vulnerability involves monitoring for suspicious script execution and configuration inconsistencies.", "Mitigation": "Mitigating this vulnerability involves upgrading Apache HTTP Server to version 2.4.60 and restricting access to sensitive directories.", "Conclusion": "Summary and conclusions."}, "executive_analysis": {"Overview": "Apache HTTP Server ModRewrite vulnerability (CVE-2024-38474) poses a high-risk threat to organizations using affected versions of the Apache HTTP Server.", "Business Impact": "The vulnerability can potentially lead to significant business disruptions and data breaches.", "Technical Impact": "The vulnerability can potentially compromise system integrity, confidentiality, and availability.", "Mitigation Strategies": "Urgent upgrade to Apache HTTP Server 2.4.60 and restricting access to sensitive directories.", "Recommendations": "Recommendations for executives include implementing robust application security controls, monitoring for suspicious activity, and educating users on avoiding execution of unfamiliar scripts.", "Conclusions": "Final conclusions and next steps."}}