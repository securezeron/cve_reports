{"id": "CVE-2009-3220", "sourceIdentifier": "cve@mitre.org", "published": "2009-09-16T19:30:00.547", "lastModified": "2018-10-10T19:43:14.157", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHP remote file inclusion vulnerability in cp_html2txt.php in All In One Control Panel (AIOCP) 1.4.001 allows remote attackers to execute arbitrary PHP code via a URL in the page parameter."}, {"lang": "es", "value": "Vulnerabilidad de inclusi\u00f3n remota de archivo PHP en All In One Control Panel (AIOCP) v1.4.001 permite a atacantes remotos ejecutar c\u00f3digo PHP de su elecci\u00f3n a trav\u00e9s de una URL en el par\u00e1metro page."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:tecnick:aiocp:1.4.001:*:*:*:*:*:*:*", "matchCriteriaId": "2AC7DB67-3FCE-4EF7-81EA-A90FE4B61B21"}]}]}], "references": [{"url": "http://www.securityfocus.com/archive/1/505250/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/35811", "source": "cve@mitre.org", "tags": ["Exploit"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2009-3220 - Remote File Inclusion vulnerability in AIOCP, allows attackers to execute arbitrary code. Defenders can use techniques like network traffic analysis to detect and prevent this type of attack."}, {"techniqueID": "T1196", "comment": "CVE-2009-3220 - Phishing and spear phishing attacks can be used to trick users into visiting a page with a malicious URL, exploiting the remote file inclusion vulnerability. Defenders can use email and web page analysis to detect and prevent such attacks."}, {"techniqueID": "T1069", "comment": "CVE-2009-3220 - Defenders can use techniques like process and network enumeration to identify potential command and control channels used by attackers to exploit this vulnerability."}, {"techniqueID": "T1086", "comment": "CVE-2009-3220 - Lateral movement and privilege escalation can occur once an attacker gains access to the system. Defenders can use techniques like network configuration and account monitoring to detect and prevent this type of movement."}], "stix_bundle": {"$schema": "https://raw.githubusercontent.com/oasis-tcs/stix2/master/schema/json/stix-v2.1.json", "id": "bundle--cve-2009-3220", "type": "bundle", "objects": [{"type": "vulnerability", "id": "vulnerability--cve-2009-3220", "name": "CVE-2009-3220", "description": "PHP remote file inclusion vulnerability in cp_html2txt.php in All In One Control Panel (AIOCP) 1.4.001 allows remote attackers to execute arbitrary PHP code via a URL in the page parameter."}, {"type": "attack_pattern", "id": "attack_pattern--cve-2009-3220-t1059", "name": "T1059 - Remote File Inclusion (RCE)", "description": "This attack pattern takes advantage of the remote file inclusion vulnerability in AIOCP to execute arbitrary PHP code."}, {"type": "intrusion_set", "id": "intrusion_set--cve-2009-3220-t1196", "name": "Phishing and Spear Phishing Attack", "description": "This intrusion set uses phishing and spear phishing attacks to trick users into visiting a page with a malicious URL."}, {"type": "course_of_action", "id": "course_of_action--cve-2009-3220-t1069", "name": "Process and Network Enumeration", "description": "This course of action involves enumerating processes and networks to identify potential command and control channels.", "action_text": "The defender will use process and network enumeration to identify potential command and control channels.", "mitigated_by": [{"id": "attack_pattern--cve-2009-3220-t1059"}]}, {"type": "course_of_action", "id": "course_of_action--cve-2009-3220-t1086", "name": "Network Configuration and Account Monitoring", "description": "This course of action involves monitoring network configuration and account activities to detect and prevent lateral movement.", "action_text": "The defender will use network configuration and account monitoring to detect and prevent lateral movement.", "mitigated_by": [{"id": "attack_pattern--cve-2009-3220-t1059"}]}, {"type": "note", "id": "note--cve-2009-3220-technical-details", "name": "Technical Details", "content": "The vulnerability is caused by the lack of input validation and sanitation in the `cp_html2txt.php` file. An attacker can exploit this by submitting a crafted URL in the `page` parameter."}], "correlations": [{"relates_to": "vulnerability--cve-2009-3220", "related_object_id": "attack_pattern--cve-2009-3220-t1059"}, {"relates_to": "vulnerability--cve-2009-3220", "related_object_id": "course_of_action--cve-2009-3220-t1069"}, {"relates_to": "vulnerability--cve-2009-3220", "related_object_id": "course_of_action--cve-2009-3220-t1086"}, {"relates_to": "attack_pattern--cve-2009-3220-t1059", "related_object_id": "course_of_action--cve-2009-3220-t1069"}, {"relates_to": "attack_pattern--cve-2009-3220-t1059", "related_object_id": "course_of_action--cve-2009-3220-t1086"}]}, "technical_analysis": {"Introduction": "The CVE-2009-3220 vulnerability is a remote file inclusion vulnerability in the cp_html2txt.php file of AIOCP 1.4.001.", "Impact and Scope": "The vulnerability allows an attacker to execute arbitrary PHP code, potentially leading to remote code execution. CVSS score: 7.5 (high). Attack vector: network.", "Related MITRE ATT&CK Techniques": "T1059, T1196, T1069, T1086", "Technical Details": "The vulnerability is caused by the lack of input validation and sanitation in the `cp_html2txt.php` file. An attacker can exploit this by submitting a crafted URL in the `page` parameter.", "Detection": "Network traffic analysis and log monitoring can be used to detect and prevent this type of attack.", "Mitigation": "Applying proper input validation and sanitization, limiting access to sensitive files and directories, and implementing intrusion detection and prevention systems can help mitigate this vulnerability.", "Conclusion": "The CVE-2009-3220 vulnerability highlights the importance of proper input validation and sanitization in web applications, as well as the need for robust security controls and monitoring."}, "executive_analysis": {"Overview": "The CVE-2009-3220 vulnerability is a remote file inclusion vulnerability in AIOCP 1.4.001, allowing attackers to execute arbitrary PHP code.", "Business Impact": "Successful exploitation of this vulnerability can lead to remote code execution, potentially compromising sensitive data and disrupting business operations.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary PHP code, potentially leading to remote code execution and resulting in a loss of confidentiality, integrity, and availability.", "Mitigation Strategies": "Implementing proper input validation and sanitization, limiting access to sensitive files and directories, and implementing intrusion detection and prevention systems can help mitigate this vulnerability.", "Recommendations": "Patching the vulnerable version of AIOCP 1.4.001 and implementing robust security controls can help prevent exploitation of this vulnerability.", "Conclusions": "The CVE-2009-3220 vulnerability highlights the need for proactive security measures, regular patching, and robust security controls to prevent attacks and protect against potential threats."}}