{"id": "CVE-2020-5236", "sourceIdentifier": "security-advisories@github.com", "published": "2020-02-04T03:15:10.750", "lastModified": "2020-02-06T18:46:27.267", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Waitress version 1.4.2 allows a DOS attack When waitress receives a header that contains invalid characters. When a header like \"Bad-header: xxxxxxxxxxxxxxx\\x10\" is received, it will cause the regular expression engine to catastrophically backtrack causing the process to use 100% CPU time and blocking any other interactions. This allows an attacker to send a single request with an invalid header and take the service offline. This issue was introduced in version 1.4.2 when the regular expression was updated to attempt to match the behaviour required by errata associated with RFC7230. The regular expression that is used to validate incoming headers has been updated in version 1.4.3, it is recommended that people upgrade to the new version of Waitress as soon as possible."}, {"lang": "es", "value": "Waitress versi\u00f3n 1.4.2, permite un ataque de DOS cuando waitress recibe un encabezado que contiene caracteres no v\u00e1lidos. Cuando un encabezado como \"Bad-header: xxxxxxxxxxxxxxx\\x10\" es recibido, causar\u00e1 que el motor de expresi\u00f3n regular retroceda catastr\u00f3ficamente, provocando que el proceso utilice el 100% del tiempo de CPU y bloquee cualquier otras interacciones. Esto permite a un atacante enviar una \u00fanica petici\u00f3n con un encabezado no v\u00e1lido y desconectar el servicio. Este problema fue introducido en la versi\u00f3n 1.4.2 cuando se actualiz\u00f3 la expresi\u00f3n regular para intentar hacer coincidir el comportamiento requerido por las erratas asociadas con RFC7230. La expresi\u00f3n regular que se usa para comprobar los encabezados entrantes se actualiz\u00f3 en la versi\u00f3n 1.4.3, se recomienda que las personas actualicen a la nueva versi\u00f3n de Waitress tan pronto como sea posible."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:N/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "COMPLETE", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-400"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-400"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:agendaless:waitress:1.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "3C433875-4299-4F58-AB6A-D7E9A815329B"}]}]}], "references": [{"url": "https://github.com/Pylons/waitress/commit/6e46f9e3f014d64dd7d1e258eaf626e39870ee1f", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/Pylons/waitress/security/advisories/GHSA-73m2-3pwg-5fgc", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1203", "comment": "CVE-2020-5236 - This technique is relevant as it describes an instance of a 'Denial of Service' (DoS) attack, which is exploited by sending a crafted HTTP header that causes the regular expression engine to catastrophically backtrack, leading to a CPU usage of 100%. The technique is used by the attacker to take the service offline, making it unavailable to legitimate users."}, {"techniqueID": "T1055", "comment": "CVE-2020-5236 - This technique is used to gain unauthorized access to the system, allowing the attacker to send a single request with an invalid header that causes the regular expression engine to backtrace, leading to a CPU usage of 100%. This allows the attacker to take the service offline, making it unavailable to legitimate users."}, {"techniqueID": "T1190", "comment": "CVE-2020-5236 - This technique is used by the attacker to crash the web server, making the service unavailable to legitimate users. This is achieved by sending a crafted HTTP header that causes the regular expression engine to catastrophically backtrack, leading to a CPU usage of 100%. This can be prevented by updating to a newer version of Waitress that fixes the issue."}, {"techniqueID": "T1065", "comment": "CVE-2020-5236 - This technique is used by the attacker to create a denial of service attack, which can be prevented by detecting and blocking suspicious patterns in the HTTP headers. The regular expression engine can be exploited by sending a crafted HTTP header that causes it to backtrace, leading to a CPU usage of 100%. "}], "stix_bundle": "/* Add STIX 2.1 bundle here */", "technical_analysis": {"Introduction": "Waitress version 1.4.2 allows a DOS attack when it receives a header that contains invalid characters.", "Impact and Scope": "This vulnerability has a CVSS score of 6.5 and 5.7, respectively, in CVSS versions 3.1 and 2.0, which indicates a high impact and medium severity. The attack vector is network-based, and the privileges required are low, meaning that an unauthenticated user can exploit this vulnerability.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are information gathering, denial of service, and web shellcoding.", "Technical Details": "The regular expression engine in Waitress version 1.4.2 has been updated to match the behavior required by errata associated with RFC7230.", "Detection": "Detection can be achieved by monitoring for suspicious patterns in HTTP headers and by implementing rate limiting to prevent DOS attacks.", "Mitigation": "Mitigation strategies include updating to a newer version of Waitress, detecting and blocking suspicious patterns in HTTP headers, and implementing rate limiting to prevent DOS attacks.", "Conclusion": "This vulnerability is relevant for security professionals and developers, as it highlights the importance of regular expression engine security in web servers."}, "executive_analysis": {"Overview": "Waitress version 1.4.2 allows a DOS attack when it receives a header that contains invalid characters, which can be exploited to take the service offline.", "Business Impact": "This vulnerability can have significant business impacts, including revenue loss and disruption of business operations.", "Technical Impact": "This vulnerability can have significant technical impacts, including data corruption and system crashes.", "Mitigation Strategies": "Updating to a newer version of Waitress, detecting and blocking suspicious patterns in HTTP headers, and implementing rate limiting to prevent DOS attacks.", "Recommendations": "Recommendations include conducting thorough vulnerability assessments, implementing a penetration testing program, and staying up-to-date with security patches.", "Conclusions": "In conclusion, this vulnerability highlights the importance of regular expression engine security in web servers and emphasizes the need for thorough vulnerability assessments and regular security updates."}}