{"id": "CVE-2024-40628", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-18T17:15:04.370", "lastModified": "2024-07-19T13:01:44.567", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "JumpServer is an open-source Privileged Access Management (PAM) tool that provides DevOps and IT teams with on-demand and secure access to SSH, RDP, Kubernetes, Database and RemoteApp endpoints through a web browser. An attacker can exploit the ansible playbook to read arbitrary files in the celery container, leading to sensitive information disclosure. The Celery container runs as root and has database access, allowing the attacker to steal all secrets for hosts, create a new JumpServer account with admin privileges, or manipulate the database in other ways. This issue has been addressed in release versions 3.10.12 and 4.0.0. It is recommended to upgrade the safe versions. There is no known workarounds for this vulnerability."}, {"lang": "es", "value": "JumpServer es una herramienta de gesti\u00f3n de acceso privilegiado (PAM) de c\u00f3digo abierto que proporciona a los equipos de TI y DevOps acceso seguro y bajo demanda a terminales SSH, RDP, Kubernetes, bases de datos y RemoteApp a trav\u00e9s de un navegador web. Un atacante puede aprovechar el libro de jugadas de ansible para leer archivos arbitrarios en el contenedor de apio, lo que lleva a la divulgaci\u00f3n de informaci\u00f3n confidencial. El contenedor Celery se ejecuta como root y tiene acceso a la base de datos, lo que permite al atacante robar todos los secretos de los hosts, crear una nueva cuenta JumpServer con privilegios de administrador o manipular la base de datos de otras formas. Este problema se solucion\u00f3 en las versiones 3.10.12 y 4.0.0. Se recomienda actualizar las versiones seguras. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-22"}]}], "references": [{"url": "https://github.com/jumpserver/jumpserver/security/advisories/GHSA-rpf7-g4xh-84v9", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1562", "comment": "CVE-2024-40628 - An attacker can exploit the Ansible playbook to read arbitrary files in the Celery container, allowing sensitive information disclosure."}, {"techniqueID": "T1078", "comment": "CVE-2024-40628 - An attacker can use the vulnerable Ansible playbook to execute malicious code and potentially achieve code execution on the system."}, {"techniqueID": "T1056", "comment": "CVE-2024-40628 - An attacker can use the vulnerable Ansible playbook to access sensitive data and potentially achieve data theft."}, {"techniqueID": "T1047", "comment": "CVE-2024-40628 - An attacker can use the vulnerable Ansible playbook to gain access to the system and potentially achieve persistence."}], "stix_bundle": {"typ": "bundle", "id": "bundle--11111111-1111-1111-1111-111111111111", "spec_version": "2.1", "object_refs": [{"id": "object--11111111-1111-1111-1111-111111111111", "type": "vulnerability"}], "objects": {"object--11111111-1111-1111-1111-111111111111": {"typ": "vulnerability", "id": "object--11111111-1111-1111-1111-111111111111", "created_by_ref": "identity--11111111-1111-1111-1111-111111111111", "modified": "2024-07-19T13:01:44.567", "description": {"text": "CVE-2024-40628 - An attacker can exploit the Ansible playbook to read arbitrary files in the Celery container, allowing sensitive information disclosure."}, "vulnerability_properties": {"cvss": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"}}, "effects": {"impacted-resources": [{"resource_type": "Container", "resource_id": "Celery container"}]}, "actions": [{"id": "action--11111111-1111-1111-1111-111111111111", "type": "read-arbitrary-files"}], "mitigations": [{"id": "mitigation--11111111-1111-1111-1111-111111111111", "type": "Update JumpServer to version 3.10.12 or 4.0.0"}]}}}, "technical_analysis": {"Introduction": "CVE-2024-40628 is a vulnerability in JumpServer's Ansible playbook that allows an attacker to read arbitrary files in the Celery container.", "Impact and Scope": "The vulnerability has a CVSS score of 10.0 with a severity rating of CRITICAL. It is rated as HIGH for confidentiality, integrity, and availability. The attack vector is NETWORK, and the privileges required are NONE.", "Related MITRE ATT&CK Techniques": "T1562, T1078, T1056, and T1047", "Technical Details": "The vulnerability is due to an insecure Ansible playbook that can be exploited by an attacker to read arbitrary files in the Celery container, leading to sensitive information disclosure.", "Detection": "Detection methods include monitoring the Ansible playbook for suspicious activity and monitoring the Celery container for unauthorized access.", "Mitigation": "The vulnerability can be mitigated by updating JumpServer to version 3.10.12 or 4.0.0.", "Conclusion": "In conclusion, CVE-2024-40628 is a critical vulnerability that allows an attacker to read arbitrary files in the Celery container. It is recommended to update JumpServer to the latest version to mitigate this vulnerability."}, "executive_analysis": {"Overview": "CVE-2024-40628 is a critical vulnerability in JumpServer's Ansible playbook that allows an attacker to read arbitrary files in the Celery container.", "Business Impact": "The vulnerability has a significant business impact as it could allow an attacker to steal sensitive information, gain unauthorized access to systems, and disrupt business operations.", "Technical Impact": "The vulnerability has a significant technical impact as it could allow an attacker to execute malicious code, steal sensitive data, and gain persistence on the system.", "Mitigation Strategies": "The recommended mitigation strategy is to update JumpServer to version 3.10.12 or 4.0.0.", "Recommendations": "It is recommended that executives prioritize updating JumpServer to the latest version and implementing additional security measures to mitigate the risk of this vulnerability.", "Conclusions": "In conclusion, CVE-2024-40628 is a critical vulnerability that requires immediate attention. It is recommended that executives prioritize updating JumpServer and implementing additional security measures to mitigate the risk of this vulnerability."}}