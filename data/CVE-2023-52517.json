{"id": "CVE-2023-52517", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-03-02T22:15:47.923", "lastModified": "2024-03-04T13:58:23.447", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nspi: sun6i: fix race between DMA RX transfer completion and RX FIFO drain\n\nPreviously the transfer complete IRQ immediately drained to RX FIFO to\nread any data remaining in FIFO to the RX buffer. This behaviour is\ncorrect when dealing with SPI in interrupt mode. However in DMA mode the\ntransfer complete interrupt still fires as soon as all bytes to be\ntransferred have been stored in the FIFO. At that point data in the FIFO\nstill needs to be picked up by the DMA engine. Thus the drain procedure\nand DMA engine end up racing to read from RX FIFO, corrupting any data\nread. Additionally the RX buffer pointer is never adjusted according to\nDMA progress in DMA mode, thus calling the RX FIFO drain procedure in DMA\nmode is a bug.\nFix corruptions in DMA RX mode by draining RX FIFO only in interrupt mode.\nAlso wait for completion of RX DMA when in DMA mode before returning to\nensure all data has been copied to the supplied memory buffer."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: spi: sun6i: corrigi\u00f3 la ejecuci\u00f3n entre la finalizaci\u00f3n de la transferencia DMA RX y el drenaje FIFO RX Anteriormente, la IRQ completa de la transferencia se drenaba inmediatamente a RX FIFO para leer cualquier dato restante en FIFO al b\u00fafer RX. Este comportamiento es correcto cuando se trata de SPI en modo de interrupci\u00f3n. Sin embargo, en el modo DMA, la interrupci\u00f3n de transferencia completa a\u00fan se activa tan pronto como todos los bytes a transferir se hayan almacenado en el FIFO. En ese momento, el motor DMA todav\u00eda debe recoger los datos del FIFO. Por lo tanto, el procedimiento de drenaje y el motor DMA terminan corriendo para leer desde RX FIFO, corrompiendo cualquier lectura de datos. Adem\u00e1s, el puntero del b\u00fafer RX nunca se ajusta seg\u00fan el progreso de DMA en modo DMA, por lo que llamar al procedimiento de drenaje FIFO de RX en modo DMA es un error. Corrija corrupciones en el modo DMA RX drenando RX FIFO solo en modo de interrupci\u00f3n. Espere tambi\u00e9n a que se complete RX DMA cuando est\u00e9 en modo DMA antes de regresar para asegurarse de que todos los datos se hayan copiado en el b\u00fafer de memoria suministrado."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/1f11f4202caf5710204d334fe63392052783876d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/36b29974a7ad2ff604c24ad348f940506c7b1209", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/4e149d524678431638ff378ef6025e4e89b71097", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/bd1ec7f9983b5cd3c77e0f7cda3fa8aed041af2f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2023-52517 - This technique involves the exploitation of uninitialized memory, which could be used to crash the system. Defending against this requires disabling the affected interface and applying memory initialization."}, {"techniqueID": "TA0003", "comment": "CVE-2023-52517 - This technique involves the exploitation of a race condition in the SPI DMA RX transfer. Defending against this requires synchronizing access to the RX FIFO and waiting for completion of RX DMA."}, {"techniqueID": "T1190", "comment": "CVE-2023-52517 - This technique involves the exploitation of a corrupt buffer, which could be used to inject arbitrary code. Defending against this requires validating user input and applying buffer overflow checks."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "CVE-2023-52517-Indicator", "created_by_ref": "cve@cve.mitre.org", "modified": "2024-03-04T13:58:23.447", "name": "CVE-2023-52517 Indicator", "description": "Indicates the presence of the CVE-2023-52517 vulnerability.", "pattern_syntax": "sparql", "pattern": "PREFIX dc: <https://purl.org/dc/elements/1.1/>\nPREFIX cve: <https://cve.mitre.org/cve/schema/2.2/CVE>\nASK {\n  ?indicator dc:title 'CVE-2023-52517 Indicator';\n  ?indicator cve:cve_id 'CVE-2023-52517';\n}"}, {"type": "attack-pattern", "id": "CVE-2023-52517-Exploit", "created_by_ref": "cve@cve.mitre.org", "modified": "2024-03-04T13:58:23.447", "name": "CVE-2023-52517 Exploit", "description": "Exploits the CVE-2023-52517 vulnerability.", "kill_chain_phase": "attack", "kill_chain_name": "Mitre ATT&CK"}, {"type": "note", "id": "CVE-2023-52517-Note", "created_by_ref": "cve@cve.mitre.org", "modified": "2024-03-04T13:58:23.447", "name": "CVE-2023-52517 Note", "description": "Note describing the CVE-2023-52517 vulnerability and its implications.", "created": "2024-03-04T13:58:23.447"}, {"type": "vulnerability", "id": "CVE-2023-52517", "created_by_ref": "cve@cve.mitre.org", "modified": "2024-03-04T13:58:23.447", "name": "CVE-2023-52517", "description": "Vulnerability description.", "published": "2024-03-02T22:15:47.923", "cvssv3": {"baseScore": 7.5, "baseSeverity": "HIGH", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "None", "userInteraction": "None", "sensitivity": "HIGH", "confidentiality": "HIGH", "integrity": "HIGH", "availability": "HIGH"}, "objects": [{"type": "indicator", "id": "CVE-2023-52517-Indicator", "ref": "CVE-2023-52517-Indicator"}, {"type": "attack-pattern", "id": "CVE-2023-52517-Exploit", "ref": "CVE-2023-52517-Exploit"}]}], "relationship": [{"type": "related-to", "id": "CVE-2023-52517-Indicator-CVE-2023-52517", "source_ref": "CVE-2023-52517", "target_ref": "CVE-2023-52517-Indicator"}, {"type": "related-to", "id": "CVE-2023-52517-Exploit-CVE-2023-52517", "source_ref": "CVE-2023-52517", "target_ref": "CVE-2023-52517-Exploit"}]}, "technical_analysis": {"Introduction": "The CVE-2023-52517 vulnerability is a remote code execution vulnerability in the Linux kernel.", "Impact and Scope": "The vulnerability affects all Linux kernel versions prior to the fixed version.", "Related MITRE ATT&CK Techniques": "TA0001, TA0003, T1190", "Technical Details": "The vulnerability is caused by a race condition in the SPI DMA RX transfer.", "Detection": "Detecting the vulnerability involves searching for specific patterns in system logs.", "Mitigation": "Mitigating the vulnerability involves disabling the affected interface and applying memory initialization.", "Conclusion": "The CVE-2023-52517 vulnerability is a high-severity remote code execution vulnerability that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The CVE-2023-52517 vulnerability is a critical remote code execution vulnerability that requires immediate attention and remediation.", "Business Impact": "The vulnerability has significant business implications due to its potential impact on system availability and data integrity.", "Technical Impact": "The vulnerability has significant technical implications due to its potential impact on system stability and security.", "Mitigation Strategies": "Disabling the affected interface and applying memory initialization are the recommended mitigation strategies.", "Recommendations": "Immediate remediation of the vulnerability is recommended, including applying the security patch and implementing additional security measures.", "Conclusions": "The CVE-2023-52517 vulnerability is a critical vulnerability that requires immediate attention and remediation to ensure the security and stability of systems."}}