{"id": "CVE-2024-30378", "sourceIdentifier": "sirt@juniper.net", "published": "2024-04-16T20:15:09.680", "lastModified": "2024-05-16T18:15:09.407", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A Use After Free vulnerability in command processing of Juniper Networks Junos OS on MX Series allows a local, authenticated attacker to cause the broadband edge service manager daemon (bbe-smgd) to crash upon execution of specific CLI commands, creating a Denial of Service (DoS) condition.\u00a0 The process crashes and restarts automatically.\n\nWhen specific CLI commands are executed, the bbe-smgd daemon attempts to write into an area of memory (mgd socket) that was already closed, causing the process to crash.\u00a0 This process manages and controls the configuration of broadband subscriber sessions and services.\u00a0 While the process is unavailable, additional subscribers will not be able to connect to the device, causing a temporary Denial of Service condition.\n\nThis issue only occurs if\u00a0Graceful Routing Engine Switchover (GRES) and Subscriber Management are enabled.\nThis issue affects Junos OS:\n\n\n  *  All versions before 20.4R3-S5, \n  *  from 21.1 before 21.1R3-S4, \n  *  from 21.2 before 21.2R3-S3, \n  *  from 21.3 before 21.3R3-S5, \n  *  from 21.4 before 21.4R3-S5, \n  *  from 22.1 before 22.1R3, \n  *  from 22.2 before 22.2R3, \n  *  from 22.3 before 22.3R2;"}, {"lang": "es", "value": "Una vulnerabilidad Use After Free en el procesamiento de comandos de Juniper Networks Junos OS en la serie MX permite que un atacante local autenticado provoque que el demonio del administrador de servicios de banda ancha (bbe-smgd) se bloquee al ejecutar comandos CLI espec\u00edficos, creando una condici\u00f3n de denegaci\u00f3n de servicio ( DoS). El proceso falla y se reinicia autom\u00e1ticamente. Cuando se ejecutan comandos CLI espec\u00edficos, el demonio bbe-smgd intenta escribir en un \u00e1rea de la memoria (socket mgd) que ya estaba cerrada, lo que provoca que el proceso falle. Este proceso gestiona y controla la configuraci\u00f3n de las sesiones y servicios de los suscriptores de banda ancha. Mientras el proceso no est\u00e9 disponible, los suscriptores adicionales no podr\u00e1n conectarse al dispositivo, lo que provocar\u00e1 una condici\u00f3n temporal de denegaci\u00f3n de servicio. Este problema solo ocurre si est\u00e1n habilitados Graceful Routing Engine Switchover (GRES) y Subscriber Management. Este problema afecta a Junos OS: * Todas las versiones anteriores a 20.4R3-S5, * desde 21.1 anterior a 21.1R3-S4, * desde 21.2 anterior a 21.2R3-S3, * desde 21.3 anterior a 21.3R3-S5, * desde 21.4 anterior a 21.4R3-S5 , * desde 22.1 antes de 22.1R3, * desde 22.2 antes de 22.2R3, * desde 22.3 antes de 22.3R2;"}], "metrics": {"cvssMetricV40": [{"source": "sirt@juniper.net", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:L/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "attackVector": "LOCAL", "attackComplexity": "LOW", "attackRequirements": "NONE", "privilegesRequired": "NONE", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "NONE", "vulnerableSystemIntegrity": "NONE", "vulnerableSystemAvailability": "HIGH", "subsequentSystemConfidentiality": "NONE", "subsequentSystemIntegrity": "NONE", "subsequentSystemAvailability": "LOW", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NOT_DEFINED", "recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED", "baseScore": 6.9, "baseSeverity": "MEDIUM"}}], "cvssMetricV31": [{"source": "sirt@juniper.net", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "sirt@juniper.net", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-416"}]}], "references": [{"url": "https://supportportal.juniper.net/JSA79109", "source": "sirt@juniper.net"}, {"url": "https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:L", "source": "sirt@juniper.net"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-30378 - Use-after-free vulnerability exploitation to cause a Denial of Service (DoS) condition, which is a common tactic to disrupt network services."}, {"techniqueID": "T1217", "comment": "CVE-2024-30378 - Attackers may exploit this vulnerability to crash the broadband edge service manager daemon (bbe-smgd), potentially leading to a temporary Denial of Service condition."}, {"techniqueID": "T1008", "comment": "CVE-2024-30378 - The vulnerability involves a command processing flaw, which could potentially be used to execute arbitrary commands or carry out command injection attacks."}], "stix_bundle": {"idy": "CVE-2024-30378", "type": "indicator", "spec_version": "2.1", "stix_core_components": [{"type": "Vulnerability", "id": "vuln:CVE-2024-30378", "name": "Juniper Networks Junos OS Use-after-free vulnerability", "description": "A vulnerability in Junos OS command processing allows authenticated attackers to cause a Denial of Service (DoS) condition.", "identifiers": [{"scheme": "https://cve.mitre.org/cve/data/candidates", "value": "CVE-2024-30378"}]}], "indicator": [{"type": "Network Traffic", "id": "traf:CVE-2024-30378-1", "name": "Poisonous command execution", "description": "Traffic indicating the execution of poisonous commands", "observable_datasets": [{"type": "Network Traffic", "id": "traf:exec-poison-1", "name": "Executing poisonous commands"}]}], "intrusion-set": [{"type": "Intrusion Set", "id": "ins:CVE-2024-30378-1", "name": "Juniper Networks Junos OS Use-after-free vulnerability", "description": "Intrusion set exploiting the Junos OS Use-after-free vulnerability"}]}, "technical_analysis": {"Introduction": "The CVE-2024-30378 vulnerability is a use-after-free vulnerability in Junos OS command processing.", "Impact and Scope": "The vulnerability allows authenticated attackers to cause a Denial of Service (DoS) condition, which can impact network services.", "Related MITRE ATT&CK Techniques": "T1190, T1217, and T1008.", "Technical Details": "The vulnerability involves a command processing flaw in Junos OS.", "Detection": "Detection involves monitoring network traffic for signs of command execution and DoS conditions.", "Mitigation": "Mitigations include patching Junos OS, using intrusion detection systems, and implementing security controls.", "Conclusion": "The CVE-2024-30378 vulnerability highlights the importance of timely patching and security controls to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-30378 vulnerability is a critical security flaw in Junos OS command processing.", "Business Impact": "The vulnerability could potentially disrupt network services, leading to lost productivity and revenue.", "Technical Impact": "The vulnerability allows attackers to exploit the Junos OS command processing flaw.", "Mitigation Strategies": "Implementing security controls, patching Junos OS, and using intrusion detection systems are the recommended mitigation strategies.", "Recommendations": "Executives should work with IT teams to identify and mitigate the vulnerability as soon as possible.", "Conclusions": "The CVE-2024-30378 vulnerability is a critical security issue that requires immediate attention to prevent exploitation and minimize impact."}}