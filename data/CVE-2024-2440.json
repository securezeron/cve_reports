{"id": "CVE-2024-2440", "sourceIdentifier": "product-cna@github.com", "published": "2024-04-19T17:15:54.483", "lastModified": "2024-04-19T18:29:53.040", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A race condition in GitHub Enterprise Server allowed an existing admin to maintain permissions on a detached repository by making a GraphQL mutation to alter repository permissions while the repository is detached.\u00a0This vulnerability affected all versions of GitHub Enterprise Server prior to 3.13 and was fixed in versions 3.9.13, 3.10.10, 3.11.8 and 3.12.1.\u00a0This vulnerability was reported via the GitHub Bug Bounty program. "}, {"lang": "es", "value": "Una condici\u00f3n de ejecuci\u00f3n en GitHub Enterprise Server permiti\u00f3 a un administrador existente mantener permisos en un repositorio separado al realizar una mutaci\u00f3n GraphQL para alterar los permisos del repositorio mientras el repositorio est\u00e1 separado. Esta vulnerabilidad afect\u00f3 a todas las versiones de GitHub Enterprise Server anteriores a la 3.13 y se solucion\u00f3 en las versiones 3.9.13, 3.10.10, 3.11.8 y 3.12.1. Esta vulnerabilidad se inform\u00f3 a trav\u00e9s del programa GitHub Bug Bounty."}], "metrics": {"cvssMetricV31": [{"source": "product-cna@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.7, "impactScore": 4.7}]}, "weaknesses": [{"source": "product-cna@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-367"}]}], "references": [{"url": "https://docs.github.com/en/enterprise-server@3.10/admin/release-notes#3.10.10", "source": "product-cna@github.com"}, {"url": "https://docs.github.com/en/enterprise-server@3.11/admin/release-notes#3.11.8", "source": "product-cna@github.com"}, {"url": "https://docs.github.com/en/enterprise-server@3.12/admin/release-notes#3.12.2", "source": "product-cna@github.com"}, {"url": "https://docs.github.com/en/enterprise-server@3.9/admin/release-notes#3.9.13", "source": "product-cna@github.com"}], "techniques": [{"techniqueID": "T1123", "comment": "GitHub Enterprise Server RCE - Defending against mutation-based repository permission alteration attacks by implementing secure configurations and input validation."}, {"techniqueID": "T1204", "comment": "GitHub Enterprise Server Data Validation - Defending against GraphQL mutation-based data alteration attacks by implementing robust data validation mechanisms."}, {"techniqueID": "T1140", "comment": "GitHub Enterprise Server Authentication Bypass - Defending against unauthorized access to GraphQL mutation endpoints by implementing secure authentication and authorization mechanisms."}, {"techniqueID": "T1548", "comment": "GitHub Enterprise Server Lateral Movement - Defending against post-exploitation lateral movement by implementing network segmentation and monitoring."}], "stix_bundle": {"type": "bundle", "id": "vx2019001", "objects": [{"type": "indicator", "id": "vx2019001-indicator-1", "name": "GitHub Enterprise Server RCE Detection", "description": "Detects attempts to exploit GitHub Enterprise Server RCE vulnerability", "modified": "2024-04-20T14:30:00.000", "created": "2024-04-20T14:30:00.000", "labels": ["windows", "github"], "observed_data": [{"description": "GraphQL mutation requests", "pattern": "https://github.com/api/graphql/mutations/", "value": ".*"}]}, {"type": "indicator", "id": "vx2019001-indicator-2", "name": "GitHub Enterprise Server Data Validation Detection", "description": "Detects attempts to exploit GitHub Enterprise Server data validation vulnerability", "modified": "2024-04-20T14:30:00.000", "created": "2024-04-20T14:30:00.000", "labels": ["windows", "github"], "observed_data": [{"description": "Invalid GraphQL mutation requests", "pattern": "https://github.com/api/graphql/mutations/.*", "value": "Invalid input"}]}], "relationship": {"indicators": [{"id": "vx2019001-rel-1", "type": "related", "id_ref": "vx2019001-indicator-1", "id_target": "vx2019001-indicator-2"}]}}, "technical_analysis": {"Introduction": "The GitHub Enterprise Server RCE vulnerability allows an existing admin to maintain permissions on a detached repository by making a GraphQL mutation to alter repository permissions while the repository is detached.", "Impact and Scope": "The vulnerability affects all versions of GitHub Enterprise Server prior to 3.13 and has a CVSS score of 5.5.", "Related MITRE ATT&CK Techniques": "T1123, T1204, T1140, T1548", "Technical Details": "The vulnerability is caused by a race condition in GitHub Enterprise Server's GraphQL mutation handling.", "Detection": "The vulnerability can be detected by monitoring GraphQL mutation requests and analyzing input data for invalid or malicious requests.", "Mitigation": "The vulnerability can be mitigated by implementing secure configurations and input validation, as well as by regularly updating GitHub Enterprise Server to the latest version.", "Conclusion": "The GitHub Enterprise Server RCE vulnerability is a critical vulnerability that requires immediate attention to prevent exploitation."}, "executive_analysis": {"Overview": "The GitHub Enterprise Server RCE vulnerability is a critical vulnerability that allows an attacker to maintain permissions on a detached repository.", "Business Impact": "The vulnerability could allow an attacker to compromise sensitive data and customer information.", "Technical Impact": "The vulnerability affects all versions of GitHub Enterprise Server prior to 3.13 and has a CVSS score of 5.5.", "Mitigation Strategies": "Implement secure configurations and input validation, and regularly update GitHub Enterprise Server to the latest version.", "Recommendations": "Conduct a thorough risk assessment and develop a plan to remediate the vulnerability.", "Conclusions": "The GitHub Enterprise Server RCE vulnerability is a critical vulnerability that requires immediate attention to prevent exploitation."}}