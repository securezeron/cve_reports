{"id": "CVE-2024-26704", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-03T15:15:53.193", "lastModified": "2024-06-27T12:15:20.167", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: fix double-free of blocks due to wrong extents moved_len\n\nIn ext4_move_extents(), moved_len is only updated when all moves are\nsuccessfully executed, and only discards orig_inode and donor_inode\npreallocations when moved_len is not zero. When the loop fails to exit\nafter successfully moving some extents, moved_len is not updated and\nremains at 0, so it does not discard the preallocations.\n\nIf the moved extents overlap with the preallocated extents, the\noverlapped extents are freed twice in ext4_mb_release_inode_pa() and\next4_process_freed_data() (as described in commit 94d7c16cbbbd (\"ext4:\nFix double-free of blocks with EXT4_IOC_MOVE_EXT\")), and bb_free is\nincremented twice. Hence when trim is executed, a zero-division bug is\ntriggered in mb_update_avg_fragment_size() because bb_free is not zero\nand bb_fragments is zero.\n\nTherefore, update move_len after each extent move to avoid the issue."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: ext4: corrige la doble liberaci\u00f3n de bloques debido a extensiones incorrectas. moving_len En ext4_move_extents(), move_len solo se actualiza cuando todos los movimientos se ejecutan exitosamente y solo descarta las preasignaciones de orig_inode y donante_inode cuando se mueve_len no es cero. Cuando el bucle no sale despu\u00e9s de mover con \u00e9xito algunas extensiones, moving_len no se actualiza y permanece en 0, por lo que no descarta las asignaciones previas. Si las extensiones movidas se superponen con las extensiones preasignadas, las extensiones superpuestas se liberan dos veces en ext4_mb_release_inode_pa() y ext4_process_freed_data() (como se describe en el commit 94d7c16cbbbd (\"ext4: corrige la doble liberaci\u00f3n de bloques con EXT4_IOC_MOVE_EXT\")), y se incrementa bb_free dos veces. Por lo tanto, cuando se ejecuta trim, se activa un error de divisi\u00f3n cero en mb_update_avg_fragment_size() porque bb_free no es cero y bb_fragments es cero. Por lo tanto, actualice move_len despu\u00e9s de cada movimiento de extensi\u00f3n para evitar el problema."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/185eab30486ba3e7bf8b9c2e049c79a06ffd2bc1", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/2883940b19c38d5884c8626483811acf4d7e148f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/55583e899a5357308274601364741a83e78d6ac4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/559ddacb90da1d8786dd8ec4fd76bbfa404eaef6", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/afba9d11320dad5ce222ac8964caf64b7b4bedb1", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/afbcad9ae7d6d11608399188f03a837451b6b3a1", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b4fbb89d722cbb16beaaea234b7230faaaf68c71", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d033a555d9a1cf53dbf3301af7199cc4a4c8f537", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-26704 - This vulnerability in the Linux kernel could be exploited by an attacker to perform a double-free attack, which could lead to a denial-of-service (DoS) or arbitrary code execution (ACE) situations."}, {"techniqueID": "T1189", "comment": "This technique may be used to exploit the vulnerability in the Linux kernel by moving and deleting blocks in a way that can cause a double-free situation, resulting in a DoS or ACE."}, {"techniqueID": "T1003", "comment": "An attacker could exploit this vulnerability by creating a malformed block move request that could cause the kernel to free the wrong block, leading to a double-free situation."}, {"techniqueID": "T1109", "comment": "This technique may be used to exploit the vulnerability by creating a file with a large number of blocks and then deleting the file, which could cause the kernel to free the wrong block, leading to a double-free situation."}], "stix_bundle": {"objects": [{"type": "incident", "id": "incident--cve-2024-26704", "created_by_ref": "identity--user-1", "created": "2024-04-03T15:15:53.193", "modified": "2024-06-27T12:15:20.167", "name": "CVE-2024-26704 Linux Kernel Vulnerability", "description": "Linux Kernel Vulnerability CVE-2024-26704", "properties": [{"name": "cve_id", "value": "CVE-2024-26704"}, {"name": "cvss_score", "value": "9.8"}, {"name": "attack_vector", "value": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}], "objects": [{"type": "attack-pattern", "id": "attack-pattern--t1190", "created_by_ref": "identity--user-1", "created": "2024-04-03T15:15:53.193", "modified": "2024-06-27T12:15:20.167", "name": "Linux Kernel Double-Free Attack", "description": "Attack Pattern for Linux Kernel Double-Free Attack", "external_references": [{"source_name": "MITRE", "external_id": "T1190"}]}]}]}, "technical_analysis": {"Introduction": "The Linux kernel vulnerability CVE-2024-26704 is a double-free vulnerability in the ext4 filesystem that can be exploited to perform a denial-of-service (DoS) or arbitrary code execution (ACE).", "Impact and Scope": "CVSS Score: 9.8, Attack Vector: Network, Attack Complexity: Low, Authentication: None, Confidentiality: Complete, Integrity: Complete, Availability: Complete", "Related MITRE ATT&CK Techniques": "T1190, T1189, T1003, T1109", "Technical Details": "The vulnerability occurs when the ext4 filesystem mistakenly frees blocks that have already been freed, leading to a double-free situation.", "Detection": "Detecting this vulnerability may be challenging, but it can be done by monitoring network traffic for suspicious activity and examining system logs for evidence of exploitation.", "Mitigation": "To mitigate this vulnerability, systems should be updated with the latest security patches, and ext4 filesystems should be updated to the latest version. Additionally, firewalls and intrusion detection systems should be configured to detect and block suspicious network traffic.", "Conclusion": "The Linux kernel vulnerability CVE-2024-26704 is a serious vulnerability that can be exploited to perform a denial-of-service (DoS) or arbitrary code execution (ACE). It is essential to apply the recommended mitigations to prevent exploitation and to monitor system logs and network traffic for suspicious activity."}, "executive_analysis": {"Overview": "The Linux kernel vulnerability CVE-2024-26704 is a critical security vulnerability that can be exploited to perform a denial-of-service (DoS) or arbitrary code execution (ACE).", "Business Impact": "This vulnerability has significant business implications, as it can disrupt critical systems and operations, resulting in financial losses and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is significant, as it can be exploited to perform a denial-of-service (DoS) or arbitrary code execution (ACE), allowing attackers to gain access to sensitive data and systems.", "Mitigation Strategies": "To mitigate this vulnerability, executives should prioritize the application of security patches, monitoring of system logs and network traffic, and implementation of robust incident response procedures.", "Recommendations": "Executives should recommend that their teams update the system with the latest security patches, monitor system logs and network traffic, and conduct regular security assessments to identify and address vulnerabilities.", "Conclusions": "In conclusion, the Linux kernel vulnerability CVE-2024-26704 is a critical security vulnerability that requires immediate attention and action. It is essential for executives to prioritize the mitigation of this vulnerability to ensure the security and integrity of their systems and data."}}