{"id": "CVE-2020-4037", "sourceIdentifier": "security-advisories@github.com", "published": "2020-06-29T20:15:10.317", "lastModified": "2020-07-07T18:40:25.653", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In OAuth2 Proxy from version 5.1.1 and less than version 6.0.0, users can provide a redirect address for the proxy to send the authenticated user to at the end of the authentication flow. This is expected to be the original URL that the user was trying to access. This redirect URL is checked within the proxy and validated before redirecting the user to prevent malicious actors providing redirects to potentially harmful sites. This has been fixed in version 6.0.0."}, {"lang": "es", "value": "En OAuth2 Proxy a partir de la versi\u00f3n 5.1.1 y anterior a la versi\u00f3n 6.0.0, los usuarios pueden proporcionar una direcci\u00f3n de redireccionamiento para que el proxy env\u00ede al usuario autenticado al final del flujo de autenticaci\u00f3n. Est\u00e1 previsto que esta sea la URL original a la que el usuario intentaba acceder. Esta URL de redireccionamiento es comprobada dentro del proxy y validada antes de redireccionar al usuario para impedir que los actores maliciosos proporcionen redireccionamientos a sitios potencialmente da\u00f1inos. Esto ha sido corregido en la versi\u00f3n 6.0.0"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.5}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-601"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:oauth2_proxy_project:oauth2_proxy:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.1.1", "versionEndExcluding": "6.0.0", "matchCriteriaId": "736CC29A-0FA1-4DBF-AF26-6645C2D6E474"}]}]}], "references": [{"url": "https://github.com/oauth2-proxy/oauth2-proxy/commit/ee5662e0f5001d76ec76562bb605abbd07c266a2", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/oauth2-proxy/oauth2-proxy/security/advisories/GHSA-5m6c-jp6f-2vcv", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1187", "comment": "CVE-2020-4037 - An attacker may exploit this vulnerability by providing a malicious redirect URL, which can lead to unauthorized access to the system. This technique is relevant to the vulnerability and defenders should consider implementing measures to validate the redirect URLs."}, {"techniqueID": "T1210", "comment": "CVE-2020-4037 - The vulnerability in OAuth2 Proxy allows an attacker to bypass validation of redirect URLs, which can lead to the exploitation of other vulnerabilities. This technique is relevant to the vulnerability and defenders should consider implementing measures to validate user input."}, {"techniqueID": "T1190", "comment": "CVE-2020-4037 - The vulnerability in OAuth2 Proxy can be exploited by an attacker to capture user credentials, which can lead to unauthorized access to the system. This technique is relevant to the vulnerability and defenders should consider implementing measures to protect user credentials."}], "stix_bundle": {"schema": "https://stix2.io/schema/2.1/json", "type": "bundle", "id": "example-cve-2020-4037-stix-bundle", "created_by_ref": "oid:00000000-0000-0000-0000-000000000000", "objects": [{"type": "vulnerability", "id": "example-cve-2020-4037-vulnerability", "name": "CVE-2020-4037", "description": "A vulnerability in OAuth2 Proxy allows an attacker to provide a malicious redirect URL, which can lead to unauthorized access to the system.", "exploit_availability": "avail", "exploit_complexity": "low", "detection_difficulty": "medium", "exploit_code_maturity": "available", "cwe": {"id": "CWE-601", "name": "CWE-601: Use of Client-Side Injection in Input Validation", "source": "NVD"}}, {"type": "attack-pattern", "id": "example-cve-2020-4037-t1187", "name": "T1187: Exploitation of OAuth2 Proxy Redirect URL Vulnerability", "description": "An attacker may exploit this vulnerability by providing a malicious redirect URL, which can lead to unauthorized access to the system.", "kill_chain_phases": {"phase": "exploitation"}}, {"type": "action", "id": "example-cve-2020-4037-action-1", "name": "Validate Redirect URLs", "description": "Defenders should validate the redirect URLs provided by users to prevent malicious activity.", "related_object": {"ref": "example-cve-2020-4037-vulnerability"}, "mitigated_techniques": ["example-cve-2020-4037-t1187"]}]}, "technical_analysis": {"Introduction": "The CVE-2020-4037 vulnerability is a significant threat to the security of OAuth2 Proxy installations.", "Impact and Scope": "The vulnerability allows an attacker to provide a malicious redirect URL, which can lead to unauthorized access to the system.", "Related MITRE ATT&CK Techniques": "T1187, T1210, and T1190", "Technical Details": "The vulnerability occurs when the redirect URL is not properly validated, allowing an attacker to bypass security checks.", "Detection": "Defenders can detect the vulnerability by monitoring for suspicious redirect URL activity.", "Mitigation": "Defenders should implement measures to validate the redirect URLs provided by users.", "Conclusion": "CVE-2020-4037 is a critical vulnerability that requires immediate attention from defenders."}, "executive_analysis": {"Overview": "The CVE-2020-4037 vulnerability presents a significant risk to the security of OAuth2 Proxy installations.", "Business Impact": "An attacker can gain unauthorized access to the system, which can lead to unauthorized access to sensitive data.", "Technical Impact": "The vulnerability allows an attacker to bypass security checks, which can lead to the exploitation of other vulnerabilities.", "Mitigation Strategies": "Defenders should implement measures to validate the redirect URLs provided by users.", "Recommendations": "Executives should prioritize the mitigation of this vulnerability due to the potential impact on the organization.", "Conclusions": "The CVE-2020-4037 vulnerability requires immediate attention from defenders and executives to ensure the security of OAuth2 Proxy installations."}}