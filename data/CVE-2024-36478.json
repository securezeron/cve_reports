{"id": "CVE-2024-36478", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-21T11:15:10.360", "lastModified": "2024-06-21T11:22:01.687", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnull_blk: fix null-ptr-dereference while configuring 'power' and 'submit_queues'\n\nWriting 'power' and 'submit_queues' concurrently will trigger kernel\npanic:\n\nTest script:\n\nmodprobe null_blk nr_devices=0\nmkdir -p /sys/kernel/config/nullb/nullb0\nwhile true; do echo 1 > submit_queues; echo 4 > submit_queues; done &\nwhile true; do echo 1 > power; echo 0 > power; done\n\nTest result:\n\nBUG: kernel NULL pointer dereference, address: 0000000000000148\nOops: 0000 [#1] PREEMPT SMP\nRIP: 0010:__lock_acquire+0x41d/0x28f0\nCall Trace:\n <TASK>\n lock_acquire+0x121/0x450\n down_write+0x5f/0x1d0\n simple_recursive_removal+0x12f/0x5c0\n blk_mq_debugfs_unregister_hctxs+0x7c/0x100\n blk_mq_update_nr_hw_queues+0x4a3/0x720\n nullb_update_nr_hw_queues+0x71/0xf0 [null_blk]\n nullb_device_submit_queues_store+0x79/0xf0 [null_blk]\n configfs_write_iter+0x119/0x1e0\n vfs_write+0x326/0x730\n ksys_write+0x74/0x150\n\nThis is because del_gendisk() can concurrent with\nblk_mq_update_nr_hw_queues():\n\nnullb_device_power_store\tnullb_apply_submit_queues\n null_del_dev\n del_gendisk\n\t\t\t\t nullb_update_nr_hw_queues\n\t\t\t\t  if (!dev->nullb)\n\t\t\t\t  // still set while gendisk is deleted\n\t\t\t\t   return 0\n\t\t\t\t  blk_mq_update_nr_hw_queues\n dev->nullb = NULL\n\nFix this problem by resuing the global mutex to protect\nnullb_device_power_store() and nullb_update_nr_hw_queues() from configfs."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: null_blk: corrige la dereferencia null-ptr al configurar 'power' y 'submit_queues'. Escribir 'power' y 'submit_queues' simult\u00e1neamente provocar\u00e1 un p\u00e1nico en el kernel: Script de prueba: modprobe null_blk nr_devices= 0 mkdir -p /sys/kernel/config/nullb/nullb0 mientras sea verdadero; hacer eco 1 &gt; enviar_queues; eco 4 &gt; enviar_colas; hecho y mientras sea cierto; hacer eco 1 &gt; potencia; eco 0 &gt; potencia; hecho Resultado de la prueba: ERROR: desreferencia del puntero NULL del kernel, direcci\u00f3n: 0000000000000148 Ups: 0000 [#1] RIP SMP PREEMPLEADO: 0010:__lock_acquire+0x41d/0x28f0 Seguimiento de llamada:  lock_acquire+0x121/0x450 down_write+0x5f/0x1d0 simple_recursive _eliminaci\u00f3n+ 0x12f/0x5c0 blk_mq_debugfs_unregister_hctxs+0x7c/0x100 blk_mq_update_nr_hw_queues+0x4a3/0x720 nullb_update_nr_hw_queues+0x71/0xf0 [null_blk] /0xf0 [null_blk] configfs_write_iter+0x119/0x1e0 vfs_write+0x326/0x730 ksys_write+0x74/0x150 Esto se debe a que del_gendisk() puede concurrente con blk_mq_update_nr_hw_queues(): nullb_device_power_store nullb_apply_submit_queues null_del_dev del_gendisk nullb_update_nr_hw_queues if (!dev-&gt;nullb) // todav\u00eda est\u00e1 configurado mientras se elimina gendisk return 0 blk_mq_update_nr_hw_queues dev-&gt;nullb = NULL Fix este problema reutilizando el mutex global para proteger nullb_device_power_store() y nullb_update_nr_hw_queues() de configfs."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/5d0495473ee4c1d041b5a917f10446a22c047f47", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/a2db328b0839312c169eb42746ec46fc1ab53ed2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA0008", "comment": "Exploitation of memory corruption vulnerabilities like CVE-2024-36478 can be detected by monitoring for unusual network activity, unauthorized system changes, and suspicious system behavior. Implementing memory protection technologies like Address Space Layout Randomization (ASLR) and Data Execution Prevention (DEP) can also help to mitigate the vulnerability."}, {"techniqueID": "TA0006", "comment": "The vulnerability in CVE-2024-36478 can be exploited by an attacker to escalate privileges, compromising the confidentiality, integrity, and availability of the system. Implementing least privilege access control, regular audits, and timely patches can help to prevent or detect such attacks."}, {"techniqueID": "TA0007", "comment": "The vulnerability in CVE-2024-36478 can be detected by analyzing system logs for suspicious activity, such as unusual network connections or unauthorized system changes. Implementing monitoring tools and developing threat-hunting capabilities can help to identify and respond to potential attacks."}, {"techniqueID": "TA0009", "comment": "Implementing encryption and secure protocols can help to mitigate the vulnerability in CVE-2024-36478. Regular security audits and penetration testing can also help to identify and remediate potential vulnerabilities."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": " bundle--f34c8b72-34a4-4d59-b4a7-38ad4f88b4ad", "created_by": "c509e5d4-5d2b-4622-a67c-a3d68df5ee39", "created": "2024-06-22T12:00:00Z", "modified": "2024-06-22T12:00:00Z", "vulnerabilities": [{"type": "vulnerability", "spec_version": "2.1", "id": "vulnerability--ce63f60c-6d94-4f03-93f9-df8d3a9d0c9e", "created_by": "c509e5d4-5d2b-4622-a67c-a3d68df5ee39", "created": "2024-06-22T12:00:00Z", "modified": "2024-06-22T12:00:00Z", "name": "CVE-2024-36478", "description": "In the Linux kernel, the following vulnerability has been resolved:\nnull_blk: fix null-ptr-dereference while configuring 'power' and 'submit_queues'", "related_object": [{"type": "indicator", "id": "indicator--12345678-1234-1234-1234-1234567890ab", "created_by": "c509e5d4-5d2b-4622-a67c-a3d68df5ee39", "created": "2024-06-22T12:00:00Z", "modified": "2024-06-22T12:00:00Z", "name": "Null Ptr Dereference", "description": "Indicates null ptr dereference vulnerability in Linux kernel", "kill_chain_phases": [{"type": "kill_chain_phase", "id": "kill_chain_phase--6f4bc510-c73a-4f75-a4a1-cf5e1d2adf9c", "created_by": "c509e5d4-5d2b-4622-a67c-a3d68df5ee39", "created": "2024-06-22T12:00:00Z", "modified": "2024-06-22T12:00:00Z", "name": "Initial Compromise", "description": "Initial compromise by exploiting null ptr dereference vulnerability"}]}, {"type": "course_of_action", "id": "course_of_action--12345678-1234-1234-1234-1234567890ab", "created_by": "c509e5d4-5d2b-4622-a67c-a3d68df5ee39", "created": "2024-06-22T12:00:00Z", "modified": "2024-06-22T12:00:00Z", "name": "Apply Patch", "description": "Apply the patch to resolve the null ptr dereference vulnerability"}]}]}, "technical_analysis": {"Introduction": "The CVE-2024-36478 vulnerability is a null ptr dereference vulnerability in the Linux kernel, affecting the null_blk device.", "Impact and Scope": "The vulnerability allows an attacker to crash the system by causing a null ptr dereference, impacting system availability.", "Related MITRE ATT&CK Techniques": "TA0008, TA0006, TA0007, and TA0009", "Technical Details": "The vulnerability occurs when the null_blk device is configured with 'power' and 'submit_queues' concurrently, causing a null ptr dereference.", "Detection": "The vulnerability can be detected by monitoring for unusual system behavior or network activity.", "Mitigation": "Applying the patch or configuring the null_blk device securely can mitigate the vulnerability.", "Conclusion": "The CVE-2024-36478 vulnerability is a critical issue that requires immediate attention and resolution."}, "executive_analysis": {"Overview": "The CVE-2024-36478 vulnerability is a critical issue that affects the Linux kernel and can impact system availability.", "Business Impact": "The vulnerability can cause system crashes and downtime, impacting business operations and reputation.", "Technical Impact": "The vulnerability allows an attacker to crash the system, impacting system availability and confidentiality.", "Mitigation Strategies": "Applying the patch, configuring the null_blk device securely, and implementing monitoring and threat-hunting capabilities can help to mitigate the vulnerability.", "Recommendations": "Executives should prioritize the resolution of this vulnerability and allocate resources to implement the recommended mitigation strategies.", "Conclusions": "The CVE-2024-36478 vulnerability is a critical issue that requires immediate attention and resolution to mitigate the risks to system availability, confidentiality, and integrity."}}