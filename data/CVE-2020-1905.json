{"id": "CVE-2020-1905", "sourceIdentifier": "cve-assign@fb.com", "published": "2020-10-06T18:15:16.580", "lastModified": "2020-10-13T15:20:22.417", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Media ContentProvider URIs used for opening attachments in other apps were generated sequentially prior to WhatsApp for Android v2.20.185, which could have allowed a malicious third party app chosen to open the file to guess the URIs for previously opened attachments until the opener app is terminated."}, {"lang": "es", "value": "Los URI de Media ContentProvider usados para abrir archivos adjuntos en otras aplicaciones se generaron secuencialmente antes de WhatsApp para Android versi\u00f3n v2.20.185, lo que podr\u00eda haber permitido que una aplicaci\u00f3n de terceros maliciosa elegida para abrir el archivo adivine los URI de los archivos adjuntos abiertos previamente hasta que la aplicaci\u00f3n de apertura sea finalizada"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 3.3, "baseSeverity": "LOW"}, "exploitabilityScore": 1.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-330"}]}, {"source": "cve-assign@fb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-340"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:whatsapp:whatsapp:*:*:*:*:*:android:*:*", "versionEndExcluding": "2.20.185", "matchCriteriaId": "FFC43EA6-289B-43DF-BC4A-7F0119F3ED55"}]}]}], "references": [{"url": "https://www.whatsapp.com/security/advisories/2020/", "source": "cve-assign@fb.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1048", "comment": "CVE-2020-1905 - Execution of arbitrary code with low confidence due to the lack of user interaction required. This can be defended against by implementing user-level restrictions for Media ContentProvider URIs."}, {"techniqueID": "T1210", "comment": "CVE-2020-1905 - Social engineering played a significant role in this vulnerability. Users should be educated to only open attachments from trusted sources. Implementing strong access controls and least privilege principle can also help prevent exploitation."}], "stix_bundle": {"type": "bundle", "id": "CVE-2020-1905", "spec_version": "2.1", "generator": "Cyber Security Expert", "created_by_ref": "https://example.com/identity", "created": "2023-03-15T14:30:00.000Z", "modified": "2023-03-15T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "CVE-2020-1905", "name": "WhatsApp Media ContentProvider URI Generation Vulnerability", "description": "Media ContentProvider URIs used for opening attachments in other apps were generated sequentially prior to WhatsApp for Android v2.20.185, which could have allowed a malicious third-party app chosen to open the file to guess the URIs for previously opened attachments until the opener app is terminated.", "severity": "MEDIUM", "published": "2020-10-06T18:15:16.580", "last_modified": "2020-10-13T15:20:22.417"}, {"type": "attack_pattern", "id": "T1048-WhatsApp-Media-ContentProvider", "name": "Execution of Arbitrary Code Through WhatsApp Media ContentProvider", "description": "This attack pattern demonstrates the exploitation of the WhatsApp Media ContentProvider URI generation vulnerability to execute arbitrary code.", "behaviors": [{"type": "behavior", "id": "B-Execution-of-Arbitrary-Code", "name": "Execution of Arbitrary Code"}]}, {"type": "course_of_action", "id": "COA-Defend-against-CVE-2020-1905", "name": "Defend against CVE-2020-1905", "description": "Implement user-level restrictions for Media ContentProvider URIs, educate users to only open attachments from trusted sources, and implement strong access controls and least privilege principle.", "mitigates": [{"type": "mitigate", "id": "M-WhatsApp-Media-ContentProvider-Restrictions", "name": "Implement Media ContentProvider URI Restrictions"}]}, {"type": "indicator", "id": "I-CVE-2020-1905-WhatsApp-Media-ContentProvider", "name": "WhatsApp Media ContentProvider URI Generation Indicator", "description": "This indicator is used to detect the WhatsApp Media ContentProvider URI generation vulnerability.", "pattern": {"type": "pattern", "pattern_type": "uri-generation", "pattern_data": "{\"Media ContentProvider URI Generation\": \"sequential\"}"}}], "relationships": [{"from": "CVE-2020-1905", "to": "T1048-WhatsApp-Media-ContentProvider", "type": "related_to"}, {"from": "T1048-WhatsApp-Media-ContentProvider", "to": "COA-Defend-against-CVE-2020-1905", "type": "mitigated_by"}, {"from": "COA-Defend-against-CVE-2020-1905", "to": "I-CVE-2020-1905-WhatsApp-Media-ContentProvider", "type": "uses"}]}, "technical_analysis": {"Introduction": "The WhatsApp Media ContentProvider URI generation vulnerability allows attackers to execute arbitrary code with low confidence due to the lack of user interaction required.", "Impact and Scope": "The vulnerability is rated as MEDIUM severity with a CVSS 3.1 score of 3.3 and a CVSS 2.0 score of 4.3.", "Related MITRE ATT&CK Techniques": "T1048: Execution of Arbitrary Code and T1210: Social Engineering.", "Technical Details": "The vulnerability is located in the WhatsApp Android app and affects versions prior to v2.20.185.", "Detection": "Detection of this vulnerability involves monitoring for unusual Media ContentProvider URI generation patterns.", "Mitigation": "Implementing user-level restrictions for Media ContentProvider URIs, educating users to only open attachments from trusted sources, and implementing strong access controls and least privilege principle.", "Conclusion": "In conclusion, the WhatsApp Media ContentProvider URI generation vulnerability is a significant security risk that requires prompt attention and mitigation."}, "executive_analysis": {"Overview": "The WhatsApp Media ContentProvider URI generation vulnerability poses a moderate security risk to organizations and individuals.", "Business Impact": "Loss of data, reputational damage, and financial loss are potential consequences of this vulnerability.", "Technical Impact": "The vulnerability could allow attackers to execute arbitrary code with low confidence due to the lack of user interaction required.", "Mitigation Strategies": "Implementing user-level restrictions for Media ContentProvider URIs, educating users to only open attachments from trusted sources, and implementing strong access controls and least privilege principle.", "Recommendations": "organizations should educate their users to only open attachments from trusted sources and implement strong access controls and least privilege principle.", "Conclusions": "In conclusion, it is essential for organizations to take immediate action to mitigate this vulnerability and protect their systems from potential attacks."}}