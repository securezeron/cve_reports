{"id": "CVE-2024-5980", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-27T19:15:18.803", "lastModified": "2024-06-27T19:25:12.067", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability in the /v1/runs API endpoint of lightning-ai/pytorch-lightning v2.2.4 allows attackers to exploit path traversal when extracting tar.gz files. When the LightningApp is running with the plugin_server, attackers can deploy malicious tar.gz plugins that embed arbitrary files with path traversal vulnerabilities. This can result in arbitrary files being written to any directory in the victim's local file system, potentially leading to remote code execution."}, {"lang": "es", "value": "Una vulnerabilidad en el endpoint API /v1/runs de lightning-ai/pytorch-lightning v2.2.4 permite a los atacantes explotar el path traversal al extraer archivos tar.gz. Cuando LightningApp se ejecuta con plugin_server, los atacantes pueden implementar complementos tar.gz maliciosos que incrustan archivos arbitrarios con vulnerabilidades de path traversal. Esto puede provocar que se escriban archivos arbitrarios en cualquier directorio del sistema de archivos local de la v\u00edctima, lo que podr\u00eda provocar la ejecuci\u00f3n remota de c\u00f3digo."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-434"}]}], "references": [{"url": "https://huntr.com/bounties/55a6ac6f-89c7-42ea-86f3-c6e93a2679f3", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1204", "comment": "CVE-2024-5980 - This is a potential path traversal vulnerability in the /v1/runs API endpoint, which allows attackers to deploy malicious tar.gz plugins that can result in arbitrary files being written to any directory on the victim's local file system, potentially leading to remote code execution. Defend against this by validating user input and restricting directory traversal."}, {"techniqueID": "T1059", "comment": "CVE-2024-5980 - The vulnerability in the /v1/runs API endpoint can also be exploited by attackers to execute arbitrary code, which can lead to privilege escalation and ultimately, remote code execution. Defend against this by restricting access to sensitive areas of the system and monitoring for suspicious activity."}, {"techniqueID": "T1087", "comment": "CVE-2024-5980 - The fact that the vulnerability allows attackers to deploy malicious tar.gz plugins is a significant threat, as it can be used to distribute malware or ransomware. Defend against this by monitoring for suspicious activity and restricting access to sensitive areas of the system."}], "stix_bundle": {"$schema": "https://docs.oasis-open.org/cti/stix/2.1/stix-core-v2.1.xsd", "type": "bundle", "id": "bundle--e7ea18af-90f3-46e4-91c6-510ac2a92f70", "created": "2024-06-27T19:15:18.803", "modified": "2024-06-27T19:25:12.067", "objects": [{"type": "vulnerability", "id": "vulnerability--7f83f9f5-6fd2-4b2f-9a6b-4154c3a94f19", "created": "2024-06-27T19:15:18.803", "modified": "2024-06-27T19:25:12.067", "name": "CVE-2024-5980: Path Traversal in Lightning-ai/Pytorch-Lightning", "description": [{"lang": "en", "value": "A vulnerability in the /v1/runs API endpoint of lightning-ai/pytorch-lightning v2.2.4 allows attackers to exploit path traversal when extracting tar.gz files."}], "references": [{"url": "https://huntr.com/bounties/55a6ac6f-89c7-42ea-86f3-c6e93a2679f3", "source": "security@huntr.dev"}], "cve": "CVE-2024-5980", "cvss": {"vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H", "source": "security@huntr.dev"}, "mitigation": {"mitigate": "Restrict directory traversal and monitor for suspicious activity"}, "related_indicators": [{"type": "indicator", "id": "indicator--e4b2f0d5-21c0-46ae-a8ae-5a2b76f75c72", "created": "2024-06-27T19:15:18.803", "modified": "2024-06-27T19:25:12.067", "name": "Suspicious directory traversal attempt", "description": [{"lang": "en", "value": "This is an indicator of malicious activity related to the CVE-2024-5980 vulnerability."}], "mitre_attack_id": "T1204", "observable": {"type": "endpoint", "name": "Suspicious directory traversal attempt", "description": [{"lang": "en", "value": "This is an indicator of malicious activity related to the CVE-2024-5980 vulnerability."}]}}]}, {"type": "course-of-action", "id": "course-of-action--f4d76c24-0f7a-418c-97e6-c9468fbb461d", "created": "2024-06-27T19:15:18.803", "modified": "2024-06-27T19:25:12.067", "name": "Defend against CVE-2024-5980", "description": [{"lang": "en", "value": "A course of action for defending against the CVE-2024-5980 vulnerability."}], "mitigation": "Restrict directory traversal and monitor for suspicious activity", "mitre_attack_id": "T1204", "observable": {"type": "endpoint", "name": "Defend against CVE-2024-5980", "description": [{"lang": "en", "value": "A course of action for defending against the CVE-2024-5980 vulnerability."}]}}], "relationship": [{"type": "related-to", "from": "vulnerability--7f83f9f5-6fd2-4b2f-9a6b-4154c3a94f19", "to": "course-of-action--f4d76c24-0f7a-418c-97e6-c9468fbb461d"}]}, "technical_analysis": {"Introduction": "This vulnerability allows attackers to exploit path traversal when extracting tar.gz files, which can result in arbitrary files being written to any directory on the victim's local file system, potentially leading to remote code execution.", "Impact and Scope": "CVSS Score: 9.1, Attack Vector: NETWORK, CVSS Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H.", "Related MITRE ATT&CK Techniques": "T1204, T1059, T1087", "Technical Details": "The vulnerability occurs when the LightningApp is running with the plugin_server, and attackers can deploy malicious tar.gz plugins that embed arbitrary files with path traversal vulnerabilities.", "Detection": "Monitor for suspicious activity and restrict access to sensitive areas of the system.", "Mitigation": "Restrict directory traversal and monitor for suspicious activity", "Conclusion": "This vulnerability can have severe consequences if left unchecked, so it is essential to take immediate action to remediate it."}, "executive_analysis": {"Overview": "A critical vulnerability has been discovered in the /v1/runs API endpoint of lightning-ai/pytorch-lightning v2.2.4.", "Business Impact": "If left unchecked, this vulnerability can result in the loss of sensitive data and potentially, remote code execution.", "Technical Impact": "The vulnerability allows attackers to exploit path traversal when extracting tar.gz files, which can result in arbitrary files being written to any directory on the victim's local file system.", "Mitigation Strategies": "Restrict directory traversal and monitor for suspicious activity", "Recommendations": "Take immediate action to remediate this vulnerability and ensure that all systems are up-to-date with the latest security patches.", "Conclusions": "This vulnerability is a critical security issue that requires immediate attention. It is essential to take prompt action to remediate it to prevent any potential security breaches."}}