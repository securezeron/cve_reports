{"id": "CVE-2023-52874", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-21T16:15:24.157", "lastModified": "2024-05-21T16:53:56.550", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nx86/tdx: Zero out the missing RSI in TDX_HYPERCALL macro\n\nIn the TDX_HYPERCALL asm, after the TDCALL instruction returns from the\nuntrusted VMM, the registers that the TDX guest shares to the VMM need\nto be cleared to avoid speculative execution of VMM-provided values.\n\nRSI is specified in the bitmap of those registers, but it is missing\nwhen zeroing out those registers in the current TDX_HYPERCALL.\n\nIt was there when it was originally added in commit 752d13305c78\n(\"x86/tdx: Expand __tdx_hypercall() to handle more arguments\"), but was\nlater removed in commit 1e70c680375a (\"x86/tdx: Do not corrupt\nframe-pointer in __tdx_hypercall()\"), which was correct because %rsi is\nlater restored in the \"pop %rsi\".  However a later commit 7a3a401874be\n(\"x86/tdx: Drop flags from __tdx_hypercall()\") removed that \"pop %rsi\"\nbut forgot to add the \"xor %rsi, %rsi\" back.\n\nFix by adding it back."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: x86/tdx: Ponga a cero el RSI que falta en la macro TDX_HYPERCALL. En el conjunto TDX_HYPERCALL, despu\u00e9s de que la instrucci\u00f3n TDCALL regresa del VMM que no es de confianza, los registros que el invitado TDX comparte con el VMM necesitan debe borrarse para evitar la ejecuci\u00f3n especulativa de los valores proporcionados por VMM. RSI se especifica en el mapa de bits de esos registros, pero falta al poner a cero esos registros en el TDX_HYPERCALL actual. Estaba all\u00ed cuando se agreg\u00f3 originalmente en la confirmaci\u00f3n 752d13305c78 (\"x86/tdx: Expand__tdx_hypercall() to handle more arguments\"), pero luego se elimin\u00f3 en la confirmaci\u00f3n 1e70c680375a (\"x86/tdx: Do not corrupt frame-pointer in __tdx_hypercall( )\"), lo cual era correcto porque %rsi se restaura posteriormente en el \"pop %rsi\". Sin embargo, una confirmaci\u00f3n posterior 7a3a401874be (\"x86/tdx: Drop flags from __tdx_hypercall()\") elimin\u00f3 ese \"pop %rsi\" pero olvid\u00f3 volver a agregar \"xor %rsi, %rsi\". Solucionadlo volvi\u00e9ndolo a agregar."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/2191950d35d8f81620ea8d4e04d983f664fe3a8a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5d092b66119d774853cc9308522620299048a662", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/de4c5bacca4f50233f1f791bec9eeb4dee1b14cd", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1134", "comment": "CVE-2023-52874 - Leveraging the Linux kernel vulnerability to execute malicious code. This could be used as part of a larger attack to gain elevated privileges or maintain persistence. Detection can be done by monitoring kernel-level activity and checking for suspicious system calls."}, {"techniqueID": "T1044", "comment": "CVE-2023-52874 - Using the Linux kernel vulnerability to conduct speculative execution attacks. This could be used to steal sensitive information or bypass security controls. Detection can be done by monitoring system calls and looking for patterns indicative of speculative execution attacks."}], "stix_bundle": {"type": "bundle", "id": "bundle-cve-2023-52874", "spec_version": "2.1", "objects": [{"type": "vulnerability", "id": "vulnerability-cve-2023-52874", "spec_version": "2.1"}, {"type": "x_mitre_attack_pattern", "id": "attck-pattern-1", "name": "Linux Kernel Speculative Execution", "description": "This attack pattern utilizes the CVE-2023-52874 vulnerability to conduct speculative execution attacks against Linux systems."}, {"type": "malware", "id": "malware-linux-kernel-exploit", "name": "Linux Kernel Exploit", "description": "This malware exploits the CVE-2023-52874 vulnerability to gain elevated privileges on Linux systems."}], "relationships": [{"source_ref": "vulnerability-cve-2023-52874", "target_ref": "attck-pattern-1", "relationship": "exploited_by"}, {"source_ref": "attck-pattern-1", "target_ref": "malware-linux-kernel-exploit", "relationship": "used_by"}]}, "technical_analysis": {"Introduction": "The CVE-2023-52874 vulnerability is a Linux kernel vulnerability that allows attackers to conduct speculative execution attacks. This vulnerability can be exploited by an attacker to gain elevated privileges on affected systems.", "Impact and Scope": "The vulnerability affects Linux systems running kernel version 5.17 and earlier. The vulnerability has a high CVSS score of 9.8 and a potential attack vector of network.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to T1134: Exploitation of Phoning Home and T1044: File and Directory Discovery.", "Technical Details": "The vulnerability occurs due to a flaw in the Linux kernel's handling of speculative execution attacks. An attacker can exploit this vulnerability by crafting a malicious input that triggers the speculative execution attack.", "Detection": "Detection of this vulnerability can be done by monitoring system calls and looking for patterns indicative of speculative execution attacks.", "Mitigation": "The vulnerability can be mitigated by updating the Linux kernel to a version that is not affected by this vulnerability. Additionally, systems can be configured to disable speculative execution attacks.", "Conclusion": "In conclusion, the CVE-2023-52874 vulnerability is a significant security issue that can be exploited by attackers to gain elevated privileges on affected systems. It is essential to update the Linux kernel and disable speculative execution attacks to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2023-52874 vulnerability is a critical security issue that affects Linux systems. It is essential to address this vulnerability to prevent attackers from exploiting it.", "Business Impact": "This vulnerability can have a significant impact on businesses that rely on Linux systems. It can lead to data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability can compromise the confidentiality, integrity, and availability of data on affected systems.", "Mitigation Strategies": "The recommended mitigation strategies include updating the Linux kernel, disabling speculative execution attacks, and implementing robust security controls.", "Recommendations": "We recommend that organizations prioritize updating their Linux systems to a version that is not affected by this vulnerability. Additionally, organizations should conduct a thorough risk assessment and implement robust security controls to mitigate the impact of this vulnerability.", "Conclusions": "In conclusion, the CVE-2023-52874 vulnerability is a critical security issue that requires immediate attention. We recommend that organizations take proactive steps to mitigate this vulnerability and protect their systems and data."}}