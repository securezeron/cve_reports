{"id": "CVE-2024-38385", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-25T15:15:13.487", "lastModified": "2024-09-03T17:59:27.440", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ngenirq/irqdesc: Prevent use-after-free in irq_find_at_or_after()\n\nirq_find_at_or_after() dereferences the interrupt descriptor which is\nreturned by mt_find() while neither holding sparse_irq_lock nor RCU read\nlock, which means the descriptor can be freed between mt_find() and the\ndereference:\n\n    CPU0                            CPU1\n    desc = mt_find()\n                                    delayed_free_desc(desc)\n    irq_desc_get_irq(desc)\n\nThe use-after-free is reported by KASAN:\n\n    Call trace:\n     irq_get_next_irq+0x58/0x84\n     show_stat+0x638/0x824\n     seq_read_iter+0x158/0x4ec\n     proc_reg_read_iter+0x94/0x12c\n     vfs_read+0x1e0/0x2c8\n\n    Freed by task 4471:\n     slab_free_freelist_hook+0x174/0x1e0\n     __kmem_cache_free+0xa4/0x1dc\n     kfree+0x64/0x128\n     irq_kobj_release+0x28/0x3c\n     kobject_put+0xcc/0x1e0\n     delayed_free_desc+0x14/0x2c\n     rcu_do_batch+0x214/0x720\n\nGuard the access with a RCU read lock section."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: genirq/irqdesc: Impide el use-after-free en irq_find_at_or_after() irq_find_at_or_after() elimina la referencia al descriptor de interrupci\u00f3n que devuelve mt_find() mientras no mantiene sparse_irq_lock ni el bloqueo de lectura de RCU, lo que significa que el descriptor se puede liberar entre mt_find() y la desreferencia: CPU0 CPU1 desc = mt_find() delay_free_desc(desc) irq_desc_get_irq(desc) KASAN informa el use-after-free: Rastreo de llamadas: irq_get_next_irq+0x58/0x84 show_stat+ 0x638/0x824 seq_read_iter+0x158/0x4ec proc_reg_read_iter+0x94/0x12c vfs_read+0x1e0/0x2c8 Liberado por la tarea 4471: slab_free_freelist_hook+0x174/0x1e0 __kmem_cache_free+0xa4/0x1dc x64/0x128 irq_kobj_release+0x28/0x3c kobject_put+0xcc/0x1e0 retardado_free_desc+ 0x14/0x2c rcu_do_batch+0x214/0x720 Protege el acceso con una secci\u00f3n de bloqueo de lectura de RCU."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-416"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.5", "versionEndExcluding": "6.6.34", "matchCriteriaId": "02FF289D-5D15-411D-9F0F-33D71A6FFC05"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.9.5", "matchCriteriaId": "8366481F-770F-4850-9D0F-2977BD97D5C5"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/1c7891812d85500ae2ca4051fa5683fcf29930d8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/b84a8aba806261d2f759ccedf4a2a6a80a5e55ba", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/d084aa022f84319f8079e30882cbcbc026af9f21", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-38385 - Local privilege escalation via use-after-free vulnerability in the Linux kernel. This technique can be used to elevate privileges on a system running the vulnerable kernel version."}, {"techniqueID": "T1210", "comment": "CVE-2024-38385 - Local exploitation of the use-after-free vulnerability in the Linux kernel, leading to privilege escalation. This technique can be used to gain unauthorized access to system resources."}, {"techniqueID": "T1225", "comment": "CVE-2024-38385 - Use of a use-after-free vulnerability in the Linux kernel to execute arbitrary code. This technique can be used to achieve persistence on a system."}, {"techniqueID": "T1195", "comment": "CVE-2024-38385 - Use of a local privilege escalation vulnerability in the Linux kernel to create a backdoor. This technique can be used to maintain access to a system."}], "stix_bundle": {"bundle_id": "CVE-2024-38385-STIX-Bundle", "version": "1.0", "objects": [{"type": "vulnerability", "id": "CVE-2024-38385", "name": "Linux kernel use-after-free vulnerability"}, {"type": "attack-pattern", "id": "T1190", "name": "Local privilege escalation via use-after-free vulnerability"}, {"type": "attack-pattern", "id": "T1210", "name": "Local exploitation of use-after-free vulnerability"}, {"type": "attack-pattern", "id": "T1225", "name": "Use of use-after-free vulnerability to execute arbitrary code"}, {"type": "attack-pattern", "id": "T1195", "name": "Use of local privilege escalation vulnerability to create a backdoor"}, {"type": "indicator", "id": "A-LP-CVE-2024-38385-IPS", "name": "Vulnerable Linux kernel use-after-free signature"}], "relationships": [{"type": "related_to", "source_ref": "CVE-2024-38385", "target_ref": "T1190"}, {"type": "related_to", "source_ref": "CVE-2024-38385", "target_ref": "T1210"}, {"type": "related_to", "source_ref": "CVE-2024-38385", "target_ref": "T1225"}, {"type": "related_to", "source_ref": "CVE-2024-38385", "target_ref": "T1195"}, {"type": "indicated_by", "source_ref": "A-LP-CVE-2024-38385-IPS", "target_ref": "CVE-2024-38385"}]}, "technical_analysis": {"Introduction": "The CVE-2024-38385 vulnerability is a use-after-free vulnerability in the Linux kernel. This vulnerability allows an attacker to gain local privilege escalation and potentially execute arbitrary code.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to escalate privileges and potentially execute arbitrary code. The scope of the vulnerability is limited to local exploitation, but the potential consequences are high.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1210, T1225, and T1195.", "Technical Details": "The vulnerability occurs in the irq_find_at_or_after() function in the Linux kernel, which allows an attacker to use-after-free the interrupt descriptor. This can be exploited by an attacker to gain local privilege escalation and potentially execute arbitrary code.", "Detection": "To detect this vulnerability, network traffic should be monitored for suspicious activity, and systems should be scanned for open ports and services. Additionally, system logs should be monitored for signs of exploitation.", "Mitigation": "The recommended mitigation for this vulnerability is to apply the patch provided by the Linux kernel developers. Additionally, system administrators should ensure that systems are regularly updated and patched, and monitoring systems should be in place to detect and prevent exploitation.", "Conclusion": "The CVE-2024-38385 vulnerability is a critical vulnerability in the Linux kernel that allows an attacker to gain local privilege escalation and potentially execute arbitrary code. To mitigate this vulnerability, systems should be patched and monitored for signs of exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-38385 vulnerability is a critical vulnerability in the Linux kernel that requires immediate attention.", "Business Impact": "The business impact of this vulnerability is high, as it allows an attacker to gain local privilege escalation and potentially execute arbitrary code.", "Technical Impact": "The technical impact of this vulnerability is also high, as it requires immediate attention and remediation to prevent exploitation.", "Mitigation Strategies": "The recommended mitigation strategy is to apply the patch provided by the Linux kernel developers and ensure that systems are regularly updated and patched.", "Recommendations": "Executives should ensure that their organizations prioritize the remediation of this vulnerability and that systems are regularly updated and patched.", "Conclusions": "The CVE-2024-38385 vulnerability is a critical vulnerability in the Linux kernel that requires immediate attention. Executives should prioritize the remediation of this vulnerability and ensure that systems are regularly updated and patched."}}