{"id": "CVE-2023-6040", "sourceIdentifier": "security@ubuntu.com", "published": "2024-01-12T02:15:44.683", "lastModified": "2024-08-27T15:15:30.177", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An out-of-bounds access vulnerability involving netfilter was reported and fixed as: f1082dd31fe4 (netfilter: nf_tables: Reject tables of unsupported family); While creating a new netfilter table, lack of a safeguard against invalid nf_tables family (pf) values within `nf_tables_newtable` function enables an attacker to achieve out-of-bounds access."}, {"lang": "es", "value": "Se inform\u00f3 y solucion\u00f3 una vulnerabilidad de acceso fuera de los l\u00edmites que involucraba a netfilter como: f1082dd31fe4 (netfilter: nf_tables: Rechazar tablas de familia no admitida); Al crear una nueva tabla netfilter, la falta de protecci\u00f3n contra valores no v\u00e1lidos de la familia nf_tables (pf) dentro de la funci\u00f3n `nf_tables_newtable` permite a un atacante lograr un acceso fuera de los l\u00edmites."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}, {"source": "security@ubuntu.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-125"}]}, {"source": "security@ubuntu.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-125"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.16", "versionEndExcluding": "4.19.305", "matchCriteriaId": "9C2D75B7-AC4B-4188-A2EA-FF12AC16F4FD"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.20", "versionEndExcluding": "5.4.267", "matchCriteriaId": "B2178B60-868D-465B-945E-4A61545B2736"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.5", "versionEndExcluding": "5.10.208", "matchCriteriaId": "9369B1D9-0165-406A-96D6-C63C6BF45897"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.11", "versionEndExcluding": "5.15.147", "matchCriteriaId": "15E5B535-2734-44C8-B241-0601F0605054"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.16", "versionEndExcluding": "5.18", "matchCriteriaId": "32BB3261-7C4B-420A-9581-F22C50662262"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/177029/Kernel-Live-Patch-Security-Notice-LSN-0100-1.html", "source": "security@ubuntu.com", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.openwall.com/lists/oss-security/2024/01/12/1", "source": "security@ubuntu.com", "tags": ["Mailing List", "Patch", "Third Party Advisory"]}, {"url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6040", "source": "security@ubuntu.com", "tags": ["Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00016.html", "source": "security@ubuntu.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html", "source": "security@ubuntu.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://www.openwall.com/lists/oss-security/2024/01/12/1", "source": "security@ubuntu.com", "tags": ["Mailing List", "Third Party Advisory"]}], "techniques": [{"techniqueID": "TA1518", "comment": "CVE-2023-6040 - This vulnerability can be exploited by an actor who has access to a system that is running a vulnerable version of the Linux kernel. An attacker can achieve out-of-bounds access by creating a new netfilter table without sanitizing the family value."}, {"techniqueID": "TA1514", "comment": "CVE-2023-6040 - This is a kernel-level vulnerability and can be exploited by a threat actor who has access to the system. An attacker can use this vulnerability to achieve code execution or escalate privileges."}, {"techniqueID": "TA1511", "comment": "CVE-2023-6040 - This vulnerability is a result of a lack of input validation and can be exploited by an actor who can send a malicious packet to the netfilter table. This is a vector for remote code execution."}], "stix_bundle": {"@type": "bundle", "type": "bundle", "spec_version": "2.1", "id": "CVE-2023-6040-STIX-Bundle", "created_by_ref": "https://example.com", "created": "2024-08-28T15:15:30.177", "modified": "2024-08-28T15:15:30.177", "objects": [{"@type": "attack_pattern", "type": "attack-pattern", "id": "CVE-2023-6040", "name": "Linux Kernel Netfilter Table Out-of-Bounds Access Vulnerability", "description": "An out-of-bounds access vulnerability involving netfilter was reported and fixed as: f1082dd31fe4 (netfilter: nf_tables: Reject tables of unsupported family); While creating a new netfilter table, lack of a safeguard against invalid nf_tables family (pf) values within `nf_tables_newtable` function enables an attacker to achieve out-of-bounds access.", "labels": ["Linux", "Netfilter", "Out-of-Bounds Access"]}, {"@type": "malware", "type": "malware", "id": "Linux Netfilter Evasion", "name": "Linux Netfilter Evasion", "description": "This malware takes advantage of the out-of-bounds access vulnerability in the Linux kernel's netfilter table.", "labels": ["Linux", "Netfilter", "Evasion"]}, {"@type": "indicator", "type": "indicator", "id": "Linux Netfilter Indicator", "name": "Linux Netfilter Indicator", "description": "This indicator is used to identify the presence of the Linux Netfilter Evasion malware.", "labels": ["Linux", "Netfilter", "Indicator"], "pattern": "out-of-bounds access"}]}, "technical_analysis": {"Introduction": "The Linux kernel's netfilter table is prone to an out-of-bounds access vulnerability, which can be exploited by an attacker to achieve code execution or escalate privileges.", "Impact and Scope": "The vulnerability affects all versions of the Linux kernel from 4.16 to 5.18, and can be exploited by an actor who has access to a system running a vulnerable version of the kernel.", "Related MITRE ATT&CK Techniques": "TA1518, TA1514, TA1511", "Technical Details": "The vulnerability is caused by a lack of input validation in the `nf_tables_newtable` function, which allows an attacker to create a new netfilter table with an invalid family value. This can be exploited to achieve out-of-bounds access and potentially execute code.", "Detection": "Detection of this vulnerability involves monitoring for suspicious network traffic and system calls related to the netfilter table.", "Mitigation": "To mitigate this vulnerability, systems should be updated to a version of the Linux kernel that includes the fix for CVE-2023-6040.", "Conclusion": "The Linux kernel's netfilter table is vulnerable to an out-of-bounds access vulnerability, which can be exploited by an attacker to achieve code execution or escalate privileges. This vulnerability is highly relevant to Linux systems and requires immediate attention."}, "executive_analysis": {"Overview": "The Linux kernel's netfilter table is vulnerable to an out-of-bounds access vulnerability, which can be exploited by an attacker to achieve code execution or escalate privileges.", "Business Impact": "The vulnerability has a significant impact on the security of Linux systems, and exploitation could result in unauthorized access to sensitive data or system resources.", "Technical Impact": "The vulnerability allows an attacker to achieve code execution or escalate privileges, which could potentially lead to a complete compromise of the system.", "Mitigation Strategies": "Systems should be updated to a version of the Linux kernel that includes the fix for CVE-2023-6040, and monitoring should be put in place to detect and prevent exploitation.", "Recommendations": "Executive management should prioritize the patching and updating of Linux systems to prevent exploitation, and ensure that incident response plans are in place to respond to potential breaches.", "Conclusions": "The vulnerability highlights the importance of keeping software up to date and secure, especially for systems that have access to sensitive data or resources."}}