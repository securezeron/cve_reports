{"id": "CVE-2024-29033", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-20T21:15:31.593", "lastModified": "2024-03-21T12:58:51.093", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "OAuthenticator provides plugins for JupyterHub to use common OAuth providers, as well as base classes for writing one's own Authenticators with any OAuth 2.0 provider. `GoogleOAuthenticator.hosted_domain` is used to restrict what Google accounts can be authorized access to a JupyterHub. The restriction is intented to be to Google accounts part of one or more Google organization verified to control specified domain(s). Prior to version 16.3.0, the actual restriction has been to Google accounts with emails ending with the domain. Such accounts could have been created by anyone which at one time was able to read an email associated with the domain. This was described by Dylan Ayrey (@dxa4481) in this [blog post] from 15th December 2023). OAuthenticator 16.3.0 contains a patch for this issue. As a workaround, restrict who can login another way, such as `allowed_users` or `allowed_google_groups`."}, {"lang": "es", "value": "OAuthenticator proporciona complementos para que JupyterHub utilice proveedores de OAuth comunes, as\u00ed como clases base para escribir sus propios autenticadores con cualquier proveedor de OAuth 2.0. `GoogleOAuthenticator.hosted_domain` se utiliza para restringir a qu\u00e9 cuentas de Google se les puede autorizar el acceso a un JupyterHub. La restricci\u00f3n est\u00e1 destinada a las cuentas de Google que forman parte de una o m\u00e1s organizaciones de Google verificadas para controlar dominios espec\u00edficos. Antes de la versi\u00f3n 16.3.0, la restricci\u00f3n real era para las cuentas de Google con correos electr\u00f3nicos que terminaban con el dominio. Estas cuentas podr\u00edan haber sido creadas por cualquier persona que en alg\u00fan momento haya podido leer un correo electr\u00f3nico asociado con el dominio. Esto fue descrito por Dylan Ayrey (@dxa4481) en esta [publicaci\u00f3n de blog] del 15 de diciembre de 2023). OAuthenticator 16.3.0 contiene un parche para este problema. Como workaround, restrinja qui\u00e9n puede iniciar sesi\u00f3n de otra manera, como \"usuarios_permitidos\" o \"grupos_de_google_permitidos\"."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-285"}]}], "references": [{"url": "https://github.com/jupyterhub/oauthenticator/commit/5246b09675501b09fb6ed64022099b7644812f60", "source": "security-advisories@github.com"}, {"url": "https://github.com/jupyterhub/oauthenticator/security/advisories/GHSA-55m3-44xf-hg4h", "source": "security-advisories@github.com"}, {"url": "https://trufflesecurity.com/blog/google-oauth-is-broken-sort-of", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1169", "comment": "DNS Cache Poisoning - Applying DNS caching best practices to prevent attackers from tampering with DNS requests."}, {"techniqueID": "T1204", "comment": "Email Account Harvesting - OAuthenticator's vulnerability can be exploited to access sensitive information, emphasizing the importance of secure email handling practices."}, {"techniqueID": "T1036", "comment": "MASL - OAuthenticator's weakness in Google OAuth authentication allows attackers to bypass intended access restrictions, highlighting the need for thorough authentication and authorization checks."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "https://example.com/CVE-2024-29033.stix2bundle", "spec_version": "2.1", "entities": [{"type": "observed-data", "id": "https://example.com/CVE-2024-29033-observed-data", "created_by_ref": "urn:stix:cybox-2.1:indicator@https://example.com/CVE-2024-29033-indicator", "first_seen": "2024-03-20T21:15:31.593", "last_seen": "2024-03-21T12:58:51.093", "objects": [{"type": "vulnerability", "id": "https://example.com/CVE-2024-29033-vulnerability", "description": "OAuthenticator provides plugins for JupyterHub to use common OAuth providers, as well as base classes for writing one's own Authenticators with any OAuth 2.0 provider."}]}, {"type": "actor", "id": "https://example.com/CVE-2024-29033-actor", "name": "Attackers"}, {"type": "relationship", "id": "https://example.com/CVE-2024-29033-relationship", "source_ref": "https://example.com/CVE-2024-29033-observed-data", "target_ref": "https://example.com/CVE-2024-29033-vulnerability"}, {"type": "relationship", "id": "https://example.com/CVE-2024-29033-relationship2", "source_ref": "https://example.com/CVE-2024-29033-actor", "target_ref": "https://example.com/CVE-2024-29033-vulnerability"}]}}, "technical_analysis": {"Introduction": "OAuthenticator provides plugins for JupyterHub to use common OAuth providers, as well as base classes for writing one's own Authenticators with any OAuth 2.0 provider. However, version 16.3.0 of OAuthenticator contains a vulnerability that can be exploited by attackers.", "Impact and Scope": "The vulnerability affects OAuthenticator versions prior to 16.3.0, allowing attackers to access JupyterHub without proper authentication.", "Related MITRE ATT&CK Techniques": "T1169: DNS Cache Poisoning, T1204: Email Account Harvesting, and T1036: MASL", "Technical Details": "The vulnerability occurs when an attacker can create a Google account with an email address ending with the domain specified in GoogleOAuthenticator.hosted_domain.", "Detection": "Detection methods include monitoring DNS cache and email traffic for suspicious patterns.", "Mitigation": "Mitigation strategies include applying DNS caching best practices and secure email handling practices.", "Conclusion": "In conclusion, the vulnerability in OAuthenticator highlights the importance of secure authentication and authorization practices."}, "executive_analysis": {"Overview": "OAuthenticator provides plugins for JupyterHub to use common OAuth providers, as well as base classes for writing one's own Authenticators with any OAuth 2.0 provider. However, version 16.3.0 of OAuthenticator contains a vulnerability that can be exploited by attackers.", "Business Impact": "The vulnerability can result in unauthorized access to JupyterHub, potentially leading to data breaches and financial losses.", "Technical Impact": "The vulnerability can be exploited to gain unauthorized access to JupyterHub, highlighting the need for robust authentication and authorization practices.", "Mitigation Strategies": "To mitigate the vulnerability, organizations can apply DNS caching best practices and secure email handling practices.", "Recommendations": "Executives should recommend patching OAuthenticator to version 16.3.0 and implementing robust authentication and authorization practices.", "Conclusions": "In conclusion, the vulnerability in OAuthenticator emphasizes the importance of robust security practices to prevent unauthorized access and data breaches."}}