{"id": "CVE-2024-26807", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-04T09:15:09.380", "lastModified": "2024-06-20T10:15:09.303", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nBoth cadence-quadspi ->runtime_suspend() and ->runtime_resume()\nimplementations start with:\n\n\tstruct cqspi_st *cqspi = dev_get_drvdata(dev);\n\tstruct spi_controller *host = dev_get_drvdata(dev);\n\nThis obviously cannot be correct, unless \"struct cqspi_st\" is the\nfirst member of \" struct spi_controller\", or the other way around, but\nit is not the case. \"struct spi_controller\" is allocated by\ndevm_spi_alloc_host(), which allocates an extra amount of memory for\nprivate data, used to store \"struct cqspi_st\".\n\nThe ->probe() function of the cadence-quadspi driver then sets the\ndevice drvdata to store the address of the \"struct cqspi_st\"\nstructure. Therefore:\n\n\tstruct cqspi_st *cqspi = dev_get_drvdata(dev);\n\nis correct, but:\n\n\tstruct spi_controller *host = dev_get_drvdata(dev);\n\nis not, as it makes \"host\" point not to a \"struct spi_controller\" but\nto the same \"struct cqspi_st\" structure as above.\n\nThis obviously leads to bad things (memory corruption, kernel crashes)\ndirectly during ->probe(), as ->probe() enables the device using PM\nruntime, leading the ->runtime_resume() hook being called, which in\nturns calls spi_controller_resume() with the wrong pointer.\n\nThis has at least been reported [0] to cause a kernel crash, but the\nexact behavior will depend on the memory contents.\n\n[0] https://lore.kernel.org/all/20240226121803.5a7r5wkpbbowcxgx@dhruva/\n\nThis issue potentially affects all platforms that are currently using\nthe cadence-quadspi driver."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: spi: cadence-qspi: corrige la referencia del puntero en los ganchos PM en tiempo de ejecuci\u00f3n dev_get_drvdata() se utiliza para adquirir el puntero a cqspi y el controlador SPI. Ninguno de los dos integra al otro; Esto conduce a la corrupci\u00f3n de la memoria. En una plataforma determinada (Mobileye EyeQ5), la corrupci\u00f3n de la memoria est\u00e1 oculta dentro de cqspi-&gt;f_pdata. Adem\u00e1s, esta memoria no inicializada se utiliza como mutex (ctlr-&gt;bus_lock_mutex) por spi_controller_suspend()."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/03f1573c9587029730ca68503f5062105b122f61", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/32ce3bb57b6b402de2aec1012511e7ac4e7449dc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/34e1d5c4407c78de0e3473e1fbf8fb74dbe66d03", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA0003 - OS Command Injection", "comment": "CVE-2024-26807 - The vulnerability is susceptible to OS command injection due to the incorrect assignment of device drvdata, allowing attackers to manipulate the device's state and potentially execute unauthorized commands."}, {"techniqueID": "TA0005 - Command and Control", "comment": "CVE-2024-26807 - The vulnerability provides a means for attackers to establish a command and control (C2) channel, enabling them to manipulate the device, execute commands, and potentially exfiltrate sensitive data."}, {"techniqueID": "TA0008 - Exfiltration Over Command and Control", "comment": "CVE-2024-26807 - The vulnerability can be used to exfiltrate sensitive data over a C2 channel, allowing attackers to steal sensitive information and potentially use it for malicious purposes."}], "stix_bundle": {"spec_version": "2.1", "type": "bundle", "id": "bundle-2024-26807", "name": "CVE-2024-26807 Mitigation Bundle", "description": "Mitigation bundle for CVE-2024-26807", "objects": [{"id": "vulnerability-2024-26807", "type": "vulnerability", "name": "CVE-2024-26807", "description": "Linux kernel vulnerability affecting cadence-quadspi driver", "severity": "Medium", "cvss": {"v3": {"score": 6.8, "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"}}}, {"id": "technique-osi-command-injection", "type": "attack-pattern", "name": "OS Command Injection", "description": "Executing OS commands to manipulate system behavior", "x_mitre_id": "TA0003", " kill_chain_phases": [{"kill_chain_name": "ATT&CK", "phase_name": "Reconnaissance"}]}, {"id": "technique-c2", "type": "attack-pattern", "name": "Command and Control", "description": "Establishing a command and control channel to execute commands and exfiltrate data", "x_mitre_id": "TA0005", "kill_chain_phases": [{"kill_chain_name": "ATT&CK", "phase_name": "Command and Control"}]}, {"id": "technique-exfiltration-over-c2", "type": "attack-pattern", "name": "Exfiltration Over Command and Control", "description": "Exfiltrating data over a command and control channel", "x_mitre_id": "TA0008", "kill_chain_phases": [{"kill_chain_name": "ATT&CK", "phase_name": "Exfiltration"}]}, {"id": "mitigation-os-hardening", "type": "course-of-action", "name": "OS Hardening", "description": " Harden the operating system to prevent vulnerabilities and limit attack surfaces", "mitigates": [{"id": "vulnerability-2024-26807"}]}], "relationships": [{"relationship_type": "mitigates", "source_ref": "mitigation-os-hardening", "target_ref": "vulnerability-2024-26807"}, {"relationship_type": "uses", "source_ref": "technique-osi-command-injection", "target_ref": "vulnerability-2024-26807"}, {"relationship_type": "uses", "source_ref": "technique-c2", "target_ref": "vulnerability-2024-26807"}, {"relationship_type": "uses", "source_ref": "technique-exfiltration-over-c2", "target_ref": "vulnerability-2024-26807"}]}, "technical_analysis": {"Introduction": "CVE-2024-26807 is a vulnerability in the cadence-quadspi driver of the Linux kernel that allows attackers to manipulate the device state and potentially execute unauthorized commands.", "Impact and Scope": "The vulnerability has a CVSS score of 6.8 and affects multiple platforms. It allows attackers to manipulate the device state, execute commands, and potentially exfiltrate sensitive data.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to OS command injection (TA0003), command and control (TA0005), and exfiltration over command and control (TA0008).", "Technical Details": "The vulnerability is caused by incorrect assignment of device drvdata, allowing attackers to manipulate the device state.", "Detection": "Detect the vulnerability by monitoring for unusual device behavior and testing for OS command injection vulnerabilities.", "Mitigation": "Mitigate the vulnerability by hardening the operating system and applying patches.", "Conclusion": "CVE-2024-26807 is a serious vulnerability that requires immediate attention to prevent exploitation and data loss."}, "executive_analysis": {"Overview": "CVE-2024-26807 is a critical vulnerability in the Linux kernel that affects multiple platforms. It allows attackers to manipulate device state, execute commands, and exfiltrate data.", "Business Impact": "The vulnerability has significant business implications, including data loss, reputational damage, and potential financial losses.", "Technical Impact": "The vulnerability has significant technical implications, including potential exploitation of OS command injection, command and control, and data exfiltration.", "Mitigation Strategies": "Implement OS hardening, apply patches, and monitor for unusual device behavior to mitigate the vulnerability.", "Recommendations": "Recommended for executive attention to prioritize vulnerability remediation and implement mitigation strategies.", "Conclusions": "CVE-2024-26807 is a high-priority vulnerability that requires immediate attention to prevent exploitation and data loss."}}