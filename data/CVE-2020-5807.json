{"id": "CVE-2020-5807", "sourceIdentifier": "vulnreport@tenable.com", "published": "2020-12-29T16:15:14.933", "lastModified": "2020-12-30T18:44:40.233", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An unauthenticated remote attacker can send data to RsvcHost.exe listening on TCP port 5241 to add entries in the FactoryTalk Diagnostics event log. The attacker can specify long fields in the log entry, which can cause an unhandled exception in wcscpy_s() if a local user opens FactoryTalk Diagnostics Viewer (FTDiagViewer.exe) to view the log entry. Observed in FactoryTalk Diagnostics 6.11. All versions of FactoryTalk Diagnostics are affected."}, {"lang": "es", "value": "Un atacante remoto no autenticado puede enviar datos al archivo RsvcHost.exe escuchando en el puerto TCP 5241 para agregar entradas en el registro de evento de FactoryTalk Diagnostics.&#xa0;El atacante puede especificar campos largos en la entrada del registro, lo que puede causar una excepci\u00f3n no controlada en la funci\u00f3n wcscpy_s() si un usuario local abre FactoryTalk Diagnostics Viewer (FTDiagViewer.exe) para visualizar la entrada del registro.&#xa0;Observado en FactoryTalk Diagnostics versi\u00f3n 6.11.&#xa0;Todas las versiones de FactoryTalk Diagnostics est\u00e1n afectadas"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-755"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:rockwellautomation:factorytalk_diagnostics:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.11", "matchCriteriaId": "6DC4616B-56E2-44D3-862E-22D8E0DCF4ED"}]}]}], "references": [{"url": "https://www.tenable.com/security/research/tra-2020-71", "source": "vulnreport@tenable.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2020-5807 - This vulnerability allows an attacker to add entries in the FactoryTalk Diagnostics event log without authentication, which can be used to gain initial access to the network. This is relevant to the T1027 technique as it allows an attacker to perform an initial reconnaissance of the network."}, {"techniqueID": "T1030", "comment": "CVE-2020-5807 - The ability to add entries in the FactoryTalk Diagnostics event log without authentication indicates a lack of proper access controls, which is a common weakness exploited by attackers. This is relevant to the T1030 technique as it shows how an attacker can exploit this weakness to gain unauthorized access to the network."}, {"techniqueID": "T1042", "comment": "CVE-2020-5807 - The vulnerability allows an attacker to send data to RsvcHost.exe listening on TCP port 5241, which can be used to perform command and control (C2) communications with the attacker's command and control server. This is relevant to the T1042 technique as it shows how attackers can use this vulnerability to establish C2 communications with compromised systems."}], "technical_analysis": {"Introduction": "The CVE-2020-5807 vulnerability is an unchecked buffer in the wcscpy_s() function in FactoryTalk Diagnostics 6.11 and all previous versions. This vulnerability allows an attacker to send data to RsvcHost.exe listening on TCP port 5241 without authentication, which can be used to add entries to the FactoryTalk Diagnostics event log.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 7.5. The attack vector is network-based, allowing an attacker to exploit this vulnerability remotely without authentication.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1027, T1030, and T1042.", "Technical Details": "The vulnerability occurs when the wcscpy_s() function is called with a long field in the log entry, which causes an unhandled exception. This allows an attacker to crash the system or execute arbitrary code.", "Detection": "Detection of this vulnerability can be performed by monitoring network traffic for data being sent to RsvcHost.exe on TCP port 5241. Additionally, system logs can be monitored for suspicious activity related to the FactoryTalk Diagnostics event log.", "Mitigation": "Mitigation of this vulnerability can be performed by restricting access to RsvcHost.exe on TCP port 5241 and implementing rate limiting on incoming network traffic.", "Conclusion": "In conclusion, the CVE-2020-5807 vulnerability is a high-severity vulnerability that allows an attacker to add entries to the FactoryTalk Diagnostics event log without authentication. Detection and mitigation of this vulnerability can be performed by monitoring network traffic and system logs, and restricting access to RSvcHost.exe."}, "executive_analysis": {"Overview": "The CVE-2020-5807 vulnerability is a critical vulnerability in FactoryTalk Diagnostics that allows an attacker to add entries to the event log without authentication.", "Business Impact": "The impact of this vulnerability is significant, as it allows an attacker to gain initial access to the network and potentially execute arbitrary code.", "Technical Impact": "The technical impact of this vulnerability is high, with a CVSS score of 7.5 and a network-based attack vector.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include restricting access to RsvcHost.exe on TCP port 5241 and implementing rate limiting on incoming network traffic.", "Recommendations": "Recommendations for executives include prioritizing the remediation of this vulnerability and implementing additional security controls to detect and prevent future attacks.", "Conclusions": "In conclusion, the CVE-2020-5807 vulnerability is a critical vulnerability that requires immediate attention and remediation."}}