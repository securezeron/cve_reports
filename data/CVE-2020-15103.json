{"id": "CVE-2020-15103", "sourceIdentifier": "security-advisories@github.com", "published": "2020-07-27T18:15:13.903", "lastModified": "2023-11-07T03:17:24.850", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In FreeRDP less than or equal to 2.1.2, an integer overflow exists due to missing input sanitation in rdpegfx channel. All FreeRDP clients are affected. The input rectangles from the server are not checked against local surface coordinates and blindly accepted. A malicious server can send data that will crash the client later on (invalid length arguments to a `memcpy`) This has been fixed in 2.2.0. As a workaround, stop using command line arguments /gfx, /gfx-h264 and /network:auto"}, {"lang": "es", "value": "En FreeRDP versiones anteriores o igual a 2.1.2, se presenta un desbordamiento de enteros debido a una falta de saneamiento de entrada en el canal rdpegfx. Todos los clientes de FreeRDP est\u00e1n afectados. Los rect\u00e1ngulos de entrada del servidor no son comprobados contra las coordenadas de la superficie local y se aceptan ciegamente. Un servidor malicioso puede enviar datos que bloquear\u00e1n al cliente m\u00e1s adelante (argumentos de longitud no v\u00e1lidos a un \"memcpy\"). Esto ha sido corregido en la versi\u00f3n 2.2.0. Como soluci\u00f3n alternativa, deje de usar argumentos de l\u00ednea de comandos /gfx, /gfx-h264 y /network:auto"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-680"}]}, {"source": "nvd@nist.gov", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-190"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:freerdp:freerdp:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.1.2", "matchCriteriaId": "97C18E70-9E09-4C4E-B070-AAA72AF12FD3"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:31:*:*:*:*:*:*:*", "matchCriteriaId": "80F0FA5D-8D3B-4C0E-81E2-87998286AF33"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*", "matchCriteriaId": "36D96259-24BD-44E2-96D9-78CE1D41F956"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*", "matchCriteriaId": "B620311B-34A3-48A6-82DF-6F078D7A4493"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:esm:*:*:*", "matchCriteriaId": "B3293E55-5506-4587-A318-D1734F781C09"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:20.04:*:*:*:lts:*:*:*", "matchCriteriaId": "902B8056-9E37-443B-8905-8AA93E2447FB"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-09/msg00010.html", "source": "security-advisories@github.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://github.com/FreeRDP/FreeRDP/blob/616af2d5b86dc24c7b3e89870dbcffd841d9a535/ChangeLog#L4", "source": "security-advisories@github.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/FreeRDP/FreeRDP/pull/6382", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/FreeRDP/FreeRDP/security/advisories/GHSA-4r38-6hq7-j3j9", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2023/10/msg00008.html", "source": "security-advisories@github.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/6Y35HBHG2INICLSGCIKNAR7GCXEHQACQ/", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XOZLH35OJWIQLM7FYDXAP2EAUBDXE76V/", "source": "security-advisories@github.com"}, {"url": "https://usn.ubuntu.com/4481-1/", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1570", "comment": "CVE-2020-15103 - Input validation weakness in FreeRDP's rdpegfx channel, which allows a malicious server to send data that will crash the client (CWE-680)."}, {"techniqueID": "T1190", "comment": "CVE-2020-15103 - Use of unvalidated input in the rdpegfx channel, potentially leading to a buffer overflow vulnerability (CWE-190)."}], "stix_bundle": {"cybox": {"Vulnerability": {"id": "CVE-2020-15103", "name": "FreeRDP rdpegfx channel integer overflow"}}, "AttackPattern": [{"id": "AP:123456", "name": "FreeRDP rdpegfx channel integer overflow exploit"}], "Indicator": [{"id": "IND:654321", "value": "rdpegfx channel integer overflow"}], "Malware": [{"id": "MA:901234", "name": "FreeRDP rdpegfx channel integer overflow exploit"}], "CourseOfAction": [{"id": "COA:111111", "name": "Disable command line arguments /gfx, /gfx-h264 and /network:auto"}], "Note": [{"id": "NOTE:123456", "content": "Disabling command line arguments /gfx, /gfx-h264 and /network:auto mitigates the vulnerability."}]}, "technical_analysis": {"Introduction": "FreeRDP's rdpegfx channel has a vulnerability due to an integer overflow in the input sanitization process.", "Impact and Scope": "The vulnerability allows a malicious server to send data that will crash the client. CVSS score is 3.5 with a moderate attack complexity.", "Related MITRE ATT&CK Techniques": "T1570 (Lateral Movement) and T1190 (Exploit Public-Facing Applications) are relevant to this CVE.", "Technical Details": "The vulnerability is due to the failure to check the length of the input rectangles from the server against the local surface coordinates.", "Detection": "Detection can be done by monitoring for unusual client crashes or error messages related to the rdpegfx channel.", "Mitigation": "Disabling command line arguments /gfx, /gfx-h264 and /network:auto mitigates the vulnerability.", "Conclusion": "The vulnerability is a serious issue and should be addressed as soon as possible."}, "executive_analysis": {"Overview": "FreeRDP has a vulnerability in its rdpegfx channel due to an integer overflow in the input sanitization process.", "Business Impact": "The vulnerability allows a malicious server to send data that will crash the client, impacting business operations.", "Technical Impact": "The vulnerability is a serious technical issue that requires immediate attention.", "Mitigation Strategies": "Disabling command line arguments /gfx, /gfx-h264 and /network:auto is a recommended mitigation strategy.", "Recommendations": "Executives should recommend disabling command line arguments /gfx, /gfx-h264 and /network:auto to the IT department.", "Conclusions": "The vulnerability is a significant risk to the organization and should be addressed as soon as possible."}}