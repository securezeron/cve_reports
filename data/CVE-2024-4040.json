{"id": "CVE-2024-4040", "sourceIdentifier": "430a6cef-dc26-47e3-9fa8-52fb7f19644e", "published": "2024-04-22T20:15:07.803", "lastModified": "2024-04-26T15:25:47.270", "vulnStatus": "Analyzed", "cveTags": [], "cisaExploitAdd": "2024-04-24", "cisaActionDue": "2024-05-01", "cisaRequiredAction": "Apply mitigations per vendor instructions or discontinue use of the product if mitigations are unavailable.", "cisaVulnerabilityName": "CrushFTP VFS Sandbox Escape Vulnerability", "descriptions": [{"lang": "en", "value": "A server side template injection vulnerability in CrushFTP in all versions before 10.7.1 and 11.1.0 on all platforms allows unauthenticated remote attackers to read files from the filesystem outside of the VFS Sandbox, bypass authentication to gain administrative access, and perform remote code execution on the server.\n"}, {"lang": "es", "value": "VFS Sandbox Escape en CrushFTP en todas las versiones anteriores a 10.7.1 y 11.1.0 en todas las plataformas permite a atacantes remotos con privilegios bajos leer archivos del sistema de archivos fuera de VFS Sandbox."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 6.0}, {"source": "430a6cef-dc26-47e3-9fa8-52fb7f19644e", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}, {"source": "430a6cef-dc26-47e3-9fa8-52fb7f19644e", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1336"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:crushftp:crushftp:*:*:*:*:*:*:*:*", "versionStartIncluding": "10.0.0", "versionEndExcluding": "10.7.1", "matchCriteriaId": "1922C854-D367-44B7-AEFB-4AEB07679E16"}, {"vulnerable": true, "criteria": "cpe:2.3:a:crushftp:crushftp:*:*:*:*:*:*:*:*", "versionStartIncluding": "11.0.0", "versionEndExcluding": "11.1.0", "matchCriteriaId": "4EF482D8-4F40-454D-9A92-9D6924C582E2"}]}]}], "references": [{"url": "https://github.com/airbus-cert/CVE-2024-4040", "source": "430a6cef-dc26-47e3-9fa8-52fb7f19644e", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://www.bleepingcomputer.com/news/security/crushftp-warns-users-to-patch-exploited-zero-day-immediately/", "source": "430a6cef-dc26-47e3-9fa8-52fb7f19644e", "tags": ["Press/Media Coverage", "Third Party Advisory"]}, {"url": "https://www.crushftp.com/crush10wiki/Wiki.jsp?page=Update", "source": "430a6cef-dc26-47e3-9fa8-52fb7f19644e", "tags": ["Vendor Advisory"]}, {"url": "https://www.crushftp.com/crush11wiki/Wiki.jsp?page=Update", "source": "430a6cef-dc26-47e3-9fa8-52fb7f19644e", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://www.rapid7.com/blog/post/2024/04/23/etr-unauthenticated-crushftp-zero-day-enables-complete-server-compromise/", "source": "430a6cef-dc26-47e3-9fa8-52fb7f19644e", "tags": ["Third Party Advisory"]}, {"url": "https://www.reddit.com/r/crowdstrike/comments/1c88788/situational_awareness_20240419_crushftp_virtual/", "source": "430a6cef-dc26-47e3-9fa8-52fb7f19644e", "tags": ["Press/Media Coverage", "Third Party Advisory"]}, {"url": "https://www.reddit.com/r/cybersecurity/comments/1c850i2/all_versions_of_crush_ftp_are_vulnerable/", "source": "430a6cef-dc26-47e3-9fa8-52fb7f19644e", "tags": ["Patch", "Press/Media Coverage", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-4040 - A CrushFTP template injection vulnerability allows an attacker to read files outside of the VFS Sandbox, bypass authentication, and perform remote code execution. This technique is related to server-side request forgery."}, {"techniqueID": "T1189", "comment": "CVE-2024-4040 - This vulnerability allows an attacker to inject arbitrary server-side templates, leading to code execution and file access. This technique is related to server-side request forgery and code injection."}, {"techniqueID": "T1192", "comment": "CVE-2024-4040 - An attacker can exploit this vulnerability to read files outside of the VFS Sandbox and bypass authentication. This technique is related to lateral movement and data theft."}, {"techniqueID": "T1027", "comment": "CVE-2024-4040 - This vulnerability allows an attacker to inject arbitrary code on the server, which can be used to gain a foothold in the system. This technique is related to web shell placement and persistence."}], "stix_bundle": {"id": "stix-bundle-2024-04-27", "type": "bundle", "spec_version": "2.1", "idref": "CVE-2024-4040", "created_by": "Automation", "created": "2024-04-27T14:00:00.000Z", "modified": "2024-04-27T14:00:00.000Z", "objects": [{"type": "vulnerability", "id": "CVE-2024-4040", "label": "CrushFTP VFS Sandbox Escape Vulnerability", "created_by": "Automation", "created": "2024-04-27T14:00:00.000Z", "modified": "2024-04-27T14:00:00.000Z", "description": "A server-side template injection vulnerability in CrushFTP in all versions before 10.7.1 and 11.1.0 on all platforms allows unauthenticated remote attackers to read files from the filesystem outside of the VFS Sandbox, bypass authentication to gain administrative access, and perform remote code execution on the server.", "relations": [{"type": "capec-attack-pattern", "idref": "CAPEC-40013", "label": "Server-Side Template Injection"}, {"type": "capec-attack-pattern", "idref": "CAPEC-40014", "label": "Server-Side Request Forgery"}]}, {"type": "attack-pattern", "id": "T1190", "label": "Server-Side Request Forgery", "created_by": "Automation", "created": "2024-04-27T14:00:00.000Z", "modified": "2024-04-27T14:00:00.000Z", "description": "Server-side request forgery (SSRF) is an attack technique where an attacker injects malicious code or data into a server, which is then executed by the server or its components.", "relations": [{"type": "vulnerability", "idref": "CVE-2024-4040", "label": "CrushFTP VFS Sandbox Escape Vulnerability"}]}, {"type": "course-of-action", "id": "COA-1", "label": "Apply Mitigations Per Vendor Instructions", "created_by": "Automation", "created": "2024-04-27T14:00:00.000Z", "modified": "2024-04-27T14:00:00.000Z", "description": "Apply the provided mitigations per vendor instructions or discontinue use of the product if mitigations are unavailable.", "relations": [{"type": "vulnerability", "idref": "CVE-2024-4040", "label": "CrushFTP VFS Sandbox Escape Vulnerability"}, {"type": "technique", "idref": "T1190", "label": "Server-Side Request Forgery"}]}]}, "technical_analysis": {"Introduction": "This vulnerability is a server-side template injection vulnerability in CrushFTP that allows an attacker to read files outside of the VFS Sandbox, bypass authentication, and perform remote code execution.", "Impact and Scope": "This vulnerability has a CVSS score of 10.0 and affects all versions of CrushFTP before 10.7.1 and 11.1.0.", "Related MITRE ATT&CK Techniques": "T1190, T1189, T1192, T1027", "Technical Details": "The vulnerability allows an attacker to inject arbitrary server-side templates, leading to code execution and file access.", "Detection": "Detecting this vulnerability requires monitoring for suspicious network traffic and system logs.", "Mitigation": "Apply the provided mitigations per vendor instructions or discontinue use of the product if mitigations are unavailable.", "Conclusion": "This vulnerability is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-4040 is a critical vulnerability in CrushFTP that allows an attacker to read files outside of the VFS Sandbox, bypass authentication, and perform remote code execution.", "Business Impact": "This vulnerability could result in the compromise of sensitive data and the disruption of business operations.", "Technical Impact": "This vulnerability could allow an attacker to gain a foothold in the system and escalate privileges.", "Mitigation Strategies": "Apply the provided mitigations per vendor instructions or discontinue use of the product if mitigations are unavailable.", "Recommendations": "Review and apply the provided mitigations as soon as possible, and consider discontinuing use of the product if mitigations are unavailable.", "Conclusions": "This vulnerability is a critical vulnerability that requires immediate attention and mitigation. It is essential to prioritize the mitigation of this vulnerability to prevent any potential business disruptions."}}