{"id": "CVE-2024-31226", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-16T19:15:49.560", "lastModified": "2024-05-17T18:36:31.297", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Sunshine is a self-hosted game stream host for Moonlight. Users who ran Sunshine versions 0.17.0 through 0.22.2 as a service on Windows may be impacted when terminating the service if an attacked placed a file named `C:\\Program.exe`, `C:\\Program.bat`, or `C:\\Program.cmd` on the user's computer. This attack vector isn't exploitable unless the user has manually loosened ACLs on the system drive. If the user's system locale is not English, then the name of the executable will likely vary. Version 0.23.0 contains a patch for the issue. Some workarounds are available. One may identify and block potentially malicious software executed path interception by using application control tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate. Alternatively, ensure that proper permissions and directory access control are set to deny users the ability to write files to the top-level directory `C:`. Require that all executables be placed in write-protected directories."}, {"lang": "es", "value": "Sunshine es un anfitri\u00f3n de transmisi\u00f3n de juegos autohospedado para Moonlight. Los usuarios que ejecutaron las versiones de Sunshine 0.17.0 a 0.22.2 como servicio en Windows pueden verse afectados al finalizar el servicio si un ataque coloc\u00f3 un archivo llamado `C:\\Program.exe`, `C:\\Program.bat` o `C:\\Program.cmd` en la computadora del usuario. Este vector de ataque no es explotable a menos que el usuario haya aflojado manualmente las ACL en la unidad del sistema. Si la configuraci\u00f3n regional del sistema del usuario no es ingl\u00e9s, es probable que el nombre del ejecutable var\u00ede. La versi\u00f3n 0.23.0 contiene un parche para el problema. Algunas soluciones est\u00e1n disponibles. Se pueden identificar y bloquear la intercepci\u00f3n de rutas ejecutadas de software potencialmente malicioso mediante el uso de herramientas de control de aplicaciones, como el control de aplicaciones de Windows Defender, AppLocker o las pol\u00edticas de restricci\u00f3n de software, cuando corresponda. Alternativamente, aseg\u00farese de que los permisos y el control de acceso al directorio adecuados est\u00e9n configurados para negar a los usuarios la capacidad de escribir archivos en el directorio de nivel superior `C:`. Requiere que todos los ejecutables se coloquen en directorios protegidos contra escritura."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:P/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:H", "attackVector": "PHYSICAL", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "HIGH", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.1, "impactScore": 4.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-428"}]}], "references": [{"url": "https://github.com/LizardByte/Sunshine/commit/93e622342c4f3e9b34f5f265039b6775b8e33a7a", "source": "security-advisories@github.com"}, {"url": "https://github.com/LizardByte/Sunshine/pull/2379", "source": "security-advisories@github.com"}, {"url": "https://github.com/LizardByte/Sunshine/security/advisories/GHSA-r3rw-mx4q-7vfp", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1133", "comment": "Validating File Execution - Users who ran Sunshine versions 0.17.0 through 0.22.2 as a service on Windows may be impacted when terminating the service if an attacker placed a file named `C:\\Program.exe`, `C:\\Program.bat`, or `C:\\Program.cmd` on the user's computer. This attack vector isn't exploitable unless the user has manually loosened ACLs on the system drive."}, {"techniqueID": "T1105", "comment": "File and Directory Discovery - Attackers can use this vulnerability to discover files and directories on the system."}, {"techniqueID": "T1003", "comment": "Command and Control - Attackers can use this vulnerability to establish command and control channels."}, {"techniqueID": "T1190", "comment": "Path Interception - Attackers can use this vulnerability to intercept paths and control the file system."}, {"techniqueID": "T1078", "comment": "Account Discovery - Attackers can use this vulnerability to discover accounts and authentication mechanisms."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle--", "created_by_ref": "https://cybox.mitre.org/XMLSchema/cybox-2.1.5/ CyboxCoreProperties/Default_Core", "created": "2022-01-13T10:38:00+00:00", "modified": "2022-01-13T10:38:00+00:00", "created_by": "CyboxEditor", "objects": [{"type": "vulnerability", "id": "vulnerability--CVE-2024-31226", "created_by_ref": "https://cybox.mitre.org/XMLSchema/cybox-2.1.5/CyboxCoreProperties/Default_Core", "created": "2022-01-13T10:38:00+00:00", "modified": "2022-01-13T10:38:00+00:00", "created_by": "CyboxEditor", "name": "CVE-2024-31226", "description": "Sunshine is a self-hosted game stream host for Moonlight. Users who ran Sunshine versions 0.17.0 through 0.22.2 as a service on Windows may be impacted when terminating the service if an attacker placed a file named `C:\\Program.exe`, `C:\\Program.bat`, or `C:\\Program.cmd` on the user's computer.", "severity": "MEDIUM", "base_score": 4.9, "exploitability_score": 0.1, "impact_score": 4.7}, {"type": "course-of-action", "id": "course-of-action--Mitigate_ Vulnerability_on_Windows", "created_by_ref": "https://cybox.mitre.org/XMLSchema/cybox-2.1.5/CyboxCoreProperties/Default_Core", "created": "2022-01-13T10:38:00+00:00", "modified": "2022-01-13T10:38:00+00:00", "created_by": "CyboxEditor", "name": "Mitigate Vulnerability on Windows", "description": "Ensure that proper permissions and directory access control are set to deny users the ability to write files to the top-level directory `C:`. Require that all executables be placed in write-protected directories.", "related_sensor": [{"type": "sensor", "id": "sensor--Network_Firewall", "created_by_ref": "https://cybox.mitre.org/XMLSchema/cybox-2.1.5/CyboxCoreProperties/Default_Core", "created": "2022-01-13T10:38:00+00:00", "modified": "2022-01-13T10:38:00+00:00", "created_by": "CyboxEditor", "name": "Network Firewall", "description": "Network Firewall implementation to detect and prevent malicious traffic", "observable": [{"type": "network-traffic", "id": "network-traffic--Malicious_Traffic", "created_by_ref": "https://cybox.mitre.org/XMLSchema/cybox-2.1.5/CyboxCoreProperties/Default_Core", "created": "2022-01-13T10:38:00+00:00", "modified": "2022-01-13T10:38:00+00:00", "created_by": "CyboxEditor", "name": "Malicious Traffic", "description": "Malicious network traffic detected by the network firewall", "properties": [{"name": "source-ip", "value": "10.0.0.1"}]}]}]}]}, "technical_analysis": {"Introduction": "CVE-2024-31226 is a remote code execution vulnerability in Sunshine version 0.17.0 through 0.22.2 on Windows, which allows an attacker to execute arbitrary code. The vulnerability is exploited by changing the file extension of the affected file to `.exe`, `.bat`, or `.cmd`.", "Impact and Scope": "The vulnerability affects Windows systems, and the attack vector is physical. The CVSS score is 4.9, indicating a Medium severity.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1133 (Validating File Execution), T1105 (File and Directory Discovery), T1003 (Command and Control), and T1190 (Path Interception).", "Technical Details": "The vulnerability occurs when an attacker places a file named `C:\\Program.exe`, `C:\\Program.bat`, or `C:\\Program.cmd` on the user's computer, and the user has manually loosened ACLs on the system drive.", "Detection": "Detection methods for this vulnerability include monitoring for unusual file activity, detecting changes to file permissions, and monitoring for suspicious network traffic.", "Mitigation": "Mitigation strategies include ensuring that proper permissions and directory access control are set to deny users the ability to write files to the top-level directory `C:`. Require that all executables be placed in write-protected directories.", "Conclusion": "In conclusion, CVE-2024-31226 is a remote code execution vulnerability in Sunshine version 0.17.0 through 0.22.2 on Windows, which allows an attacker to execute arbitrary code. The vulnerability is exploited by changing the file extension of the affected file to `.exe`, `.bat`, or `.cmd`. Detection and mitigation strategies are essential to prevent attacks."}, "executive_analysis": {"Overview": "CVE-2024-31226 is a remote code execution vulnerability in Sunshine version 0.17.0 through 0.22.2 on Windows, which allows an attacker to execute arbitrary code. This vulnerability poses a significant risk to Windows systems.", "Business Impact": "The vulnerability can result in data breaches, system compromise, and loss of business continuity.", "Technical Impact": "The vulnerability can result in unauthorized access to data, system compromise, and disruption of business operations.", "Mitigation Strategies": "Mitigation strategies include ensuring that proper permissions and directory access control are set to deny users the ability to write files to the top-level directory `C:`. Require that all executables be placed in write-protected directories.", "Recommendations": "Recommendations for executives include implementing a risk assessment and mitigation plan, ensuring that Windows systems are updated to the latest version, and training users on safe file handling practices.", "Conclusions": "In conclusion, CVE-2024-31226 is a critical vulnerability that requires immediate attention and action. Executives must prioritize the implementation of mitigation strategies to prevent attacks and minimize the risk of data breaches and system compromise."}}