{"id": "CVE-2020-28347", "sourceIdentifier": "cve@mitre.org", "published": "2020-11-08T20:15:11.793", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "tdpServer on TP-Link Archer A7 AC1750 devices before 201029 allows remote attackers to execute arbitrary code via the slave_mac parameter. NOTE: this issue exists because of an incomplete fix for CVE-2020-10882 in which shell quotes are mishandled."}, {"lang": "es", "value": "tdpServer en dispositivos TP-Link Archer A7 AC1750 versiones anteriores a 201029, permite a atacantes remotos ejecutar c\u00f3digo arbitrario mediante el par\u00e1metro slave_mac. NOTA: este problema se presenta debido a una correcci\u00f3n incompleta para el CVE-2020-10882 en que las citas de shell se manejan inapropiadamente"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:tp-link:ac1750:a7:*:*:*:*:*:*:*", "matchCriteriaId": "F42A7EDC-ECE1-4D62-8DD7-8EB68A0F8215"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:tp-link:ac1750_firmware:*:*:*:*:*:*:*:*", "versionEndExcluding": "201029", "matchCriteriaId": "5FDBE8E9-2DB3-4C33-AF45-99DE5898DC9E"}]}]}], "references": [{"url": "https://github.com/pedrib/PoC/blob/master/advisories/Pwn2Own/Tokyo_2019/lao_bomb/lao_bomb.md", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/pedrib/PoC/blob/master/advisories/Pwn2Own/Tokyo_2020/minesweeper.md", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/rapid7/metasploit-framework/pull/14365", "source": "cve@mitre.org", "tags": ["Exploit", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/rdomanski/Exploits_and_Advisories/blob/master/advisories/Pwn2Own/Tokyo2019/lao_bomb.md", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/rdomanski/Exploits_and_Advisories/blob/master/advisories/Pwn2Own/Tokyo2020/minesweeper.md", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-28347 - This technique is relevant to the exploitation of a vulnerable CPE (cpe:2.3:o:tp-link:ac1750_firmware:*:*:*:*:*:*:*:*). It's important to detect and prevent exploitation attempts using techniques like network monitoring and intrusion detection."}, {"techniqueID": "T1191", "comment": "CVE-2020-28347 - This technique is relevant to the exploitation of a vulnerable CPE (cpe:2.3:o:tp-link:ac1750_firmware:*:*:*:*:*:*:*:*). It's important to detect and prevent exploitation attempts using techniques like file monitoring and access control."}, {"techniqueID": "T1589.001", "comment": "CVE-2020-28347 - This technique is relevant to the execution of arbitrary code on a vulnerable device. It's important to detect and prevent shell commands being mishandled, and to implement input validation and sanitization."}, {"techniqueID": "T1555.007", "comment": "CVE-2020-28347 - This technique is relevant to the execution of a command string injected by an attacker. It's important to detect and prevent command injection attacks, and to implement input validation and sanitization."}], "stix_bundle": {"@cybox": "1.0", "bundle": {"description": "Vulnerability Analysis for CVE-2020-28347", "objects": [{"type": "relationship", "relationship_type": "related_to", "source_ref": "vulnerability:CVE-2020-28347", "target_ref": "indicator:x509 Certificate Spoofing"}, {"type": "relationship", "relationship_type": "mitigates", "source_ref": "course_of_action:Implements Input Validation", "target_ref": "vulnerability:CVE-2020-28347"}, {"type": "relationship", "relationship_type": "uses", "source_ref": "tool:Network Monitoring Tool", "target_ref": "vulnerability:CVE-2020-28347"}, {"type": "vulnerability", "id": "CVE-2020-28347", "name": "CVE-2020-28347", "description": "tdpServer on TP-Link Archer A7 AC1750 devices before 201029 allows remote attackers to execute arbitrary code via the slave_mac parameter.", "cvss": {"scores": [{"score": 9.8}]}}, {"type": "indicator", "id": "x509 Certificate Spoofing", "name": "x509 Certificate Spoofing", "description": "Indicates the presence of a x509 certificate spoofing attack"}, {"type": "course_of_action", "id": "Implements Input Validation", "name": "Implements Input Validation", "description": "Implement input validation and sanitization to prevent command injection attacks"}, {"type": "tool", "id": "Network Monitoring Tool", "name": "Network Monitoring Tool", "description": "Network monitoring tool to detect and prevent network traffic attacks"}]}}, "technical_analysis": {"Introduction": "The CVE-2020-28347 vulnerability affects TP-Link Archer A7 AC1750 devices before 201029. It allows remote attackers to execute arbitrary code via the slave_mac parameter.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and affects devices running before 201029. It allows remote attackers to execute arbitrary code, which can lead to a complete compromise of the device.", "Related MITRE ATT&CK Techniques": "T1190, T1191, T1589.001, and T1555.007", "Technical Details": "The vulnerability occurs due to mishandled shell quotes in the tdpServer. An attacker can inject malicious code by sending a crafted slave_mac parameter.", "Detection": "Detecting this vulnerability requires monitoring network traffic and applying signature-based detection techniques to identify suspicious traffic patterns.", "Mitigation": "Implement input validation and sanitization to prevent command injection attacks. Monitor network traffic to detect and prevent suspicious traffic patterns.", "Conclusion": "The CVE-2020-28347 vulnerability is a critical vulnerability that can allow remote attackers to execute arbitrary code. Implementing mitigation strategies and monitoring network traffic is crucial to preventing exploitation attempts."}, "executive_analysis": {"Overview": "The CVE-2020-28347 vulnerability is a critical vulnerability affecting TP-Link Archer A7 AC1750 devices before 201029.", "Business Impact": "Exploitation of this vulnerability can lead to a complete compromise of the device, resulting in business disruption and reputational damage.", "Technical Impact": "The vulnerability allows remote attackers to execute arbitrary code, which can lead to a complete compromise of the device.", "Mitigation Strategies": "Implement input validation and sanitization to prevent command injection attacks and monitor network traffic to detect and prevent suspicious traffic patterns.", "Recommendations": "Develop a incident response plan, implement input validation and sanitization, and monitor network traffic to detect and prevent suspicious traffic patterns.", "Conclusions": "The CVE-2020-28347 vulnerability is a critical vulnerability that requires immediate attention. Developing a incident response plan and implementing mitigation strategies is crucial to preventing exploitation attempts."}}