{"id": "CVE-2024-2840", "sourceIdentifier": "security@wordfence.com", "published": "2024-05-02T17:15:20.100", "lastModified": "2024-05-02T18:00:37.360", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Enhanced Media Library plugin for WordPress is vulnerable to Stored Cross-Site Scripting via media upload functionality in all versions up to, and including, 2.8.9 due to the plugin allowing 'dfxp' files to be uploaded. This makes it possible for authenticated attackers, with author-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page."}, {"lang": "es", "value": "El complemento Enhanced Media Library para WordPress es vulnerable a Cross-Site Scripting Almacenado a trav\u00e9s de la funcionalidad de carga de medios en todas las versiones hasta la 2.8.9 incluida, debido a que el complemento permite cargar archivos 'dfxp'. Esto hace posible que atacantes autenticados, con acceso a nivel de autor y superior, inyecten scripts web arbitrarios en p\u00e1ginas que se ejecutar\u00e1n cada vez que un usuario acceda a una p\u00e1gina inyectada."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}]}, "references": [{"url": "https://plugins.trac.wordpress.org/changeset?old_path=/enhanced-media-library/tags/2.8.9&new_path=/enhanced-media-library/tags/2.8.10&sfp_email=&sfph_mail=", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/15b30ecb-e3ce-4092-841b-3a1b2553596a?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1059.005 - Command and Scripting Interpreter: Elevated Execution", "comment": "CVE-2024-2840 - An attacker can inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page, using the Enhanced Media Library plugin for WordPress, to gain elevated privileges."}, {"techniqueID": "T1193 - Spearphishing Email", "comment": "CVE-2024-2840 - An attacker can send targeted spearphishing emails to users with author-level access and above, to trick them into uploading a malicious 'dfxp' file, which can lead to the injection of arbitrary web scripts."}, {"techniqueID": "T1190 - Data Stolen Through an Unsecured Interface", "comment": "CVE-2024-2840 - An authenticated attacker with author-level access and above can steal sensitive data by uploading a malicious 'dfxp' file, which can be used to inject arbitrary web scripts."}, {"techniqueID": "T1027 - Command and Control: Standard Command Shell", "comment": "CVE-2024-2840 - An attacker can use the injected web script to establish a command and control channel, using a standard command shell, to execute system commands and maintain persistence."}, {"techniqueID": "T1566.002 - Phishing: Spearphishing Link", "comment": "CVE-2024-2840 - An attacker can send targeted spearphishing emails to users with author-level access and above, containing a link to a malicious page that can lead to the injection of arbitrary web scripts."}], "technical_analysis": {"Introduction": "The Enhanced Media Library plugin for WordPress is vulnerable to Stored Cross-Site Scripting due to the allowance of 'dfxp' file uploads, allowing authenticated attackers with author-level access and above to inject arbitrary web scripts.", "Impact and Scope": "The vulnerability impacts all versions of the Enhanced Media Library plugin up to and including 2.8.9, with a CVSS score of 5.4 (MEDIUM) and an attack vector of Network.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including Command and Scripting Interpreter: Elevated Execution, Spearphishing Email, Data Stolen Through an Unsecured Interface, Command and Control: Standard Command Shell, and Phishing: Spearphishing Link.", "Technical Details": "The vulnerability is due to the plugin allowing 'dfxp' files to be uploaded via the media upload functionality, which can lead to the injection of arbitrary web scripts.", "Detection": "Detection can be performed by monitoring for unusual traffic patterns or network activity, or by using security tools that analyze web traffic for injected scripts.", "Mitigation": "Mitigation strategies include updating the Enhanced Media Library plugin to version 2.8.10 or higher, or disabling the media upload functionality if not needed.", "Conclusion": "The vulnerability is a significant risk to organizations that use the Enhanced Media Library plugin for WordPress, and should be addressed promptly with mitigation strategies."}, "executive_analysis": {"Overview": "The Enhanced Media Library plugin for WordPress is vulnerable to Stored Cross-Site Scripting, allowing attackers to inject arbitrary web scripts and potentially gain elevated privileges.", "Business Impact": "The vulnerability could lead to financial losses, compromised data, or reputational damage if not addressed promptly.", "Technical Impact": "The vulnerability impacts the confidentiality, integrity, and availability of data stored in the WordPress plugin, and could lead to command execution and data theft.", "Mitigation Strategies": "Updating the plugin or disabling the media upload functionality can help mitigate the risk.", "Recommendations": "It is recommended that organizations with the Enhanced Media Library plugin for WordPress update to the latest version or disable the media upload functionality if not needed.", "Conclusions": "The vulnerability is a significant risk that requires immediate attention and mitigation strategies to ensure the security and integrity of data."}}