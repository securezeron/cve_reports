{"id": "CVE-2020-12772", "sourceIdentifier": "cve@mitre.org", "published": "2020-05-12T20:15:11.723", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered in Ignite Realtime Spark 2.8.3 (and the ROAR plugin for it) on Windows. A chat message can include an IMG element with a SRC attribute referencing an external host's IP address. Upon access to this external host, the (NT)LM hashes of the user are sent with the HTTP request. This allows an attacker to collect these hashes, crack them, and potentially compromise the computer. (ROAR can be configured for automatic access. Also, access can occur if the user clicks.)"}, {"lang": "es", "value": "Se detect\u00f3 un problema en Ignite Realtime Spark versi\u00f3n 2.8.3 (y el plugin ROAR para \u00e9l) en Windows. Un mensaje de chat puede incluir un elemento IMG con un atributo SRC que hace referencia a la direcci\u00f3n IP de un host externo. Tras acceder a este host externo, los hashes LM(NT) del usuario se env\u00edan con la petici\u00f3n HTTP. Esto permite a un atacante recolectar estos hashes, descifrarlos y potencialmente comprometer la computadora. (ROAR puede ser configurado para acceso autom\u00e1tico. Adem\u00e1s, el acceso puede ocurrir si el usuario hace clic)."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:igniterealtime:spark:2.8.3:*:*:*:*:*:*:*", "matchCriteriaId": "0DCAAE27-F8BD-4ED0-B508-98948F10952A"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows:-:*:*:*:*:*:*:*", "matchCriteriaId": "A2572D17-1DE6-457B-99CC-64AFD54487EA"}]}]}], "references": [{"url": "https://github.com/theart42/cves/blob/master/cve-2020-12772/CVE-2020-12772.md", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2020-12772 - This technique is related to Phishing and may be used to deliver the exploit. Attackers could use the vulnerability to phish users, gathering their NTLM hashes and using them to gain unauthorized access to sensitive systems."}, {"techniqueID": "T1566", "comment": "CVE-2020-12772 - This technique is related to Phishing and may be used to deliver the exploit. Attackers could use the vulnerability to phish users, gathering their NTLM hashes and using them to gain unauthorized access to sensitive systems."}, {"techniqueID": "T1190", "comment": "CVE-2020-12772 - This technique is related to Cross-Site Scripting (XSS) and may be used to deliver the exploit. Attackers could use the vulnerability to inject malicious scripts into the chat, allowing them to steal sensitive information and cookies."}, {"techniqueID": "T1204", "comment": "CVE-2020-12772 - This technique is related to Command and Control and may be used to deliver the exploit. Attackers could use the vulnerability to exfiltrate stolen NTLM hashes and use them to gain unauthorized access to sensitive systems."}, {"techniqueID": "T1547", "comment": "CVE-2020-12772 - This technique is related to Data Encapsulation and may be used to deliver the exploit. Attackers could use the vulnerability to encapsulate and exfiltrate stolen NTLM hashes and sensitive information."}], "stix_bundle": {"_objects": [{"id": "vuln_12345", "type": "vulnerability", "created_by_ref": "stix_12345", "modified": "2022-01-01T14:30:00.000Z", "name": "CVE-2020-12772", "description": "An issue was discovered in Ignite Realtime Spark 2.8.3 (and the ROAR plugin for it) on Windows. A chat message can include an IMG element with a SRC attribute referencing an external host's IP address. Upon access to this external host, the (NT)LM hashes of the user are sent with the HTTP request.", "category": "CWE-200", "severity": "High", "published": "2020-05-12T20:15:11.723", "last_modified": "2021-07-21T11:39:23.747"}, {"id": "tec_12346", "type": "indicator", "created_by_ref": "stix_12345", "modified": "2022-01-01T14:30:00.000Z", "name": "Possible Phishing Activity", "description": "This indicator is related to T1027, Phishing. The indicator may be used to identify and prevent phishing attacks.", "pattern": "http://example.com/phishing.html", "confidence": 0.8}, {"id": "tec_12347", "type": "indicator", "created_by_ref": "stix_12345", "modified": "2022-01-01T14:30:00.000Z", "name": "Possible XSS Activity", "description": "This indicator is related to T1190, Cross-Site Scripting. The indicator may be used to identify and prevent XSS attacks.", "pattern": "javascript:alert('XSS');", "confidence": 0.8}], "_relationships": [{"from": "vuln_12345", "to": "tec_12346", "type": "exploits"}, {"from": "vuln_12345", "to": "tec_12347", "type": "exploits"}]}, "technical_analysis": {"Introduction": "The vulnerability, CVE-2020-12772, is an issue in Ignite Realtime Spark 2.8.3 on Windows. It allows an attacker to steal NTLM hashes of users and potentially gain unauthorized access to sensitive systems.", "Impact and Scope": "The vulnerability is critical, with a CVSS score of 8.8 (AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H).", "Related MITRE ATT&CK Techniques": "T1027, Phishing, T1566, Phishing, T1190, Cross-Site Scripting, T1204, Command and Control, T1547, Data Encapsulation", "Technical Details": "The vulnerability is caused by a flaw in the Image handling code. The IMG element with a SRC attribute referencing an external host's IP address is not properly sanitized.", "Detection": "The vulnerability can be detected by monitoring for unusual network traffic patterns, such as requests to external hosts for NTLM hashes.", "Mitigation": "The vulnerability can be mitigated by implementing strict image handling controls and monitoring for unusual network traffic patterns.", "Conclusion": "The vulnerability, CVE-2020-12772, is a serious issue that allows attackers to steal NTLM hashes of users and potentially gain unauthorized access to sensitive systems."}, "executive_analysis": {"Overview": "The vulnerability, CVE-2020-12772, is a critical issue that allows attackers to steal NTLM hashes of users and potentially gain unauthorized access to sensitive systems.", "Business Impact": "The vulnerability could have significant business impact, as it could allow attackers to gain unauthorized access to sensitive systems and data.", "Technical Impact": "The vulnerability could allow attackers to steal NTLM hashes of users and potentially gain unauthorized access to sensitive systems.", "Mitigation Strategies": "Implement strict image handling controls and monitor for unusual network traffic patterns.", "Recommendations": "Recommendations for executives include prioritizing the remediation of the vulnerability, implementing strict image handling controls, and monitoring for unusual network traffic patterns.", "Conclusions": "The vulnerability, CVE-2020-12772, is a serious issue that requires immediate attention from executives and IT teams."}}