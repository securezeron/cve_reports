{"id": "CVE-2007-4262", "sourceIdentifier": "cve@mitre.org", "published": "2007-08-08T23:17:00.000", "lastModified": "2018-10-15T21:34:16.073", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Unrestricted file upload vulnerability in EZPhotoSales 1.9.3 and earlier allows remote authenticated administrators to upload and execute arbitrary PHP code under OnlineViewing/galleries/."}, {"lang": "es", "value": "Vulnerabilidad de env\u00edo de archivo no restringido en EZPhotoSales 1.9.3 y anteriores permite a administradores autenticados remotamente enviar y ejecutar c\u00f3digo PHP de su elecci\u00f3n bajo OnlineViewing/galleries/."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 8.5}, "baseSeverity": "HIGH", "exploitabilityScore": 6.8, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ez_photo_sales:ez_photo_sales:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.9.3", "matchCriteriaId": "33F5E844-573E-44B7-9A58-83B4D44CCCDC"}]}]}], "references": [{"url": "http://secunia.com/advisories/26341", "source": "cve@mitre.org"}, {"url": "http://securityreason.com/securityalert/2985", "source": "cve@mitre.org"}, {"url": "http://www.airscanner.com/security/07080601_ezphotosales.htm", "source": "cve@mitre.org"}, {"url": "http://www.informit.com/guides/content.asp?g=security&seqNum=267", "source": "cve@mitre.org"}, {"url": "http://www.informit.com/guides/content.asp?g=security&seqNum=268", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/475678/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/25323", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "Unrestricted file upload vulnerability in EZPhotoSales 1.9.3 and earlier allows remote authenticated administrators to upload and execute arbitrary PHP code under OnlineViewing/galleries/. MITRE technique T1190, Lateral Movement, is relevant as it may be used to exploit this vulnerability."}, {"techniqueID": "T1218", "comment": "Unrestricted file upload vulnerability in EZPhotoSales 1.9.3 and earlier allows remote authenticated administrators to upload and execute arbitrary PHP code under OnlineViewing/galleries/. MITRE technique T1218, Exploit Public-Facing Application, is relevant as it is an example of a publicly accessible application being exploited."}, {"techniqueID": "T1562", "comment": "Unrestricted file upload vulnerability in EZPhotoSales 1.9.3 and earlier allows remote authenticated administrators to upload and execute arbitrary PHP code under OnlineViewing/galleries/. MITRE technique T1562, Phishing, is relevant as it may be used to gain initial access and escalate privileges."}], "stix_bundle": {"id": "CVE-2007-4262", "type": "bundle", "spec_version": "2.1", "idref": "CVE-2007-4262", "created_by_ref": "https://nvd.nl/wrapper_2.0.json", "created": "2018-10-15T21:34:16.073", "modified": "2018-10-15T21:34:16.073", "description": "Unrestricted file upload vulnerability in EZPhotoSales 1.9.3 and earlier allows remote authenticated administrators to upload and execute arbitrary PHP code under OnlineViewing/galleries/", "analysis": {"vulnerability": {"description": "Unrestricted file upload vulnerability in EZPhotoSales 1.9.3 and earlier allows remote authenticated administrators to upload and execute arbitrary PHP code under OnlineViewing/galleries/", "details": {"cvss_scores": {"v2": {"base_score": 8.5, "exploitability_score": 6.8, "impact_score": 10.0}}}}, "related_threats": [{"type": "known-attack-pattern", "idref": "T1190", "name": "Lateral Movement", "description": " Techniques and Actions", "x_mitre_version": 2.1}, {"type": "known-attack-pattern", "idref": "T1218", "name": "Exploit Public-Facing Application", "description": "Techniques and Actions", "x_mitre_version": 2.1}, {"type": "known-attack-pattern", "idref": "T1562", "name": "Phishing", "description": "Techniques and Actions", "x_mitre_version": 2.1}], "mitigation": {"recommended_courses": [{"type": "detection", "course_name": "Network Intrusion Detection System", "description": "Configure network intrusion detection system to detect and prevent unauthorized file upload attempts."}, {"type": "detection", "course_name": "Web Application Firewall", "description": "Configure web application firewall to block suspicious traffic and prevent arbitrary PHP code execution."}]}}}, "technical_analysis": {"Introduction": "EZPhotoSales 1.9.3 and earlier is vulnerable to unrestricted file upload, which allows remote authenticated administrators to upload and execute arbitrary PHP code.", "Impact and Scope": "This vulnerability has a CVSS score of 8.5, with a medium attack vector and single authentication requirement.", "Related MITRE ATT&CK Techniques": "T1190, T1218, and T1562 are relevant techniques to this vulnerability.", "Technical Details": "The vulnerability is caused by an unrestricted file upload in EZPhotoSales 1.9.3 and earlier, allowing remote authenticated administrators to upload and execute arbitrary PHP code.", "Detection": "Detection methods include network intrusion detection systems and web application firewalls.", "Mitigation": "Mitigation strategies include configuring network intrusion detection systems and web application firewalls to detect and prevent unauthorized file upload attempts.", "Conclusion": "This vulnerability can allow remote authenticated administrators to execute arbitrary PHP code on the affected system, and should be addressed promptly."}, "executive_analysis": {"Overview": "The EZPhotoSales 1.9.3 and earlier vulnerability is a significant security risk that allows remote authenticated administrators to execute arbitrary PHP code.", "Business Impact": "This vulnerability has the potential to cause significant business disruption if exploited.", "Technical Impact": "The vulnerability allows for arbitrary PHP code execution, which can lead to complete compromise of the affected system.", "Mitigation Strategies": "Immediate action should be taken to address this vulnerability by configuring network intrusion detection systems and web application firewalls.", "Recommendations": "It is recommended that users upgrade to a patched version of EZPhotoSales or apply a patch.", "Conclusions": "This vulnerability is a high priority and should be addressed promptly to minimize risk."}}