{"id": "CVE-2020-15168", "sourceIdentifier": "security-advisories@github.com", "published": "2020-09-10T19:15:13.490", "lastModified": "2020-09-17T20:21:19.147", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "node-fetch before versions 2.6.1 and 3.0.0-beta.9 did not honor the size option after following a redirect, which means that when a content size was over the limit, a FetchError would never get thrown and the process would end without failure. For most people, this fix will have a little or no impact. However, if you are relying on node-fetch to gate files above a size, the impact could be significant, for example: If you don't double-check the size of the data after fetch() has completed, your JS thread could get tied up doing work on a large file (DoS) and/or cost you money in computing."}, {"lang": "es", "value": "node-fetch  versiones anteriores a 2.6.1 y a 3.0.0-beta.9 no respetaba la opci\u00f3n de tama\u00f1o despu\u00e9s de seguir un redireccionamiento, lo que significa que cuando un tama\u00f1o de contenido superaba el l\u00edmite, una FetchError nunca se iniciaba y el proceso terminaba sin fallos.&#xa0;Para la mayor\u00eda de las personas, esta soluci\u00f3n tendr\u00e1 un impacto m\u00ednimo o nulo.&#xa0;Sin embargo, si conf\u00eda en node-fetch para bloquear archivos por encima de un tama\u00f1o, el impacto podr\u00eda ser significativo, por ejemplo: si no verifica dos veces el tama\u00f1o de los datos despu\u00e9s de que se haya completado la funci\u00f3n fetch(), su hilo o subproceso JS podr\u00eda atarse haciendo que en un archivo grande (DoS) y/o le cueste dinero en inform\u00e1tica"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 2.6, "baseSeverity": "LOW"}, "exploitabilityScore": 1.2, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-770"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}, {"lang": "en", "value": "CWE-770"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:node-fetch_project:node-fetch:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "2.6.1", "matchCriteriaId": "DFF1F6BD-BADD-4347-8E55-F9BC6F0208DC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:node-fetch_project:node-fetch:3.0.0:beta1:*:*:*:node.js:*:*", "matchCriteriaId": "B3E6018B-5323-462E-BF24-371C8C0FD83A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:node-fetch_project:node-fetch:3.0.0:beta5:*:*:*:node.js:*:*", "matchCriteriaId": "C0B46F27-637F-4C06-9637-44BEDC4610B7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:node-fetch_project:node-fetch:3.0.0:beta6:*:*:*:node.js:*:*", "matchCriteriaId": "3B08B9F1-6A45-4769-BC15-45FE6C40F1AD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:node-fetch_project:node-fetch:3.0.0:beta7:*:*:*:node.js:*:*", "matchCriteriaId": "96F4B288-91CC-42F6-B35F-F118DD73D4CB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:node-fetch_project:node-fetch:3.0.0:beta8:*:*:*:node.js:*:*", "matchCriteriaId": "12FF1237-1096-4FEF-AAEB-EF8D78456ED9"}]}]}], "references": [{"url": "https://github.com/node-fetch/node-fetch/security/advisories/GHSA-w7rc-rwvf-8q5r", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://www.npmjs.com/package/node-fetch", "source": "security-advisories@github.com", "tags": ["Product", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "T1190 - Weaknesses in the configuration of the system can be exploited by attackers. This vulnerability is an example of CWE-770, a weakness in the default configuration of Node.js that can lead to unexpected behavior. Defending against this weakness involves ensuring that the system is configured correctly, using tools such as server firewall configurations and access controls to prevent unauthorized access."}, {"techniqueID": "T1040", "comment": "T1040 - Web Services - This vulnerability is related to web services, as it affects a library used for making HTTP requests in Node.js. Defending against this technique involves ensuring that web services are properly configured and monitored, and that the system is updated with the latest security patches."}, {"techniqueID": "T1192", "comment": "T1192 - Exploit Public-Facing Application - This vulnerability is an example of a public-facing application vulnerability, as it affects a widely-used library in Node.js. Defending against this technique involves ensuring that the system is updated with the latest security patches and that public-facing applications are properly configured and monitored."}, {"techniqueID": "T1046", "comment": "T1046 - System Network Configuration Disruption - This vulnerability can be used to disrupt system network configuration, allowing attackers to gain unauthorized access to the system. Defending against this technique involves ensuring that system network configuration is properly managed and monitored."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "https://example.com/cve-2020-15168-stix", "entities": [{"type": "vulnerability", "id": "https://example.com/cve-2020-15168", "name": "CVE-2020-15168", "description": "node-fetch before versions 2.6.1 and 3.0.0-beta.9 did not honor the size option after following a redirect, which means that when a content size was over the limit, a FetchError would never get thrown and the process would end without failure.", "published": "2020-09-10T19:15:13.490", "lastModified": "2020-09-17T20:21:19.147"}, {"type": "course-of-action", "id": "https://example.com/cve-2020-15168-coa", "name": "Update node-fetch to version 2.6.1 or later", "description": "Update the node-fetch library to version 2.6.1 or later to resolve this vulnerability", "threats": ["https://example.com/cve-2020-15168"]}, {"type": "course-of-action", "id": "https://example.com/cve-2020-15168-coa", "name": "Configure node-fetch to respect size option", "description": "Configure the node-fetch library to respect the size option when making HTTP requests", "threats": ["https://example.com/cve-2020-15168"]}, {"type": "note", "id": "https://example.com/cve-2020-15168-note", "name": "node-fetch configuration note", "description": "Node-fetch should be configured to respect the size option when making HTTP requests", "entities": ["https://example.com/cve-2020-15168"]}], "relationships": [{"source": "https://example.com/cve-2020-15168", "target": "https://example.com/cve-2020-15168-coa", "relationship": " Mitigated By"}, {"source": "https://example.com/cve-2020-15168", "target": "https://example.com/cve-2020-15168-coa", "relationship": " Mitigates"}, {"source": "https://example.com/cve-2020-15168", "target": "https://example.com/cve-2020-15168-note", "relationship": "Note"}]}}, "technical_analysis": {"Introduction": "CVE-2020-15168 is a vulnerability in the node-fetch library that affects versions before 2.6.1 and 3.0.0-beta.9. It allows an attacker to make HTTP requests that bypass the size option, leading to denial of service or unauthorized access to the system.", "Impact and Scope": "The impact of this vulnerability is a denial of service or unauthorized access to the system, and the scope is limited to systems using the affected versions of node-fetch.", "Related MITRE ATT&CK Techniques": "T1190, T1040, T1192, T1046", "Technical Details": "The vulnerability is caused by a weakness in the default configuration of node-fetch, which allows an attacker to make HTTP requests that bypass the size option. This can be exploited by an attacker to make large requests that consume system resources, leading to denial of service or unauthorized access to the system.", "Detection": "Detection of this vulnerability involves monitoring system logs for suspicious HTTP requests and monitoring system resources for signs of denial of service.", "Mitigation": "Mitigation of this vulnerability involves updating node-fetch to version 2.6.1 or later, configuring node-fetch to respect the size option, and monitoring system logs and resources for signs of denial of service or unauthorized access.", "Conclusion": "In conclusion, CVE-2020-15168 is a vulnerability in the node-fetch library that affects versions before 2.6.1 and 3.0.0-beta.9. It allows an attacker to make HTTP requests that bypass the size option, leading to denial of service or unauthorized access to the system. The vulnerability can be mitigated by updating node-fetch and configuring it to respect the size option, and monitoring system logs and resources for signs of denial of service or unauthorized access."}, "executive_analysis": {"Overview": "CVE-2020-15168 is a vulnerability in the node-fetch library that affects versions before 2.6.1 and 3.0.0-beta.9.", "Business Impact": "The business impact of this vulnerability is a disruption to system availability and potential unauthorized access to sensitive data.", "Technical Impact": "The technical impact of this vulnerability is a denial of service or unauthorized access to the system.", "Mitigation Strategies": "The recommended mitigation strategy is to update node-fetch to version 2.6.1 or later, configure node-fetch to respect the size option, and monitor system logs and resources for signs of denial of service or unauthorized access.", "Recommendations": "It is recommended that all systems using the affected versions of node-fetch be upgraded to the latest version as soon as possible, and that system administrators take steps to monitor and control system resources and logs to prevent exploitation of this vulnerability.", "Conclusions": "In conclusion, CVE-2020-15168 is a vulnerability in the node-fetch library that affects versions before 2.6.1 and 3.0.0-beta.9. It is recommended that all systems using the affected versions of node-fetch be upgraded to the latest version as soon as possible, and that system administrators take steps to monitor and control system resources and logs to prevent exploitation of this vulnerability."}}