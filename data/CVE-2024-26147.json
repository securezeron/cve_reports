{"id": "CVE-2024-26147", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-21T23:15:08.763", "lastModified": "2024-02-22T19:07:27.197", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Helm is a package manager for Charts for Kubernetes. Versions prior to 3.14.2 contain an uninitialized variable vulnerability when Helm parses index and plugin yaml files missing expected content. When either an `index.yaml` file or a plugins `plugin.yaml` file were missing all metadata a panic would occur in Helm. In the Helm SDK, this is found when using the `LoadIndexFile` or `DownloadIndexFile` functions in the `repo` package or the `LoadDir` function in the `plugin` package. For the Helm client this impacts functions around adding a repository and all Helm functions if a malicious plugin is added as Helm inspects all known plugins on each invocation. This issue has been resolved in Helm v3.14.2. If a malicious plugin has been added which is causing all Helm client commands to panic, the malicious plugin can be manually removed from the filesystem. If using Helm SDK versions prior to 3.14.2, calls to affected functions can use `recover` to catch the panic."}, {"lang": "es", "value": "Helm es un administrador de paquetes para Charts para Kubernetes. Las versiones anteriores a la 3.14.2 contienen una vulnerabilidad variable no inicializada cuando Helm analiza archivos yaml de \u00edndice y complemento que carecen del contenido esperado. Cuando a un archivo `index.yaml` o a un archivo de complementos `plugin.yaml` le faltaban todos los metadatos, se produc\u00eda un p\u00e1nico en Helm. En el SDK de Helm, esto se encuentra cuando se utilizan las funciones `LoadIndexFile` o `DownloadIndexFile` en el paquete `repo` o la funci\u00f3n `LoadDir` en el paquete `plugin`. Para el cliente Helm, esto afecta las funciones relacionadas con la adici\u00f3n de un repositorio y todas las funciones de Helm si se agrega un complemento malicioso, ya que Helm inspecciona todos los complementos conocidos en cada invocaci\u00f3n. Este problema se resolvi\u00f3 en Helm v3.14.2. Si se agreg\u00f3 un complemento malicioso que provoca que todos los comandos del cliente Helm entren en p\u00e1nico, el complemento malicioso se puede eliminar manualmente del sistema de archivos. Si usa versiones de Helm SDK anteriores a la 3.14.2, las llamadas a las funciones afectadas pueden usar \"recover\" para detectar el p\u00e1nico."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-457"}]}], "references": [{"url": "https://github.com/helm/helm/commit/bb4cc9125503a923afb7988f3eb478722a8580af", "source": "security-advisories@github.com"}, {"url": "https://github.com/helm/helm/security/advisories/GHSA-r53h-jv2g-vpx6", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190-001", "comment": "CVE-2024-26147 - An uninitialized variable vulnerability in Helm prior to version 3.14.2, when processing index and plugin yaml files, could lead to a denial-of-service condition. This technique could be used to inject malicious code in the index.yaml files."}, {"techniqueID": "T1027-001", "comment": "CVE-2024-26147 - An uninitialized variable vulnerability in Helm prior to version 3.14.2, when processing index and plugin yaml files, could be exploited by an attacker to inject malicious code in the plugin.yaml files and gain access to the system."}, {"techniqueID": "T1190-005", "comment": "CVE-2024-26147 - An uninitialized variable vulnerability in Helm prior to version 3.14.2, when processing index and plugin yaml files, could be used to cause a panic in Helm when using the LoadIndexFile or DownloadIndexFile functions in the repo package or the LoadDir function in the plugin package."}], "stix_bundle": {"type": "bundle", "id": "bundle--d3dfc6e6-16f1-48b1-ae7a-3ec6c4a40f17", "created_by_ref": "identity--8a87ca9a-c45f-4263-b9e0-14f2c94ef8b9", "created": "2022-01-12T18:45:00.000Z", "modified": "2022-01-12T18:45:00.000Z", "objects": [{"type": "vulnerability", "id": "vulnerability--1b84a5b0-34d4-4324-8497-e4b9f9c39f7c", "created_by_ref": "identity--8a87ca9a-c45f-4263-b9e0-14f2c94ef8b9", "created": "2022-01-12T18:45:00.000Z", "modified": "2022-01-12T18:45:00.000Z", "name": "CVE-2024-26147", "description": "Helm is a package manager for Charts for Kubernetes. Versions prior to 3.14.2 contain an uninitialized variable vulnerability when Helm parses index and plugin yaml files missing expected content.", "severity": "high", "affected_components": [{"type": "software", "id": "software--b85e31da-cf74-4f34-bcf7-7aa9fb2f98c5", "name": "Helm"}], "references": [{"source_name": "Github Advisory", "href": "https://github.com/helm/helm/commit/bb4cc9125503a923afb7988f3eb478722a8580af"}]}, {"type": "unknown-data", "id": "indicator--5f1f6a28-94f6-45a9-a5de-b71e6e6fbd4c", "created_by_ref": "identity--8a87ca9a-c45f-4263-b9e0-14f2c94ef8b9", "created": "2022-01-12T18:45:00.000Z", "modified": "2022-01-12T18:45:00.000Z", "name": "Malicious Index.yaml", "description": "The presence of a malicious index.yaml file with an uninitialized variable vulnerability.", "pattern": "Unknown"}, {"type": "course-of-action", "id": "course-of-action--2b2ba6ce-89c9-4750-8b4f-4a6c35f7bd5c", "created_by_ref": "identity--8a87ca9a-c45f-4263-b9e0-14f2c94ef8b9", "created": "2022-01-12T18:45:00.000Z", "modified": "2022-01-12T18:45:00.000Z", "name": "Mitigate CVE-2024-26147", "description": "Update Helm to version 3.14.2 or later to mitigate the uninitialized variable vulnerability.", "relates_to": {"type": "vulnerability", "value": "vulnerability--1b84a5b0-34d4-4324-8497-e4b9f9c39f7c"}}]}, "technical_analysis": {"Introduction": "CVE-2024-26147 is a vulnerability in Helm, a widely-used package manager for Charts for Kubernetes. It is a denial-of-service vulnerability that allows an attacker to inject malicious code in the index.yaml files and gain access to the system.", "Impact and Scope": "The vulnerability affects Helm versions prior to 3.14.2 and has a CVSS score of 7.5. The attack vector is network, and the attack complexity is low.", "Related MITRE ATT&CK Techniques": "The vulnerability could be exploited using techniques like T1190, T1027, and T1190-005.", "Technical Details": "The vulnerability occurs when Helm parses index and plugin yaml files missing expected content, leading to an uninitialized variable vulnerability.", "Detection": "Detection involves monitoring for suspicious activity, such as the presence of malicious index.yaml files.", "Mitigation": "Mitigation involves updating Helm to version 3.14.2 or later, as well as implementing robust security measures, such as code reviews and testing.", "Conclusion": "In conclusion, CVE-2024-26147 is a critical vulnerability in Helm that requires immediate attention. Detection and mitigation involve a combination of technical and non-technical approaches."}, "executive_analysis": {"Overview": "CVE-2024-26147 is a critical vulnerability in Helm that affects the security and integrity of Kubernetes environments.", "Business Impact": "The vulnerability could lead to data breaches, unauthorized access, and system compromise, resulting in financial losses and reputational damage.", "Technical Impact": "The vulnerability could be exploited to inject malicious code in the index.yaml files and gain access to the system.", "Mitigation Strategies": "Mitigation strategies include updating Helm to version 3.14.2 or later, implementing robust security measures, and monitoring for suspicious activity.", "Recommendations": "Recommendations include prioritizing the patching and updating of Helm, conducting thorough security assessments, and implementing robust incident response plans.", "Conclusions": "In conclusion, CVE-2024-26147 is a critical vulnerability that requires immediate attention. Executives should prioritize the mitigation of this vulnerability to ensure the security and integrity of their Kubernetes environments."}}