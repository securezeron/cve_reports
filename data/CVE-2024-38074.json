{"id": "CVE-2024-38074", "sourceIdentifier": "secure@microsoft.com", "published": "2024-07-09T17:15:41.733", "lastModified": "2024-07-12T16:33:19.547", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Windows Remote Desktop Licensing Service Remote Code Execution Vulnerability"}, {"lang": "es", "value": "Vulnerabilidad de ejecuci\u00f3n remota de c\u00f3digo del servicio Windows Remote Desktop Licensing"}], "metrics": {"cvssMetricV31": [{"source": "secure@microsoft.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "secure@microsoft.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-191"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:r2:sp1:*:*:*:*:x64:*", "matchCriteriaId": "AF07A81D-12E5-4B1D-BFF9-C8D08C32FF4F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:-:*:*:*:*:*:*:*", "matchCriteriaId": "A7DF96F8-BA6A-4780-9CA3-F719B3F81074"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:r2:*:*:*:*:*:*:*", "matchCriteriaId": "DB18C4CE-5917-401E-ACF7-2747084FD36E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2016:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.14393.7159", "matchCriteriaId": "59C9A2A5-AE44-4583-A7B1-B8D62B0E83BB"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2019:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.17763.6054", "matchCriteriaId": "3401E6F7-2430-4247-8A22-0B733A03501A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.20348.2582", "matchCriteriaId": "4E433A09-F730-4EBE-8050-8789755B0D35"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022_23h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.25398.1009", "matchCriteriaId": "EDA01A4A-9AED-484A-8B10-3282FA13F635"}]}]}], "references": [{"url": "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38074", "source": "secure@microsoft.com", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-38074 - This vulnerability can be exploited through the Remote Desktop Protocol to execute arbitrary code, which is a key characteristic of Lateral Movement. Defenders should consider restrictions on Remote Desktop Protocol access, monitoring of network traffic, and implementation of Application Whitelisting."}, {"techniqueID": "T1047", "comment": "CVE-2024-38074 - This vulnerability can be used to further obfuscate commands and evade detection. Defenders should focus on detecting and preventing command and control traffic, using techniques such as YARA rules and sandboxing."}, {"techniqueID": "T1190", "comment": "CVE-2024-38074 - This vulnerability can be used to inject malicious content into Windows Remote Desktop Services, which can be leveraged for further exploitation. Defenders should focus on validating all input and output, monitoring system calls, and implementing Data Execution Prevention."}, {"techniqueID": "T1497", "comment": "CVE-2024-38074 - This vulnerability can be used to further evade detection by masking malicious activity as legitimate activity. Defenders should focus on implementing Network Traffic Analysis, using techniques such as flow-based detection and behavioral analysis."}], "stix_bundle": {"$schema": "https://stix2.io/schema/2.1/stixBundle.json", "type": "stix_bundle", "spec_version": "2.1", "id": "bundle--CVE-2024-38074", "created_by_ref": "https://example.com/created-by", "created": "2022-07-12T14:30:00.000Z", "modified": "2022-07-12T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "vulnerability--CVE-2024-38074", "created_by_ref": "https://example.com/created-by", "created": "2022-07-12T14:30:00.000Z", "modified": "2022-07-12T14:30:00.000Z", "name": "CVE-2024-38074 - Windows Remote Desktop Licensing Service Remote Code Execution Vulnerability", "description": "CVE-2024-38074 is a remote code execution vulnerability in the Windows Remote Desktop Licensing Service.", "severity": "CRITICAL", "cvssv3": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}, "exploit_scoring_system": {"exploitability_score": 3.9, "impact_score": 5.9}, "exploit_scoring_system_refs": [{"id_ref": "https://example.com/exploit-scoring-system"}]}, {"type": "course-of-action", "id": "course-of-action--T1210", "created_by_ref": "https://example.com/created-by", "created": "2022-07-12T14:30:00.000Z", "modified": "2022-07-12T14:30:00.000Z", "name": "Restrict Remote Desktop Protocol Access", "description": "Restrict access to the Remote Desktop Protocol to reduce the attack surface.", "related_tactics": [{"id_ref": "https://example.com/T1210", "relationship_type": "mitigated-by"}], "mitigated_by_refs": [{"id_ref": "https://example.com/tactic-T1210"}]}, {"type": "course-of-action", "id": "course-of-action--T1047", "created_by_ref": "https://example.com/created-by", "created": "2022-07-12T14:30:00.000Z", "modified": "2022-07-12T14:30:00.000Z", "name": "Detect and Prevent Command and Control Traffic", "description": "Detect and prevent Command and Control traffic to prevent lateral movement.", "related_tactics": [{"id_ref": "https://example.com/T1047", "relationship_type": "mitigated-by"}], "mitigated_by_refs": [{"id_ref": "https://example.com/tactic-T1047"}]}, {"type": "course-of-action", "id": "course-of-action--T1190", "created_by_ref": "https://example.com/created-by", "created": "2022-07-12T14:30:00.000Z", "modified": "2022-07-12T14:30:00.000Z", "name": "Inject Malicious Content into Windows Remote Desktop Services", "description": "Inject malicious content into Windows Remote Desktop Services to further exploit the vulnerability.", "related_tactics": [{"id_ref": "https://example.com/T1190", "relationship_type": "mitigated-by"}], "mitigated_by_refs": [{"id_ref": "https://example.com/tactic-T1190"}]}, {"type": "course-of-action", "id": "course-of-action--T1497", "created_by_ref": "https://example.com/created-by", "created": "2022-07-12T14:30:00.000Z", "modified": "2022-07-12T14:30:00.000Z", "name": "Mask Malicious Activity as Legitimate Activity", "description": "Mask malicious activity as legitimate activity to evade detection.", "related_tactics": [{"id_ref": "https://example.com/T1497", "relationship_type": "mitigated-by"}], "mitigated_by_refs": [{"id_ref": "https://example.com/tactic-T1497"}]}]}, "technical_analysis": {"Introduction": "CVE-2024-38074 is a remote code execution vulnerability in the Windows Remote Desktop Licensing Service.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and is exploitable through the Remote Desktop Protocol.", "Related MITRE ATT&CK Techniques": "T1210, T1047, T1190, T1497", "Technical Details": "The vulnerability occurs when the Windows Remote Desktop Licensing Service fails to properly validate user input, allowing an attacker to inject arbitrary code.", "Detection": "Detection can be achieved by monitoring network traffic and system calls.", "Mitigation": "Mitigation strategies include restricting Remote Desktop Protocol access, monitoring network traffic, and implementing Data Execution Prevention.", "Conclusion": "In conclusion, CVE-2024-38074 is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-38074 is a critical remote code execution vulnerability in the Windows Remote Desktop Licensing Service.", "Business Impact": "The vulnerability can be exploited to compromise sensitive data, disrupt business operations, and cause reputational damage.", "Technical Impact": "The vulnerability can be exploited to execute arbitrary code, allowing an attacker to gain control of the System.", "Mitigation Strategies": "Mitigation strategies include restricting Remote Desktop Protocol access, monitoring network traffic, and implementing Data Execution Prevention.", "Recommendations": "We recommend implementing restrictive access controls, monitoring system calls, and performing regular system backups.", "Conclusions": "In conclusion, CVE-2024-38074 is a critical vulnerability that requires immediate attention and mitigation. It is essential to prioritize vulnerability management and reduce the attack surface."}}