{"id": "CVE-2024-6717", "sourceIdentifier": "security@hashicorp.com", "published": "2024-07-23T01:15:09.190", "lastModified": "2024-07-24T12:55:13.223", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "HashiCorp Nomad and Nomad Enterprise 1.6.12 up to 1.7.9, and 1.8.1 archive unpacking during migration is vulnerable to path escaping of the allocation directory. This vulnerability, CVE-2024-6717, is fixed in Nomad 1.6.13, 1.7.10, and 1.8.2."}, {"lang": "es", "value": " HashiCorp Nomad y Nomad Enterprise 1.6.12 hasta 1.7.9 y 1.8.1 al desempaquetar archivos durante la migraci\u00f3n es vulnerable a que la ruta se escape del directorio de asignaci\u00f3n. Esta vulnerabilidad, CVE-2024-6717, se solucion\u00f3 en Nomad 1.6.13, 1.7.10 y 1.8.2."}], "metrics": {"cvssMetricV31": [{"source": "security@hashicorp.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.1, "impactScore": 4.0}]}, "weaknesses": [{"source": "security@hashicorp.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-610"}]}], "references": [{"url": "https://discuss.hashicorp.com/t/hcsec-2024-15-nomad-vulnerable-to-allocation-directory-path-escape-through-archive-unpacking/68781", "source": "security@hashicorp.com"}], "techniques": [{"techniqueID": "TA0040", "comment": " CVE-2024-6717 - This vulnerability demonstrates an attack pattern that exploits an insider with elevated privileges in a targeted manner. It's essential to monitor user actions, audit logs, and implement strict access control to prevent malicious activities."}, {"techniqueID": "TA0011", "comment": " CVE-2024-6717 - This vulnerability suggests that command and control channels may be compromised. It's crucial to monitor network traffic, and implement signature-based detection and prevention methods to identify and block suspicious communication."}, {"techniqueID": "TA0012", "comment": " CVE-2024-6717 - This vulnerability indicates a potential file-system compromise. Implementing file integrity monitoring and implementing least privilege access can help prevent and detect malicious activities."}], "stix_bundle": {"objects": [{"id": "vuln-1", "type": "vulnerability", "name": "CVE-2024-6717", "description": "HashiCorp Nomad and Nomad Enterprise 1.6.12 up to 1.7.9, and 1.8.1 archive unpacking during migration is vulnerable to path escaping of the allocation directory.", "published": "2024-07-23T01:15:09.190", "lastModified": "2024-07-24T12:55:13.223", "cveTags": []}, {"id": "technique-1", "type": "attack-pattern", "name": "TA0040: Insider Movement", "description": "An adversary with elevated privileges moves laterally within a targeted environment.", "kill_chain_phases": [{"id": "kill-chain-1", "type": "kill-chain-phase", "name": "TA0040: Insider Movement"}]}, {"id": "technique-2", "type": "attack-pattern", "name": "TA0011: Command and Control", "description": "An adversary establishes command and control channels to remotely access compromised systems.", "kill_chain_phases": [{"id": "kill-chain-2", "type": "kill-chain-phase", "name": "TA0011: Command and Control"}]}, {"id": "technique-3", "type": "attack-pattern", "name": "TA0012: File System Compromise", "description": "An adversary compromises file systems to implant malicious code or steal sensitive data.", "kill_chain_phases": [{"id": "kill-chain-3", "type": "kill-chain-phase", "name": "TA0012: File System Compromise"}]}, {"id": "course-of-action-1", "type": "course-of-action", "name": "Monitor User Actions", "description": "Monitor user actions to detect suspicious behavior and identify potential insider threats.", "related_techniques": ["technique-1"], "notes": ["Implement strict access control and monitor audit logs."]}, {"id": "course-of-action-2", "type": "course-of-action", "name": "Implement Signature-Based Detection", "description": "Implement signature-based detection methods to identify and block suspicious network traffic.", "related_techniques": ["technique-2"], "notes": ["Configure firewalls and intrusion detection systems accordingly."]}, {"id": "course-of-action-3", "type": "course-of-action", "name": "Implement File Integrity Monitoring", "description": "Implement file integrity monitoring to detect any changes to files and directories.", "related_techniques": ["technique-3"], "notes": ["Configure file integrity monitoring software and schedule regular scans."]}], "relationships": [{"source_id": "vuln-1", "target_id": "technique-1", "relationship": "related_to"}, {"source_id": "vuln-1", "target_id": "technique-2", "relationship": "related_to"}, {"source_id": "vuln-1", "target_id": "technique-3", "relationship": "related_to"}, {"source_id": "technique-1", "target_id": "course-of-action-1", "relationship": "mitigates"}, {"source_id": "technique-2", "target_id": "course-of-action-2", "relationship": "mitigates"}, {"source_id": "technique-3", "target_id": "course-of-action-3", "relationship": "mitigates"}]}, "technical_analysis": {"Introduction": "CVE-2024-6717 is a vulnerability in HashiCorp Nomad that allows an attacker to escape the directory allocation and gain elevated privileges.", "Impact and Scope": "The vulnerability has a CVSS score of 7.7 and an attack vector of network. The impact is high, and the scope is changed.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are TA0040: Insider Movement, TA0011: Command and Control, and TA0012: File System Compromise.", "Technical Details": "The vulnerability occurs when the Nomad cluster node allocates a directory for the migration and unpacking process, and an attacker can manipulate this allocation directory to escape to other parts of the system.", "Detection": "To detect this vulnerability, monitor user actions, audit logs, and implement strict access control.", "Mitigation": "To mitigate this vulnerability, implement command and control channels, monitor file systems, and implement signature-based detection.", "Conclusion": "In conclusion, CVE-2024-6717 is a significant vulnerability that requires immediate attention and action."}, "executive_analysis": {"Overview": "CVE-2024-6717 is a critical vulnerability in HashiCorp Nomad that can compromise the security and integrity of the system.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to data breaches, system compromise, and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is high, as it can allow an attacker to gain elevated privileges and move laterally within the system.", "Mitigation Strategies": "To mitigate this vulnerability, implement strict access control, monitor user actions, and implement signature-based detection.", "Recommendations": "Recommendations for executives include reviewing and updating security policies, conducting regular security audits, and implementing training programs for employees.", "Conclusions": "In conclusion, executives must take immediate action to mitigate this vulnerability and protect the organization's security and integrity."}}