{"id": "CVE-2024-38531", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-28T14:15:03.293", "lastModified": "2024-07-01T12:37:24.220", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Nix is a package manager for Linux and other Unix systems that makes package management reliable and reproducible. A build process has access to and can change the permissions of the build directory. After creating a setuid binary in a globally accessible location, a malicious local user can assume the permissions of a Nix daemon worker and hijack all future builds. This issue was patched in version(s) 2.23.1, 2.22.2, 2.21.3, 2.20.7, 2.19.5 and 2.18.4."}, {"lang": "es", "value": "Nix es un administrador de paquetes para Linux y otros sistemas Unix que hace que la administraci\u00f3n de paquetes sea confiable y reproducible. Un proceso de compilaci\u00f3n tiene acceso y puede cambiar los permisos del directorio de compilaci\u00f3n. Despu\u00e9s de crear un binario setuid en una ubicaci\u00f3n accesible globalmente, un usuario local malicioso puede asumir los permisos de un daemon trabajador de Nix y secuestrar todas las compilaciones futuras. Este problema se solucion\u00f3 en las versiones 2.23.1, 2.22.2, 2.21.3, 2.20.7, 2.19.5 y 2.18.4."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 3.6, "baseSeverity": "LOW"}, "exploitabilityScore": 1.0, "impactScore": 2.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-278"}]}], "references": [{"url": "https://github.com/NixOS/nix/pull/10501", "source": "security-advisories@github.com"}, {"url": "https://github.com/NixOS/nix/security/advisories/GHSA-q82p-44mg-mgh5", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1055", "comment": "CVSSv3.1: AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:L - A malicious local user can assume the permissions of a Nix daemon worker and hijack all future builds. This technique is used to spread and execute malware on the affected system."}, {"techniqueID": "T1190", "comment": "A setuid binary created in a globally accessible location allows a malicious local user to assume elevated privileges and execute arbitrary commands. This technique is used to execute malicious payloads and maintain persistence."}, {"techniqueID": "T1036", "comment": "A build process with write access to the build directory can be used to create a setuid binary and escalate privileges. This technique is used to create a backdoor or escalate privileges."}, {"techniqueID": "T1406", "comment": "A setuid binary created in a globally accessible location allows a malicious local user to execute arbitrary commands and maintain persistence. This technique is used to maintain persistence and execute malicious payloads."}], "stix_bundle": {"stixBundle": {"objects": [{"id": "vulnerability@cve-2024-38531", "type": "vulnerability", "name": "Nix: Privilege Escalation", "description": "A build process has access to and can change the permissions of the build directory, allowing a malicious local user to assume the permissions of a Nix daemon worker and hijack all future builds.", "objects": [{"id": "mitigation@cve-2024-38531-1", "type": "course-of-action", "name": "Update Nix to version 2.23.1 or later", "description": "Update Nix to the latest version to address the vulnerability.", "relationship": {"vulnerability": ["vulnerability@cve-2024-38531"], "related_course_of_action": ["mitigation@cve-2024-38531-1"]}}], "relationships": [{"id": "mitigation-vulnerability@cve-2024-38531-1", "type": "mitigates", "object": "mitigation@cve-2024-38531-1"}]}]}}, "technical_analysis": {"Introduction": "The CVE-2024-38531 vulnerability allows a malicious local user to escalate privileges and hijack all future builds on systems using the Nix package manager.", "Impact and Scope": "The CVE has a CVSSv3.1 score of 3.6, with an attack vector of LOCAL, and an attack complexity of HIGH. It affects systems using Nix versions prior to 2.23.1.", "Related MITRE ATT&CK Techniques": "T1055, T1190, T1036, T1406", "Technical Details": "The vulnerability occurs due to a build process having access to and being able to change the permissions of the build directory, allowing a malicious local user to assume the permissions of a Nix daemon worker and hijack all future builds.", "Detection": "Detection methods include monitoring for abnormal system behavior and identifying software packages and dependencies.", "Mitigation": "Update Nix to the latest version, use secure coding practices, and monitor system behavior.", "Conclusion": "The CVE-2024-38531 vulnerability is a significant threat that can be mitigated by updating Nix to the latest version and implementing secure coding practices."}, "executive_analysis": {"Overview": "The CVE-2024-38531 vulnerability is a critical issue that can allow a malicious local user to escalate privileges and hijack all future builds on systems using the Nix package manager.", "Business Impact": "The vulnerability can result in data breaches, system compromise, and revenue loss for affected organizations.", "Technical Impact": "The vulnerability can allow an attacker to execute malicious payloads and maintain persistence on affected systems.", "Mitigation Strategies": "Implement secure coding practices, update Nix to the latest version, and monitor system behavior.", "Recommendations": "Executives should prioritize addressing the vulnerability and ensuring that their systems are updated to the latest Nix version.", "Conclusions": "The CVE-2024-38531 vulnerability is a significant threat that requires immediate attention and action to mitigate its impact."}}