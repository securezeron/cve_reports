{"id": "CVE-2024-27403", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-17T12:15:10.030", "lastModified": "2024-05-17T18:35:35.070", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nft_flow_offload: reset dst in route object after setting up flow\n\ndst is transferred to the flow object, route object does not own it\nanymore.  Reset dst in route object, otherwise if flow_offload_add()\nfails, error path releases dst twice, leading to a refcount underflow."}, {"lang": "es", "value": " En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: netfilter: nft_flow_offload: restablece dst en el objeto de ruta despu\u00e9s de configurar el flujo dst se transfiere al objeto de flujo, el objeto de ruta ya no es propietario. Restablezca el dst en el objeto de ruta; de lo contrario, si flow_offload_add() fallo, la ruta de error libera el dst dos veces, lo que provoca un desbordamiento insuficiente del recuento."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/012df10717da02367aaf92c65f9c89db206c15f4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/4c167af9f6b5ae4a5dbc243d5983c295ccc2e43c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/558b00a30e05753a62ecc7e05e939ca8f0241148", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/670548c8db44d76e40e1dfc06812bca36a61e9ae", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9e0f0430389be7696396c62f037be4bf72cf93e3", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-27403 - This technique can be used to exploit the Linux kernel vulnerability by injecting malicious code to reset dst in route object after setting up flow. Defense against this technique involves validating and sanitizing user input and enforcing proper memory management."}, {"techniqueID": "T1047", "comment": "CVE-2024-27403 - This technique can be used to exploit the Linux kernel vulnerability by injecting malicious code to transfer dst to the flow object, route object does not own it anymore. Defense against this technique involves validating and sanitizing user input and enforcing proper memory management."}, {"techniqueID": "T1199", "comment": "CVE-2024-27403 - This technique can be used to exploit the Linux kernel vulnerability by injecting malicious code to set dst in route object after setting up flow. Defense against this technique involves validating and sanitizing user input and enforcing proper memory management."}], "stix_bundle": {"@typescript": "2.1", "objects": [{"type": "vulnerability", "id": "vuln-1", "created": "2024-05-17T12:15:10.030", "modified": "2024-05-17T18:35:35.070", "name": "CVE-2024-27403", "description": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nft_flow_offload: reset dst in route object after setting up flow\n\ndst is transferred to the flow object, route object does not own it\nanymore.  Reset dst in route object, otherwise if flow_offload_add()\nfails, error path releases dst twice, leading to a refcount underflow."}]}, {"type": "course-of-action", "id": "coa-1", "created": "2024-05-17T12:15:10.030", "modified": "2024-05-17T18:35:35.070", "name": "Apply patches", "description": [{"lang": "en", "value": "Apply the related kernel patches to mitigate the vulnerability."}]}, {"type": "course-of-action", "id": "coa-2", "created": "2024-05-17T12:15:10.030", "modified": "2024-05-17T18:35:35.070", "name": "Disable affected services", "description": [{"lang": "en", "value": "Disable the affected services to prevent exploitation of the vulnerability."}]}, {"type": "intrusion-set", "id": "is-1", "created": "2024-05-17T12:15:10.030", "modified": "2024-05-17T18:35:35.070", "name": "Unidentified Actor", "description": [{"lang": "en", "value": "An unidentified actor is suspected to be behind this threat."}]}, {"type": "indicator", "id": "indi-1", "created": "2024-05-17T12:15:10.030", "modified": "2024-05-17T18:35:35.070", "name": " Malicious IP addresses ", "description": [{"lang": "en", "value": " Malicious IP addresses related to the vulnerability."}]}, {"type": " observable", "id": "obs-1", "created": "2024-05-17T12:15:10.030", "modified": "2024-05-17T18:35:35.070", "name": " Kernel crash", "description": [{"lang": "en", "value": "A kernel crash can be used to detect exploitation of the vulnerability."}]}, {"type": "behavior", "id": "beh-1", "created": "2024-05-17T12:15:10.030", "modified": "2024-05-17T18:35:35.070", "name": " Unexpected network traffic", "description": [{"lang": "en", "value": "Unexpected network traffic can be used to detect exploitation of the vulnerability."}]}, {"type": "note", "id": "note-1", "created": "2024-05-17T12:15:10.030", "modified": "2024-05-17T18:35:35.070", "name": " Sanitization of input", "description": [{"lang": "en", "value": "Sanitizing user input can help prevent exploitation of the vulnerability."}]}, {"type": "note", "id": "note-2", "created": "2024-05-17T12:15:10.030", "modified": "2024-05-17T18:35:35.070", "name": " Validating memory", "description": [{"lang": "en", "value": "Validating memory can help prevent exploitation of the vulnerability."}]}], "relationships": [{"id": "r-1", "type": "related_to", "source_ref": "vuln-1", "target_ref": "coa-1"}, {"id": "r-2", "type": "related_to", "source_ref": "vuln-1", "target_ref": "coa-2"}, {"id": "r-3", "type": "related_to", "source_ref": "vuln-1", "target_ref": "is-1"}, {"id": "r-4", "type": "related_to", "source_ref": "vuln-1", "target_ref": "indi-1"}, {"id": "r-5", "type": "related_to", "source_ref": "vuln-1", "target_ref": "obs-1"}, {"id": "r-6", "type": "related_to", "source_ref": "vuln-1", "target_ref": "beh-1"}, {"id": "r-7", "type": "related_to", "source_ref": "vuln-1", "target_ref": "note-1"}, {"id": "r-8", "type": "related_to", "source_ref": "vuln-1", "target_ref": "note-2"}]}, "technical_analysis": {"Introduction": "The CVE-2024-27403 vulnerability is a Linux kernel vulnerability that has been resolved. The vulnerability is related to the netfilter: nft_flow_offload function in the Linux kernel.", "Impact and Scope": "The vulnerability has a moderate impact and a low scope. It can be exploited by injecting malicious code to reset dst in route object after setting up flow.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1047, and T1199.", "Technical Details": "The vulnerability is caused by an error in the netfilter: nft_flow_offload function. The error leads to a refcount underflow when the flow_offload_add function fails.", "Detection": "The vulnerability can be detected by monitoring for kernel crashes and unexpected network traffic.", "Mitigation": "The vulnerability can be mitigated by applying patches and disabling affected services.", "Conclusion": "In conclusion, the CVE-2024-27403 vulnerability is a Linux kernel vulnerability that has been resolved. It has a moderate impact and a low scope. It can be exploited by injecting malicious code to reset dst in route object after setting up flow."}, "executive_analysis": {"Overview": "The CVE-2024-27403 vulnerability is a critical security issue affecting Linux kernel.", "Business Impact": "The vulnerability has a moderate impact on the business, as it allows an attacker to inject malicious code and gain access to the system.", "Technical Impact": "The vulnerability has a low technical impact, as it is a Linux kernel vulnerability, and it can be mitigated by applying patches and disabling affected services.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are to apply patches and disable affected services.", "Recommendations": "We recommend applying patches and disabling affected services to mitigate the vulnerability.", "Conclusions": "In conclusion, the CVE-2024-27403 vulnerability is a critical security issue affecting Linux kernel. It has a moderate impact on the business and a low technical impact. It can be mitigated by applying patches and disabling affected services."}}