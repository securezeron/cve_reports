{"id": "CVE-2020-28942", "sourceIdentifier": "cve@mitre.org", "published": "2020-11-19T17:15:13.310", "lastModified": "2020-12-03T18:54:00.837", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue exists in PrimeKey EJBCA before 7.4.3 when enrolling with EST while proxied through an RA over the Peers protocol. As a part of EJBCA's domain security model, the peer connector allows the restriction of client certificates (for the RA, not the end user) to a limited set of allowed CAs, thus restricting the accessibility of that RA to the rights it has within a specific role. While this works for other protocols such as CMP, it was found that the EJBCA enrollment over an EST implementation bypasses this check, allowing enrollment with a valid client certificate through any functioning and authenticated RA connected to the CA. NOTE: an attacker must already have a trusted client certificate and authorization to enroll against the targeted CA."}, {"lang": "es", "value": "Se presenta un problema en PrimeKey EJBCA versiones anteriores a 7.4.3 cuando se inscribe con EST mientras se realiza un proxy por medio de un RA sobre el protocolo Peers.&#xa0;Como parte del modelo de seguridad de dominio de EJBCA, el conector de peers permite la restricci\u00f3n de certificados de cliente (para el RA, no para el usuario final) a un ajuste limitado de CAs permitidas, restringiendo as\u00ed la accesibilidad de ese RA a los derechos que presenta dentro de un papel espec\u00edfico.&#xa0;Si bien esto funciona para otros protocolos como CMP, se encontr\u00f3 que la inscripci\u00f3n EJBCA sobre una implementaci\u00f3n de EST al omitir esta comprobaci\u00f3n, permite la inscripci\u00f3n con un certificado de cliente v\u00e1lido por medio de cualquier RA autenticado y en funcionamiento conectado a la CA.&#xa0;NOTA: un atacante ya debe tener un certificado de cliente confiable y autorizaci\u00f3n para inscribirse en la CA apuntado"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-295"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:primekey:ejbca:*:*:*:*:enterprise:*:*:*", "versionEndExcluding": "7.4.3", "matchCriteriaId": "1AD6F9F4-0E93-4978-9585-1748B9F3B2F5"}]}]}], "references": [{"url": "https://support.primekey.com/news/posts/40", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1572.001", "comment": "CVE-2020-28942 - An attacker could exploit this vulnerability by using a valid client certificate and authorisation to enroll against the targeted CA, illustrating the importance of proper certificate validation and authorisation checks in the enrollment process."}, {"techniqueID": "T1078", "comment": "CVE-2020-28942 - The vulnerability allows for unauthorized enrollment with a valid client certificate, demonstrating the importance of implementing adequate access controls and restrictions on the enrollment process."}, {"techniqueID": "T1555.005", "comment": "CVE-2020-28942 - The bypassing of certificate checks allows an attacker to enroll with any functioning and authenticated RA connected to the CA, illustrating the potential for an attacker to use valid but compromised certificates."}], "stix_bundle": {"@documentation": "https://stix2.io/documentation/2.1/", "bundle": {"type": "bundle", "id": "bundle--b7a4d0c4-5c4a-4ce1-a1dd-fcfe0e5e6d79", "created_by_ref": "identity--44b5c5d1-67f5-4964-8f3f-a5b17b987c0c", "created": "2023-03-21T11:34:49.000Z", "modified": "2023-03-21T11:34:49.000Z", "objects": [{"type": "vulnerability", "id": "vulnerability--1e5f6cc4-2d4c-4d63-b9f8-8a1a45a5f6fa", "name": "CVE-2020-28942", "description": "An issue exists in PrimeKey EJBCA before 7.4.3 when enrolling with EST while proxied through an RA over the Peers protocol.", "baseSeverity": "MEDIUM", "exploitabilityScore": 2.8, "impactScore": 1.4, "cvssMetricV31": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N"}}, {"type": "course-of-action", "id": "course-of-action--9ea9a0c2-45c0-42a8-9436-7f1d2f07bea5", "name": "Apply patches", "description": "Apply patches to PrimeKey EJBCA to version 7.4.3 or later.", "related_activity": {"type": "activity", "id": "activity--3cca48c9-e0c4-4375-b1d7-6f2fcf9dea18"}}, {"type": "course-of-action", "id": "course-of-action--92d9a454-23dd-40b0-8c43-84a02b93a4d4", "name": "Implement access controls", "description": "Implement adequate access controls and restrictions on the enrollment process to prevent unauthorized enrollment.", "related_activity": {"type": "activity", "id": "activity--e39e4c2d-2f4a-4068-96f5-7dd3a2d0c22a"}}, {"type": "indicator", "id": "indicator--5abb0f45-1e11-4561-8a1f-ccf5e59fba7d", "name": "PrimeKey EJBCA vulnerability", "description": "Indicates a attempted exploitation of the PrimeKey EJBCA vulnerability."}], "relationships": [{"id": "r1", "type": "has", "to_id": "vulnerability--1e5f6cc4-2d4c-4d63-b9f8-8a1a45a5f6fa", "from_id": "bundle--b7a4d0c4-5c4a-4ce1-a1dd-fcfe0e5e6d79"}, {"id": "r2", "type": "has", "to_id": "course-of-action--9ea9a0c2-45c0-42a8-9436-7f1d2f07bea5", "from_id": "bundle--b7a4d0c4-5c4a-4ce1-a1dd-fcfe0e5e6d79"}, {"id": "r3", "type": "has", "to_id": "course-of-action--92d9a454-23dd-40b0-8c43-84a02b93a4d4", "from_id": "bundle--b7a4d0c4-5c4a-4ce1-a1dd-fcfe0e5e6d79"}, {"id": "r4", "type": "has", "to_id": "indicator--5abb0f45-1e11-4561-8a1f-ccf5e59fba7d", "from_id": "bundle--b7a4d0c4-5c4a-4ce1-a1dd-fcfe0e5e6d79"}]}}, "technical_analysis": {"Introduction": "The CVE-2020-28942 vulnerability in PrimeKey EJBCA is a significant risk that allows an attacker to enroll with any functioning and authenticated RA connected to the CA, even if the attacker does not have a valid client certificate.", "Impact and Scope": "The vulnerability affects PrimeKey EJBCA versions 7.4.2 and below, and has a CVSS score of 4.3 (Medium).", "Related MITRE ATT&CK Techniques": "T1572.001, T1078, T1555.005", "Technical Details": "The vulnerability arises from the bypassing of certificate checks in the enrollment process, allowing an attacker to enroll with any functioning and authenticated RA connected to the CA.", "Detection": "Detection of the vulnerability involves checking the version of PrimeKey EJBCA and implementing access controls to prevent unauthorized enrollment.", "Mitigation": "The vulnerability can be mitigated by applying patches to PrimeKey EJBCA to version 7.4.3 or later, and implementing adequate access controls and restrictions on the enrollment process.", "Conclusion": "The CVE-2020-28942 vulnerability in PrimeKey EJBCA is a significant risk that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The CVE-2020-28942 vulnerability in PrimeKey EJBCA is a potential risk that could compromise the security of your organization's certificate authority.", "Business Impact": "The vulnerability could lead to unauthorized enrollment and compromise of your organization's certificate authority, resulting in loss of trust and damage to your organization's reputation.", "Technical Impact": "The vulnerability could result in unauthorized enrollment and could potentially be used to issue fraudulent certificates.", "Mitigation Strategies": "Apply patches to PrimeKey EJBCA to version 7.4.3 or later, and implement adequate access controls and restrictions on the enrollment process.", "Recommendations": "Recommendations for executives include applying patches to PrimeKey EJBCA to version 7.4.3 or later, and requiring adequate access controls and restrictions on the enrollment process.", "Conclusions": "Conclusions and next steps include implementing recommendations, monitoring for signs of exploitation, and conducting regular security assessments."}}