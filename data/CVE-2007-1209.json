{"id": "CVE-2007-1209", "sourceIdentifier": "secure@microsoft.com", "published": "2007-04-10T21:19:00.000", "lastModified": "2018-10-16T16:37:07.423", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Use-after-free vulnerability in the Client/Server Run-time Subsystem (CSRSS) in Microsoft Windows Vista does not properly handle connection resources when starting and stopping processes, which allows local users to gain privileges by opening and closing multiple ApiPort connections, which leaves a \"dangling pointer\" to a process data structure."}, {"lang": "es", "value": "Una vulnerabilidad de uso de la memoria previamente liberada en el subsistema Run-time cliente/servidor (CSRSS) en Microsoft Windows Vista, no maneja apropiadamente los recursos de conexi\u00f3n al iniciar y detener procesos, lo que permite a los usuarios locales alcanzar privilegios al abrir y cerrar m\u00faltiples conexiones de ApiPort, que deja un \"dangling pointer\" a una estructura de datos de proceso."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-399"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_vista:*:*:*:*:*:*:*:*", "matchCriteriaId": "3852BB02-47A1-40B3-8E32-8D8891A53114"}]}]}], "references": [{"url": "http://research.eeye.com/html/advisories/published/AD20070410b.html", "source": "secure@microsoft.com"}, {"url": "http://secunia.com/advisories/24823", "source": "secure@microsoft.com"}, {"url": "http://securityreason.com/securityalert/2531", "source": "secure@microsoft.com"}, {"url": "http://www.kb.cert.org/vuls/id/219848", "source": "secure@microsoft.com", "tags": ["US Government Resource"]}, {"url": "http://www.osvdb.org/34008", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/archive/1/465233/100/0/threaded", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/archive/1/466331/100/200/threaded", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/bid/23338", "source": "secure@microsoft.com"}, {"url": "http://www.securitytracker.com/id?1017897", "source": "secure@microsoft.com"}, {"url": "http://www.us-cert.gov/cas/techalerts/TA07-100A.html", "source": "secure@microsoft.com", "tags": ["US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2007/1325", "source": "secure@microsoft.com", "tags": ["Vendor Advisory"]}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2007/ms07-021", "source": "secure@microsoft.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A1524", "source": "secure@microsoft.com"}], "techniques": [{"techniqueID": "T1036", "comment": "T1036 - Windows API Calls Used to Bypass Windows Credentials Dialog Box - This technique is relevant as it can be used to escalate privileges on a Windows system, and since the CVE-2007-1209 vulnerability is a use-after-free vulnerability that allows local users to gain privileges, it can be exploited in combination with this technique. "}, {"techniqueID": "T1090", "comment": "T1090 - Proxy: Reverse Web Shell - This technique is relevant as it can be used to establish a reverse shell on the system, and since the CVE-2007-1209 vulnerability is a use-after-free vulnerability that allows local users to gain privileges, it can be exploited to establish a privileged reverse shell. "}, {"techniqueID": "T1035", "comment": "T1035 - Network Share Discovery - This technique is relevant as it can be used to discover network shares on the system, and since the CVE-2007-1209 vulnerability is a use-after-free vulnerability that allows local users to gain privileges, it can be exploited to establish a privileged connection to the network. "}, {"techniqueID": "T1083", "comment": "T1083 - File and Directory Discovery - This technique is relevant as it can be used to discover files and directories on the system, and since the CVE-2007-1209 vulnerability is a use-after-free vulnerability that allows local users to gain privileges, it can be exploited to establish a privileged connection to the file system. "}], "stix_bundle": {"assessment": {"id": "ASSENT-123456789", "name": "CVE-2007-1209 Assessment", "description": "Assessment of the CVE-2007-1209 vulnerability"}, "objects": [{"id": "id123456789", "type": "vulnerability", "name": "CVE-2007-1209", "description": "Use-after-free vulnerability in the Client/Server Run-time Subsystem (CSRSS) in Microsoft Windows Vista does not properly handle connection resources when starting and stopping processes, which allows local users to gain privileges by opening and closing multiple ApiPort connections, which leaves a \"dangling pointer\" to a process data structure."}, {"id": "id234567890", "type": "intrusion-set", "name": "APT1", "description": "APT1 is a known Chinese state-sponsored threat actor"}, {"id": "id345678901", "type": "course-of-action", "name": "Install Windows Update", "description": "Installing the Windows update that fixes the CVE-2007-1209 vulnerability"}, {"id": "id456789012", "type": "course-of-action", "name": "Disable CSRSS", "description": "Disabling the CSRSS service to prevent exploitation"}, {"id": "id567890123", "type": "indicator", "name": "Process Creation", "description": "Indicates malware is creating new processes"}, {"id": "id678901234", "type": "indicator", "name": "ApiPort Connections", "description": "Indicates the system is connecting to ApiPort"}, {"id": "id789012345", "type": "recommendation", "name": "Implement Windows Defender", "description": "Implementing Windows Defender to detect and mitigate exploitation attempts"}], "relationships": [{"id": "id123456789", "source_ref": "id123456789", "target_ref": "id234567890", "typed_relationship": "Has Mitigation"}, {"id": "id234567890", "source_ref": "id123456789", "target_ref": "id345678901", "typed_relationship": "Requires Mitigation Action"}, {"id": "id345678901", "source_ref": "id123456789", "target_ref": "id456789012", "typed_relationship": "Conflicts With"}, {"id": "id456789012", "source_ref": "id123456789", "target_ref": "id567890123", "typed_relationship": "Used To Detect"}, {"id": "id567890123", "source_ref": "id123456789", "target_ref": "id678901234", "typed_relationship": "Used To Detect"}, {"id": "id678901234", "source_ref": "id123456789", "target_ref": "id789012345", "typed_relationship": "Used To Mitigate"}]}, "technical_analysis": {"Introduction": "CVE-2007-1209 is a use-after-free vulnerability in the Client/Server Run-time Subsystem (CSRSS) in Microsoft Windows Vista that allows local users to gain privileges by opening and closing multiple ApiPort connections, which leaves a \"dangling pointer\" to a process data structure.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2 and affects all supported versions of Windows Vista.", "Related MITRE ATT&CK Techniques": "T1036, T1090, T1035, T1083", "Technical Details": "The vulnerability is a use-after-free vulnerability that allows local users to gain privileges by opening and closing multiple ApiPort connections, which leaves a \"dangling pointer\" to a process data structure.", "Detection": "Detection is possible through process creation and ApiPort connection logs.", "Mitigation": "Mitigation strategies include installing the Windows update that fixes the vulnerability, disabling the CSRSS service, and implementing Windows Defender.", "Conclusion": "In conclusion, CVE-2007-1209 is a critical vulnerability that requires immediate attention and mitigation to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2007-1209 is a critical vulnerability in Windows Vista that allows local users to gain privileges.", "Business Impact": "Exploitation of the vulnerability can result in unauthorized access to sensitive data and systems.", "Technical Impact": "The vulnerability allows local users to gain privileges, which can be used to escalate privileges and gain access to sensitive data and systems.", "Mitigation Strategies": "install the Windows update that fixes the vulnerability, disable the CSRSS service, and implement Windows Defender.", "Recommendations": "Implement a robust vulnerability management program, conduct regular security assessments, and educate employees on safe computing practices.", "Conclusions": "In conclusion, CVE-2007-1209 is a critical vulnerability that requires immediate attention and mitigation to prevent exploitation."}}