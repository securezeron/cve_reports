{"id": "CVE-2024-26764", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-03T17:15:52.580", "lastModified": "2024-06-27T12:15:20.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nfs/aio: Restrict kiocb_set_cancel_fn() to I/O submitted via libaio\n\nIf kiocb_set_cancel_fn() is called for I/O submitted via io_uring, the\nfollowing kernel warning appears:\n\nWARNING: CPU: 3 PID: 368 at fs/aio.c:598 kiocb_set_cancel_fn+0x9c/0xa8\nCall trace:\n kiocb_set_cancel_fn+0x9c/0xa8\n ffs_epfile_read_iter+0x144/0x1d0\n io_read+0x19c/0x498\n io_issue_sqe+0x118/0x27c\n io_submit_sqes+0x25c/0x5fc\n __arm64_sys_io_uring_enter+0x104/0xab0\n invoke_syscall+0x58/0x11c\n el0_svc_common+0xb4/0xf4\n do_el0_svc+0x2c/0xb0\n el0_svc+0x2c/0xa4\n el0t_64_sync_handler+0x68/0xb4\n el0t_64_sync+0x1a4/0x1a8\n\nFix this by setting the IOCB_AIO_RW flag for read and write I/O that is\nsubmitted by libaio."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: fs/aio: restringe kiocb_set_cancel_fn() a E/S enviadas a trav\u00e9s de libaio. Si se llama a kiocb_set_cancel_fn() para E/S enviadas a trav\u00e9s de io_uring, aparece la siguiente advertencia del kernel: ADVERTENCIA: CPU : 3 PID: 368 en fs/aio.c:598 kiocb_set_cancel_fn+0x9c/0xa8 Rastreo de llamadas: kiocb_set_cancel_fn+0x9c/0xa8 ffs_epfile_read_iter+0x144/0x1d0 io_read+0x19c/0x498 io_issue_sqe+0x118/0x27c io_submit_sqes+0x25c/0x5fc __arm64_sys_io_uring_enter+0x104/ 0xab0 invoke_syscall+0x58/0x11c el0_svc_common+0xb4/0xf4 do_el0_svc+0x2c/0xb0 el0_svc+0x2c/0xa4 el0t_64_sync_handler+0x68/0xb4 el0t_64_sync+0x1a4/0x1a8 Solucionar esto configurando el IOC Bandera B_AIO_RW para E/S de lectura y escritura enviada por libaio ."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/18f614369def2a11a52f569fe0f910b199d13487", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/1dc7d74fe456944a9b1c57bd776280249f441ac6", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/337b543e274fe7a8f47df3c8293cc6686ffa620f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b4eea7a05ee0ab5ab0514421e6ba8c5d249cf942", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b820de741ae48ccf50dd95e297889c286ff4f760", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d7b6fa97ec894edd02f64b83e5e72e1aa352f353", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e7e23fc5d5fe422827c9a43ecb579448f73876c7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ea1cd64d59f22d6d13f367d62ec6e27b9344695f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1055", "comment": "CVE-2024-26764 - This technique is relevant as it deals with the exploitation of kernel bugs and takes advantage of the existing kernel bugs to inject malicious kernel code. Defending against this involves restricting kiocb_set_cancel_fn() to I/O submitted via libaio to prevent unexpected kernel warnings."}, {"techniqueID": "T1060", "comment": "CVE-2024-26764 - This technique is relevant as it involves the exploitation of kernel bugs to escalate privileges. Defending against this involves setting the IOCB_AIO_RW flag for read and write I/O that is submitted by libaio to prevent kernel warnings."}], "stix_bundle": {"description": "A STIX 2.1 bundle expressing all the related techniques, risks and defense strategies for this CVE.", "objects": [{"type": "indicator", "id": "indicator--5c3645a1-b52b-4e14-8d0e-c8a2ce0b5d1c", "spec_version": "2.1", "created_by_ref": "organization--5c3645a1-b52b-4e14-8d0e-c8a2ce0b5d1c", "modified": "2024-06-27T12:15:20.647", "created": "2024-04-03T17:15:52.580", "name": "CVE-2024-26764", "description": "Linux kernel bug: fs/aio: Restrict kiocb_set_cancel_fn() to I/O submitted via libaio", "labels": ["vulnerability", "CVE-2024-26764"], "objects": [{"type": "report", "id": "report--5c3645a1-b52b-4e14-8d0e-c8a2ce0b5d1c", "spec_version": "2.1", "created_by_ref": "organization--5c3645a1-b52b-4e14-8d0e-c8a2ce0b5d1c", "modified": "2024-06-27T12:15:20.647", "created": "2024-04-03T17:15:52.580", "name": "CVE-2024-26764", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nfs/aio: Restrict kiocb_set_cancel_fn() to I/O submitted via libaio\n\nIf kiocb_set_cancel_fn() is called for I/O submitted via io_uring, the\nfollowing kernel warning appears:\n\nWARNING: CPU: 3 PID: 368 at fs/aio.c:598 kiocb_set_cancel_fn+0x9c/0xa8\nCall trace:\n kiocb_set_cancel_fn+0x9c/0xa8\n ffs_epfile_read_iter+0x144/0x1d0\n io_read+0x19c/0x498\n io_issue_sqe+0x118/0x27c\n io_submit_sqes+0x25c/0x5fc\n __arm64_sys_io_uring_enter+0x104/0xab0\n invoke_syscall+0x58/0x11c\n el0_svc_common+0xb4/0xf4\n do_el0_svc+0x2c/0xb0\n el0_svc+0x2c/0xa4\n el0t_64_sync_handler+0x68/0xb4\n el0t_64_sync+0x1a4/0x1a8\n\nFix this by setting the IOCB_AIO_RW flag for read and write I/O that is\nsubmitted by libaio."}, {"type": "course-of-action", "id": "course-of-action--5c3645a1-b52b-4e14-8d0e-c8a2ce0b5d1c", "spec_version": "2.1", "created_by_ref": "organization--5c3645a1-b52b-4e14-8d0e-c8a2ce0b5d1c", "modified": "2024-06-27T12:15:20.647", "created": "2024-04-03T17:15:52.580", "name": "Defend against CVE-2024-26764", "description": "Set the IOCB_AIO_RW flag for read and write I/O that is submitted by libaio to prevent kernel warnings.", "related_tactics": ["T1055", "T1060"]}]}]}, "technical_analysis": {"Introduction": "The Linux kernel bug CVE-2024-26764 allows for the exploitation of kernel bugs to inject malicious kernel code, potentially escalating privileges.", "Impact and Scope": "CVSS score: N/A; Attack vector: N/A; The kernel bug could allow attackers to inject malicious kernel code, potentially leading to privilege escalation.", "Related MITRE ATT&CK Techniques": "T1055, T1060", "Technical Details": "The kernel bug allows for the exploitation of kernel bugs to inject malicious kernel code, potentially escalating privileges.", "Detection": "Detecting this CVE involves monitoring for kernel warnings and restrictions on kiocb_set_cancel_fn() to I/O submitted via libaio.", "Mitigation": "Mitigating this CVE involves setting the IOCB_AIO_RW flag for read and write I/O that is submitted by libaio to prevent kernel warnings.", "Conclusion": "The Linux kernel bug CVE-2024-26764 is a high-severity vulnerability that allows for the exploitation of kernel bugs to inject malicious kernel code, potentially escalating privileges."}, "executive_analysis": {"Overview": "The Linux kernel bug CVE-2024-26764 is a high-severity vulnerability that allows for the exploitation of kernel bugs to inject malicious kernel code, potentially escalating privileges.", "Business Impact": "The kernel bug could allow attackers to inject malicious kernel code, potentially leading to privilege escalation, which could have significant business impact.", "Technical Impact": "The kernel bug could allow attackers to inject malicious kernel code, potentially escalating privileges, which could have significant technical impact.", "Mitigation Strategies": "Setting the IOCB_AIO_RW flag for read and write I/O that is submitted by libaio to prevent kernel warnings.", "Recommendations": "Upgrade to the latest kernel version, implement kernel-hardening patches, and deploy security monitoring software to detect and respond to potential attacks.", "Conclusions": "The Linux kernel bug CVE-2024-26764 is a high-severity vulnerability that requires immediate attention and action to mitigate its risks and impact."}}