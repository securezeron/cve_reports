{"id": "CVE-2024-4851", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T19:16:02.800", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A Server-Side Request Forgery (SSRF) vulnerability exists in the stangirard/quivr application, version 0.0.204, which allows attackers to access internal networks. The vulnerability is present in the crawl endpoint where the 'url' parameter can be manipulated to send HTTP requests to arbitrary URLs, thereby facilitating SSRF attacks. The affected code is located in the backend/routes/crawl_routes.py file, specifically within the crawl_endpoint function. This issue could allow attackers to interact with internal services that are accessible from the server hosting the application."}, {"lang": "es", "value": "Existe una vulnerabilidad de Server-Side Request Forgery (SSRF) en la aplicaci\u00f3n stangirard/quivr, versi\u00f3n 0.0.204, que permite a los atacantes acceder a redes internas. La vulnerabilidad est\u00e1 presente en el endpoint de rastreo donde el par\u00e1metro 'url' puede manipularse para enviar solicitudes HTTP a URL arbitrarias, facilitando as\u00ed los ataques SSRF. El c\u00f3digo afectado se encuentra en el archivo backend/routes/crawl_routes.py, espec\u00edficamente dentro de la funci\u00f3n crawl_endpoint. Este problema podr\u00eda permitir a los atacantes interactuar con servicios internos a los que se puede acceder desde el servidor que aloja la aplicaci\u00f3n."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.1, "impactScore": 4.0}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-918"}]}], "references": [{"url": "https://huntr.com/bounties/b6011986-954a-47da-a60c-fc7aebc8005d", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-4851 is a Server-Side Request Forgery (SSRF) vulnerability, which can be exploited to potentially interact with internal services. This can be mitigated by implementing Input Validation and Sanitization (T1190) to prevent manipulating the 'url' parameter in the crawl endpoint."}, {"techniqueID": "T1508", "comment": "The vulnerability also allows attackers to send HTTP requests to arbitrary URLs. This can be mitigated by implementing Network Traffic Analysis and Session Policy Enforcement (T1508) to detect and block suspicious network traffic."}, {"techniqueID": "T1102", "comment": "The 'crawl' endpoint allows attackers to crawl internal networks, which can be detected by implementing Network Traffic Analysis and Session Policy Enforcement (T1102) to detect and respond to internal network reconnaissance."}], "stix_bundle": {"stix_core_v20": {"objects": [{"id": "CVE-2024-4851", "created_by_ref": "identity://1234567890", "modified": "2024-06-07T14:56:05.647", "name": "CVE-2024-4851", "description": "A Server-Side Request Forgery (SSRF) vulnerability in the stangirard/quivr application, version 0.0.204, which allows attackers to access internal networks.", "labels": ["vulnerability", "SSRF"], "observed_data": {"id": "observed-data--0", "created_by_ref": "identity://1234567890", "modified": "2024-06-07T14:56:05.647", "name": "Observed Malicious Activity", "description": "Observed malicious activity on the internal network", "created": "2024-06-06T19:16:02.800", "first_seen": "2024-06-06T19:16:02.800", "last_seen": "2024-06-06T19:16:02.800", "labels": ["malicious", "internal_network"], "object_marking_refs": ["marking-definition--1"]}, "attack_pattern_refs": ["attack-pattern--0"], "course_of_action_refs": ["course-of-action--0"], "x_mitre_attack_pattern_refs": ["T1190", "T1508", "T1102"]}]}}, "technical_analysis": {"Introduction": "CVE-2024-4851 is a Server-Side Request Forgery (SSRF) vulnerability in the stangirard/quivr application, version 0.0.204.", "Impact and Scope": "The vulnerability allows attackers to access internal networks, and can be exploited to interact with internal services.", "Related MITRE ATT&CK Techniques": "T1190, T1508, and T1102 are related MITRE ATT&CK Techniques, which can be used to exploit and detect this vulnerability.", "Technical Details": "The vulnerability exists in the 'crawl' endpoint, where the 'url' parameter can be manipulated to send HTTP requests to arbitrary URLs.", "Detection": "This vulnerability can be detected by monitoring network traffic and detecting suspicious requests.", "Mitigation": "The vulnerability can be mitigated by implementing input validation and sanitization, and by monitoring network traffic.", "Conclusion": "CVE-2024-4851 is a significant vulnerability that can be exploited to interact with internal services. It is essential to implement mitigations and detections to protect against this vulnerability."}, "executive_analysis": {"Overview": "CVE-2024-4851 is a critical vulnerability that can be exploited to interact with internal services.", "Business Impact": "This vulnerability can result in data breaches and unauthorized access to internal networks.", "Technical Impact": "The vulnerability can be exploited to interact with internal services, which can result in data breaches and unauthorized access to internal networks.", "Mitigation Strategies": "Implement input validation and sanitization, and monitor network traffic to detect and respond to this vulnerability.", "Recommendations": "Executives should ensure that their organization has implemented robust security measures to detect and respond to this vulnerability.", "Conclusions": "CVE-2024-4851 is a critical vulnerability that requires immediate attention and action to mitigate its impact."}}