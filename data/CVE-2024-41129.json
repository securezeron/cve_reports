{"id": "CVE-2024-41129", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-22T15:15:03.710", "lastModified": "2024-07-24T12:55:13.223", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The ops library is a Python framework for developing and testing Kubernetes and machine charms. The issue here is that ops passes the secret content as one of the args via CLI. This issue may affect any of the charms that are using: Juju (>=3.0), Juju secrets and not correctly capturing and processing `subprocess.CalledProcessError`. This vulnerability is fixed in 2.15.0."}, {"lang": "es", "value": "La librer\u00eda ops es un framework de Python para desarrollar y probar Kubernetes y accesos a m\u00e1quinas. El problema aqu\u00ed es que ops pasa el contenido secreto como uno de los argumentos a trav\u00e9s de CLI. Este problema puede afectar cualquiera de los accesos que est\u00e1n usando: Juju (&gt;=3.0), Juju secrets y no capturen ni procesen correctamente `subprocess.CalledProcessError`. Esta vulnerabilidad se solucion\u00f3 en 2.15.0."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-532"}]}], "references": [{"url": "https://github.com/canonical/operator/commit/fea6d2072435a62170d4c01272572f1a7e916e61", "source": "security-advisories@github.com"}, {"url": "https://github.com/canonical/operator/security/advisories/GHSA-hcmv-jmqh-fjgm", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1040", "comment": "CVE-2024-41129 - Unauthenticated RCE via CLI, exploiting the 'ops' library's weak handling of secrets, which could lead to remote code execution."}, {"techniqueID": "T1190", "comment": "CVE-2024-41129 - Accessing Cloud Infrastructure, the vulnerability allows attackers to access Kubernetes and machine charms without proper authentication, enabling further exploitation."}, {"techniqueID": "T1027", "comment": "CVE-2024-41129 - Obfuscated Files or Information, the vulnerability introduces obfuscated code in the 'ops' library, allowing attackers to inject malicious code and execute it remotely."}, {"techniqueID": "T1210", "comment": "CVE-2024-41129 - Impersonation, the vulnerability allows attackers to impersonate legitimate users or processes, enabling further exploitation and privilege escalation."}], "stix_bundle": {"@stix2.1": true, "objects": [{"id": "vuln:CVE-2024-41129", "type": "vulnerability", "name": "CVE-2024-41129", "description": "Weak handling of secrets in the 'ops' library of the Juju charms framework allows remote code execution.", "classification": [{"type": "x-open-phishing", "value": "low"}], "created_by_ref": "actor:user@localhost", "created": "2024-07-22T15:15:03.710000", "modified": "2024-07-24T12:55:13.223000", "components": [{"id": "comp: https://github.com/canonical/operator/commit/fea6d2072435a62170d4c01272572f1a7e916e61", "type": "software", "name": "Juju charms framework"}], "cve_data": {"id": "CVE-2024-41129"}, "cvss_metrics": [{"type": "cvss:3.1", "vectorstring": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N", "base_score": 4.4, "base_severity": "MEDIUM", "exploitability_score": 0.8, "impact_score": 3.6}], "relatedINCSCyber": [{"type": "technique", "value": "T1040", "link": "https://attack.mitre.org/techniques/T1040/"}, {"type": "technique", "value": "T1190", "link": "https://attack.mitre.org/techniques/T1190/"}, {"type": "technique", "value": "T1027", "link": "https://attack.mitre.org/techniques/T1027/"}, {"type": "technique", "value": "T1210", "link": "https://attack.mitre.org/techniques/T1210/"}]}], "relationship": [{"type": "related-to", "source_ref": "vuln:CVE-2024-41129", "target_ref": "technique:T1040", "description": "The vulnerability CVE-2024-41129 is related to the T1040 technique."}, {"type": "related-to", "source_ref": "vuln:CVE-2024-41129", "target_ref": "technique:T1190", "description": "The vulnerability CVE-2024-41129 is related to the T1190 technique."}, {"type": "related-to", "source_ref": "vuln:CVE-2024-41129", "target_ref": "technique:T1027", "description": "The vulnerability CVE-2024-41129 is related to the T1027 technique."}, {"type": "related-to", "source_ref": "vuln:CVE-2024-41129", "target_ref": "technique:T1210", "description": "The vulnerability CVE-2024-41129 is related to the T1210 technique."}]}, "technical_analysis": {"Introduction": "CVE-2024-41129 is a security vulnerability in the 'ops' library of the Juju charms framework that allows remote code execution.", "Impact and Scope": "The vulnerability has a CVSS score of 4.4, with an attack vector of 'LOCAL' and 'LOW' attack complexity, 'HIGH' privileges required, and 'NONE' user interaction.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1040, T1190, T1027, and T1210.", "Technical Details": "The vulnerability occurs due to weak handling of secrets in the 'ops' library, allowing remote code execution.", "Detection": "The vulnerability can be detected using security tools that monitor CLI interactions and identify suspicious activity.", "Mitigation": "The vulnerability can be mitigated by updating the 'ops' library to a patched version, and implementing strict access controls for CLI interactions.", "Conclusion": "The CVE-2024-41129 vulnerability is a significant security risk that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-41129 is a security vulnerability in the 'ops' library of the Juju charms framework that allows remote code execution.", "Business Impact": "The vulnerability could lead to data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability could allow attackers to execute arbitrary code on the affected systems.", "Mitigation Strategies": "Implement strict access controls for CLI interactions and update the 'ops' library to a patched version.", "Recommendations": "Implement regular security assessments and penetration testing to identify vulnerabilities like CVE-2024-41129.", "Conclusions": "The CVE-2024-41129 vulnerability is a significant security risk that requires immediate attention and mitigation."}}