{"id": "CVE-2007-4685", "sourceIdentifier": "cve@mitre.org", "published": "2007-11-15T01:46:00.000", "lastModified": "2017-07-29T01:33:06.537", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The kernel in Apple Mac OS X 10.4 through 10.4.10 allows local users to gain privileges by executing setuid or setgid programs in which the stdio, stderr, or stdout file descriptors are \"in an unexpected state.\""}, {"lang": "es", "value": "El n\u00facle del Apple Mac OS X 10.4 hasta el 10.4.10 permite a usuarios locales obtener privilegios mediante la ejecuci\u00f3n de los programas setuid o setgid en los cuales los ficheros descriptores stdio, stderr o stdout est\u00e1n en \"un estado inesperado\"."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "AFD4DE58-46C7-4E69-BF36-C5FD768B8248"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "CF824694-52DE-44E3-ACAD-60B2A84CD3CE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.3:*:*:*:*:*:*:*", "matchCriteriaId": "B73A0891-A37A-4E0D-AA73-B18BFD6B1447"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.4:*:*:*:*:*:*:*", "matchCriteriaId": "26AC38AB-D689-4B2B-9DAE-F03F4DFD15BE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.5:*:*:*:*:*:*:*", "matchCriteriaId": "0C580935-0091-4163-B747-750FB7686973"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.6:*:*:*:*:*:*:*", "matchCriteriaId": "BB0F2132-8431-4CEF-9A3D-A69425E3834E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.7:*:*:*:*:*:*:*", "matchCriteriaId": "8719F3C4-F1DE-49B5-9301-22414A2B6F9C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.8:*:*:*:*:*:*:*", "matchCriteriaId": "09ED46A8-1739-411C-8807-2A416BDB6DFE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.9:*:*:*:*:*:*:*", "matchCriteriaId": "786BB737-EA99-4EC6-B742-0C35BF2453F9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.10:*:*:*:*:*:*:*", "matchCriteriaId": "8D089858-3AF9-4B82-912D-AA33F25E3715"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "29644501-54BD-45E9-A6C1-618892CD354F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "8A132487-E89F-4D0D-8366-14AFC904811F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.3:*:*:*:*:*:*:*", "matchCriteriaId": "FD231103-D7C7-4697-BE90-D67558D6115C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.4:*:*:*:*:*:*:*", "matchCriteriaId": "BCADAAA0-C885-466C-A122-A94E73EAF817"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.5:*:*:*:*:*:*:*", "matchCriteriaId": "448DB1C7-7B0C-4076-9B9F-1CDCD5EB6930"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.6:*:*:*:*:*:*:*", "matchCriteriaId": "2BE429EF-24D4-453A-8B43-8CCEF5D72773"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.7:*:*:*:*:*:*:*", "matchCriteriaId": "8AC9692A-CE81-446D-B136-449662C4B9A2"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.8:*:*:*:*:*:*:*", "matchCriteriaId": "504D78AB-5374-48C9-B357-DB6BD2267D2D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.9:*:*:*:*:*:*:*", "matchCriteriaId": "3029892E-1375-4F40-83D3-A51BDC4E9840"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.10:*:*:*:*:*:*:*", "matchCriteriaId": "81F8DA6D-2258-4138-8FB2-90BE3C68B230"}]}]}], "references": [{"url": "http://docs.info.apple.com/article.html?artnum=307041", "source": "cve@mitre.org"}, {"url": "http://lists.apple.com/archives/security-announce/2007/Nov/msg00002.html", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://secunia.com/advisories/27643", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://securitytracker.com/id?1018950", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/26444", "source": "cve@mitre.org"}, {"url": "http://www.us-cert.gov/cas/techalerts/TA07-319A.html", "source": "cve@mitre.org", "tags": ["US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2007/3868", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/38469", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1102", "comment": "CVE-2007-4685 - This vulnerability allows an attacker to gain privileges by executing setuid or setgid programs with FILE DESCRIPTORS in an unexpected state. This can be mitigated by validating and sanitizing the FILE DESCRIPTORS of setuid or setgid programs."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "CVE-2007-4685", "name": "Applying Security Patches and Mitigations", "created_by_ref": "organization--4f8c7f4f-d5fd-421b-9322-d7ff333be4f2", "created": "2017-07-29T01:33:06.537Z", "modified": "2017-07-29T01:33:06.537Z", "components": [{"type": "indicator", "id": "setuid_OR_setgid_program", "name": "Setuid or Setgid Program", "description": "A setuid or setgid program with FILE DESCRIPTORS in an unexpected state.", "created_by_ref": "organization--4f8c7f4f-d5fd-421b-9322-d7ff333be4f2", "created": "2017-07-29T01:33:06.537Z", "modified": "2017-07-29T01:33:06.537Z", "labels": [{"type": "label", "value": "Indicator", "observable_date": "2017-07-29T01:33:06.537Z"}], "objects": [{"type": "observable", "id": "FILE_DESCRIPTOR_ERROR", "name": "FILE_DESCRIPTOR_ERROR", "description": "FILE DESCRIPTORS in an unexpected state.", "created_by_ref": "organization--4f8c7f4f-d5fd-421b-9322-d7ff333be4f2", "created": "2017-07-29T01:33:06.537Z", "modified": "2017-07-29T01:33:06.537Z", "labels": [{"type": "label", "value": "Error", "observable_date": "2017-07-29T01:33:06.537Z"}]}]}, {"type": "indicator", "id": "CVE-2007-4685_vulnerability", "name": "CVE-2007-4685 Vulnerability", "description": "The kernel in Apple Mac OS X 10.4 through 10.4.10 allows local users to gain privileges by executing setuid or setgid programs in which the stdio, stderr, or stdout file descriptors are in an unexpected state.", "created_by_ref": "organization--4f8c7f4f-d5fd-421b-9322-d7ff333be4f2", "created": "2017-07-29T01:33:06.537Z", "modified": "2017-07-29T01:33:06.537Z", "labels": [{"type": "label", "value": "Indicator", "observable_date": "2017-07-29T01:33:06.537Z"}], "objects": [{"type": "observable", "id": "kernel_vulnerability", "name": "Kernel Vulnerability", "description": "The kernel in Apple Mac OS X 10.4 through 10.4.10 allows local users to gain privileges by executing setuid or setgid programs in which the stdio, stderr, or stdout file descriptors are in an unexpected state.", "created_by_ref": "organization--4f8c7f4f-d5fd-421b-9322-d7ff333be4f2", "created": "2017-07-29T01:33:06.537Z", "modified": "2017-07-29T01:33:06.537Z", "labels": [{"type": "label", "value": "Vulnerability", "observable_date": "2017-07-29T01:33:06.537Z"}]}]}]}}, "technical_analysis": {"Introduction": "The vulnerability affects the kernel of Apple Mac OS X 10.4 through 10.4.10, allowing local users to gain privileges by executing setuid or setgid programs in which the stdio, stderr, or stdout file descriptors are in an unexpected state.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2 with a low attack complexity and no authentication required, making it a high-risk vulnerability.", "Related MITRE ATT&CK Techniques": "T1102: Expand Attack Surface", "Technical Details": "The vulnerability is caused by a flaw in the kernel's handling of setuid or setgid programs, which allows an attacker to manipulate the file descriptors in an unexpected way.", "Detection": "Detection of this vulnerability involves monitoring for unusual file descriptor behavior in setuid or setgid programs.", "Mitigation": "Mitigation strategies include applying security patches and updating the kernel, as well as validating and sanitizing file descriptors of setuid or setgid programs.", "Conclusion": "The vulnerable kernel in Apple Mac OS X 10.4 through 10.4.10 must be patched to prevent privilege escalation and other malicious activities."}, "executive_analysis": {"Overview": "The Apple Mac OS X 10.4 through 10.4.10 is vulnerable to a privilege escalation vulnerability.", "Business Impact": "This vulnerability can lead to unauthorized access to sensitive data and systems, resulting in significant business losses.", "Technical Impact": "The vulnerability can be exploited to gain privileges, allowing attackers to perform actions such as data theft, system compromise, and unauthorized access.", "Mitigation Strategies": "Patching the kernel and updating the system are effective mitigation strategies.", "Recommendations": "Executives should prioritize patching and updating the system, as well as implementing additional security measures to prevent exploitation.", "Conclusions": "The priority for executives should be to apply security patches and updates, and to implement additional security measures to prevent exploitation of the vulnerable kernel."}}