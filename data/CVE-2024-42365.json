{"id": "CVE-2024-42365", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-08T17:15:19.340", "lastModified": "2024-08-08T18:55:19.180", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Asterisk is an open source private branch exchange (PBX) and telephony toolkit. Prior to asterisk versions 18.24.2, 20.9.2, and 21.4.2 and certified-asterisk versions 18.9-cert11 and 20.7-cert2, an AMI user with `write=originate` may change all configuration files in the `/etc/asterisk/` directory. This occurs because they are able to curl remote files and write them to disk, but are also able to append to existing files using the `FILE` function inside the `SET` application. This issue may result in privilege escalation, remote code execution and/or blind server-side request forgery with arbitrary protocol. Asterisk versions 18.24.2, 20.9.2, and 21.4.2 and certified-asterisk versions 18.9-cert11 and 20.7-cert2 contain a fix for this issue."}, {"lang": "es", "value": "Asterisk es un kit de herramientas de telefon\u00eda y centralita privada (PBX) de c\u00f3digo abierto. Antes de las versiones de asterisk 18.24.2, 20.9.2 y 21.4.2 y de las versiones de asterisco certificado 18.9-cert11 y 20.7-cert2, un usuario de AMI con `write=originate` pod\u00eda cambiar todos los archivos de configuraci\u00f3n en `/etc/asterisk. /` directorio. Esto ocurre porque pueden curvar archivos remotos y escribirlos en el disco, pero tambi\u00e9n pueden agregarlos a archivos existentes usando la funci\u00f3n `FILE` dentro de la aplicaci\u00f3n `SET`. Este problema puede provocar una escalada de privilegios, la ejecuci\u00f3n remota de c\u00f3digo y/o blind server-side request forgery con un protocolo arbitrario. Las versiones de Asterisk 18.24.2, 20.9.2 y 21.4.2 y las versiones de asterisco certificado 18.9-cert11 y 20.7-cert2 contienen una soluci\u00f3n para este problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.1, "impactScore": 3.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1220"}, {"lang": "en", "value": "CWE-267"}]}], "references": [{"url": "https://github.com/asterisk/asterisk/blob/14367caaf7241df1eceea7c45c5b261989c2c6db/main/manager.c#L6426", "source": "security-advisories@github.com"}, {"url": "https://github.com/asterisk/asterisk/blob/7d28165cb1b2d02d66e8693bd3fe23ee72fc55d8/main/manager.c#L6426", "source": "security-advisories@github.com"}, {"url": "https://github.com/asterisk/asterisk/commit/42a2f4ccfa2c7062a15063e765916b3332e34cc4", "source": "security-advisories@github.com"}, {"url": "https://github.com/asterisk/asterisk/commit/7a0090325bfa9d778a39ae5f7d0a98109e4651c8", "source": "security-advisories@github.com"}, {"url": "https://github.com/asterisk/asterisk/commit/b4063bf756272254b160b6d1bd6e9a3f8e16cc71", "source": "security-advisories@github.com"}, {"url": "https://github.com/asterisk/asterisk/commit/bbe68db10ab8a80c29db383e4dfe14f6eafaf993", "source": "security-advisories@github.com"}, {"url": "https://github.com/asterisk/asterisk/commit/faddd99f2b9408b524e5eb8a01589fe1fa282df2", "source": "security-advisories@github.com"}, {"url": "https://github.com/asterisk/asterisk/security/advisories/GHSA-c4cg-9275-6w44", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-42365 - Remote code execution through AMI user with write=originate, potentially leading to privilege escalation and server-side request forgery."}, {"techniqueID": "T1204", "comment": "CVE-2024-42365 - File upload and execution through curl and FILE function, potentially leading to remote code execution and blind server-side request forgery."}, {"techniqueID": "T1190", "comment": "CVE-2024-42365 - Use of AMI to manipulate configuration files, potentially leading to privilege escalation and remote code execution."}, {"techniqueID": "T1036", "comment": "CVE-2024-42365 - Use of curl to download and execute files, potentially leading to remote code execution and file execution."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "cve_2024_42365_bundle", "objects": [{"type": "vulnerability", "id": "cve_2024_42365", "created_by_ref": "https://github.com/asterisk/asterisk", "created": "2024-08-08T17:15:19.340", "modified": "2024-08-08T18:55:19.180", "name": "Asterisk Remote Code Execution Vulnerability", "description": [{"lang": "en", "value": "Asterisk is an open source private branch exchange (PBX) and telephony toolkit. Prior to asterisk versions 18.24.2, 20.9.2, and 21.4.2 and certified-asterisk versions 18.9-cert11 and 20.7-cert2, an AMI user with `write=originate` may change all configuration files in the `/etc/asterisk/` directory."}], "cve": {"id": "CVE-2024-42365", "source": "https://github.com/asterisk/asterisk/security/advisories/GHSA-c4cg-9275-6w44"}, "cvssv3": {"base_score": 7.4, "base_severity": "HIGH", "attack_vector": "NETWORK", "attack_complexity": "LOW", "privileges_required": "LOW", "user_interaction": "NONE", "scope": "CHANGED", "confidentiality_impact": "LOW", "integrity_impact": "LOW", "availability_impact": "LOW"}, "related_opinions": [{"type": "opinion", "opinion": "SEVERE", "confidence": "HIGH"}], "courses_of_action": [{"type": "course_of_action", "id": "fix_the_vuln", "name": "Apply patch to fix the vulnerability", "description": [{"lang": "en", "value": "Apply the patch provided by the vendor to fix the vulnerability."}], "related_defenses": [{"type": "defense", "id": "defense1", "name": "Restrict access to the AMI interface", "description": [{"lang": "en", "value": "Restrict access to the AMI interface to only trusted devices and users."}]}]}]}], "relationships": [{"type": "has_course_of_action", "source_ref": "cve_2024_42365", "target_ref": "fix_the_vuln"}]}, "technical_analysis": {"Introduction": "Asterisk is an open-source private branch exchange (PBX) and telephony toolkit that has a remote code execution vulnerability.", "Impact and Scope": "The vulnerability has a CVSS score of 7.4 and allows an attacker to execute arbitrary code remotely. It affects Asterisk versions 18.24.2, 20.9.2, and 21.4.2, and certified-asterisk versions 18.9-cert11 and 20.7-cert2.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the T1210, T1204, T1190, and T1036 techniques.", "Technical Details": "The vulnerability is caused by the use of the `write=originate` permission in the AMI interface and the ability to execute curl commands.", "Detection": "The vulnerability can be detected by monitoring the system logs for suspicious activity and by using vulnerability scanners.", "Mitigation": "The vulnerability can be mitigated by applying the patch provided by the vendor and by restricting access to the AMI interface.", "Conclusion": "The vulnerability is a high-severity issue that can be exploited by an attacker to execute arbitrary code remotely."}, "executive_analysis": {"Overview": "Asterisk is an open-source private branch exchange (PBX) and telephony toolkit that has a remote code execution vulnerability.", "Business Impact": "The vulnerability could allow an attacker to gain unauthorized access to the system and potentially compromise sensitive data.", "Technical Impact": "The vulnerability could allow an attacker to execute arbitrary code remotely and potentially compromise the system.", "Mitigation Strategies": "The vendor has released a patch to fix the vulnerability and restricting access to the AMI interface can help to mitigate the risk.", "Recommendations": "Apply the patch to fix the vulnerability and restrict access to the AMI interface.", "Conclusions": "The vulnerability is a high-severity issue that requires immediate attention and mitigation to prevent potential attacks."}}