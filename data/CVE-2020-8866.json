{"id": "CVE-2020-8866", "sourceIdentifier": "zdi-disclosures@trendmicro.com", "published": "2020-03-23T21:15:12.643", "lastModified": "2022-10-07T15:35:40.950", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "This vulnerability allows remote attackers to create arbitrary files on affected installations of Horde Groupware Webmail Edition 5.2.22. Authentication is required to exploit this vulnerability. The specific flaw exists within add.php. The issue results from the lack of proper validation of user-supplied data, which can allow the upload of arbitrary files. An attacker can leverage this in conjunction with other vulnerabilities to execute code in the context of the www-data user. Was ZDI-CAN-10125."}, {"lang": "es", "value": "Esta vulnerabilidad permite a atacantes remotos crear archivos arbitrarios sobre las instalaciones afectadas de Horde Groupware Webmail Edition versi\u00f3n 5.2.22. Es requerida una autenticaci\u00f3n para explotar esta vulnerabilidad. El fallo espec\u00edfico se presenta dentro del archivo add.php. El problema es debido a la falta de una comprobaci\u00f3n apropiada de los datos suministrados por el usuario, lo que puede permitir la carga de archivos arbitrarios. Un atacante puede aprovechar esto en conjunto con otras vulnerabilidades para ejecutar c\u00f3digo en el contexto del usuario www-data. Fue ZDI-CAN-10125."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV30": [{"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-434"}]}, {"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-434"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:horde:groupware:5.2.22:*:*:*:webmail:*:*:*", "matchCriteriaId": "13EBB673-7F7D-402E-9791-7974AC24B529"}, {"vulnerable": true, "criteria": "cpe:2.3:a:horde:horde_form:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.0.20", "matchCriteriaId": "65DB0EAC-4A7F-4805-A30D-38F0AE22BFB6"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43"}]}]}], "references": [{"url": "https://lists.debian.org/debian-lts-announce/2020/03/msg00036.html", "source": "zdi-disclosures@trendmicro.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.horde.org/archives/announce/2020/001288.html", "source": "zdi-disclosures@trendmicro.com", "tags": ["Mailing List", "Vendor Advisory"]}, {"url": "https://www.zerodayinitiative.com/advisories/ZDI-20-275/", "source": "zdi-disclosures@trendmicro.com", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1027", "comment": "Inadequate File Validation - This technique is relevant as the vulnerability allows remote attackers to create arbitrary files on affected installations of Horde Groupware Webmail Edition 5.2.22. Authentication is required to exploit this vulnerability. The specific flaw exists within add.php. The issue results from the lack of proper validation of user-supplied data, which can allow the upload of arbitrary files."}, {"techniqueID": "T1190", "comment": "Injection - This technique is relevant as the vulnerability allows an attacker to inject arbitrary files. The file upload feature in Horde Groupware Webmail Edition 5.2.22 does not properly validate the file type and contents, allowing an attacker to upload arbitrary files."}, {"techniqueID": "T1210", "comment": "Other System Discovery - This technique is relevant as the vulnerability allows an attacker to create arbitrary files, which can be used to gather information about the system."}, {"techniqueID": "T1429", "comment": "Authorized Interface Primary Functionality - This technique is relevant as the vulnerability allows an attacker to use the file upload feature to upload arbitrary files, which can be used to execute code in the context of the www-data user."}], "stix_bundle": "{\"bundle\":{\r\n  \"objects\":{\r\n    \"vulnerability\":{\r\n      \"id\":\"CVE-2020-8866\",\r\n      \"description\":\"This vulnerability allows remote attackers to create arbitrary files on affected installations of Horde Groupware Webmail Edition 5.2.22. Authentication is required to exploit this vulnerability. The specific flaw exists within add.php. The issue results from the lack of proper validation of user-supplied data, which can allow the upload of arbitrary files.\",\r\n      \"exploitability\":\"high\",\r\n      \"severity\":\"high\",\r\n      \"cvss-version\":\"3.1\",\r\n      \"cvss-vector\":\"AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N\",\r\n      \"cvss-score\":6.5,\r\n      \"refs\":[\r\n        {\r\n          \"type\":\"reference\",\r\n          \"href\":\"https://lists.debian.org/debian-lts-announce/2020/03/msg00036.html\",\r\n          \"description\":\"Debian Advisory\",\r\n          \"source\":\"zdi-disclosures@trendmicro.com\"\r\n        },{\r\n          \"type\":\"reference\",\r\n          \"href\":\"https://lists.horde.org/archives/announce/2020/001288.html\",\r\n          \"description\":\"Horde Advisory\",\r\n          \"source\":\"zdi-disclosures@trendmicro.com\"\r\n        },{\r\n          \"type\":\"reference\",\r\n          \"href\":\"https://www.zerodayinitiative.com/advisories/ZDI-20-275/\",\r\n          \"description\":\"ZDI Advisory\",\r\n          \"source\":\"zdi-disclosures@trendmicro.com\"\r\n        }\r\n      ],\r\n      \"created-by\":{\"agent\":{\"name\":\"cpe.sh\"}},\r\n      \"modified\":{\"by\":{\"agent\":{\"name\":\"cpe.sh\"}}}\"\r\n    },\r\n    \"attack-pattern\":{\r\n      \"type\":\"attack-pattern\",\r\n      \"id\":\"T1027\",\r\n      \"name\":\"Valid MITRE T1027\",\r\n      \"description\":\"A technique where the attacker uploads arbitrary files on an affected installation of Horde Groupware Webmail Edition 5.2.22.\",\r\n      \"kill-chain-phase\":\"initial-compromise\",\r\n      \"tactics\":[\r\n        {\r\n          \"type\":\"tactic\",\r\n          \"id\":\"TA0003\",\r\n          \"name\":\"Lateral Movement\"\r\n        }\r\n      ]\r\n    },\r\n    \"malware\":{\r\n      \"type\":\"malware\",\r\n      \"id\":\"file-upload-attack\",\r\n      \"name\":\"File Upload Attack\",\r\n      \"description\":\"A malware that abuses the file upload feature in Horde Groupware Webmail Edition 5.2.22 to upload arbitrary files.\",\r\n      \"kill-chain-phase\":\"initial-compromise\",\r\n      \"tactics\":[\r\n        {\r\n          \"type\":\"tactic\",\r\n          \"id\":\"TA0003\",\r\n          \"name\":\"Lateral Movement\"\r\n        }\r\n      ]\r\n    },\r\n    \"course-of-action\":{\r\n      \"type\":\"course-of-action\",\r\n      \"id\":\"mitigate-file-upload-attack\",\r\n      \"name\":\"Mitigate File Upload Attack\",\r\n      \"description\":\"A course of action that provides guidance on mitigating file upload attacks.\",\r\n      \"kill-chain-phase\":\"initial-compromise\",\r\n      \"tactics\":[\r\n        {\r\n          \"type\":\"tactic\",\r\n          \"id\":\"TA0018\",\r\n          \"name\":\"Anti-Evasion\"\r\n        },{\r\n          \"type\":\"tactic\",\r\n          \"id\":\"TA0019\",\r\n          \"name\":\"Exploit Detection\"\r\n        }\r\n      ]\r\n    },\r\n    \"note\":{\r\n      \"type\":\"note\",\r\n      \"id\":\"file-upload-attack-detection\",\r\n      \"name\":\"File Upload Attack Detection\",\r\n      \"description\":\"A note that provides guidance on detecting file upload attacks.\",\r\n      \"kill-chain-phase\":\"initial-compromise\",\r\n      \"tactics\":[\r\n        {\r\n          \"type\":\"tactic\",\r\n          \"id\":\"TA0018\",\r\n          \"name\":\"Anti-Evasion\"\r\n        },{\r\n          \"type\":\"tactic\",\r\n          \"id\":\"TA0019\",\r\n          \"name\":\"Exploit Detection\"\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  \"relationships\":{\r\n    \"vulnerability\":{\r\n      \"attack-pattern\u00ab attack-pattern:attack-pattern\",\r\n      \"malware\u00ab malware:malware\",\r\n      \"course-of-action\u00ab course-of-action:course-of-action\",\r\n      \"note\u00ab note:note\"\r\n    }},{\r\n    \"attack-pattern\":{\r\n      \"malware\u00ab attack-pattern:malware\",\r\n      \"vulnerability\u00ab attack-pattern:vulnerability\"\r\n    }},{\r\n    \"malware\":{\r\n      \"vulnerability\u00ab malware:vulnerability\",\r\n      \"attack-pattern\u00ab malware:attack-pattern\"\r\n    }},{\r\n    \"course-of-action\":{\r\n      \"malware\u00ab course-of-action:malware\",\r\n      \"vulnerability\u00ab course-of-action:vulnerability\",\r\n      \"note\u00ab course-of-action:note\"\r\n    }},{\r\n    \"note\":{\r\n      \"malware\u00ab note:malware\",\r\n      \"vulnerability\u00ab note:vulnerability\",\r\n      \"course-of-action\u00ab note:course-of-action\"\r\n    }\r\n  }\r\n}", "technical_analysis": {"Introduction": "Introduction to the vulnerability CVE-2020-8866 in Horde Groupware Webmail Edition 5.2.22.", "Impact and Scope": "The vulnerability allows remote attackers to create arbitrary files on affected installations of Horde Groupware Webmail Edition 5.2.22. Authentication is required to exploit this vulnerability.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1027, T1190, T1210, T1429.", "Technical Details": "The vulnerability exists in the file upload feature in Horde Groupware Webmail Edition 5.2.22. The issue results from the lack of proper validation of user-supplied data, which can allow the upload of arbitrary files.", "Detection": "Detection methods include monitoring system logs for suspicious file upload activity and monitoring for the presence of malicious files.", "Mitigation": "Mitigation strategies include validating user-supplied data and monitoring system logs for suspicious file upload activity.", "Conclusion": "Conclusion: The vulnerability CVE-2020-8866 in Horde Groupware Webmail Edition 5.2.22 is a significant risk and should be addressed promptly."}, "executive_analysis": {"Overview": "Overview of the vulnerability CVE-2020-8866 in Horde Groupware Webmail Edition 5.2.22.", "Business Impact": "The vulnerability has the potential to compromise sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability exists in the file upload feature in Horde Groupware Webmail Edition 5.2.22 and can be exploited by remote attackers.", "Mitigation Strategies": "Mitigation strategies include implementing file upload validation and monitoring system logs for suspicious activity.", "Recommendations": "Recommendations include patching affected systems and enforcing strong authentication and access controls.", "Conclusions": "Conclusions: The vulnerability CVE-2020-8866 in Horde Groupware Webmail Edition 5.2.22 is a significant risk and should be addressed promptly."}}