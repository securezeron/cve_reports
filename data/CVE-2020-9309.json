{"id": "CVE-2020-9309", "sourceIdentifier": "cve@mitre.org", "published": "2020-07-15T21:15:13.740", "lastModified": "2020-07-24T14:39:44.827", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Silverstripe CMS through 4.5 can be susceptible to script execution from malicious upload contents under allowed file extensions (for example HTML code in a TXT file). When these files are stored as protected or draft files, the MIME detection can cause browsers to execute the file contents. Uploads stored as protected or draft files are allowed by default for authorised users only, but can also be enabled through custom logic as well as modules such as silverstripe/userforms. Sites using the previously optional silverstripe/mimevalidator module can configure MIME whitelists rather than extension whitelists, and hence prevent this issue. Sites on the Common Web Platform (CWP) use this module by default, and are not affected."}, {"lang": "es", "value": "Silverstripe CMS versiones hasta 4.5, puede ser susceptible de ejecuci\u00f3n de script desde contenidos de carga maliciosos bajo extensiones de archivo permitidas (por ejemplo, c\u00f3digo HTML en un archivo TXT). Cuando estos archivos son almacenados como archivos protegidos o borradores, la detecci\u00f3n MIME puede causar que los navegadores ejecuten el contenido del archivo. Las cargas almacenadas como archivos protegidos o borradores est\u00e1n permitidas por defecto solo para usuarios autorizados, pero tambi\u00e9n pueden ser habilitadas por medio de l\u00f3gica personalizada, as\u00ed como m\u00f3dulos como silverstripe/userforms. Los sitios que usan el m\u00f3dulo opcional de silverstripe/mimevalidator pueden configurar listas blancas MIME en lugar de listas blancas de extensi\u00f3n y, por lo tanto, impedir este problema. Los sitios en la Common Web Platform (CWP) usan este m\u00f3dulo por defecto y no est\u00e1n afectados"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-434"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:silverstripe:mimevalidator:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.0.0", "matchCriteriaId": "2B73DB50-72A1-4602-9844-F39219913D13"}, {"vulnerable": true, "criteria": "cpe:2.3:a:silverstripe:recipe:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.6.0", "matchCriteriaId": "E4DB8C57-082C-4489-B296-BD07F20759E3"}]}]}], "references": [{"url": "https://www.silverstripe.org/download/security-releases/CVE-2020-9309", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-9309 - This technique can be used to execute malicious scripts by exploiting the vulnerability in Silverstripe CMS, allowing for code execution and potential remote code execution."}, {"techniqueID": "T1204", "comment": "CVE-2020-9309 - This technique can be used to upload malicious files to compromise the Silverstripe CMS, which can lead to code execution or data exfiltration. Defense point: Ensure default file extensions are changed and custom logic is implemented to prevent unauthorized uploads."}, {"techniqueID": "T1192", "comment": "CVE-2020-9309 - This technique can be used to inject malicious HTML code to execute scripts or upload files to compromise the Silverstripe CMS, which can lead to code execution or data exfiltration. Defense point: Implement a MIME validator to validate file types and prevent malicious uploads."}], "stix_bundle": {"bundle": {"id": "CVE-2020-9309", "type": "indicator", "created_by_ref": "cve@mitre.org", "created": "2020-07-15T21:15:13.740", "modified": "2020-07-24T14:39:44.827", "name": "Silverstripe CMS Script Execution Vulnerability", "description": "Silverstripe CMS through 4.5 can be susceptible to script execution from malicious upload contents under allowed file extensions. When these files are stored as protected or draft files, the MIME detection can cause browsers to execute the file contents.", "object_refs": [{"id": "T1190", "type": "attack-pattern", "name": "Execution Through Crafted Name"}, {"id": "T1204", "type": "attack-pattern", "name": "File and Directory Discovery"}, {"id": "T1192", "type": "attack-pattern", "name": "HTML Injection"}], "relationships": [{"id": "T1190-CVE-2020-9309", "type": "related-to", "from": {"id": "T1190", "type": "attack-pattern"}, "to": {"id": "CVE-2020-9309", "type": "indicator"}, "label": "Execute malicious scripts"}, {"id": "T1204-CVE-2020-9309", "type": "related-to", "from": {"id": "T1204", "type": "attack-pattern"}, "to": {"id": "CVE-2020-9309", "type": "indicator"}, "label": "Upload malicious files"}, {"id": "T1192-CVE-2020-9309", "type": "related-to", "from": {"id": "T1192", "type": "attack-pattern"}, "to": {"id": "CVE-2020-9309", "type": "indicator"}, "label": "Inject malicious HTML code"}, {"id": "D3FEND-DLP", "type": "related-to", "from": {"id": "D3FEND-DLP", "type": "tactic"}, "to": {"id": "CVE-2020-9309", "type": "indicator"}, "label": "Data Loss Prevention"}, {"id": "D3FEND-MQ", "type": "related-to", "from": {"id": "D3FEND-MQ", "type": "tactic"}, "to": {"id": "CVE-2020-9309", "type": "indicator"}, "label": "Malware Injection"}]}}, "technical_analysis": {"Introduction": "Silverstripe CMS through 4.5 can be susceptible to script execution from malicious upload contents under allowed file extensions.", "Impact and Scope": "CVSS Score: 8.8, Attack Vector: Network, Attack Complexity: Low.", "Related MITRE ATT&CK Techniques": "T1190, T1204, T1192.", "Technical Details": "The vulnerability allows an attacker to upload malicious files with allowed file extensions, which can lead to code execution or data exfiltration.", "Detection": "Use a MIME validator to validate file types and prevent malicious uploads.", "Mitigation": "Change default file extensions, implement custom logic to prevent unauthorized uploads, and use a MIME validator.", "Conclusion": "This vulnerability can be used to execute malicious scripts or upload files to compromise the Silverstripe CMS, leading to code execution or data exfiltration."}, "executive_analysis": {"Overview": "Silverstripe CMS through 4.5 has a vulnerability that allows an attacker to execute malicious scripts or upload files.", "Business Impact": "This vulnerability can lead to data exfiltration or code execution, potentially causing significant business impact.", "Technical Impact": "The vulnerability affects the file upload mechanism in Silverstripe CMS, allowing unauthorized files to be uploaded.", "Mitigation Strategies": "Implement a MIME validator, change default file extensions, and use custom logic to prevent unauthorized uploads.", "Recommendations": "Ensure all Silverstripe CMS sites are updated to the latest version and implement additional security measures.", "Conclusions": "This vulnerability is a high-risk issue that requires immediate attention and mitigation."}}