{"id": "CVE-2007-4485", "sourceIdentifier": "cve@mitre.org", "published": "2007-08-22T23:17:00.000", "lastModified": "2018-10-15T21:35:45.933", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHP remote file inclusion vulnerability in visitor.php in Butterfly online visitors counter 1.08, when used with certain older versions of PHP with improper SERVER superglobal handling, allows remote attackers to execute arbitrary PHP code via a URL in the _SERVER[DOCUMENT_ROOT] parameter.  NOTE: it could be argued that this vulnerability is caused by a problem in PHP and the proper fix should be in PHP; if so, then this should not be treated as a vulnerability in Butterfly online visitors counter."}, {"lang": "es", "value": "Vulnerabilidad de inclusi\u00f3n remota de archivo en PHP en visitor.php de Butterfly online visitors counter 1.08, al ser utilizado con ciertas versiones antiguas de PHP que no manejan adecuadamente la superglobal SERVER, permite a atacantes remotos ejecutar c\u00f3digo PHP de su elecci\u00f3n mediante un URL en el par\u00e1metro _SERVER[DOCUMENT_ROOT]. NOTA: se podr\u00eda argumentar que esta vulnerabilidad es causada por un problema en PHP y el parche adecuado deber\u00eda estar en PHP; en este caso, entonces no deber\u00eda tratarse como una vulnerabilidad en Butterfly online visitors counter."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:butterfly:butterfly:1.08:*:*:*:*:*:*:*", "matchCriteriaId": "D759E359-E8FF-4271-A607-2D4C96E8107A"}]}]}], "references": [{"url": "http://osvdb.org/38327", "source": "cve@mitre.org"}, {"url": "http://securityvulns.com/Rdocument845.html", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://securityvulns.com/source26994.html", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/477253/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/482006/100/0/threaded", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/36147", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1047", "comment": "CVE-2007-4485 - This PHP remote file inclusion vulnerability can be exploited through crafted URLs, allowing attackers to execute arbitrary code. This technique involves exploiting vulnerabilities in web applications to gain unauthorized access."}, {"techniqueID": "T1190", "comment": "CVE-2007-4485 - This PHP remote file inclusion vulnerability can be used to steal sensitive data or install malware on the affected system. This technique involves spreading malware or stealing data through remote code execution."}], "stix_bundle": {"type": "bundle", "id": "urn:example:bundle:1.0", "description": "STIX bundle for CVE-2007-4485", "objects": [{"type": "vulnerability", "id": "urn:example:vulnerability:1.0", "description": "CVE-2007-4485 - PHP remote file inclusion vulnerability", "cve": {"id": "CVE-2007-4485"}, "risk_analysis": {"confidence_level": "HIGH", "severeness_level": "HIGH", "cve_source": "nvd@nist.gov"}, "affected_analysis": {"configurations": [{"operator": "OR", "nodes": [{"operator": "AND", "nodes": [{"cpe_match": "cpe:2.3:a:butterfly:butterfly:1.08:*:*:*:*:*:*:*"}]}]}]}, "note": {"text": "Note: This vulnerability is also related to a problem in PHP."}, "relationships": [{"type": "exploitible_by", "id": "T1047", "object_ref": "urn:example:technique:1.0", "relationship_type": "exploited_by"}, {"type": "spread_by", "id": "T1190", "object_ref": "urn:example:technique:2.0", "relationship_type": "exploited_by"}]}, {"type": "network", "id": "urn:example:indicator:1.0", "description": " Indicator for CVE-2007-4485"}, {"type": "tool", "id": "urn:example:tool:1.0", "description": "PHP Remote File Inclusion Exploit Tool"}]}, "technical_analysis": {"Introduction": "CVE-2007-4485 is a vulnerability in the Butterfly online visitors counter application. It allows remote attackers to inject arbitrary PHP code by exploiting a PHP remote file inclusion vulnerability in the _SERVER[DOCUMENT_ROOT] parameter.", "Impact and Scope": "The vulnerability has a CVSS score of 6.8 (CVSS v2). Attackers can execute arbitrary code on the affected system, which can enable them to steal sensitive data, install malware, or conduct other malicious activities.", "Related MITRE ATT&CK Techniques": "T1047 - Web App Attack, T1190 - Exploit Public-Facing Application", "Technical Details": "The vulnerability is caused by a PHP remote file inclusion vulnerability in the visitor.php script. Attackers can exploit this vulnerability by crafting a URL with a _SERVER[DOCUMENT_ROOT] parameter that includes a malicious PHP file.", "Detection": "Detecting this vulnerability involves monitoring web server logs for suspicious traffic and identifying HTTP requests with unusual parameters, such as the _SERVER[DOCUMENT_ROOT] parameter.", "Mitigation": "To mitigate this vulnerability, developers should validate and sanitize user input to prevent PHP file inclusion, and web server administrators should monitor logs for suspicious activity.", "Conclusion": "In conclusion, CVE-2007-4485 is a critical vulnerability that can be exploited by attackers to inject arbitrary code on the affected system. Detection and mitigation are crucial to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2007-4485 is a vulnerability in the Butterfly online visitors counter application that allows remote attackers to inject arbitrary PHP code.", "Business Impact": "Exploitation of this vulnerability can lead to data theft, malware installation, or other malicious activities, resulting in significant business losses.", "Technical Impact": "The vulnerability has a CVSS score of 6.8 (CVSS v2), indicating a high level of severity.", "Mitigation Strategies": "Web developers should validate and sanitize user input, and web administrators should monitor logs for suspicious activity.", "Recommendations": "Executives should prioritize patching and updating the affected application as soon as possible, and implement a comprehensive incident response plan in case of compromise.", "Conclusions": "In conclusion, CVE-2007-4485 is a critical vulnerability that requires immediate attention and action to mitigate its impact."}}