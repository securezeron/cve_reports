{"id": "CVE-2007-1710", "sourceIdentifier": "cve@mitre.org", "published": "2007-03-27T01:19:00.000", "lastModified": "2017-10-11T01:31:57.753", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The readfile function in PHP 4.4.4, 5.1.6, and 5.2.1 allows context-dependent attackers to bypass safe_mode restrictions and read arbitrary files by referring to local files with a certain URL syntax instead of a pathname syntax, as demonstrated by a filename preceded a \"php://../../\" sequence."}, {"lang": "es", "value": "La funci\u00f3n readfile de PHP 4.4.4, 5.1.6, Y 5.2.1 permite a usuarios locales o remotos dependiendo del contexto evitar las restricciones del modo seguro (safe_mode) y leer archivos de su elecci\u00f3n haciendo referencia a archivos locales con una determinada sintaxis de tipo URL en lugar de una sintaxis de nombre de ruta, como se ha demostrado mediante un nombre de archivo precedido por una secuencia \"php://../../\"."}], "vendorComments": [{"organization": "Red Hat", "comment": "We do not consider these to be security issues.  For more details see http://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=169857#c1\nand http://www.php.net/security-note.php\n", "lastModified": "2007-04-17T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.1, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": true, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:4.4.4:*:*:*:*:*:*:*", "matchCriteriaId": "71AEE8B4-FCF8-483B-8D4C-2E80A02E925E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.1.6:*:*:*:*:*:*:*", "matchCriteriaId": "A9BF34B5-F74C-4D56-9841-42452D60CB87"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "88358D1E-BE6F-4CE3-A522-83D1FA4739E3"}]}]}], "references": [{"url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?lang=en&cc=us&objectID=c01056506", "source": "cve@mitre.org"}, {"url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?lang=en&cc=us&objectID=c01086137", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/25423", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/25850", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/1991", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/2374", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/3573", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1047", "comment": "CVE-2007-1710 - The readfile function in PHP 4.4.4, 5.1.6, and 5.2.1 allows context-dependent attackers to bypass safe_mode restrictions and read arbitrary files by referring to local files with a certain URL syntax instead of a pathname syntax, which can be used to execute arbitrary code and is relevant to the 'File and Directory Discovery' MITRE ATT&CK Technique."}, {"techniqueID": "T1053", "comment": "CVE-2007-1710 - The vulnerability allows for file inclusion and execution of arbitrary code, which can be used to conduct post-exploitation activities, and is relevant to the 'Process Injection' MITRE ATT&CK Technique."}, {"techniqueID": "T1083", "comment": "CVE-2007-1710 - The vulnerability can be used to conduct code injection and is relevant to the 'Command and Control Server Implementation' MITRE ATT&CK Technique."}], "stix_bundle": {"type": "bundle", "id": "bundle-1", "objects": [{"type": "marker-identification", "id": "marker-1", "name": "CVE-2007-1710", "description": "The readfile function in PHP 4.4.4, 5.1.6, and 5.2.1 allows context-dependent attackers to bypass safe_mode restrictions and read arbitrary files by referring to local files with a certain URL syntax instead of a pathname syntax.", "objects": [{"type": "intrusion-set", "id": "intrusion-set-1", "name": "Unknown", "description": "Unknown"}]}, {"type": "attack-pattern", "id": "attack-pattern-1", "name": "File and Directory Discovery", "description": "The attack pattern involves discovering and reading files on a target system.", "objects": [{"type": "tool", "id": "tool-1", "name": "readfile", "description": "The readfile function can be used to read files on a target system."}]}, {"type": "attack-pattern", "id": "attack-pattern-2", "name": "Process Injection", "description": "The attack pattern involves injecting code into a process on a target system.", "objects": [{"type": "tool", "id": "tool-2", "name": "php", "description": "The php tool can be used to inject code into a process."}]}, {"type": "attack-pattern", "id": "attack-pattern-3", "name": "Command and Control Server Implementation", "description": "The attack pattern involves implementing a command and control server to communicate with compromised systems.", "objects": [{"type": "tool", "id": "tool-3", "name": " netcat", "description": "The netcat tool can be used to implement a command and control server."}]}, {"type": "course-of-action", "id": "course-of-action-1", "name": "patch-application", "description": "Apply the patch to the affected system to prevent exploitation.", "objects": [{"type": " recommendation", "id": "recommendation-1", "name": "Implement patch", "description": "Implement patch to prevent exploitation."}]}]}, "technical_analysis": {"Introduction": "The CVE-2007-1710 vulnerability is a file inclusion vulnerability which allows attackers to read arbitrary files by referring to local files with a certain URL syntax instead of a pathname syntax.", "Impact and Scope": "The vulnerability has a CVSS score of 4.3 and allows for file inclusion and execution of arbitrary code, which can be used to conduct post-exploitation activities.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK Techniques are File and Directory Discovery (T1047), Process Injection (T1053), and Command and Control Server Implementation (T1083).", "Technical Details": "The vulnerability is caused by the readfile function in PHP 4.4.4, 5.1.6, and 5.2.1 which allows context-dependent attackers to bypass safe_mode restrictions and read arbitrary files.", "Detection": "The vulnerability can be detected using tools such as Nessus and OpenVAS which can identify the presence of the vulnerable PHP version.", "Mitigation": "The vulnerability can be mitigated by applying the patch to the affected system.", "Conclusion": "The CVE-2007-1710 vulnerability is a file inclusion vulnerability which allows attackers to read arbitrary files and execute arbitrary code, and can be mitigated by applying the patch."}, "executive_analysis": {"Overview": "The CVE-2007-1710 vulnerability is a file inclusion vulnerability which allows attackers to read arbitrary files and execute arbitrary code.", "Business Impact": "The vulnerability can allow attackers to gain unauthorized access to sensitive data and systems, which can have serious business impacts.", "Technical Impact": "The vulnerability can allow attackers to conduct post-exploitation activities such as data theft and system compromise.", "Mitigation Strategies": "The vulnerability can be mitigated by applying the patch to the affected system.", "Recommendations": "Executives should ensure that the affected systems are patched as soon as possible, and that regular security scanning and vulnerability assessment are performed.", "Conclusions": "The CVE-2007-1710 vulnerability is a serious vulnerability which requires immediate attention and action to prevent exploitation."}}