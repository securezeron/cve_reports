{"id": "CVE-2024-40636", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-17T18:15:04.343", "lastModified": "2024-07-18T12:28:43.707", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Steeltoe is an open source project that provides a collection of libraries that helps users build production-grade cloud-native applications using externalized configuration, service discovery, distributed tracing, application management, and more. When utilizing multiple Eureka server service URLs with basic auth and encountering an issue with fetching the service registry, an error is logged with the Eureka server service URLs but only the first URL is masked. The code in question is  `_logger.LogError(e, \"FetchRegistry Failed for Eureka service urls: {EurekaServerServiceUrls}\", new Uri(ClientConfig.EurekaServerServiceUrls).ToMaskedString());` in the `DiscoveryClient.cs` file which may leak credentials into logs. This issue has been addressed in version 3.2.8 of the Steeltoe.Discovery.Eureka nuget package."}, {"lang": "es", "value": "Steeltoe es un proyecto de c\u00f3digo abierto que proporciona una colecci\u00f3n de librer\u00edas que ayudan a los usuarios a crear aplicaciones nativas de la nube de nivel de producci\u00f3n mediante configuraci\u00f3n externalizada, descubrimiento de servicios, seguimiento distribuido, gesti\u00f3n de aplicaciones y m\u00e1s. Cuando se utilizan varias URL del servicio del servidor Eureka con autenticaci\u00f3n b\u00e1sica y se produce un problema al obtener el registro del servicio, se registra un error con las URL del servicio del servidor Eureka, pero solo se enmascara la primera URL. El c\u00f3digo en cuesti\u00f3n es `_logger.LogError(e, \"FetchRegistry Failed for Eureka service urls: {EurekaServerServiceUrls}\", new Uri(ClientConfig.EurekaServerServiceUrls).ToMaskedString());` en el archivo `DiscoveryClient.cs` que puede filtrarse credenciales en registros. Este problema se solucion\u00f3 en la versi\u00f3n 3.2.8 del paquete nuget Steeltoe.Discovery.Eureka."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-532"}]}], "references": [{"url": "https://github.com/SteeltoeOSS/security-advisories/security/advisories/GHSA-vmcp-66r5-3pcp", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1134", "comment": "CVE-2024-40636 - Attacker can obtain sensitive information from logs due to improper masking of Eureka server service URLs. An attacker can use this information to conduct further attacks."}, {"techniqueID": "T1562", "comment": "CVE-2024-40636 - Attacker can use this vulnerability to gain access to the targeted system by leveraging the leaked credentials from logs."}, {"techniqueID": "T1044", "comment": "CVE-2024-40636 - Attacker can use this vulnerability to conduct reconnaissance on the targeted system by analyzing the logged information."}, {"techniqueID": "T1190", "comment": "CVE-2024-40636 - Defenders should implement logging analyzer tools to detect and monitor logs for potential malicious activity."}], "technical_analysis": {"Introduction": "CVE-2024-40636 is a vulnerabiltiy in Steeltoe's Eureka service that allows attackers to obtain sensitive information from logs due to improper masking of Eureka server service URLs.", "Impact and Scope": "The vulnerabilty has a CVSS score of 5.3 with a 3.1 version and an attack vector of NETWORK. It has a confidentiality impact of LOW, integrity impact of NONE, and availability impact of NONE.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK Techniques for this vulnerability are T1134, T1562, T1044, and T1190.", "Technical Details": "The vulnerability occurs when the `DiscoveryClient` class is used to perform Eureka service discovery with multiple service URLs configured. The `ToMaskedString()` method is used to mask the URLs, but only the first URL is masked, leaving the other URLs vulnerable to information disclosure.", "Detection": "Detection of this vulnerability can be achieved by monitoring logs for potentially sensitive information and using logging analyzer tools to detect and monitor logs for potential malicious activity.", "Mitigation": "Mitigation strategies include updating the affected Steeltoe package to version 3.2.8, implementing logging analyzer tools to detect and monitor logs for potential malicious activity, and configuring service discovery to use a single service URL.", "Conclusion": "The vulnerability poses a significant risk to organizations that use Steeltoe's Eureka service, and prompt action is necessary to protect against potential attacks."}, "executive_analysis": {"Overview": "CVE-2024-40636 is a vulnerability in Steeltoe's Eureka service that poses a significant risk to organizations that use the service.", "Business Impact": "The vulnerability has the potential to cause material damage to an organization's reputation and financial stability if exploited by an attacker.", "Technical Impact": "The vulnerability can be used to gain access to sensitive information, conduct reconnaissance on the targeted system, and launch further attacks.", "Mitigation Strategies": "The main mitigation strategy is to update the affected Steeltoe package to version 3.2.8 and implement logging analyzer tools to detect and monitor logs for potential malicious activity.", "Recommendations": "Executive stakeholders should prioritize patching and updating the affected software, as well as conducting a thorough risk assessment to determine the potential impact of the vulnerability on their organization.", "Conclusions": "The vulnerability poses a significant risk to organizations that use Steeltoe's Eureka service, and prompt action is necessary to protect against potential attacks."}}