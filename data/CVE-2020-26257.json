{"id": "CVE-2020-26257", "sourceIdentifier": "security-advisories@github.com", "published": "2020-12-09T19:15:11.500", "lastModified": "2023-11-07T03:20:32.103", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Matrix is an ecosystem for open federated Instant Messaging and VoIP. Synapse is a reference \"homeserver\" implementation of Matrix. A malicious or poorly-implemented homeserver can inject malformed events into a room by specifying a different room id in the path of a `/send_join`, `/send_leave`, `/invite` or `/exchange_third_party_invite` request. This can lead to a denial of service in which future events will not be correctly sent to other servers over federation. This affects any server which accepts federation requests from untrusted servers. The Matrix Synapse reference implementation before version 1.23.1 the implementation is vulnerable to this injection attack. Issue is fixed in version 1.23.1. As a workaround homeserver administrators could limit access to the federation API to trusted servers (for example via `federation_domain_whitelist`)."}, {"lang": "es", "value": "Matrix es un ecosistema para VoIP y mensajer\u00eda instant\u00e1nea federada abierta.&#xa0;Synapse es una implementaci\u00f3n \"homeserver\" de referencia de Matrix.&#xa0;Un servidor dom\u00e9stico malicioso o mal implementado puede inyectar eventos malformados en una sala especificando un ID de sala diferente en la ruta de una petici\u00f3n \"/send_join\", \"/send_leave\", \"/invite\" o \"/exchange_third_party_invite\".&#xa0;Esto puede conllevar a una denegaci\u00f3n de servicio en la que los eventos futuros no ser\u00e1n enviados correctamente a otros servidores por medio de la federaci\u00f3n.&#xa0;Esto afecta a cualquier servidor que acepte peticiones de federaci\u00f3n de servidores que no sean confiables.&#xa0;La implementaci\u00f3n de referencia de Matrix Synapse anterior a la versi\u00f3n 1.23.1 es vulnerable a este ataque de inyecci\u00f3n.&#xa0;El problema se corrigi\u00f3 en la versi\u00f3n 1.23.1. Como soluci\u00f3n alternativa, los administradores de servidores dom\u00e9sticos podr\u00edan limitar el acceso a la API de federaci\u00f3n a servidores de confianza (por ejemplo, por medio de \"federation_domain_whitelist\")"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-400"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-400"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:matrix:synapse:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.23.1", "matchCriteriaId": "EB7A69DA-7B46-419F-A191-F50D816671A2"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*", "matchCriteriaId": "36D96259-24BD-44E2-96D9-78CE1D41F956"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*", "matchCriteriaId": "E460AA51-FCDA-46B9-AE97-E6676AA5E194"}]}]}], "references": [{"url": "https://github.com/matrix-org/synapse/blob/develop/CHANGES.md#synapse-1231-2020-12-09", "source": "security-advisories@github.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/matrix-org/synapse/commit/3ce2f303f15f6ac3dc352298972dc6e04d9b7a8b", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/matrix-org/synapse/pull/8776", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/matrix-org/synapse/security/advisories/GHSA-hxmp-pqch-c8mm", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/DBTIU3ZNBFWZ56V4X7JIAD33V5H2GOMC/", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QR4MMYZKX5N5GYGH4H5LBUUC5TLAFHI7/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0002", "comment": "CVE-2020-26257 - Ability to inject malformed events into a room can lead to a denial of service; Defend by limiting access to the federation API and implementing proper whitelisting."}, {"techniqueID": "TA0010", "comment": "CVE-2020-26257 - A malicious or poorly-implemented homeserver can inject malformed events into a room, potentially leading to a denial of service; Defend by implementing proper input validation and sanitization."}, {"techniqueID": "TA0015", "comment": "CVE-2020-26257 - Ability to inject malformed events into a room can lead to a denial of service; Defend by implementing proper logging and monitoring to detect and respond to suspicious activity."}, {"techniqueID": "TA0040", "comment": "CVE-2020-26257 - A malicious or poorly-implemented homeserver can inject malformed events into a room, potentially leading to a denial of service; Defend by implementing proper segmentation and isolation to contain the attack."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/CVE-2020-26257", "created_byRef": "https://example.com/creator", "created": "2023-11-07T03:20:32.103", "modified": "2023-11-07T03:20:32.103", "objects": [{"type": "vulnerability", "id": "https://example.com/CVE-2020-26257", "created_byRef": "https://example.com/creator", "created": "2023-11-07T03:20:32.103", "modified": "2023-11-07T03:20:32.103", "name": "CVE-2020-26257: Matrix Synapse Denial of Service", "description": "Matrix Synapse is vulnerable to a denial of service attack", "severity": "MEDIUM", "cvss-v3": {"base_score": 6.5, "base_severity": "MEDIUM"}}, {"type": "course-of-action", "id": "https://example.com/COA-1", "created_byRef": "https://example.com/creator", "created": "2023-11-07T03:20:32.103", "modified": "2023-11-07T03:20:32.103", "name": "Limit access to the federation API", "description": "Limit access to the federation API to trusted servers", "related t\u00e9cnicas": ["TA0002"]}, {"type": "course-of-action", "id": "https://example.com/COA-2", "created_byRef": "https://example.com/creator", "created": "2023-11-07T03:20:32.103", "modified": "2023-11-07T03:20:32.103", "name": "Implement proper whitelisting", "description": "Implement proper whitelisting to allow only trusted servers to access the federation API", "related t\u00e9cnicas": ["TA0002"]}, {"type": "course-of-action", "id": "https://example.com/COA-3", "created_byRef": "https://example.com/creator", "created": "2023-11-07T03:20:32.103", "modified": "2023-11-07T03:20:32.103", "name": "Implement proper input validation and sanitization", "description": "Implement proper input validation and sanitization to prevent malformed events from being injected into a room", "related t\u00e9cnicas": ["TA0010"]}], "relationship": {"vulnerability": {"course-of-action": {"COA-1": {"type": "related_to", "id": "https://example.com/COA-1"}, "COA-2": {"type": "related_to", "id": "https://example.com/COA-2"}}}}}, "technical_analysis": {"Introduction": "Matrix Synapse is a reference implementation of the Matrix protocol, widely used for open federated Instant Messaging and VoIP. Synapse is vulnerable to a denial of service attack due to the ability to inject malformed events into a room.", "Impact and Scope": "The impact of this vulnerability is a denial of service attack, which can lead to future events not being correctly sent to other servers over federation.", "Related MITRE ATT&CK Techniques": "TA0002, TA0010, TA0015, TA0040", "Technical Details": "The vulnerability is caused by the ability to inject malformed events into a room, which can lead to a denial of service attack.", "Detection": "Detection methods include monitoring for unusual network traffic patterns and analyzing logs for signs of attack.", "Mitigation": "Mitigation strategies include limiting access to the federation API and implementing proper whitelisting, as well as implementing proper input validation and sanitization.", "Conclusion": "In conclusion, Matrix Synapse is vulnerable to a denial of service attack, and mitigation strategies are necessary to prevent this attack from occurring."}, "executive_analysis": {"Overview": "Matrix Synapse is vulnerable to a denial of service attack, which can lead to future events not being correctly sent to other servers over federation.", "Business Impact": "The business impact of this vulnerability is a potential denial of service attack, which can lead to lost productivity and revenue.", "Technical Impact": "The technical impact of this vulnerability is a potential denial of service attack, which can lead to future events not being correctly sent to other servers over federation.", "Mitigation Strategies": "Mitigation strategies include limiting access to the federation API and implementing proper whitelisting, as well as implementing proper input validation and sanitization.", "Recommendations": "Executives are recommended to take immediate action to mitigate this vulnerability by implementing the recommended mitigation strategies.", "Conclusions": "In conclusion, immediate action is necessary to mitigate this vulnerability and prevent a denial of service attack from occurring."}}