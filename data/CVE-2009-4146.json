{"id": "CVE-2009-4146", "sourceIdentifier": "cve@mitre.org", "published": "2009-12-02T18:30:00.297", "lastModified": "2019-05-22T03:29:00.333", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The _rtld function in the Run-Time Link-Editor (rtld) in libexec/rtld-elf/rtld.c in FreeBSD 7.1, 7.2, and 8.0 does not clear the LD_PRELOAD environment variable, which allows local users to gain privileges by executing a setuid or setguid program with a modified LD_PRELOAD variable containing an untrusted search path that points to a Trojan horse library, a different vector than CVE-2009-4147."}, {"lang": "es", "value": "La funci\u00f3n _rtld en el Run-Time Link-Editor (rtld) de libexec/rtld-elf/rtld.c de FreeBSD v7.1, v7.2 y v8.0, no limpia la variable de entorno LD_PRELOAD, esto permite a usuarios locales aumentar sus privilegios al ejecutar el programa setuid o setguid con la variable LD_PRELOAD modificada para que contenga una ruta de b\u00fasqueda no confiable que apunte a una biblioteca de un Troyano. Se trata de una vulnerabilidad diferente de CVE-2009-4147."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.1:*:*:*:*:*:*:*", "matchCriteriaId": "803EFA9F-B7CB-4511-B1C1-381170CA9A23"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.2:*:*:*:*:*:*:*", "matchCriteriaId": "F948527C-A01E-4315-80B6-47FACE18A34F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "3CF1F9EF-01AF-4708-AE02-765360AF3D66"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/152997/FreeBSD-rtld-execl-Privilege-Escalation.html", "source": "cve@mitre.org"}, {"url": "http://people.freebsd.org/~cperciva/rtld.patch", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://secunia.com/advisories/37517", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/508142/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/508146/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/508168/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/37154", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.securitytracker.com/id?1023250", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1212", "comment": "Exploitation of a Security Feature Through the Mechanism of Weakness - Exploitation of unset or uninitialized buffer variables (CVE-2009-4146) - Allows an attacker to inject arbitrary code by exploiting the NULL or underinitialized buffer variables."}, {"techniqueID": "T1068", "comment": "Exploitation of a Security Feature Through the Mechanism of Weakness - Exploitation of unset or uninitialized buffer variables (CVE-2009-4146) - Allows an attacker to inject arbitrary code by exploiting the NULL or underinitialized buffer variables."}, {"techniqueID": "T1190", "comment": "Exploitation of a Security Feature Through the Mechanism of Weakness - Exploitation of unset or uninitialized buffer variables (CVE-2009-4146) - Allows an attacker to inject arbitrary code by exploiting the NULL or underinitialized buffer variables."}], "technical_analysis": {"Introduction": "The CVE-2009-4146 vulnerability is a buffer overflow issue in the FreeBSD _rtld function, which allows local users to gain privileges by executing a setuid or setgid program with a modified LD_PRELOAD variable containing an untrusted search path that points to a Trojan horse library.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2 with a version of 2.0, and an attack vector of LOCAL. This means that an attacker with local access to the system can exploit the vulnerability.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1212: Exploitation of a Security Feature Through the Mechanism of Weakness, T1068: Exploitation of Unrealized Memory (Predictable), and T1190: Exploitation of Uninitialized Buffer.", "Technical Details": "The vulnerability occurs because the _rtld function in FreeBSD 7.1, 7.2, and 8.0 does not clear the LD_PRELOAD environment variable, which allows an attacker to inject arbitrary code by exploiting the NULL or underinitialized buffer variables.", "Detection": "Detection of the vulnerability can be done by monitoring system logs for unauthorized access attempts, and by checking the LD_PRELOAD environment variable for unexpected values.", "Mitigation": "Mitigation strategies include patching the system to the latest version of FreeBSD, restricting access to the system, and monitoring system logs for suspicious activity.", "Conclusion": "The CVE-2009-4146 vulnerability is a significant security issue that can be exploited by an attacker with local access to the system. It is important to patch the system to the latest version of FreeBSD and to implement mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2009-4146 vulnerability is a significant security issue that can be exploited by an attacker with local access to the system.", "Business Impact": "The vulnerability can result in significant business impact, including loss of data, disruption of operations, and damage to reputation.", "Technical Impact": "The vulnerability can result in significant technical impact, including the possibility of unauthorized access to sensitive data, and the potential for data breaches.", "Mitigation Strategies": "Mitigation strategies include patching the system to the latest version of FreeBSD, restricting access to the system, and monitoring system logs for suspicious activity.", "Recommendations": "We recommend that the business implements a comprehensive vulnerability management program, including regular patching and monitoring of system logs.", "Conclusions": "In conclusion, the CVE-2009-4146 vulnerability is a significant security issue that requires immediate attention and mitigation."}}