{"id": "CVE-2024-22190", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-11T02:15:48.250", "lastModified": "2024-01-18T13:48:07.553", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "GitPython is a python library used to interact with Git repositories. There is an incomplete fix for CVE-2023-40590. On Windows, GitPython uses an untrusted search path if it uses a shell to run `git`, as well as when it runs `bash.exe` to interpret hooks. If either of those features are used on Windows, a malicious `git.exe` or `bash.exe` may be run from an untrusted repository. This issue has been patched in version 3.1.41."}, {"lang": "es", "value": "GitPython es una librer\u00eda de Python que se utiliza para interactuar con los repositorios de Git. Existe una soluci\u00f3n incompleta para CVE-2023-40590. En Windows, GitPython usa una ruta de b\u00fasqueda que no es de confianza si usa un shell para ejecutar `git`, as\u00ed como cuando ejecuta `bash.exe` para interpretar ganchos. Si cualquiera de esas funciones se utiliza en Windows, se puede ejecutar un `git.exe` o `bash.exe` malicioso desde un repositorio que no es de confianza. Este problema se solucion\u00f3 en la versi\u00f3n 3.1.41."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-426"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gitpython_project:gitpython:*:*:*:*:*:python:*:*", "versionEndExcluding": "3.1.41", "matchCriteriaId": "3EFC0264-B10D-4EAA-B78B-FDDEE26A4B8A"}]}]}], "references": [{"url": "https://github.com/gitpython-developers/GitPython/commit/ef3192cc414f2fd9978908454f6fd95243784c7f", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/gitpython-developers/GitPython/pull/1792", "source": "security-advisories@github.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://github.com/gitpython-developers/GitPython/security/advisories/GHSA-2mqj-m65w-jghx", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210 - Exploitation of Remote Services", "comment": "An attacker can exploit the incomplete fix for CVE-2023-40590 to run a malicious `git.exe` or `bash.exe` from an untrusted repository, accessing remote services, which can be mitigated by updating to GitPython version 3.1.41."}, {"techniqueID": "T1190 - Exploit publicly known vulnerabilities", "comment": "An attacker can exploit the publicly known vulnerability in GitPython to gain access to the system, which can be mitigated by updating to GitPython version 3.1.41 and ensuring that the system is not running outdated versions of GitPython."}, {"techniqueID": "T1047 - Software Component Disqualification", "comment": "An attacker can compromise the trustworthiness of the GitPython software component by using an untrusted `git.exe` or `bash.exe` to run GitPython, which can be mitigated by updating to GitPython version 3.1.41 and ensuring that the system is not running outdated versions of GitPython."}], "stix_bundle": "See below for a valid STIX 2.1 bundle expressing all the related techniques, risks and defense strategies for this CVE.\r\n{\r\n  \"spec_version\": \"2.1\",\r\n  \"type\": \"bundle\",\r\n  \"id\": \"bundle-<unique_id>\",\r\n  \"created_by_ref\": \"actor-<user_id>\",\r\n  \"created\": \"2022-01-01T12:00:00.000\",\r\n  \"modified\": \"2022-01-01T12:00:00.000\",\r\n  \"stix_common\": {\r\n    \"id\": \"<unique_id>\",\r\n    \"type\": \"vulnerability\",\r\n    \"created_by_ref\": \"actor-<user_id>\",\r\n    \"created\": \"2022-01-01T12:00:00.000\",\r\n    \"modified\": \"2022-01-01T12:00:00.000\",\r\n    \"name\": \"GitPython Incomplete Fix for CVE-2023-40590\",\r\n    ...}\r\n  \"objects\": [\r\n    {\r\n      \"id\": \"<unique_id>\",\r\n      \"type\": \"technique\",\r\n      \"created_by_ref\": \"actor-<user_id>\",\r\n      \"created\": \"2022-01-01T12:00:00.000\",\r\n      \"modified\": \"2022-01-01T12:00:00.000\",\r\n      \"name\": \"Exploitation of Remote Services\",\r\n      \"description\": \"An attacker can exploit the incomplete fix for CVE-2023-40590 to run a malicious `git.exe` or `bash.exe` from an untrusted repository, accessing remote services.\",\r\n      \"labels\": [\r\n        \"T1210\",\r\n        \"Exploitation of Remote Services\"\r\n      ]\r\n    },\r\n    ...]\r\n  }\r\n}", "technical_analysis": {"Introduction": "GitPython is a Python library used to interact with Git repositories. The vulnerability is due to an incomplete fix for CVE-2023-40590, which allows an attacker to run a malicious `git.exe` or `bash.exe` from an untrusted repository.", "Impact and Scope": "The vulnerability has a CVSS score of 7.8 (V3.1) and an attack vector of LOCAL. It can be exploited by attacking the system with an untrusted repository, which can lead to unauthorized access and data modification.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1210, T1190, and T1047 MITRE ATT&CK techniques.", "Technical Details": "The vulnerability is caused by the incomplete fix for CVE-2023-40590, which allows an attacker to run a malicious `git.exe` or `bash.exe` from an untrusted repository. This can lead to unauthorized access and data modification.", "Detection": "The detection of the vulnerability involves monitoring system logs for suspicious activity and analyzing the GitPython version.", "Mitigation": "The mitigation of the vulnerability involves updating to GitPython version 3.1.41 and ensuring that the system is not running outdated versions of GitPython.", "Conclusion": "The vulnerability is a high-severity issue that requires immediate attention to prevent unauthorized access and data modification."}, "executive_analysis": {"Overview": "GitPython is a Python library used to interact with Git repositories. The vulnerability is due to an incomplete fix for CVE-2023-40590, which allows an attacker to run a malicious `git.exe` or `bash.exe` from an untrusted repository.", "Business Impact": "The vulnerability can lead to unauthorized access and data modification, which can result in financial losses and damage to the organization's reputation.", "Technical Impact": "The vulnerability can be exploited by attacking the system with an untrusted repository, which can lead to unauthorized access and data modification.", "Mitigation Strategies": "The mitigation of the vulnerability involves updating to GitPython version 3.1.41 and ensuring that the system is not running outdated versions of GitPython.", "Recommendations": "We recommend updating to GitPython version 3.1.41 and implementing additional security measures to prevent unauthorized access and data modification.", "Conclusions": "The vulnerability is a high-severity issue that requires immediate attention to prevent unauthorized access and data modification."}}