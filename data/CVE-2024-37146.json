{"id": "CVE-2024-37146", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-01T19:15:04.070", "lastModified": "2024-08-21T14:38:39.563", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Flowise is a drag & drop user interface to build a customized large language model flow. In version 1.4.3 of Flowise, a reflected cross-site scripting vulnerability occurs in the `/api/v1/credentials/id` endpoint. If the default configuration is used (unauthenticated), an attacker may be able to craft a specially crafted URL that injects Javascript into the user sessions, allowing the attacker to steal information, create false popups, or even redirect the user to other websites without interaction. If the chatflow ID is not found, its value is reflected in the 404 page, which has type text/html. This allows an attacker to attach arbitrary scripts to the page, allowing an attacker to steal sensitive information. This XSS may be chained with the path injection to allow an attacker without direct access to Flowise to read arbitrary files from the Flowise server. As of time of publication, no known patches are available."}, {"lang": "es", "value": "Flowise es una interfaz de usuario de arrastrar y soltar para crear un flujo de modelo de lenguaje grande personalizado. En la versi\u00f3n 1.4.3 de Flowise, se produce una vulnerabilidad de cross-site scripting reflejado en el endpoint `/api/v1/credentials/id`. Si se utiliza la configuraci\u00f3n predeterminada (no autenticada), un atacante puede crear una URL especialmente manipulada que inyecta Javascript en las sesiones del usuario, lo que le permite robar informaci\u00f3n, crear ventanas emergentes falsas o incluso redirigir al usuario a otros sitios web sin interacci\u00f3n. Si no se encuentra el ID del flujo de chat, su valor se refleja en la p\u00e1gina 404, que tiene el tipo texto/html. Esto permite a un atacante adjuntar scripts arbitrarios a la p\u00e1gina, lo que le permite robar informaci\u00f3n confidencial. Este XSS puede encadenarse con la inyecci\u00f3n de ruta para permitir que un atacante sin acceso directo a Flowise lea archivos arbitrarios del servidor Flowise. Al momento de la publicaci\u00f3n, no hay parches conocidos disponibles."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:flowiseai:flowise:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.4.3", "matchCriteriaId": "DBDD4038-636B-45D5-9BFA-07AB0D236287"}]}]}], "references": [{"url": "https://github.com/FlowiseAI/Flowise/blob/flowise-ui%401.4.0/packages/server/src/index.ts#L545-L545", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://securitylab.github.com/advisories/GHSL-2023-232_GHSL-2023-234_Flowise/", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-37146 - This technique demonstrates an example of Reflected Cross-Site Scripting (XSS) which allows an attacker to inject arbitrary JavaScript code in the user's session, putting sensitive data at risk."}, {"techniqueID": "T1210", "comment": "CVE-2024-37146 - This technique shows that the vulnerability can be chained with a Path Traversal attack to allow an unauthenticated attacker to read arbitrary files from the Flowise server."}, {"techniqueID": "T1591", "comment": "CVE-2024-37146 - This technique highlights the ability of an attacker to inject scripts into the 404 page, allowing for arbitrary control over the user's session."}], "stix_bundle": {"@metadata": {"generated_on": "generated_on"}, "objects": [{"type": "indicator", "id": "CVE-2024-37146", "created_by_ref": "security-advisories@github.com", "modified": "2024-08-21T14:38:39.563", "created": "2024-07-01T19:15:04.070", "name": "Flowise Reflected Cross-Site Scripting Vulnerability (CVE-2024-37146)", "description": "Flowise Reflected Cross-Site Scripting Vulnerability (CVE-2024-37146)", "based_on": "https://nvd.nist.gov/vuln/detail/CVE-2024-37146", "type_of_option": "INDICATOR_TYPE_UNSPECIFIED", "objects": [{"type": "attack-pattern", "id": "CVE-2024-37146", "created_by_ref": "https://github.com/ FlowiseAI/Flowise/blob/flowise-ui@1.4.0/packages/server/src/index.ts#L545-L545", "name": "Flowise Reflected Cross-Site Scripting Vulnerability (CVE-2024-37146)", "description": "Flowise Reflected Cross-Site Scripting Vulnerability (CVE-2024-37146)", ".kill_chain_phase": "DEFENSE_EVACTION", " kill_chain_id": "https://docs.onap.org/attck/"}]}]}, "technical_analysis": {"Introduction": "Flowise Reflected Cross-Site Scripting Vulnerability (CVE-2024-37146) allows an unauthenticated attacker to inject arbitrary JavaScript code in the user's session, putting sensitive data at risk.", "Impact and Scope": "The vulnerability has a CVSS score of 6.1 with an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "T1190, T1210, T1591", "Technical Details": "The vulnerability occurs in the `/api/v1/credentials/id` endpoint in Flowise version 1.4.3.", "Detection": "Detection methods for this vulnerability include monitoring for suspicious JavaScript injection or unauthorized changes to user data.", "Mitigation": "Mitigation strategies include patching the vulnerability, disabling the vulnerable endpoint, or implementing a Web Application Firewall.", "Conclusion": "The Flowise Reflected Cross-Site Scripting Vulnerability (CVE-2024-37146) highlights the importance of secure coding practices and regular security testing in preventing web application vulnerabilities."}, "executive_analysis": {"Overview": "The Flowise Reflected Cross-Site Scripting Vulnerability (CVE-2024-37146) is a significant security risk that requires immediate attention.", "Business Impact": "This vulnerability has the potential to compromise sensitive business data and undermine trust in the Flowise platform.", "Technical Impact": "The vulnerability allows an unauthenticated attacker to inject arbitrary JavaScript code in the user's session, putting sensitive data at risk.", "Mitigation Strategies": "Patch the vulnerability, disable the vulnerable endpoint, or implement a Web Application Firewall.", "Recommendations": "Develop and implement secure coding practices, conduct regular security testing, and implement a robust incident response plan.", "Conclusions": "The Flowise Reflected Cross-Site Scripting Vulnerability (CVE-2024-37146) is a critical security risk that requires immediate attention. Implementing sound security practices and regular testing can help prevent similar vulnerabilities in the future."}}