{"id": "CVE-2023-5547", "sourceIdentifier": "patrick@puiterwijk.org", "published": "2023-11-09T20:15:10.210", "lastModified": "2023-11-15T14:18:41.997", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The course upload preview contained an XSS risk for users uploading unsafe data."}, {"lang": "es", "value": "La vista previa de la carga del curso conten\u00eda un riesgo XSS para los usuarios que cargaban datos no seguros."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "patrick@puiterwijk.org", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.3, "baseSeverity": "LOW"}, "exploitabilityScore": 1.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "patrick@puiterwijk.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.9.0", "versionEndExcluding": "3.9.24", "matchCriteriaId": "B4F617E2-A462-4502-895E-136F1ECA1DC4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.11.0", "versionEndExcluding": "3.11.17", "matchCriteriaId": "7C058D38-D206-4BEC-B647-4CD1808A1FC8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.0.11", "matchCriteriaId": "4827B277-0EC2-4254-B6DF-F18475A6253C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.1.0", "versionEndExcluding": "4.1.6", "matchCriteriaId": "E660C47C-2CB3-4B06-B98A-F8EE211F798A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.2.0", "versionEndExcluding": "4.2.3", "matchCriteriaId": "C65020B8-B78E-4B59-B894-3F223D769078"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:redhat:enterprise_linux:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "142AD0DD-4CF3-4D74-9442-459CE3347E3A"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:37:*:*:*:*:*:*:*", "matchCriteriaId": "E30D0E6F-4AE8-4284-8716-991DFA48CC5D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:38:*:*:*:*:*:*:*", "matchCriteriaId": "CC559B26-5DFC-4B7A-A27C-B77DE755DFF9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:39:*:*:*:*:*:*:*", "matchCriteriaId": "B8EDB836-4E6A-4B71-B9B2-AA3E03E0F646"}]}]}], "references": [{"url": "http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-79455", "source": "patrick@puiterwijk.org", "tags": ["Patch"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2243447", "source": "patrick@puiterwijk.org", "tags": ["Issue Tracking"]}, {"url": "https://moodle.org/mod/forum/discuss.php?d=451588", "source": "patrick@puiterwijk.org", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2023-5547 - This technique is relevant because it allows an attacker to upload and execute malicious code, potentially leading to remote code execution. Defending against this requires implementing proper input validation and sanitization, as well as limiting file uploads to trusted sources."}, {"techniqueID": "T1491", "comment": "This technique is relevant because it allows an attacker to inject malicious code into the system, potentially leading to escalation of privileges. Defending against this requires implementing proper access controls and limiting privileges to only necessary users and processes."}, {"techniqueID": "T1048", "comment": "This technique is relevant because it allows an attacker to inject malicious code into the system, potentially leading to data manipulation. Defending against this requires implementing proper data controls and validating all input data."}, {"techniqueID": "T1192", "comment": "This technique is relevant because it allows an attacker to upload and execute malicious code, potentially leading to remote code execution. Defending against this requires implementing proper input validation and sanitization, as well as limiting file uploads to trusted sources."}], "stix_bundle": {"$schema": "https://docs.oasis-open.org/soar/SOAR/SOAR.dtd", "type": "view", "id": "https://example.com/cve-2023-5547", "description": "STIX Bundle for CVE-2023-5547", "objects": [{"id": "https://example.com/cve-2023-5547", "type": "vulnerability", "name": "CVE-2023-5547: Moodle Course Upload XSS Vulnerability", "description": "The course upload preview contained an XSS risk for users uploading unsafe data.", "severity": "MEDIUM", "published": "2023-11-09T20:15:10.210", "modified": "2023-11-15T14:18:41.997", "cve": "CVE-2023-5547", "references": [{"id": "https://example.com/cve-2023-5547/ref-1", "type": "reference", "source": "patrick@puiterwijk.org", "tags": ["Patch"], "url": "http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-79455"}, {"id": "https://example.com/cve-2023-5547/ref-2", "type": "reference", "source": "patrick@puiterwijk.org", "tags": ["Issue Tracking"], "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2243447"}, {"id": "https://example.com/cve-2023-5547/ref-3", "type": "reference", "source": "patrick@puiterwijk.org", "tags": ["Patch"], "url": "https://moodle.org/mod/forum/discuss.php?d=451588"}], "relationships": [{"id": "https://example.com/cve-2023-5547/rel-1", "type": "related-to", "object_id": "https://example.com/technique/T1190", "label": "Exploits"}, {"id": "https://example.com/cve-2023-5547/rel-2", "type": "related-to", "object_id": "https://example.com/technique/T1491", "label": "Exploits"}, {"id": "https://example.com/cve-2023-5547/rel-3", "type": "related-to", "object_id": "https://example.com/technique/T1048", "label": "Exploits"}]}, {"id": "https://example.com/technique/T1190", "type": "technique", "name": "T1190: Exploit Public-Facing Application", "description": "The attacker attempts to exploit a public-facing application, such as a web server or email server, to gain access to the system or network."}, {"id": "https://example.com/technique/T1491: Implants Code", "type": "technique", "name": "T1491: Implants Code", "description": "The attacker injects code into the system, potentially to maintain access or further exploit the system."}, {"id": "https://example.com/technique/T1048: Software Component Discovery", "type": "technique", "name": "T1048: Software Component Discovery", "description": "The attacker discovers software components or technologies on the system, potentially to target vulnerabilities or exploit weaknesses."}]}, "technical_analysis": {"Introduction": "Moodle is a popular open-source learning management system that is vulnerable to a cross-site scripting (XSS) attack due to a vulnerability in the course upload preview.", "Impact and Scope": "The vulnerability allows an attacker to upload and execute malicious code, potentially leading to remote code execution, data manipulation, and escalation of privileges.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190, T1491, and T1048.", "Technical Details": "The vulnerability is due to insufficent input validation and sanitization of user-uploaded files, which allows an attacker to inject malicious code into the system.", "Detection": "Detection of this vulnerability requires monitoring for suspicious file uploads and analyzing network traffic for attempts to exploit the vulnerability.", "Mitigation": "Mitigating this vulnerability requires implementing proper input validation and sanitization of user-uploaded files, as well as limiting file uploads to trusted sources.", "Conclusion": "In summary, this vulnerability in Moodle allows an attacker to inject malicious code into the system, potentially leading to remote code execution, data manipulation, and escalation of privileges."}, "executive_analysis": {"Overview": "Moodle is a popular open-source learning management system that is vulnerable to a cross-site scripting (XSS) attack.", "Business Impact": "The impact of this vulnerability is significant, as it allows an attacker to inject malicious code into the system, potentially leading to data breaches, financial losses, and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is the potential for remote code execution, data manipulation, and escalation of privileges.", "Mitigation Strategies": "To mitigate this vulnerability, organizations should implement proper input validation and sanitization of user-uploaded files, as well as limit file uploads to trusted sources.", "Recommendations": "We recommend that organizations conduct a thorough risk assessment to determine the impact of this vulnerability on their specific systems and implement mitigation strategies accordingly.", "Conclusions": "In conclusion, the vulnerability in Moodle is a significant threat to the security of the system, and organizations should prioritize mitigation to avoid potential attacks."}}