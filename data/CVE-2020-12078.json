{"id": "CVE-2020-12078", "sourceIdentifier": "cve@mitre.org", "published": "2020-04-28T14:15:14.203", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered in Open-AudIT 3.3.1. There is shell metacharacter injection via attributes to an open-audit/configuration/ URI. An attacker can exploit this by adding an excluded IP address to the global discovery settings (internally called exclude_ip). This exclude_ip value is passed to the exec function in the discoveries_helper.php file (inside the all_ip_list function) without being filtered, which means that the attacker can provide a payload instead of a valid IP address."}, {"lang": "es", "value": "Se descubri\u00f3  un problema en Open-AudIT versi\u00f3n 3.3.1. Hay una inyecci\u00f3n de metacaracteres de shell por medio de atributos en un URI open-audit/configuration/. Un atacante puede explotar esto al agregar una direcci\u00f3n IP excluida en la configuraci\u00f3n de descubrimiento global (llamada internamente exclude_ip). Este valor exclude_ip es pasado a la funci\u00f3n exec en el archivo discoveries_helper.php (dentro de la funci\u00f3n all_ip_list) sin ser filtrado, lo que significa que el atacante puede proporcionar una carga \u00fatil en lugar de una direcci\u00f3n IP v\u00e1lida."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:opmantek:open-audit:3.3.1:*:*:*:*:*:*:*", "matchCriteriaId": "E7999860-701B-4389-AD71-48205DE04283"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/157477/Open-AudIT-Professional-3.3.1-Remote-Code-Execution.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://gist.github.com/mhaskar/dca62d0f0facc13f6364b8ed88d5a7fd", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/Opmantek/open-audit/commit/6ffc7f9032c55eaa1c37cf5e070809b7211c7e9a", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://shells.systems/open-audit-v3-3-1-remote-command-execution-cve-2020-12078/", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-12078 - This is a Command and Control (C2) server technique, which allows the attacker to execute arbitrary commands on the system. It's relevant because an attacker can exploit this vulnerability to remotely execute code and gain control over the system."}, {"techniqueID": "T1059", "comment": "CVE-2020-12078 - This is a Command Execution technique, which allows the attacker to execute arbitrary commands on the system. It's relevant because an attacker can exploit this vulnerability to execute arbitrary commands, leading to remote code execution and system compromise."}, {"techniqueID": "T1027", "comment": "CVE-2020-12078 - This is a Remote Service exploitation technique, which allows the attacker to exploit a remote service to gain access to the system. It's relevant because an attacker can exploit this vulnerability to remotely access the system and execute arbitrary code."}, {"techniqueID": "T1203", "comment": "CVE-2020-12078 - This is a Command Injection technique, which allows the attacker to inject arbitrary commands into a vulnerable system. It's relevant because an attacker can exploit this vulnerability to inject arbitrary commands and execute malicious code."}], "stix_bundle": {"_bundle": {"type": "software", "id": " opmantek:open-audit:3.3.1:*:*:*:*:*:*:*", "name": "Open-AudIT Professional 3.3.1", "description": "Open-AudIT Professional 3.3.1 is a software application", "labels": {"software": true}, "objects": [{"type": "vulnerability", "id": "CVE-2020-12078", "name": "Open-AudIT Professional 3.3.1 RCE", "description": "An issue was discovered in Open-AudIT 3.3.1. There is shell metacharacter injection via attributes to an open-audit/configuration/ URI. An attacker can exploit this by adding an excluded IP address to the global discovery settings (internally called exclude_ip). This exclude_ip value is passed to the exec function in the discoveries_helper.php file (inside the all_ip_list function) without being filtered, which means that the attacker can provide a payload instead of a valid IP address.", "labels": {"vulnerability": true}, "objects": [{"type": "network-traffic", "id": "network-traffic:CVE-2020-12078", "name": "Open-AudIT Professional 3.3.1 RCE traffic", "description": "Network traffic related to the Open-AudIT Professional 3.3.1 RCE vulnerability", "labels": {"network-traffic": true}, "connections": [{"relationship": "has-c2-server", "idRef": "opmantek:open-audit:3.3.1:*:*:*:*:*:*:*:T1190"}]}]}, {"type": "attack-pattern", "id": "T1190", "name": "Command and Control (C2) server", "description": "This attack pattern is used to establish a command and control (C2) server", "labels": {"attack-pattern": true}}], "relationships": [{"relationship": "targets", "idRef": " opmantek:open-audit:3.3.1:*:*:*:*:*:*:*"}]}}, "technical_analysis": {"Introduction": "This is a technical analysis of the Open-AudIT Professional 3.3.1 RCE vulnerability.", "Impact and Scope": "The impact of this vulnerability is remote code execution and system compromise, with a CVSS score of 8.8 and an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190, T1059, T1027, and T1203.", "Technical Details": "The vulnerability is caused by shell metacharacter injection via attributes to an open-audit/configuration/ URI, which allows an attacker to execute arbitrary code.", "Detection": "Detection methods include monitoring network traffic for suspicious patterns and analyzing system logs for unusual activity.", "Mitigation": " Mitigation strategies include applying secure coding practices and ensuring strict input validation and sanitization.", "Conclusion": "In conclusion, the Open-AudIT Professional 3.3.1 RCE vulnerability is a critical vulnerability that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The Open-AudIT Professional 3.3.1 RCE vulnerability is a security risk that requires immediate attention.", "Business Impact": "The business impact of this vulnerability is potentially severe, as it allows an attacker to gain control over the system and execute arbitrary code.", "Technical Impact": "The technical impact of this vulnerability is remote code execution and system compromise, which can lead to data breaches and other security incidents.", "Mitigation Strategies": "Mitigation strategies include applying secure coding practices, ensuring strict input validation and sanitization, and regularly updating software and systems.", "Recommendations": "We recommend that all Open-AudIT Professional 3.3.1 users take immediate action to remediate this vulnerability and implement additional security measures to prevent similar attacks in the future.", "Conclusions": "In conclusion, the Open-AudIT Professional 3.3.1 RCE vulnerability is a critical vulnerability that requires immediate attention and remediation, and we recommend that all users take immediate action to mitigate this risk."}}