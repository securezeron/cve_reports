{"id": "CVE-2024-3164", "sourceIdentifier": "security@dotcms.com", "published": "2024-04-01T22:15:22.507", "lastModified": "2024-07-26T14:15:02.560", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In dotCMS dashboard, the Tools and Log Files tabs under System \u2192 Maintenance Portlet, which is and always has been an Admin portlet, is accessible to anyone with that portlet and not just to CMS Admins. Users that get site admin but not a system admin, should not have access to the System Maintenance \u2192 Tools portlet. This would share database username and password under Log Files and download DB Dump and other dotCMS Content under Tools. Nothing in the System \u2192 Maintenance should be displayed for users with site admin role. Only system admins must have access to System Maintenance.\n\nOWASP Top 10 - A01) Broken Access Control\n\nOWASP Top 10 - A04) Insecure Design"}, {"lang": "es", "value": "En el panel de dotCMS, las pesta\u00f1as Tools y Log Files en System-&gt;Maintenance-&gt; Log Files, que es y siempre ha sido un portlet de administraci\u00f3n, son accesibles para cualquier persona con ese portlet y no solo para los administradores de CMS. Los usuarios que obtienen un administrador del sitio pero no un administrador del sistema no deber\u00edan tener acceso al portlet System Maintenance ? Tools. Esto compartir\u00eda el nombre de usuario y la contrase\u00f1a de la base de datos en Archivos de registro y descargar\u00eda DB Dump y otro contenido de dotCMS en Herramientas. No se debe mostrar nada en System ? Maintenance para los usuarios con funci\u00f3n de administrador del sitio. S\u00f3lo los administradores del sistema deben tener acceso al Mantenimiento del sistema. OWASP Top 10 - A01) Control de acceso roto OWASP Top 10 - A04) Dise\u00f1o inseguro"}], "metrics": {"cvssMetricV31": [{"source": "security@dotcms.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@dotcms.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-552"}]}], "references": [{"url": "https://github.com/dotCMS/core/issues/27909", "source": "security@dotcms.com"}, {"url": "https://github.com/dotCMS/core/pull/27912", "source": "security@dotcms.com"}, {"url": "https://www.dotcms.com/security/SI-69", "source": "security@dotcms.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-3164 - Broken Access Control: Unauthorized users can access sensitive data and functionality within the dotCMS dashboard."}, {"techniqueID": "T1534", "comment": "CVE-2024-3164 - Security Misconfiguration: Insecure design of the dotCMS dashboard allows unauthorized access to sensitive data and functionality."}, {"techniqueID": "T1078", "comment": "CVE-2024-3164 - Account Manipulation: Attacker can manipulate account privileges to gain unauthorized access to sensitive data and functionality within the dotCMS dashboard."}, {"techniqueID": "T1194", "comment": "CVE-2024-3164 - Content Injection: Attacker can inject malicious data into the dotCMS dashboard, potentially leading to unauthorized data access or disclosure."}], "stix_bundle": {"type": "bundle", "objects": [{"type": "attack-pattern", "id": "attacks/T1190/Broken_Access_Control", "name": "Broken Access Control", "description": "Attackers exploit broken access controls to gain unauthorized access to data, applications, or systems."}, {"type": "attack-pattern", "id": "attacks/T1534/Security_Misconfiguration", "name": "Security Misconfiguration", "description": "Attackers exploit insecure design or configuration of a system or application to gain unauthorized access or elevate privileges."}, {"type": "attack-pattern", "id": "attacks/T1078/Account_Manipulation", "name": "Account Manipulation", "description": "Attackers manipulate account privileges or credentials to gain unauthorized access or elevate privileges."}, {"type": "attack-pattern", "id": "attacks/T1194/Content_Injection", "name": "Content Injection", "description": "Attackers inject malicious data into a system or application to disrupt operations, steal data, or elevate privileges."}, {"type": "incident", "id": "incidents/CVE-2024-3164", "name": "CVE-2024-3164 - Broken Access Control", "description": "An incident was reported where an unauthorized user accessed sensitive data and functionality within the dotCMS dashboard."}, {"type": "indicator", "id": "indicators/regex-pattern", "name": "Regex Pattern", "description": "A regex pattern to detect and prevent unauthorized access to sensitive data and functionality within the dotCMS dashboard.", "pattern": "[^a-zA-Z0-9_/]"}, {"type": "indicator", "id": "indicators/http-request", "name": "HTTP Request", "description": "A HTTP request to detect and prevent unauthorized access to sensitive data and functionality within the dotCMS dashboard.", "pattern": "GET /dotCMS/system/maintenance/tools"}], "relationships": [{"id": "relation/CVE-2024-3164/T1190", "type": "exploits", "from": {"id": "attacks/T1190/Broken_Access_Control", "type": "attack-pattern"}, "to": {"id": "incidents/CVE-2024-3164", "type": "incident"}}, {"id": "relation/CVE-2024-3164/T1534", "type": "exploits", "from": {"id": "attacks/T1534/Security_Misconfiguration", "type": "attack-pattern"}, "to": {"id": "incidents/CVE-2024-3164", "type": "incident"}}, {"id": "relation/CVE-2024-3164/T1078", "type": "exploits", "from": {"id": "attacks/T1078/Account_Manipulation", "type": "attack-pattern"}, "to": {"id": "incidents/CVE-2024-3164", "type": "incident"}}, {"id": "relation/CVE-2024-3164/T1194", "type": "exploits", "from": {"id": "attacks/T1194/Content_Injection", "type": "attack-pattern"}, "to": {"id": "incidents/CVE-2024-3164", "type": "incident"}}, {"id": "relation/CVE-2024-3164/regex-pattern", "type": "detection", "from": {"id": "indicators/regex-pattern", "type": "indicator"}, "to": {"id": "incidents/CVE-2024-3164", "type": "incident"}}, {"id": "relation/CVE-2024-3164/http-request", "type": "detection", "from": {"id": "indicators/http-request", "type": "indicator"}, "to": {"id": "incidents/CVE-2024-3164", "type": "incident"}}]}, "technical_analysis": {"Introduction": "This report provides a technical analysis of the CVE-2024-3164 vulnerability, including its impact, scope, and remediation strategies.", "Impact and Scope": "The CVE-2024-3164 vulnerability allows unauthorized users to access sensitive data and functionality within the dotCMS dashboard, compromising the security and integrity of the system.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1190, T1534, T1078, and T1194.", "Technical Details": "The vulnerability is caused by a broken access control in the dotCMS dashboard, which allows unauthorized users to access sensitive data and functionality.", "Detection": "Network traffic analysis and application logging can be used to detect and prevent unauthorized access to the dotCMS dashboard.", "Mitigation": "Implementing role-based access control (RBAC) and secure design principles can mitigate the risk of this vulnerability.", "Conclusion": "In conclusion, the CVE-2024-3164 vulnerability is a critical security issue that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "This report provides a high-level overview of the CVE-2024-3164 vulnerability and its impact on the organization.", "Business Impact": "The vulnerability can compromise sensitive business data and compromise the reputation of the organization.", "Technical Impact": "The vulnerability can allow unauthorized users to access sensitive data and functionality within the dotCMS dashboard, compromising the security and integrity of the system.", "Mitigation Strategies": "Implementing role-based access control (RBAC) and secure design principles can mitigate the risk of this vulnerability.", "Recommendations": "The organization should prioritize the remediation of this vulnerability and implement additional security controls to prevent similar issues in the future.", "Conclusions": "In conclusion, the CVE-2024-3164 vulnerability is a critical security issue that requires immediate attention and remediation."}}