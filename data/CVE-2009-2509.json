{"id": "CVE-2009-2509", "sourceIdentifier": "secure@microsoft.com", "published": "2009-12-09T18:30:00.377", "lastModified": "2019-02-26T14:04:00.993", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Active Directory Federation Services (ADFS) in Microsoft Windows Server 2003 SP2 and Server 2008 Gold and SP2 does not properly validate headers in HTTP requests, which allows remote authenticated users to execute arbitrary code via a crafted request to an IIS web server, aka \"Remote Code Execution in ADFS Vulnerability.\""}, {"lang": "es", "value": "Active Directory Federation Services (ADFS) en Microsoft Windows Server 2003 SP2 y Server 2008 Gold y SP2 no valida adecuadamente las cabeceras en peticiones HTTP, lo que permite a atacantes remotos autenticados ejecutar c\u00f3digo de su elecci\u00f3n mediante una petici\u00f3n manipulada a un servidor web IIS. Tambi\u00e9n conocido como \"Vulnerabilidad de Ejecuci\u00f3n de C\u00f3digo Remoto en ADFS\"."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2003:*:sp2:*:*:*:*:*:*", "matchCriteriaId": "4D3B5E4F-56A6-4696-BBB4-19DF3613D020"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:*:*:x32:*:*:*:*:*", "matchCriteriaId": "9CFB1A97-8042-4497-A45D-C014B5E240AB"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:*:*:x64:*:*:*:*:*", "matchCriteriaId": "7F9C7616-658D-409D-8B53-AC00DC55602A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:*:sp2:x32:*:*:*:*:*", "matchCriteriaId": "B8A32637-65EC-42C4-A892-0E599562527C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:*:sp2:x64:*:*:*:*:*", "matchCriteriaId": "FFF81F4B-7D92-4398-8658-84530FB8F518"}]}]}], "references": [{"url": "http://www.us-cert.gov/cas/techalerts/TA09-342A.html", "source": "secure@microsoft.com", "tags": ["US Government Resource"]}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-070", "source": "secure@microsoft.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6441", "source": "secure@microsoft.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2009-2509 - This vulnerability allows remote authenticated users to execute arbitrary code via a crafted request to an IIS web server, aka Remote Code Execution in ADFS Vulnerability."}, {"techniqueID": "T1218", "comment": "CVE-2009-2509 - This vulnerability allows an attacker to craft a HTTP request to exploit the vulnerability, aka Remote Code Execution in ADFS Vulnerability."}, {"techniqueID": "T1497", "comment": "CVE-2009-2509 - This vulnerability can be exploited by an attacker to execute code on the affected system, aka Remote Code Execution in ADFS Vulnerability."}], "stix_bundle": {"id": "CVE-2009-2509", "type": "indicator", "spec_version": "2.1", "stix_core_components": {"incident": {"id": "incident-1", "type": "incident", "indicator": {"id_refs.id": "CVE-2009-2509"}}}, "tasks": {"task-1": {"type": "task", "relationship": "related_to", "target_ref": "incident-1", "technique": {"id": "T1190", "technique_type": "attack_pattern"}}}, "objects": {"object-1": {"type": "object", "name": "CVE-2009-2509", "description": "Active Directory Federation Services (ADFS) in Microsoft Windows Server 2003 SP2 and Server 2008 Gold and SP2 does not properly validate headers in HTTP requests, which allows remote authenticated users to execute arbitrary code via a crafted request to an IIS web server, aka 'Remote Code Execution in ADFS Vulnerability'.", "value": "CVE-2009-2509"}}, "notes": {"note-1": {"type": "note", "content": "This vulnerability affects Windows Server 2003 SP2 and Server 2008 Gold and SP2."}}}, "technical_analysis": {"Introduction": "The CVE-2009-2509 vulnerability is a remote code execution issue in Microsoft's Active Directory Federation Services (ADFS) affecting Windows Server 2003 SP2 and Server 2008 Gold and SP2.", "Impact and Scope": "The vulnerability can be exploited by remote authenticated users to execute arbitrary code, resulting in complete confidentiality, integrity, and availability Impact (CVSS v2 9.0, CVSS v3 9.0), making it a high-severity vulnerability.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to techniques T1190, T1218, and T1497, which are part of the Spearphishing Attacks, Web Application Exploitation, and Exploitation of Removable Storage techniques.", "Technical Details": "The vulnerability is caused by the lack of proper header validation in HTTP requests, which allows attackers to craft a request to exploit the vulnerability.", "Detection": "Detection can be performed by monitoring web traffic and HTTP requests for suspicious patterns and validating headers in HTTP requests.", "Mitigation": "Mitigation strategies include applying security patches, configuring ADFS to validate headers in HTTP requests, and implementing web application firewalls.", "Conclusion": "The CVE-2009-2509 vulnerability is a high-severity vulnerability that can be exploited to execute arbitrary code, and mitigation strategies should be implemented to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2009-2509 vulnerability affects Windows Server 2003 SP2 and Server 2008 Gold and SP2, making it a high-severity vulnerability.", "Business Impact": "Exploitation of this vulnerability can result in significant business disruption, financial loss, and reputational damage.", "Technical Impact": "The vulnerability affects the confidentiality, integrity, and availability of Windows Server 2003 SP2 and Server 2008 Gold and SP2.", "Mitigation Strategies": "Applying security patches, configuring ADFS to validate headers in HTTP requests, and implementing web application firewalls are recommended mitigation strategies.", "Recommendations": "All stakeholders should be notified of the vulnerability and mitigation strategies implemented to prevent exploitation.", "Conclusions": "The CVE-2009-2509 vulnerability is a high-severity vulnerability that requires immediate attention and mitigation."}}