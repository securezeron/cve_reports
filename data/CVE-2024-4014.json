{"id": "CVE-2024-4014", "sourceIdentifier": "security@wordfence.com", "published": "2024-04-20T10:15:56.670", "lastModified": "2024-04-22T13:28:43.747", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The hCaptcha for WordPress plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's cf7-hcaptcha shortcode in all versions up to, and including, 4.0.0 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page."}, {"lang": "es", "value": "El complemento hCaptcha for WordPress para WordPress es vulnerable a Cross-Site Scripting Almacenado a trav\u00e9s del c\u00f3digo corto cf7-hcaptcha del complemento en todas las versiones hasta la 4.0.0 incluida debido a una sanitizaci\u00f3n de entrada insuficiente y a un escape de salida en los atributos proporcionados por el usuario. Esto hace posible que atacantes autenticados, con acceso de nivel de colaborador y superior, inyecten scripts web arbitrarios en p\u00e1ginas que se ejecutar\u00e1n cada vez que un usuario acceda a una p\u00e1gina inyectada."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.1, "impactScore": 2.7}]}, "references": [{"url": "https://plugins.trac.wordpress.org/changeset/3072795/hcaptcha-for-forms-and-more/tags/4.0.1/src/php/CF7/CF7.php", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/5ce70e87-6dee-4d4a-b2fc-93fd4d50957d?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-4014 - Stored Cross-Site Scripting (XSS) vulnerability in the hCaptcha for WordPress plugin allows authenticated attackers to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page."}, {"techniqueID": "T1027", "comment": "CVE-2024-4014 - Insufficient input sanitization and output escaping in the cf7-hcaptcha shortcode of the hCaptcha for WordPress plugin allows attackers to inject malicious scripts and potentially launch attacks such as phishing, malware distribution, and data exfiltration."}], "stix_bundle": {"objects": [{"id": "vulnerability:CVE-2024-4014", "type": "vulnerability", "description": "Stored Cross-Site Scripting (XSS) vulnerability in the hCaptcha for WordPress plugin allows authenticated attackers to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.", "created_by_ref": {"idref": "organization:wordfence"}}, {"id": "attack-pattern:T1190", "type": "attack-pattern", "description": "Stored Cross-Site Scripting (XSS) is a type of web-based attack where an attacker injects malicious script into a vulnerable web application, allowing for the theft of sensitive data, injection of malware, or other malicious activities.", "created_by_ref": {"idref": "organization:mitre"}}, {"id": "attack-pattern:T1027", "type": "attack-pattern", "description": "Injection is a type of attack where an attacker injects malicious data, such as scripts, into a vulnerable application, allowing for the theft of sensitive data, injection of malware, or other malicious activities.", "created_by_ref": {"idref": "organization:mitre"}}, {"id": "course-of-action: mitigate-stored-xss", "type": "course-of-action", "description": "Mitigate the Stored XSS vulnerability in the hCaptcha for WordPress plugin by updating the plugin to the latest version or disabling the cf7-hcaptcha shortcode.", "recommended_by_ref": {"idref": "organization:mitre"}, "related_to_refs": [{"idref": "attack-pattern:T1190"}]}, {"id": "indicator:cf7-hcaptcha-shortcode", "type": "indicator", "description": "Look for the cf7-hcaptcha shortcode in the plugin's code as it is used to inject the malicious script.", "observed_data": "cf7-hcaptcha shortcode", "pattern": "cf7-hcaptcha.*"}], "relationships": [{"type": "vulnerability", "id": "vulnerability:CVE-2024-4014", "underlies": [{"id": "indicator:cf7-hcaptcha-shortcode"}]}, {"type": "attack-pattern", "id": "attack-pattern:T1190", "uses": [{"id": "vulnerability:CVE-2024-4014"}]}, {"type": "attack-pattern", "id": "attack-pattern:T1027", "uses": [{"id": "vulnerability:CVE-2024-4014"}]}, {"type": "course-of-action", "id": "course-of-action: mitigate-stored-xss", "mitigates": [{"id": "attack-pattern:T1190"}]}]}, "technical_analysis": {"Introduction": "The Stored XSS vulnerability in the hCaptcha for WordPress plugin allows authenticated attackers to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.", "Impact and Scope": "The vulnerability has a CVSS v3.1 score of 6.4 with a low attack vector, meaning it is possible to exploit the vulnerability with a low level of expertise and minimal resources.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the MITRE ATT&CK techniques T1190 and T1027, which involve the use of Stored XSS to inject malicious scripts and potentially launch attacks such as phishing, malware distribution, and data exfiltration.", "Technical Details": "The vulnerability is caused by insufficient input sanitization and output escaping in the cf7-hcaptcha shortcode of the hCaptcha for WordPress plugin.", "Detection": "The vulnerability can be detected by looking for the cf7-hcaptcha shortcode in the plugin's code and verifying that the plugin is up-to-date.", "Mitigation": "The vulnerability can be mitigated by updating the plugin to the latest version or disabling the cf7-hcaptcha shortcode.", "Conclusion": "The Stored XSS vulnerability in the hCaptcha for WordPress plugin poses a moderate risk to users, and immediate action should be taken to mitigate the vulnerability."}, "executive_analysis": {"Overview": "The Stored XSS vulnerability in the hCaptcha for WordPress plugin is a reminder of the importance of keeping software up-to-date and verified to prevent potential attacks.", "Business Impact": "The vulnerability has the potential to impact business operations by allowing attackers to inject malicious scripts and potentially launch attacks such as phishing, malware distribution, and data exfiltration.", "Technical Impact": "The vulnerability is a technical issue that requires immediate attention to prevent potential attacks.", "Mitigation Strategies": "The vulnerability can be mitigated by updating the plugin to the latest version or disabling the cf7-hcaptcha shortcode.", "Recommendations": "It is recommended that users update the plugin to the latest version or disable the cf7-hcaptcha shortcode to prevent potential attacks.", "Conclusions": "Immediate action should be taken to mitigate the Stored XSS vulnerability in the hCaptcha for WordPress plugin to prevent potential attacks."}}