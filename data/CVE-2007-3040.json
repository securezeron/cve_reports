{"id": "CVE-2007-3040", "sourceIdentifier": "secure@microsoft.com", "published": "2007-09-12T01:17:00.000", "lastModified": "2018-10-16T16:47:07.073", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Stack-based buffer overflow in agentdpv.dll 2.0.0.3425 in Microsoft Agent on Windows 2000 SP4 allows remote attackers to execute arbitrary code via a crafted URL to the Agent (Agent.Control) ActiveX control, which triggers an overflow within the Agent Service (agentsrv.exe) process, a different issue than CVE-2007-1205."}, {"lang": "es", "value": "Un desbordamiento de b\u00fafer en la regi\u00f3n stack de la memoria en la biblioteca agentdpv.dll versi\u00f3n 2.0.0.3425 en Microsoft Agent en Windows 2000 SP4, permite a los atacantes remoto ejecutar c\u00f3digo arbitrarios por medio  de una URL creada para el control ActiveX del Agente (Agent.Control), que activa un desbordamiento dentro del proceso Agent Service (agentsrv.exe), un problema diferente del CVE-2007-1205."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.3}, "baseSeverity": "HIGH", "exploitabilityScore": 8.6, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_2000:*:sp4:*:*:*:*:*:*", "matchCriteriaId": "83E7C4A0-78CF-4B56-82BF-EC932BDD8ADF"}]}]}], "references": [{"url": "http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=592", "source": "secure@microsoft.com"}, {"url": "http://secunia.com/advisories/26753", "source": "secure@microsoft.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://securityreason.com/securityalert/3124", "source": "secure@microsoft.com"}, {"url": "http://securitytracker.com/id?1018677", "source": "secure@microsoft.com"}, {"url": "http://www.kb.cert.org/vuls/id/716872", "source": "secure@microsoft.com", "tags": ["US Government Resource"]}, {"url": "http://www.osvdb.org/36934", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/archive/1/479096/100/0/threaded", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/bid/25566", "source": "secure@microsoft.com"}, {"url": "http://www.us-cert.gov/cas/techalerts/TA07-254A.html", "source": "secure@microsoft.com", "tags": ["US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2007/3113", "source": "secure@microsoft.com", "tags": ["Vendor Advisory"]}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2007/ms07-051", "source": "secure@microsoft.com"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/35752", "source": "secure@microsoft.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A2116", "source": "secure@microsoft.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2007-3040 - A stack-based buffer overflow in agentdpv.dll can allow remote code execution. This technique is relevant to detect and prevent similar buffer overflow attacks."}, {"techniqueID": "T1077", "comment": "CVE-2007-3040 - Remote code execution via a crafted URL to the Agent Control ActiveX control is a common tactic used by attackers. This technique is relevant to detect and prevent similar types of attacks."}, {"techniqueID": "T1273", "comment": "CVE-2007-3040 - The exploitation of a buffer overflow vulnerability in a Windows Service (agentsrv.exe) process is a common method used by attackers to execute arbitrary code. This technique is relevant to detect and prevent similar types of attacks."}], "stix_bundle": {"packages": [{"id": "vulnerability:cve-2007-3040", "title": "Stack-Based Buffer Overflow Vulnerability in Microsoft Agent", "description": "A stack-based buffer overflow vulnerability exists in Microsoft Agent.", "objects": [{"id": "indicator-1", "type": "indicator", "name": "Microsoft Agent Stack-Based Buffer Overflow", "description": "An indication of compromise related to the Microsoft Agent Stack-Based Buffer Overflow vulnerability.", "pattern": "The Microsoft Agent Stack-Based Buffer Overflow vulnerability was exploited."}, {"id": "course-of-action-1", "type": "course-of-action", "name": "Apply Patch MS07-051", "description": "Apply Patch MS07-051 to resolve the Stack-Based Buffer Overflow vulnerability in Microsoft Agent.", "related_techniques": ["T1190"]}, {"id": "note-1", "type": "note", "name": "Default Denial-of-Service Protection", "description": "Default Denial-of-Service protection can be enabled to prevent network-based attacks.", "related_techniques": ["T1077"]}, {"id": "course-of-action-2", "type": "course-of-action", "name": "Update to Microsoft Agent 2.0.0.3433", "description": "Update to Microsoft Agent 2.0.0.3433 to resolve the Stack-Based Buffer Overflow vulnerability.", "related_techniques": ["T1273"]}], "objectsRelationships": [{"relationship": "indication-of-compromise", "source": "indicator-1", "target": "vulnerability:cve-2007-3040"}, {"relationship": "mitigated-by", "source": "course-of-action-1", "target": "vulnerability:cve-2007-3040"}, {"relationship": "notes", "source": "note-1", "target": "vulnerability:cve-2007-3040"}, {"relationship": "mitigated-by", "source": "course-of-action-2", "target": "vulnerability:cve-2007-3040"}]}]}, "technical_analysis": {"Introduction": "The CVE-2007-3040 vulnerability is a stack-based buffer overflow in Microsoft Agent that allows remote code execution.", "Impact and Scope": "This vulnerability has a CVSS score of 9.3 with a medium-high impact. It allows attackers to execute arbitrary code and could potentially lead to a complete compromise of the system.", "Related MITRE ATT&CK Techniques": "T1190, T1077, and T1273", "Technical Details": "The vulnerability occurs when the Microsoft Agent ActiveX control is triggered with a crafted URL. It causes a stack-based buffer overflow in the agentsrv.exe process.", "Detection": "signature-based detection, behavioral detection", "Mitigation": "apply patch, restrict access to the Microsoft Agent ActiveX control, configure default Denial-of-Service protection", "Conclusion": "The CVE-2007-3040 vulnerability is a serious threat to the security of Microsoft Agent systems. It is essential to apply the patch and take measures to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2007-3040 vulnerability is a critical vulnerability in Microsoft Agent that allows remote code execution.", "Business Impact": "This vulnerability could lead to a complete compromise of the system, resulting in data loss, financial loss, and reputational damage.", "Technical Impact": "The exploitation of this vulnerability could result in Arbitrary Code Execution, allowing attackers to perform malicious activities on the system.", "Mitigation Strategies": "Apply the patch, restrict access to the Microsoft Agent ActiveX control, configure default Denial-of-Service protection.", "Recommendations": "Implement a comprehensive vulnerability management program, conduct regular security audits, and educate users on secure practices.", "Conclusions": "The CVE-2007-3040 vulnerability is a serious threat to the security of Microsoft Agent systems. It is essential to take immediate action to mitigate the risk of exploitation."}}