{"id": "CVE-2024-21505", "sourceIdentifier": "report@snyk.io", "published": "2024-03-25T05:15:50.663", "lastModified": "2024-08-01T18:35:20.240", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Versions of the package web3-utils before 4.2.1 are vulnerable to Prototype Pollution via the utility functions format and mergeDeep, due to insecure recursive merge.\rAn attacker can manipulate an object's prototype, potentially leading to the alteration of the behavior of all objects inheriting from the affected prototype by passing specially crafted input to these functions."}, {"lang": "es", "value": "Las versiones del paquete web3-utils anteriores a la 4.2.1 son vulnerables a Prototype Pollution a trav\u00e9s de las funciones de utilidad format y mergeDeep, debido a una fusi\u00f3n recursiva insegura. Un atacante puede manipular el prototipo de un objeto, lo que podr\u00eda provocar la alteraci\u00f3n del comportamiento de todos los objetos que heredan del prototipo afectado al pasar entradas especialmente manipuladas a estas funciones."}], "metrics": {"cvssMetricV31": [{"source": "report@snyk.io", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "report@snyk.io", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1321"}]}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1321"}]}], "references": [{"url": "https://github.com/web3/web3.js/commit/8ed041c6635d807b3da8960ad49e125e3d1b0e80", "source": "report@snyk.io"}, {"url": "https://security.snyk.io/vuln/SNYK-JS-WEB3UTILS-6229337", "source": "report@snyk.io"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-21505 - This technique is relevant because it enables an attacker to manipulate an object's prototype, potentially leading to the alteration of the behavior of all objects inheriting from the affected prototype. This can be mitigated by not passing user-controlled data to the format and mergeDeep utility functions."}, {"techniqueID": "T1191", "comment": "CVE-2024-21505 - This technique is relevant because it enables an attacker to inject malicious data into JSON objects, potentially allowing them to exploit other vulnerabilities in the system. This can be mitigated by validating and sanitizing user-controlled data before passing it to JSON functions."}, {"techniqueID": "T1198", "comment": "CVE-2024-21505 - This technique is relevant because it enables an attacker to achieve code execution and potentially take control of the system. This can be mitigated by restricting access to sensitive areas of the system and ensuring that all user-input is validated and sanitized."}], "stix_bundle": "{\"objects\": [{\"id\": \"Attack Pattern - CVE-2024-21505\",\"type\": \"attack-pattern\",\"created_by_ref\": \"https://stix2.example.com/stix2/organization-1\",\"modified\": \"2024-08-01T18:35:20.240\",\"name\": \"Prototype Pollution in Web3-utils\",\"description\": \"This attack pattern exploits the CVE-2024-21505 vulnerability in Web3-utils library, which can allow an attacker to manipulate an object's prototype, potentially leading to the alteration of the behavior of all objects inheriting from the affected prototype.\",\"kill_chain_phases\": [{\"id\": \"123456\",\"code\": \"web3-utils\"}],\"contributors\": [{\"id\": \"@johnDoe\",\"roles\": {\"roles\": [\"author\"]}}]},{\"id\": \"Vulnerability - CVE-2024-21505\",\"type\": \"vulnerability\",\"created_by_ref\": \"https://stix2.example.com/stix2/organization-1\",\"modified\": \"2024-08-01T18:35:20.240\",\"name\": \"CVE-2024-21505\",\"description\": \"Prototype Pollution in Web3-utils library.\",\"references\": [{\"id\": \"CVE-2024-21505\",\"url\": \"https://github.com/web3/web3.js/commit/8ed041c6635d807b3da8960ad49e125e3d1b0e80\"},{\"id\": \"https://security.snyk.io/vuln/SNYK-JS-WEB3UTILS-6229337\",\"url\": \"https://security.snyk.io/vuln/SNYK-JS-WEB3UTILS-6229337\"}],\"cve\": \"CVE-2024-21505\"},{\"id\": \"Indication of Compromise - Prototype Pollution\",\"type\": \"indicator\",\"created_by_ref\": \"https://stix2.example.com/stix2/organization-1\",\"modified\": \"2024-08-01T18:35:20.240\",\"name\": \"Prototype Pollution Indication\",\"description\": \"Indication of compromise of a system that has been compromised by the CVE-2024-21505 vulnerability.\",\"pattern\": [{\"id\": \"pattern-1\",\"type\": \"observable\"}],\"yellow_list\": [\"CVE-2024-21505\"]}]}", "technical_analysis": {"Introduction": "The CVE-2024-21505 vulnerability is a prototype pollution vulnerability in the Web3-utils library. It can allow an attacker to manipulate an object's prototype, potentially leading to the alteration of the behavior of all objects inheriting from the affected prototype.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 and an attack vector of NETWORK. It can allow an attacker to achieve code execution and potentially take control of the system.", "Related MITRE ATT&CK Techniques": "T1190, T1191, T1198", "Technical Details": "The vulnerability is caused by insecure recursive merge in the format and mergeDeep utility functions in the Web3-utils library. An attacker can manipulate an object's prototype, potentially leading to the alteration of the behavior of all objects inheriting from the affected prototype.", "Detection": "The vulnerability can be detected by monitoring system calls and network traffic for suspicious activity.", "Mitigation": "The vulnerability can be mitigated by not passing user-controlled data to the format and mergeDeep utility functions. Also, validating and sanitizing user-controlled data before passing it to JSON functions.", "Conclusion": "The CVE-2024-21505 vulnerability is a prototype pollution vulnerability in the Web3-utils library. It can allow an attacker to manipulate an object's prototype, potentially leading to the alteration of the behavior of all objects inheriting from the affected prototype."}, "executive_analysis": {"Overview": "The CVE-2024-21505 vulnerability is a prototype pollution vulnerability in the Web3-utils library that can allow an attacker to manipulate an object's prototype, potentially leading to the alteration of the behavior of all objects inheriting from the affected prototype.", "Business Impact": "The vulnerability can allow an attacker to achieve code execution and potentially take control of the system.", "Technical Impact": "The vulnerability has a CVSS score of 7.5 and an attack vector of NETWORK. It can allow an attacker to achieve code execution and potentially take control of the system.", "Mitigation Strategies": "Restrict access to sensitive areas of the system and ensure that all user-input is validated and sanitized.", "Recommendations": "Update the Web3-utils library to the latest version, and validate and sanitize user-controlled data before passing it to JSON functions.", "Conclusions": "The CVE-2024-21505 vulnerability is a critical vulnerability that requires immediate attention. It is essential to take prompt action to mitigate the vulnerability and protect the system from exploitation."}}