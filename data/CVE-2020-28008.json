{"id": "CVE-2020-28008", "sourceIdentifier": "cve@mitre.org", "published": "2021-05-06T13:15:09.287", "lastModified": "2021-05-10T20:17:54.690", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Exim 4 before 4.94.2 allows Execution with Unnecessary Privileges. Because Exim operates as root in the spool directory (owned by a non-root user), an attacker can write to a /var/spool/exim4/input spool header file, in which a crafted recipient address can indirectly lead to command execution."}, {"lang": "es", "value": "Exim 4 versiones anteriores a 4.94.2, permite una ejecuci\u00f3n con Privilegios Innecesarios.&#xa0;Debido a que Exim opera como root en el directorio spool (propiedad para un usuario no root), un atacante puede escribir en un archivo de encabezado spool /var/spool/exim4/input, en el que una direcci\u00f3n de destinatario dise\u00f1ada puede conllevar indirectamente a una ejecuci\u00f3n de comando"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-269"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:exim:exim:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.00", "versionEndExcluding": "4.94.2", "matchCriteriaId": "E0B1EAB0-1202-4BB9-94AF-CC07299D0256"}]}]}], "references": [{"url": "https://www.exim.org/static/doc/security/CVE-2020-qualys/CVE-2020-28008-SPDIR.txt", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-28008 - Exim Code Execution vulnerability allowing attackers to write to the spool directory, leading to command execution. Defend against this by restricting access to the spool directory and scanning for suspicious activity."}, {"techniqueID": "T1077", "comment": "CVE-2020-28008 - The Exim vulnerability can be exploited to execute code with unnecessary privileges. Defend against this by regularly updating Exim and monitoring system logs for suspicious activity."}, {"techniqueID": "T1191", "comment": "CVE-2020-28008 - The vulnerability can be exploited to create a new file in the spool directory, allowing an attacker to create a backdoor. Defend against this by monitoring the spool directory for new files and scanning for suspicious activity."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "CVE-2020-28008-indicator", "created_by_ref": "Me", "created": "2021-06-01T14:00:00.000", "modified": "2021-06-01T14:00:00.000", "title": "Exim 4 Code Execution Vulnerability", "description": "Exim 4 code execution vulnerability allowing attackers to write to the spool directory, leading to command execution.", "name": "Exim 4 Code Execution Vulnerability Indicator", "severity": "high", "url": "https://www.exim.org/static/doc/security/CVE-2020-qualys/CVE-2020-28008-SPDIR.txt", "labels": ["cve-2020-28008", "exim-4", "code-execution"], "objects": [{"type": "identity", "id": "exim-4-identity", "name": "Exim 4"}]}, {"type": "attack-pattern", "id": "T1190-attack-pattern", "created_by_ref": "Me", "created": "2021-06-01T14:00:00.000", "modified": "2021-06-01T14:00:00.000", "title": "Exim Code Execution", "description": "Exim code execution attack pattern, exploiting the Exim 4 code execution vulnerability.", "name": "Exim Code Execution Attack Pattern", "labels": ["t1190", "cve-2020-28008", "exim-4", "code-execution"]}, {"type": "course-of-action", "id": "exim-4-coa", "created_by_ref": "Me", "created": "2021-06-01T14:00:00.000", "modified": "2021-06-01T14:00:00.000", "title": "Defend against Exim 4 Code Execution Vulnerability", "description": "Defend against the Exim 4 code execution vulnerability by restricting access to the spool directory and scanning for suspicious activity.", "name": "Exim 4 Code Execution Defense Guide", "labels": ["cve-2020-28008", "exim-4", "code-execution", "defense"]}]}, "technical_analysis": {"Introduction": "The Exim 4 code execution vulnerability, identified as CVE-2020-28008, allows attackers to write to the spool directory, leading to command execution. This vulnerability affects Exim 4 versions prior to 4.94.2.", "Impact and Scope": "The vulnerability has a CVSS score of 7.8 (AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H) and is rated as HIGH.", "Related MITRE ATT&CK Techniques": "T1190, T1077, T1191", "Technical Details": "The vulnerability is caused by Exim operating as root in the spool directory, allowing attackers to write to a spool header file that can indirectly lead to command execution.", "Detection": "Monitor system logs for suspicious activity, such as unusual writes to the spool directory.", "Mitigation": "Restrict access to the spool directory, regularly update Exim, and monitor system logs for suspicious activity.", "Conclusion": "The Exim 4 code execution vulnerability is a significant threat to system security. Defenders must prioritize patching and monitoring to prevent exploitation."}, "executive_analysis": {"Overview": "The Exim 4 code execution vulnerability is a high-severity vulnerability that allows attackers to execute code with unnecessary privileges.", "Business Impact": "The vulnerability can lead to data theft, system compromise, and business disruption.", "Technical Impact": "The vulnerability can be exploited to create a backdoor, allowing attackers to access the system.", "Mitigation Strategies": "Prioritize patching and monitoring, restrict access to the spool directory, and regularly update Exim.", "Recommendations": "Implement the recommended mitigation strategies and consider conducting a vulnerability assessment to identify other potential vulnerabilities.", "Conclusions": "The Exim 4 code execution vulnerability is a serious threat to system security. Executives must prioritize remediation and ensure that IT teams are equipped to respond effectively."}}