{"id": "CVE-2024-28183", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-25T15:15:52.183", "lastModified": "2024-03-25T16:43:06.137", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "ESP-IDF is the development framework for Espressif SoCs supported on Windows, Linux and macOS. A Time-of-Check to Time-of-Use (TOCTOU) vulnerability was discovered in the implementation of the ESP-IDF bootloader which could allow an attacker with physical access to flash of the device to bypass anti-rollback protection. Anti-rollback prevents rollback to application with security version lower than one programmed in eFuse of chip. This attack can allow to boot past (passive) application partition having lower security version of the same device even in the presence of the flash encryption scheme. The attack requires carefully modifying the flash contents after the anti-rollback checks have been performed by the bootloader (before loading the application). The vulnerability is fixed in 4.4.7 and 5.2.1."}, {"lang": "es", "value": "ESP-IDF es el framework de desarrollo para los SoC de Espressif compatibles con Windows, Linux y macOS. Se descubri\u00f3 una vulnerabilidad de tiempo de verificaci\u00f3n a tiempo de uso (TOCTOU) en la implementaci\u00f3n del gestor de arranque ESP-IDF que podr\u00eda permitir a un atacante con acceso f\u00edsico a la memoria flash del dispositivo eludir la protecci\u00f3n anti-retroceso. Anti-rollback evita el retroceso a una aplicaci\u00f3n con una versi\u00f3n de seguridad inferior a la programada en eFuse del chip. Este ataque puede permitir arrancar m\u00e1s all\u00e1 de la partici\u00f3n de la aplicaci\u00f3n (pasiva) que tiene una versi\u00f3n de menor seguridad del mismo dispositivo, incluso en presencia del esquema de cifrado flash. El ataque requiere modificar cuidadosamente el contenido flash despu\u00e9s de que el gestor de arranque haya realizado las comprobaciones anti-retroceso (antes de cargar la aplicaci\u00f3n). La vulnerabilidad se solucion\u00f3 en 4.4.7 y 5.2.1."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "PHYSICAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-367"}]}], "references": [{"url": "https://github.com/espressif/esp-idf/commit/3305cb4d235182067936f8e940e6db174e25b4b2", "source": "security-advisories@github.com"}, {"url": "https://github.com/espressif/esp-idf/commit/4c95aa445d4e84f01f86b6f3a552aa299276abf3", "source": "security-advisories@github.com"}, {"url": "https://github.com/espressif/esp-idf/commit/534e3ad1fa68526a5f989fb2163856d6b7cd2c87", "source": "security-advisories@github.com"}, {"url": "https://github.com/espressif/esp-idf/commit/7003f1ef0dffc73c34eb153d1b0710babb078149", "source": "security-advisories@github.com"}, {"url": "https://github.com/espressif/esp-idf/commit/b2cdc0678965790f49afeb6e6b0737cd24433a05", "source": "security-advisories@github.com"}, {"url": "https://github.com/espressif/esp-idf/commit/c33b9e1426121ce8cccf1a94241740be9cff68de", "source": "security-advisories@github.com"}, {"url": "https://github.com/espressif/esp-idf/commit/f327ddf6adab0c28d395975785727b2feef57803", "source": "security-advisories@github.com"}, {"url": "https://github.com/espressif/esp-idf/security/advisories/GHSA-22x6-3756-pfp8", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1204.001", "comment": "CVE-2024-28183 - This TOCTOU vulnerability can be exploited by an attacker to bypass anti-rollback protection, allowing them to boot a lower security version of the device application, potentially leading to code execution and data extraction. Defend against this by validating flash contents before loading the application."}, {"techniqueID": "T1499.003", "comment": "CVE-2024-28183 - The vulnerability can be exploited by an attacker to modify the flash contents to bypass anti-rollback protection, resulting in code execution and data extraction. Defend against this by implementing flash encryption and verifying flash contents before loading the application."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle--3a44f03d-7f3e-443a-971b-a8e7bad1ca26", "objects": [{"type": "malware", "id": "malware--6d5e3b32-7d6d-4a6c-9e57-36c6a53f2e55", "name": "TOCTOU Flash Vulnerability", "description": "TOCTOU flash vulnerability in ESP-IDF bootloader allowing bypass of anti-rollback protection", "created_by_ref": "identity--1", "created": "2024-03-25T15:15:52.183", "modified": "2024-03-25T16:43:06.137", "labels": ["esp-idf-vulnerability", "toctou-flash-vulnerability"]}, {"type": "vulnerability", "id": "vulnerability--5e1f3b2a-c35b-4e43-bc6c-45f454e47a5a", "name": "CVE-2024-28183", "description": "TOCTOU flash vulnerability in ESP-IDF bootloader allowing bypass of anti-rollback protection", "exploitability_score": 0.9, "impact_score": 5.2, "cvss_score": {"version": "3.1", "vectorString": "CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N"}, "created_by_ref": "identity--1", "created": "2024-03-25T15:15:52.183", "modified": "2024-03-25T16:43:06.137"}, {"type": "course-of-action", "id": "course-of-action--2a4eb3f1-18e1-416a-a2ea-53e8cc83fb9a", "name": "Mitigation", "description": "Implement flash encryption and verify flash contents before loading the application", "created_by_ref": "identity--1", "created": "2024-03-25T15:15:52.183", "modified": "2024-03-25T16:43:06.137", "related techniques": ["T1204.001", "T1499.003"], "notes": ["Implement flash encryption", "Verify flash contents before loading the application"]}], "relationships": [{"type": "has", "id": "has--7a48a94d-ee51-455c-9a62-c1a8dae6aedd", "from": "bundle--3a44f03d-7f3e-443a-971b-a8e7bad1ca26", "to": "malware--6d5e3b32-7d6d-4a6c-9e57-36c6a53f2e55", "label": "has_vulnerability"}, {"type": "has", "id": "has--f4c6a76c-7a36-4db9-93a5-5c4a56ebce35", "from": "bundle--3a44f03d-7f3e-443a-971b-a8e7bad1ca26", "to": "vulnerability--5e1f3b2a-c35b-4e43-bc6c-45f454e47a5a", "label": "has_vulnerability"}, {"type": "applies-to", "id": "applies-to--13d0c355-cf74-45d3-b48b-5c48a9f5a58e", "from": "bundle--3a44f03d-7f3e-443a-971b-a8e7bad1ca26", "to": "course-of-action--2a4eb3f1-18e1-416a-a2ea-53e8cc83fb9a", "label": "applies_to_vulnerability"}]}, "technical_analysis": {"Introduction": "The TOCTOU flash vulnerability in ESP-IDF bootloader allows an attacker to bypass anti-rollback protection and boot a lower security version of the device application, potentially leading to code execution and data extraction.", "Impact and Scope": "The vulnerability has a CVSS score of 6.1 (Medium) and an exploitability score of 0.9. The attack vector is PHYSICAL, and the scope is UNCHANGED.", "Related MITRE ATT&CK Techniques": "T1204.001: Execution Flow or Individual Instructions, T1499.003: BIOS Boot Process", "Technical Details": "The vulnerability is caused by the TOCTOU flash vulnerability in the ESP-IDF bootloader, which allows an attacker to bypass anti-rollback protection.", "Detection": "The vulnerability can be detected by analyzing the flash contents before loading the application.", "Mitigation": "Implement flash encryption and verify flash contents before loading the application.", "Conclusion": "In conclusion, the TOCTOU flash vulnerability in ESP-IDF bootloader is a serious vulnerability that can allow an attacker to bypass anti-rollback protection and boot a lower security version of the device application. Implementing flash encryption and verifying flash contents before loading the application is the recommended mitigation strategy."}, "executive_analysis": {"Overview": "The TOCTOU flash vulnerability in ESP-IDF bootloader is a serious vulnerability that can allow an attacker to bypass anti-rollback protection and boot a lower security version of the device application.", "Business Impact": "The vulnerability can lead to significant business impact, including loss of intellectual property, data breaches, and reputational damage.", "Technical Impact": "The vulnerability has a significant technical impact, including the potential for code execution and data extraction.", "Mitigation Strategies": "Implement flash encryption and verify flash contents before loading the application.", "Recommendations": "Recommendations for executives include prioritizing the fix of the vulnerability, updating the firmware, and implementing additional security measures.", "Conclusions": "In conclusion, the TOCTOU flash vulnerability in ESP-IDF bootloader is a serious vulnerability that requires immediate attention and mitigation. Implementing flash encryption and verifying flash contents before loading the application is the recommended mitigation strategy."}}