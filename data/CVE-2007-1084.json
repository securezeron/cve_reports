{"id": "CVE-2007-1084", "sourceIdentifier": "cve@mitre.org", "published": "2007-02-23T02:28:00.000", "lastModified": "2018-10-16T16:36:35.047", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Mozilla Firefox 2.0.0.1 and earlier does not prompt users before saving bookmarklets, which allows remote attackers to bypass the same-domain policy by tricking a user into saving a bookmarklet with a data: scheme, which is executed in the context of the last visited web page."}, {"lang": "es", "value": "Mozilla Firefox versi\u00f3n 2.0.0.1 y anteriores, no sugiere a los usuarios antes de guardar un bookmarklets, lo que permite a los atacantes remotos omitir la pol\u00edtica del mismo dominio enga\u00f1ando a un usuario para que guarde un bookmarklet con un esquema data:, que es ejecutado en el contexto de la \u00faltima p\u00e1gina web visitada."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-16"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.0.0.1", "matchCriteriaId": "6AFDBFCE-228C-416A-AB9D-36C09EBB1A5F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:0.8:*:*:*:*:*:*:*", "matchCriteriaId": "93C142C5-3A85-432B-80D6-2E7B1B4694F4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:0.9:*:*:*:*:*:*:*", "matchCriteriaId": "2434FCE7-A50B-4527-9970-C7224B31141C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:0.9.1:*:*:*:*:*:*:*", "matchCriteriaId": "429ECA02-DBCD-45FB-942C-CA4BC1BC8A72"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:0.9.2:*:*:*:*:*:*:*", "matchCriteriaId": "B5F0DC80-5473-465C-9D7F-9589F1B78E12"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:0.9.3:*:*:*:*:*:*:*", "matchCriteriaId": "567FF916-7DE0-403C-8528-7931A43E0D18"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:0.10:*:*:*:*:*:*:*", "matchCriteriaId": "010B34F4-910E-4515-990B-8E72DF009578"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:0.10.1:*:*:*:*:*:*:*", "matchCriteriaId": "8FAA1A89-E8D9-46D0-8E2C-9259920ACBFE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.0:*:*:*:*:*:*:*", "matchCriteriaId": "5A545A77-2198-4685-A87F-E0F2DAECECF6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "778FAE0C-A5CF-4B67-93A9-1A803E3E699F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "E7447185-7509-449D-8907-F30A42CF7EB5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "0EDBAC37-9D08-44D1-B279-BC6ACF126CAF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.0.4:*:*:*:*:*:*:*", "matchCriteriaId": "3FFF89FA-2020-43CC-BACD-D66117B3DD26"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.0.5:*:*:*:*:*:*:*", "matchCriteriaId": "834BB391-5EB5-43A8-980A-D305EDAE6FA7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.0.6:*:*:*:*:*:*:*", "matchCriteriaId": "9A38AD88-BAA6-4FBE-885B-69E951BD1EFE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.0.7:*:*:*:*:*:*:*", "matchCriteriaId": "B500EE6C-99DB-49A3-A1F1-AFFD7FE28068"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.0.8:*:*:*:*:*:*:*", "matchCriteriaId": "4F2938F2-A801-45E5-8E06-BE03DE03C8A7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.5:*:*:*:*:*:*:*", "matchCriteriaId": "ABB88E86-6E83-4A59-9266-8B98AA91774D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.5.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "7D6BF5B1-86D1-47FE-9D9C-735718F94874"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.5.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "84D15CE0-69DF-4EFD-801E-96A4D6AABEDB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.5.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "CEE203DE-6C0E-4FDE-9C3A-0E73430F17DA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.5.0.4:*:*:*:*:*:*:*", "matchCriteriaId": "F2F38886-C25A-4C6B-93E7-36461405BA99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.5.0.5:*:*:*:*:*:*:*", "matchCriteriaId": "C65D2670-F37F-48CB-804A-D35BB1C27D9F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.5.0.6:*:*:*:*:*:*:*", "matchCriteriaId": "DE8E5194-7B34-4802-BDA6-6A86EB5EDE05"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.5.0.7:*:*:*:*:*:*:*", "matchCriteriaId": "FABA5F56-99F7-4F8F-9CC1-5B0B2EB72922"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.5.0.8:*:*:*:*:*:*:*", "matchCriteriaId": "2917BD67-CE81-4B94-B241-D4A9DDA60319"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.5.0.9:*:*:*:*:*:*:*", "matchCriteriaId": "A524A94E-F19B-42B9-AA8E-171751C339AA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.5.6:*:*:*:*:*:*:*", "matchCriteriaId": "CA97C80E-17FA-4866-86CE-29886145ED80"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:1.5.8:*:*:*:*:*:*:*", "matchCriteriaId": "04198E04-CE1D-4A5A-A20C-D1E135B45F94"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mozilla:firefox:2.0:*:*:*:*:*:*:*", "matchCriteriaId": "3487FA64-BE04-42CA-861E-3DAC097D7D32"}]}]}], "references": [{"url": "http://archives.neohapsis.com/archives/fulldisclosure/2007-02/0490.html", "source": "cve@mitre.org"}, {"url": "http://lcamtuf.coredump.cx/ffbook", "source": "cve@mitre.org"}, {"url": "http://lcamtuf.coredump.cx/ffbook/", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/33803", "source": "cve@mitre.org"}, {"url": "http://securityreason.com/securityalert/2304", "source": "cve@mitre.org"}, {"url": "http://www.heise-security.co.uk/news/85728", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/460885/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/460890/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/460896/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/461021/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/22666", "source": "cve@mitre.org"}, {"url": "https://bugzilla.mozilla.org/show_bug.cgi?id=371179", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2007-1084 - This technique could be used to bypass the same-domain policy by tricking a user into saving a bookmarklet with a data: scheme, which is executed in the context of the last visited web page."}, {"techniqueID": "T1190", "comment": "CVE-2007-1084 - Similar to T1210, this technique shows how an attacker can use the vulnerability to execute malicious code in the context of the last visited web page."}, {"techniqueID": "T1499", "comment": "CVE-2007-1084 - This technique highlights the vulnerability's possibility of being used to create a cross-site scripting (XSS) attack."}], "stix_bundle": {"type": "bundle", "id": "CVE-2007-1084-bundle", "spec_version": "2.1", "objects": {"vulnerability": {"type": "vulnerability", "id": "CVE-2007-1084", "name": "Mozilla Firefox Bookmarklet Execution Vulnerability", "description": "CVE-2007-1084: Mozilla Firefox 2.0.0.1 and earlier does not prompt users before saving bookmarklets, which allows remote attackers to bypass the same-domain policy by tricking a user into saving a bookmarklet with a data: scheme, which is executed in the context of the last visited web page.", "severity": "MEDIUM", "cvss": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "baseScore": 6.8}}, "attack_pattern": {"type": "attack-pattern", "id": "T1190-trick", "name": "Tricking the User into Saving Bookmarklet (T1190)", "description": "An adversary tricks a user into saving a bookmarklet with a data: scheme, which is executed in the context of the last visited web page.", "kill_chain_phases": [{"phase_name": "Defense Evasion", "phase_id": "T1190"}]}, "course_of_action": {"type": "course-of-action", "id": "mitigation-3", "name": "Use a Content Security Policy (CSP)", "description": "Use a Content Security Policy (CSP) to restrict the sources of web pages and prevent the execution of malicious bookmarklets.", "technical_remediation": "Implement a CSP in the web application."}, "note": {"type": "note", "id": "note-1", "text": "Attackers can use this vulnerability to execute arbitrary JavaScript code in the context of the last visited web page."}}, "relationships": [{"id": "vulnerability-attack-pattern", "source": "CVE-2007-1084", "target": "T1210-bookmarklet", "type": "related_to"}, {"id": "vulnerability-attack-pattern", "source": "CVE-2007-1084", "target": "T1190-trick", "type": "related_to"}, {"id": "vulnerability-course-of-action", "source": "CVE-2007-1084", "target": "mitigation-1", "type": "mitigates"}, {"id": "vulnerability-course-of-action", "source": "CVE-2007-1084", "target": "mitigation-2", "type": "mitigates"}, {"id": "vulnerability-course-of-action", "source": "CVE-2007-1084", "target": "mitigation-3", "type": "mitigates"}]}, "technical_analysis": {"Introduction": "The Mozilla Firefox Bookmarklet Execution Vulnerability, identified as CVE-2007-1084, allows remote attackers to bypass the same-domain policy by tricking a user into saving a bookmarklet with a data: scheme.", "Impact and Scope": "The vulnerability has a CVSS score of 6.8, with an attack vector of NETWORK, and allows remote attackers to execute arbitrary JavaScript code in the context of the last visited web page.", "Related MITRE ATT&CK Techniques": "T1210 - Bookmarklet Execution Vulnerability and T1190 - Tricking the User into Saving Bookmarklet.", "Technical Details": "The vulnerability occurs in Firefox 2.0.0.1 and earlier when a data: scheme is used in a bookmarklet. The JavaScript code in the bookmarklet is executed in the context of the last visited web page.", "Detection": "Detection methods include monitoring for unusual bookmarklet behavior and identifying suspicious JavaScript code in web page requests.", "Mitigation": "Mitigation strategies include updating Firefox to a version greater than or equal to 2.0.0.2, disabling JavaScript in Firefox, and implementing a Content Security Policy (CSP).", "Conclusion": "In conclusion, the Mozilla Firefox Bookmarklet Execution Vulnerability is a serious security issue that can be mitigated through proper updating and configuration of Firefox."}, "executive_analysis": {"Overview": "The Mozilla Firefox Bookmarklet Execution Vulnerability, identified as CVE-2007-1084, is a significant security risk that can be exploited by remote attackers.", "Business Impact": "The vulnerability can result in the execution of malicious code in the context of the last visited web page, potentially leading to data theft, unauthorized access, or system compromise.", "Technical Impact": "The vulnerability allows remote attackers to execute arbitrary JavaScript code in the context of the last visited web page, which can be used to steal sensitive data, steal credentials, or inject malicious code.", "Mitigation Strategies": "It is recommended that users update Firefox to a version greater than or equal to 2.0.0.2 and implement a Content Security Policy (CSP) to prevent the execution of malicious bookmarklets.", "Recommendations": "Recommendations include updating Firefox to a recent version, disabling JavaScript in Firefox, and implementing a Content Security Policy (CSP).", "Conclusions": "In conclusion, the Mozilla Firefox Bookmarklet Execution Vulnerability is a serious security risk that requires immediate attention and mitigation."}}