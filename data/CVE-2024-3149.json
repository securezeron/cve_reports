{"id": "CVE-2024-3149", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T19:16:00.130", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A Server-Side Request Forgery (SSRF) vulnerability exists in the upload link feature of mintplex-labs/anything-llm. This feature, intended for users with manager or admin roles, processes uploaded links through an internal Collector API using a headless browser. An attacker can exploit this by hosting a malicious website and using it to perform actions such as internal port scanning, accessing internal web applications not exposed externally, and interacting with the Collector API. This interaction can lead to unauthorized actions such as arbitrary file deletion and limited Local File Inclusion (LFI), including accessing NGINX access logs which may contain sensitive information."}, {"lang": "es", "value": "Existe una vulnerabilidad de Server-Side Request Forgery (SSRF) en la funci\u00f3n de enlace de carga de mintplex-labs/anything-llm. Esta funci\u00f3n, destinada a usuarios con funciones de administrador o administrador, procesa los enlaces cargados a trav\u00e9s de una API interna de Collector mediante un navegador sin cabeza. Un atacante puede aprovechar esto alojando un sitio web malicioso y us\u00e1ndolo para realizar acciones como escaneo de puertos internos, acceder a aplicaciones web internas no expuestas externamente e interactuar con la API de Collector. Esta interacci\u00f3n puede dar lugar a acciones no autorizadas, como la eliminaci\u00f3n arbitraria de archivos y la inclusi\u00f3n de archivos locales (LFI) limitada, incluido el acceso a los registros de acceso de NGINX que pueden contener informaci\u00f3n confidencial."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.6, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.1, "impactScore": 5.8}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-918"}]}], "references": [{"url": "https://github.com/mintplex-labs/anything-llm/commit/f4088d9348fa86dcebe9f97a18d39c0a6e92f15e", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/b230d76b-ae2d-440e-a25b-94ffaa7c4ff1", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-3149 - SSRF vulnerability can be used to perform actions such as internal port scanning, accessing internal web applications not exposed externally, and interacting with the Collector API. Defenders can monitor API requests and block suspicious traffic."}, {"techniqueID": "T1204", "comment": "CVE-2024-3149 - SSRF vulnerability can be used to perform actions such as internal port scanning, accessing internal web applications not exposed externally, and interacting with the Collector API. Defenders can monitor network traffic and block suspicious packets."}, {"techniqueID": "T1027", "comment": "CVE-2024-3149 - SSRF vulnerability can be used to access internal web applications not exposed externally. Defenders can monitor API requests and block suspicious traffic."}], "stix_bundle": {"@stix_core_v2.1": {"bundle": {"id": "CVE-2024-3149", "type": "indicator", "created_by_ref": "https://huntr.dev", "modified": "2024-06-07T14:56:05.647", "name": "CVE-2024-3149 SSRF Vulnerability", "description": [{"lang": "en", "value": "SSRF vulnerability exists in the upload link feature of mintplex-labs/anything-llm."}], "severity": "critical", "confidence": "high", "created": "2024-06-06T19:16:00.130", "modified_by_ref": "https://huntr.dev", "object_refs": [{"id": "CVE-2024-3149", "type": "note", "summary": "SSRF vulnerability in mintplex-labs/anything-llm"}], "indicatecs": [{"indicator_id_ref": "CVE-2024-3149", "type": "note", "summary": " SSRF vulnerability in mintplex-labs/anything-llm"}], "report": {"technique": {"name": "T1190", "description": "Command and Scripting Interactivity", "kill_chain_phases": [{"kill_chain_name": "MITRE ATT&CK", "phase_name": "Reconnaissance"}]}, "tactics": [{"name": "Lateral Movement", "description": "Lateral Movement Tactic", "kill_chain_phases": [{"kill_chain_name": "MITRE ATT&CK", "phase_name": "Persistence"}]}], "courses_of_action": [{"id": "T1190", "name": "Monitor API requests and block suspicious traffic"}]}}}}, "technical_analysis": {"Introduction": "The CVE-2024-3149 SSRF vulnerability exists in the upload link feature of mintplex-labs/anything-llm, which allows an attacker to interact with the Collector API and perform actions such as internal port scanning and accessing internal web applications not exposed externally.", "Impact and Scope": "The vulnerability has a CVSS score of 9.6 and a severity of CRITICAL. It affects the upload link feature of mintplex-labs/anything-llm and can be exploited by an attacker to perform actions such as internal port scanning and accessing internal web applications not exposed externally.", "Related MITRE ATT&CK Techniques": "T1190, T1204, T1027", "Technical Details": "The SSRF vulnerability exists in the upload link feature of mintplex-labs/anything-llm because of improper input validation and sanitization of user input. An attacker can exploit this vulnerability by hosting a malicious website and using it to interact with the Collector API.", "Detection": "Defense teams can detect this vulnerability by monitoring API requests and blocking suspicious traffic.", "Mitigation": "Mitigation strategies include blocking suspicious traffic, monitoring API requests, and implementing input validation and sanitization for user input.", "Conclusion": "The CVE-2024-3149 SSRF vulnerability is a critical vulnerability that can be exploited by an attacker to perform actions such as internal port scanning and accessing internal web applications not exposed externally. Defenders should take immediate action to mitigate this vulnerability and prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-3149 SSRF vulnerability has a critical impact on organizations that use mintplex-labs/anything-llm.", "Business Impact": "This vulnerability has a significant business impact as it can allow an attacker to access sensitive information and disrupt business operations.", "Technical Impact": "The vulnerability has a technical impact as it can allow an attacker to access internal web applications not exposed externally and conduct reconnaissance and lateral movement attacks.", "Mitigation Strategies": "Mitigation strategies include blocking suspicious traffic, monitoring API requests, and implementing input validation and sanitization for user input.", "Recommendations": "Recommendations for executives include conducting a risk assessment, implementing mitigation strategies, and providing training to employees on how to detect and prevent this vulnerability.", "Conclusions": "The CVE-2024-3149 SSRF vulnerability is a critical vulnerability that requires immediate attention and action. Executives should take steps to mitigate this vulnerability and prevent exploitation to ensure the security and integrity of their organization."}}