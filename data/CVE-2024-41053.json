{"id": "CVE-2024-41053", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-29T15:15:13.473", "lastModified": "2024-08-21T19:21:41.530", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: ufs: core: Fix ufshcd_abort_one racing issue\n\nWhen ufshcd_abort_one is racing with the completion ISR, the completed tag\nof the request's mq_hctx pointer will be set to NULL by ISR.  Return\nsuccess when request is completed by ISR because ufshcd_abort_one does not\nneed to do anything.\n\nThe racing flow is:\n\nThread A\nufshcd_err_handler\t\t\t\t\tstep 1\n\t...\n\tufshcd_abort_one\n\t\tufshcd_try_to_abort_task\n\t\t\tufshcd_cmd_inflight(true)\tstep 3\n\t\tufshcd_mcq_req_to_hwq\n\t\t\tblk_mq_unique_tag\n\t\t\t\trq->mq_hctx->queue_num\tstep 5\n\nThread B\nufs_mtk_mcq_intr(cq complete ISR)\t\t\tstep 2\n\tscsi_done\n\t\t...\n\t\t__blk_mq_free_request\n\t\t\trq->mq_hctx = NULL;\t\tstep 4\n\nBelow is KE back trace.\n  ufshcd_try_to_abort_task: cmd at tag 41 not pending in the device.\n  ufshcd_try_to_abort_task: cmd at tag=41 is cleared.\n  Aborting tag 41 / CDB 0x28 succeeded\n  Unable to handle kernel NULL pointer dereference at virtual address 0000000000000194\n  pc : [0xffffffddd7a79bf8] blk_mq_unique_tag+0x8/0x14\n  lr : [0xffffffddd6155b84] ufshcd_mcq_req_to_hwq+0x1c/0x40 [ufs_mediatek_mod_ise]\n   do_mem_abort+0x58/0x118\n   el1_abort+0x3c/0x5c\n   el1h_64_sync_handler+0x54/0x90\n   el1h_64_sync+0x68/0x6c\n   blk_mq_unique_tag+0x8/0x14\n   ufshcd_err_handler+0xae4/0xfa8 [ufs_mediatek_mod_ise]\n   process_one_work+0x208/0x4fc\n   worker_thread+0x228/0x438\n   kthread+0x104/0x1d4\n   ret_from_fork+0x10/0x20"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: scsi: ufs: core: solucione el problema de ejecuci\u00f3n de ufshcd_abort_one Cuando ufshcd_abort_one se ejecuta con el ISR de finalizaci\u00f3n, ISR establecer\u00e1 la etiqueta completada del puntero mq_hctx de la solicitud en NULL. Devuelve el \u00e9xito cuando ISR completa la solicitud porque ufshcd_abort_one no necesita hacer nada. El flujo de ejecucuones es: Hilo A ufshcd_err_handler paso 1 ... ufshcd_abort_one ufshcd_try_to_abort_task ufshcd_cmd_inflight(true) paso 3 ufshcd_mcq_req_to_hwq blk_mq_unique_tag rq-&gt;mq_hctx-&gt;queue_num paso 5 Hilo B (cq completar ISR) paso 2 scsi_done... __blk_mq_free_request rq-&gt; mq_hctx = NULO; paso 4 A continuaci\u00f3n se muestra el seguimiento de KE. ufshcd_try_to_abort_task: cmd en la etiqueta 41 no est\u00e1 pendiente en el dispositivo. ufshcd_try_to_abort_task: cmd en la etiqueta = 41 se borra. Anulaci\u00f3n de la etiqueta 41 / CDB 0x28 exitosa No se puede manejar la desreferencia del puntero NULL del kernel en la direcci\u00f3n virtual 0000000000000194 pc: [0xffffffddd7a79bf8] blk_mq_unique_tag+0x8/0x14 lr: [0xffffffddd6155b84] x1c/0x40 [ufs_mediatek_mod_ise] do_mem_abort+0x58/0x118 el1_abort+0x3c/ 0x5c el1h_64_sync_handler+0x54/0x90 el1h_64_sync+0x68/0x6c blk_mq_unique_tag+0x8/0x14 ufshcd_err_handler+0xae4/0xfa8 [ufs_mediatek_mod_ise] Process_one_work+0x208/0x4fc trabajador_thread+0x228/0 x438 kthread+0x104/0x1d4 ret_from_fork+0x10/0x20"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-476"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.6.5", "versionEndExcluding": "6.6.41", "matchCriteriaId": "D801CC48-8332-42BC-BE0D-DA5A5C2D8FF5"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.9.10", "matchCriteriaId": "AB2E8DEC-CFD5-4C2B-981D-E7E45A36C352"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/74736103fb4123c71bf11fb7a6abe7c884c5269e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/b5a6ac887256762758bfe7f2918cb0233aa544f4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/c3111b3cf3889bfa7b73ebff83d7397db9b7e5e0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2024-41053 - This technique is relevant because it is an example of a kernel memory corruption vulnerability, which can be exploited by attackers to gain elevated privileges or gain access to sensitive data. This can be defended against by implementing robust memory protection mechanisms and secure coding practices."}, {"techniqueID": "TA0005", "comment": "CVE-2024-41053 - This technique is relevant because it is an example of a remote code execution vulnerability, which can be exploited by attackers to take control of a system or execute arbitrary code. This can be defended against by implementing secure coding practices and patching vulnerable systems."}, {"techniqueID": "TA0021", "comment": "CVE-2024-41053 - This technique is relevant because it is an example of a kernel-level privilege escalation vulnerability, which can be exploited by attackers to gain elevated privileges or access sensitive data. This can be defended against by implementing robust access controls and secure coding practices."}], "stix_bundle": "stix:indicator/cve-2024-41053.json", "technical_analysis": {"Introduction": "CVE-2024-41053 is a kernel-level privilege escalation vulnerability in the Linux kernel. It allows an attacker to gain elevated privileges or access sensitive data.", "Impact and Scope": "The vulnerability has a CVSS score of 5.5 (Medium) with an attack vector of LOCAL and a scope of UNCHANGED.", "Related MITRE ATT&CK Techniques": "TA0001, TA0005, TA0021", "Technical Details": "The vulnerability occurs when the ufshcd_abort_one function is called with the ISR of finalization. This can lead to a kernel-level privilege escalation.", "Detection": "The vulnerability can be detected by monitoring system logs for evidence of unauthorized access or privilege escalation.", "Mitigation": "The vulnerability can be mitigated by implementing robust access controls and secure coding practices.", "Conclusion": "CVE-2024-41053 is a significant vulnerability that can allow attackers to gain elevated privileges or access sensitive data. It is essential to implement robust security measures to protect against this vulnerability."}, "executive_analysis": {"Overview": "CVE-2024-41053 is a kernel-level privilege escalation vulnerability in the Linux kernel that can be exploited by attackers to gain elevated privileges or access sensitive data.", "Business Impact": "The vulnerability can result in the loss of sensitive data or unauthorized access to critical systems.", "Technical Impact": "The vulnerability can be exploited by attackers to gain elevated privileges or access sensitive data.", "Mitigation Strategies": "Implement robust access controls and secure coding practices.", "Recommendations": "Patch vulnerable systems and implement robust security measures.", "Conclusions": "CVE-2024-41053 is a significant vulnerability that requires immediate attention and action to mitigate its impact."}}