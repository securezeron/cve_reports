{"id": "CVE-2024-5213", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-20T03:15:09.067", "lastModified": "2024-07-17T14:36:39.397", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In mintplex-labs/anything-llm versions up to and including 1.5.3, an issue was discovered where the password hash of a user is returned in the response after login (`POST /api/request-token`) and after account creations (`POST /api/admin/users/new`). This exposure occurs because the entire User object, including the bcrypt password hash, is included in the response sent to the frontend. This practice could potentially lead to sensitive information exposure despite the use of bcrypt, a strong hashing algorithm. It is recommended not to expose any clues about passwords to the frontend. "}, {"lang": "es", "value": "En las versiones de mintplex-labs/anything-llm hasta la 1.5.3 incluida, se descubri\u00f3 un problema por el cual el hash de la contrase\u00f1a de un usuario se devuelve en la respuesta despu\u00e9s de iniciar sesi\u00f3n (`POST /api/request-token`) y despu\u00e9s de la creaci\u00f3n de la cuenta. (`POST /api/admin/usuarios/nuevo`). Esta exposici\u00f3n se produce porque todo el objeto Usuario, incluido el hash de la contrase\u00f1a de bcrypt, se incluye en la respuesta enviada al frontend. Esta pr\u00e1ctica podr\u00eda conducir potencialmente a la exposici\u00f3n de informaci\u00f3n confidencial a pesar del uso de bcrypt, un potente algoritmo hash. Se recomienda no exponer ninguna pista sobre contrase\u00f1as en la interfaz."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-1230"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mintplexlabs:anythingllm:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.5.3", "matchCriteriaId": "F14948BA-FCCF-4867-B27A-215B159DA3AD"}]}]}], "references": [{"url": "https://github.com/mintplex-labs/anything-llm/commit/9df4521113ddb9a3adb5d0e3941e7d494992629c", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.com/bounties/8794fb65-50aa-40e3-b348-a29838dbf63d", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1048", "comment": "CVE-2024-5213 - Insecure Direct Object Reference (IDOR) vulnerability may allow an attacker to gain access to sensitive information by directly referencing certain variables. This technique is particularly relevant in scenario where the vulnerability is exploited through a POST request."}, {"techniqueID": "T1055", "comment": "CVE-2024-5213 - The exposure of the password hash in the response to a legitimate login request may enable an attacker to use this information to craft a password-guessing attack."}, {"techniqueID": "T1056", "comment": "CVE-2024-5213 - Information Exposure through password hash exposure may give an attacker a starting point for further exploitation."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "urn:stix:Vulnerability:1.2.3:example:1", "title": "CVE-2024-5213", "description": "CWE-1230 Insecure Direct Object Reference vulnerability in mintplex-labs/anything-llm", "created_by": {"name": "security@huntr.dev", "email": "security@huntr.dev", "organization": "Huntr"}, "created": "2024-06-20T03:15:09.067", "modified": "2024-07-17T14:36:39.397", "references": [{"source": "security@huntr.dev", "type": "Primary", "description": "CWE-1230"}], "relates_to": [{"type": "intrusion-set", "id": "urn:stix:Intrusion_Set:1.2.3:example:1", "title": "APT Group", "description": "Advanced Persistent Threat Group"}], "associated_with": [{"type": "course-of-action", "id": "urn:stix:Course_of_Action:1.2.3:example:1", "title": "Patch and Update", "description": "Apply patches and update software to the latest version"}]}, {"type": "course-of-action", "id": "urn:stix:Course_of_Action:1.2.3:example:1", "title": "Patch and Update", "description": "Apply patches and update software to the latest version", "relates_to": [{"type": "vulnerability", "id": "urn:stix:Vulnerability:1.2.3:example:1", "role": "mitigated-by"}]}, {"type": "note", "id": "urn:stix:Note:1.2.3:example:1", "title": "Defense Strategy", "text": "Patch and update software to the latest version, monitor system logs for suspicious activity"}], "relationships": [{"from": "urn:stix:Vulnerability:1.2.3:example:1", "to": "urn:stix:Course_of_Action:1.2.3:example:1", "type": "mitigated-by"}, {"from": "urn:stix:Vulnerability:1.2.3:example:1", "to": "urn:stix:Note:1.2.3:example:1", "type": "related-to"}]}, "technical_analysis": {"Introduction": "The vulnerability CVE-2024-5213 is an Insecure Direct Object Reference (IDOR) vulnerability in mintplex-labs/anything-llm. This vulnerability allows an attacker to access sensitive information by directly referencing certain variables.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5 with version 3.1 and an attack vector of NETWORK. It is a high-impact vulnerability allowing attackers to gain access to sensitive information.", "Related MITRE ATT&CK Techniques": "T1048, T1055, T1056", "Technical Details": "The vulnerability is caused by the exposure of the password hash in the response to a legitimate login request. This allows an attacker to use this information to craft a password-guessing attack.", "Detection": "Monitor system logs for suspicious activity and scan for open ports and services.", "Mitigation": "Apply patches and update software to the latest version, monitor system logs for suspicious activity", "Conclusion": "The vulnerability CVE-2024-5213 is a high-impact vulnerability allowing attackers to gain access to sensitive information. It is crucial to patch and update software to the latest version and monitor system logs for suspicious activity."}, "executive_analysis": {"Overview": "The vulnerability CVE-2024-5213 is a high-impact vulnerability allowing attackers to gain access to sensitive information.", "Business Impact": "The vulnerability can result in significant financial losses and reputational damage.", "Technical Impact": "The vulnerability allows attackers to gain access to sensitive information and launch further attacks.", "Mitigation Strategies": "Apply patches and update software to the latest version, monitor system logs for suspicious activity.", "Recommendations": "Executive management should ensure that the IT department is aware of the vulnerability and takes immediate action to patch and update software.", "Conclusions": "The vulnerability CVE-2024-5213 is a high-impact vulnerability requiring immediate attention. It is crucial to patch and update software to the latest version and monitor system logs for suspicious activity."}}