{"id": "CVE-2024-3150", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T19:16:00.350", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In mintplex-labs/anything-llm, a vulnerability exists in the thread update process that allows users with Default or Manager roles to escalate their privileges to Administrator. The issue arises from improper input validation when handling HTTP POST requests to the endpoint `/workspace/:slug/thread/:threadSlug/update`. Specifically, the application fails to validate or check user input before passing it to the `workspace_thread` Prisma model for execution. This oversight allows attackers to craft a Prisma relation query operation that manipulates the `users` model to change a user's role to admin. Successful exploitation grants attackers the highest level of user privileges, enabling them to see and perform all actions within the system."}, {"lang": "es", "value": "En mintplex-labs/anything-llm, existe una vulnerabilidad en el proceso de actualizaci\u00f3n de subprocesos que permite a los usuarios con roles predeterminados o de administrador escalar sus privilegios a administrador. El problema surge de una validaci\u00f3n de entrada incorrecta al manejar solicitudes HTTP POST al endpoint `/workspace/:slug/thread/:threadSlug/update`. Espec\u00edficamente, la aplicaci\u00f3n no puede validar o verificar la entrada del usuario antes de pasarla al modelo Prisma `workspace_thread` para su ejecuci\u00f3n. Esta supervisi\u00f3n permite a los atacantes crear una operaci\u00f3n de consulta de relaci\u00f3n Prisma que manipula el modelo de \"usuarios\" para cambiar la funci\u00f3n de un usuario a administrador. La explotaci\u00f3n exitosa otorga a los atacantes el nivel m\u00e1s alto de privilegios de usuario, permiti\u00e9ndoles ver y realizar todas las acciones dentro del sistema."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "https://github.com/mintplex-labs/anything-llm/commit/200bd7f0615347ed2efc07903d510e5a208b0afc", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/745f5c80-14ea-4055-9f15-a066ae93e5a3", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1027", "comment": "This technique is relevant because it showcases how the vulnerability can be exploited to privilege escalation attacks. A defense against this is to implement proper input validation on HTTP requests to prevent manipulation of the Prisma relation query operation."}, {"techniqueID": "T1169", "comment": "This technique is relevant because it highlights the importance of proper user role validation and access control. A defense against this is to implement strict role-based access control to prevent unauthorized changes to user roles."}, {"techniqueID": "T1190", "comment": "This technique is relevant because it demonstrates how the vulnerability can be exploited to gain full system control. A defense against this is to implement a web application firewall to prevent malicious HTTP requests from reaching the application."}], "stix_bundle": {"objects": [{"id": "CVE-2024-3150", "type": "vulnerability", "name": "CVE-2024-3150", "description": {"lang": "en", "value": "In mintplex-labs/anything-llm, a vulnerability exists in the thread update process that allows users with Default or Manager roles to escalate their privileges to Administrator."}, "references": [{"url": "https://github.com/mintplex-labs/anything-llm/commit/200bd7f0615347ed2efc07903d510e5a208b0afc", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/745f5c80-14ea-4055-9f15-a066ae93e5a3", "source": "security@huntr.dev"}], "vulnerable-software-vulnerability": {"vulnerable-software-package": {"name": "anything-llm", "version": "unspecified"}}}, {"id": "T1027", "type": "attack-pattern", "name": "T1027: Web Application Authentication Bypass", "description": {"lang": "en", "value": "An attacker sends a crafted request to a web application to bypass authentication controls and access restricted areas."}}, {"id": "T1169", "type": "attack-pattern", "name": "T1169: User Role Privilege Escalation", "description": {"lang": "en", "value": "An attacker exploits a vulnerability to escalate their user role to Administrator, granting access to sensitive areas."}}, {"id": "T1190", "type": "attack-pattern", "name": "T1190: Web Application Manipulation", "description": {"lang": "en", "value": "An attacker manipulates a web application to perform unauthorized actions."}}], "relationship": [{"id": "r_CVE-2024-3150:T1027", "relationship_type": "relates_to", "object_refs": ["CVE-2024-3150", "T1027"]}, {"id": "r_CVE-2024-3150:T1169", "relationship_type": "relates_to", "object_refs": ["CVE-2024-3150", "T1169"]}, {"id": "r_CVE-2024-3150:T1190", "relationship_type": "relates_to", "object_refs": ["CVE-2024-3150", "T1190"]}]}, "technical_analysis": {"Introduction": "CVE-2024-3150 is a privilege escalation vulnerability in anything-llm that allows users with Default or Manager roles to escalate their privileges to Administrator.", "Impact and Scope": "This CVE has a CVSS score of 8.1, with an attack vector of NETWORK, privileges required being LOW, and user interaction being NONE. This indicates a high-risk vulnerability that can be exploited remotely without user interaction.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this CVE are T1027: Web Application Authentication Bypass, T1169: User Role Privilege Escalation, and T1190: Web Application Manipulation.", "Technical Details": "The vulnerability arises from improper input validation when handling HTTP POST requests to the endpoint `/workspace/:slug/thread/:threadSlug/update`. An attacker can craft a Prisma relation query operation that manipulates the `users` model to change a user's role to admin.", "Detection": "Detection can be achieved by monitoring for unauthorized role changes in the system and implementing web application firewalls to prevent malicious HTTP requests.", "Mitigation": "Mitigation strategies include implementing proper input validation on HTTP requests, strict role-based access control, and implementing a web application firewall.", "Conclusion": "In conclusion, CVE-2024-3150 is a high-risk vulnerability that can be exploited remotely without user interaction. It is essential to implement proper mitigation strategies to prevent this vulnerability from being exploited."}, "executive_analysis": {"Overview": "CVE-2024-3150 is a privilege escalation vulnerability in anything-llm that allows users with Default or Manager roles to escalate their privileges to Administrator.", "Business Impact": "This vulnerability has a high business impact as it allows attackers to gain full system control, compromising sensitive data and potentially leading to financial losses.", "Technical Impact": "The technical impact of this vulnerability is that it allows attackers to manipulate the system, potentially leading to data breaches and system compromise.", "Mitigation Strategies": "Mitigation strategies include implementing proper input validation on HTTP requests, strict role-based access control, and implementing a web application firewall.", "Recommendations": "It is recommended that executives prioritize patching and vulnerability remediation to prevent this vulnerability from being exploited.", "Conclusions": "In conclusion, CVE-2024-3150 is a high-risk vulnerability that requires immediate attention and mitigation strategies to prevent exploitation."}}