{"id": "CVE-2020-13304", "sourceIdentifier": "cve@gitlab.com", "published": "2020-09-14T22:15:11.067", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability was discovered in GitLab versions before 13.1.10, 13.2.8 and 13.3.4. Same 2 factor Authentication secret code was generated which resulted an attacker to maintain access under certain conditions."}, {"lang": "es", "value": "Se detect\u00f3 una vulnerabilidad en GitLab versiones anteriores a 13.1.10, 13.2.8 y 13.3.4.&#xa0;El mismo c\u00f3digo secreto de autenticaci\u00f3n de 2 factores era generado, lo que resultaba en que un atacante mantuviera el acceso bajo determinadas condiciones"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}, {"source": "cve@gitlab.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.8, "baseSeverity": "LOW"}, "exploitabilityScore": 1.2, "impactScore": 2.5}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-330"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:*:*:*:*", "versionEndExcluding": "13.1.10", "matchCriteriaId": "5679F06E-96ED-4A34-AF94-2532C22B465B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:*:*:*:*", "versionStartIncluding": "13.2.0", "versionEndExcluding": "13.2.8", "matchCriteriaId": "724E2186-FCF8-4082-9603-06609EFA4157"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:*:*:*:*", "versionStartIncluding": "13.3.0", "versionEndExcluding": "13.3.4", "matchCriteriaId": "EBD4843F-FD1E-497A-A95F-B7F4C1B8BDA3"}]}]}], "references": [{"url": "https://gitlab.com/gitlab-org/cves/-/blob/master/2020/CVE-2020-13304.json", "source": "cve@gitlab.com", "tags": ["Third Party Advisory"]}, {"url": "https://gitlab.com/gitlab-org/gitlab/-/issues/27686", "source": "cve@gitlab.com", "tags": ["Broken Link"]}, {"url": "https://hackerone.com/reports/511260", "source": "cve@gitlab.com", "tags": ["Permissions Required"]}], "techniques": [{"techniqueID": "T1185", "comment": "CVE-2020-13304 - The attacker uses the generated same 2-factor authentication code to maintain access under certain conditions. This technique can be used to maintain persistence and command an entire network."}, {"techniqueID": "T1134", "comment": "CVE-2020-13304 - The attacker uses a publicly available exploitation tool to exploit the vulnerability. This technique can be used to automate exploitation and spread malware."}, {"techniqueID": "T1210", "comment": "CVE-2020-13304 - The attacker uses the vulnerability to maintain access and conduct reconnaissance. This technique can be used to maintain a foothold and conduct further attacks."}], "technical_analysis": {"Introduction": "The reported vulnerability, CVE-2020-13304, allows an attacker to maintain 2-factor authentication access to a GitLab instance under certain conditions. This vulnerability is present in versions before 13.1.10, 13.2.8, and 13.3.4.", "Impact and Scope": "The vulnerability has a CVSSv3 score of 7.2 with an attack vector of NETWORK, attack complexity of LOW, and required privileges of HIGH. This means that an attacker can exploit this vulnerability remotely without user interaction to gain access to the system.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are TA0002 - Initial Access, TA0005 - Command and Control, and TA0011 - Extension", "Technical Details": "The vulnerability is caused by the same 2-factor authentication code being generated, which allows an attacker to maintain access under certain conditions.", "Detection": "Detecting this vulnerability requires monitoring for unusual 2-factor authentication attempts and monitoring for suspicious activity on the system.", "Mitigation": "Mitigating this vulnerability involves updating to the latest version of GitLab, disabling 2-factor authentication, and implementing additional security measures such as monitoring for suspicious activity.", "Conclusion": "In conclusion, the reported vulnerability, CVE-2020-13304, is a serious issue that allows an attacker to maintain 2-factor authentication access to a GitLab instance under certain conditions. It is essential to update to the latest version and implement additional security measures to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The reported vulnerability, CVE-2020-13304, is a significant issue that can allow an attacker to maintain 2-factor authentication access to a GitLab instance under certain conditions.", "Business Impact": "This vulnerability can have a significant business impact if an attacker gains access to a system using this vulnerability. Data can be compromised, and intellectual property can be stolen.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows an attacker to gain access to a system remotely without user interaction.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability are updating to the latest version of GitLab, disabling 2-factor authentication, and implementing additional security measures.", "Recommendations": "We recommend that all organizations using GitLab immediately update to the latest version and implement additional security measures to mitigate this vulnerability.", "Conclusions": "In conclusion, the reported vulnerability, CVE-2020-13304, is a serious issue that requires immediate attention. We recommend that all organizations take immediate action to mitigate this vulnerability."}}