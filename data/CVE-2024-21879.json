{"id": "CVE-2024-21879", "sourceIdentifier": "csirt@divd.nl", "published": "2024-08-12T13:38:15.237", "lastModified": "2024-08-23T17:49:25.830", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Improper Neutralization of Special Elements used in a Command ('Command Injection') vulnerability through an url parameter of an authenticated enpoint in Enphase IQ Gateway (formerly known as Envoy) allows OS Command Injection.This issue affects Envoy: from 4.x to 8.x and < 8.2.4225."}, {"lang": "es", "value": "La neutralizaci\u00f3n inadecuada de elementos especiales utilizados en una vulnerabilidad de comando (\"Inyecci\u00f3n de comando\") a trav\u00e9s de un par\u00e1metro de URL de un punto autenticado en Enphase IQ Gateway (anteriormente conocido como Envoy) permite la inyecci\u00f3n de comando del sistema operativo. Este problema afecta a Envoy: de 4.x a 8. .xy &lt;8.2.4225."}], "metrics": {"cvssMetricV40": [{"source": "csirt@divd.nl", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:L/SI:L/SA:L/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:P/AU:Y/R:I/V:C/RE:H/U:X", "attackVector": "NETWORK", "attackComplexity": "LOW", "attackRequirements": "NONE", "privilegesRequired": "LOW", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "HIGH", "vulnerableSystemIntegrity": "HIGH", "vulnerableSystemAvailability": "HIGH", "subsequentSystemConfidentiality": "LOW", "subsequentSystemIntegrity": "LOW", "subsequentSystemAvailability": "LOW", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "PRESENT", "automatable": "YES", "recovery": "IRRECOVERABLE", "valueDensity": "CONCENTRATED", "vulnerabilityResponseEffort": "HIGH", "providerUrgency": "NOT_DEFINED", "baseScore": 8.7, "baseSeverity": "HIGH"}}], "cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}, {"source": "csirt@divd.nl", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-77"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:enphase:iq_gateway_firmware:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0", "versionEndExcluding": "8.2.4225", "matchCriteriaId": "045C0178-42FE-4511-A182-AF3BA9545EF0"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:enphase:iq_gateway:-:*:*:*:*:*:*:*", "matchCriteriaId": "75882BE4-CF58-44B5-BA30-DD13BDFF78C0"}]}]}], "references": [{"url": "https://csirt.divd.nl/CVE-2024-21879", "source": "csirt@divd.nl", "tags": ["Third Party Advisory"]}, {"url": "https://csirt.divd.nl/DIVD-2024-00011", "source": "csirt@divd.nl", "tags": ["Third Party Advisory"]}, {"url": "https://enphase.com/cybersecurity/advisories/ensa-2024-4", "source": "csirt@divd.nl", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1499", "comment": "CVE-2024-21879 - This OS Command Injection vulnerability allows attackers to inject arbitrary OS commands, which can lead to remote code execution, data theft, and other malicious activities"}, {"techniqueID": "T1059", "comment": "CVE-2024-21879 - This vulnerability allows attackers to inject arbitrary OS commands, which can lead to remote code execution, data theft, and other malicious activities, making it an important technique to identify and defend against."}, {"techniqueID": "T1046", "comment": "CVE-2024-21879 - This vulnerability allows attackers to inject arbitrary OS commands, which can lead to remote code execution, data theft, and other malicious activities, making it an important technique to identify and defend against."}, {"techniqueID": "TA0044", "comment": "CVE-2024-21879 - This vulnerability allows attackers to inject arbitrary OS commands, which can lead to remote code execution, data theft, and other malicious activities, making it an important technique to identify and defend against."}], "technical_analysis": {"Introduction": "The CVE-2024-21879 vulnerability is a critical OS Command Injection vulnerability that allows attackers to inject arbitrary OS commands, which can lead to remote code execution, data theft, and other malicious activities.", "Impact and Scope": "The vulnerability affects Enphase IQ Gateway firmware versions 4.x to 8.x and less than 8.2.4225, and has a CVSSv4.0 score of 8.7, a CVSSv3.1 score of 8.8, and an attack vector of Network.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are relevant to this vulnerability: T1499, T1059, T1046, and TA0044.", "Technical Details": "The vulnerability occurs when an authenticated endpoint in the Enphase IQ Gateway fails to properly neutralize special elements in user-supplied input, allowing an attacker to inject arbitrary OS commands.", "Detection": "Detection methods include monitoring for suspicious network traffic, analyzing system logs for signs of exploitation, and looking for unusual system behavior.", "Mitigation": "Mitigation strategies include restricting access to the affected endpoint, limiting user privileges, and implementing input validation and sanitization.", "Conclusion": "In conclusion, the CVE-2024-21879 vulnerability is a critical security risk that requires immediate attention. Defending against this vulnerability requires a combination of technical controls, user education, and organizational policies."}, "executive_analysis": {"Overview": "The CVE-2024-21879 vulnerability is a critical OS Command Injection vulnerability that allows attackers to inject arbitrary OS commands, which can lead to remote code execution, data theft, and other malicious activities.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to unauthorized access, data theft, and disruption of critical systems.", "Technical Impact": "The technical impact of this vulnerability is also significant, as it allows attackers to inject arbitrary OS commands, which can lead to remote code execution, data theft, and other malicious activities.", "Mitigation Strategies": "Mitigation strategies include restricting access to the affected endpoint, limiting user privileges, and implementing input validation and sanitization.", "Recommendations": "Recommendations for executives include implementing a vulnerability management program, conducting regular security audits, and providing training to employees on cybersecurity best practices.", "Conclusions": "In conclusion, the CVE-2024-21879 vulnerability is a critical security risk that requires immediate attention. Executives must take action to mitigate this vulnerability and protect their organizations from potential attacks."}}