{"id": "CVE-2007-3731", "sourceIdentifier": "secalert@redhat.com", "published": "2007-09-17T17:17:00.000", "lastModified": "2023-02-13T02:18:02.567", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Linux kernel 2.6.20 and 2.6.21 does not properly handle an invalid LDT segment selector in %cs (the xcs field) during ptrace single-step operations, which allows local users to cause a denial of service (NULL dereference and OOPS) via certain code that makes ptrace PTRACE_SETREGS and PTRACE_SINGLESTEP requests, related to the TRACE_IRQS_ON function, and possibly related to the arch_ptrace function."}, {"lang": "es", "value": "El kernel de Linux 2.6.20 y 2.6.21 no maneja de forma adecuada un segmento de selecci\u00f3n LDT no v\u00e1lido en %cs (el campo xcs)a lo largo de las operaciones paso-simple ptrace, lo caul permite a usuarios loalces provocar denegaci\u00f3n de servicio (referencia NULL y OOPS) a trav\u00e9s de ciertos c\u00f3digos que realizan las respuestas ptrace PTRACE_SETREGS y PTRACE_SINGLESTEP, relacionado con la funci\u00f3n TRACE_IRQS_ON, y posiblemente relacionado con la funci\u00f3n arch_ptrace."}], "vendorComments": [{"organization": "Red Hat", "comment": "This issue did not affect the versions of the Linux kernel as shipped with Red Hat Enterprise Linux 2.1, 3, or 4.", "lastModified": "2007-10-18T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:N/I:N/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "COMPLETE", "baseScore": 4.9}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.9, "impactScore": 6.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.20:*:*:*:*:*:*:*", "matchCriteriaId": "C6940324-0383-4510-BA55-770E0A6B80B7"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.21:*:*:*:*:*:*:*", "matchCriteriaId": "50B422D1-6C6E-4359-A169-3EED78A1CF40"}]}]}], "references": [{"url": "http://bugzilla.kernel.org/show_bug.cgi?id=8765", "source": "secalert@redhat.com", "tags": ["Exploit"]}, {"url": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commitdiff%3Bh=29eb51101c02df517ca64ec472d7501127ad1da8", "source": "secalert@redhat.com"}, {"url": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commitdiff%3Bh=a10d9a71bafd3a283da240d2868e71346d2aef6f", "source": "secalert@redhat.com"}, {"url": "http://osvdb.org/37286", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/26935", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/26955", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/26978", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/27322", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/29159", "source": "secalert@redhat.com"}, {"url": "http://wiki.rpath.com/wiki/Advisories:rPSA-2008-0094", "source": "secalert@redhat.com"}, {"url": "http://www.debian.org/security/2007/dsa-1378", "source": "secalert@redhat.com"}, {"url": "http://www.redhat.com/support/errata/RHSA-2007-0940.html", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/archive/1/488972/100/0/threaded", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/bid/25801", "source": "secalert@redhat.com"}, {"url": "http://www.ubuntu.com/usn/usn-518-1", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=248324", "source": "secalert@redhat.com", "tags": ["Patch"]}, {"url": "https://issues.rpath.com/browse/RPL-2304", "source": "secalert@redhat.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A10394", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "CVE-2007-3731 - This vulnerability can be exploited by an attacker to gain unauthorized access to the system, which may lead to further exploitation of the system. Defending against this involves implementing proper input validation and sanitization techniques to prevent buffer overflow attacks."}, {"techniqueID": "T1083: File and Directory Discovery", "comment": "CVE-2007-3731 - This vulnerability can be used by an attacker to gain access to sensitive files and directories on the system, which may lead to further exploitation of the system. Defending against this involves implementing proper access controls and file permissions to restrict access to sensitive files and directories."}, {"techniqueID": "T1350: File Deletion", "comment": "CVE-2007-3731 - This vulnerability can be used by an attacker to delete critical system files, which may lead to system instability or failure. Defending against this involves implementing proper backup and recovery procedures to ensure failure of critical system files does not lead to system downtime."}], "stix_bundle": {"@timestamp": "2023-02-13T02:20:02.567", "bundle": {"id": "Bundle: CVE-2007-3731", "name": "CVE-2007-3731", "description": "A Linux kernel vulnerability that can be used to cause a denial of service (NULL dereference and OOPS) via certain code that makes ptrace PTRACE_SETREGS and PTRACE_SINGLESTEP requests.", "created_by_ref": "https://example.com", "modified": "2023-02-13T02:20:02.567", "objects": [{"id": "Vulnerability: CVE-2007-3731", "type": "vulnerability", "description": "A Linux kernel vulnerability that can be used to cause a denial of service (NULL dereference and OOPS) via certain code that makes ptrace PTRACE_SETREGS and PTRACE_SINGLESTEP requests.", "exploitability": "moderate", "cvssv2": "4.9", "cvssv3": "4.9", "affected_systems": ["Linux kernel 2.6.20 and 2.6.21"], "references": [{"id": "Reference: 1", "type": "reference", "url": "http://bugzilla.kernel.org/show_bug.cgi?id=8765"}, {"id": "Reference: 2", "type": "reference", "url": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git?a=commitdiff&h=29eb51101c02df517ca64ec472d7501127ad1da8"}]}, {"id": "TTP: Exploit Public-Facing Application", "type": "ttp", "name": "Exploit Public-Facing Application", "description": "An attacker uses an exploit to compromise a public-facing application.", "related_schemas": ["Vulnerability: CVE-2007-3731"]}, {"id": "TTP: T1083 File and Directory Discovery", "type": "ttp", "name": "File and Directory Discovery", "description": "An attacker searches for and identifies files and directories on a system.", "related_schemas": ["Vulnerability: CVE-2007-3731"]}, {"id": "TTP: T1350 File Deletion", "type": "ttp", "name": "File Deletion", "description": "An attacker deletes a file on a system.", "related_schemas": ["Vulnerability: CVE-2007-3731"]}], "relations": [{"from": "Vulnerability: CVE-2007-3731", "to": "TTP: Exploit Public-Facing Application"}, {"from": "Vulnerability: CVE-2007-3731", "to": "TTP: T1083 File and Directory Discovery"}, {"from": "Vulnerability: CVE-2007-3731", "to": "TTP: T1350 File Deletion"}]}}, "technical_analysis": {"Introduction": "The CVE-2007-3731 vulnerability is a Linux kernel vulnerability that can be used to cause a denial of service (NULL dereference and OOPS) via certain code that makes ptrace PTRACE_SETREGS and PTRACE_SINGLESTEP requests.", "Impact and Scope": "The impact of this vulnerability is a denial of service (NULL dereference and OOPS) via certain code that makes ptrace PTRACE_SETREGS and PTRACE_SINGLESTEP requests. The scope of this vulnerability is limited to Linux kernel versions 2.6.20 and 2.6.21.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1190 Exploit Public-Facing Application, T1083 File and Directory Discovery, and T1350 File Deletion.", "Technical Details": "The vulnerability occurs when the Linux kernel does not properly handle an invalid LDT segment selector in %cs (the xcs field) during ptrace single-step operations, which allows local users to cause a denial of service (NULL dereference and OOPS) via certain code that makes ptrace PTRACE_SETREGS and PTRACE_SINGLESTEP requests.", "Detection": "The detection of this vulnerability involves monitoring for unusual system behavior and identifying unauthorized access to sensitive files and directories.", "Mitigation": "The mitigation of this vulnerability involves implementing proper input validation and sanitization techniques to prevent buffer overflow attacks, implementing proper access controls and file permissions to restrict access to sensitive files and directories, and implementing proper backup and recovery procedures to ensure failure of critical system files does not lead to system downtime.", "Conclusion": "The CVE-2007-3731 vulnerability is a critical security vulnerability that can be used to cause a denial of service (NULL dereference and OOPS) via certain code that makes ptrace PTRACE_SETREGS and PTRACE_SINGLESTEP requests. It is recommended that Linux kernel versions 2.6.20 and 2.6.21 be updated to a higher version to prevent exploitation of this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2007-3731 vulnerability is a Linux kernel vulnerability that can be used to cause a denial of service (NULL dereference and OOPS) via certain code that makes ptrace PTRACE_SETREGS and PTRACE_SINGLESTEP requests.", "Business Impact": "The business impact of this vulnerability is a potential loss of data and system downtime, which can result in significant financial losses and damage to the organization's reputation.", "Technical Impact": "The technical impact of this vulnerability is a potential denial of service (NULL dereference and OOPS) via certain code that makes ptrace PTRACE_SETREGS and PTRACE_SINGLESTEP requests, which can result in system instability and failure.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include implementing proper input validation and sanitization techniques to prevent buffer overflow attacks, implementing proper access controls and file permissions to restrict access to sensitive files and directories, and implementing proper backup and recovery procedures to ensure failure of critical system files does not lead to system downtime.", "Recommendations": "It is recommended that Linux kernel versions 2.6.20 and 2.6.21 be updated to a higher version to prevent exploitation of this vulnerability, and that proper security measures be implemented to prevent unauthorized access to sensitive files and directories.", "Conclusions": "The CVE-2007-3731 vulnerability is a critical security vulnerability that can be used to cause a denial of service (NULL dereference and OOPS) via certain code that makes ptrace PTRACE_SETREGS and PTRACE_SINGLESTEP requests. It is recommended that immediate action be taken to mitigate this vulnerability and prevent exploitation."}}