{"id": "CVE-2020-7456", "sourceIdentifier": "secteam@freebsd.org", "published": "2020-06-09T19:15:10.760", "lastModified": "2020-07-07T19:24:21.290", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In FreeBSD 12.1-STABLE before r361918, 12.1-RELEASE before p6, 11.4-STABLE before r361919, 11.3-RELEASE before p10, and 11.4-RC2 before p1, an invalid memory location may be used for HID items if the push/pop level is not restored within the processing of that HID item allowing an attacker with physical access to a USB port to be able to use a specially crafted USB device to gain kernel or user-space code execution."}, {"lang": "es", "value": "En FreeBSD versi\u00f3n 12.1-ESTABLE versiones anteriores a r361918, 12.1-RELEASE versiones anteriores a p6, 11.4-ESTABLE versiones anteriores a r361919, 11.3-RELEASE versiones anteriores a p10 y 11.4-RC2 versiones anteriores a p1, puede ser usada una ubicaci\u00f3n de memoria no comprobada para elementos HID si el nivel de inserci\u00f3n/extracci\u00f3n no es restaurado dentro del procesamiento de ese elemento HID, permitiendo que un atacante con acceso f\u00edsico a un puerto USB pueda usar un dispositivo USB especialmente dise\u00f1ado para conseguir una ejecuci\u00f3n de c\u00f3digo de kernel o del espacio de usuario"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "PHYSICAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:-:*:*:*:*:*:*", "matchCriteriaId": "F35957CE-AF9F-40CA-BDD1-FA6A0E73783F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p1:*:*:*:*:*:*", "matchCriteriaId": "EA929713-B797-494A-853D-C121D9D69519"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p2:*:*:*:*:*:*", "matchCriteriaId": "3C3D8EDC-91D3-45B2-AC1D-EF4346D4A714"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p3:*:*:*:*:*:*", "matchCriteriaId": "EA5006FF-06A5-4D95-BF5B-29F26248D11F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p4:*:*:*:*:*:*", "matchCriteriaId": "A705031B-FD63-4076-B92E-E826E11D7111"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p5:*:*:*:*:*:*", "matchCriteriaId": "11C1EFB1-68E5-45F4-A7E1-744574F290D1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p6:*:*:*:*:*:*", "matchCriteriaId": "25F649A7-9265-4552-8934-BCE083363982"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p7:*:*:*:*:*:*", "matchCriteriaId": "F202C856-5B95-4796-AC4A-1F210E7BAB8F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p8:*:*:*:*:*:*", "matchCriteriaId": "9419C866-C478-4CDE-A9A1-E592D8FF0933"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p9:*:*:*:*:*:*", "matchCriteriaId": "2B6DFC23-A7A1-431A-9AD9-A820579F95F0"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.4:rc1:*:*:*:*:*:*", "matchCriteriaId": "2B0FB7BE-DB4E-47CE-8B51-C43DC5AADD17"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.4:rc2:*:*:*:*:*:*", "matchCriteriaId": "0D427061-B399-47BA-865D-9FAB315210CF"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.1:-:*:*:*:*:*:*", "matchCriteriaId": "BD730B6A-F123-4685-ACB3-4F20AAAB77F3"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.1:p1:*:*:*:*:*:*", "matchCriteriaId": "508150E3-2C0C-4EEB-BFC9-BB5CEB404C06"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.1:p2:*:*:*:*:*:*", "matchCriteriaId": "B5D692EF-A5D7-430E-91BA-4CD137343B66"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.1:p3:*:*:*:*:*:*", "matchCriteriaId": "D50C60A7-4C9F-4636-92E9-9F5B8B01BE5B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.1:p4:*:*:*:*:*:*", "matchCriteriaId": "6C49F6C7-A740-42F4-93BB-512CBF334516"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.1:p5:*:*:*:*:*:*", "matchCriteriaId": "402740C4-5B55-423F-BAD2-F742E1E21ADC"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:netapp:clustered_data_ontap:-:*:*:*:*:*:*:*", "matchCriteriaId": "1FE996B1-6951-4F85-AA58-B99A379D2163"}]}]}], "references": [{"url": "https://security.FreeBSD.org/advisories/FreeBSD-SA-20:17.usb.asc", "source": "secteam@freebsd.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20200625-0005/", "source": "secteam@freebsd.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1003.003", "comment": "CVE-2020-7456 - The use of a USB device to gain unauthorized access to a system allows attackers to exploit this vulnerability, making it relevant to Defense Evasion tactics such as Native API, which is a common technique used to interact with the Operating System and potentially gain elevated privileges."}, {"techniqueID": "T1210", "comment": "CVE-2020-7456 - The vulnerability allows an attacker to inject and execute arbitrary code, making it relevant to Command and Control techniques such as Secondary DNS and Third-Party DNS, which are often used to communicate with command and control servers and potentially inject malware."}, {"techniqueID": "T1078", "comment": "CVE-2020-7456 - The vulnerability allows an attacker to inject and execute arbitrary code, making it relevant to Command and Control techniques such as Command and Control Server Infrastructure, which is often used to communicate with command and control servers and potentially inject malware."}, {"techniqueID": "T1027", "comment": "CVE-2020-7456 - The vulnerability allows an attacker to inject and execute arbitrary code, making it relevant to Data Encoding and Obfuscation techniques such as ASCII, which is often used to encode and hide the content of malicious files."}], "stix_bundle": [{"type": "indicator", "id": "indicator--93a06d5d-2c5a-4d21-98a8-0f1f8f4a1b60", "created_by_ref": "identity--67ce8d4c-7a65-434a-87ba-66a31ccf6f76", "modified": "2022-01-01T14:30:00.000Z", "created": "2022-01-01T14:30:00.000Z", "name": "FreeBSD USB Device Vulnerability Indicator", "description": "An indicator for the FreeBSD USB device vulnerability", "identity_category": "indicator", "producer_entity": "test-identity"}, {"type": "report", "id": "report--62b02ac5-7c5d-49c6-9ba4-a5c72f9c7b33", "created_by_ref": "identity--67ce8d4c-7a65-434a-87ba-66a31ccf6f76", "modified": "2022-01-01T14:30:00.000Z", "created": "2022-01-01T14:30:00.000Z", "name": "FreeBSD USB Device Vulnerability Report", "description": "A report for the FreeBSD USB device vulnerability", "identity_category": "report", "producer_entity": "test-identity"}], "technical_analysis": {"Introduction": "The FreeBSD USB device vulnerability (CVE-2020-7456) exists in the USB device handling code of the FreeBSD operating system, allowing an attacker to inject and execute arbitrary code with kernel-level privileges.", "Impact and Scope": "This vulnerability has a CVSS score of 6.8, with a base severity of MEDIUM, and is exploitable via a physical interaction with a USB device.", "Related MITRE ATT&CK Techniques": "T1003.003, T1210, T1078, T1027", "Technical Details": "The vulnerability is due to an invalid memory location being used for HID items, allowing an attacker to inject and execute arbitrary code with kernel-level privileges.", "Detection": "Detecting this vulnerability requires identifying and monitoring USB devices interacting with the system, particularly those devices with HID items.", "Mitigation": "To mitigate this vulnerability, users should ensure that USB devices are only plugged into trusted systems, and that USB device handling code is reviewed and audited for signs of tampering.", "Conclusion": "The FreeBSD USB device vulnerability (CVE-2020-7456) is a significant vulnerability that can be exploited through physical interaction with a USB device, providing attackers with kernel-level privileges."}, "executive_analysis": {"Overview": "The FreeBSD USB device vulnerability (CVE-2020-7456) is a critical vulnerability that allows attackers to gain kernel-level privileges through physical interaction with a USB device.", "Business Impact": "This vulnerability poses a significant risk to business data and operations, particularly if an attacker gains kernel-level privileges and can execute arbitrary code.", "Technical Impact": "This vulnerability allows attackers to execute arbitrary code with kernel-level privileges, providing them with elevated access to the system and potential access to sensitive data.", "Mitigation Strategies": "Implement USB device whitelisting, review and audit USB device handling code, and ensure that only trusted USB devices are plugged into systems.", "Recommendations": "Patch devices, implement USB device whitelisting, and review and audit USB device handling code.", "Conclusions": "The FreeBSD USB device vulnerability (CVE-2020-7456) is a critical vulnerability that requires immediate attention and remediation to ensure the security of business data and operations."}}