{"id": "CVE-2024-39905", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-11T16:15:05.067", "lastModified": "2024-07-11T18:09:58.777", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Red is a fully modular Discord bot. Due to a bug in Red's Core API, 3rd-party cogs using the `@commands.can_manage_channel()` command permission check without additional permission controls may authorize a user to run a command even when that user doesn't have permissions to manage a channel. None of the core commands or core cogs are affected. The maintainers of the project are not aware of any _public_ 3rd-party cog utilizing this API at the time of writing this advisory. The problem was patched and released in version 3.5.10."}, {"lang": "es", "value": "Red es un bot de Discord totalmente modular. Debido a un error en la API principal de Red, los engranajes de terceros que utilizan la verificaci\u00f3n de permisos del comando `@commands.can_manage_channel()` sin controles de permisos adicionales pueden autorizar a un usuario a ejecutar un comando incluso cuando ese usuario no tiene permisos para administrar un canal. Ninguno de los comandos principales o engranajes principales se ve afectado. Los mantenedores del proyecto no tienen conocimiento de ning\u00fan any _public_ 3rd-party que utilice esta API al momento de escribir este aviso. El problema fue parcheado y lanzado en la versi\u00f3n 3.5.10. "}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-863"}]}], "references": [{"url": "https://github.com/Cog-Creators/Red-DiscordBot/commit/0b0b23b9717b40ed4f8715720b199417c8e89750", "source": "security-advisories@github.com"}, {"url": "https://github.com/Cog-Creators/Red-DiscordBot/pull/6398", "source": "security-advisories@github.com"}, {"url": "https://github.com/Cog-Creators/Red-DiscordBot/security/advisories/GHSA-5jq8-q6rj-9gq4", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1204.004", "comment": "Using a compromised account to impersonate a legitimate user - Red is a fully modular Discord bot with a bug in its Core API affecting 3rd-party cogs. An attacker can use this vulnerability to impersonate a legitimate user and execute unauthorized commands."}, {"techniqueID": "T1134.001", "comment": "Calling process with unauthorized arguments - An attacker can exploit this vulnerability to execute unauthorized commands, bypassing the intended permission checks."}], "stix_bundle": {"type": "bundle", "id": "Bundle-1", "created": "2024-07-11T16:15:05.067", "modified": "2024-07-11T18:09:58.777", "name": "Red Discord Bot API Bug", "description": "Bundle relating to the CVE-2024-39905 vulnerability in Red Discord Bot's Core API.", "objects": [{"type": "report", "id": "Report-1", "created": "2024-07-11T16:15:05.067", "modified": "2024-07-11T18:09:58.777", "name": "Vulnerability in Red Discord Bot's Core API", "description": "A vulnerability in Red Discord Bot's Core API allows an attacker to execute unauthorized commands.", "objects": [{"type": "course-of-action", "id": "COA-1", "created": "2024-07-11T16:15:05.067", "modified": "2024-07-11T18:09:58.777", "name": "Update to version 3.5.10", "description": "Update to the latest version of Red Discord Bot to patch the vulnerability.", "effective_date": "2024-07-11T16:15:05.067", "related_to": "T1204.004"}, {"type": "course-of-action", "id": "COA-2", "created": "2024-07-11T16:15:05.067", "modified": "2024-07-11T18:09:58.777", "name": "Disable 3rd-party cogs", "description": "Temporarily disable 3rd-party cogs to prevent unauthorized access.", "effective_date": "2024-07-11T16:15:05.067", "related_to": "T1134.001"}]}], "relationships": [{"source_id": "Report-1", "target_id": "T1204.004", "type": "relates", "label": "exploits"}, {"source_id": "Report-1", "target_id": "T1134.001", "type": "relates", "label": "bypasses"}]}, "technical_analysis": {"Introduction": "The CVE-2024-39905 vulnerability in Red Discord Bot's Core API allows an attacker to execute unauthorized commands by exploiting a bug in the `@commands.can_manage_channel()` permission check.", "Impact and Scope": "The impact of this vulnerability is limited to unauthorized command execution, with a CVSS score of 5.3 (Medium) and an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1204.004 (User Execution) and T1134.001 (Calling Process with Unauthorized Arguments).", "Technical Details": "The vulnerability is caused by a bug in the Core API, which allows 3rd-party cogs to execute unauthorized commands without additional permission controls.", "Detection": "Methods for detecting this vulnerability include monitoring log files for suspicious command execution and implementing automated testing for vulnerability exploitation.", "Mitigation": "Mitigation strategies include updating to the latest version of Red Discord Bot (version 3.5.10) and disabling 3rd-party cogs that may be affected by the vulnerability.", "Conclusion": "In conclusion, the CVE-2024-39905 vulnerability in Red Discord Bot's Core API is a moderate-risk vulnerability that can be mitigated by updating to the latest version and implementing additional permission controls."}, "executive_analysis": {"Overview": "The CVE-2024-39905 vulnerability in Red Discord Bot's Core API is a moderate-risk vulnerability that can be exploited by attackers to execute unauthorized commands.", "Business Impact": "The business impact of this vulnerability includes the potential for unauthorized access and command execution, which could lead to data breaches, reputational damage, or financial losses.", "Technical Impact": "The technical impact of this vulnerability includes the potential for unauthorized access and command execution, which could lead to security breaches, data breaches, or system compromise.", "Mitigation Strategies": "Mitigation strategies include implementing robust permission controls, regularly updating software, and monitoring for suspicious activity.", "Recommendations": "Recommendations for executives include prioritizing vulnerability remediation, implementing robust security controls, and providing training to employees on cybersecurity best practices.", "Conclusions": "In conclusion, the CVE-2024-39905 vulnerability in Red Discord Bot's Core API is a moderate-risk vulnerability that requires immediate attention and remediation to ensure the security and integrity of the organization's systems and data."}}