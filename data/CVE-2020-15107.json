{"id": "CVE-2020-15107", "sourceIdentifier": "security-advisories@github.com", "published": "2020-07-15T22:15:13.967", "lastModified": "2020-07-22T15:03:46.377", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In openenclave before 0.10.0, enclaves that use x87 FPU operations are vulnerable to tampering by a malicious host application. By violating the Linux System V Application Binary Interface (ABI) for such operations, a host app can compromise the execution integrity of some x87 FPU operations in an enclave. Depending on the FPU control configuration of the enclave app and whether the operations are used in secret-dependent execution paths, this vulnerability may also be used to mount a side-channel attack on the enclave. This has been fixed in 0.10.0 and the current master branch. Users will need to recompile their applications against the patched libraries to be protected from this vulnerability."}, {"lang": "es", "value": "En openenclave versi\u00f3n anterior a 0.10.0, los enclaves que usan operaciones x87 FPU son vulnerables a la manipulaci\u00f3n por parte de una aplicaci\u00f3n host maliciosa. Al violar la Application Binary Interface (ABI) de Linux System V para tales operaciones, una aplicaci\u00f3n host puede comprometer la integridad de ejecuci\u00f3n de algunas operaciones x87 FPU en un enclave. Dependiendo de la configuraci\u00f3n de control de FPU de la aplicaci\u00f3n de enclave y de si las operaciones se usan en rutas de ejecuci\u00f3n dependientes de secretos, esta vulnerabilidad tambi\u00e9n puede ser usada para montar un ataque de canal lateral en el enclave. Esto se ha corregido en 0.10.0 y la derivaci\u00f3n maestra actual. Los usuarios deber\u00e1n recompilar sus aplicaciones contra las bibliotecas parcheadas para estar protegidos de esta vulnerabilidad"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:N/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.8, "impactScore": 4.0}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:N/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.8, "impactScore": 4.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:H/Au:N/C:N/I:P/A:N", "accessVector": "LOCAL", "accessComplexity": "HIGH", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 1.2}, "baseSeverity": "LOW", "exploitabilityScore": 1.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:openenclave:openenclave:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.10.0", "matchCriteriaId": "AB8DA108-BE91-4BB6-84FA-710672A3A726"}]}]}], "references": [{"url": "https://github.com/openenclave/openenclave/security/advisories/GHSA-7wjx-wcwg-w999", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0005", "comment": "CVE-2020-15107 - Local Privilege Escalation via FPU Operations in Enclaves. This CVE can be used to gain local access to an enclave, which can then be used for further exploitation."}, {"techniqueID": "TA0006", "comment": "CVE-2020-15107 - Data Tampering via FPU Operations in Enclaves. This CVE can be used to tamper with data processed by an enclave, which can lead to integrity issues."}, {"techniqueID": "TA0022", "comment": "CVE-2020-15107 - X87 FPU Operations in Enclaves. This CVE uses x87 FPU operations in enclaves which can be used to exploit the vulnerability."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve-2020-15107-stix-bundle", "objects": [{"type": "indicator", "id": "https://example.com/cve-2020-15107-indicator", "name": "CVE-2020-15107 Indicator", "description": "Indicator for CVE-2020-15107", "valid_from": "2020-07-15T22:15:13.967", "valid_until": "9999-12-31T23:59:59.999", "pattern": "/**/*/*/*/*/*/*/*/*/*/*/*", " observable": {"type": "x509-certificate", "hashes": [{"type": "SHA-256", "value": "hash_val"}]}}, {"type": "course-of-action", "id": "https://example.com/cve-2020-15107-coa", "name": "MITRE Technique TA0005", "description": "Course of action for CVE-2020-15107", "related_techniques": ["TA0005"], "mitigations": ["Update to version 0.10.0 or later", "Compile enclave applications against patched libraries"]}, {"type": "note", "id": "https://example.com/cve-2020-15107-note", "name": "Defense Point", "description": "Defense point for CVE-2020-15107"}], "relationships": [{"type": "has-indicator", "id": "https://example.com/cve-2020-15107-indicator-rel", "object_id": "https://example.com/cve-2020-15107-indicator", "relationship_type": "indicates"}, {"type": "has-course-of-action", "id": "https://example.com/cve-2020-15107-coa-rel", "object_id": "https://example.com/cve-2020-15107-coa", "relationship_type": "uses"}, {"type": "has-note", "id": "https://example.com/cve-2020-15107-note-rel", "object_id": "https://example.com/cve-2020-15107-note", "relationship_type": "notes"}]}, "technical_analysis": {"Introduction": "CVE-2020-15107 is a local privilege escalation vulnerability in Open Enclave, a trusted execution environment framework. The vulnerability allows an attacker to execute code with elevated privileges by manipulating the FPU operations in an enclave.", "Impact and Scope": "The vulnerability affects all versions of Open Enclave prior to 0.10.0 and can be exploited by an attacker with local access to the system.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: TA0005, TA0006, and TA0022.", "Technical Details": "The vulnerability is caused by the improper handling of x87 FPU operations in enclaves. An attacker can exploit this vulnerability by using a malicious host application to compromise the execution integrity of the enclave.", "Detection": "This vulnerability can be detected by monitoring for unusual behavior on the system, such as changes to the FPU control word.", "Mitigation": "The vulnerability can be mitigated by updating to version 0.10.0 or later and compiling enclave applications against patched libraries.", "Conclusion": "CVE-2020-15107 is a local privilege escalation vulnerability that can be exploited by an attacker with local access to the system. The vulnerability is related to the improper handling of x87 FPU operations in enclaves and can be mitigated by updating to a patched version of Open Enclave."}, "executive_analysis": {"Overview": "CVE-2020-15107 is a local privilege escalation vulnerability in Open Enclave that can be exploited by an attacker with local access to the system. The vulnerability is related to the improper handling of x87 FPU operations in enclaves.", "Business Impact": "The vulnerability can be used to gain unauthorized access to sensitive data and systems. This can have significant business impact, including data breaches and system compromise.", "Technical Impact": "The vulnerability can be used to exploit the system and gain unauthorized access to sensitive data and systems.", "Mitigation Strategies": "The vulnerability can be mitigated by updating to a patched version of Open Enclave and ensuring that enclave applications are compiled against patched libraries.", "Recommendations": "Executives should ensure that their organization is aware of the vulnerability and is taking steps to mitigate it. This includes updating to a patched version of Open Enclave and ensuring that enclave applications are compiled against patched libraries.", "Conclusions": "CVE-2020-15107 is a local privilege escalation vulnerability in Open Enclave that can be exploited by an attacker with local access to the system. The vulnerability is related to the improper handling of x87 FPU operations in enclaves and can be mitigated by updating to a patched version of Open Enclave."}}