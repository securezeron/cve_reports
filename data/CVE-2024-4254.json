{"id": "CVE-2024-4254", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-04T12:15:13.710", "lastModified": "2024-06-04T16:57:41.053", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The 'deploy-website.yml' workflow in the gradio-app/gradio repository, specifically in the 'main' branch, is vulnerable to secrets exfiltration due to improper authorization. The vulnerability arises from the workflow's explicit checkout and execution of code from a fork, which is unsafe as it allows the running of untrusted code in an environment with access to push to the base repository and access secrets. This flaw could lead to the exfiltration of sensitive secrets such as GITHUB_TOKEN, HF_TOKEN, VERCEL_ORG_ID, VERCEL_PROJECT_ID, COMMENT_TOKEN, AWSACCESSKEYID, AWSSECRETKEY, and VERCEL_TOKEN. The vulnerability is present in the workflow file located at https://github.com/gradio-app/gradio/blob/72f4ca88ab569aae47941b3fb0609e57f2e13a27/.github/workflows/deploy-website.yml."}, {"lang": "es", "value": "El flujo de trabajo 'deploy-website.yml' en el repositorio gradio-app/gradio, espec\u00edficamente en la rama 'principal', es vulnerable a la filtraci\u00f3n de secretos debido a una autorizaci\u00f3n inadecuada. La vulnerabilidad surge de la verificaci\u00f3n expl\u00edcita del flujo de trabajo y la ejecuci\u00f3n de c\u00f3digo desde una bifurcaci\u00f3n, lo cual no es seguro ya que permite la ejecuci\u00f3n de c\u00f3digo que no es de confianza en un entorno con acceso para enviar al repositorio base y acceder a secretos. Esta falla podr\u00eda provocar la exfiltraci\u00f3n de secretos confidenciales como GITHUB_TOKEN, HF_TOKEN, VERCEL_ORG_ID, VERCEL_PROJECT_ID, COMMENT_TOKEN, AWSACCESSKEYID, AWSSECRETKEY y VERCEL_TOKEN. La vulnerabilidad est\u00e1 presente en el archivo de flujo de trabajo ubicado en https://github.com/gradio-app/gradio/blob/72f4ca88ab569aae47941b3fb0609e57f2e13a27/.github/workflows/deploy-website.yml."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 7.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.2}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-285"}]}], "references": [{"url": "https://huntr.com/bounties/59873fbd-5698-4ec3-87f9-5d70c6055d01", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-4254 - This is an example of a secrets exfiltration attack, where the 'deploy-website.yml' workflow in the gradio-app/gradio repository unintentionally allows the execution of untrusted code, leading to the exfiltration of sensitive secrets."}, {"techniqueID": "T1210", "comment": "CVE-2024-4254 - This is an example of a compromised authentication due to the explicit checkout and execution of untrusted code, leading to the unauthorized access to the gradio-app/gradio repository and exfiltration of sensitive secrets."}, {"techniqueID": "T1192", "comment": "CVE-2024-4254 - This is an example of a file access for exfiltration attack, where the 'deploy-website.yml' workflow in the gradio-app/gradio repository unintentionally allows the execution of untrusted code, leading to the exfiltration of sensitive secrets."}, {"techniqueID": "T1497", "comment": "CVE-2024-4254 - This is an example of a code execution attack, where the 'deploy-website.yml' workflow in the gradio-app/gradio repository unintentionally allows the execution of untrusted code, leading to the exfiltration of sensitive secrets."}], "stix_bundle": {"type": "bundle", "id": "bundle--ce88d0da-fa55-4c6f-b54e-cf7c9b5dd6af", "created_by_ref": "identity--03c4a8b5-8b23-4ca5-88a5-df7d7ce3f9ab", "created": "2024-06-04T12:15:13.710Z", "modified": "2024-06-04T16:57:41.053Z", "objects": [{"type": "incident", "id": "incident--b78c5c73-8f32-4a45-a2a3-1e0fed6f4a45", "created_by_ref": "identity--03c4a8b5-8b23-4ca5-88a5-df7d7ce3f9ab", "created": "2024-06-04T12:15:13.710Z", "modified": "2024-06-04T16:57:41.053Z", "name": "Incident: CVE-2024-4254", "description": "Incident related to the compromise of the 'deploy-website.yml' workflow in the gradio-app/gradio repository.", "first_observed": "2024-06-04T12:15:13.710Z", "reporter": [{"sourceName": "security@huntr.dev", "description": "security@huntr.dev"}], "related_object": [{"type": "object", "id": "object--47b7f5cd-3f14-46a8-9d3d-18d6a6c7eca4"}]}, {"type": "attack_pattern", "id": "attack_pattern--3f1e43ff-f7a6-4c14-bf4a-4dd69a5af8ac", "created_by_ref": "identity--03c4a8b5-8b23-4ca5-88a5-df7d7ce3f9ab", "created": "2024-06-04T12:15:13.710Z", "modified": "2024-06-04T16:57:41.053Z", "name": "Attack Pattern: Compromised Authentication", "description": "Attack pattern related to the compromise of the 'deploy-website.yml' workflow in the gradio-app/gradio repository."}]}, "technical_analysis": {"Introduction": "The vulnerability 'CVE-2024-4254' is a secrets exfiltration attack that affects the 'deploy-website.yml' workflow in the gradio-app/gradio repository.", "Impact and Scope": "The impact of this vulnerability is a CVSS score of 7.1, with an attack vector of NETWORK, and a confidentiality impact of HIGH.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1190, T1210, T1192, and T1497.", "Technical Details": "The vulnerability arises from the explicit checkout and execution of untrusted code in the 'deploy-website.yml' workflow.", "Detection": "Detection of this vulnerability can be done by monitoring the code execution in the 'deploy-website.yml' workflow and monitoring for suspicious activity.", "Mitigation": "Mitigation strategies for this vulnerability include implementing strict code review and validation, and reducing the privileges of the workflow executor.", "Conclusion": "In conclusion, this vulnerability is a significant risk that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The vulnerability 'CVE-2024-4254' is a critical security issue that affects the 'deploy-website.yml' workflow in the gradio-app/gradio repository.", "Business Impact": "The business impact of this vulnerability is the potential loss of sensitive data and the impact on the reputation of the organization.", "Technical Impact": "The technical impact of this vulnerability is the compromise of the 'deploy-website.yml' workflow and the potential exfiltration of sensitive data.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include implementing strict code review and validation, and reducing the privileges of the workflow executor.", "Recommendations": "We recommend that the organization implement the mitigation strategies and conduct a thorough security audit to identify and remediate any other vulnerabilities.", "Conclusions": "In conclusion, this vulnerability is a significant risk that requires immediate attention and mitigation."}}