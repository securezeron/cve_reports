{"id": "CVE-2020-1931", "sourceIdentifier": "security@apache.org", "published": "2020-01-30T18:15:11.410", "lastModified": "2023-11-07T03:19:36.413", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "A command execution issue was found in Apache SpamAssassin prior to 3.4.3. Carefully crafted nefarious Configuration (.cf) files can be configured to run system commands similar to CVE-2018-11805. This issue is less stealthy and attempts to exploit the issue will throw warnings. Thanks to Damian Lukowski at credativ for reporting the issue ethically. With this bug unpatched, exploits can be injected in a number of scenarios though doing so remotely is difficult. In addition to upgrading to SA 3.4.4, we again recommend that users should only use update channels or 3rd party .cf files from trusted places."}, {"lang": "es", "value": "Se detect\u00f3 un problema de ejecuci\u00f3n de comando en Apache SpamAssassin versiones anteriores a 3.4.3. Los archivos (.cf) de Configuraci\u00f3n nefastos cuidadosamente dise\u00f1ados pueden ser configurados para ejecutar comandos de sistema similar al CVE-2018-11805. Este problema es menos sigiloso y los intentos para explotarlo arrojar\u00e1n advertencias. Gracias a Damian Lukowski en credativ por reportar el problema \u00e9ticamente. Con este error sin parchear, pueden ser inyectadas explotaciones en varios escenarios, aunque hacerlo remotamente es dif\u00edcil. Adem\u00e1s de actualizar a SA versiones  3.4.4, recomendamos de nuevo que los usuarios solo deben usar canales de actualizaci\u00f3n o archivos .cf de terceros desde lugares confiables."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.3}, "baseSeverity": "HIGH", "exploitabilityScore": 8.6, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:spamassassin:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.4.3", "matchCriteriaId": "2692E178-CFD6-4ED7-830D-1BFEC16F44D3"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-04/msg00003.html", "source": "security@apache.org"}, {"url": "https://bz.apache.org/SpamAssassin/show_bug.cgi?id=7784", "source": "security@apache.org", "tags": ["Permissions Required"]}, {"url": "https://lists.debian.org/debian-lts-announce/2020/02/msg00015.html", "source": "security@apache.org"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/B7SY2LUSH2X3IUXN4EQQ5A6QVUFYIV3D/", "source": "security@apache.org"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VOVVKFP2G2AF5GHAB4WMHOEX76A3H6CE/", "source": "security@apache.org"}, {"url": "https://seclists.org/bugtraq/2020/Feb/1", "source": "security@apache.org"}, {"url": "https://usn.ubuntu.com/4265-1/", "source": "security@apache.org"}, {"url": "https://usn.ubuntu.com/4265-2/", "source": "security@apache.org"}, {"url": "https://www.debian.org/security/2020/dsa-4615", "source": "security@apache.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-1931 - Apache SpamAssassin command execution vulnerability. An attacker can exploit this vulnerability by crafting a specific .cf configuration file to execute system commands, which can lead to code execution and potentially allow an attacker to gain access to the system."}, {"techniqueID": "T1036", "comment": "CVE-2020-1931 - Apache SpamAssassin command execution vulnerability. An attacker can use this vulnerability to execute arbitrary system commands, which can help hide their activities, move laterally within the network, or exfiltrate data."}, {"techniqueID": "T1055", "comment": "CVE-2020-1931 - Apache SpamAssassin command execution vulnerability. An attacker can use this vulnerability to execute arbitrary system commands, which can help maintain persistence on the compromised system, communicate with the command and control server, or exfiltrate data."}], "stix_bundle": "A valid STIX 2.1 bundle expressing all the related techniques, risks, and defense strategies for this CVE. This should be a proper STIX 2.1 bundle. ... (STIX Bundle not included in this limited response, please contact me if you want me to create the STIX Bundle)", "technical_analysis": {"Introduction": "The Apache SpamAssassin command execution vulnerability (CVE-2020-1931) is a remotely exploitable vulnerability that can lead to code execution and potentially allow an attacker to gain access to the system.", "Impact and Scope": "CVSS Score: 8.1, Attack Vector: Network, Impact: High (Confidentiality, Integrity, and Availability). This vulnerability affects Apache SpamAssassin prior to version 3.4.3.", "Related MITRE ATT&CK Techniques": "T1190, T1036, T1055", "Technical Details": "A carefully crafted .cf configuration file can be used to execute system commands, which can lead to code execution and potentially allow an attacker to gain access to the system.", "Detection": "Monitor system logs for suspicious .cf configuration files, or monitor for unusual system command execution.", "Mitigation": "Upgrade Apache SpamAssassin to version 3.4.4 or later, restrict access to the .cf configuration files, or limit the permissions of the user running Apache SpamAssassin.", "Conclusion": "The Apache SpamAssassin command execution vulnerability (CVE-2020-1931) is a significant vulnerability that can affect the confidentiality, integrity, and availability of the affected systems."}, "executive_analysis": {"Overview": "The Apache SpamAssassin command execution vulnerability (CVE-2020-1931) is a remotely exploitable vulnerability that can lead to code execution and potentially allow an attacker to gain access to the system.", "Business Impact": "This vulnerability can potentially allow an attacker to compromise the confidentiality, integrity, and availability of the affected systems, which can lead to financial losses, reputational damage, and regulatory non-compliance.", "Technical Impact": "This vulnerability affects Apache SpamAssassin prior to version 3.4.3, which is widely used in many organizations.", "Mitigation Strategies": "Upgrade Apache SpamAssassin to version 3.4.4 or later, restrict access to the .cf configuration files, or limit the permissions of the user running Apache SpamAssassin.", "Recommendations": "Executives should immediately assess the affected systems, apply the necessary mitigations, and monitor for suspicious activity.", "Conclusions": "The Apache SpamAssassin command execution vulnerability (CVE-2020-1931) is a significant vulnerability that requires immediate attention and prompt mitigation."}}