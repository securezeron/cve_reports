{"id": "CVE-2020-15153", "sourceIdentifier": "security-advisories@github.com", "published": "2021-04-30T16:15:07.447", "lastModified": "2021-05-09T02:29:38.493", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Ampache before version 4.2.2 allows unauthenticated users to perform SQL injection. Refer to the referenced GitHub Security Advisory for details and a workaround. This is fixed in version 4.2.2 and the development branch."}, {"lang": "es", "value": "Ampache versiones anteriores a 4.2.2, permite a usuarios no autenticados llevar a cabo una inyecci\u00f3n SQL.&#xa0;Consulte el Aviso de seguridad de GitHub al que se hace referencia para obtener detalles y una soluci\u00f3n alternativa.&#xa0;Esto es corregido en versi\u00f3n 4.2.2 y en la rama de desarrollo."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 8.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 4.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ampache:ampache:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.2.2", "matchCriteriaId": "2058E2E3-F6DC-4174-A612-B0038C9EFB11"}]}]}], "references": [{"url": "https://github.com/ampache/ampache/commit/e92cb6154c32c513b9c07e5fdbf5ac7de81ef5ed", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/ampache/ampache/releases/tag/4.2.2", "source": "security-advisories@github.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/ampache/ampache/security/advisories/GHSA-phr3-mpx5-7826", "source": "security-advisories@github.com", "tags": ["Exploit", "Mitigation", "Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0010", "comment": "Reference: CVE-2020-15153 - This vulnerability is relevant because it allows unauthenticated users to perform SQL injection, which can lead to sensitive data exposure. To defend against this, implement secure coding practices, validate user input, and consider using a Web Application Firewall (WAF) and an Intrusion Detection System (IDS) to detect and prevent potential attacks."}, {"techniqueID": "TA0001", "comment": "Reference: CVE-2020-15153 - This vulnerability is relevant because it allows unauthenticated users to perform SQL injection, which can lead to sensitive data exposure. To defend against this, implement secure coding practices, validate user input, and consider using a WAF and an IDS to detect and prevent potential attacks."}, {"techniqueID": "TA0036", "comment": "Reference: CVE-2020-15153 - This vulnerability is relevant because it allows unauthenticated users to perform SQL injection, which can lead to sensitive data exposure. To defend against this, implement secure coding practices, validate user input, and consider using a WAF and an IDS to detect and prevent potential attacks."}], "stix_bundle": "{\"spec_version\":\"2.1\",\"stix\":{\"objects\":[{\"id\":\"ampache-sql-injection\",\"type\":\"Attack-Pattern\",\"created_by_ref\":\"http://ontology.iAmateur\",\"modified\":\"2021-05-09T02:29:38.493\",\"name\":\"Ampache SQL Injection\",\"description\":\"Ampache SQL injection vulnerability allows unauthenticated users to perform SQL injection and potentially access sensitive data.\",\"kill_chain_phases\":[{\"type\":\"Kill-Chain-Phase\",\"kill_chain_name\":\"mitre-attack\",\"phase_name\":\"Initial Access\"}],\"object_marking_refs\":[{\"type\":\"Object-Marking\",\"objective\": \"marking\",\"description\":\"Mark the attack pattern as relevant to the CVE\"}],\"related_items\":[{\"type\":\"Related-Item\",\"id\":\"ampache-sql-injection\",\"type\":\"Incident-Record\"},{\"type\":\"Related-Item\",\"id\":\"ampache-sql-injection\",\"type\":\"Finding\"},{\"type\":\"Related-Item\",\"id\":\"ampache-sql-injection\",\"type\":\"Note\"},{\"type\":\"Related-Item\",\"id\":\"ampache-sql-injection\",\"type\":\"Exploit\"},{\"type\":\"Related-Item\",\"id\":\"ampache-sql-injection\",\"type\":\"Vulnerability\"},{\"type\":\"Related-Item\",\"id\":\"ampache-sql-injection\",\"type\":\"Exploit-Package\"},{\"type\":\"Related-Item\",\"id\":\"ampache-sql-injection\",\"type\":\"CWE-89\"},{\"type\":\"Related-Item\",\"id\":\"ampache-sql-injection\",\"type\":\"CVSSv3.1\",\"score\":9.8},{\"type\":\"Related-Item\",\"id\":\"ampache-sql-injection\",\"type\":\"CVSSv3.1\",\"score\":8.2},{\"type\":\"Related-Item\",\"id\":\"ampache-sql-injection\",\"type\":\"CVSSv2.0\",\"score\":7.5}}],\"attack_pattern_refs\":[{\"type\":\"Attack-Pattern-Ref\",\"id\":\"ampache-sql-injection\",\"type\":\"CVE-2020-15153\"}]}", "technical_analysis": {"Introduction": "Ampache SQL injection vulnerability allows unauthenticated users to perform SQL injection and potentially access sensitive data, with a CVSSv3.1 score of 9.8 and 8.2, and a CVSSv2.0 score of 7.5.", "Impact and Scope": "The impact of this vulnerability is high, as it allows unauthenticated users to access sensitive data and potentially compromise the system. The scope of this vulnerability is limited to Ampache versions prior to 4.2.2.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are TA0010, TA0001, and TA0036.", "Technical Details": "The vulnerability is caused by an unvalidated user-input variable being used in a SQL query, allowing an attacker to inject arbitrary SQL code.", "Detection": "Detection methods include monitoring for unusual SQL queries, tracking user activity, and analyzing system logs for signs of SQL injection attacks.", "Mitigation": "Mitigation strategies include validating user input, limiting database access, and implementing a Web Application Firewall (WAF) and an Intrusion Detection System (IDS) to detect and prevent potential attacks.", "Conclusion": "In conclusion, the Ampache SQL injection vulnerability is a significant risk to systems running vulnerable versions of Ampache, and proper mitigation strategies are necessary to prevent exploitation."}, "executive_analysis": {"Overview": "This report provides an overview of the Ampache SQL injection vulnerability, its impact, and recommended mitigation strategies.", "Business Impact": "The business impact of this vulnerability is significant, as it potentially allows unauthenticated users to access sensitive data and compromise the system.", "Technical Impact": "The technical impact of this vulnerability is high, as it allows unauthenticated users to access sensitive data and potentially compromise the system.", "Mitigation Strategies": "Mitigation strategies include validating user input, limiting database access, and implementing a WAF and an IDS to detect and prevent potential attacks.", "Recommendations": "Recommendations for executives include prioritizing vulnerability patching, implementing robust security controls, and monitoring system logs for signs of SQL injection attacks.", "Conclusions": "In conclusion, the Ampache SQL injection vulnerability is a significant risk to systems running vulnerable versions of Ampache, and proper mitigation strategies are necessary to prevent exploitation."}}