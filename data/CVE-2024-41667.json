{"id": "CVE-2024-41667", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-24T18:15:05.310", "lastModified": "2024-08-06T20:15:39.877", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "OpenAM is an open access management solution. In versions 15.0.3 and prior, the `getCustomLoginUrlTemplate` method in RealmOAuth2ProviderSettings.java is vulnerable to template injection due to its usage of user input. Although the developer intended to implement a custom URL for handling login to override the default OpenAM login, they did not restrict the `CustomLoginUrlTemplate`, allowing it to be set freely. Commit fcb8432aa77d5b2e147624fe954cb150c568e0b8 introduces `TemplateClassResolver.SAFER_RESOLVER` to disable the resolution of commonly exploited classes in FreeMarker template injection. As of time of publication, this fix is expected to be part of version 15.0.4."}, {"lang": "es", "value": "OpenAM es una soluci\u00f3n de gesti\u00f3n de acceso abierto. En las versiones 15.0.3 y anteriores, el m\u00e9todo `getCustomLoginUrlTemplate` en RealmOAuth2ProviderSettings.java es vulnerable a la inyecci\u00f3n de plantillas debido al uso de la entrada del usuario. Aunque el desarrollador ten\u00eda la intenci\u00f3n de implementar una URL personalizada para manejar el inicio de sesi\u00f3n para anular la p\u00e1gina de inicio de sesi\u00f3n predeterminada de PingOne Advanced Identity Cloud, no restringieron la `CustomLoginUrlTemplate`, lo que permiti\u00f3 configurarla libremente. La confirmaci\u00f3n fcb8432aa77d5b2e147624fe954cb150c568e0b8 introduce `TemplateClassResolver.SAFER_RESOLVER` para deshabilitar la resoluci\u00f3n de clases com\u00fanmente explotadas en la inyecci\u00f3n de plantillas de FreeMarker. Al momento de la publicaci\u00f3n, se espera que esta soluci\u00f3n forme parte de la versi\u00f3n 15.0.4."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://github.com/OpenIdentityPlatform/OpenAM/commit/fcb8432aa77d5b2e147624fe954cb150c568e0b8", "source": "security-advisories@github.com"}, {"url": "https://github.com/OpenIdentityPlatform/OpenAM/security/advisories/GHSA-7726-43hg-m23v", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-41667 - This technique is relevant as it involves template injection, allowing an attacker to inject malicious code in the `getCustomLoginUrlTemplate` method. To defend against this, implement input validation and sanitization to prevent tampering with the template."}, {"techniqueID": "T1055", "comment": "CVE-2024-41667 - This technique is relevant as it involves remote access to a system, allowing an attacker to remotely execute code. To defend against this, restrict access to remote login methods and implement identity verification."}], "stix_bundle": {"description": "Stix Bundle for CVE-2024-41667", "vulnerability": {"id": "CVE-2024-41667", "name": "OpenAM Template Injection Vulnerability", "description": "OpenAM is an open access management solution. In versions 15.0.3 and prior, the `getCustomLoginUrlTemplate` method in RealmOAuth2ProviderSettings.java is vulnerable to template injection due to its usage of user input.", "identifiers": [{"type": "CVE", "value": "CVE-2024-41667"}], "links": [{"type": "reference", "relationship": " relates to", "object": {"id": "mitre-techniques", "type": "report"}}]}, "attack-patterns": [{"id": "attack-pattern-1", "name": "Template Injection Attack", "description": "An attacker injects malicious code into a template using user input.", "kill-chain-phases": [{"id": "initial-access", "name": "Initial Access"}, {"id": "persistence", "name": "Persistence"}, {"id": "escalation", "name": "Escalation"}, {"id": "lateral-movement", "name": "Lateral Movement"}, {"id": "delivery", "name": "Delivery"}], "mitre-techniques": [{"type": "mitre", "value": "T1190"}]}], "malware": [{"id": "malware-1", "name": "malware-1", "description": "Malware that exploits the OpenAM template injection vulnerability", "malleable": true}], "observed-data": [{"id": "observed-data-1", "name": "observed-data-1", "description": "Data collected from the OpenAM template injection vulnerability", "file": {"path": "C:\\temp\\example.txt"}}], "network-traffic": [{"id": "network-traffic-1", "name": "network-traffic-1", "description": "Network traffic associated with the OpenAM template injection vulnerability", "protocols": [{"type": "http"}]}], "report": {"id": "report-1", "name": "report-1", "description": "Report describing the OpenAM template injection vulnerability", "links": [{"type": "reference", "relationship": " relates to", "object": {"id": "vulnerability", "type": "vulnerability"}}]}}, "technical_analysis": {"Introduction": "Introduction content.", "Impact and Scope": "The OpenAM template injection vulnerability has a severity score of 8.8, with a high impact on confidentiality, integrity, and availability.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to several MITRE ATT&CK techniques, including T1190.", "Technical Details": "The vulnerability occurs in the `getCustomLoginUrlTemplate` method in RealmOAuth2ProviderSettings.java, which is vulnerable to template injection due to its usage of user input.", "Detection": "Detection of this vulnerability may involve monitoring network traffic for unusual patterns, such as requests to the `getCustomLoginUrlTemplate` method.", "Mitigation": "Mitigation strategies include implementing input validation and sanitization to prevent tampering with the template, restricting access to remote login methods, and implementing identity verification.", "Conclusion": "In conclusion, the OpenAM template injection vulnerability is a significant risk and should be mitigated by implementing the recommended countermeasures."}, "executive_analysis": {"Overview": "The OpenAM template injection vulnerability is a significant risk to organizations that use OpenAM as their access management solution.", "Business Impact": "The vulnerability could result in the compromise of sensitive data, disruption to business operations, and damage to the organization's reputation.", "Technical Impact": "The vulnerability affects the confidentiality, integrity, and availability of sensitive data and could allow an attacker to inject malicious code into the system.", "Mitigation Strategies": "The recommended mitigation strategies include implementing input validation and sanitization, restricting access to remote login methods, and implementing identity verification.", "Recommendations": "Executives should prioritize the mitigation of this vulnerability and consider implementing additional security measures to prevent similar vulnerabilities in the future.", "Conclusions": "In conclusion, the OpenAM template injection vulnerability is a significant risk that requires prompt mitigation to protect sensitive data and prevent potential attacks."}}