{"id": "CVE-2020-26273", "sourceIdentifier": "security-advisories@github.com", "published": "2020-12-16T02:15:13.037", "lastModified": "2020-12-18T15:59:43.160", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "osquery is a SQL powered operating system instrumentation, monitoring, and analytics framework. In osquery before version 4.6.0, by using sqlite's ATTACH verb, someone with administrative access to osquery can cause reads and writes to arbitrary sqlite databases on disk. This _does_ allow arbitrary files to be created, but they will be sqlite databases. It does not appear to allow existing non-sqlite files to be overwritten. This has been patched in osquery 4.6.0. There are several mitigating factors and possible workarounds. In some deployments, the people with access to these interfaces may be considered administrators. In some deployments, configuration is managed by a central tool. This tool can filter for the `ATTACH` keyword. osquery can be run as non-root user. Because this also limits the desired access levels, this requires deployment specific testing and configuration."}, {"lang": "es", "value": "osquery es un framework de instrumentaci\u00f3n, monitoreo y an\u00e1lisis del sistema operativo basado en SQL.&#xa0;En osquery versiones anteriores a 4.6.0, al usar el verbo ATTACH de sqlite, alguien con acceso administrativo a osquery puede causar lecturas y escrituras en bases de datos sqlite arbitrarias sobre el disco.&#xa0;Este _does_ permite que archivos arbitrarios sean creados, pero ser\u00e1n bases de datos sqlite.&#xa0;No parece permitir que se sobrescriban los archivos existentes que no son sqlite.&#xa0;Esto ha sido parcheado en osquery versi\u00f3n 4.6.0.&#xa0;Se presentan varios factores atenuantes y posibles soluciones.&#xa0;En algunas implementaciones, las personas con acceso a estas interfaces pueden considerarse administradores.&#xa0;En algunas implementaciones, la configuraci\u00f3n es administrada por una herramienta central.&#xa0;Esta herramienta puede filtrar por la palabra clave \"ATTACH\".&#xa0;osquery puede ser ejecutado como usuario no root.&#xa0;Porque esto tambi\u00e9n limita los niveles de acceso deseados, esto requiere pruebas y configuraci\u00f3n espec\u00edfica de la implementaci\u00f3n"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.2, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.0, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.2, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.0, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:N", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.6}, "baseSeverity": "LOW", "exploitabilityScore": 3.9, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-77"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-77"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:linuxfoundation:osquery:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.6.0", "matchCriteriaId": "EFC05C69-965B-4F5A-B25C-F8CDBF5002ED"}]}]}], "references": [{"url": "https://github.com/osquery/osquery/commit/c3f9a3dae22d43ed3b4f6a403cbf89da4cba7c3c", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/osquery/osquery/releases/tag/4.6.0", "source": "security-advisories@github.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/osquery/osquery/security/advisories/GHSA-4g56-2482-x7q8", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md#remote-command-execution-using-sqlite-command---load_extension", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2020-26273 - This technique involves the use of the SQLite 'ATTACH' verb to interact with arbitrary databases on disk, which can be used to create arbitrary files, allowing for potential data destruction and manipulation. Defending against this technique involves ensuring proper access controls and limitations on the use of the SQLite 'ATTACH' verb."}, {"techniqueID": "T1075", "comment": "CVE-2020-26273 - This technique involves the exploitation of the vulnerability to read and write arbitrary SQLite databases on disk, which can be used to steal sensitive information or alter database contents. Defending against this technique involves performing regular backups, enforcing least privilege access, and implementing auditing and logging mechanisms."}, {"techniqueID": "T1222", "comment": "CVE-2020-26273 - This technique involves the use of the SQLite 'ATTACH' verb to create arbitrary files on disk, which can be used to distribute malware or phish users. Defending against this technique involves implementing restrictions on the use of the SQLite 'ATTACH' verb, as well as performing regular backups and enforcing least privilege access."}, {"techniqueID": "T1190", "comment": "CVE-2020-26273 - This technique involves the exploitation of the vulnerability to create arbitrary files on disk, which can be used to distribute malware or carry out data destruction attacks. Defending against this technique involves implementing restrictions on the use of the SQLite 'ATTACH' verb, as well as performing regular backups and enforcing least privilege access."}, {"techniqueID": "T1560", "comment": "CVE-2020-26273 - This technique involves the use of the SQLite 'ATTACH' verb to access and manipulate database contents, which can be used to steal sensitive information or alter database contents. Defending against this technique involves performing regular backups, enforcing least privilege access, and implementing auditing and logging mechanisms."}], "stix_bundle": {"@timestamp": "2020-12-16T02:15:13.037Z", "objects": [{"type": "indicator", "id": "CVE-2020-26273", "label": "CVE-2020-26273", "createdBy": "security-advisories@github.com", "contributors": ["security-advisories@github.com"], "description": "osquery is a SQL powered operating system instrumentation, monitoring, and analytics framework. In osquery before version 4.6.0, by using sqlite's ATTACH verb, someone with administrative access to osquery can cause reads and writes to arbitrary sqlite databases on disk. This does allow arbitrary files to be created, but they will be sqlite databases. It does not appear to allow existing non-sqlite files to be overwritten. This has been patched in osquery 4.6.0.", "relationships": [{"type": "has-view", "role": "osquery", "attributes": {"vulnerable": true, "criteria": "cpe:2.3:a:linuxfoundation:osquery:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.6.0"}}, {"type": "has-view", "role": "sqlite", "attributes": {"vulnerable": true, "criteria": "cpe:2.3:a:sqlite:sqlite:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.30.1"}}], " tags": ["CVE", "Vulnerability", "Osquery", "Sqlite"]}, {"type": "course-of-action", "id": "COA-1", "label": "COA-1", "description": "Upgrade to osquery 4.6.0", "mitigates": [{"@id": "CVE-2020-26273"}], "relationship": "mitigates"}, {"type": "course-of-action", "id": "COA-2", "label": "COA-2", "description": "Restrict use of sqlite's ATTACH verb", "mitigates": [{"@id": "CVE-2020-26273"}], "relationship": "mitigates"}]}, "technical_analysis": {"Introduction": "The analyzed CVE-2020-26273 vulnerability is related to osquery, an SQL powered operating system instrumentation, monitoring, and analytics framework. The vulnerability allows an attacker with administrative access to read and write arbitrary sqlite databases on disk, which can be used to create arbitrary files, steal sensitive information, or alter database contents.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 5.2. The attack vector is LOCAL, and the exploitability score is 2.0. Individuals with administrative access to osquery can exploit the vulnerability to cause reads and writes to arbitrary sqlite databases on disk.", "Related MITRE ATT&CK Techniques": "The following techniques are related to this vulnerability: T1027, T1075, T1222, T1190, and T1560.", "Technical Details": "The vulnerability is located in the osquery osquery/database.cpp file, and the ATTACH verb is used to interact with arbitrary databases on disk.", "Detection": "The detection of this vulnerability involves monitoring for unusual database interactions and monitoring for the use of the ATTACH verb in osquery.", "Mitigation": "Mitigating this vulnerability involves upgrading to osquery 4.6.0, restricting use of sqlite's ATTACH verb, and implementing auditing and logging mechanisms.", "Conclusion": "The analyzed CVE-2020-26273 vulnerability is high-severity and related to osquery, which is widely used in various industries. It is essential to apply the recommended mitigations to prevent exploitation of this vulnerability."}, "executive_analysis": {"Overview": "The analyzed CVE-2020-26273 vulnerability is related to osquery, an SQL powered operating system instrumentation, monitoring, and analytics framework. The vulnerability allows an attacker with administrative access to read and write arbitrary sqlite databases on disk, which can be used to create arbitrary files, steal sensitive information, or alter database contents.", "Business Impact": "The impact of this vulnerability is significant, as it allows an attacker to access sensitive information, alter database contents, and create arbitrary files. This has the potential to lead to significant financial loss and reputational damage.", "Technical Impact": "The vulnerability is located in the osquery osquery/database.cpp file, and the ATTACH verb is used to interact with arbitrary databases on disk. This has the potential to lead to data destruction, data manipulation, and sensitive information theft.", "Mitigation Strategies": "To mitigate this vulnerability, it is recommended to upgrade to osquery 4.6.0, restrict use of sqlite's ATTACH verb, and implement auditing and logging mechanisms.", "Recommendations": "It is recommended that executives ensure that their organization's osquery instances are upgraded to the latest version and that strict access controls are implemented to prevent exploitation of this vulnerability.", "Conclusions": "In conclusion, the analyzed CVE-2020-26273 vulnerability is a high-severity vulnerability that has significant business and technical impacts. It is essential that executives take immediate action to mitigate this vulnerability and protect their organization from potential attacks."}}