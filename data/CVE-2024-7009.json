{"id": "CVE-2024-7009", "sourceIdentifier": "info@starlabs.sg", "published": "2024-08-06T04:16:47.040", "lastModified": "2024-08-19T17:18:50.290", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Unsanitized user-input in Calibre <= 7.15.0 allow users with permissions to perform full-text searches to achieve SQL injection on the SQLite database."}, {"lang": "es", "value": "La entrada de usuario no sanitizada en Calibre &lt;= 7.15.0 permite a los usuarios con permisos realizar b\u00fasquedas de texto completo para lograr la inyecci\u00f3n SQL en la base de datos SQLite."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 7.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.2}, {"source": "info@starlabs.sg", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.2, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 2.5}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}, {"source": "info@starlabs.sg", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:calibre-ebook:calibre:*:*:*:*:*:*:*:*", "versionEndIncluding": "7.15.0", "matchCriteriaId": "CF8FB6FA-434C-4488-8DD0-34F59D962183"}]}]}], "references": [{"url": "https://github.com/kovidgoyal/calibre/commit/d56574285e8859d3d715eb7829784ee74337b7d7", "source": "info@starlabs.sg", "tags": ["Patch"]}, {"url": "https://starlabs.sg/advisories/24/24-7009/", "source": "info@starlabs.sg", "tags": ["Exploit", "Mitigation", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "Reference: https://attack.mitre.org/wiki/Technique/T1190 - Input Validation Testing. This technique is relevant to the CVE-2024-7009 as it involves testing of user-input for potential SQL injection vulnerabilities."}, {"techniqueID": "T1027", "comment": "Reference: https://attack.mitre.org/wiki/Technique/T1027 - Reverse Shell. The CVE-2024-7009 allows an attacker with permissions to perform full-text searches to achieve SQL injection on the SQLite database, which could be used to execute reverse shell payloads."}, {"techniqueID": "T1059", "comment": "Reference: https://attack.mitre.org/wiki/Technique/T1059 - Command and Scripting Interpreter. The CVE-2024-7009 can be used to inject arbitrary SQL commands and execute arbitrary code on the SQLite database, which is a common technique for executing shell commands."}, {"techniqueID": "T1046", "comment": "Reference: https://attack.mitre.org/wiki/Technique/T1046 - Network Service Scanning. The CVE-2024-7009 allows an attacker to perform full-text searches on the SQLite database, which could be used to scan the network for vulnerable services."}], "technical_analysis": {"Introduction": "The CVE-2024-7009 is a SQL injection vulnerability in Calibre <= 7.15.0, allowing an attacker with permissions to perform full-text searches to achieve SQL injection on the SQLite database.", "Impact and Scope": "The vulnerability has a CVSS score of 7.1 (High) with a base severity of Medium, and an attack vector of Network.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1190, T1027, T1059, and T1046.", "Technical Details": "The vulnerability occurs due to unsanitized user-input, which can be used to inject arbitrary SQL commands and execute arbitrary code on the SQLite database.", "Detection": "Detection can be performed using custom SQL queries or database monitoring tools, such as sniffing network traffic for suspicious queries.", "Mitigation": "Mitigation strategies include implementing input validation and sanitization, limiting permissions for full-text searches, and patching the affected version.", "Conclusion": "The CVE-2024-7009 is a high-severity vulnerability that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The CVE-2024-7009 is a critical vulnerability that can allow attackers to perform SQL injection attacks.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to data breaches and system compromise.", "Technical Impact": "The technical impact of this vulnerability is the potential for sensitive data exposure and system compromise.", "Mitigation Strategies": "Implement input validation and sanitization, limit permissions for full-text searches, and patch the affected version.", "Recommendations": "Recommendations for executives include prioritizing remediation, conducting regular security assessments, and ensuring compliance with industry standards.", "Conclusions": "In conclusion, the CVE-2024-7009 is a critical vulnerability that requires immediate attention and remediation to prevent potential attacks."}}