{"id": "CVE-2023-52625", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-03-26T18:15:09.040", "lastModified": "2024-03-27T12:29:41.530", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/amd/display: Refactor DMCUB enter/exit idle interface\n\n[Why]\nWe can hang in place trying to send commands when the DMCUB isn't\npowered on.\n\n[How]\nWe need to exit out of the idle state prior to sending a command,\nbut the process that performs the exit also invokes a command itself.\n\nFixing this issue involves the following:\n\n1. Using a software state to track whether or not we need to start\n   the process to exit idle or notify idle.\n\nIt's possible for the hardware to have exited an idle state without\ndriver knowledge, but entering one is always restricted to a driver\nallow - which makes the SW state vs HW state mismatch issue purely one\nof optimization, which should seldomly be hit, if at all.\n\n2. Refactor any instances of exit/notify idle to use a single wrapper\n   that maintains this SW state.\n\nThis works simialr to dc_allow_idle_optimizations, but works at the\nDMCUB level and makes sure the state is marked prior to any notify/exit\nidle so we don't enter an infinite loop.\n\n3. Make sure we exit out of idle prior to sending any commands or\n   waiting for DMCUB idle.\n\nThis patch takes care of 1/2. A future patch will take care of wrapping\nDMCUB command submission with calls to this new interface."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: drm/amd/display: Refactor DMCUB entra/sale de la interfaz inactiva [Por qu\u00e9] Podemos quedarnos quietos intentando enviar comandos cuando el DMCUB no est\u00e1 encendido. [C\u00f3mo] Necesitamos salir del estado inactivo antes de enviar un comando, pero el proceso que realiza la salida tambi\u00e9n invoca un comando en s\u00ed. Solucionar este problema implica lo siguiente: 1. Usar un estado de software para rastrear si necesitamos o no iniciar el proceso para salir de inactivo o notificarlo. Es posible que el hardware haya salido de un estado inactivo sin el conocimiento del controlador, pero ingresar a uno siempre est\u00e1 restringido a un permiso del controlador, lo que hace que el problema de discrepancia entre el estado del SW y el estado del HW sea puramente de optimizaci\u00f3n, que rara vez deber\u00eda solucionarse, en todo caso. . 2. Refactorice cualquier instancia de salida/notificaci\u00f3n inactiva para utilizar un contenedor \u00fanico que mantenga este estado de software. Esto funciona de manera similar a dc_allow_idle_optimizations, pero funciona en el nivel DMCUB y garantiza que el estado est\u00e9 marcado antes de cualquier notificaci\u00f3n/salida inactiva para que no entremos en un bucle infinito. 3. Aseg\u00farese de salir del modo inactivo antes de enviar cualquier comando o esperar a que DMCUB est\u00e9 inactivo. Este parche se ocupa de la mitad. Un parche futuro se encargar\u00e1 de empaquetar el env\u00edo de comandos DMCUB con llamadas a esta nueva interfaz."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/820c3870c491946a78950cdf961bf40e28c1025f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8e57c06bf4b0f51a4d6958e15e1a99c9520d00fa", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1083", "comment": "CVE-2023-52625 - This vulnerability can lead to a kernel hang, which can be exploited by attackers to maintain a presence on the system. This can be mitigated by refactoring DMCUB idle interfaces, tracking software state, and ensuring the exit out of idle prior to sending commands."}, {"techniqueID": "T1044", "comment": "CVE-2023-52625 - This vulnerability can lead to a bug caused by a software state vs hardware state mismatch, which can be exploited by attackers to maintain a presence on the system. This can be mitigated by implementing software state tracking and ensuring the exit out of idle prior to sending commands."}, {"techniqueID": "T1176", "comment": "CVE-2023-52625 - This vulnerability can lead to a software state mismatch, which can be exploited by attackers to maintain a presence on the system. This can be mitigated by implementing software state tracking and ensuring the exit out of idle prior to sending commands."}], "technical_analysis": {"Introduction": "A vulnerability in the Linux kernel has been resolved in the drm/amd/display module. The vulnerability allows an attacker to hang the system by exploiting a bug in the DMCUB idle interface.", "Impact and Scope": "The vulnerability has a potential CVSS score of 7.5 and an attack vector of network attack.", "Related MITRE ATT&CK Techniques": "T1083, T1044, T1176", "Technical Details": "The vulnerability occurs when the DMCUB idle interface is exited without notifying the hardware. This can lead to a software state vs hardware state mismatch.", "Detection": "The vulnerability can be detected by monitoring system logs for hangs and crashes.", "Mitigation": "The vulnerability can be mitigated by refactoring the DMCUB idle interface to track software state and ensure the exit out of idle prior to sending commands.", "Conclusion": "The vulnerability is resolved, but it's still important to implement mitigation strategies to prevent future exploitation."}, "executive_analysis": {"Overview": "A vulnerability in the Linux kernel has been resolved in the drm/amd/display module.", "Business Impact": "The vulnerability has a potential business impact of decreased system availability and increased maintenance costs.", "Technical Impact": "The vulnerability has a potential technical impact of system crashes and hangs.", "Mitigation Strategies": "Implement mitigation strategies to prevent future exploitation, such as refactoring the DMCUB idle interface to track software state and ensure the exit out of idle prior to sending commands.", "Recommendations": "Recommendation to system administrators is to monitor system logs for hangs and crashes and to implement mitigation strategies as soon as possible.", "Conclusions": "The vulnerability is resolved, but it's still important to implement mitigation strategies to prevent future exploitation."}}