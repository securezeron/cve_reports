{
    "id": "CVE-2022-36760",
    "sourceIdentifier": "security@apache.org",
    "published": "2023-01-17T20:15:11.580",
    "lastModified": "2023-09-08T22:15:10.133",
    "vulnStatus": "Modified",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "Inconsistent Interpretation of HTTP Requests ('HTTP Request Smuggling') vulnerability in mod_proxy_ajp of Apache HTTP Server allows an attacker to smuggle requests to the AJP server it forwards requests to.  This issue affects Apache HTTP Server Apache HTTP Server 2.4 version 2.4.54 and prior versions."
        },
        {
            "lang": "es",
            "value": "Una vulnerabilidad de interpretaci\u00f3n inconsistente de solicitudes HTTP (\"contrabando de solicitudes HTTP\") en mod_proxy_ajp del servidor HTTP Apache permite a un atacante contrabandear solicitudes al servidor AJP al que las reenv\u00eda. Este problema afecta al servidor Apache HTTP Server 2.4 versi\u00f3n 2.4.54 y versiones anteriores."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H",
                    "attackVector": "NETWORK",
                    "attackComplexity": "HIGH",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "CHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH",
                    "baseScore": 9.0,
                    "baseSeverity": "CRITICAL"
                },
                "exploitabilityScore": 2.2,
                "impactScore": 6.0
            }
        ]
    },
    "weaknesses": [
        {
            "source": "security@apache.org",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-444"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:apache:http_server:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "2.4.0",
                            "versionEndExcluding": "2.4.55",
                            "matchCriteriaId": "D0A3B324-BA2F-404C-9E0D-6E810296BEA2"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https://httpd.apache.org/security/vulnerabilities_24.html",
            "source": "security@apache.org",
            "tags": [
                "Mailing List",
                "Vendor Advisory"
            ]
        },
        {
            "url": "https://security.gentoo.org/glsa/202309-01",
            "source": "security@apache.org"
        }
    ],
    "techniques": [
        {
            "techniqueID": "T1047",
            "comment": "CVE-2022-36760 - Apache HTTP Server mod_proxy_ajp HTTP Request Smuggling vulnerability allows an attacker to smuggle requests to the AJP server, which is a Command and Control (C2) server, making it a possible T1047 technique. This vulnerability can be used to manipulate and control the requests made to the AJP server, enabling command execution and data exfiltration."
        },
        {
            "techniqueID": "T1048",
            "comment": "CVE-2022-36760 - Apache HTTP Server mod_proxy_ajp HTTP Request Smuggling vulnerability allows an attacker to smuggle requests to the AJP server, which is a possible C2 server, making it a possible T1048 technique. This vulnerability can be used to manipulate and control the requests made to the AJP server, enabling command execution and data exfiltration."
        },
        {
            "techniqueID": "T1055",
            "comment": "CVE-2022-36760 - Apache HTTP Server mod_proxy_ajp HTTP Request Smuggling vulnerability allows an attacker to smuggle requests to the AJP server, which is a possible C2 server, making it a possible T1055 technique. This vulnerability can be used to manipulate and control the requests made to the AJP server, enabling command execution and data exfiltration."
        },
        {
            "techniqueID": "T1210",
            "comment": "CVE-2022-36760 - Apache HTTP Server mod_proxy_ajp HTTP Request Smuggling vulnerability allows an attacker to smuggle requests to the AJP server, which is a possible C2 server, making it a possible T1210 technique. This vulnerability can be used to manipulate and control the requests made to the AJP server, enabling command execution and data exfiltration."
        }
    ],
    "technical_analysis": {
        "Introduction": "The Apache HTTP Server mod_proxy_ajp HTTP Request Smuggling vulnerability (CVE-2022-36760) allows an attacker to smuggle requests to the AJP server, enabling command execution and data exfiltration. This vulnerability affects Apache HTTP Server 2.4 version 2.4.54 and prior versions.",
        "Impact and Scope": "The vulnerability is exposed when an attacker sends a request to the Apache HTTP Server that contains misinterpreted HTTP headers, allowing the request to be smuggled to the AJP server. This can result in unauthorized access to sensitive data and systems.",
        "Related MITRE ATT&CK Techniques": "T1047: Web Shell, T1048: Web Application Confidentiality Impaired, T1055: exfiltration, T1210: Remote Access Tools.",
        "Technical Details": "The vulnerability is a result of the inconsistent interpretation of HTTP requests by the Apache HTTP Server mod_proxy_ajp module. When a request is made to the Apache HTTP Server, the module may not correctly parse the request, allowing an attacker to smuggle requests to the AJP server.",
        "Detection": "To detect this vulnerability, it is recommended to monitor network traffic for suspicious requests and analyze logs for any evidence of irregular request patterns.",
        "Mitigation": "To mitigate this vulnerability, it is recommended to upgrade to a patched version of Apache HTTP Server 2.4, configure mod_proxy_ajp to use a secure protocol, and monitor network traffic for suspicious requests.",
        "Conclusion": "The Apache HTTP Server mod_proxy_ajp HTTP Request Smuggling vulnerability is a critical issue that can allow an attacker to smuggle requests to the AJP server, enabling command execution and data exfiltration. It is essential to upgrade to a patched version of Apache HTTP Server 2.4 and implement additional security measures to prevent exploitation."
    },
    "executive_analysis": {
        "Overview": "The Apache HTTP Server mod_proxy_ajp HTTP Request Smuggling vulnerability is a critical issue that can allow an attacker to smuggle requests to the AJP server, enabling command execution and data exfiltration.",
        "Business Impact": "The vulnerability can result in the loss of sensitive data, financial losses, and reputational damage.",
        "Technical Impact": "The vulnerability can be used to manipulate and control the requests made to the AJP server, enabling command execution and data exfiltration.",
        "Mitigation Strategies": "Upgrade to a patched version of Apache HTTP Server 2.4, configure mod_proxy_ajp to use a secure protocol, and monitor network traffic for suspicious requests.",
        "Recommendations": "Executives should prioritize the upgrade to a patched version of Apache HTTP Server 2.4 and implement additional security measures to prevent exploitation.",
        "Conclusions": "The Apache HTTP Server mod_proxy_ajp HTTP Request Smuggling vulnerability is a critical issue that requires immediate attention and action."
    }
}