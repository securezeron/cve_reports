{"id": "CVE-2024-41178", "sourceIdentifier": "security@apache.org", "published": "2024-07-23T17:15:12.663", "lastModified": "2024-08-01T13:58:24.173", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Exposure of temporary credentials in logs\u00a0in Apache Arrow Rust Object Store (`object_store` crate), version 0.10.1 and earlier on all platforms using AWS WebIdentityTokens.\u00a0\n\nOn certain error conditions, the logs may contain the OIDC token passed to  AssumeRoleWithWebIdentity https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithWebIdentity.html . This allows someone with access to the logs to impersonate that identity, including performing their own calls to AssumeRoleWithWebIdentity, until the OIDC token expires. Typically OIDC tokens are valid for up to an hour, although this will vary depending on the issuer.\n\nUsers are recommended to use a different AWS authentication mechanism, disable logging or upgrade to version 0.10.2, which fixes this issue.\n\nDetails:\n\nWhen using AWS WebIdentityTokens with the object_store crate, in the event of a failure and automatic retry, the underlying reqwest error, including the full URL with the credentials, potentially in the parameters, is written to the logs.\u00a0\n\nThanks to Paul\u00a0Hatcherian for reporting this vulnerability"}, {"lang": "es", "value": "Exposici\u00f3n de credenciales temporales en registros en Apache Arrow Rust Object Store (caja `object_store`), versi\u00f3n 0.10.1 y anteriores en todas las plataformas que utilizan AWS WebIdentityTokens. En determinadas condiciones de error, los registros pueden contener el token OIDC pasado a AssumeRoleWithWebIdentity https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithWebIdentity.html. Esto permite que alguien con acceso a los registros se haga pasar por esa identidad, incluida la realizaci\u00f3n de sus propias llamadas a AssumeRoleWithWebIdentity, hasta que caduque el token OIDC. Normalmente, los tokens OIDC son v\u00e1lidos por hasta una hora, aunque esto variar\u00e1 seg\u00fan el emisor. Se recomienda a los usuarios utilizar un mecanismo de autenticaci\u00f3n de AWS diferente, deshabilitar el registro o actualizar a la versi\u00f3n 0.10.2, que soluciona este problema. Detalles: cuando se utilizan AWS WebIdentityTokens con la caja object_store, en caso de error y reintento autom\u00e1tico, el error de solicitud subyacente, incluida la URL completa con las credenciales, potencialmente en los par\u00e1metros, se escribe en los registros. Gracias a Paul Hatcherian por informar de esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@apache.org", "type": "Primary", "description": [{"lang": "en", "value": "CWE-532"}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/07/23/3", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread/3t0povdppnt2czv6crlsqhvyko93kcrg", "source": "security@apache.org"}], "techniques": [{"techniqueID": "T1568", "comment": "CVE-2024-41178 - Exposure of temporary credentials in logs allows attackers to impersonate identities and perform unauthorized actions"}, {"techniqueID": "T1190", "comment": "CVE-2024-41178 - Discretionary logging and error handling allows attackers to manipulate and obtain sensitive information"}, {"techniqueID": "T1228", "comment": "CVE-2024-41178 - Lack of access controls and auditing allows attackers to exploit and maintain unauthorized access"}, {"techniqueID": "T1071", "comment": "CVE-2024-41178 - Authentication and credentials management flaws allow attackers to assume legitimate identities and perform unauthorized actions"}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2024-41178", "created_by_ref": "https://cve.mitre.org/schema/cve/2.11#CVE", "modified": "2024-08-01T13:58:24.173", "name": "Apache Arrow Rust Object Store Object Storage Logout Exposes OIDC Tokens", "description": "Exposure of temporary credentials in logs in Apache Arrow Rust Object Store (object_store crate), version 0.10.1 and earlier on all platforms using AWS WebIdentityTokens.", "cvss_score": 7.5, "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attack_vector": "NETWORK", "attack_complexity": "LOW", "privileges_required": "NONE", "user_interaction": "NONE", "scope": "UNCHANGED", "confidentiality_impact": "HIGH", "integrity_impact": "NONE", "availability_impact": "NONE", "capec_id": ["http://capec.mitre.org/capec/CAPEC-1"]}, {"type": "intrusion-set", "id": "CVE-2024-41178-IntrusionSet", "created_by_ref": "https://cve.mitre.org/schema/cve/2.11#CVE", "modified": "2024-08-01T13:58:24.173", "name": "Apache Arrow Rust Object Store Object Storage Logout Exposes OIDC Tokens", "description": "Intrusion set exploiting CVE-2024-41178", "mitre_tactics": ["Persistence", "Defense Evasion"]}, {"type": "alert", "id": "CVE-2024-41178-Alert", "created_by_ref": "https://cve.mitre.org/schema/cve/2.11#CVE", "modified": "2024-08-01T13:58:24.173", "name": "Apache Arrow Rust Object Store Object Storage Logout Exposes OIDC Tokens", "description": "Alert triggered by detection of CVE-2024-41178 exploit attempts"}], "relationship": [{"relationship_type": "exploits", "from": "CVE-2024-41178-IntrusionSet", "to": "CVE-2024-41178"}, {"relationship_type": "detected_by", "from": "CVE-2024-41178-Alert", "to": "CVE-2024-41178"}, {"relationship_type": "mitigated_by", "from": "CVE-2024-41178-Mitigation", "to": "CVE-2024-41178"}]}, "technical_analysis": {"Introduction": "The CVE-2024-41178 vulnerability in the Apache Arrow Rust Object Store (object_store crate) allows attackers to expose temporary credentials in logs, potentially leading to the assumption of legitimate identities and the performance of unauthorized actions.", "Impact and Scope": "The impact of the vulnerability is High, with a CVSS score of 7.5. The attack vector is NETWORK, and the attack complexity is LOW.", "Related MITRE ATT&CK Techniques": "T1568, T1190, T1228, T1071", "Technical Details": "The vulnerability occurs when the `object_store` crate logs error messages, which may contain temporary credentials (OIDC tokens) used for AWS WebIdentityTokens.", "Detection": "Detection involves monitoring logs for suspicious activity and alerting on anomalies. This can be done using various tools and techniques, such as intrusion detection systems, log aggregation, and data analytics.", "Mitigation": "Mitigation involves implementing secure logging practices, disabling logging, and upgrading to the patched version 0.10.2.", "Conclusion": "In conclusion, the CVE-2024-41178 vulnerability in the Apache Arrow Rust Object Store (object_store crate) is a significant threat to system security and should be addressed promptly."}, "executive_analysis": {"Overview": "The CVE-2024-41178 vulnerability in the Apache Arrow Rust Object Store (object_store crate) is a critical security issue that has the potential to compromise system security.", "Business Impact": "The impact of the vulnerability is significant, as it can allow attackers to assume legitimate identities and perform unauthorized actions, potentially leading to data breaches, financial losses, and damage to reputation.", "Technical Impact": "The vulnerability has technical implications, as it can allow attackers to exploit the system and gain access to sensitive data and systems.", "Mitigation Strategies": "Implement secure logging practices, disable logging, and upgrade to the patched version 0.10.2.", "Recommendations": "Recommended actions for executives include implementing security controls, monitoring logs, and conducting regular security audits and testing.", "Conclusions": "In conclusion, prompt action is necessary to address the CVE-2024-41178 vulnerability and protect system security."}}