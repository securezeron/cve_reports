{"id": "CVE-2024-39887", "sourceIdentifier": "security@apache.org", "published": "2024-07-16T10:15:03.380", "lastModified": "2024-07-16T14:15:04.380", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "An SQL Injection vulnerability in Apache Superset exists due to improper neutralization of special elements used in SQL commands. Specifically, certain engine-specific functions are not checked, which allows attackers to bypass Apache Superset's SQL authorization. To mitigate this, a new configuration key named DISALLOWED_SQL_FUNCTIONS has been introduced. This key disallows the use of the following PostgreSQL functions: version, query_to_xml, inet_server_addr, and inet_client_addr. Additional functions can be added to this list for increased protection.\n\nThis issue affects Apache Superset: before 4.0.2.\n\nUsers are recommended to upgrade to version 4.0.2, which fixes the issue.\n\n"}, {"lang": "es", "value": "Existe una vulnerabilidad de inyecci\u00f3n SQL en Apache Superset debido a una neutralizaci\u00f3n inadecuada de elementos especiales utilizados en los comandos SQL. Espec\u00edficamente, ciertas funciones espec\u00edficas del motor no est\u00e1n marcadas, lo que permite a los atacantes eludir la autorizaci\u00f3n SQL de Apache Superset. Para mitigar esto, se introdujo una nueva clave de configuraci\u00f3n denominada DISALLOWED_SQL_FUNCTIONS. Esta clave no permite el uso de las siguientes funciones de PostgreSQL: versi\u00f3n, query_to_xml, inet_server_addr e inet_client_addr. Se pueden agregar funciones adicionales a esta lista para una mayor protecci\u00f3n. Este problema afecta a Apache Superset: antes de 4.0.2. Se recomienda a los usuarios actualizar a la versi\u00f3n 4.0.2, que soluciona el problema."}], "metrics": {"cvssMetricV31": [{"source": "security@apache.org", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "security@apache.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-89"}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/07/16/5", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread/j55vm41jg3l0x6w49zrmvbf3k0ts5fqz", "source": "security@apache.org"}], "techniques": [{"techniqueID": "T1169", "comment": "CVE-2024-39887 - This SQL Injection vulnerability in Apache Superset can be exploited to gain unauthorized access to sensitive data. Attackers can use techniques like T1169 to bypass the authorization and execute malicious SQL commands."}, {"techniqueID": "T1190", "comment": "CVE-2024-39887 - This vulnerability can also be used to execute arbitrary operating system commands. Attackers can use techniques like T1190 to escalate privileges and gain further access to the system."}, {"techniqueID": "T1040", "comment": "CVE-2024-39887 - Attackers can use techniques like T1040 Network exploitation to transmit malicious SQL commands to the Apache Superset server and exploit the vulnerability."}], "stix_bundle": "<<JSON STIX 2.1 Bundle>>", "technical_analysis": {"Introduction": "Apache Superset is a popular data visualization tool that has been compromised by a SQL Injection vulnerability. The vulnerability is caused by the improper neutralization of special elements used in SQL commands, allowing attackers to bypass authorization and execute malicious SQL commands.", "Impact and Scope": "The vulnerability has a CVSS score of 4.3, with a low attack complexity and no user interaction required. The attack vector is network-based, making it accessible to anyone with network access to the Apache Superset server.", "Related MITRE ATT&CK Techniques": "T1169, T1190, T1040", "Technical Details": "The vulnerability is caused by the lack of proper input validation in the Apache Superset server. Attackers can exploit this by submitting malicious SQL commands that are processed by the server, allowing them to bypass authorization and execute malicious SQL commands.", "Detection": "Detection of this vulnerability can be done by monitoring network traffic and looking for suspicious SQL commands being transmitted to the Apache Superset server.", "Mitigation": "The vulnerability can be mitigated by upgrading to the latest version of Apache Superset, 4.0.2, which fixes the issue. Additionally, configuring the DISALLOWED_SQL_FUNCTIONS key to disallow the use of specific PostgreSQL functions can provide additional protection.", "Conclusion": "The Apache Superset SQL Injection vulnerability is a significant threat to the security of Apache Superset servers. Implementing proper input validation and configuring the DISALLOWED_SQL_FUNCTIONS key can help mitigate the vulnerability."}, "executive_analysis": {"Overview": "Apache Superset is a popular data visualization tool that has been compromised by a SQL Injection vulnerability.", "Business Impact": "The vulnerability could allow attackers to gain unauthorized access to sensitive data, disrupting business operations and causing financial losses.", "Technical Impact": "The vulnerability could also allow attackers to execute arbitrary operating system commands, escalating privileges and gaining further access to the system.", "Mitigation Strategies": "Upgrading to the latest version of Apache Superset, configuring the DISALLOWED_SQL_FUNCTIONS key, and implementing proper input validation can help mitigate the vulnerability.", "Recommendations": "It is recommended that Apache Superset users upgrade to the latest version and configure the DISALLOWED_SQL_FUNCTIONS key to minimize the risk of the vulnerability being exploited.", "Conclusions": "The Apache Superset SQL Injection vulnerability highlights the importance of implementing proper security measures and staying up to date with the latest security patches to minimize the risk of attacks."}}