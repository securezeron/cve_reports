{"id": "CVE-2024-43407", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-21T15:15:09.397", "lastModified": "2024-08-23T16:20:42.363", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "CKEditor4 is an open source what-you-see-is-what-you-get HTML editor. A potential vulnerability has been discovered in CKEditor 4 Code Snippet GeSHi plugin. The vulnerability allowed a reflected XSS attack by exploiting a flaw in the GeSHi syntax highlighter library hosted by the victim. The GeSHi library was included as a vendor dependency in CKEditor 4 source files. In a specific scenario, an attacker could craft a malicious script that could be executed by sending a request to the GeSHi library hosted on a PHP web server. The GeSHi library is no longer actively maintained. Due to the lack of ongoing support and updates, potential security vulnerabilities have been identified with its continued use. To mitigate these risks and enhance the overall security of the CKEditor 4, we have decided to completely remove the GeSHi library as a dependency. This change aims to maintain a secure environment and reduce the risk of any security incidents related to outdated or unsupported software. The fix is be available in version 4.25.0-lts."}, {"lang": "es", "value": "CKEditor4 es un editor HTML de c\u00f3digo abierto de lo que ves es lo que obtienes. Se ha descubierto una vulnerabilidad potencial en el complemento GeSHi del fragmento de c\u00f3digo de CKEditor 4. La vulnerabilidad permiti\u00f3 un ataque XSS reflejado al explotar una falla en la librer\u00eda de resaltado de sintaxis GeSHi alojada por la v\u00edctima. La librer\u00eda GeSHi se incluy\u00f3 como dependencia del proveedor en los archivos fuente de CKEditor 4. En un escenario espec\u00edfico, un atacante podr\u00eda crear un script malicioso que podr\u00eda ejecutarse enviando una solicitud a la librer\u00eda GeSHi alojada en un servidor web PHP. La librer\u00eda GeSHi ya no se mantiene activamente. Debido a la falta de soporte y actualizaciones continuas, se han identificado posibles vulnerabilidades de seguridad con su uso continuo. Para mitigar estos riesgos y mejorar la seguridad general de CKEditor 4, hemos decidido eliminar por completo la librer\u00eda GeSHi como dependencia. Este cambio tiene como objetivo mantener un entorno seguro y reducir el riesgo de incidentes de seguridad relacionados con software desactualizado o sin soporte. La soluci\u00f3n estar\u00e1 disponible en la versi\u00f3n 4.25.0-lts."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ckeditor:ckeditor:*:*:*:*:lts:*:*:*", "versionStartIncluding": "4.0", "versionEndExcluding": "4.25.0", "matchCriteriaId": "C4754AC3-7A7F-4BFA-BD12-066EE0C46FC3"}]}]}], "references": [{"url": "https://github.com/ckeditor/ckeditor4/commit/71072c9f7f263329841bd38e7e5309074c82ef94", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/ckeditor/ckeditor4/commit/951e7d75fcbcaa2590b0719fb0bb0dd0539ca6fa", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/ckeditor/ckeditor4/security/advisories/GHSA-7r32-vfj5-c2jv", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-43407 - A potential vulnerability (CWE-79) in CKEditor 4 Code Snippet GeSHi plugin allows an attacker to craft a malicious script that can be executed by sending a request to the GeSHi library hosted on a PHP web server. Relevant to T1190 as it is a reflected XSS attack."}, {"techniqueID": "T1499", "comment": "CVE-2024-43407 - A potential vulnerability (CWE-79) in CKEditor 4 Code Snippet GeSHi plugin allows an attacker to craft a malicious script that can be executed by sending a request to the GeSHi library hosted on a PHP web server. Relevant to T1499 as it is an attempt to exploit a vulnerable library."}, {"techniqueID": "T1049", "comment": "CVE-2024-43407 - A potential vulnerability (CWE-79) in CKEditor 4 Code Snippet GeSHi plugin allows an attacker to craft a malicious script that can be executed by sending a request to the GeSHi library hosted on a PHP web server. Relevant to T1049 as it is a web application vulnerability."}], "stix_bundle": {"type": "bundle", "id": " Bundle--a4f3be78-964a-4a13-911f-92a1d9d7c8f5", "timestamp": "2024-08-21T15:15:09", "created_by_ref": "identity--5c9c8c7c-07a5-4196-b3d9-ab4c3f7a3d43", "modified": "2024-08-23T16:20:42", "objects": [{"type": "incident", "id": "Incident--c2a3519c-8f3e-4396-a92f-92a1d9d7c8f5", "created_by_ref": "identity--5c9c8c7c-07a5-4196-b3d9-ab4c3f7a3d43", "modified": "2024-08-23T16:20:42", "first_seen": "2024-08-21T15:15:09", "last_seen": "2024-08-23T16:20:42", "description": "A potential vulnerability (CWE-79) in CKEditor 4 Code Snippet GeSHi plugin allows an attacker to craft a malicious script that can be executed by sending a request to the GeSHi library hosted on a PHP web server.", "labels": ["vulnerability", "cve-2024-43407"], " relations": [{"type": "indicates", "id_refs": {"bundle--a4f3be78-964a-4a13-911f-92a1d9d7c8f5": "Bundle--a4f3be78-964a-4a13-911f-92a1d9d7c8f5"}}]}, {"type": "technique", "id": "Tactic--7c92ae4f-f6c9-4324-a3cd-76a0b33f90f2", "created_by_ref": "identity--5c9c8c7c-07a5-4196-b3d9-ab4c3f7a3d43", "modified": "2024-08-23T16:20:42", "name": "Command and Control", "description": "Command and Control", "labels": ["c2"]}, {"type": "course_of_action", "id": "Course_of_Action--5bbd4f96-6e3c-4fca-b9f7-92a1d9d7c8f5", "created_by_ref": "identity--5c9c8c7c-07a5-4196-b3d9-ab4c3f7a3d43", "modified": "2024-08-23T16:20:42", "title": "Update geSHi library and remove it as a dependency", "description": "Update geSHi library and remove it as a dependency", "course_of_action_points": [{"type": "note", "content": "Update geSHi library", "references": [{"type": "attack_pattern", "id_refs": {"T1190": "attack_pattern--e6f51114-cb13-4435-b5b4-76a0b33f90f2"}}]}, {"type": "note", "content": "Remove geSHi library as a dependency", "references": [{"type": "attack_pattern", "id_refs": {"T1499": "attack_pattern--e6f51114-cb13-4435-b5b4-76a0b33f90f2"}}]}]}]}, "technical_analysis": {"Introduction": "The vulnerability (CWE-79) in CKEditor 4 Code Snippet geSHi plugin allows an attacker to craft a malicious script that can be executed by sending a request to the geSHi library hosted on a PHP web server.", "Impact and Scope": "The vulnerability has a CVSS score of 6.1 and is classified as a medium severity risk.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1190, T1499, and T1049.", "Technical Details": "The vulnerability is due to the lack of input validation and sanitization in the geSHi library, which allows an attacker to inject malicious code.", "Detection": "The vulnerability can be detected by monitoring for suspicious traffic patterns and logs.", "Mitigation": "The vulnerability can be mitigated by updating the geSHi library and removing it as a dependency.", "Conclusion": "The vulnerability in CKEditor 4 Code Snippet geSHi plugin is a serious threat that can be exploited by attackers to gain unauthorized access to systems."}, "executive_analysis": {"Overview": "The vulnerability in CKEditor 4 Code Snippet geSHi plugin is a potential security risk that can be exploited by attackers to gain unauthorized access to systems.", "Business Impact": "The vulnerability can lead to data breaches, financial losses, and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to execute malicious code and gain unauthorized access to systems.", "Mitigation Strategies": "Update geSHi library and remove it as a dependency.", "Recommendations": "Recommendations for executives include updating geSHi library and removing it as a dependency, monitoring for suspicious traffic patterns, and implementing incident response plans.", "Conclusions": "The vulnerability in CKEditor 4 Code Snippet geSHi plugin is a serious threat that requires immediate attention and mitigation."}}