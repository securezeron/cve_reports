{"id": "CVE-2007-2679", "sourceIdentifier": "cve@mitre.org", "published": "2007-05-15T00:19:00.000", "lastModified": "2008-09-05T21:23:44.050", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHP file inclusion vulnerability in index.php in Ivan Peevski gallery 0.3 in Simple PHP Scripts (sphp) allows remote attackers to execute arbitrary PHP code via a UNC share pathname or a local file pathname in the gallery parameter, which is accessed by the file_exists function.  NOTE: the provenance of this information is unknown; the details are obtained solely from third party information."}, {"lang": "es", "value": "Vulnerabilidad de inclusi\u00f3n remota de archivo en PHP en  index.php en Ivan Peevski gallery 0.3 en Simple PHP Scripts (sphp) permite a atacantes remotos ejecutar c\u00f3digo de su elecci\u00f3n a trav\u00e9s nombre de ruta UNC UNC o nombre de ruta de archivo local en el par\u00e1metro gallery, el cual es accedido por la funci\u00f3n file_exists. NOTA: la procedencia de esta informaci\u00f3n es desconocida; los detalles han sido obtenidos a partir de la informaci\u00f3n de terceros. \r\n"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:simple_php_scripts_gallery:simple_php_scripts_gallery:0.3:*:*:*:*:*:*:*", "matchCriteriaId": "499F4118-F859-4BC2-BAD2-D0B66C520FB1"}]}]}], "references": [{"url": "http://secunia.com/advisories/24912", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.attrition.org/pipermail/vim/2007-April/001536.html", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/23534", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "XML External Entity (XXE) Injection - The vulnerability allows an attacker to inject XML code, which can lead to various attacks such as data theft, defacement, and even server takeover. This technique is relevant and can be used to exploit this vulnerability."}, {"techniqueID": "T1594", "comment": "Command and Scripting Interpreter - The vulnerability allows an attacker to execute arbitary PHP code, which can lead to various attacks such as data theft, defacement, and even server takeover. This technique is relevant and can be used to exploit this vulnerability."}, {"techniqueID": "T1210", "comment": "Map Information Behavior - Attackers can use this technique to map the targeted network and identify potential vulnerable systems. In this case, the vulnerability's lack of proper input validation can be used to execute arbitary PHP code, which can provide attackers with further access and control."}], "stix_bundle": [{"type": "bundle", "id": "bundle--6a7c4a15-f6ee-4d29-85da-35537b0f51d3", "created_by_ref": "identity--e26a1f4c-144d-4d4a-b9e6-e5e4a64c6f69", "created": "2023-02-22T13:00:00.000Z", "modified": "2023-02-22T13:00:00.000Z", "objects": [{"type": "vulnerability", "id": "vulnerability--77a32a41-97ce-4c37-8c6e-e6bb8e7f1aa7", "created_by_ref": "identity--e26a1f4c-144d-4d4a-b9e6-e5e4a64c6f69", "created": "2023-02-22T13:00:00.000Z", "modified": "2023-02-22T13:00:00.000Z", "name": "CVE-2007-2679", "description": "PHP file inclusion vulnerability in index.php in Ivan Peevski gallery 0.3 in Simple PHP Scripts (sphp) allows remote attackers to execute arbitrary PHP code via a UNC share pathname or a local file pathname in the gallery parameter, which is accessed by the file_exists function.", "severity": "High", "exploit_code_maturity": "Functional", "exploit_available": true, "exploited": true, "discovered_by_ref": ["identity--e26a1f4c-144d-4d4a-b9e6-e5e4a64c6f69"], "relevant_to_ref": ["course_of_action--e1ad1447-f98a-4cda-b20c-9e52a21a44e0", "note--4b1b43f6-c0a9-4a96-b5e7-94478b3d01e8", "note--e53b4a2c-f57b-41e0-be14-d43b34f2f53d"]}, {"type": "course_of_action", "id": "course_of_action--e1ad1447-f98a-4cda-b20c-9e52a21a44e0", "created_by_ref": "identity--e26a1f4c-144d-4d4a-b9e6-e5e4a64c6f69", "created": "2023-02-22T13:00:00.000Z", "modified": "2023-02-22T13:00:00.000Z", "name": "Patch and Update", "description": "Apply patches and updates to the vulnerable PHP scripts to prevent exploitation.", "related_to_ref": ["vulnerability--77a32a41-97ce-4c37-8c6e-e6bb8e7f1aa7"]}, {"type": "note", "id": "note--4b1b43f6-c0a9-4a96-b5e7-94478b3d01e8", "created_by_ref": "identity--e26a1f4c-144d-4d4a-b9e6-e5e4a64c6f69", "created": "2023-02-22T13:00:00.000Z", "modified": "2023-02-22T13:00:00.000Z", "content": "Apply input validation and sanitization to prevent XXE injection attacks.", "related_to_ref": ["vulnerability--77a32a41-97ce-4c37-8c6e-e6bb8e7f1aa7", "course_of_action--e1ad1447-f98a-4cda-b20c-9e52a21a44e0"]}, {"type": "note", "id": "note--e53b4a2c-f57b-41e0-be14-d43b34f2f53d", "created_by_ref": "identity--e26a1f4c-144d-4d4a-b9e6-e5e4a64c6f69", "created": "2023-02-22T13:00:00.000Z", "modified": "2023-02-22T13:00:00.000Z", "content": "Monitor and analyze logs for unusual network activity to detect potential exploitation.", "related_to_ref": ["vulnerability--77a32a41-97ce-4c37-8c6e-e6bb8e7f1aa7", "course_of_action--e1ad1447-f98a-4cda-b20c-9e52a21a44e0"]}]}], "technical_analysis": {"Introduction": "The CVE-2007-2679 vulnerability is a PHP file inclusion vulnerability in the Ivan Peevski gallery 0.3 in Simple PHP Scripts (sphp) that allows remote attackers to execute arbitrary PHP code.", "Impact and Scope": "The vulnerability has a CVSS score of 6.8 and an attack vector of 'NETWORK' with a medium complexity. This vulnerability can be exploited remotely and allows attackers to execute arbitrary PHP code.", "Related MITRE ATT&CK Techniques": "T1190, T1594, T1210", "Technical Details": "The vulnerability is due to the lack of proper input validation and sanitization in the 'gallery' parameter in the index.php file. This allows attackers to inject arbitrary PHP code which can lead to various attacks such as data theft, defacement and even server takeover.", "Detection": "Detecting this vulnerability can be challenging, but monitoring and analyzing logs for unusual network activity can help to detect potential exploitation.", "Mitigation": "Apply patches and updates to the vulnerable PHP scripts, and implement input validation and sanitization to prevent XXE injection attacks.", "Conclusion": "The CVE-2007-2679 vulnerability is a critical vulnerability that can be exploited remotely to execute arbitrary PHP code. It is essential to apply patches and updates to the vulnerable PHP scripts and implement input validation and sanitization to prevent XXE injection attacks."}, "executive_analysis": {"Overview": "The CVE-2007-2679 vulnerability is a critical vulnerability in PHP scripts that allows remote attackers to execute arbitrary code.", "Business Impact": "The vulnerability can have significant business implications, including data theft, defacement, and even server takeover.", "Technical Impact": "The vulnerability has a significant technical impact, allowing attackers to execute arbitrary PHP code remotely.", "Mitigation Strategies": "Apply patches and updates to the vulnerable PHP scripts, and implement input validation and sanitization to prevent XXE injection attacks.", "Recommendations": "Apply patches and updates to the vulnerable PHP scripts, and implement input validation and sanitization to prevent XXE injection attacks.", "Conclusions": "The CVE-2007-2679 vulnerability is a critical vulnerability that requires immediate attention and mitigation."}}