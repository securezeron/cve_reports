{"id": "CVE-2024-26845", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-17T10:15:10.137", "lastModified": "2024-06-27T12:15:21.423", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: target: core: Add TMF to tmr_list handling\n\nAn abort that is responded to by iSCSI itself is added to tmr_list but does\nnot go to target core. A LUN_RESET that goes through tmr_list takes a\nrefcounter on the abort and waits for completion. However, the abort will\nbe never complete because it was not started in target core.\n\n Unable to locate ITT: 0x05000000 on CID: 0\n Unable to locate RefTaskTag: 0x05000000 on CID: 0.\n wait_for_tasks: Stopping tmf LUN_RESET with tag 0x0 ref_task_tag 0x0 i_state 34 t_state ISTATE_PROCESSING refcnt 2 transport_state active,stop,fabric_stop\n wait for tasks: tmf LUN_RESET with tag 0x0 ref_task_tag 0x0 i_state 34 t_state ISTATE_PROCESSING refcnt 2 transport_state active,stop,fabric_stop\n...\n INFO: task kworker/0:2:49 blocked for more than 491 seconds.\n task:kworker/0:2     state:D stack:    0 pid:   49 ppid:     2 flags:0x00000800\n Workqueue: events target_tmr_work [target_core_mod]\nCall Trace:\n __switch_to+0x2c4/0x470\n _schedule+0x314/0x1730\n schedule+0x64/0x130\n schedule_timeout+0x168/0x430\n wait_for_completion+0x140/0x270\n target_put_cmd_and_wait+0x64/0xb0 [target_core_mod]\n core_tmr_lun_reset+0x30/0xa0 [target_core_mod]\n target_tmr_work+0xc8/0x1b0 [target_core_mod]\n process_one_work+0x2d4/0x5d0\n worker_thread+0x78/0x6c0\n\nTo fix this, only add abort to tmr_list if it will be handled by target\ncore."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: scsi: target: core: agregar TMF al manejo de tmr_list. Una cancelaci\u00f3n a la que responde iSCSI se agrega a tmr_list pero no va al n\u00facleo de destino. Un LUN_RESET que pasa por tmr_list toma un refcounter al cancelar y espera a que se complete. Sin embargo, la cancelaci\u00f3n nunca se completar\u00e1 porque no se inici\u00f3 en el n\u00facleo de destino. No se puede ubicar ITT: 0x05000000 en CID: 0 No se puede ubicar RefTaskTag: 0x05000000 en CID: 0. wait_for_tasks: Deteniendo tmf LUN_RESET con etiqueta 0x0 ref_task_tag 0x0 i_state 34 t_state ISTATE_PROCESSING refcnt 2 transport_state active,stop,fabric_stop esperar tareas: t mf LUN_RESET con etiqueta 0x0 ref_task_tag 0x0 i_state 34 t_state ISTATE_PROCESSING refcnt 2 transport_state active,stop,fabric_stop ... INFORMACI\u00d3N: tarea kworker/0:2:49 bloqueada durante m\u00e1s de 491 segundos. tarea:kworker/0:2 estado:D pila: 0 pid: 49 ppid: 2 banderas:0x00000800 Cola de trabajo: eventos target_tmr_work [target_core_mod] Seguimiento de llamadas: __switch_to+0x2c4/0x470 _schedule+0x314/0x1730 Schedule+0x64/0x130 Schedule_timeout+0x168 /0x430 wait_for_completion+0x140/0x270 target_put_cmd_and_wait+0x64/0xb0 [target_core_mod] core_tmr_lun_reset+0x30/0xa0 [target_core_mod] target_tmr_work+0xc8/0x1b0 [target_core_mod] work_thread+0x78/0x6c0 Para solucionar este problema, solo agregue abort a tmr_list si ser\u00e1 manejado por el n\u00facleo objetivo."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/11f3fe5001ed05721e641f0ecaa7a73b7deb245d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/168ed59170de1fd7274080fe102216162d6826cf", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/36bc5040c863b44af06094b22f1e50059227b9cb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/425a571a7e6fc389954cf2564e1edbba3740e171", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/83ab68168a3d990d5ff39ab030ad5754cbbccb25", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/a9849b67b4402a12eb35eadc9306c1ef9847d53d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/bd508f96b5fef96d8a0ce9cbb211d82bcfc2341f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e717bd412001495f17400bfc09f606f1b594ef5a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1078", "comment": "CVE-2024-26845 is related to the 'Valid Accounts' technique. Attackers may use this vulnerability to gain elevated privileges on a Linux system by exploiting the 'scsi: target: core: Add TMF to tmr_list handling' bug, allowing them to execute system commands with superuser privileges. This technique is relevant to the CVE because it involves exploiting a vulnerability in the Linux kernel to gain unauthorized access."}, {"techniqueID": "T1222", "comment": "The 'Data Encapsulation' technique may also be applicable to CVE-2024-26845. Attackers could use this vulnerability to encapsulate data within an ISCSI command and then exploit the bug to gain unauthorized access to the system. This technique is relevant because it involves modifying data to exploit the vulnerability, which could aid in future attacks."}, {"techniqueID": "T1190", "comment": "The 'Path Manipulation' technique may also be applicable to CVE-2024-26845. Attackers may manipulate file paths or command-line arguments to exploit the vulnerability and gain unauthorized access. This technique is relevant because it involves modifying system paths or command-line arguments to manipulate system behavior and exploit the vulnerability."}, {"techniqueID": "T1204", "comment": "The 'File and Directory Discovery' technique may also be applicable to CVE-2024-26845. Attackers could use this vulnerability to scan the file system and discover sensitive information, which could aid in future attacks. This technique is relevant because it involves using the vulnerability to gather information about the system and its potential vulnerabilities."}], "stix_bundle": {"@ xsi:schemaLocation": "http://stix.mitre.org/XMLSchema/2.1 core", "stix_Bundle": {"id": "bundle:CVE-2024-26845", "name": "CVE-2024-26845 STIX Bundle", "description": "STIX bundle for CVE-2024-26845 vulnerability", "created": "2024-06-27T12:15:21.423", "modified": "2024-06-27T12:15:21.423", "objects": [{"id": "object:CVE-2024-26845", "type": "vulnerability", "name": "CVE-2024-26845", "description": "A Linux kernel vulnerability allowing attackers to gain unauthorized access.", "scanner_detection": "False", "exploit_status": "Exploitation_Awaits", "impact": "High", "attack_vector": ["Network"], "cvss_score": "9.8/10", "cwe_id": ["[]"], "related": {"vulnerability_attack_pattern": [{"id": "vulnerability_attack_pattern:unix-shell", "relationship": "related_to", "description": "A vulnerability attack pattern exploiting a Linux kernel vulnerability."}]}}, {"id": "object:T1078", "type": "attack_pattern", "name": "T1078: Valid Accounts", "description": "A technique involving exploiting valid system accounts.", "created": "2024-06-27T12:15:21.423", "modified": "2024-06-27T12:15:21.423", "related": [{"id": "vulnerability:CVE-2024-26845", "relationship": "exploits", "description": "Exploits CVE-2024-26845 to gain elevated privileges."}]}, {"id": "object:T1222", "type": "attack_pattern", "name": "T1222: Data Encapsulation", "description": "A technique involving encapsulating data within another protocol.", "created": "2024-06-27T12:15:21.423", "modified": "2024-06-27T12:15:21.423", "related": [{"id": "vulnerability:CVE-2024-26845", "relationship": "uses", "description": "Uses CVE-2024-26845 to encapsulate data."}]}, {"id": "object:T1190", "type": "attack_pattern", "name": "T1190: Path Manipulation", "description": "A technique involving manipulating system paths or command-line arguments.", "created": "2024-06-27T12:15:21.423", "modified": "2024-06-27T12:15:21.423", "related": [{"id": "vulnerability:CVE-2024-26845", "relationship": "exploits", "description": "Exploits CVE-2024-26845 by manipulating system paths or command-line arguments."}]}, {"id": "object:T1204", "type": "attack_pattern", "name": "T1204: File and Directory Discovery", "description": "A technique involving discovering files and directories on a system.", "created": "2024-06-27T12:15:21.423", "modified": "2024-06-27T12:15:21.423", "related": [{"id": "vulnerability:CVE-2024-26845", "relationship": "uses", "description": "Uses CVE-2024-26845 to discover files and directories on a system."}]}]}}, "technical_analysis": {"Introduction": "CVE-2024-26845 is a Linux kernel vulnerability allowing attackers to gain unauthorized access to the system.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 9.8/10. It affects all Linux systems running the affected kernel version.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1078: Valid Accounts, T1222: Data Encapsulation, T1190: Path Manipulation, and T1204: File and Directory Discovery.", "Technical Details": "The vulnerability occurs when the Linux kernel fails to properly handle TMF (Target Management Framework) commands, allowing attackers to execute system commands with superuser privileges.", "Detection": "Detection of this vulnerability is challenging, as it requires detecting and analyzing system calls and kernel activity.", "Mitigation": "Mitigation strategies include updating to the latest kernel version, disabling unnecessary ISCSI targets, and implementing strict access controls.", "Conclusion": "In conclusion, CVE-2024-26845 is a high-severity vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-26845 is a critical Linux kernel vulnerability that allows attackers to gain unauthorized access to the system.", "Business Impact": "The business impact of this vulnerability is significant, as it could be used to compromise sensitive data and disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is high, as it affects all Linux systems running the affected kernel version.", "Mitigation Strategies": "Mitigation strategies include updating to the latest kernel version, disabling unnecessary ISCSI targets, and implementing strict access controls.", "Recommendations": "Recommendations for executives include prioritizing vulnerability remediation, implementing robust incident response, and conducting regular security assessments.", "Conclusions": "In conclusion, CVE-2024-26845 is a critical vulnerability that requires immediate attention and mitigation to protect the business."}}