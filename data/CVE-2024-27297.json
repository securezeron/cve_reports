{"id": "CVE-2024-27297", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-11T22:15:55.277", "lastModified": "2024-03-12T12:40:13.500", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Nix is a package manager for Linux and other Unix systems. A fixed-output derivations on Linux can send file descriptors to files in the Nix store to another program running on the host (or another fixed-output derivation) via Unix domain sockets in the abstract namespace. This allows to modify the output of the derivation, after Nix has registered the path as \"valid\" and immutable in the Nix database. In particular, this allows the output of fixed-output derivations to be modified from their expected content. This issue has been addressed in versions 2.3.18 2.18.2 2.19.4 and 2.20.5. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Nix es un administrador de paquetes para Linux y otros sistemas Unix. Una derivaci\u00f3n de salida fija en Linux puede enviar descriptores de archivos en el almac\u00e9n Nix a otro programa que se ejecuta en el host (u otra derivaci\u00f3n de salida fija) a trav\u00e9s de sockets de dominio Unix en el espacio de nombres abstracto. Esto permite modificar la salida de la derivaci\u00f3n, despu\u00e9s de que Nix haya registrado la ruta como \"v\u00e1lida\" e inmutable en la base de datos de Nix. En particular, esto permite modificar la salida de derivaciones de salida fija respecto de su contenido esperado. Este problema se solucion\u00f3 en las versiones 2.3.18 2.18.2 2.19.4 y 2.20.5. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:L", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 6.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 4.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-367"}]}], "references": [{"url": "https://github.com/NixOS/nix/commit/f8170ce9f119e5e6724eb81ff1b5a2d4c0024000", "source": "security-advisories@github.com"}, {"url": "https://github.com/NixOS/nix/security/advisories/GHSA-2ffj-w4mj-pg37", "source": "security-advisories@github.com"}, {"url": "https://hackmd.io/03UGerewRcy3db44JQoWvw", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-27297 - This vulnerability is related to T1027, Lateral Movement, as it allows an attacker to modify the output of a fixed-output derivation, potentially leading to a elevation of privilege or data exfiltration."}, {"techniqueID": "T1518", "comment": "CVE-2024-27297 - This vulnerability is related to T1518, Software Deployment Tools, as it involves the modification of software output to achieve malicious goals."}, {"techniqueID": "T1546", "comment": "CVE-2024-27297 - This vulnerability is related to T1546, Create or Modify System Log, as it allows an attacker to manipulate the system logs to hide their activities."}, {"techniqueID": "T1172", "comment": "CVE-2024-27297 - This vulnerability is related to T1172, File and Directory Discovery, as it involves the creation and modification of files and directories to achieve malicious goals."}], "technical_analysis": {"Introduction": "The CVE-2024-27297 vulnerability is a fixed-output derivation vulnerability in Nix, a package manager for Linux and other Unix systems. This vulnerability allows an attacker to modify the output of a fixed-output derivation, potentially leading to a elevation of privilege or data exfiltration.", "Impact and Scope": "The impact of this vulnerability is medium, with a CVSS score of 6.3 and an attack vector of ADJACENT_NETWORK. The scope of this vulnerability is limited to Linux and other Unix systems that use Nix.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1027, T1518, T1546, and T1172.", "Technical Details": "The vulnerability is due to the fact that fixed-output derivations in Nix can send file descriptors to files in the Nix store to another program running on the host (or another fixed-output derivation) via Unix domain sockets in the abstract namespace. This allows an attacker to modify the output of a fixed-output derivation after Nix has registered the path as valid and immutable in the Nix database.", "Detection": "The detection of this vulnerability is challenging, as it requires knowledge of the Nix package manager and the specific configurations used in the environment. However, the vulnerability can be detected by monitoring system logs and file modifications.", "Mitigation": "The mitigation for this vulnerability is to upgrade to a version of Nix that is not affected by this vulnerability. Users are advised to upgrade to a version of Nix that addresses this vulnerability.", "Conclusion": "The CVE-2024-27297 vulnerability is a critical vulnerability that affects the Nix package manager. It allows an attacker to modify the output of a fixed-output derivation, potentially leading to a elevation of privilege or data exfiltration. Users are advised to upgrade to a version of Nix that addresses this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-27297 vulnerability is a critical vulnerability that affects the Nix package manager. It allows an attacker to modify the output of a fixed-output derivation, potentially leading to a elevation of privilege or data exfiltration.", "Business Impact": "The business impact of this vulnerability is significant, as it could allow an attacker to gain unauthorized access to sensitive data or systems.", "Technical Impact": "The technical impact of this vulnerability is the potential for an attacker to elevate privileges or exfiltrate data.", "Mitigation Strategies": "The mitigation strategy for this vulnerability is to upgrade to a version of Nix that addresses this vulnerability. Users are advised to prioritize this upgrade and monitor their systems for any signs of malicious activity.", "Recommendations": "We recommend that all users of Nix upgrade to a version that addresses this vulnerability as soon as possible. Additionally, users should monitor their systems for any signs of malicious activity and implement additional security measures to protect against this vulnerability.", "Conclusions": "In conclusion, the CVE-2024-27297 vulnerability is a critical vulnerability that affects the Nix package manager. It allows an attacker to modify the output of a fixed-output derivation, potentially leading to a elevation of privilege or data exfiltration. We recommend that all users of Nix upgrade to a version that addresses this vulnerability and monitor their systems for any signs of malicious activity."}}