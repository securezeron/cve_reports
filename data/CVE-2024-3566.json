{
    "id": "CVE-2024-3566",
    "sourceIdentifier": "cret@cert.org",
    "published": "2024-04-10T16:15:16.083",
    "lastModified": "2025-06-25T20:24:12.743",
    "vulnStatus": "Analyzed",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "A command inject vulnerability allows an attacker to perform command injection on Windows applications that indirectly depend on the CreateProcess function when the specific conditions are satisfied."
        },
        {
            "lang": "es",
            "value": "Una vulnerabilidad de inyecci\u00f3n de comandos permite a un atacante realizar inyecci\u00f3n de comandos en aplicaciones de Windows que dependen indirectamente de la funci\u00f3n CreateProcess cuando se cumplen las condiciones espec\u00edficas."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
                    "baseScore": 9.8,
                    "baseSeverity": "CRITICAL",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 3.9,
                "impactScore": 5.9
            },
            {
                "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
                    "baseScore": 9.8,
                    "baseSeverity": "CRITICAL",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "HIGH"
                },
                "exploitabilityScore": 3.9,
                "impactScore": 5.9
            }
        ]
    },
    "weaknesses": [
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-77"
                }
            ]
        }
    ],
    "configurations": [
        {
            "operator": "AND",
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:golang:go:*:*:*:*:*:*:*:*",
                            "matchCriteriaId": "2E708195-E45A-411A-AAF5-4417D5C7812B"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:haskell:process_library:1.6.19.0:*:*:*:*:*:*:*",
                            "matchCriteriaId": "755FA0B2-7E78-4416-9FB8-262C56D3E56B"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:nodejs:node.js:*:*:*:*:-:*:*:*",
                            "versionEndIncluding": "21.7.2",
                            "matchCriteriaId": "FA780E04-1B07-40CA-8B6B-874DE37C3785"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
                            "matchCriteriaId": "58A8B39D-57DF-4D71-BBCA-1D5A19E0A1B9"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:rust-lang:rust:1.77.2:*:*:*:*:*:*:*",
                            "matchCriteriaId": "E275AF66-3988-4223-9896-43AFFEE4581B"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:yt-dlp_project:yt-dlp:*:*:*:*:*:*:*:*",
                            "matchCriteriaId": "9E5FBD75-34B4-4FA0-A38A-3BE8A79B9F7D"
                        }
                    ]
                },
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": false,
                            "criteria": "cpe:2.3:o:microsoft:windows:-:*:*:*:*:*:*:*",
                            "matchCriteriaId": "A2572D17-1DE6-457B-99CC-64AFD54487EA"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https://flatt.tech/research/posts/batbadbut-you-cant-securely-execute-commands-on-windows/",
            "source": "cret@cert.org",
            "tags": [
                "Exploit",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://kb.cert.org/vuls/id/123335",
            "source": "cret@cert.org",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://learn.microsoft.com/en-us/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way",
            "source": "cret@cert.org",
            "tags": [
                "Technical Description"
            ]
        },
        {
            "url": "https://www.cve.org/CVERecord?id=CVE-2024-1874",
            "source": "cret@cert.org",
            "tags": [
                "Not Applicable"
            ]
        },
        {
            "url": "https://www.cve.org/CVERecord?id=CVE-2024-22423",
            "source": "cret@cert.org",
            "tags": [
                "Not Applicable"
            ]
        },
        {
            "url": "https://www.cve.org/CVERecord?id=CVE-2024-24576",
            "source": "cret@cert.org",
            "tags": [
                "Not Applicable"
            ]
        },
        {
            "url": "https://www.kb.cert.org/vuls/id/123335",
            "source": "cret@cert.org",
            "tags": [
                "Not Applicable"
            ]
        },
        {
            "url": "https://flatt.tech/research/posts/batbadbut-you-cant-securely-execute-commands-on-windows/",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Exploit",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://kb.cert.org/vuls/id/123335",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://learn.microsoft.com/en-us/archive/blogs/twistylittlepassagesallalike/everyone-quotes-command-line-arguments-the-wrong-way",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Technical Description"
            ]
        },
        {
            "url": "https://www.cve.org/CVERecord?id=CVE-2024-1874",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Not Applicable"
            ]
        },
        {
            "url": "https://www.cve.org/CVERecord?id=CVE-2024-22423",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Not Applicable"
            ]
        },
        {
            "url": "https://www.cve.org/CVERecord?id=CVE-2024-24576",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Not Applicable"
            ]
        },
        {
            "url": "https://www.kb.cert.org/vuls/id/123335",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Not Applicable"
            ]
        }
    ],
    "techniques": [
        {
            "techniqueID": "T1055 - Command and Control",
            "comment": "CVE-2024-3566 - This command inject vulnerability allows an attacker to perform command injection on Windows applications that indirectly depend on the CreateProcess function when the specific conditions are satisfied. Defense strategies include isolating and validating user input to prevent command injection attacks."
        },
        {
            "techniqueID": "T1056 - Execution",
            "comment": "CVE-2024-3566 - This vulnerability allows an attacker to execute arbitrary commands on vulnerable systems. Defense strategies include implementing mitigations such as data execution prevention (DEP) and address space layout randomization (ASLR) to prevent exploitation of this vulnerability."
        },
        {
            "techniqueID": "T1407 - Brokered Execution",
            "comment": "CVE-2024-3566 - This vulnerability can be used to broker execution of arbitrary code on vulnerable systems. Defense strategies include implementing mitigations such as data execution prevention (DEP) and address space layout randomization (ASLR) to prevent exploitation of this vulnerability."
        },
        {
            "techniqueID": "T1086 - File and Directory Discovery",
            "comment": "CVE-2024-3566 - This vulnerability allows an attacker to gather information about files and directories on vulnerable systems, which can be used to plan further attacks. Defense strategies include monitoring file system access and implementing access controls to limit discovery of sensitive information."
        },
        {
            "techniqueID": "T1112 - Modify Registry",
            "comment": "CVE-2024-3566 - This vulnerability allows an attacker to modify the registry on vulnerable systems, which can be used to persist on the system and evade detection. Defense strategies include monitoring registry changes and implementing access controls to limit modifications."
        }
    ],
    "technical_analysis": {
        "Introduction": "This analysis discusses a command inject vulnerability in Windows applications that can be exploited to perform arbitrary command injection.",
        "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and can be exploited remotely over a network. The attack vector is local.",
        "Related MITRE ATT&CK Techniques": "T1055, T1056, T1407, T1086, T1112.",
        "Technical Details": "The vulnerability is caused by a command inject vulnerability in the CreateProcess function, which can be used to inject arbitrary commands and code.",
        "Detection": "Defense techniques include monitoring system calls for suspicious command injection attempts.",
        "Mitigation": "Defense mitigations include implementing mitigations such as data execution prevention (DEP) and address space layout randomization (ASLR) to prevent exploitation of this vulnerability.",
        "Conclusion": "This vulnerability can be exploited to perform arbitrary command injection and can have significant impact on vulnerable systems."
    },
    "executive_analysis": {
        "Overview": "This vulnerability in Windows applications allows attackers to perform command injection and can have significant impact on vulnerable systems.",
        "Business Impact": "This vulnerability can lead to unauthorized access to sensitive data, system compromise, and potentially financial loss.",
        "Technical Impact": "The vulnerability can be used to execute arbitrary code on vulnerable systems, allowing attackers to pivot and gain further access to the system.",
        "Mitigation Strategies": "Implementing mitigations such as data execution prevention (DEP) and address space layout randomization (ASLR) can help prevent exploitation of this vulnerability.",
        "Recommendations": "Recommendations for executives include identifying and patching vulnerable systems, implementing monitoring and detection techniques, and increasing user awareness of the vulnerability.",
        "Conclusions": "This vulnerability is a significant threat and requires immediate attention to prevent exploitation and minimize impact."
    }
}