{"id": "CVE-2023-5331", "sourceIdentifier": "responsibledisclosure@mattermost.com", "published": "2023-10-09T11:15:11.280", "lastModified": "2023-10-12T18:31:39.367", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Mattermost fails to properly check the creator of an attached file when adding the file to a draft post,\u00a0potentially exposing unauthorized file information.\n\n"}, {"lang": "es", "value": "Mattermost no verifica adecuadamente el creador de un archivo adjunto al agregar el fichero a un borrador de publicaci\u00f3n, lo que potencialmente expone informaci\u00f3n del archivo no autorizada."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-862"}]}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-862"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost_server:*:*:*:*:*:*:*:*", "versionEndExcluding": "7.8.11", "matchCriteriaId": "714E3E9F-A35A-456F-B198-C1CBD09169C6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost_server:*:*:*:*:*:*:*:*", "versionStartIncluding": "8.0.0", "versionEndExcluding": "8.0.3", "matchCriteriaId": "135D194F-2285-4EB4-9963-5BCB97F6BC6B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost_server:*:*:*:*:*:*:*:*", "versionStartIncluding": "8.1.0", "versionEndExcluding": "8.1.2", "matchCriteriaId": "AC20942B-35AD-4EF5-8878-6E112865E3D5"}]}]}], "references": [{"url": "https://mattermost.com/security-updates", "source": "responsibledisclosure@mattermost.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1221", "comment": "Account Discovery - The vulnerability allows an attacker to gather information about the users, such as their usernames, email addresses, and hashed passwords. CVE-2023-5331 - This is relevant because it provides an opportunity for attackers to build profiles of users, which can be used for social engineering attacks."}, {"techniqueID": "T1027", "comment": "Obfuscated Files or Code - The vulnerability allows an attacker to upload files with malicious code that can evade detection. CVE-2023-5331 - This is relevant because it provides an opportunity for attackers to exfiltrate data or execute malicious code without detection."}, {"techniqueID": "T1204", "comment": "Email Collection - The vulnerability allows an attacker to collect email addresses of users, which can be used for phishing or spamming attacks. CVE-2023-5331 - This is relevant because it provides an opportunity for attackers to gather information about users' email accounts."}, {"techniqueID": "T1133", "comment": "File and Directory Discovery - The vulnerability allows an attacker to discover file and directory structures on the affected system. CVE-2023-5331 - This is relevant because it provides an opportunity for attackers to gather information about the system's file structure, which can be used for further exploitation."}, {"techniqueID": "T1538", "comment": "Command and Control - The vulnerability allows an attacker to establish a command and control (C2) channel with the compromised system. CVE-2023-5331 - This is relevant because it provides an opportunity for attackers to remotely control the compromised system and execute malicious commands."}], "technical_analysis": {"Introduction": "Mattermost server fails to properly check the creator of an attached file when adding the file to a draft post, potentially exposing unauthorized file information.", "Impact and Scope": "The vulnerability has a CVSS score of 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) with a medium severity rating. It affects Mattermost server versions 7.8.11 and earlier, 8.0.0 to 8.0.3, and 8.1.0 to 8.1.2.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are Account Discovery, Obfuscated Files or Code, Email Collection, File and Directory Discovery, and Command and Control.", "Technical Details": "The vulnerability occurs when the Mattermost server fails to check the creator of an attached file when adding the file to a draft post, allowing an attacker to manipulate the file information.", "Detection": "Detection methods include monitoring for suspicious file uploads, monitoring for sensitive data exposure, and monitoring for command and control channel establishment.", "Mitigation": "Mitigation strategies include patching the vulnerable versions of Mattermost server, monitoring for suspicious file uploads, and monitoring for command and control channel establishment.", "Conclusion": "The vulnerability allows attackers to exploit the Mattermost server, potentially exposing unauthorized file information. Detection and mitigation strategies are crucial to prevent further exploitation."}, "executive_analysis": {"Overview": "The vulnerability in Mattermost server allows attackers to exploit the system, potentially exposing unauthorized file information.", "Business Impact": "The vulnerability can result in unauthorized file information exposure, which can be used for malicious purposes such as data theft or social engineering attacks.", "Technical Impact": "The vulnerability can be exploited by attackers to gain unauthorized access to sensitive data, which can lead to data breach and potential financial losses.", "Mitigation Strategies": "Patching the vulnerable version of Mattermost server, monitoring for suspicious file uploads, and monitoring for command and control channel establishment are crucial mitigation strategies.", "Recommendations": "We recommend patching the vulnerable version of Mattermost server, monitoring for suspicious file uploads, and monitoring for command and control channel establishment. It is also recommended to implement Incident Response and Contingency Planning strategies to minimize potential damage.", "Conclusions": "The vulnerability in Mattermost server requires immediate attention, and mitigation strategies must be implemented to prevent further exploitation."}}