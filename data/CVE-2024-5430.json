{"id": "CVE-2024-5430", "sourceIdentifier": "cve@gitlab.com", "published": "2024-06-27T00:15:12.650", "lastModified": "2024-06-28T13:17:34.380", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered in GitLab CE/EE affecting all versions starting from 16.10 prior to 16.11.5, starting from 17.0 prior to 17.0.3, and starting from 17.1 prior to 17.1.1, which allows a project maintainer can delete the merge request approval policy via graphQL."}, {"lang": "es", "value": " Se descubri\u00f3 un problema en GitLab CE/EE que afecta a todas las versiones desde la 16.10 anterior a la 16.11.5, desde la 17.0 anterior a la 17.0.3 y desde la 17.1 anterior a la 17.1.1, lo que permite que el mantenedor del proyecto pueda eliminar la pol\u00edtica de aprobaci\u00f3n de solicitud de fusi\u00f3n a trav\u00e9s de GraphQL."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.6}, {"source": "cve@gitlab.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 4.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "cve@gitlab.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-284"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "16.10.0", "versionEndExcluding": "16.11.5", "matchCriteriaId": "E23493BC-7E07-4790-B52E-CA71B7A6467A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "16.10.0", "versionEndExcluding": "16.11.5", "matchCriteriaId": "85300561-C131-4906-8FCA-001B1B3C5A4C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "17.0.0", "versionEndExcluding": "17.0.3", "matchCriteriaId": "541958DE-CB05-43D9-921B-4ADD2E436BF7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "17.0.0", "versionEndExcluding": "17.0.3", "matchCriteriaId": "C987EC42-A56B-462A-A0CE-7417CC0FD414"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:17.1.0:*:*:*:community:*:*:*", "matchCriteriaId": "D2461A15-EA5F-43D1-B359-0F24713A713B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:17.1.0:*:*:*:enterprise:*:*:*", "matchCriteriaId": "9AA7835D-35E6-44D6-9194-2AC4C38961CE"}]}]}], "references": [{"url": "https://gitlab.com/gitlab-org/gitlab/-/issues/464017", "source": "cve@gitlab.com", "tags": ["Broken Link"]}, {"url": "https://hackerone.com/reports/2520947", "source": "cve@gitlab.com", "tags": ["Permissions Required"]}], "techniques": [{"techniqueID": "TA0001", "comment": "This vulnerability can be exploited by unauthorized project maintainersDeleting the merge request approval policy via GraphQL can be used as a pivot to gain unauthorized access to the application. Defending against this technique requires implementing proper access controls and validating user input."}, {"techniqueID": "TA0005", "comment": "This vulnerability can be exploited by using authentication for unauthorized accessDeleting the merge request approval policy via GraphQL can be used as a pivot to gain unauthorized access to the application. Defending against this technique requires implementing proper authentication and access controls."}, {"techniqueID": "TA0040", "comment": "This vulnerability can be exploited by using a compromised accountDeleting the merge request approval policy via GraphQL can be used as a pivot to gain unauthorized access to the application. Defending against this technique requires implementing proper role-based access controls and monitoring user behavior."}], "stix_bundle": {"@stix_v": "2.1", "stix_bundle": {"generated_by": "MITRE ATT&CK", "date_generated": "2024-06-28T13:17:34.380", "title": "GitLab GraphQL Vulnerability", "description": "Vulnerability in GitLab GraphQL API allowing unauthorized deletion of merge request approval policy", "bundle_types": ["indicator", "observable", "relationship", "note", "comment"], "bundle_items": [{"type": "vulnerability", "id": "CVE-2024-5430", "name": "GitLab GraphQL Vulnerability", "description": "Vulnerability in GitLab GraphQL API allowing unauthorized deletion of merge request approval policy", "severity": "Medium", "score": 4.9, "references": ["https://gitlab.com/gitlab-org/gitlab/-/issues/464017"], "related": ["cwe-284"]}, {"type": "incident", "id": "Incident-1", "name": "GitLab GraphQL Vulnerability Incident", "description": "Unauthorize deletion of merge request approval policy via GraphQL API", "start_time": "2024-06-27T00:00:00.000", "end_time": "2024-06-28T13:17:34.380", "impact": "HIGH", "malware": ["None"], "relationships": ["relatedsto", "CVE-2024-5430"]}, {"type": "Network traffic", "id": "Indicator-1", "name": "Unauthorized GraphQL Query", "description": "Unauthorized GraphQL query used to delete merge request approval policy", "pattern": "INSERT UNAUTHORIZED GraphQL QUERY", "context": " GitLab GraphQL API", "created_by": "MITRE ATT&CK", "date_created": "2024-06-28T13:17:34.380", "relationships": ["relatedto", "Incident-1"]}]}}, "technical_analysis": {"Introduction": "The vulnerability is a result of an unauthenticated GraphQL query that allows an attacker to delete the merge request approval policy.", "Impact and Scope": "The vulnerability affects all versions of GitLab CE/EE starting from 16.10 prior to 16.11.5, starting from 17.0 prior to 17.0.3, and starting from 17.1 prior to 17.1.1.", "Related MITRE ATT&CK Techniques": "TA0001, TA0005, and TA0040", "Technical Details": "The vulnerability is caused by the lack of authentication checks for GraphQL queries.", "Detection": " Detection can be done by monitoring network traffic and identifying unauthorized GraphQL queries.", "Mitigation": "Mitigation can be done by implementing proper authentication checks for GraphQL queries and limiting access to the GraphQL API.", "Conclusion": "Conclusion"}, "executive_analysis": {"Overview": "The vulnerability is a result of an unauthenticated GraphQL query that allows an attacker to delete the merge request approval policy.", "Business Impact": "The vulnerability can be used to gain unauthorized access to the application and delete critical data.", "Technical Impact": "The vulnerability can be exploited by unauthorized users to delete critical data.", "Mitigation Strategies": "Implement proper authentication checks for GraphQL queries and limit access to the GraphQL API.", "Recommendations": "Recommendations for executives.", "Conclusions": "Final conclusions and next steps."}}