{"id": "CVE-2024-37032", "sourceIdentifier": "cve@mitre.org", "published": "2024-05-31T04:15:09.617", "lastModified": "2024-07-15T22:15:02.747", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Ollama before 0.1.34 does not validate the format of the digest (sha256 with 64 hex digits) when getting the model path, and thus mishandles the TestGetBlobsPath test cases such as fewer than 64 hex digits, more than 64 hex digits, or an initial ../ substring."}, {"lang": "es", "value": "Ollama anterior a 0.1.34 no valida el formato del resumen (sha256 con 64 d\u00edgitos hexadecimales) al obtener la ruta del modelo y, por lo tanto, maneja mal los casos de prueba TestGetBlobsPath, como menos de 64 d\u00edgitos hexadecimales, m\u00e1s de 64 d\u00edgitos hexadecimales o una inicial. ../ subcadena."}], "metrics": {}, "references": [{"url": "https://github.com/ollama/ollama/blob/adeb40eaf29039b8964425f69a9315f9f1694ba8/server/modelpath_test.go#L41-L58", "source": "cve@mitre.org"}, {"url": "https://github.com/ollama/ollama/compare/v0.1.33...v0.1.34", "source": "cve@mitre.org"}, {"url": "https://github.com/ollama/ollama/pull/4175", "source": "cve@mitre.org"}, {"url": "https://www.vicarius.io/vsociety/posts/probllama-in-ollama-a-tale-of-a-yet-another-rce-vulnerability-cve-2024-37032", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-37032 - Ollama's lack of validating the digest format allows for an RCE vulnerability. This technique can be used to execute arbitrary code remotely, making it a high-risk vulnerability."}, {"techniqueID": "T1027", "comment": "CVE-2024-37032 - Ollama's error in validating the digest format allows for command injection. This technique can be used to inject malicious commands, making it a high-risk vulnerability."}, {"techniqueID": "T1204", "comment": "CVE-2024-37032 - Ollama's vulnerability can be used to execute arbitrary code. This technique can be used to execute arbitrary code, making it a high-risk vulnerability."}, {"techniqueID": "T1210", "comment": "CVE-2024-37032 - Ollama's vulnerability can be used to inject malicious data. This technique can be used to inject malicious data, making it a high-risk vulnerability."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle--cve-2024-37032", "created_by_ref": "user--bob", "created": "2024-07-15T14:00:00.000Z", "objects": [{"type": "indicator", "id": "indicator--ollama-rce", "created_by_ref": "user--bob", "created": "2024-07-15T14:00:00.000Z", "name": "Ollama RCE Indicator", "delta": "indicator_delta--ollama-rce", "observed_data": [{"type": "network-traffic", "id": "network-traffic--ollama-rce", "from": "2024-07-15T14:00:00.000Z", "to": "2024-07-15T15:00:00.000Z"}]}, {"type": "course-of-action", "id": "course-of-action--ollama-rce-mitigation", "created_by_ref": "user--bob", "created": "2024-07-15T14:00:00.000Z", "name": "Ollama RCE Mitigation", "description": "Update Ollama to version 0.1.35 or later", "related_object": "technique--T1190", "notes": [{"type": "note", "id": "note--ollama-rce-mitigation", "content": "Update Ollama to version 0.1.35 or later to mitigate this vulnerability"}]}]}}, "technical_analysis": {"Introduction": "Ollama before 0.1.34 does not validate the format of the digest (sha256 with 64 hex digits) when getting the model path, and thus mishandles the TestGetBlobsPath test cases such as fewer than 64 hex digits, more than 64 hex digits, or an initial ../ substring.", "Impact and Scope": "This vulnerability allows for remote code execution (RCE) and command injection, making it a high-risk vulnerability. The impact is high because it can be used to execute arbitrary code, inject malicious commands, and potentially compromise the confidentiality and integrity of the system.", "Related MITRE ATT&CK Techniques": "T1190, T1027, T1204, T1210", "Technical Details": "The vulnerability occurs when Ollama does not validate the format of the digest (sha256 with 64 hex digits) when getting the model path. This allows for an attacker to inject malicious code and commands.", "Detection": "Detection methods include monitoring for suspicious network traffic and unusual system behavior.", "Mitigation": "Mitigation strategies include updating Ollama to version 0.1.35 or later, restricting network access, and monitoring for suspicious network traffic.", "Conclusion": "This vulnerability is a high-risk threat and requires immediate attention. Updating Ollama, restricting network access, and monitoring for suspicious network traffic are the recommended mitigation strategies."}, "executive_analysis": {"Overview": "Ollama before 0.1.34 contains a vulnerability that allows for remote code execution (RCE) and command injection.", "Business Impact": "This vulnerability has a high business impact because it can be used to compromise the confidentiality and integrity of the system, potentially leading to financial loss and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is high because it can be used to execute arbitrary code, inject malicious commands, and potentially compromise the system.", "Mitigation Strategies": "Updating Ollama to version 0.1.35 or later, restricting network access, and monitoring for suspicious network traffic are the recommended mitigation strategies.", "Recommendations": "It is recommended that executives prioritize the mitigation of this vulnerability and provide resources to the IT department to ensure a timely and effective response.", "Conclusions": "This vulnerability is a high-risk threat and requires immediate attention. It is recommended that executives prioritize the mitigation of this vulnerability and provide resources to the IT department to ensure a timely and effective response."}}