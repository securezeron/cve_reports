{"id": "CVE-2024-21391", "sourceIdentifier": "secure@microsoft.com", "published": "2024-02-13T18:15:57.073", "lastModified": "2024-05-29T00:15:32.207", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability"}, {"lang": "es", "value": "Proveedor Microsoft WDAC OLE DB para la vulnerabilidad de ejecuci\u00f3n remota de c\u00f3digo de SQL Server"}], "metrics": {"cvssMetricV31": [{"source": "secure@microsoft.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "secure@microsoft.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-197"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1507:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.10240.20469", "matchCriteriaId": "448534CE-1C07-4DF1-8EDD-C43C3492898B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1607:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.14393.6709", "matchCriteriaId": "2D282E53-ABBF-4832-9C93-A988586AE96E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1809:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.17763.5458", "matchCriteriaId": "A1689DFD-D52D-4121-BFD7-DBF2BE4E7DE8"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_21h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.19044.4046", "matchCriteriaId": "C78776CC-3A9C-41A3-8BEB-D71D92F6579D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_22h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.19045.4046", "matchCriteriaId": "806CA6D2-42B2-4244-A5ED-D23E6DD56772"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_21h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22000.2777", "matchCriteriaId": "3F7F8173-9E59-48E4-98C9-4BEB6AE79451"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_22h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22621.3155", "matchCriteriaId": "84EDBE52-EFE0-4D6D-AA76-698B6F9687D1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_23h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22631.3155", "matchCriteriaId": "900D1DA2-6DA7-4681-966A-B9973B1329EA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:-:sp2:*:*:*:*:*:*", "matchCriteriaId": "5F422A8C-2C4E-42C8-B420-E0728037E15C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:r2:*:*:*:*:*:*:*", "matchCriteriaId": "36559BC0-44D7-48B3-86FF-1BFF0257B5ED"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:-:*:*:*:*:*:*:*", "matchCriteriaId": "A7DF96F8-BA6A-4780-9CA3-F719B3F81074"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:r2:*:*:*:*:*:*:*", "matchCriteriaId": "DB18C4CE-5917-401E-ACF7-2747084FD36E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2016:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.14393.6709", "matchCriteriaId": "14F86494-7001-40DB-A99E-34A9490F5B58"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2019:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.17763.5458", "matchCriteriaId": "A9098F92-79E7-4762-A37C-99B4CFA8CDD1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.20348.2322", "matchCriteriaId": "5C8F0436-3AFE-48BD-AE92-8F8392DD0A1D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022_23h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.25398.709", "matchCriteriaId": "B6FCF1A0-6B8E-457A-AB6A-2DE939B9D18B"}]}]}], "references": [{"url": "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-21391", "source": "secure@microsoft.com", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-21391 - This is a remote code execution vulnerability in Microsoft Windows Data Access Components (WDAC) OLE DB provider for SQL Server. An attacker can exploit this vulnerability to execute arbitrary code on a targeted system, and then use the system to conduct further attacks. Defending against this vulnerability requires implementing security patches, using Network segmentation, and implementing web application firewalls."}, {"techniqueID": "T1068", "comment": "This technique stands for Exploitation of Remote Services. An attacker can exploit this vulnerability by sending malicious OLE DB requests to the affected systems and executing arbitrary code on the targeted system."}, {"techniqueID": "T1005", "comment": "This technique stands for Data Encoded Command. An attacker can use this technique to encode command payload into a SQL Server OLE DB request and execute it on the targeted system."}], "stix_bundle": {"$schema": "https://docs.oasis-open.org/oxum/stix-core/v2.1/stix-core-v2.1.json", "type": "bundle", "id": "bundle-CVE-2024-21391", "spec_version": "2.1", "created_by_ref": "", "created": "", "modified": "", "generated_at": "", "bundle_items": [{"type": "report", "id": "report-CVE-2024-21391", "_bundle_item": "bundle-CVE-2024-21391", "title": "CVE-2024-21391 - Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability"}, {"type": "event", "id": "event-CVE-2024-21391", "source": "Microsoft", "reporter": "Vulnerability Research Group", "timestamp": "2024-02-13T18:15:57.073", "vulnerability": "CVE-2024-21391"}, {"type": "indicator", "id": "indicator-CVE-2024-21391", "bundle_item": "bundle-CVE-2024-21391", "title": "Indicator for CVE-2024-21391", "description": "Indicator for CVE-2024-21391"}], "relationships": [{"source_ref": "report-CVE-2024-21391", "target_ref": "vulnerability-CVE-2024-21391", "relationship_type": "related"}, {"source_ref": "event-CVE-2024-21391", "target_ref": "report-CVE-2024-21391", "relationship_type": "observed"}, {"source_ref": "indicator-CVE-2024-21391", "target_ref": "report-CVE-2024-21391", "relationship_type": "indicated"}]}, "technical_analysis": {"Introduction": "This vulnerability is a remote code execution vulnerability in Microsoft Windows Data Access Components (WDAC) OLE DB provider for SQL Server.", "Impact and Scope": "This vulnerability has a CVSS score of 8.8, with a high severity and a high impact on targeted systems. The attacker can execute arbitrary code on the targeted system, with a potential business impact of data breaches, system compromise, or financial loss.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to MITRE ATT&CK Techniques T1190, T1068, and T1005.", "Technical Details": "The vulnerability is due to insufficient validation of user-supplied data in the way that the OLE DB provider handles OLE DB requests, which could allow an attacker to execute arbitrary code on the targeted system.", "Detection": "Detection methods for this vulnerability include monitoring for unusual traffic patterns, network activity, and system logs for suspicious requests.", "Mitigation": "Mitigation strategies for this vulnerability include implementing security patches, using network segmentation, and implementing web application firewalls.", "Conclusion": "In conclusion, this vulnerability poses a significant threat to targeted systems, and immediate action should be taken to patch affected systems and implement mitigation strategies."}, "executive_analysis": {"Overview": "This vulnerability is a remote code execution vulnerability in Microsoft Windows Data Access Components (WDAC) OLE DB provider for SQL Server.", "Business Impact": "This vulnerability poses a significant business risk, with potential impacts on data breaches, system compromise, or financial loss.", "Technical Impact": "The technical impact of this vulnerability is high, with a CVSS score of 8.8 and a potential for severe consequences.", "Mitigation Strategies": "Immediate action should be taken to patch affected systems, use network segmentation, and implement web application firewalls.", "Recommendations": "We recommend that organizations prioritize patching affected systems, conducting regular security assessments, and implementing additional security measures.", "Conclusions": "In conclusion, this vulnerability requires immediate attention and action to minimize the risk of exploitation."}}