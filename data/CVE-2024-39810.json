{"id": "CVE-2024-39810", "sourceIdentifier": "responsibledisclosure@mattermost.com", "published": "2024-08-22T07:15:03.743", "lastModified": "2024-08-23T16:16:36.907", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Mattermost versions 9.5.x <= 9.5.7 and 9.10.x <= 9.10.0 fail to time limit and size limit the CA path file in the ElasticSearch configuration which allows a System Role with access to the Elasticsearch system console to add any file as a CA path field, such as /dev/zero and, after testing the connection, cause the application to crash."}, {"lang": "es", "value": "Las versiones 9.5.x &lt;= 9.5.7 y 9.10.x &lt;= 9.10.0 de Mattermost no limitan el tiempo ni el tama\u00f1o del archivo de ruta de CA en la configuraci\u00f3n de ElasticSearch, lo que permite que una funci\u00f3n del sistema con acceso a la consola del sistema Elasticsearch agregue cualquier archivo. como un campo de ruta de CA, como /dev/zero y, despu\u00e9s de probar la conexi\u00f3n, provocar que la aplicaci\u00f3n falle."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.6}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-400"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.5.0", "versionEndExcluding": "9.5.8", "matchCriteriaId": "7FEEA8D7-745A-49FF-8B01-CA0D1D820D48"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.10.0", "versionEndExcluding": "9.10.1", "matchCriteriaId": "0CA40F21-914D-4891-A578-02E6F35FE249"}]}]}], "references": [{"url": "https://mattermost.com/security-updates", "source": "responsibledisclosure@mattermost.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-39810 - Reading File and Data Staged for Execution. This technique is relevant as it allows an attacker to add any file as a CA path field, such as /dev/zero, and cause the application to crash, allowing for potential code execution."}, {"techniqueID": "T1210", "comment": "CVE-2024-39810 - Map View. This technique is relevant as it allows the attacker to leverage an incorrectly configured CA path field to cause the application to crash, potentially allowing for privilege escalation."}, {"techniqueID": "T1055", "comment": "CVE-2024-39810 - SMB/Windows Admin Shares. This technique is relevant as it allows an attacker to leverage a System Role with access to the Elasticsearch system console to add any file as a CA path field, potentially allowing for code execution and privilege escalation."}], "stix_bundle": {"$id": "CVE-2024-39810", "$schema": "https://stix2.io/schema/2.1/stixcore-V2.1.xsd", "spec_version": "2.1", "type": "bundle", "description": "STIX Bundle for CVE-2024-39810", "created_by_ref": "", "created": "2024-08-22T07:15:03.743", "modified": "2024-08-23T16:16:36.907", "objects": [{"$id": "Vulnerability-CVE-2024-39810", "$schema": "https://stix2.io/schema/2.1/stixvuln-V2.1.xsd", "type": "vulnerability", "description": "Mattermost versions 9.5.x <= 9.5.7 and 9.10.x <= 9.10.0 fail to time limit and size limit the CA path file in the ElasticSearch configuration which allows a System Role with access to the Elasticsearch system console to add any file as a CA path field, such as /dev/zero and, after testing the connection, cause the application to crash.", "impact_score": 4.9, "exploitability_score": 1.2, "impact_type": "availability", "exploitably_type": "network", "references": [{"id": "Vulnerability-CVE-2024-39810-Vendor-Advisory", "type": "vendor-advisory", "title": "Vendor Advisory from Mattermost", "description": "Mattermost security advisory for CVE-2024-39810", "url": "https://mattermost.com/security-updates"}]}, {"$id": "Related-MITRE-Technique-T1190", "$schema": "https://stix2.io/schema/2.1/stixTTP-V2.1.xsd", "type": "technique", "id": "T1190", "name": "Reading File and Data Staged for Execution", "description": "The adversary reads a file and prepares it for execution.", "external_references": [{"source_name": "mitre-attack", "external_id": "T1190"}]}, {"$id": "Related-MITRE-Technique-T1210", "$schema": "https://stix2.io/schema/2.1/stixTTP-V2.1.xsd", "type": "technique", "id": "T1210", "name": "Map View", "description": "The adversary leverages an incorrectly configured CA path field to cause the application to crash.", "external_references": [{"source_name": "mitre-attack", "external_id": "T1210"}]}, {"$id": "Related-MITRE-Technique-T1055", "$schema": "https://stix2.io/schema/2.1/stixTTP-V2.1.xsd", "type": "technique", "id": "T1055", "name": "SMB/Windows Admin Shares", "description": "The adversary uses an SMB/Windows Admin Share to access a system.", "external_references": [{"source_name": "mitre-attack", "external_id": "T1055"}]}], "relationships": [{"id": "Vulnerability-CVE-2024-39810-relatedTo-Related-MITRE-Technique-T1190", "type": "related-to", "source_ref": "Vulnerability-CVE-2024-39810", "target_ref": "Related-MITRE-Technique-T1190", "relationship_type": "uses"}, {"id": "Vulnerability-CVE-2024-39810-relatedTo-Related-MITRE-Technique-T1210", "type": "related-to", "source_ref": "Vulnerability-CVE-2024-39810", "target_ref": "Related-MITRE-Technique-T1210", "relationship_type": "uses"}, {"id": "Vulnerability-CVE-2024-39810-relatedTo-Related-MITRE-Technique-T1055", "type": "related-to", "source_ref": "Vulnerability-CVE-2024-39810", "target_ref": "Related-MITRE-Technique-T1055", "relationship_type": "uses"}]}, "technical_analysis": {"Introduction": "This vulnerability in Mattermost versions 9.5.x <= 9.5.7 and 9.10.x <= 9.10.0 allows an attacker to add any file as a CA path field, potentially causing the application to crash and allowing for code execution.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 4.9. The scope is limited to Mattermost versions 9.5.x <= 9.5.7 and 9.10.x <= 9.10.0.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1190, T1210, and T1055.", "Technical Details": "The vulnerability allows an attacker to add any file as a CA path field, potentially causing the application to crash and allowing for code execution.", "Detection": "Detection of this vulnerability can be achieved through monitoring for suspicious CA path field additions and application crashes.", "Mitigation": "Mitigation strategies include updating to patched versions, implementing strict CA path field validation, and monitoring for suspicious activity.", "Conclusion": "This vulnerability presents a significant risk to Mattermost users and administrators, and prompt mitigation and patching are recommended."}, "executive_analysis": {"Overview": "This vulnerability in Mattermost allows an attacker to add any file as a CA path field, potentially causing the application to crash and allowing for code execution.", "Business Impact": "The business impact of this vulnerability is significant, as it could allow attackers to compromise sensitive data and systems.", "Technical Impact": "The technical impact of this vulnerability is also significant, as it could allow attackers to execute code and gain unauthorized access to systems.", "Mitigation Strategies": "Prompt mitigation and patching are recommended to prevent exploitation of this vulnerability.", "Recommendations": "Recommendations for executives include implementing strict CA path field validation, monitoring for suspicious activity, and ensuring that all systems and applications are up to date with the latest patches.", "Conclusions": "This vulnerability presents a significant risk to Mattermost users and administrators, and prompt action is recommended to prevent exploitation."}}