{"id": "CVE-2020-27661", "sourceIdentifier": "cve@mitre.org", "published": "2021-06-02T16:15:08.320", "lastModified": "2023-11-07T03:20:58.273", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "A divide-by-zero issue was found in dwc2_handle_packet in hw/usb/hcd-dwc2.c in the hcd-dwc2 USB host controller emulation of QEMU. A malicious guest could use this flaw to crash the QEMU process on the host, resulting in a denial of service."}, {"lang": "es", "value": "Se encontr\u00f3 un problema de divisi\u00f3n por cero en la funci\u00f3n dwc2_handle_packet en el archivo hw/usb/hcd-dwc2.c en la emulaci\u00f3n del controlador de host USB hcd-dwc2 de QEMU. Un hu\u00e9sped malicioso podr\u00eda utilizar este fallo para bloquear el proceso de QEMU en el host, resultando en una denegaci\u00f3n de servicio"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.0, "impactScore": 4.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 2.1}, "baseSeverity": "LOW", "exploitabilityScore": 3.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-369"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:qemu:qemu:*:*:*:*:*:*:*:*", "versionEndIncluding": "5.1.1", "matchCriteriaId": "37A49175-42F7-433A-82A0-59D9A969E731"}]}]}], "references": [{"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1890653", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://git.qemu.org/?p=qemu.git%3Ba=commit%3Bh=bea2a9e3e00b275dc40cfa09c760c715b8753e03", "source": "cve@mitre.org"}, {"url": "https://lists.nongnu.org/archive/html/qemu-devel/2020-10/msg04263.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Patch", "Third Party Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20210720-0010/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.mail-archive.com/debian-bugs-dist%40lists.debian.org/msg1770368.html", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-27661 - An attacker could exploit this vulnerability to crash the QEMU process on the host, resulting in a denial of service, which is a potential vector for further attacks."}, {"techniqueID": "T1499", "comment": "CVE-2020-27661 - Adversaries may leverage this vulnerability to create a diversion or draw attention away from their malicious activities, potentially utilizing the resulting denial of service as a smokescreen."}, {"techniqueID": "T1574", "comment": "CVE-2020-27661 - This vulnerability's potential impact on the availability of QEMU-host services may influence an attacker's decision to exploit it, potentially creating opportunities for lateral movement or data exfiltration."}], "stix_bundle": {"type": "bundle", "id": "b3f9b2f8-cb3a-44ee-b94c-6f7a34c93a76", "spec_version": "2.1", "objects": [{"type": "vulnerability", "id": "vulnerability-1", "title": "QEMU dwc2 USB Host Controller Emulation Divide-by-Zero Issue", "description": "A divide-by-zero issue was found in dwc2_handle_packet in hw/usb/hcd-dwc2.c in the hcd-dwc2 USB host controller emulation of QEMU.", "external_references": [{"source_name": "cve@mitre.org", "external_id": "CVE-2020-27661"}], "created": "2021-06-02T16:15:08.320", "modified": "2023-11-07T03:20:58.273", "impact": {"type": "denial-of-service"}, "cve": {"id": "CVE-2020-27661", "source": "cve@mitre.org"}, "mitre": {"techniques": ["T1190", "T1499", "T1574"]}}, {"type": "course-of-action", "id": "ca-1", "title": "Apply the patch", "description": "Apply the patch provided by QEMU to mitigate this vulnerability.", "external_references": [{"source_name": "cve@mitre.org", "external_id": "CVE-2020-27661"}], "created": "2021-06-02T16:15:08.320", "modified": "2023-11-07T03:20:58.273", "relevant_to": [{"ref_id": "vulnerability-1", "relationship": "mitigates"}]}, {"type": "match-regex", "id": "i-1", "title": "Presence of malicious guest", "description": "The presence of a malicious guest on the host system is a potential indicator of exploitation of this vulnerability.", "pattern": "Win32k!SYSPROC", "filter": "rule=match-all", "created": "2021-06-02T16:15:08.320", "modified": "2023-11-07T03:20:58.273", "relevant_to": [{"ref_id": "vulnerability-1", "relationship": "indicates-exploitation"}]}]}, "technical_analysis": {"Introduction": "QEMU is an open-source virtual machine emulator that allows users to run multiple operating systems on a single physical machine. This vulnerability affects the dwc2 USB host controller emulation component of QEMU, which is responsible for handling USB packets.", "Impact and Scope": "This vulnerability has a CVSS score of 6.5 and an attack vector of LOCAL. It allows a malicious guest to crash the QEMU process on the host system, resulting in a denial of service. This vulnerability is critical because it can be used as a potential vector for further attacks.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to MITRE ATT&CK techniques T1190, T1499, and T1574, which are used to create a diversion, draw attention away from malicious activities, and influence an attacker's decision to exploit a vulnerability.", "Technical Details": "The vulnerability is caused by a divide-by-zero issue in the dwc2_handled_packet function in the hw/usb/hcd-dwc2.c file of the hcd-dwc2 USB host controller emulation component of QEMU.", "Detection": "Detecting this vulnerability may involve monitoring the system for suspicious USB packet handling activity and identifying potential indicators of exploitation.", "Mitigation": "The vulnerability can be mitigated by applying the provided patch to the QEMU software.", "Conclusion": "This vulnerability highlights the importance of keeping software up-to-date and security patches applied, particularly in the context of virtualization and USB hosting."}, "executive_analysis": {"Overview": "The vulnerability in QEMU's dwc2 USB host controller emulation component allows a malicious guest to crash the QEMU process on the host system, resulting in a denial of service.", "Business Impact": "This vulnerability can have a significant impact on an organization's business and operations, particularly if it is exploited during peak usage hours.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows an attacker to crash the QEMU process and potentially gain unauthorized access to the host system.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include applying the provided patch to the QEMU software and implementing detection and monitoring systems.", "Recommendations": "Recommendations for executives include prioritizing software updates and security patches, implementing robust security controls, and conducting regular security audits and incident response procedures.", "Conclusions": "The conclusion is that this vulnerability highlights the importance of keeping software up-to-date and security patches applied, particularly in the context of virtualization and USB hosting."}}