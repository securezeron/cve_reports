{"id": "CVE-2007-2729", "sourceIdentifier": "cve@mitre.org", "published": "2007-05-16T22:30:00.000", "lastModified": "2018-10-16T16:45:15.917", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Comodo Firewall Pro 2.4.18.184 and Comodo Personal Firewall 2.3.6.81, and probably older Comodo Firewall versions, do not properly test for equivalence of process identifiers for certain Microsoft Windows API functions in the NT kernel 5.0 and greater, which allows local users to call these functions, and bypass firewall rules or gain privileges, via a modified identifier that is one, two, or three greater than the canonical identifier."}, {"lang": "es", "value": "Comodo Firewall Pro 2.4.18.184 y Comodo Personal Firewall 2.3.6.81, y posiblemente versiones anteriores de Comodo Firewall, no comprueba adecuadamente la equivalencia de identificadores de proceso para ciertas funciones de la API de Windows en el NT kernel 5.0 y superiores, lo cual permite a usuarios locales llamar a estas funciones, y evitar reglas del cortafuegos u obtener privilegios, mediante un identificador modificado que es una, dos o tres veces m\u00e1s grande que el identificador can\u00f3nico."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:comodo:comodo_firewall_pro:2.4.18.184:*:*:*:*:*:*:*", "matchCriteriaId": "6518A7E2-C299-4985-BCAD-0A52FB9E850D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:comodo:comodo_personal_firewall:2.3.6.81:*:*:*:*:*:*:*", "matchCriteriaId": "27A1D441-3366-4F5C-944B-76472ACCBC29"}]}]}], "references": [{"url": "http://osvdb.org/37375", "source": "cve@mitre.org"}, {"url": "http://securityreason.com/securityalert/2714", "source": "cve@mitre.org"}, {"url": "http://www.matousec.com/info/advisories/Bypassing-PWF-HIPS-open-process-control-with-uncommon-identifier.php", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/468643/100/0/threaded", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2007-2729 - Comodo Firewall Pro and Comodo Personal Firewall allow local users to bypass firewall rules or gain privileges via a modified process identifier. This technique can be used for privilege escalation and command execution"}, {"techniqueID": "T1005", "comment": "CVE-2007-2729 - The vulnerability allows local users to call certain Microsoft Windows API functions, which can be used for code execution and exploit"}, {"techniqueID": "T1059", "comment": "CVE-2007-2729 - The vulnerability allows local users to bypass firewall rules or gain privileges, which can be used for persistence"}], "stix_bundle": {"objects": [{"id": "vulnerability_cve-2007-2729", "type": "vulnerability", "name": "CVE-2007-2729"}, {"id": "technique_t1190", "type": "attack-pattern", "name": "Bypassing Firewall Rules"}, {"id": "technique_t1005", "type": "attack-pattern", "name": "API Function Call"}, {"id": "technique_t1059", "type": "attack-pattern", "name": "Persistence Through Firewall Bypass"}], "relationships": [{"relationship_id": "vulnerability_cve-2007-2729_bypassing_firewall_rules", "relationship_type": "related_to", "source_ref": "vulnerability_cve-2007-2729", "target_ref": "technique_t1190"}, {"relationship_id": "vulnerability_cve-2007-2729_api_function_call", "relationship_type": "related_to", "source_ref": "vulnerability_cve-2007-2729", "target_ref": "technique_t1005"}, {"relationship_id": "vulnerability_cve-2007-2729_persistence_through_firewall_bypass", "relationship_type": "related_to", "source_ref": "vulnerability_cve-2007-2729", "target_ref": "technique_t1059"}]}, "technical_analysis": {"Introduction": "Comodo Firewall Pro and Comodo Personal Firewall allow local users to bypass firewall rules or gain privileges via a modified process identifier.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2 and allows local users to call certain Microsoft Windows API functions, which can be used for code execution and exploit.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1190, T1005, and T1059.", "Technical Details": "The vulnerability is a result of not properly testing for equivalence of process identifiers for certain Microsoft Windows API functions in the NT kernel 5.0 and greater.", "Detection": "Detection can be done by monitoring system calls and API function calls.", "Mitigation": "Mitigation can be done by implementing proper equivalence checks for process identifiers.", "Conclusion": "The vulnerability can be used for privilege escalation and command execution, and therefore must be addressed promptly."}, "executive_analysis": {"Overview": "The vulnerability affects Comodo Firewall Pro and Comodo Personal Firewall, allowing local users to bypass firewall rules or gain privileges.", "Business Impact": "The vulnerability can be used for privilege escalation and command execution, which can lead to data breaches and financial losses.", "Technical Impact": "The vulnerability allows local users to call certain Microsoft Windows API functions, which can be used for code execution and exploit.", "Mitigation Strategies": "Implement proper equivalence checks for process identifiers and monitor system calls and API function calls.", "Recommendations": "Patch the vulnerabilities promptly and implement proper security controls.", "Conclusions": "The vulnerability is a high-severity vulnerability that can be used for privilege escalation and command execution. It is recommended to address the vulnerability promptly to minimize risks."}}