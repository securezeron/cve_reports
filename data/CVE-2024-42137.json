{"id": "CVE-2024-42137", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-30T08:15:05.583", "lastModified": "2024-07-30T13:32:45.943", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: qca: Fix BT enable failure again for QCA6390 after warm reboot\n\nCommit 272970be3dab (\"Bluetooth: hci_qca: Fix driver shutdown on closed\nserdev\") will cause below regression issue:\n\nBT can't be enabled after below steps:\ncold boot -> enable BT -> disable BT -> warm reboot -> BT enable failure\nif property enable-gpios is not configured within DT|ACPI for QCA6390.\n\nThe commit is to fix a use-after-free issue within qca_serdev_shutdown()\nby adding condition to avoid the serdev is flushed or wrote after closed\nbut also introduces this regression issue regarding above steps since the\nVSC is not sent to reset controller during warm reboot.\n\nFixed by sending the VSC to reset controller within qca_serdev_shutdown()\nonce BT was ever enabled, and the use-after-free issue is also fixed by\nthis change since the serdev is still opened before it is flushed or wrote.\n\nVerified by the reported machine Dell XPS 13 9310 laptop over below two\nkernel commits:\ncommit e00fc2700a3f (\"Bluetooth: btusb: Fix triggering coredump\nimplementation for QCA\") of bluetooth-next tree.\ncommit b23d98d46d28 (\"Bluetooth: btusb: Fix triggering coredump\nimplementation for QCA\") of linus mainline tree."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: Bluetooth: qca: corrija el error de habilitaci\u00f3n de BT nuevamente para QCA6390 despu\u00e9s de un reinicio en caliente. La confirmaci\u00f3n 272970be3dab (\"Bluetooth: hci_qca: corrija el apagado del controlador en un serdev cerrado\") causar\u00e1 el siguiente problema de regresi\u00f3n: BT puede No se habilitar\u00e1 despu\u00e9s de los pasos siguientes: arranque en fr\u00edo -&gt; habilitar BT -&gt; deshabilitar BT -&gt; reinicio en caliente -&gt; falla de habilitaci\u00f3n de BT si la propiedad enable-gpios no est\u00e1 configurada dentro de DT|ACPI para QCA6390. El compromiso es solucionar un problema de use after free dentro de qca_serdev_shutdown() agregando una condici\u00f3n para evitar que el serdev se vac\u00ede o escriba despu\u00e9s de cerrarse, pero tambi\u00e9n introduce este problema de regresi\u00f3n con respecto a los pasos anteriores, ya que el VSC no se env\u00eda para restablecer el controlador durante el reinicio en caliente. . Se solucion\u00f3 enviando el VSC para restablecer el controlador dentro de qca_serdev_shutdown() una vez que BT estuvo habilitado, y el problema de use after free tambi\u00e9n se solucion\u00f3 con este cambio ya que el serdev todav\u00eda est\u00e1 abierto antes de vaciarse o escribirse. Verificado por la computadora port\u00e1til Dell XPS 13 9310 de la m\u00e1quina informada en las siguientes dos confirmaciones del kernel: confirmaci\u00f3n e00fc2700a3f (\"Bluetooth: btusb: soluci\u00f3n de activaci\u00f3n de la implementaci\u00f3n de coredump para QCA\") del \u00e1rbol siguiente de bluetooth. confirme b23d98d46d28 (\"Bluetooth: btusb: soluci\u00f3n que activa la implementaci\u00f3n de coredump para QCA\") del \u00e1rbol principal de Linux."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/215a26c2404fa34625c725d446967fa328a703eb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/4ca6013cd18e58ac1044908c40d4006a92093a11", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/88e72239ead9814b886db54fc4ee39ef3c2b8f26", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/977b9dc65e14fb80de4763d949c7dec2ecb15b9b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e2d8aa4c763593704ac21e7591aed4f13e32f3b5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e6e200b264271f62a3fadb51ada9423015ece37b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-42137 - The attacker may leverage this vulnerability to remotely execute code on the targeted Linux-based system, potentially leading to unauthorized access. Defense against this threat involves applying the latest kernel updates and configuring the system's Bluetooth settings to prevent exploitation."}, {"techniqueID": "T1069", "comment": "CVE-2024-42137 - The attacker may exploit this vulnerability to gain elevated privileges on the targeted system, allowing them to persist and escalate their attack. Defending against this threat involves using memory protection and access control features in the Linux kernel."}, {"techniqueID": "T1027", "comment": "CVE-2024-42137 - The attacker may use this vulnerability to remove or modify system settings, allowing them to bypass security controls or disrupt system functionality. Defending against this threat involves monitoring system logs and implementing anomaly detection mechanisms."}], "stix_bundle": {"id": "bundle-1", "type": "bundle", "created_by_ref": "user-1", "created": "2024-08-01T10:00:00", "description": "STIX 2.1 bundle for CVE-2024-42137", "objects": [{"id": "vuln-1", "type": "vulnerability", "name": "CVE-2024-42137", "description": "In the Linux kernel, the following vulnerability has been resolved: ...", "references": [{"url": "https://git.kernel.org/stable/c/215a26c2404fa34625c725d446967fa328a703eb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}]}, {"id": "tech-1", "type": "indicator", "name": "Linux kernel Bluetooth vulnerability", "description": "The Linux kernel Bluetooth vulnerability (CVE-2024-42137) allows for remote code execution.", "related_threats": [{"id": "threat-1", "type": "threat-actor", "name": "Threat Actor 1"}]}, {"id": "tech-2", "type": "indicator", "name": "Linux kernel Bluetooth vulnerability ( Mitigation )", "description": "To mitigate this vulnerability, apply the latest kernel updates and configure the system's Bluetooth settings.", "related_techniques": [{"id": "T1190", "type": "mitigation-technique"}]}]}, "technical_analysis": {"Introduction": "The Linux kernel Bluetooth vulnerability (CVE-2024-42137) is a remotely exploitable vulnerability that allows for remote code execution.", "Impact and Scope": "The impact of this vulnerability is significant, as it allows an attacker to execute arbitrary code on the targeted system. The scope of the vulnerability is system-wide, as it affects all systems running Linux.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1190, T1069, and T1027.", "Technical Details": "The vulnerability is located in the Linux kernel's Bluetooth implementation and is caused by a use-after-free bug.", "Detection": "This vulnerability can be detected by monitoring system logs for suspicious activity and implementing anomaly detection mechanisms.", "Mitigation": "The mitigation strategy for this vulnerability is to apply the latest kernel updates and configure the system's Bluetooth settings to prevent exploitation.", "Conclusion": "In conclusion, the Linux kernel Bluetooth vulnerability is a significant threat that requires immediate attention. Using the mitigation strategies outlined in this analysis can help prevent exploitation."}, "executive_analysis": {"Overview": "The Linux kernel Bluetooth vulnerability (CVE-2024-42137) is a serious security threat that requires immediate attention.", "Business Impact": "The business impact of this vulnerability is significant, as it can allow attackers to compromise sensitive data and disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows attackers to execute arbitrary code on the targeted system.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include applying the latest kernel updates and configuring the system's Bluetooth settings to prevent exploitation.", "Recommendations": "Executives are recommended to prioritize the implementation of these mitigation strategies and to monitor system logs for suspicious activity.", "Conclusions": "In conclusion, the Linux kernel Bluetooth vulnerability is a serious security threat that requires immediate attention. Executives must prioritize the mitigation of this vulnerability to protect their organizations from attack."}}