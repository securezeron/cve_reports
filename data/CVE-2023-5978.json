{"id": "CVE-2023-5978", "sourceIdentifier": "secteam@freebsd.org", "published": "2023-11-08T09:15:07.933", "lastModified": "2023-12-14T10:15:08.727", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In versions of FreeBSD 13-RELEASE before 13-RELEASE-p5, under certain circumstances the cap_net libcasper(3) service incorrectly validates that updated constraints are strictly subsets of the active constraints. \u00a0When only a list\u00a0of resolvable domain names was specified without setting any other limitations, an application could submit a new list of domains including include entries not previously listed. \u00a0This could permit the application to resolve domain names that were previously restricted."}, {"lang": "es", "value": "En las versiones 13-RELEASE anteriores a 13-RELEASE-p5 de FreeBSD, bajo ciertas circunstancias el servicio cap_net libcasper(3) valida incorrectamente que las restricciones actualizadas son estrictamente subconjuntos de las restricciones activas. Cuando solo se especificaba una lista de nombres de dominio resolubles sin establecer otras limitaciones, una aplicaci\u00f3n pod\u00eda enviar una nueva lista de dominios que incluyeran entradas que no figuraban anteriormente. Esto podr\u00eda permitir que la aplicaci\u00f3n resuelva nombres de dominio que anteriormente estaban restringidos."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "secteam@freebsd.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-269"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:*:*:*:*:*:*:*:*", "versionStartIncluding": "13.0", "versionEndExcluding": "13.2", "matchCriteriaId": "BA49E374-9F1A-4F62-B88D-CD36EDEA6060"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.2:-:*:*:*:*:*:*", "matchCriteriaId": "A87EFA20-DD6B-41C5-98FD-A29F67D2E732"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.2:p1:*:*:*:*:*:*", "matchCriteriaId": "2888B0C1-4D85-42EC-9696-03FAD0A9C28F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.2:p2:*:*:*:*:*:*", "matchCriteriaId": "A3306F11-D3C0-41D6-BB5E-2ABDC3927715"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.2:p3:*:*:*:*:*:*", "matchCriteriaId": "9E584FE1-3A34-492B-B10F-508DA7CBA768"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.2:p4:*:*:*:*:*:*", "matchCriteriaId": "A5605E90-D125-4CC9-8B9F-F5EED9D4EE0C"}]}]}], "references": [{"url": "https://security.freebsd.org/advisories/FreeBSD-SA-23:16.cap_net.asc", "source": "secteam@freebsd.org", "tags": ["Vendor Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20231214-0003/", "source": "secteam@freebsd.org"}], "techniques": [{"techniqueID": "T1190", "comment": "Discovery of valid domains - CVE-2023-5978 - This is a command injection vulnerability in the cap_net libcasper(3) service. An attacker can inject arbitrary commands to resolve any domain name, which could be used to get shell access."}, {"techniqueID": "T1059", "comment": "Command Injection - CVE-2023-5978 - An attacker can inject arbitrary commands by providing a list of resolvable domain names including unexpected entries."}, {"techniqueID": "T1169", "comment": "Path Manipulation - CVE-2023-5978 - An attacker can manipulate the path to inject commands, leading to arbitrary command execution."}, {"techniqueID": "T1078", "comment": "Valid Accounts - CVE-2023-5978 - An attacker can use the vulnerability to create a valid account and gain access to the system."}], "stix_bundle": {"objects": [{"id": "vulnerability-cve-2023-5978", "type": "vulnerability", "name": "FreeBSD 13-RELEASE command injection vulnerability"}, {"id": "technique-discovery-of-valid-domains", "type": "attack-pattern", "name": "Discovery of valid domains", "description": "An attacker discovers valid domains to use for command injection.", "layers": [{"id": "attack-pattern-technique", "type": "relationship", "from": "vulnerability-cve-2023-5978", "to": "technique-discovery-of-valid-domains", "relationship_type": "uses"}]}, {"id": "technique-command-injection", "type": "attack-pattern", "name": "Command Injection", "description": "An attacker injects arbitrary commands to resolve any domain name, which could be used to get shell access.", "layers": [{"id": "attack-pattern-technique", "type": "relationship", "from": "vulnerability-cve-2023-5978", "to": "technique-command-injection", "relationship_type": "uses"}]}, {"id": "defense-path-validation", "type": "course-of-action", "name": "Path validation", "description": "Validate the path before executing any commands.", "layers": [{"id": "course-of-action-technique", "type": "relationship", "from": "defense-path-validation", "to": "technique-command-injection", "relationship_type": "mitigates"}]}]}, "technical_analysis": {"Introduction": "The CVE-2023-5978 is a command injection vulnerability in the cap_net libcasper(3) service of FreeBSD 13-RELEASE before 13-RELEASE-p5.", "Impact and Scope": "This vulnerability allows an attacker to inject arbitrary commands to resolve any domain name, which could be used to get shell access.", "Related MITRE ATT&CK Techniques": "T1190, T1059, T1169, and T1078", "Technical Details": "An attacker can inject arbitrary commands by providing a list of resolvable domain names including unexpected entries.", "Detection": "Detect anomalies in command execution and verify domain name resolution.", "Mitigation": "Validate the path before executing any commands, restrict access to the service, and apply security patches.", "Conclusion": "This vulnerability is critical and must be patched immediately to prevent exploitation."}, "executive_analysis": {"Overview": "The FreeBSD 13-RELEASE command injection vulnerability (CVE-2023-5978) is a critical security issue that allows an attacker to gain shell access.", "Business Impact": "This vulnerability can lead to data breaches, system compromise, and reputational damage.", "Technical Impact": "An attacker can inject arbitrary commands to resolve any domain name, which could be used to get shell access.", "Mitigation Strategies": "Implement path validation, restrict access to the service, and apply security patches.", "Recommendations": "Patch immediately, ensure proper configuration, and monitor for anomalies.", "Conclusions": "This vulnerability is critical and must be addressed immediately to prevent exploitation."}}