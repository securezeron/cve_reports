{"id": "CVE-2024-42233", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-07T16:15:46.313", "lastModified": "2024-08-08T14:56:18.620", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nfilemap: replace pte_offset_map() with pte_offset_map_nolock()\n\nThe vmf->ptl in filemap_fault_recheck_pte_none() is still set from\nhandle_pte_fault().  But at the same time, we did a pte_unmap(vmf->pte). \nAfter a pte_unmap(vmf->pte) unmap and rcu_read_unlock(), the page table\nmay be racily changed and vmf->ptl maybe fails to protect the actual page\ntable.  Fix this by replacing pte_offset_map() with\npte_offset_map_nolock().\n\nAs David said, the PTL pointer might be stale so if we continue to use\nit infilemap_fault_recheck_pte_none(), it might trigger UAF.  Also, if\nthe PTL fails, the issue fixed by commit 58f327f2ce80 (\"filemap: avoid\nunnecessary major faults in filemap_fault()\") might reappear."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: filemap: reemplace pte_offset_map() con pte_offset_map_nolock() El vmf-&gt;ptl en filemap_fault_recheck_pte_none() todav\u00eda est\u00e1 configurado desde handle_pte_fault(). Pero al mismo tiempo, hicimos un pte_unmap(vmf-&gt;pte). Despu\u00e9s de desasignar pte_unmap(vmf-&gt;pte) y rcu_read_unlock(), la tabla de p\u00e1ginas puede cambiarse r\u00e1pidamente y vmf-&gt;ptl tal vez no pueda proteger la tabla de p\u00e1ginas real. Solucione este problema reemplazando pte_offset_map() con pte_offset_map_nolock(). Como dijo David, el puntero PTL puede estar obsoleto, por lo que si continuamos us\u00e1ndolo en filemap_fault_recheck_pte_none(), podr\u00eda activar UAF. Adem\u00e1s, si el PTL falla, el problema solucionado mediante el commit 58f327f2ce80 (\"filemap: evite errores importantes innecesarios en filemap_fault()\") podr\u00eda reaparecer."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.3, "baseSeverity": "LOW"}, "exploitabilityScore": 1.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.9", "versionEndExcluding": "6.9.10", "matchCriteriaId": "0F5C3789-472B-40EC-9D2A-48169EDB592B"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/24be02a42181f0707be0498045c4c4b13273b16d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/6a6c2aec1a89506595801b4cf7e8eef035f33748", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1133 - Called Process", "comment": "The CVE-2024-42233 vulnerability in the Linux kernel allows an attacker to execute a called process, which can be used to escalate privileges and gain control of the system."}, {"techniqueID": "T1078 - Exploitation of Remote Services", "comment": "The vulnerability can also be exploited by an attacker to gain access to the system by exploiting a remote service, such as a web server or a database server."}, {"techniqueID": "T1210 - Exploitation of Phased Vulnerabilities", "comment": "The CVE-2024-42233 vulnerability can also be exploited by an attacker to phase the exploitation of multiple vulnerabilities in the Linux kernel, allowing for more complex and targeted attacks."}, {"techniqueID": "T1072 - Network Share Discovery", "comment": "An attacker can use the vulnerability to gain access to sensitive information on the network by exploiting a network share."}, {"techniqueID": "T1054 - Network Share Discovery", "comment": "An attacker can use the vulnerability to remotely access and steal sensitive information on a network share."}], "stix_bundle": "{\"bundle\": {\"type\": \"bundle\", \"id\": \"CVE-2024-42233\", \"created_by_ref\": \"\",\"objects\": [{\"type\": \"incident\", \"id\": \"CVE-2024-42233\",\"timestamp\": \"2024-08-07T16:15:46.313\",\"description\": \"Vulnerability in the Linux kernel that allows an attacker to execute a called process, exploit remote services, phase the exploitation of multiple vulnerabilities, discover and exploit network shares.\", \"generated_by_ref\": \"{}/incidents\",\"handling\": [{\"type\": \"handling\", \"id\": \"CVE-2024-42233\", \"description\": \"Handle the incident by patching the Linux kernel, configuring the system to prevent the exploitation of the vulnerability.\"}]}]}", "technical_analysis": {"Introduction": "The CVE-2024-42233 vulnerability in the Linux kernel affects all versions of the kernel from 6.9 to 6.9.10. This vulnerability can be exploited by an attacker to execute a called process, exploit remote services, phase the exploitation of multiple vulnerabilities, and discover and exploit network shares. The attack vector is local, and the attack complexity is low.", "Impact and Scope": "The impact of this vulnerability is the ability for an attacker to gain control of the system, steal sensitive information, and disrupt the normal functioning of the system. The scope of this vulnerability is all versions of the Linux kernel from 6.9 to 6.9.10.", "Related MITRE ATT&CK Techniques": "The MITRE ATT&CK techniques related to this vulnerability are called process, exploitation of remote services, exploitation of phased vulnerabilities, network share discovery, and exploitation of network shares.", "Technical Details": "The vulnerability is caused by a flaw in the filemap_fault_recheck_pte_none function in the Linux kernel that allows an attacker to execute a called process. The attacker can exploit this vulnerability by sending a crafted request to the system and waiting for the system to execute the called process.", "Detection": "To detect this vulnerability, systems administrators should monitor system logs for suspicious activity, such as calls to the filemap_fault_recheck_pte_none function. They should also conduct regular vulnerability scans to identify potential vulnerabilities.", "Mitigation": "To mitigate this vulnerability, systems administrators should patch the Linux kernel to version 6.9.11 or higher. They should also configure the system to prevent the exploitation of the vulnerability by disabling the filemap_fault_recheck_pte_none function.", "Conclusion": "The CVE-2024-42233 vulnerability in the Linux kernel is a serious vulnerability that can be exploited by an attacker to gain control of the system. To mitigate this vulnerability, systems administrators should patch the Linux kernel and configure the system to prevent the exploitation of the vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-42233 vulnerability in the Linux kernel is a serious vulnerability that affects all versions of the kernel from 6.9 to 6.9.10. This vulnerability can be exploited by an attacker to gain control of the system, steal sensitive information, and disrupt the normal functioning of the system.", "Business Impact": "The business impact of this vulnerability is the potential loss of sensitive information, disruption to normal functioning of the system, and potential financial losses.", "Technical Impact": "The technical impact of this vulnerability is the potential for an attacker to gain control of the system, steal sensitive information, and disrupt the normal functioning of the system.", "Mitigation Strategies": "To mitigate this vulnerability, systems administrators should patch the Linux kernel to version 6.9.11 or higher. They should also configure the system to prevent the exploitation of the vulnerability by disabling the filemap_fault_recheck_pte_none function.", "Recommendations": "Recommendations for executives include patching the Linux kernel, configuring the system to prevent the exploitation of the vulnerability, and conducting regular vulnerability scans to identify potential vulnerabilities.", "Conclusions": "In conclusion, the CVE-2024-42233 vulnerability in the Linux kernel is a serious vulnerability that can be exploited by an attacker to gain control of the system. To mitigate this vulnerability, systems administrators should patch the Linux kernel and configure the system to prevent the exploitation of the vulnerability."}}