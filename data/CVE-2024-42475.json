{"id": "CVE-2024-42475", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-15T19:15:19.520", "lastModified": "2024-08-19T13:00:23.117", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the OAuth library for nim prior to version 0.11, the `state` values generated by the `generateState` function do not have sufficient entropy. These can be successfully guessed by an attacker allowing them to perform a CSRF vs a user, associating the user's session with the attacker's protected resources. While `state` isn't exactly a cryptographic value, it should be generated in a cryptographically secure way. `generateState` should be using a CSPRNG. Version 0.11 modifies the `generateState` function to generate `state` values of at least 128 bits of entropy while using a CSPRNG."}, {"lang": "es", "value": "En la librer\u00eda OAuth para nim anterior a la versi\u00f3n 0.11, los valores de \"state\" generados por la funci\u00f3n \"generateState\" no tienen suficiente entrop\u00eda. Un atacante puede adivinarlos con \u00e9xito, permiti\u00e9ndole realizar un CSRF frente a un usuario, asociando la sesi\u00f3n del usuario con los recursos protegidos del atacante. Si bien \"state\" no es exactamente un valor criptogr\u00e1fico, debe generarse de forma criptogr\u00e1ficamente segura. `generateState` deber\u00eda usar un CSPRNG. La versi\u00f3n 0.11 modifica la funci\u00f3n \"generateState\" para generar valores de \"state\" de al menos 128 bits de entrop\u00eda mientras se usa un CSPRNG."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-330"}, {"lang": "en", "value": "CWE-352"}]}], "references": [{"url": "https://github.com/CORDEA/oauth/blob/b8c163b0d9cfad6d29ce8c1fb394e5f47182ee1c/src/oauth2.nim#L179", "source": "security-advisories@github.com"}, {"url": "https://github.com/CORDEA/oauth/security/advisories/GHSA-332c-q46h-fg8f", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1097", "comment": "CVE-2024-42475 - Poorly generated state values can be exploited to perform a CSRF attack, allowing an attacker to associate the victim's session with their own protected resources. This technique can be used to gain unauthorized access to sensitive data or systems."}, {"techniqueID": "T1204", "comment": "CVE-2024-42475 - The lack of sufficient entropy in the 'state' values generated by the 'generateState' function can be exploited by attackers to successfully guess the values. This technique can be used to compromise the integrity and availability of sensitive data or systems."}, {"techniqueID": "T1574", "comment": "CVE-2024-42475 - The incorrect use of a non-cryptographically secure method for generating 'state' values can be exploited by attackers to inject arbitrary code and commands into a victim's system. This technique can be used to escalate privileges and gain unauthorized access to sensitive data or systems."}], "stix_bundle": {"@type": "bundle", "description": "STIX 2.1 Bundle for CVE-2024-42475", "id": " https://example.com/cve-2024-42475.stix", "objects": [{"@type": "indicator", "id": "indicator--cve-2024-42475", "name": "CVE-2024-42475", "description": "Poorly generated state values can be exploited to perform a CSRF attack", "created": "2024-09-01T12:00:00.000", "modified": "2024-09-01T12:00:00.000", "pattern": {"@type": "pattern", "id": "pattern--cve-2024-42475", "name": "Pattern for CVE-2024-42475", "description": "Pattern for detecting CVE-2024-42475", "created": "2024-09-01T12:00:00.000", "modified": "2024-09-01T12:00:00.000", "simple_pattern": {"@type": "simple_pattern", "id": "simple_pattern--cve-2024-42475", "name": "Simple Pattern for CVE-2024-42475", "description": "Simple pattern for detecting CVE-2024-42475", "created": "2024-09-01T12:00:00.000", "modified": "2024-09-01T12:00:00.000", "condition": "generateState( ) >= 128 && generateState( ) <= 129"}}, "handling": {"@type": "handling", "id": "handling--cve-2024-42475", "name": "Handling for CVE-2024-42475", "description": "Handling for CVE-2024-42475", "created": "2024-09-01T12:00:00.000", "modified": "2024-09-01T12:00:00.000", "mitigation": {"@type": "mitigation", "id": "mitigation--cve-2024-42475", "name": "Mitigation for CVE-2024-42475", "description": "Mitigation for CVE-2024-42475", "created": "2024-09-01T12:00:00.000", "modified": "2024-09-01T12:00:00.000", "recommended_actions": [{"@type": "recommended_action", "id": "recommended_action--cve-2024-42475-1", "name": "Recommended Action 1 for CVE-2024-42475", "description": "Recommended action 1 for CVE-2024-42475", "created": "2024-09-01T12:00:00.000", "modified": "2024-09-01T12:00:00.000", "technique": {"@type": "technique", "id": "technique--cve-2024-42475-1", "name": "Technique 1 for CVE-2024-42475", "description": "Technique 1 for CVE-2024-42475", "created": "2024-09-01T12:00:00.000", "modified": "2024-09-01T12:00:00.000"}}], "recommended_devices": [{"@type": "recommended_device", "id": "recommended_device--cve-2024-42475-1", "name": "Recommended Device 1 for CVE-2024-42475", "description": "Recommended device 1 for CVE-2024-42475", "created": "2024-09-01T12:00:00.000", "modified": "2024-09-01T12:00:00.000"}]}}}]}, "technical_analysis": {"Introduction": "CVE-2024-42475 is a vulnerability in the OAuth library for nim that affects the generation of 'state' values. This vulnerability allows attackers to perform a CSRF attack, which can be used to gain unauthorized access to sensitive data or systems.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 6.5. The affected system is any system using the OAuth library for nim prior to version 0.11.", "Related MITRE ATT&CK Techniques": "T1097, T1204, T1574", "Technical Details": "The vulnerability is caused by the use of a non-cryptographically secure method for generating 'state' values. This allows attackers to successfully guess the values and perform a CSRF attack.", "Detection": "Detection of this vulnerability can be done by monitoring for suspicious network traffic patterns and analyzing HTTP requests for CSRF attacks.", "Mitigation": "The recommended mitigation for this vulnerability is to update the OAuth library for nim to version 0.11 or later, which generates 'state' values using a cryptographically secure method.", "Conclusion": "In conclusion, CVE-2024-42475 is a significant vulnerability that allows attackers to perform a CSRF attack. It is important to update the OAuth library for nim to the latest version to prevent this vulnerability."}, "executive_analysis": {"Overview": "CVE-2024-42475 is a vulnerability in the OAuth library for nim that affects the generation of 'state' values.", "Business Impact": "The business impact of this vulnerability is high, as it allows attackers to perform a CSRF attack and gain unauthorized access to sensitive data or systems.", "Technical Impact": "The technical impact of this vulnerability is high, with a CVSS score of 6.5. The affected system is any system using the OAuth library for nim prior to version 0.11.", "Mitigation Strategies": "The recommended mitigation for this vulnerability is to update the OAuth library for nim to version 0.11 or later, which generates 'state' values using a cryptographically secure method.", "Recommendations": "Recommendations for executives include: reviewing the use of the OAuth library for nim in their systems, ensuring that all systems are updated to the latest version of the library, and implementing additional security measures to prevent CSRF attacks.", "Conclusions": "In conclusion, CVE-2024-42475 is a significant vulnerability that requires immediate attention. Executives should take action to mitigate this vulnerability by updating the OAuth library for nim and implementing additional security measures."}}