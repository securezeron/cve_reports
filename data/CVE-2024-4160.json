{"id": "CVE-2024-4160", "sourceIdentifier": "security@wordfence.com", "published": "2024-05-31T10:15:09.977", "lastModified": "2024-05-31T13:01:46.727", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Download Manager plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's 'wpdm-all-packages' shortcode in all versions up to, and including, 3.2.90 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page."}, {"lang": "es", "value": "El complemento Download Manager para WordPress es vulnerable a las Cross-Site Scripting Almacenado a trav\u00e9s del c\u00f3digo corto 'wpdm-all-packages' del complemento en todas las versiones hasta la 3.2.90 incluida debido a una sanitizaci\u00f3n de entrada insuficiente y a un escape de salida en los atributos proporcionados por el usuario. Esto hace posible que atacantes autenticados, con acceso de nivel de colaborador y superior, inyecten scripts web arbitrarios en p\u00e1ginas que se ejecutar\u00e1n cada vez que un usuario acceda a una p\u00e1gina inyectada."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.1, "impactScore": 2.7}]}, "references": [{"url": "https://plugins.trac.wordpress.org/browser/download-manager/trunk/src/Package/views/all-packages-shortcode.php?rev=2996137#L202", "source": "security@wordfence.com"}, {"url": "https://plugins.trac.wordpress.org/changeset/3080781/", "source": "security@wordfence.com"}, {"url": "https://wordpress.org/plugins/download-manager/", "source": "security@wordfence.com"}, {"url": "https://wordpress.org/plugins/download-manager/#developers", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/9f51258a-e228-412f-9d97-28ab679136d7?source=cve", "source": "security@wordfence.com"}, {"url": "https://www.wpdownloadmanager.com/doc/short-codes/wpdm_all_packages-list-all-downloads-in-tabular-format-in-a-page/", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "TA0048", "comment": "Cross-Site Scripting (XSS) - CVE-2024-4160 - The vulnerability allows an authenticated attacker to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page."}, {"techniqueID": "T1048", "comment": "Web Shellcode - CVE-2024-4160 - An attacker can inject shellcode using a stored XSS vulnerability, allowing for arbitrary code execution."}, {"techniqueID": "T1190", "comment": "Exploit Public-Facing Application - CVE-2024-4160 - The vulnerability allows an attacker to exploit a public-facing application to inject arbitrary web scripts."}], "stix_bundle": {"type": "bundle", "id": "vulnerability_bundle:45f63a0a-4a28-4c54-a3a5-43f7af05341c", "objects": [{"type": "attack-pattern", "id": "attack-pattern:6c1a46e6-91d4-4f5e-a0b9-4b7a3c9a34cf", "name": "Cross-Site Scripting (XSS)"}, {"type": "tool", "id": "tool:cebaa5f5-2c13-4b7a-9e6f-54a1bac3d3a9", "name": "Wordfence"}, {"type": "vulnerability", "id": "vulnerability:45f63a0a-4a28-4c54-a3a5-43f7af05341c", "name": "CVE-2024-4160"}, {"type": "indicator", "id": "indicator:aa5b6cc7-68cd-4631-ab4a-10a2d9d5a8a1", "name": "Download Manager Plugin Stored XSS"}, {"type": "course-of-action", "id": "course-of-action:b7d73f4f-b28f-49a5-a7a2-d4f7cfc4a33d", "name": "Update Software"}, {"type": "indicator", "id": "indicator:5f5c43ed-74b4-4c9c-94b5-7d1a2c1cd43f", "name": "Unauthenticated Source"}], "relationships": [{"type": "relates", "id": "relates:3e94d1ce-7a3c-44c9-a6c3-eb9a7b2af3c5", "source": "vulnerability:45f63a0a-4a28-4c54-a3a5-43f7af05341c", "relationship": "uses", "target": "tool:cebaa5f5-2c13-4b7a-9e6f-54a1bac3d3a9"}, {"type": "relates", "id": "relates:0d4bdf45-9d5e-4d4e-83d1-cb6e25b55b43", "source": "vulnerability:45f63a0a-4a28-4c54-a3a5-43f7af05341c", "relationship": "uses", "target": "attack-pattern:6c1a46e6-91d4-4f5e-a0b9-4b7a3c9a34cf"}, {"type": "relates", "id": "relates:5d9e47be-5e9e-4435-a91c-5eedbb0b5dbb", "source": "vulnerability:45f63a0a-4a28-4c54-a3a5-43f7af05341c", "relationship": "vulnerable-to", "target": "course-of-action:b7d73f4f-b28f-49a5-a7a2-d4f7cfc4a33d"}]}, "technical_analysis": {"Introduction": "The vulnerability allows an authenticated attacker to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.", "Impact and Scope": "The vulnerability affects all versions of the Download Manager plugin for WordPress up to and including 3.2.90.", "Related MITRE ATT&CK Techniques": "TA0048, T1048, T1190", "Technical Details": "The vulnerability is due to insufficient input sanitization and output escaping on user-supplied attributes in the plugin's 'wpdm-all-packages' shortcode.", "Detection": "Detecting this vulnerability requires inspecting the 'wpdm-all-packages' shortcode and looking for suspicious user-supplied attributes.", "Mitigation": "Updating the Download Manager plugin to a version greater than 3.2.90, or using a web application security scanner to detect and remediate the vulnerability.", "Conclusion": "The vulnerability poses a serious risk to WordPress administrators and users, and prompt action must be taken to update the plugin and protect against exploitation."}, "executive_analysis": {"Overview": "A vulnerability in the Download Manager plugin for WordPress allows authenticated attackers to inject arbitrary web scripts.", "Business Impact": "The vulnerability could allow attackers to execute arbitrary code, which could compromise sensitive data, disrupt business operations, and damage reputation.", "Technical Impact": "The vulnerability affects all versions of the Download Manager plugin up to and including 3.2.90, and requires immediate attention to prevent exploitation.", "Mitigation Strategies": "Patch the vulnerability as soon as possible, use a web application security scanner to detect and remediate the vulnerability, and conduct regular security testing to identify and remediate similar vulnerabilities.", "Recommendations": "WordPress administrators should update the Download Manager plugin to a version greater than 3.2.90, and users should use a web application security scanner to protect against exploitation.", "Conclusions": "The vulnerability emphasizes the importance of prompt action to address security vulnerabilities, and the need for continuous monitoring and testing to identify and remediate similar vulnerabilities."}}