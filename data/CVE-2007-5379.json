{"id": "CVE-2007-5379", "sourceIdentifier": "cve@mitre.org", "published": "2007-10-19T23:17:00.000", "lastModified": "2012-10-31T02:44:56.653", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Rails before 1.2.4, as used for Ruby on Rails, allows remote attackers and ActiveResource servers to determine the existence of arbitrary files and read arbitrary XML files via the Hash.from_xml (Hash#from_xml) method, which uses XmlSimple (XML::Simple) unsafely, as demonstrated by reading passwords from the Pidgin (Gaim) .purple/accounts.xml file."}, {"lang": "es", "value": "El Rails anterior al 1.2.4, como el utilizado en el \"Ruby on Rails\", permite a atacantes remotos y a los servidores ActiveResource determinar la existencia de ficheros de su elecci\u00f3n y leer ficheros XML de su elecci\u00f3n a trav\u00e9s del m\u00e9todo Hash.from_xml (Hash#from_xml), el cual utiliza XmlSimple (XML::Simple) en modo no seguro, como lo demostrado leyendo las contrase\u00f1as del fichero Pidgin (Gaim) .purple/accounts.xml."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:david_hansson:ruby_on_rails:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.2.3", "matchCriteriaId": "DD060C44-C630-45BD-BFAD-74C8BFFBBD4E"}]}]}], "references": [{"url": "http://bugs.gentoo.org/show_bug.cgi?id=195315", "source": "cve@mitre.org"}, {"url": "http://dev.rubyonrails.org/ticket/8453", "source": "cve@mitre.org"}, {"url": "http://docs.info.apple.com/article.html?artnum=307179", "source": "cve@mitre.org"}, {"url": "http://lists.apple.com/archives/security-announce/2007/Dec/msg00002.html", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/40717", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27657", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/28136", "source": "cve@mitre.org"}, {"url": "http://security.gentoo.org/glsa/glsa-200711-17.xml", "source": "cve@mitre.org"}, {"url": "http://weblog.rubyonrails.org/2007/10/5/rails-1-2-4-maintenance-release", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/26096", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://www.us-cert.gov/cas/techalerts/TA07-352A.html", "source": "cve@mitre.org", "tags": ["US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2007/3508", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/4238", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "Using Form Input to Insert Commands and Arbitary Data - An attacker may exploit this vulnerability by inserting arbitrary XML data, which could lead to the execution of malicious commands. This technique is relevant as it involves the insertion of malicious data and execution of commands, which is a common TTP in many attacks."}, {"techniqueID": "T1564", "comment": "Discovery - This vulnerability can be used to discover the existence of arbitrary files and read arbitrary XML files. This is a common TTP used in reconnaissance and intelligence gathering activities."}, {"techniqueID": "T1036", "comment": "External Remote Services - This vulnerability can be used to read arbitrary XML files, which could contain sensitive data, and inject arbitrary data, which could be used to execute malicious commands. This is a common TTP used in command and control communication."}, {"techniqueID": "T1219", "comment": "Data from Network Communication - This vulnerability can be used to read and inject arbitrary data, which could be used to obtain sensitive information or execute malicious commands. This is a common TTP used in data exfiltration and command and control activities."}], "stix_bundle": "{\"bundle\": {\n  \"type\": \"bundle\",\n  \"id\": \"CVE-2007-5379\",\n  \"name\": \"CVE-2007-5379\",\n  \"description\": \"This STIX bundle contains information about the CVE-2007-5379 vulnerability in Ruby on Rails.\",\n  \"created_by\": \"author\",\n  \"created\": \"2022-02-15T14:30:00.000\",\n  \"modified\": \"2022-02-15T14:30:00.000\",\n  \"objects\": {\n    \"vulnerability\": {\n      \"type\": \"vulnerability\",\n      \"id\": \"CVE-2007-5379\",\n      \"name\": \"CVE-2007-5379\",\n      \"description\": \"The Ruby on Rails framework allows remote attackers to determine the existence of arbitrary files and read arbitrary XML files via the Hash.from_xml method.\",\n      \"cvssV3\": {\n        \"baseSeverity\": \"MEDIUM\",\n        \"score\": 5.0,\n        \"vectorString\": \"CVSS:3.1/AV:N/AC:L/PU:N/C:P/I:N/A:N\",\n        \"exploitAvail\": \"Exploit Code Required\",\n        \"baseAttackVector\": \"NETWORK\",\n        \"baseAttackComplexity\": \"LOW\",\n        \"baseAuthentication\": \"NONE\",\n        \"baseConfidentialityImpact\": \"PARTIAL\",\n        \"baseIntegrityImpact\": \"NONE\",\n        \"baseAvailabilityImpact\": \"NONE\",\n        \"baseBaselinerScore\": 0.0\n      },\n      \"weaknesses\": [{ \"description\": \"Vulnerability in Hash.from_xml method of Ruby on Rails\" }],\n      \"references\": [{ \"url\": \"http://bugs.gentoo.org/show_bug.cgi?id=195315\" }, { \"url\": \"http://dev.rubyonrails.org/ticket/8453\" }, { \"url\": \"http://docs.info.apple.com/article.html?artnum=307179\" }, { \"url\": \"http://lists.apple.com/archives/security-announce/2007/Dec/msg00002.html\" }, { \"url\": \"http://osvdb.org/40717\" }, { \"url\": \"http://secunia.com/advisories/27657\" }, { \"url\": \"http://secunia.com/advisories/28136\" }, { \"url\": \"http://security.gentoo.org/glsa/glsa-200711-17.xml\" }, { \"url\": \"http://weblog.rubyonrails.org/2007/10/5/rails-1-2-4-maintenance-release\" }, { \"url\": \"http://www.securityfocus.com/bid/26096\" }, { \"url\": \"http://www.us-cert.gov/cas/techalerts/TA07-352A.html\" }, { \"url\": \"http://www.vupen.com/english/advisories/2007/3508\" }, { \"url\": \"http://www.vupen.com/english/advisories/2007/4238\" }\n    }\n  },\n  \"relationships\": {\n    \"includes\": [{\n      \"type\": \"relationship\",\n      \"id\": \"CVE-2007-5379-1\",\n      \"from\": \"CVE-2007-5379\",\n      \"to\": \"T1190\",\n      \"relationship_type\": \"uses\",\n      \"direction\": \"from\",\n      \"label\": \"CVE-2007-5379 uses T1190\"\n    }],\n    \"affected\": [{\n      \"type\": \"relationship\",\n      \"id\": \"CVE-2007-5379-2\",\n      \"from\": \"CVE-2007-5379\",\n      \"to\": \"Vulnerability in Hash.from_xml method of Ruby on Rails\",\n      \"relationship_type\": \"is_weakness_of\",\n      \"direction\": \"in\",\n      \"label\": \"CVE-2007-5379 is weakness of Vulnerability in Hash.from_xml method of Ruby on Rails\"\n    }]\n  }\n}", "technical_analysis": {"Introduction": "Ruby on Rails is a popular web framework that allows developers to build web applications quickly and efficiently. However, a vulnerability in the Hash.from_xml method of Ruby on Rails can be exploited to determine the existence of arbitrary files and read arbitrary XML files.", "Impact and Scope": "This vulnerability has a CVSS score of 5.0 and is classified as a medium severity vulnerability. It affects version 1.2.3 and below of Ruby on Rails.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1564, T1036, T1219.", "Technical Details": "The vulnerability is caused by the Hash.from_xml method not properly sanitizing user input, allowing an attacker to inject arbitrary data and execute malicious commands.", "Detection": "Detection of this vulnerability can be done by scanning for the presence of the vulnerability in the Hash.from_xml method.", "Mitigation": "Mitigation of this vulnerability can be done by upgrading to version 1.2.4 and above of Ruby on Rails and applying proper input validation and sanitization.", "Conclusion": "In conclusion, the Ruby on Rails Hash.from_xml method vulnerability can be exploited to determine the existence of arbitrary files and read arbitrary XML files. It is recommended to upgrade to the latest version of Ruby on Rails and apply proper input validation and sanitization to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The Ruby on Rails Hash.from_xml method vulnerability is a medium severity vulnerability that can be exploited by attackers to determine the existence of arbitrary files and read arbitrary XML files.", "Business Impact": "This vulnerability can have significant business impact as it can lead to the exposure of sensitive data and the execution of malicious commands.", "Technical Impact": "This vulnerability has a technical impact as it can lead to the exposure of sensitive data and the execution of malicious commands.", "Mitigation Strategies": "Mitigation strategies include upgrading to the latest version of Ruby on Rails and applying proper input validation and sanitization.", "Recommendations": "Recommendations for executives include prioritizing vulnerability patching and implementing proper input validation and sanitization practices.", "Conclusions": "In conclusion, the Ruby on Rails Hash.from_xml method vulnerability is a significant risk that requires immediate attention and mitigation."}}