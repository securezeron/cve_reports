{"id": "CVE-2024-4146", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-08T20:15:52.117", "lastModified": "2024-08-30T16:15:09.813", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In lunary-ai/lunary version v1.2.13, an incorrect authorization vulnerability exists that allows unauthorized users to access and manipulate projects within an organization they should not have access to. Specifically, the vulnerability is located in the `checkProjectAccess` method within the authorization middleware, which fails to adequately verify if a user has the correct permissions to access a specific project. Instead, it only checks if the user is part of the organization owning the project, overlooking the necessary check against the `account_project` table for explicit project access rights. This flaw enables attackers to gain complete control over all resources within a project, including the ability to create, update, read, and delete any resource, compromising the privacy and security of sensitive information."}, {"lang": "es", "value": "En lunary-ai/lunary versi\u00f3n v1.2.13, existe una vulnerabilidad de autorizaci\u00f3n inadecuada que permite a usuarios no autorizados acceder y manipular proyectos dentro de una organizaci\u00f3n a la que no deber\u00edan tener acceso. Espec\u00edficamente, la vulnerabilidad se ubica en el m\u00e9todo `checkProjectAccess` dentro del middleware de autorizaci\u00f3n, que no logra verificar adecuadamente si un usuario tiene los permisos correctos para acceder a un proyecto espec\u00edfico. En cambio, solo verifica si el usuario es parte de la organizaci\u00f3n propietaria del proyecto, pasando por alto la verificaci\u00f3n necesaria en la tabla `account_project` para obtener derechos de acceso expl\u00edcitos al proyecto. Esta falla permite a los atacantes obtener control total sobre todos los recursos dentro de un proyecto, incluida la capacidad de crear, actualizar, leer y eliminar cualquier recurso, comprometiendo la privacidad y seguridad de la informaci\u00f3n confidencial."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-863"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-863"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:lunary:lunary:1.2.13:*:*:*:*:*:*:*", "matchCriteriaId": "7223CE59-4E84-4008-9E35-D2B9D25ADD1E"}]}]}], "references": [{"url": "https://github.com/lunary-ai/lunary/commit/c43b6c62035f32ca455f66d5fd22ba661648cde7", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.com/bounties/a749e696-b398-4260-b2d0-b0054b9fffa7", "source": "security@huntr.dev", "tags": ["Exploit", "Issue Tracking"]}], "techniques": [{"techniqueID": "T1499", "comment": "CVE-2024-4146 - Authorization Bypass allows unauthorized users to access and manipulate projects, enabling complete control over resources, compromising privacy and security."}, {"techniqueID": "T1003", "comment": "CVE-2024-4146 - Web Shelling allows attackers to access and manipulate projects, potentially leading to complete control over resources, compromising privacy and security."}, {"techniqueID": "T1210", "comment": "CVE-2024-4146 - Exploitation for Client Execution allows attackers to access and manipulate projects, potentially leading to complete control over resources, compromising privacy and security."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "https://nvd.nist.gov/vuln/detail/CVE-2024-4146", "created_by": "MITRE", "created_on": "2024-08-30T16:15:09.813Z", "modified_by": "MITRE", "modified_on": "2024-08-30T16:15:09.813Z", "objects": [{"type": "vulnerability", "id": "https://nvd.nist.gov/vuln/detail/CVE-2024-4146", "name": "CVE-2024-4146 - Authorization Bypass in lunary-ai/lunary", "description": "In lunary-ai/lunary version v1.2.13, an incorrect authorization vulnerability exists that allows unauthorized users to access and manipulate projects within an organization they should not have access to", "vulnerability_types": ["CWE-863"], "cvss3_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "cvss3_score": 9.8, "cvss3_severity": "CRITICAL", "references": [{"type": "reference", "id": "https://github.com/lunary-ai/lunary/commit/c43b6c62035f32ca455f66d5fd22ba661648cde7", "uri": "https://github.com/lunary-ai/lunary/commit/c43b6c62035f32ca455f66d5fd22ba661648cde7", "relationship": "has_patch"}], "objects": [{"type": "exploit", "id": "https://huntr.com/bounties/a749e696-b398-4260-b2d0-b0054b9fffa7", "name": "CVE-2024-4146 - Exploit", "description": "An exploit for CVE-2024-4146 exists that allows attackers to access and manipulate projects", "techniques": [{"type": "exploitation", "id": "T1210", "name": "Exploitation for Client Execution"}]}], "courses_of_action": [{"type": "course_of_action", "id": "https://cisa.gov/uscert/ics/advice-and-resources/ics-detection-and-response", "name": "ICS Detection and Response", "description": "Use the ICS Detection and Response framework to detect and respond to the vulnerability", "techniques": [{"type": "defense_evasion", "id": "T1564", "name": "Defence Evasion"}]}]}]}}, "technical_analysis": {"Introduction": "CVE-2024-4146 is an authorization bypass vulnerability in lunary-ai/lunary version v1.2.13, allowing unauthorized users to access and manipulate projects.", "Impact and Scope": "The vulnerability is rated CVSS 3.1 with a base score of 9.8, and allows attackers to access and manipulate all resources within a project.", "Related MITRE ATT&CK Techniques": "Related techniques include T1499, T1003, and T1210.", "Technical Details": "The vulnerability occurs due to an incorrect authorization check in the `checkProjectAccess` method, which allows unauthorized users to access and manipulate projects.", "Detection": "Detection involves monitoring for unusual project access and manipulation", "Mitigation": "Mitigation strategies include patching the vulnerability and implementing additional authorization checks", "Conclusion": "CVE-2024-4146 is a critical vulnerability that allows unauthorized access and manipulation of projects, and should be prioritized for patching and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-4146 is a critical security vulnerability in lunary-ai/lunary version v1.2.13, allowing unauthorized access and manipulation of projects.", "Business Impact": "The vulnerability poses a significant risk to business operations, as it allows unauthorized users to access and manipulate sensitive information.", "Technical Impact": "The vulnerability is a critical security risk, allowing attackers to access and manipulate all resources within a project.", "Mitigation Strategies": "Mitigation strategies include patching the vulnerability and implementing additional authorization checks", "Recommendations": "Recommendations for executives include prioritizing patching and mitigation, and implementing additional security measures.", "Conclusions": "CVE-2024-4146 is a critical vulnerability that requires immediate attention and mitigation to protect business operations and sensitive information."}}