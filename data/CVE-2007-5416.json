{"id": "CVE-2007-5416", "sourceIdentifier": "cve@mitre.org", "published": "2007-10-12T21:17:00.000", "lastModified": "2018-10-15T21:44:38.703", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Drupal 5.2 and earlier does not properly unset variables when the input data includes a numeric parameter with a value matching an alphanumeric parameter's hash value, which allows remote attackers to execute arbitrary PHP code by invoking the drupal_eval function through a callback parameter to the default URI, as demonstrated by the _menu[callbacks][1][callback] parameter.  NOTE: it could be argued that this vulnerability is due to a bug in the unset PHP command (CVE-2006-3017) and the proper fix should be in PHP; if so, then this should not be treated as a vulnerability in Drupal."}, {"lang": "es", "value": "Drupal 5.2 y versiones anteriores no des-asigna el valor de las variables apropiadamente cuando los datos de entrada incluyen un par\u00e1metro num\u00e9rico con un valor que casa con un valor resumen de un par\u00e1metro alfanum\u00e9rico, lo cual permite a atacantes remotos ejecutar c\u00f3digo PHP de su elecci\u00f3n al invocar la funci\u00f3n drupal_eval a trav\u00e9s de un par\u00e1metro de llamada inversa (callback) a el URI por defecto, como se demuestra con el par\u00e1metro _menu[callbacks][1][callback].\r\nNOTA: se podr\u00eda discutir que esta vulnerabilidad se debe a un error de programaci\u00f3n en el comando PHP unset (CVE-2006-3017) y el parche apropiado que deber\u00eda estar en PHP; de ser as\u00ed, este asunto no deber\u00eda ser tratado como vulnerabilidad en Drupal."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-189"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:drupal:drupal:*:*:*:*:*:*:*:*", "versionEndIncluding": "5.2", "matchCriteriaId": "0370CE41-AC3A-463F-B171-C67C4CC91251"}]}]}], "references": [{"url": "http://securityreason.com/securityalert/3216", "source": "cve@mitre.org"}, {"url": "http://securityvulns.ru/Sdocument137.html", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.securityfocus.com/archive/1/482006/100/0/threaded", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/4510", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0002", "comment": "CVE-2007-5416 - Insufficient Path Canonicalization and Filtering allows remote attackers to execute arbitrary PHP code by invoking the drupal_eval function through a callback parameter to the default URI, as demonstrated by the _menu[callbacks][1][callback] parameter."}, {"techniqueID": "T1190", "comment": "CVE-2007-5416 - Exploit: PHP Remote File Include, allows remote attackers to execute arbitrary PHP code by including a malicious file via a crafted callback parameter to the default URI."}, {"techniqueID": "T1192", "comment": "CVE-2007-5416 - Exploit: Web Shell, allows remote attackers to execute arbitrary PHP code by uploading and executing a malicious script via a crafted callback parameter to the default URI."}, {"techniqueID": "T1027", "comment": "CVE-2007-5416 - Command and Control: Remote File Copy, allows remote attackers to execute arbitrary PHP code by copying a malicious file to the server via a crafted callback parameter to the default URI."}, {"techniqueID": "T1193", "comment": "CVE-2007-5416 - Exploit: PHP Object Injection, allows remote attackers to execute arbitrary PHP code by injecting a malicious object via a crafted callback parameter to the default URI."}], "stix_bundle": {"bundleId": "CVE-2007-5416-Related-STIX-Bundle", "bundleVersion": "1.0", "objects": [{"id": "vuln:CVE-2007-5416", "type": "vulnerability", "name": "Drupal 5.2 Insufficient Path Canonicalization", "description": "Drupal 5.2 does not properly unset variables when the input data includes a numeric parameter with a value matching an alphanumeric parameter's hash value, which allows remote attackers to execute arbitrary PHP code by invoking the drupal_eval function through a callback parameter to the default URI.", "objectMarking": [{"id": "marking-definition:/data/markings/default", "name": "Default Marking Definition"}], "objects": [{"id": "indicator:php-file-inclusion", "type": "indicator", "name": "PHP File Inclusion Indicator", "description": "Indicator of PHP file inclusion vulnerability", "pattern": "php:*:*:*:*:*:*", "createdBy": "Vuln:CVE-2007-5416"}, {"id": "course-of-action:Drupal-Upgrade", "type": "course-of-action", "name": "Drupal Upgrade", "description": "Upgrade Drupal to version 5.3 or later", "recommendedActions": ["Update Drupal to version 5.3 or later"], "relatedObjects": [{"id": "vuln:CVE-2007-5416", "type": "vulnerability", "name": "Drupal 5.2 Insufficient Path Canonicalization"}]}]}, {"id": "indicator:remote-file-include", "type": "indicator", "name": "Remote File Include Indicator", "description": "Indicator of remote file inclusion vulnerability", "pattern": "http:*:*-*:*:*:*", "createdBy": "Vuln:CVE-2007-5416"}], "relationships": [{"relationship": "derived-from", "from": "vuln:CVE-2007-5416", "to": "indicator:php-file-inclusion"}, {"relationship": "related-to", "from": "indicator:php-file-inclusion", "to": "course-of-action:Drupal-Upgrade"}]}, "technical_analysis": {"Introduction": "This vulnerability allows remote attackers to execute arbitrary PHP code by invoking the drupal_eval function through a callback parameter to the default URI in Drupal 5.2 and earlier.", "Impact and Scope": "CVE-2007-5416 has a CVSS score of 6.8 with a medium severity rating. It can be exploited by remote attackers, allowing them to execute arbitrary PHP code.", "Related MITRE ATT&CK Techniques": "Related techniques include Command and Control: Remote File Copy (T1027), Exploit: PHP Remote File Include (T1190), and Exploit: Web Shell (T1192).", "Technical Details": "This vulnerability is due to Drupal's insufficient path canonicalization and filtering, which allows attackers to inject malicious code.", "Detection": "Detection can be performed by monitoring network traffic for suspicious PHP file inclusion requests.", "Mitigation": "Mitigation strategies include updating Drupal to version 5.3 or later and implementing proper input validation.", "Conclusion": "In conclusion, CVE-2007-5416 is a critical vulnerability that allows remote attackers to execute arbitrary PHP code. It is essential to update Drupal to version 5.3 or later and implement proper input validation to mitigate this vulnerability."}, "executive_analysis": {"Overview": "This vulnerability affects Drupal 5.2 and earlier, allowing remote attackers to execute arbitrary PHP code.", "Business Impact": "This vulnerability can lead to significant business impact, including data breaches, system compromise, and reputational damage.", "Technical Impact": "This vulnerability has a critical technical impact, as it allows attackers to execute arbitrary PHP code and potentially compromise the system.", "Mitigation Strategies": "Mitigation strategies include updating Drupal to version 5.3 or later and implementing proper input validation.", "Recommendations": "Recommendations include prioritizing the update of Drupal, implementing regular security scans, and conducting employee training on security best practices.", "Conclusions": "In conclusion, this vulnerability is a critical security risk that requires immediate attention. Organizations should prioritize the update of Drupal and implement proper mitigation strategies to protect against this vulnerability."}}