{"id": "CVE-2007-0897", "sourceIdentifier": "cve@mitre.org", "published": "2007-02-16T19:28:00.000", "lastModified": "2024-02-09T02:48:50.797", "vulnStatus": "Analyzed", "cveTags": [], "evaluatorSolution": "This vulnerability is addressed in the following product release:\nClam AntiVirus, ClamAV, 0.90 Stable", "descriptions": [{"lang": "en", "value": "Clam AntiVirus ClamAV before 0.90 does not close open file descriptors under certain conditions, which allows remote attackers to cause a denial of service (file descriptor consumption and failed scans) via CAB archives with a cabinet header record length of zero, which causes a function to return without closing a file descriptor."}, {"lang": "es", "value": "Clam AntiVirus ClamAV anterior a 0.90 no cierra los descriptores de apertura de ficheros bajo ciertas condiciones, lo cual permite a atacantes remotos provocar denegaci\u00f3n de servicio (consumo del descriptor de fichero y fallo de escaneo) a trav\u00e9s de archivos CAB \t\r\ncon una longitud de registro con una cabecera cabinet(.CAB) de cero, lo cual provoca que una funci\u00f3n retorne sin cerrar el descriptor de fichero."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-772"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:clamav:clamav:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.90", "matchCriteriaId": "EA546DD9-A29C-4D82-8E21-80619B2FF25B"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.4.11", "matchCriteriaId": "B2D0444E-6B76-46EE-95EF-617F8967F6B6"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:3.1:*:*:*:*:*:*:*", "matchCriteriaId": "A2E0C1F8-31F5-4F61-9DF7-E49B43D3C873"}]}]}], "references": [{"url": "http://docs.info.apple.com/article.html?artnum=307562", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=475", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://lists.apple.com/archives/security-announce/2008/Mar/msg00001.html", "source": "cve@mitre.org", "tags": ["Mailing List"]}, {"url": "http://lists.suse.com/archive/suse-security-announce/2007-Feb/0004.html", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://osvdb.org/32283", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/24183", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/24187", "source": "cve@mitre.org", "tags": ["Broken Link", "Patch", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/24192", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/24319", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/24332", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/24425", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/29420", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://security.gentoo.org/glsa/glsa-200703-03.xml", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.debian.org/security/2007/dsa-1263", "source": "cve@mitre.org", "tags": ["Mailing List"]}, {"url": "http://www.mandriva.com/security/advisories?name=MDKSA-2007:043", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.securityfocus.com/bid/22580", "source": "cve@mitre.org", "tags": ["Broken Link", "Patch", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securitytracker.com/id?1017659", "source": "cve@mitre.org", "tags": ["Broken Link", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.vupen.com/english/advisories/2007/0623", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.vupen.com/english/advisories/2008/0924/references", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/32531", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1059.012", "comment": "CVE-2007-0897 - An attacker can potentially leverage this vulnerability to cause a denial of service by creating a CAB archive with a zero-length cabinet header record, which can lead to a file descriptor exhaustion, making it difficult for the system to scan files and potentially leading to a failed scan. This technique is relevant because it demonstrates how an attacker can exploit this vulnerability to achieve a denial of service. Defending against this vulnerability involves properly closing file descriptors in ClamAV and monitoring system logs for signs of file descriptor exhaustion."}, {"techniqueID": "T1190", "comment": "CVE-2007-0897 - This vulnerability can be exploited to obtain a remote command shell. ClamAV's failure to close file descriptors can be used to create a persistent backdoor by an attacker, which can lead to unintended consequences. This technique is relevant because it demonstrates how an attacker can use this vulnerability to obtain unauthorized access to a system. Defending against this vulnerability involves properly configuring ClamAV and implementing monitoring and logging mechanisms to detect potential vulnerabilities."}, {"techniqueID": "T1437", "comment": "CVE-2007-0897 - The failure to close file descriptors in ClamAV can be used to execute arbitrary system commands. This technique is relevant because it demonstrates how an attacker can use this vulnerability to execute system commands. Defending against this vulnerability involves properly configuring ClamAV and implementing monitoring and logging mechanisms to detect potential vulnerabilities."}], "stix_bundle": {"@context": "https://stix2.io/version/2.1", "bundle": {"id": "bundle-cve-2007-0897", "type": "bundle", "created_by_ref": "https://stix2.io", "created": "2023-02-16T14:30:00.000", "modified": "2023-02-16T14:30:00.000", "objects": [{"id": "cve-2007-0897", "type": "vulnerability", "name": "CVE-2007-0897", "description": "Clam Anti-Virus ClamAV before 0.90 does not close open file descriptors under certain conditions, which allows remote attackers to cause a denial of service (file descriptor consumption and failed scans) via CAB archives with a cabinet header record length of zero, which causes a function to return without closing a file descriptor.", "threat_actor": [{"id": "threat-actor-1", "type": "threat-actor", "name": "Malicious Hacker", "description": "A malicious hacker who seeks to exploit vulnerabilities for personal gain."}], "vulnerable_system": [{"id": "system-1", "type": "system", "name": "Clam Anti-Virus ClamAV", "description": "Clam Anti-Virus ClamAV before 0.90 vulnerable to remote code execution."}], "tactic": [{"id": "tactic-1", "type": "tactic", "name": " Execution", "description": "The goal is to execute system commands."}], "mitigation": [{"id": "mitigation-1", "type": "mitigation", "name": "Apply patch", "description": "Apply the patch to fix the vulnerability."}], "note": [{"id": "note-1", "type": "note", "description": "This vulnerability can be exploited to obtain a remote command shell. The failure to close file descriptors in ClamAV can be used to execute arbitrary system commands. ClamAV's failure to close file descriptors can be used to create a persistent backdoor by an attacker, which can lead to unintended consequences.", "relationship": "related-course-of-action"}]}], "relationships": [{"id": "relationship-1", "type": "related-course-of-action", "description": "This vulnerability is related to the T1059.012 technique, which is a MITRE ATT&CK technique.", "from": "cve-2007-0897", "to": "T1059.012"}]}}, "technical_analysis": {"Introduction": "The CVE-2007-0897 vulnerability is a remote code execution vulnerability in Clam Anti-Virus ClamAV before 0.90. It is caused by the failure to close open file descriptors under certain conditions, which can lead to a denial of service (file descriptor consumption and failed scans).", "Impact and Scope": "The impact of this vulnerability is a remote command shell with code execution capabilities. The scope of this vulnerability is Clam Anti-Virus ClamAV before 0.90.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1059.012, T1190, and T1437.", "Technical Details": "The technical details of this vulnerability are the failure to close open file descriptors under certain conditions, which can lead to a denial of service (file descriptor consumption and failed scans).", "Detection": "The detection methods for this vulnerability are monitoring system logs for signs of file descriptor exhaustion and scanning files for potential vulnerabilities.", "Mitigation": "The mitigation strategies for this vulnerability are to apply the patch, monitor system logs for signs of file descriptor exhaustion, and scan files for potential vulnerabilities.", "Conclusion": "In conclusion, the CVE-2007-0897 vulnerability is a remote code execution vulnerability in Clam Anti-Virus ClamAV before 0.90. It can be exploited to obtain a remote command shell with code execution capabilities. The mitigation strategies for this vulnerability are to apply the patch, monitor system logs for signs of file descriptor exhaustion, and scan files for potential vulnerabilities."}, "executive_analysis": {"Overview": "The CVE-2007-0897 vulnerability is a remote code execution vulnerability in Clam Anti-Virus ClamAV before 0.90.", "Business Impact": "The business impact of this vulnerability is the potential for data breaches and unauthorized access to sensitive information.", "Technical Impact": "The technical impact of this vulnerability is the potential for remote code execution with code execution capabilities.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are to apply the patch, monitor system logs for signs of file descriptor exhaustion, and scan files for potential vulnerabilities.", "Recommendations": "Recommendations for executives include applying the patch, monitoring system logs for signs of file descriptor exhaustion, and scanning files for potential vulnerabilities.", "Conclusions": "In conclusion, the CVE-2007-0897 vulnerability is a remote code execution vulnerability in Clam Anti-Virus ClamAV before 0.90. It can be exploited to obtain a remote command shell with code execution capabilities. The mitigation strategies for this vulnerability are to apply the patch, monitor system logs for signs of file descriptor exhaustion, and scan files for potential vulnerabilities."}}