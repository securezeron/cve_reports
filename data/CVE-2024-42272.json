{"id": "CVE-2024-42272", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-17T09:15:08.370", "lastModified": "2024-08-19T12:59:59.177", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nsched: act_ct: take care of padding in struct zones_ht_key\n\nBlamed commit increased lookup key size from 2 bytes to 16 bytes,\nbecause zones_ht_key got a struct net pointer.\n\nMake sure rhashtable_lookup() is not using the padding bytes\nwhich are not initialized.\n\n BUG: KMSAN: uninit-value in rht_ptr_rcu include/linux/rhashtable.h:376 [inline]\n BUG: KMSAN: uninit-value in __rhashtable_lookup include/linux/rhashtable.h:607 [inline]\n BUG: KMSAN: uninit-value in rhashtable_lookup include/linux/rhashtable.h:646 [inline]\n BUG: KMSAN: uninit-value in rhashtable_lookup_fast include/linux/rhashtable.h:672 [inline]\n BUG: KMSAN: uninit-value in tcf_ct_flow_table_get+0x611/0x2260 net/sched/act_ct.c:329\n  rht_ptr_rcu include/linux/rhashtable.h:376 [inline]\n  __rhashtable_lookup include/linux/rhashtable.h:607 [inline]\n  rhashtable_lookup include/linux/rhashtable.h:646 [inline]\n  rhashtable_lookup_fast include/linux/rhashtable.h:672 [inline]\n  tcf_ct_flow_table_get+0x611/0x2260 net/sched/act_ct.c:329\n  tcf_ct_init+0xa67/0x2890 net/sched/act_ct.c:1408\n  tcf_action_init_1+0x6cc/0xb30 net/sched/act_api.c:1425\n  tcf_action_init+0x458/0xf00 net/sched/act_api.c:1488\n  tcf_action_add net/sched/act_api.c:2061 [inline]\n  tc_ctl_action+0x4be/0x19d0 net/sched/act_api.c:2118\n  rtnetlink_rcv_msg+0x12fc/0x1410 net/core/rtnetlink.c:6647\n  netlink_rcv_skb+0x375/0x650 net/netlink/af_netlink.c:2550\n  rtnetlink_rcv+0x34/0x40 net/core/rtnetlink.c:6665\n  netlink_unicast_kernel net/netlink/af_netlink.c:1331 [inline]\n  netlink_unicast+0xf52/0x1260 net/netlink/af_netlink.c:1357\n  netlink_sendmsg+0x10da/0x11e0 net/netlink/af_netlink.c:1901\n  sock_sendmsg_nosec net/socket.c:730 [inline]\n  __sock_sendmsg+0x30f/0x380 net/socket.c:745\n  ____sys_sendmsg+0x877/0xb60 net/socket.c:2597\n  ___sys_sendmsg+0x28d/0x3c0 net/socket.c:2651\n  __sys_sendmsg net/socket.c:2680 [inline]\n  __do_sys_sendmsg net/socket.c:2689 [inline]\n  __se_sys_sendmsg net/socket.c:2687 [inline]\n  __x64_sys_sendmsg+0x307/0x4a0 net/socket.c:2687\n  x64_sys_call+0x2dd6/0x3c10 arch/x86/include/generated/asm/syscalls_64.h:47\n  do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n  do_syscall_64+0xcd/0x1e0 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nLocal variable key created at:\n  tcf_ct_flow_table_get+0x4a/0x2260 net/sched/act_ct.c:324\n  tcf_ct_init+0xa67/0x2890 net/sched/act_ct.c:1408"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: sched: act_ct: cuida el relleno en struct zonas_ht_key El commit culpada aument\u00f3 el tama\u00f1o de la clave de b\u00fasqueda de 2 bytes a 16 bytes, porque zonas_ht_key obtuvo un puntero de red de estructura. Aseg\u00farese de que rhashtable_lookup() no est\u00e9 utilizando los bytes de relleno que no est\u00e1n inicializados. ERROR: KMSAN: valor uninit en rht_ptr_rcu include/linux/rhashtable.h:376 [en l\u00ednea] ERROR: KMSAN: valor uninit en __rhashtable_lookup include/linux/rhashtable.h:607 [en l\u00ednea] ERROR: KMSAN: valor uninit en rhashtable_lookup include/linux/rhashtable.h:646 [en l\u00ednea] ERROR: KMSAN: valor uninit en rhashtable_lookup_fast include/linux/rhashtable.h:672 [en l\u00ednea] ERROR: KMSAN: valor uninit en tcf_ct_flow_table_get+0x611/0x2260 net/sched /act_ct.c:329 rht_ptr_rcu include/linux/rhashtable.h:376 [en l\u00ednea] __rhashtable_lookup include/linux/rhashtable.h:607 [en l\u00ednea] rhashtable_lookup include/linux/rhashtable.h:646 [en l\u00ednea] rhashtable_lookup_fast include/linux/ rhashtable.h:672 [en l\u00ednea] tcf_ct_flow_table_get+0x611/0x2260 net/sched/act_ct.c:329 tcf_ct_init+0xa67/0x2890 net/sched/act_ct.c:1408 tcf_action_init_1+0x6cc/0xb30 net/sched/act_api.c:1425 tcf_action_init+0x458/0xf00 net/sched/act_api.c:1488 tcf_action_add net/sched/act_api.c:2061 [en l\u00ednea] tc_ctl_action+0x4be/0x19d0 net/sched/act_api.c:2118 rtnetlink_rcv_msg+0x12fc/0x1410 net /n\u00facleo/ rtnetlink.c:6647 netlink_rcv_skb+0x375/0x650 net/netlink/af_netlink.c:2550 rtnetlink_rcv+0x34/0x40 net/core/rtnetlink.c:6665 netlink_unicast_kernel net/netlink/af_netlink.c:1331 [en l\u00ednea] netlink_unicast+0xf52/ 0x1260 net/netlink/af_netlink.c:1357 netlink_sendmsg+0x10da/0x11e0 net/netlink/af_netlink.c:1901 sock_sendmsg_nosec net/socket.c:730 [en l\u00ednea] __sock_sendmsg+0x30f/0x380 net/socket.c:745 ____sys_s mensaje final+0x877 /0xb60 net/socket.c:2597 ___sys_sendmsg+0x28d/0x3c0 net/socket.c:2651 __sys_sendmsg net/socket.c:2680 [en l\u00ednea] __do_sys_sendmsg net/socket.c:2689 [en l\u00ednea] __se_sys_sendmsg net/socket. c: 2687 [en l\u00ednea] __x64_sys_sendmsg+0x307/0x4a0 net/socket.c:2687 x64_sys_call+0x2dd6/0x3c10 arch/x86/include/generated/asm/syscalls_64.h:47 do_syscall_x64 arch/x86/entry/common.c:52 [en l\u00ednea ] do_syscall_64+0xcd/0x1e0 arch/x86/entry/common.c:83 Entry_SYSCALL_64_after_hwframe+0x77/0x7f Clave de variable local creada en: tcf_ct_flow_table_get+0x4a/0x2260 net/sched/act_ct.c:324 tcf_ct_init+0xa67/0x2890 net /programado /act_ct.c:1408"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/2191a54f63225b548fd8346be3611c3219a24738", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/3a5b68869dbe14f1157c6a24ac71923db060eeab", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/3ddefcb8f75e312535e2e7d5fef9932019ba60f2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/7c03ab555eb1ba26c77fd7c25bdf44a0ac23edee", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d06daf0ad645d9225a3ff6958dd82e1f3988fa64", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d7cc186d0973afce0e1237c37f7512c01981fb79", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA1519", "comment": "Additionally, this vulnerability could be exploited by T1598: Network Sniffing: The vulnerability could be used by an attacker to sniff network packets and gather information about the network."}, {"techniqueID": "TA1530", "comment": "This vulnerability could also be exploited by T1530: Unvalidated Redirects and Forwards: An attacker could use this vulnerability to redirect users to malicious websites."}, {"techniqueID": "TA1535", "comment": "Furthermore, this vulnerability could be exploited by T1535: Cross-Site Scripting: An attacker could use this vulnerability to inject malicious scripts into the application."}, {"techniqueID": "TA1541", "comment": "Additionally, this vulnerability could be exploited by T1541: Server-Side Request Forgery: An attacker could use this vulnerability to make requests on behalf of the server."}, {"techniqueID": "TA1547", "comment": "This vulnerability could also be exploited by T1547: Packet Capture: An attacker could use this vulnerability to capture network packets."}], "technical_analysis": {"Introduction": "", "Impact and Scope": "The CVE is a kernel-level vulnerability in the Linux kernel's scheduling functionality. It is exploited by unauthenticated attackers using a network snippet, and allows for arbitrary code execution with kernel-level privileges. The attack vector is network.", "Related MITRE ATT&CK Techniques": "Related MITRE ATT&CK techniques include TA1519, TA1530, TA1535, TA1541, and TA1547.", "Technical Details": "The vulnerability is caused by an integer overflow in the Linux kernel's scheduling functionality, which allows for arbitrary code execution. It is triggered by a network packet with a specific packet size.", "Detection": "Detection of this vulnerability involves monitoring for unusual network activity and system resources. Monitoring for unusual system calls, file access, and changes to system configuration is recommended.", "Mitigation": "Mitigation strategies include disabling unnecessary network services, restricting network access, and implementing kernel hardening techniques. Regular system updates and patching are also recommended.", "Conclusion": "In summary, this vulnerability is a critical one that can have significant impact on the stability and security of a Linux-based system. It is essential to prioritize patching and mitigation efforts to prevent exploitation."}, "executive_analysis": {"Overview": "This vulnerability is a high-severity kernel-level vulnerability in the Linux kernel's scheduling functionality that allows for arbitrary code execution with kernel-level privileges.", "Business Impact": "The business impact of this vulnerability is significant, as it can affect the stability and security of Linux-based systems, which are widely used in enterprise environments.", "Technical Impact": "The technical impact of this vulnerability is that it can be exploited by unauthenticated attackers using a network snippet, allowing for arbitrary code execution with kernel-level privileges.", "Mitigation Strategies": "Mitigation strategies include disabling unnecessary network services, restricting network access, and implementing kernel hardening techniques.", "Recommendations": "Recommendations for executives include prioritizing patching and mitigation efforts, implementing kernel hardening techniques, and restrictive network access controls.", "Conclusions": "In conclusion, this vulnerability is a critical one that requires immediate attention and action. It is essential to prioritize patching and mitigation efforts to prevent exploitation."}}