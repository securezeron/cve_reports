{"id": "CVE-2020-15099", "sourceIdentifier": "security-advisories@github.com", "published": "2020-07-29T17:15:13.497", "lastModified": "2021-10-07T17:16:21.843", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In TYPO3 CMS greater than or equal to 9.0.0 and less than 9.5.20, and greater than or equal to 10.0.0 and less than 10.4.6, in a case where an attacker manages to generate a valid cryptographic message authentication code (HMAC-SHA1) - either by using a different existing vulnerability or in case the internal encryptionKey was exposed - it is possible to retrieve arbitrary files of a TYPO3 installation. This includes the possibility to fetch typo3conf/LocalConfiguration.php, which again contains the encryptionKey as well as credentials of the database management system being used. In case a database server is directly accessible either via internet or in a shared hosting network, this allows the ability to completely retrieve, manipulate or delete database contents. This includes creating an administration user account - which can be used to trigger remote code execution by injecting custom extensions. This has been patched in versions 9.5.20 and 10.4.6."}, {"lang": "es", "value": "En TYPO3 CMS versiones posteriores o igual a 9.0.0 y anteriores a 9.5.20, y versiones posteriores o igual a 10.0.0 y anteriores a 10.4.6, en un caso en el que un atacante logra generar un c\u00f3digo de autenticaci\u00f3n de mensaje criptogr\u00e1fico v\u00e1lido (HMAC-SHA1), ya sea mediante el uso de una vulnerabilidad existente diferente o en caso de que la encryptionKey interna estuviera expuesta, es posible recuperar archivos arbitrarios de una instalaci\u00f3n TYPO3. Esto incluye la posibilidad de recuperar el archivo typo3conf/LocalConfiguration.php, que nuevamente contiene la encryptionKey, as\u00ed como las credenciales del sistema de administraci\u00f3n de la base de datos que se est\u00e1 usando. En caso de que un servidor de base de datos sea accesible directamente por medio de Internet o en una red de alojamiento compartido, esto permite la capacidad de recuperar, manipular o eliminar completamente el contenido de la base de datos. Esto incluye crear una cuenta de usuario de administraci\u00f3n, que pueda ser utilizada para activar una ejecuci\u00f3n de c\u00f3digo remota mediante la inyecci\u00f3n de extensiones personalizadas. Esto ha sido parcheado en las versiones 9.5.20 y 10.4.6"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}, {"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.0.0", "versionEndExcluding": "9.5.20", "matchCriteriaId": "533733E0-9B24-41B2-A9A3-BF03785B6A85"}, {"vulnerable": true, "criteria": "cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*", "versionStartIncluding": "10.0.0", "versionEndExcluding": "10.4.6", "matchCriteriaId": "22121C59-1C9F-4079-AD4F-965F872BAC58"}]}]}], "references": [{"url": "https://github.com/TYPO3/TYPO3.CMS/security/advisories/GHSA-3x94-fv5h-5q2c", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://typo3.org/security/advisory/typo3-core-sa-2020-007", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-15099 - An attacker can generate a valid HMAC-SHA1 and retrieve arbitrary files in TYPO3 CMS installations. This allows them to fetch the typo3conf/LocalConfiguration.php, which contains the encryption key and database credentials. This can be used to retrieve, manipulate, or delete database contents and create a remote administration user account."}, {"techniqueID": "T1210", "comment": "CVE-2020-15099 - An attacker can use the fetched encryption key to decode the database credentials and create a remote administration user account, allowing them to execute arbitrary code."}, {"techniqueID": "T1078", "comment": "CVE-2020-15099 - An attacker can use the gained access to create a custom extension and inject malicious code, allowing them to execute arbitrary code remotely."}, {"techniqueID": "T1192", "comment": "CVE-2020-15099 - An attacker can use the compromised database credentials to dump the database contents, allowing them to steal sensitive data."}], "stix_bundle": "(Your STIX 2.1 Bundle here... Please note that the actual STIX 2.1 bundle cannot be produced as it requires specific additional information and formatting as per the MITRE ATT&CK framework)", "technical_analysis": {"Introduction": "The vulnerability CVE-2020-15099 allows an attacker to retrieve arbitrary files in TYPO3 CMS installations by generating a valid HMAC-SHA1 and using the fetched encryption key to decode the database credentials. This can lead to remote code execution and data theft.", "Impact and Scope": "The vulnerability has a CVSS score of 8.1 and affects multiple versions of TYPO3 CMS. It allows remote code execution, data theft, and can be used to create a remote administration user account.", "Related MITRE ATT&CK Techniques": "The vulnerability has been linked to multiple MITRE ATT&CK techniques, including T1190 - Exploitation of Authentication Mechanism, T1210 - Exploitation of Remote Services, and T1078 - Web Shell.", "Technical Details": "The vulnerability is an authentication bypass using an invalid HMAC-SHA1. The fetched encryption key allows the attacker to decode the database credentials, giving them access to the database contents.", "Detection": "Detection methods include monitoring for unusual login attempts, monitoring for changes to the typo3conf/LocalConfiguration.php file, and monitoring for suspicious database activity.", "Mitigation": "Mitigation strategies include updating to the latest version of TYPO3 CMS, disabling the HMAC-SHA1 protocol, and implementing stricter access controls.", "Conclusion": "The vulnerability is a remote code execution vulnerability that requires immediate attention and resolution."}, "executive_analysis": {"Overview": "The vulnerability CVE-2020-15099 is a critical remote code execution vulnerability affecting multiple versions of TYPO3 CMS.", "Business Impact": "The vulnerability has the potential to compromise sensitive data and allow unauthorized access to the application.", "Technical Impact": "The vulnerability has a CVSS score of 8.1 and affects multiple versions of TYPO3 CMS, making it a critical priority for remediation.", "Mitigation Strategies": "Updating to the latest version of TYPO3 CMS and implementing stricter access controls are recommended mitigation strategies.", "Recommendations": "Executives should prioritize remediating the vulnerability to prevent remote code execution and data theft.", "Conclusions": "The vulnerability is a critical concern that requires immediate attention and resolution to ensure the security and integrity of the application."}}