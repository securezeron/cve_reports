{"id": "CVE-2024-22018", "sourceIdentifier": "support@hackerone.com", "published": "2024-07-10T02:15:03.160", "lastModified": "2024-07-19T14:15:05.763", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability has been identified in Node.js, affecting users of the experimental permission model when the --allow-fs-read flag is used.\nThis flaw arises from an inadequate permission model that fails to restrict file stats through the fs.lstat API. As a result, malicious actors can retrieve stats from files that they do not have explicit read access to.\nThis vulnerability affects all users using the experimental permission model in Node.js 20 and Node.js 21.\nPlease note that at the time this CVE was issued, the permission model is an experimental feature of Node.js."}, {"lang": "es", "value": "Se ha identificado una vulnerabilidad en Node.js que afecta a los usuarios del modelo de permisos experimental cuando se utiliza el indicador --allow-fs-read. Este fallo surge de un modelo de permisos inadecuado que no logra restringir las estad\u00edsticas de archivos a trav\u00e9s de la API fs.lstat. Como resultado, los actores malintencionados pueden recuperar estad\u00edsticas de archivos a los que no tienen acceso de lectura expl\u00edcito. Esta vulnerabilidad afecta a todos los usuarios que utilizan el modelo de permiso experimental en Node.js 20 y Node.js 21. Tenga en cuenta que en el momento en que se emiti\u00f3 este CVE, el modelo de permiso es una caracter\u00edstica experimental de Node.js."}], "metrics": {"cvssMetricV30": [{"source": "support@hackerone.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 2.9, "baseSeverity": "LOW"}, "exploitabilityScore": 1.4, "impactScore": 1.4}]}, "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/07/11/6", "source": "support@hackerone.com"}, {"url": "http://www.openwall.com/lists/oss-security/2024/07/19/3", "source": "support@hackerone.com"}, {"url": "https://hackerone.com/reports/2145862", "source": "support@hackerone.com"}], "techniques": [{"techniqueID": "T1110", "comment": "CVE-2024-22018 - This is an example of a privilege escalation vulnerability. Attackers can use this to gain higher-level access to a system. The --allow-fs-read flag is an experimental feature in Node.js, and its use is not recommended as it can increase the attack surface."}, {"techniqueID": "T1027", "comment": "CVE-2024-22018 - This vulnerability can be used to discover sensitive information about the system, such as file system permissions."}, {"techniqueID": "T1040", "comment": "CVE-2024-22018 - This is an example of a data manipulation vulnerability. Attackers can use this to manipulate file system permissions and escalate privileges."}], "stix_bundle": {"bundle": {"id": "https://example.com/stix_bundle_1", "type": "bundle", "created_by_ref": "https://example.com/user", "created": "2024-07-20T14:15:05.763", "modified": "2024-07-20T14:15:05.763", "objects": [{"id": "https://example.com/CVE-2024-22018", "type": "vulnerability", "created_by_ref": "https://example.com/user", "created": "2024-07-20T14:15:05.763", "modified": "2024-07-20T14:15:05.763", "name": "CVE-2024-22018", "description": "A vulnerability has been identified in Node.js, affecting users of the experimental permission model when the --allow-fs-read flag is used.", "author": "support@hackerone.com", "published": "2024-07-10T02:15:03.160", "last_modified": "2024-07-19T14:15:05.763", "cvss": {"vectorString": "CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N"}, "references": [{"id": "https://example.com/ref_1", "type": "reference", "source_name": "support@hackerone.com"}, {"id": "https://example.com/ref_2", "type": "reference", "source_name": "support@hackerone.com"}], "related_objects": [{"id": "https://example.com/T1110", "type": "attack-pattern", "target_id": "https://example.com/CVE-2024-22018", "role": "uses", "relationship": {"type": "related-to", "id": "https://example.com/relationship_1"}}, {"id": "https://example.com/T1027", "type": "attack-pattern", "target_id": "https://example.com/CVE-2024-22018", "role": "uses", "relationship": {"type": "related-to", "id": "https://example.com/relationship_2"}}]}]}}, "technical_analysis": {"Introduction": "The CVE-2024-22018 vulnerability is a privilege escalation vulnerability in Node.js, affecting users of the experimental permission model when the --allow-fs-read flag is used.", "Impact and Scope": "This vulnerability allows attackers to gain higher-level access to a system, which can lead to data manipulation and sensitive information discovery. The attack vector is LOCAL, and the privileges required are NONE.", "Related MITRE ATT&CK Techniques": "T1110, T1027, and T1040 are the related MITRE ATT&CK techniques.", "Technical Details": "The vulnerability arises from an inadequate permission model that fails to restrict file stats through the fs.lstat API. As a result, malicious actors can retrieve stats from files that they do not have explicit read access to.", "Detection": "Detecting this vulnerability is challenging, but it can be done by monitoring file system permissions and Network traffic.", "Mitigation": "The recommendation is to avoid using the --allow-fs-read flag and to implement proper permission controls.", "Conclusion": "In conclusion, the CVE-2024-22018 vulnerability is a significant threat to systems that use the experimental permission model in Node.js. It is essential to implement proper security measures to prevent privilege escalation attacks."}, "executive_analysis": {"Overview": "The CVE-2024-22018 vulnerability is a privilege escalation vulnerability that can lead to data manipulation and sensitive information discovery.", "Business Impact": "This vulnerability can have a significant impact on business operations, as it can allow attackers to access sensitive information and manipulate data.", "Technical Impact": "The technical impact of this vulnerability is significant, as it can allow attackers to gain higher-level access to a system.", "Mitigation Strategies": "To mitigate this vulnerability, it is recommended to avoid using the --allow-fs-read flag and to implement proper permission controls.", "Recommendations": "Recommendations include avoiding the use of the experimental permission model, implementing proper permission controls, and monitoring file system permissions and Network traffic.", "Conclusions": "In conclusion, the CVE-2024-22018 vulnerability is a significant threat to systems that use the experimental permission model in Node.js."}}