{"id": "CVE-2024-6229", "sourceIdentifier": "security@huntr.dev", "published": "2024-07-07T16:15:02.013", "lastModified": "2024-07-11T15:03:15.233", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A stored cross-site scripting (XSS) vulnerability exists in the 'Upload Knowledge' feature of stangirard/quivr, affecting the latest version. Users can upload files via URL, which allows the insertion of malicious JavaScript payloads. These payloads are stored on the server and executed whenever any user clicks on a link containing the payload, leading to potential data theft, session hijacking, and reputation damage."}, {"lang": "es", "value": " Existe una vulnerabilidad de Cross Site Scripting (XSS) almacenado en la funci\u00f3n 'Upload Knowledge' de stangirard/quivr, que afecta a la \u00faltima versi\u00f3n. Los usuarios pueden cargar archivos a trav\u00e9s de URL, lo que permite la inserci\u00f3n de payloads de JavaScript maliciosos. Estos payloads se almacenan en el servidor y se ejecutan cada vez que un usuario hace clic en un enlace que contiene el payload, lo que genera un posible robo de datos, secuestro de sesiones y da\u00f1os a la reputaci\u00f3n."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 4.0}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:quivr:quivr:*:*:*:*:*:*:*:*", "versionEndIncluding": "0.0.281", "matchCriteriaId": "722DE352-4E03-4519-BDB9-2DC6C56D4A83"}]}]}], "references": [{"url": "https://huntr.com/bounties/2ee71e9e-2cf5-41a4-8440-d75758018786", "source": "security@huntr.dev", "tags": ["Exploit"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-6229 - Stored XSS allows an attacker to inject malicious JavaScript payloads, potentially leading to data theft, session hijacking, and reputation damage."}, {"techniqueID": "T1190", "comment": "CVE-2024-6229 - Saved malicious payloads allow for persistence and evasion, making it a challenging vulnerability to address."}, {"techniqueID": "T1077", "comment": "CVE-2024-6229 - Users can upload files with malicious JavaScript, potentially leading to a cross-site scripting attack."}, {"techniqueID": "T1562", "comment": "CVE-2024-6229 - Stored XSS can be used to conduct spear phishing attacks, making it a high-risk vulnerability to address."}, {"techniqueID": "T1192", "comment": "CVE-2024-6229 - The use of URL-based uploads allows for a higher likelihood of attacks, making it essential to Implement defense-in-depth strategies."}], "stix_bundle": "https://pastebin.com/raw/PzL4n2HV", "technical_analysis": {"Introduction": "CVE-2024-6229 is a stored cross-site scripting (XSS) vulnerability in the 'Upload Knowledge' feature of stangirard/quivr, which allows attackers to inject malicious JavaScript payloads.", "Impact and Scope": "The vulnerability has a CVSS score of 5.4 (MEDIUM) and an attack vector of NETWORK. It allows attackers to inject malicious JavaScript payloads, potentially leading to data theft, session hijacking, and reputation damage.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1059, T1190, T1077, T1562, and T1192.", "Technical Details": "The vulnerability occurs due to insufficient sanitization of user-uploaded files, allowing attackers to inject malicious JavaScript code.", "Detection": "Detection can be achieved by analyzing network traffic and identifying potential URL-based uploads.", "Migation": "Mitigation strategies include implementing a secure upload process, validating user input, and monitoring network traffic for suspicious activity.", "Conclusion": "CVE-2024-6229 is a high-risk vulnerability that requires immediate attention and action to mitigate its effects."}, "executive_analysis": {"Overview": "CVE-2024-6229 is a stored cross-site scripting (XSS) vulnerability in the 'Upload Knowledge' feature of stangirard/quivr, which allows attackers to inject malicious JavaScript payloads.", "Business Impact": "The vulnerability has the potential to result in significant financial losses, reputational damage, and legal consequences.", "Technical Impact": "The vulnerability allows attackers to inject malicious JavaScript payloads, potentially leading to data theft, session hijacking, and reputation damage.", "Mitigation Strategies": "Implementing a secure upload process, validating user input, and monitoring network traffic for suspicious activity are essential mitigation strategies.", "Recommendations": "Recommendations include implementing a secure upload process, validating user input, and monitoring network traffic for suspicious activity.", "Conclusions": "Immediate action is required to mitigate the effects of CVE-2024-6229 and ensure the security of the 'Upload Knowledge' feature."}}