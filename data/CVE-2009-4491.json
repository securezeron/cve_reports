{"id": "CVE-2009-4491", "sourceIdentifier": "cve@mitre.org", "published": "2010-01-13T20:30:00.500", "lastModified": "2024-07-12T16:11:02.653", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "thttpd 2.25b0 writes data to a log file without sanitizing non-printable characters, which might allow remote attackers to modify a window's title, or possibly execute arbitrary commands or overwrite files, via an HTTP request containing an escape sequence for a terminal emulator."}, {"lang": "es", "value": "thttpd v2.25b0, escribe datos en un archivo de los sin depurar los caracteres no escribibles, lo que podr\u00eda permitir a atacantes remotos modificar la ventana de t\u00edtulo, o posiblemente ejecutar comandos de su elecci\u00f3n o sobrescribir archivos, a trav\u00e9s de una petici\u00f3n HTTP que contiene una secuencia de escape para el emulador de terminal."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:acme:thttpd:2.25:b:*:*:*:*:*:*", "matchCriteriaId": "E8437876-9C0D-4621-BB0F-2449B706C640"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/175949/m-privacy-TightGate-Pro-Code-Execution-Insecure-Permissions.html", "source": "cve@mitre.org"}, {"url": "http://seclists.org/fulldisclosure/2023/Nov/13", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/508830/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.ush.it/team/ush/hack_httpd_escape/adv.txt", "source": "cve@mitre.org", "tags": ["Exploit"]}], "techniques": [{"techniqueID": "T1046", "comment": "CVE-2009-4491 - This vulnerability allows attackers to execute arbitrary commands by injecting escape sequences in the request. This can be mitigated by sanitizing non-printable characters in the log file."}, {"techniqueID": "T1027", "comment": "CVE-2009-4491 - The vulnerability also allows attackers to modify the window's title, which can aid in reconnaissance or spearphishing attempts. This can be mitigated by ensuring the title is sanitized and does not reveal sensitive information."}, {"techniqueID": "T1190", "comment": "CVE-2009-4491 - The vulnerability can be exploited remotely, making it a high-priority vulnerability for organizations with remote access to the affected systems. This can be mitigated by patching the vulnerable system or restricting remote access to authorized personnel."}], "stix_bundle": {"bundle": {"description": "Thhppd HTTP Vulnerability", "created_by_ref": "http://example.com", "modified": "2024-07-12T16:11:02.653", "objects": [{"Object": {"type": "vulnerability", "id": "CVE-2009-4491", "description": "thttpd 2.25b0 writes data to a log file without sanitizing non-printable characters, which might allow remote attackers to modify a window's title, or possibly execute arbitrary commands or overwrite files, via an HTTP request containing an escape sequence for a terminal emulator.", "created_by_ref": "http://example.com", "modified": "2024-07-12T16:11:02.653"}}, {"Object": {"type": "network-traffic", "id": "indicator-1", "title": "HTTP Request with Escape Sequence", "description": "A HTTP request containing an escape sequence for a terminal emulator.", "pattern": "http://.*\\x0d\\x09.*"}}, {"Object": {"type": "window-title", "id": "indicator-2", "title": "Modified Window Title", "description": "A window title that has been modified through an HTTP request.", "pattern": ".*Modified by .*"}}, {"Object": {"type": "course-of-action", "id": "coa-1", "title": "Sanitize Non-Printable Characters", "description": "Sanitize non-printable characters in the log file to prevent exploitation.", "effective_date": "2024-07-12T16:11:02.653"}}, {"Object": {"type": "course-of-action", "id": "coa-2", "title": "Restrict Remote Access", "description": "Restrict remote access to authorized personnel to prevent exploitation.", "effective_date": "2024-07-12T16:11:02.653"}}], "relationships": [{"relationship": {"type": "is-related-to", "id": "rel-1", "source_ref": "CVE-2009-4491", "target_ref": "indicator-1"}}, {"relationship": {"type": "is-related-to", "id": "rel-2", "source_ref": "CVE-2009-4491", "target_ref": "indicator-2"}}, {"relationship": {"type": "is-related-to", "id": "rel-3", "source_ref": "coa-1", "target_ref": "CVE-2009-4491"}}, {"relationship": {"type": "is-related-to", "id": "rel-4", "source_ref": "coa-2", "target_ref": "CVE-2009-4491"}}]}}, "technical_analysis": {"Introduction": "thttpd 2.25b0 is vulnerable to a command injection vulnerability due to the lack of sanitization of non-printable characters in the log file.", "Impact and Scope": "The vulnerability allows remote attackers to execute arbitrary commands, modify the window's title, or overwrite files.", "Related MITRE ATT&CK Techniques": "T1046, T1027, T1190", "Technical Details": "The vulnerability occurs when an HTTP request contains an escape sequence for a terminal emulator, which allows attackers to execute arbitrary commands.", "Detection": "Detect the vulnerability by monitoring the log file for non-printable characters and analyzing the HTTP request for escape sequences.", "Mitigation": "Mitigate the vulnerability by sanitizing non-printable characters in the log file and restricting remote access to authorized personnel.", "Conclusion": "The vulnerability is critical and requires immediate attention to prevent exploitation."}, "executive_analysis": {"Overview": "thttpd 2.25b0 is vulnerable to a command injection vulnerability that allows remote attackers to execute arbitrary commands, modify the window's title, or overwrite files.", "Business Impact": "The vulnerability poses a significant risk to the organization's data and operations, and failure to patch or restrict access could result in financial losses, data breaches, or reputational damage.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary commands, which could lead to further exploitation of the system, data breaches, or other security incidents.", "Mitigation Strategies": "The organization should implement a patch management program to ensure timely patching of the vulnerable system, restrict remote access to authorized personnel, and monitor the log file for suspicious activity.", "Recommendations": "Executives should prioritize the patching and mitigation of the vulnerability to protect the organization's data and operations.", "Conclusions": "The vulnerability is critical and requires immediate attention to prevent exploitation."}}