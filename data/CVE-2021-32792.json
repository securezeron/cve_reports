{
    "id": "CVE-2021-32792",
    "sourceIdentifier": "security-advisories@github.com",
    "published": "2021-07-26T17:15:08.280",
    "lastModified": "2024-11-21T06:07:45.070",
    "vulnStatus": "Modified",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "mod_auth_openidc is an authentication/authorization module for the Apache 2.x HTTP server that functions as an OpenID Connect Relying Party, authenticating users against an OpenID Connect Provider. In mod_auth_openidc before version 2.4.9, there is an XSS vulnerability in when using `OIDCPreservePost On`."
        },
        {
            "lang": "es",
            "value": "mod_auth_openidc es un m\u00f3dulo de autenticaci\u00f3n/autorizaci\u00f3n para el servidor HTTP Apache versi\u00f3n 2.x que funciona como OpenID Connect Relying Party, autenticando a usuarios contra un proveedor de OpenID Connect. En mod_auth_openidc versiones anteriores a 2.4.9, se presenta una vulnerabilidad de tipo XSS cuando se usa el par\u00e1metro \"OIDCPreservePost On\""
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "security-advisories@github.com",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N",
                    "baseScore": 3.1,
                    "baseSeverity": "LOW",
                    "attackVector": "NETWORK",
                    "attackComplexity": "HIGH",
                    "privilegesRequired": "NONE",
                    "userInteraction": "REQUIRED",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "LOW",
                    "integrityImpact": "NONE",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 1.6,
                "impactScore": 1.4
            },
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
                    "baseScore": 6.1,
                    "baseSeverity": "MEDIUM",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "REQUIRED",
                    "scope": "CHANGED",
                    "confidentialityImpact": "LOW",
                    "integrityImpact": "LOW",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 2.8,
                "impactScore": 2.7
            }
        ],
        "cvssMetricV2": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "2.0",
                    "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
                    "baseScore": 4.3,
                    "accessVector": "NETWORK",
                    "accessComplexity": "MEDIUM",
                    "authentication": "NONE",
                    "confidentialityImpact": "NONE",
                    "integrityImpact": "PARTIAL",
                    "availabilityImpact": "NONE"
                },
                "baseSeverity": "MEDIUM",
                "exploitabilityScore": 8.6,
                "impactScore": 2.9,
                "acInsufInfo": false,
                "obtainAllPrivilege": false,
                "obtainUserPrivilege": false,
                "obtainOtherPrivilege": false,
                "userInteractionRequired": true
            }
        ]
    },
    "weaknesses": [
        {
            "source": "security-advisories@github.com",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-79"
                }
            ]
        },
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-79"
                }
            ]
        }
    ],
    "configurations": [
        {
            "operator": "AND",
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:openidc:mod_auth_openidc:*:*:*:*:*:*:*:*",
                            "versionEndExcluding": "2.4.9",
                            "matchCriteriaId": "FAEFDBA2-55AD-410B-95C4-D2524C65B4A8"
                        }
                    ]
                },
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": false,
                            "criteria": "cpe:2.3:a:apache:http_server:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "2.0.0",
                            "versionEndIncluding": "2.4.48",
                            "matchCriteriaId": "BC9C65B5-0989-4D64-9BED-1E391AD971AE"
                        }
                    ]
                }
            ]
        },
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*",
                            "matchCriteriaId": "E460AA51-FCDA-46B9-AE97-E6676AA5E194"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*",
                            "matchCriteriaId": "A930E247-0B43-43CB-98FF-6CE7B8189835"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/commit/00c315cb0c8ab77c67be4a2ac08a71a83ac58751",
            "source": "security-advisories@github.com",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/commit/55ea0a085290cd2c8cdfdd960a230cbc38ba8b56",
            "source": "security-advisories@github.com",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/releases/tag/v2.4.9",
            "source": "security-advisories@github.com",
            "tags": [
                "Release Notes",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/security/advisories/GHSA-458c-7pwg-3j7j",
            "source": "security-advisories@github.com",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://lists.debian.org/debian-lts-announce/2023/04/msg00034.html",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FZVF6BSJLRQZ7PFFR4X5JSU6KUJYNOCU/",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QXAWKPT5LXZSUTFSJ6IWSZC7RMYYQXQD/",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
            "source": "security-advisories@github.com",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/commit/00c315cb0c8ab77c67be4a2ac08a71a83ac58751",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/commit/55ea0a085290cd2c8cdfdd960a230cbc38ba8b56",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/releases/tag/v2.4.9",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Release Notes",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/security/advisories/GHSA-458c-7pwg-3j7j",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://lists.debian.org/debian-lts-announce/2023/04/msg00034.html",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FZVF6BSJLRQZ7PFFR4X5JSU6KUJYNOCU/",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QXAWKPT5LXZSUTFSJ6IWSZC7RMYYQXQD/",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        }
    ],
    "techniques": [
        {
            "techniqueID": "T1059.007",
            "comment": "mod_auth_openidc before version 2.4.9 allows an attacker to inject arbitrary JavaScript code by using the 'OIDCPreservePost On' parameter, leading to cross-site scripting (XSS) attacks. This can be achieved by manipulating the configuration file to include a payload."
        },
        {
            "techniqueID": "T1508.002",
            "comment": "An attacker can inject arbitrary JavaScript code by using the 'OIDCPreservePost On' parameter, leading to cross-site scripting (XSS) attacks."
        },
        {
            "techniqueID": "T1190",
            "comment": "The vulnerability can be exploited by sending a specially crafted request to the Apache server, potentially leading to the execution of arbitrary JavaScript code."
        },
        {
            "techniqueID": "T1191",
            "comment": "The attacker can manipulate the 'OIDCPreservePost On' parameter to inject arbitrary JavaScript code, potentially leading to the execution of arbitrary system commands."
        }
    ],
    "technical_analysis": {
        "Introduction": "mod_auth_openidc is an authentication module for Apache 2.x HTTP server that functions as an OpenID Connect Relying Party. A vulnerability in mod_auth_openidc before version 2.4.9 allows an attacker to inject arbitrary JavaScript code through the 'OIDCPreservePost On' parameter.",
        "Impact and Scope": "The vulnerability affects mod_auth_openidc before version 2.4.9 and has a CVSS score of 3.1. It is an XSS vulnerability that can be exploited by manipulating the configuration file.",
        "Related MITRE ATT&CK Techniques": "T1059.007, T1508.002, T1190, T1191",
        "Technical Details": "The vulnerability is caused by the lack of input validation for the 'OIDCPreservePost On' parameter in mod_auth_openidc. An attacker can inject arbitrary JavaScript code by manipulating this parameter.",
        "Detection": "The vulnerability can be detected by monitoring for suspicious requests to the Apache server, such as requests containing unusual JavaScript code.",
        "Mitigation": "Update mod_auth_openidc to version 2.4.9 or later, disable the 'OIDCPreservePost On' parameter, and implement input validation for the 'OIDCPreservePost On' parameter.",
        "Conclusion": "The mod_auth_openidc XSS vulnerability can be exploited by attackers to inject arbitrary JavaScript code, potentially leading to the execution of arbitrary system commands. It is essential to update mod_auth_openidc and implement proper input validation."
    },
    "executive_analysis": {
        "Overview": "mod_auth_openidc before version 2.4.9 contains a cross-site scripting (XSS) vulnerability that can be exploited by attackers.",
        "Business Impact": "The vulnerability can be used to inject arbitrary JavaScript code, potentially leading to the execution of arbitrary system commands, which can compromise the security and integrity of the organization.",
        "Technical Impact": "The vulnerability allows an attacker to inject arbitrary JavaScript code, potentially leading to the execution of arbitrary system commands.",
        "Mitigation Strategies": "Update mod_auth_openidc, disable the 'OIDCPreservePost On' parameter, and implement input validation for the 'OIDCPreservePost On' parameter.",
        "Recommendations": "Contact the Apache security team to confirm the presence of the vulnerability and request an update. Implement input validation for the 'OIDCPreservePost On' parameter and disable the parameter if not necessary.",
        "Conclusions": "The mod_auth_openidc XSS vulnerability poses a significant risk to the organization and requires immediate attention to prevent attacks."
    }
}