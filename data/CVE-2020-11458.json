{"id": "CVE-2020-11458", "sourceIdentifier": "cve@mitre.org", "published": "2020-04-02T12:15:15.870", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "app/Model/feed.php in MISP before 2.4.124 allows administrators to choose arbitrary files that should be ingested by MISP. This does not cause a leak of the full contents of a file, but does cause a leaks of strings that match certain patterns. Among the data that can leak are passwords from database.php or GPG key passphrases from config.php."}, {"lang": "es", "value": "El archivo app/Model/feed.php en MISP versiones anteriores a  2.4.124,  permite a administradores elegir archivos arbitrarios que deber\u00edan ser consumidos por MISP. Esto no causa una filtraci\u00f3n de todo el contenido de un archivo, pero s\u00ed una filtraci\u00f3n de cadenas que coinciden con determinados patrones. Entre los datos que pueden filtrarse se encuentran las contrase\u00f1as desde el archivo database.php o las frases de clave GPG desde el archivo config.php."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:misp:misp:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.4.124", "matchCriteriaId": "F514A7E1-4EBA-44ED-B548-C787D4EADC0B"}]}]}], "references": [{"url": "https://github.com/MISP/MISP/commit/30ff4b6451549dae7b526d4fb3a49061311ed477", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://matthias.sdfeu.org/misp-poc.py", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2020-11458 - Path manipulation allows an attacker to access arbitrary files, which can be used to extract sensitive data. This technique is relevant to defenders who may need to monitor for suspicious files being accessed or modified."}, {"techniqueID": "T1027", "comment": "CVE-2020-11458 - Discovery of sensitive information through improper error handling. Defenders can use this technique to monitor for sensitive information being leaked and take proactive measures to prevent it."}, {"techniqueID": "T1190", "comment": "CVE-2020-11458 - Exfiltration of sensitive data through an open file. Defenders can use this technique to monitor for sensitive data being exfiltrated and take proactive measures to prevent it."}], "stix_bundle": "{\"bundle\":\n{\n    \"id\": \"https://example.com/stix_bundle\", \n    \"type\": \"bundle\", \n    \"created_by_ref\": \"https://example.com/user\", \n    \"created\": \"2021-08-16T14:30:00.000Z\",\n    \"modified\": \"2021-08-16T14:30:00.000Z\",\n    \"objects\": [\n        {\n            \"type\": \"vulnerability\",\n            \"id\": \"https://example.com/vulnerability\",\n            \"name\": \"MISP Feed File Path Manipulation Vulnerability\",\n            \"description\": [\"App/Model/feed.php in MISP before 2.4.124 allows administrators to choose arbitrary files that should be ingested by MISP.\", \"El archivo app/Model/feed.php en MISP versiones anteriores a  2.4.124,  permite a administradores elegir archivos arbitrarios que deber\u00edan ser consumidos por MISP.\"],\n            \"cvssV2Score\": 4.0,\n            \"cvssV3Score\": 4.9,\n            \"cvssV2Severity\": \"MEDIUM\",\n            \"cvssV3Severity\": \"MEDIUM\",\n            \"related_sinks\": [\n                {\n                    \"id\": \"https://example.com/technique\",\n                    \"type\": \"technique\",\n                    \"name\": \"Path Manipulation\",\n                    \"description\": [\"Path manipulation is a common technique used to manipulate file paths and access arbitrary files.\"],\n                    \"attack_patterns\": [\n                        {\n                            \"id\": \"https://example.com/attack_pattern\",\n                            \"type\": \"attack_pattern\",\n                            \"name\": \"Path Manipulation\",\n                            \"description\": [\"Attack pattern description.\"],\n                            \"mitigations\": \"user interaction or data validation\",\n                            \"tactics\": [\"T1210\"],\n                            \"kill_chain_phases\": [\n                                {\n                                    \"id\": \"https://example.com/kill_chain_phase\",\n                                    \"type\": \"kill_chain_phase\",\n                                    \"name\": \"Initial Access\",\n                                    \"description\": [\"Kill chain phase description.\"],\n                                    \"mitigations\": \"user interaction or data validation\"\n                                }\n                            ]\n                        }\n                    ],\n                    \" Defense_ Points\": [\"Implement file path validation\",\"Sanitize user input\"]\n                }\n            ]\n        },\n        {\n            \"type\": \"indicator\",\n            \"id\": \"https://example.com/indicator\",\n            \"name\": \"MISP Feed File Path Manipulation Indicator\",\n            \"description\": \"Indicator description.\",\n            \"pattern\": [\"indicator pattern\"],\n            \"valid_from\": \"2021-08-15T14:30:00.000Z\",\n            \"valid_until\": \"2021-08-16T14:30:00.000Z\",\n            \"related_attack_patterns\": [\n                {\n                    \"id\": \"https://example.com/attack_pattern\",\n                    \"type\": \"attack_pattern\",\n                    \"name\": \"Path Manipulation\",\n                    \"description\": [\"Attack pattern description.\"],\n                    \"mitigations\": \"user interaction or data validation\",\n                    \"tactics\": [\"T1210\"],\n                    \"kill_chain_phases\": [\n                        {\n                            \"id\": \"https://example.com/kill_chain_phase\",\n                            \"type\": \"kill_chain_phase\",\n                            \"name\": \"Initial Access\",\n                            \"description\": [\"Kill chain phase description.\"],\n                            \"mitigations\": \"user interaction or data validation\"\n                        }\n                    ]\n                }\n            ]\n        }\n    ]\n}\n}", "technical_analysis": {"Introduction": "MISP Feed File Path Manipulation Vulnerability allows attackers to access arbitrary files, which can be used to extract sensitive data.", "Impact and Scope": "The vulnerability has a CVSSv2 score of 4.0 and a CVSSv3 score of 4.9, with an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1210, T1027, and T1190.", "Technical Details": "The vulnerability occurs in the app/Model/feed.php file in MISP before 2.4.124, allowing administrators to choose arbitrary files that should be ingested by MISP.", "Detection": "Detection methods include monitoring for suspicious files being accessed or modified.", "Mitigation": "Mitigation strategies include implementing file path validation and sanitizing user input.", "Conclusion": "The MISP Feed File Path Manipulation Vulnerability is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "MISP Feed File Path Manipulation Vulnerability is a critical vulnerability that can lead to the exfiltration of sensitive data.", "Business Impact": "The vulnerability can have a significant impact on the business, including the compromise of sensitive data and the potential for financial loss.", "Technical Impact": "The vulnerability allows attackers to access arbitrary files, which can be used to extract sensitive data.", "Mitigation Strategies": "Implement file path validation, sanitize user input, and monitor for suspicious files being accessed or modified.", "Recommendations": "Users should update to the latest version of MISP, implement file path validation, and sanitize user input.", "Conclusions": "The MISP Feed File Path Manipulation Vulnerability is a critical vulnerability that requires immediate attention and mitigation, and users should take proactive steps to prevent data exfiltration."}}