{"id": "CVE-2023-5834", "sourceIdentifier": "security@hashicorp.com", "published": "2023-10-27T22:15:09.163", "lastModified": "2023-11-13T14:34:59.287", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "HashiCorp Vagrant's Windows installer targeted a custom location with a non-protected path that could be junctioned, introducing potential for unauthorized file system writes. Fixed in Vagrant 2.4.0."}, {"lang": "es", "value": "El instalador HashiCorp Vagrant de Windows apunt\u00f3 a una ubicaci\u00f3n personalizada con una ruta no protegida que pod\u00eda unirse, lo que introdujo la posibilidad de escrituras no autorizadas en el sistema de archivos. Corregido en Vagrant 2.4.0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}, {"source": "security@hashicorp.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:L/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.8, "baseSeverity": "LOW"}, "exploitabilityScore": 2.0, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-59"}]}, {"source": "security@hashicorp.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1386"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hashicorp:vagrant:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.4.0", "matchCriteriaId": "3ADD2BC9-1919-4EB9-B23C-783DE3BD08F3"}]}]}], "references": [{"url": "https://discuss.hashicorp.com/t/hcsec-2023-31-vagrant-s-windows-installer-allowed-directory-junction-write/59568", "source": "security@hashicorp.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1184", "comment": "CVE-2023-5834 - The Write What Where technique allows an attacker to write data to any location on the file system, which can be exploited to gain unauthorized access to sensitive data. This can be mitigated by implementing proper file system permissions and access controls."}, {"techniqueID": "T1197", "comment": "CVE-2023-5834 - The Directory Mismatch technique allows an attacker to create a directory with a name that matches a junction point on the file system, which can be used to write data to unexpected locations. This can be mitigated by implementing proper file system permissions and access controls."}, {"techniqueID": "T1190", "comment": "CVE-2023-5834 - The File System Corruption technique allows an attacker to corrupt files on the file system, which can be used to gain unauthorized access to sensitive data. This can be mitigated by implementing proper file system permissions and access controls."}], "stix_bundle": {"type": "bundle", "id": "CVE-2023-5834-bundle", "created_by": "Anonymous", "created": "2023-11-15T14:30:00.000Z", "modified": "2023-11-15T14:30:00.000Z", "objects": [{"type": "indicator", "id": "indicator-1", "created_by": "Anonymous", "created": "2023-11-15T14:30:00.000Z", "modified": "2023-11-15T14:30:00.000Z", "name": "Unprotected File System Junction Point", "description": "A file system junction point identified as unprotected and potentially exploitable.", "last_seen": "2023-11-15T14:30:00.000Z", "first_seen": "2023-11-15T14:30:00.000Z", "observable": "The file system junction point is not protected and is accessible to any user.", "granular_markings": [{"selectors": [{"property": "path", "value": "/path/to/junction"}], "marks": [{"type": "indicator", "value": "indicator-1"}]}]}, {"type": "course-of-action", "id": "coa-1", "created_by": "Anonymous", "created": "2023-11-15T14:30:00.000Z", "modified": "2023-11-15T14:30:00.000Z", "name": "Mitigate File System Junction Point", "description": "Modify the file system permissions to restrict access to the junction point.", "related_object": {"id": "indicator-1", "type": "indicator"}, "technique": {"id": "T1184", "type": "technique"}}], "relationships": [{"id": "relationship-1", "type": "has-course-of-action", "course_of_action": {"id": "coa-1", "type": "course-of-action"}, "vulnerability": {"id": "CVE-2023-5834", "type": "vulnerability"}}, {"id": "relationship-2", "type": "indicates", "indicator": {"id": "indicator-1", "type": "indicator"}, "vulnerability": {"id": "CVE-2023-5834", "type": "vulnerability"}}]}, "technical_analysis": {"Introduction": "The vulnerability CVE-2023-5834 affects the Windows installer of HashiCorp Vagrant, allowing an attacker to write data to any location on the file system. This can be exploited to gain unauthorized access to sensitive data.", "Impact and Scope": "The attack vector for this vulnerability is LOCAL, and the impact is HIGH, with a CVSS score of 7.8.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1184, T1197, and T1190.", "Technical Details": "The vulnerability is caused by a custom location with a non-protected path that can be junctioned, allowing an attacker to write data to unexpected locations.", "Detection": "Detection of this vulnerability can be done by monitoring for suspicious file system activity and monitoring for changes to the file system permissions.", "Mitigation": "Mitigation of this vulnerability can be done by implementing proper file system permissions and access controls, and by regularly monitoring the file system for suspicious activity.", "Conclusion": "In conclusion, CVE-2023-5834 is a serious vulnerability that can be exploited to gain unauthorized access to sensitive data. It is essential to implement proper file system permissions and access controls to mitigate this vulnerability."}, "executive_analysis": {"Overview": "CVE-2023-5834 is a vulnerability in the Windows installer of HashiCorp Vagrant that allows an attacker to write data to any location on the file system.", "Business Impact": "The business impact of this vulnerability is HIGH, as it can be exploited to gain unauthorized access to sensitive data.", "Technical Impact": "The technical impact of this vulnerability is HIGH, with a CVSS score of 7.8.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include implementing proper file system permissions and access controls, and regularly monitoring the file system for suspicious activity.", "Recommendations": "Recommendations for executives include implementing a comprehensive vulnerability management program, conducting regular security assessments, and providing regular training to employees on security best practices.", "Conclusions": "In conclusion, CVE-2023-5834 is a serious vulnerability that requires immediate attention. Implementing proper file system permissions and access controls, and regularly monitoring the file system for suspicious activity are essential to mitigate this vulnerability."}}