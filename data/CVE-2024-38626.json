{"id": "CVE-2024-38626", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-21T11:15:11.517", "lastModified": "2024-06-21T11:22:01.687", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nfuse: clear FR_SENT when re-adding requests into pending list\n\nThe following warning was reported by lee bruce:\n\n  ------------[ cut here ]------------\n  WARNING: CPU: 0 PID: 8264 at fs/fuse/dev.c:300\n  fuse_request_end+0x685/0x7e0 fs/fuse/dev.c:300\n  Modules linked in:\n  CPU: 0 PID: 8264 Comm: ab2 Not tainted 6.9.0-rc7\n  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996)\n  RIP: 0010:fuse_request_end+0x685/0x7e0 fs/fuse/dev.c:300\n  ......\n  Call Trace:\n  <TASK>\n  fuse_dev_do_read.constprop.0+0xd36/0x1dd0 fs/fuse/dev.c:1334\n  fuse_dev_read+0x166/0x200 fs/fuse/dev.c:1367\n  call_read_iter include/linux/fs.h:2104 [inline]\n  new_sync_read fs/read_write.c:395 [inline]\n  vfs_read+0x85b/0xba0 fs/read_write.c:476\n  ksys_read+0x12f/0x260 fs/read_write.c:619\n  do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n  do_syscall_64+0xce/0x260 arch/x86/entry/common.c:83\n  entry_SYSCALL_64_after_hwframe+0x77/0x7f\n  ......\n  </TASK>\n\nThe warning is due to the FUSE_NOTIFY_RESEND notify sent by the write()\nsyscall in the reproducer program and it happens as follows:\n\n(1) calls fuse_dev_read() to read the INIT request\nThe read succeeds. During the read, bit FR_SENT will be set on the\nrequest.\n(2) calls fuse_dev_write() to send an USE_NOTIFY_RESEND notify\nThe resend notify will resend all processing requests, so the INIT\nrequest is moved from processing list to pending list again.\n(3) calls fuse_dev_read() with an invalid output address\nfuse_dev_read() will try to copy the same INIT request to the output\naddress, but it will fail due to the invalid address, so the INIT\nrequest is ended and triggers the warning in fuse_request_end().\n\nFix it by clearing FR_SENT when re-adding requests into pending list."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: fusible: borre FR_SENT al volver a agregar solicitudes a la lista pendiente Lee bruce inform\u00f3 la siguiente advertencia: ------------[ cortar aqu\u00ed ]- ----------- ADVERTENCIA: CPU: 0 PID: 8264 en fs/fuse/dev.c:300 fuse_request_end+0x685/0x7e0 fs/fuse/dev.c:300 M\u00f3dulos vinculados en: CPU: 0 PID: 8264 Comm: ab2 No contaminado 6.9.0-rc7 Nombre del hardware: PC est\u00e1ndar QEMU (i440FX + PIIX, 1996) RIP: 0010:fuse_request_end+0x685/0x7e0 fs/fuse/dev.c:300 ...... Seguimiento de llamadas:  fuse_dev_do_read.constprop.0+0xd36/0x1dd0 fs/fuse/dev.c:1334 fuse_dev_read+0x166/0x200 fs/fuse/dev.c:1367 call_read_iter include/linux/fs.h:2104 [en l\u00ednea ] new_sync_read fs/read_write.c:395 [en l\u00ednea] vfs_read+0x85b/0xba0 fs/read_write.c:476 ksys_read+0x12f/0x260 fs/read_write.c:619 do_syscall_x64 arch/x86/entry/common.c:52 [en l\u00ednea ] do_syscall_64+0xce/0x260 arch/x86/entry/common.c:83 Entry_SYSCALL_64_after_hwframe+0x77/0x7f ......  La advertencia se debe a la notificaci\u00f3n FUSE_NOTIFY_RESEND enviada por la llamada al sistema write() en el reproductor programa y sucede de la siguiente manera: (1) llama a fuse_dev_read() para leer la solicitud INIT La lectura se realiza correctamente. Durante la lectura, se establecer\u00e1 el bit FR_SENT en la solicitud. (2) llama a fuse_dev_write() para enviar una notificaci\u00f3n USE_NOTIFY_RESEND. La notificaci\u00f3n de reenv\u00edo reenviar\u00e1 todas las solicitudes de procesamiento, por lo que la solicitud INIT se mueve nuevamente de la lista de procesamiento a la lista pendiente. (3) llama a fuse_dev_read() con una direcci\u00f3n de salida no v\u00e1lida. fuse_dev_read() intentar\u00e1 copiar la misma solicitud INIT a la direcci\u00f3n de salida, pero fallar\u00e1 debido a la direcci\u00f3n no v\u00e1lida, por lo que la solicitud INIT finaliza y activa la advertencia en fuse_request_end (). Solucionelo borrando FR_SENT al volver a agregar solicitudes a la lista pendiente."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/246014876d782bbf2e652267482cd2e799fb5fcd", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/533070db659a9589310a743e9de14cf9d651ffaf", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-38626 - The vulnerability is related to the use of FUSE_NOTIFY_RESEND notify, which can be exploited by an attacker to trigger a warning in fuse_request_end(). This technique can be used to further explore the vulnerability, allowing the attacker to take control of the system."}, {"techniqueID": "T1165", "comment": "CVE-2024-38626 - The use of USE_NOTIFY_RESEND notify by the write() syscall, which can be exploited by an attacker to trigger the warning in fuse_request_end(). This technique is used by attackers to move files and take control of the system."}, {"techniqueID": "T1018", "comment": "CVE-2024-38626 - The vulnerability is related to the Linux kernel, specifically the FUSE file system. The attacker can use this technique to exploit the FUSE file system and take control of the system."}, {"techniqueID": "T1027", "comment": "CVE-2024-38626 - The use of the fusion file system, which can be exploited by an attacker to move files and take control of the system. This technique is used by attackers to move files and take control of the system."}], "stix_bundle": {"package": {"id": "bundle:0", "type": "bundle", "name": "CVE-2024-38626 STIX Bundle", "description": "STIX Bundle for CVE-2024-38626", "maintainer": "Your Name", "created_at": "2024-06-21T11:15:11.517", "modified_at": "2024-06-21T11:22:01.687"}, "objects": [{"id": "object1", "type": "incident", "name": "CVE-2024-38626", "description": "CVE-2024-38626 - Linux kernel FUSE file system vulnerability", "created_at": "2024-06-21T11:15:11.517", "modified_at": "2024-06-21T11:22:01.687", "objects": [{"id": "note1", "type": "note", "name": "Technical Analysis", "description": "Technical analysis of the vulnerability", "created_at": "2024-06-21T11:15:11.517", "modified_at": "2024-06-21T11:22:01.687", "from": "object1"}, {"id": "note2", "type": "note", "name": "MITRE ATT&CK Techniques", "description": "List of related MITRE ATT&CK Techniques", "created_at": "2024-06-21T11:15:11.517", "modified_at": "2024-06-21T11:22:01.687", "from": "object1"}, {"id": "note3", "type": "note", "name": "STIX Bundle Elements", "description": "STIX Bundle elements for CVE-2024-38626", "created_at": "2024-06-21T11:15:11.517", "modified_at": "2024-06-21T11:22:01.687", "from": "object1"}]}, {"id": "object2", "type": "indicator", "name": "High-Risk Indicator", "description": "Indicates high-risk activity related to CVE-2024-38626", "created_at": "2024-06-21T11:15:11.517", "modified_at": "2024-06-21T11:22:01.687", "objects": [{"id": "course_of_action1", "type": "course-of-action", "name": "Defense Against CVE-2024-38626", "description": "Defense strategy against CVE-2024-38626", "created_at": "2024-06-21T11:15:11.517", "modified_at": "2024-06-21T11:22:01.687", "from": "object2", "related_to": "T1190"}, {"id": "course_of_action2", "type": "course-of-action", "name": "Mitigation Strategy for CVE-2024-38626", "description": "Mitigation strategy for CVE-2024-38626", "created_at": "2024-06-21T11:15:11.517", "modified_at": "2024-06-21T11:22:01.687", "from": "object2", "related_to": "T1165"}]}], "relationship_types": [{"id": " relationship_type0", "type": "relationship-type", "name": "exploits", "description": "Exploits the vulnerability"}, {"id": "relationship_type1", "type": "relationship-type", "name": "indicates", "description": "Indicates high-risk activity"}]}, "technical_analysis": {"Introduction": "The CVE-2024-38626 vulnerability is a Linux kernel FUSE file system vulnerability that allows an attacker to trigger a warning in fuse_request_end() and move files and take control of the system.", "Impact and Scope": "The vulnerability has a CVSS score of 7.8 (high severity) and an attack vector of `LOCAL`.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK Techniques T1190, T1165, T1018, and T1027.", "Technical Details": "The vulnerability is caused by a use-after-free bug in the FUSE file system.", "Detection": "The vulnerability can be detected by monitoring for suspicious file system activity and looking for signs of exploitation, such as changes to the file system structure.", "Mitigation": "The vulnerability can be mitigated by disabling the FUSE file system or by patching the affected kernel version.", "Conclusion": "The CVE-2024-38626 vulnerability is a high-severity vulnerability that can be exploited to move files and take control of the system. It requires a local attack and can be detected and mitigated with proper monitoring and patching."}, "executive_analysis": {"Overview": "The CVE-2024-38626 vulnerability is a critical Linux kernel FUSE file system vulnerability that requires immediate attention from system administrators.", "Business Impact": "The vulnerability can allow an attacker to move files and take control of the system, which can result in data breaches and system compromise.", "Technical Impact": "The vulnerability requires a local attack and can be exploited by an attacker to move files and take control of the system.", "Mitigation Strategies": "Disable the FUSE file system or patch the affected kernel version.", "Recommendations": "System administrators should disable the FUSE file system until a patch is available, and then apply the patch as soon as possible.", "Conclusions": "The CVE-2024-38626 vulnerability is a critical vulnerability that requires immediate attention and mitigation to prevent system compromise and data breaches."}}