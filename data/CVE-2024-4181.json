{"id": "CVE-2024-4181", "sourceIdentifier": "security@huntr.dev", "published": "2024-05-16T09:15:15.553", "lastModified": "2024-05-16T13:03:05.353", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A command injection vulnerability exists in the RunGptLLM class of the llama_index library, version 0.9.47, used by the RunGpt framework from JinaAI to connect to Language Learning Models (LLMs). The vulnerability arises from the improper use of the eval function, allowing a malicious or compromised LLM hosting provider to execute arbitrary commands on the client's machine. This issue was fixed in version 0.10.13. The exploitation of this vulnerability could lead to a hosting provider gaining full control over client machines."}, {"lang": "es", "value": "Existe una vulnerabilidad de inyecci\u00f3n de comandos en la clase RunGptLLM de la librer\u00eda llama_index, versi\u00f3n 0.9.47, utilizada por el marco RunGpt de JinaAI para conectarse a los modelos de aprendizaje de idiomas (LLM). La vulnerabilidad surge del uso inadecuado de la funci\u00f3n de evaluaci\u00f3n, lo que permite que un proveedor de alojamiento LLM malicioso o comprometido ejecute comandos arbitrarios en la m\u00e1quina del cliente. Este problema se solucion\u00f3 en la versi\u00f3n 0.10.13. La explotaci\u00f3n de esta vulnerabilidad podr\u00eda llevar a que un proveedor de alojamiento obtenga control total sobre las m\u00e1quinas cliente."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://github.com/run-llama/llama_index/commit/d73715eaf0642705583e7897c78b9c8dd2d3a7ba", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/1a204520-598a-434e-b13d-0d34f2a5ddc1", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "TA0003", "comment": "CVE-2024-4181 - Lateral Movement - Validating Command Injection in RunGptLLM class of llama_index library\nDefending against this vulnerability requires a robust validation mechanism for user input."}, {"techniqueID": "TA0005", "comment": "CVE-2024-4181 - Command and Control - Exploitation of CWE-94 Vulnerability\nDefending against this vulnerability requires thorough validation of serialized data and restriction on the execution of arbitrary commands."}, {"techniqueID": "TA0040", "comment": "CVE-2024-4181 - Data Input/Output Hijacking - Unvalidated User Input in RunGptLLM class\nDefending against this vulnerability requires a robust input validation mechanism for data in-transit."}], "technical_analysis": {"Introduction": "A command injection vulnerability exists in the RunGptLLM class of the llama_index library, version 0.9.47, due to the improper use of the eval function. This vulnerability allows a malicious or compromised LLM hosting provider to execute arbitrary commands on the client's machine.", "Impact and Scope": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H, base score 8.8, attack vector NETWORK", "Related MITRE ATT&CK Techniques": "The vulnerability relies on the client's machine having the RunGptLLM class installed and vulnerable to command injection. Validating user input and restricting the execution of arbitrary commands are essential defense strategies to prevent exploitation.", "Technical Details": "The vulnerability arises from the improper use of the eval function, which allows a malicious or compromised LLM hosting provider to execute arbitrary commands on the client's machine.", "Detection": "Detection involves monitoring for suspicious command execution and validating user input.", "Mitigation": "Mitigation involves updating the llama_index library to version 0.10.13, validating user input, and restricting the execution of arbitrary commands.", "Conclusion": "The CVE-2024-4181 vulnerability is a critical security issue that requires immediate attention. Updating the llama_index library, validating user input, and restricting the execution of arbitrary commands are essential to prevent exploitation."}, "executive_analysis": {"Overview": "A command injection vulnerability exists in the RunGptLLM class of the llama_index library, version 0.9.47, due to the improper use of the eval function.", "Business Impact": "The vulnerability has a high confidentiality, integrity, and availability impact, as it allows a malicious or compromised LLM hosting provider to execute arbitrary commands on the client's machine.", "Technical Impact": "The vulnerability arises from the improper use of the eval function, which allows a malicious or compromised LLM hosting provider to execute arbitrary commands on the client's machine.", "Mitigation Strategies": "Updating the llama_index library to version 0.10.13, validating user input, and restricting the execution of arbitrary commands are essential mitigation strategies.", "Recommendations": "Executive-level recommendations include prioritizing CVE-2024-4181 vulnerability remediation, conducting thorough security audits, and implementing robust input validation mechanisms.", "Conclusions": "Immediate attention is required to address the CVE-2024-4181 vulnerability."}}