{"id": "CVE-2024-1504", "sourceIdentifier": "security@wordfence.com", "published": "2024-04-02T06:15:12.963", "lastModified": "2024-04-02T12:50:42.233", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The SecuPress Free \u2014 WordPress Security plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 2.2.5.1. This is due to missing or incorrect nonce validation on the secupress_blackhole_ban_ip() function. This makes it possible for unauthenticated attackers to block a user's IP via a forged request granted they can trick the user into performing an action such as clicking on a link."}, {"lang": "es", "value": "El complemento SecuPress Free \u2013 WordPress Security para WordPress es vulnerable a cross-site request forgery en todas las versiones hasta la 2.2.5.1 incluida. Esto se debe a una validaci\u00f3n nonce faltante o incorrecta en la funci\u00f3n secupress_blackhole_ban_ip(). Esto hace posible que atacantes no autenticados bloqueen la IP de un usuario mediante una solicitud falsificada, siempre que puedan enga\u00f1ar al usuario para que realice una acci\u00f3n como hacer clic en un enlace."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "references": [{"url": "https://plugins.trac.wordpress.org/browser/secupress/tags/2.2.5.1/free/modules/sensitive-data/plugins/blackhole.php#L74", "source": "security@wordfence.com"}, {"url": "https://plugins.trac.wordpress.org/browser/secupress/trunk/free/modules/sensitive-data/plugins/blackhole.php#L54", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/4243bd6d-34f6-4d29-a333-4499a2e2d2e1?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-1504 - Cross-Site Request Forgery (CSRF) vulnerability allows unauthenticated attackers to block a user's IP address by tricking the user into performing an action such as clicking on a link. Defend against this by implementing CSRF token validation and rate limiting of IP addresses."}, {"techniqueID": "T1062", "comment": "CVE-2024-1504 - The SecuPress Free WordPress Security plugin's missing or incorrect nonce validation on the secupress_blackhole_ban_ip() function leads to Cross-Site Request Forgery (CSRF) vulnerability, which can be exploited by unauthenticated attackers. Implement measures to secure this function and validate nonce values."}, {"techniqueID": "T1568.002", "comment": "CVE-2024-1504 - The SecuPress Free WordPress Security plugin's secupress_blackhole_ban_ip() function lacks proper input validation, allowing attackers to manipulate the function and block IP addresses programmatically. Implement input validation and sanitization measures to prevent this."}], "stix_bundle": {"objects": [{"id": "CVE-2024-1504", "type": "vulnerability", "name": "SecuPress Free WordPress Security Plugin Cross-Site Request Forgery Vulnerability", "description": "The SecuPress Free WordPress Security plugin has a Cross-Site Request Forgery (CSRF) vulnerability due to missing or incorrect nonce validation on the secupress_blackhole_ban_ip() function, allowing unauthenticated attackers to block a user's IP address.", "severity": "MEDIUM", " exploited": "UNIKERNEL", "published": "2024-04-02T06:15:12.963", "modified": "2024-04-02T12:50:42.233"}, {"id": "T1190", "type": "attack-pattern", "name": "Cross-Site Request Forgery (CSRF)", "description": "An attacker tricks a user into performing an unwanted action on a web application, usually by exploiting the fact that many web applications do not validate or securely parse HTTP requests."}, {"id": "T1062", "type": "attack-pattern", "name": "Reflected File Data", "description": "An attacker injects malicious data into a web application's input fields, which is then reflected back to the user."}, {"id": "T1568.002", "type": "attack-pattern", "name": "Command and Control - Network", "description": "An attacker establishes command and control over a compromised network device or system to issue malicious commands and execute unauthorized actions."}], "resources": [{"id": "CVE-2024-1504", "type": "resource", "name": "CVE-2024-1504", "description": "The SecuPress Free WordPress Security plugin Cross-Site Request Forgery vulnerability"}], "analyses": [{"id": "Analyses", "type": "analysis", "name": "Analyses"}]}, "technical_analysis": {"Introduction": "The SecuPress Free WordPress Security plugin has a Cross-Site Request Forgery (CSRF) vulnerability due to missing or incorrect nonce validation on the secupress_blackhole_ban_ip() function.", "Impact and Scope": "The vulnerability allows unauthenticated attackers to block a user's IP address by tricking the user into performing an action such as clicking on a link. The cvss score is 4.3 (MEDIUM) and the attack vector is NETWORK.", "Related MITRE ATT&CK Techniques": "T1190, T1062, and T1568.002", "Technical Details": "The secupress_blackhole_ban_ip() function lacks proper input validation and sanitization, making it vulnerable to CSRF attacks.", "Detection": "Detect this vulnerability by monitoring for HTTP requests that trigger the secupress_blackhole_ban_ip() function and verifying the validity of the requests.", "Mitigation": "Implement measures to secure the secupress_blackhole_ban_ip() function, such as implementing CSRF token validation and rate limiting of IP addresses.", "Conclusion": "The SecuPress Free WordPress Security plugin Cross-Site Request Forgery vulnerability is a significant risk and requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "A Cross-Site Request Forgery (CSRF) vulnerability in the SecuPress Free WordPress Security plugin allows unauthenticated attackers to block a user's IP address.", "Business Impact": "This vulnerability could lead to unauthorized access to sensitive data, disruption of business operations, and reputational damage.", "Technical Impact": "The vulnerability could allow attackers to manipulate the secupress_blackhole_ban_ip() function and block IP addresses programmatically.", "Mitigation Strategies": "Implement measures to secure the secupress_blackhole_ban_ip() function, such as implementing CSRF token validation and rate limiting of IP addresses.", "Recommendations": "Prioritize patching and updating the SecuPress Free WordPress Security plugin, as well as implementing security measures to detect and prevent CSRF attacks.", "Conclusions": "This vulnerability requires immediate attention and mitigation to prevent unauthorized access and protect business operations."}}