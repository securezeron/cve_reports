{"id": "CVE-2024-38275", "sourceIdentifier": "patrick@puiterwijk.org", "published": "2024-06-18T20:15:13.970", "lastModified": "2024-07-03T02:04:53.613", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The cURL wrapper in Moodle retained the original request headers when following redirects, so HTTP authorization header information could be unintentionally sent in requests to redirect URLs."}, {"lang": "es", "value": "El contenedor cURL en Moodle retuvo los encabezados de solicitud originales al seguir redirecciones, por lo que la informaci\u00f3n del encabezado de autorizaci\u00f3n HTTP podr\u00eda enviarse involuntariamente en solicitudes para redireccionar URL."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "patrick@puiterwijk.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-226"}]}], "references": [{"url": "https://moodle.org/mod/forum/discuss.php?d=459500", "source": "patrick@puiterwijk.org"}], "techniques": [{"techniqueID": "TA0001", "comment": "T1190 - Exploit Public-Facing Application - The cURL wrapper in Moodle retained the original request headers when following redirects, which could be exploited by an attacker. This technique is relevant as it is often used by attackers to exploit vulnerable applications."}, {"techniqueID": "TA0002", "comment": "T1191 - Exploit Secondary Vulnerability - The vulnerability in cURL could be exploited to gain additional access to a system, which could then be used to carry out further attacks. This technique is relevant as it is often used by attackers to escalate privileges."}, {"techniqueID": "TA0010", "comment": "T1018 - Reduced Privilege Command Shell - This technique is relevant as it is often used by attackers to establish a foothold on a system and then escalate privileges. The vulnerability in cURL could be used to gain a foothold on a system."}], "stix_bundle": {"objects": [{"type": "attack-pattern", "id": "attack-pattern--c4a6aeae-4f94-44c9-8f4c-88c6e25d67a6", "name": "Moodle cURL Wrapper Redirect Request Traversal", "description": "The cURL wrapper in Moodle retained the original request headers when following redirects, which could be exploited by an attacker.", "kill_chain_phase_name": "Attack", "external_references": [{"source_name": "MITRE", "external_id": "T1190"}]}, {"type": "vulnerability", "id": "vulnerability--1b9a1b1f-37a8-446a-bd1f-e9a8e0fd2b3a", "name": "Moodle cURL Wrapper Redirect Request Traversal", "description": "The cURL wrapper in Moodle retained the original request headers when following redirects, which could be exploited by an attacker.", "external_references": [{"source_name": "CISA", "external_id": "CVE-2024-38275"}]}, {"type": "indicator", "id": "indicator--07a8e5e9-ed3a-47a8-b25a-57bcb33d2b4a", "name": "Moodle cURL Wrapper Redirect Request Indication", "description": "The cURL wrapper in Moodle retained the original request headers when following redirects, which could be exploited by an attacker.", "kill_chain_phases": [{"kill_chain_name": "Attack", "phase_name": "T1190"}]}], "relationship": [{"type": "related-to", "id": "related-to--0f0b3f4d-b8e6-482e-9003-ecf3a7c4ffea", "from": "vulnerability--1b9a1b1f-37a8-446a-bd1f-e9a8e0fd2b3a", "to": "attack-pattern--c4a6aeae-4f94-44c9-8f4c-88c6e25d67a6", "relationship_type": "exploits"}, {"type": "related-to", "id": "related-to--7d5f5f8a-b7d3-447c-a0a6-6e45f2a48f2c", "from": "attack-pattern--c4a6aeae-4f94-44c9-8f4c-88c6e25d67a6", "to": "indicator--07a8e5e9-ed3a-47a8-b25a-57bcb33d2b4a", "relationship_type": "indicated-by"}]}, "technical_analysis": {"Introduction": "The Moodle cURL wrapper redirect request traversal vulnerability allowed an attacker to exploit the cURL wrapper in Moodle to gain additional access to a system.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5, with an attack vector of NETWORK and an exploitability score of 3.9. This means that the vulnerability could be exploited remotely, which increases the risk of the vulnerability being exploited in a real-world scenario.", "Related MITRE ATT&CK Techniques": "The vulnerability is relevant to several MITRE ATT&CK techniques, including T1190, T1191, and T1018. These techniques could be used to exploit the vulnerability and gain additional access to a system.", "Technical Details": "The cURL wrapper in Moodle retained the original request headers when following redirects, which could be exploited by an attacker to gain additional access to a system.", "Detection": "The vulnerability can be detected by monitoring network traffic for anomalies and by conducting regular vulnerability assessments.", "Mitigation": "The vulnerability can be mitigated by updating the cURL wrapper in Moodle to the latest version, which is patched against the vulnerability.", "Conclusion": "In conclusion, the Moodle cURL wrapper redirect request traversal vulnerability is a serious vulnerability that could be exploited by an attacker to gain additional access to a system. The vulnerability is relevant to several MITRE ATT&CK techniques and can be detected and mitigated using the methods described above."}, "executive_analysis": {"Overview": "The Moodle cURL wrapper redirect request traversal vulnerability is a serious vulnerability that could be exploited by an attacker to gain additional access to a system.", "Business Impact": "The vulnerability could be exploited by an attacker to gain access to sensitive data or to take control of a system, which could result in significant financial and reputational damage.", "Technical Impact": "The vulnerability could be exploited remotely, which increases the risk of the vulnerability being exploited in a real-world scenario.", "Mitigation Strategies": "The vulnerability can be mitigated by updating the cURL wrapper in Moodle to the latest version, which is patched against the vulnerability. Regular vulnerability assessments and patch management can also help to reduce the risk of the vulnerability being exploited.", "Recommendations": "We recommend that educational institutions and organizations update the cURL wrapper in Moodle to the latest version as soon as possible and that they conduct regular vulnerability assessments to identify and mitigate any vulnerabilities that may be present.", "Conclusions": "In conclusion, the Moodle cURL wrapper redirect request traversal vulnerability is a serious vulnerability that could be exploited by an attacker to gain additional access to a system. We recommend that immediate action be taken to mitigate the vulnerability and to reduce the risk of it being exploited."}}