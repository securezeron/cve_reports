{"id": "CVE-2024-6872", "sourceIdentifier": "security@wordfence.com", "published": "2024-08-03T12:15:17.160", "lastModified": "2024-08-05T12:41:45.957", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Build Your Dream Website Fast with 400+ Starter Templates and Landing Pages, No Coding Needed, One-Click Import for Elementor & Gutenberg Blocks! \u2013 TemplateSpare plugin for WordPress is vulnerable to unauthorized modification of data due to a missing capability check on the 'templatespare_activate_required_theme' and 'templatespare_get_theme_status' functions in all versions up to, and including, 2.4.2. This makes it possible for authenticated attackers, with Subscriber-level access and above, to activate any installed theme and read any theme status. If the attacker attempts to activate a theme that is not installed, a non-existent theme with the slug chosen by the attacker will be considered the active theme, leaving the site with no theme functionality."}, {"lang": "es", "value": "Build Your Dream Website Fast with 400+ Starter Templates and Landing Pages, No Coding Needed, One-Click Import for Elementor &amp; Gutenberg Blocks! \u2013 TemplateSpare para WordPress es vulnerable a modificaciones no autorizadas de datos debido a una falta de verificaci\u00f3n de capacidad en las funciones 'templatespare_activate_required_theme' y 'templatespare_get_theme_status' en todas las versiones hasta la 2.4.2 incluida. Esto hace posible que atacantes autenticados, con acceso de nivel de suscriptor y superior, activen cualquier tema instalado y lean el estado de cualquier tema. Si el atacante intenta activar un tema que no est\u00e1 instalado, un tema inexistente con el slug elegido por el atacante se considerar\u00e1 tema activo, dejando el sitio sin funcionalidad de tema."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "security@wordfence.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-862"}]}], "references": [{"url": "https://plugins.trac.wordpress.org/browser/templatespare/trunk/includes/templatespare-kit.php#L13", "source": "security@wordfence.com"}, {"url": "https://plugins.trac.wordpress.org/browser/templatespare/trunk/includes/templatespare-kit.php#L34", "source": "security@wordfence.com"}, {"url": "https://plugins.trac.wordpress.org/changeset/3129809/", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/a0c74807-b85c-478e-bebf-1f0b46a21c11?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-6872 - Authentication Bypass via AnAlternate Authentication Mechanism. The missing capability check in the 'templatespare_activate_required_theme' function allows authenticated attackers to activate any installed theme, bypassing the normal theme activation process."}, {"techniqueID": "T1645", "comment": "CVE-2024-6872 - Theme Activation and Theme Status Display. The vulnerability in the 'templatespare_get_theme_status' function allows attackers to read any theme status, and if the attacker attempts to activate a theme that is not installed, a non-existent theme with the slug chosen by the attacker will be considered the active theme, leaving the site with no theme functionality."}, {"techniqueID": "T1638", "comment": "CVE-2024-6872 - Theme Template Injection. The vulnerability in the 'templatespare-get-theme-status' function allows attackers to inject themes, potentially leading to malicious code execution."}], "technical_analysis": {"Introduction": "The CVE-2024-6872 vulnerability affects the TemplateSpare plugin for WordPress, allowing authenticated attackers to bypass authentication and activate any installed theme or inject malicious themes, ultimately leading to loss of integrity and availability of the affected website.", "Impact and Scope": "The vulnerability has a base score of 4.3, with an attack vector of NETWORK and privileges required of LOW. This vulnerability can potentially be exploited by authenticated attackers, allowing them to take control of the affected website.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190, T1645, and T1638.", "Technical Details": "The vulnerability lies in the missing capability check in the 'templatespare_activate_required_theme' function, which allows attackers to activate any installed theme, and in the 'templatespare_get_theme_status' function, which allows attackers to read any theme status.", "Detection": "Detection of this vulnerability can be done by monitoring for unauthorized theme activation and status changes.", "Mitigation": "The mitigation for this vulnerability is to update the TemplateSpare plugin to a version greater than 2.4.2, and to monitor for unauthorized theme activation and status changes.", "Conclusion": "The CVE-2024-6872 vulnerability is a critical issue that can be exploited by authenticated attackers, allowing them to take control of the affected website. It is essential to update the TemplateSpare plugin to a version greater than 2.4.2 and to monitor for unauthorized theme activation and status changes."}, "executive_analysis": {"Overview": "The CVE-2024-6872 vulnerability is a critical issue that affects the TemplateSpare plugin for WordPress, allowing authenticated attackers to bypass authentication and take control of the affected website.", "Business Impact": "The business impact of this vulnerability is significant, as it can potentially lead to loss of integrity and availability of the affected website.", "Technical Impact": "The technical impact of this vulnerability is the potential for unauthorized theme activation and status changes, leading to loss of integrity and availability of the affected website.", "Mitigation Strategies": "The mitigation strategy for this vulnerability is to update the TemplateSpare plugin to a version greater than 2.4.2 and to monitor for unauthorized theme activation and status changes.", "Recommendations": "We recommend that all users affected by this vulnerability update the TemplateSpare plugin to a version greater than 2.4.2 and take immediate action to mitigate the risk.", "Conclusions": "In conclusion, the CVE-2024-6872 vulnerability is a critical issue that can be exploited by authenticated attackers, allowing them to take control of the affected website. It is essential to update the TemplateSpare plugin to a version greater than 2.4.2 and to monitor for unauthorized theme activation and status changes."}}