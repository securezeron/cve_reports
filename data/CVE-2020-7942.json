{"id": "CVE-2020-7942", "sourceIdentifier": "security@puppet.com", "published": "2020-02-19T21:15:11.747", "lastModified": "2021-12-30T13:33:51.290", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Previously, Puppet operated on a model that a node with a valid certificate was entitled to all information in the system and that a compromised certificate allowed access to everything in the infrastructure. When a node's catalog falls back to the `default` node, the catalog can be retrieved for a different node by modifying facts for the Puppet run. This issue can be mitigated by setting `strict_hostname_checking = true` in `puppet.conf` on your Puppet master. Puppet 6.13.0 and 5.5.19 changes the default behavior for strict_hostname_checking from false to true. It is recommended that Puppet Open Source and Puppet Enterprise users that are not upgrading still set strict_hostname_checking to true to ensure secure behavior. Affected software versions: Puppet 6.x prior to 6.13.0 Puppet Agent 6.x prior to 6.13.0 Puppet 5.5.x prior to 5.5.19 Puppet Agent 5.5.x prior to 5.5.19 Resolved in: Puppet 6.13.0 Puppet Agent 6.13.0 Puppet 5.5.19 Puppet Agent 5.5.19"}, {"lang": "es", "value": "Anteriormente, Puppet operaba en un modelo en el que un nodo con un certificado v\u00e1lido ten\u00eda derecho a toda la informaci\u00f3n del sistema y que un certificado comprometido permit\u00eda el acceso a todo en la infraestructura. Cuando el cat\u00e1logo de un nodo retrocede al nodo \"default\", el cat\u00e1logo puede ser recuperado para un nodo diferente mediante la modificaci\u00f3n de datos para una ejecuci\u00f3n de Puppet. Este problema puede ser mitigado al configurar \"strictly_hostname_checking = true\" en \"puppet.conf\" en su maestro de Puppet. Puppet versi\u00f3n 6.13.0 y versi\u00f3n 5.5.19 cambia el comportamiento predeterminado para el strict_hostname_checking de falso a verdadero. Se recomienda que los usuarios de Puppet Open Source y Puppet Enterprise que no est\u00e1n actualizando establezcan stric_nombre_host_checking en verdadero para garantizar un comportamiento seguro. Versiones de software afectadas: Puppet versi\u00f3n 6.x en versiones anteriores a la 6.13.0 Puppet Agent versi\u00f3n 6.x en versiones anteriores a la 6.13.0 Puppet versi\u00f3n 5.5.x en versiones anteriores a la 5.5.19 Puppet Agent versi\u00f3n 5.5.x en versiones anteriores a la 5.5.19 Resuelto en: Puppet versi\u00f3n 6.13.0 Puppet Agente versi\u00f3n 6.13.0 Puppet versi\u00f3n 5.5.19 Puppet Agent versi\u00f3n 5.5.19."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-295"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.5.0", "versionEndExcluding": "5.5.19", "matchCriteriaId": "E1316D93-D540-4E07-97B9-0FD9DAC19D5E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.0.0", "versionEndExcluding": "6.13.0", "matchCriteriaId": "2A32C5AF-A28C-464B-949D-570BD98D36C9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet_agent:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.5.0", "versionEndExcluding": "5.5.19", "matchCriteriaId": "09EAB60C-0BE2-4FCA-9867-2D6CA4F84F35"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet_agent:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.0.0", "versionEndExcluding": "6.13.0", "matchCriteriaId": "C76E5E7E-185B-48E7-AC61-C7F97F1B46BC"}]}]}], "references": [{"url": "https://puppet.com/security/cve/CVE-2020-7942/", "source": "security@puppet.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0001: Initial Access", "comment": "CVE-2020-7942 - An attacker can use this vulnerability to gain initial access to a victim's system by exploiting the Puppet certificate management system, potentially allowing them to execute arbitrary code or steal sensitive information."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "CVE-2020-7942 - The vulnerability is a public-facing application exploit, allowing an attacker to exploit the Puppet certificate management system by targeting the default node in a Puppet infrastructure, potentially accessing sensitive information or executing malicious code."}, {"techniqueID": "T1210: Exploitation of Remote Services", "comment": "CVE-2020-7942 - The vulnerability is an exploitation of a remote service, specifically the Puppet certificate management system, which allows an attacker to access the system remotely, potentially executing malicious code or stealing sensitive information."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "vuln:CVE-2020-7942", "created": "2020-02-19T21:15:11.747", "modified": "2021-12-30T13:33:51.290", "name": "Puppet Certificate Management System Vulnerability", "description": "Previously, Puppet operated on a model that a node with a valid certificate was entitled to all information in the system and that a compromised certificate allowed access to everything in the infrastructure.", "Weaknesses": [{"type": "weakeness", "id": "weakeness:CWE-295", "name": "Incorrect Certificate Validation"}], "Extensions": [{"type": "extension", "id": "extension:cvss-3.1", "cvss": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"}}], "Relations": [{"type": "relates-to", "id": "relates-to:technique:TA0001", "technique": {"name": "Initial Access"}}, {"type": "relates-to", "id": "relates-to:technique:T1190", "technique": {"name": "Exploit Public-Facing Application"}}, {"type": "relates-to", "id": "relates-to:technique:T1210", "technique": {"name": "Exploitation of Remote Services"}}]}]}, "technical_analysis": {"Introduction": "The Puppet Certificate Management System vulnerability (CVE-2020-7942) is a high-severity vulnerability that allows an attacker to gain initial access to a victim's system by exploiting the certificate management system.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 6.5, and it affects Puppet 6.x prior to 6.13.0 and Puppet 5.5.x prior to 5.5.19.", "Related MITRE ATT&CK Techniques": "TA0001: Initial Access, T1190: Exploit Public-Facing Application, T1210: Exploitation of Remote Services", "Technical Details": "The vulnerability allows an attacker to obtain a valid certificate for a different node by modifying facts for the Puppet run, potentially allowing them to access sensitive information or execute malicious code.", "Detection": "Detection of this vulnerability involves monitoring for unusual activity in the Puppet certificate management system and investigating any potential indicators of compromise.", "Mitigation": "Mitigation strategies include configuring `strict_hostname_checking = true` in `puppet.conf` on the Puppet master, updating to affected versions of Puppet, and implementing additional security controls.", "Conclusion": "In conclusion, the Puppet Certificate Management System vulnerability (CVE-2020-7942) is a significant vulnerability that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The Puppet Certificate Management System vulnerability (CVE-2020-7942) is a critical vulnerability that requires immediate attention and remediation.", "Business Impact": "The impact of this vulnerability is significant, with potential financial losses and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is significant, with potential exposure of sensitive information and execution of malicious code.", "Mitigation Strategies": "Mitigation strategies include configuring `strict_hostname_checking = true` in `puppet.conf` on the Puppet master, updating to affected versions of Puppet, and implementing additional security controls.", "Recommendations": "Recommendations for executives include prioritizing remediation of this vulnerability, monitoring for unusual activity, and implementing additional security controls.", "Conclusions": "In conclusion, the Puppet Certificate Management System vulnerability (CVE-2020-7942) is a critical vulnerability that requires immediate attention and remediation."}}