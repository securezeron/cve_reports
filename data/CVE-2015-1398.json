{"id": "CVE-2015-1398", "sourceIdentifier": "cve@mitre.org", "published": "2015-04-29T22:59:01.533", "lastModified": "2015-05-12T02:03:27.600", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple directory traversal vulnerabilities in Magento Community Edition (CE) 1.9.1.0 and Enterprise Edition (EE) 1.14.1.0 allow remote authenticated users to include and execute certain PHP files via (1) .. (dot dot) sequences in the PATH_INFO to index.php or (2) vectors involving a block value in the ___directive parameter to the Cms_Wysiwyg controller in the Adminhtml module, related to the blockDirective function and the auto loading mechanism.  NOTE: vector 2 might not cross privilege boundaries, since administrators might already have the privileges to execute code and upload files."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de salto de directorio en Magento Community Edition (CE) 1.9.1.0 y Enterprise Edition (EE) 1.14.1.0 permiten a usuarios remotos autenticados incluir y ejecutar ciertos ficherso PHP a trav\u00e9s de (1) secuencias de .. (punto punto) en PATH_INFO en index.php o (2) vectores que involucran un valor de bloque en el par\u00e1metro ___directive en el controlador Cms_Wysiwyg en el m\u00f3dulo Adminhtml, relacionado con la funci\u00f3n blockDirective y el mecanismo de carga autom\u00e1tica. NOTA: el vector 2 podr\u00eda no cruzar los l\u00edmites de los privilegios, como administradores podr\u00edan ya tener los privilegios para ejecutar c\u00f3digo y subir ficheros."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:magento:magento:1.9.1.0:*:*:*:community:*:*:*", "matchCriteriaId": "A6844CE7-F5A9-41CC-BAE8-C860C36F1C14"}, {"vulnerable": true, "criteria": "cpe:2.3:a:magento:magento:1.14.1.0:*:*:*:enterprise:*:*:*", "matchCriteriaId": "3B9093FD-5E68-4616-BFDC-DA589FBCEDFB"}]}]}], "references": [{"url": "http://blog.checkpoint.com/2015/04/20/analyzing-magento-vulnerability/", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://magento.com/blog/technical/critical-security-advisory-remote-code-execution-rce-vulnerability", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.securitytracker.com/id/1032194", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2015-1398 - Directory traversal vulnerability allowing remote authenticated users to include and execute PHP files, related to the blockDirective function and the auto-loading mechanism."}, {"techniqueID": "T1204", "comment": "CVE-2015-1398 - Use of PHP files with malicious code, which can lead to remote code execution as a result of directory traversal, requires authentication."}, {"techniqueID": "T1139", "comment": "CVE-2015-1398 - Weak configuration of Magento, allowing attacks to succeed, requiring authentication and exploitation of directory traversal vulnerability."}, {"techniqueID": "T1210", "comment": "CVE-2015-1398 - Injection of PHP code through PATH_INFO to index.php, related to the blockDirective function and the auto-loading mechanism, requires authentication."}, {"techniqueID": "T1078", "comment": "CVE-2015-1398 - Post-authentication exploitation of directory traversal vulnerability, allowing remote attackers to access and include arbitrary files, leading to remote code execution."}], "technical_analysis": {"Introduction": "CVE-2015-1398 is a directory traversal vulnerability in Magento Community Edition 1.9.1.0 and Enterprise Edition 1.14.1.0, allowing remote authenticated users to include and execute PHP files.", "Impact and Scope": "CVSSv2: 6.5, AV:N/AC:L/Au:S/C:P/I:P/A:P, Partially affects confidentiality, integrity, and availability.", "Related MITRE ATT&CK Techniques": ["T1190", "T1204", "T1139", "T1210", "T1078"], "Technical Details": "Directory traversal vulnerability in Magento, allowing remote authenticated users to include and execute PHP files, related to the blockDirective function and the auto-loading mechanism.", "Detection": "Monitor for authentication traffic, unusual HTTP requests, and PHP file access.", "Mitigation": "Apply patches, restrict file access, limit user privileges.", "Conclusion": "CVE-2015-1398 is a serious vulnerability requiring immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2015-1398 is a serious authentication bypass vulnerability in Magento, allowing attackers to access and execute PHP files, compromising system security.", "Business Impact": "Potential data loss, system compromise, and reputational damage.", "Technical Impact": "Allows attackers to execute arbitrary code, gain unauthorized access, and manipulate system configuration.", "Mitigation Strategies": "Apply patches, restrict file access, limit user privileges.", "Recommendations": "Prioritize vulnerability remediation, restrict access to sensitive files, and implement robust security measures.", "Conclusions": "CVE-2015-1398 is a critical vulnerability requiring immediate attention and mitigation to ensure system security and integrity."}}