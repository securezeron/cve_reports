{"id": "CVE-2024-35901", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-19T09:15:10.967", "lastModified": "2024-05-20T13:00:04.957", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: mana: Fix Rx DMA datasize and skb_over_panic\n\nmana_get_rxbuf_cfg() aligns the RX buffer's DMA datasize to be\nmultiple of 64. So a packet slightly bigger than mtu+14, say 1536,\ncan be received and cause skb_over_panic.\n\nSample dmesg:\n[ 5325.237162] skbuff: skb_over_panic: text:ffffffffc043277a len:1536 put:1536 head:ff1100018b517000 data:ff1100018b517100 tail:0x700 end:0x6ea dev:<NULL>\n[ 5325.243689] ------------[ cut here ]------------\n[ 5325.245748] kernel BUG at net/core/skbuff.c:192!\n[ 5325.247838] invalid opcode: 0000 [#1] PREEMPT SMP NOPTI\n[ 5325.258374] RIP: 0010:skb_panic+0x4f/0x60\n[ 5325.302941] Call Trace:\n[ 5325.304389]  <IRQ>\n[ 5325.315794]  ? skb_panic+0x4f/0x60\n[ 5325.317457]  ? asm_exc_invalid_op+0x1f/0x30\n[ 5325.319490]  ? skb_panic+0x4f/0x60\n[ 5325.321161]  skb_put+0x4e/0x50\n[ 5325.322670]  mana_poll+0x6fa/0xb50 [mana]\n[ 5325.324578]  __napi_poll+0x33/0x1e0\n[ 5325.326328]  net_rx_action+0x12e/0x280\n\nAs discussed internally, this alignment is not necessary. To fix\nthis bug, remove it from the code. So oversized packets will be\nmarked as CQE_RX_TRUNCATED by NIC, and dropped."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net: mana: Fix Rx DMA datasize y skb_over_panic mana_get_rxbuf_cfg() alinea el tama\u00f1o de datos DMA del buffer RX para que sea m\u00faltiplo de 64. Entonces, un paquete ligeramente m\u00e1s grande que mtu+14, digamos 1536, se puede recibir y causar skb_over_panic. Dmesg de muestra: [5325.237162] skbuff: skb_over_panic: text:ffffffffc043277a len:1536 put:1536 head:ff1100018b517000 data:ff1100018b517100 tail:0x700 end:0x6ea dev: [ 689] ----------- -[ cortar aqu\u00ed ]------------ \u00a1BUG del kernel [5325.245748] en net/core/skbuff.c:192! [ 5325.247838] c\u00f3digo de operaci\u00f3n no v\u00e1lido: 0000 [#1] PREEMPT SMP NOPTI [ 5325.258374] RIP: 0010:skb_panic+0x4f/0x60 [ 5325.302941] Seguimiento de llamadas: [ 5325.304389]  [ 5325.315794] ? skb_panic+0x4f/0x60 [5325.317457]? asm_exc_invalid_op+0x1f/0x30 [5325.319490]? skb_panic+0x4f/0x60 [ 5325.321161] skb_put+0x4e/0x50 [ 5325.322670] mana_poll+0x6fa/0xb50 [mana] [ 5325.324578] __napi_poll+0x33/0x1e0 [ 5325.326328 ] net_rx_action+0x12e/0x280 Como se analiz\u00f3 internamente, esta alineaci\u00f3n no es necesaria. Para corregir este error, elim\u00ednelo del c\u00f3digo. Por lo tanto, los paquetes de gran tama\u00f1o ser\u00e1n marcados como CQE_RX_TRUNCATED por NIC y descartados."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/05cb7c41fa1a7a7b2c2a6b81bbe7c67f5c11932b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c0de6ab920aafb56feab56058e46b688e694a246", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ca58927b00385005f488b6a9905ced7a4f719aad", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-35901 - This technique is relevant as it manipulates the DMA datasize which can lead to a buffer overflow and potentially allow for the execution of arbitrary code. To defend against this, ensure proper validation of buffers and implement memory protection mechanisms."}, {"techniqueID": "T1043", "comment": "CVE-2024-35901 - A buffer overflow vulnerability exists which can lead to the execution of arbitrary code. This can be exploited by an attacker to gain elevated privileges or execute a payload."}, {"techniqueID": "T1041", "comment": "CVE-2024-35901 - A buffer overflow vulnerability exists which can be exploited by an attacker to inject arbitrary code into a vulnerable system."}, {"techniqueID": "TTP9", "comment": "CVE-2024-35901 - The vulnerability exists in a Linux kernel driver and can be triggered by sending a malformed packet. To defend against this, ensure proper validation of packets and implement memory protection mechanisms."}], "stix_bundle": {"objects": [{"id": "cov-vulnerability-cve-2024-35901", "type": "vulnerability", "created_by_ref": "test", "modified": "2024-05-20T13:00:04.957", "name": "Linux Kernel Mana Driver Buffer Overflow Vulnerability", "description": "A buffer overflow vulnerability exists in the Linux kernel Mana driver which can be exploited by an attacker to inject arbitrary code into a vulnerable system.", "severity": "medium", "_aliases": ["CVE-2024-35901"], "objects": [{"id": "atta-technique-T1190", "type": "technique", "created_by_ref": "test", "name": "Buffer Overflow via DMA Datamax", "description": "This technique uses DMA datamax to manipulate the DMA datasize and cause a buffer overflow."}, {"id": "atta-technique-T1043", "type": "technique", "created_by_ref": "test", "name": "Buffer Overflow via Packet Injection", "description": "This technique injects a malformed packet into the system to cause a buffer overflow."}, {"id": "atta-technique-T1041", "type": "technique", "created_by_ref": "test", "name": "Buffer Overflow via Code Injection", "description": "This technique injects arbitrary code into a vulnerable system to cause a buffer overflow."}, {"id": "atta-technique-TTP9", "type": "technique", "created_by_ref": "test", "name": "Linux Kernel Buffer Overflow Vulnerability", "description": "This technique exploits a buffer overflow vulnerability in the Linux kernel."}], "relationship": [{"id": "r-vulnerability-atta-technique-T1190", "type": "related_to", "target_ref": "atta-technique-T1190"}, {"id": "r-vulnerability-atta-technique-T1043", "type": "related_to", "target_ref": "atta-technique-T1043"}, {"id": "r-vulnerability-atta-technique-T1041", "type": "related_to", "target_ref": "atta-technique-T1041"}, {"id": "r-vulnerability-atta-technique-TTP9", "type": "related_to", "target_ref": "atta-technique-TTP9"}]}]}, "technical_analysis": {"Introduction": "The Linux kernel Mana driver buffer overflow vulnerability, identified as CVE-2024-35901, is a significant security issue that can be exploited to inject arbitrary code into a vulnerable system.", "Impact and Scope": "The vulnerability exists in the Linux kernel Mana driver and has a CVSS score of 7.0 (Medium) with an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques such as T1190, T1043, T1041, and TTP9.", "Technical Details": "The vulnerability is caused by a buffer overflow in the DMA datasize, which can be triggered by sending a malformed packet. This can be exploited to inject arbitrary code into a vulnerable system.", "Detection": "Detection methods include monitoring for suspicious network traffic and analyzing system logs for signs of buffer overflow attacks.", "Mitigation": "Mitigation strategies include implementing memory protection mechanisms, validating buffers, and patching the vulnerable driver.", "Conclusion": "The Linux kernel Mana driver buffer overflow vulnerability is a significant security issue that requires immediate attention. Implementing the recommended mitigation strategies can help prevent exploitation of this vulnerability."}, "executive_analysis": {"Overview": "The Linux kernel Mana driver buffer overflow vulnerability is a critical security issue that can have significant business and technical impacts.", "Business Impact": "The vulnerability can be exploited to inject arbitrary code into a vulnerable system, which can lead to data breaches and damage to business reputation.", "Technical Impact": "The vulnerability can be exploited to gain elevated privileges or execute a payload, which can lead to system compromise and data theft.", "Mitigation Strategies": "Mitigation strategies include patching the vulnerable driver, implementing memory protection mechanisms, and validating buffers.", "Recommendations": "Recommendations include conducting a thorough risk assessment, implementing a vulnerability management program, and providing training to IT staff on security best practices.", "Conclusions": "The Linux kernel Mana driver buffer overflow vulnerability requires immediate attention and action to prevent exploitation. Implementing recommended mitigation strategies and conducting regular security assessments can help protect against this vulnerability."}}