{"id": "CVE-2024-3799", "sourceIdentifier": "cvd@cert.pl", "published": "2024-07-10T12:15:10.180", "lastModified": "2024-07-12T10:15:02.353", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Insecure handling of POST header parameter body\u00a0included in requests being sent to an instance of the open-source project\u00a0Phoniebox allows an attacker to create a website, which \u2013 when visited by a user \u2013 will send\u00a0malicious requests to multiple hosts on the local network. If such a request reaches the server, it will cause a\u00a0shell command execution.\n\n\nThis issue affects Phoniebox in all releases through 2.7. Newer 2.x releases were not tested, but they might also be vulnerable. \nPhoniebox in version 3.0 and higher are not affected."}, {"lang": "es", "value": "El manejo inseguro del cuerpo del par\u00e1metro del encabezado POST incluido en las solicitudes que se env\u00edan a una instancia del proyecto de c\u00f3digo abierto Phoniebox permite a un atacante crear un sitio web que, cuando lo visita un usuario, enviar\u00e1 solicitudes maliciosas a m\u00faltiples hosts en la red local. Si dicha solicitud llega al servidor, provocar\u00e1 la ejecuci\u00f3n de un comando de shell. Este problema afecta a Phoniebox en todas las versiones hasta la 2.7. Las versiones m\u00e1s recientes no se probaron, pero tambi\u00e9n podr\u00edan ser vulnerables."}], "metrics": {"cvssMetricV40": [{"source": "cvd@cert.pl", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "attackVector": "NETWORK", "attackComplexity": "LOW", "attackRequirements": "NONE", "privilegesRequired": "NONE", "userInteraction": "PASSIVE", "vulnerableSystemConfidentiality": "HIGH", "vulnerableSystemIntegrity": "HIGH", "vulnerableSystemAvailability": "HIGH", "subsequentSystemConfidentiality": "NONE", "subsequentSystemIntegrity": "NONE", "subsequentSystemAvailability": "NONE", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NOT_DEFINED", "recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED", "baseScore": 8.7, "baseSeverity": "HIGH"}}]}, "weaknesses": [{"source": "cvd@cert.pl", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-78"}]}], "references": [{"url": "https://cert.pl/en/posts/2024/07/CVE-2024-3798", "source": "cvd@cert.pl"}, {"url": "https://cert.pl/posts/2024/07/CVE-2024-3798", "source": "cvd@cert.pl"}, {"url": "https://github.com/MiczFlor/RPi-Jukebox-RFID/issues/2342", "source": "cvd@cert.pl"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-3799 - Insecure handling of POST header parameter body allows an attacker to send malicious requests to multiple hosts on the local network, which can lead to command execution."}, {"techniqueID": "T1190", "comment": "CVE-2024-3799 - The attacker can create a website that, when visited by a user, can send malicious requests to multiple hosts on the local network, which can lead to command execution."}, {"techniqueID": "T1488", "comment": "CVE-2024-3799 - The vulnerability can be exploited by a remote attacker to execute a shell command, which can lead to a range of impacts including data extraction, data destruction, and denial of service attacks."}, {"techniqueID": "T1553", "comment": "CVE-2024-3799 - The vulnerability can be exploited by a remote attacker to execute a shell command, which can lead to a range of impacts including data extraction, data destruction, and denial of service attacks."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "indicator--9fa54b3c-9f2d-4e3f-a87c-745f9a2bf9a1", "created_by_ref": "identity--ad54f6a4-6f7b-45d4-96ef-4da2bf9a4f9a", "modified": "2024-07-18T10:14:03.000Z", "name": "Vulnerable Website", "description": "Website displaying the vulnerable application", "first_seen": "2024-07-10T12:15:10.000Z", "last_seen": "2024-07-15T12:15:10.000Z", "sighting_count": 10, "malware_observed": false, "network_traffic_observed": true, "domain_observed": true, "path": "/phoniebox", "protocol": "HTTP", "destination_ip": "192.168.1.100", "observable_data": "HTTP POST /phoniebox?body=<script>alert(1)</script>"}, {"type": "campaign", "id": "campaign--e51a74f4-9439-47c1-8c85-f6a41e47c6a4", "created_by_ref": "identity--ad54f6a4-6f7b-45d4-96ef-4da2bf9a4f9a", "modified": "2024-07-18T10:14:03.000Z", "name": "Phoniebox Attack", "description": "Campaign exploiting the Phoniebox vulnerability", "first_seen": "2024-07-10T12:15:10.000Z", "last_seen": "2024-07-15T12:15:10.000Z", "sighting_count": 10}, {"type": "course_of_action", "id": "course_of_action--8d42a544-144d-433c-a1e4-3f7e7e2d3bf2", "created_by_ref": "identity--ad54f6a4-6f7b-45d4-96ef-4da2bf9a4f9a", "modified": "2024-07-18T10:14:03.000Z", "name": "Patch and Update", "description": "Patch and update the Phoniebox application to version 2.8 or higher", "course_of_action": "Patch and update the Phoniebox application to version 2.8 or higher"}, {"type": "note", "id": "note--94be45f2-5a89-4523-8e9f-f2e48f3bdf8e", "created_by_ref": "identity--ad54f6a4-6f7b-45d4-96ef-4da2bf9a4f9a", "modified": "2024-07-18T10:14:03.000Z", "name": "Note", "description": "The attacker can use the vulnerability to send malicious requests to multiple hosts on the local network, which can lead to command execution."}], "relations": [{"type": "indicates", "id": "indicates--9fa54b3c-9f2d-4e3f-a87c-745f9a2bf9a1", "from": "indicator--9fa54b3c-9f2d-4e3f-a87c-745f9a2bf9a1", "to": "campaign--e51a74f4-9439-47c1-8c85-f6a41e47c6a4"}, {"type": "uses", "id": "uses--e51a74f4-9439-47c1-8c85-f6a41e47c6a4", "from": "campaign--e51a74f4-9439-47c1-8c85-f6a41e47c6a4", "to": "course_of_action--8d42a544-144d-433c-a1e4-3f7e7e2d3bf2"}, {"type": "contains", "id": "contains--94be45f2-5a89-4523-8e9f-f2e48f3bdf8e", "from": "note--94be45f2-5a89-4523-8e9f-f2e48f3bdf8e", "to": "indicator--9fa54b3c-9f2d-4e3f-a87c-745f9a2bf9a1"}]}, "technical_analysis": {"Introduction": "The CVE-2024-3799 vulnerability in Phoniebox allows an attacker to send malicious requests to multiple hosts on the local network, which can lead to command execution.", "Impact and Scope": "The vulnerability has a CVSS score of 8.7 and allows remote attackers to execute a shell command, which can lead to a range of impacts including data extraction, data destruction, and denial of service attacks.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1059, T1190, T1488, and T1553.", "Technical Details": "The vulnerability is caused by insecure handling of POST header parameter body in the Phoniebox application.", "Detection": "The vulnerability can be detected by monitoring HTTP traffic for suspicious requests to the Phoniebox application.", "Mitigation": "The vulnerability can be mitigated by patching and updating the Phoniebox application to version 2.8 or higher.", "Conclusion": "In summary, the CVE-2024-3799 vulnerability in Phoniebox allows remote attackers to execute a shell command, which can lead to a range of impacts including data extraction, data destruction, and denial of service attacks."}, "executive_analysis": {"Overview": "The CVE-2024-3799 vulnerability in Phoniebox is a critical security risk that allows remote attackers to execute a shell command, which can lead to a range of impacts including data extraction, data destruction, and denial of service attacks.", "Business Impact": "The vulnerability can have a significant business impact, including data breaches, system downtime, and reputational damage.", "Technical Impact": "The vulnerability can have a significant technical impact, including the ability to execute arbitrary commands on affected systems.", "Mitigation Strategies": "The vulnerability can be mitigated by patching and updating the Phoniebox application to version 2.8 or higher, as well as implementing additional security measures such as firewalls and intrusion detection systems.", "Recommendations": "We recommend that all organizations using Phoniebox patch and update their applications as soon as possible, and also implement additional security measures to detect and prevent future attacks.", "Conclusions": "In conclusion, the CVE-2024-3799 vulnerability in Phoniebox is a critical security risk that requires immediate attention and action to mitigate the potential impacts."}}