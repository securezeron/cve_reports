{"id": "CVE-2015-8351", "sourceIdentifier": "cve@mitre.org", "published": "2017-09-11T20:29:00.457", "lastModified": "2018-10-09T19:58:25.503", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHP remote file inclusion vulnerability in the Gwolle Guestbook plugin before 1.5.4 for WordPress, when allow_url_include is enabled, allows remote authenticated users to execute arbitrary PHP code via a URL in the abspath parameter to frontend/captcha/ajaxresponse.php.  NOTE: this can also be leveraged to include and execute arbitrary local files via directory traversal sequences regardless of whether allow_url_include is enabled."}, {"lang": "es", "value": "Una vulnerabilidad de inclusi\u00f3n de archivo remoto PHP en el plugin Gwolle Guestbook en versiones anteriores a la 1.5.4 para WordPress, cuando allow_url_include est\u00e1 activado, permite a usuarios autenticados remotos ejecutar c\u00f3digo PHP arbitrario mediante una URL en el par\u00e1metro abspath en frontend/captcha/ajaxresponse.php. NOTA: esto se puede utilizar para incluir y ejecutar archivos locales arbitrarios mediante secuencias de salto de directorio independientemente de si allow_url_include est\u00e1 activado o no."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.2, "impactScore": 6.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gwolle_guestbook_project:gwolle_guestbook:*:*:*:*:*:wordpress:*:*", "versionEndIncluding": "1.5.3", "matchCriteriaId": "59D30F9D-FFB1-4083-9D80-DFBDB70A6504"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/134599/WordPress-Gwolle-Guestbook-1.5.3-Remote-File-Inclusion.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securityfocus.com/archive/1/537020/100/0/threaded", "source": "cve@mitre.org"}, {"url": "https://wordpress.org/plugins/gwolle-gb/changelog/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.exploit-db.com/exploits/38861/", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://www.htbridge.com/advisory/HTB23275", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2015-8351 - This technique is used to exploit the PHP remote file inclusion vulnerability, allowing an attacker to execute arbitrary PHP code. To defend against this, enable 'allow_url_include' only when necessary and ensure the file upload functionality is properly sanitized."}, {"techniqueID": "T1086", "comment": "CVE-2015-8351 - This technique is used to add the Web Server (IIS, Apache, etc.) to the attack chain. To defend against this, ensure your web server is configured to restrict access to sensitive directories and files."}, {"techniqueID": "T1036", "comment": "CVE-2015-8351 - This technique is used to perform a Command and Control session. To defend against this, monitor your network traffic and logs for suspicious communication with command and control servers."}, {"techniqueID": "TA0008", "comment": "CVE-2015-8351 - This technique is used to execute a payload. To defend against this, use Web Application Firewalls (WAFs) and Input Validation and Sanitization (IVS) to prevent malicious input."}], "stix_bundle": {"@stix": {"version": "2.1"}, "main_bundle": {"@stix_bundle": {"id": "stix_bundle_1", "title": "CVE-2015-8351 Bundle"}, "objects": {"vulnerability": {"id": "vuln-1", "title": "CVE-2015-8351", "description": [{"lang": "en", "value": "A PHP remote file inclusion vulnerability exists in the Gwolle Guestbook plugin before 1.5.4 for WordPress, when allow_url_include is enabled, allowing remote authenticated users to execute arbitrary PHP code via a URL in the abspath parameter to frontend/captcha/ajaxresponse.php."}]}, "threat_actor": {"id": "actor-1", "title": "Malicious Actors"}, "course_of_action": {"id": "coa-2", "title": "Use Input Validation and Sanitization (IVS)", "description": [{"lang": "en", "value": "Using IVS can help prevent malicious input from being processed by the web application."}]}, "indicator": {"id": "ind-2", "title": "Unusual File Uploads", "description": [{"lang": "en", "value": "Monitor for unusual file uploads that may be used to exploit the vulnerability."}]}}}}, "technical_analysis": {"Introduction": "The CVE-2015-8351 is a remote file inclusion vulnerability in the Gwolle Guestbook plugin for WordPress, which allows remote authenticated users to execute arbitrary PHP code.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 9.0 and an attack vector of NETWORK. It affects all versions of the Gwolle Guestbook plugin before 1.5.4.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190, T1086, T1036, and TA0008.", "Technical Details": "The vulnerability occurs when allow_url_include is enabled in the plugin, allowing an attacker to include and execute arbitrary PHP files.", "Detection": "Detection can be performed by monitoring for suspicious network traffic and logs, and monitoring for unusual file uploads.", "Mitigation": "Mitigation strategies include enabling 'allow_url_include' only when necessary, using input validation and sanitization, and implementing web application firewalls.", "Conclusion": "In conclusion, this vulnerability is a high-risk threat that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2015-8351 is a critical vulnerability in the Gwolle Guestbook plugin for WordPress that allows remote authenticated users to execute arbitrary PHP code.", "Business Impact": "The impact of this vulnerability is high, with the potential for significant business disruption and reputational damage.", "Technical Impact": "The technical impact is also high, with the potential for unauthorized access to sensitive data and systems.", "Mitigation Strategies": "Mitigation strategies include enabling 'allow_url_include' only when necessary, using input validation and sanitization, and implementing web application firewalls.", "Recommendations": "We recommend that all organizations with the affected plugin implement these mitigation strategies as soon as possible.", "Conclusions": "In conclusion, all organizations must take immediate action to protect themselves from this vulnerability."}}