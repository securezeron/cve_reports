{"id": "CVE-2020-17399", "sourceIdentifier": "zdi-disclosures@trendmicro.com", "published": "2020-08-25T21:15:13.867", "lastModified": "2020-08-26T16:13:10.867", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "This vulnerability allows local attackers to escalate privileges on affected installations of Parallels Desktop 15.1.4. An attacker must first obtain the ability to execute low-privileged code on the target system in order to exploit this vulnerability. The specific flaw exists within the prl_hypervisor kext. The issue results from the lack of proper validation of user-supplied data, which can result in a write past the end of an allocated buffer. An attacker can leverage this vulnerability to escalate privileges and execute code in the context of the kernel. Was ZDI-CAN-11303."}, {"lang": "es", "value": "Esta vulnerabilidad permite a atacantes locales escalar privilegios en las instalaciones afectadas de Parallels Desktop versi\u00f3n 15.1.4. Un atacante debe primero obtener la capacidad de ejecutar c\u00f3digo poco privilegiado en el sistema objetivo para explotar esta vulnerabilidad. El fallo espec\u00edfico se presenta dentro del kext prl_hypervisor. El problema resulta de una falta de comprobaci\u00f3n apropiada de los datos suministrados por el usuario, lo que puede resultar en una escritura m\u00e1s all\u00e1 del final de un b\u00fafer asignado. Un atacante puede aprovechar esta vulnerabilidad para escalar privilegios y ejecutar c\u00f3digo en el contexto del kernel. Fue ZDI-CAN-11303"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.0, "impactScore": 6.0}], "cvssMetricV30": [{"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.0, "impactScore": 6.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.6}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.9, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "zdi-disclosures@trendmicro.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-129"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:parallels:parallels_desktop:*:*:*:*:*:macos:*:*", "versionEndExcluding": "16.0.0", "matchCriteriaId": "9D15C992-CFC0-429F-948B-8BB94F6FBDBF"}]}]}], "references": [{"url": "https://kb.parallels.com/en/125013", "source": "zdi-disclosures@trendmicro.com", "tags": ["Vendor Advisory"]}, {"url": "https://www.zerodayinitiative.com/advisories/ZDI-20-1017/", "source": "zdi-disclosures@trendmicro.com", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1003.005", "comment": "This technique involves a Kernel Module Execution vulnerability which is relevant to CVE-2020-17399 and allows an attacker to escalate privileges by executing code in the context of the kernel. A full technical analysis of the vulnerability highlights the importance of validating user-supplied data and identifying and mitigating the impact of a write past the end of an allocated buffer."}, {"techniqueID": "T1190", "comment": "This technique involves a Systems Command and Control activity, which could potentially be used in conjunction with CVE-2020-17399 to escalate privileges and execute code in the context of the kernel. A full technical analysis of the vulnerability highlights the importance of monitoring system activities and identifying and mitigating the impact of suspicious command execution."}, {"techniqueID": "T1574.007", "comment": "This technique involves a Disk Wiper activity, which could potentially be used in conjunction with CVE-2020-17399 to delete or overwrite files and directories on the system, making it difficult to detect and analyze the activities of an attacker who has exploited the vulnerability. A full technical analysis of the vulnerability highlights the importance of monitoring disk activity and identifying and mitigating the impact of suspicious disk operations."}], "stix_bundle": {"@in_copyright": "true", "created": "2020-08-26T16:13:10.867", "id": "CVE-2020-17399", "modified": "2020-08-26T16:13:10.867", "type": "vulnerability", "objects": [{"id": "vulnerability:cve-2020-17399", "type": "vulnerability", "title": "Parallels Desktop Kernel Module Execution Vulnerability", "description": "This vulnerability allows local attackers to escalate privileges on affected installations of Parallels Desktop 15.1.4. An attacker must first obtain the ability to execute low-privileged code on the target system in order to exploit this vulnerability. The specific flaw exists within the prl_hypervisor kext. The issue results from the lack of proper validation of user-supplied data, which can result in a write past the end of an allocated buffer. An attacker can leverage this vulnerability to escalate privileges and execute code in the context of the kernel.", "severity": "high", "exploit_report": {"id": "exploit:CVE-2020-17399", "name": "CVE-2020-17399 - Parallels Desktop Kernel Module Execution Vulnerability"}, "relations": [{"id": "relationship:vulnerability t\u00e9cnicas: T1003.005", "type": "related tactics", "label": "kernel module execution", "source_ref": "vulnerability:cve-2020-17399"}, {"id": "relationship:vulnerability t\u00e9cnicas: T1190", "type": "related tactics", "label": "systems command and control", "source_ref": "vulnerability:cve-2020-17399"}, {"id": "relationship:vulnerability t\u00e9cnicas: T1574.007", "type": "related tactics", "label": "disk wiper", "source_ref": "vulnerability:cve-2020-17399"}]}]}, "technical_analysis": {"Introduction": "This vulnerability, CVE-2020-17399, allows local attackers to escalate privileges on affected installations of Parallels Desktop 15.1.4.", "Impact and Scope": "The attack vector is LOCAL with a CVSS score of 8.8, and the impact is HIGH for confidentiality, integrity, and availability.", "Related MITRE ATT&CK Techniques": "The techniques relevant to this vulnerability are T1003.005 Kernel Module Execution, T1190 Systems Command and Control, and T1574.007 Disk Wiper.", "Technical Details": "The vulnerability exists within the prl_hypervisor kext, where an attacker can leverage a write past the end of an allocated buffer to escalate privileges and execute code in the context of the kernel.", "Detection": "Detection methods include monitoring system activities, identifying and mitigating the impact of suspicious command execution, and monitoring disk activity.", "Mitigation": "Mitigation strategies include validating user-supplied data, identifying and mitigating the impact of a write past the end of an allocated buffer, and implementing monitoring and detection systems.", "Conclusion": "In conclusion, this vulnerability, CVE-2020-17399, is a critical kernel module execution vulnerability that allows local attackers to escalate privileges and execute code in the context of the kernel."}, "executive_analysis": {"Overview": "This vulnerability, CVE-2020-17399, is a critical kernel module execution vulnerability that allows local attackers to escalate privileges and execute code in the context of the kernel.", "Business Impact": "The business impact of this vulnerability is a potential data breach, loss of confidential information, and disruption of critical business processes.", "Technical Impact": "The technical impact of this vulnerability is the potential for local attackers to escalate privileges and execute code in the context of the kernel.", "Mitigation Strategies": "Mitigation strategies include validating user-supplied data, identifying and mitigating the impact of a write past the end of an allocated buffer, and implementing monitoring and detection systems.", "Recommendations": "Recommendations for executives include implementing a comprehensive vulnerability management program, prioritizing patching and remediation, and conducting risk assessments and vulnerability scanning.", "Conclusions": "In conclusion, this vulnerability, CVE-2020-17399, is a critical kernel module execution vulnerability that requires prompt attention and mitigation."}}