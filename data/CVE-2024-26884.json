{"id": "CVE-2024-26884", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-17T11:15:10.163", "lastModified": "2024-06-27T12:15:22.003", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Fix hashtab overflow check on 32-bit arches\n\nThe hashtab code relies on roundup_pow_of_two() to compute the number of\nhash buckets, and contains an overflow check by checking if the\nresulting value is 0. However, on 32-bit arches, the roundup code itself\ncan overflow by doing a 32-bit left-shift of an unsigned long value,\nwhich is undefined behaviour, so it is not guaranteed to truncate\nneatly. This was triggered by syzbot on the DEVMAP_HASH type, which\ncontains the same check, copied from the hashtab code. So apply the same\nfix to hashtab, by moving the overflow check to before the roundup."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: bpf: corrige la comprobaci\u00f3n de desbordamiento de hashtab en arcos de 32 bits. El c\u00f3digo hashtab se basa en roundup_pow_of_two() para calcular el n\u00famero de dep\u00f3sitos de hash y contiene una comprobaci\u00f3n de desbordamiento comprobando si el valor resultante es 0. Sin embargo, en arcos de 32 bits, el c\u00f3digo de resumen en s\u00ed puede desbordarse al realizar un desplazamiento hacia la izquierda de 32 bits de un valor largo sin signo, lo cual es un comportamiento indefinido, por lo que no se garantiza que se trunque claramente. Esto fue activado por syzbot en el tipo DEVMAP_HASH, que contiene la misma verificaci\u00f3n, copiada del c\u00f3digo hashtab. As\u00ed que aplique la misma soluci\u00f3n a hashtab, moviendo la verificaci\u00f3n de desbordamiento antes del resumen."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.19", "versionEndExcluding": "4.19.311", "matchCriteriaId": "C9353029-6F28-43DF-8371-7310CB2489D0"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.20", "versionEndExcluding": "5.4.273", "matchCriteriaId": "620FD8B7-BF03-43E0-951A-0A58461D4C55"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.5", "versionEndExcluding": "5.10.214", "matchCriteriaId": "65987874-467B-4D3B-91D6-68A129B34FB8"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.11", "versionEndExcluding": "5.15.153", "matchCriteriaId": "ACB69438-845D-4E3C-B114-3140611F9C0B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.16", "versionEndExcluding": "6.1.83", "matchCriteriaId": "121A07F6-F505-4C47-86BF-9BB6CC7B6C19"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2", "versionEndExcluding": "6.6.23", "matchCriteriaId": "E00814DC-0BA7-431A-9926-80FEB4A96C68"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.7.11", "matchCriteriaId": "9B95D3A6-E162-47D5-ABFC-F3FA74FA7CFD"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.8", "versionEndExcluding": "6.8.2", "matchCriteriaId": "543A75FF-25B8-4046-A514-1EA8EDD87AB1"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/33ec04cadb77605b71d9298311919303d390c4d5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/3b08cfc65f07b1132c1979d73f014ae6e04de55d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/64f00b4df0597590b199b62a37a165473bf658a6", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/6787d916c2cf9850c97a0a3f73e08c43e7d973b1", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/8435f0961bf3dc65e204094349bd9aeaac1f8868", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/92c81fbb3ed2e0dfc33a4183a67135e1ab566ace", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/a6fa75b5096c0f9826a4fabe22d907b0a5bb1016", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/a83fdaeaea3677b83a53f72ace2d73a19bcd6d93", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/d817f0d34d927f2deb17dadbfe212c9a6a32ac3e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA0008: Initial Access", "comment": "CVE-2024-26884 - An attacker may use this vulnerability to gain initial access to a system, which could be used to further exploit the system and gain additional access levels. This technique could be used in combination with other techniques to achieve a successful attack."}, {"techniqueID": "TA0007: Command and Control", "comment": "CVE-2024-26884 - An attacker may use this vulnerability to establish command and control communications with the compromised system, which could be used to issue commands and exfiltrate data. This technique could be used in combination with other techniques to achieve a successful attack."}, {"techniqueID": "TA0002: Execution", "comment": "CVE-2024-26884 - An attacker may use this vulnerability to execute arbitrary code on a system, which could be used to gain additional access levels, install additional malware, or conduct further attacks. This technique could be used in combination with other techniques to achieve a successful attack."}], "stix_bundle": {"bundleInfo": {"specVersion": "2.1", "bundleId": "CVE-2024-26884", "title": "CVE-2024-26884 Linux Kernel Hashtab Overflow", "description": "This STIX 2.1 bundle describes the vulnerability CVE-2024-26884 in the Linux kernel hashtab code.", "created": "2024-07-15T12:00:00.000Z", "modified": "2024-07-15T12:00:00.000Z"}, "objects": [{"type": "vulnerability", "id": "CVE-2024-26884", "name": "CVE-2024-26884 Linux Kernel Hashtab Overflow", "description": "In the Linux kernel, the hashtab code relies on roundup_pow_of_two() to compute the number of hash buckets, and contains an overflow check by checking if the resulting value is 0. However, on 32-bit arches, the roundup code itself can overflow by doing a 32-bit left-shift of an unsigned long value, which is undefined behaviour, so it is not guaranteed to truncate neatly.", "score": 7.8, "cvssV3": {"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}}, {"type": "course-of-action", "id": "COA-1", "name": "Apply the patch", "description": "Apply the patch provided by the Linux kernel developers to fix the hashtab overflow vulnerability.", "mitigates": {"vulnerability": "CVE-2024-26884"}}, {"type": "course-of-action", "id": "COA-2", "name": "Disable the hashtab feature", "description": "Disable the hashtab feature in the Linux kernel configuration to avoid using the vulnerable code.", "mitigates": {"vulnerability": "CVE-2024-26884"}}], "relationships": [{"source": "CVE-2024-26884", "relationship": "mitigated-by", "target": "COA-1"}, {"source": "CVE-2024-26884", "relationship": "mitigated-by", "target": "COA-2"}]}, "technical_analysis": {"Introduction": "CVE-2024-26884 is a vulnerability in the Linux kernel hashtab code that allows an attacker to cause a buffer overflow. This vulnerability is caused by the use of an unsigned integer in the hashtab code, which can cause the code to overflow and potentially lead to code execution.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to execute arbitrary code on a system. The scope of this vulnerability is also high, as it affects systems running Linux kernels prior to version 4.19.311.", "Related MITRE ATT&CK Techniques": "TA0008: Initial Access, TA0007: Command and Control, TA0002: Execution", "Technical Details": "The vulnerability is caused by the use of the `roundup_pow_of_two()` function in the hashtab code. This function takes an unsigned integer as input and returns the power of two of that integer. However, if the input integer is greater than the maximum value of an unsigned long, the function can overflow and potentially lead to code execution.", "Detection": "To detect this vulnerability, system administrators can use tools such as `find` and `grep` to search for the presence of the vulnerable code in the Linux kernel.", "Mitigation": "To mitigate this vulnerability, system administrators can apply the patch provided by the Linux kernel developers. They can also disable the hashtab feature in the Linux kernel configuration.", "Conclusion": "In conclusion, CVE-2024-26884 is a serious vulnerability in the Linux kernel hashtab code. It allows an attacker to execute arbitrary code on a system and has a high impact and scope. System administrators should apply the patch provided by the Linux kernel developers and disable the hashtab feature in the Linux kernel configuration to mitigate this vulnerability."}, "executive_analysis": {"Overview": "CVE-2024-26884 is a vulnerability in the Linux kernel hashtab code that allows an attacker to execute arbitrary code on a system.", "Business Impact": "The business impact of this vulnerability is high, as it allows an attacker to compromise sensitive data and disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is also high, as it allows an attacker to execute arbitrary code on a system and gain additional access levels.", "Mitigation Strategies": "System administrators should apply the patch provided by the Linux kernel developers and disable the hashtab feature in the Linux kernel configuration to mitigate this vulnerability.", "Recommendations": "System administrators should also consider implementing additional security measures, such as intrusion detection and prevention systems, to detect and prevent attacks.", "Conclusions": "In conclusion, CVE-2024-26884 is a serious vulnerability in the Linux kernel hashtab code. System administrators should apply the patch provided by the Linux kernel developers and disable the hashtab feature in the Linux kernel configuration to mitigate this vulnerability."}}