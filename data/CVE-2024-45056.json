{"id": "CVE-2024-45056", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-29T17:15:09.173", "lastModified": "2024-09-03T15:14:54.877", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "zksolc is a Solidity compiler for ZKsync. All LLVM versions since 2015 fold `(xor (shl 1, x), -1)` to `(rotl ~1, x)` if run with optimizations enabled. Here `~1` is generated as an unsigned 64 bits number (`2^64-1`). This number is zero-extended to 256 bits on EraVM target while it should have been sign-extended. Thus instead of producing `roti 2^256 - 1, x` the compiler produces `rotl 2^64 - 1, x`. Analysis has shown that no contracts were affected by the date of publishing this advisory. This issue has been addressed in version 1.5.3. Users are advised to upgrade and redeploy all contracts. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "zksolc es un compilador de Solidity para ZKsync. Todas las versiones de LLVM desde 2015 convierten `(xor (shl 1, x), -1)` en `(rotl ~1, x)` si se ejecutan con optimizaciones habilitadas. Aqu\u00ed, `~1` se genera como un n\u00famero de 64 bits sin signo (`2^64-1`). Este n\u00famero se extiende a 256 bits en el destino EraVM, mientras que deber\u00eda haberse extendido a signo. Por lo tanto, en lugar de producir `roti 2^256 - 1, x`, el compilador produce `rotl 2^64 - 1, x`. El an\u00e1lisis ha demostrado que ning\u00fan contrato se vio afectado a la fecha de publicaci\u00f3n de este aviso. Este problema se ha solucionado en la versi\u00f3n 1.5.3. Se recomienda a los usuarios que actualicen y vuelvan a implementar todos los contratos. No existen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.2, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.2, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-682"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-682"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:matter-labs:zksolc:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.5.3", "matchCriteriaId": "6C6C5C19-A23C-4059-AD36-CECE6B08C936"}]}]}], "references": [{"url": "https://github.com/llvm/llvm-project/commit/e48237df95b49a36b8ffceb78c8a58f4be1b4344", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/matter-labs/era-compiler-solidity/security/advisories/GHSA-fpx7-8vc6-frjj", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-45056 - This vulnerability can be exploited using a Lateral Movement technique, allowing attackers to move laterally within the network with the potential to gain access to sensitive information."}, {"techniqueID": "T1027", "comment": "CVE-2024-45056 - This vulnerability can be exploited using a File and Directory Discovery technique, allowing attackers to gather information about the network and potentially identify vulnerabilities."}, {"techniqueID": "T1210", "comment": "CVE-2024-45056 - This vulnerability can be exploited using a Exploitation of Removable Storage technique, allowing attackers to exploit removable storage devices."}], "stix_bundle": {"tzolmis_bundle": {"type": "bundle", "spec_version": "2.1", "id": "tzolmis_bundle_CVE-2024-45056", "created_by_ref": "https://github.com/yourgithubusername", "created": "2024-09-03T15:14:54.877", "modified": "2024-09-03T15:14:54.877", "title": "CVE-2024-45056 Zksolc Vulnerability", "description": "This bundle represents the CVE-2024-45056 vulnerability in Zksolc, a Solidity compiler for ZKsync. It includes vulnerability details, related MITRE ATT&CK techniques, and defense strategies.", "objects": [{"id": "TZOLmis_Object_1", "type": "vulnerability", "created_by_ref": "https://github.com/yourgithubusername", "created": "2024-09-03T15:14:54.877", "modified": "2024-09-03T15:14:54.877", "title": "CVE-2024-45056 Zksolc Vulnerability", "description": "This vulnerability is a CWE-682 issue in Zksolc, a Solidity compiler for ZKsync. It allows attackers to exploit removable storage devices.", "exploit_count": 2, "reporting_org_ref": "https://github.com/llvm/llvm-project", "references": [{"source_name": "security-advisories@github.com", "external_id": "GHSA-fpx7-8vc6-frjj", "url": "https://github.com/llvm/llvm-project/commit/e48237df95b49a36b8ffceb78c8a58f4be1b4344"}]}, {"id": "TZOLmis_Object_2", "type": "attack-pattern", "created_by_ref": "https://github.com/yourgithubusername", "created": "2024-09-03T15:14:54.877", "modified": "2024-09-03T15:14:54.877", "title": "T1190 Lateral Movement", "description": "This attack pattern represents the Lateral Movement technique, which allows attackers to move laterally within the network with the potential to gain access to sensitive information.", "kill_chain_name": "mitre_attck", "kill_chain_phase": "Initial Access", "external_references": [{"source_name": "mitre", "external_id": "T1190"}]}, {"id": "TZOLmis_Object_3", "type": "course-of-action", "created_by_ref": "https://github.com/yourgithubusername", "created": "2024-09-03T15:14:54.877", "modified": "2024-09-03T15:14:54.877", "title": "Upgrade and Re-deploy Contracts", "description": "Users are advised to upgrade and re-deploy all contracts to address this vulnerability.", "mitigates": "TZOLmis_Object_1"}], "relationships": [{"id": "rel_1", "type": "caused-by", "source_ref": "TZOLmis_Object_1", "target_ref": "TZOLmis_Object_3"}, {"id": "rel_2", "type": "uses", "source_ref": "TZOLmis_Object_2", "target_ref": "TZOLmis_Object_1"}]}}, "technical_analysis": {"Introduction": "CVE-2024-45056 is a CWE-682 issue in Zksolc, a Solidity compiler for ZKsync. It allows attackers to exploit removable storage devices.", "Impact and Scope": "The vulnerability has a CVSS score of 5.9 and affects all LLVM versions since 2015. It allows attackers to gain access to sensitive information and has a high integrity impact.", "Related MITRE ATT&CK Techniques": "T1190 Lateral Movement, T1027 File and Directory Discovery, T1210 Exploitation of Removable Storage", "Technical Details": "The vulnerability occurs when the compiler generates a zero-extended 64-bit number for the EraVM target, instead of sign-extended.", "Detection": "Detection methods include monitoring network traffic for suspicious activity and analyzing system logs for evidence of exploitation.", "Mitigation": "Mitigation strategies include upgrading and re-deploying contracts, monitoring network traffic, and analyzing system logs.", "Conclusion": "CVE-2024-45056 is a serious vulnerability that requires immediate attention from system administrators and developers."}, "executive_analysis": {"Overview": "CVE-2024-45056 is a serious vulnerability in Zksolc that allows attackers to exploit removable storage devices.", "Business Impact": "The vulnerability has a high business impact, as it could allow attackers to gain access to sensitive information and disrupt business operations.", "Technical Impact": "The vulnerability has a high technical impact, as it exploits a weakness in the compiler and could allow attackers to execute arbitrary code.", "Mitigation Strategies": "Upgrade and re-deploy contracts, monitor network traffic, and analyze system logs.", "Recommendations": "Implement mitigation strategies, perform regular security audits, and provide employee training on security best practices.", "Conclusions": "CVE-2024-45056 is a serious vulnerability that requires immediate attention from system administrators and developers."}}