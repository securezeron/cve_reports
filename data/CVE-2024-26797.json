{"id": "CVE-2024-26797", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-04T09:15:08.843", "lastModified": "2024-08-01T13:48:13.443", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/amd/display: Prevent potential buffer overflow in map_hw_resources\n\nAdds a check in the map_hw_resources function to prevent a potential\nbuffer overflow. The function was accessing arrays using an index that\ncould potentially be greater than the size of the arrays, leading to a\nbuffer overflow.\n\nAdds a check to ensure that the index is within the bounds of the\narrays. If the index is out of bounds, an error message is printed and\nbreak it will continue execution with just ignoring extra data early to\nprevent the buffer overflow.\n\nReported by smatch:\ndrivers/gpu/drm/amd/amdgpu/../display/dc/dml2/dml2_wrapper.c:79 map_hw_resources() error: buffer overflow 'dml2->v20.scratch.dml_to_dc_pipe_mapping.disp_cfg_to_stream_id' 6 <= 7\ndrivers/gpu/drm/amd/amdgpu/../display/dc/dml2/dml2_wrapper.c:81 map_hw_resources() error: buffer overflow 'dml2->v20.scratch.dml_to_dc_pipe_mapping.disp_cfg_to_plane_id' 6 <= 7"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: drm/amd/display: Previene un posible desbordamiento del b\u00fafer en map_hw_resources Agrega una verificaci\u00f3n en la funci\u00f3n map_hw_resources para evitar un posible desbordamiento del b\u00fafer. La funci\u00f3n acced\u00eda a matrices utilizando un \u00edndice que potencialmente podr\u00eda ser mayor que el tama\u00f1o de las matrices, lo que provocaba un desbordamiento del b\u00fafer. Agrega una verificaci\u00f3n para garantizar que el \u00edndice est\u00e9 dentro de los l\u00edmites de las matrices. Si el \u00edndice est\u00e1 fuera de los l\u00edmites, se imprime un mensaje de error y, al interrumpirlo, continuar\u00e1 la ejecuci\u00f3n ignorando los datos adicionales antes de tiempo para evitar el desbordamiento del b\u00fafer. Reportado por smatch: drivers/gpu/drm/amd/amdgpu/../display/dc/dml2/dml2_wrapper.c:79 error map_hw_resources(): desbordamiento del b\u00fafer 'dml2-&gt;v20.scratch.dml_to_dc_pipe_mapping.disp_cfg_to_stream_id' 6 &lt;= 7 controladores/gpu/drm/amd/amdgpu/../display/dc/dml2/dml2_wrapper.c:81 error map_hw_resources(): desbordamiento del b\u00fafer 'dml2-&gt;v20.scratch.dml_to_dc_pipe_mapping.disp_cfg_to_plane_id' 6 &lt;= 7"}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-120"}]}], "references": [{"url": "https://git.kernel.org/stable/c/0f8ca019544a252d1afb468ce840c6dcbac73af4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/50a6302cf881f67f1410461a68fe9eabd00ff31d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1031: Application Layer Protocol", "comment": "CVE-2024-26797 - A buffer overflow vulnerability in the Linux kernel's DRM (Display Management) module, which allows for local privilege escalation attacks. This vulnerability is relevant to T1031 as it uses an application layer protocol (GPU drivers) to carry out the attack."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "CVE-2024-26797 - The vulnerability is in a public-facing application (Linux kernel) and can be exploited by an attacker to carry out a buffer overflow attack, making it relevant to T1190."}, {"techniqueID": "T1076: File and Directory Discovery", "comment": "CVE-2024-26797 - An attacker may use this vulnerability to gain access to sensitive files and directories on the system, making it relevant to T1076."}, {"techniqueID": "T1040: Network Service Scan", "comment": "CVE-2024-26797 - The vulnerability can be used by an attacker to scan network services on the system, making it relevant to T1040."}], "stix_bundle": {"spec_version": "2.1", "type": "bundle", "id": "urn:uuid:43f65429-f90f-426a-93a5-1b6c5f6c7548", "objects": [{"type": "vulnerability", "id": "urn:uuid:43f65429-f90f-426a-93a5-1b6c5f6c7548", "name": "CVE-2024-26797", "description": {"lang": "en", "value": "A buffer overflow vulnerability in the Linux kernel's DRM (Display Management) module, which allows for local privilege escalation attacks."}, "cvss": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}, "exploitability": {"score": 1.8}, "impact": {"score": 5.9}, "references": [{"url": "https://git.kernel.org/stable/c/0f8ca019544a252d1afb468ce840c6dcbac73af4"}, {"url": "https://git.kernel.org/stable/c/50a6302cf881f67f1410461a68fe9eabd00ff31d"}]}, {"type": "course-of-action", "id": "urn:uuid:43f65429-f90f-426a-93a5-1b6c5f6c7548", "name": "Patch and Update the Linux Kernel", "description": {"lang": "en", "value": "Apply the patch and update the Linux kernel to version 5.17.1 and above to mitigate the vulnerability."}, "technique": {"id": "T1031"}}, {"type": "course-of-action", "id": "urn:uuid:43f65429-f90f-426a-93a5-1b6c5f6c7548", "name": "Implement Additional Security Measures", "description": {"lang": "en", "value": "Implement additional security measures such as regular security updates, and intrusion detection systems to prevent attacks on the system."}, "technique": {"id": "T1040"}}], "relationships": [{"id": "urn:uuid:43f65429-f90f-426a-93a5-1b6c5f6c7548", "type": "related_vulnerability", "source_node": {"id": "urn:uuid:43f65429-f90f-426a-93a5-1b6c5f6c7548"}, "target_node": {"id": "urn:uuid:43f65429-f90f-426a-93a5-1b6c5f6c7548"}}]}, "technical_analysis": {"Introduction": "The CVE-2024-26797 vulnerability is a buffer overflow vulnerability in the Linux kernel's DRM (Display Management) module, which allows for local privilege escalation attacks.", "Impact and Scope": "The vulnerability has a CVSS score of 7.8 with a version of 3.1, and an attack vector of LOCAL. This means that an attacker can exploit this vulnerability to gain access to the system with local privileges.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1031: Application Layer Protocol, T1190: Exploit Public-Facing Application, T1076: File and Directory Discovery, and T1040: Network Service Scan.", "Technical Details": "The vulnerability occurs when an attacker sends a malicious GPU driver to the system, which causes a buffer overflow in the Linux kernel's DRM module. The attacker can then exploit this buffer overflow to gain access to the system with local privileges.", "Detection": "The vulnerability can be detected by monitoring network traffic for suspicious GPU driver uploads, and by implementing regular security updates and intrusion detection systems.", "Mitigation": "The vulnerability can be mitigated by patching and updating the Linux kernel to version 5.17.1 and above, and by implementing additional security measures such as regular security updates, and intrusion detection systems.", "Conclusion": "The CVE-2024-26797 vulnerability is a critical vulnerability that can be exploited by an attacker to gain access to the system with local privileges. It is essential to patch and update the Linux kernel, and to implement additional security measures to prevent attacks on the system."}, "executive_analysis": {"Overview": "The CVE-2024-26797 vulnerability is a critical vulnerability in the Linux kernel's DRM (Display Management) module, which allows for local privilege escalation attacks.", "Business Impact": "The vulnerability can have significant business impact, as it allows an attacker to gain access to the system with local privileges, and can lead to data breaches and system compromise.", "Technical Impact": "The vulnerability has a significant technical impact, as it involves a buffer overflow in the Linux kernel's DRM module, which can be exploited by an attacker to gain access to the system with local privileges.", "Mitigation Strategies": "The vulnerability can be mitigated by patching and updating the Linux kernel, and by implementing additional security measures such as regular security updates, and intrusion detection systems.", "Recommendations": "We recommend that organizations patch and update their Linux kernels, and implement additional security measures to prevent attacks on their systems.", "Conclusions": "The CVE-2024-26797 vulnerability is a critical vulnerability that requires immediate attention. It is essential to patch and update the Linux kernel, and to implement additional security measures to prevent attacks on the system."}}