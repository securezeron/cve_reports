{"id": "CVE-2024-1626", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-16T00:15:09.777", "lastModified": "2024-04-16T13:24:07.103", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "An Insecure Direct Object Reference (IDOR) vulnerability exists in the lunary-ai/lunary repository, version 0.3.0, within the project update endpoint. The vulnerability allows authenticated users to modify the name of any project within the system without proper authorization checks, by directly referencing the project's ID in the PATCH request to the '/v1/projects/:projectId' endpoint. This issue arises because the endpoint does not verify if the provided project ID belongs to the currently authenticated user, enabling unauthorized modifications across different organizational projects."}, {"lang": "es", "value": "Existe una vulnerabilidad de referencia directa a objetos inseguros (IDOR) en el repositorio lunary-ai/lunary, versi\u00f3n 0.3.0, dentro del endpoint de actualizaci\u00f3n del proyecto. La vulnerabilidad permite a los usuarios autenticados modificar el nombre de cualquier proyecto dentro del sistema sin las comprobaciones de autorizaci\u00f3n adecuadas, haciendo referencia directamente al ID del proyecto en la solicitud PATCH al endpoint '/v1/projects/:projectId'. Este problema surge porque el endpoint no verifica si el ID del proyecto proporcionado pertenece al usuario actualmente autenticado, lo que permite modificaciones no autorizadas en diferentes proyectos organizacionales."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-250"}]}], "references": [{"url": "https://github.com/lunary-ai/lunary/commit/9eb9e526edff8bf82ae032f7a04867c8d58572bc", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/ccc291db-ae9c-403c-b6b5-6fe3f4800933", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1037.004", "comment": "CVE-2024-1626 - The 'Insecure Direct Object Reference' technique allows an authenticated actor to manipulate data without authorization. This can be mitigated by enforcing proper access control and validation of user input."}, {"techniqueID": "T1555.007", "comment": "CVE-2024-1626 - The 'Command and Control - Custom Command and Control Structure' technique can be used to remotely control the affected system. This can be mitigated by implementing robust security controls and monitoring systems."}, {"techniqueID": "T1204.001", "comment": "CVE-2024-1626 - The 'File and Directory Discovery' technique can be used to gather information about the affected system. This can be mitigated by implementing robust security controls and monitoring systems."}], "stix_bundle": "{\"spec_version\":\"2.1\",\"type\":\"bundle\",\"objects\":{\n    \"vulnerability\":{\n      \"id\":\"CVE-2024-1626\",\n      \"type\":\"vulnerability\",\n      \"description\":\"An Insecure Direct Object Reference (IDOR) vulnerability exists in the lunary-ai/lunary repository, version 0.3.0, within the project update endpoint.\",\n      \"severity\":\"critical\",\n      \"score\":{\"vectorString\":\"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N\",\"base\":{\"severity\":\"CRITICAL\",\"score\":9.1},\"exploitability\":{\"exploit_maturity\":\"confirmed\",\"difficulty\":\"high\"},\"impact\":{\"confidentiality\":{\"impact\":\"HIGH\"},\"integrity\":{\"impact\":\"HIGH\"},\"availability\":{\"impact\":\"NONE\"}}\n    },\n    \"attack_pattern\":{\n      \"id\":\"T1037.004\",\n      \"type\":\"attack-pattern\",\n      \"name\":\"Insecure Direct Object Reference\",\n      \"description\":\"The 'Insecure Direct Object Reference' technique allows an authenticated actor to manipulate data without authorization.\",\n      \" kill_chain_phases\":[{\"phase\":\"initial_access\",\"phase_range\":{\"start\":\"null\",\"end\":{\"from\":\"initial_access\",\"to\":\"initial_access\"}}},{\"phase\":\"execution\",\"phase_range\":{\"start\":{\"from\":\"execution\",\"to\":\"execution\"}}},{\"phase\":\" persistence\",\"phase_range\":{\"start\":{\"from\":\"persistence\",\"to\":\"persistence\"}}},{\"phase\":\"command_and_control\",\"phase_range\":{\"start\":{\"from\":\"command_and_control\",\"to\":\"command_and_control\"}}},{\"phase\":\"defense_evasion\",\"phase_range\":{\"start\":{\"from\":\"defense_evasion\",\"to\":\"defense_evasion\"}}},{\"phase\":\"lateral_movement\",\"phase_range\":{\"start\":{\"from\":\"lateral_movement\",\"to\":\"lateral_movement\"}}},{\"phase\":\"collection\",\"phase_range\":{\"start\":{\"from\":\"collection\",\"to\":\"collection\"}}},{\"phase\":\"Impact\",\"phase_range\":{\"start\":{\"from\":\"impact\",\"to\":\"impact\"}}}\n    },\n    \"tool\":{\n      \"id\":\"defense_evasion_monitors\",\n      \"type\":\"tool\",\n      \"name\":\"Defense Evasion Monitors\",\n      \"description\":\"Tools used to monitor for defense evasion activities.\",\n      \"objects\":[{\"object\":{\"type\":\"observed-data\",\"id\":\"observed_data\"},\"relationship\":{\"type\":\"uses\"}}]\n    },\n    \"course_of_action\":{\n      \"id\":\"mitigate_idor_vulnerability\",\n      \"type\":\"course-of-action\",\n      \"name\":\"Mitigate IDOR Vulnerability\",\n      \"description\":\"Implement robust security controls and monitoring systems to detect and prevent exploitation of the IDOR vulnerability.\",\n      \"objects\":[{\"object\":{\"type\":\"indicator\",\"id\":\"indicator\"},\"relationship\":{\"type\":\"indicated_by\"}}]\n    }\n  }},", "technical_analysis": {"Introduction": "The CVE-2024-1626 vulnerability is a critical, remotely exploitable vulnerability in the lunary-ai/lunary repository, version 0.3.0, that allows an authenticated actor to manipulate data without authorization.", "Impact and Scope": "The vulnerability has a CVSS score of 9.1 and an attack vector of NETWORK, making it a high-priority vulnerability to address. The impact of the vulnerability is HIGH for confidentiality, integrity, and availability.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the T1037.004, T1555.007, and T1204.001 MITRE ATT&CK techniques.", "Technical Details": "The vulnerability exists in the project update endpoint and allows an attacker to directly reference the project's ID in the PATCH request. This allows an attacker to modify the name of any project within the system without proper authorization checks.", "Detection": "Methods for detecting the vulnerability include monitoring for unauthorized changes to project names and implementing robust security controls and monitoring systems.", "Mitigation": "Mitigation strategies include enforcing proper access control and validation of user input, implementing robust security controls and monitoring systems, and applying security patches.", "Conclusion": "In conclusion, the CVE-2024-1626 vulnerability is a critical vulnerability that requires immediate attention and action to mitigate its impact."}, "executive_analysis": {"Overview": "The CVE-2024-1626 vulnerability is a critical vulnerability in the lunary-ai/lunary repository, version 0.3.0, that allows an authenticated actor to manipulate data without authorization.", "Business Impact": "The vulnerability has a potential business impact of compromise of sensitive data and disruption of business operations.", "Technical Impact": "The technical impact of the vulnerability is HIGH for confidentiality, integrity, and availability.", "Mitigation Strategies": "Mitigation strategies include implementing robust security controls and monitoring systems and applying security patches.", "Recommendations": "Recommendations for executives include prioritizing the mitigation of the vulnerability and implementing additional security controls and monitoring systems.", "Conclusions": "In conclusion, the CVE-2024-1626 vulnerability is a critical vulnerability that requires immediate attention and action to mitigate its impact."}}