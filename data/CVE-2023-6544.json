{"id": "CVE-2023-6544", "sourceIdentifier": "secalert@redhat.com", "published": "2024-04-25T16:15:10.097", "lastModified": "2024-04-25T17:24:59.967", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A flaw was found in the Keycloak package. This issue occurs due to a permissive regular expression hardcoded for filtering which allows hosts to register a dynamic client. A malicious user with enough information about the environment could jeopardize an environment with this specific Dynamic Client Registration and TrustedDomain configuration previously unauthorized."}, {"lang": "es", "value": "Se encontr\u00f3 una falla en el paquete Keycloak. Este problema se produce debido a una expresi\u00f3n regular permisiva codificada para el filtrado que permite a los hosts registrar un cliente din\u00e1mico. Un usuario malintencionado con suficiente informaci\u00f3n sobre el entorno podr\u00eda poner en peligro un entorno con este registro din\u00e1mico de cliente espec\u00edfico y esta configuraci\u00f3n de TrustedDomain previamente no autorizada."}], "metrics": {"cvssMetricV31": [{"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.5}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-625"}]}], "references": [{"url": "https://access.redhat.com/errata/RHSA-2024:1860", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1861", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1862", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1864", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1866", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1867", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:1868", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/security/cve/CVE-2023-6544", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2253116", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2023-6544 - Persistence of dynamic client registration, allows an attacker to register a malicious dynamic client, which can be used for information gathering, privilege escalation, and access to sensitive data."}, {"techniqueID": "T1134", "comment": "CVE-2023-6544 - Exploitation of the permissive regular expression hardcoded for filtering, allows an attacker to bypass access controls and register a dynamic client, which can lead to unauthorized access and data exfiltration."}, {"techniqueID": "T1204", "comment": "CVE-2023-6544 - Command and Control, the attacker can use a registered dynamic client to send and receive commands and data from the Keycloak server, allowing for remote control and data exfiltration."}, {"techniqueID": "T1547", "comment": "CVE-2023-6544 - Containerization, the attacker can use a compromised container to execute malicious code and evade detection, allowing for further exploitation and data theft."}], "stix_bundle": {"bundle": {"type": "bundle", "spec_version": "2.1", "objects": [{"type": "vulnerability", "id": "vuln:CVE-2023-6544", "name": "Keycloak Dynamic Client Registration RCE", "description": "CVE-2023-6544", "short_description": "Keycloak Dynamic Client Registration CWE-625", "attacks": [{"type": "attack-pattern", "id": "ap:T1190", "name": "Entity Registration for Persistence"}, {"type": "attack-pattern", "id": "ap:T1134", "name": "Filtering Rules Bypass"}, {"type": "attack-pattern", "id": "ap:T1204", "name": "Command and Control"}, {"type": "attack-pattern", "id": "ap:T1547", "name": "Containerization"}]}, {"type": "course-of-action", "id": "cao:mitigate_cve_2023_6544", "name": "Mitigate CVE-2023-6544", "description": "Apply latest Keycloak version and disable dynamic client registration", "relevant_attack_pattern_ids": ["ap:T1190", "ap:T1134", "ap:T1204", "ap:T1547"]}], "relationships": [{"id": "rel:has_attack_pattern", "type": "has_attack_pattern", "source_ref": "vuln:CVE-2023-6544", "target_ref": "ap:T1190"}, {"id": "rel:has_attack_pattern", "type": "has_attack_pattern", "source_ref": "vuln:CVE-2023-6544", "target_ref": "ap:T1134"}, {"id": "rel:has_attack_pattern", "type": "has_attack_pattern", "source_ref": "vuln:CVE-2023-6544", "target_ref": "ap:T1204"}, {"id": "rel:has_attack_pattern", "type": "has_attack_pattern", "source_ref": "vuln:CVE-2023-6544", "target_ref": "ap:T1547"}, {"id": "rel:is_mitigated_by", "type": "is_mitigated_by", "source_ref": "cao:mitigate_cve_2023_6544", "target_ref": "vuln:CVE-2023-6544"}]}}, "technical_analysis": {"Introduction": "Keycloak Dynamic Client Registration RCE vulnerability allows an attacker to register a dynamic client and gain unauthorized access to Keycloak server.", "Impact and Scope": "CVSS score: 5.4 (AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N), allows an attacker to register a dynamic client, which can lead to information gathering, privilege escalation, and access to sensitive data.", "Related MITRE ATT&CK Techniques": "T1190, T1134, T1204, T1547", "Technical Details": "Keycloak Dynamic Client Registration allows clients to register themselves with the Keycloak server, but the implementation has a permissive regular expression hardcoded for filtering, which can be exploited by an attacker to register a malicious dynamic client.", "Detection": "Monitor Keycloak server logs for suspicious dynamic client registration requests, monitor network traffic for suspicious traffic patterns.", "Mitigation": "Apply latest Keycloak version and disable dynamic client registration, monitor Keycloak server logs for suspicious dynamic client registration requests.", "Conclusion": "Keycloak Dynamic Client Registration RCE vulnerability is a high-severity vulnerability that can be exploited by an attacker to gain unauthorized access to Keycloak server. It is recommended to apply latest Keycloak version and disable dynamic client registration to mitigate the vulnerability."}, "executive_analysis": {"Overview": "Keycloak Dynamic Client Registration RCE vulnerability is a high-severity vulnerability that can be exploited by an attacker to gain unauthorized access to Keycloak server.", "Business Impact": "Unauthorized access can lead to data theft, financial loss, and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to register a dynamic client and gain access to Keycloak server, which can lead to information gathering, privilege escalation, and access to sensitive data.", "Mitigation Strategies": "Apply latest Keycloak version and disable dynamic client registration, monitor Keycloak server logs for suspicious dynamic client registration requests.", "Recommendations": "Recommend to apply latest Keycloak version and disable dynamic client registration, monitor Keycloak server logs for suspicious dynamic client registration requests.", "Conclusions": "Keycloak Dynamic Client Registration RCE vulnerability is a high-severity vulnerability that requires immediate attention and mitigation."}}