{"id": "CVE-2024-0674", "sourceIdentifier": "cve-coordination@incibe.es", "published": "2024-01-30T13:15:08.330", "lastModified": "2024-02-08T16:39:59.450", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Privilege escalation vulnerability in Lamassu Bitcoin ATM Douro machines, in its 7.1 version, which could allow a local user to acquire root permissions by modifying the updatescript.js, inserting special code inside the script and creating the done.txt file. This would cause the watchdog process to run as root and execute the payload stored in the updatescript.js."}, {"lang": "es", "value": "Vulnerabilidad de escalada de privilegios en m\u00e1quinas Lamassu Bitcoin ATM Douro, en su versi\u00f3n 7.1, que podr\u00eda permitir a un usuario local adquirir permisos root modificando el updatescript.js, insertando un c\u00f3digo especial dentro del script y creando el archivo done.txt. Esto har\u00eda que el proceso de vigilancia se ejecutara como root y ejecutarael payload almacenado en updatescript.js."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}, {"source": "cve-coordination@incibe.es", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:P/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "PHYSICAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.4, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-281"}]}, {"source": "cve-coordination@incibe.es", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-269"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:lamassu:douro_firmware:7.1:*:*:*:*:*:*:*", "matchCriteriaId": "A91DE83C-3B58-41AA-BD7E-3894617B9740"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:lamassu:douro:-:*:*:*:*:*:*:*", "matchCriteriaId": "827786B5-C5F1-4F98-95EC-DCF681683ECA"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:lamassu:douro_ii_firmware:7.1:*:*:*:*:*:*:*", "matchCriteriaId": "3355BA32-76B3-4245-9C31-1F778B7D1848"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:lamassu:douro_ii:-:*:*:*:*:*:*:*", "matchCriteriaId": "14DA65BF-520F-415F-8A4C-CF06DDCC147C"}]}]}], "references": [{"url": "https://www.incibe.es/en/incibe-cert/notices/aviso/multiple-vulnerabilities-lamassu-bitcoin-atm-douro-machines", "source": "cve-coordination@incibe.es", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1112", "comment": "CVE-2024-0674 - This technique is relevant as it involves modifying system files to escalate privileges, which is similar to the vulnerability's exploitation method."}, {"techniqueID": "T1055", "comment": "CVE-2024-0674 - The vulnerability's exploitation involves creating files and executing scripts, which is similar to this technique's actions, making it relevant to this CVE."}, {"techniqueID": "T1065", "comment": "CVE-2024-0674 - This technique is relevant as it involves creating and executing scripts, which is a similar method used to exploit this vulnerability."}], "stix_bundle": {"type": "Bundle", "id": "bundle-2024-0674", "created_by_ref": "organization---1", "created": "2024-03-08T14:30:00.000", "updated": "2024-03-08T14:30:00.000", "description": "Bundle for CVE-2024-0674", "objects": [{"type": "Vulnerability", "id": "vulnerability---1", "created_by_ref": "organization---1", "created": "2024-03-08T14:30:00.000", "updated": "2024-03-08T14:30:00.000", "description": "CVE-2024-0674 - Privilege escalation vulnerability in Lamassu Bitcoin ATM Douro machines", "baseObject": {"type": "Attack Pattern", "id": "attack_pattern---1", "created_by_ref": "organization---1", "created": "2024-03-08T14:30:00.000", "updated": "2024-03-08T14:30:00.000", "description": "Lamassu Bitcoin ATM Douro privilege escalation vulnerability"}, "related_object": {"type": "Course of Action", "id": "course_of_action---1", "created_by_ref": "organization---1", "created": "2024-03-08T14:30:00.000", "updated": "2024-03-08T14:30:00.000", "description": "Patch system to fix vulnerability"}}, {"type": "Course of Action", "id": "course_of_action---2", "created_by_ref": "organization---1", "created": "2024-03-08T14:30:00.000", "updated": "2024-03-08T14:30:00.000", "description": "Implement network segmentation to limit access to vulnerable devices"}, {"type": "Note", "id": "note---1", "created_by_ref": "organization---1", "created": "2024-03-08T14:30:00.000", "updated": "2024-03-08T14:30:00.000", "description": "Monitor system logs for suspicious activity and disable remote access"}], "relationships": [{"type": "related_to", "id": "related_to---1", "source_ref": "vulnerability---1", "target_ref": "course_of_action---1"}, {"type": "related_to", "id": "related_to---2", "source_ref": "course_of_action---1", "target_ref": "attack_pattern---1"}]}, "technical_analysis": {"Introduction": "The CVE-2024-0674 vulnerability is a privilege escalation vulnerability in the Lamassu Bitcoin ATM Douro machines.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 7.8 and an attack vector of LOCAL.", "Related MITRE ATT&CK Techniques": "The techniques T1112, T1055, and T1065 are relevant to this CVE as they involve similar methods of exploitation.", "Technical Details": "The vulnerability is caused by the ability to modify system files to escalate privileges, which is achieved by creating special code inside the updatescript.js and creating the done.txt file.", "Detection": "Detection methods include monitoring system logs for suspicious activity and disabling remote access.", "Mitigation": "Mitigation strategies include patching the system to fix the vulnerability, implementing network segmentation, and monitoring system logs.", "Conclusion": "In conclusion, the CVE-2024-0674 vulnerability is a significant threat that requires immediate attention and action."}, "executive_analysis": {"Overview": "The CVE-2024-0674 vulnerability is a privilege escalation vulnerability in the Lamassu Bitcoin ATM Douro machines.", "Business Impact": "The impact of this vulnerability is significant, with potential financial losses and reputation damage.", "Technical Impact": "The technical impact is high, with a CVSS score of 7.8 and an attack vector of LOCAL.", "Mitigation Strategies": "Mitigation strategies include patching the system, implementing network segmentation, and monitoring system logs.", "Recommendations": "Recommendations for executives include prioritizing patching the system and implementing network segmentation.", "Conclusions": "In conclusion, immediate action is required to mitigate the impact of this vulnerability."}}