{"id": "CVE-2024-24213", "sourceIdentifier": "cve@mitre.org", "published": "2024-02-08T18:15:08.237", "lastModified": "2024-08-21T18:06:24.633", "vulnStatus": "Analyzed", "cveTags": [{"sourceIdentifier": "cve@mitre.org", "tags": ["disputed"]}], "descriptions": [{"lang": "en", "value": "Supabase PostgreSQL v15.1 was discovered to contain a SQL injection vulnerability via the component /pg_meta/default/query. NOTE: the vendor's position is that this is an intended feature; also, it exists in the Supabase dashboard product, not the Supabase PostgreSQL product. Specifically, /pg_meta/default/query is for SQL queries that are entered in an intended UI by an authorized user. Nothing is injected."}, {"lang": "es", "value": "Se descubri\u00f3 que Supabase PostgreSQL v15.1 contiene una vulnerabilidad de inyecci\u00f3n SQL a trav\u00e9s del componente /pg_meta/default/query."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:supabase:postgres:15.1:*:*:*:*:*:*:*", "matchCriteriaId": "97FF52D4-4293-47D3-A491-DAF771B9A2C5"}]}]}], "references": [{"url": "https://app.flows.sh:8443/project/default%2C", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "https://github.com/940198871/Vulnerability-details/blob/main/CVE-2024-24213", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://postfixadmin.ballardini.com.ar:8443/project/default/logs/explorer.", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "https://reference1.example.com/project/default/logs/explorer%2C", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "https://supabase.com/docs/guides/database/overview#the-sql-editor", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1499", "comment": "CVE-2024-24213 - SQL Injection via /pg_meta/default/query in Supabase PostgreSQL. Attackers can inject malicious SQL queries to alter database contents and potentially execute arbitrary commands."}, {"techniqueID": "T1190", "comment": "CVE-2024-24213 - SQL Injection via /pg_meta/default/query in Supabase PostgreSQL. Attackers can inject malicious SQL queries to alter database contents and potentially execute arbitrary commands."}, {"techniqueID": "T1027", "comment": "CVE-2024-24213 - SQL Injection via /pg_meta/default/query in Supabase PostgreSQL. Attackers can inject malicious SQL queries to alter database contents and potentially execute arbitrary commands."}], "stix_bundle": {"objects": [{"id": "vulnerability--1", "type": "vulnerability", "objects": [{"id": "mitre_attack_technique--1", "type": "technique", "name": "SQL Injection", "revoked": false, "description": "CVE-2024-24213 - Unvalidated or improperly sanitized user input is used in a SQL command, allowing an attacker to manipulate the command and execute arbitrary SQL code."}, {"id": "action--1", "type": "action", "name": "Inject Malicious SQL Queries", "revoked": false, "description": "Attempting to inject malicious SQL queries into the Supabase PostgreSQL database via the /pg_meta/default/query endpoint."}, {"id": "indicator--1", "type": "indicator", "name": "Malicious SQL Queries", "revoked": false, "description": "Malicious SQL queries detected in the Supabase PostgreSQL database logs."}], "relationships": [{"source_ref": "vulnerability--1", "target_ref": "mitre_attack_technique--1", "relationship": "related"}, {"source_ref": "vulnerability--1", "target_ref": "action--1", "relationship": "exploits"}, {"source_ref": "action--1", "target_ref": "indicator--1", "relationship": "produces"}]}], "objects_fields": [{"id": "d3fend-tactic--1", "type": "tactic", "name": "Defeat the Malicious SQL Queries", "description": "Detect and block malicious SQL queries in the Supabase PostgreSQL database."}], "relationships_fields": [{"source_ref": "vulnerability--1", "target_ref": "d3fend-tactic--1", "relationship": "mitigates"}]}, "technical_analysis": {"Introduction": "CVE-2024-24213 is a SQL injection vulnerability in the Supabase PostgreSQL database, allowing attackers to inject malicious SQL queries and potentially execute arbitrary commands.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and affects Supabase PostgreSQL v15.1. The scope of the vulnerability is network-based and requires no user interaction.", "Related MITRE ATT&CK Techniques": "T1499, T1190, and T1027", "Technical Details": "The vulnerability is due to an unintended feature in the /pg_meta/default/query endpoint, which allows attackers to inject malicious SQL queries. The vulnerability can be exploited by sending a specially crafted SQL query to the endpoint.", "Detection": "Detection methods include monitoring database logs for suspicious SQL queries and detecting anomalies in database access patterns.", "Mitigation": "Mitigation strategies include validating and sanitizing user input, modifying the endpoint to disallow injection of malicious SQL queries, and implementing Intrusion Detection Systems (IDS) and Web Application Firewalls (WAF) to detect and block malicious traffic.", "Conclusion": "In conclusion, CVE-2024-24213 is a critical vulnerability that requires immediate attention. Implementing effective mitigation strategies is crucial to prevent exploitation of this vulnerability."}, "executive_analysis": {"Overview": "CVE-2024-24213 is a serious vulnerability in the Supabase PostgreSQL database, allowing attackers to inject malicious SQL queries and potentially execute arbitrary commands.", "Business Impact": "The vulnerability poses a significant risk to the confidentiality, integrity, and availability of sensitive data stored in the database.", "Technical Impact": "The vulnerability can be exploited by attackers to compromise the database and potentially execute arbitrary commands, leading to data breaches and system compromise.", "Mitigation Strategies": "Implementing effective mitigation strategies, such as validating and sanitizing user input, modifying the endpoint to disallow injection of malicious SQL queries, and implementing IDS and WAF, is crucial to prevent exploitation of this vulnerability.", "Recommendations": "We recommend that organizations prioritize patching and deploying mitigation strategies for this vulnerability as soon as possible.", "Conclusions": "In conclusion, CVE-2024-24213 is a critical vulnerability that requires immediate attention. Implementing effective mitigation strategies is crucial to prevent exploitation of this vulnerability."}}