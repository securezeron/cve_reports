{"id": "CVE-2020-1946", "sourceIdentifier": "security@apache.org", "published": "2021-03-25T10:15:11.727", "lastModified": "2023-11-07T03:19:37.797", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Apache SpamAssassin before 3.4.5, malicious rule configuration (.cf) files can be configured to run system commands without any output or errors. With this, exploits can be injected in a number of scenarios. In addition to upgrading to SA version 3.4.5, users should only use update channels or 3rd party .cf files from trusted places."}, {"lang": "es", "value": "En Apache SpamAssassin anterior a versi\u00f3n 3.4.5, los archivos de configuraci\u00f3n de reglas maliciosas (.cf) se pueden configurar para ejecutar comandos del sistema sin ning\u00fan resultado ni errores.&#xa0;Con esto, las explotaciones se pueden inyectar en varios escenarios.&#xa0;Adem\u00e1s de actualizar a la versi\u00f3n 3.4.5 de SA, los usuarios solo deben usar canales de actualizaci\u00f3n o archivos .cf de terceros desde lugares de confianza"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}, {"source": "security@apache.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:spamassassin:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.4.5", "matchCriteriaId": "6B2EC96E-432A-4D9F-95C7-051CBE121C7D"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*", "matchCriteriaId": "36D96259-24BD-44E2-96D9-78CE1D41F956"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*", "matchCriteriaId": "E460AA51-FCDA-46B9-AE97-E6676AA5E194"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*", "matchCriteriaId": "A930E247-0B43-43CB-98FF-6CE7B8189835"}]}]}], "references": [{"url": "https://lists.debian.org/debian-lts-announce/2021/04/msg00000.html", "source": "security@apache.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/7V2SBVTKVLFFT36ECJQ7TQ7KAQCQZDRZ/", "source": "security@apache.org"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/JFBFRIG5TX23NF4ND6OAKKY7I6TLRCCP/", "source": "security@apache.org"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NKAXYBKBMQOLIW6UKASJCAZRBOIYS4RL/", "source": "security@apache.org"}, {"url": "https://s.apache.org/3r1wh", "source": "security@apache.org", "tags": ["Mailing List", "Vendor Advisory"]}, {"url": "https://security.gentoo.org/glsa/202105-26", "source": "security@apache.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2021/dsa-4879", "source": "security@apache.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1031", "comment": "CVE-2020-1946 - This vulnerability allows for system command injection, which can be used to execute arbitrary commands and elevate privileges. This is a key technique for threat actors to exploit and gain access to secure systems."}, {"techniqueID": "T1133", "comment": "CVE-2020-1946 - This vulnerability can be used to inject exploits and malware into the system, which can lead to data breaches and unauthorized access. Defending against this technique requires implementing robust security measures and monitoring systems for suspicious activity."}, {"techniqueID": "T1204", "comment": "CVE-2020-1946 - This vulnerability can be used to inject malicious code into the system, which can be used to gather sensitive information and disrupt system functionality. Detecting this technique requires monitoring for suspicious network traffic and system activity."}, {"techniqueID": "T1591", "comment": "CVE-2020-1946 - This vulnerability can be used to conceal malicious activity by injecting shellcode into system commands. Defending against this technique requires implementing anti-tampering measures and monitoring systems for signs of suspicious activity."}], "stix_bundle": {"@stix2-1": {"type": "bundle", "id": "urn:cve-mitre:2.0", "created_by": "https://mitre.org", "modified": "2023-11-07T03:19:37.797", "objects": [{"type": "vulnerability", "id": "CVE-2020-1946", "name": "Apache SpamAssassin command injection vulnerability", "description": "In Apache SpamAssassin before 3.4.5, malicious rule configuration (.cf) files can be configured to run system commands without any output or errors.", "created_by": "https://mitre.org", "modified": "2023-11-07T03:19:37.797"}, {"type": "indicator", "id": "CVE-2020-1946-Indicator", "name": "CVE-2020-1946 Indicator", "description": "Indicator of the CVE-2020-1946 vulnerability", "pattern": " network traffic containing system command injection strings", "created_by": "https://mitre.org", "modified": "2023-11-07T03:19:37.797"}, {"type": "attack-pattern", "id": "T1031", "name": "System Command Injection", "description": "Attack pattern for system command injection", "created_by": "https://mitre.org", "modified": "2023-11-07T03:19:37.797"}, {"type": "course-of-action", "id": "CVE-2020-1946-COA", "name": "CVE-2020-1946 Course of Action", "description": "Course of action for mitigating the CVE-2020-1946 vulnerability", "related_courses_of_action": ["T1031"], "created_by": "https://mitre.org", "modified": "2023-11-07T03:19:37.797"}]}}, "technical_analysis": {"Introduction": "The CVE-2020-1946 vulnerability in Apache SpamAssassin allows attackers to execute system commands without any output or errors, making it a high-risk vulnerability.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8, with an attack vector of network, and affects Apache SpamAssassin versions prior to 3.4.5.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1031, T1133, T1204, and T1591.", "Technical Details": "The vulnerability occurs when malicious rule configuration (.cf) files are configured to run system commands without any output or errors.", "Detection": "Detecting this vulnerability requires monitoring for suspicious network traffic and system activity.", "Mitigation": "Mitigating this vulnerability requires updating Apache SpamAssassin to version 3.4.5 or later, and configuring security measures to prevent system command injection.", "Conclusion": "The CVE-2020-1946 vulnerability is a high-risk vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2020-1946 vulnerability is a critical security vulnerability in Apache SpamAssassin that allows attackers to execute system commands without any output or errors.", "Business Impact": "This vulnerability can result in data breaches, unauthorized access, and disruption of system functionality, which can have significant business impacts.", "Technical Impact": "The vulnerability is highly technical and requires deep understanding of system command injection and Apache SpamAssassin configuration.", "Mitigation Strategies": "Updating Apache SpamAssassin to version 3.4.5 or later, and configuring security measures to prevent system command injection are the recommended mitigation strategies.", "Recommendations": "We recommend immediate attention and mitigation of this vulnerability, and conducting regular security audits and penetration testing to identify and address potential vulnerabilities.", "Conclusions": "The CVE-2020-1946 vulnerability is a critical security issue that requires immediate attention and mitigation."}}