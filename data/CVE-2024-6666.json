{"id": "CVE-2024-6666", "sourceIdentifier": "security@wordfence.com", "published": "2024-07-11T07:15:07.233", "lastModified": "2024-07-12T16:46:48.387", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The WP ERP plugin for WordPress is vulnerable to SQL Injection via the \u2018vendor_id\u2019 parameter in all versions up to, and including, 1.13.0 due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query.  This makes it possible for authenticated attackers, with Accounting Manager access (erp_ac_view_sales_summary capability) and above, to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database."}, {"lang": "es", "value": "El complemento WP ERP para WordPress es vulnerable a la inyecci\u00f3n SQL a trav\u00e9s del par\u00e1metro 'vendor_id' en todas las versiones hasta la 1.13.0 incluida debido a un escape insuficiente en el par\u00e1metro proporcionado por el usuario y a la falta de preparaci\u00f3n suficiente en la consulta SQL existente. Esto hace posible que atacantes autenticados, con acceso de Accounting Manager (capacidad erp_ac_view_sales_summary) y superior, agreguen consultas SQL adicionales a consultas ya existentes que pueden usarse para extraer informaci\u00f3n confidencial de la base de datos."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:wedevs:wp_erp:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "1.13.1", "matchCriteriaId": "1C79F33B-A8DE-4154-91F2-04672C330F9E"}]}]}], "references": [{"url": "https://plugins.trac.wordpress.org/changeset/3064874/erp/tags/1.13.1/modules/accounting/includes/functions/transactions.php", "source": "security@wordfence.com", "tags": ["Patch"]}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/e23335c9-0830-4c6b-8e0d-6897a7176ba5?source=cve", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059.007", "comment": "CVE-2024-6666 - Authentication Bypass via Injection; an attacker can exploit the vulnerability by injecting malicious SQL queries to bypass authentication and gain access to sensitive information."}, {"techniqueID": "T1068", "comment": "CVE-2024-6666 - Input Validation and Insecure Data Handling; the vulnerability allows attackers to supply malicious input in the 'vendor_id' parameter, which is not properly validated, leading to SQL Injection."}, {"techniqueID": "T1190", "comment": "CVE-2024-6666 - Data Confidentiality; the vulnerability compromises data confidentiality as attackers can extract sensitive information from the database by injecting malicious SQL queries."}, {"techniqueID": "T1199", "comment": "CVE-2024-6666 - Command and Control; the vulnerability can be used to establish Command and Control channels to remotely access and control the affected system."}], "technical_analysis": {"Introduction": "The Vulnerability Analysis Report.", "Impact and Scope": "The vulnerability, CVE-2024-6666, is a remote SQL injection vulnerability in the WP ERP plugin for WordPress, with a CVSS score of 8.8.", "Related MITRE ATT&CK Techniques": "T1059.007, T1068, T1190, and T1199.", "Technical Details": "The vulnerability occurs due to insufficient escaping on the user-supplied 'vendor_id' parameter and lack of sufficient preparation on the existing SQL query.", "Detection": "Detection methods include monitoring for suspicious SQL queries and monitoring system logs for authentication attempts.", "Mitigation": "Mitigation strategies include patching the vulnerable plugin, validating user input, and implementing input validation and sanitization mechanisms.", "Conclusion": "The vulnerability, CVE-2024-6666, is a significant threat and requires immediate attention to prevent exploitation."}, "executive_analysis": {"Overview": "Overview of the Vulnerability.", "Business Impact": "The vulnerability can lead to unauthorized access to sensitive information, data breaches, and potential financial losses.", "Technical Impact": "The vulnerability compromises data confidentiality, raises the risk of system compromise, and can lead to unauthorized access to sensitive information.", "Mitigation Strategies": "Patching the vulnerable plugin, validating user input, and implementing input validation and sanitization mechanisms.", "Recommendations": "Executives are recommended to immediately patch the vulnerable plugin, perform regular security audits, and implement robust security measures.", "Conclusions": "The vulnerability, CVE-2024-6666, requires immediate attention and action to prevent exploitation and protect business assets."}}