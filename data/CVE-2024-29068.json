{"id": "CVE-2024-29068", "sourceIdentifier": "security@ubuntu.com", "published": "2024-07-25T20:15:04.280", "lastModified": "2024-08-26T17:00:24.647", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In snapd versions prior to 2.62, snapd failed to properly check the file\ntype when extracting a snap. The snap format is a squashfs file-system\nimage and so can contain files that are non-regular files (such as pipes \nor sockets etc). Various file entries within the snap squashfs image\n(such as icons etc) are directly read by snapd when it is extracted. An \nattacker who could convince a user to install a malicious snap which\ncontained non-regular files at these paths could then cause snapd to block\nindefinitely trying to read from such files and cause a denial of service."}, {"lang": "es", "value": "En versiones de snapd anteriores a la 2.62, snapd no pudo verificar correctamente el tipo de archivo al extraer un complemento. El formato snap es una imagen del sistema de archivos squashfs y, por lo tanto, puede contener archivos que no son archivos regulares (como tuber\u00edas o enchufes, etc.). Snapd lee directamente varias entradas de archivos dentro de la imagen de snap squashfs (como \u00edconos, etc.) cuando se extrae. Un atacante que pudiera convencer a un usuario de que instalara un complemento malicioso que contuviera archivos no regulares en estas rutas podr\u00eda provocar que snapd bloqueara indefinidamente el intento de leer dichos archivos y provocar una denegaci\u00f3n de servicio."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.6, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 5.2}, {"source": "security@ubuntu.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.6, "impactScore": 5.2}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "security@ubuntu.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:canonical:snapd:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.62", "matchCriteriaId": "A4A95DA5-EB47-48AA-B9C6-EB6D1489E832"}]}]}], "references": [{"url": "https://github.com/snapcore/snapd/commit/b66fee81606a1c05f965a876ccbaf44174194063", "source": "security@ubuntu.com", "tags": ["Patch"]}, {"url": "https://github.com/snapcore/snapd/pull/13682", "source": "security@ubuntu.com", "tags": ["Issue Tracking", "Patch"]}], "techniques": [{"techniqueID": "TA0002", "comment": "CVE-2024-29068 - This technique utilizes social engineering to trick a user into installing a malicious snap package, which can lead to a denial-of-service condition. A defense strategy would be to implement strict package verification and restrict access to only approved snap packages."}, {"techniqueID": "TA0005", "comment": "CVE-2024-29068 - This technique involves exploiting the vulnerability by convincing a user to install a malicious snap package, which can then be used to cause a denial-of-service condition. A defense strategy would be to implement strict package verification and restrict access to only approved snap packages."}, {"techniqueID": "TA0040", "comment": "CVE-2024-29068 - This technique utilizes the vulnerability to cause a denial-of-service condition. A defense strategy would be to implement strict package verification and restrict access to only approved snap packages."}], "technical_analysis": {"Introduction": "CVE-2024-29068 is a remote code execution vulnerability in snapd, a package manager for snap packages. The vulnerability allows an attacker to create a malicious snap package that can be installed on an unsuspecting user's system, leading to a denial-of-service condition.", "Impact and Scope": "The vulnerability has a CVSS score of 6.6, with a severity rating of MEDIUM. It affects all systems running snapd versions prior to 2.62, and requires a user to interact with a malicious snap package in order to exploit the vulnerability.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to TA0002, TA0005, and TA0040.", "Technical Details": "The vulnerability occurs when snapd fails to properly check the file type when extracting a snap package. An attacker can create a malicious snap package that contains non-regular files, such as pipes or sockets, which can cause snapd to block indefinitely when trying to read from these files.", "Detection": "The vulnerability can be detected by monitoring system logs for suspicious activity, such as unexpected package installations or system crashes.", "Mitigation": "The vulnerability can be mitigated by installing the latest version of snapd, which fixes the vulnerability. Additionally, implementing strict package verification and restricting access to only approved snap packages can help prevent exploitation of the vulnerability.", "Conclusion": "CVE-2024-29068 is a serious vulnerability that can lead to a denial-of-service condition. It is important to install the latest version of snapd and implement strict package verification to prevent exploitation of the vulnerability."}, "executive_analysis": {"Overview": "CVE-2024-29068 is a remote code execution vulnerability in snapd, a package manager for snap packages.", "Business Impact": "The vulnerability can lead to a denial-of-service condition, which can result in lost productivity and revenue.", "Technical Impact": "The vulnerability can be exploited by an attacker to cause a denial-of-service condition, which can result in system crashes and data loss.", "Mitigation Strategies": "Implementing strict package verification and restricting access to only approved snap packages can help prevent exploitation of the vulnerability.", "Recommendations": "We recommend that all systems running snapd versions prior to 2.62 be updated to the latest version, and that strict package verification and restrictions be implemented to prevent exploitation of the vulnerability.", "Conclusions": "CVE-2024-29068 is a serious vulnerability that requires immediate attention. We recommend implementing the recommended mitigation strategies to prevent exploitation of the vulnerability."}}