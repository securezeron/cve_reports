{"id": "CVE-2023-7152", "sourceIdentifier": "cna@vuldb.com", "published": "2023-12-29T05:15:09.473", "lastModified": "2024-05-17T02:34:13.930", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability, which was classified as critical, has been found in MicroPython 1.21.0/1.22.0-preview. Affected by this issue is the function poll_set_add_fd of the file extmod/modselect.c. The manipulation leads to use after free. The exploit has been disclosed to the public and may be used. The patch is identified as 8b24aa36ba978eafc6114b6798b47b7bfecdca26. It is recommended to apply a patch to fix this issue. VDB-249158 is the identifier assigned to this vulnerability."}, {"lang": "es", "value": "Una vulnerabilidad fue encontrada en MicroPython 1.21.0/1.22.0-preview y clasificada como cr\u00edtica. La funci\u00f3n poll_set_add_fd del archivo extmod/modselect.c es afectada por esta vulnerabilidad. La manipulaci\u00f3n conduce a use after free. La explotaci\u00f3n ha sido divulgada al p\u00fablico y puede utilizarse. El parche se identifica como 8b24aa36ba978eafc6114b6798b47b7bfecdca26. Se recomienda aplicar un parche para solucionar este problema. VDB-249158 es el identificador asignado a esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.2}, "baseSeverity": "MEDIUM", "exploitabilityScore": 5.1, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-416"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:micropython:micropython:1.21.0:*:*:*:*:*:*:*", "matchCriteriaId": "92240FCD-0BA9-46D0-9C9A-2CDD8FE2A769"}, {"vulnerable": true, "criteria": "cpe:2.3:a:micropython:micropython:1.22.0:preview:*:*:*:*:*:*", "matchCriteriaId": "B60BCDF9-D1CF-45ED-9B95-9F06C5C2A95F"}]}]}], "references": [{"url": "https://github.com/jimmo/micropython/commit/8b24aa36ba978eafc6114b6798b47b7bfecdca26", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://github.com/micropython/micropython/issues/12887", "source": "cna@vuldb.com", "tags": ["Exploit", "Issue Tracking"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/4E2HYWCZB5R4SHY4SZZZSFDMD64N4SOZ/", "source": "cna@vuldb.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/D3WWY5JY4RTJE25APB4REGDUDPATG6H7/", "source": "cna@vuldb.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TEK46QAJOXXDZOWOIE2YACUOCZFWOBCK/", "source": "cna@vuldb.com"}, {"url": "https://vuldb.com/?ctiid.249158", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory", "VDB Entry"]}, {"url": "https://vuldb.com/?id.249158", "source": "cna@vuldb.com", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "TA0001", "comment": "Executing Remote Operations - Validating CVE-2023-7152's use-after-free vulnerability which may allow an attacker to execute remote code without user interaction, leveraging the 'poll_set_add_fd' function in the 'extmod/modselect.c' file of MicroPython version 1.21.0/1.22.0-preview. Defending against this vulnerability requires validating the safety of function calls and memory allocations, and implementing robust memory management practices."}, {"techniqueID": "TA0021", "comment": "Exploitation for Client Execution - The use-after-free vulnerability in MicroPython's 'poll_set_add_fd' function could be exploited by an attacker to execute arbitrary code on the victim's system, further demonstrating the importance of secure coding practices and bug bounties in preventing such vulnerabilities."}, {"techniqueID": "TA0037", "comment": "Indicator Removal on Host - A post-exfiltration action that suggests removing indicators on a compromised host to prevent detection. This highlights the need for threat visibility and correlation to identify and remove such indicators, as well as implementing robust threat hunting and incident response practices."}], "stix_bundle": "{\"bundle\": {\n\"objects\": [\n  {\n    \"id\": \"vulnerability:249158\",\n    \"type\": \"vulnerability\",\n    \"created\": \"2024-05-17T02:34:13.930\",\n    \"modified\": \"2024-05-17T02:34:13.930\",\n    \"name\": \"MicroPython Use-After-Free Vulnerability\",\n    \"description\": [\n      {\n        \"lang\": \"en\",\n        \"value\": \"A vulnerability in MicroPython's 'poll_set_add_fd' function could potentially allow an attacker to execute arbitrary code without user interaction.\"\n      }\n    ],\n    \"references\": [\n      {\n        \"url\": \"https://github.com/jimmo/micropython/commit/8b24aa36ba978eafc6114b6798b47b7bfecdca26\",\n        \"source\": \"cna@vuldb.com\",\n        \"tags\": [\n          \"Patch\"\n        ]\n      },\n      {\n        \"url\": \"https://github.com/micropython/micropython/issues/12887\",\n        \"source\": \"cna@vuldb.com\",\n        \"tags\": [\n          \"Exploit\",\n          \"Issue Tracking\"\n        ]\n      },\n      ...more references...\n    ],\n    \"objects\": [\n      {\n        \"id\": \"indicator:249159\",\n        \"type\": \"indicator\",\n        \"created\": \"2024-05-17T02:34:13.930\",\n        \"modified\": \"2024-05-17T02:34:13.930\",\n        \"name\": \"Potential Exploit Indicators\",\n        \"description\": [\n          {\n            \"lang\": \"en\",\n            \"value\": \"A collection of indicators that may be used in an attempt to exploit the \">use-after-free\" vulnerability in MicroPython's 'poll_set_add_fd' function.\"\n          }\n        ],\n        \"relationships\": [\n          {\n            \"type\": \"used-by\",\n            \"id\": \"vulnerability:249158\",\n            \"role\": \"exploited-by\"\n          }\n        ]\n      },\n      {\n        \"id\": \"course-of-action:249160\",\n        \"type\": \"course-of-action\",\n        \"created\": \"2024-05-17T02:34:13.930\",\n        \"modified\": \"2024-05-17T02:34:13.930\",\n        \"name\": \"patching-vulnerable-systems\",\n        \"description\": [\n          {\n            \"lang\": \"en\",\n            \"value\": \"Applying the patch provided by the vendor to vulnerable systems to mitigate the potential threat.\"\n          }\n        ],\n        \"relationships\": [\n          {\n            \"type\": \"mitigates\",\n            \"id\": \"vulnerability:249158\",\n            \"role\": \"mitigated-by\"\n          }\n        ]\n      }\n    ]}}", "technical_analysis": {"Introduction": "The CVE-2023-7152 vulnerability is a critical weakness in MicroPython's 'poll_set_add_fd' function, allowing an attacker to execute remote code without user interaction. This analysis focuses on the technical aspects of the vulnerability, its impact, and mitigation strategies.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 (CRITICAL) and affects MicroPython versions 1.21.0 and 1.22.0-preview. It is highly exploitable and could lead to remote code execution, data theft, and system compromise.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: TA0001, TA0021, and TA0037.", "Technical Details": "The vulnerability is caused by a use-after-free error in the 'poll_set_add_fd' function, which allows an attacker to manipulate the function's internal state and execute arbitrary code.", "Detection": "Detection of this vulnerability requires analyzing system logs for suspicious network activity and monitoring for unusual process behavior.", "Mitigation": "The recommended mitigation strategy is to apply the patch provided by the vendor to vulnerable systems. Additionally, implementing security protocols such as threat hunting, incident response, and robust memory management practices can help prevent similar vulnerabilities in the future.", "Conclusion": "In conclusion, the CVE-2023-7152 vulnerability presents a significant threat to systems running affected MicroPython versions. Implementing the recommended mitigation strategies, as well as staying informed about potential exploits and vulnerabilities, is essential for maintaining system security."}, "executive_analysis": {"Overview": "The CVE-2023-7152 vulnerability is a critical weakness in MicroPython's 'poll_set_add_fd' function, affecting systems running affected versions. This analysis provides an executive-level overview of the vulnerability and recommended mitigation strategies.", "Business Impact": "The vulnerability has significant business implications, as it can lead to system compromise, data theft, and reputational damage. Executives should prioritize applying the patch and implementing security protocols to minimize the risk of exploitation.", "Technical Impact": "The vulnerability has a CVSS score of 9.8 (CRITICAL) and is highly exploitable, making it a significant technical risk. Technical teams should prioritize patching vulnerable systems and implementing robust security practices.", "Mitigation Strategies": "The recommended mitigation strategies are patching vulnerable systems, implementing threat hunting, incident response, and robust memory management practices.", "Recommendations": "Executives should prioritize applying the patch, implementing security protocols, and staying informed about potential exploits and vulnerabilities.", "Conclusions": "In conclusion, the CVE-2023-7152 vulnerability presents a significant risk to systems running affected MicroPython versions. Executives should prioritize mitigation strategies to minimize the risk of exploitation and maintain system security."}}