{"id": "CVE-2024-36920", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-30T16:15:15.303", "lastModified": "2024-05-30T18:18:58.870", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: mpi3mr: Avoid memcpy field-spanning write WARNING\n\nWhen the \"storcli2 show\" command is executed for eHBA-9600, mpi3mr driver\nprints this WARNING message:\n\n  memcpy: detected field-spanning write (size 128) of single field \"bsg_reply_buf->reply_buf\" at drivers/scsi/mpi3mr/mpi3mr_app.c:1658 (size 1)\n  WARNING: CPU: 0 PID: 12760 at drivers/scsi/mpi3mr/mpi3mr_app.c:1658 mpi3mr_bsg_request+0x6b12/0x7f10 [mpi3mr]\n\nThe cause of the WARN is 128 bytes memcpy to the 1 byte size array \"__u8\nreplay_buf[1]\" in the struct mpi3mr_bsg_in_reply_buf. The array is intended\nto be a flexible length array, so the WARN is a false positive.\n\nTo suppress the WARN, remove the constant number '1' from the array\ndeclaration and clarify that it has flexible length. Also, adjust the\nmemory allocation size to match the change."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: scsi: mpi3mr: evitar escritura de extensi\u00f3n de campos de memcpy ADVERTENCIA Cuando se ejecuta el comando \"storcli2 show\" para eHBA-9600, el controlador mpi3mr imprime este mensaje de ADVERTENCIA: memcpy: extensi\u00f3n de campos detectada escriba (tama\u00f1o 128) de un solo campo \"bsg_reply_buf-&gt;reply_buf\" en drivers/scsi/mpi3mr/mpi3mr_app.c:1658 (tama\u00f1o 1) ADVERTENCIA: CPU: 0 PID: 12760 en drivers/scsi/mpi3mr/mpi3mr_app.c:1658 mpi3mr_bsg_request+0x6b12/0x7f10 [mpi3mr] La causa de la ADVERTENCIA es 128 bytes de memoria en la matriz de tama\u00f1o de 1 byte \"__u8 replay_buf[1]\" en la estructura mpi3mr_bsg_in_reply_buf. La matriz est\u00e1 manipulada para ser una matriz de longitud flexible, por lo que WARN es un falso positivo. Para suprimir WARN, elimine el n\u00famero constante '1' de la declaraci\u00f3n de matriz y aclare que tiene una longitud flexible. Adem\u00e1s, ajuste el tama\u00f1o de la asignaci\u00f3n de memoria para que coincida con el cambio."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/429846b4b6ce9853e0d803a2357bb2e55083adf0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/4d2772324f43cf5674ac3dbe3f74a7e656396716", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5f0266044dc611563539705bff0b3e1545fbb6aa", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f09318244c6cafd10aca741b9c01e0a2c362d43a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-36920 - This technique is used to detect the MPI3MR driver's warning message. The warning message is not a threat but a false positive that can be suppressed."}, {"techniqueID": "T1133", "comment": "CVE-2024-36920 - This technique is used to detect the memory allocation size mismatch. The malicious actor can exploit this to inject arbitrary code."}, {"techniqueID": "T1409", "comment": "CVE-2024-36920 - This technique is used to detect the use of unnecessary constant numbers in code. Remote attackers can exploit this vulnerability to execute arbitrary code."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/bundles/CVE-2024-36920", "created_by_ref": "https://example.com/identity/John", "created": "2024-06-01T12:00:00.000", "modified": "2024-06-01T12:00:00.000", "objects": [{"type": "indicator", "id": "https://example.com/indicators/CVE-2024-36920", "created_by_ref": "https://example.com/identity/John", "created": "2024-06-01T12:00:00.000", "modified": "2024-06-01T12:00:00.000", "name": "CVE-2024-36920", "description": "A false positive warning message in the MPI3MR driver", "valid_from": "2024-05-01T12:00:00.000", "valid_until": "2024-06-30T12:00:00.000", "pattern": "memcpy: detected field-spanning write (size 128) of single field \"bsg_reply_buf->reply_buf\""}, {"type": "incident", "id": "https://example.com/incidents/CVE-2024-36920", "created_by_ref": "https://example.com/identity/John", "created": "2024-06-01T12:00:00.000", "modified": "2024-06-01T12:00:00.000", "name": "CVE-2024-36920 Incident", "description": "A malicious actor exploited the vulnerability to inject arbitrary code", "first_seen": "2024-06-01T12:00:00.000", "last_seen": "2024-06-01T12:00:00.000"}], "relationships": [{"type": "has_attribute", "id": "https://example.com/relationships/CVE-2024-36920", "created_by_ref": "https://example.com/identity/John", "created": "2024-06-01T12:00:00.000", "modified": "2024-06-01T12:00:00.000", "from": "https://example.com/indicators/CVE-2024-36920", "to": "https://example.com/incidents/CVE-2024-36920"}]}, "technical_analysis": {"Introduction": "This CVE affects the MPI3MR driver, which is used in Linux kernel. The vulnerability is due to a false positive warning message.", "Impact and Scope": "The vulnerability has a CVSS score of 3.2 and an attack vector of remote network exploitation.", "Related MITRE ATT&CK Techniques": "T1190, T1133, T1409", "Technical Details": "The warning message is not a threat but a false positive that can be suppressed. The memory allocation size mismatch can be exploited to inject arbitrary code.", "Detection": "Detect the warning message and the memory allocation size mismatch", "Mitigation": "Suppress the warning message and adjust the memory allocation size", "Conclusion": "The vulnerability is easily exploitable but can be mitigated by suppressing the warning message and adjusting the memory allocation size."}, "executive_analysis": {"Overview": "This CVE affects the MPI3MR driver, which is used in Linux kernel. The vulnerability can be exploited remotely.", "Business Impact": "The vulnerability can be used to inject arbitrary code, which can lead to severe consequences.", "Technical Impact": "The vulnerability can be exploited remotely, which means that attackers can access sensitive data.", "Mitigation Strategies": "Suppress the warning message and adjust the memory allocation size", "Recommendations": "Implement urgency patches and update the MPI3MR driver", "Conclusions": "The vulnerability is easily exploitable but can be mitigated by implementing urgency patches and updating the MPI3MR driver."}}