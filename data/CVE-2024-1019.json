{"id": "CVE-2024-1019", "sourceIdentifier": "vulnerability@ncsc.ch", "published": "2024-01-30T16:15:47.123", "lastModified": "2024-02-20T02:15:49.973", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "ModSecurity / libModSecurity 3.0.0 to 3.0.11 is affected by a WAF bypass for path-based payloads submitted via specially crafted request URLs. ModSecurity v3 decodes percent-encoded characters present in request URLs before it separates the URL path component from the optional query string component. This results in an impedance mismatch versus RFC compliant back-end applications. The vulnerability hides an attack payload in the path component of the URL from WAF rules inspecting it. A back-end may be vulnerable if it uses the path component of request URLs to construct queries. Integrators and users are advised to upgrade to 3.0.12. The ModSecurity v2 release line is not affected by this vulnerability.\n"}, {"lang": "es", "value": "ModSecurity/libModSecurity 3.0.0 a 3.0.11 se ve afectado por una omisi\u00f3n de WAF para payloads basados en rutas enviados a trav\u00e9s de URL de solicitud especialmente manipuladas. ModSecurity v3 decodifica los caracteres codificados en porcentaje presentes en las URL de solicitud antes de separar el componente de ruta URL del componente de cadena de consulta opcional. Esto da como resultado una discrepancia de impedancia en comparaci\u00f3n con las aplicaciones de back-end que cumplen con RFC. La vulnerabilidad oculta un payload de ataque en el componente de ruta de la URL de las reglas WAF que la inspeccionan. Un back-end puede ser vulnerable si utiliza el componente de ruta de las URL de solicitud para construir consultas. Se recomienda a los integradores y usuarios que actualicen a 3.0.12. La l\u00ednea de lanzamiento ModSecurity v2 no se ve afectada por esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.6, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 4.0}, {"source": "vulnerability@ncsc.ch", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.6, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 4.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "vulnerability@ncsc.ch", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:trustwave:modsecurity:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.0.0", "versionEndExcluding": "3.0.12", "matchCriteriaId": "52EBFAFE-523F-46B7-9631-4FA866ABC2D0"}]}]}], "references": [{"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/34KDQNZE2RS3CWFG5654LNHKXXDPIW5I/", "source": "vulnerability@ncsc.ch"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/K6ZGABPJK2JPVH2JDFHZ5LQLWGONUH7V/", "source": "vulnerability@ncsc.ch"}, {"url": "https://owasp.org/www-project-modsecurity/tab_cves#cve-2024-1019-2024-01-30", "source": "vulnerability@ncsc.ch", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0003", "comment": "CVE-2024-1019 - This vulnerability is related to command and scripting interpretation, which can be detected by monitoring for unusual command-line arguments or script execution."}, {"techniqueID": "T1190", "comment": "CVE-2024-1019 - This vulnerability can be used as a command and control channel, allowing attackers to execute commands on the affected system. This can be detected by monitoring for unusual network traffic patterns."}, {"techniqueID": "T1218", "comment": "CVE-2024-1019 - This vulnerability can be used to modify or delete files, which can be detected by monitoring for unusual file system changes."}, {"techniqueID": "T1566", "comment": "CVE-2024-1019 - This vulnerability can be used as a jumping-off point for further attacks, allowing attackers to pivot to other systems or applications. This can be detected by monitoring for unusual network traffic patterns."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "urn:x-ci-bundle:CVE-2024-1019", "name": "CVE-2024-1019", "created_by_ref": "urn:x-ci-user:securityanalyst", "created": "2024-02-20T02:15:49.973Z", "modified": "2024-02-20T02:15:49.973Z", "objects": [{"type": "vulnerability", "id": "urn:x-ci-vulnerability:CVE-2024-1019", "name": "CVE-2024-1019", "description": "ModSecurity / libModSecurity 3.0.0 to 3.0.11 is affected by a WAF bypass for path-based payloads submitted via specially crafted request URLs.", "published": "2024-01-30T16:15:47.123Z", "last_modified": "2024-02-20T02:15:49.973Z", "cve_data_id": "CVE-2024-1019", "cvss": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.6, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 4.0}}, {"type": "course-of-action", "id": "urn:x-ci-course-of-action:mitigation-CVE-2024-1019", "name": "Mitigation strategy", "description": "Apply patch 3.0.12 to ModSecurity / libModSecurity 3.0.0 to 3.0.11", "techniques": [{"type": "technique", "id": "urn:x-ci-technique:TA0003", "name": "Command and Scripting Interpretation", "description": "Monitor for unusual command-line arguments or script execution"}]}], "relationships": [{"type": "has_vulnerability", "id": "urn:x-ci-relationship:CVE-2024-1019", "source_ref": "urn:x-ci-vulnerability:CVE-2024-1019", "target_ref": "urn:x-ci-course-of-action:mitigation-CVE-2024-1019"}]}}, "technical_analysis": {"Introduction": "The CVE-2024-1019 vulnerability is a path-based WAF bypass in ModSecurity / libModSecurity 3.0.0 to 3.0.11.", "Impact and Scope": "The vulnerability has a CVSS score of 8.6, with a high impact on integrity. It can be exploited over a network.", "Related MITRE ATT&CK Techniques": "TA0003, T1190, T1218, T1566", "Technical Details": "The vulnerability hides an attack payload in the path component of the URL from WAF rules inspecting it. A back-end may be vulnerable if it uses the path component of request URLs to construct queries.", "Detection": "Monitor for unusual command-line arguments or script execution, unusual file system changes, unusual network traffic patterns.", "Mitigation": "Apply patch 3.0.12 to ModSecurity / libModSecurity 3.0.0 to 3.0.11", "Conclusion": "The CVE-2024-1019 vulnerability is a high-severity vulnerability that can be exploited over a network. It is recommended to apply the patch to mitigate the vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-1019 vulnerability is a high-severity vulnerability in ModSecurity / libModSecurity 3.0.0 to 3.0.11.", "Business Impact": "The vulnerability can allow attackers to execute commands on the affected system, which can lead to unauthorized access and data modification.", "Technical Impact": "The vulnerability can be exploited over a network, and can be used as a jumping-off point for further attacks.", "Mitigation Strategies": "Apply patch 3.0.12 to ModSecurity / libModSecurity 3.0.0 to 3.0.11", "Recommendations": "It is recommended to apply the patch to mitigate the vulnerability. Additionally, monitor for unusual command-line arguments or script execution, unusual file system changes, and unusual network traffic patterns.", "Conclusions": "The CVE-2024-1019 vulnerability is a high-severity vulnerability that requires immediate attention. It is recommended to apply the patch and monitor for signs of exploitation."}}