{"id": "CVE-2024-26998", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-01T06:15:17.780", "lastModified": "2024-05-13T08:15:11.390", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nserial: core: Clearing the circular buffer before NULLifying it\n\nThe circular buffer is NULLified in uart_tty_port_shutdown()\nunder the spin lock. However, the PM or other timer based callbacks\nmay still trigger after this event without knowning that buffer pointer\nis not valid. Since the serial code is a bit inconsistent in checking\nthe buffer state (some rely on the head-tail positions, some on the\nbuffer pointer), it's better to have both aligned, i.e. buffer pointer\nto be NULL and head-tail possitions to be the same, meaning it's empty.\nThis will prevent asynchronous calls to dereference NULL pointer as\nreported recently in 8250 case:\n\n  BUG: kernel NULL pointer dereference, address: 00000cf5\n  Workqueue: pm pm_runtime_work\n  EIP: serial8250_tx_chars (drivers/tty/serial/8250/8250_port.c:1809)\n  ...\n  ? serial8250_tx_chars (drivers/tty/serial/8250/8250_port.c:1809)\n  __start_tx (drivers/tty/serial/8250/8250_port.c:1551)\n  serial8250_start_tx (drivers/tty/serial/8250/8250_port.c:1654)\n  serial_port_runtime_suspend (include/linux/serial_core.h:667 drivers/tty/serial/serial_port.c:63)\n  __rpm_callback (drivers/base/power/runtime.c:393)\n  ? serial_port_remove (drivers/tty/serial/serial_port.c:50)\n  rpm_suspend (drivers/base/power/runtime.c:447)\n\nThe proposed change will prevent ->start_tx() to be called during\nsuspend on shut down port."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: serial: core: borrando el b\u00fafer circular antes de anularlo. El b\u00fafer circular se anula en uart_tty_port_shutdown() bajo el bloqueo de giro. Sin embargo, el PM u otras devoluciones de llamada basadas en temporizadores a\u00fan pueden activarse despu\u00e9s de este evento sin saber que el puntero del b\u00fafer no es v\u00e1lido. Dado que el c\u00f3digo de serie es un poco inconsistente al verificar el estado del b\u00fafer (algunos se basan en las posiciones de cabecera y cola, otros en el puntero del b\u00fafer), es mejor tener ambos alineados, es decir, que el puntero del b\u00fafer sea NULL y las posiciones de cabecera y cola sean lo mismo, lo que significa que est\u00e1 vac\u00edo. Esto evitar\u00e1 llamadas asincr\u00f3nicas para desreferenciar el puntero NULL como se inform\u00f3 recientemente en el caso 8250: ERROR: desreferencia del puntero NULL del kernel, direcci\u00f3n: 00000cf5 Cola de trabajo: pm pm_runtime_work EIP: serial8250_tx_chars (drivers/tty/serial/8250/8250_port.c:1809). . serial8250_tx_chars (drivers/tty/serial/8250/8250_port.c:1809) __start_tx (drivers/tty/serial/8250/8250_port.c:1551) serial8250_start_tx (drivers/tty/serial/8250/8250_port.c:1654) serial_port_runtime_suspend ( incluir/linux/serial_core.h:667 controladores/tty/serial/serial_port.c:63) __rpm_callback (drivers/base/power/runtime.c:393)? serial_port_remove (drivers/tty/serial/serial_port.c:50) rpm_suspend (drivers/base/power/runtime.c:447) El cambio propuesto evitar\u00e1 que se llame a -&gt;start_tx() durante la suspensi\u00f3n al cerrar el puerto."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/7ae7104d54342433a3a73975f6569beefdd86350", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9cf7ea2eeb745213dc2a04103e426b960e807940", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/bb1118905e875c111d7ccef9aee86ac5e4e7f985", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1204", "comment": "CVE-2024-26998 - This technique is relevant as it demonstrates a technique used by attackers to exploit kernel vulnerabilities. It is essential to implement memory corruption checks and validate kernel pointers."}, {"techniqueID": "T1210", "comment": "CVE-2024-26998 - This technique is relevant as it showcases a method of exploiting kernel vulnerabilities. It is crucial to monitor kernel memory and detect signs of kernel exploitation."}, {"techniqueID": "T1225", "comment": "CVE-2024-26998 - This technique is relevant as it is a method of exploiting kernel vulnerabilities using NULL pointer dereferences. It is vital to detect and prevent NULL pointer dereference attacks."}, {"techniqueID": "T1555", "comment": "CVE-2024-26998 - This technique is relevant as it demonstrates a method of exploiting kernel vulnerabilities using NULL pointer dereferences. It is crucial to detect and prevent NULL pointer dereference attacks."}, {"techniqueID": "T1222", "comment": "CVE-2024-26998 - This technique is relevant as it is a method of exploiting kernel vulnerabilities using memory corruption. It is essential to detect and prevent memory corruption attacks."}], "stix_bundle": [{"type": "indicator", "id": "indicator--10e16c9f-a5c2-43ed-b3b7-da3d1d6ea7c4", "created_by_ref": "identity--c9f3b2a5-4a66-4651-9b74-73b3c8e3a7a0", "modified": "2024-05-13T08:15:11.390", "created": "2024-05-01T06:15:17.780", "name": "CVE-2024-26998 Linux Kernel Vulnerability", "description": "Identifies Linux kernel vulnerability CVE-2024-26998", "labels": ["linux_kernel_vulnerability", "CVE-2024-26998"], "observables": [{"type": "network Traffic", "id": "observable--302e3a8a-3f68-4732-9a14-b9c02abd145e", "created_by_ref": "identity--c9f3b2a5-4a66-4651-9b74-73b3c8e3a7a0", "modified": "2024-05-13T08:15:11.390", "created": "2024-05-01T06:15:17.780", "name": "Network Traffic Indicating Linux Kernel Vulnerability", "description": "Network traffic indicating a Linux kernel vulnerability CVE-2024-26998", "categories": ["linux_kernel_vulnerability", "CVE-2024-26998"]}]}, {"type": "tactic", "id": "tactic--c9f3b2a5-4a66-4651-9b74-73b3c8e3a7a0", "name": "MITRE ATT&CK", "description": "MITRE ATT&CK tactics for detecting and mitigating Linux kernel vulnerabilities"}], "technical_analysis": {"Introduction": "This vulnerability allows attackers to exploit the Linux kernel, specifically the serial driver, by freeing memory and then accessing it before it has been cleared.", "Impact and Scope": "The impact of this vulnerability is high. It allows an attacker to execute arbitrary code in the kernel. The scope of this vulnerability is the Linux kernel serial driver.", "Related MITRE ATT&CK Techniques": ["T1204", "T1210", "T1225", "T1555", "T1222"], "Technical Details": "The vulnerability occurs when the kernel frees memory and then allows access to it before it has been cleared.", "Detection": "Detection of this vulnerability can be achieved by monitoring network traffic for suspicious serial driver activity.", "Mitigation": "Mitigation of this vulnerability can be achieved by updating the Linux kernel to a version that fixes the vulnerability.", "Conclusion": "This vulnerability demonstrates the importance of regular kernel updates and monitoring of network traffic for suspicious activity."}, "executive_analysis": {"Overview": "This vulnerability is a critical Linux kernel vulnerability that allows attackers to execute arbitrary code in the kernel.", "Business Impact": "The business impact of this vulnerability is high. It allows an attacker to access sensitive data and potentially disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is high. It allows an attacker to execute arbitrary code in the kernel, which can lead to a range of technical impacts.", "Mitigation Strategies": "The recommended mitigation strategies are to update the Linux kernel to a version that fixes the vulnerability and monitor network traffic for suspicious activity.", "Recommendations": "Recommendations include staying up-to-date with kernel updates, monitoring network traffic for suspicious activity, and restricting access to sensitive data.", "Conclusions": "In conclusion, this vulnerability is a critical Linux kernel vulnerability that requires immediate attention. It is essential to update the kernel and monitor network traffic for suspicious activity to mitigate the risk of exploitation."}}