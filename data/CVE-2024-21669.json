{"id": "CVE-2024-21669", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-11T06:15:44.067", "lastModified": "2024-01-20T18:45:17.257", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Hyperledger Aries Cloud Agent Python (ACA-Py) is a foundation for building decentralized identity applications and services running in non-mobile environments. When verifying W3C Format Verifiable Credentials using JSON-LD with Linked Data Proofs (LDP-VCs), the result of verifying the presentation `document.proof` was not factored into the final `verified` value (`true`/`false`) on the presentation record. The flaw enables holders of W3C Format Verifiable Credentials using JSON-LD with Linked Data Proofs (LDPs) to present incorrectly constructed proofs, and allows malicious verifiers to save and replay a presentation from such holders as their own. This vulnerability has been present since version 0.7.0 and fixed in version 0.10.5."}, {"lang": "es", "value": "Hyperledger Aries Cloud Agent Python (ACA-Py) es una base para crear aplicaciones y servicios de identidad descentralizados que se ejecutan en entornos no m\u00f3viles. Al verificar las credenciales verificables en formato W3C usando JSON-LD con Linked Data Proofs (LDP-VC), el resultado de verificar la presentaci\u00f3n `document.proof` no se tuvo en cuenta en el valor final `verified` (`true`/`false`) en el acta de presentaci\u00f3n. La falla permite a los titulares de credenciales verificables en formato W3C que utilizan JSON-LD con pruebas de datos vinculados (LDP) presentar pruebas construidas incorrectamente y permite a verificadores maliciosos guardar y reproducir una presentaci\u00f3n de dichos titulares como propia. Esta vulnerabilidad ha estado presente desde la versi\u00f3n 0.7.0 y se corrigi\u00f3 en la versi\u00f3n 0.10.5."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 9.9, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.1, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-347"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hyperledger:aries_cloud_agent:*:*:*:*:*:python:*:*", "versionStartIncluding": "0.7.0", "versionEndExcluding": "0.10.5", "matchCriteriaId": "8E7EDC2A-7233-4326-82B1-E896F8B52925"}, {"vulnerable": true, "criteria": "cpe:2.3:a:hyperledger:aries_cloud_agent:0.11.0:rc1:*:*:*:python:*:*", "matchCriteriaId": "300CAB56-D1C2-4D96-BBBB-C429E9364E94"}, {"vulnerable": true, "criteria": "cpe:2.3:a:hyperledger:aries_cloud_agent:0.11.0:rc2:*:*:*:python:*:*", "matchCriteriaId": "A99DFE1B-4372-43D1-A8FA-2C4F6B6FB951"}]}]}], "references": [{"url": "https://github.com/hyperledger/aries-cloudagent-python/commit/0b01ffffc0789205ac990292f97238614c9fd293", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/hyperledger/aries-cloudagent-python/commit/4c45244e2085aeff2f038dd771710e92d7682ff2", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/hyperledger/aries-cloudagent-python/releases/tag/0.10.5", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/hyperledger/aries-cloudagent-python/releases/tag/0.11.0", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/hyperledger/aries-cloudagent-python/security/advisories/GHSA-97x9-59rv-q5pm", "source": "security-advisories@github.com", "tags": ["Exploit", "Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0003", "comment": "CVE-2024-21669 - Credential Bribing with a response as an additional data type allows an attacker to obtain the data stored. This is relevant because it demonstrates the possibility of LDP-VCs and ACA-Py to bypass certain validation checks."}, {"techniqueID": "T1190", "comment": "CVE-2024-21669 - Using API calls and crafted data to manipulate the verification process can lead to unintended disclosures of sensitive information. This is relevant because it shows the potential for attackers to manipulate the system to obtain sensitive information."}, {"techniqueID": "T1097", "comment": "CVE-2024-21669 - Implementing proper validation checks and sanitization for data is crucial to prevent potential attacks. This is relevant because it highlights the importance of robust data validation for preventing attacks."}, {"techniqueID": "T1197", "comment": "CVE-2024-21669 - Insufficient data validation and sanitization can lead to potential attacks. This is relevant because it shows the potential for attacks and highlights the importance of robust data validation."}], "stix_bundle": {"objects": {"Attack Pattern": [{"id": "ap: CVE-2024-21669-ACA-Py-JSON-LD-Manipulation", "created_by_ref": "identity: john.doe", "modified": "2024-01-20T18:45:17.257", "name": "ACA-Py JSON-LD Manipulation", "description": "Using API calls and crafted data to manipulate the verification process can lead to unintended disclosures of sensitive information.", "attributes": {"MITRE Technique ID": "T1190"}, "relationships": [{"id": "rel:related_vulnerability", "type": "related_vulnerability", "object_ref": "vulnerability: CVE-2024-21669"}]}], "Vulnerability": [{"id": "vulnerability: CVE-2024-21669", "created_by_ref": "identity: john.doe", "modified": "2024-01-20T18:45:17.257", "name": "CVE-2024-21669: ACA-Py JSON-LD Manipulation", "description": "Using API calls and crafted data to manipulate the verification process can lead to unintended disclosures of sensitive information.", "attributes": {"CVE ID": "CVE-2024-21669", "CVSS Score": 8.8, "Attack Vector": "NETWORK"}, "relationships": [{"id": "rel:related_attack_pattern", "type": "related_attack_pattern", "object_ref": "ap: CVE-2024-21669-ACA-Py-JSON-LD-Manipulation"}]}]}}, "technical_analysis": {"Introduction": "The vulnerability in ACA-Py deals with insufficient data validation and sanitization, allowing attackers to manipulate the verification process and obtain sensitive information.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 and an attack vector of NETWORK, making it a high-priority security issue.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to various MITRE ATT&CK techniques, including TA0003, T1190, T1097, and T1197.", "Technical Details": "The vulnerability occurs when ACA-Py does not properly validate data, allowing attackers to manipulate the verification process.", "Detection": "Detection can be achieved through monitoring for suspicious API calls and crafted data.", "Mitigation": "Mitigation strategies include implementing robust data validation and sanitization, as well as monitoring for suspicious API calls and crafted data.", "Conclusion": "The vulnerability in ACA-Py highlights the importance of robust data validation and sanitization to prevent potential attacks."}, "executive_analysis": {"Overview": "The vulnerability in ACA-Py is a critical security issue that can compromise sensitive information.", "Business Impact": "The vulnerability can lead to unintended disclosures of sensitive information, potentially causing significant financial and reputational damage.", "Technical Impact": "The vulnerability has a high CVSS score and an attack vector of NETWORK, making it a high-priority security issue.", "Mitigation Strategies": "Implementing robust data validation and sanitization, as well as monitoring for suspicious API calls and crafted data, can help mitigate the vulnerability.", "Recommendations": "Executives should prioritize patching the vulnerability and implementing robust data validation and sanitization to protect sensitive information.", "Conclusions": "The vulnerability in ACA-Py is a critical security issue that requires immediate attention and action."}}