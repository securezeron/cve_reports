{"id": "CVE-2024-22191", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-16T22:15:46.020", "lastModified": "2024-01-24T18:13:53.947", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Avo is a framework to create admin panels for Ruby on Rails apps. A stored cross-site scripting (XSS) vulnerability was found in the key_value field of Avo v3.2.3 and v2.46.0. This vulnerability could allow an attacker to execute arbitrary JavaScript code in the victim's browser. The value of the key_value is inserted directly into the HTML code. In the current version of Avo (possibly also older versions), the value is not properly sanitized before it is inserted into the HTML code. This vulnerability could be used to steal sensitive information from victims that could be used to hijack victims' accounts or redirect them to malicious websites. Avo 3.2.4 and 2.47.0 include a fix for this issue. Users are advised to upgrade."}, {"lang": "es", "value": "Avo es un framework para crear paneles de administraci\u00f3n para aplicaciones Ruby on Rails. Se encontr\u00f3 una vulnerabilidad de cross site scripting (XSS) almacenado en el campo key_value de Avo v3.2.3. Esta vulnerabilidad podr\u00eda permitir a un atacante ejecutar c\u00f3digo JavaScript arbitrario en el navegador de la v\u00edctima. El valor de key_value se inserta directamente en el c\u00f3digo HTML. En la versi\u00f3n actual de Avo (posiblemente tambi\u00e9n en versiones anteriores), el valor no se sanitiza adecuadamente antes de insertarlo en el c\u00f3digo HTML. Esta vulnerabilidad podr\u00eda usarse para robar informaci\u00f3n confidencial de las v\u00edctimas que podr\u00eda usarse para secuestrar las cuentas de las v\u00edctimas o redirigirlas a sitios web maliciosos. Avo 3.2.4 incluye una soluci\u00f3n para este problema. Se recomienda a los usuarios que actualicen."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.1, "impactScore": 5.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:avohq:avo:*:*:*:*:*:ruby:*:*", "versionEndExcluding": "2.47.0", "matchCriteriaId": "C6D742CC-21F8-4D5B-BA37-6A3273DEEE5E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:avohq:avo:*:*:*:*:*:ruby:*:*", "versionStartIncluding": "3.0.0", "versionEndExcluding": "3.3.0", "matchCriteriaId": "05D03894-17B7-4A0F-B580-9BA3F9D71F7B"}]}]}], "references": [{"url": "https://github.com/avo-hq/avo/commit/51bb80b181cd8e31744bdc4e7f9b501c81172347", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/avo-hq/avo/commit/fc92a05a8556b1787c8694643286a1afa6a71258", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/avo-hq/avo/security/advisories/GHSA-ghjv-mh6x-7q6h", "source": "security-advisories@github.com", "tags": ["Exploit", "Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0002", "comment": "CVE-2024-22191 - A stored XSS vulnerability allows an attacker to execute arbitrary JavaScript code in the victim's browser, which can be used to steal sensitive information or hijack accounts. Defense: Implement input validation and sanitization on user-inputted data to prevent malicious payloads from being injected into the browser."}, {"techniqueID": "TA0010", "comment": "CVE-2024-22191 - The vulnerability allows an attacker to execute arbitrary code in the victim's browser, which can be used to steal sensitive information or hijack accounts. Defense: Implement secure coding practices and review application code for vulnerabilities."}, {"techniqueID": "TA0005", "comment": "CVE-2024-22191 - An attacker can inject malicious code into the browser, which can be used to steal sensitive information or hijack accounts. Defense: Implement browser security features, such as content security policy (CSP), to restrict the types of scripts that can be executed in the browser."}], "stix_bundle": {"type": "bundle", "id": "CVE-2024-22191", "created_by_ref": "identity@cto.fivepoints", "created": "2024-01-16T22:15:46.020", "modified": "2024-01-24T18:13:53.947", "objects": [{"type": "vulnerability", "id": "CVE-2024-22191"}, {"type": "indicator", "id": "indicator-1", "created_by_ref": "identity@cto.fivepoints", "created": "2024-01-16T22:15:46.020", "modified": "2024-01-24T18:13:53.947", "name": "CVE-2024-22191 Stored XSS"}, {"type": "course_of_action", "id": "COA-1", "created_by_ref": "identity@cto.fivepoints", "created": "2024-01-16T22:15:46.020", "modified": "2024-01-24T18:13:53.947", "name": "Apply Patch", "description": "Apply the latest patch for Avo to fix the vulnerability", "mitigates": [{"relationship": "mitigates", "target_ref": "indicator-1"}]}, {"type": "course_of_action", "id": "COA-2", "created_by_ref": "identity@cto.fivepoints", "created": "2024-01-16T22:15:46.020", "modified": "2024-01-24T18:13:53.947", "name": "Sanitize User-Input Data", "description": "Sanitize and validate user-inputted data to prevent XSS attacks", "mitigates": [{"relationship": "mitigates", "target_ref": "indicator-1"}]}], "relationships": [{"type": "relates", "id": "relates-1", "target_ref": "vulnerability@cto.fivepoints", "source_ref": "indicator-1"}]}, "technical_analysis": {"Introduction": "CVE-2024-22191 is a stored cross-site scripting (XSS) vulnerability in Avo, a framework for creating admin panels for Ruby on Rails apps.", "Impact and Scope": "This vulnerability allows an attacker to execute arbitrary JavaScript code in the victim's browser, which can be used to steal sensitive information or hijack accounts. The attack vector is network-based, and the vulnerability affects Avo versions 3.2.3 and 2.46.0.", "Related MITRE ATT&CK Techniques": "TA0002, TA0010, TA0005", "Technical Details": "The vulnerability occurs when user-inputted data is inserted directly into the HTML code without proper sanitization. An attacker can inject malicious code into the browser, which can be used to steal sensitive information or hijack accounts.", "Detection": "Detect this vulnerability by monitoring for suspicious JavaScript code execution or network traffic pertaining to malicious payloads.", "Mitigation": "Apply the latest patch for Avo, sanitize and validate user-inputted data, and implement browser security features such as content security policy (CSP).", "Conclusion": "CVE-2024-22191 is a significant vulnerability that requires immediate attention. Applying the latest patch and implementing proper sanitization and validation of user-inputted data can help mitigate the risks associated with this vulnerability."}, "executive_analysis": {"Overview": "CVE-2024-22191 is a potential security risk that can lead to the theft of sensitive information or hijacking of accounts.", "Business Impact": "This vulnerability can have significant business implications, including data theft, reputational damage, and financial losses.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary JavaScript code in the victim's browser, which can be used to steal sensitive information or hijack accounts.", "Mitigation Strategies": "Apply the latest patch for Avo, sanitize and validate user-inputted data, and implement browser security features such as content security policy (CSP).", "Recommendations": "Executives should prioritize applying the latest patch and implementing proper mitigations to minimize the risks associated with this vulnerability.", "Conclusions": "CVE-2024-22191 is a critical vulnerability that requires immediate attention. Executives should take immediate action to mitigate the risks associated with this vulnerability."}}