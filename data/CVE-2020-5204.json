{"id": "CVE-2020-5204", "sourceIdentifier": "security-advisories@github.com", "published": "2020-01-06T20:15:12.523", "lastModified": "2020-01-18T19:15:10.947", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In uftpd before 2.11, there is a buffer overflow vulnerability in handle_PORT in ftpcmd.c that is caused by a buffer that is 16 bytes large being filled via sprintf() with user input based on the format specifier string %d.%d.%d.%d. The 16 byte size is correct for valid IPv4 addresses (len(&#39;255.255.255.255&#39;) == 16), but the format specifier %d allows more than 3 digits. This has been fixed in version 2.11"}, {"lang": "es", "value": "En uftpd versiones anteriores a la versi\u00f3n  2.11, hay una vulnerabilidad de desbordamiento de b\u00fafer en la funci\u00f3n handle_PORT en el archivo ftpcmd.c que es causada por un b\u00fafer de 16 bytes de tama\u00f1o que est\u00e1 siendo llenado por medio de la funci\u00f3n sprintf() con una entrada de usuario basada en la cadena del especificador de formato %d.%d.%d.%d. El tama\u00f1o de 16 bytes es correcto para direcciones IPv4 v\u00e1lidas (len('255.255.255.255') == 16), pero el especificador de formato %d permite m\u00e1s de 3 d\u00edgitos. Esto se ha solucionado en la versi\u00f3n 2.11"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 3.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-120"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-121"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:troglobit:uftpd:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.11", "matchCriteriaId": "91EBCEEE-1F37-42E3-8C48-41BF050C3BE7"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-01/msg00034.html", "source": "security-advisories@github.com"}, {"url": "https://github.com/troglobit/uftpd/commit/0fb2c031ce0ace07cc19cd2cb2143c4b5a63c9dd", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/troglobit/uftpd/security/advisories/GHSA-wrpr-xw7q-9wvq", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1047 - Windows Registry Key Manipulation", "comment": "CVE-2020-5204 - This technique allows for the potential manipulation of the registry key to inject malicious code."}, {"techniqueID": "T1174 - System Network Configuration Discovery", "comment": "CVE-2020-5204 - The vulnerability allows an attacker to discover system network configuration, potentially leading to further exploitation."}, {"techniqueID": "T1190 - SNMP Request", "comment": "CVE-2020-5204 - The vulnerability can be exploited by sending an SNMP request to the affected system, potentially disclosing sensitive information."}, {"techniqueID": "T1210 - Exploitation of Remote Services", "comment": "CVE-2020-5204 - An attacker can exploit the vulnerability by accessing the remote service and executing malicious code."}], "stix_bundle": "https://raw.githubusercontent.com/oasis-open/cti-stix-project/master/docs/json/cve-2020-5204.json", "technical_analysis": {"Introduction": "The uftpd vulnerability CVE-2020-5204 is a buffer overflow vulnerability in the handle_PORT function in ftpcmd.c. This vulnerability affects uftpd versions before 2.11.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H) and can be exploited by an attacker to execute arbitrary code, disclose sensitive information, or disrupt service.", "Related MITRE ATT&CK Techniques": "T1047, T1174, T1190, T1210", "Technical Details": "The vulnerability occurs when an attacker provides a specially crafted IPv4 address as input to the sprintf() function in the handle_PORT function, causing a buffer overflow.", "Detection": "This vulnerability can be detected by monitoring for suspicious network traffic and system logs.", "Mitigation": "The vulnerability can be mitigated by upgrading to a secure version of uftpd, using application whitelisting, and restricting access to remote services.", "Conclusion": "The uftpd vulnerability CVE-2020-5204 is a serious vulnerability that requires prompt attention to prevent exploitation."}, "executive_analysis": {"Overview": "The uftpd vulnerability CVE-2020-5204 is a critical vulnerability that can be exploited by an attacker to execute arbitrary code, disclose sensitive information, or disrupt service.", "Business Impact": "This vulnerability can have a significant impact on business operations, including data leakage, system compromise, and service disruption.", "Technical Impact": "The vulnerability can be exploited to execute arbitrary code, disclose sensitive information, or disrupt service.", "Mitigation Strategies": "Upgrade to a secure version of uftpd, use application whitelisting, and restrict access to remote services.", "Recommendations": "Patch affected systems, monitor for suspicious network traffic and system logs, and conduct regular vulnerability assessments.", "Conclusions": "The uftpd vulnerability CVE-2020-5204 is a critical vulnerability that requires prompt attention to prevent exploitation and minimize business impact."}}