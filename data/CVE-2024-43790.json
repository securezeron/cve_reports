{"id": "CVE-2024-43790", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-22T22:15:05.317", "lastModified": "2024-08-23T16:18:28.547", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Vim is an open source command line text editor. When performing a search and displaying the search-count message is disabled (:set shm+=S), the search pattern is displayed at the bottom of the screen in a buffer (msgbuf). When right-left mode (:set rl) is enabled, the search pattern is reversed. This happens by allocating a new buffer. If the search pattern contains some ASCII NUL characters, the buffer allocated will be smaller than the original allocated buffer (because for allocating the reversed buffer, the strlen() function is called, which only counts until it notices an ASCII NUL byte ) and thus the original length indicator is wrong. This causes an overflow when accessing characters inside the msgbuf by the previously (now wrong) length of the msgbuf. The issue has been fixed as of Vim patch v9.1.0689."}, {"lang": "es", "value": "Vim es un editor de texto de l\u00ednea de comandos de c\u00f3digo abierto. Cuando se realiza una b\u00fasqueda y se deshabilita la visualizaci\u00f3n del mensaje de recuento de b\u00fasqueda (:set shm+=S), el patr\u00f3n de b\u00fasqueda se muestra en la parte inferior de la pantalla en un b\u00fafer (msgbuf). Cuando el modo derecha-izquierda (:set rl) est\u00e1 habilitado, el patr\u00f3n de b\u00fasqueda se invierte. Esto sucede asignando un nuevo b\u00fafer. Si el patr\u00f3n de b\u00fasqueda contiene algunos caracteres ASCII NUL, el b\u00fafer asignado ser\u00e1 m\u00e1s peque\u00f1o que el b\u00fafer asignado original (porque para asignar el b\u00fafer invertido, se llama a la funci\u00f3n strlen(), que solo cuenta hasta que detecta un byte ASCII NUL) y por lo tanto el indicador de longitud original es incorrecto. Esto provoca un desbordamiento al acceder a caracteres dentro del msgbuf por la longitud anterior (ahora incorrecta) del msgbuf. El problema se solucion\u00f3 a partir del parche Vim v9.1.0689."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 3.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-122"}]}], "references": [{"url": "https://github.com/vim/vim/commit/cacb6693c10bb19f28a50eca47bc", "source": "security-advisories@github.com"}, {"url": "https://github.com/vim/vim/security/advisories/GHSA-v2x2-cjcg-f9jm", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1204.001: Input Validation", "comment": "CVE-2024-43790 - Due to CWE-122, an attacker could potentially inject malicious data, leading to an overflow attack."}, {"techniqueID": "T1210: Exploit Public-Facing Application", "comment": "CVE-2024-43790 - As an open-source command-line text editor, Vim is a public-facing application that could be targeted by attackers."}, {"techniqueID": "T1190: Expoit Vulnerability", "comment": "CVE-2024-43790 - The vulnerability in Vim's search and display function could be exploited to gain unauthorized access."}, {"techniqueID": "T1027: Obfuscated Files or Information", "comment": "CVE-2024-43790 - Attackers may use obfuscated files or information to hide their malicious activities."}, {"techniqueID": "T1033: Unexpected Registry Value", "comment": "CVE-2024-43790 - The vulnerability in Vim's search and display function could be exploited to alter registry values."}], "stix_bundle": "Insert STIX 2.1 bundle here", "technical_analysis": {"Introduction": "Vim is an open-source command-line text editor that suffers from a CWE-122 vulnerability in its search and display function. This vulnerability could be exploited to cause an overflow attack.", "Impact and Scope": "The vulnerability has a CVSS score of 4.5 (Medium) and occurs when performing a search and displaying the search-count message is disabled (:set shm+=S).", "Related MITRE ATT&CK Techniques": "T1204.001, T1210, T1190, T1027, T1033", "Technical Details": "The vulnerability occurs when the search pattern contains ASCII NUL characters, causing the buffer allocated to be smaller than expected. This leads to an overflow when accessing characters in the msgbuf.", "Detection": "Detection methods include monitoring for unusual search patterns and buffer overflows.", "Mitigation": "Mitigation strategies include updating Vim to the patched version v9.1.0689 and disabling right-left mode (:set rl).", "Conclusion": "The CVE-2024-43790 vulnerability in Vim's search and display function poses a medium-level risk and should be addressed promptly."}, "executive_analysis": {"Overview": "Vim, an open-source command-line text editor, has a vulnerability that could allow attackers to exploit the system.", "Business Impact": "The vulnerability could lead to data breaches and unauthorized access, disrupting business operations.", "Technical Impact": "The vulnerability affects the search and display function of Vim, making it vulnerable to overflow attacks.", "Mitigation Strategies": "Regularly update Vim to the patched version and implement additional security measures to prevent exploitation.", "Recommendations": "Executives should prioritize updating Vim and implementing additional security measures to prevent exploitation.", "Conclusions": "The CVE-2024-43790 vulnerability in Vim's search and display function requires prompt attention and mitigation to ensure the security of the system."}}