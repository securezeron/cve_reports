{"id": "CVE-2020-11945", "sourceIdentifier": "cve@mitre.org", "published": "2020-04-23T15:15:14.233", "lastModified": "2023-11-07T03:15:15.630", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered in Squid before 5.0.2. A remote attacker can replay a sniffed Digest Authentication nonce to gain access to resources that are otherwise forbidden. This occurs because the attacker can overflow the nonce reference counter (a short integer). Remote code execution may occur if the pooled token credentials are freed (instead of replayed as valid credentials)."}, {"lang": "es", "value": "Se detect\u00f3 un problema en Squid versiones anteriores a 5.0.2. Un atacante remoto puede reproducir un nonce Digest Autenticaci\u00f3n rastreado para conseguir acceso a recursos que de otra manera est\u00e1n restringidos. Esto ocurre porque el atacante puede desbordar el contador de referencia nonce (un entero corto). Una ejecuci\u00f3n de c\u00f3digo remota puede presentarse si las credenciales de token agrupadas son liberadas (en lugar de reproducirse como credenciales validas)."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-190"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:squid-cache:squid:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.0", "versionEndIncluding": "3.5.28", "matchCriteriaId": "FC9F2659-B37B-4E7B-AE40-B91BF3CE4E88"}, {"vulnerable": true, "criteria": "cpe:2.3:a:squid-cache:squid:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0", "versionEndExcluding": "4.11", "matchCriteriaId": "AEA4C698-1DD0-4229-A80A-2437D56AA38D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:squid-cache:squid:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.0", "versionEndExcluding": "5.0.2", "matchCriteriaId": "665C9300-5D66-4653-84CB-F3C3500F9BBF"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*", "matchCriteriaId": "B620311B-34A3-48A6-82DF-6F078D7A4493"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:30:*:*:*:*:*:*:*", "matchCriteriaId": "97A4B8DF-58DA-4AB6-A1F9-331B36409BA3"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:31:*:*:*:*:*:*:*", "matchCriteriaId": "80F0FA5D-8D3B-4C0E-81E2-87998286AF33"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*", "matchCriteriaId": "36D96259-24BD-44E2-96D9-78CE1D41F956"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*", "matchCriteriaId": "F7016A2A-8365-4F1A-89A2-7A19F2BCAE5B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*", "matchCriteriaId": "23A7C53F-B80F-4E6A-AFA9-58EEA84BE11D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:19.10:*:*:*:*:*:*:*", "matchCriteriaId": "A31C8344-3E02-4EB8-8BD8-4C84B7959624"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:20.04:*:*:*:lts:*:*:*", "matchCriteriaId": "902B8056-9E37-443B-8905-8AA93E2447FB"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-05/msg00018.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://master.squid-cache.org/Versions/v4/changesets/squid-4-eeebf0f37a72a2de08348e85ae34b02c34e9a811.patch", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2020/04/23/2", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.squid-cache.org/Versions/v4/changesets/squid-4-eeebf0f37a72a2de08348e85ae34b02c34e9a811.patch", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://bugzilla.suse.com/show_bug.cgi?id=1170313", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/squid-cache/squid/commit/eeebf0f37a72a2de08348e85ae34b02c34e9a811", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/squid-cache/squid/pull/585", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2020/07/msg00009.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4FWQRYZJPHAZBLXJ56FPCHJN5X2FP3VA/", "source": "cve@mitre.org"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/H4MWXEZAJSOGRJSS2JCJK4WBSND4IV46/", "source": "cve@mitre.org"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RV2VZWFJNO3B56IVN56HHKJASG5DYUIX/", "source": "cve@mitre.org"}, {"url": "https://security.gentoo.org/glsa/202005-05", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20210304-0004/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/4356-1/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2020/dsa-4682", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-11945 - This technique is used to deface web pages. An attacker can use this vulnerability to gain access to a web application and deface its pages."}, {"techniqueID": "T1350", "comment": "CVE-2020-11945 - This technique is used to inject malicious code into web pages. An attacker can use this vulnerability to inject malicious code into a web application."}, {"techniqueID": "T1531", "comment": "CVE-2020-11945 - This technique is used to perform command injection. An attacker can use this vulnerability to perform command injection attacks on a web application."}, {"techniqueID": "T1550", "comment": "CVE-2020-11945 - This technique is used to perform directory traversal attacks. An attacker can use this vulnerability to perform directory traversal attacks on a web application."}, {"techniqueID": "T1621", "comment": "CVE-2020-11945 - This technique is used to perform persistent cross-site scripting (XSS) attacks. An attacker can use this vulnerability to perform persistent XSS attacks on a web application."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "cve-2020-11945", "objects": [{"type": "vulnerability", "id": "cve-2020-11945", "created": "2020-04-23T15:15:14.233Z", "modified": "2023-11-07T03:15:15.630Z", "name": "Squid before 5.0.2 Digest Authentication Null Pointer Dereference", "description": "An issue was discovered in Squid before 5.0.2. A remote attacker can replay a sniffed Digest Authentication nonce to gain access to resources that are otherwise forbidden.", "severity": "CRITICAL", "cvss": {"vector_string": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "base_score": 9.8}, "exploit_availability": "HIGH", "exploit_complexity": "MEDIUM", "reporter": "cve@mitre.org", "references": [{"scheme": "http", "value": "http://lists.opensuse.org/opensuse-security-announce/2020-05/msg00018.html"}, {"scheme": "http", "value": "http://master.squid-cache.org/Versions/v4/changesets/squid-4-eeebf0f37a72a2de08348e85ae34b02c34e9a811.patch"}, {"scheme": "http", "value": "http://www.openwall.com/lists/oss-security/2020/04/23/2"}, {"scheme": "http", "value": "http://www.squid-cache.org/Versions/v4/changesets/squid-4-eeebf0f37a72a2de08348e85ae34b02c34e9a811.patch"}, {"scheme": "https", "value": "https://bugzilla.suse.com/show_bug.cgi?id=1170313"}, {"scheme": "https", "value": "https://github.com/squid-cache/squid/commit/eeebf0f37a72a2de08348e85ae34b02c34e9a811"}, {"scheme": "https", "value": "https://github.com/squid-cache/squid/pull/585"}, {"scheme": "https", "value": "https://lists.debian.org/debian-lts-announce/2020/07/msg00009.html"}, {"scheme": "https", "value": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/4FWQRYZJPHAZBLXJ56FPCHJN5X2FP3VA/"}, {"scheme": "https", "value": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/H4MWXEZAJSOGRJSS2JCJK4WBSND4IV46/"}, {"scheme": "https", "value": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RV2VZWFJNO3B56IVN56HHKJASG5DYUIX/"}, {"scheme": "https", "value": "https://security.gentoo.org/glsa/202005-05"}, {"scheme": "https", "value": "https://security.netapp.com/advisory/ntap-20210304-0004/"}, {"scheme": "https", "value": "https://usn.ubuntu.com/4356-1/"}, {"scheme": "https", "value": "https://www.debian.org/security/2020/dsa-4682"}]}], "relationships": [{"type": "has_vulnerability", "id_ref": "cve-2020-11945", "id": " technique:T1190"}, {"type": "has_vulnerability", "id_ref": "cve-2020-11945", "id": "technique:T1350"}, {"type": "has_vulnerability", "id_ref": "cve-2020-11945", "id": "technique:T1531"}, {"type": "has_vulnerability", "id_ref": "cve-2020-11945", "id": "technique:T1550"}, {"type": "has_vulnerability", "id_ref": "cve-2020-11945", "id": "technique:T1621"}]}, "technical_analysis": {"Introduction": "The CVE-2020-11945 is a remote code execution vulnerability in Squid before 5.0.2. This vulnerability allows an attacker to replay a sniffed Digest Authentication nonce to gain access to resources that are otherwise forbidden.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 9.8. The scope of this vulnerability is limited to Squid before 5.0.2 and affects multiple operating systems, including Debian, Fedora, and Ubuntu.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1190, T1350, T1531, T1550, and T1621.", "Technical Details": "This vulnerability occurs when an attacker can sniff a Digest Authentication nonce and then replay it to gain access to resources that are otherwise forbidden. The attacker can use this vulnerability to perform remote code execution, directory traversal attacks, and persistent cross-site scripting attacks.", "Detection": "Detection of this vulnerability can be performed by monitoring network traffic for suspicious activity, such as a sudden increase in failed authentication attempts. Additionally, a vulnerability scanner can be used to identify the presence of the vulnerable Squid version.", "Mitigation": "The mitigation for this vulnerability is to upgrade Squid to version 5.0.2 or later. Additionally, implementing a Web Application Firewall (WAF) can help detect and prevent attempts to exploit this vulnerability.", "Conclusion": "In conclusion, the CVE-2020-11945 is a critical remote code execution vulnerability in Squid before 5.0.2. It is essential to upgrade Squid to a patched version and implement a WAF to prevent attempts to exploit this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2020-11945 is a critical remote code execution vulnerability in Squid before 5.0.2 that allows an attacker to gain access to resources that are otherwise forbidden.", "Business Impact": "The impact of this vulnerability on the business is significant, as it can lead to unauthorized access to sensitive data and systems.", "Technical Impact": "The technical impact of this vulnerability is limited to the affected Squid versions and operating systems.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability are to upgrade Squid to version 5.0.2 or later and implement a WAF to detect and prevent attempts to exploit this vulnerability.", "Recommendations": "It is recommended to prioritize the mitigation of this vulnerability and to implement a WAF to prevent attempts to exploit this vulnerability.", "Conclusions": "In conclusion, the CVE-2020-11945 is a critical remote code execution vulnerability in Squid before 5.0.2. It is essential to prioritize the mitigation of this vulnerability and to implement a WAF to prevent attempts to exploit this vulnerability."}}