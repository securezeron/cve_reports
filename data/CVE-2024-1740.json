{"id": "CVE-2024-1740", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-10T17:15:53.293", "lastModified": "2024-04-10T19:49:51.183", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In lunary-ai/lunary version 1.0.1, a vulnerability exists where a user removed from an organization can still read, create, modify, and delete logs by re-using an old authorization token. The lunary web application communicates with the server using an 'Authorization' token in the browser, which does not properly invalidate upon the user's removal from the organization. This allows the removed user to perform unauthorized actions on logs and access project and external user details without valid permissions."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-863"}]}], "references": [{"url": "https://github.com/lunary-ai/lunary/commit/c57cd50fa0477fd2a2efe60810c0099eebd66f54", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/c1a51f71-628e-4eb5-ac35-50bf64832cfd", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "TA0008", "comment": "CVE-2024-1740 could be exploited by attackers using the 'External Remote Services' technique, they could access the logs and perform unauthorized actions, hence it's crucial to implement controls to detect and prevent this"}, {"techniqueID": "TA0005", "comment": "The attackers could also use 'Valid Accounts' technique to exploit the vulnerability by using an old authorization token, hence it's necessary to implement controls for user account management and token invalidation"}, {"techniqueID": "TA0001", "comment": "The vulnerability could be exploited by using 'Initial Access' technique, the attackers could gain access to the system and perform actions without valid permissions, hence it's crucial to implement controls for access control and permission management"}, {"techniqueID": "TA0043", "comment": "The attackers could also use 'Lateral Movement' technique to move laterally within the system, hence it's necessary to implement controls for network segmentation and access control"}], "stix_bundle": {"@stix2-mixin-version": "2.1", "objects": [{"type": "intrusion-set", "id": "intrusion-set--f4723c8c-43a2-4433-90c9-4dee0f1f8d45", "name": "Lunary-AI-Exploit", "description": "Intrusion set representing attacks exploiting CVE-2024-1740", "objects": [{"type": "attack-pattern", "id": "attack-pattern--48c62f7c-440f-45f0-9d83-e2f7d7a75f29", "name": "Lunary-AI-Exploit-Log-Access", "description": "Attack pattern representing the exploitation of CVE-2024-1740 to access logs", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "kill_chain_phase_name": "Initial Access"}]}, {"type": "attack-pattern", "id": "attack-pattern--79cedda4-4549-4f76-b0e1-f2c1fcd1152f", "name": "Lunary-AI-Exploit-Token-Re-use", "description": "Attack pattern representing the reuse of old authorization tokens to exploit CVE-2024-1740", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "kill_chain_phase_name": "Persistence"}]}]}, {"type": "analysis", "id": "analysis--5af1b5f9-4a9e-4363-9a24-9c5dcf8d07c9", "name": "Lunary-AI-CVE-2024-1740", "description": "Analysis object representing the vulnerability CVE-2024-1740", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "kill_chain_phase_name": "Reconnaissance"}]}]}, "technical_analysis": {"Introduction": "Introduction content.", "Impact and Scope": "Details on the impact and scope of the CVE, mention cvss score with version and attack vector.", "Related MITRE ATT&CK Techniques": "List of related MITRE ATT&CK Techniques and their relevance to the CVE.", "Technical Details": "In-depth technical details of the CVE.", "Detection": "Methods for detecting the CVE.", "Mitigation": "Mitigation strategies for the CVE.", "Conclusion": "Summary and conclusions."}, "executive_analysis": {"Overview": "Overview of the CVE.", "Business Impact": "Explanation of the business impact of the CVE.", "Technical Impact": "Explanation of the technical impact of the CVE.", "Mitigation Strategies": "High-level mitigation strategies.", "Recommendations": "Recommendations for executives.", "Conclusions": "Final conclusions and next steps."}}