{"id": "CVE-2020-1978", "sourceIdentifier": "psirt@paloaltonetworks.com", "published": "2020-04-08T19:15:13.277", "lastModified": "2020-04-10T15:42:03.760", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "TechSupport files generated on Palo Alto Networks VM Series firewalls for Microsoft Azure platform configured with high availability (HA) inadvertently collect Azure dashboard service account credentials. These credentials are equivalent to the credentials associated with the Contributor role in Azure. A user with the credentials will be able to manage all the Azure resources in the subscription except for granting access to other resources. These credentials do not allow login access to the VMs themselves. This issue affects VM Series Plugin versions before 1.0.9 for PAN-OS 9.0. This issue does not affect VM Series in non-HA configurations or on other cloud platforms. It does not affect hardware firewall appliances. Since becoming aware of the issue, Palo Alto Networks has safely deleted all the tech support files with the credentials. We now filter and remove these credentials from all TechSupport files sent to us. The TechSupport files uploaded to Palo Alto Networks systems were only accessible by authorized personnel with valid Palo Alto Networks credentials. We do not have any evidence of malicious access or use of these credentials."}, {"lang": "es", "value": "Los archivos TechSupport generados en los firewalls Palo Alto Networks VM Series para la plataforma Microsoft Azure configurados con alta disponibilidad (HA), recopilan inadvertidamente las credenciales de la cuenta de servicio del panel de Azure. Estas credenciales son equivalentes a las credenciales asociadas con el rol Contributor en Azure. Un usuario con las credenciales podr\u00e1 ser capaz de administrar todos los recursos de Azure en la suscripci\u00f3n, excepto para otorgar acceso a otros recursos. Estas credenciales no permiten el acceso de inicio de sesi\u00f3n a las m\u00e1quinas virtuales por si mismas. Este problema afecta a VM Series Plugin versiones anteriores a 1.0.9 para PAN-OS versi\u00f3n 9.0. Este problema no afecta a VM Series en configuraciones que no sean de alta disponibilidad o sobre otras plataformas en la nube. No afecta al hardware de dispositivos firewall. Desde que se conoci\u00f3 el problema, Palo Alto Networks ha eliminado de manera segura todos los archivos de soporte t\u00e9cnico con las credenciales. Ahora filtramos y eliminamos estas credenciales de todos los archivos TechSupport que nos env\u00edan. Los archivos TechSupport cargados en los sistemas de Palo Alto Networks solo eran accesibles por personal autorizado con credenciales v\u00e1lidas de Palo Alto Networks. No tenemos ninguna evidencia de acceso malicioso o uso de estas credenciales."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.8, "impactScore": 3.6}, {"source": "psirt@paloaltonetworks.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.6, "impactScore": 5.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:P/I:N/A:N", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 1.9}, "baseSeverity": "LOW", "exploitabilityScore": 3.4, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-522"}]}, {"source": "psirt@paloaltonetworks.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-255"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:paloaltonetworks:vm-series:*:*:*:*:*:azure:*:*", "versionStartIncluding": "1.0", "versionEndExcluding": "1.0.9", "matchCriteriaId": "302372C3-03AD-4C54-9726-76AFAF8E00B8"}, {"vulnerable": true, "criteria": "cpe:2.3:o:paloaltonetworks:pan-os:9.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "A8493281-925D-4BD5-BE4F-2FB9C2CD8F9D"}]}]}], "references": [{"url": "https://security.paloaltonetworks.com/CVE-2020-1978", "source": "psirt@paloaltonetworks.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2020-1978 - The vulnerability allows attackers to access sensitive Azure dashboard service account credentials, leading to unauthorized access to Azure resources. This is an example of credential harvesting, a common tactic in attacker tactics, techniques, and procedures (TTPs)."}, {"techniqueID": "T1036", "comment": "CVE-2020-1978 - The vulnerability allows attackers to access sensitive Azure dashboard service account credentials, which can be used to move laterally within a network or escalate privileges. This is an example of credential dumping, a common tactic in attacker TTPs."}, {"techniqueID": "T1566", "comment": "CVE-2020-1978 - The vulnerability allows attackers to access sensitive Azure dashboard service account credentials, which can be used to access and manipulate Azure resources. This is an example of credential access, a common tactic in attacker TTPs."}, {"techniqueID": "T1190", "comment": "CVE-2020-1978 - The vulnerability allows attackers to access sensitive Azure dashboard service account credentials, which can be used to move laterally within a network or escalate privileges. This is an example of exploited credentialed privilege escalation, a common tactic in attacker TTPs."}, {"techniqueID": "T1078", "comment": "CVE-2020-1978 - The vulnerability allows attackers to access sensitive Azure dashboard service account credentials, which can be used to access and manipulate Azure resources. This is an example of command and control, a common tactic in attacker TTPs."}], "stix_bundle": {"@stix_Bundle_Type": " Bundle", "objects": [{"@stix_Header_Type": "INDICATOR", "id": "incident-1", "created_at": "2020-04-08T19:15:13.277", "description": [{"lang": "en", "value": "TechSupport files generated on Palo Alto Networks VM Series firewalls for Microsoft Azure platform configured with high availability (HA) inadvertently collect Azure dashboard service account credentials."}]}, {"@stix_Header_Type": "VULNERABILITY", "id": "vuln-1", "description": [{"lang": "en", "value": "CWE-522"}]}, {"@stix_Header_Type": "TECHNICAL_OID", "id": "techid-1", "description": [{"lang": "en", "value": "VM Series Plugin versions before 1.0.9 for PAN-OS 9.0"}]}, {"@stix_Header_Type": "VULNERABILITY", "id": "vuln-2", "description": [{"lang": "en", "value": "CWE-255"}]}, {"@stix_Header_Type": "TECHNICAL_OID", "id": "techid-2", "description": [{"lang": "en", "value": "Only affects VM Series Plugin versions before 1.0.9 for PAN-OS 9.0"}]}]}, "technical_analysis": {"Introduction": "This vulnerability allows attackers to access sensitive Azure dashboard service account credentials, leading to unauthorized access to Azure resources. The vulnerability affects VM Series firewalls for Microsoft Azure platform configured with high availability (HA).", "Impact and Scope": "The vulnerability is rated 4.4/5.8 based on the CVSS 3.1 scoring, with an attack vector of LOCAL and privileges required of HIGH. The scope of the vulnerability is limited to the affected VM Series firewalls and does not affect other cloud platforms or hardware firewall appliances.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including Credential Harvesting (T1027), Credential Dumping (T1036), and Command and Control (T1078).", "Technical Details": "The vulnerability occurs when TechSupport files generated on Palo Alto Networks VM Series firewalls for Microsoft Azure platform configured with high availability (HA) inadvertently collect Azure dashboard service account credentials.", "Detection": "Detection strategies include monitoring for suspicious activity related to Azure dashboard service account credentials, as well as monitoring for unusual access to Azure resources.", "Mitigation": "Mitigation strategies include patching affected VM Series Plugin versions and configuring firewall rules to block unauthorized access to Azure resources.", "Conclusion": "The vulnerability is a significant risk to Azure resources and requires immediate attention to mitigate."}, "executive_analysis": {"Overview": "The vulnerability allows attackers to access sensitive Azure dashboard service account credentials, leading to unauthorized access to Azure resources. This presents a significant risk to Azure resources and requires immediate attention to mitigate.", "Business Impact": "The vulnerability could result in unauthorized access to Azure resources, potentially leading to data breaches, system compromise, or financial losses.", "Technical Impact": "The vulnerability affects VM Series firewalls for Microsoft Azure platform configured with high availability (HA), making it a critical vulnerability that requires immediate attention.", "Mitigation Strategies": "Patch affected VM Series Plugin versions, configure firewall rules to block unauthorized access to Azure resources, and monitor for suspicious activity related to Azure dashboard service account credentials.", "Recommendations": "Executives should prioritize patching affected VM Series Plugin versions and implementing mitigation strategies to prevent unauthorized access to Azure resources.", "Conclusions": "The vulnerability is a significant risk to Azure resources and requires immediate attention to mitigate. Executives should prioritize patching and mitigation strategies to minimize the risk of unauthorized access to Azure resources."}}