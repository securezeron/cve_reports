{"id": "CVE-2024-23751", "sourceIdentifier": "cve@mitre.org", "published": "2024-01-22T01:15:08.557", "lastModified": "2024-01-29T15:06:44.003", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "LlamaIndex (aka llama_index) through 0.9.34 allows SQL injection via the Text-to-SQL feature in NLSQLTableQueryEngine, SQLTableRetrieverQueryEngine, NLSQLRetriever, RetrieverQueryEngine, and PGVectorSQLQueryEngine. For example, an attacker might be able to delete this year's student records via \"Drop the Students table\" within English language input."}, {"lang": "es", "value": "LlamaIndex (tambi\u00e9n conocido como llama_index) hasta 0.9.34 permite la inyecci\u00f3n de SQL a trav\u00e9s de la funci\u00f3n Texto a SQL en NLSQLTableQueryEngine, SQLTableRetrieverQueryEngine, NLSQLRetriever, RetrieverQueryEngine y PGVectorSQLQueryEngine. Por ejemplo, un atacante podr\u00eda eliminar los registros de los estudiantes de este a\u00f1o mediante \"Soltar la tabla de estudiantes\" dentro de la entrada en idioma ingl\u00e9s."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:llamaindex:llamaindex:*:*:*:*:*:*:*:*", "versionEndIncluding": "0.9.34", "matchCriteriaId": "A85457FA-3A68-45F3-9AB7-7E367D18EC67"}]}]}], "references": [{"url": "https://github.com/run-llama/llama_index/issues/9957", "source": "cve@mitre.org", "tags": ["Exploit", "Issue Tracking", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-23751 - LlamaIndex (aka llama_index) through 0.9.34 allows SQL injection via the Text-to-SQL feature in NLSQLTableQueryEngine, SQLTableRetrieverQueryEngine, NLSQLRetriever, RetrieverQueryEngine, and PGVectorSQLQueryEngine."}, {"techniqueID": "T1068", "comment": "This technique is used to execute arbitrary SQL queries on the database. Attackers can use this vulnerability to extract sensitive data or modify database records."}, {"techniqueID": "T1190", "comment": "This technique is used to execute system commands and can be used to download and execute malicious payloads."}], "technical_analysis": {"Introduction": "CVE-2024-23751 is a remote code execution vulnerability in LlamaIndex through 0.9.34. This vulnerability allows attackers to inject arbitrary SQL queries into the Text-to-SQL feature, which can be used to extract sensitive data or modify database records.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 9.8 and an attack vector of NETWORK. This vulnerability can be exploited by an attacker to execute arbitrary SQL queries and potentially download and execute malicious payloads.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1059, T1068, and T1190.", "Technical Details": "The vulnerability is caused by the use of a vulnerable Text-to-SQL feature in LlamaIndex. This feature allows attackers to inject arbitrary SQL queries into the database, which can be used to extract sensitive data or modify database records.", "Detection": "Detection of this vulnerability is possible through the use of intrusion detection systems and vulnerability scanners. Additionally, log analysis and database monitoring can be used to detect potential attacks.", "Mitigation": "The mitigation for this vulnerability is to upgrade to a version of LlamaIndex that is not vulnerable to this issue. Additionally, consider implementing additional security measures such as web application firewalls and intrusion detection systems.", "Conclusion": "In conclusion, CVE-2024-23751 is a high-impact vulnerability that can be exploited to execute arbitrary SQL queries and potentially download and execute malicious payloads. It is recommended that organizations upgrade to a version of LlamaIndex that is not vulnerable to this issue and implement additional security measures."}, "executive_analysis": {"Overview": "CVE-2024-23751 is a remote code execution vulnerability in LlamaIndex through 0.9.34. This vulnerability allows attackers to inject arbitrary SQL queries into the Text-to-SQL feature, which can be used to extract sensitive data or modify database records.", "Business Impact": "The business impact of this vulnerability is high, as it can allow attackers to extract sensitive data or modify database records. This can result in significant financial and reputational losses.", "Technical Impact": "The technical impact of this vulnerability is high, as it can allow attackers to execute arbitrary SQL queries and potentially download and execute malicious payloads. This is a highly critical vulnerability that requires immediate attention.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are to upgrade to a version of LlamaIndex that is not vulnerable to this issue and implement additional security measures such as web application firewalls and intrusion detection systems.", "Recommendations": "Recommendations for executives include prioritizing the upgrade to a secure version of LlamaIndex and implementing additional security measures to detect and prevent attacks.", "Conclusions": "In conclusion, CVE-2024-23751 is a critical vulnerability that requires immediate attention. It is recommended that organizations upgrade to a secure version of LlamaIndex and implement additional security measures to mitigate this vulnerability."}}