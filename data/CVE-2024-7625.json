{"id": "CVE-2024-7625", "sourceIdentifier": "security@hashicorp.com", "published": "2024-08-15T00:15:13.127", "lastModified": "2024-08-15T13:01:10.150", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In HashiCorp Nomad and Nomad Enterprise from 0.6.1 up to 1.16.13, 1.7.10, and 1.8.2, the archive unpacking process is vulnerable to writes outside the allocation directory during migration of allocation directories when multiple archive headers target the same file. This vulnerability, CVE-2024-7625, is fixed in Nomad 1.6.14, 1.7.11, and 1.8.3. Access or compromise of the Nomad client agent at the source allocation first is a prerequisite for leveraging this vulnerability."}, {"lang": "es", "value": " En HashiCorp Nomad y Nomad Enterprise desde 0.6.1 hasta 1.16.13, 1.7.10 y 1.8.2, el proceso de descompresi\u00f3n del archivo es vulnerable a escrituras fuera del directorio de asignaci\u00f3n durante la migraci\u00f3n de directorios de asignaci\u00f3n cuando varios encabezados de archivo apuntan al mismo archivo. . Esta vulnerabilidad, CVE-2024-7625, se solucion\u00f3 en Nomad 1.6.14, 1.7.11 y 1.8.3. El acceso o el compromiso del agente del cliente Nomad en la asignaci\u00f3n de origen primero es un requisito previo para aprovechar esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security@hashicorp.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 4.0}]}, "weaknesses": [{"source": "security@hashicorp.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-610"}]}], "references": [{"url": "https://discuss.hashicorp.com/t/hcsec-2024-17-nomad-vulnerable-to-allocation-directory-escape-on-non-existing-file-paths-through-archive-unpacking/69293", "source": "security@hashicorp.com"}], "techniques": [{"techniqueID": "T1204", "comment": "CVE-2024-7625 - Lateral movement by exploiting remote services. Attackers may exploit this vulnerability to write files outside the intended directory, potentially allowing them to execute arbitrary commands or manipulate the system."}, {"techniqueID": "T1027", "comment": "CVE-2024-7625 - Application and system inconsistencies. Exploiting this vulnerability can lead to inconsistent directory structures, making it difficult to identify and remediate affected systems."}, {"techniqueID": "T1136", "comment": "CVE-2024-7625 - Command and control. An attacker could potentially use this vulnerability to execute commands on the compromised system, allowing for further exploitation."}], "technical_analysis": {"Introduction": "CVE-2024-7625 is a vulnerability in HashiCorp Nomad and Nomad Enterprise, affecting archive unpacking during allocation directory migration. This vulnerability allows attackers to write files outside the intended directory, potentially leading to increased attack surface and further exploitation.", "Impact and Scope": "CVE-2024-7625 has a CVSS 3.1 base score of 5.8 with an attack vector of NETWORK, attack complexity of HIGH, privileges required of HIGH, and user interaction of NONE. The vulnerability affects Nomad and Nomad Enterprise versions 0.6.1 to 1.16.13, 1.7.10, and 1.8.2.", "Related MITRE ATT&CK Techniques": "T1204, T1027, and T1136 are relevant MITRE ATT&CK techniques related to this vulnerability.", "Technical Details": "The vulnerability occurs when multiple archive headers target the same file during allocation directory migration, allowing attackers to write files outside the intended directory.", "Detection": "Systems affected by CVE-2024-7625 can be detected by monitoring for unusual file system modifications or access patterns.", "Mitigation": "To mitigate this vulnerability, affected systems should be updated to versions 1.6.14, 1.7.11, and 1.8.3, or equivalent, and monitoring for unusual file system modifications or access patterns should be implemented.", "Conclusion": "CVE-2024-7625 is a high-impact vulnerability that can be exploited by attackers to increase the attack surface and potentially execute arbitrary commands or manipulate the system. Timely patching and monitoring are essential to mitigate this vulnerability."}, "executive_analysis": {"Overview": "CVE-2024-7625 is a critical vulnerability in HashiCorp Nomad and Nomad Enterprise that can increase the attack surface and potentially lead to significant business disruptions.", "Business Impact": "This vulnerability has the potential to impact business systems and processes, potentially leading to data breaches, unauthorized access, or system compromise.", "Technical Impact": "CVE-2024-7625 is a technical vulnerability that affects the security and integrity of affected systems, potentially allowing attackers to execute arbitrary commands or manipulate the system.", "Mitigation Strategies": "Affected systems should be updated to patched versions, and network monitoring and incident response plans should be reviewed and updated to address the potential impact of this vulnerability.", "Recommendations": "System administrators should prioritize updating affected systems to patched versions and implementing additional security controls to prevent and detect potential exploits. Organizations should also review their incident response plans and conduct regular security assessments to identify and address potential vulnerabilities.", "Conclusions": "CVE-2024-7625 is a critical vulnerability that requires immediate attention and action. Organizations should prioritize patching affected systems and implementing additional security controls to mitigate the potential risks and impacts associated with this vulnerability."}}