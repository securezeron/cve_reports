{"id": "CVE-2023-7080", "sourceIdentifier": "cna@cloudflare.com", "published": "2023-12-29T12:15:47.970", "lastModified": "2024-01-05T18:09:24.273", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The V8 inspector intentionally allows arbitrary code execution within the Workers sandbox for debugging. wrangler dev would previously start an inspector server listening on all network interfaces. This would allow an attacker on the local network to connect to the inspector and run arbitrary code. Additionally, the inspector server did not validate Origin/Host headers, granting an attacker that can trick any user on the local network into opening a malicious website the ability to run code. If wrangler dev --remote was being used, an attacker could access production resources if they were bound to the worker.\n\nThis issue was fixed in wrangler@3.19.0 and wrangler@2.20.2. Whilst wrangler dev's inspector server listens on local interfaces by default as of wrangler@3.16.0, an  SSRF vulnerability in miniflare https://github.com/cloudflare/workers-sdk/security/advisories/GHSA-fwvg-2739-22v7 \u00a0(CVE-2023-7078) allowed access from the local network until wrangler@3.18.0. wrangler@3.19.0 and wrangler@2.20.2 introduced validation for the Origin/Host headers.\n"}, {"lang": "es", "value": "V8 inspector permite intencionalmente la ejecuci\u00f3n de c\u00f3digo arbitrario dentro de la sandbox de Workers para su depuraci\u00f3n. wrangler dev previamente iniciar\u00eda un servidor inspector escuchando en todas las interfaces de red. Esto permitir\u00eda a un atacante en la red local conectarse al inspector y ejecutar c\u00f3digo arbitrario. Adem\u00e1s, el servidor inspector no valid\u00f3 los encabezados Origin/Host, lo que le otorga a un atacante que puede enga\u00f1ar a cualquier usuario de la red local para que abra un sitio web malicioso la capacidad de ejecutar c\u00f3digo. Si se usaba wrangler dev --remote, un atacante podr\u00eda acceder a los recursos de producci\u00f3n si estuvieran vinculados al trabajador. Este problema se solucion\u00f3 en wrangler@3.19.0 y wrangler@2.20.2. Si bien el servidor inspector de wrangler dev escucha en las interfaces locales de forma predeterminada a partir de wrangler@3.16.0, se ha detectado una vulnerabilidad SSRF en miniflare https://github.com/cloudflare/workers-sdk/security/advisories/GHSA-fwvg-2739-22v7&#xa0;( CVE-2023-7078) permit\u00eda el acceso desde la red local hasta wrangler@3.18.0. wrangler@3.19.0 y wrangler@2.20.2 introdujeron la validaci\u00f3n para los encabezados Origen/Host."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.0, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.1, "impactScore": 5.9}, {"source": "cna@cloudflare.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.1, "impactScore": 5.8}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "cna@cloudflare.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-269"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:cloudflare:wrangler:*:*:*:*:*:node.js:*:*", "versionStartIncluding": "2.0.0", "versionEndExcluding": "2.20.2", "matchCriteriaId": "9BC3CE33-76AB-4812-BCBD-C65F5728471D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:cloudflare:wrangler:*:*:*:*:*:node.js:*:*", "versionStartIncluding": "3.0.0", "versionEndExcluding": "3.19.0", "matchCriteriaId": "4F11F521-F7AC-4E31-9424-4CB968F50E6E"}]}]}], "references": [{"url": "https://github.com/cloudflare/workers-sdk/issues/4430", "source": "cna@cloudflare.com", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://github.com/cloudflare/workers-sdk/pull/4437", "source": "cna@cloudflare.com", "tags": ["Patch"]}, {"url": "https://github.com/cloudflare/workers-sdk/pull/4535", "source": "cna@cloudflare.com", "tags": ["Patch"]}, {"url": "https://github.com/cloudflare/workers-sdk/pull/4550", "source": "cna@cloudflare.com", "tags": ["Patch"]}, {"url": "https://github.com/cloudflare/workers-sdk/security/advisories/GHSA-f8mp-x433-5wpf", "source": "cna@cloudflare.com", "tags": ["Mitigation", "Patch", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2023-7080 - This vulnerability allows for arbitrary code execution within the Workers sandbox. Attackers can leverage this to gain unauthorized access to production resources."}, {"techniqueID": "T1204", "comment": "CVE-2023-7080 - The inspector server does not validate Origin/Host headers, allowing attackers to trick users into opening malicious websites, enabling code execution."}, {"techniqueID": "T1210", "comment": "CVE-2023-7080 - This SSRF vulnerability in miniflare (CVE-2023-7078) allowed access from the local network until wrangler@3.18.0, enabling code execution."}, {"techniqueID": "T1574", "comment": "CVE-2023-7080 - The vulnerability affects wrangler dev's inspector server, allowing attackers to connect to the inspector and execute arbitrary code."}, {"techniqueID": "T1584", "comment": "CVE-2023-7080 - The vulnerability could be exploited to inject arbitrary code, potentially leading to information disclosure, denial of service, or privilege escalation."}], "stix_bundle": {"type": "stix Bundle", "id": "bundle_2023-7080", "created_by": "Vulnerability Team", "created_date": "2023-12-30T10:10:00.000Z", "objects": [{"type": "vulnerability", "id": "vulnerability_2023-7080", "name": "CVE-2023-7080", "description": "Arbitrary code execution in Workers sandbox", "cvss_score": "8.0", "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "references": [{"type": "incident", "id": "incident_1", "description": "CVE-2023-7080", "url": "https://github.com/cloudflare/workers-sdk/issues/4430"}]}, {"type": "course_of_action", "id": "course_of_action_1", "name": "CoA-1", "description": "Update wrangler to version 3.19.0 or later", "techniques": [{"type": "technique", "id": "T1190", "description": "Exploit the arbitrary code execution vulnerability"}]}]}, "technical_analysis": {"Introduction": "CVE-2023-7080 is a remote code execution vulnerability in the Cloudflare Workers sandbox, affecting wrangler dev's inspector server.", "Impact and Scope": "The vulnerability has a CVSS score of 8.0, with a potential impact of information disclosure, denial of service, or privilege escalation. The attack vector is adjacent network.", "Related MITRE ATT&CK Techniques": "T1190, T1204, T1210, T1574, T1584", "Technical Details": "The vulnerability allows attackers to inject arbitrary code, which can be executed within the Workers sandbox.", "Detection": "Network monitoring can detect attempts to connect to the inspector server from unexpected sources.", "Mitigation": "Update wrangler to version 3.19.0 or later, restrict access to the inspector server, and monitor network traffic.", "Conclusion": "CVE-2023-7080 is a high-priority vulnerability that requires immediate attention to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2023-7080 is a critical vulnerability in the Cloudflare Workers sandbox, affecting wrangler dev's inspector server.", "Business Impact": "The vulnerability could lead to unauthorized access to production resources, resulting in significant financial losses and reputation damage.", "Technical Impact": "The vulnerability allows attackers to inject arbitrary code, which can be executed within the Workers sandbox.", "Mitigation Strategies": "Implement strict access controls, monitor network traffic, and update wrangler to version 3.19.0 or later.", "Recommendations": "Prioritize patching and implement additional security measures to prevent exploitation.", "Conclusions": "CVE-2023-7080 is a high-priority vulnerability that requires immediate attention and action to prevent exploitation and minimize potential impact."}}