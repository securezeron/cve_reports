{"id": "CVE-2024-4889", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T18:15:18.577", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A code injection vulnerability exists in the berriai/litellm application, version 1.34.6, due to the use of unvalidated input in the eval function within the secret management system. This vulnerability requires a valid Google KMS configuration file to be exploitable. Specifically, by setting the `UI_LOGO_PATH` variable to a remote server address in the `get_image` function, an attacker can write a malicious Google KMS configuration file to the `cached_logo.jpg` file. This file can then be used to execute arbitrary code by assigning malicious code to the `SAVE_CONFIG_TO_DB` environment variable, leading to full system control. The vulnerability is contingent upon the use of the Google KMS feature."}, {"lang": "es", "value": "Existe una vulnerabilidad de inyecci\u00f3n de c\u00f3digo en la aplicaci\u00f3n berriai/litellm, versi\u00f3n 1.34.6, debido al uso de entradas no validadas en la funci\u00f3n de evaluaci\u00f3n dentro del sistema de gesti\u00f3n de secretos. Esta vulnerabilidad requiere un archivo de configuraci\u00f3n de Google KMS v\u00e1lido para ser explotable. Espec\u00edficamente, al configurar la variable `UI_LOGO_PATH` en una direcci\u00f3n de servidor remoto en la funci\u00f3n `get_image`, un atacante puede escribir un archivo de configuraci\u00f3n malicioso de Google KMS en el archivo `cached_logo.jpg`. Este archivo luego se puede usar para ejecutar c\u00f3digo arbitrario asignando c\u00f3digo malicioso a la variable de entorno `SAVE_CONFIG_TO_DB`, lo que lleva al control total del sistema. La vulnerabilidad depende del uso de la funci\u00f3n Google KMS."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://huntr.com/bounties/be3fda72-a65b-4993-9a0e-7e0f05db51f8", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1055 - Command and Control", "comment": "The vulnerability in berriai/litellm allows an attacker to write a malicious Google KMS configuration file, which can then be used to execute arbitrary code, leading to full system control. This is an example of Command and Control technique, as the attacker can use the exploited system as a C2 server."}, {"techniqueID": "T1078 - Post Exploitation", "comment": "Once the vulnerability is exploited, the attacker can use it to execute arbitrary code, leading to post-exploitation activities such as data exfiltration or lateral movement. This is a common scenario for this type of vulnerability."}, {"techniqueID": "T1190 - Exploit Public-Facing Application", "comment": "The vulnerability in berriai/litellm is an example of an exploit of a public-facing application, as it can be triggered by an attacker with access to the vulnerable system."}, {"techniqueID": "T1203 - Exploitation of Remote Services", "comment": "The vulnerability in berriai/litellm is an example of exploitation of a remote service, as it is triggered by interacting with the vulnerable system remotely."}], "technical_analysis": {"Introduction": "The berriai/litellm application, version 1.34.6, contains a code injection vulnerability that allows attackers to write a malicious Google KMS configuration file, which can then be used to execute arbitrary code.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2 (HIGH), with Network attack vectors and LOW skill level required. The confidentiality, integrity, and availability of the system are all affected.", "Related MITRE ATT&CK Techniques": "T1055 - Command and Control, T1078 - Post Exploitation, T1190 - Exploit Public-Facing Application, T1203 - Exploitation of Remote Services", "Technical Details": "The vulnerability is caused by the use of unvalidated input in the eval function within the secret management system. This allows attackers to write a malicious Google KMS configuration file to the cached_logo.jpg file, which can then be used to execute arbitrary code.", "Detection": "Detection methods will depend on the specific environment and systems in use. However, common methods include monitoring for unusual network traffic, reviewing system logs, and implementing file integrity monitoring.", "Mitigation": "The vulnerability can be mitigated by applying the patch to the berriai/litellm application, version 1.34.6, and reviewing system logs for suspicious activity.", "Conclusion": "In conclusion, the berriai/litellm application, version 1.34.6, contains a code injection vulnerability that can be exploited by an attacker to write a malicious Google KMS configuration file, leading to full system control."}, "executive_analysis": {"Overview": "The berriai/litellm application, version 1.34.6, contains a critical code injection vulnerability that allows attackers to write a malicious Google KMS configuration file, which can then be used to execute arbitrary code.", "Business Impact": "The potential impact of this vulnerability on the business includes loss of sensitive data, system compromise, and potentially significant reputational damage.", "Technical Impact": "The technical impact of this vulnerability includes the potential for attackers to execute arbitrary code, leading to full system control.", "Mitigation Strategies": "Mitigation strategies include applying the patch to the affected application, implementing file integrity monitoring, and reviewing system logs for suspicious activity.", "Recommendations": "It is recommended that the berriai/litellm application, version 1.34.6, be patched as soon as possible, and that all systems be reviewed for suspicious activity.", "Conclusions": "In conclusion, the berriai/litellm application, version 1.34.6, contains a critical code injection vulnerability that requires immediate attention and mitigation."}}