{"id": "CVE-2020-15938", "sourceIdentifier": "psirt@fortinet.com", "published": "2021-03-04T18:15:12.863", "lastModified": "2021-03-11T13:56:58.360", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "When traffic other than HTTP/S (eg: SSH traffic, etc...) traverses the FortiGate in version below 6.2.5 and below 6.4.2 on port 80/443, it is not redirected to the transparent proxy policy for processing, as it doesn't have a valid HTTP header."}, {"lang": "es", "value": "Cuando el tr\u00e1fico que no es HTTP/S (por ejemplo: tr\u00e1fico SSH, etc.) atraviesa el FortiGate en versiones inferiores a 6.2.5 y por debajo de 6.4.2 en el puerto 80/443, no se redirecciona hacia la pol\u00edtica de proxy transparente para su procesamiento, ya que no presenta un encabezado HTTP v\u00e1lido"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "psirt@fortinet.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.0, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.2, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fortinet:fortios:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.2.5", "matchCriteriaId": "3D02C781-85DB-4474-A90B-042398B080D2"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fortinet:fortios:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.4.0", "versionEndIncluding": "6.4.2", "matchCriteriaId": "1CBBBF98-0E21-4C0B-BE40-040CF6F81C9C"}]}]}], "references": [{"url": "https://fortiguard.com/advisory/FG-IR-20-172", "source": "psirt@fortinet.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2020-15938 - Port Scanning and Network Scanning techniques can be used to identify open ports for exploitation. Detection can be enhanced by monitoring for suspicious network traffic and analyzing FortiGate configuration files."}, {"techniqueID": "T1568", "comment": "CVE-2020-15938 - Web Shelling and Remote File Inclusion attacks can be performed by exploiting this vulnerability. Detection can be enhanced by monitoring for suspicious HTTP traffic and analyzing FortiGate log files."}, {"techniqueID": "T1027", "comment": "CVE-2020-15938 - File and Directory Discovery techniques can be used to discover valid FTP/SMTP/SFTP/SSH configurations and credentials. Detection can be enhanced by monitoring for suspicious network traffic and analyzing FortiGate configuration files."}], "stix_bundle": {"bundle": {"type": "indicator", "id": "https://example.com/cve-2020-15938", "created_by_ref": "https://example.com/organization", "modified": "2021-03-12T14:30:00.000Z", "created": "2021-03-12T14:30:00.000Z", "name": "CVE-2020-15938 FortiGate Vulnerability", "description": "A vulnerability in FortiGate versions 6.2.5 and below and 6.4.2 on port 80/443 allows an attacker to bypass security policies and conduct unauthorized activities.", "labels": ["cve", "fortigate", "vulnerability"], "objects": {"vulnerability": {"type": "vulnerability", "id": "https://example.com/cve-2020-15938/vulnerability", "name": "CVE-2020-15938 FortiGate Vulnerability", "description": "A vulnerability in FortiGate versions 6.2.5 and below and 6.4.2 on port 80/443 allows an attacker to bypass security policies and conduct unauthorized activities."}, "mitigation": {"type": "mitigation", "id": "https://example.com/cve-2020-15938/mitigation", "name": "FortiGate Vulnerability Mitigation", "description": "Apply patches to FortiGate versions 6.2.5 and below and 6.4.2 on port 80/443. Monitor for suspicious network traffic and analyze FortiGate configuration files."}, "course_of_action": {"type": "course-of-action", "id": "https://example.com/cve-2020-15938/course-of-action", "name": "CVE-2020-15938 Course of Action", "description": "Apply patches to FortiGate versions 6.2.5 and below and 6.4.2 on port 80/443. Monitor for suspicious network traffic and analyze FortiGate configuration files."}}, "relationships": {"vulnerability": {"type": "has-vulnerability", "object_ref": "https://example.com/cve-2020-15938/vulnerability"}, "mitigation": {"type": "mitigates", "object_ref": "https://example.com/cve-2020-15938/mitigation"}, "course_of_action": {"type": "responds-to", "object_ref": "https://example.com/cve-2020-15938/course-of-action"}}}}, "technical_analysis": {"Introduction": "FortiGate versions 6.2.5 and below and 6.4.2 on port 80/443 have a vulnerability that allows an attacker to bypass security policies and conduct unauthorized activities.", "Impact and Scope": "This vulnerability has a CVSS score of 7.5 and is classified as High severity. It can be exploited by any attacker who can access the network.", "Related MITRE ATT&CK Techniques": "T1059, T1568, and T1027", "Technical Details": "The vulnerability exists due to the way FortiGate handles traffic on port 80/443. An attacker can exploit this by sending traffic on these ports without a valid HTTP header.", "Detection": "Monitor for suspicious network traffic and analyze FortiGate configuration files.", "Mitigation": "Apply patches to FortiGate versions 6.2.5 and below and 6.4.2 on port 80/443.", "Conclusion": "The vulnerability exists due to a flaw in the FortiGate's handling of traffic on port 80/443. Applying patches and monitoring for suspicious traffic can help mitigate this vulnerability."}, "executive_analysis": {"Overview": "The FortiGate vulnerability poses a High risk to organizations that use these versions.", "Business Impact": "The vulnerability can lead to unauthorized access to sensitive data and disruption of business operations.", "Technical Impact": "The vulnerability can be exploited by any attacker who can access the network, regardless of their skill level.", "Mitigation Strategies": "Apply patches to FortiGate versions 6.2.5 and below and 6.4.2 on port 80/443. Monitor for suspicious network traffic and analyze FortiGate configuration files.", "Recommendations": "Organizations using FortiGate should prioritize patching and monitoring to mitigate this vulnerability.", "Conclusions": "Effective mitigation of this vulnerability requires prompt patching and monitoring. Organizations should prioritize this and take steps to minimize the risk of exploit."}}