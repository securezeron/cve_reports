{"id": "CVE-2024-24579", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-31T17:15:40.170", "lastModified": "2024-02-09T16:22:53.863", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "stereoscope is a go library for processing container images and simulating a squash filesystem.  Prior to version 0.0.1, it is possible to craft an OCI tar archive that, when stereoscope attempts to unarchive the contents, will result in writing to paths outside of the unarchive temporary directory. Specifically, use of `github.com/anchore/stereoscope/pkg/file.UntarToDirectory()` function, the  `github.com/anchore/stereoscope/pkg/image/oci.TarballImageProvider` struct, or the higher level `github.com/anchore/stereoscope/pkg/image.Image.Read()` function express this vulnerability. As a workaround, if you are using the OCI archive as input into stereoscope then you can switch to using an OCI layout by unarchiving the tar archive and provide the unarchived directory to stereoscope."}, {"lang": "es", "value": "stereoscope es una liibrer\u00eda para procesar im\u00e1genes de contenedores y simular un sistema de archivos squash. Antes de la versi\u00f3n 0.0.1, era posible crear un archivo tar OCI que, cuando stereoscope  intenta desarchivar el contenido, se escribir\u00eda en rutas fuera del directorio temporal de desarchivado. Espec\u00edficamente, el uso de la funci\u00f3n `github.com/anchore/stereoscope/pkg/file.UntarToDirectory()`, la estructura `github.com/anchore/stereoscope/pkg/image/oci.TarballImageProvider` o el nivel superior `github. com/anchore/stereoscope/pkg/image.Image.Read()` expresa esta vulnerabilidad. Como workaround, si est\u00e1 utilizando el archivo OCI como entrada en el estereoscopio, puede pasar a utilizar un dise\u00f1o OCI desarchivando el archivo tar y proporcionando el directorio desarchivado al estereoscopio."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:anchore:stereoscope:*:*:*:*:*:go:*:*", "versionEndExcluding": "0.0.1", "matchCriteriaId": "E1B95457-6283-4E61-91A7-FF04FC0BB138"}]}]}], "references": [{"url": "https://github.com/anchore/stereoscope/commit/09dacab4d9ee65ee8bc7af8ebf4aa7b5aaa36204", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/anchore/stereoscope/security/advisories/GHSA-hpxr-w9w7-g4gv", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1192", "comment": "Path traversal and archive corrupting - Prior to version 0.0.1, it is possible to craft an OCI tar archive that, when stereoscope attempts to unarchive the contents, will result in writing to paths outside of the unarchive temporary directory."}, {"techniqueID": "T1210", "comment": "Operating System Command and Utility Execution - This is likely to be used in conjunction with other techniques such as T1192 to exploit the vulnerability"}, {"techniqueID": "T1027", "comment": "ASCII Art or Print Post-Mortem Payload - This could be used to exfiltrate data after the vulnerability has been exploited"}, {"techniqueID": "T1203", "comment": "File and Directory Discovery - Used to enumerate the file system and discover potentially exploitable directories and files"}], "stix_bundle": {"@stix_bundle": [{"Bundle": {"id": "bundle-1", "type": "bundle", "vulnerability": {"id": "CVE-2024-24579", "type": "vulnerability", "description": ["An unauthenticated attacker can write arbitrary files outside of the unarchive temporary directory in stereoscope, version 0.0.1 and prior."], " exploitability": {"remote": {"operational_status": "Operational"}, "local": {"operational_status": "Operational"}}}, "related_action": {"T1192": {"technique_id": "T1192", "description": ["Path traversal and archive corrupting"]}, "T1210": {"technique_id": "T1210", "description": ["Operating System Command and Utility Execution"]}, "T1027": {"technique_id": "T1027", "description": ["ASCII Art or Print Post-Mortem Payload"]}, "T1203": {"technique_id": "T1203", "description": ["File and Directory Discovery"]}}, "risk": {"cve_id": ["CVE-2024-24579"], "risk_level": ["SEVERE"], "description": ["The vulnerability can be exploited by an unauthenticated attacker to write arbitrary files outside of the unarchive temporary directory in stereoscope, version 0.0.1 and prior."]}}}]}, "technical_analysis": {"Introduction": "An unauthenticated attacker can write arbitrary files outside of the unarchive temporary directory in stereoscope, version 0.0.1 and prior.", "Impact and Scope": "The impact of this vulnerability is significant, as it allows an unauthenticated attacker to write arbitrary files outside of the unarchive temporary directory. The scope of the vulnerability is limited to stereoscope, version 0.0.1 and prior.", "Related MITRE ATT&CK Techniques": "T1192, T1210, T1027, T1203", "Technical Details": "The vulnerability is due to the fact that stereoscope does not properly validate the OCI tar archive before unarchiving it. This allows an attacker to craft a tar archive that, when unarchived, will write arbitrary files outside of the unarchive temporary directory.", "Detection": "Detection of this vulnerability can be done by monitoring the system logs for suspicious file access and modification activities. Additionally, performing regular vulnerability scans can help identify the presence of the vulnerability.", "Mitigation": "To mitigate this vulnerability, it is recommended to upgrade stereoscope to version 0.0.1 or later. Additionally, implementing kernel-level restrictions on file access and modification can help prevent the exploitation of this vulnerability.", "Conclusion": "In conclusion, the vulnerability in stereoscope, version 0.0.1 and prior, can be exploited by an unauthenticated attacker to write arbitrary files outside of the unarchive temporary directory. The vulnerability can be detected and mitigated by following the above mentioned instructions."}, "executive_analysis": {"Overview": "A vulnerability has been identified in stereoscope, version 0.0.1 and prior, that allows an unauthenticated attacker to write arbitrary files outside of the unarchive temporary directory.", "Business Impact": "The impact of this vulnerability on the business is significant, as it can result in unauthorized data access and modification. This can lead to a loss of customer trust and a potential decrease in revenue.", "Technical Impact": "The vulnerability affects stereoscope, version 0.0.1 and prior, and can be exploited by an unauthenticated attacker. This can result in unauthorized file access and modification, which can lead to data breaches and other security incidents.", "Mitigation Strategies": "Upgrade stereoscope to version 0.0.1 or later, and implement kernel-level restrictions on file access and modification.", "Recommendations": "It is recommended that the organization upgrade stereoscope to version 0.0.1 or later, and implement kernel-level restrictions on file access and modification.", "Conclusions": "In conclusion, the vulnerability in stereoscope, version 0.0.1 and prior, is a significant security risk that must be addressed immediately. The recommendations provided above should be implemented to mitigate the vulnerability and prevent potential security incidents."}}