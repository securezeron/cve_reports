{"id": "CVE-2020-7063", "sourceIdentifier": "security@php.net", "published": "2020-02-27T21:15:19.117", "lastModified": "2022-05-08T23:50:23.913", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In PHP versions 7.2.x below 7.2.28, 7.3.x below 7.3.15 and 7.4.x below 7.4.3, when creating PHAR archive using PharData::buildFromIterator() function, the files are added with default permissions (0666, or all access) even if the original files on the filesystem were with more restrictive permissions. This may result in files having more lax permissions than intended when such archive is extracted."}, {"lang": "es", "value": "En PHP versiones 7.2.x por debajo de 7.2.28, versiones 7.3.x por debajo de 7.3.15 y versiones 7.4.x por debajo de 7.4.3, cuando es creado un archivo PHAR usando la funci\u00f3n PharData::buildFromIterator(), los archivos son agregados con permisos predeterminados (0666, o acceso total) incluso si los archivos originales en el sistema de archivos estaban con permisos m\u00e1s restrictivos. Esto puede causar que los archivos tengan m\u00e1s permisos laxos de lo previsto cuando dicho archivo es extra\u00eddo."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}, {"source": "security@php.net", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-281"}]}, {"source": "security@php.net", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-281"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.2.0", "versionEndIncluding": "7.2.27", "matchCriteriaId": "C6DEDF33-5700-450F-980D-8CA598A53DED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.3.0", "versionEndIncluding": "7.3.14", "matchCriteriaId": "1CA6A47B-6146-4361-AED1-4263B7911C6C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.4.0", "versionEndIncluding": "7.4.2", "matchCriteriaId": "D73AA9E0-B622-41A6-9E5B-924051D4CA61"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:tenable:tenable.sc:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.19.0", "matchCriteriaId": "41DBA7C7-8084-45F6-B59D-13A9022C34DF"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*", "matchCriteriaId": "B620311B-34A3-48A6-82DF-6F078D7A4493"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-03/msg00023.html", "source": "security@php.net", "tags": ["Third Party Advisory"]}, {"url": "https://bugs.php.net/bug.php?id=79082", "source": "security@php.net", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2020/03/msg00034.html", "source": "security@php.net", "tags": ["Third Party Advisory"]}, {"url": "https://security.gentoo.org/glsa/202003-57", "source": "security@php.net", "tags": ["Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/4330-1/", "source": "security@php.net", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2020/dsa-4717", "source": "security@php.net", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2020/dsa-4719", "source": "security@php.net", "tags": ["Third Party Advisory"]}, {"url": "https://www.tenable.com/security/tns-2021-14", "source": "security@php.net", "tags": ["Patch", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1204.001", "comment": "CVE-2020-7063 - Allows an attacker to potentially execute unintended code by creating a PHAR archive with files having lax permissions, leading to potential data breaches and integrity issues. To defend against this, ensure that PHP is updated to a non-vulnerable version, restrict access to the phar_build_from_iterator() function, and monitor system logs for suspicious activities."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "indicator--2c18a93c-8a4c-4bbd-946a-f4e3f0d20a6a", "created_by_ref": "identity--1425b09a-50d2-4c3a-8b35-114c3d3b1a6a", "modified": "2022-05-08T23:50:23.913", "name": "PHP PHAR Archive Permissions Vulnerability", "description": "A vulnerability in PHP's PHAR archive creation functionality allows an attacker to create a PHAR archive with files having lax permissions, leading to potential data breaches and integrity issues.", "discovered_by": "identity--1425b09a-50d2-4c3a-8b35-114c3d3b1a6a", "valid_from": "2020-02-27T21:15:19.117", "valid_until": "2024-02-27T21:15:19.117"}, {"type": "course-of-action", "id": "course-of-action--6f7f5f2d-9e6b-411a-8cc9-5b7b02f6efdc", "created_by_ref": "identity--1425b09a-50d2-4c3a-8b35-114c3d3b1a6a", "modified": "2022-05-08T23:50:23.913", "name": "Update PHP to a non-vulnerable version", "description": "Update PHP to a non-vulnerable version to mitigate the vulnerability.", "related_sobject_ref": "indicator--2c18a93c-8a4c-4bbd-946a-f4e3f0d20a6a", "mitigated_by": "technique--a1b2c3d4e5f6g7h8i9j"}, {"type": "sighting", "id": "sighting--73fde61f-8b41-4314-8f6c-d4e21b50dfe5", "created_by_ref": "identity--1425b09a-50d2-4c3a-8b35-114c3d3b1a6a", "modified": "2022-05-08T23:50:23.913", "name": "Potential PHP PHAR Archive Permissions Vulnerability Sighting", "description": "A potential sight of the PHP PHAR Archive Permissions Vulnerability.", "related_sobject_ref": "indicator--2c18a93c-8a4c-4bbd-946a-f4e3f0d20a6a", "sighted_by": "identity--1425b09a-50d2-4c3a-8b35-114c3d3b1a6a"}], "notes": [{"id": "note--cece2345-1234-5678-1234-cece2345", "created_by_ref": "identity--1425b09a-50d2-4c3a-8b35-114c3d3b1a6a", "modified": "2022-05-08T23:50:23.913", "name": "Defense Point", "description": "Monitor system logs for suspicious activities, restrict access to the phar_build_from_iterator() function, and ensure that PHP is updated to a non-vulnerable version to defend against the PHP PHAR Archive Permissions Vulnerability.", "related_sobject_ref": "indicator--2c18a93c-8a4c-4bbd-946a-f4e3f0d20a6a"}]}, "technical_analysis": {"Introduction": "The PHP PHAR Archive Permissions Vulnerability is a vulnerability in PHP's PHAR archive creation functionality that allows an attacker to create a PHAR archive with files having lax permissions, leading to potential data breaches and integrity issues.", "Impact and Scope": "The vulnerability affects PHP versions 7.2.x below 7.2.28, 7.3.x below 7.3.15, and 7.4.x below 7.4.3. The CVSSv3.1 score is 5.3.", "Related MITRE ATT&CK Techniques": "T1204.001", "Technical Details": "The vulnerability occurs when creating a PHAR archive with the PharData::buildFromIterator() function, where files are added with default permissions (0666) even if the original files on the filesystem were with more restrictive permissions.", "Detection": "Monitor system logs for suspicious activities, such as the creation of PHAR archives with files having lax permissions.", "Mitigation": "Update PHP to a non-vulnerable version, restrict access to the phar_build_from_iterator() function, and monitor system logs for suspicious activities.", "Conclusion": "The PHP PHAR Archive Permissions Vulnerability is a critical vulnerability that requires immediate attention to prevent potential data breaches and integrity issues."}, "executive_analysis": {"Overview": "The PHP PHAR Archive Permissions Vulnerability is a critical vulnerability that affects PHP versions 7.2.x below 7.2.28, 7.3.x below 7.3.15, and 7.4.x below 7.4.3.", "Business Impact": "This vulnerability could lead to potential data breaches and integrity issues, resulting in revenue loss and damage to reputation.", "Technical Impact": "The vulnerability could allow an attacker to execute unintended code, leading to potential data breaches and integrity issues.", "Mitigation Strategies": "Update PHP to a non-vulnerable version, restrict access to the phar_build_from_iterator() function, and monitor system logs for suspicious activities.", "Recommendations": "Implement the recommended mitigation strategies to prevent potential data breaches and integrity issues.", "Conclusions": "The PHP PHAR Archive Permissions Vulnerability is a critical vulnerability that requires immediate attention to prevent potential data breaches and integrity issues."}}