{"id": "CVE-2024-41953", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-31T17:15:10.850", "lastModified": "2024-08-01T12:42:36.933", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Zitadel is an open source identity management system. ZITADEL uses HTML for emails and renders certain information such as usernames dynamically. That information can be entered by users or administrators. Due to a missing output sanitization, these emails could include malicious code. This may potentially lead to a threat where an attacker, without privileges, could send out altered notifications that are part of the registration processes. An attacker could create a malicious link, where the injected code would be rendered as part of the email. On the user's detail page, the username was also not sanitized and would also render HTML, giving an attacker the same vulnerability. While it was possible to inject HTML including javascript, the execution of such scripts would be prevented by most email clients and the Content Security Policy in Console UI. This vulnerability is fixed in 2.58.1, 2.57.1, 2.56.2, 2.55.5, 2.54.8 2.53.9, and 2.52.3."}, {"lang": "es", "value": "Zitadel es un sistema de gesti\u00f3n de identidades de c\u00f3digo abierto. ZITADEL utiliza HTML para los correos electr\u00f3nicos y muestra cierta informaci\u00f3n, como los nombres de usuario, de forma din\u00e1mica. Esa informaci\u00f3n puede ser ingresada por usuarios o administradores. Debido a la falta de sanitizaci\u00f3n de la salida, estos correos electr\u00f3nicos podr\u00edan incluir c\u00f3digo malicioso. Esto puede generar potencialmente una amenaza en la que un atacante, sin privilegios, podr\u00eda enviar notificaciones alteradas que forman parte de los procesos de registro. Un atacante podr\u00eda crear un enlace malicioso, donde el c\u00f3digo inyectado se presentar\u00eda como parte del correo electr\u00f3nico. En la p\u00e1gina de detalles del usuario, el nombre de usuario tampoco estaba sanitizado y tambi\u00e9n representaba HTML, lo que le daba al atacante la misma vulnerabilidad. Si bien era posible inyectar HTML, incluido JavaScript, la mayor\u00eda de los clientes de correo electr\u00f3nico y la Pol\u00edtica de seguridad de contenido en la interfaz de usuario de la consola impedir\u00edan la ejecuci\u00f3n de dichos scripts. Esta vulnerabilidad se solucion\u00f3 en 2.58.1, 2.57.1, 2.56.2, 2.55.5, 2.54.8 2.53.9 y 2.52.3."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "references": [{"url": "https://github.com/zitadel/zitadel/commit/0e1f99e987b5851caec45a72660fe9f67e425747", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/commit/38da602ee1cfc35c0d7918c298fbfc3f3674133b", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/commit/4b59cac67bb89c1f3f84a2041dd273d11151d29f", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/commit/c1a3fc72dde16e987d8a09aa291e7c2edfc928f7", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/commit/c353f82f89c6982c0888c6763363296cf4263cb2", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/commit/d04ac6df8f2f0243e649b802a8bfa6176cef0923", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/commit/f846616a3f022e88e3ea8cea05d3254ad86f1615", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/releases/tag/v2.52.3", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/releases/tag/v2.53.9", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/releases/tag/v2.54.8", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/releases/tag/v2.55.5", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/releases/tag/v2.56.2", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/releases/tag/v2.57.1", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/releases/tag/v2.58.1", "source": "security-advisories@github.com"}, {"url": "https://github.com/zitadel/zitadel/security/advisories/GHSA-v333-7h2p-5fhv", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-41953 - This vulnerability allows an unauthenticated attacker to inject malicious code into email notifications, which could lead to persistent Stored Cross-Site Scripting (XSS). This is relevant due to the potential for attackers to use this vulnerability to compromise user data and steal sensitive information."}, {"techniqueID": "T0027", "comment": "CVE-2024-41953 - This vulnerability could be used by attackers to conduct Cross-Site Scripting (XSS) attacks, as malicious code injected into email notifications could be executed within the victim's browser. Defending against this vulnerability requires implementing proper output encoding and sanitization of user input."}], "stix_bundle": {"objects": [{"type": "note", "created_by_ref": "organization-1", "object_ref": "cve-2024-41953", "created": "2024-08-01T12:42:36.933", "modified": "2024-08-01T12:42:36.933", "note": "CVE-2024-41953: A vulnerability in Zitadel's email notification system allows an attacker to inject malicious code, which can lead to persistent Stored Cross-Site Scripting (XSS)."}, {"type": "course-of-action", "created_by_ref": "organization-1", "object_ref": "cve-2024-41953", "created": "2024-08-01T12:42:36.933", "modified": "2024-08-01T12:42:36.933", "course_of_action": "Apply patch to Zitadel's email notification system", "relationship": {"rel_type": "mitigates", "object_ref": "T1190"}}, {"type": "indicator", "created_by_ref": "organization-1", "object_ref": "cve-2024-41953", "created": "2024-08-01T12:42:36.933", "modified": "2024-08-01T12:42:36.933", "name": "Malicious code injection", "description": "Look for abnormal code injection patterns in email notifications", "url": "https://example.com/indicator/malicious-code-injection", "relationship": {"rel_type": "detects", "object_ref": "T0027"}}], " relationships": [{"source_ref": "note-1", "target_ref": "cve-2024-41953"}, {"source_ref": "course-of-action-1", "target_ref": "cve-2024-41953"}, {"source_ref": "indicator-1", "target_ref": "cve-2024-41953"}, {"source_ref": "T1190", "target_ref": "course-of-action-1", "rel_type": "is-mitigated-by"}, {"source_ref": "T0027", "target_ref": "indicator-1", "rel_type": "alerts"}]}, "technical_analysis": {"Introduction": "CVE-2024-41953 is a vulnerability in Zitadel's email notification system that allows an attacker to inject malicious code, which can lead to persistent Stored Cross-Site Scripting (XSS).", "Impact and Scope": "The vulnerability has a CVSS score of 4.3 with a version of 3.1, and an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "T1190: Cross-Site Scripting (XSS) and T0027: Input Validation weakness.", "Technical Details": "The vulnerability occurs due to a lack of output sanitization in Zitadel's email notification system, allowing an attacker to inject malicious code.", "Detection": "Detection methods include monitoring for abnormal code injection patterns in email notifications.", "Mitigation": "Mitigation strategies include applying patches to Zitadel's email notification system and implementing proper output encoding and sanitization of user input.", "Conclusion": "In conclusion, CVE-2024-41953 is a serious vulnerability that requires immediate attention to prevent potential attacks."}, "executive_analysis": {"Overview": "CVE-2024-41953 is a vulnerability in Zitadel's email notification system that could lead to sensitive information theft and compromise.", "Business Impact": "The vulnerability poses a significant threat to business operations due to the potential for sensitive information theft.", "Technical Impact": "The vulnerability has a low impact on technical systems, but can compromise user data and steal sensitive information.", "Mitigation Strategies": "Apply patch to Zitadel's email notification system and implement proper output encoding and sanitization of user input.", "Recommendations": "Recommendations for executives include ensuring timely patching of systems and implementing additional security measures.", "Conclusions": "In conclusion, CVE-2024-41953 is a critical vulnerability that requires immediate attention to prevent potential attacks."}}