{"id": "CVE-2009-1801", "sourceIdentifier": "cve@mitre.org", "published": "2009-05-28T14:30:00.343", "lastModified": "2019-12-10T15:34:59.420", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple cross-site scripting (XSS) vulnerabilities in FreePBX 2.5.1, and other 2.4.x, 2.5.x, and pre-release 2.6.x versions, allow remote attackers to inject arbitrary web script or HTML via the (1) display parameter to reports.php, the (2) order and (3) extdisplay parameters to config.php, and the (4) sort parameter to recordings/index.php. NOTE: some of these details are obtained from third party information."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de ejecuci\u00f3n de secuencias de comandos en sitios cruzados(XSS) en FreePBX v2.5.1, y otras v2.4.x, v2.5.x, y versiones pre-release v2.6.x, permite a atacantes remotos inyectar secuencias de comandos web o HTML de su elecci\u00f3n a trav\u00e9s (1) del par\u00e1metro display a reports.php, (2) el order y (3) el par\u00e1metro extdisplay a config.php, y (4) el par\u00e1metro sort a recordings/index.php. NOTA: algunos de estos detalles han sido obtenidos a partir de terceros."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:freepbx:freepbx:2.4:*:*:*:*:*:*:*", "matchCriteriaId": "455E97D6-B069-49D6-B510-3D4112A9E1B3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:freepbx:freepbx:2.4.0_beta1:*:*:*:*:*:*:*", "matchCriteriaId": "BF1E1278-3114-4BD1-B589-30B5313C9502"}, {"vulnerable": true, "criteria": "cpe:2.3:a:freepbx:freepbx:2.4.0_beta2:*:*:*:*:*:*:*", "matchCriteriaId": "32D216B0-31D6-4288-8773-FB2438944492"}, {"vulnerable": true, "criteria": "cpe:2.3:a:freepbx:freepbx:2.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "0A09E3F0-E1A6-4CC4-8134-89DF5DB6EA3B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:freepbx:freepbx:2.5.0_beta1:*:*:*:*:*:*:*", "matchCriteriaId": "11ACC1C9-A2C3-41CA-B608-C474B642A380"}, {"vulnerable": true, "criteria": "cpe:2.3:a:freepbx:freepbx:2.5.0rc2:*:*:*:*:*:*:*", "matchCriteriaId": "D8A021AB-A142-4DAD-9EB0-2352C625D8CC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:freepbx:freepbx:2.5.0rc3:*:*:*:*:*:*:*", "matchCriteriaId": "9C0B173F-2161-4E40-A712-90DA6B997820"}, {"vulnerable": true, "criteria": "cpe:2.3:a:freepbx:freepbx:2.5.1:*:*:*:*:*:*:*", "matchCriteriaId": "613A39A4-976E-4535-9408-533F957F7F87"}, {"vulnerable": true, "criteria": "cpe:2.3:a:freepbx:freepbx:2.5.2:*:*:*:*:*:*:*", "matchCriteriaId": "B5B657C6-A2DF-432A-9F46-1157C630CB20"}, {"vulnerable": true, "criteria": "cpe:2.3:a:sangoma:freepbx:2.4.0:*:*:*:*:*:*:*", "matchCriteriaId": "9734B50E-BEA8-41DF-835F-7B15A9BB31E8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:sangoma:freepbx:2.5.0:*:*:*:*:*:*:*", "matchCriteriaId": "E9645D4F-BB03-49AD-AE79-6FE990BF18FE"}]}]}], "references": [{"url": "http://freepbx.org/trac/ticket/3660", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/54259", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/54260", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/54261", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/34772", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/34857", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/50361", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2009-1801 - This XSS vulnerability can be used for remote code execution. The attacker can inject arbitrary web script or HTML via parameters in reports.php, config.php, or recordings/index.php. This is a technique used in many penetration testing frameworks, including Metasploit."}, {"techniqueID": "T1075", "comment": "CVE-2009-1801 - Cross-site scripting (XSS) vulnerabilities can be used to inject malicious scripts. The attacker can inject JavaScript code that steals user credentials, transfers files, or executes other malicious actions."}], "stix_bundle": {"id": "https://example.com/stix_bundle.cortex", "type": "stix_bundle", "spec_version": "2.1", "bundle_id": "CVE-2009-1801-STIX-BUNDLE", " bundles": [{"id": "https://example.com/cve-2009-1801.cortex", "type": "stix_cve", "cve_id": "CVE-2009-1801"}, {"id": "https://example.com/attack-technique-1.cortex", "type": "stix_attack_pattern", "description": "The attacker injects arbitrary web script or HTML via parameters in reports.php, config.php, or recordings/index.php.", "name": "Cross-Site Scripting (XSS)", "kill_chain_phases": [{"kill_chain_name": "ATT&CK", "phase_name": "Defense Evasion"}]}, {"id": "https://example.com/defense-technique-1.cortex", "type": "stix_observable", "description": "Regularly update and patch FreePBX to prevent exploitation of this vulnerability.", "name": "Patch Management", "kill_chain_phases": [{"kill_chain_name": "ATT&CK", "phase_name": "Mitigation"}]}, {"id": "https://example.com/detection-technique-1.cortex", "type": "stix_observable", "description": "Monitor for unusual traffic or suspicious behavior on the FreePBX server.", "name": "Anomaly Detection", "kill_chain_phases": [{"kill_chain_name": "ATT&CK", "phase_name": "Detection"}]}], "relationship": [{"relationship_type": "related_to", "id_ref": "https://example.com/cve-2009-1801.cortex", "id": "https://example.com/attack-technique-1.cortex"}, {"relationship_type": "mitigated_by", "id_ref": "https://example.com/cve-2009-1801.cortex", "id": "https://example.com/defense-technique-1.cortex"}, {"relationship_type": "detected_by", "id_ref": "https://example.com/cve-2009-1801.cortex", "id": "https://example.com/detection-technique-1.cortex"}]}, "technical_analysis": {"Introduction": "CVE-2009-1801 is a cross-site scripting (XSS) vulnerability in FreePBX, a popular open-source IP PBX software. This vulnerability allows an attacker to inject arbitrary web script or HTML via parameters in reports.php, config.php, or recordings/index.php.", "Impact and Scope": "The vulnerability has a CVSS score of 4.3 and an attack vector of NETWORK. It affects all versions of FreePBX prior to 2.6.x. Exploitation of this vulnerability can lead to remote code execution, data theft, and other malicious activities.", "Related MITRE ATT&CK Techniques": "T1059 - Exploitation of Application Layer Protocols, T1075 - Input Validation Bugs", "Technical Details": "The vulnerability is caused by insufficient input validation in FreePBX, which allows an attacker to inject malicious script code. The attacker can inject JavaScript code that steals user credentials, transfers files, or executes other malicious actions.", "Detection": "Monitor for unusual traffic or suspicious behavior on the FreePBX server. Regularly update and patch FreePBX to prevent exploitation of this vulnerability.", "Mitigation": "Regularly update and patch FreePBX to prevent exploitation of this vulnerability. Limit access to the FreePBX server and monitor for unusual traffic or suspicious behavior.", "Conclusion": "In conclusion, CVE-2009-1801 is a critical vulnerability in FreePBX that can be exploited by an attacker to gain unauthorized access to a network. It is essential to regularly update and patch FreePBX to prevent exploitation of this vulnerability and monitor for unusual traffic or suspicious behavior."}, "executive_analysis": {"Overview": "CVE-2009-1801 is a critical vulnerability in FreePBX that can be exploited by an attacker to gain unauthorized access to a network. It is essential to regularly update and patch FreePBX to prevent exploitation of this vulnerability.", "Business Impact": "The vulnerability can result in the compromise of sensitive data, disruption of business operations, and damage to the organization's reputation.", "Technical Impact": "The vulnerability can be exploited by an attacker to gain unauthorized access to a network, which can lead to data theft, ransomware attacks, and other malicious activities.", "Mitigation Strategies": "Regularly update and patch FreePBX to prevent exploitation of this vulnerability. Limit access to the FreePBX server and monitor for unusual traffic or suspicious behavior.", "Recommendations": "Recommend that FreePBX users update their software regularly and follow best practices for security.", "Conclusions": "In conclusion, it is essential for FreePBX users to regularly update and patch their software to prevent exploitation of this vulnerability. Additionally, monitoring for unusual traffic or suspicious behavior can help detect and prevent attacks."}}