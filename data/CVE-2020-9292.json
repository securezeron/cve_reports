{"id": "CVE-2020-9292", "sourceIdentifier": "psirt@fortinet.com", "published": "2020-06-04T13:15:11.367", "lastModified": "2020-06-09T17:21:31.920", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An unquoted service path vulnerability in the FortiSIEM Windows Agent component may allow an attacker to gain elevated privileges via the AoWinAgt executable service path."}, {"lang": "es", "value": "Una vulnerabilidad de la ruta de servicio sin comillas en el componente FortiSIEM Windows Agent puede permitir a un atacante alcanzar privilegios elevados por medio de la ruta de servicio del ejecutable AoWinAgt"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-428"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:fortinet:fortisiem_windows_agent:*:*:*:*:*:*:*:*", "versionEndIncluding": "3.1.2", "matchCriteriaId": "B60709A5-29E1-4C6D-990B-D65C736D1F7B"}]}]}], "references": [{"url": "https://fortiguard.com/advisory/FG-IR-20-021", "source": "psirt@fortinet.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-9292 - This vulnerability is an example of an unquoted service path vulnerability, which can be exploited by an attacker to gain elevated privileges. This is relevant as it highlights the importance of proper configuration and validation of service paths to prevent such attacks."}, {"techniqueID": "T1190.001", "comment": "CVE-2020-9292 - This specific technique involves an unquoted service path in the AoWinAgt executable service, which is the root cause of the vulnerability."}, {"techniqueID": "T1112", "comment": "CVE-2020-9292 - This technique involves the exploitation of a vulnerable service to gain elevated privileges. Defending against this technique requires ensuring that all services are properly configured and validated."}, {"techniqueID": "T1036", "comment": "CVE-2020-9292 - This technique involves the exploitation of a vulnerability in the FortiSIEM Windows Agent component to gain elevated privileges. Defending against this technique requires ensuring that all FortiSIEM components are properly configured and validated."}, {"techniqueID": "T1204", "comment": "CVE-2020-9292 - This technique involves the exploitation of a vulnerable service to gain access to a system. Defending against this technique requires ensuring that all systems are properly configured and validated."}], "stix_bundle": {"@context": "https://cybox.mitre.org/XMLSchema/cybox-2/2.1/cybox_common_core_properties-v2.1.owl", "profile": "STIX 2.1", "objects": [{"@type": "malware", "name": "CVE-2020-9292", "label": "Malware", "description": "FortiSIEM Windows Agent vulnerable to unquoted service path exploitation", "properties": [{"@type": "Observable", "@value": "CVE-2020-9292", "name": "vulnerable_software_site"}, {"@type": "Observable", "@value": "FortiSIEM Windows Agent", "name": "vulnerable_software"}]}, {"@type": "threat-actor", "name": "Actor", "label": "Threat Actor", "description": "An attacker using the unquoted service path vulnerability to gain elevated privileges", "properties": [{"@type": "Observable", "@value": "unquoted_service_path", "name": "attack_patterns"}]}, {"@type": "course-of-action", "name": "Defensive Action", "label": "Defensive Action", "description": "Ensure all FortiSIEM components are properly configured and validated to prevent exploitation", "properties": [{"@type": "Observable", "@value": "mitigation_bypass", "name": "defensive_technique"}]}, {"@type": "indicator", "name": "Indicator", "label": "Indicator", "description": "Activity indicating potential exploitation of the unquoted service path vulnerability", "properties": [{"@type": "Observable", "@value": "unquoted_service_path_exploitation", "name": "indicator"}]}], "relationships": [{"@type": "related_to", "source": "malware", "target": "threat-actor", "relationship_type": "was_exploited_by"}, {"@type": "related_to", "source": "threat-actor", "target": "course-of-action", "relationship_type": "was_mitigated_by"}, {"@type": "related_to", "source": "malware", "target": "indicator", "relationship_type": "produces"}]}, "technical_analysis": {"Introduction": "The FortiSIEM Windows Agent is vulnerable to an unquoted service path vulnerability, which can be exploited by an attacker to gain elevated privileges.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and an exploitability score of 3.9, and can be exploited via a network attack vector.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to techniques T1190, T1190.001, T1112, T1036, and T1204, all of which involve exploitation of vulnerable services or unquoted service paths.", "Technical Details": "The vulnerability is due to an unquoted service path in the AoWinAgt executable service in the FortiSIEM Windows Agent component. This allows an attacker to execute arbitrary code with elevated privileges.", "Detection": "Detection of this vulnerability involves monitoring for suspicious service path exploitation activity and verifying that all FortiSIEM components are properly configured and validated.", "Mitigation": "Mitigation of this vulnerability involves ensuring that all FortiSIEM components are properly configured and validated, and implementing defensive measures to prevent exploitation of vulnerable services.", "Conclusion": "In conclusion, the FortiSIEM Windows Agent vulnerability highlights the importance of proper configuration and validation of service paths to prevent exploitation of vulnerable services."}, "executive_analysis": {"Overview": "The FortiSIEM Windows Agent has a critical vulnerability that can be exploited by an attacker to gain elevated privileges.", "Business Impact": "The vulnerability could allow an attacker to gain access to sensitive data and compromise the confidentiality, integrity, and availability of the system.", "Technical Impact": "The vulnerability could allow an attacker to execute arbitrary code with elevated privileges, potentially leading to compromise of the system.", "Mitigation Strategies": "Implementing proper configuration and validation of service paths, as well as defensive measures to prevent exploitation of vulnerable services, are key mitigation strategies.", "Recommendations": "Executives should ensure that all FortiSIEM components are properly configured and validated, and that defensive measures are in place to prevent exploitation of vulnerable services.", "Conclusions": "In conclusion, it is essential to take immediate action to prevent exploitation of this vulnerability, and to ensure that all systems are properly configured and validated to prevent future vulnerabilities."}}