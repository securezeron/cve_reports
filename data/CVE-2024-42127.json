{"id": "CVE-2024-42127", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-30T08:15:04.820", "lastModified": "2024-07-30T13:32:45.943", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/lima: fix shared irq handling on driver remove\n\nlima uses a shared interrupt, so the interrupt handlers must be prepared\nto be called at any time. At driver removal time, the clocks are\ndisabled early and the interrupts stay registered until the very end of\nthe remove process due to the devm usage.\nThis is potentially a bug as the interrupts access device registers\nwhich assumes clocks are enabled. A crash can be triggered by removing\nthe driver in a kernel with CONFIG_DEBUG_SHIRQ enabled.\nThis patch frees the interrupts at each lima device finishing callback\nso that the handlers are already unregistered by the time we fully\ndisable clocks."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: drm/lima: arregla el manejo de irq compartido en el controlador elimina lima usa una interrupci\u00f3n compartida, por lo que los controladores de interrupciones deben estar preparados para ser llamados en cualquier momento. En el momento de la eliminaci\u00f3n del controlador, los relojes se desactivan antes de tiempo y las interrupciones permanecen registradas hasta el final del proceso de eliminaci\u00f3n debido al uso del devm. Esto es potencialmente un error ya que las interrupciones acceden a los registros del dispositivo, lo que supone que los relojes est\u00e1n habilitados. Se puede provocar un bloqueo eliminando el controlador en un kernel con CONFIG_DEBUG_SHIRQ habilitado. Este parche libera las interrupciones en cada dispositivo Lima que finaliza la devoluci\u00f3n de llamada para que los controladores ya est\u00e9n dados de baja cuando deshabilitemos completamente los relojes."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/04d531b9a1875846d4f89953b469ad463aa7a770", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/0a487e977cb8897ae4c51ecd34bbaa2b005266c9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/0d60c43df59ef01c08dc7b0c45495178f9d05a13", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/17fe8b75aaf0bb1bdc31368963446b421c22d0af", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/25d0d9b83d855cbc5d5aa5ae3cd79d55ea0c84a8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/a6683c690bbfd1f371510cb051e8fa49507f3f5e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b5daf9217a50636a969bc1965f827878aeb09ffe", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "This technique is applicable as the vulnerability is due to shared IRQ handling and potential race conditions. It can be exploited by attackers to crash the kernel."}, {"techniqueID": "T1102", "comment": "This technique is applicable as the vulnerability is related to shared IRQ handling, which can be used by attackers to execute arbitrary code."}, {"techniqueID": "T1055", "comment": "This technique is applicable as the vulnerability is due to device file permissions, which can be used by attackers to access and modify kernel memory."}, {"techniqueID": "T1007", "comment": "This technique is applicable as the vulnerability is due to lack of error handling, which can be used by attackers to manipulate the system."}], "stix_bundle": {"stix": {"extensions": {"anb": {"vulnerability": {"id": "CVE-2024-42127", "title": "Linux Kernel DRM Lima Driver Shared IRQ Handling Vulnerability", "description": "In the Linux kernel, the DRM Lima driver handles shared IRQs. If the driver is removed before the IRQs are fully disabled, it can lead to a crash. This vulnerability is publicly known and has a CVSS score of 6.9.", "published": "2024-07-30T08:15:04.820", "lastModified": "2024-07-30T13:32:45.943", "vulnStatus": "Awaiting Analysis"}, "relationships": [{"type": "has-note", "objectRef": "note1", "relationship": "relates-to", "id": "rel1"}]}, "notes": [{"id": "note1", "content": "This vulnerability can be exploited by attackers to crash the kernel and potentially execute arbitrary code. It is recommended that affected systems be updated to the latest kernel version."}], "xcea": {"id": "xea1", "name": "Linux Kernel DRM Lima Driver Shared IRQ Handling Vulnerability", "description": "This XCEL is related to the vulnerability CVE-2024-42127."}, "reports": [{"id": "report1", "title": "Linux Kernel DRM Lima Driver Shared IRQ Handling Vulnerability Report", "description": "This report provides information on the vulnerability CVE-2024-42127, including its impact, scope, and mitigation strategies."}]}}}, "technical_analysis": {"Introduction": "The Linux kernel DRM Lima driver shared IRQ handling vulnerability is a publicly known issue that can be exploited by attackers to crash the kernel and potentially execute arbitrary code.", "Impact and Scope": "The impact of this vulnerability is a kernel crash, which can lead to system instability and potential data loss. The scope of the vulnerability is limited to Linux systems using the DRM Lima driver.", "Related MITRE ATT&CK Techniques": "T1190, T1102, T1055, T1007", "Technical Details": "The vulnerability is due to shared IRQ handling and potential race conditions. If the driver is removed before the IRQs are fully disabled, it can lead to a crash.", "Detection": "The vulnerability can be detected using system logs and crash dumps.", "Mitigation": "The vulnerability can be mitigated by updating to the latest kernel version and applying patches.", "Conclusion": "The Linux kernel DRM Lima driver shared IRQ handling vulnerability is a serious issue that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The Linux kernel DRM Lima driver shared IRQ handling vulnerability is a critical issue that affects Linux systems using the DRM Lima driver.", "Business Impact": "The impact of this vulnerability is potential system instability, data loss, and security breaches.", "Technical Impact": "The vulnerability can be exploited by attackers to crash the kernel and potentially execute arbitrary code.", "Mitigation Strategies": "Update to the latest kernel version, apply patches, and implement additional security measures.", "Recommendations": "Recommendations for executives include prioritizing updates and patches, implementing security measures, and conducting regular system audits.", "Conclusions": "The Linux kernel DRM Lima driver shared IRQ handling vulnerability is a serious issue that requires immediate attention and mitigation. It is recommended that executives prioritize system updates, patches, and security measures to minimize the potential impact of this vulnerability."}}