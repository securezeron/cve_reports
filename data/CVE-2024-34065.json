{"id": "CVE-2024-34065", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-12T15:15:51.460", "lastModified": "2024-06-13T18:36:09.010", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Strapi is an open-source content management system. By combining two vulnerabilities (an `Open Redirect` and `session token sent as URL query parameter`) in @strapi/plugin-users-permissions before version 4.24.2, is its possible of an unauthenticated attacker to bypass authentication mechanisms and retrieve the 3rd party tokens. The attack requires user interaction (one click). Unauthenticated attackers can leverage two vulnerabilities to obtain an 3rd party token and the bypass authentication of Strapi apps. Users should upgrade @strapi/plugin-users-permissions to version 4.24.2 to receive a patch."}, {"lang": "es", "value": "Strapi es un sistema de gesti\u00f3n de contenidos de c\u00f3digo abierto. Al combinar dos vulnerabilidades (un `Open Redirect` y un `token de sesi\u00f3n enviado como par\u00e1metro de consulta de URL`) en @strapi/plugin-users-permissions antes de la versi\u00f3n 4.24.2, es posible que un atacante no autenticado evite los mecanismos de autenticaci\u00f3n y recupere  the 3rd party tokens. El ataque requiere la interacci\u00f3n del usuario (un clic). Los atacantes no autenticados pueden aprovechar dos vulnerabilidades para obtener un token de terceros y evitar la autenticaci\u00f3n de las aplicaciones Strapi. Los usuarios deben actualizar @strapi/plugin-users-permissions a la versi\u00f3n 4.24.2 para recibir un parche."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 7.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-294"}, {"lang": "en", "value": "CWE-601"}]}], "references": [{"url": "https://github.com/strapi/strapi/security/advisories/GHSA-wrvh-rcmr-9qfc", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-34065 - This technique involves using a combination of open redirect and session token sent as URL query parameter to bypass authentication mechanisms and retrieve 3rd party tokens."}, {"techniqueID": "T1191", "comment": "CVE-2024-34065 - This technique involves leveraging an open redirect to redirect users to malicious websites and steal sensitive information."}, {"techniqueID": "T1144", "comment": "CVE-2024-34065 - This technique involves using a session token sent as URL query parameter to gain unauthorized access to an application."}, {"techniqueID": "T1195", "comment": "CVE-2024-34065 - This technique involves using user interaction to trick users into clicking on a malicious link and stealing sensitive information."}], "technical_analysis": {"Introduction": "CVE-2024-34065 is a vulnerability in Strapi's @strapi/plugin-users-permissions that allows an unauthenticated attacker to bypass authentication mechanisms and retrieve 3rd party tokens.", "Impact and Scope": "The vulnerability has a CVSS 3.1 score of 7.1, with an attack vector of NETWORK, attack complexity of LOW, and user interaction required. The confidentiality impact is HIGH, integrity impact is LOW, and availability impact is NONE.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1190, T1191, T1144, and T1195.", "Technical Details": "The vulnerability is due to a combination of open redirect and session token sent as URL query parameter, which allows an unauthenticated attacker to bypass authentication mechanisms and retrieve 3rd party tokens.", "Detection": "The vulnerability can be detected by monitoring for unusual login activity, inspecting HTTP requests for suspicious redirects, and checking for the presence of 3rd party tokens in URL queries.", "Mitigation": "The vulnerability can be mitigated by upgrading @strapi/plugin-users-permissions to version 4.24.2, disabling open redirects, and implementing rate limiting on login attempts.", "Conclusion": "CVE-2024-34065 is a significant vulnerability that requires immediate attention and mitigation. Proper patching and defense strategies are crucial to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-34065 is a vulnerability in Strapi's @strapi/plugin-users-permissions that can allow an unauthenticated attacker to bypass authentication mechanisms and retrieve 3rd party tokens.", "Business Impact": "The vulnerability can result in sensitive information being stolen, and can lead to financial loss and reputational damage.", "Technical Impact": "The vulnerability can allow an attacker to gain unauthorized access to an application, and can lead to a complete compromise of the system.", "Mitigation Strategies": "Upgrading @strapi/plugin-users-permissions to version 4.24.2, disabling open redirects, and implementing rate limiting on login attempts are recommended mitigation strategies.", "Recommendations": "Executives should recommend immediate patching and defense strategies to the development team, and should ensure that incident response plans are up-to-date to handle potential breaches.", "Conclusions": "CVE-2024-34065 is a critical vulnerability that requires immediate attention and mitigation. Executives should prioritize patching and defense strategies to prevent exploitation and minimize business risk."}}