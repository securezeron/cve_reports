{"id": "CVE-2024-38559", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-19T14:15:16.077", "lastModified": "2024-07-15T07:15:09.480", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: qedf: Ensure the copied buf is NUL terminated\n\nCurrently, we allocate a count-sized kernel buffer and copy count from\nuserspace to that buffer. Later, we use kstrtouint on this buffer but we\ndon't ensure that the string is terminated inside the buffer, this can\nlead to OOB read when using kstrtouint. Fix this issue by using\nmemdup_user_nul instead of memdup_user."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: scsi: qedf: aseg\u00farese de que el buf copiado tenga terminaci\u00f3n NUL. Actualmente, asignamos un b\u00fafer del kernel del tama\u00f1o de un conteo y copiamos el conteo desde el espacio de usuario a ese b\u00fafer. M\u00e1s adelante, usamos kstrtouint en este b\u00fafer pero no nos aseguramos de que la cadena termine dentro del b\u00fafer, esto puede provocar una lectura OOB cuando usamos kstrtouint. Solucione este problema utilizando memdup_user_nul en lugar de memdup_user."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/177f43c6892e6055de6541fe9391a8a3d1f95fc9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/1f84a2744ad813be23fc4be99fb74bfb24aadb95", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/4907f5ad246fa9b51093ed7dfc7da9ebbd3f20b8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/563e609275927c0b75fbfd0d90441543aa7b5e0d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/769b9fd2af02c069451fe9108dba73355d9a021c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/a75001678e1d38aa607d5b898ec7ff8ed0700d59", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d0184a375ee797eb657d74861ba0935b6e405c62", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d93318f19d1e1a6d5f04f5d965eaa9055bb7c613", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/dccd97b39ab2f2b1b9a47a1394647a4d65815255", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-38559 - The Linux kernel vulnerability in qedf driver allows an attacker to potentially execute arbitrary code and potentially escalate privileges."}, {"techniqueID": "T1190", "comment": "CVE-2024-38559 - The vulnerability in Linux kernel's qedf driver could be used by attackers to inject malicious kernel code and potentially escalate privileges."}, {"techniqueID": "T1060", "comment": "CVE-2024-38559 - The vulnerability in Linux kernel's qedf driver could be used by attackers to read sensitive data from kernel memory and potentially elevate privileges."}, {"techniqueID": "T1077", "comment": "CVE-2024-38559 - The vulnerability in Linux kernel's qedf driver could be used by attackers to create a backdoor in the kernel and potentially elevate privileges."}], "stix_bundle": {"stix_bundle": {"type": "bundle", "id": "bundle--cve-2024-38559", "created_by_ref": "identity--your-identity-ref", "created": "2024-07-15T14:30:00.000Z", "modified": "2024-07-15T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "vulnerability--cve-2024-38559", "created_by_ref": "identity--your-identity-ref", "created": "2024-07-15T14:30:00.000Z", "modified": "2024-07-15T14:30:00.000Z", "name": "CVE-2024-38559", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: qedf: Ensure the copied buf is NUL terminated\n\nCurrently, we allocate a count-sized kernel buffer and copy count from\nuserspace to that buffer. Later, we use kstrtouint on this buffer but we\ndon't ensure that the string is terminated inside the buffer, this can\nlead to OOB read when using kstrtouint. Fix this issue by using\nmemdup_user_nul instead of memdup_user.", "cve_id": "CVE-2024-38559"}, {"type": "indicator", "id": "indicator--kernel-memory-reading", "created_by_ref": "identity--your-identity-ref", "created": "2024-07-15T14:30:00.000Z", "modified": "2024-07-15T14:30:00.000Z", "name": "Kernel Memory Reading", "description": "Detects attempts to read kernel memory", "confidence": 0.9, "granularity_sel": "Process"}, {"type": "course_of_action", "id": "course_of_action--update-kernel", "created_by_ref": "identity--your-identity-ref", "created": "2024-07-15T14:30:00.000Z", "modified": "2024-07-15T14:30:00.000Z", "name": "Update Linux Kernel", "description": "Update the Linux kernel to a version that addresses the CVE-2024-38559 vulnerability", "mitigated_by_ref": "technique--mitigate-cve-2024-38559"}, {"type": "technique", "id": "technique--mitigate-cve-2024-38559", "created_by_ref": "identity--your-identity-ref", "created": "2024-07-15T14:30:00.000Z", "modified": "2024-07-15T14:30:00.000Z", "name": "Mitigate CVE-2024-38559", "description": "Detect and prevent attempts to exploit the CVE-2024-38559 vulnerability", "linked_analysis": ["attack_pattern--cve-2024-38559"]}, {"type": "attack_pattern", "id": "attack_pattern--cve-2024-38559", "created_by_ref": "identity--your-identity-ref", "created": "2024-07-15T14:30:00.000Z", "modified": "2024-07-15T14:30:00.000Z", "name": "CVE-2024-38559 Exploit", "description": "Exploits the CVE-2024-38559 vulnerability in the Linux kernel", "used_by_ref": ["technique--mitigate-cve-2024-38559"]}], "relationships": [{"from_ref": "vulnerability--cve-2024-38559", "to_ref": "indicator--kernel-memory-reading", "relationship_type": "indicates"}, {"from_ref": "vulnerability--cve-2024-38559", "to_ref": "course_of_action--update-kernel", "relationship_type": "mitigates"}, {"from_ref": "technique--mitigate-cve-2024-38559", "to_ref": "attack_pattern--cve-2024-38559", "relationship_type": "used_by"}]}}, "technical_analysis": {"Introduction": "The CVE-2024-38559 vulnerability is a Linux kernel vulnerability in the qedf driver that allows an attacker to potentially execute arbitrary code and potentially escalate privileges.", "Impact and Scope": "The vulnerability affects Linux kernel versions 4.12 and later. The attack vector is unknown, but it is likely to be exploited through a network attack.", "Related MITRE ATT&CK Techniques": "T1059, T1190, T1060, T1077", "Technical Details": "The vulnerability occurs when the qedf driver does not properly validate user input, allowing an attacker to inject malicious code.", "Detection": "This vulnerability can be detected by monitoring kernel memory usage and detecting unusual patterns.", "Mitigation": "The vulnerability can be mitigated by updating the Linux kernel to a version that addresses the vulnerability.", "Conclusion": "This vulnerability poses a significant threat to Linux systems and should be addressed promptly."}, "executive_analysis": {"Overview": "The CVE-2024-38559 vulnerability is a critical Linux kernel vulnerability that poses a significant threat to Linux systems.", "Business Impact": "This vulnerability could allow an attacker to gain unauthorized access to sensitive data and systems, which could result in significant business disruption and financial losses.", "Technical Impact": "The vulnerability allows an attacker to potentially escalate privileges and execute arbitrary code, which could result in a complete compromise of the system.", "Mitigation Strategies": "Update the Linux kernel to a version that addresses the vulnerability.", "Recommendations": "Executive management should prioritize the mitigation of this vulnerability and ensure that all Linux systems are updated promptly.", "Conclusions": "This vulnerability is a critical risk to Linux systems and should be addressed promptly to prevent significant business disruption and financial losses."}}