{"id": "CVE-2024-2361", "sourceIdentifier": "security@huntr.dev", "published": "2024-05-16T09:15:10.060", "lastModified": "2024-05-16T13:03:05.353", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability in the parisneo/lollms-webui allows for arbitrary file upload and read due to insufficient sanitization of user-supplied input. Specifically, the issue resides in the `install_model()` function within `lollms_core/lollms/binding.py`, where the application fails to properly sanitize the `file://` protocol and other inputs, leading to arbitrary read and upload capabilities. Attackers can exploit this vulnerability by manipulating the `path` and `variant_name` parameters to achieve path traversal, allowing for the reading of arbitrary files and uploading files to arbitrary locations on the server. This vulnerability affects the latest version of parisneo/lollms-webui."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.6, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.8, "impactScore": 6.0}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-29"}]}], "references": [{"url": "https://huntr.com/bounties/cd383817-924a-445a-838e-d0c867c6a176", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1196", "comment": "CVE-2024-2361 - This Technique allows an attacker to upload and read arbitrary files due to insufficient sanitization of user-supplied input."}, {"techniqueID": "T1036", "comment": "CVE-2024-2361 - This Technique allows an attacker to achieve path traversal and read arbitrary files."}, {"techniqueID": "T1027", "comment": "CVE-2024-2361 - This Technique allows an attacker to upload files to arbitrary locations on the server."}, {"techniqueID": "T1197", "comment": "CVE-2024-2361 - This Technique allows an attacker to read and upload files to arbitrary locations on the server."}], "stix_bundle": {"bundle_id": "https://huntr.dev/cve/CVE-2024-2361", "title": "Huntr Dev: CVE-2024-2361: ParisNeo/Lollms-WebUI File Upload and Read Vulnerability", "authors": [], "description": "This bundle represents a STIX 2.1 expression of the CVE-2024-2361 vulnerability and the related defense strategies.", "objects": [{"id": "https://huntr.dev/cve/CVE-2024-2361", "type": "Vulnerability", "description": "ParisNeo/Lollms-WebUI File Upload and Read Vulnerability", "first_seen": "2024-05-16T09:15:10.060", "lastSeen": "2024-05-16T13:03:05.353", "cvss": {"vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H", "baseScore": 9.6, "baseSeverity": "CRITICAL"}}, {"id": "https://huntr.dev/cve/CVE-2024-2361/technique/T1196", "type": "TTP", "description": "Arbitrary File Upload and Read", "techniqueID": "T1196", "related_obj": "https://huntr.dev/cve/CVE-2024-2361"}, {"id": "https://huntr.dev/cve/CVE-2024-2361/technique/T1036", "type": "TTP", "description": "Path Traversal and File Read", "techniqueID": "T1036", "related_obj": "https://huntr.dev/cve/CVE-2024-2361"}, {"id": "https://huntr.dev/cve/CVE-2024-2361/defensive_countermeasures/DCM1", "type": "Defensive Countermeasure", "description": "Validate and sanitize user input", "mitigates": "https://huntr.dev/cve/CVE-2024-2361/technique/T1196"}, {"id": "https://huntr.dev/cve/CVE-2024-2361/defensive_countermeasures/DCM2", "type": "Defensive Countermeasure", "description": "Restrict file upload and read to authorized directories", "mitigates": "https://huntr.dev/cve/CVE-2024-2361/technique/T1036"}], "relations": [{"relationship_type": "mitigates", "source": "https://huntr.dev/cve/CVE-2024-2361/defensive_countermeasures/DCM1", "target": "https://huntr.dev/cve/CVE-2024-2361/technique/T1196"}, {"relationship_type": "mitigates", "source": "https://huntr.dev/cve/CVE-2024-2361/defensive_countermeasures/DCM2", "target": "https://huntr.dev/cve/CVE-2024-2361/technique/T1036"}]}, "technical_analysis": {"Introduction": "This Technical Analysis will outline the vulnerability discovered in ParisNeo/Lollms-WebUI, CVE-2024-2361.", "Impact and Scope": "The vulnerability allows an attacker to upload and read arbitrary files due to insufficient sanitization of user-supplied input.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1196, T1036, and T1027, which are all components of the exploitation process.", "Technical Details": "The vulnerability resides in the `install_model()` function within `lollms_core/lollms/binding.py`, where the application fails to properly sanitize the `file://` protocol and other inputs.", "Detection": "The vulnerability can be detected by monitoring for unusual file upload and read activity, and verifying the validity of user-supplied input.", "Mitigation": "Validating and sanitizing user input, and restricting file upload and read to authorized directories, can mitigate the vulnerability.", "Conclusion": "In conclusion, the vulnerability in ParisNeo/Lollms-WebUI, CVE-2024-2361, is a critical issue that requires immediate attention."}, "executive_analysis": {"Overview": "This Executive Analysis provides an overview of the vulnerability in ParisNeo/Lollms-WebUI, CVE-2024-2361, and its potential impact on the organization.", "Business Impact": "The vulnerability could lead to the loss of sensitive data, disruption of business operations, and compromise of the organization's reputation.", "Technical Impact": "The vulnerability could allow an attacker to exploit the system and gain unauthorized access to sensitive data, systems, and networks.", "Mitigation Strategies": "Validating and sanitizing user input, and restricting file upload and read to authorized directories, can mitigate the vulnerability.", "Recommendations": "The organization should prioritize remediating the vulnerability, and implement defenses to prevent similar vulnerabilities from occurring in the future.", "Conclusions": "In conclusion, the vulnerability in ParisNeo/Lollms-WebUI, CVE-2024-2361, is a critical issue that requires immediate attention and mitigation efforts."}}