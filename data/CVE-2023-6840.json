{"id": "CVE-2023-6840", "sourceIdentifier": "cve@gitlab.com", "published": "2024-02-07T22:15:09.500", "lastModified": "2024-03-04T20:52:05.890", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue has been discovered in GitLab EE affecting all versions from 16.4 prior to 16.6.7, 16.7 prior to 16.7.5, and 16.8 prior to 16.8.2 which allows a maintainer to change the name of a protected branch that bypasses the security policy added to block MR."}, {"lang": "es", "value": "Se ha descubierto un problema en GitLab EE que afecta a todas las versiones desde 16.4 anterior a 16.6.7, 16.7 anterior a 16.7.5 y 16.8 anterior a 16.8.2 lo que permite a un fabricante cambiar el nombre de una rama protegida que omite la pol\u00edtica de seguridad agregada para bloquear MR."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 5.5}, {"source": "cve@gitlab.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 5.5}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}, {"source": "cve@gitlab.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-284"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "16.4.0", "versionEndExcluding": "16.6.7", "matchCriteriaId": "5A1A9E0E-DFC2-4567-9218-6F7B9FE56F34"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "16.7.0", "versionEndExcluding": "16.7.5", "matchCriteriaId": "8ECA9350-B77B-41F6-B234-72BF47FD50E7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "16.8.0", "versionEndExcluding": "16.8.2", "matchCriteriaId": "FDA190F8-0AAA-44DF-8A6B-A9A4380D478C"}]}]}], "references": [{"url": "https://gitlab.com/gitlab-org/gitlab/-/issues/435500", "source": "cve@gitlab.com", "tags": ["Issue Tracking", "Permissions Required"]}, {"url": "https://hackerone.com/reports/2280292", "source": "cve@gitlab.com", "tags": ["Permissions Required", "Technical Description"]}], "techniques": [{"techniqueID": "T1228", "comment": "CVE-2023-6840 - This vulnerability allows attackers to bypass security policies and change the name of protected branches, enabling unauthenticated attacks, which is a typical indicator of a MITRE ATT&CK T1228-Domain Name System (DNS) Service is being exploited for unauthorized access and is a sign of a lateral movement technique."}, {"techniqueID": "T1034", "comment": "CVE-2023-6840 - This vulnerability also allows attackers to gain unauthorized access and manipulate data, which is a typical indicator of a MITRE ATT&CK T1034-Windows Command Shell exploitation, as privileges are elevated, and the attacker is able to move the attack chain."}, {"techniqueID": "T1007", "comment": "CVE-2023-6840 - This vulnerability also enables attackers to compromise the confidentiality, integrity and availability of data, which is a typical indicator of a MITRE ATT&CK T1007-Data From Local System which is a lateral movement technique that involves the attacker moving laterally within the compromised environment."}, {"techniqueID": "T1190", "comment": "CVE-2023-6840 - This vulnerability also allows attackers to exploit the security of software and hardware components, which is a typical indicator of a MITRE ATT&CK T1190-Exploit Public-Facing Application, as the attackers are using the vulnerability to exploit the application itself."}, {"techniqueID": "T1476", "comment": "CVE-2023-6840 - This vulnerability also enables attackers to bypass security controls and gain unauthorized access to sensitive data, which is a typical indicator of a MITRE ATT&CK T1476-Action on Object Cache, as the attacker is using the vulnerability to bypass the security controls and access the sensitive data."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/stix_bundle", "created_by_ref": "https://example.com/actor", "created": "2024-02-07T22:15:09.500Z", "modified": "2024-03-04T20:52:05.890Z", "objects": [{"type": "incident", "id": "https://example.com/incident", "created_by_ref": "https://example.com/actor", "created": "2024-02-07T22:15:09.500Z", "modified": "2024-03-04T20:52:05.890Z", "title": "CVE-2023-6840", "description": "An issue has been discovered in GitLab EE affecting all versions from 16.4 prior to 16.6.7, 16.7 prior to 16.7.5, and 16.8 prior to 16.8.2 which allows a maintainer to change the name of a protected branch that bypasses the security policy added to block MR.", "objects": [{"type": "string", "id": "https://example.com/indicator", "created_by_ref": "https://example.com/actor", "created": "2024-02-07T22:15:09.500Z", "modified": "2024-03-04T20:52:05.890Z", "title": "CVE-2023-6840 Indicator", "description": "An indicator for the CVE-2023-6840 vulnerability", "observable": "https://example.com/observable", "value": "CVE-2023-6840"}], "relations": [{"type": "related_to", "id": "https://example.com/related_to", "created_by_ref": "https://example.com/actor", "created": "2024-02-07T22:15:09.500Z", "modified": "2024-03-04T20:52:05.890Z", "source_ref": "https://example.com/incident", "target_ref": "https://example.com/cve"}]}, {"type": "cve", "id": "https://example.com/cve", "created_by_ref": "https://example.com/actor", "created": "2024-02-07T22:15:09.500Z", "modified": "2024-03-04T20:52:05.890Z", "title": "CVE-2023-6840", "description": "An issue has been discovered in GitLab EE affecting all versions from 16.4 prior to 16.6.7, 16.7 prior to 16.7.5, and 16.8 prior to 16.8.2 which allows a maintainer to change the name of a protected branch that bypasses the security policy added to block MR."}], "relationships": [{"type": "has_indicator", "id": "https://example.com/has_indicator", "created_by_ref": "https://example.com/actor", "created": "2024-02-07T22:15:09.500Z", "modified": "2024-03-04T20:52:05.890Z", "source_ref": "https://example.com/indicator", "target_ref": "https://example.com/incident"}]}, "technical_analysis": {"Introduction": "The CVE-2023-6840 vulnerability affects all versions of GitLab EE from 16.4 prior to 16.6.7, 16.7 prior to 16.7.5, and 16.8 prior to 16.8.2. This vulnerability allows a maintainer to change the name of a protected branch that bypasses the security policy added to block MR. The attack vector is NETWORK and the privileges required are HIGH.", "Impact and Scope": "The impact of the CVE-2023-6840 vulnerability is LOW for confidentiality, HIGH for integrity, and HIGH for availability, with a CVSS score of 6.7. The vulnerability allows attackers to compromise the confidentiality, integrity and availability of data.", "Related MITRE ATT&CK Techniques": "The MITRE ATT&CK tactics involved in this vulnerability include T1228-Domain Name System (DNS) Service, T1034-Windows Command Shell, T1007-Data From Local System, T1190-Exploit Public-Facing Application and T1476-Action on Object Cache.", "Technical Details": "The vulnerability is caused by a flaw in the security policy of the GitLab EE application, which allows a maintainer to change the name of a protected branch. This can be exploited by an attacker to gain unauthorized access to sensitive data.", "Detection": "The vulnerability can be detected by monitoring for unauthorized changes to protected branches in the GitLab EE application.", "Mitigation": "The vulnerability can be mitigated by applying the latest security patches to the GitLab EE application and implementing additional security controls to restrict access to protected branches.", "Conclusion": "In conclusion, the CVE-2023-6840 vulnerability is a significant risk to the confidentiality, integrity and availability of data in GitLab EE applications. It is essential to take immediate action to mitigate this vulnerability and protect against potential attacks."}, "executive_analysis": {"Overview": "The CVE-2023-6840 vulnerability is a critical security flaw in the GitLab EE application that allows a maintainer to change the name of a protected branch. This vulnerability has a high impact on the confidentiality, integrity and availability of data.", "Business Impact": "The impact of this vulnerability on the business is significant, as it allows attackers to compromise critical data and disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is the potential for unauthorized access to sensitive data and the compromise of the confidentiality, integrity and availability of data.", "Mitigation Strategies": "The recommended mitigation strategy is to apply the latest security patches to the GitLab EE application and implement additional security controls to restrict access to protected branches.", "Recommendations": "We recommend that organizations take immediate action to mitigate this vulnerability and protect against potential attacks. This includes applying the latest security patches, implementing additional security controls, and monitoring for unauthorized changes to protected branches.", "Conclusions": "In conclusion, the CVE-2023-6840 vulnerability is a significant risk to the confidentiality, integrity and availability of data in GitLab EE applications. It is essential to take immediate action to mitigate this vulnerability and protect against potential attacks."}}