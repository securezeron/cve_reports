{"id": "CVE-2024-21519", "sourceIdentifier": "report@snyk.io", "published": "2024-06-22T05:15:11.620", "lastModified": "2024-06-27T13:15:55.027", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "This affects versions of the package opencart/opencart from 4.0.0.0. An Arbitrary File Creation issue was identified via the database restoration functionality. By injecting PHP code into the database, an attacker with admin privileges can create a backup file with an arbitrary filename (including the extension), within /system/storage/backup.\r\r**Note:**\r\rIt is less likely for the created file to be available within the web root, as part of the security recommendations for the application suggest moving the storage path outside of the web root."}, {"lang": "es", "value": "Esto afecta a las versiones del paquete opencart/opencart desde 4.0.0.0. Se identific\u00f3 un problema de creaci\u00f3n arbitraria de archivos mediante la funcionalidad de restauraci\u00f3n de la base de datos. Al inyectar c\u00f3digo PHP en la base de datos, un atacante con privilegios de administrador puede crear un archivo de copia de seguridad con un nombre de archivo arbitrario (incluida la extensi\u00f3n), dentro de /system/storage/backup. **Nota:** Es menos probable que el archivo creado est\u00e9 disponible en la ra\u00edz web, ya que parte de las recomendaciones de seguridad para la aplicaci\u00f3n sugieren mover la ruta de almacenamiento fuera de la ra\u00edz web."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}, {"source": "report@snyk.io", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.6, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.7, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "report@snyk.io", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:opencart:opencart:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0.0", "matchCriteriaId": "60390C89-394D-4A4E-BD1C-C91F57B73CFD"}]}]}], "references": [{"url": "https://github.com/opencart/opencart/blob/4.0.2.3/upload/admin/controller/tool/upload.php%23L353", "source": "report@snyk.io"}, {"url": "https://security.snyk.io/vuln/SNYK-PHP-OPENCARTOPENCART-7266579", "source": "report@snyk.io", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0010", "comment": "CVE-2024-21519 - This arbitrary file creation vulnerability in OpenCart allows an attacker with admin privileges to create a backup file with an arbitrary filename, potentially leading to code injection and unauthorized access. Defend against it by ensuring proper least privilege access, validating user input, and regularly patching and updating software."}, {"techniqueID": "TA0011", "comment": "CVE-2024-21519 - This vulnerability allows an attacker to create a backup file with an arbitrary filename, potentially leading to code injection and unauthorized access. Defend against it by ensuring proper input validation and sanitization, and regularly patching and updating software."}, {"techniqueID": "TA0020", "comment": "CVE-2024-21519 - This arbitrary file creation vulnerability can be used to inject PHP code into the database, potentially leading to code execution and unauthorized access. Defend against it by ensuring proper input validation and sanitization, and regularly patching and updating software."}, {"techniqueID": "TA0023", "comment": "CVE-2024-21519 - This vulnerability can be used to inject PHP code into the database, potentially leading to code execution and unauthorized access. Defend against it by ensuring proper input validation and sanitization, and regularly patching and updating software."}], "stix_bundle": {"id": "bundle-1", "type": "bundle", "spec_version": "2.1", "objects": [{"type": "vulnerability", "id": "vuln-1", "description": "Arbitrary File Creation vulnerability in OpenCart", "published": "2024-06-22T05:15:11.620", "last_modified": "2024-06-27T13:15:55.027"}, {"type": "technique", "id": "tec-1", "tool": "TA0010", "name": "Command and Scripting Interperter Injection", "description": "Create arbitrary files on the system using a command or scripting interpreter"}, {"type": "technique", "id": "tec-2", "tool": "TA0011", "name": "Input Validation and Sanitization", "description": "validate and sanitize user input to prevent injection attacks"}, {"type": "technique", "id": "tec-3", "tool": "TA0020", "name": "Data Encoding and Encoding", "description": "encode and decode data to prevent injection attacks"}, {"type": "technique", "id": "tec-4", "tool": "TA0023", "name": "Data Injection and Encoding", "description": "inject and encode data to prevent injection attacks"}, {"type": "course-of-action", "id": "coa-1", "recommended_by": "tec-1", "recommendation": "ensure proper least privilege access", "notes": "least privilege access prevents unauthorized access"}, {"type": "course-of-action", "id": "coa-2", "recommended_by": "tec-2", "recommendation": "validate and sanitize user input", "notes": "validating and sanitizing user input prevents injection attacks"}, {"type": "course-of-action", "id": "coa-3", "recommended_by": "tec-3", "recommendation": "encode and decode data", "notes": "encoding and decoding data prevents injection attacks"}, {"type": "course-of-action", "id": "coa-4", "recommended_by": "tec-4", "recommendation": "inject and encode data", "notes": "injecting and encoding data prevents injection attacks"}], "relationship": {"vuln-1": {"techniques": ["tec-1", "tec-2", "tec-3", "tec-4"], "courses_of_action": ["coa-1", "coa-2", "coa-3", "coa-4"]}, "tec-1": {"recommended_by": "vuln-1"}, "tec-2": {"recommended_by": "vuln-1"}, "tec-3": {"recommended_by": "vuln-1"}, "tec-4": {"recommended_by": "vuln-1"}, "coa-1": {"recommended_by": "tec-1", "recommended_for": "tec-4"}, "coa-2": {"recommended_by": "tec-2", "recommended_for": "tec-4"}, "coa-3": {"recommended_by": "tec-3", "recommended_for": "tec-4"}, "coa-4": {"recommended_by": "tec-4", "recommended_for": "tec-3"}}}, "technical_analysis": {"Introduction": "The vulnerability CVE-2024-21519 in OpenCart allows an attacker to create a backup file with an arbitrary filename, potentially leading to code injection and unauthorized access.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2 and affects versions of OpenCart from 4.0.0.0. It can be exploited using a command or scripting interpreter to inject PHP code into the database.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: TA0010, TA0011, TA0020, and TA0023.", "Technical Details": "The vulnerability occurs in the upload.php file of OpenCart, where an attacker can inject PHP code into the database using a command or scripting interpreter.", "Detection": "The vulnerability can be detected using a web application scanner or by manually injecting PHP code into the database.", "Mitigation": "The vulnerability can be mitigated by ensuring proper input validation and sanitization, regularly patching and updating software, and using a web application firewall.", "Conclusion": "The vulnerability CVE-2024-21519 in OpenCart is a serious threat that can result in code injection and unauthorized access. It is important to take measures to mitigate this vulnerability, including updating software regularly and using a web application firewall."}, "executive_analysis": {"Overview": "The vulnerability CVE-2024-21519 in OpenCart is a critical security threat that can result in code injection and unauthorized access.", "Business Impact": "The vulnerability can result in significant business impact, including financial loss, reputational damage, and regulatory fines.", "Technical Impact": "The vulnerability can result in significant technical impact, including system compromise, data breaches, and loss of confidentiality.", "Mitigation Strategies": "The vulnerability can be mitigated by taking measures to secure software, including regularly patching and updating software, and using a web application firewall.", "Recommendations": "Executives should take immediate action to address the vulnerability, including updating software regularly and using a web application firewall.", "Conclusions": "The vulnerability CVE-2024-21519 in OpenCart is a serious security threat that requires immediate attention. Executives should take steps to mitigate the vulnerability and prevent any potential security incidents."}}