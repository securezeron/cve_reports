{"id": "CVE-2009-3016", "sourceIdentifier": "cve@mitre.org", "published": "2009-08-31T16:30:07.017", "lastModified": "2017-09-19T01:29:24.530", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Apple Safari 4.0.3 does not properly block javascript: and data: URIs in Refresh headers in HTTP responses, which allows remote attackers to conduct cross-site scripting (XSS) attacks via vectors related to (1) injecting a Refresh header that contains a javascript: URI, (2) entering a javascript: URI when specifying the content of a Refresh header, (3) injecting a Refresh header that contains JavaScript sequences in a data:text/html URI, or (4) entering a data:text/html URI with JavaScript sequences when specifying the content of a Refresh header."}, {"lang": "es", "value": "Apple Safari v4.0.3 no bloquea URIs JavaScript: ni data: de forma adecuada en las cabeceras Refresh en las respuestas HTTP, lo que permite a atacantes remotos realizar un ataque de ejecuci\u00f3n de secuencias de comandos en sitios cruzados (XSS) a trav\u00e9s de vectores relativos a (1) inyectando una cabecera Refresh que contiene una URI javascript:, (2) introduciendo una URI javascript: cuando se especifica el contenido de una cabecera Refresh, (3) inyectando a una cabecera Refresh que contiene secuencias javascript en una URI data:text/html, o (4) introduciendo una URI data:text/html con secuencias javascript cuando se especifica el contenido de una cabecera Refresh."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apple:safari:4.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "80E36485-565D-4FAA-A6AD-57DF42D47462"}]}]}], "references": [{"url": "http://websecurity.com.ua/3386/", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/52992", "source": "cve@mitre.org"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6475", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1046", "comment": "Safari 4.0.3 does not properly block JavaScript: and data: URIs in Refresh headers in HTTP responses, which allows remote attackers to conduct cross-site scripting (XSS) attacks. This technique is used to inject web shells and execute arbitrary code on compromised hosts."}, {"techniqueID": "T1190", "comment": "The vulnerability allows remote attackers to inject malicious code in the victim's browser, which can be used to steal sensitive information or create backdoors to compromise the host. This technique is used to inject malicious code in the victim's browser and steal sensitive information."}, {"techniqueID": "T1192", "comment": "The vulnerability can be exploited to inject web shells and execute arbitrary code on compromised hosts. This technique is used to inject web shells and execute arbitrary code on compromised hosts."}, {"techniqueID": "T1557", "comment": "The vulnerability can be exploited to inject malicious code in the victim's browser, which can be used to create backdoors and steal sensitive information. This technique is used to inject malicious code in the victim's browser and create backdoors."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "objects": [{"type": "vulnerability", "id": "CVE-2009-3016", "created_by_ref": "ident_1", "description": "Apple Safari 4.0.3 does not properly block JavaScript: and data: URIs in Refresh headers in HTTP responses, which allows remote attackers to conduct cross-site scripting (XSS) attacks.", "attributes": {"cvss": {"v3": {"vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "baseScore": 4.3}}}, "relationships": [{"type": "related_attack_pattern", "object_ref": "AP-00012"}]}, {"type": "attack_pattern", "id": "AP-00012", "created_by_ref": "ident_1", "description": "Cross-site scripting (XSS) attack", "attributes": {"name": "XSS attack"}, "relationships": [{"type": "uses_tool", "object_ref": "TA-0005"}]}, {"type": "tool", "id": "TA-0005", "created_by_ref": "ident_1", "description": "JavaScript injection tool", "attributes": {"name": "JavaScript injection tool"}}, {"type": "course_of_action", "id": "COA-00013", "created_by_ref": "ident_1", "description": "Configure web servers to block JavaScript: and data: URIs in Refresh headers in HTTP responses", "relationships": [{"type": "mitigates_attack_pattern", "object_ref": "AP-00012"}]}]}, "technical_analysis": {"Introduction": "Safari 4.0.3 does not properly block JavaScript: and data: URIs in Refresh headers in HTTP responses, which allows remote attackers to conduct cross-site scripting (XSS) attacks.", "Impact and Scope": "The vulnerability allows remote attackers to inject malicious code in the victim's browser, which can be used to steal sensitive information or create backdoors to compromise the host.", "Related MITRE ATT&CK Techniques": "T1046, T1190, T1192, T1557", "Technical Details": "The vulnerability can be exploited by injecting a Refresh header that contains a JavaScript: URI, entering a JavaScript: URI when specifying the content of a Refresh header, injecting a Refresh header that contains JavaScript sequences in a data:text/html URI, or entering a data:text/html URI with JavaScript sequences when specifying the content of a Refresh header.", "Detection": "Detecting the vulnerability requires analyzing HTTP responses for JavaScript: and data: URIs in Refresh headers.", "Mitigation": "Configure web servers to block JavaScript: and data: URIs in Refresh headers in HTTP responses, and prevent users from entering arbitrary values in Refresh headers.", "Conclusion": "The vulnerability can be exploited by remote attackers to inject malicious code in the victim's browser, which can be used to steal sensitive information or create backdoors to compromise the host."}, "executive_analysis": {"Overview": "Safari 4.0.3 contains a vulnerability that can be exploited by remote attackers to conduct cross-site scripting (XSS) attacks.", "Business Impact": "The vulnerability can be used to steal sensitive information or create backdoors to compromise the host, which can result in financial loss and reputational damage.", "Technical Impact": "The vulnerability can be exploited by remote attackers to inject malicious code in the victim's browser, which can be used to steal sensitive information or create backdoors to compromise the host.", "Mitigation Strategies": "Configure web servers to block JavaScript: and data: URIs in Refresh headers in HTTP responses, and prevent users from entering arbitrary values in Refresh headers.", "Recommendations": "Patch Safari 4.0.3 as soon as possible, and consider configuring web servers to block JavaScript: and data: URIs in Refresh headers in HTTP responses.", "Conclusions": "The vulnerability requires prompt attention and mitigation to prevent exploits and potential data breaches."}}