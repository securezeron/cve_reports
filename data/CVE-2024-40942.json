{"id": "CVE-2024-40942", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-12T13:15:16.520", "lastModified": "2024-07-12T16:34:58.687", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: mac80211: mesh: Fix leak of mesh_preq_queue objects\n\nThe hwmp code use objects of type mesh_preq_queue, added to a list in\nieee80211_if_mesh, to keep track of mpath we need to resolve. If the mpath\ngets deleted, ex mesh interface is removed, the entries in that list will\nnever get cleaned. Fix this by flushing all corresponding items of the\npreq_queue in mesh_path_flush_pending().\n\nThis should take care of KASAN reports like this:\n\nunreferenced object 0xffff00000668d800 (size 128):\n  comm \"kworker/u8:4\", pid 67, jiffies 4295419552 (age 1836.444s)\n  hex dump (first 32 bytes):\n    00 1f 05 09 00 00 ff ff 00 d5 68 06 00 00 ff ff  ..........h.....\n    8e 97 ea eb 3e b8 01 00 00 00 00 00 00 00 00 00  ....>...........\n  backtrace:\n    [<000000007302a0b6>] __kmem_cache_alloc_node+0x1e0/0x35c\n    [<00000000049bd418>] kmalloc_trace+0x34/0x80\n    [<0000000000d792bb>] mesh_queue_preq+0x44/0x2a8\n    [<00000000c99c3696>] mesh_nexthop_resolve+0x198/0x19c\n    [<00000000926bf598>] ieee80211_xmit+0x1d0/0x1f4\n    [<00000000fc8c2284>] __ieee80211_subif_start_xmit+0x30c/0x764\n    [<000000005926ee38>] ieee80211_subif_start_xmit+0x9c/0x7a4\n    [<000000004c86e916>] dev_hard_start_xmit+0x174/0x440\n    [<0000000023495647>] __dev_queue_xmit+0xe24/0x111c\n    [<00000000cfe9ca78>] batadv_send_skb_packet+0x180/0x1e4\n    [<000000007bacc5d5>] batadv_v_elp_periodic_work+0x2f4/0x508\n    [<00000000adc3cd94>] process_one_work+0x4b8/0xa1c\n    [<00000000b36425d1>] worker_thread+0x9c/0x634\n    [<0000000005852dd5>] kthread+0x1bc/0x1c4\n    [<000000005fccd770>] ret_from_fork+0x10/0x20\nunreferenced object 0xffff000009051f00 (size 128):\n  comm \"kworker/u8:4\", pid 67, jiffies 4295419553 (age 1836.440s)\n  hex dump (first 32 bytes):\n    90 d6 92 0d 00 00 ff ff 00 d8 68 06 00 00 ff ff  ..........h.....\n    36 27 92 e4 02 e0 01 00 00 58 79 06 00 00 ff ff  6'.......Xy.....\n  backtrace:\n    [<000000007302a0b6>] __kmem_cache_alloc_node+0x1e0/0x35c\n    [<00000000049bd418>] kmalloc_trace+0x34/0x80\n    [<0000000000d792bb>] mesh_queue_preq+0x44/0x2a8\n    [<00000000c99c3696>] mesh_nexthop_resolve+0x198/0x19c\n    [<00000000926bf598>] ieee80211_xmit+0x1d0/0x1f4\n    [<00000000fc8c2284>] __ieee80211_subif_start_xmit+0x30c/0x764\n    [<000000005926ee38>] ieee80211_subif_start_xmit+0x9c/0x7a4\n    [<000000004c86e916>] dev_hard_start_xmit+0x174/0x440\n    [<0000000023495647>] __dev_queue_xmit+0xe24/0x111c\n    [<00000000cfe9ca78>] batadv_send_skb_packet+0x180/0x1e4\n    [<000000007bacc5d5>] batadv_v_elp_periodic_work+0x2f4/0x508\n    [<00000000adc3cd94>] process_one_work+0x4b8/0xa1c\n    [<00000000b36425d1>] worker_thread+0x9c/0x634\n    [<0000000005852dd5>] kthread+0x1bc/0x1c4\n    [<000000005fccd770>] ret_from_fork+0x10/0x20"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: wifi: mac80211: mesh: corrige la fuga de objetos mesh_preq_queue El c\u00f3digo hwmp usa objetos de tipo mesh_preq_queue, agregados a una lista en ieee80211_if_mesh, para realizar un seguimiento del mpath que necesitamos resolver. Si se elimina mpath, se elimina la interfaz ex mesh, las entradas en esa lista nunca se limpiar\u00e1n. Solucione este problema eliminando todos los elementos correspondientes de preq_queue en mesh_path_flush_pending(). Esto deber\u00eda encargarse de informes KASAN como este: objeto sin referencia 0xffff00000668d800 (tama\u00f1o 128): comm \"kworker/u8:4\", pid 67, jiffies 4295419552 (edad 1836.444s) volcado hexadecimal (primeros 32 bytes): 00 1f 05 09 00 00 ff ff 00 d5 68 06 00 00 ff ff ..........h..... 8e 97 ea eb 3e b8 01 00 00 00 00 00 00 00 00 00 ....&gt;.. ......... retroceso: [&lt;000000007302a0b6&gt;] __kmem_cache_alloc_node+0x1e0/0x35c [&lt;00000000049bd418&gt;] kmalloc_trace+0x34/0x80 [&lt;0000000000d792bb&gt;] 8 [&lt;00000000c99c3696&gt;] mesh_nexthop_resolve+0x198/ 0x19c [&lt;00000000926bf598&gt;] ieee80211_xmit+0x1d0/0x1f4 [&lt;00000000fc8c2284&gt;] __ieee80211_subif_start_xmit+0x30c/0x764 [&lt;000000005926ee38&gt;] 11_subif_start_xmit+0x9c/0x7a4 [&lt;000000004c86e916&gt;] dev_hard_start_xmit+0x174/0x440 [&lt;0000000023495647&gt;] __dev_queue_xmit+0xe24/ 0x111c [&lt;00000000cfe9ca78&gt;] batadv_send_skb_packet+0x180/0x1e4 [&lt;000000007bacc5d5&gt;] batadv_v_elp_periodic_work+0x2f4/0x508 [&lt;00000000adc3cd94&gt;] xa1c [&lt;00000000b36425d1&gt;] hilo_trabajador+0x9c/0x634 [&lt;0000000005852dd5&gt;] kthread+0x1bc/ 0x1c4 [&lt;000000005fccd770&gt;] ret_from_fork+0x10/0x20 objeto sin referencia 0xffff000009051f00 (tama\u00f1o 128): comm \"kworker/u8:4\", pid 67, jiffies 4295419553 (edad 1836.440s) volcado hexadecimal (primero 32 bytes): 90 d6 92 0d 00 00 ff ff 00 d8 68 06 00 00 ff ff ..........h..... 36 27 92 e4 02 e0 01 00 00 58 79 06 00 00 ff ff 6'.... ...Xy..... retroceso: [&lt;000000007302a0b6&gt;] __kmem_cache_alloc_node+0x1e0/0x35c [&lt;00000000049bd418&gt;] kmalloc_trace+0x34/0x80 [&lt;0000000000d792bb&gt;] 0x2a8 [&lt;00000000c99c3696&gt;] mesh_nexthop_resolve+0x198/ 0x19c [&lt;00000000926bf598&gt;] ieee80211_xmit+0x1d0/0x1f4 [&lt;00000000fc8c2284&gt;] __ieee80211_subif_start_xmit+0x30c/0x764 [&lt;000000005926ee38&gt;] 11_subif_start_xmit+0x9c/0x7a4 [&lt;000000004c86e916&gt;] dev_hard_start_xmit+0x174/0x440 [&lt;0000000023495647&gt;] __dev_queue_xmit+0xe24/ 0x111c [&lt;00000000cfe9ca78&gt;] batadv_send_skb_packet+0x180/0x1e4 [&lt;000000007bacc5d5&gt;] batadv_v_elp_periodic_work+0x2f4/0x508 [&lt;00000000adc3cd94&gt;] xa1c [&lt;00000000b36425d1&gt;] hilo_trabajador+0x9c/0x634 [&lt;0000000005852dd5&gt;] kthread+0x1bc/ 0x1c4 [&lt;000000005fccd770&gt;] ret_from_fork+0x10/0x20"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/377dbb220edc8421b7960691876c5b3bef62f89b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/617dadbfb2d3e152c5753e28356d189c9d6f33c0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/63d5f89bb5664d60edbf8cf0df911aaae8ed96a4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/7518e20a189f8659b8b83969db4d33a4068fcfc3", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b7d7f11a291830fdf69d3301075dd0fb347ced84", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c4c865f971fd4a255208f57ef04d814c2ae9e0dc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d81e244af521de63ad2883e17571b789c39b6549", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ec79670eae430b3ffb7e0a6417ad7657728b8f95", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-40942 - This technique is relevant as it indicates an attempt to perform a privilege escalation attack, which may be used by an attacker to gain unauthorized access to a system."}, {"techniqueID": "T1003", "comment": "CVE-2024-40942 - This technique is relevant as it indicates an attempt to use a vulnerability to gain access to a system, which may be used by an attacker to exploit this CVE."}, {"techniqueID": "T1562", "comment": "CVE-2024-40942 - This technique is relevant as it indicates an attempt to use a vulnerability to gain a higher level of access to a system, which may be used by an attacker to exploit this CVE."}], "stix_bundle": {"type": "bundle", "id": "bundle-1", "title": "CVE-2024-40942 Analysis", "objects": [{"type": "vulnerability", "id": "vuln-1", "title": "Linux Kernel Mesh Vulnerability", "description": "A vulnerability in the Linux kernel's mesh code allows an attacker to gain unauthorized access to a system.", "score": "7.1", "vulnerable_configuration": "Linux kernel", "related_course_of_action": [{"type": "course_of_action", "id": "cao-1", "title": "Update Linux Kernel", "description": "Update the Linux kernel to the latest version to mitigate this vulnerability."}], "related_notable_configuration": [{"type": "notable_configuration", "id": "nc-1", "title": "Linux Kernel Config", "description": "The Linux kernel configuration associated with this vulnerability."}]}, {"type": "attack_pattern", "id": "ap-1", "title": "Linux Kernel Mesh Privilege Escalation", "description": "An attack pattern that exploits a vulnerability in the Linux kernel's mesh code to gain unauthorized access to a system.", "indicators": [{"type": "indicator", "id": "i-1", "title": "Linux Kernel Mesh Privilege Escalation Indicator", "description": "An indicator that detects the Linux kernel mesh privilege escalation attack."}]}], "relationships": [{"type": "has", "id": "has-1", "subject": "vuln-1", "object": "ap-1"}]}, "technical_analysis": {"Introduction": "The Linux kernel's mesh code contains a vulnerability that allows an attacker to gain unauthorized access to a system.", "Impact and Scope": "The vulnerability has a CVSS score of 7.1 and affects systems running on the Linux kernel.", "Related MITRE ATT&CK Techniques": "This vulnerability is relevant to techniques such as T1190, T1003, and T1562.", "Technical Details": "The vulnerability is located in the Linux kernel's mesh code and allows an attacker to gain unauthorized access to a system.", "Detection": "Detection of this vulnerability can be challenging, but it can be done by monitoring system logs for suspicious activity.", "Mitigation": "Updating the Linux kernel to the latest version is the most effective way to mitigate this vulnerability.", "Conclusion": "The Linux kernel's mesh code contains a vulnerability that allows an attacker to gain unauthorized access to a system. This vulnerability has a high impact and affects systems running on the Linux kernel."}, "executive_analysis": {"Overview": "A vulnerability in the Linux kernel's mesh code allows an attacker to gain unauthorized access to a system.", "Business Impact": "The vulnerability has the potential to compromise sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability allows an attacker to gain unauthorized access to a system, which can be used to steal sensitive data or disrupt business operations.", "Mitigation Strategies": "Updating the Linux kernel to the latest version and monitoring system logs for suspicious activity are effective mitigation strategies.", "Recommendations": "It is recommended that organizations prioritize patching the Linux kernel and implement measures to monitor system logs for suspicious activity.", "Conclusions": "The Linux kernel's mesh code contains a vulnerability that allows an attacker to gain unauthorized access to a system. It is critical that organizations prioritize patching and monitoring to mitigate this vulnerability."}}