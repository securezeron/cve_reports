{"id": "CVE-2024-38566", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-19T14:15:16.767", "lastModified": "2024-06-20T12:44:01.637", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Fix verifier assumptions about socket->sk\n\nThe verifier assumes that 'sk' field in 'struct socket' is valid\nand non-NULL when 'socket' pointer itself is trusted and non-NULL.\nThat may not be the case when socket was just created and\npassed to LSM socket_accept hook.\nFix this verifier assumption and adjust tests."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: bpf: corrige las suposiciones del verificador sobre socket-&gt;sk. El verificador asume que el campo 'sk' en 'struct socket' es v\u00e1lido y no NULL cuando el puntero 'socket' en s\u00ed es confiable y no NULL. Puede que ese no sea el caso cuando el socket se acaba de crear y se pas\u00f3 al gancho LSM socket_accept. Corrija esta suposici\u00f3n del verificador y ajuste las pruebas."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0db63c0b86e981a1e97d2596d64ceceba1a5470e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/39f8a29330f433000e716eefc4b9abda05b71a82", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6f5ae91172a93abac9720ba94edf3ec8f4d7f24f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c58ccdd2483a1d990748cdaf94206b5d5986a001", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-38566 - This technique is related to the Linux kernel vulnerability. The verifier assumes that 'sk' field in 'struct socket' is valid and non-NULL when 'socket' pointer itself is trusted and non-NULL. This may lead to bypassing the verifier assumptions and potential exploitation."}, {"techniqueID": "T1191", "comment": "CVE-2024-38566 - This technique is related to the Linux kernel vulnerability. The vulnerability allows an attacker to bypass the verifier assumptions and potential exploitation. Defenses such as disabling the vulnerable kernel module or patching the kernel can help mitigate this technique."}], "stix_bundle": {"id": "CVE-2024-38566", "type": "bundle", "spec_version": "2.1", "objects": [{"id": "CVE-2024-38566", "type": "vulnerability", "name": "Linux kernel bpf verifier assumptions vulnerability", "description": "The Linux kernel bpf verifier assumes that 'sk' field in 'struct socket' is valid and non-NULL when 'socket' pointer itself is trusted and non-NULL. This may lead to bypassing the verifier assumptions and potential exploitation.", "published": "2024-06-19T14:15:16.767", "last_modified": "2024-06-20T12:44:01.637", "vuln_status": "Awaiting Analysis", "cve_tags": [], "references": [{"id": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "href": "https://git.kernel.org/stable/c/0db63c0b86e981a1e97d2596d64ceceba1a5470e", "type": "source", "title": "0db63c0b86e981a1e97d2596d64ceceba1a5470e"}, {"id": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "href": "https://git.kernel.org/stable/c/39f8a29330f433000e716eefc4b9abda05b71a82", "type": "source", "title": "39f8a29330f433000e716eefc4b9abda05b71a82"}, {"id": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "href": "https://git.kernel.org/stable/c/6f5ae91172a93abac9720ba94edf3ec8f4d7f24f", "type": "source", "title": "6f5ae91172a93abac9720ba94edf3ec8f4d7f24f"}, {"id": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "href": "https://git.kernel.org/stable/c/c58ccdd2483a1d990748cdaf94206b5d5986a001", "type": "source", "title": "c58ccdd2483a1d990748cdaf94206b5d5986a001"}], "object_refs": [{"ref_id": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "type": "source", "title": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "courses_of_action": [{"id": "remove_vulnerable_kernel_module", "title": "Remove vulnerable kernel module", "description": "Remove the vulnerable kernel module to prevent exploitation", "mitigates": [{"technique_id": "T1190", " technique_category": "Lateral Movement"}]}, {"id": "patch_kernel", "title": "Patch kernel", "description": "Patch the kernel to fix the vulnerability", "mitigates": [{"technique_id": "T1191", " technique_category": "Lateral Movement"}]}], "d3fend_defenses": [], "mitre_attck_identifier": ["T1190", "T1191"]}, {"id": "T1190", "type": "attack-pattern", "name": "Bypassing Verifier Assumptions", "description": "Bypassing the verifier assumptions in the Linux kernel bpf verifier", "user-facing_name": "Bypassing Verifier Assumptions", "kill_chain_phases": [{"phase_name": "Delivery", "phase_id": "DELIVERY"}, {"phase_name": "Exploitation", "phase_id": "EXPLOITATION"}]}, {"id": "T1191", "type": "attack-pattern", "name": "Exploiting Vulnerability in Linux Kernel", "description": "Exploiting the vulnerability in the Linux kernel bpf verifier", "user-facing_name": "Exploiting Vulnerability in Linux Kernel", "kill_chain_phases": [{"phase_name": "Exploitation", "phase_id": "EXPLOITATION"}]}]}, "technical_analysis": {"Introduction": "The vulnerability in the Linux kernel bpf verifier allows an attacker to bypass the verifier assumptions and potentially exploit the system.", "Impact and Scope": "The vulnerability affects the Linux kernel and can potentially lead to arbitrary code execution.", "Related MITRE ATT&CK Techniques": "T1190 and T1191 are related to the vulnerability.", "Technical Details": "The vulnerability occurs when the verifier assumes that 'sk' field in 'struct socket' is valid and non-NULL when 'socket' pointer itself is trusted and non-NULL.", "Detection": "Detection is difficult as the vulnerability is triggered by specific kernel module interactions.", "Mitigation": "Disable the vulnerable kernel module or patch the kernel to fix the vulnerability.", "Conclusion": "The vulnerability is a serious issue that requires immediate attention."}, "executive_analysis": {"Overview": "The vulnerability in the Linux kernel bpf verifier allows an attacker to bypass the verifier assumptions and potentially exploit the system.", "Business Impact": "The vulnerability can potentially lead to data breaches or unauthorized access.", "Technical Impact": "The vulnerability can potentially lead to arbitrary code execution.", "Mitigation Strategies": "Disable the vulnerable kernel module or patch the kernel to fix the vulnerability.", "Recommendations": "Implement timely patches and security updates.", "Conclusions": "The vulnerability is a significant risk that requires immediate attention."}}