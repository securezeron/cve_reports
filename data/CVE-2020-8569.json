{"id": "CVE-2020-8569", "sourceIdentifier": "jordan@liggitt.net", "published": "2021-01-21T17:15:14.250", "lastModified": "2021-02-01T19:05:37.983", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Kubernetes CSI snapshot-controller prior to v2.1.3 and v3.0.2 could panic when processing a VolumeSnapshot custom resource when: - The VolumeSnapshot referenced a non-existing PersistentVolumeClaim and the VolumeSnapshot did not reference any VolumeSnapshotClass. - The snapshot-controller crashes, is automatically restarted by Kubernetes, and processes the same VolumeSnapshot custom resource after the restart, entering an endless crashloop. Only the volume snapshot feature is affected by this vulnerability. When exploited, users can\u2019t take snapshots of their volumes or delete the snapshots. All other Kubernetes functionality is not affected."}, {"lang": "es", "value": "Kubernetes CSI snapshot-controller versiones v2.1.3 y v3.0.2, pod\u00eda entrar en p\u00e1nico al procesar un recurso personalizado VolumeSnapshot cuando: - El VolumeSnapshot hac\u00eda referencia a un PersistentVolumeClaim no existente y el VolumeSnapshot no hac\u00eda referencia a ning\u00fan VolumeSnapshotClass. - El snapshot-controller se bloquea, Kubernetes lo reinicia autom\u00e1ticamente y procesa el mismo recurso personalizado de VolumeSnapshot despu\u00e9s del reinicio, ingresando en un bucle de bloqueo sin fin. Esta vulnerabilidad solo afecta a la funcionalidad volume snapshot. Cuando se explotaba, los usuarios no pueden tomar instant\u00e1neas de sus vol\u00famenes o eliminar las instant\u00e1neas. Todas las dem\u00e1s funciones de Kubernetes no est\u00e1n afectadas"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "jordan@liggitt.net", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-476"}]}, {"source": "jordan@liggitt.net", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-476"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:kubernetes:container_storage_interface_snapshotter:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.1.0", "versionEndExcluding": "2.1.3", "matchCriteriaId": "1609D4D8-E5EF-418C-B81E-22066045A439"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kubernetes:container_storage_interface_snapshotter:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.0.0", "versionEndExcluding": "3.0.2", "matchCriteriaId": "446F2CD3-BCE5-41DF-AD1F-3A97A2B8D59E"}]}]}], "references": [{"url": "https://github.com/kubernetes-csi/external-snapshotter/issues/380", "source": "jordan@liggitt.net", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://groups.google.com/g/kubernetes-security-announce/c/1EzCr1qUxxU", "source": "jordan@liggitt.net", "tags": ["Mailing List", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-8569 - The Kubernetes CSI snapshot-controller panic vulnerability can be exploited by an attacker, potentially leading to denial-of-service or privilege escalation. This technique can be used to identify and prevent potential exploitation attempts."}, {"techniqueID": "T1204", "comment": "CVE-2020-8569 - The panicking of the Kubernetes CSI snapshot-controller can be used as a potential way to gain access to the system by causing a crash and subsequent restart. This technique can be used to detect and prevent such attempts."}, {"techniqueID": "T1136", "comment": "CVE-2020-8569 - The vulnerability in the Kubernetes CSI snapshot-controller can be exploited to cause a denial-of-service, which can be used as a stepping stone for further attacks. This technique can be used to detect and prevent potential exploitation attempts."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "https://example.com/cve-2020-8569", "created_by_ref": "https://example.com/user", "created": "2021-02-01T19:05:37.983", "modified": "2021-02-01T19:05:37.983", "objects": [{"type": "vulnerability", "id": "https://example.com/cve-2020-8569", "name": "CVE-2020-8569"}, {"type": "incident", "id": "https://example.com/incident-2020-8569", "name": "Incident 2020-8569"}, {"type": "course-of-action", "id": "https://example.com/course-of-action-2020-8569", "name": "Course of Action 2020-8569"}], "relationships": [{"from": "https://example.com/cve-2020-8569", "to": "https://example.com/incident-2020-8569", "relationship_type": "related_to"}, {"from": "https://example.com/cve-2020-8569", "to": "https://example.com/course-of-action-2020-8569", "relationship_type": "mitigates"}]}}, "technical_analysis": {"Introduction": "The Kubernetes CSI snapshot-controller panic vulnerability is a remote code execution vulnerability that allows an attacker to cause the system to crash and potentially gain access to the system.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 6.5 (AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H). The vulnerability affects Kubernetes CSI snapshot-controller versions prior to 2.1.3 and 3.0.2.", "Related MITRE ATT&CK Techniques": "The MITRE ATT&CK techniques T1190, T1204, and T1136 are related to this vulnerability and can be used to detect and prevent potential exploitation attempts.", "Technical Details": "The vulnerability occurs when the Kubernetes CSI snapshot-controller is processing a VolumeSnapshot custom resource and the referenced VolumeSnapshot does not exist.", "Detection": "Detection of this vulnerability involves monitoring for anomalies in system behavior and detecting potential signs of exploitation, such as repeated crashes of the snapshot-controller.", "Mitigation": "Mitigation strategies for this vulnerability include patching the affected versions of the snapshot-controller and monitoring system behavior for signs of exploitation.", "Conclusion": "In conclusion, the Kubernetes CSI snapshot-controller panic vulnerability is a critical issue that requires immediate attention. Detection and mitigation efforts should focus on preventing potential exploitation attempts and monitoring system behavior for signs of compromise."}, "executive_analysis": {"Overview": "The Kubernetes CSI snapshot-controller panic vulnerability is a critical issue that requires immediate attention. It has the potential to allow an attacker to gain access to the system and cause denial-of-service.", "Business Impact": "The business impact of this vulnerability is significant, as it could potentially allow an attacker to gain access to sensitive data and disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is high, as it could potentially allow an attacker to gain administrative access to the system and cause denial-of-service.", "Mitigation Strategies": "The recommended mitigation strategy is to patch the affected versions of the snapshot-controller and monitor system behavior for signs of exploitation.", "Recommendations": "Executives are recommended to prioritize patching and monitoring efforts to prevent potential exploitation attempts and detect signs of compromise.", "Conclusions": "In conclusion, the Kubernetes CSI snapshot-controller panic vulnerability is a critical issue that requires immediate attention. Executives should prioritize patching and monitoring efforts to prevent potential exploitation attempts and detect signs of compromise."}}