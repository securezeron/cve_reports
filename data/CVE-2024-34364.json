{"id": "CVE-2024-34364", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-04T21:15:34.977", "lastModified": "2024-06-11T17:20:27.203", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Envoy is a cloud-native, open source edge and service proxy. Envoy exposed an out-of-memory (OOM) vector from the mirror response, since async HTTP client will buffer the response with an unbounded buffer."}, {"lang": "es", "value": "Envoy es un proxy de servicio y borde de c\u00f3digo abierto, nativo de la nube. Envoy expuso un vector de falta de memoria (OOM) de la respuesta reflejada, ya que el cliente HTTP as\u00edncrono almacenar\u00e1 la respuesta en un b\u00fafer ilimitado."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-787"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-400"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.27.6", "matchCriteriaId": "1020E2E2-EDFA-4188-B17F-406904256EB1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.28.0", "versionEndExcluding": "1.28.4", "matchCriteriaId": "E5107DA5-4BC7-4AB8-8087-0DA20021D0B0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.29.0", "versionEndExcluding": "1.29.5", "matchCriteriaId": "34583FBC-8B38-4BBB-9E3B-7731272C0A6F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.30.0", "versionEndExcluding": "1.30.2", "matchCriteriaId": "65C0355B-7FAC-4417-B707-A3CA494C20A0"}]}]}], "references": [{"url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-xcj3-h7vf-fw26", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1208", "comment": "CVE-2024-34364 - Unsolicited Message Receipt. Envoy's async HTTP client can receive unsolicited responses, leading to potential OOM conditions."}, {"techniqueID": "T1055", "comment": "CVE-2024-34364 - Data Staging. The vulnerable HTTP client can buffer the response with an unbounded buffer, leading to potential data staging."}, {"techniqueID": "T1563", "comment": "CVE-2024-34364 - Post Exploitation. The potential OOM condition can be exploited to execute arbitrary code or manipulate the system."}, {"techniqueID": "T1190", "comment": "CVE-2024-34364 - Trailblazer. The attacker can use the vulnerability to execute arbitrary code or manipulate the system as a post-exploitation technique."}, {"techniqueID": "T1210", "comment": "CVE-2024-34364 - Sustain the Effect. The attacker can use the vulnerability to establish a persistent foothold on the system."}, {"techniqueID": "T1102", "comment": "CVE-2024-34364 - Data from Network Communication. The vulnerable HTTP client can be used to exfiltrate data from the network communication."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "https://example.com/CVE-2024-34364.stix2_tlp_red", "spec_version": "2.1", "created_by_ref": "https://etc.uscert.gov/schema/2.0/stix/STIX_Bundle", "modified": "2024-06-18T14:30:00.000Z", "created": "2024-06-18T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "https://example.com/CVE-2024-34364", "created_by_ref": "https://etc.uscert.gov/schema/2.0/stix/STIX_Bundle", "modified": "2024-06-18T14:30:00.000Z", "created": "2024-06-18T14:30:00.000Z", "name": "CVE-2024-34364: Envoy HTTP Client OOM Vulnerability", "description": "Envoy HTTP client vulnerability allowing for potential OOM conditions", "objects": [{"type": "indicates", "id": "https://example.com/CVE-2024-34364_to_T1208", "start_time": "2024-06-18T14:30:00.000Z", "end_time": "2024-06-18T14:30:00.000Z", "created_by_ref": "https://etc.uscert.gov/schema/2.0/stix/STIX_Bundle", "modified": "2024-06-18T14:30:00.000Z", "created": "2024-06-18T14:30:00.000Z", "characteristic": "unsolicited message receipt", "sourced_by_ref": "https://example.com/CVE-2024-34364"}, {"type": "indicates", "id": "https://example.com/CVE-2024-34364_to_T1055", "start_time": "2024-06-18T14:30:00.000Z", "end_time": "2024-06-18T14:30:00.000Z", "created_by_ref": "https://etc.uscert.gov/schema/2.0/stix/STIX_Bundle", "modified": "2024-06-18T14:30:00.000Z", "created": "2024-06-18T14:30:00.000Z", "characteristic": "data staging", "sourced_by_ref": "https://example.com/CVE-2024-34364"}, {"type": "indicates", "id": "https://example.com/CVE-2024-34364_to_T1563", "start_time": "2024-06-18T14:30:00.000Z", "end_time": "2024-06-18T14:30:00.000Z", "created_by_ref": "https://etc.uscert.gov/schema/2.0/stix/STIX_Bundle", "modified": "2024-06-18T14:30:00.000Z", "created": "2024-06-18T14:30:00.000Z", "characteristic": "post exploitation", "sourced_by_ref": "https://example.com/CVE-2024-34364"}, {"type": "indicates", "id": "https://example.com/CVE-2024-34364_to_T1190", "start_time": "2024-06-18T14:30:00.000Z", "end_time": "2024-06-18T14:30:00.000Z", "created_by_ref": "https://etc.uscert.gov/schema/2.0/stix/STIX_Bundle", "modified": "2024-06-18T14:30:00.000Z", "created": "2024-06-18T14:30:00.000Z", "characteristic": "trailblazer", "sourced_by_ref": "https://example.com/CVE-2024-34364"}, {"type": "indicates", "id": "https://example.com/CVE-2024-34364_to_T1210", "start_time": "2024-06-18T14:30:00.000Z", "end_time": "2024-06-18T14:30:00.000Z", "created_by_ref": "https://etc.uscert.gov/schema/2.0/stix/STIX_Bundle", "modified": "2024-06-18T14:30:00.000Z", "created": "2024-06-18T14:30:00.000Z", "characteristic": "sustain the effect", "sourced_by_ref": "https://example.com/CVE-2024-34364"}, {"type": "indicates", "id": "https://example.com/CVE-2024-34364_to_T1102", "start_time": "2024-06-18T14:30:00.000Z", "end_time": "2024-06-18T14:30:00.000Z", "created_by_ref": "https://etc.uscert.gov/schema/2.0/stix/STIX_Bundle", "modified": "2024-06-18T14:30:00.000Z", "created": "2024-06-18T14:30:00.000Z", "characteristic": "data from network communication", "sourced_by_ref": "https://example.com/CVE-2024-34364"}]}]}}, "technical_analysis": {"Introduction": "The CVE-2024-34364 vulnerability in Envoy HTTP client allows for potential OOM conditions.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5 with an attack vector of NETWORK, attack complexity of LOW, privileges required of LOW, user interaction of NONE, and scope of UNCHANGED. It also has a CVSS score of 5.7 with an attack vector of NETWORK, attack complexity of LOW, privileges required of LOW, user interaction of REQUIRED, and scope of UNCHANGED from a secondary source.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques include T1208, T1055, T1563, T1190, T1210, and T1102.", "Technical Details": "The vulnerability occurs when the HTTP client receives unsolicited responses, leading to potential OOM conditions.", "Detection": "Detection of the vulnerability is challenging, but indicators can include unusual memory usage patterns.", "Mitigation": "Mitigation strategies include upgrading Envoy HTTP client to the latest version, configuring the HTTP client to handle unexpected responses, and implementing rate limiting.", "Conclusion": "The CVE-2024-34364 vulnerability highlights the importance of secure coding practices and testing for potential OOM conditions."}, "executive_analysis": {"Overview": "The CVE-2024-34364 vulnerability is a critical security issue affecting Envoy HTTP client.", "Business Impact": "The vulnerability has significant business impact, as it allows attackers to execute arbitrary code or manipulate the system, potentially leading to data breaches and system compromise.", "Technical Impact": "The vulnerability has significant technical impact, as it allows attackers to execute arbitrary code or manipulate the system, potentially leading to data breaches and system compromise.", "Mitigation Strategies": "Mitigation strategies for the vulnerability include upgrading Envoy HTTP client to the latest version, configuring the HTTP client to handle unexpected responses, and implementing rate limiting.", "Recommendations": "Recommendations for executives include prioritizing security testing and vulnerability remediation, implementing secure coding practices, and staying informed about the latest security threats.", "Conclusions": "The CVE-2024-34364 vulnerability is a serious security issue that requires immediate attention and mitigation."}}