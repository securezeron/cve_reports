{"id": "CVE-2024-28826", "sourceIdentifier": "security@checkmk.com", "published": "2024-05-29T10:15:09.010", "lastModified": "2024-05-29T13:02:09.280", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Improper restriction of local upload and download paths in check_sftp in Checkmk before 2.3.0p4, 2.2.0p27, 2.1.0p44, and in Checkmk 2.0.0 (EOL) allows attackers with sufficient permissions to configure the check to read and write local files on the Checkmk site server."}, {"lang": "es", "value": "La restricci\u00f3n inadecuada de las rutas de carga y descarga locales en check_sftp en Checkmk anterior a 2.3.0p4, 2.2.0p27, 2.1.0p44 y en Checkmk 2.0.0 (EOL) permite a atacantes con permisos suficientes configurar la verificaci\u00f3n para leer y escribir archivos locales en el servidor del sitio Checkmk."}], "metrics": {"cvssMetricV31": [{"source": "security@checkmk.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@checkmk.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-73"}]}], "references": [{"url": "https://checkmk.com/werk/15200", "source": "security@checkmk.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-28826 - This vulnerability can be exploited by an attacker to read and write local files on the Checkmk site server, allowing them to execute arbitrary code. This is a prime example of a lateral movement technique."}, {"techniqueID": "T1190", "comment": "CVE-2024-28826 - The vulnerability in Checkmk allows an attacker to configure the check to read and write local files on the site server, which can be used for data exfiltration or to execute malicious code."}, {"techniqueID": "T1569", "comment": "CVE-2024-28826 - The vulnerability in Checkmk can be used to escalate privileges and execute arbitrary code on the site server, allowing an attacker to pivot to other parts of the network."}], "stix_bundle": {"@stix2:Bundle": {"id": "https://example.com/cve-2024-28826/stix_bundle", "type": "stix_bundle", "created_by_ref": "https://example.com/user", "created": "2024-05-29T13:02:09.280", "modified": "2024-05-29T13:02:09.280", "objects": [{"type": "security-incident", "id": "https://example.com/cve-2024-28826/security-incident", "created_by_ref": "https://example.com/user", "created": "2024-05-29T13:02:09.280", "modified": "2024-05-29T13:02:09.280", "name": "CVE-2024-28826 Security Incident", "description": "An attacker has exploited the CVE-2024-28826 vulnerability in Checkmk to read and write local files on the site server.", "objects": [{"type": "vulnerability", "id": "https://example.com/cve-2024-28826/vulnerability", "created_by_ref": "https://example.com/user", "created": "2024-05-29T13:02:09.280", "modified": "2024-05-29T13:02:09.280", "name": "CVE-2024-28826", "description": "Improper restriction of local upload and download paths in check_sftp in Checkmk before 2.3.0p4, 2.2.0p27, 2.1.0p44, and in Checkmk 2.0.0 (EOL).", "objects": [{"type": "cvss", "id": "https://example.com/cve-2024-28826/cvss", "created_by_ref": "https://example.com/user", "created": "2024-05-29T13:02:09.280", "modified": "2024-05-29T13:02:09.280", "base_score": 8.8, "base_severity": "HIGH"}]}, {"type": "course-of-action", "id": "https://example.com/cve-2024-28826/course-of-action", "created_by_ref": "https://example.com/user", "created": "2024-05-29T13:02:09.280", "modified": "2024-05-29T13:02:09.280", "name": "Remediate Checkmk Vulnerability", "description": "Apply the recommended patch to remediate the CVE-2024-28826 vulnerability in Checkmk.", "related_tactics": [{"type": "tactic", "id": "https://example.com/tactic", "created_by_ref": "https://example.com/user", "created": "2024-05-29T13:02:09.280", "modified": "2024-05-29T13:02:09.280", "name": "Defensive Tactics", "description": "Defensive tactics to mitigate the CVE-2024-28826 vulnerability in Checkmk."}]}]}]}}, "technical_analysis": {"Introduction": "The CVE-2024-28826 vulnerability in Checkmk allows an attacker to read and write local files on the site server, which can be used to execute arbitrary code.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 and can be exploited to execute arbitrary code on the site server.", "Related MITRE ATT&CK Techniques": "The vulnerability can be exploited using MITRE ATT&CK techniques such as T1210, T1190, and T1569.", "Technical Details": "The vulnerability is due to an improper restriction of local upload and download paths in check_sftp in Checkmk before 2.3.0p4, 2.2.0p27, 2.1.0p44, and in Checkmk 2.0.0 (EOL).", "Detection": "Detection methods include monitoring for unusual file access or modification on the site server.", "Mitigation": "Mitigation strategies include applying the recommended patch to remediate the vulnerability and monitoring for unusual file access or modification on the site server.", "Conclusion": "The CVE-2024-28826 vulnerability in Checkmk is a high-risk vulnerability that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The CVE-2024-28826 vulnerability in Checkmk is a high-risk vulnerability that can be exploited to execute arbitrary code on the site server.", "Business Impact": "The vulnerability can have a significant business impact by allowing an attacker to steal sensitive data or disrupt business operations.", "Technical Impact": "The vulnerability can have a significant technical impact by allowing an attacker to execute arbitrary code on the site server.", "Mitigation Strategies": "Mitigation strategies include applying the recommended patch to remediate the vulnerability and monitoring for unusual file access or modification on the site server.", "Recommendations": "Recommendations include applying the recommended patch to remediate the vulnerability and monitoring for unusual file access or modification on the site server.", "Conclusions": "The CVE-2024-28826 vulnerability in Checkmk is a high-risk vulnerability that requires immediate attention and remediation."}}