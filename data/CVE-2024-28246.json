{"id": "CVE-2024-28246", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-25T20:15:08.580", "lastModified": "2024-03-26T12:55:05.010", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "KaTeX is a JavaScript library for TeX math rendering on the web. Code that uses KaTeX's `trust` option, specifically that provides a function to blacklist certain URL protocols, can be fooled by URLs in malicious inputs that use uppercase characters in the protocol. In particular, this can allow for malicious input to generate `javascript:` links in the output, even if the `trust` function tries to forbid this protocol via `trust: (context) => context.protocol !== 'javascript'`. Upgrade to KaTeX v0.16.10 to remove this vulnerability."}, {"lang": "es", "value": "KaTeX es una librer\u00eda de JavaScript para la representaci\u00f3n matem\u00e1tica de TeX en la web. El c\u00f3digo que utiliza la opci\u00f3n `trust` de KaTeX, espec\u00edficamente el que proporciona una funci\u00f3n para incluir en la lista negra ciertos protocolos URL, puede ser enga\u00f1ado por URL en entradas maliciosas que utilizan caracteres en may\u00fasculas en el protocolo. En particular, esto puede permitir que entradas maliciosas generen enlaces `javascript:` en la salida, incluso si la funci\u00f3n `trust` intenta prohibir este protocolo mediante `trust: (context) =&gt; context.protocol !== 'javascript' `. Actualice a KaTeX v0.16.10 para eliminar esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-184"}, {"lang": "en", "value": "CWE-697"}]}], "references": [{"url": "https://github.com/KaTeX/KaTeX/commit/fc5af64183a3ceb9be9d1c23a275999a728593de", "source": "security-advisories@github.com"}, {"url": "https://github.com/KaTeX/KaTeX/security/advisories/GHSA-3wc5-fcw2-2329", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA1507", "comment": "CVE-2024-28246 - This is a case of insufficient validation of user-supplied input, making it easier for an attacker to inject malicious code. To defend against this, implement input validation and sanitization mechanisms."}, {"techniqueID": "T1174", "comment": "CVE-2024-28246 - This is an example of protocol downgrade, allowing an attacker to inject malicious content. To defend against this, ensure that protocols are properly validated and cannot be downgraded."}, {"techniqueID": "T1218", "comment": "CVE-2024-28246 - This is a case of web search poisoning, where an attacker injects malicious content into a search result. To defend against this, implement web search poisoning mitigation mechanisms."}], "stix_bundle": {"touches": {"ipv4-addr": {"value": "0.0.0.0/0", "x_opencti_uuid": "01b3ef89-45ed-4eb1-a9f7-44c6f87c5b94"}}, "network-traffic": {"dst_port": "80", "protocol": "http", "src_port": "80", "x_opencti_uuid": "01b3ef89-45ed-4eb1-a9f7-44c6f87c5b94"}, "Observables": [{"x_opencti_type": "ipv4-addr", "value": "0.0.0.0/0", "uuid": "01b3ef89-45ed-4eb1-a9f7-44c6f87c5b94"}], "vulnerability": {"cve": {"id": "CVE-2024-28246", "references": [{"url": "https://github.com/KaTeX/KaTeX/commit/fc5af64183a3ceb9be9d1c23a275999a728593de", "source": "security-advisories@github.com"}, {"url": "https://github.com/KaTeX/KaTeX/security/advisories/GHSA-3wc5-fcw2-2329", "source": "security-advisories@github.com"}]}}}, "technical_analysis": {"Introduction": "The vulnerability CVE-2024-28246 is a case of insufficient validation of user-supplied input, allowing an attacker to inject malicious code.", "Impact and Scope": "The impact of this vulnerability is moderate, with a CVSS score of 5.5 and an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: TA1507, T1174, and T1218.", "Technical Details": "The vulnerability is caused by a flaw in the `trust` option of the KaTeX library, which allows an attacker to inject malicious code.", "Detection": "Detection methods include monitoring for suspicious network traffic and assessing the security of the KaTeX library.", "Mitigation": "Mitigation strategies include implementing input validation and sanitization mechanisms, and ensuring that protocols are properly validated.", "Conclusion": "In conclusion, the CVE-2024-28246 vulnerability is a moderate-severity issue that can be mitigated by implementing proper input validation and sanitization mechanisms."}, "executive_analysis": {"Overview": "The CVE-2024-28246 vulnerability is a case of insufficient validation of user-supplied input, allowing an attacker to inject malicious code.", "Business Impact": "The business impact of this vulnerability is moderate, as it could allow an attacker to inject malicious code into a web application.", "Technical Impact": "The technical impact of this vulnerability is moderate, as it could allow an attacker to inject malicious code into a web application.", "Mitigation Strategies": "Mitigation strategies include implementing input validation and sanitization mechanisms, and ensuring that protocols are properly validated.", "Recommendations": "It is recommended that users upgrade to the latest version of the KaTeX library and implement input validation and sanitization mechanisms.", "Conclusions": "In conclusion, the CVE-2024-28246 vulnerability is a moderate-severity issue that can be mitigated by implementing proper input validation and sanitization mechanisms."}}