{"id": "CVE-2024-35993", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-20T10:15:13.463", "lastModified": "2024-05-20T13:00:04.957", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm: turn folio_test_hugetlb into a PageType\n\nThe current folio_test_hugetlb() can be fooled by a concurrent folio split\ninto returning true for a folio which has never belonged to hugetlbfs. \nThis can't happen if the caller holds a refcount on it, but we have a few\nplaces (memory-failure, compaction, procfs) which do not and should not\ntake a speculative reference.\n\nSince hugetlb pages do not use individual page mapcounts (they are always\nfully mapped and use the entire_mapcount field to record the number of\nmappings), the PageType field is available now that page_mapcount()\nignores the value in this field.\n\nIn compaction and with CONFIG_DEBUG_VM enabled, the current implementation\ncan result in an oops, as reported by Luis. This happens since 9c5ccf2db04b\n(\"mm: remove HUGETLB_PAGE_DTOR\") effectively added some VM_BUG_ON() checks\nin the PageHuge() testing path.\n\n[willy@infradead.org: update vmcoreinfo]\n  Link: https://lkml.kernel.org/r/ZgGZUvsdhaT1Va-T@casper.infradead.org"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: mm: convierte folio_test_hugetlb en un PageType. El folio_test_hugetlb() actual puede ser enga\u00f1ado por una divisi\u00f3n de folio concurrente y devuelve verdadero para un folio que nunca ha pertenecido a hugetlbfs. Esto no puede suceder si la persona que llama tiene un recuento sobre \u00e9l, pero tenemos algunos lugares (fallo de memoria, compactaci\u00f3n, procfs) que no toman ni deben tomar una referencia especulativa. Dado que las p\u00e1ginas de Hugetlb no usan recuentos de mapas de p\u00e1ginas individuales (siempre est\u00e1n completamente asignadas y usan el campo Whole_mapcount para registrar el n\u00famero de asignaciones), el campo PageType est\u00e1 disponible ahora que page_mapcount() ignora el valor en este campo. En compactaci\u00f3n y con CONFIG_DEBUG_VM habilitado, la implementaci\u00f3n actual puede resultar en un error, seg\u00fan lo informado por Luis. Esto sucede desde que 9c5ccf2db04b (\"mm: eliminar HUGETLB_PAGE_DTOR\") agreg\u00f3 efectivamente algunas comprobaciones de VM_BUG_ON() en la ruta de prueba de PageHuge(). [willy@infradead.org: actualizar vmcoreinfo] Enlace: https://lkml.kernel.org/r/ZgGZUvsdhaT1Va-T@casper.infradead.org"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/2431b5f2650dfc47ce782d1ca7b02d6b3916976f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9fdcc5b6359dfdaa52a55033bf50e2cedd66eb32", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d99e3140a4d33e26066183ff727d8f02f56bec64", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1055", "comment": "CVE-2024-35993 - Attackers may leverage this vulnerability to manipulate the Linux kernel, potentially leading to elevated privileges. Defenses should focus on secure kernel configuration and memory management."}, {"techniqueID": "T1210", "comment": "CVE-2024-35993 - The vulnerability allows for a speculative reference, enabling attackers to bypass kernel checks. Defenses should rely on debugging tools and VM_BUG_ON() checks to detect malicious activity."}], "stix_bundle": {"stix": {"Bundle": {"id": "", "type": "Bundle", "created_by_ref": "", "created": "", "modified": "", "name": "CVE-2024-35993", "description": "Linux kernel vulnerability", "objects": [{"id": "", "type": "Vulnerability", "created_by_ref": "", "created": "", "modified": "", "name": "CVE-2024-35993", "description": "Linux kernel vulnerability", "cve": {"cve_id": "CVE-2024-35993"}, "related_events": [{"id": "", "type": "Exploit", "created_by_ref": "", "created": "", "modified": "", "name": "Exploit of CVE-2024-35993"}]}, {"id": "", "type": "Exploit", "created_by_ref": "", "created": "", "modified": "", "name": "Exploit of CVE-2024-35993", "description": "Exploit of CVE-2024-35993", "exploited_voltage": "CVE-2024-35993"}]}}}, "technical_analysis": {"Introduction": "CVE-2024-35993 is a Linux kernel vulnerability that allows for speculative references to manipulate the kernel's memory management.", "Impact and Scope": "The vulnerability has a medium severity rating and an attack vector of network-based. It affects the Linux kernel version 5.17 and earlier.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to T1055: Architecting Backdoors and T1210: Exploitation of Remote Services.", "Technical Details": "The vulnerability occurs when the kernel's mm/ folder is manipulated to create a speculative reference, allowing an attacker to bypass kernel checks.", "Detection": "Detection involves monitoring kernel logs for unusual activity and using debugging tools to identify speculative references.", "Mitigation": "Mitigation strategies include secure kernel configuration, memory management, and limiting network access to affected systems.", "Conclusion": "CVE-2024-35993 is a significant vulnerability that requires immediate attention and mitigation efforts."}, "executive_analysis": {"Overview": "CVE-2024-35993 is a Linux kernel vulnerability that requires immediate attention and mitigation efforts.", "Business Impact": "The vulnerability poses a moderate risk to business operations, as it allows for speculative references to manipulate kernel memory management.", "Technical Impact": "The vulnerability affects the Linux kernel version 5.17 and earlier, requiring updates to affected systems.", "Mitigation Strategies": "Secure kernel configuration, memory management, and limiting network access to affected systems are recommended mitigation strategies.", "Recommendations": "Recommendations include updating affected systems, implementing secure kernel configuration, and monitoring kernel logs for unusual activity.", "Conclusions": "Immediate attention and mitigation efforts are required to prevent exploitation of CVE-2024-35993."}}