{"id": "CVE-2020-4044", "sourceIdentifier": "security-advisories@github.com", "published": "2020-06-30T16:15:16.203", "lastModified": "2020-08-14T21:15:14.397", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The xrdp-sesman service before version 0.9.13.1 can be crashed by connecting over port 3350 and supplying a malicious payload. Once the xrdp-sesman process is dead, an unprivileged attacker on the server could then proceed to start their own imposter sesman service listening on port 3350. This will allow them to capture any user credentials that are submitted to XRDP and approve or reject arbitrary login credentials. For xorgxrdp sessions in particular, this allows an unauthorized user to hijack an existing session. This is a buffer overflow attack, so there may be a risk of arbitrary code execution as well."}, {"lang": "es", "value": "El servicio xrdp-sesman versiones anteriores a 0.9.13.1 puede ser bloqueado al conectarse a trav\u00e9s del puerto 3350 y suministrando una carga maliciosa. Una vez que el proceso xrdp-sesman est\u00e1 inactivo, un atacante sin privilegios en el servidor podr\u00eda comenzar a iniciar su propio servicio impostor sesman escuchando en el puerto 3350. Esto les permitir\u00e1 capturar cualquier credencial de usuario que sea enviada a XRDP y aprobar o rechazar credenciales de inicio de sesi\u00f3n arbitrarias. Para las sesiones xorgxrdp en particular, esto permite a un usuario no autorizado secuestrar una sesi\u00f3n existente. Este es un ataque de desbordamiento del b\u00fafer, por lo que tambi\u00e9n puede existir un riesgo de ejecuci\u00f3n de c\u00f3digo arbitraria"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.6}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.9, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-121"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:neutrinolabs:xrdp:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.9.13.1", "matchCriteriaId": "AB124086-296A-4B17-A012-556DDF1E7E12"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-07/msg00036.html", "source": "security-advisories@github.com"}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2020-08/msg00037.html", "source": "security-advisories@github.com"}, {"url": "https://github.com/neutrinolabs/xrdp/commit/0c791d073d0eb344ee7aaafd221513dc9226762c", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/neutrinolabs/xrdp/releases/tag/v0.9.13.1", "source": "security-advisories@github.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/neutrinolabs/xrdp/security/advisories/GHSA-j9fv-6fwf-p3g4", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2020/08/msg00015.html", "source": "security-advisories@github.com"}, {"url": "https://www.debian.org/security/2020/dsa-4737", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-4044 - This buffer overflow attack is an example of a classic exploitation technique. Defending against it requires implementing proper input validation and sanitization techniques to prevent malicious data from being injected into the system."}, {"techniqueID": "T1193", "comment": "CVE-2020-4044 - The use of a malicious payload to crash the xrdp-sesman service allows for further exploitation. Defending against this requires implementing rate limiting and monitoring for suspicious activity to detect and prevent similar attacks."}, {"techniqueID": "T1026", "comment": "CVE-2020-4044 - An unprivileged attacker may use the captured credentials to hijack an existing xorgxrdp session. Defending against this requires implementing session management and monitoring for suspicious activity to detect and prevent session hijacking."}, {"techniqueID": "T1210", "comment": "CVE-2020-4044 - The exploitation of this vulnerability may lead to arbitrary code execution, making it a potential risk to system integrity. Defending against this requires implementing proper code signing and verification techniques to ensure the integrity of system software."}, {"techniqueID": "T1078", "comment": "CVE-2020-4044 - The use of a buffer overflow attack indicates a lack of proper input validation. Defending against this requires implementing input validation and sanitization techniques to prevent similar attacks."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve-2020-4044-stix-2.1.ndjson", "created": "2021-01-01T12:00:00.000Z", "modified": "2021-01-01T12:00:00.000Z", "objects": [{"type": "vulnerability", "id": "https://example.com/cve-2020-4044-stix-2.1-vulnerability.ndjson", "affected_object_ref": {"type": "software", "id": "https://example.com/xrdp-stix-2.1-software.ndjson"}, "description": "A buffer overflow attack vulnerability in the xrdp-sesman service.", "cvss": {"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "baseScore": 7.8}}, {"type": "relationship", "id": "https://example.com/cve-2020-4044-stix-2.1-relationship.ndjson", "source_ref": {"type": "vulnerability", "id": "https://example.com/cve-2020-4044-stix-2.1-vulnerability.ndjson"}, "target_ref": {"type": "mitigation", "id": "https://example.com/cve-2020-4044-stix-2.1-mitigation.ndjson"}}, {"type": "mitigation", "id": "https://example.com/cve-2020-4044-stix-2.1-mitigation.ndjson", "description": "Implement input validation and sanitization techniques to prevent buffer overflow attacks."}], "relationships": [{"type": "affected-by", "id": "https://example.com/cve-2020-4044-stix-2.1-affected-by.ndjson", "source_ref": {"type": "vulnerability", "id": "https://example.com/cve-2020-4044-stix-2.1-vulnerability.ndjson"}, "target_ref": {"type": "software", "id": "https://example.com/xrdp-stix-2.1-software.ndjson"}}]}, "technical_analysis": {"Introduction": "The vulnerability is a classic example of a buffer overflow attack, which can be exploited by an unprivileged attacker.", "Impact and Scope": "The vulnerability affects the xrdp-sesman service, which is responsible for handling incoming connections. The attack vector is local, making it a high-risk vulnerability.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including T1190, T1193, T1026, T1210, and T1078.", "Technical Details": "The vulnerability is caused by a buffer overflow attack, which allows an attacker to inject malicious data into the system.", "Detection": "The vulnerability can be detected by monitoring for suspicious activity, such as unusual network traffic patterns or unusual system behavior.", "Mitigation": "Implementing input validation and sanitization techniques can help prevent buffer overflow attacks.", "Conclusion": "The vulnerability is a high-risk vulnerability that can be exploited by an unprivileged attacker. Implementing proper mitigation strategies can help prevent successful exploitation."}, "executive_analysis": {"Overview": "The vulnerability is a high-risk vulnerability that can be exploited by an unprivileged attacker.", "Business Impact": "The vulnerability can have significant business impacts, including data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability can cause significant technical impacts, including system compromise, data breaches, and unauthorized access.", "Mitigation Strategies": "Implementing input validation and sanitization techniques can help prevent buffer overflow attacks.", "Recommendations": "System administrators should prioritize patching and updating vulnerable systems, as well as implementing proper input validation and sanitization techniques.", "Conclusions": "The vulnerability is a high-risk vulnerability that requires immediate attention. Implementing proper mitigation strategies and staying up-to-date with patch releases can help prevent successful exploitation."}}