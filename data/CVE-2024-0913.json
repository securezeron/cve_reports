{"id": "CVE-2024-0913", "sourceIdentifier": "security@wordfence.com", "published": "2024-03-29T07:15:42.120", "lastModified": "2024-03-29T12:45:02.937", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The WP ERP | Complete HR solution with recruitment & job listings | WooCommerce CRM & Accounting plugin for WordPress is vulnerable to time-based SQL Injection via the erp/v1/accounting/v1/transactions/sales REST API endpoint in all versions up to, and including, 1.12.9 due to insufficient escaping on the user supplied status and customer_id parameters and lack of sufficient preparation on the existing SQL query.  This makes it possible for authenticated attackers, with accounting manager or admin privileges and higher to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database."}, {"lang": "es", "value": "WP ERP | Complete HR solution with recruitment &amp; job listings | WooCommerce CRM &amp; Accounting de WordPress es vulnerable a la inyecci\u00f3n SQL basada en tiempo a trav\u00e9s del endpoint API REST erp/v1/accounting/v1/transactions/sales en todas las versiones hasta la 1.12.9 incluida debido a un escape insuficiente para los par\u00e1metros user supplied status y customer_id y falta de preparaci\u00f3n suficiente en la consulta SQL existente. Esto hace posible que atacantes autenticados, con privilegios de administrador o administrador de contabilidad y superiores agreguen consultas SQL adicionales a consultas ya existentes que pueden usarse para extraer informaci\u00f3n confidencial de la base de datos."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}]}, "references": [{"url": "https://plugins.trac.wordpress.org/browser/erp/trunk/modules/accounting/includes/functions/transactions.php#L42", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/592440ab-60ac-419f-b615-e5617460aea9?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1059: Command and Control", "comment": "The vulnerability, CVE-2024-0913, allows authenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database. This can be used as a command and control channel for malicious actors."}, {"techniqueID": "T1068: Exploitation of Remote Services", "comment": "The vulnerability, CVE-2024-0913, provides an entry point for an attacker to exploit the WP ERP | Complete HR solution with recruitment & job listings | WooCommerce CRM & Accounting plugin for WordPress, allowing them to execute malicious SQL queries."}, {"techniqueID": "T1133: External Remote Services", "comment": "The vulnerability, CVE-2024-0913, can be used as a foothold for an attacker to pivot to other systems, allowing them to expand their attack surface."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "The vulnerability, CVE-2024-0913, is a public-facing application vulnerability that can be exploited by an attacker to gain unauthorized access to sensitive information."}], "stix_bundle": "{ \"bundle\" : { \"type\" : \"bundle\", \"id\" : \"https://example.com/bundle/cve-2024-0913\", \"name\" : \"CVE-2024-0913 Bundle\", \"description\" : \"A STIX 2.1 bundle for CVE-2024-0913\", \"created\" : \"2024-03-29T07:15:42.120\", \"modified\" : \"2024-03-29T12:45:02.937\", \"objects\" : [ \\n   { \"type\" : \"indicator\", \"id\" : \"indicator-1\", \"name\" : \"Indicator 1\", \"description\" : \"An indicator for the vulnerable plugin\", \"created\" : \"2024-03-29T07:15:42.120\", \"modified\" : \"2024-03-29T12:45:02.937\", \"patterns\" : [ { \"type\" : \"string\", \"value\" : \"erh=1\" } ], \"organization\" : { \"type\" : \"Organization\", \"id\" : \"example.org\" } }, \\n   { \"type\" : \"course-of-action\", \"id\" : \"c001\", \"name\" : \"COA 1\", \"description\" : \"A course of action for mitigating the vulnerability\", \"created\" : \"2024-03-29T07:15:42.120\", \"modified\" : \"2024-03-29T12:45:02.937\", \"techniques\" : [ { \"type\" : \"technique\", \"id\" : \"T1059\" } ], \"notes\" : [ { \"type\" : \"note\", \"id\" : \"n001\", \"content\" : \"Note for COA 1\" } ] }, \\n   { \"type\" : \"course-of-action\", \"id\" : \"c002\", \"name\" : \"COA 2\", \"description\" : \"A course of action for mitigating the vulnerability\", \"created\" : \"2024-03-29T07:15:42.120\", \"modified\" : \"2024-03-29T12:45:02.937\", \"techniques\" : [ { \"type\" : \"technique\", \"id\" : \"T1190\" } ], \"notes\" : [ { \"type\" : \"note\", \"id\" : \"n002\", \"content\" : \"Note for COA 2\" } ] }, \\n   { \"type\" : \"indicator\", \"id\" : \"indicator-2\", \"name\" : \"Indicator 2\", \"description\" : \"An indicator for the vulnerable plugin\", \"created\" : \"2024-03-29T07:15:42.120\", \"modified\" : \"2024-03-29T12:45:02.937\", \"patterns\" : [ { \"type\" : \"string\", \"value\" : \"erh=2\" } ], \"organization\" : { \"type\" : \"Organization\", \"id\" : \"example.org\" } } ], \\n   \"relations\" : [ { \"type\" : \"has-sub-bundle\", \"id\" : \"rel-1\", \"bundle\" : { \"type\" : \"bundle\", \"id\" : \"https://example.com/bundle/cve-2024-0913-sub\" } }, { \"type\" : \"has-sub-bundle\", \"id\" : \"rel-2\", \"bundle\" : { \"type\" : \"bundle\", \"id\" : \"https://example.com/bundle/cve-2024-0913-sub\" } } ] } }", "technical_analysis": {"Introduction": "The WP ERP | Complete HR solution with recruitment & job listings | WooCommerce CRM & Accounting plugin for WordPress is vulnerable to time-based SQL Injection via the erp/v1/accounting/v1/transactions/sales REST API endpoint in all versions up to, and including, 1.12.9 due to insufficient escaping on the user-supplied status and customer_id parameters and lack of sufficient preparation on the existing SQL query.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2 (HIGH) and is rated as HIGH in terms of attack complexity, privileges required, user interaction, and base severity. The vulnerability is applicable to all versions of the WP ERP plugin up to and including 1.12.9.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques such as T1059, T1068, T1133, and T1190.", "Technical Details": "The vulnerability can be exploited by an attacker who has accounting manager or admin privileges and higher to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.", "Detection": "The vulnerability can be detected by monitoring for suspicious SQL queries and monitoring for authenticated access to the erp/v1/accounting/v1/transactions/sales REST API endpoint.", "Mitigation": "The vulnerability can be mitigated by updating to a version higher than 1.12.9 and by disabling the erp/v1/accounting/v1/transactions/sales REST API endpoint.", "Conclusion": "The vulnerability is a high-risk vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The WP ERP | Complete HR solution with recruitment & job listings | WooCommerce CRM & Accounting plugin for WordPress is vulnerable to time-based SQL Injection.", "Business Impact": "The vulnerability can be exploited by an attacker to extract sensitive information from the database, which can result in financial loss, reputational damage, and regulatory compliance issues.", "Technical Impact": "The vulnerability can be exploited by an attacker to gain unauthorized access to sensitive information, which can result in data breaches, stolen credentials, and unauthorized changes to the database.", "Mitigation Strategies": "The vulnerability can be mitigated by updating to a version higher than 1.12.9 and by disabling the erp/v1/accounting/v1/transactions/sales REST API endpoint.", "Recommendations": "Recommendations for executives include prioritizing patch management, regularly monitoring for vulnerabilities, and conducting regular security audits.", "Conclusions": "The vulnerability is a high-risk vulnerability that requires immediate attention and mitigation."}}