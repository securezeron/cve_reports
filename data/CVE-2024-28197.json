{"id": "CVE-2024-28197", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-11T20:15:07.420", "lastModified": "2024-03-12T12:40:13.500", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Zitadel is an open source identity management system. Zitadel uses a cookie to identify the user agent (browser) and its user sessions.  Although the cookie was handled according to best practices, it was accessible on subdomains of the ZITADEL instance. An attacker could take advantage of this and provide a malicious link hosted on the subdomain to the user to gain access to the victim\u2019s account in certain scenarios. A possible victim would need to login through the malicious link for this exploit to work. If the possible victim already had the cookie present, the attack would not succeed. The attack would further only be possible if there was an initial vulnerability on the subdomain. This could either be the attacker being able to control DNS or a XSS vulnerability in an application hosted on a subdomain. Versions 2.46.0, 2.45.1, and 2.44.3 have been patched. Zitadel recommends upgrading to the latest versions available in due course. Note that applying the patch will invalidate the current cookie and thus users will need to start a new session and existing sessions (user selection) will be empty. For self-hosted environments unable to upgrade to a patched version, prevent setting the following cookie name on subdomains of your Zitadel instance (e.g. within your WAF): `__Secure-zitadel-useragent`."}, {"lang": "es", "value": "Zitadel es un sistema de gesti\u00f3n de identidades de c\u00f3digo abierto. Zitadel utiliza una cookie para identificar el agente de usuario (navegador) y sus sesiones de usuario. Aunque la cookie se manej\u00f3 de acuerdo con las mejores pr\u00e1cticas, era accesible en los subdominios de la instancia ZITADEL. Un atacante podr\u00eda aprovechar esto y proporcionar un enlace malicioso alojado en el subdominio al usuario para obtener acceso a la cuenta de la v\u00edctima en ciertos escenarios. Una posible v\u00edctima tendr\u00eda que iniciar sesi\u00f3n a trav\u00e9s del enlace malicioso para que este exploit funcione. Si la posible v\u00edctima ya tuviera presente la cookie, el ataque no tendr\u00eda \u00e9xito. Adem\u00e1s, el ataque solo ser\u00eda posible si hubiera una vulnerabilidad inicial en el subdominio. Esto podr\u00eda ser que el atacante pueda controlar DNS o una vulnerabilidad XSS en una aplicaci\u00f3n alojada en un subdominio. Se han parcheado las versiones 2.46.0, 2.45.1 y 2.44.3. Zitadel recomienda actualizar a las \u00faltimas versiones disponibles oportunamente. Tenga en cuenta que la aplicaci\u00f3n del parche invalidar\u00e1 la cookie actual y, por lo tanto, los usuarios deber\u00e1n iniciar una nueva sesi\u00f3n y las sesiones existentes (selecci\u00f3n de usuario) estar\u00e1n vac\u00edas. Para entornos autohospedados que no pueden actualizar a una versi\u00f3n parcheada, evite configurar el siguiente nombre de cookie en los subdominios de su instancia de Zitadel (por ejemplo, dentro de su WAF): `__Secure-zitadel-useragent`."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.8}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-269"}]}], "references": [{"url": "https://github.com/zitadel/zitadel/security/advisories/GHSA-mq4x-r2w3-j7mr", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-28197 - This technique is used by the attacker to manipulate the cookie and the user's session to gain unauthorized access to the victim's account."}, {"techniqueID": "T1047", "comment": "CVE-2024-28197 - This technique is used by the attacker to compromise the DNS records of the subdomain to host a malicious link that the user can click, leading to the exploitation of the vulnerability."}, {"techniqueID": "T1569", "comment": "CVE-2024-28197 - This technique is used by the attacker to inject malicious code into the victim's web application to manipulate the user's session and gain unauthorized access to their account."}, {"techniqueID": "T1048", "comment": "CVE-2024-28197 - This technique is used by the attacker to inject cross-site scripting (XSS) payloads into the user's session to manipulate the user's actions and gain unauthorized access to their account."}, {"techniqueID": "T1192", "comment": "CVE-2024-28197 - This technique is used by the attacker to manipulate the user's session to cache and reuse the authenticated session to gain unauthorized access to the victim's account."}], "stix_bundle": {"id": "VulnerabilityDetails", "type": "report", "created_by": {"type": "individual", "name": "Cyber Security Expert"}, "created": "2024-03-11T20:15:07.420", "last_modified": "2024-03-12T12:40:13.500", "info": [{"type": "note", "content": "CVE-2024-28197 - Zitadel Identity Management System", "labels": ["vulnerability", "identity-management"]}], "objects": {"vulnerability": {"id": "Vulnerability-v1"}, "technique": {"id": "T1192", "name": "Session Management", "description": "This technique is used to manipulate a user's session to gain unauthorized access to their account.", "labels": ["session", "management"]}}, "relationships": [{"type": "has_note", "note_id": "Note-v1", "object_id": "Vulnerability-v1"}, {"type": "uses_technique", "technique_id": "T1190", "object_id": "Vulnerability-v1"}, {"type": "uses_technique", "technique_id": "T1047", "object_id": "Vulnerability-v1"}, {"type": "uses_technique", "technique_id": "T1569", "object_id": "Vulnerability-v1"}, {"type": "uses_technique", "technique_id": "T1048", "object_id": "Vulnerability-v1"}, {"type": "uses_technique", "technique_id": "T1192", "object_id": "Vulnerability-v1"}]}, "technical_analysis": {"Introduction": "The CVE-2024-28197 vulnerability is a severe security issue in the Zitadel Identity Management System, allowing attackers to manipulate the cookie and the user's session to gain unauthorized access to the victim's account.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5, making it a high-severity issue. Attack vectors include XSS, DNS cache poisoning, and session management manipulation.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1047, T1569, T1048, and T1192.", "Technical Details": "The vulnerability occurs when an attacker provides a malicious link to the user, which is hosted on a subdomain of the ZITADEL instance. The attacker can then use the manipulated cookie and session to gain unauthorized access to the victim's account.", "Detection": "Detection of this vulnerability involves monitoring for suspicious DNS traffic, odd HTTP requests, and anomalies in the application's access logs.", "Mitigation": "Mitigation strategies include implementing DNS security measures, validating HTTP requests for unusual patterns, and monitoring application logs for suspicious behavior.", "Conclusion": "In conclusion, the CVE-2024-28197 vulnerability is a critical security issue that requires immediate attention. It is essential to patch the vulnerability and implement the recommended mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-28197 vulnerability is a critical security issue in the Zitadel Identity Management System, allowing attackers to gain unauthorized access to the victim's account.", "Business Impact": "The vulnerability has a significant business impact, as it can lead to unauthorized access to sensitive information and can result in financial losses and reputational damage.", "Technical Impact": "The vulnerability has a high technical impact, as it can allow attackers to exploit the system and gain control over the user's session.", "Mitigation Strategies": "Recommended mitigation strategies include patching the vulnerability, implementing DNS security measures, and monitoring application logs for suspicious behavior.", "Recommendations": "Recommendations for executives include prioritizing the patching of the vulnerability, implementing additional security measures, and providing training to employees on how to identify and report suspicious behavior.", "Conclusions": "In conclusion, the CVE-2024-28197 vulnerability is a critical security issue that requires immediate attention. It is essential to prioritize the patching of the vulnerability and implement recommended mitigation strategies to prevent exploitation."}}