{"id": "CVE-2009-4597", "sourceIdentifier": "cve@mitre.org", "published": "2010-01-12T17:30:01.010", "lastModified": "2017-08-17T01:31:40.383", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple SQL injection vulnerabilities in index.php in PHP Inventory 1.2 allow (1) remote authenticated users to execute arbitrary SQL commands via the user_id parameter in a users details action, and allow remote attackers to execute arbitrary SQL commands via the (2) user (username) and (3) pass (password) parameters.  NOTE: some of these details are obtained from third party information."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de inyecci\u00f3n SQL en index.php en PHP Inventory v1.2 permite (1) a usuarios remotos autenticados ejecutar comandos SQl arbitrarios a trav\u00e9s del par\u00e1metro \"user_id\" en una acci\u00f3n \"users details\", y permite a atacantes remotos ejecutar comandos SQL de forma arbitraria a trav\u00e9s de los par\u00e1metros (2) \"user\" (nombre usuario) y (3) \"pass\" (contrase\u00f1a). NOTA: Algunos detalles fueron obtenidos por informaci\u00f3n de terceros"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpwares:php_inventory:1.2:*:*:*:*:*:*:*", "matchCriteriaId": "1DE7CB94-D658-447C-BEF3-6969D5D6B8F2"}]}]}], "references": [{"url": "http://packetstormsecurity.org/0912-exploits/phpinventory-sql.txt", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://secunia.com/advisories/37672", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.exploit-db.com/exploits/10370", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/54666", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2009-4597 - PHP Inventory SQL Injection allows an attacker to execute arbitrary SQL commands, this can be used to extract sensitive information or steal credentials. Defend against this by validating user input and avoiding dangerous SQL practices."}, {"techniqueID": "T1040", "comment": "CVE-2009-4597 - PHP Inventory SQL Injection can also be used to inject malicious code, such as backdoors or shellcode, to maintain access to the system. Defend against this by keeping software up-to-date and configuring web applications to restrict the execution of malicious code."}, {"techniqueID": "T1078", "comment": "CVE-2009-4597 - PHP Inventory SQL Injection can be used to exfiltrate data, this can be done by sending the stolen data to a remote server. Defend against this by monitoring network traffic and applying Web Application Firewall (WAF) rules to block suspicious traffic."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle-a6e91c55-d4d6-4c4f-a7f9-03f6d66eb08f", "title": "CVE-2009-4597 PHP Inventory SQL Injection", "description": "This STIX 2.1 bundle represents a potential vulnerability in PHP Inventory versions 1.2. The vulnerability involves SQL Injection attacks, which can lead to unauthorized data access and control.", "objects": [{"id": "vulnerability-1", "type": "vulnerability", "spec_version": "2.1", "attack_vector": ["NETWORK"], "base_severity": "HIGH", "base_score": 7.5, " cvssv2": {"vector_string": "AV:N/AC:L/Au:N/C:P/I:P/A:P"}, "product_data": {"product_name": ["PHP Inventory"], "product_version": ["1.2"]}, "references": [{"id": "reference-1", "type": "reference", "source_name": "cve@mitre.org", "url": "http://packetstormsecurity.org/0912-exploits/phpinventory-sql.txt", "category": "Exploit"}], "related_indicators": [{"id": "indicator-1", "type": "indicator", "spec_version": "2.1", "name": "PHP Inventory SQL Injection Indicator", "description": "This indicator is related to the PHP Inventory SQL Injection vulnerability.", "observables": [{"type": "http", "value": "GET /index.php HTTP/1.1"}]}]}, {"id": "mitigation-1", "type": "mitigation", "spec_version": "2.1", "name": "Validating User Input", "description": "Validate user input to prevent SQL Injection attacks.", "mitigates": ["vulnerability-1"]}], "relationships": [{"id": "relation-1", "type": "mitigates", "source": "mitigation-1", "target": "vulnerability-1"}]}, "technical_analysis": {"Introduction": "The CVE-2009-4597 vulnerability is a SQL Injection attack that affects PHP Inventory versions 1.2.", "Impact and Scope": "The vulnerability allows an attacker to execute arbitrary SQL commands, which can lead to unauthorized data access and control. The CVSSv2 score is 7.5, with an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1059, T1040, and T1078.", "Technical Details": "The vulnerability occurs when user input is not properly sanitized, allowing an attacker to inject malicious SQL code.", "Detection": "The vulnerability can be detected by monitoring network traffic and applying Web Application Firewall (WAF) rules to block suspicious traffic.", "Mitigation": "The vulnerability can be mitigated by validating user input and avoiding dangerous SQL practices. Keeping software up-to-date and configuring web applications to restrict the execution of malicious code can also help to prevent the vulnerability.", "Conclusion": "In conclusion, the CVE-2009-4597 vulnerability is a significant threat to systems running PHP Inventory versions 1.2. It is essential to take immediate action to mitigate this vulnerability to prevent unauthorized access and control."}, "executive_analysis": {"Overview": "The CVE-2009-4597 vulnerability is a SQL Injection attack that affects PHP Inventory versions 1.2.", "Business Impact": "The vulnerability can lead to unauthorized data access and control, which can result in significant financial losses and damage to reputation.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary SQL commands, which can compromise system security and integrity.", "Mitigation Strategies": "Validating user input and avoiding dangerous SQL practices are the primary mitigation strategies for this vulnerability.", "Recommendations": "We recommend that all systems running PHP Inventory versions 1.2 be upgraded to the latest version, and that all users be educated on the importance of security best practices.", "Conclusions": "In conclusion, it is essential to take immediate action to mitigate the CVE-2009-4597 vulnerability to prevent unauthorized access and control. We recommend that all systems running PHP Inventory versions 1.2 be upgraded and that users be educated on security best practices."}}