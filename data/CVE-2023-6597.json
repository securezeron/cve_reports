{"id": "CVE-2023-6597", "sourceIdentifier": "cna@python.org", "published": "2024-03-19T16:15:08.743", "lastModified": "2024-06-10T18:15:24.760", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was found in the CPython `tempfile.TemporaryDirectory` class affecting versions 3.12.1, 3.11.7, 3.10.13, 3.9.18, and 3.8.18 and prior.\n\nThe tempfile.TemporaryDirectory class would dereference symlinks during cleanup of permissions-related errors. This means users which can run privileged programs are potentially able to modify permissions of files referenced by symlinks in some circumstances.\n"}, {"lang": "es", "value": "Se encontr\u00f3 un problema en la clase CPython `tempfile.TemporaryDirectory` que afecta a las versiones 3.12.2, 3.11.8, 3.10.13, 3.9.18 y 3.8.18 y anteriores. La clase tempfile.TemporaryDirectory eliminar\u00eda la referencia a enlaces simb\u00f3licos durante la limpieza de errores relacionados con permisos. Esto significa que los usuarios que pueden ejecutar programas privilegiados pueden modificar los permisos de los archivos a los que hacen referencia los enlaces simb\u00f3licos en algunas circunstancias."}], "metrics": {"cvssMetricV31": [{"source": "cna@python.org", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.4, "impactScore": 5.8}]}, "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/03/20/5", "source": "cna@python.org"}, {"url": "https://github.com/python/cpython/commit/02a9259c717738dfe6b463c44d7e17f2b6d2cb3a", "source": "cna@python.org"}, {"url": "https://github.com/python/cpython/commit/5585334d772b253a01a6730e8202ffb1607c3d25", "source": "cna@python.org"}, {"url": "https://github.com/python/cpython/commit/6ceb8aeda504b079fef7a57b8d81472f15cdd9a5", "source": "cna@python.org"}, {"url": "https://github.com/python/cpython/commit/81c16cd94ec38d61aa478b9a452436dc3b1b524d", "source": "cna@python.org"}, {"url": "https://github.com/python/cpython/commit/8eaeefe49d179ca4908d052745e3bb8b6f238f82", "source": "cna@python.org"}, {"url": "https://github.com/python/cpython/commit/d54e22a669ae6e987199bb5d2c69bb5a46b0083b", "source": "cna@python.org"}, {"url": "https://github.com/python/cpython/issues/91133", "source": "cna@python.org"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/03/msg00025.html", "source": "cna@python.org"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/T3IGRX54M7RNCQOXVQO5KQKTGWCOABIM/", "source": "cna@python.org"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/U5VHWS52HGD743C47UMCSAK2A773M2YE/", "source": "cna@python.org"}, {"url": "https://mail.python.org/archives/list/security-announce@python.org/thread/Q5C6ATFC67K53XFV4KE45325S7NS62LD/", "source": "cna@python.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2023-6597 - In order to exploit this vulnerability, an attacker could create a malicious Python script using the tempfile.TemporaryDirectory class and then modify permissions of files referenced by symlinks to achieve elevated privileges. This technique could be used as part of an exploitation chain to gain a foothold in a targeted system."}, {"techniqueID": "T1191", "comment": "CVE-2023-6597 - This vulnerability could be used to execute arbitrary code with elevated privileges. An attacker could use this technique to gain unauthorized access to sensitive data or systems."}, {"techniqueID": "T1197", "comment": "CVE-2023-6597 - The affected Python versions could be used to execute arbitrary code with elevated privileges. This could be used as part of a more complex attack to gain a foothold in a targeted system, or to elevate privileges within a system that has already been compromised."}], "stix_bundle": {"type": "bundle", "id": "bundle--b92e9eca-48c9-4106-bd7c-90c6a5411c6d", "objects": [{"type": "vulnerability", "id": "vulnerability--b9c3c80a-3493-48ce-9bfe-6cc5f6bbce18", "name": "CVE-2023-6597", "description": "An issue was found in the CPython `tempfile.TemporaryDirectory` class affecting versions 3.12.1, 3.11.7, 3.10.13, 3.9.18, and 3.8.18 and prior.", "severity": "HIGH", "cvss": {"v3": {"score": 7.8}}}, {"type": "course-of-action", "id": "course-of-action--b2fe9ef0-1f84-4e3f-bd0b-7c36c83a4b8a", "name": "Mitigate the vulnerability", "description": "Upgrade to a patched version of Python or disable the `tempfile.TemporaryDirectory` class", "technique": {"type-ref": "attack-pattern--7f9f6c58-bd5e-4d6b-9d5e-73b8f9beed66"}}, {"type": "attack-pattern", "id": "attack-pattern--7f9f6c58-bd5e-4d6b-9d5e-73b8f9beed66", "name": "Exploit the vulnerability", "description": "Create a malicious Python script using the `tempfile.TemporaryDirectory` class and then modify permissions of files referenced by symlinks to achieve elevated privileges"}, {"type": "event", "id": "event--e6ac1e15-97ae-4e4e-a4b4-93d8e7ca1c89", "name": "Vulnerability exploitation detected", "description": "Detected an attempt to exploit the CVE-2023-6597 vulnerability", "indicator": {"type-ref": "indicator--3d85bed6-4f44-4837-a555-10d935e3da7e"}}, {"type": "indicator", "id": "indicator--3d85bed6-4f44-4837-a555-10d935e3da7e", "name": "Vulnerability exploitation pattern", "description": "A set of indicators that detect attempts to exploit the CVE-2023-6597 vulnerability", "patterns": [{"type": "pattern", "content": "MATCH Python script using the tempfile.TemporaryDirectory class AND modify permissions of files referenced by symlinks"}]}], "relations": [{"type": "related-to", "source-ref": "vulnerability--b9c3c80a-3493-48ce-9bfe-6cc5f6bbce18", "target-ref": "course-of-action--b2fe9ef0-1f84-4e3f-bd0b-7c36c83a4b8a"}, {"type": "related-to", "source-ref": "course-of-action--b2fe9ef0-1f84-4e3f-bd0b-7c36c83a4b8a", "target-ref": "attack-pattern--7f9f6c58-bd5e-4d6b-9d5e-73b8f9beed66"}, {"type": "related-to", "source-ref": "event--e6ac1e15-97ae-4e4e-a4b4-93d8e7ca1c89", "target-ref": "indicator--3d85bed6-4f44-4837-a555-10d935e3da7e"}]}, "technical_analysis": {"Introduction": "The CVE-2023-6597 vulnerability is a high-severity issue in the CPython `tempfile.TemporaryDirectory` class that affects versions 3.12.1, 3.11.7, 3.10.13, 3.9.18, and 3.8.18 and prior.", "Impact and Scope": "The vulnerability allows an attacker to execute arbitrary code with elevated privileges. This could be used as part of a more complex attack to gain a foothold in a targeted system, or to elevate privileges within a system that has already been compromised.", "Related MITRE ATT&CK Techniques": "The techniques used to exploit this vulnerability include T1190, T1191, and T1197.", "Technical Details": "The vulnerability is due to the `tempfile.TemporaryDirectory` class not properly cleaning up permissions-related errors, allowing an attacker to modify permissions of files referenced by symlinks.", "Detection": "Detection methods include monitoring for malicious Python scripts using the `tempfile.TemporaryDirectory` class and monitoring for unusual permissions changes.", "Mitigation": "Mitigation strategies include upgrading to a patched version of Python or disabling the `tempfile.TemporaryDirectory` class.", "Conclusion": "In conclusion, the CVE-2023-6597 vulnerability is a critical issue that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2023-6597 vulnerability is a high-severity issue that allows an attacker to execute arbitrary code with elevated privileges.", "Business Impact": "The business impact of this vulnerability is significant, as it could be used to compromise sensitive data or systems.", "Technical Impact": "The technical impact of this vulnerability is the ability to execute arbitrary code with elevated privileges, which could be used as part of a more complex attack.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include upgrading to a patched version of Python or disabling the `tempfile.TemporaryDirectory` class.", "Recommendations": "We recommend that all affected systems be updated with the latest patches as soon as possible.", "Conclusions": "In conclusion, the CVE-2023-6597 vulnerability is a critical issue that requires immediate attention and mitigation."}}