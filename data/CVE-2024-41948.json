{"id": "CVE-2024-41948", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-01T22:15:28.743", "lastModified": "2024-08-09T18:38:47.533", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "biscuit-java is the java implementation of Biscuit, an authentication and authorization token for microservices architectures. Third-party blocks can be generated without transferring the whole token to the third-party authority. Instead, a ThirdPartyBlock request can be sent, providing only the necessary info to generate a third-party block and to sign it, which includes the public key of the previous block (used in the signature) and the public keys part of the token symbol table (for public key interning in datalog expressions). A third-part block request forged by a malicious user can trick the third-party authority into generating datalog trusting the wrong keypair. This vulnerability is fixed in 4.0.0."}, {"lang": "es", "value": "biscuit-java es la implementaci\u00f3n java de Biscuit, un token de autenticaci\u00f3n y autorizaci\u00f3n para arquitecturas de microservicios. Se pueden generar bloques de terceros sin transferir el token completo a la autoridad de terceros. En su lugar, se puede enviar una solicitud ThirdPartyBlock, proporcionando solo la informaci\u00f3n necesaria para generar un bloque de terceros y firmarlo, que incluye la clave p\u00fablica del bloque anterior (utilizada en la firma) y las claves p\u00fablicas que forman parte de la tabla de s\u00edmbolos de token (para clave p\u00fablica interna en expresiones de registro de datos). Una solicitud de bloqueo de un tercero falsificada por un usuario malintencionado puede enga\u00f1ar a la autoridad del tercero para que genere un registro de datos que conf\u00ede en el par de claves incorrecto. Esta vulnerabilidad se solucion\u00f3 en 4.0.0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.0, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.1, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.0, "baseSeverity": "LOW"}, "exploitabilityScore": 1.3, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1259"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:biscuitsec:biscuit-java:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.0.0", "versionEndExcluding": "4.0.0", "matchCriteriaId": "5E70BDB1-379E-43FC-A28A-9CE22DD64712"}]}]}], "references": [{"url": "https://github.com/biscuit-auth/biscuit-java/security/advisories/GHSA-5hcj-rwm6-xmw4", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0006", "comment": "CVE-2024-41948 - Use of unauthorized data in block generation can lead to incorrect public key interning, allowing an attacker to forge a trusted block, causing the third-party authority to generate a trustworthiness assessment based on the incorrect public key. This can be mitigated by verifying the trustworthiness assessment."}, {"techniqueID": "TA0010", "comment": "CVE-2024-41948 - An attacker can send a valid third-party block request, allowing them to generate and sign the response, which can be used to obtain a trustworthiness assessment by the third-party authority. This can be mitigated by implementing proper validation of the block request."}, {"techniqueID": "TA0023", "comment": "CVE-2024-41948 - The vulnerable implementation allows an attacker to generate a third-party block without transferring the token, making it easier to exploit. This can be mitigated by enforcing proper token transfer and validation."}, {"techniqueID": "TA0034", "comment": "CVE-2024-41948 - The attacker can send a forged block request with the public key of the previous block, tricking the third-party authority into generating a trustworthiness assessment based on the incorrect public key. This can be mitigated by validating the public key in the block request."}], "technical_analysis": {"Introduction": "CVE-2024-41948 is a vulnerability in the Biscuit-Java library that allows an attacker to generate a trusted block without transferring the token, leading to incorrect public key interning and potential trustworthiness assessments.", "Impact and Scope": "The vulnerability has a CVSS score of 5.0 with a version of 3.1 and an attack vector of NETWORK. It is exploitable with privileges required of LOW.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to TA0006, TA0010, TA0023, and TA0034.", "Technical Details": "The vulnerability occurs when the library generates a third-party block request without verifying the authenticity of the request, allowing an attacker to forge a block request with the public key of the previous block.", "Detection": "Detection methods include signature-based detection and behavior-based detection.", "Mitigation": "Mitigation strategies include enforcing proper token transfer and validation, verifying the trustworthiness assessment, and validating the public key in the block request.", "Conclusion": "In conclusion, CVE-2024-41948 is a vulnerability that allows an attacker to generate a trusted block without transferring the token, leading to incorrect public key interning and potential trustworthiness assessments. It is recommended to update the Biscuit-Java library to the latest version and implement proper mitigation strategies."}, "executive_analysis": {"Overview": "CVE-2024-41948 is a vulnerability in the Biscuit-Java library that allows an attacker to generate a trusted block without transferring the token, leading to incorrect public key interning and potential trustworthiness assessments.", "Business Impact": "The vulnerability can lead to financial loss and reputational damage if not addressed promptly.", "Technical Impact": "The vulnerability can lead to unauthorized access and data breaches if exploited.", "Mitigation Strategies": "Implement proper token transfer and validation, verify the trustworthiness assessment, and validate the public key in the block request.", "Recommendations": "Recommendations include updating the Biscuit-Java library to the latest version, implementing proper mitigation strategies, and conducting regular security audits.", "Conclusions": "In conclusion, CVE-2024-41948 is a vulnerability that requires immediate attention and action to prevent exploitation."}}