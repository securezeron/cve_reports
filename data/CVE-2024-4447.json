{"id": "CVE-2024-4447", "sourceIdentifier": "security@dotcms.com", "published": "2024-07-26T02:15:10.160", "lastModified": "2024-07-26T14:15:03.287", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the System \u2192 Maintenance tool, the Logged Users tab surfaces sessionId data for all users via the Direct Web Remoting API (UserSessionAjax.getSessionList.dwr) calls. While this is information that would and should be available to admins who possess \"Sign In As\" powers, admins who otherwise lack this privilege would still be able to utilize the session IDs to imitate other users.\n\n\nWhile this is a very small attack vector that requires very high permissions to execute, its danger lies principally in obfuscating attribution; all Sign In As operations are attributed appropriately in the log files, and a malicious administrator could use this information to render their dealings untraceable \u2014 including those admins who have not been granted this ability \u2014 such as by using a session ID to generate an API token.\n\nFixed in:\u00a024.07.12 / 23.01.20 LTS / 23.10.24v13 LTS / 24.04.24v5 LTS"}, {"lang": "es", "value": "En System ? Maintenance tool, la pesta\u00f1a Logged Users muestra datos de ID de sesi\u00f3n para todos los usuarios a trav\u00e9s de las llamadas Direct Web Remoting API (UserSessionAjax.getSessionList.dwr). Si bien esta es informaci\u00f3n que estar\u00eda y deber\u00eda estar disponible para los administradores que poseen poderes de \"Sign In As\", los administradores que de otro modo carecer\u00edan de este privilegio a\u00fan podr\u00edan utilizar las ID de sesi\u00f3n para imitar a otros usuarios. Si bien se trata de un vector de ataque muy peque\u00f1o que requiere permisos muy elevados para su ejecuci\u00f3n, su peligro radica principalmente en ofuscar la atribuci\u00f3n; todas las operaciones de Sign In As se atribuyen adecuadamente en los archivos de registro, y un administrador malintencionado podr\u00eda usar esta informaci\u00f3n para hacer que sus transacciones sean imposibles de rastrear (incluidos aquellos administradores a quienes no se les ha otorgado esta capacidad), como mediante el uso de una ID de sesi\u00f3n para generar un token API. . Corregido en: 24.07.12 / 23.01.20 LTS / 23.10.24v13 LTS / 24.04.24v5 LTS"}], "metrics": {"cvssMetricV31": [{"source": "security@dotcms.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@dotcms.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-863"}]}], "references": [{"url": "https://www.dotcms.com/security/SI-72", "source": "security@dotcms.com"}], "techniques": [{"techniqueID": "T1505: Execution", "comment": "CVE-2024-4447 - An attacker could execute system commands by impersonating other users using the session IDs obtained from the Logged Users tab. Defend against this by implementing strict access controls and user authentication."}, {"techniqueID": "T1047: Windows Remote Services", "comment": "CVE-2024-4447 - The vulnerability could be exploited by using the Direct Web Remoting API to obtain session IDs and then use them to generate API tokens. Defend against this by blocking unused APIs and implementing strong authentication."}, {"techniqueID": "T1078: Exploitation of Remote Services", "comment": "CVE-2024-4447 - The vulnerability allows attackers to exploit remote services, such as API tokens. Defend against this by implementing strong authentication and rate limiting for API calls."}, {"techniqueID": "T1140: Deobiafuscation via System Command", "comment": "CVE-2024-4447 - Attackers could use system commands to deobfuscate and analyze the system, further compromising security. Defend against this by implementing strict access controls and monitoring system logs."}], "stix_bundle": {"@type": "Bundle", "type": "bundle", "id": "https://example.com/cve-2024-4447", "name": "CVE-2024-4447 Bundle", "description": "STIX 2.1 bundle for CVE-2024-4447", "created_by_ref": "https://example.com/user-1", "created": "2024-07-27T14:15:10.160", "modified": "2024-07-27T14:15:10.160", "objects": [{"@type": "Logical", "type": "logical", "id": "https://example.com/vulnerability-1", "name": "CVE-2024-4447", "description": "Vulnerability CVE-2024-4447"}, {"@type": "Tactic", "type": "tactic", "id": "https://example.com/tactic-1", "name": "User Impersonation"}, {"@type": "Technique", "type": "technique", "id": "https://example.com/technique-1", "name": "Execution"}, {"@type": "Analysis", "type": "analysis", "id": "https://example.com/analysis-1", "name": "Vulnerability Analysis"}, {"@type": "Indicator", "type": "indicator", "id": "https://example.com/indicator-1", "name": "Invalid API Token"}], "relationships": [{"source_ref": "https://example.com/vulnerability-1", "target_ref": "https://example.com/tactic-1", "relationship_type": "Vulnerability-Uses-Tactic"}, {"source_ref": "https://example.com/tactic-1", "target_ref": "https://example.com/technique-1", "relationship_type": "Tactic-Uses-Technique"}, {"source_ref": "https://example.com/technique-1", "target_ref": "https://example.com/analysis-1", "relationship_type": "Technique-Described-in-Analysis"}]}, "technical_analysis": {"Introduction": "CVE-2024-4447 is a vulnerability in the System Maintenance tool in DotCMS that allows attackers to impersonate other users by obtaining session IDs.", "Impact and Scope": "The vulnerability has a CVSS score of 4.9 and an attack vector of NETWORK. It can be exploited by attackers to obtain session IDs and use them to generate API tokens.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK T1505: Execution, T1047: Windows Remote Services, T1078: Exploitation of Remote Services, and T1140: Deobiafuscation via System Command.", "Technical Details": "The vulnerability is caused by the fact that the System Maintenance tool allows users to obtain session IDs for other users, which can then be used to impersonate those users.", "Detection": "Detection of this vulnerability requires monitoring system logs for unusual activity and checking for session IDs being obtained from the Logged Users tab.", "Mitigation": "Mitigation strategies include implementing strict access controls and user authentication, blocking unused APIs, and implementing strong authentication and rate limiting for API calls.", "Conclusion": "In conclusion, CVE-2024-4447 is a vulnerability in the System Maintenance tool in DotCMS that allows attackers to impersonate other users by obtaining session IDs. Detection and mitigation strategies are key to preventing this type of attack."}, "executive_analysis": {"Overview": "DotCMS has announced a vulnerability in the System Maintenance tool that allows attackers to impersonate other users, which could compromise the security of the system.", "Business Impact": "The vulnerability could allow attackers to obtain sensitive information and compromise the confidentiality, integrity, and availability of the system.", "Technical Impact": "The vulnerability is caused by the fact that the System Maintenance tool allows users to obtain session IDs for other users, which can then be used to impersonate those users.", "Mitigation Strategies": "Mitigation strategies include implementing strict access controls and user authentication, blocking unused APIs, and implementing strong authentication and rate limiting for API calls.", "Recommendations": "We recommend that all affected systems be updated to the latest version and that strict access controls and user authentication be implemented.", "Conclusions": "In conclusion, CVE-2024-4447 is a serious vulnerability that affects the security of the System Maintenance tool in DotCMS. A swift and effective response is necessary to prevent this type of attack."}}