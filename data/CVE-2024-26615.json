{"id": "CVE-2024-26615", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-03-11T18:15:19.337", "lastModified": "2024-06-27T12:15:18.830", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/smc: fix illegal rmb_desc access in SMC-D connection dump\n\nA crash was found when dumping SMC-D connections. It can be reproduced\nby following steps:\n\n- run nginx/wrk test:\n  smc_run nginx\n  smc_run wrk -t 16 -c 1000 -d <duration> -H 'Connection: Close' <URL>\n\n- continuously dump SMC-D connections in parallel:\n  watch -n 1 'smcss -D'\n\n BUG: kernel NULL pointer dereference, address: 0000000000000030\n CPU: 2 PID: 7204 Comm: smcss Kdump: loaded Tainted: G\tE      6.7.0+ #55\n RIP: 0010:__smc_diag_dump.constprop.0+0x5e5/0x620 [smc_diag]\n Call Trace:\n  <TASK>\n  ? __die+0x24/0x70\n  ? page_fault_oops+0x66/0x150\n  ? exc_page_fault+0x69/0x140\n  ? asm_exc_page_fault+0x26/0x30\n  ? __smc_diag_dump.constprop.0+0x5e5/0x620 [smc_diag]\n  ? __kmalloc_node_track_caller+0x35d/0x430\n  ? __alloc_skb+0x77/0x170\n  smc_diag_dump_proto+0xd0/0xf0 [smc_diag]\n  smc_diag_dump+0x26/0x60 [smc_diag]\n  netlink_dump+0x19f/0x320\n  __netlink_dump_start+0x1dc/0x300\n  smc_diag_handler_dump+0x6a/0x80 [smc_diag]\n  ? __pfx_smc_diag_dump+0x10/0x10 [smc_diag]\n  sock_diag_rcv_msg+0x121/0x140\n  ? __pfx_sock_diag_rcv_msg+0x10/0x10\n  netlink_rcv_skb+0x5a/0x110\n  sock_diag_rcv+0x28/0x40\n  netlink_unicast+0x22a/0x330\n  netlink_sendmsg+0x1f8/0x420\n  __sock_sendmsg+0xb0/0xc0\n  ____sys_sendmsg+0x24e/0x300\n  ? copy_msghdr_from_user+0x62/0x80\n  ___sys_sendmsg+0x7c/0xd0\n  ? __do_fault+0x34/0x160\n  ? do_read_fault+0x5f/0x100\n  ? do_fault+0xb0/0x110\n  ? __handle_mm_fault+0x2b0/0x6c0\n  __sys_sendmsg+0x4d/0x80\n  do_syscall_64+0x69/0x180\n  entry_SYSCALL_64_after_hwframe+0x6e/0x76\n\nIt is possible that the connection is in process of being established\nwhen we dump it. Assumed that the connection has been registered in a\nlink group by smc_conn_create() but the rmb_desc has not yet been\ninitialized by smc_buf_create(), thus causing the illegal access to\nconn->rmb_desc. So fix it by checking before dump."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: net/smc: corrige el acceso ilegal a rmb_desc en el volcado de conexiones SMC-D Se encontr\u00f3 un bloqueo al volcar conexiones SMC-D. Se puede reproducir mediante los siguientes pasos: - ejecute la prueba nginx/wrk: smc_run nginx smc_run wrk -t 16 -c 1000 -d  -H 'Conexi\u00f3n: Cerrar'  - volcar continuamente las conexiones SMC-D en paralelo: watch -n 1 'smcss -D' ERROR: desreferencia del puntero NULL del kernel, direcci\u00f3n: 00000000000000030 CPU: 2 PID: 7204 Comm: smcss Kdump: cargado Contaminado: GE 6.7.0+ #55 RIP: 0010:__smc_diag_dump.constprop.0+ 0x5e5/0x620 [smc_diag] Seguimiento de llamadas: ? __morir+0x24/0x70 ? page_fault_oops+0x66/0x150? exc_page_fault+0x69/0x140? asm_exc_page_fault+0x26/0x30? __smc_diag_dump.constprop.0+0x5e5/0x620 [smc_diag] ? __kmalloc_node_track_caller+0x35d/0x430 ? __alloc_skb+0x77/0x170 smc_diag_dump_proto+0xd0/0xf0 [smc_diag] smc_diag_dump+0x26/0x60 [smc_diag] netlink_dump+0x19f/0x320 __netlink_dump_start+0x1dc/0x300 smc_diag_handler_dump+ 0x6a/0x80 [smc_diag] ? __pfx_smc_diag_dump+0x10/0x10 [smc_diag] sock_diag_rcv_msg+0x121/0x140 ? __pfx_sock_diag_rcv_msg+0x10/0x10 netlink_rcv_skb+0x5a/0x110 sock_diag_rcv+0x28/0x40 netlink_unicast+0x22a/0x330 netlink_sendmsg+0x1f8/0x420 __sock_sendmsg+0xb0/0xc0 ____s ys_sendmsg+0x24e/0x300? copy_msghdr_from_user+0x62/0x80 ___sys_sendmsg+0x7c/0xd0 ? __do_fault+0x34/0x160? do_read_fault+0x5f/0x100? do_fault+0xb0/0x110? __handle_mm_fault+0x2b0/0x6c0 __sys_sendmsg+0x4d/0x80 do_syscall_64+0x69/0x180 Entry_SYSCALL_64_after_hwframe+0x6e/0x76 Es posible que la conexi\u00f3n est\u00e9 en proceso de establecerse cuando la volcamos. Se supone que la conexi\u00f3n ha sido registrada en un grupo de enlaces por smc_conn_create() pero rmb_desc a\u00fan no ha sido inicializado por smc_buf_create(), lo que provoca el acceso ilegal a conn-&gt;rmb_desc. As\u00ed que solucionelo comprobando antes del volcado."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/1fea9969b81c67d0cb1611d1b8b7d19049d937be", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/27aea64838914c6122db5b8bd4bed865c9736f22", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5fed92ca32eafbfae8b6bee8ca34cca71c6a8b6d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/68b888d51ac82f2b96bf5e077a31d76afcdef25a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6994dba06321e3c48fdad0ba796a063d9d82183a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8f3f9186e5bb96a9c9654c41653210e3ea7e48a6", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/a164c2922675d7051805cdaf2b07daffe44f20d9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/dbc153fd3c142909e564bb256da087e13fbf239c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1003", "comment": "CVE-2024-26615 - An attacker can exploit a kernel vulnerability to gain unauthorized access to a system. This can be achieved by dumping a connection's details, which can lead to a kernel NULL pointer dereference. Defenders can mitigate this by implementing robust connection handling and validation mechanisms."}, {"techniqueID": "T1040", "comment": "CVE-2024-26615 - An attacker can exploit a kernel vulnerability to gain unauthorized access to a system. This can be achieved by dumping a connection's details, which can lead to a kernel NULL pointer dereference. Defenders can mitigate this by implementing robust connection handling and validation mechanisms."}], "stix_bundle": {"stix": {"Identity": {"ID": "bundle:CVE-2024-26615", "name": "CVE-2024-26615", "description": "CVE-2024-26615 - Linux kernel vulnerability", "created_by_ref": "https://github.com/mitre/cti", "modified": "2024-06-27T12:15:18.830", "labels": ["CVE", "Kernel", "Linux"]}, "Indicator": [{"ID": "indicator:CVE-2024-26615.1", "name": "CVE-2024-26615", "description": "Linux kernel vulnerability - SMC-D connection dump", "created_by_ref": "https://github.com/mitre/cti", "modified": "2024-06-27T12:15:18.830", "labels": ["CVE", "Kernel", "Linux"]}], "Tactic": [{"ID": "tactic:TA0010", "name": "TA0010 - Initial Access", "description": "An attacker gains initial access to a system", "created_by_ref": "https://github.com/mitre/cti", "modified": "2024-06-27T12:15:18.830", "labels": ["Tactic", "Initial Access"]}, {"ID": "tactic:TA0020", "name": "TA0020 - Execution", "description": "An attacker executes code on a system", "created_by_ref": "https://github.com/mitre/cti", "modified": "2024-06-27T12:15:18.830", "labels": ["Tactic", "Execution"]}], "Course_of_Action": [{"ID": "course_of_action:CVE-2024-26615.1", "name": "CVE-2024-26615 - Apply kernel patch", "description": "Apply kernel patch to resolve vulnerability", "created_by_ref": "https://github.com/mitre/cti", "modified": "2024-06-27T12:15:18.830", "labels": ["Course of Action", "Kernel Patch"]}], "Note": [{"ID": "note:CVE-2024-26615.1", "name": "CVE-2024-26615 - Defense", "description": "Implement robust connection handling and validation mechanisms to defend against the vulnerability", "created_by_ref": "https://github.com/mitre/cti", "modified": "2024-06-27T12:15:18.830", "labels": ["Note", "Defense"]}]}}, "technical_analysis": {"Introduction": "The CVE-2024-26615 is a Linux kernel vulnerability that allows an attacker to dump a connection's details, leading to a kernel NULL pointer dereference.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to gain unauthorized access to a system. The scope is system-wide, affecting all systems running the affected kernel version.", "Related MITRE ATT&CK Techniques": "T1003, T1040", "Technical Details": "The vulnerability occurs when dumping a connection's details, which can lead to a kernel NULL pointer dereference.", "Detection": "Detection of this vulnerability is challenging, as it requires monitoring system calls and network traffic.", "Mitigation": "To mitigate this vulnerability, implement robust connection handling and validation mechanisms.", "Conclusion": "In conclusion, the CVE-2024-26615 is a serious vulnerability that requires immediate attention. Implementing robust connection handling and validation mechanisms can help to defend against this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-26615 is a high-severity vulnerability that affects Linux kernels.", "Business Impact": "The impact of this vulnerability is significant, as it can lead to unauthorized access to systems and data.", "Technical Impact": "The technical impact is high, as it requires immediate attention and can lead to system instability.", "Mitigation Strategies": "Apply kernel patch to resolve vulnerability.", "Recommendations": "Recommendations include applying the kernel patch, implementing robust connection handling and validation mechanisms, and monitoring system calls and network traffic.", "Conclusions": "In conclusion, the CVE-2024-26615 is a serious vulnerability that requires immediate attention and action."}}