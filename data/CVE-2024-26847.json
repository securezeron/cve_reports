{"id": "CVE-2024-26847", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-17T11:15:08.273", "lastModified": "2024-04-17T12:48:07.510", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc/rtas: use correct function name for resetting TCE tables\n\nThe PAPR spec spells the function name as\n\n  \"ibm,reset-pe-dma-windows\"\n\nbut in practice firmware uses the singular form:\n\n  \"ibm,reset-pe-dma-window\"\n\nin the device tree. Since we have the wrong spelling in the RTAS\nfunction table, reverse lookups (token -> name) fail and warn:\n\n  unexpected failed lookup for token 86\n  WARNING: CPU: 1 PID: 545 at arch/powerpc/kernel/rtas.c:659 __do_enter_rtas_trace+0x2a4/0x2b4\n  CPU: 1 PID: 545 Comm: systemd-udevd Not tainted 6.8.0-rc4 #30\n  Hardware name: IBM,9105-22A POWER10 (raw) 0x800200 0xf000006 of:IBM,FW1060.00 (NL1060_028) hv:phyp pSeries\n  NIP [c0000000000417f0] __do_enter_rtas_trace+0x2a4/0x2b4\n  LR [c0000000000417ec] __do_enter_rtas_trace+0x2a0/0x2b4\n  Call Trace:\n   __do_enter_rtas_trace+0x2a0/0x2b4 (unreliable)\n   rtas_call+0x1f8/0x3e0\n   enable_ddw.constprop.0+0x4d0/0xc84\n   dma_iommu_dma_supported+0xe8/0x24c\n   dma_set_mask+0x5c/0xd8\n   mlx5_pci_init.constprop.0+0xf0/0x46c [mlx5_core]\n   probe_one+0xfc/0x32c [mlx5_core]\n   local_pci_probe+0x68/0x12c\n   pci_call_probe+0x68/0x1ec\n   pci_device_probe+0xbc/0x1a8\n   really_probe+0x104/0x570\n   __driver_probe_device+0xb8/0x224\n   driver_probe_device+0x54/0x130\n   __driver_attach+0x158/0x2b0\n   bus_for_each_dev+0xa8/0x120\n   driver_attach+0x34/0x48\n   bus_add_driver+0x174/0x304\n   driver_register+0x8c/0x1c4\n   __pci_register_driver+0x68/0x7c\n   mlx5_init+0xb8/0x118 [mlx5_core]\n   do_one_initcall+0x60/0x388\n   do_init_module+0x7c/0x2a4\n   init_module_from_file+0xb4/0x108\n   idempotent_init_module+0x184/0x34c\n   sys_finit_module+0x90/0x114\n\nAnd oopses are possible when lockdep is enabled or the RTAS\ntracepoints are active, since those paths dereference the result of\nthe lookup.\n\nUse the correct spelling to match firmware's behavior, adjusting the\nrelated constants to match."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: powerpc/rtas: use el nombre de funci\u00f3n correcto para restablecer las tablas TCE La especificaci\u00f3n PAPR escribe el nombre de la funci\u00f3n como \"ibm,reset-pe-dma-windows\" pero en la pr\u00e1ctica el firmware usa el singular formulario: \"ibm,reset-pe-dma-window\" en el \u00e1rbol de dispositivos. Dado que tenemos una ortograf\u00eda incorrecta en la tabla de funciones RTAS, las b\u00fasquedas inversas (token -&gt; nombre) fallan y advierten: b\u00fasqueda fallida inesperada del token 86 ADVERTENCIA: CPU: 1 PID: 545 en arch/powerpc/kernel/rtas.c:659 __do_enter_rtas_trace+0x2a4/0x2b4 cpu: 1 pid: 545 com: systemd-udevd no contaminado 6.8.0-rc4 #30 Nombre de hardware: IBM, 9105-22A Power10 (RAW) 0x800200 0xf000006 de: IBM, FW1060.00 (NL10606060) :phyp pSeries NIP [c0000000000417f0] __do_enter_rtas_trace+0x2a4/0x2b4 LR [c0000000000417ec] __do_enter_rtas_trace+0x2a0/0x2b4 Seguimiento de llamadas: __do_enter_rtas_trace+0x2a0/0x2b4 (no confiable) tas_call+0x1f8/0x3e0 enable_ddw.constprop.0+0x4d0/0xc84 dma_iommu_dma_supported+0xe8/ 0x24c dma_set_mask+0x5c/0xd8 mlx5_pci_init.constprop.0+0xf0/0x46c [mlx5_core] probe_one+0xfc/0x32c [mlx5_core] local_pci_probe+0x68/0x12c pci_call_probe+0x68/0x1ec pci_device_probe+0xbc /0x1a8 realmente_probe+0x104/0x570 __driver_probe_device+0xb8/ 0x224 driver_probe_device+0x54/0x130 __driver_attach+0x158/0x2b0 bus_for_each_dev+0xa8/0x120 driver_attach+0x34/0x48 bus_add_driver+0x174/0x304 driver_register+0x8c/0x1c4 __pci_register_driver+0x68 /0x7c mlx5_init+0xb8/0x118 [mlx5_core] do_one_initcall+0x60/0x388 do_init_module +0x7c/0x2a4 init_module_from_file+0xb4/0x108 idempotent_init_module+0x184/0x34c sys_finit_module+0x90/0x114 Y es posible que haya errores cuando lockdep est\u00e1 habilitado o los puntos de seguimiento RTAS est\u00e1n activos, ya que esas rutas eliminan la referencia al resultado de la b\u00fasqueda. Utilice la ortograf\u00eda correcta para que coincida con el comportamiento del firmware, ajustando las constantes relacionadas para que coincidan."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/6b6282d56b14879124416a23837af9bd52ae2dfb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/dd63817baf334888289877ab1db1d866af2a6479", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/fad87dbd48156ab940538f052f1820f4b6ed2819", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1124", "comment": "CVE-2024-26847 - Use of incorrect function name for resetting TCE tables, leading to potential data exposure. This technique can be used to bypass security controls and gain unauthorized access."}, {"techniqueID": "T1518", "comment": "CVE-2024-26847 - Firmware modifications can be used to exploit this vulnerability. This technique can lead to data exfiltration and unauthorized access."}], "stix_bundle": {"type": "bundled-observables", "id": "https://example.com/stix-bundle/cve-2024-26847", "created": "2024-04-18T14:30:00.000Z", "modified": "2024-04-18T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "https://example.com/stix-bundle/cve-2024-26847/vulnerability", "name": "CVE-2024-26847", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc/rtas: use correct function name for resetting TCE tables"}, {"type": "ttp", "id": "https://example.com/stix-bundle/cve-2024-26847/ttp/t1124", "name": "TTP: Use of incorrect function name for resetting TCE tables", "description": "Use of incorrect function name for resetting TCE tables, leading to potential data exposure."}, {"type": "ttp", "id": "https://example.com/stix-bundle/cve-2024-26847/ttp/t1518", "name": "TTP: Firmware modifications", "description": "Firmware modifications can be used to exploit this vulnerability, leading to data exfiltration and unauthorized access."}, {"type": " course-of-action", "id": "https://example.com/stix-bundle/cve-2024-26847/course-of-action/patch-application", "name": "Patch Application", "description": "Apply the patch provided by the Linux kernel developers to resolve this vulnerability."}, {"type": " course-of-action", "id": "https://example.com/stix-bundle/cve-2024-26847/course-of-action/logs-monitoring", "name": "Logs Monitoring", "description": "Monitor system logs for any signs of exploitation, such as unusual network traffic or system behavior."}], " relations": [{"from": "https://example.com/stix-bundle/cve-2024-26847/vulnerability", "to": "https://example.com/stix-bundle/cve-2024-26847/ttp/t1124", " relationship": "Exploits"}, {"from": "https://example.com/stix-bundle/cve-2024-26847/vulnerability", "to": "https://example.com/stix-bundle/cve-2024-26847/ttp/t1518", "relationship": "Exploited-By"}, {"from": "https://example.com/stix-bundle/cve-2024-26847/course-of-action/patch-application", "to": "https://example.com/stix-bundle/cve-2024-26847/ttp/t1124", "relationship": "Mitigates"}, {"from": "https://example.com/stix-bundle/cve-2024-26847/course-of-action/logs-monitoring", "to": "https://example.com/stix-bundle/cve-2024-26847/ttp/t1518", "relationship": "Detects"}]}, "technical_analysis": {"Introduction": "CVE-2024-26847 is a vulnerability in the Linux kernel that allows attackers to exploit the powerpc/rtas: use correct function name for resetting TCE tables functionality.", "Impact and Scope": "This vulnerability allows an attacker to access and modify sensitive data, compromising the confidentiality and integrity of the system.", "Related MITRE ATT&CK Techniques": "T1124, T1518", "Technical Details": "The vulnerability arises from the incorrect function name being used for resetting TCE tables, allowing attackers to bypass security controls and gain unauthorized access.", "Detection": "Monitor system logs for any signs of exploitation, such as unusual network traffic or system behavior.", "Mitigation": "Apply the patch provided by the Linux kernel developers to resolve this vulnerability.", "Conclusion": "CVE-2024-26847 is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-26847 is a vulnerability in the Linux kernel that poses a significant risk to system security and data confidentiality.", "Business Impact": "The exploitation of this vulnerability can lead to data breaches and unauthorized access to sensitive information, potentially causing significant financial and reputational harm to the organization.", "Technical Impact": "The vulnerability allows attackers to bypass security controls and gain unauthorized access to the system, compromising the confidentiality and integrity of the data.", "Mitigation Strategies": "Apply the patch provided by the Linux kernel developers, monitor system logs for any signs of exploitation, and implement additional security controls to prevent unauthorized access.", "Recommendations": "Organizations that rely on Linux kernel-based systems should review their systems immediately and apply the patch to prevent exploitation.", "Conclusions": "CVE-2024-26847 is a critical vulnerability that requires immediate attention and mitigation. Organizations must take proactive steps to protect their systems and data from this threat."}}