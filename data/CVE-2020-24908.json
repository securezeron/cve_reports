{"id": "CVE-2020-24908", "sourceIdentifier": "cve@mitre.org", "published": "2021-02-19T06:15:12.510", "lastModified": "2024-07-23T19:37:16.630", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Checkmk before 1.6.0p17 allows local users to obtain SYSTEM privileges via a Trojan horse shell script in the %PROGRAMDATA%\\checkmk\\agent\\local directory."}, {"lang": "es", "value": "Checkmk versiones anteriores a 1.6.0p17, permite a usuarios locales alcanzar privilegios SYSTEM por medio de un script de shell de tipo caballo de Troya en el directorio %PROGRAMDATA%\\checkmk\\agent\\local"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.6.0", "matchCriteriaId": "706DB623-2336-4C3A-8393-CC7C1C71A1F0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:-:*:*:*:*:*:*", "matchCriteriaId": "5D63367A-3B90-462E-B6AD-1CB5721FD45E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p1:*:*:*:*:*:*", "matchCriteriaId": "30F84B89-7EC6-44E6-A164-4C170379D55C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p10:*:*:*:*:*:*", "matchCriteriaId": "DDA94D2F-F27C-4DF6-84AE-8ED1BBC7F61E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p11:*:*:*:*:*:*", "matchCriteriaId": "71CF8EFD-17F6-4D9A-961A-4B949A6C8B61"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p12:*:*:*:*:*:*", "matchCriteriaId": "B04DC2A8-CF05-4FB2-AE2F-AE07943B998D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p13:*:*:*:*:*:*", "matchCriteriaId": "1F3BECA6-983C-436E-A635-4E1FB9080E56"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p14:*:*:*:*:*:*", "matchCriteriaId": "51A9A2B4-3693-490A-94E2-64E1DB795646"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p15:*:*:*:*:*:*", "matchCriteriaId": "C14AB385-8A9F-46FA-A1C5-4A4A45C1B7F5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p16:*:*:*:*:*:*", "matchCriteriaId": "EC41CC5F-F088-4E65-B076-35665F0F6C7E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p2:*:*:*:*:*:*", "matchCriteriaId": "D49B1D63-8FDD-45FD-99F0-AA9E4FBCCB00"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p3:*:*:*:*:*:*", "matchCriteriaId": "9CCE5845-1B77-4E97-B508-41400F4E1F31"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p4:*:*:*:*:*:*", "matchCriteriaId": "3FCED94F-7683-40FE-B511-F1F49CDD1F73"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p5:*:*:*:*:*:*", "matchCriteriaId": "0C4E70EC-3D46-40CE-AD59-597EFD721014"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p6:*:*:*:*:*:*", "matchCriteriaId": "12E695A8-9A1E-4D7A-AB3B-AAC2CF777773"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p7:*:*:*:*:*:*", "matchCriteriaId": "653632A8-E700-404A-ADB2-B3A50253ECB0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p8:*:*:*:*:*:*", "matchCriteriaId": "60733789-DDA3-4819-A9F1-70B76AC715CB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:1.6.0:p9:*:*:*:*:*:*", "matchCriteriaId": "D90DBA66-EF97-4CE9-AD4C-3A82F70D2250"}]}]}], "references": [{"url": "https://compass-security.com/fileadmin/Research/Advisories/2020-05_CSNC-2020-005_Checkmk_Local_Privilege_Escalation.txt", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1078", "comment": "CVE-2020-24908 - This vulnerability allows local users to escalate privileges on Checkmk systems by leveraging a Trojan horse shell script. It is an example of a file discovery and execution vulnerability, showcasing the importance of code review and testing in privilege escalation attacks."}], "stix_bundle": {"type": "bundled-observable", "spec_version": "2.1", "id": "https://example.com/cve-2020-24908", "created_by_ref": "https://example.com/created_by", "modified": "2024-07-23T19:37:16.630", "created": "2021-02-19T06:15:12.510", "description": "Checkmk before 1.6.0p17 allows local users to obtain SYSTEM privileges via a Trojan horse shell script in the %PROGRAMDATA%\\checkmk\\agent\\local directory.", "generated_warning": "This bundle was generated by a tool, any further modifications may affect its accuracy.", "objects": [{"type": "vulnerability", "id": "https://example.com/cve-2020-24908", "modified": "2024-07-23T19:37:16.630", "created": "2021-02-19T06:15:12.510", "description": "Checkmk before 1.6.0p17 allows local users to obtain SYSTEM privileges via a Trojan horse shell script in the %PROGRAMDATA%\\checkmk\\agent\\local directory.", "cvss": {"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "version": "3.1"}}, {"type": "observable", "id": "https://example.com/observable-2020-24908", "modified": "2024-07-23T19:37:16.630", "created": "2021-02-19T06:15:12.510", "description": "Trojan horse shell script in the %PROGRAMDATA%\\checkmk\\agent\\local directory", "observable_types": ["file"], "x_opencti_external_references": [{"source_name": "cve@mitre.org", "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-24908", "external_id": "CVE-2020-24908"}]}], "relationships": [{"type": "has-part", "id": "https://example.com/cve-2020-24908-part-1", "target_id": "https://example.com/observable-2020-24908"}]}, "technical_analysis": {"Introduction": "Checkmk is a popular network monitoring and management system that provides a comprehensive set of tools for monitoring, troubleshooting, and maintaining network infrastructure.", "Impact and Scope": "The CVE-2020-24908 vulnerability allows local users to escalate privileges on Checkmk systems by leveraging a Trojan horse shell script in the %PROGRAMDATA%\\checkmk\\agent\\local directory. The affected systems are vulnerable to privilege escalation, allowing attackers to gain SYSTEM privileges.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the T1078 technique (Software Installation) and the T1133 technique (File and Directory Discovery) in the MITRE ATT&CK Framework.", "Technical Details": "The vulnerability is caused by a lack of proper input validation and sanitization, allowing an attacker to inject shell code into the system.", "Detection": "Detection of this vulnerability involves monitoring for suspicious file access and modification activities, as well as identifying and blocking suspicious network traffic.", "Mitigation": "Mitigating this vulnerability requires applying the latest security patches, ensuring proper configuration of Checkmk systems, and implementing robust security monitoring and incident response practices.", "Conclusion": "In conclusion, the CVE-2020-24908 vulnerability highlights the importance of secure coding practices and regular security testing and validation in the development of network monitoring and management systems."}, "executive_analysis": {"Overview": "The CVE-2020-24908 vulnerability is a significant threat to the security of Checkmk systems, allowing attackers to escalate privileges and gain unauthorized access.", "Business Impact": "A successful exploitation of this vulnerability could result in the unauthorized access and control of affected systems, resulting in significant financial and reputational losses.", "Technical Impact": "The vulnerability has significant technical implications, as it allows attackers to gain SYSTEM privileges and execute arbitrary code.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability include applying the latest security patches, ensuring proper configuration of Checkmk systems, and implementing robust security monitoring and incident response practices.", "Recommendations": "Executives are recommended to prioritize the patching and configuration of Checkmk systems, as well as implementing robust security monitoring and incident response practices to detect and respond to potential attacks.", "Conclusions": "In conclusion, the CVE-2020-24908 vulnerability is a significant threat that requires immediate attention and action from executives, IT teams, and system administrators."}}