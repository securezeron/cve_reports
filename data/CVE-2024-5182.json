{"id": "CVE-2024-5182", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-20T00:15:09.487", "lastModified": "2024-08-27T17:30:21.127", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A path traversal vulnerability exists in mudler/localai version 2.14.0, where an attacker can exploit the `model` parameter during the model deletion process to delete arbitrary files. Specifically, by crafting a request with a manipulated `model` parameter, an attacker can traverse the directory structure and target files outside of the intended directory, leading to the deletion of sensitive data. This vulnerability is due to insufficient input validation and sanitization of the `model` parameter."}, {"lang": "es", "value": "Existe una vulnerabilidad de path traversal en mudler/localai versi\u00f3n 2.14.0, donde un atacante puede explotar el par\u00e1metro `model` durante el proceso de eliminaci\u00f3n del modelo para eliminar archivos arbitrarios. Espec\u00edficamente, al elaborar una solicitud con un par\u00e1metro \"modelo\" manipulado, un atacante puede atravesar la estructura del directorio y apuntar a archivos fuera del directorio deseado, lo que lleva a la eliminaci\u00f3n de datos confidenciales. Esta vulnerabilidad se debe a una validaci\u00f3n de entrada y una sanitizaci\u00f3n insuficientes del par\u00e1metro \"modelo\"."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mudler:localai:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.16.0", "matchCriteriaId": "82A38415-0349-46CD-850C-677CDDDC7DAD"}]}]}], "references": [{"url": "https://github.com/mudler/localai/commit/1a3dedece06cab1acc3332055d285ac540a47f0e", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.com/bounties/f7a87f29-c22a-48e8-9fce-b6d5a273e545", "source": "security@huntr.dev", "tags": ["Exploit", "Issue Tracking", "Patch"]}], "techniques": [{"techniqueID": "T1228", "comment": "Using reconnaissance to gather information about the target system, allowing the attacker to identify potential vulnerabilities to exploit. CWE-22, 'Path Traversal', is used to traverse the directory structure and target files outside of the intended directory, allowing the attacker to delete sensitive data. CVE-2024-5182 is a prime example of this technique."}, {"techniqueID": "T1190", "comment": "Using a Web Shell to interact with the target system, allowing the attacker to delete files with arbitrary paths. CWE-22, 'Path Traversal', is used to provide the web shell with the necessary information to achieve this goal. "}, {"techniqueID": "T1087", "comment": "T1087, 'Windows Service Execution', is not directly applicable to this vulnerability, but it could be used in combination with CWE-22, 'Path Traversal', to deleted files with arbitrary paths."}, {"techniqueID": "T1229", "comment": "Using an exploit to execute code on the target system, allowing the attacker to deliver a Web Shell to delete files. CWE-22, 'Path Traversal', is used to provide the necessary information for the exploit to successfully delete files."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2024-5182", "title": "Path Traversal Vulnerability in mudler/localai", "description": "A path traversal vulnerability exists in mudler/localai version 2.14.0, where an attacker can exploit the `model` parameter during the model deletion process to delete arbitrary files.", "mitre_ tactics": [{"id": "T1228", "label": "Web Service Attacks", "description": "Using reconnaissance to gather information about the target system, allowing the attacker to identify potential vulnerabilities to exploit."}, {"id": "T1190", "label": "Exploit Public-Facing Application", "description": "Using a Web Shell to interact with the target system, allowing the attacker to delete files with arbitrary paths."}, {"id": "T1087", "label": "Windows Service Execution", "description": "Executing Windows services to gain a foothold on the target system."}, {"id": "T1229", "label": "Exploit Public-Facing Application", "description": "Using an exploit to execute code on the target system, allowing the attacker to deliver a Web Shell to delete files."}]}]}, "technical_analysis": {"Introduction": "The CVE-2024-5182 is a path traversal vulnerability in mudler/localai version 2.14.0, which allows an attacker to delete arbitrary files.", "Impact and Scope": "CVSS v3.1: 9.1, High, Network, Confidentiality: None, Integrity: High, Availability: High. CVSS v3.0: 7.5, High, Network, Confidentiality: None, Integrity: None, Availability: High.", "Related MITRE ATT&CK Techniques": "T1228, T1190, T1087, T1229.", "Technical Details": "The vulnerability occurs when the `model` parameter is not properly validated and sanitized, allowing an attacker to traverse the directory structure and target files outside of the intended directory.", "Detection": "Detection methods include monitoring system logs for unusual file deletion requests and implementing web application firewalls to block unauthorized access.", "Mitigation": "Mitigation strategies include updating to a patched version of mudler/localai, validating and sanitizing user input, and implementing rate limiting on file deletion requests.", "Conclusion": "The CVE-2024-5182 is a critical vulnerability that requires immediate attention and action to mitigate."}, "executive_analysis": {"Overview": "The CVE-2024-5182 is a critical path traversal vulnerability in mudler/localai version 2.14.0.", "Business Impact": "The vulnerability has the potential to compromise sensitive data and could lead to reputational damage and financial loss.", "Technical Impact": "The vulnerability allows an attacker to delete arbitrary files, which could be used to disrupt business operations and compromise confidentiality, integrity, and availability.", "Mitigation Strategies": "Implementing rate limiting on file deletion requests, validating and sanitizing user input, and updating to a patched version of mudler/localai are all effective mitigation strategies.", "Recommendations": "It is recommended that all organizations update to a patched version of mudler/localai and implement additional security measures to mitigate the risk of exploitation.", "Conclusions": "The CVE-2024-5182 is a critical vulnerability that requires immediate attention and action to mitigate the risk of exploitation."}}