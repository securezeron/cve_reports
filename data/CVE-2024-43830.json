{"id": "CVE-2024-43830", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-17T10:15:08.857", "lastModified": "2024-08-19T12:59:59.177", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nleds: trigger: Unregister sysfs attributes before calling deactivate()\n\nTriggers which have trigger specific sysfs attributes typically store\nrelated data in trigger-data allocated by the activate() callback and\nfreed by the deactivate() callback.\n\nCalling device_remove_groups() after calling deactivate() leaves a window\nwhere the sysfs attributes show/store functions could be called after\ndeactivation and then operate on the just freed trigger-data.\n\nMove the device_remove_groups() call to before deactivate() to close\nthis race window.\n\nThis also makes the deactivation path properly do things in reverse order\nof the activation path which calls the activate() callback before calling\ndevice_add_groups()."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: leds: trigger: Anular el registro de los atributos sysfs antes de llamar a desactivar() Los activadores que tienen atributos sysfs espec\u00edficos del activador normalmente almacenan datos relacionados en datos de activaci\u00f3n asignados por la devoluci\u00f3n de llamada enable() y liberados por el desactivar() devoluci\u00f3n de llamada. Llamar a device_remove_groups() despu\u00e9s de llamar a deactivate() deja una ventana donde los atributos sysfs muestran/almacenan funciones que se pueden llamar despu\u00e9s de la desactivaci\u00f3n y luego operar con los datos de activaci\u00f3n reci\u00e9n liberados. Mueva la llamada device_remove_groups() antes de desactivar() para cerrar esta ventana de ejecuci\u00f3n. Esto tambi\u00e9n hace que la ruta de desactivaci\u00f3n haga las cosas correctamente en orden inverso a la ruta de activaci\u00f3n que llama a la devoluci\u00f3n de llamada enable() antes de llamar a device_add_groups()."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0788a6f3523d3686a9eed5ea1e6fcce6841277b2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/09c1583f0e10c918855d6e7540a79461a353e5d6", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/3fb6a9d67cfd812a547ac73ec02e1077c26c640d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/734ba6437e80dfc780e9ee9d95f912392d12b5ea", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c0dc9adf9474ecb7106e60e5472577375aedaed3", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c3b7a650c8717aa89df318364609c86cbc040156", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/cb8aa9d2a4c8a15d6a43ccf901ef3d094aa60374", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d1415125b701ef13370e2761f691ec632a5eb93a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-43830 - This vulnerability is relevant to the 'Boot/Linux Start-Up' ATT&CK technique, where an attacker could exploit this vulnerability to achieve persistence on the system."}, {"techniqueID": "T1194", "comment": "CVE-2024-43830 - This vulnerability is also relevant to the 'Boot/Persistence' ATT&CK technique, as it provides a pathway for an attacker to maintain persistence on the system."}, {"techniqueID": "T1499", "comment": "CVE-2024-43830 - This vulnerability is relevant to the 'PostExploitation/Command And Control' ATT&CK technique, as it could be used to establish command and control channels for attacks."}], "stix_bundle": {"$schema": "https://raw.githubusercontent.com/oasis-open/cti-stix/v2.1/stix-2.1/stix-schema.json", "type": "bundle", "objects": [{"type": "indicator", "id": "indicator--C8C13142-4B23-4F3D-BEA2-3A4C58DD6D7D", "name": "CVE-2024-43830 Indicator", "description": "Indicator for CVE-2024-43830", "created_by_ref": "group--6A8B2A9E-AF8B-457F-AE1B-25C1E3E7A3B7", "modified": "2024-08-20T14:15:30.000Z", "created": "2024-08-20T14:15:30.000Z", "entities": [{"type": " Vulnerability", "id": "vulnerability--416baaa9-dc9f-4396-8d5f-8c081fb06d67", "name": "CVE-2024-43830", "description": "Forced OS shell command injection via crafted sysfs attributes.", "references": [{"url": "https://git.kernel.org/stable/c/0788a6f3523d3686a9eed5ea1e6fcce6841277b2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}]}]}, {"type": "attack_pattern", "id": "attack_pattern--C8C13142-4B23-4F3D-BEA2-3A4C58DD6D7D", "name": "CVE-2024-43830 Attack Pattern", "description": "Attack pattern for CVE-2024-43830", "created_by_ref": "group--6A8B2A9E-AF8B-457F-AE1B-25C1E3E7A3B7", "modified": "2024-08-20T14:15:30.000Z", "created": "2024-08-20T14:15:30.000Z", "relationship": [{"type": "uses", "id_refs": {"indicator--C8C13142-4B23-4F3D-BEA2-3A4C58DD6D7D": {"type": "indicator", "id": "indicator--C8C13142-4B23-4F3D-BEA2-3A4C58DD6D7D"}}}]}, {"type": "course_of_action", "id": "course_of_action--C8C13142-4B23-4F3D-BEA2-3A4C58DD6D7D", "name": "CVE-2024-43830 Course of Action", "description": "Course of action for CVE-2024-43830", "created_by_ref": "group--6A8B2A9E-AF8B-457F-AE1B-25C1E3E7A3B7", "modified": "2024-08-20T14:15:30.000Z", "created": "2024-08-20T14:15:30.000Z", "relationship": [{"type": "uses", "id_refs": {"attack_pattern--C8C13142-4B23-4F3D-BEA2-3A4C58DD6D7D": {"type": "attack_pattern", "id": "attack_pattern--C8C13142-4B23-4F3D-BEA2-3A4C58DD6D7D"}}}]}]}, "technical_analysis": {"Introduction": "This vulnerability allows for forced OS shell command injection via crafted sysfs attributes, which could be used to achieve persistence on the system.", "Impact and Scope": "The vulnerability affects Linux kernel, impacting the boot process and allowing for command injection.", "Related MITRE ATT&CK Techniques": "T1190, T1194, T1499", "Technical Details": "The vulnerability is caused by insufficient input validation in the Linux kernel module, allowing an attacker to inject commands into the system.", "Detection": "Detecting this vulnerability requires monitoring for suspicious sysfs attribute modifications.", "Mitigation": "Apply the mitigations provided in the patch, and ensure sysfs attribute modifications are monitored and restricted."}, "executive_analysis": {"Overview": "This is a critical vulnerability in the Linux kernel that allows for forced OS shell command injection via crafted sysfs attributes.", "Business Impact": "The vulnerability poses a significant risk to business operations, as it could be used to compromise critical systems.", "Technical Impact": "The vulnerability is critical, as it allows for persistence on the system and could be used to commandeer the system.", "Mitigation Strategies": "Apply the provided patches and restrict sysfs attribute modifications.", "Recommendations": "Update Linux kernel, restrict sysfs attribute modifications, and monitor system activity for suspicious behavior.", "Conclusions": "The vulnerability is critical and requires immediate attention. Patching and monitoring are essential to prevent exploitation."}}