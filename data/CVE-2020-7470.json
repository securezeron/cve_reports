{"id": "CVE-2020-7470", "sourceIdentifier": "cve@mitre.org", "published": "2020-01-21T15:15:12.303", "lastModified": "2020-01-24T20:41:21.777", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Sonoff TH 10 and 16 devices with firmware 6.6.0.21 allows XSS via the Friendly Name 1 field (after a successful login with the Web Admin Password)."}, {"lang": "es", "value": "Los dispositivos Sonoff TH versiones 10 y 16 con versi\u00f3n de firmware 6.6.0.21, permiten un ataque de tipo XSS por medio del campo Friendly Name 1 (despu\u00e9s de un inicio de sesi\u00f3n con \u00e9xito con la Contrase\u00f1a del Administrador Web)."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:sonoff:th10:-:*:*:*:*:*:*:*", "matchCriteriaId": "D08AF6A8-16D0-49F4-BF6E-3E96B974088F"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:sonoff:th10_firmware:6.6.0.21:*:*:*:*:*:*:*", "matchCriteriaId": "76DA50A9-44C5-4591-96F3-E0D6C340C7E9"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:sonoff:th16:-:*:*:*:*:*:*:*", "matchCriteriaId": "B50F4C57-9832-446B-B508-34562AC8A069"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:sonoff:th16_firmware:6.6.0.21:*:*:*:*:*:*:*", "matchCriteriaId": "8B193C9C-DDB7-4E24-9C27-5BC4418A3928"}]}]}], "references": [{"url": "https://sku11army.blogspot.com/2020/01/sonoff-sonoff-th-module-vuln-xss.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1562", "comment": "CVE-2020-7470 - Cross-Site Scripting (XSS) vulnerability allows an attacker to inject malicious scripts, potentially leading to unauthorized access to sensitive data, user credentials, or system functionality. This technique is relevant, as it highlights the importance of input validation and sanitization, and how an attacker might use this vulnerability to execute malicious code."}, {"techniqueID": "T1190", "comment": "CVE-2020-7470 - The vulnerability allows an attacker to conduct a man-in-the-middle (MitM) attack, potentially intercepting sensitive data and injecting malicious code. This technique is relevant, as it emphasizes the importance of encrypting data and authenticating connections to prevent unauthorized access."}, {"techniqueID": "T1231", "comment": "CVE-2020-7470 - The vulnerability can be used to conduct a privilege escalation attack, potentially leading to unauthorized access to system resources or sensitive data. This technique is relevant, as it highlights the importance of implementing proper access controls and ensuring that only authorized users have access to sensitive resources."}], "stix_bundle": {"objects": [{"id": "CVE-2020-7470", "type": "vulnerability", "description": "Sonoff TH 10 and 16 devices with firmware 6.6.0.21 allow XSS via the Friendly Name 1 field (after a successful login with the Web Admin Password)."}, {"id": "T1562", "type": "attack-pattern", "description": "Cross-Site Scripting (XSS)", "external_references": [{"source_name": "mitre", "external_id": "T1562"}]}, {"id": "T1190", "type": "attack-pattern", "description": "Man-in-the-Middle (MitM)", "external_references": [{"source_name": "mitre", "external_id": "T1190"}]}, {"id": "T1231", "type": "attack-pattern", "description": "Privilege Escalation", "external_references": [{"source_name": "mitre", "external_id": "T1231"}]}, {"id": "CVE-2020-7470:CVE-2020-7470", "type": "relationship", "predicate": "related", "from": {"id": "CVE-2020-7470"}, "to": {"id": "T1562"}}, {"id": "CVE-2020-7470:CVE-2020-7470", "type": "relationship", "predicate": "related", "from": {"id": "CVE-2020-7470"}, "to": {"id": "T1190"}}, {"id": "CVE-2020-7470:CVE-2020-7470", "type": "relationship", "predicate": "related", "from": {"id": "CVE-2020-7470"}, "to": {"id": "T1231"}}]}, "technical_analysis": {"Introduction": "CVE-2020-7470 is a vulnerability affecting the Sonoff TH 10 and 16 devices with firmware 6.6.0.21, which allows Cross-Site Scripting (XSS) attacks.", "Impact and Scope": "The vulnerability has a CVSS score of 4.8, with an attack vector of 'NETWORK' and requires 'HIGH' privileges. It affects 'LOW' confidentiality, 'LOW' integrity, and 'NONE' availability.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to Techniques T1562, T1190, and T1231.", "Technical Details": "The vulnerability occurs when an attacker injects malicious scripts into the 'Friendly Name 1' field, which can lead to unauthorized access to sensitive data or system functionality.", "Detection": "Detection methods include monitoring for unusual login activity, analyzing network traffic for suspicious patterns, and performing regular security audits.", "Mitigation": "Mitigation strategies include updating to the latest firmware, implementing input validation and sanitization, and configuring the device to use a secure protocol.", "Conclusion": "CVE-2020-7470 highlights the importance of implementing proper security measures to prevent XSS attacks."}, "executive_analysis": {"Overview": "CVE-2020-7470 is a vulnerability affecting the Sonoff TH 10 and 16 devices with firmware 6.6.0.21.", "Business Impact": "The vulnerability can lead to unauthorized access to sensitive data, financial loss, or reputational damage.", "Technical Impact": "The vulnerability affects the security of the device and can be exploited to gain unauthorized access to system resources or sensitive data.", "Mitigation Strategies": "Implementing regular security audits, updating to the latest firmware, and configuring the device to use a secure protocol.", "Recommendations": "Executives should ensure that the necessary steps are taken to mitigate the vulnerability and prevent unauthorized access.", "Conclusions": "CVE-2020-7470 emphasizes the importance of prioritizing security and implementing robust measures to prevent vulnerabilities."}}