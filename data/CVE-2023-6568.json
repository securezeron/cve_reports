{"id": "CVE-2023-6568", "sourceIdentifier": "security@huntr.dev", "published": "2023-12-07T05:15:09.347", "lastModified": "2024-04-16T12:15:08.957", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "A reflected Cross-Site Scripting (XSS) vulnerability exists in the mlflow/mlflow repository, specifically within the handling of the Content-Type header in POST requests. An attacker can inject malicious JavaScript code into the Content-Type header, which is then improperly reflected back to the user without adequate sanitization or escaping, leading to arbitrary JavaScript execution in the context of the victim's browser. The vulnerability is present in the mlflow/server/auth/__init__.py file, where the user-supplied Content-Type header is directly injected into a Python formatted string and returned to the user, facilitating the XSS attack."}, {"lang": "es", "value": "Cross-Site-Scripting (XSS) Reflejadas en el repositorio de GitHub mlflow/mlflow antes de 2.9.0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:lfprojects:mlflow:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.9.0", "matchCriteriaId": "D7B09299-B859-4252-B907-2924010BD019"}]}]}], "references": [{"url": "https://github.com/mlflow/mlflow/commit/28ff3f94994941e038f2172c6484b65dc4db6ca1", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.com/bounties/816bdaaa-8153-4732-951e-b0d92fddf709", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0003", "comment": "CVE-2023-6568 - Cross-Site Scripting (XSS) vulnerability exists in the mlflow repository, facilitating the XSS attack. The user-supplied Content-Type header is directly injected into a Python formatted string and returned to the user, leading to arbitrary JavaScript execution in the context of the victim's browser."}, {"techniqueID": "TA0008", "comment": "CVE-2023-6568 - The vulnerability can be exploited by injecting malicious JavaScript code into the Content-Type header of a POST request. An attacker can use this technique to execute arbitrary JavaScript code on the vulnerable server, leading to further exploitation."}, {"techniqueID": "TA0040", "comment": "CVE-2023-6568 - The vulnerability can be detected by monitoring network traffic for suspicious POST requests with modified Content-Type headers. Defenders can use web application firewalls (WAFs) to block these requests and prevent XSS attacks."}, {"techniqueID": "TA0041", "comment": "CVE-2023-6568 - A defense strategy is to implement Content-Type header validation and sanitization to prevent malicious code injection. This can be achieved by using a whitelist of allowed Content-Type values or implementing a validation mechanism to check the header's contents."}], "stix_bundle": {"type": "bundle", "id": "bundle--1", "spec_version": "2.1", "objects": [{"type": "notice", "id": "notice--1", "created_by_ref": "identity--1", "created": "2023-12-07T05:15:09.347", "modified": "2024-04-16T12:15:08.957", "name": "CVE-2023-6568 XSA", "description": "A reflected Cross-Site Scripting (XSS) vulnerability exists in the mlflow repository, specifically within the handling of the Content-Type header in POST requests.", "published": true, "extended_properties": [{"key": "cve_id", "value": "CVE-2023-6568"}, {"key": "cvss_score", "value": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"}}, {"key": "cvss_score_v30", "value": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N"}}], "objects": [{"type": "incident", "id": "incident--1", "incident_type": "xss", "description": "A reflected Cross-Site Scripting (XSS) vulnerability exists in the mlflow repository, specifically within the handling of the Content-Type header in POST requests.", "courses_of_action": [{"type": "course_of_action", "id": "course_of_action--1", "description": "Implement Content-Type header validation and sanitization", "mitigates": "technique--1"}]}]}, {"type": "technique", "id": "technique--1", "name": "Content-Type Header Injection", "description": "Inject malicious JavaScript code into the Content-Type header of a POST request to execute arbitrary JavaScript code on the vulnerable server.", "related_course_of_action": "course_of_action--1"}]}, "technical_analysis": {"Introduction": "This technical analysis covers the details of the CVE-2023-6568 XSS vulnerability in the mlflow repository.", "Impact and Scope": "The vulnerability has a CVSS score of 6.1 and is considered medium severity. It can be exploited by injecting malicious JavaScript code into the Content-Type header of a POST request.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the Cross-Site Scripting (XSS) technique (TA0003) and can be detected using the Network Traffic Analysis (TA0008) technique.", "Technical Details": "The vulnerability exists in the mlflow repository's handling of the Content-Type header in POST requests. An attacker can inject malicious JavaScript code into the header, which is then improperly reflected back to the user, leading to arbitrary JavaScript execution in the context of the victim's browser.", "Detection": "The vulnerability can be detected by monitoring network traffic for suspicious POST requests with modified Content-Type headers or using web application firewalls (WAFs) to block these requests.", "Mitigation": "A defense strategy is to implement Content-Type header validation and sanitization to prevent malicious code injection.", "Conclusion": "In conclusion, the CVE-2023-6568 XSS vulnerability is a serious security flaw that can be exploited by injecting malicious JavaScript code into the Content-Type header of a POST request. It is essential to implement proper validation and sanitization of the Content-Type header to prevent this type of attack."}, "executive_analysis": {"Overview": "The CVE-2023-6568 XSS vulnerability is a critical security flaw in the mlflow repository that can be exploited by attackers to inject malicious JavaScript code and execute arbitrary code on the vulnerable server.", "Business Impact": "This vulnerability can have significant business implications, especially for organizations that rely heavily on the mlflow repository for their business operations.", "Technical Impact": "The vulnerability can be exploited by attackers to execute arbitrary code on the vulnerable server, leading to further exploitation and potential data breaches.", "Mitigation Strategies": "Implementing Content-Type header validation and sanitization is a critical defense strategy to prevent malicious code injection.", "Recommendations": "We recommend that organizations using the mlflow repository upgrade to a patched version and implement additional security measures to prevent XSS attacks.", "Conclusions": ""}}