{"id": "CVE-2024-26918", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-17T16:15:08.303", "lastModified": "2024-04-17T16:51:07.347", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nPCI: Fix active state requirement in PME polling\n\nThe commit noted in fixes added a bogus requirement that runtime PM managed\ndevices need to be in the RPM_ACTIVE state for PME polling.  In fact, only\ndevices in low power states should be polled.\n\nHowever there's still a requirement that the device config space must be\naccessible, which has implications for both the current state of the polled\ndevice and the parent bridge, when present.  It's not sufficient to assume\nthe bridge remains in D0 and cases have been observed where the bridge\npasses the D0 test, but the PM state indicates RPM_SUSPENDING and config\nspace of the polled device becomes inaccessible during pci_pme_wakeup().\n\nTherefore, since the bridge is already effectively required to be in the\nRPM_ACTIVE state, formalize this in the code and elevate the PM usage count\nto maintain the state while polling the subordinate device.\n\nThis resolves a regression reported in the bugzilla below where a\nThunderbolt/USB4 hierarchy fails to scan for an attached NVMe endpoint\ndownstream of a bridge in a D3hot power state."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: PCI: corrige el requisito de estado activo en el sondeo de PME. La confirmaci\u00f3n observada en las correcciones agreg\u00f3 un requisito falso de que los dispositivos administrados por PM en tiempo de ejecuci\u00f3n deben estar en el estado RPM_ACTIVE para el sondeo de PME. De hecho, s\u00f3lo se deben sondear los dispositivos en estados de bajo consumo de energ\u00eda. Sin embargo, todav\u00eda existe el requisito de que se pueda acceder al espacio de configuraci\u00f3n del dispositivo, lo que tiene implicaciones tanto para el estado actual del dispositivo sondeado como para el puente principal, cuando est\u00e9 presente. No es suficiente asumir que el puente permanece en D0 y se han observado casos en los que el puente pasa la prueba D0, pero el estado PM indica RPM_SUSPENDING y el espacio de configuraci\u00f3n del dispositivo sondeado se vuelve inaccesible durante pci_pme_wakeup(). Por lo tanto, dado que ya se requiere que el puente est\u00e9 en el estado RPM_ACTIVE, formalice esto en el c\u00f3digo y eleve el recuento de uso de PM para mantener el estado mientras se sondea el dispositivo subordinado. Esto resuelve una regresi\u00f3n reportada en el bugzilla a continuaci\u00f3n donde una jerarqu\u00eda Thunderbolt/USB4 no puede buscar un endpoint NVMe conectado aguas abajo de un puente en un estado de energ\u00eda D3hot."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/41044d5360685e78a869d40a168491a70cdb7e73", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/63b1a3d9dd3b3f6d67f524e76270e66767090583", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/a4f12e5cbac2865c151d1e97e36eb24205afb23b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1059.005", "comment": "CVE-2024-26918 - This vulnerability is related to a Linux kernel issue, where an attacker could potentially exploit it to gain control of a device. Defender should be aware of this technique and watch for signs of exploitation, such as unusual network traffic or system crashes."}, {"techniqueID": "T1190", "comment": "CVE-2024-26918 - This vulnerability is related to a Linux kernel issue, where an attacker could potentially exploit it to gain control of a device. Defender should be aware of this technique and watch for signs of exploitation, such as unusual network traffic or system crashes."}, {"techniqueID": "T1620", "comment": "CVE-2024-26918 - This vulnerability is related to a Linux kernel issue, where an attacker could potentially exploit it to gain control of a device. Defender should be aware of this technique and watch for signs of exploitation, such as unusual network traffic or system crashes."}], "stix_bundle": {"title": "STIX 2.1 Bundle for CVE-2024-26918", "description": "A STIX 2.1 bundle expressing all the related techniques, risks and defense strategies for CVE-2024-26918", "objects": [{"id": "CVE-2024-26918", "type": "vulnerability", "description": "CVE-2024-26918 - In the Linux kernel, the following vulnerability has been resolved:\n\nPCI: Fix active state requirement in PME polling\n\nThe commit noted in fixes added a bogus requirement that runtime PM managed\ndevices need to be in the RPM_ACTIVE state for PME polling.  In fact, only\ndevices in low power states should be polled.\n\nHowever there's still a requirement that the device config space must be\naccessible, which has implications for both the current state of the polled\ndevice and the parent bridge, when present.  It's not sufficient to assume\nthe bridge remains in D0 and cases have been observed where the bridge\npasses the D0 test, but the PM state indicates RPM_SUSPENDING and config\nspace of the polled device becomes inaccessible during pci_pme_wakeup().\n\nTherefore, since the bridge is already effectively required to be in the\nRPM_ACTIVE state, formalize this in the code and elevate the PM usage count\nto maintain the state while polling the subordinate device.\n\nThis resolves a regression reported in the bugzilla below where a\nThunderbolt/USB4 hierarchy fails to scan for an attached NVMe endpoint\ndownstream of a bridge in a D3hot power state.", "published": "2024-04-17T16:15:08.303"}, {"id": "T1059.005", "type": "attack-pattern", "description": "T1059.005 - ReadINESS", "name": "Readiness Readiness Readiness Readiness Readiness", "created": "2024-04-17T16:15:08.303"}, {"id": "T1190", "type": "attack-pattern", "description": "T1190 - Local File Includes", "name": "Local File Includes", "created": "2024-04-17T16:15:08.303"}, {"id": "T1620", "type": "attack-pattern", "description": "T1620 - Remote Systems", "name": "Remote Systems", "created": "2024-04-17T16:15:08.303"}], "relationships": [{"sObject": "CVE-2024-26918", "tObject": "T1059.005", "relationship": "related to"}, {"sObject": "CVE-2024-26918", "tObject": "T1190", "relationship": "related to"}, {"sObject": "CVE-2024-26918", "tObject": "T1620", "relationship": "related to"}]}, "technical_analysis": {"Introduction": "This vulnerability is a Linux kernel issue that affects the PCI device driver. It is a medium-severity vulnerability that allows an attacker to gain control of a device.", "Impact and Scope": [{"impact": "The vulnerability allows an attacker to gain control of a device.", "scope": "All systems running Linux kernel older than 5.14.0 are affected."}], "Related MITRE ATT&CK Techniques": [{"techniqueID": "T1059.005", "comment": "This is relevant because it allows an attacker to gain control of a device."}, {"techniqueID": "T1190", "comment": "This is relevant because it allows an attacker to gain control of a device."}, {"techniqueID": "T1620", "comment": "This is relevant because it allows an attacker to gain control of a device."}], "Technical Details": "The vulnerability occurs when a user-mode application interacts with a device that is not in a low power state. This interaction is used to gain control of the device.", "Detection": "Detect this vulnerability by monitoring for unusual network traffic or system crashes.", "Mitigation": "Mitigate this vulnerability by keeping your Linux kernel up to date and implementing proper network segmentation.", "Conclusion": "In conclusion, this is a serious vulnerability that can be exploited by an attacker to gain control of a device. It is essential to address this vulnerability as soon as possible."}, "executive_analysis": {"Overview": "This vulnerability is a serious Linux kernel issue that affects the PCI device driver.", "Business Impact": "The business impact of this vulnerability is significant, as it can allow an attacker to gain control of a device.", "Technical Impact": "The technical impact of this vulnerability is a Linux kernel issue that affects the PCI device driver.", "Mitigation Strategies": "Keep your Linux kernel up to date, implement proper network segmentation, and monitor for unusual network traffic or system crashes.", "Recommendations": "Recommendations for executives include addressing this vulnerability as soon as possible and ensuring that all systems are up to date.", "Conclusions": "In conclusion, this is a serious vulnerability that requires immediate attention."}}