{"id": "CVE-2024-30080", "sourceIdentifier": "secure@microsoft.com", "published": "2024-06-11T17:15:55.207", "lastModified": "2024-06-12T14:19:52.130", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Microsoft Message Queuing (MSMQ) Remote Code Execution Vulnerability"}, {"lang": "es", "value": "Vulnerabilidad de ejecuci\u00f3n remota de c\u00f3digo de Microsoft Message Queuing (MSMQ)"}], "metrics": {"cvssMetricV31": [{"source": "secure@microsoft.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-416"}]}, {"source": "secure@microsoft.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-416"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1507:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.10240.20680", "matchCriteriaId": "CF7733FD-F870-4578-A567-9900AD6C78E3"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1607:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.14393.7070", "matchCriteriaId": "D96DA51E-404E-49AE-B852-56FF8A1CEEA6"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1809:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.17763.5936", "matchCriteriaId": "9B52F95E-6080-46C6-B4B6-E2B3F3E78456"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_21h1:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.19043.4529", "matchCriteriaId": "E5EEF5EA-99CC-45F0-9F07-95019D51C6BD"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_21h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22000.3019", "matchCriteriaId": "84ECD6C0-8C47-4D2F-82B5-4F8C0BBC5FEE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_22h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22621.3737", "matchCriteriaId": "4E80DF17-1F27-474E-B147-9F5B6C494300"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_23h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22631.3737", "matchCriteriaId": "4258468C-56CC-45C0-B510-FC833E942876"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:-:sp2:*:*:*:*:x64:*", "matchCriteriaId": "2127D10C-B6F3-4C1D-B9AA-5D78513CC996"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:-:sp2:*:*:*:*:x86:*", "matchCriteriaId": "AB425562-C0A0-452E-AABE-F70522F15E1A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:r2:sp1:*:*:*:*:x64:*", "matchCriteriaId": "AF07A81D-12E5-4B1D-BFF9-C8D08C32FF4F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:-:*:*:*:*:*:*:*", "matchCriteriaId": "A7DF96F8-BA6A-4780-9CA3-F719B3F81074"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:r2:*:*:*:*:*:*:*", "matchCriteriaId": "DB18C4CE-5917-401E-ACF7-2747084FD36E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2016:-:*:*:*:*:*:*:*", "matchCriteriaId": "041FF8BA-0B12-4A1F-B4BF-9C4F33B7C1E7"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2019:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.17763.5936", "matchCriteriaId": "12F9D974-A968-4CBB-81D8-C73B76DD284A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.20348.2522", "matchCriteriaId": "498A643B-0180-4AD3-BD7C-5E3CEB0FD112"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022_23h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.25398.950", "matchCriteriaId": "0EA59E2D-57B2-4E8B-937A-3EB51A3AD285"}]}]}], "references": [{"url": "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-30080", "source": "secure@microsoft.com", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-30080 - This vulnerability allows for remote code execution, allowing an attacker to gain unauthorized access and potentially take control of the system. Defending against this attack involves implementing proper network segmentation, limiting access to trusted sources, and ensuring timely patching of systems."}, {"techniqueID": "T1191", "comment": "CVE-2024-30080 - The vulnerability in MSMQ allows an attacker to execute arbitrary code on the system, which could be used to install malware, steal data, or disrupt system functionality. Defending against this attack involves implementing proper access controls, monitoring system logs, and enforcing strong patch management practices."}, {"techniqueID": "T1194", "comment": "CVE-2024-30080 - The remote code execution vulnerability in MSMQ allows an attacker to perform lateral movement, escalating privileges and increasing the attack's impact. Defending against this attack involves implementing threat intelligence, monitoring system logs, and enforcing strong access controls."}], "stix_bundle": {"objects": [{"id": "vulnerability:CVE-2024-30080", "type": "vulnerability", "description": "Microsoft Message Queuing (MSMQ) Remote Code Execution Vulnerability", "components": [], "objects_bindings": {"related_attack_patterns": [{"description": "T1190: Exploit Public-Facing Application", "id": "attack-pattern/T1190", "type": "attack-pattern"}, {"description": "T1191: Exploit Public-Facing Technology", "id": "attack-pattern/T1191", "type": "attack-pattern"}, {"description": "T1194: Lateral Movement", "id": "attack-pattern/T1194", "type": "attack-pattern"}]}}, {"id": "attack-pattern/T1190", "type": "attack-pattern", "description": "Exploit Public-Facing Application", "objects_bindings": {"related_course_of_actions": [{"description": "Implement Proper Network Segmentation", "id": "course-of-action/COA-1", "type": "course-of-action"}, {"description": "Limit Access to Trusted Sources", "id": "course-of-action/COA-2", "type": "course-of-action"}]}}, {"id": "attack-pattern/T1191", "type": "attack-pattern", "description": "Exploit Public-Facing Technology", "objects_bindings": {"related_course_of_actions": [{"description": "Implement Proper Access Controls", "id": "course-of-action/COA-3", "type": "course-of-action"}, {"description": "Monitor System Logs", "id": "course-of-action/COA-4", "type": "course-of-action"}]}}, {"id": "attack-pattern/T1194", "type": "attack-pattern", "description": "Lateral Movement", "objects_bindings": {"related_course_of_actions": [{"description": "Implement Threat Intelligence", "id": "course-of-action/COA-5", "type": "course-of-action"}, {"description": "Monitor System Logs", "id": "course-of-action/COA-6", "type": "course-of-action"}]}}]}, "technical_analysis": {"Introduction": "The CVE-2024-30080 vulnerability allows for remote code execution on Microsoft Message Queuing (MSMQ) servers, posing a significant risk to systems and data. This analysis provides an in-depth look at the vulnerability, its impact, and recommended mitigations.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8, indicating a high likelihood of exploitation. It allows an attacker to execute arbitrary code on the system, which could be used to install malware, steal data, or disrupt system functionality.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to attack techniques T1190, T1191, and T1194, which are part of the MITRE ATT&CK framework.", "Technical Details": "The vulnerability is caused by an arbitrary file write vulnerability in MSMQ, which allows an attacker to write a malicious file to the system. This allows the attacker to execute arbitrary code on the system.", "Detection": "The vulnerability can be detected using network traffic analysis, system logging, and file system monitoring. Use of security information and event management (SIEM) systems can also help detect and alert on suspicious activity.", "Mitigation": "Implementing proper network segmentation, access controls, and monitoring can help prevent exploitation of this vulnerability. It is also recommended to limit access to trusted sources and to ensure timely patching of systems.", "Conclusion": "In conclusion, the CVE-2024-30080 vulnerability is a significant risk to systems and data. Implementing the recommended mitigations can help prevent exploitation and minimize the impact of a potential attack."}, "executive_analysis": {"Overview": "CVE-2024-30080 is a critical vulnerability in Microsoft Message Queuing (MSMQ) that can allow an attacker to execute arbitrary code on a system.", "Business Impact": "This vulnerability poses a significant risk to business operations, as it can allow an attacker to steal data, disrupt system functionality, or install malware. It is important to take immediate action to mitigate this vulnerability.", "Technical Impact": "The vulnerability is a high-severity remote code execution vulnerability, which can allow an attacker to take control of a system.", "Mitigation Strategies": "Implementing network segmentation, access controls, and monitoring can help prevent exploitation of this vulnerability.", "Recommendations": "It is recommended that executives take immediate action to mitigate this vulnerability, including implementing the recommended mitigations and monitoring systems for suspicious activity.", "Conclusions": "In conclusion, CVE-2024-30080 is a critical vulnerability that poses a significant risk to systems and data. Implementing the recommended mitigations can help prevent exploitation and minimize the impact of a potential attack."}}