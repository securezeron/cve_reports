{"id": "CVE-2020-8567", "sourceIdentifier": "jordan@liggitt.net", "published": "2021-01-21T17:15:14.063", "lastModified": "2021-08-27T16:07:41.243", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Kubernetes Secrets Store CSI Driver Vault Plugin prior to v0.0.6, Azure Plugin prior to v0.0.10, and GCP Plugin prior to v0.2.0 allow an attacker who can create specially-crafted SecretProviderClass objects to write to arbitrary file paths on the host filesystem, including /var/lib/kubelet/pods."}, {"lang": "es", "value": "Kubernetes Secrets Store CSI Driver Vault Plugin anterior a versi\u00f3n v0.0.6, Azure Plugin anterior a versi\u00f3n v0.0.10 y GCP Plugin anterior a versi\u00f3n v0.2.0, permiten a un atacante que puede crear objetos SecretProviderClass especialmente dise\u00f1ados para escribir en rutas de archivo arbitrarias en el sistema de archivos host , incluyendo la biblioteca /var/lib/kubelet/pods"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "jordan@liggitt.net", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:N/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}, {"source": "jordan@liggitt.net", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-24"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:google:secret_manager_provider_for_secret_store_csi_driver:*:*:*:*:*:kubernetes:*:*", "versionEndExcluding": "0.2.0", "matchCriteriaId": "FF1065B6-815D-49AC-9071-2366DFD8918C"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hashicorp:vault_provider_for_secrets_store_csi_driver:*:*:*:*:*:kubernetes:*:*", "versionEndExcluding": "0.0.6", "matchCriteriaId": "0A30166E-B020-4E14-ACB4-87A99EEE788A"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:azure_key_vault_provider_for_secrets_store_csi_driver:*:*:*:*:*:kubernetes:*:*", "versionEndExcluding": "0.0.10", "matchCriteriaId": "C3941507-D6C5-4263-B6C4-56FC0625C6DE"}]}]}], "references": [{"url": "https://github.com/kubernetes-sigs/secrets-store-csi-driver/issues/384", "source": "jordan@liggitt.net", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://groups.google.com/g/kubernetes-secrets-store-csi-driver/c/BI2qisiNXHY", "source": "jordan@liggitt.net", "tags": ["Mailing List", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1077", "comment": "CVE-2020-8567 - An attacker can write to arbitrary file paths on the host filesystem, including `/var/lib/kubelet/pods`, by creating specially-crafted SecretProviderClass objects. This is a classic example of a file write vulnerability, where an attacker can write arbitrary files to critical system locations."}, {"techniqueID": "T1190", "comment": "CVE-2020-8567 - An attacker can use the arbitrary file write vulnerability to write malware or other malicious code to critical system locations, potentially allowing for persistence, escalation of privileges, or data exfiltration."}, {"techniqueID": "T1486", "comment": "CVE-2020-8567 - An attacker can use the arbitrary file write vulnerability to create a web shell or other malicious executable, potentially allowing for remote code execution."}, {"techniqueID": "T1078", "comment": "CVE-2020-8567 - An attacker can use the arbitrary file write vulnerability to write a custom Docker container or other malicious payload to critical system locations, potentially allowing for persistence or data exfiltration."}, {"techniqueID": "D3FEND::1035", "comment": "CVE-2020-8567 - Defense against arbitrary file write vulnerabilities includes implementing file write restrictions, validating user input, and using security-focused programming practices."}], "stix_bundle": "Insert STIX 2.1 bundle expression here", "technical_analysis": {"Introduction": "This vulnerability allows an attacker to write to arbitrary file paths on the host filesystem, including critical system locations.", "Impact and Scope": "The impact of this vulnerability is significant, with a CVSS score of 6.5 and potential for data exfiltration, escalations of privileges, or persistence.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques include T1077, T1190, T1486, and T1078.", "Technical Details": "The vulnerability is caused by a weakness in the Secrets Store CSI Driver Vault Plugin, which allows an attacker to write to arbitrary file paths.", "Detection": "Detection of this vulnerability involves monitoring for suspicious file writes to critical system locations and implementing logging and alerting mechanisms.", "Mitigation": "Mitigation strategies include implementing file write restrictions, validating user input, and using security-focused programming practices.", "Conclusion": "This vulnerability is a significant risk to the security of Kubernetes environments and requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The CVE-2020-8567 vulnerability is a critical security risk that allows an attacker to write to arbitrary file paths on the host filesystem, including critical system locations.", "Business Impact": "The impact of this vulnerability is significant, with potential for data exfiltration, escalations of privileges, or persistence.", "Technical Impact": "The technical impact of this vulnerability is the ability to compromise the security of critical system locations.", "Mitigation Strategies": "Mitigation strategies include implementing file write restrictions, validating user input, and using security-focused programming practices.", "Recommendations": "Recommendations include patching affected systems, implementing additional security controls, and conducting regular security assessments.", "Conclusions": "This vulnerability requires immediate attention and remediation to ensure the security of Kubernetes environments."}}