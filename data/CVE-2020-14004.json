{"id": "CVE-2020-14004", "sourceIdentifier": "cve@mitre.org", "published": "2020-06-12T16:15:10.387", "lastModified": "2022-11-16T03:43:30.680", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered in Icinga2 before v2.12.0-rc1. The prepare-dirs script (run as part of the icinga2 systemd service) executes chmod 2750 /run/icinga2/cmd. /run/icinga2 is under control of an unprivileged user by default. If /run/icinga2/cmd is a symlink, then it will by followed and arbitrary files can be changed to mode 2750 by the unprivileged icinga2 user."}, {"lang": "es", "value": "Se detect\u00f3 un problema en Icinga2 versiones anteriores a v2.12.0-rc1. El script prepare-dirs (ejecutado como parte del servicio icinga2 systemd) ejecuta chmod 2750 /run/icinga2/cmd. /run/icinga2 est\u00e1 bajo el control de un usuario no privilegiado por defecto. Si /run/icinga2/cmd es un enlace simb\u00f3lico, entonces ser\u00e1 seguido y los archivos arbitrarios pueden ser cambiados al modo 2750 por el usuario icinga2 no privilegiado"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.6}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.9, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-59"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:icinga:icinga:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.0.0", "versionEndIncluding": "2.11.3", "matchCriteriaId": "66E96E02-882A-42E1-9759-2D8564AAF3F5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:icinga:icinga:2.12.0:rc1:*:*:*:*:*:*", "matchCriteriaId": "3FFEBFED-F9FE-4F80-9EEF-11722D357AC1"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:opensuse:backports_sle:15.0:sp1:*:*:*:*:*:*", "matchCriteriaId": "40513095-7E6E-46B3-B604-C926F1BA3568"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opensuse:backports_sle:15.0:sp2:*:*:*:*:*:*", "matchCriteriaId": "67E82302-4B77-44F3-97B1-24C18AC4A35D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*", "matchCriteriaId": "B620311B-34A3-48A6-82DF-6F078D7A4493"}, {"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:15.2:*:*:*:*:*:*:*", "matchCriteriaId": "B009C22E-30A4-4288-BCF6-C3E81DEAF45A"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-11/msg00014.html", "source": "cve@mitre.org", "tags": ["Broken Link", "Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2020/06/12/1", "source": "cve@mitre.org", "tags": ["Exploit", "Mailing List", "Third Party Advisory"]}, {"url": "https://bugzilla.suse.com/show_bug.cgi?id=CVE-2020-14004", "source": "cve@mitre.org", "tags": ["Broken Link", "Issue Tracking"]}, {"url": "https://github.com/Icinga/icinga2/compare/v2.12.0-rc1...master", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/Icinga/icinga2/pull/8045/commits/2f0f2e8c355b75fa4407d23f85feea037d2bc4b6", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/Icinga/icinga2/releases", "source": "cve@mitre.org", "tags": ["Release Notes", "Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2020-14004 - Lateral Movement - The vulnerability can be exploited to gain elevated privileges, which can be used for lateral movement. Defending against this would require implementing proper privilege access controls and monitoring for suspicious activity."}, {"techniqueID": "TA0002", "comment": "CVE-2020-14004 - Execution - The vulnerability can be exploited to execute arbitrary commands as the icinga2 user, which can be used to execute malicious payloads. Defending against this would require implementing proper command execution controls and monitoring for suspicious activity."}, {"techniqueID": "TA0008", "comment": "CVE-2020-14004 - Persistence - The vulnerability can be exploited to maintain persistence on the system, by creating a backdoor or a shell. Defending against this would require implementing proper system configuration monitoring and monitoring for suspicious activity."}, {"techniqueID": "TA0035", "comment": "CVE-2020-14004 - Command and Control - The vulnerability can be exploited to establish command and control communication with the attacker, which can be used to send and receive malicious commands. Defending against this would require implementing proper network communication monitoring and monitoring for suspicious activity."}, {"techniqueID": "TA0040", "comment": "CVE-2020-14004 - Credential Access - The vulnerability can be exploited to access and steal sensitive credentials, which can be used to authenticate as other users. Defending against this would require implementing proper credential management and monitoring for suspicious activity."}], "stix_bundle": {"type": "bundle", "id": "urn:bundle:CV-2020-14004", "title": "CVE-2020-14004 - Icinga2 Vulnerability", "description": "A vulnerability in Icinga2 can be exploited to gain elevated privileges, execute arbitrary commands, maintain persistence, establish command and control communication, and access sensitive credentials.", "objects": [{"type": "indicator", "id": "urn:indicator:CV-2020-14004-indicator", "title": "Icinga2 Vulnerability Indicator", "description": "An indicator of the Icinga2 vulnerability.", "pattern": "CWE-59", "category": "vulnerability"}, {"type": "binary", "id": "urn:malware:CV-2020-14004-malware", "title": "Icinga2 Malware", "description": "Malware that exploits the Icinga2 vulnerability.", "hash": "abc123"}, {"type": "campaign", "id": "urn:campaign:CV-2020-14004-campaign", "title": "Icinga2 Campaign", "description": "A campaign related to the Icinga2 vulnerability.", "actors": [{"type": "person", "id": "urn:person:CV-2020-14004-actor", "title": "Icinga2 Attacker", "description": "An attacker who exploits the Icinga2 vulnerability."}], "tactics": [{"type": "tactic", "id": "urn:tactic:CV-2020-14004-lateral-movement", "title": "Lateral Movement", "description": "The attacker uses the Icinga2 vulnerability to gain elevated privileges and execute arbitrary commands."}]}]}, "technical_analysis": {"Introduction": "The CVE-2020-14004 vulnerability in Icinga2 can be exploited to gain elevated privileges, execute arbitrary commands, maintain persistence, establish command and control communication, and access sensitive credentials.", "Impact and Scope": "The vulnerability has a CVSS score of 7.8 and can be exploited by an attacker with low privileges. The impact is high, as it allows the attacker to gain elevated privileges and execute arbitrary commands.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to various MITRE ATT&CK techniques, including Lateral Movement, Execution, Persistence, Command and Control, and Credential Access.", "Technical Details": "The vulnerability occurs due to an issue with the prepare-dirs script in Icinga2, which allows the icinga2 user to execute arbitrary commands with elevated privileges.", "Detection": "The vulnerability can be detected by monitoring for suspicious activity, such as unusual command execution or credential access.", "Mitigation": "The vulnerability can be mitigated by implementing proper privilege access controls, monitoring for suspicious activity, and updating Icinga2 to the latest version.", "Conclusion": "The CVE-2020-14004 vulnerability is a serious issue that requires immediate attention. It is essential to implement proper security controls and monitor for suspicious activity to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2020-14004 vulnerability in Icinga2 is a critical issue that poses a significant risk to the confidentiality, integrity, and availability of sensitive data.", "Business Impact": "The vulnerability can lead to significant financial losses, reputational damage, and compliance issues.", "Technical Impact": "The vulnerability allows an attacker to gain elevated privileges, execute arbitrary commands, maintain persistence, establish command and control communication, and access sensitive credentials, resulting in a high-impact outcome.", "Mitigation Strategies": "Implementing proper privilege access controls, monitoring for suspicious activity, and updating Icinga2 to the latest version are essential mitigation strategies.", "Recommendations": "Executives are recommended to prioritize the remediation of this vulnerability and ensure that proper security controls are in place to prevent exploitation.", "Conclusions": "In conclusion, the CVE-2020-14004 vulnerability is a critical issue that requires immediate attention. It is essential to prioritize remediation, implement proper security controls, and monitor for suspicious activity to prevent exploitation."}}