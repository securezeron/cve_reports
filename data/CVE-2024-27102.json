{"id": "CVE-2024-27102", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-13T21:15:59.590", "lastModified": "2024-03-14T12:52:16.723", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Wings is the server control plane for Pterodactyl Panel. This vulnerability impacts anyone running the affected versions of Wings. The vulnerability can potentially be used to access files and directories on the host system. The full scope of impact is exactly unknown, but reading files outside of a server's base directory (sandbox root) is possible. In order to use this exploit, an attacker must have an existing \"server\" allocated and controlled by Wings. Details on the exploitation of this vulnerability are embargoed until March 27th, 2024 at 18:00 UTC. In order to mitigate this vulnerability, a full rewrite of the entire server filesystem was necessary. Because of this, the size of the patch is massive, however effort was made to reduce the amount of breaking changes. Users are advised to update to version 1.11.9. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Wings es el plano de control del servidor de Pterodactyl Panel. Esta vulnerabilidad afecta a cualquiera que ejecute las versiones afectadas de Wings. La vulnerabilidad puede usarse potencialmente para acceder a archivos y directorios en el sistema host. Se desconoce exactamente el alcance total del impacto, pero es posible leer archivos fuera del directorio base de un servidor (ra\u00edz de la zona de pruebas). Para utilizar este exploit, un atacante debe tener un \"servidor\" existente asignado y controlado por Wings. Los detalles sobre la explotaci\u00f3n de esta vulnerabilidad est\u00e1n embargados hasta el 27 de marzo de 2024 a las 18:00 UTC. Para mitigar esta vulnerabilidad, fue necesaria una reescritura completa de todo el sistema de archivos del servidor. Debido a esto, el tama\u00f1o del parche es enorme, sin embargo, se hizo un esfuerzo para reducir la cantidad de cambios importantes. Se recomienda a los usuarios que actualicen a la versi\u00f3n 1.11.9. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.9, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.1, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-22"}, {"lang": "en", "value": "CWE-362"}, {"lang": "en", "value": "CWE-363"}]}], "references": [{"url": "https://github.com/pterodactyl/wings/commit/d1c0ca526007113a0f74f56eba99511b4e989287", "source": "security-advisories@github.com"}, {"url": "https://github.com/pterodactyl/wings/security/advisories/GHSA-494h-9924-xww9", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-27102 - An attacker with existing control over a Wings server can potentially access files and directories outside of a server's base directory, demonstrating the exploitation of this vulnerability. This can be mitigated by ensuring proper access controls and segmentation of servers."}, {"techniqueID": "T1204", "comment": "CVE-2024-27102 - The exploitation of this vulnerability involves reading files outside of a server's base directory, which can be detected by monitoring file access patterns and anomalies. Defenders can implement intrusion detection systems and file integrity monitoring tools to detect and alert on such activity."}, {"techniqueID": "T1027", "comment": "CVE-2024-27102 - To exploit this vulnerability, an attacker must have an existing 'server' allocated and controlled by Wings, highlighting the importance of proper server setup and configuration. Defenders can implement robust server Hardening and configuration validation to prevent exploitation."}], "stix_bundle": {"@stix_Bundle": {"type": "bundle", "id": "bundle--a7d4c2a4-8da2-40f5-b4d8-dc79a6a6f6e0", "label": "CVE-2024-27102 Bundle"}, "objects": [{"@observable": {"type": "vulnerability", "id": "vulnerability--c4e6dcd4-77b7-45b3-9a64-8c44c86db1a2", "label": "CVE-2024-27102", "created_by_ref": "identity--28c4c7f0-22a8-455b-b4a3-8dcece2c7d36", "created": "2024-03-13T21:15:59.590Z"}}, {"@exploit": {"type": "attack-pattern", "id": "attack-pattern--f0f0f0f0-f0f0-f0f0-f0f0-f0f0f0f0f0f0", "label": "Wings Server File Access Exploit", "description": "Exploits the vulnerability in Wings server control plane.", "created_by_ref": "identity--28c4c7f0-22a8-455b-b4a3-8dcece2c7d36", "created": "2024-03-13T21:15:59.590Z"}}, {"@tactic": {"type": "tactic", "id": "tactic--a1b2c3d4-e5f6-g7h8-i9j0", "label": "Lateral Movement", "description": "Attackers use exploits in existing control to move laterally within a network.", "created_by_ref": "identity--28c4c7f0-22a8-455b-b4a3-8dcece2c7d36", "created": "2024-03-13T21:15:59.590Z"}}], "relationships": [{"type": "has-part", "id": "r2", "source_ref": "bundle--a7d4c2a4-8da2-40f5-b4d8-dc79a6a6f6e0", "target_ref": "vulnerability--c4e6dcd4-77b7-45b3-9a64-8c44c86db1a2"}, {"type": "used-by", "id": "r3", "source_ref": "vulnerability--c4e6dcd4-77b7-45b3-9a64-8c44c86db1a2", "target_ref": "attack-pattern--f0f0f0f0-f0f0-f0f0-f0f0-f0f0f0f0f0f0"}, {"type": "uses", "id": "r4", "source_ref": "attack-pattern--f0f0f0f0-f0f0-f0f0-f0f0-f0f0f0f0f0f0", "target_ref": "tactic--a1b2c3d4-e5f6-g7h8-i9j0"}]}, "technical_analysis": {"Introduction": "The CVE-2024-27102 vulnerability in Wings server control plane allows an attacker with existing control over a Wings server to potentially access files and directories outside of a server's base directory.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 9.9. The attack vector is network-based, and an attacker must have an existing 'server' allocated and controlled by Wings to exploit this vulnerability.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1210, T1204, and T1027, which involve reading files outside of a server's base directory, exploiting server file access, and exploiting existing control over a Wings server.", "Technical Details": "The vulnerability is due to the improper handling of server file access, allowing an attacker to read files outside of a server's base directory. This can be mitigated by implementing proper access controls and segmentation of servers.", "Detection": "Detection can be done by monitoring file access patterns and anomalies, as well as implementing intrusion detection systems and file integrity monitoring tools.", "Mitigation": "The primary mitigation strategy is to implement proper access controls and segmentation of servers. Additionally, implementing intrusion detection systems and file integrity monitoring tools can help detect and alert on exploitation attempts.", "Conclusion": "The CVE-2024-27102 vulnerability in Wings server control plane is a high-impact vulnerability that can be exploited by an attacker with existing control over a Wings server. Implementing proper access controls and segmentation of servers, as well as monitoring for signs of exploitation, can help mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-27102 vulnerability in Wings server control plane is a critical vulnerability that can have significant business and technical impacts.", "Business Impact": "This vulnerability can cause significant business disruptions, particularly if an attacker gains unauthorized access to sensitive data or systems.", "Technical Impact": "The technical impact of this vulnerability is also significant, as it allows an attacker to move laterally within a network and potentially compromise sensitive systems.", "Mitigation Strategies": "Mitigation strategies include implementing proper access controls and segmentation of servers, as well as monitoring for signs of exploitation.", "Recommendations": "We recommend that impacted organizations take immediate action to mitigate this vulnerability by implementing the recommended mitigation strategies.", "Conclusions": "The CVE-2024-27102 vulnerability in Wings server control plane is a critical vulnerability that requires immediate attention and action to mitigate its impacts."}}