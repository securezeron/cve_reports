{"id": "CVE-2020-7934", "sourceIdentifier": "cve@mitre.org", "published": "2020-01-28T14:15:14.943", "lastModified": "2020-11-23T18:15:11.063", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In LifeRay Portal CE 7.1.0 through 7.2.1 GA2, the First Name, Middle Name, and Last Name fields for user accounts in MyAccountPortlet are all vulnerable to a persistent XSS issue. Any user can modify these fields with a particular XSS payload, and it will be stored in the database. The payload will then be rendered when a user utilizes the search feature to search for other users (i.e., if a user with modified fields occurs in the search results). This issue was fixed in Liferay Portal CE version 7.3.0 GA1."}, {"lang": "es", "value": "En LifeRay Portal CE versiones 7.1.0 hasta 7.2.1 GA2, los campos First Name, Middle Name, y Last Name para las cuentas de usuario en MyAccountPortlet son vulnerables a un problema de tipo XSS persistente. Cualquier usuario puede modificar estos campos con una carga \u00fatil XSS particular, y ser\u00e1 almacenada en la base de datos. La carga \u00fatil entonces ser\u00e1 renderizada cuando un usuario utilice la funcionalidad search para buscar a otros usuarios (es decir, si se presenta un usuario con campos modificados en los resultados de la b\u00fasqueda). Este problema fue corregido en el Portal Liferay CE versi\u00f3n 7.3.0 GA1"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:liferay:liferay_portal:*:*:*:*:community:*:*:*", "versionStartIncluding": "7.1.0", "versionEndIncluding": "7.2.1", "matchCriteriaId": "6F3ED980-C91C-4A2F-944D-207C6C78981C"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/160168/LifeRay-7.2.1-GA2-Cross-Site-Scripting.html", "source": "cve@mitre.org"}, {"url": "https://github.com/3ndG4me/liferay-xss-7.2.1GA2-poc-report-CVE-2020-7934", "source": "cve@mitre.org"}, {"url": "https://semanticbits.com/liferay-portal-authenticated-xss-disclosure/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-7934 - User-Interactive Web Content (Persistent XSS) to steal user data. Defend by updating Liferay Portal CE to version 7.3.0 GA1 and validating user input."}, {"techniqueID": "T1204", "comment": "CVE-2020-7934 - Web App Attack Vectors to inject XSS payload. Defend by implementing web application firewalls and validating user input."}, {"techniqueID": "T1584", "comment": "CVE-2020-7934 - Data Stewardship to steal user data. Defend by encrypting user data and implementing access controls."}, {"techniqueID": "T1050", "comment": "CVE-2020-7934 - Web Shell (Persistence) to execute malicious code. Defend by implementing web application firewalls and validating user input."}], "stix_bundle": {"bundle": {"id": "CVE-2020-7934", "type": "vulnerability", "created_byRef": "https://github.com/3ndG4me/liferay-xss-7.2.1GA2-poc-report-CVE-2020-7934", "created": "2020-01-28T14:15:14.943", "modified": "2020-11-23T18:15:11.063", "description": "In LifeRay Portal CE 7.1.0 through 7.2.1 GA2, the First Name, Middle Name, and Last Name fields for user accounts in MyAccountPortlet are all vulnerable to a persistent XSS issue.", "severity": "MEDIUM", "published": "2020-01-28T14:15:14.943", "references": [{"href": "http://packetstormsecurity.com/files/160168/LifeRay-7.2.1-GA2-Cross-Site-Scripting.html", "type": "reference", "description": "Packet Storm IDS sig"}, {"href": "https://github.com/3ndG4me/liferay-xss-7.2.1GA2-poc-report-CVE-2020-7934", "type": "reference", "description": "GitHub PoC Report"}], "incident_report_refs": [{"href": "https://semanticbits.com/liferay-portal-authenticated-xss-disclosure/", "type": "reference", "description": "Liferay Portal Authenticated XSS Disclosure"}], "tactics": [{"id": "TA0001", "created_byRef": "https://github.com/3ndG4me/liferay-xss-7.2.1GA2-poc-report-CVE-2020-7934", "created": "2020-01-28T14:15:14.943", "modified": "2020-11-23T18:15:11.063", "title": "Initial Access", "description": "Initial access is gained through the vulnerability, allowing the attacker to inject malicious code and steal user data."}, {"id": "TA0002", "created_byRef": "https://github.com/3ndG4me/liferay-xss-7.2.1GA2-poc-report-CVE-2020-7934", "created": "2020-01-28T14:15:14.943", "modified": "2020-11-23T18:15:11.063", "title": "Persistence", "description": "The attacker gains persistence on the system through the injected malicious code, allowing them to steal user data and execute further attacks."}], "mitigations": [{"href": "https://www.d3fend.io/en/techniques/12/edit", "type": "mitigation", "description": "Implement web application firewalls to block malicious traffic."}, {"href": "https://www.d3fend.io/en/techniques/15/edit", "type": "mitigation", "description": "Validate user input to prevent XSS attacks."}]}}, "technical_analysis": {"Introduction": "CVE-2020-7934 is a persistent XSS vulnerability in Liferay Portal CE 7.1.0 through 7.2.1 GA2, affecting user data access.", "Impact and Scope": "The vulnerability has a CVSS score of 5.4, with a network-based attack vector, requiring sensitive data to be accessed from an authenticated session. ", "Related MITRE ATT&CK Techniques": "T1190, T1204, T1584, T1050", "Technical Details": "The vulnerability allows an attacker to inject malicious code into the First Name, Middle Name, and Last Name fields for user accounts in MyAccountPortlet, allowing them to steal user data.", "Detection": "Detection methods include monitoring for unusual traffic patterns, validating user input, and implementing web application firewalls.", "Mitigation": "Mitigation strategies include updating Liferay Portal CE to version 7.3.0 GA1, validating user input, implementing web application firewalls, and encrypting user data.", "Conclusion": "In conclusion, CVE-2020-7934 is a significant vulnerability that allows attackers to steal user data through a persistent XSS attack. It is crucial to update to the latest version of Liferay Portal CE and implement robust security measures to mitigate this threat."}, "executive_analysis": {"Overview": "CVE-2020-7934 is a vulnerability in Liferay Portal CE that allows attackers to steal user data through a persistent XSS attack.", "Business Impact": "The vulnerability poses a significant risk to user data and could lead to financial losses, reputation damage, and legal consequences.", "Technical Impact": "The vulnerability compromises user data security, allowing attackers to steal sensitive information.", "Mitigation Strategies": "Implementing web application firewalls, validating user input, and encrypting user data are recommended mitigation strategies.", "Recommendations": "Executives should prioritize patching and updating Liferay Portal CE to version 7.3.0 GA1, implementing robust security measures to prevent further breaches.", "Conclusions": "In conclusion, CVE-2020-7934 is a critical vulnerability that requires immediate attention and mitigation. Executives should prioritize patching and implementing robust security measures to protect user data."}}