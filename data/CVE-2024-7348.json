{"id": "CVE-2024-7348", "sourceIdentifier": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007", "published": "2024-08-08T13:15:14.007", "lastModified": "2024-08-12T15:54:52.320", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Time-of-check Time-of-use (TOCTOU) race condition in pg_dump in PostgreSQL allows an object creator to execute arbitrary SQL functions as the user running pg_dump, which is often a superuser. The attack involves replacing another relation type with a view or foreign table. The attack requires waiting for pg_dump to start, but winning the race condition is trivial if the attacker retains an open transaction. Versions before PostgreSQL 16.4, 15.8, 14.13, 13.16, and 12.20 are affected."}, {"lang": "es", "value": "La condici\u00f3n de ejecuci\u00f3n de tiempo de verificaci\u00f3n de tiempo de uso (TOCTOU) en pg_dump en PostgreSQL permite a un creador de objetos ejecutar funciones SQL arbitrarias como el usuario que ejecuta pg_dump, que a menudo es un superusuario. El ataque implica reemplazar otro tipo de relaci\u00f3n con una vista o tabla externa. El ataque requiere esperar a que se inicie pg_dump, pero ganar la condici\u00f3n de ejecuci\u00f3n es trivial si el atacante retiene una transacci\u00f3n abierta. Las versiones anteriores a PostgreSQL 16.4, 15.8, 14.13, 13.16 y 12.20 se ven afectadas."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.6, "impactScore": 5.9}, {"source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-367"}]}, {"source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-367"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "12.0", "versionEndExcluding": "12.20", "matchCriteriaId": "1406C6A7-1C35-4474-ACDB-BA846C24F21B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "13.0", "versionEndExcluding": "13.16", "matchCriteriaId": "8FADD5D0-8034-4379-8C8F-2EB545AF97A9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "14.0", "versionEndExcluding": "14.13", "matchCriteriaId": "5BC17304-2D09-4162-9010-02C4ED82B9EA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "15.0", "versionEndExcluding": "15.8", "matchCriteriaId": "7A8C15B7-5796-44FA-8A83-01DAF7B226ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "16.0", "versionEndExcluding": "16.4", "matchCriteriaId": "7DDD83C9-C0AF-464E-A367-481E5556B970"}]}]}], "references": [{"url": "https://www.postgresql.org/support/security/CVE-2024-7348/", "source": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "This CVE is related to a TOCTOU race condition in pg_dump in PostgreSQL, allowing an authenticated attacker to execute arbitrary SQL functions as a superuser. This is a relevant technique as it could be used to exploit the vulnerability, allowing an attacker to gain elevated privileges."}, {"techniqueID": "T1038", "comment": "This CVE is related to the use of a TOCTOU race condition in pg_dump in PostgreSQL, which could be used by an attacker to replace another relation type with a view or foreign table. This technique could be used to exploit the vulnerability, allowing an attacker to perform unauthorized actions."}], "stix_bundle": {"cybox": {"Object": {"Id": "CVE-2024-7348", "Title": "Time-of-check Time-of-use (TOCTOU) race condition in pg_dump in PostgreSQL", "Description": [{"Language": "en", "Value": "Time-of-check Time-of-use (TOCTOU) race condition in pg_dump in PostgreSQL allows an object creator to execute arbitrary SQL functions as the user running pg_dump, which is often a superuser. The attack involves replacing another relation type with a view or foreign table."}], "Created": "2024-08-08T13:15:14.007", "Modified": "2024-08-12T15:54:52.320", "Contributors": [{"Name": "f86ef6dc-4d3a-42ad-8f28-e6d5547a5007", "Role": "Vulnerability Researcher"}]}, "Observables": [{"Id": "CVE-2024-7348", "Type": "process", "ParentId": "CVE-2024-7348", "Value": "pg_dump"}], "Relationships": [{"Id": "CVE-2024-7348", "TargetId": "T1190", "Relationship": "exploits", "Type": "technique"}, {"Id": "CVE-2024-7348", "TargetId": "T1038", "Relationship": "exploits", "Type": "technique"}]}, "note": "This STIX bundle was automatically generated using the provided CVE data. It includes the vulnerability as the main object and all related techniques, as well as related observables and relationships."}, "technical_analysis": {"Introduction": "The CVE-2024-7348 is a TOCTOU race condition in pg_dump in PostgreSQL, allowing an authenticated attacker to execute arbitrary SQL functions as a superuser.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 7.5 and a CVSS vector of AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H. The scope of the vulnerability is PostgreSQL versions before 16.4, 15.8, 14.13, 13.16, and 12.20.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to MITRE ATT&CK techniques T1190 and T1038, which could be used to exploit the vulnerability and gain elevated privileges.", "Technical Details": "The vulnerability occurs when an authenticated attacker replaces another relation type with a view or foreign table, allowing them to execute arbitrary SQL functions as the user running pg_dump.", "Detection": "Detection of this vulnerability can be done using intrusion detection systems and vulnerability scanners that check for the presence of the vulnerable pg_dump version.", "Mitigation": "Mitigation of this vulnerability can be done by patching the vulnerable version of pg_dump, as well as restricting access to the database administrator.", "Conclusion": "In conclusion, CVE-2024-7348 is a critical vulnerability in PostgreSQL's pg_dump feature, allowing an authenticated attacker to execute arbitrary SQL functions as a superuser. It is important to patch the vulnerable version of pg_dump and restrict access to the database administrator to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-7348 is a critical vulnerability in PostgreSQL's pg_dump feature, allowing an authenticated attacker to execute arbitrary SQL functions as a superuser.", "Business Impact": "The business impact of this vulnerability is high, as it could allow an attacker to gain elevated privileges and conduct unauthorized actions.", "Technical Impact": "The technical impact is high, with a CVSS score of 7.5 and a CVSS vector of AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H.", "Mitigation Strategies": "Patching the vulnerable version of pg_dump, restricting access to the database administrator, and using intrusion detection systems and vulnerability scanners to detect and prevent exploitation.", "Recommendations": "It is recommended that organizations with PostgreSQL installations upgrade to the latest version of pg_dump to mitigate this vulnerability.", "Conclusions": "In conclusion, CVE-2024-7348 is a critical vulnerability that requires immediate attention and action to mitigate. It is important to patch the vulnerable version of pg_dump and restrict access to the database administrator to prevent exploitation."}}