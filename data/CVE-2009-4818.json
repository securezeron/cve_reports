{"id": "CVE-2009-4818", "sourceIdentifier": "cve@mitre.org", "published": "2010-04-27T15:30:00.797", "lastModified": "2017-08-17T01:31:46.180", "vulnStatus": "Modified", "cveTags": [], "evaluatorComment": "Per: http://cwe.mitre.org/data/definitions/434.html\r\n\r\n'CWE-434: Unrestricted Upload of File with Dangerous Type'", "descriptions": [{"lang": "en", "value": "Unrestricted file upload vulnerability in upload.php in PHPSimplicity Simplicity oF Upload 1.3.2 allows remote attackers to execute arbitrary PHP code by uploading a file with a double extension, as demonstrated by .php.gif."}, {"lang": "es", "value": "Vulnerabilidades de subida de archivos sin restricci\u00f3n en upload.php en PHPSimplicity Simplicity oF Upload v1.3.2 permite a atacantes remotos ejecutar c\u00f3digo PHP de su elecci\u00f3n por la carga de un archivo con doble extensi\u00f3n, como ha sido demostrado con uno .php.gif. \r\n"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpsimplicity:simplicity_of_upload:1.3.2:*:*:*:*:*:*:*", "matchCriteriaId": "0180D91E-66EA-4A24-AA2E-16F658FF6F2F"}]}]}], "references": [{"url": "http://www.exploit-db.com/exploits/10568", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.securityfocus.com/bid/37424", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/54952", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1566", "comment": "CVE-2009-4818 - This technique is relevant because it demonstrates the vulnerability to upload and execute arbitrary PHP code. To defend against this, ensure that file uploads are validated and sanitized to prevent unauthorized code execution."}, {"techniqueID": "T1059", "comment": "CVE-2009-4818 - This technique is relevant because it shows the ability to upload and execute arbitrary PHP code. To defend against this, implement restrictions on file uploads and ensure that only authorized users can perform uploads."}, {"techniqueID": "T1190", "comment": "CVE-2009-4818 - This technique is relevant because it demonstrates the ability to upload and execute arbitrary PHP code. To defend against this, implement Input Validation and Sanitization (IVS) to prevent malicious code execution."}], "stix_bundle": "{\"stix_v21\": {..., \\r\n    \"objects\": [\\r\n        {\\r\n            \"type\": \"vulnerability\", \\r\n            \"id\": \"CVE-2009-4818\", \\r\n            \"created_by_ref\": \"my-cve-service\", \\r\n            \"modified\": \"2010-04-27T15:30:00.797\", \\r\n            \"description\": [\\r\n                {\\r\n                    \"lang\": \"en\", \\r\n                    \"value\": \"Unrestricted file upload vulnerability in upload.php in PHPSimplicity Simplicity oF Upload 1.3.2 allows remote attackers to execute arbitrary PHP code by uploading a file with a double extension, as demonstrated by .php.gif.\"\\r\n                }\\r\n            ], \\r\n            \"permissions\": {\\r\n                \"view\": [\\r\n                    \"my-cve-service\"\\r\n                ], \\r\n                \"update\": [\\r\n                    \"my-cve-service\"\\r\n                ], \\r\n                \"delete\": [\\r\n                    \"my-cve-service\"\\r\n                ]\\r\n            }, \\r\n            \"labels\": [\\r\n                \"unrestricted-file-upload\", \\r\n                \"php\", \\r\n                \"file-upload\"\\r\n            ], \\r\n            \"object_marking_refs\": [\\r\n                {\\r\n                    \"label\": \"high-severity\", \\r\n                    \"marker\": \"high-severity\"\\r\n                }\\r\n            ], \\r\n            \"revoked\": false, \\r\n            \"watermark\": \"my-cve-service\", \\r\n            \"objects\": [\\r\n                {\\r\n                    \"type\": \"indication-of-compromise\", \\r\n                    \"id\": \"I-2009-4818\", \\r\n                    \"created_by_ref\": \"my-indicator-service\", \\r\n                    \"modified\": \"2010-04-27T15:30:00.797\", \\r\n                    \"description\": [\\r\n                        {\\r\n                            \"lang\": \"en\", \\r\n                            \"value\": \"Unrestricted file upload vulnerability in upload.php in PHPSimplicity Simplicity oF Upload 1.3.2 allows remote attackers to execute arbitrary PHP code by uploading a file with a double extension, as demonstrated by .php.gif.\"\\r\n                        }\\r\n                    ], \\r\n                    \"permissions\": {\\r\n                        \"view\": [\\r\n                            \"my-indicator-service\"\\r\n                        ], \\r\n                        \"update\": [\\r\n                            \"my-indicator-service\"\\r\n                        ], \\r\n                        \"delete\": [\\r\n                            \"my-indicator-service\"\\r\n                        ]\\r\n                    }, \\r\n                    \"labels\": [\\r\n                        \"file-upload\", \\r\n                        \"php\", \\r\n                        \"high-severity\"\\r\n                    ], \\r\n                    \"object_marking_refs\": [\\r\n                        {\\r\n                            \"label\": \"high-severity\", \\r\n                            \"marker\": \"high-severity\"\\r\n                        }\\r\n                    ], \\r\n                    \"revoked\": false, \\r\n                    \"watermark\": \"my-indicator-service\"\\r\n                }\\r\n            ], \\r\n            \"relationship\": [\\r\\n                {\\r\\n                    \"type\": \"related-to\", \\r\\n                    \"id\": \"RT-2009-4818\", \\r\\n                    \"created_by_ref\": \"my-rel-service\", \\r\\n                    \"modified\": \"2010-04-27T15:30:00.797\", \\r\\n                    \"description\": [\\r\\n                        {\\r\\n                            \"lang\": \"en\", \\r\\n                            \"value\": \"Unrestricted file upload vulnerability in upload.php in PHPSimplicity Simplicity oF Upload 1.3.2 allows remote attackers to execute arbitrary PHP code by uploading a file with a double extension, as demonstrated by .php.gif.\"\\r\\n                        }\\r\\n                    ], \\r\\n                    \"permissions\": {\\r\\n                        \"view\": [\\r\\n                            \"my-rel-service\"\\r\\n                        ], \\r\\n                        \"update\": [\\r\\n                            \"my-rel-service\"\\r\\n                        ], \\r\\n                        \"delete\": [\\r\\n                            \"my-rel-service\"\\r\\n                        ]\\r\\n                    }, \\r\\n                    \"labels\": [\\r\\n                        \"related-to\", \\r\\n                        \"high-severity\"\\r\\n                    ], \\r\\n                    \"object_marking_refs\": [\\r\\n                        {\\r\\n                            \"label\": \"high-severity\", \\r\\n                            \"marker\": \"high-severity\"\\r\\n                        }\\r\\n                    ], \\r\\n                    \"revoked\": false, \\r\\n                    \"watermark\": \"my-rel-service\"\\r\\n                }\\r\\n            ]\\r\\n        }\\r\\n    ]\\r\\n}", "technical_analysis": {"Introduction": "The vulnerability, CVE-2009-4818, is an unrestricted file upload vulnerability in the PHPSimplicity Simplicity oF Upload 1.3.2 version. It allows remote attackers to execute arbitrary PHP code by uploading a file with a double extension.", "Impact and Scope": "The vulnerability has a CVSS score of 6.8, with an attack vector of NETWORK, an access complexity of MEDIUM, and authentication of NONE. This means that in order to exploit the vulnerability, an attacker needs to have network access to the vulnerable system, and does not require any authentication.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK Techniques T1566, T1059, and T1190, which are all related to file upload and code execution.", "Technical Details": "The vulnerability is caused by the fact that the PHP application does not properly validate and sanitize user-uploaded files, which allows an attacker to upload and execute arbitrary PHP code.", "Detection": "The vulnerability can be detected by monitoring the application's file upload process and checking for any suspicious or malicious activity.", "Mitigation": "The vulnerability can be mitigated by implementing strict file upload validation and sanitization, as well as implementing restrictions on file uploads and ensuring that only authorized users can perform uploads.", "Conclusion": "In conclusion, the vulnerability, CVE-2009-4818, is a critical vulnerability in the PHPSimplicity Simplicity oF Upload 1.3.2 version. It allows remote attackers to execute arbitrary PHP code by uploading a file with a double extension. It is related to MITRE ATT&CK Techniques T1566, T1059, and T1190, and can be detected and mitigated by implementing proper file upload validation and sanitization."}, "executive_analysis": {"Overview": "The vulnerability, CVE-2009-4818, is a critical vulnerability in the PHPSimplicity Simplicity oF Upload 1.3.2 version. It allows remote attackers to execute arbitrary PHP code by uploading a file with a double extension.", "Business Impact": "The vulnerability could potentially allow an attacker to gain unauthorized access to the application and execute arbitrary code, which could lead to data breaches, financial loss, and reputational damage.", "Technical Impact": "The vulnerability is caused by a lack of proper file upload validation and sanitization, which makes it easy for an attacker to exploit.", "Mitigation Strategies": "The vulnerability can be mitigated by implementing strict file upload validation and sanitization, as well as implementing restrictions on file uploads and ensuring that only authorized users can perform uploads.", "Recommendations": "It is recommended that all users upgrade to a patched version of the PHPSimplicity Simplicity oF Upload, and that all users implement strict file upload validation and sanitization.", "Conclusions": "In conclusion, the vulnerability, CVE-2009-4818, is a critical vulnerability in the PHPSimplicity Simplicity oF Upload 1.3.2 version. It is important for users to be aware of the vulnerability and take steps to mitigate it."}}