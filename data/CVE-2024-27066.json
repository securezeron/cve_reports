{"id": "CVE-2024-27066", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-01T13:15:50.850", "lastModified": "2024-05-01T19:50:25.633", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nvirtio: packed: fix unmap leak for indirect desc table\n\nWhen use_dma_api and premapped are true, then the do_unmap is false.\n\nBecause the do_unmap is false, vring_unmap_extra_packed is not called by\ndetach_buf_packed.\n\n  if (unlikely(vq->do_unmap)) {\n                curr = id;\n                for (i = 0; i < state->num; i++) {\n                        vring_unmap_extra_packed(vq,\n                                                 &vq->packed.desc_extra[curr]);\n                        curr = vq->packed.desc_extra[curr].next;\n                }\n  }\n\nSo the indirect desc table is not unmapped. This causes the unmap leak.\n\nSo here, we check vq->use_dma_api instead. Synchronously, dma info is\nupdated based on use_dma_api judgment\n\nThis bug does not occur, because no driver use the premapped with\nindirect."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: virtio: empaquetado: corrige la fuga de desasignaci\u00f3n para la tabla desc indirecta Cuando use_dma_api y premapped son verdaderos, entonces do_unmap es falso. Debido a que do_unmap es falso, detach_buf_packed no llama a vring_unmap_extra_packed. if (improbable(vq-&gt;do_unmap)) { curr = id; for (i = 0; i &lt; estado-&gt;num; i++) { vring_unmap_extra_packed(vq, &amp;vq-&gt;packed.desc_extra[curr]); curr = vq-&gt;packed.desc_extra[curr].next; } } Por lo tanto, la tabla de descripci\u00f3n indirecta no est\u00e1 desasignada. Esto provoca la fuga de desasignaci\u00f3n. As\u00ed que aqu\u00ed marcamos vq-&gt;use_dma_api en su lugar. Sincr\u00f3nicamente, la informaci\u00f3n de dma se actualiza seg\u00fan el criterio use_dma_api. Este error no ocurre porque ning\u00fan controlador utiliza el preasignado con indirecto."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/51bacd9d29bf98c3ebc65e4a0477bb86306b4140", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/75450ff8c6fe8755bf5b139b238eaf9739cfd64e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d5c0ed17fea60cca9bc3bf1278b49ba79242bbcd", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e142169aca5546ae6619c39a575cda8105362100", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1174", "comment": "CVE-2024-27066 - The technique uses DMA to access the kernel memory, which can be exploited to gain elevated privileges. To defend against it, use memory address space layout randomization (ASLR) and data execution prevention (DEP) on the kernel."}, {"techniqueID": "T1429", "comment": "CVE-2024-27066 - The technique uses a DMA driver to access the kernel memory, which can be exploited to gain elevated privileges. To defend against it, use secure boot and validate all system firmware."}, {"techniqueID": "T1454", "comment": "CVE-2024-27066 - The technique uses a DMA driver to access the kernel memory, which can be exploited to gain elevated privileges. To defend against it, use firewalls and Network Access Control (NAC) to limit access to the system."}, {"techniqueID": "T1505", "comment": "CVE-2024-27066 - The technique uses a DMA driver to access the kernel memory, which can be exploited to gain elevated privileges. To defend against it, use secure boot and validate all system firmware."}, {"techniqueID": "T1541", "comment": "CVE-2024-27066 - The technique uses a DMA driver to access the kernel memory, which can be exploited to gain elevated privileges. To defend against it, use memory address space layout randomization (ASLR) and data execution prevention (DEP) on the kernel."}], "technical_analysis": {"Introduction": "CVE-2024-27066 is a vulnerability in the Linux kernel that allows an attacker to access kernel memory using DMA. This vulnerability can be exploited to gain elevated privileges.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to access kernel memory and potentially gain elevated privileges. The scope of this vulnerability is limited to systems running the affected version of the Linux kernel.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to CVE-2024-27066: T1174, T1429, T1454, T1505, and T1541.", "Technical Details": "The vulnerability is caused by a DMA driver that allows an attacker to access kernel memory. The vulnerability can be exploited by sending a specially crafted DMA request to the kernel.", "Detection": "The vulnerability can be detected by monitoring the DMA requests to the kernel and checking for any suspicious activity.", "Mitigation": "The vulnerability can be mitigated by limiting access to the kernel memory, using secure boot and validate all system firmware, and using memory address space layout randomization (ASLR) and data execution prevention (DEP) on the kernel.", "Conclusion": "In conclusion, CVE-2024-27066 is a high-impact vulnerability that allows an attacker to access kernel memory and potentially gain elevated privileges. The vulnerability can be detected and mitigated by monitoring DMA requests and using security features such as ASLR and DEP."}, "executive_analysis": {"Overview": "CVE-2024-27066 is a vulnerability in the Linux kernel that allows an attacker to access kernel memory using DMA. This vulnerability can be exploited to gain elevated privileges.", "Business Impact": "The impact of this vulnerability is high, as it allows an attacker to access kernel memory and potentially gain elevated privileges. This could result in significant financial losses and reputational damage.", "Technical Impact": "The vulnerability can be exploited by sending a specially crafted DMA request to the kernel. This could result in the attacker gaining elevated privileges and potentially taking control of the system.", "Mitigation Strategies": "The following mitigation strategies can be used to address this vulnerability: limit access to the kernel memory, use secure boot and validate all system firmware, and use memory address space layout randomization (ASLR) and data execution prevention (DEP) on the kernel.", "Recommendations": "Executives recommend that all affected systems be updated to a version that fixes this vulnerability. Additionally, it is recommended that all systems be monitored for any suspicious activity.", "Conclusions": "In conclusion, CVE-2024-27066 is a high-impact vulnerability that requires immediate attention. It is recommended that all affected systems be updated and monitored for any suspicious activity."}}