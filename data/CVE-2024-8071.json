{"id": "CVE-2024-8071", "sourceIdentifier": "responsibledisclosure@mattermost.com", "published": "2024-08-22T07:15:04.830", "lastModified": "2024-08-23T15:34:53.913", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Mattermost versions 9.9.x <= 9.9.1, 9.5.x <= 9.5.7, 9.10.x <= 9.10.0 and 9.8.x <= 9.8.2 fail to restrict which roles can promote a user as system admin which allows a System Role with edit access to the permissions section of system console to update their role (e.g. member) to include the `manage_system` permission, effectively becoming a System Admin."}, {"lang": "es", "value": "Las versiones de Mattermost 9.9.x &lt;= 9.9.1, 9.5.x &lt;= 9.5.7, 9.10.x &lt;= 9.10.0 y 9.8.x &lt;= 9.8.2 no restringen qu\u00e9 roles pueden promover a un usuario como administrador del sistema y cu\u00e1les permite que una funci\u00f3n del sistema con acceso de edici\u00f3n a la secci\u00f3n de permisos de la consola del sistema actualice su funci\u00f3n (por ejemplo, miembro) para incluir el permiso `manage_system`, convirti\u00e9ndose efectivamente en un administrador del sistema."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}, {"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-284"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.5.0", "versionEndExcluding": "9.5.8", "matchCriteriaId": "7FEEA8D7-745A-49FF-8B01-CA0D1D820D48"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.8.0", "versionEndExcluding": "9.8.3", "matchCriteriaId": "9B9B4EAB-A618-4823-BECD-0BFD3D76A9D2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.9.0", "versionEndExcluding": "9.9.2", "matchCriteriaId": "A445A478-E185-49DF-8CDC-F42BBF8577D4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mattermost:mattermost:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.10.0", "versionEndExcluding": "9.10.1", "matchCriteriaId": "0CA40F21-914D-4891-A578-02E6F35FE249"}]}]}], "references": [{"url": "https://mattermost.com/security-updates", "source": "responsibledisclosure@mattermost.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1184", "comment": "CVE-2024-8071 - The vulnerability allows an attacker to promote a user to a system admin without proper access control, making it a potential entry point for attackers. Defending against this requires restricting which roles can promote a user as system admin and implementing robust access controls."}, {"techniqueID": "T1190", "comment": "CVE-2024-8071 - The vulnerability allows an attacker to update system permissions without proper authorization, making it a potential stealth attack vector. Defending against this requires implementing robust permission checks and access controls."}, {"techniqueID": "T1068", "comment": "CVE-2024-8071 - The vulnerability allows an attacker to compromise system admin privileges without proper authentication, making it a potential privilege escalation vulnerability. Defending against this requires implementing robust authentication and authorization controls."}], "stix_bundle": {"objects": [{"id": "https://example.com/vulnerability/CVE-2024-8071", "type": "vulnerability", "created_by_ref": "https://example.com/user/admin", "modified": "2024-08-23T15:34:53.913", "created": "2024-08-22T07:15:04.830", "name": "Mattermost Privilege Escalation", "description": "Mattermost versions 9.9.x <= 9.9.1, 9.5.x <= 9.5.7, 9.10.x <= 9.10.0 and 9.8.x <= 9.8.2 fail to restrict which roles can promote a user as system admin which allows a System Role with edit access to the permissions section of system console to update their role (e.g. member) to include the `manage_system` permission, effectively becoming a System Admin.", "severity": "high", "cvss3_score": 7.2, "cvss3_attacker_complexity": "LOW", "cvss3_attack_vector": "NETWORK", "cvss3_availability_impact": "HIGH", "cvss3_attackvector": "NETWORK", "cvss3_attackcomplexity": "LOW", "cvss3_privilegesrequired": "HIGH", "cvss3_userinteraction": "NONE", "cvss3_scope": "UNCHANGED", "cvss3_confidentialityimpact": "HIGH", "cvss3_integrityimpact": "HIGH", "cvss3_availabilityimpact": "HIGH", "impact_score": 5.9, "exploitability_score": 1.2, "cost_req_score": 1, "discovered": true, "source": "responsibledisclosure@mattermost.com", "references": [{"resource": "https://mattermost.com/security-updates"}], "objects": [{"id": "https://example.com/technique/T1184", "type": "attack-pattern", "created_by_ref": "https://example.com/user/admin", "modified": "2024-08-23T15:34:53.913", "created": "2024-08-22T07:15:04.830", "name": "Reflective File Download", "description": "The attacker downloads a file from a remote location and saves it to a local file on the system."}, {"id": "https://example.com/technique/T1190", "type": "attack-pattern", "created_by_ref": "https://example.com/user/admin", "modified": "2024-08-23T15:34:53.913", "created": "2024-08-22T07:15:04.830", "name": "Privilege Escalation", "description": "The attacker gains elevated privileges on a system."}, {"id": "https://example.com/technique/T1068", "type": "attack-pattern", "created_by_ref": "https://example.com/user/admin", "modified": "2024-08-23T15:34:53.913", "created": "2024-08-22T07:15:04.830", "name": "Privilege Escalation via Logon Module", "description": "The attacker gains elevated privileges on a system using a logon module."}]}]}, "technical_analysis": {"Introduction": "CVE-2024-8071 is a privilege escalation vulnerability in Mattermost that allows an attacker to promote a user to a system admin without proper access control.", "Impact and Scope": "The vulnerability can be exploited to gain system admin privileges on affected systems, potentially leading to data theft, data destruction, or takeovers.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to techniques such as Privilege Escalation, Privilege Escalation via Logon Module, and Reflective File Download.", "Technical Details": "The vulnerability is caused by a failure to properly restrict which roles can promote a user as system admin, allowing an attacker to update system permissions without proper authorization.", "Detection": "Detection can be done using log analysis tools and network traffic analysis tools.", "Mitigation": "The vulnerability can be mitigated by restricting which roles can promote a user as system admin, implementing robust access controls, and patching affected systems.", "Conclusion": "CVE-2024-8071 is a high-severity vulnerability that can be exploited to gain system admin privileges on affected systems."}, "executive_analysis": {"Overview": "CVE-2024-8071 is a privilege escalation vulnerability in Mattermost that can be exploited to gain system admin privileges on affected systems.", "Business Impact": "The vulnerability can potentially lead to data theft, data destruction, or takeovers, causing significant financial and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to gain elevated privileges on a system, potentially allowing for unauthorized access to sensitive data.", "Mitigation Strategies": "Implementing robust access controls, patching affected systems, and restricting which roles can promote a user as system admin can mitigate the vulnerability.", "Recommendations": "It is recommended that administrators patch affected systems and implement robust access controls to prevent exploitation of the vulnerability.", "Conclusions": "CVE-2024-8071 is a high-severity vulnerability that requires immediate attention and action to prevent exploitation."}}