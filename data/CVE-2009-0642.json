{"id": "CVE-2009-0642", "sourceIdentifier": "cve@mitre.org", "published": "2009-02-20T06:47:48.297", "lastModified": "2017-09-29T01:33:56.263", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "ext/openssl/ossl_ocsp.c in Ruby 1.8 and 1.9 does not properly check the return value from the OCSP_basic_verify function, which might allow remote attackers to successfully present an invalid X.509 certificate, possibly involving a revoked certificate."}, {"lang": "es", "value": "ext/openssl/ossl_ocsp.c en Ruby v1.8 y v1.9 no comprueba adecuadamente el valor de retorno de la funcion OCSP_basic_verify, lo cual permitiria a atacantes remotos tener exito en la presentacion de un certificado X.509 invalido, posiblemente utilizando un certificado revocado."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-287"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:1.8:*:*:*:*:*:*:*", "matchCriteriaId": "3EA01D6F-3B61-44EC-A6EA-9E878A0D5B99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:1.9:*:*:*:*:*:*:*", "matchCriteriaId": "D9237145-35F8-4E05-B730-77C0F386E5B2"}]}]}], "references": [{"url": "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=513528", "source": "cve@mitre.org"}, {"url": "http://redmine.ruby-lang.org/issues/show/1091", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://secunia.com/advisories/33750", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/35699", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/35937", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2009:193", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2009-1140.html", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/33769", "source": "cve@mitre.org"}, {"url": "http://www.securitytracker.com/id?1022505", "source": "cve@mitre.org"}, {"url": "http://www.ubuntu.com/usn/USN-805-1", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/48761", "source": "cve@mitre.org"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A11450", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1566", "comment": "Forge an X.509 certificate by modifying the OCSP_basic_verify function in Ruby 1.8 and 1.9. - CVE-2009-0642 - This vulnerability allows an attacker to present an invalid X.509 certificate, possibly involving a revoked certificate, making it necessary to implement proper certificate verification in Ruby applications."}, {"techniqueID": "T1204", "comment": "Modify the OCSP_basic_verify function in Ruby 1.8 and 1.9 to bypass certificate validation. - CVE-2009-0642 - This vulnerability allows an attacker to successfully present an invalid X.509 certificate, possibly involving a revoked certificate, making it necessary to implement proper certificate verification in Ruby applications."}, {"techniqueID": "T1020", "comment": "Use the OCSP_basic_verify function in Ruby 1.8 and 1.9 to validate an invalid X.509 certificate. - CVE-2009-0642 - This vulnerability allows an attacker to successfully present an invalid X.509 certificate, possibly involving a revoked certificate, making it necessary to implement proper certificate verification in Ruby applications."}, {"techniqueID": "T1190", "comment": "Use the OCSP_basic_verify function in Ruby 1.8 and 1.9 to validate a revoked X.509 certificate. - CVE-2009-0642 - This vulnerability allows an attacker to successfully present an invalid X.509 certificate, possibly involving a revoked certificate, making it necessary to implement proper certificate verification in Ruby applications."}], "technical_analysis": {"Introduction": "The vulnerability CVE-2009-0642 is a CWE-287 issue in Ruby 1.8 and 1.9, affecting the OCSP_basic_verify function in the ossl_ocsp.c extension. This vulnerability allows an attacker to present an invalid X.509 certificate, possibly involving a revoked certificate, making it necessary to implement proper certificate verification in Ruby applications.", "Impact and Scope": "CVSS Score: 6.8, Vector: (AV:N/AC:M/Au:N/C:P/I:P/A:P) - The vulnerability has a potential confidentiality impact of Partial, integrity impact of Partial, and availability impact of Partial. attackers can exploit this vulnerability to bypass certificate validation and present an invalid X.509 certificate.", "Related MITRE ATT&CK Techniques": "T1566, T1204, T1020, T1190", "Technical Details": "The vulnerability is due to improper validation of the OCSP response by the OCSP_basic_verify function. The function does not properly check the return value from the OCSP_basic_verify function, which can be exploited by an attacker to bypass certificate validation and present an invalid X.509 certificate.", "Detection": "Detecting this vulnerability can be challenging as it requires identifying the improper validation of the OCSP response by the OCSP_basic_verify function. Implementing proper certificate verification mechanisms and logging can help detect this vulnerability.", "Mitigation": "Implement proper certificate verification mechanisms, such as OpenSSL's verify function, in Ruby applications. Ensure that the OCSP response is properly validated before trusting it. Implement logging and monitoring to detect and respond to potential attacks.", "Conclusion": "In conclusion, the vulnerability CVE-2009-0642 is a significant issue affecting Ruby 1.8 and 1.9. It is essential to implement proper certificate verification mechanisms and logging to detect and respond to potential attacks."}, "executive_analysis": {"Overview": "The vulnerability CVE-2009-0642 is a significant issue affecting Ruby 1.8 and 1.9, allowing attackers to bypass certificate validation and present an invalid X.509 certificate.", "Business Impact": "This vulnerability can have a significant business impact, potentially leading to data breaches, loss of customer trust, and reputational damage.", "Technical Impact": "The vulnerability has a significant technical impact, allowing attackers to bypass certificate validation and present an invalid X.509 certificate, making it necessary to implement proper certificate verification mechanisms.", "Mitigation Strategies": "Implementing proper certificate verification mechanisms and logging can help mitigate this vulnerability.", "Recommendations": "Recommendations for executives include prioritizing the patching of affected systems, implementing proper certificate verification mechanisms, and regularly monitoring and logging system activity.", "Conclusions": "In conclusion, it is essential for executives to be aware of this vulnerability and take necessary steps to mitigate it."}}