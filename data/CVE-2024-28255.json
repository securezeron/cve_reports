{"id": "CVE-2024-28255", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-15T20:15:10.270", "lastModified": "2024-03-17T22:38:29.433", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "OpenMetadata is a unified platform for discovery, observability, and governance powered by a central metadata repository, in-depth lineage, and seamless team collaboration. The `JwtFilter` handles the API authentication by requiring and verifying JWT tokens. When a new request comes in, the request's path is checked against this list. When the request's path contains any of the excluded endpoints the filter returns without validating the JWT. Unfortunately, an attacker may use Path Parameters to make any path contain any arbitrary strings. For example, a request to `GET /api/v1;v1%2fusers%2flogin/events/subscriptions/validation/condition/111` will match the excluded endpoint condition and therefore will be processed with no JWT validation allowing an attacker to bypass the authentication mechanism and reach any arbitrary endpoint, including the ones listed above that lead to arbitrary SpEL expression injection. This bypass will not work when the endpoint uses the `SecurityContext.getUserPrincipal()` since it will return `null` and will throw an NPE. This issue may lead to authentication bypass and has been addressed in version 1.2.4. Users are advised to upgrade. There are no known workarounds for this vulnerability. This issue is also tracked as `GHSL-2023-237`."}, {"lang": "es", "value": "OpenMetadata es una plataforma unificada para el descubrimiento, la observabilidad y la gobernanza impulsada por un repositorio central de metadatos, un linaje profundo y una colaboraci\u00f3n fluida en equipo. El `JwtFilter` maneja la autenticaci\u00f3n API solicitando y verificando tokens JWT. Cuando llega una nueva solicitud, la ruta de la solicitud se compara con esta lista. Cuando la ruta de la solicitud contiene cualquiera de los endpoints excluidos, el filtro regresa sin validar el JWT. Desafortunadamente, un atacante puede usar par\u00e1metros de ruta para hacer que cualquier ruta contenga cadenas arbitrarias. Por ejemplo, una solicitud para `GET /api/v1;v1%2fusers%2flogin/events/subscriptions/validation/condition/111` coincidir\u00e1 con la condici\u00f3n del endpoint excluido y, por lo tanto, se procesar\u00e1 sin validaci\u00f3n JWT, lo que permitir\u00e1 a un atacante eludir el mecanismo de autenticaci\u00f3n y llegar a cualquier endpoint arbitrario, incluidos los enumerados anteriormente que conducen a la inyecci\u00f3n de expresi\u00f3n SpEL arbitraria. Esta omisi\u00f3n no funcionar\u00e1 cuando el endpoint utilice `SecurityContext.getUserPrincipal()` ya que devolver\u00e1 `null` y generar\u00e1 un NPE. Este problema puede provocar una omisi\u00f3n de autenticaci\u00f3n y se solucion\u00f3 en la versi\u00f3n 1.2.4. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad. Este problema tambi\u00e9n se rastrea como \"GHSL-2023-237\"."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-287"}]}], "references": [{"url": "https://github.com/open-metadata/OpenMetadata/blob/e2043a3f31312ebb42391d6c93a67584d798de52/openmetadata-service/src/main/java/org/openmetadata/service/security/JwtFilter.java#L111", "source": "security-advisories@github.com"}, {"url": "https://github.com/open-metadata/OpenMetadata/blob/e2043a3f31312ebb42391d6c93a67584d798de52/openmetadata-service/src/main/java/org/openmetadata/service/security/JwtFilter.java#L113", "source": "security-advisories@github.com"}, {"url": "https://github.com/open-metadata/OpenMetadata/security/advisories/GHSA-6wx7-qw5p-wh84", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1078", "comment": "CVE-2024-28255 - This vulnerability is relevant to CVE-2024-28255 as it showcases the use of Path Parameters to bypass authentication checks, allowing an attacker to reach arbitrary endpoints. This can be mitigated by implementing proper authentication and authorization mechanisms."}, {"techniqueID": "T1568", "comment": "CVE-2024-28255 - This vulnerability is also relevant as it involves the use of arbitrary path parameters to inject malicious code, making it a common attack vector in web applications. This can be mitigated by implementing input validation and sanitization mechanisms."}], "stix_bundle": {"bundle": {"type": "Bundle", "id": "bundle-cve-2024-28255", "created_by_ref": "", "created": "2024-03-15T20:15:10.270", "modified": "2024-03-17T22:38:29.433", "objects": [{"type": "Vulnerability", "id": "vulnerability-cve-2024-28255", "name": "OpenMetadata Authentication Bypass", "description": {"description_type": "rich_text", "text": "This vulnerability allows an attacker to bypass authentication checks in OpenMetadata by using arbitrary path parameters."}, "references": [{"type": "Reference", "id": "reference-1", "relationship": "related_to", "source_name": "security-advisories@github.com", "source_reference": "https://github.com/open-metadata/OpenMetadata/blob/e2043a3f31312ebb42391d6c93a67584d798de52/openmetadata-service/src/main/java/org/openmetadata/service/security/JwtFilter.java#L111"}]}, {"type": "Course_of_Action", "id": "course-of-action-1", "name": "Upgrade to version 1.2.4", "description": {"description_type": "rich_text", "text": "Upgrade to version 1.2.4 to mitigate this vulnerability."}, "related_to_refs": [{"relationship": "mitigates", "source_ref": "vulnerability-cve-2024-28255"}]}, {"type": "Tactic", "id": "technique-T1078", "name": "Valid MITRE 1 Technique ID", "description": {"description_type": "rich_text", "text": "This technique is used to demonstrate the use of Path Parameters to bypass authentication checks."}, "related_to_refs": [{"relationship": "used_by", "source_ref": "vulnerability-cve-2024-28255"}]}, {"type": "Tactic", "id": "technique-T1568", "name": "Valid MITRE 1 Technique ID", "description": {"description_type": "rich_text", "text": "This technique is used to demonstrate the use of arbitrary path parameters to inject malicious code."}, "related_to_refs": [{"relationship": "used_by", "source_ref": "vulnerability-cve-2024-28255"}]}]}}, "technical_analysis": {"Introduction": "OpenMetadata is a unified platform for discovery, observability, and governance powered by a central metadata repository, in-depth lineage, and seamless team collaboration.", "Impact and Scope": "The impact of this vulnerability is a potential authentication bypass, which can lead to arbitrary code execution and data tampering.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1078 and T1568, which involve the use of Path Parameters to bypass authentication checks and inject malicious code.", "Technical Details": "The technical details of the vulnerability involve the use of arbitrary path parameters to inject malicious code and bypass authentication checks.", "Detection": "Detection can be performed by monitoring for unusual authentication-related activity and monitoring for malicious code injection.", "Mitigation": "Mitigation can be performed by implementing proper authentication and authorization mechanisms, as well as input validation and sanitization mechanisms.", "Conclusion": "In conclusion, this vulnerability highlights the importance of implementing proper authentication and authorization mechanisms, as well as input validation and sanitization mechanisms, to prevent authentication bypass and malicious code injection attacks."}, "executive_analysis": {"Overview": "OpenMetadata is a unified platform for discovery, observability, and governance powered by a central metadata repository, in-depth lineage, and seamless team collaboration.", "Business Impact": "The business impact of this vulnerability is significant, as it can allow an attacker to execute arbitrary code and tamper with data, potentially leading to financial losses and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is a potential authentication bypass, which can lead to arbitrary code execution and data tampering.", "Mitigation Strategies": "The suggested mitigation strategies include implementing proper authentication and authorization mechanisms, as well as input validation and sanitization mechanisms.", "Recommendations": "Recommendations for executives include implementing proper authentication and authorization mechanisms, as well as implementing input validation and sanitization mechanisms.", "Conclusions": "In conclusion, it is crucial to prioritize the implementation of proper authentication and authorization mechanisms, as well as input validation and sanitization mechanisms, to prevent authentication bypass and malicious code injection attacks."}}