{"id": "CVE-2024-40900", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-12T13:15:13.433", "lastModified": "2024-07-12T16:34:58.687", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ncachefiles: remove requests from xarray during flushing requests\n\nEven with CACHEFILES_DEAD set, we can still read the requests, so in the\nfollowing concurrency the request may be used after it has been freed:\n\n     mount  |   daemon_thread1    |    daemon_thread2\n------------------------------------------------------------\n cachefiles_ondemand_init_object\n  cachefiles_ondemand_send_req\n   REQ_A = kzalloc(sizeof(*req) + data_len)\n   wait_for_completion(&REQ_A->done)\n            cachefiles_daemon_read\n             cachefiles_ondemand_daemon_read\n                                  // close dev fd\n                                  cachefiles_flush_reqs\n                                   complete(&REQ_A->done)\n   kfree(REQ_A)\n              xa_lock(&cache->reqs);\n              cachefiles_ondemand_select_req\n                req->msg.opcode != CACHEFILES_OP_READ\n                // req use-after-free !!!\n              xa_unlock(&cache->reqs);\n                                   xa_destroy(&cache->reqs)\n\nHence remove requests from cache->reqs when flushing them to avoid\naccessing freed requests."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: cachefiles: elimina solicitudes de xarray durante las solicitudes de vaciado Incluso con CACHEFILES_DEAD configurado, a\u00fan podemos leer las solicitudes, por lo que en la siguiente concurrencia la solicitud se puede usar despu\u00e9s de que se haya liberado: mount | daemon_thread1 | daemon_thread2 ------------------------------------------------- --------- Cachefiles_ondemand_init_object Cachefiles_ondemand_send_req req_a = kzalloc (sizeof (*req) + data_len) Wait_for_completion (&amp; req_a-&gt; ded) gratis (req_a ) xa_lock(&amp;cache-&gt;reqs); cachefiles_ondemand_select_req req-&gt;msg.opcode != CACHEFILES_OP_READ // \u00a1\u00a1\u00a1requiere use-after-free !!! xa_unlock(&amp;cache-&gt;reqs); xa_destroy(&amp;cache-&gt;reqs) Por lo tanto, elimine las solicitudes de cache-&gt;reqs cuando las vac\u00ede para evitar acceder a las solicitudes liberadas."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0fc75c5940fa634d84e64c93bfc388e1274ed013", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/37e19cf86a520d65de1de9cb330415c332a40d19", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/50d0e55356ba5b84ffb51c42704126124257e598", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9f13aacdd4ee9a7644b2a3c96d67113cd083c9c7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-40900 - A use-after-free vulnerability in the Linux kernel's cachefiles module, allowing an attacker to read and use after-freed requests. This technique is used to weaponize the vulnerability and trigger the use-after-free condition, leading to arbitrary memory access and potentially code execution."}, {"techniqueID": "T1077", "comment": "CVE-2024-40900 - The vulnerability allows an attacker to perform a use-after-free attack, which can be used to inject arbitrary code and lead to arbitrary memory access, potentially allowing an attacker to execute arbitrary code on the system."}, {"techniqueID": "T1218", "comment": "CVE-2024-40900 - The vulnerability could be used to perform a use-after-free attack, potentially leading to arbitrary memory access and code execution. This technique can be used to weaponize the vulnerability and perform further actions such as persistence, privilege escalation, and exfiltration."}], "stix_bundle": {}, "technical_analysis": {"Introduction": "The CVE-2024-40900 vulnerability is a use-after-free vulnerability in the Linux kernel's cachefiles module, which leads to arbitrary memory access and potentially code execution.", "Impact and Scope": "The vulnerability has a CVSS score of 8.5 with a CVSSv3.1 severity rating of High. It is exploitable remotely without authentication and requires no user interaction.", "Related MITRE ATT&CK Techniques": "T1190, T1077, T1218", "Technical Details": "The vulnerability occurs because the cachefiles_ondemand_init_object function does not properly handle the freeing of requests, leading to use-after-free conditions.", "Detection": "Detection of this vulnerability requires monitoring for use-after-free conditions and analyzing system logs for signs of exploitation.", "Mitigation": "The vulnerability has been resolved in the latest kernel releases. Applying the latest kernel patches is the most effective way to mitigate this vulnerability.", "Conclusion": "The CVE-2024-40900 vulnerability is a high-severity vulnerability that allows arbitrary memory access and potentially code execution. Applying the latest kernel patches and monitoring for use-after-free conditions are the most effective ways to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-40900 vulnerability is a critical security vulnerability in the Linux kernel's cachefiles module that allows arbitrary memory access and potentially code execution.", "Business Impact": "The vulnerability has the potential to impact the confidentiality, integrity, and availability of sensitive data on affected systems.", "Technical Impact": "The vulnerability allows an attacker to inject arbitrary code and potentially execute code on the system, leading to unauthorized data access, modification, and destruction.", "Mitigation Strategies": "Applying the latest kernel patches and monitoring for use-after-free conditions are the most effective ways to mitigate this vulnerability.", "Recommendations": "It is recommended that all affected systems be updated with the latest kernel patches as soon as possible.", "Conclusions": "The CVE-2024-40900 vulnerability is a critical security vulnerability that requires immediate attention and remediation to prevent exploitation and potential data breaches."}}