{"id": "CVE-2024-36930", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-30T16:15:16.217", "lastModified": "2024-06-10T19:20:48.797", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nspi: fix null pointer dereference within spi_sync\n\nIf spi_sync() is called with the non-empty queue and the same spi_message\nis then reused, the complete callback for the message remains set while\nthe context is cleared, leading to a null pointer dereference when the\ncallback is invoked from spi_finalize_current_message().\n\nWith function inlining disabled, the call stack might look like this:\n\n  _raw_spin_lock_irqsave from complete_with_flags+0x18/0x58\n  complete_with_flags from spi_complete+0x8/0xc\n  spi_complete from spi_finalize_current_message+0xec/0x184\n  spi_finalize_current_message from spi_transfer_one_message+0x2a8/0x474\n  spi_transfer_one_message from __spi_pump_transfer_message+0x104/0x230\n  __spi_pump_transfer_message from __spi_transfer_message_noqueue+0x30/0xc4\n  __spi_transfer_message_noqueue from __spi_sync+0x204/0x248\n  __spi_sync from spi_sync+0x24/0x3c\n  spi_sync from mcp251xfd_regmap_crc_read+0x124/0x28c [mcp251xfd]\n  mcp251xfd_regmap_crc_read [mcp251xfd] from _regmap_raw_read+0xf8/0x154\n  _regmap_raw_read from _regmap_bus_read+0x44/0x70\n  _regmap_bus_read from _regmap_read+0x60/0xd8\n  _regmap_read from regmap_read+0x3c/0x5c\n  regmap_read from mcp251xfd_alloc_can_err_skb+0x1c/0x54 [mcp251xfd]\n  mcp251xfd_alloc_can_err_skb [mcp251xfd] from mcp251xfd_irq+0x194/0xe70 [mcp251xfd]\n  mcp251xfd_irq [mcp251xfd] from irq_thread_fn+0x1c/0x78\n  irq_thread_fn from irq_thread+0x118/0x1f4\n  irq_thread from kthread+0xd8/0xf4\n  kthread from ret_from_fork+0x14/0x28\n\nFix this by also setting message->complete to NULL when the transfer is\ncomplete."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: spi: corrige la desreferencia del puntero nulo dentro de spi_sync Si se llama a spi_sync() con la cola no vac\u00eda y luego se reutiliza el mismo spi_message, la devoluci\u00f3n de llamada completa para el mensaje permanece configurada mientras el el contexto se borra, lo que lleva a una desreferencia del puntero nulo cuando se invoca la devoluci\u00f3n de llamada desde spi_finalize_current_message(). Con la funci\u00f3n incorporada deshabilitada, la pila de llamadas podr\u00eda verse as\u00ed: _raw_spin_lock_irqsave from complete_with_flags+0x18/0x58 complete_with_flags from spi_complete+0x8/0xc spi_complete from spi_finalize_current_message+0xec/0x184 spi_finalize_current_message from spi_transfer_one_message+0x2 a8/0x474 spi_transfer_one_message de __spi_pump_transfer_message+0x104/0x230 __spi_pump_transfer_message de __spi_transfer_message_noqueue+0x30/0xc4 __spi_transfer_message_noqueue de __spi_sync+0x204/0x248 __spi_sync de spi_sync+0x24/0x3c spi_sync de mcp251xfd_regmap_crc_read+0x124/0x28c fd] mcp251xfd_regmap_crc_read [mcp251xfd] de _regmap_raw_read+0xf8/0x154 _regmap_raw_read de _regmap_bus_read+0x44/0x70 _regmap_bus_read de _regmap_read+ 0x60/0xd8 _regmap_read de regmap_read+0x3c/0x5c regmap_read de mcp251xfd_alloc_can_err_skb+0x1c/0x54 [mcp251xfd] mcp251xfd_alloc_can_err_skb [mcp251xfd] de mcp251xfd_irq+0x19 4/0xe70 [mcp251xfd] mcp251xfd_irq [mcp251xfd] de irq_thread_fn+0x1c/0x78 irq_thread_fn de irq_thread+0x118/0x1f4 irq_thread de kthread+0xd8/0xf4 kthread de ret_from_fork+0x14/0x28 Solucione este problema configurando tambi\u00e9n mensaje-&gt;completo en NULL cuando se complete la transferencia."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-476"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.0", "versionEndExcluding": "6.1.91", "matchCriteriaId": "54C26F9A-8376-491B-B07E-65C07B72B8D9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2", "versionEndExcluding": "6.6.31", "matchCriteriaId": "CDDB1F69-36AC-41C1-9192-E7CCEF5FFC00"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.8.10", "matchCriteriaId": "6A6B920C-8D8F-4130-86B4-AD334F4CF2E3"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/2070d008cc08bff50a58f0f4d30f12d3ebf94c00", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/4756fa529b2f12b7cb8f21fe229b0f6f47190829", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/a30659f1576d2c8e62e7426232bb18b885fd951a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/e005d6754e3e440257006795b687c4ad8733b493", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1003", "comment": "CVE-2024-36930 - This vulnerability is related to the exploitation of a null pointer dereference in the Linux kernel. Attackers might use this vulnerability to execute arbitrary code, creating a backdoor or installing malware. Organizations should focus on patching and updating their Linux systems to mitigate this risk."}, {"techniqueID": "T1027", "comment": "CVE-2024-36930 - Attackers might use this vulnerability to execute arbitrary code, creating a backdoor or installing malware. To defend against this, organizations should implement robust malware detection and cleaning mechanisms and regularly update their Linux systems."}, {"techniqueID": "T1134", "comment": "CVE-2024-36930 - This vulnerability is related to the exploitation of a null pointer dereference in the Linux kernel. Attackers might use this vulnerability to execute arbitrary code, creating a backdoor or installing malware. Organizations should focus on patching and updating their Linux systems to mitigate this risk."}], "stix_bundle": {"type": "bundle", "objects": [{"type": "incident", "id": "CVE-2024-36930", "name": "CVE-2024-36930", "description": "CVE-2024-36930 - A vulnerability in the Linux kernel that can be exploited by attackers to execute arbitrary code, create a backdoor, or install malware."}, {"type": "attack-pattern", "id": "T1003", "name": "Null Pointer Dereference", "description": "A technique used by attackers to exploit a null pointer dereference in a system."}, {"type": "attack-pattern", "id": "T1027", "name": "Remote Access Tool", "description": "A technique used by attackers to install a remote access tool on a system."}, {"type": "attack-pattern", "id": "T1134", "name": "Networking Device Exploitation", "description": "A technique used by attackers to exploit vulnerabilities in networking devices."}], "relationships": [{"type": "related", "id": "CVE-2024-36930", "relationship": "exploited_by", "object_id": "T1003", "attribute": "Technique ID"}, {"type": "related", "id": "CVE-2024-36930", "relationship": "exploited_by", "object_id": "T1027", "attribute": "Technique ID"}, {"type": "related", "id": "CVE-2024-36930", "relationship": "exploited_by", "object_id": "T1134", "attribute": "Technique ID"}]}, "technical_analysis": {"Introduction": "CVE-2024-36930 is a vulnerability in the Linux kernel that can be exploited by attackers to execute arbitrary code, create a backdoor, or install malware. This analysis will provide an in-depth look at the technical details of the vulnerability.", "Impact and Scope": "The impact of this vulnerability is significant, as it can allow attackers to execute arbitrary code on systems running affected versions of the Linux kernel. The scope of the vulnerability is limited to systems running affected versions of the Linux kernel.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to multiple MITRE ATT&CK techniques, including T1003 (Null Pointer Dereference), T1027 (Remote Access Tool), and T1134 (Networking Device Exploitation).", "Technical Details": "The vulnerability is caused by a null pointer dereference in the Linux kernel. Attackers can exploit this vulnerability by sending a specially crafted packet to a system running an affected version of the Linux kernel.", "Detection": "To detect this vulnerability, organizations can use network traffic monitoring tools to monitor for suspicious traffic patterns and system logs to monitor for signs of exploitation.", "Mitigation": "To mitigate this vulnerability, organizations can patch affected versions of the Linux kernel and implement network traffic filtering rules to block suspicious traffic patterns.", "Conclusion": "CVE-2024-36930 is a significant vulnerability that can be exploited by attackers to execute arbitrary code, create a backdoor, or install malware. Organizations should prioritize patching and updating their Linux systems to mitigate this risk."}, "executive_analysis": {"Overview": "CVE-2024-36930 is a vulnerability in the Linux kernel that can be exploited by attackers to execute arbitrary code, create a backdoor, or install malware.", "Business Impact": "The business impact of this vulnerability is significant, as it can allow attackers to compromise systems running affected versions of the Linux kernel.", "Technical Impact": "The technical impact of this vulnerability is the potential for attackers to execute arbitrary code, create a backdoor, or install malware on systems running affected versions of the Linux kernel.", "Mitigation Strategies": "To mitigate this risk, organizations should prioritize patching and updating their Linux systems and implement network traffic filtering rules to block suspicious traffic patterns.", "Recommendations": "Organizations should prioritize patching and updating their Linux systems and implement network traffic filtering rules to block suspicious traffic patterns.", "Conclusions": "CVE-2024-36930 is a significant vulnerability that requires immediate attention and action. Organizations should prioritize patching and updating their Linux systems and implement network traffic filtering rules to block suspicious traffic patterns."}}