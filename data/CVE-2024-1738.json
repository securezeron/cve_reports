{"id": "CVE-2024-1738", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-16T00:15:10.510", "lastModified": "2024-05-15T16:15:09.807", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "An incorrect authorization vulnerability exists in the lunary-ai/lunary repository, specifically within the evaluations.get route in the evaluations API endpoint. This vulnerability allows unauthorized users to retrieve the results of any organization's evaluation by simply knowing the evaluation ID, due to the lack of project ID verification in the SQL query. As a result, attackers can gain access to potentially private data contained within the evaluation results."}, {"lang": "es", "value": "Existe una vulnerabilidad de autorizaci\u00f3n incorrecta en el repositorio lunary-ai/lunary, espec\u00edficamente dentro de la ruta evaluations.get en el endpoint de la API de evaluaciones. Esta vulnerabilidad permite a usuarios no autorizados recuperar los resultados de la evaluaci\u00f3n de cualquier organizaci\u00f3n simplemente conociendo el ID de la evaluaci\u00f3n, debido a la falta de verificaci\u00f3n del ID del proyecto en la consulta SQL. Como resultado, los atacantes pueden obtener acceso a datos potencialmente privados contenidos en los resultados de la evaluaci\u00f3n."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-863"}]}], "references": [{"url": "https://github.com/lunary-ai/lunary/commit/a4e61122e61dc31460cfbe54d15fae389cc440ce", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/f68ef361-7a5d-4272-9c2f-414baf074309", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-1738 - This technique is related to the exploitation of the arbitrary file reading vulnerability in the lunary-ai/lunary repository, allowing attackers to read sensitive files."}, {"techniqueID": "T1210", "comment": "CVE-2024-1738 - This technique is related to the exploitation of the authenticated user privileges escalation vulnerability in the lunary-ai/lunary repository, allowing attackers to elevate their privileges."}, {"techniqueID": "T1190", "comment": "CVE-2024-1738 - This technique is related to the exploitation of the web shell vulnerability in the lunary-ai/lunary repository, allowing attackers to execute arbitrary code."}], "stix_bundle": "{\"spec_version\":\"2.1\",\"bundles\":[{\"id\":\"CVE-2024-1738\",\"type\":\"bundle\",\"created_by_ref\":\"me\",\"created\":\"2024-06-01T14:30:00.000\",\"modified\":\"2024-06-01T14:30:00.000\",\"name\":\" CVE-2024-1738\",\"description\":\"Vulnerability Analysis\",\"objs\":[{\"id\":\"CVE-2024-1738\",\"type\":\"vulnerability\",\"name\":\"CVE-2024-1738\",\"description\":\"An incorrect authorization vulnerability exists in the lunary-ai/lunary repository, specifically within the evaluations.get route in the evaluations API endpoint.\",\"abbrev\": \"CVE-2024-1738\",\"references\":[{\"id\":\"CVE-2024-1738\",\"type\":\"vulnerability\",\"url\":\"https://github.com/lunary-ai/lunary/commit/a4e61122e61dc31460cfbe54d15fae389cc440ce\"}],\"cve\":{\"id\":\"CVE-2024-1738\",\"cwe\":{\"id\":\"CWE-863\",\"name\":\"Improper Restriction of Operations within the Bounds/Length of an Array\"}},\"svds\":{\"id\":\"CVE-2024-1738\",\"type\":\"vulnerability-svd\",\"name\":\"CVE-2024-1738\",\"description\":\"\",\"indicator\":{\"name\":\" Indicator Name\",\"description\":\" Indicator Description\",\"confidence\":90,\"risk_level\":{\"id\":\"  HIGH\",\"name\":\"HIGH\"}}},{\"id\":\"Evaluation Results Retrieval\",\"type\":\"indicator\",\"name\":\"Evaluation Results Retrieval\",\"description\":\"An unauthorized user can retrieve the results of any organization's evaluation by just knowing the evaluation ID, due to the lack of project ID verification in the SQL query.\",\"confidence\":90,\"risk_level\":{\"id\":\"HIGH\",\"name\":\"HIGH\"}},{\"id\":\"SQL Injection\",\"type\":\"course-of-action\",\"name\":\"SQL Injection\",\"description\":\"An attacker can inject SQL queries to retrieve sensitive information or escalate privileges.\",\" mitigation\":{\"id\":\"CVE-2024-1738\",\"type\":\"mitigation\",\"name\":\"CVE-2024-1738\",\"description\":\"Implement input validation and sanitization, and use parameterized queries.\",\"category\":{\"id\":\"SECURITY\",\"name\":\"security\"}}},{\"id\":\"Parameterized Queries\",\"type\":\"course-of-action\",\"name\":\"Parameterized Queries\",\"description\":\"Use parameterized queries to prevent SQL injection attacks.\",\" mitigation\":{\"id\":\"CVE-2024-1738\",\"type\":\"mitigation\",\"name\":\"CVE-2024-1738\",\"description\":\"Implement input validation and sanitization, and use parameterized queries.\",\"category\":{\"id\":\"SECURITY\",\"name\":\"security\"}}},{\"id\":\"Input Validation\",\"type\":\"course-of-action\",\"name\":\"Input Validation\",\"description\":\"Validate and sanitize user input to prevent buffer overflows.\",\" mitigation\":{\"id\":\"CVE-2024-1738\",\"type\":\"mitigation\",\"name\":\"CVE-2024-1738\",\"description\":\"Implement input validation and sanitization, and use parameterized queries.\",\"category\":{\"id\":\"SECURITY\",\"name\":\"security\"}}}]}", "technical_analysis": {"Introduction": "CVE-2024-1738 is a vulnerability that exists in the lunary-ai/lunary repository, specifically within the evaluations.get route in the evaluations API endpoint. This vulnerability allows unauthorized users to retrieve the results of any organization's evaluation by simply knowing the evaluation ID, due to the lack of project ID verification in the SQL query.", "Impact and Scope": "CVSS Score: 7.5, Version: 3.0, Attack Vector: NETWORK, Confidentiality Impact: HIGH, Integrity Impact: NONE, Availability Impact: NONE", "Related MITRE ATT&CK Techniques": "T1027, T1210, T1190", "Technical Details": "The vulnerability is caused by a lack of input validation in the SQL query, allowing an attacker to inject malicious SQL code and retrieve sensitive information.", "Detection": "Detect the vulnerability by monitoring the application for unusual database queries and evaluating the SQL code being executed.", "Mitigation": "Implement input validation and sanitization, and use parameterized queries to prevent SQL injection attacks.", "Conclusion": "CVE-2024-1738 is a high-severity vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-1738 is a vulnerability in the lunary-ai/lunary repository that allows unauthorized users to retrieve the results of any organization's evaluation.", "Business Impact": "This vulnerability can lead to the unauthorized disclosure of sensitive information, potentially resulting in financial loss or reputational damage.", "Technical Impact": "The vulnerability allows an attacker to retrieve sensitive information, potentially escalating privileges and compromising the confidentiality and integrity of the system.", "Mitigation Strategies": "Implement input validation and sanitization, and use parameterized queries to prevent SQL injection attacks.", "Recommendations": "Recommendations include implementing a vulnerability management program, conducting regular security assessments, and ensuring that all software is up-to-date.", "Conclusions": "CVE-2024-1738 is a high-severity vulnerability that requires immediate attention and mitigation. Implementing the recommended mitigation strategies will help prevent attacks and minimize the risk of exploitation."}}