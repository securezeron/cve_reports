{"id": "CVE-2024-37145", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-01T19:15:03.853", "lastModified": "2024-08-21T14:37:45.993", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Flowise is a drag & drop user interface to build a customized large language model flow. In version 1.4.3 of Flowise, a reflected cross-site scripting vulnerability occurs in the `/api/v1/chatflows-streaming/id` endpoint. If the default configuration is used (unauthenticated), an attacker may be able to craft a specially crafted URL that injects Javascript into the user sessions, allowing the attacker to steal information, create false popups, or even redirect the user to other websites without interaction. If the chatflow ID is not found, its value is reflected in the 404 page, which has type text/html. This allows an attacker to attach arbitrary scripts to the page, allowing an attacker to steal sensitive information. This XSS may be chained with the path injection to allow an attacker without direct access to Flowise to read arbitrary files from the Flowise server. As of time of publication, no known patches are available."}, {"lang": "es", "value": "Flowise es una interfaz de usuario de arrastrar y soltar para crear un flujo de modelo de lenguaje grande personalizado. En la versi\u00f3n 1.4.3 de Flowise, se produce una vulnerabilidad de cross-site scripting reflejado en el endpoint `/api/v1/chatflows-streaming/id`. Si se utiliza la configuraci\u00f3n predeterminada (no autenticada), un atacante puede crear una URL especialmente dise\u00f1ada que inyecta Javascript en las sesiones del usuario, lo que le permite robar informaci\u00f3n, crear ventanas emergentes falsas o incluso redirigir al usuario a otros sitios web sin interacci\u00f3n. Si no se encuentra el ID del flujo de chat, su valor se refleja en la p\u00e1gina 404, que tiene el tipo texto/html. Esto permite a un atacante adjuntar scripts arbitrarios a la p\u00e1gina, lo que le permite robar informaci\u00f3n confidencial. Este XSS puede encadenarse con la inyecci\u00f3n de ruta para permitir que un atacante sin acceso directo a Flowise lea archivos arbitrarios del servidor Flowise. Al momento de la publicaci\u00f3n, no hay parches conocidos disponibles."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:flowiseai:flowise:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.4.3", "matchCriteriaId": "DBDD4038-636B-45D5-9BFA-07AB0D236287"}]}]}], "references": [{"url": "https://github.com/FlowiseAI/Flowise/blob/flowise-ui%401.4.0/packages/server/src/index.ts#L375-L375", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://securitylab.github.com/advisories/GHSL-2023-232_GHSL-2023-234_Flowise/", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-37145 - A reflected cross-site scripting vulnerability occurs in the `/api/v1/chatflows-streaming/id` endpoint, allowing an attacker to steal information, create false popups, or redirect the user to other websites without interaction."}, {"techniqueID": "T1129", "comment": "CVE-2024-37145 - The weakness of CWE-79 allows for a path traversal and can be chained with the reflected XSS to allow an attacker to read arbitrary files from the Flowise server."}, {"techniqueID": "T1509", "comment": "CVE-2024-37145 - An attacker could create a specially crafted URL that injects Javascript into the user sessions, allowing the attacker to steal information, create false popups, or redirect the user to other websites without interaction."}, {"techniqueID": "T1059", "comment": "CVE-2024-37145 - The reflected XSS can be used to steal sensitive information, create false popups, or redirect the user to other websites without interaction."}], "stix_bundle": {"objects": [{"type": "Event", "id": "CVE-2024-37145", "title": "CVE-2024-37145 - Reflected Cross-Site Scripting Vulnerability in Flowise", "description": "A reflected cross-site scripting vulnerability occurs in the `/api/v1/chatflows-streaming/id` endpoint, allowing an attacker to steal information, create false popups, or redirect the user to other websites without interaction."}, {"type": "Object", "id": "CWE-79", "title": "CWE-79 - Cross-Site Scripting", "description": "A weakness in the input validation mechanism, allowing an attacker to inject malicious JavaScript code into the website."}, {"type": "Tactic", "id": "Defense Evasion", "title": "Defense Evasion"}, {"type": "Technique", "id": "T1190", "title": "Exploit Public-Facing Application", "description": "The adversary exploits a publicly known vulnerability in a web application, exploiting the weakness to gain access."}, {"type": "Technique", "id": "T1129", "title": "Scripts and Artifacts", "description": "The adversary uses scripts and artifacts to exploit the weakness and gain access."}, {"type": "Course of Action", "id": "COA-1", "title": "Validate Input", "description": "Validate all user-input data to prevent malicious code from being injected into the website."}, {"type": "Note", "id": "Note-1", "title": "Defense Point", "description": "Regularly update the Flowise application and all its dependencies to ensure the latest security patches are applied."}], "relationships": [{"type": "related_to", "id": "related_to-1", "source": "CVE-2024-37145", "target": "CWE-79"}, {"type": "mitigated_by", "id": "mitigated_by-1", "source": "COA-1", "target": "T1190"}, {"type": "mitigated_by", "id": "mitigated_by-2", "source": "COA-1", "target": "T1129"}, {"type": "contains", "id": "contains-1", "source": "COA-1", "target": "Note-1"}]}, "technical_analysis": {"Introduction": "Flowise is a drag & drop user interface to build a customized large language model flow.", "Impact and Scope": "The reflected cross-site scripting vulnerability in Flowise's `/api/v1/chatflows-streaming/id` endpoint allows an attacker to steal information, create false popups, or redirect the user to other websites without interaction, with a CVSS score of 6.1 (MEDIUM).", "Related MITRE ATT&CK Techniques": "T1190, T1129, T1509, T1059.", "Technical Details": "The vulnerability occurs due to the use of a default configuration that is not authenticated, allowing an attacker to inject malicious JavaScript code into the website.", "Detection": "Detect the vulnerability by monitoring for HTTP requests to the `/api/v1/chatflows-streaming/id` endpoint and analyzing the request parameter for HTML code.", "Mitigation": "Apply regular updates to the Flowise application and its dependencies, and validate all user-input data to prevent malicious code from being injected into the website.", "Conclusion": "The CVE-2024-37145 is a significant vulnerability that can be used to steal information, create false popups, or redirect the user to other websites without interaction."}, "executive_analysis": {"Overview": "Flowise is a drag & drop user interface to build a customized large language model flow that has a reflected cross-site scripting vulnerability.", "Business Impact": "The vulnerability can be used to steal sensitive information, disrupt business operations, and compromise the confidentiality, integrity, and availability of data.", "Technical Impact": "The vulnerability can be used to gain unauthorized access to sensitive data, create false pop-ups, or redirect users to malicious websites.", "Mitigation Strategies": "Apply regular updates to the Flowise application and its dependencies, validate all user-input data, and restrict the use of the `/api/v1/chatflows-streaming/id` endpoint.", "Recommendations": "Implement security-aware development practices, regularly test and validate code for vulnerabilities, and ensure that all dependencies are up-to-date.", "Conclusions": "The vulnerability is a serious security threat that requires immediate attention and action to mitigate the risks to business operations and data confidentiality."}}