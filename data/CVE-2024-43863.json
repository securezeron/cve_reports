{"id": "CVE-2024-43863", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-21T00:15:04.847", "lastModified": "2024-09-03T13:42:44.727", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/vmwgfx: Fix a deadlock in dma buf fence polling\n\nIntroduce a version of the fence ops that on release doesn't remove\nthe fence from the pending list, and thus doesn't require a lock to\nfix poll->fence wait->fence unref deadlocks.\n\nvmwgfx overwrites the wait callback to iterate over the list of all\nfences and update their status, to do that it holds a lock to prevent\nthe list modifcations from other threads. The fence destroy callback\nboth deletes the fence and removes it from the list of pending\nfences, for which it holds a lock.\n\ndma buf polling cb unrefs a fence after it's been signaled: so the poll\ncalls the wait, which signals the fences, which are being destroyed.\nThe destruction tries to acquire the lock on the pending fences list\nwhich it can never get because it's held by the wait from which it\nwas called.\n\nOld bug, but not a lot of userspace apps were using dma-buf polling\ninterfaces. Fix those, in particular this fixes KDE stalls/deadlock."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: drm/vmwgfx: soluciona un punto muerto en el sondeo de valla de dma buf. Introduce una versi\u00f3n de las operaciones de valla que, al lanzarse, no elimina la valla de la lista de pendientes y, por tanto, no requiere un bloqueo para arreglar los puntos muertos de encuesta-&gt;espera de valla-&gt;cerca sin referencia. vmwgfx sobrescribe la devoluci\u00f3n de llamada de espera para iterar sobre la lista de todas las barreras y actualizar su estado; para ello, mantiene un bloqueo para evitar que otros subprocesos modifiquen la lista. La devoluci\u00f3n de llamada de destrucci\u00f3n de valla elimina la valla y la elimina de la lista de vallas pendientes, para las cuales mantiene un bloqueo. dma buf polling cb desrefs una valla despu\u00e9s de haber sido se\u00f1alada: entonces la encuesta llama a la espera, lo que se\u00f1ala las vallas que est\u00e1n siendo destruidas. La destrucci\u00f3n intenta adquirir el bloqueo en la lista de vallas pendientes que nunca puede conseguir porque est\u00e1 retenido por la espera desde la que fue llamado. Error antiguo, pero no muchas aplicaciones de espacio de usuario usaban interfaces de sondeo dma-buf. Solucionarlos, en particular esto soluciona los bloqueos/bloqueos de KDE."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-667"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.18", "versionEndExcluding": "5.15.165", "matchCriteriaId": "A02B7BA9-C2B0-475F-9401-338FBF89D50C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.16", "versionEndExcluding": "6.1.104", "matchCriteriaId": "20DB9042-F89E-4024-B005-ACBBA99CA659"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2", "versionEndExcluding": "6.6.45", "matchCriteriaId": "6ED8FBDF-48EE-4FEB-8B1A-CFF4FBCB27BF"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.10.4", "matchCriteriaId": "1F9FECDC-6CB8-41E5-B32A-E46776100D9C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:6.11:rc1:*:*:*:*:*:*", "matchCriteriaId": "8B3CE743-2126-47A3-8B7C-822B502CF119"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/3b933b16c996af8adb6bc1b5748a63dfb41a82bc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/9e20d028d8d1deb1e7fed18f22ffc01669cf3237", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/a8943969f9ead2fd3044fc826140a21622ef830e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/c98ab18b9f315ff977c2c65d7c71298ef98be8e3", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/e58337100721f3cc0c7424a18730e4f39844934f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1036.005", "comment": "CVE-2024-43863 - This vulnerability can be exploited by an attacker to cause a deadlock in the Linux kernel, leading to a denial-of-service (DoS) condition. This can be mitigated by updating the Linux kernel to a version that is not vulnerable to this issue."}, {"techniqueID": "T1190", "comment": "CVE-2024-43863 - This vulnerability can be exploited by an attacker to compromise legitimate kernel processes, leading to arbitrary code execution. This can be mitigated by implementing memory protection mechanisms and monitoring for suspicious kernel activity."}, {"techniqueID": "T1499", "comment": "CVE-2024-43863 - This vulnerability can be exploited by an attacker to manipulate kernel memory, leading to arbitrary code execution. This can be mitigated by implementing memory protection mechanisms and monitoring for suspicious kernel activity."}], "stix_bundle": {"$schema": "https://stix2.io/schema/2.1/stix-core-v2.1.json", "type": "bundle", "id": "bundle-1234", "created_by_ref": "identity-1234", "created": "2024-08-21T00:15:04.847", "labels": ["CVE-2024-43863", "Linux Kernel"], "objects": [{"type": "marker", "id": "marker-1234", "created_by_ref": "identity-1234", "created": "2024-08-21T00:15:04.847", "description": "CVE-2024-43863: Linux Kernel Vulnerability"}, {"type": "vulnerability", "id": "vulnerability-1234", "created_by_ref": "identity-1234", "created": "2024-08-21T00:15:04.847", "description": "CVE-2024-43863: Linux Kernel Vulnerability", "impact": "High", "severity": "MEDIUM", "related_schemas": ["cvssv3"]}, {"type": "incident", "id": "incident-1234", "created_by_ref": "identity-1234", "created": "2024-08-21T00:15:04.847", "description": "CVE-2024-43863: Linux Kernel Vulnerability Compromised", "threat_actor_refs": ["identity-1234"], "technique_refs": ["T1036.005", "T1190", "T1499"], "intrusion_set_refs": ["intrusion-set-1234"], "course_of_action_refs": ["course-of-action-1234"]}, {"type": "course_of_action", "id": "course-of-action-1234", "created_by_ref": "identity-1234", "created": "2024-08-21T00:15:04.847", "description": "Update Linux Kernel to a Version Not Vulnerable to CVE-2024-43863", "technique_refs": ["T1036.005", "T1190", "T1499"], "intrusion_set_refs": ["intrusion-set-1234"]}, {"type": "note", "id": "note-1234", "created_by_ref": "identity-1234", "created": "2024-08-21T00:15:04.847", "description": "Memory protection mechanisms are recommended to mitigate CVE-2024-43863.", "technique_refs": ["T1036.005", "T1190", "T1499"]}], "relationships": [{"id": "relationship-1234", "type": "related_to", "from": "marker-1234", "to": "vulnerability-1234"}, {"id": "relationship-1235", "type": "related_to", "from": "vulnerability-1234", "to": "incident-1234"}, {"id": "relationship-1236", "type": "related_to", "from": "incident-1234", "to": "course-of-action-1234"}, {"id": "relationship-1237", "type": "related_to", "from": "course-of-action-1234", "to": "note-1234"}]}, "technical_analysis": {"Introduction": "The CVE-2024-43863 vulnerability is a Linux kernel vulnerability that allows an attacker to cause a deadlock in the kernel, leading to a denial-of-service (DoS) condition.", "Impact and Scope": "The vulnerability has a CVSS score of 5.5 (MEDIUM) with an attack vector of LOCAL and a CVSS vector string of CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to the following MITRE ATT&CK techniques: T1036.005, T1190, and T1499.", "Technical Details": "The vulnerability is caused by a race condition in the Linux kernel's memory management code, which can be exploited by an attacker to cause a deadlock.", "Detection": "Detection for this vulnerability involves monitoring for kernel crashes and debugging the kernel to identify the cause of the crash.", "Mitigation": "Mitigation strategies for this vulnerability include updating the Linux kernel to a version that is not vulnerable to this issue, implementing memory protection mechanisms, and monitoring for suspicious kernel activity.", "Conclusion": "In conclusion, the CVE-2024-43863 vulnerability is a significant threat to Linux systems and requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2024-43863 vulnerability is a significant threat to Linux systems and requires immediate attention and mitigation.", "Business Impact": "This vulnerability poses a significant risk to business operations, as it can cause a denial-of-service (DoS) condition, leading to losses and revenue impacts.", "Technical Impact": "The vulnerability has a significant technical impact, as it can cause a deadlock in the kernel, leading to system instability and crashes.", "Mitigation Strategies": "High-level mitigation strategies include updating the Linux kernel to a version that is not vulnerable to this issue, implementing memory protection mechanisms, and monitoring for suspicious kernel activity.", "Recommendations": "Recommendations for executives include prioritizing the mitigation of this vulnerability, implementing additional security measures to protect against future vulnerabilities, and ensuring that all systems are up to date with the latest security patches.", "Conclusions": "In conclusion, the CVE-2024-43863 vulnerability requires immediate attention and mitigation. Executives should prioritize the mitigation of this vulnerability and ensure that all systems are up to date with the latest security patches."}}