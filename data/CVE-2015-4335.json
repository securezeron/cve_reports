{"id": "CVE-2015-4335", "sourceIdentifier": "cve@mitre.org", "published": "2015-06-09T14:59:07.850", "lastModified": "2023-11-07T02:25:51.377", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Redis before 2.8.21 and 3.x before 3.0.2 allows remote attackers to execute arbitrary Lua bytecode via the eval command."}, {"lang": "es", "value": "Redis anterior a versi\u00f3n 2.8.21 y versiones 3.x y anteriores a 3.0.2, permite a los atacantes remotos ejecutar el c\u00f3digo byte Lua arbitrario por medio del comando eval."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-17"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redislabs:redis:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.8.20", "matchCriteriaId": "AD1CE4A9-BFA8-42F7-86B7-ABE8D079CFEB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redislabs:redis:3.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "3A586960-66FE-4812-AB9F-9C5A745BCC48"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redislabs:redis:3.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "11528338-5A26-4BEF-A7AB-13C2DD28F668"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}]}]}], "references": [{"url": "http://benmmurphy.github.io/blog/2015/06/04/redis-eval-lua-sandbox-escape/", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/162094.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-July/162146.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-updates/2015-10/msg00014.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://rhn.redhat.com/errata/RHSA-2015-1676.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.debian.org/security/2015/dsa-3279", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2015/06/04/12", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2015/06/04/8", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2015/06/05/3", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.securityfocus.com/bid/75034", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/antirez/redis/commit/fdf9d455098f54f7666c702ae464e6ea21e25411", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://groups.google.com/forum/#%21msg/redis-db/4Y6OqK8gEyk/Dg-5cejl-eUJ", "source": "cve@mitre.org"}, {"url": "https://security.gentoo.org/glsa/201702-16", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2015-4335 - Redis Eval Command Remote Code Execution Vulnerability. Threat actors can exploit this vulnerability by sending specially crafted Lua code to the Redis eval command, allowing them to execute arbitrary Lua bytecode. This can be used to perform reconnaissance, move laterally, and ultimately achieve their goals. Defending against this vulnerability requires restricting access to the eval command, implementing strict input validation, and monitoring Redis logs for suspicious activity."}, {"techniqueID": "T1191", "comment": "CVE-2015-4335 - Redis Lua Code Injection. This vulnerability allows threat actors to inject Lua code into Redis, allowing them to execute arbitrary code and perform various malicious activities. Defending against this vulnerability requires validating and sanitizing input data, implementing strict access controls, and monitoring Redis logs for suspicious activity."}, {"techniqueID": "T1046", "comment": "CVE-2015-4335 - Redis Command Execution. Threat actors can exploit this vulnerability by sending specially crafted commands to Redis, allowing them to execute arbitrary code and perform various malicious activities. Defending against this vulnerability requires restricting access to Redis, implementing strict access controls, and monitoring Redis logs for suspicious activity."}, {"techniqueID": "T1068", "comment": "CVE-2015-4335 - Redis Data Execution. This vulnerability allows threat actors to execute arbitrary code by manipulating Redis data structures, allowing them to perform various malicious activities. Defending against this vulnerability requires validating and sanitizing input data, implementing strict access controls, and monitoring Redis logs for suspicious activity."}], "stix_bundle": {"stix": {"Bundle": {"id": "bundle--71c9b3d3-c1c3-4f9e-b6b4-6d6c6a496c41", "type": "bundle", "created_by_ref": "http://example.com/assessor", "created": "2019-07-19T14:30:00.000Z", "modified": "2019-07-19T14:30:00.000Z", "objects": [{"id": "object--5f34c4f9-41f4-4959-bcde-a7d8e67f6a3b", "type": "indicator", "created_by_ref": "http://example.com/assessor", "created": "2019-07-19T14:30:00.000Z", "modified": "2019-07-19T14:30:00.000Z", "name": "Redis Eval Command Remote Code Execution Indicator", "description": "Indicator for Redis Eval Command Remote Code Execution", "first_seen": "2015-06-04T14:30:00.000Z", "last_seen": "2015-06-04T14:30:00.000Z", "objects": [{"id": "object--71c9b3d3-c1c3-4f9e-b6b4-6d6c6a496c41", "type": "associated-indicator", "created_by_ref": "http://example.com/assessor", "created": "2019-07-19T14:30:00.000Z", "modified": "2019-07-19T14:30:00.000Z", "indicator_ref": "http://example.com/indicator--5f34c4f9-41f4-4959-bcde-a7d8e67f6a3b", "technique_ref": "http://example.com/technique--c3f4e5f6-7d7d-4e4e-5f5f-6e6e6f6e6f"}]}]}}}, "technical_analysis": {"Introduction": "Redis is an in-memory data store that provides a rich set of features for caching, session management, and other applications. However, a vulnerability in Redis allows an attacker to execute arbitrary Lua code, potentially leading to remote code execution. This vulnerability occurs when an attacker sends specially crafted Lua code to the Redis eval command.", "Impact and Scope": "The impact of this vulnerability is significant, as it allows an attacker to execute arbitrary code on the Redis server. This can be used to perform reconnaissance, move laterally, and ultimately achieve their goals. The scope of the vulnerability includes Redis versions prior to 2.8.21 and 3.x prior to version 3.0.2.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques include T1190, T1191, T1046, and T1068. These techniques allow an attacker to execute arbitrary code, inject Lua code, and execute commands on the Redis server.", "Technical Details": "The vulnerability occurs when an attacker sends specially crafted Lua code to the Redis eval command. The eval command executes the provided Lua code, allowing an attacker to execute arbitrary code. To exploit this vulnerability, an attacker needs to send the specially crafted Lua code to the Redis server.", "Detection": "Detection of this vulnerability involves monitoring Redis logs for suspicious activity, such as unexpected Lua code execution. Additionally, network monitoring tools can be used to detect suspicious traffic, such as connections to the Redis server.", "Mitigation": "Mitigating this vulnerability involves updating to the latest version of Redis, restricting access to the eval command, and implementing strict input validation. Additionally, monitoring Redis logs and network traffic can help detect and prevent exploitation.", "Conclusion": "This vulnerability is significant, as it allows an attacker to execute arbitrary code on the Redis server. To mitigate this vulnerability, it is essential to update to the latest version of Redis and implement strict security controls."}, "executive_analysis": {"Overview": "The Redis Eval Command Remote Code Execution Vulnerability is a significant vulnerability that allows an attacker to execute arbitrary code on the Redis server. This vulnerability occurs when an attacker sends specially crafted Lua code to the Redis eval command.", "Business Impact": "The business impact of this vulnerability is significant, as it allows an attacker to execute arbitrary code on the Redis server. This can be used to perform reconnaissance, move laterally, and ultimately achieve their goals.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows an attacker to execute arbitrary code on the Redis server. This can be used to perform reconnaissance, move laterally, and ultimately achieve their goals.", "Mitigation Strategies": "Mitigating this vulnerability involves updating to the latest version of Redis, restricting access to the eval command, and implementing strict input validation.", "Recommendations": "Recommendations for executives include updating to the latest version of Redis, restricting access to the eval command, and implementing strict input validation.", "Conclusions": "In conclusion, the Redis Eval Command Remote Code Execution Vulnerability is a significant vulnerability that requires immediate attention and mitigation."}}