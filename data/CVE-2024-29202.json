{"id": "CVE-2024-29202", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-29T15:15:12.223", "lastModified": "2024-04-01T01:12:59.077", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "JumpServer is an open source bastion host and an operation and maintenance security audit system. Attackers can exploit a Jinja2 template injection vulnerability in JumpServer's Ansible to execute arbitrary code within the Celery container. Since the Celery container runs with root privileges and has database access, attackers could steal sensitive information from all hosts or manipulate the database. This vulnerability is fixed in v3.10.7.\n\n"}, {"lang": "es", "value": "JumpServer es un host basti\u00f3n de c\u00f3digo abierto y un sistema de auditor\u00eda de seguridad de operaci\u00f3n y mantenimiento. Los atacantes pueden aprovechar una vulnerabilidad de inyecci\u00f3n de plantilla Jinja2 en Ansible de JumpServer para ejecutar c\u00f3digo arbitrario dentro del contenedor Celery. Dado que el contenedor Celery se ejecuta con privilegios de root y tiene acceso a la base de datos, los atacantes podr\u00edan robar informaci\u00f3n confidencial de todos los hosts o manipular la base de datos. Esta vulnerabilidad se solucion\u00f3 en v3.10.7."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.9, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.1, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://github.com/jumpserver/jumpserver/security/advisories/GHSA-2vvr-vmvx-73ch", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-29202 - Attackers can exploit this Jinja2 template injection vulnerability in JumpServer's Ansible to execute arbitrary code within the Celery container, leading to escalated privileges and potential data theft. Defenders can use techniques like T1190 to detect and prevent unauthorized code execution."}, {"techniqueID": "T1218", "comment": "CVE-2024-29202 - Attackers can use this vulnerability to inject arbitrary code and execute it as the Celery container owner (root), allowing for potential data theft and manipulation of the database. Defenders can use techniques like T1218 to detect and prevent code injection attacks."}], "stix_bundle": {"type": "bundle", "description": "A bundle of objects related to the JumpServer Jinja2 template injection vulnerability CVE-2024-29202", "objects": [{"type": "incident", "id": "Incident-1", "description": "JumpServer Jinja2 template injection vulnerability CVE-2024-29202 exploitation", "firstseen": "2024-03-29T15:15:12.223", "created_by_ref": "identity--1", "object_marking_refs": [{"id_ref": "marking-definition--1"}]}, {"type": "identity", "id": "identity--1", "name": "JumpServer Jinja2 Template Injection Vulnerability Exploitation"}, {"type": "marking-definition", "id": "marking-definition--1", "name": "JumpServer Jinja2 Template Injection Vulnerability Threat"}, {"type": "attack-pattern", "id": "attack-pattern--1", "name": "JumpServer Jinja2 Template Injection", "description": "The JumpServer Jinja2 template injection attack pattern is used to exploit the Jinja2 template injection vulnerability in JumpServer's Ansible", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "kill_chain_phase_name": "Initial Access"}]}, {"type": "tool", "id": "tool--1", "name": "JumpServer Ansible", "description": "JumpServer Ansible is a tool used to exploit the Jinja2 template injection vulnerability in JumpServer's Ansible"}, {"type": "course-of-action", "id": "course-of-action--1", "name": "Patch JumpServer Ansible to the latest version (v3.10.7)", "description": "Patch JumpServer Ansible to the latest version (v3.10.7) to prevent exploitation of the Jinja2 template injection vulnerability", "related_sobject_refs": [{"sobject_type": "attack-pattern", "id_ref": "attack-pattern--1"}]}], "relations": [{"id": "Incident-1", "relation_type": "started", "object_ref": "attack-pattern--1"}, {"id": "Incident-1", "relation_type": "attributed", "object_ref": "identity--1"}]}, "technical_analysis": {"Introduction": "The JumpServer Jinja2 template injection vulnerability (CVE-2024-29202) allows attackers to inject arbitrary code and execute it within the Celery container, leading to escalated privileges and potential data theft.", "Impact and Scope": "The vulnerability has a CVSS score of 9.9 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H) and has the potential to be exploited by attackers with low privileges, making it a critical threat.", "Related MITRE ATT&CK Techniques": "T1190 - Exploitation of Remote Services and T1218 - Code Injection", "Technical Details": "The vulnerability is a Jinja2 template injection vulnerability in JumpServer's Ansible, which allows attackers to inject arbitrary code and execute it within the Celery container.", "Detection": "Detection of this vulnerability can be achieved by monitoring for suspicious Ansible commands and monitoring the Celery container for unauthorized code execution.", "Mitigation": "The vulnerability can be mitigated by patching JumpServer Ansible to the latest version (v3.10.7) and implementing strict access controls for the Celery container.", "Conclusion": "The JumpServer Jinja2 template injection vulnerability is a critical threat that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The JumpServer Jinja2 template injection vulnerability is a critical threat that requires immediate attention and mitigation.", "Business Impact": "The vulnerability has the potential to lead to data theft and manipulation of the database, resulting in significant financial and reputational losses.", "Technical Impact": "The vulnerability has the potential to be exploited by attackers with low privileges, making it a critical threat.", "Mitigation Strategies": "Patching JumpServer Ansible to the latest version (v3.10.7) and implementing strict access controls for the Celery container are the recommended mitigation strategies.", "Recommendations": "We recommend that JumpServer Ansible be patched to the latest version (v3.10.7) as soon as possible, and that strict access controls be implemented for the Celery container.", "Conclusions": "The JumpServer Jinja2 template injection vulnerability is a critical threat that requires immediate attention and mitigation. We recommend taking immediate action to patch and secure JumpServer Ansible."}}