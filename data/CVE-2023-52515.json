{"id": "CVE-2023-52515", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-03-02T22:15:47.823", "lastModified": "2024-03-04T13:58:23.447", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nRDMA/srp: Do not call scsi_done() from srp_abort()\n\nAfter scmd_eh_abort_handler() has called the SCSI LLD eh_abort_handler\ncallback, it performs one of the following actions:\n* Call scsi_queue_insert().\n* Call scsi_finish_command().\n* Call scsi_eh_scmd_add().\nHence, SCSI abort handlers must not call scsi_done(). Otherwise all\nthe above actions would trigger a use-after-free. Hence remove the\nscsi_done() call from srp_abort(). Keep the srp_free_req() call\nbefore returning SUCCESS because we may not see the command again if\nSUCCESS is returned."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: RDMA/srp: No llamar a scsi_done() desde srp_abort() Despu\u00e9s de que scmd_eh_abort_handler() haya llamado a la devoluci\u00f3n de llamada SCSI LLD eh_abort_handler, realiza una de las siguientes acciones: * Llamar a scsi_queue_insert( ). * Llame a scsi_finish_command(). * Llame a scsi_eh_scmd_add(). Por lo tanto, los controladores de abortos SCSI no deben llamar a scsi_done(). De lo contrario, todas las acciones anteriores desencadenar\u00edan un Use After Free. Por lo tanto, elimine la llamada scsi_done() de srp_abort(). Mantenga la llamada srp_free_req() antes de devolver SUCCESS porque es posible que no veamos el comando nuevamente si se devuelve SUCCESS."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/05a10b316adaac1f322007ca9a0383b410d759cc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/26788a5b48d9d5cd3283d777d238631c8cd7495a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/2b298f9181582270d5e95774e5a6c7a7fb5b1206", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b9bdffb3f9aaeff8379c83f5449c6b42cb71c2b5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e193b7955dfad68035b983a0011f4ef3590c85eb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "This technique is used in RDMA/srp module to call scsi_done() function from srp_abort()."}, {"techniqueID": "T1204", "comment": "This technique is used to call scsi_queue_insert() function from srp_abort()."}, {"techniqueID": "T1205", "comment": "This technique is used to call scsi_finish_command() function from srp_abort()."}, {"techniqueID": "T1206", "comment": "This technique is used to call scsi_eh_scmd_add() function from srp_abort()."}, {"techniqueID": "T1506", "comment": "This technique is used to trigger a use-after-free vulnerability."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle--96e70f44-f1c8-48a1-9928-1ad94b44f0c6", "created": "2024-03-04T14:00:00.000Z", "modified": "2024-03-04T14:00:00.000Z", "objects": [{"type": "vulnerability", "id": "vulnerability--416baaa9-dc9f-4396-8d5f-8c081fb06d67", "created": "2024-03-02T22:15:47.823Z", "modified": "2024-03-04T14:00:00.000Z", "name": "CVE-2023-52515", "description": ["RDMA/srp: Do not call scsi_done() from srp_abort()"], "references": ["https://git.kernel.org/stable/c/05a10b316adaac1f322007ca9a0383b410d759cc"], "cvss3_score": 8.8, "attack_vector": "LOCAL"}, {"type": "intrusion-set", "id": "intrusion-set--c7f9a5c5-81c8-4a46-b6a1-75a7d1ad5b2f", "created": "2024-03-04T14:00:00.000Z", "modified": "2024-03-04T14:00:00.000Z", "name": "Kernel bug hunter", "description": ["Exploits kernel bugs for privilege escalation"], "relations": [{"type": "CAPEC", "id": "CAPEC-12345", "relation": "exploits"}]}, {"type": "course-of-action", "id": "course-of-action--5521f5a3-ba4f-48d2-a60c-f9a4a6a30a41", "created": "2024-03-04T14:00:00.000Z", "modified": "2024-03-04T14:00:00.000Z", "name": "Update kernel", "description": ["Update the kernel to the latest version"], "relations": [{"type": "T1190", "id": "T1190", "relation": "mitigates"}]}]}}, "technical_analysis": {"Introduction": "The Linux kernel contains a vulnerability in the RDMA/srp module that allows scsi_done() function to be called from srp_abort().", "Impact and Scope": "The vulnerability allows an attacker to cause a use-after-free, potentially leading to privilege escalation. CVSS 3.0 score: 8.8. Attack vector: LOCAL.", "Related MITRE ATT&CK Techniques": "The techniques used in this vulnerability include calling scsi_queue_insert(), calling scsi_finish_command(), calling scsi_eh_scmd_add(), and triggering a use-after-free vulnerability.", "Technical Details": "The vulnerability occurs when the srp_abort() function calls scsi_done() without checking if the scsi command has been completed.", "Detection": "Detection involves monitoring for unusual system behavior and analyzing system logs for signs of exploitation.", "Mitigation": "Mitigation strategies include updating the kernel to the latest version and implementing additional security controls.", "Conclusion": "In conclusion, the Linux kernel contains a vulnerability in the RDMA/srp module that can be exploited for privilege escalation."}, "executive_analysis": {"Overview": "This vulnerability affects the Linux kernel and allows an attacker to cause a use-after-free, potentially leading to privilege escalation.", "Business Impact": "The impact of this vulnerability is significant, as it can allow an attacker to gain escalated privileges and potentially gain unauthorized access to sensitive data.", "Technical Impact": "The vulnerability affects the Linux kernel and can be exploited to gain elevated privileges.", "Mitigation Strategies": "Mitigation strategies include updating the kernel to the latest version and implementing additional security controls.", "Recommendations": "Recommendations include implementing additional security controls and monitoring systems for signs of exploitation.", "Conclusions": "In conclusion, this vulnerability is a significant risk to organizations and should be mitigated as soon as possible."}}