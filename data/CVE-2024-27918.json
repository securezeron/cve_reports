{"id": "CVE-2024-27918", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-21T02:52:20.863", "lastModified": "2024-03-21T12:58:51.093", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Coder allows oragnizations to provision remote development environments via Terraform. Prior to versions 2.6.1, 2.7.3, and 2.8.4, a vulnerability in Coder's OIDC authentication could allow an attacker to bypass the `CODER_OIDC_EMAIL_DOMAIN` verification and create an account with an email not in the allowlist. Deployments are only affected if the OIDC provider allows users to create accounts on the provider. During OIDC registration, the user's email was improperly validated against the allowed `CODER_OIDC_EMAIL_DOMAIN`s. This could allow a user with a domain that only partially matched an allowed domain to successfully login or register. An attacker could register a domain name that exploited this vulnerability and register on a Coder instance with a public OIDC provider.\n\nCoder instances with OIDC enabled and protected by the `CODER_OIDC_EMAIL_DOMAIN` configuration are affected. Coder instances using a private OIDC provider are not affected, as arbitrary users cannot register through a private OIDC provider without first having an account on the provider. Public OIDC providers are impacted. GitHub authentication and external authentication are not impacted. This vulnerability is remedied in versions 2.8.4, 2.7.3, and 2.6.1 All versions prior to these patches are affected by the vulnerability.*It is recommended that customers upgrade their deployments as soon as possible if they are utilizing OIDC authentication with the `CODER_OIDC_EMAIL_DOMAIN` setting."}, {"lang": "es", "value": "Coder permite a las organizaciones aprovisionar entornos de desarrollo remotos a trav\u00e9s de Terraform. Antes de las versiones 2.6.1, 2.7.3 y 2.8.4, una vulnerabilidad en la autenticaci\u00f3n OIDC de Coder pod\u00eda permitir a un atacante eludir la verificaci\u00f3n `CODER_OIDC_EMAIL_DOMAIN` y crear una cuenta con un correo electr\u00f3nico que no estaba en la lista de permitidos. Las implementaciones solo se ven afectadas si el proveedor de OIDC permite a los usuarios crear cuentas en el proveedor. Durante el registro de OIDC, el correo electr\u00f3nico del usuario se valid\u00f3 incorrectamente con los `CODER_OIDC_EMAIL_DOMAIN`s permitidos. Esto podr\u00eda permitir que un usuario con un dominio que solo coincidiera parcialmente con un dominio permitido inicie sesi\u00f3n o se registre exitosamente. Un atacante podr\u00eda registrar un nombre de dominio que explotara esta vulnerabilidad y registrarse en una instancia de Coder con un proveedor p\u00fablico de OIDC. Las instancias de Coder con OIDC habilitado y protegido por la configuraci\u00f3n `CODER_OIDC_EMAIL_DOMAIN` se ven afectadas. Las instancias de Coder que utilizan un proveedor OIDC privado no se ven afectadas, ya que los usuarios arbitrarios no pueden registrarse a trav\u00e9s de un proveedor OIDC privado sin tener primero una cuenta en el proveedor. Los proveedores p\u00fablicos de OIDC se ven afectados. La autenticaci\u00f3n de GitHub y la autenticaci\u00f3n externa no se ven afectadas. Esta vulnerabilidad se soluciona en las versiones 2.8.4, 2.7.3 y 2.6.1. Todas las versiones anteriores a estos parches se ven afectadas por la vulnerabilidad. *Se recomienda que los clientes actualicen sus implementaciones lo antes posible si utilizan autenticaci\u00f3n OIDC con la configuraci\u00f3n `CODER_OIDC_EMAIL_DOMAIN`."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 8.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 4.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0", "source": "security-advisories@github.com"}, {"url": "https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31", "source": "security-advisories@github.com"}, {"url": "https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb", "source": "security-advisories@github.com"}, {"url": "https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c", "source": "security-advisories@github.com"}, {"url": "https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1102", "comment": "CVE-2024-27918 - Insecure Default Settings - An attacker can exploit this vulnerability by creating an account on a Coder instance with an email that partially matches a domain from the `CODER_OIDC_EMAIL_DOMAIN` allowed list. This technique is relevant as it allows the attacker to bypass email domain verification and potentially gain unauthorized access to the Coder instance."}, {"techniqueID": "T1190", "comment": "CVE-2024-27918 - Exploit Public-Facing Application - Public OIDC providers are impacted, allowing an attacker to register a new domain that partially matches a domain from the `CODER_OIDC_EMAIL_DOMAIN` allowed list, and create an account with an email that matches the new domain. This technique is relevant as it allows the attacker to exploit a public facing application and potentially gain unauthorized access to the Coder instance."}, {"techniqueID": "T1555.005", "comment": "CVE-2024-27918 - Automated Attack - An attacker can use automated tools to register new domains and exploit this vulnerability, making it a high-impact technique. This technique is relevant as it allows the attacker to quickly and easily exploit the vulnerability, making it a high-priority target for mitigation."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle--CVE-2024-27918", "created_by_ref": "identity--Bob Smith", "created": "2024-03-22T14:30:00+00:00", "modified": "2024-03-22T14:30:00+00:00", "objects": [{"type": "Campaign", "id": "campaign--CVE-2024-27918", "name": "CVE-2024-27918", "description": "CVE-2024-27918 Campaign", "created_by_ref": "identity--Bob Smith", "created": "2024-03-22T14:30:00+00:00", "modified": "2024-03-22T14:30:00+00:00"}, {"type": "Indicator", "id": "indicator--CVE-2024-27918", "name": "CVE-2024-27918 Indicator", "description": "CVE-2024-27918 Indicator", "created_by_ref": "identity--Bob Smith", "created": "2024-03-22T14:30:00+00:00", "modified": "2024-03-22T14:30:00+00:00"}], "relationships": [{"type": "related_to", "id": "relationship--1", "from": "bundle--CVE-2024-27918", "to": "campaign--CVE-2024-27918"}, {"type": "related_to", "id": "relationship--2", "from": "bundle--CVE-2024-27918", "to": "indicator--CVE-2024-27918"}]}}, "technical_analysis": {"Introduction": "The CVE-2024-27918 vulnerability in Coder's OIDC authentication allows an attacker to bypass email domain verification and create an account with an email that partially matches a domain from the `CODER_OIDC_EMAIL_DOMAIN` allowed list. This allows the attacker to gain unauthorized access to the Coder instance.", "Impact and Scope": "The impact of this vulnerability is the ability to bypass email domain verification, which allows an attacker to create an account with an email that partially matches a domain from the `CODER_OIDC_EMAIL_DOMAIN` allowed list. The scope of the vulnerability is limited to Coder instances that use OIDC authentication with the `CODER_OIDC_EMAIL_DOMAIN` configuration.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1102, T1190, and T1555.005. T1102 is Insecure Default Settings, T1190 is Exploit Public-Facing Application, and T1555.005 is Automated Attack.", "Technical Details": "The technical details of the vulnerability are that the `CODER_OIDC_EMAIL_DOMAIN` configuration allows an attacker to bypass email domain verification by creating an account with an email that partially matches a domain from the allowed list.", "Detection": "The detection of this vulnerability can be done by monitoring the Coder instance's logs for unusual account creation activity and verifying the email addresses of newly created accounts.", "Mitigation": "The mitigation for this vulnerability is to upgrade to a patched version of Coder or to disable OIDC authentication until a patch is available.", "Conclusion": "In conclusion, the CVE-2024-27918 vulnerability in Coder's OIDC authentication allows an attacker to bypass email domain verification and create an account with an email that partially matches a domain from the `CODER_OIDC_EMAIL_DOMAIN` allowed list."}, "executive_analysis": {"Overview": "The CVE-2024-27918 vulnerability in Coder's OIDC authentication is a high-priority vulnerability that allows an attacker to bypass email domain verification and create an account with an email that partially matches a domain from the `CODER_OIDC_EMAIL_DOMAIN` allowed list.", "Business Impact": "The business impact of this vulnerability is the potential for unauthorized access to the Coder instance, which could result in data breaches, financial losses, and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is the ability to bypass email domain verification, which allows an attacker to create an account with an email that partially matches a domain from the `CODER_OIDC_EMAIL_DOMAIN` allowed list.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are to upgrade to a patched version of Coder or to disable OIDC authentication until a patch is available.", "Recommendations": "Recommendations for executives include prioritizing the patching of the vulnerability, disabling OIDC authentication until a patch is available, and monitoring the Coder instance's logs for unusual account creation activity.", "Conclusions": "In conclusion, the CVE-2024-27918 vulnerability in Coder's OIDC authentication is a high-priority vulnerability that requires immediate attention and mitigation."}}