{"id": "CVE-2020-28493", "sourceIdentifier": "report@snyk.io", "published": "2021-02-01T20:15:12.517", "lastModified": "2023-11-07T03:21:22.577", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "This affects the package jinja2 from 0.0.0 and before 2.11.3. The ReDoS vulnerability is mainly due to the `_punctuation_re regex` operator and its use of multiple wildcards. The last wildcard is the most exploitable as it searches for trailing punctuation. This issue can be mitigated by Markdown to format user content instead of the urlize filter, or by implementing request timeouts and limiting process memory."}, {"lang": "es", "value": "Esto afecta al paquete jinja2 desde versiones 0.0.0 y anteriores a 2.11.3. La vulnerabilidad ReDoS se debe principalmente al operador `_punctuation_re regex` y su uso de m\u00faltiples comodines. El \u00faltimo comod\u00edn es el m\u00e1s explotable, ya que busca la puntuaci\u00f3n final. Este problema puede ser mitigado con Markdown para formatear el contenido del usuario en lugar del filtro urlize, o implementando tiempos de espera de las peticiones y limitando la memoria del proceso"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}, {"source": "report@snyk.io", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-400"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:palletsprojects:jinja:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.11.3", "matchCriteriaId": "B4C4464D-515B-4608-96F0-D7282C5AA582"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*", "matchCriteriaId": "E460AA51-FCDA-46B9-AE97-E6676AA5E194"}]}]}], "references": [{"url": "https://github.com/pallets/jinja/blob/ab81fd9c277900c85da0c322a2ff9d68a235b2e6/src/jinja2/utils.py%23L20", "source": "report@snyk.io", "tags": ["Broken Link"]}, {"url": "https://github.com/pallets/jinja/pull/1343", "source": "report@snyk.io", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/PVAKCOO7VBVUBM3Q6CBBTPBFNP5NDXF4/", "source": "report@snyk.io"}, {"url": "https://security.gentoo.org/glsa/202107-19", "source": "report@snyk.io", "tags": ["Third Party Advisory"]}, {"url": "https://snyk.io/vuln/SNYK-PYTHON-JINJA2-1012994", "source": "report@snyk.io", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-28493 - The ReDoS vulnerability in Jinja2 can be exploited by an attacker to cause a denial-of-service (DoS) or a resource exhaustion, which can lead to a crash or a service disruption."}, {"techniqueID": "T1027", "comment": "CVE-2020-28493 - The vulnerability in Jinja2 can be exploited by an attacker to conduct a path traversal attack, which can lead to unauthorized access to sensitive data."}, {"techniqueID": "T1036", "comment": "CVE-2020-28493 - The vulnerability in Jinja2 can be exploited by an attacker to conduct command injection, which can lead to unauthorized execution of system commands."}], "technical_analysis": {"Introduction": "The CVE-2020-28493 is a ReDoS vulnerability in the Jinja2 templating engine, which can be exploited by an attacker to cause a denial-of-service (DoS) or a resource exhaustion.", "Impact and Scope": "The vulnerability has a CVSS score of 5.3 and can lead to a denial-of-service (DoS) or a resource exhaustion. The attack vector is network-based and the attack complexity is low.", "Related MITRE ATT&CK Techniques": "The vulnerability can be exploited by using the T1190, T1027, and T1036 techniques of the MITRE ATT&CK framework.", "Technical Details": "The vulnerability is caused by the use of multiple wildcards in the `_punctuation_re regex` operator, which can lead to a ReDoS attack. The vulnerability can be mitigated by using Markdown to format user content instead of the urlize filter or by implementing request timeouts and limiting process memory.", "Detection": "The vulnerability can be detected by monitoring the system logs for signs of a denial-of-service (DoS) or a resource exhaustion attack.", "Mitigation": "The vulnerability can be mitigated by updating the Jinja2 templating engine to a version that is not affected by the vulnerability or by implementing request timeouts and limiting process memory.", "Conclusion": "The CVE-2020-28493 is a critical vulnerability that can lead to a denial-of-service (DoS) or a resource exhaustion attack. It is essential to implement the recommended mitigations to prevent the exploitation of this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2020-28493 is a critical vulnerability in the Jinja2 templating engine that can lead to a denial-of-service (DoS) or a resource exhaustion attack.", "Business Impact": "The vulnerability can lead to significant business disruptions and financial losses if it is not addressed in a timely and effective manner.", "Technical Impact": "The vulnerability can be exploited by an attacker to cause a denial-of-service (DoS) or a resource exhaustion attack, which can lead to unauthorized access to sensitive data or the unauthorized execution of system commands.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability include updating the Jinja2 templating engine to a version that is not affected by the vulnerability or implementing request timeouts and limiting process memory.", "Recommendations": "All organizations that use the Jinja2 templating engine should apply the recommended mitigations as soon as possible to prevent the exploitation of this vulnerability.", "Conclusions": "In conclusion, the CVE-2020-28493 is a critical vulnerability that requires prompt attention and action to prevent the exploitation of this vulnerability. It is essential to implement the recommended mitigations to ensure the security of your organization."}}