{"id": "CVE-2024-24386", "sourceIdentifier": "cve@mitre.org", "published": "2024-02-15T08:15:46.497", "lastModified": "2024-08-19T21:35:04.070", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue in VitalPBX v.3.2.4-5 allows an attacker to execute arbitrary code via a crafted payload to the /var/lib/vitalpbx/scripts folder."}, {"lang": "es", "value": "Un problema en VitalPBX v.3.2.4-5 permite a un atacante ejecutar c\u00f3digo arbitrario a trav\u00e9s de un payload manipulado en la carpeta /var/lib/vitalpbx/scripts."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-284"}]}], "references": [{"url": "https://erickduarte.notion.site/VitalPBX-3-2-4-5-ee402173241c493687aa22ec60160c67?pvs=4", "source": "cve@mitre.org"}, {"url": "https://github.com/erick-duarte/CVE-2024-24386", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-24386 - This technique, known as 'Exploit Public-Facing Application', is relevant due to the vulnerability providing an attacker with the capability to execute arbitrary code. Defending against this technique requires patching the vulnerable application, restricting file permissions, and implementing intrusion detection systems."}, {"techniqueID": "T1027", "comment": "CVE-2024-24386 - This technique, known as 'Remote File Copy', is relevant due to the ability for an attacker to upload files to the vulnerable application. Defending against this technique requires restricting incoming file transfers, implementing firewall rules, and monitoring file system access."}, {"techniqueID": "T1564.001", "comment": "CVE-2024-24386 - This technique, known as 'Child Process Attack', is relevant due to the ability for an attacker to execute arbitrary code. Defending against this technique requires restricting the ability to execute arbitrary code, implementing memory protection, and monitoring system calls."}], "stix_bundle": "{\"bundle\": {\n  \"objects\": [\n    {\n      \"id\": \"vulnerability:CVE-2024-24386\",\n      \"type\": \"vulnerability\",\n      \"created_by_ref\": \"identity:123456789\",\n      \"modified\": \"2024-08-19T21:35:04.070\",\n      \"published\": \"2024-02-15T08:15:46.497\",\n      \"description\": \"An issue in VitalPBX v.3.2.4-5 allows an attacker to execute arbitrary code via a crafted payload to the /var/lib/vitalpbx/scripts folder.\",\n      \"references\": [\n        {\n          \"source_name\": \"VitalPBX\",\n          \"url\": \"https://erickduarte.notion.site/VitalPBX-3-2-4-5-ee402173241c493687aa22ec60160c67?pvs=4\"\n        },\n        {\n          \"source_name\": \"CVE@Mitre\",\n          \"url\": \"https://github.com/erick-duarte/CVE-2024-24386\"\n        }\n      ],\n      \"weaknesses\": [\n        {\n          \"source_name\": \" CWE@Mitre\",\n          \"description\": \"CWE-284: Using an Inherently Untrustworthy Construct\",\n          \"class\": \"CLASS:Untrusted Construct\"\n        }\n      ],\n      \"cvssMetricV31\": {\n        \"cvssData\": {\n          \"version\": \"3.1\",\n          \"vectorString\": \"CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H\",\n          \"attackVector\": \"NETWORK\",\n          \"attackComplexity\": \"LOW\",\n          \"privilegesRequired\": \"HIGH\",\n          \"userInteraction\": \"NONE\",\n          \"scope\": \"UNCHANGED\",\n          \"baseScore\": 7.2,\n          \"baseSeverity\": \"HIGH\"\n        },\n        \"exploitabilityScore\": 1.2,\n        \"impactScore\": 5.9\n      }\n    },\n    {\n      \"id\": \"technique:T1190\",\n      \"type\": \"technique\",\n      \"name\": \"Exploit Public-Facing Application\",\n      \"description\": \"Exploit publicly-facing applications\",\n      \"/mitre\": {\n      },\n      \"related_schemas\": [\n        {\n          \"name\": \"CIA Triad\",\n          \"description\": \"Conducting continuous monitoring and checking of systems to identify potential vulnerabilities\",\n          \"schema\": \"https://stix-project.github.io/stix/api\"\n        }\n      ]\n    },\n    {\n      \"id\": \"technique:T1027\",\n      \"type\": \"technique\",\n      \"name\": \"Remote File Copy\",\n      \"description\": \"Copy files from a remote system\",\n      \"/mitre\": {\n      },\n      \"related_schemas\": [\n        {\n          \"name\": \"CIA Triad\",\n          \"description\": \"Conducting continuous monitoring and checking of systems to identify potential vulnerabilities\",\n          \"schema\": \"https://stix-project.github.io/stix/api\"\n        }\n      ]\n    },\n    {\n      \"id\": \"technique:T1564.001\",\n      \"type\": \"technique\",\n      \"name\": \"Child Process Attack\",\n      \"description\": \"Execute arbitrary code using a child process\",\n      \"/mitre\": {\n      },\n      \"related_schemas\": [\n        {\n          \"name\": \"CIA Triad\",\n          \"description\": \"Conducting continuous monitoring and checking of systems to identify potential vulnerabilities\",\n          \"schema\": \"https://stix-project.github.io/stix/api\"\n        }\n      ]\n    },\n    {\n      \"id\": \"course_of_action:COA1\",\n      \"type\": \"course-of-action\",\n      \"name\": \"Remediate Vulnerability\",\n      \"description\": \"Patch the vulnerable application and restrict file permissions\",\n      \"mitigates\": {\n        \"techniques\": [\n          \"technique:T1190\",\n          \"technique:T1027\",\n          \"technique:T1564.001\"\n        ]\n      }\n    },\n    {\n      \"id\": \"defense_implementation:DI1\",\n      \"type\": \"defense_implementation\",\n      \"name\": \"Intrusion Detection System\",\n      \"description\": \"Implement an intrusion detection system to monitor file system access\",\n      \"implements\": {\n        \"course_of_actions\": [\n          \"course_of_action:COA1\"\n        ]\n      }\n    }\n  ],\n  \"relationships\": [\n    {\n      \"id\": \"vulnerability:CVE-2024-24386\\n\",\n      \"type\": \"vulnerability\",\n      \"schema\": \"https://stix-project.github.io/stix/api\",\n      \"created_by_ref\": \"identity:123456789\",\n      \"modified\": \"2024-08-19T21:35:04.070\",\n      \"published\": \"2024-02-15T08:15:46.497\",\n      \"description\": \"An issue in VitalPBX v.3.2.4-5 allows an attacker to execute arbitrary code via a crafted payload to the /var/lib/vitalpbx/scripts folder.\",\n      \"references\": [\n        {\n          \"source_name\": \"VitalPBX\",\n          \"url\": \"https://erickduarte.notion.site/VitalPBX-3-2-4-5-ee402173241c493687aa22ec60160c67?pvs=4\"\n        },\n        {\n          \"source_name\": \"CVE@Mitre\",\n          \"url\": \"https://github.com/erick-duarte/CVE-2024-24386\"\n        }\n      ]\n    },\n    {\n      \"id\": \"technique:T1190\",\n      \"type\": \"technique\",\n      \"schema\": \"https://stix-project.github.io/stix/api\",\n      \"created_by_ref\": \"identity:123456789\",\n      \"modified\": \"2024-08-19T21:35:04.070\",\n      \"published\": \"2024-02-15T08:15:46.497\",\n      \"description\": \"Exploit publicly-facing applications\",\n      \"/mitre\": {}\n    },\n    {\n      \"id\": \"technique:T1027\",\n      \"type\": \"technique\",\n      \"schema\": \"https://stix-project.github.io/stix/api\",\n      \"created_by_ref\": \"identity:123456789\",\n      \"modified\": \"2024-08-19T21:35:04.070\",\n      \"published\": \"2024-02-15T08:15:46.497\",\n      \"description\": \"Copy files from a remote system\",\n      \"/mitre\": {}\n    },\n    {\n      \"id\": \"technique:T1564.001\",\n      \"type\": \"technique\",\n      \"schema\": \"https://stix-project.github.io/stix/api\",\n      \"created_by_ref\": \"identity:123456789\",\n      \"modified\": \"2024-08-19T21:35:04.070\",\n      \"published\": \"2024-02-15T08:15:46.497\",\n      \"description\": \"Execute arbitrary code using a child process\",\n      \"/mitre\": {}\n    },\n    {\n      \"id\": \"course_of_action:COA1\",\n      \"type\": \"course-of-action\",\n      \"schema\": \"https://stix-project.github.io/stix/api\",\n      \"created_by_ref\": \"identity:123456789\",\n      \"modified\": \"2024-08-19T21:35:04.070\",\n      \"published\": \"2024-02-15T08:15:46.497\",\n      \"description\": \"Patch the vulnerable application and restrict file permissions\",\n      \"mitigates\": {\n        \"techniques\": [\n          \"technique:T1190\",\n          \"technique:T1027\",\n          \"technique:T1564.001\"\n        ]\n      }\n    },\n    {\n      \"id\": \"defense_implementation:DI1\",\n      \"type\": \"defense_implementation\",\n      \"schema\": \"https://stix-project.github.io/stix/api\",\n      \"created_by_ref\": \"identity:123456789\",\n      \"modified\": \"2024-08-19T21:35:04.070\",\n      \"published\": \"2024-02-15T08:15:46.497\",\n      \"description\": \"Implement an intrusion detection system to monitor file system access\",\n      \"implements\": {\n        \"course_of_actions\": [\n          \"course_of_action:COA1\"\n        ]\n      }\n    }\n  ]\n}}", "technical_analysis": {"Introduction": "The CVE-2024-24386 vulnerability in VitalPBX v.3.2.4-5 allows an attacker to execute arbitrary code via a crafted payload to the /var/lib/vitalpbx/scripts folder. This vulnerability is remotely exploitable and has a CVSS score of 7.2.", "Impact and Scope": "The impact and scope of this vulnerability is limited to the VitalPBX application, which is a popular open-source PBX software. This software allows for remote access and execution of scripts, making it vulnerable to code injection attacks.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1190, T1027, and T1564.001, which are Exploit Public-Facing Application, Remote File Copy, and Child Process Attack, respectively.", "Technical Details": "This vulnerability is caused by an unvalidated input in the VitalPBX scripting environment. The script execution function allows an attacker to execute arbitrary commands by injecting code as part of the input.", "Detection": "Detection of this vulnerability is possible by monitoring the application's network traffic and system calls for suspicious activity. Additionally, regular scanning for vulnerabilities and patching of the affected application is recommended.", "Mitigation": "Mitigation strategies include patching the vulnerable application, restricting file permissions, and implementing intrusion detection systems.", "Conclusion": "In conclusion, the CVE-2024-24386 vulnerability in VitalPBX v.3.2.4-5 is a remotely exploitable vulnerability that has a high CVSS score of 7.2. It is important to patch the vulnerable application and implement additional security controls to mitigate the risk of exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-24386 vulnerability in VitalPBX v.3.2.4-5 is a remotely exploitable vulnerability that has the potential to cause significant business disruption.", "Business Impact": "The business impact of this vulnerability is significant, as it could allow an attacker to execute arbitrary code on the affected system. This could lead to data breaches, system compromise, and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is equally significant, as it could allow an attacker to bypass security controls and gain unauthorized access to sensitive data.", "Mitigation Strategies": "Mitigation strategies include patching the vulnerable application, restricting file permissions, and implementing intrusion detection systems.", "Recommendations": "We recommend that customers update their VitalPBX software to the latest version, restrict file permissions, and implement intrusion detection systems to detect and prevent any potential attacks.", "Conclusions": "In conclusion, the CVE-2024-24386 vulnerability in VitalPBX v.3.2.4-5 is a serious security risk that requires immediate attention and action. By following the recommended mitigation strategies, customers can reduce the risk of exploitation and maintain the security and integrity of their systems."}}