{"id": "CVE-2023-7045", "sourceIdentifier": "cve@gitlab.com", "published": "2024-05-23T11:15:23.153", "lastModified": "2024-05-24T01:15:30.977", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A CSRF vulnerability exists within GitLab CE/EE from versions 13.11 before 16.10.6, from 16.11 before 16.11.3, from 17.0 before 17.0.1. By leveraging this vulnerability, an attacker could exfiltrate anti-CSRF tokens via the Kubernetes Agent Server (KAS)."}, {"lang": "es", "value": "Existe una vulnerabilidad CSRF en GitLab CE/EE desde las versiones 13.11 anteriores a 16.10.6, desde 16.11 anteriores a 16.11.3, desde 17.0 anteriores a 17.0.1. Al aprovechar esta vulnerabilidad, un atacante podr\u00eda filtrar tokens anti-CSRF a trav\u00e9s del servidor de agentes de Kubernetes (KAS)."}], "metrics": {"cvssMetricV31": [{"source": "cve@gitlab.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}]}, "weaknesses": [{"source": "cve@gitlab.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-352"}]}], "references": [{"url": "https://gitlab.com/gitlab-org/gitlab/-/issues/436358", "source": "cve@gitlab.com"}, {"url": "https://hackerone.com/reports/2286823", "source": "cve@gitlab.com"}], "techniques": [{"techniqueID": "T1059.003", "comment": "CVE-2023-7045 - A possible lateral movement technique, attackers can use CSRF vulnerabilities to exfiltrate anti-CSRF tokens, which could allow them to perform further actions."}, {"techniqueID": "T1190", "comment": "CVE-2023-7045 - Attackers can manipulate anti-CSRF tokens to perform unauthorized actions, which is a common tactic used in CSRF attacks."}, {"techniqueID": "T1027", "comment": "CVE-2023-7045 - Attackers can use CSRF vulnerabilities to steal sensitive data, including anti-CSRF tokens, which could lead to further exploitation."}, {"techniqueID": "T1193", "comment": "CVE-2023-7045 - Defenders can use techniques like CORS filtering to prevent CSRF attacks and protect against the vulnerability."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "indicator--1d5bd345-d1ef-464e-8f35-e13bc77e91f4", "created_by_ref": "identity--1d5bd345-d1ef-464e-8f35-e13bc77e91f4", "modified": "2024-05-24T01:15:30.977Z", "name": "GitLab CSRF Vulnerability", "description": {"lang": "en", "value": "A CSRF vulnerability exists within GitLab CE/EE from versions 13.11 before 16.10.6, from 16.11 before 16.11.3, from 17.0 before 17.0.1."}, "patternSyntax": " Palo Alto Networks", "pattern": "https://gitlab.com/*", "label": "CSRF", "created_at": "2024-05-24T01:15:30.977Z", "modified_at": "2024-05-24T01:15:30.977Z", "objects": [{"type": "relationship", "id": "relationship--1d5bd345-d1ef-464e-8f35-e13bc77e91f4", "source_ref": "indicator--1d5bd345-d1ef-464e-8f35-e13bc77e91f4", "target_ref": "attack_pattern--1d5bd345-d1ef-464e-8f35-e13bc77e91f4", "relationship_type": "related_to"}]}, {"type": "identity", "id": "identity--1d5bd345-d1ef-464e-8f35-e13bc77e91f4", "name": "GitLab", "created_at": "2024-05-24T01:15:30.977Z", "modified_at": "2024-05-24T01:15:30.977Z"}, {"type": "intrusion_set", "id": "intrusion_set--1d5bd345-d1ef-464e-8f35-e13bc77e91f4", "name": "GitLab CSRF Attack", "description": {"lang": "en", "value": "A group of threat actors using the GitLab CSR vulnerability to exfiltrate anti-CSRF tokens."}, "created_at": "2024-05-24T01:15:30.977Z", "modified_at": "2024-05-24T01:15:30.977Z", "objects": [{"type": "relationship", "id": "relationship--1d5bd345-d1ef-464e-8f35-e13bc77e91f4", "source_ref": "intrusion_set--1d5bd345-d1ef-464e-8f35-e13bc77e91f4", "target_ref": "malware--1d5bd345-d1ef-464e-8f35-e13bc77e91f4", "relationship_type": "contains"}]}]}, "technical_analysis": {"Introduction": "CVE-2023-7045 is a CSRF vulnerability in GitLab CE/EE from versions 13.11 before 16.10.6, from 16.11 before 16.11.3, from 17.0 before 17.0.1. Attackers can use this vulnerability to exfiltrate anti-CSRF tokens.", "Impact and Scope": "This vulnerability has a CVSS score of 5.4 with a version of 3.1 and an attack vector of NETWORK. It has a base score of 5.4 and a base severity of MEDIUM.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to MITRE ATT&CK techniques T1059.003, T1190, T1027, and T1193.", "Technical Details": "The vulnerability exists due to insufficient validation of user input. Attackers can manipulate anti-CSRF tokens to perform unauthorized actions.", "Detection": "Detection methods include monitoring for anomalous user activity and analyzing log data for signs of CSRF attacks.", "Mitigation": "Mitigation strategies include applying patches, implementing CORS filtering, and monitoring for anomalous user activity.", "Conclusion": "The CVE-2023-7045 is a significant vulnerability that can be exploited by attackers to exfiltrate anti-CSRF tokens. It is essential to apply patches, implement CORS filtering, and monitor for anomalous user activity to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2023-7045 is a CSRF vulnerability in GitLab CE/EE from versions 13.11 before 16.10.6, from 16.11 before 16.11.3, from 17.0 before 17.0.1.", "Business Impact": "This vulnerability has a significant business impact as it can be used to exfiltrate anti-CSRF tokens and perform unauthorized actions.", "Technical Impact": "The technical impact is significant as it can be used to compromise the security of GitLab installations.", "Mitigation Strategies": "High-level mitigation strategies include applying patches, implementing CORS filtering, and monitoring for anomalous user activity.", "Recommendations": "Recommendations for executives include prioritizing the patching of vulnerable systems, implementing measures to detect and prevent CSRF attacks, and conducting regular security assessments.", "Conclusions": "In conclusion, the CVE-2023-7045 is a significant vulnerability that requires immediate attention and action to prevent exploitation."}}