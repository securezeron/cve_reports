{"id": "CVE-2020-27754", "sourceIdentifier": "secalert@redhat.com", "published": "2020-12-08T22:15:18.227", "lastModified": "2023-03-11T23:15:12.477", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In IntensityCompare() of /magick/quantize.c, there are calls to PixelPacketIntensity() which could return overflowed values to the caller when ImageMagick processes a crafted input file. To mitigate this, the patch introduces and uses the ConstrainPixelIntensity() function, which forces the pixel intensities to be within the proper bounds in the event of an overflow. This flaw affects ImageMagick versions prior to 6.9.10-69 and 7.0.8-69."}, {"lang": "es", "value": "En la funci\u00f3n IntensityCompare() del archivo /magick/quantize.c, se presentan llamadas a PixelPacketIntensity() que podr\u00edan devolver valores desbordados a la persona que llama cuando ImageMagick procesa un archivo de entrada dise\u00f1ado.&#xa0;Para mitigar esto, el parche introduce y utiliza la funci\u00f3n ConstrainPixelIntensity(), que obliga a las intensidades de p\u00edxeles a estar dentro de los l\u00edmites adecuados en caso de un desbordamiento.&#xa0;Este fallo afecta a ImageMagick versiones anteriores a 6.9.10-69 y 7.0.8-69"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 3.3, "baseSeverity": "LOW"}, "exploitabilityScore": 1.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-190"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:imagemagick:imagemagick:*:*:*:*:*:*:*:*", "versionEndExcluding": "6.9.10-69", "matchCriteriaId": "0DA39290-2761-4869-AC2B-A251A33AEA75"}, {"vulnerable": true, "criteria": "cpe:2.3:a:imagemagick:imagemagick:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.0.8", "versionEndExcluding": "7.0.8-69", "matchCriteriaId": "3224AE1E-CEFD-40C3-AC2B-076E0EDC254D"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}]}]}], "references": [{"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1894231", "source": "secalert@redhat.com", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2021/03/msg00030.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2023/03/msg00008.html", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1068", "comment": "CVE-2020-27754 - ImageMagick vulnerable to overflow in IntensityCompare() function, allowing for potential remote code execution. This technique may be exploited by adversaries to launch targeted attacks or spread malware."}, {"techniqueID": "T1190", "comment": "CVE-2020-27754 - Crafted input files can cause ImageMagick to return overflowed values, which could lead to potential remote code execution. This technique may be used by adversaries to inject malicious code or disrupt system functionality."}, {"techniqueID": "T1090", "comment": "CVE-2020-27754 - The vulnerability in ImageMagick's IntensityCompare() function can be exploited to inject malicious code or disrupt system functionality. This technique may be used by adversaries to spread malware or launch targeted attacks."}, {"techniqueID": "T1036", "comment": "CVE-2020-27754 - The vulnerability in ImageMagick can be exploited to create a backdoor or execute malicious code. This technique may be used by adversaries to maintain persistence or facilitate lateral movement."}, {"techniqueID": "T1192", "comment": "CVE-2020-27754 - The vulnerability in ImageMagick's ConstrainPixelIntensity() function can be exploited to inject malicious code or disrupt system functionality. This technique may be used by adversaries to spread malware or launch targeted attacks."}], "stix_bundle": {"@stix2_syntax_version": "2.1", "objects": [{"type": "indicator", "id": "ind-1", "created_by_ref": "stix@author", "created": "2023-03-11T23:15:12.477", "modified": "2023-03-11T23:15:12.477", "name": "CVE-2020-27754 Indicator", "description": "Indicator for CVE-2020-27754 vulnerability in ImageMagick", "pattern": "ImageMagick version prior to 6.9.10-69 and 7.0.8-69", "confidence": 0.9, "valid_from": "2020-12-08T22:15:18.227", "valid_until": "2023-03-11T23:15:12.477", "handling": "identity"}, {"type": "attack_pattern", "id": "ap-1", "created_by_ref": "stix@author", "created": "2023-03-11T23:15:12.477", "modified": "2023-03-11T23:15:12.477", "name": "CVE-2020-27754 Attack Pattern", "description": "Attack pattern for CVE-2020-27754 vulnerability in ImageMagick", "goals": ["Code Execution"], "tactics": ["Exploit"], "attack_pattern_types": ["Local File Inclusion"], "indicators": ["ind-1"]}, {"type": "course_of_action", "id": "coa-1", "created_by_ref": "stix@author", "created": "2023-03-11T23:15:12.477", "modified": "2023-03-11T23:15:12.477", "name": "CVE-2020-27754 Course of Action", "description": "Course of action for CVE-2020-27754 vulnerability in ImageMagick", "attack_pattern_ref": "ap-1", "notes": ["Update to a patched version of ImageMagick"]}], "relationships": [{"id": "r-1", "type": "indicates", "source_ref": "ind-1", "target_ref": "ap-1"}]}, "technical_analysis": {"Introduction": "The CVE-2020-27754 vulnerability in ImageMagick's IntensityCompare() function allows for potential remote code execution. This vulnerability can be exploited by crafting input files to return overflowed values.", "Impact and Scope": "The vulnerability has a CVSS score of 3.3 and an attack vector of LOCAL.", "Related MITRE ATT&CK Techniques": "Related MITRE ATT&CK techniques include T1068, T1190, T1090, and T1036.", "Technical Details": "The vulnerability is caused by the IntensityCompare() function not properly checking the bounds of the pixel intensity values. This can lead to remote code execution.", "Detection": "Detection may be difficult due to the complexity of the vulnerability.", "Mitigation": "Mitigation strategies include updating to a patched version of ImageMagick, limiting access to the affected system, and monitoring for suspicious activity.", "Conclusion": "The CVE-2020-27754 vulnerability in ImageMagick's IntensityCompare() function is a critical vulnerability that can be exploited to launch targeted attacks or spread malware."}, "executive_analysis": {"Overview": "The CVE-2020-27754 vulnerability in ImageMagick's IntensityCompare() function poses a significant threat to organizations using the affected software.", "Business Impact": "The vulnerability can be exploited to launch targeted attacks or spread malware, which can result in significant financial losses and reputational damage.", "Technical Impact": "The vulnerability can be exploited to execute arbitrary code, which can result in a complete compromise of the affected system.", "Mitigation Strategies": "The recommended mitigation strategies include updating to a patched version of ImageMagick, limiting access to the affected system, and monitoring for suspicious activity.", "Recommendations": "Organizations using the affected software should update to a patched version as soon as possible, limit access to the affected system, and monitor for suspicious activity.", "Conclusions": "The CVE-2020-27754 vulnerability in ImageMagick's IntensityCompare() function is a critical vulnerability that requires immediate attention and action."}}