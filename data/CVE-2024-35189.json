{"id": "CVE-2024-35189", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-30T20:15:09.457", "lastModified": "2024-05-31T13:01:46.727", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Fides is an open-source privacy engineering platform. The Fides webserver has a number of endpoints that retrieve `ConnectionConfiguration` records and their associated `secrets` which _can_ contain sensitive data (e.g. passwords, private keys, etc.). These `secrets` are stored encrypted at rest (in the application database), and the associated endpoints are not meant to expose that sensitive data in plaintext to API clients, as it could be compromising. Fides's developers have available to them a Pydantic field-attribute (`sensitive`) that they can annotate as `True` to indicate that a given secret field should not be exposed via the API. The application has an internal function that uses `sensitive` annotations to mask the sensitive fields with a `\"**********\"` placeholder value. This vulnerability is due to a bug in that function, which prevented `sensitive` API model fields that were _nested_ below the root-level of a `secrets` object from being masked appropriately. Only the `BigQuery` connection configuration secrets meets these criteria: the secrets schema has a nested sensitive `keyfile_creds.private_key` property that is exposed in plaintext via the APIs. Connection types other than `BigQuery` with sensitive fields at the root-level that are not nested are properly masked with the placeholder and are not affected by this vulnerability. This vulnerability has been patched in Fides version 2.37.0. Users are advised to upgrade to this version or later to secure their systems against this threat. Users are also advised to rotate any Google Cloud secrets used for BigQuery integrations in their Fides deployments. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Fides es una plataforma de ingenier\u00eda de privacidad de c\u00f3digo abierto. El servidor web de Fides tiene una serie de endpoints que recuperan registros de \"Configuraci\u00f3n de conexi\u00f3n\" y sus \"secretos\" asociados que _pueden_ contener datos confidenciales (por ejemplo, contrase\u00f1as, claves privadas, etc.). Estos \"secretos\" se almacenan cifrados en reposo (en la base de datos de la aplicaci\u00f3n) y los endpoints asociados no est\u00e1n destinados a exponer esos datos confidenciales en texto sin formato a los clientes API, ya que podr\u00edan ser comprometedores. Los desarrolladores de Fides tienen a su disposici\u00f3n un atributo de campo Pydantic (\"sensible\") que pueden anotar como \"Verdadero\" para indicar que un campo secreto determinado no debe exponerse a trav\u00e9s de la API. La aplicaci\u00f3n tiene una funci\u00f3n interna que utiliza anotaciones \"sensibles\" para enmascarar los campos sensibles con un valor de marcador de posici\u00f3n \"**********\". Esta vulnerabilidad se debe a un error en esa funci\u00f3n, que imped\u00eda que los campos del modelo API \"sensibles\" que estaban _anidados_ debajo del nivel ra\u00edz de un objeto \"secreto\" se enmascararan adecuadamente. Solo los secretos de configuraci\u00f3n de conexi\u00f3n de \"BigQuery\" cumplen estos criterios: el esquema de secretos tiene una propiedad sensible anidada \"keyfile_creds.private_key\" que se expone en texto sin formato a trav\u00e9s de las API. Los tipos de conexi\u00f3n distintos de \"BigQuery\" con campos confidenciales en el nivel ra\u00edz que no est\u00e1n anidados se enmascaran correctamente con el marcador de posici\u00f3n y no se ven afectados por esta vulnerabilidad. Esta vulnerabilidad ha sido parcheada en la versi\u00f3n 2.37.0 de Fides. Se recomienda a los usuarios que actualicen a esta versi\u00f3n o posterior para proteger sus sistemas contra esta amenaza. Tambi\u00e9n se recomienda a los usuarios que roten los secretos de Google Cloud utilizados para las integraciones de BigQuery en sus implementaciones de Fides. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}, {"lang": "en", "value": "CWE-201"}]}], "references": [{"url": "https://cloud.google.com/iam/docs/key-rotation", "source": "security-advisories@github.com"}, {"url": "https://github.com/ethyca/fides/security/advisories/GHSA-rcvg-jj3g-rj7c", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0011", "comment": "T1567.003 - Lateral Movement via Remote Services - The vulnerability in Fides WebServer allows remote attackers to access and steal sensitive data without having to physically access the device. This is a potential breach of confidentiality."}, {"techniqueID": "T1027", "comment": "Data Staged - The vulnerable endpoint in Fides WebServer can be used to steal sensitive data, which can then be stored on the attacker's system or cloud location for later use."}, {"techniqueID": "T1569", "comment": "System Network Communication - The vulnerable endpoint in Fides WebServer can be used to communicate with other systems or send sensitive data to other parties."}, {"techniqueID": "T1190", "comment": "Exploit Public-Facing Application - The vulnerability in Fides WebServer is a public-facing application that can be exploited by attackers."}], "stix_bundle": {"@type": "bundle", "name": "Fides Web Server Vulnerability", "description": "Vulnerability in Fides Web Server", "objects": {"vulnerability": {"@type": "vulnerability", "id": "CVE-2024-35189", "name": "Fides Web Server Vulnerability", "description": "Vulnerability in Fides Web Server", "severity": "MEDIUM", "cvss": {"@type": " cvss:3.1", "version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}}, "attack_pattern": {"@type": "attack-pattern", "id": "T1567.003", "name": "Lateral Movement via Remote Services", "description": "An adversary uses remote services to move laterally across a network.", "kill_chain_phases": {"reconnaissance": {"@type": "reconnaissance", "description": "An adversary conducts reconnaissance to identify potential targets and gather information."}, "initial_attack": {"@type": "initial-attack", "description": "An adversary launches an initial attack to gain access to a network."}, "lateral_movement": {"@type": "lateral-movement", "description": "An adversary uses remote services to move laterally across a network."}}}, "tactic": {"@type": "tactic", "id": "TA0011", "name": "Initial Access", "description": "The adversary's goal is to gain access to the targeted system."}, "course_of_action": {"@type": "course-of-action", "id": "COA-1", "name": "Patch Fides Web Server", "description": "Apply the patch released by Fides to mitigate the vulnerability."}}, "relations": {"related_to": {"type": "related-to", "source": "vulnerability", "target": "attack_pattern", "relationship": "exploited"}, "mitigates": {"type": "mitigates", "source": "attack_pattern", "target": "course_of_action", "relationship": "mitigated_by"}}}, "technical_analysis": {"Introduction": "The Fides Web Server vulnerability allows remote attackers to access and steal sensitive data without having to physically access the device. This is a potential breach of confidentiality.", "Impact and Scope": "The vulnerability is rated as HIGH for confidentiality impact and MEDIUM for severity. The attack vector is NETWORK and the attack complexity is LOW.", "Related MITRE ATT&CK Techniques": "T1567.003 - Lateral Movement via Remote Services, T1027 - Data Staged, T1569 - System Network Communication, T1190 - Exploit Public-Facing Application", "Technical Details": "The vulnerability is due to a bug in the function that uses sensitive annotations to mask sensitive fields with a placeholder value. Only the BigQuery connection configuration secrets meets the criteria.", "Detection": "Detecting the vulnerability is challenging as it requires looking for specific patterns in the data. Additionally, the vulnerability may not have any obvious symptoms.", "Mitigation": "The recommended mitigation is to patch the Fides Web Server and rotate any Google Cloud secrets used for BigQuery integrations.", "Conclusion": "In conclusion, the Fides Web Server vulnerability is a significant threat that requires immediate attention. It is recommended to patch the Fides Web Server and rotate any Google Cloud secrets used for BigQuery integrations."}, "executive_analysis": {"Overview": "The Fides Web Server vulnerability is a significant threat that requires immediate attention. The vulnerability allows remote attackers to access and steal sensitive data without having to physically access the device.", "Business Impact": "The business impact of this vulnerability is significant as it allows attackers to steal sensitive data. This can lead to financial losses, reputational damage, and compliance issues.", "Technical Impact": "The technical impact of this vulnerability is significant as it allows attackers to access and steal sensitive data. This can lead to data breaches, identity theft, and other technical issues.", "Mitigation Strategies": "The recommended mitigation is to patch the Fides Web Server and rotate any Google Cloud secrets used for BigQuery integrations.", "Recommendations": "Recommendations for executives include implementing a patch management process, monitoring for suspicious activity, and conducting regular vulnerability assessments.", "Conclusions": "In conclusion, the Fides Web Server vulnerability is a significant threat that requires immediate attention. It is recommended to patch the Fides Web Server and rotate any Google Cloud secrets used for BigQuery integrations."}}