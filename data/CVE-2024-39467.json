{"id": "CVE-2024-39467", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-25T15:15:15.190", "lastModified": "2024-06-25T18:50:42.040", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: fix to do sanity check on i_xattr_nid in sanity_check_inode()\n\nsyzbot reports a kernel bug as below:\n\nF2FS-fs (loop0): Mounted with checkpoint version = 48b305e4\n==================================================================\nBUG: KASAN: slab-out-of-bounds in f2fs_test_bit fs/f2fs/f2fs.h:2933 [inline]\nBUG: KASAN: slab-out-of-bounds in current_nat_addr fs/f2fs/node.h:213 [inline]\nBUG: KASAN: slab-out-of-bounds in f2fs_get_node_info+0xece/0x1200 fs/f2fs/node.c:600\nRead of size 1 at addr ffff88807a58c76c by task syz-executor280/5076\n\nCPU: 1 PID: 5076 Comm: syz-executor280 Not tainted 6.9.0-rc5-syzkaller #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 03/27/2024\nCall Trace:\n <TASK>\n __dump_stack lib/dump_stack.c:88 [inline]\n dump_stack_lvl+0x241/0x360 lib/dump_stack.c:114\n print_address_description mm/kasan/report.c:377 [inline]\n print_report+0x169/0x550 mm/kasan/report.c:488\n kasan_report+0x143/0x180 mm/kasan/report.c:601\n f2fs_test_bit fs/f2fs/f2fs.h:2933 [inline]\n current_nat_addr fs/f2fs/node.h:213 [inline]\n f2fs_get_node_info+0xece/0x1200 fs/f2fs/node.c:600\n f2fs_xattr_fiemap fs/f2fs/data.c:1848 [inline]\n f2fs_fiemap+0x55d/0x1ee0 fs/f2fs/data.c:1925\n ioctl_fiemap fs/ioctl.c:220 [inline]\n do_vfs_ioctl+0x1c07/0x2e50 fs/ioctl.c:838\n __do_sys_ioctl fs/ioctl.c:902 [inline]\n __se_sys_ioctl+0x81/0x170 fs/ioctl.c:890\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xf5/0x240 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nThe root cause is we missed to do sanity check on i_xattr_nid during\nf2fs_iget(), so that in fiemap() path, current_nat_addr() will access\nnat_bitmap w/ offset from invalid i_xattr_nid, result in triggering\nkasan bug report, fix it."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: f2fs: correcci\u00f3n para realizar una verificaci\u00f3n de estado en i_xattr_nid en sanity_check_inode() syzbot informa un error en el kernel como se muestra a continuaci\u00f3n: F2FS-fs (loop0): Montado con la versi\u00f3n de punto de control = 48b305e4 ==== ==================================================== ============ ERROR: KASAN: losa fuera de los l\u00edmites en f2fs_test_bit fs/f2fs/f2fs.h:2933 [en l\u00ednea] ERROR: KASAN: losa fuera de los l\u00edmites en current_nat_addr fs/f2fs/node.h:213 [en l\u00ednea] ERROR: KASAN: losa fuera de los l\u00edmites en f2fs_get_node_info+0xece/0x1200 fs/f2fs/node.c:600 Lectura de tama\u00f1o 1 en la direcci\u00f3n ffff88807a58c76c mediante la tarea syz-executor280 /5076 CPU: 1 PID: 5076 Comm: syz-executor280 No contaminado 6.9.0-rc5-syzkaller #0 Nombre del hardware: Google Google Compute Engine/Google Compute Engine, BIOS Google 27/03/2024 Seguimiento de llamadas:  __dump_stack lib/dump_stack.c:88 [en l\u00ednea] dump_stack_lvl+0x241/0x360 lib/dump_stack.c:114 print_address_description mm/kasan/report.c:377 [en l\u00ednea] print_report+0x169/0x550 mm/kasan/report.c:488 kasan_report +0x143/0x180 mm/kasan/report.c:601 f2fs_test_bit fs/f2fs/f2fs.h:2933 [en l\u00ednea] current_nat_addr fs/f2fs/node.h:213 [en l\u00ednea] f2fs_get_node_info+0xece/0x1200 fs/f2fs/node. c:600 f2fs_xattr_fiemap fs/f2fs/data.c:1848 [en l\u00ednea] f2fs_fiemap+0x55d/0x1ee0 fs/f2fs/data.c:1925 ioctl_fiemap fs/ioctl.c:220 [en l\u00ednea] do_vfs_ioctl+0x1c07/0x2e50 ioctl. c:838 __do_sys_ioctl fs/ioctl.c:902 [en l\u00ednea] __se_sys_ioctl+0x81/0x170 fs/ioctl.c:890 do_syscall_x64 arch/x86/entry/common.c:52 [en l\u00ednea] do_syscall_64+0xf5/0x240 arch/x86/ Entry/common.c:83 Entry_SYSCALL_64_after_hwframe+0x77/0x7f La causa principal es que no hicimos una verificaci\u00f3n de cordura en i_xattr_nid durante f2fs_iget(), de modo que en la ruta fiemap(), current_nat_addr() acceder\u00e1 a nat_bitmap con desplazamiento desde i_xattr_nid no v\u00e1lido, resulta en la activaci\u00f3n del informe de error de Kasan, corr\u00edjalo."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/1640dcf383cdba52be8b28d2a1a2aa7ef7a30c98", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/20faaf30e55522bba2b56d9c46689233205d7717", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/68e3cd4ecb8603936cccdc338929130045df2e57", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/75c87e2ac6149abf44bdde0dd6d541763ddb0dff", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8c8aa473fe6eb46a4bf99f3ea2dbe52bf0c1a1f0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/be0155202e431f3007778568a72432c68f8946ba", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c559a8d840562fbfce9f318448dda2f7d3e6d8e8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-39467 - This is a memory corruption vulnerability in the Linux kernel's f2fs file system, allowing an attacker to potentially exploit a KASAN bug and execute arbitrary code. This technique is relevant because it demonstrates the importance of memory safety and the potential for exploitation in a vulnerable operating system."}], "stix_bundle": {"type": "bundle", "id": "CVE-2024-39467", "created_by_ref": "https://stix2.io/Organization/creator", "created": "2024-06-25T15:15:15.190", "modified": "2024-06-25T18:50:42.040", "objects": [{"type": "vulnerability", "id": "CVE-2024-39467", "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: fix to do sanity check on i_xattr_nid in sanity_check_inode()\n\nsyzbot reports a kernel bug as below:\n\nF2FS-fs (loop0): Mounted with checkpoint version = 48b305e4\n==================================================================\nBUG: KASAN: slab-out-of-bounds in f2fs_test_bit fs/f2fs/f2fs.h:2933 [inline]\nBUG: KASAN: slab-out-of-bounds in current_nat_addr fs/f2fs/node.h:213 [inline]\nBUG: KASAN: slab-out-of-bounds in f2fs_get_node_info+0xece/0x1200 fs/f2fs/node.c:600\nRead of size 1 at addr ffff88807a58c76c by task syz-executor280/5076\n\nCPU: 1 PID: 5076 Comm: syz-executor280 Not tainted 6.9.0-rc5-syzkaller #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 03/27/2024\nCall Trace:\n <TASK>\n __dump_stack lib/dump_stack.c:88 [inline]\n dump_stack_lvl+0x241/0x360 lib/dump_stack.c:114\n print_address_description mm/kasan/report.c:377 [inline]\n print_report+0x169/0x550 mm/kasan/report.c:488\n kasan_report+0x143/0x180 mm/kasan/report.c:601\n f2fs_test_bit fs/f2fs/f2fs.h:2933 [inline]\n current_nat_addr fs/f2fs/node.h:213 [inline]\n f2fs_get_node_info+0xece/0x1200 fs/f2fs/node.c:600\n f2fs_xattr_fiemap fs/f2fs/data.c:1848 [inline]\n f2fs_fiemap+0x55d/0x1ee0 fs/f2fs/data.c:1925\n ioctl_fiemap fs/ioctl.c:220 [inline]\n do_vfs_ioctl+0x1c07/0x2e50 fs/ioctl.c:838\n __do_sys_ioctl fs/ioctl.c:902 [inline]\n __se_sys_ioctl+0x81/0x170 fs/ioctl.c:890\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xf5/0x240 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n", "platforms": ["Linux"], "severity": "High", "vector_string": "L", "exploit_maturity": "Unproven"}, {"type": "course-of-action", "id": "COA-1", "title": "Apply the kernel patch", "description": "Apply the kernel patch to fix the vulnerability", "mitigated_by": "T1190"}, {"type": "course-of-action", "id": "COA-2", "title": "Disable the vulnerable feature", "description": "Disable the vulnerable feature to prevent exploitation", "mitigated_by": "T1190"}], "relationships": [{"type": "incident", "id": "INC-1", "source_refs": ["https://stix2.io/Object/CVE-2024-39467"], "destination_refs": ["https://stix2.io/Opinion/ T1190"], "label": "Exploitation"}]}, "technical_analysis": {"Introduction": "The CVE-2024-39467 is a memory corruption vulnerability in the Linux kernel's f2fs file system, allowing an attacker to potentially exploit a KASAN bug and execute arbitrary code.", "Impact and Scope": "The vulnerability affects the Linux kernel version 6.9.0-rc5-syzkaller and has a CVSS score of 9.0 with a CVSS vector string of 'L'.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK technique is 'Exploit Public-Facing Application' (T1190)", "Technical Details": "The vulnerability occurs when the kernel's f2fs file system is mounted with the checkpoint version set to 48b305e4.", "Detection": "The vulnerability can be detected by monitoring for suspicious system calls such as 'ioctl' and 'sys_ioctl'", "Mitigation": "The vulnerability can be mitigated by applying the kernel patch or disabling the vulnerable feature", "Conclusion": "The CVE-2024-39467 is a critical vulnerability that should be addressed promptly to prevent exploitation"}, "executive_analysis": {"Overview": "The CVE-2024-39467 is a critical memory corruption vulnerability in the Linux kernel's f2fs file system", "Business Impact": "The vulnerability has the potential to allow an attacker to execute arbitrary code and gain control of the system, which could have severe business consequences", "Technical Impact": "The vulnerability has the potential to allow an attacker to execute arbitrary code and gain control of the system, which could have severe technical consequences", "Mitigation Strategies": "The vulnerability can be mitigated by applying the kernel patch or disabling the vulnerable feature", "Recommendations": "Executives should recommend that the organization apply the kernel patch or disable the vulnerable feature as soon as possible", "Conclusions": "The CVE-2024-39467 is a critical vulnerability that should be addressed promptly to prevent exploitation"}}