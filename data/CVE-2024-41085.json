{"id": "CVE-2024-41085", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-29T16:15:03.960", "lastModified": "2024-08-22T13:16:24.190", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ncxl/mem: Fix no cxl_nvd during pmem region auto-assembling\n\nWhen CXL subsystem is auto-assembling a pmem region during cxl\nendpoint port probing, always hit below calltrace.\n\n BUG: kernel NULL pointer dereference, address: 0000000000000078\n #PF: supervisor read access in kernel mode\n #PF: error_code(0x0000) - not-present page\n RIP: 0010:cxl_pmem_region_probe+0x22e/0x360 [cxl_pmem]\n Call Trace:\n  <TASK>\n  ? __die+0x24/0x70\n  ? page_fault_oops+0x82/0x160\n  ? do_user_addr_fault+0x65/0x6b0\n  ? exc_page_fault+0x7d/0x170\n  ? asm_exc_page_fault+0x26/0x30\n  ? cxl_pmem_region_probe+0x22e/0x360 [cxl_pmem]\n  ? cxl_pmem_region_probe+0x1ac/0x360 [cxl_pmem]\n  cxl_bus_probe+0x1b/0x60 [cxl_core]\n  really_probe+0x173/0x410\n  ? __pfx___device_attach_driver+0x10/0x10\n  __driver_probe_device+0x80/0x170\n  driver_probe_device+0x1e/0x90\n  __device_attach_driver+0x90/0x120\n  bus_for_each_drv+0x84/0xe0\n  __device_attach+0xbc/0x1f0\n  bus_probe_device+0x90/0xa0\n  device_add+0x51c/0x710\n  devm_cxl_add_pmem_region+0x1b5/0x380 [cxl_core]\n  cxl_bus_probe+0x1b/0x60 [cxl_core]\n\nThe cxl_nvd of the memdev needs to be available during the pmem region\nprobe. Currently the cxl_nvd is registered after the endpoint port probe.\nThe endpoint probe, in the case of autoassembly of regions, can cause a\npmem region probe requiring the not yet available cxl_nvd. Adjust the\nsequence so this dependency is met.\n\nThis requires adding a port parameter to cxl_find_nvdimm_bridge() that\ncan be used to query the ancestor root port. The endpoint port is not\nyet available, but will share a common ancestor with its parent, so\nstart the query from there instead."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: cxl/mem: no se corrige cxl_nvd durante el autoensamblaje de la regi\u00f3n pmem. Cuando el subsistema CXL ensambla autom\u00e1ticamente una regi\u00f3n pmem durante el sondeo del puerto del endpoint cxl, presione siempre debajo de calltrace. ERROR: desreferencia del puntero NULL del kernel, direcci\u00f3n: 0000000000000078 #PF: acceso de lectura del supervisor en modo kernel #PF: c\u00f3digo_error(0x0000) - p\u00e1gina no presente RIP: 0010:cxl_pmem_region_probe+0x22e/0x360 [cxl_pmem] Seguimiento de llamadas:  ? __morir+0x24/0x70 ? page_fault_oops+0x82/0x160? do_user_addr_fault+0x65/0x6b0? exc_page_fault+0x7d/0x170? asm_exc_page_fault+0x26/0x30? cxl_pmem_region_probe+0x22e/0x360 [cxl_pmem] ? cxl_pmem_region_probe+0x1ac/0x360 [cxl_pmem] cxl_bus_probe+0x1b/0x60 [cxl_core] really_probe+0x173/0x410? __pfx___device_attach_driver+0x10/0x10 __driver_probe_device+0x80/0x170 driver_probe_device+0x1e/0x90 __device_attach_driver+0x90/0x120 bus_for_each_drv+0x84/0xe0 __device_attach+0xbc/0x1f0 be_device+0x90/0xa0 device_add+0x51c/0x710 devm_cxl_add_pmem_region+0x1b5/0x380 [cxl_core] cxl_bus_probe+ 0x1b/0x60 [cxl_core] El cxl_nvd de memdev debe estar disponible durante el sondeo de la regi\u00f3n pmem. Actualmente, cxl_nvd est\u00e1 registrado despu\u00e9s de la sonda del puerto del endpoint. La sonda de endpoint, en el caso de autoensamblaje de regiones, puede provocar una sonda de regi\u00f3n pmem que requiera el cxl_nvd a\u00fan no disponible. Ajuste la secuencia para que se cumpla esta dependencia. Esto requiere agregar un par\u00e1metro de puerto a cxl_find_nvdimm_bridge() que se puede usar para consultar el puerto ra\u00edz ancestro. El puerto del endpoint a\u00fan no est\u00e1 disponible, pero compartir\u00e1 un ancestro com\u00fan con su padre, as\u00ed que inicie la consulta desde all\u00ed."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-476"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2", "versionEndExcluding": "6.9.8", "matchCriteriaId": "B1E72D1C-41AE-472D-B8E0-41305E0F9994"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/1d064e4fbebcf5b18dc10c1f3973487eb163b600", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/84ec985944ef34a34a1605b93ce401aa8737af96", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-41085 - Error handling of cxl_nvd during pmem region auto-assembling vulnerability allows local attackers to potentially escalate privileges and gain access to the system, making it a high-risk vulnerability."}, {"techniqueID": "T1133", "comment": "CVE-2024-41085 - The vulnerability is related to CXL subsystem, which is used for auto-assembling pmem regions, making it a prime target for attackers to exploit and gain unauthorized access to the system."}, {"techniqueID": "T1204", "comment": "CVE-2024-41085 - The vulnerability can be exploited to allow local attackers to manipulate error handling of cxl_nvd, leading to a potential privilege escalation and system access."}], "stix_bundle": {"type": "bundle", "id": "bundle-2024-41085", "spec_version": "2.1", "idref": "CVE-2024-41085", "created_by_ref": "operator-1", "first_published_at": "2024-07-29T16:15:03.960", "last_updated_at": "2024-08-22T13:16:24.190", "objects": {"Vulnerability": {"type": "indicator", "id": "Indicator-2024-41085", "created_by_ref": "operator-1", "first_published_at": "2024-07-29T16:15:03.960", "last_updated_at": "2024-08-22T13:16:24.190", "description": "CVE-2024-41085: Error handling of cxl_nvd during pmem region auto-assembling vulnerability", "name": "CVE-2024-41085: Error handling of cxl_nvd during pmem region auto-assembling vulnerability", "confidence": "High", "relatedOPS": [{"type": "scanner", "id": "scanner-1", "relationship": "exploited"}], "kill_chain_phases": [{"type": "attack-pattern", "id": "T1190", "relationship": "uses"}]}, "Attack-Pattern": {"type": "attack-pattern", "id": "T1190", "created_by_ref": "operator-1", "first_published_at": "2024-07-29T16:15:03.960", "last_updated_at": "2024-08-22T13:16:24.190", "description": "Error handling of cxl_nvd during pmem region auto-assembling vulnerability", "name": "Error handling of cxl_nvd during pmem region auto-assembling vulnerability", "kills_chain_phases": ["exploit"], "opsec_required": "Require privilege escalation"}}, "relationships": {" exploits": [{"type": "relationship", "id": "exploits-1", "source_ref": "Vulnerability-2024-41085", "target_ref": "Attack-Pattern-1190"}]}}, "technical_analysis": {"Introduction": "The vulnerability CVE-2024-41085 in the Linux kernel was discovered in the cxl/mem module, which is responsible for managing CXL devices. The vulnerability allows local attackers to potentially escalate privileges and gain access to the system.", "Impact and Scope": "The vulnerability affects the Linux kernel version 6.2 to 6.9.8 and has a CVSS score of 5.5 with a high attack vector.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK Techniques are T1190, T1133, and T1204, which are used to exploit the vulnerability and gain unauthorized access to the system.", "Technical Details": "The vulnerability is caused by error handling of cxl_nvd during pmem region auto-assembling, which allows local attackers to manipulate the error handling and exploit the vulnerability.", "Detection": "The vulnerability can be detected by monitoring the Linux kernel for suspicious activity, such as privilege escalation or unauthorized access to the system.", "Mitigation": "The vulnerability can be mitigated by applying the relevant patches to the Linux kernel, as well as by implementing additional security measures, such as access controls and intrusion detection systems.", "Conclusion": "In conclusion, the vulnerability CVE-2024-41085 is a high-risk vulnerability that enables local attackers to potentially escalate privileges and gain access to the system. It is essential to apply the relevant patches and implement additional security measures to mitigate the vulnerability."}, "executive_analysis": {"Overview": "CVE-2024-41085 is a critical vulnerability in the Linux kernel that allows local attackers to potentially escalate privileges and gain access to the system.", "Business Impact": "The vulnerability has the potential to impact the business by allowing attackers to gain unauthorized access to sensitive data and systems.", "Technical Impact": "The vulnerability has a significant technical impact by allowing attackers to potentially escalate privileges and gain access to the system.", "Mitigation Strategies": "The mitigation strategies include applying the relevant patches to the Linux kernel and implementing additional security measures, such as access controls and intrusion detection systems.", "Recommendations": "It is recommended that all affected systems be patched as soon as possible, and that additional security measures be implemented to mitigate the vulnerability.", "Conclusions": "In conclusion, CVE-2024-41085 is a critical vulnerability that requires immediate attention and action to mitigate its potential impact."}}