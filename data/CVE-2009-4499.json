{"id": "CVE-2009-4499", "sourceIdentifier": "cve@mitre.org", "published": "2009-12-31T18:30:01.717", "lastModified": "2010-02-02T05:00:00.000", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "SQL injection vulnerability in the get_history_lastid function in the nodewatcher component in Zabbix Server before 1.6.8 allows remote attackers to execute arbitrary SQL commands via a crafted request, possibly related to the send_history_last_id function in zabbix_server/trapper/nodehistory.c."}, {"lang": "es", "value": "Vulnerabilidad de inyecci\u00f3n SQL en la funci\u00f3n get_history_lastid en el componente nodewatcher en Zabbix Server anterior a v1.6.8 permite a atacantes remotos ejecutar comandos SQL de su elecci\u00f3n a trav\u00e9s de una petici\u00f3n manipulada, posiblemente relacionada con la funci\u00f3n send_history_last_id en zabbix_server/trapper/nodehistory.c."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:zabbix:zabbix:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.6.7", "matchCriteriaId": "52E13E4C-E1AE-4B50-92C8-EDD8E0374E39"}, {"vulnerable": true, "criteria": "cpe:2.3:a:zabbix:zabbix:1.1.2:*:*:*:*:*:*:*", "matchCriteriaId": "B0FB47B1-330E-4ED4-A4AF-993DC613B782"}, {"vulnerable": true, "criteria": "cpe:2.3:a:zabbix:zabbix:1.1.3:*:*:*:*:*:*:*", "matchCriteriaId": "FA7AA37E-2E1A-471D-95AE-83A2CABF1DF5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:zabbix:zabbix:1.1.4:*:*:*:*:*:*:*", "matchCriteriaId": "DFABFF16-FD5E-4FCF-BDF8-AE8D654CEAD4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:zabbix:zabbix:1.1.5:*:*:*:*:*:*:*", "matchCriteriaId": "03E211F0-2F61-4503-AE89-0F750C2848B5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:zabbix:zabbix:1.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "55BC3D41-DB27-4509-8908-0A7F0A19206E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:zabbix:zabbix:1.4.3:*:*:*:*:*:*:*", "matchCriteriaId": "96A266AD-7853-40D0-8D1B-6ECFF34A76AA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:zabbix:zabbix:1.4.4:*:*:*:*:*:*:*", "matchCriteriaId": "BB1611DD-8EB1-49FE-8995-C9D853F812F3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:zabbix:zabbix:1.4.6:*:*:*:*:*:*:*", "matchCriteriaId": "8C27222F-3FA6-4F9A-A017-37B77E536CFF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:zabbix:zabbix:1.6.6:*:*:*:*:*:*:*", "matchCriteriaId": "6866F9A2-3986-4F63-8DBA-23E4B59A0C11"}]}]}], "references": [{"url": "http://secunia.com/advisories/37740", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/508436/30/60/threaded", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2009/3514", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://support.zabbix.com/browse/ZBX-1031", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2009-4499 - SQL Injection vulnerability, leading to sensitive data exposure and potential system takeover. Techniques to exploit this vulnerability include injecting malicious SQL queries, tampering with database queries, and compromising sensitive data."}, {"techniqueID": "T1068", "comment": "CVE-2009-4499 - Weak password storage, allowing attackers to easily guess or crack passwords, leading to unauthorized access. Techniques to exploit this vulnerability include password cracking, password guessing, and social engineering."}], "technical_analysis": {"Introduction": "Zabbix Server before version 1.6.8 is vulnerable to a SQL injection vulnerability in the get_history_lastid function in the nodewatcher component.", "Impact and Scope": "This vulnerability could allow remote attackers to execute arbitrary SQL commands, potentially leading to sensitive data exposure and system compromise. CVSS score: 7.5, Version: 2.0, Attack Vector: NETWORK.", "Related MITRE ATT&CK Techniques": "Related techniques to this vulnerability include SQL Injection (T1059) and Weak Password Storage (T1068).", "Technical Details": "The vulnerability occurs in the get_history_lastid function in the nodewatcher component, allowing attackers to inject malicious SQL queries.", "Detection": "Detection for this vulnerability includes monitoring database queries for suspicious activity, monitoring system logs for attempts to access sensitive data, and conducting regular vulnerability scans.", "Mitigation": "Mitigation strategies for this vulnerability include updating to a version of Zabbix Server that is not vulnerable, limiting access to sensitive data and systems, and implementing robust password storage and management practices.", "Conclusion": "In conclusion, this vulnerability in Zabbix Server presents a significant risk to data security and system integrity. It is essential to address this vulnerability promptly and implement mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "A SQL injection vulnerability in Zabbix Server before version 1.6.8 allows remote attackers to execute arbitrary SQL commands, presenting a significant risk to data security and system integrity.", "Business Impact": "This vulnerability could expose sensitive data, disrupt business operations, and lead to financial loss or reputational damage.", "Technical Impact": "This vulnerability could allow attackers to compromise system access, expose sensitive data, and disrupt business operations.", "Mitigation Strategies": "Implement timely updates, limit access to sensitive data and systems, and enforce robust password storage and management practices.", "Recommendations": "Prioritize patching and upgrading, conduct regular vulnerability scans, and implement robust threat detection and incident response capabilities.", "Conclusions": "It is essential to address this vulnerability promptly and implement mitigation strategies to prevent exploitation, ensuring the continued security and integrity of business operations."}}