{"id": "CVE-2009-2372", "sourceIdentifier": "cve@mitre.org", "published": "2009-07-08T15:30:01.500", "lastModified": "2021-04-21T13:41:43.210", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Drupal 6.x before 6.13 does not prevent users from modifying user signatures after the associated comment format has been changed to an administrator-controlled input format, which allows remote authenticated users to inject arbitrary web script, HTML, and possibly PHP code via a crafted user signature."}, {"lang": "es", "value": "Drupal v.6x anteriores a v.6.13 no impide a los usuarios modificar sus firmas despu\u00e9s de que el formato comentado asociado ha sido cambiado a un formato de entrada controlado por administrador, que permite a usuarios autentificados remotamente inyectar codigo web, HTML y posiblemente c\u00f3digo PHP, a su elecci\u00f3n, a trav\u00e9s de la firma Crafted user."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:drupal:drupal:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.0", "versionEndExcluding": "6.13", "matchCriteriaId": "78907707-0DC4-4F74-9311-D81BDE598413"}]}]}], "references": [{"url": "http://drupal.org/node/507572", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://osvdb.org/55525", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/35681", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.securitytracker.com/id?1022497", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1190", "comment": "Drupal 6.x Web Shell - Users can inject arbitrary web script, HTML, and possibly PHP code via crafted user signature. Defend against by validating user input in comments and user signatures."}, {"techniqueID": "T1195", "comment": "Cross-Site Scripting (XSS) - Users can inject arbitrary web script, HTML, and possibly PHP code via crafted user signature. Defend against by validating user input in comments and user signatures."}], "stix_bundle": {"objects": [{"id": "vulnerability:CVE-2009-2372", "type": "vulnerability", "description": "Drupal 6.x before 6.13 does not prevent users from modifying user signatures after the associated comment format has been changed to an administrator-controlled input format, which allows remote authenticated users to inject arbitrary web script, HTML, and possibly PHP code via a crafted user signature.", "authors": [{"name": "MITRE", "organization": "MITRE"}], "objects": [{"id": "technique:T1190", "type": "technique", "description": "Web Shell", "x_mitre_ids": ["T1190"], "external_ids": ["windows-exec-remote"]}, {"id": "technique:T1195", "type": "technique", "description": "Cross-Site Scripting (XSS)", "x_mitre_ids": ["T1195"], "external_ids": ["xss"]}, {"id": "malware:Webshell", "type": "malware", "description": "Webshell", "platforms": ["Multi-platform"], "object_refs": ["technique:T1190"]}], "relations": [{"relationship_type": "TECHNIQUE USED", "objects": [{"id": "vulnerability:CVE-2009-2372", "type": "vulnerability"}, {"id": "technique:T1190", "type": "technique"}]}, {"relationship_type": "TECHNIQUE USED", "objects": [{"id": "vulnerability:CVE-2009-2372", "type": "vulnerability"}, {"id": "technique:T1195", "type": "technique"}]}]}]}, "technical_analysis": {"Introduction": "The Drupal 6.x vulnerability CVE-2009-2372 allows remote authenticated users to inject arbitrary web script, HTML, and possibly PHP code via a crafted user signature.", "Impact and Scope": "CVSS Score: 6.5 (AV:N/AC:L/Au:S/C:P/I:P/A:P). Impact and scope are limited to Drupal 6.x users with administrator-controlled comment formats.", "Related MITRE ATT&CK Techniques": "T1190 - Web Shell, T1195 - Cross-Site Scripting (XSS).", "Technical Details": "The vulnerability occurs when a user with an administrator-controlled comment format changes the comment format to a valid input format.", "Detection": "Detect users modifying comment formats to valid input formats.", "Mitigation": "Validate user input in comments and user signatures.", "Conclusion": "The Drupal 6.x vulnerability CVE-2009-2372 can be mitigated by validating user input in comments and user signatures."}, "executive_analysis": {"Overview": "A vulnerability in Drupal 6.x allows remote authenticated users to inject arbitrary web script, HTML, and possibly PHP code via a crafted user signature.", "Business Impact": "The vulnerability can allow attackers to inject malicious code or compromise the integrity of the application.", "Technical Impact": "The vulnerability can allow attackers to inject malicious code or compromise the integrity of the application.", "Mitigation Strategies": "Validate user input in comments and user signatures.", "Recommendations": "Upgrade to Drupal 6.13 or later, validate user input in comments and user signatures, and regularly scan for vulnerabilities.", "Conclusions": "The Drupal 6.x vulnerability CVE-2009-2372 is a significant risk to Drupal 6.x users and should be mitigated as soon as possible."}}