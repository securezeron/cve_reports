{"id": "CVE-2023-6693", "sourceIdentifier": "secalert@redhat.com", "published": "2024-01-02T10:15:08.930", "lastModified": "2024-05-22T17:16:09.817", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "A stack based buffer overflow was found in the virtio-net device of QEMU. This issue occurs when flushing TX in the virtio_net_flush_tx function if guest features VIRTIO_NET_F_HASH_REPORT, VIRTIO_F_VERSION_1 and VIRTIO_NET_F_MRG_RXBUF are enabled. This could allow a malicious user to overwrite local variables allocated on the stack. Specifically, the `out_sg` variable could be used to read a part of process memory and send it to the wire, causing an information leak."}, {"lang": "es", "value": "Se encontr\u00f3 un desbordamiento de b\u00fafer en la regi\u00f3n stack de la memoria en el dispositivo virtio-net de QEMU. Este problema ocurre al vaciar TX en la funci\u00f3n virtio_net_flush_tx si las funciones de invitado VIRTIO_NET_F_HASH_REPORT, VIRTIO_F_VERSION_1 y VIRTIO_NET_F_MRG_RXBUF est\u00e1n habilitadas. Esto podr\u00eda permitir que un usuario malintencionado sobrescriba las variables locales asignadas en la pila. Espec\u00edficamente, la variable `out_sg` podr\u00eda usarse para leer una parte de la memoria del proceso y enviarla al cable, provocando una fuga de informaci\u00f3n."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.4}, {"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.4, "impactScore": 3.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-787"}]}, {"source": "secalert@redhat.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-121"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:qemu:qemu:*:*:*:*:*:*:*:*", "versionEndExcluding": "8.2.1", "matchCriteriaId": "EF658C4B-28B2-4514-A3E6-8AE0F8028C53"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:-:*:*:*", "matchCriteriaId": "053C1B35-3869-41C2-9551-044182DE0A64"}, {"vulnerable": true, "criteria": "cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:advanced_virtualization:*:*:*", "matchCriteriaId": "3AA08768-75AF-4791-B229-AE938C780959"}, {"vulnerable": true, "criteria": "cpe:2.3:o:redhat:enterprise_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "7F6FB57C-2BC7-487C-96DD-132683AEB35D"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:39:*:*:*:*:*:*:*", "matchCriteriaId": "B8EDB836-4E6A-4B71-B9B2-AA3E03E0F646"}]}]}], "references": [{"url": "https://access.redhat.com/errata/RHSA-2024:2962", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/security/cve/CVE-2023-6693", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2254580", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OYGUN5HVOXESW7MSNM44E4AE2VNXQB6Y/", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20240208-0004/", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0008: Initial Access - Exploitation of Remote Services", "comment": "CVE-2023-6693 - A stack-based buffer overflow in QEMU virtio-net device can be exploited to gain initial access to the target system."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "CVE-2023-6693 - Exploitation of the QEMU virtio-net device can be done by sending malicious network packets to the target system, making this technique relevant."}, {"techniqueID": "T1231: Supply Chain Compromise", "comment": "CVE-2023-6693 - Vulnerability in QEMU virtio-net device can be used to compromise the supply chain, potentially introducing malware or other malicious code into the system."}, {"techniqueID": "TA0023: Defense Evasion - Hide Artifacts - Clear Windows Logs", "comment": "CVE-2023-6693 - After exploiting the vulnerability, an attacker may try to hide their tracks by clearing Windows logs, making this technique relevant."}, {"techniqueID": "T1020: Automated Defense Evasion", "comment": "CVE-2023-6693 - Automated tools can be used to exploit the vulnerability and evade detection by clearing logs and deleting artifacts."}, {"techniqueID": "T1036: Upload and Execute Malicious File", "comment": "CVE-2023-6693 - After exploiting the vulnerability, an attacker can upload and execute malicious code on the target system, making this technique relevant."}], "stix_bundle": {"@stix_core:Bundle": {"title": "CVE-2023-6693 Bundle", "description": "Bundle of STIX objects related to CVE-2023-6693", "objects": [{"@stix_common:Vulnerability": {"id": "CVE-2023-6693", "description": "Stack-based buffer overflow in QEMU virtio-net device", "published": "2024-01-02T10:15:08.930", "cvssScore": 5.3, "cvssVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L"}}, {"@sro:StixInformationSource": {"id": "src:cve:secalert", "title": "SecAlert", "description": "Source of CVE-2023-6693"}}, {"@sro:StixInformationSource": {"id": "src:cwe:nvd", "title": "NVD", "description": "Source of CWE-787 weakness"}}, {"@sro:StixInformationSource": {"id": "src:cwe:secalert", "title": "SecAlert", "description": "Source of CWE-121 weakness"}}, {"@cybox:Observation": {"id": "obs:exploit", "title": "Exploitation of CVE-2023-6693", "description": "Observation of exploitation of CVE-2023-6693", "techniques": [{"@stix_common:AttackPattern": {"id": "TA0008: Initial Access - Exploitation of Remote Services", "name": "Initial Access - Exploitation of Remote Services"}}]}}, {"@cybox:Observation": {"id": "obs: defense", "title": "Defense against CVE-2023-6693", "description": "Observation of defense against CVE-2023-6693", "counters": [{"@stix_common:CourseOfAction": {"id": "coa:mitigate", "name": "Mitigate"}}]}}]}}, "technical_analysis": {"Introduction": "CVE-2023-6693 is a stack-based buffer overflow in QEMU virtio-net device that can be exploited to gain initial access to the target system. The vulnerability can be exploited by sending malicious network packets to the target system.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 5.3. The vulnerability can be exploited by any user on the system, regardless of their privilege level.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: TA0008, T1190, T1231, TA0023, T1020, T1036.", "Technical Details": "The vulnerability occurs when flushing TX in the virtio_net_flush_tx function if guest features VIRTIO_NET_F_HASH_REPORT, VIRTIO_F_VERSION_1 and VIRTIO_NET_F_MRG_RXBUF are enabled.", "Detection": "Detection of this vulnerability can be done by monitoring for malicious network packets and identifying patterns of exploitation.", "Mitigation": "Mitigation of this vulnerability involves patching the QEMU virtio-net device and implementing additional security controls such as network segmentation and intrusion detection systems.", "Conclusion": "In conclusion, CVE-2023-6693 is a serious vulnerability that can be exploited to gain initial access to the target system. It is essential to patch the QEMU virtio-net device and implement additional security controls to mitigate the risk of exploitation."}, "executive_analysis": {"Overview": "CVE-2023-6693 is a vulnerability in QEMU virtio-net device that can be exploited to gain initial access to the target system.", "Business Impact": "The vulnerability can have a significant business impact, particularly for organizations that rely heavily on network communications.", "Technical Impact": "The technical impact of this vulnerability is high, with a CVSS score of 5.3. The vulnerability can be exploited by any user on the system, regardless of their privilege level.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include patching the QEMU virtio-net device and implementing additional security controls such as network segmentation and intrusion detection systems.", "Recommendations": "Recommendations for executives include implementing a patch management process, conducting regular security assessments, and ensuring that all network devices are properly configured and updated.", "Conclusions": "In conclusion, CVE-2023-6693 is a serious vulnerability that requires immediate attention and action. It is essential to patch the QEMU virtio-net device and implement additional security controls to mitigate the risk of exploitation."}}