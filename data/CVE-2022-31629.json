{
    "id": "CVE-2022-31629",
    "sourceIdentifier": "security@php.net",
    "published": "2022-09-28T23:15:10.540",
    "lastModified": "2024-11-21T07:04:53.460",
    "vulnStatus": "Modified",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "In PHP versions before 7.4.31, 8.0.24 and 8.1.11, the vulnerability enables network and same-site attackers to set a standard insecure cookie in the victim's browser which is treated as a `__Host-` or `__Secure-` cookie by PHP applications."
        },
        {
            "lang": "es",
            "value": "En PHP versiones anteriores a 7.4.31, 8.0.24 y 8.1.11, la vulnerabilidad permite a atacantes de la red y del mismo sitio establecer una cookie no segura est\u00e1ndar en el navegador de la v\u00edctima que es tratada como una cookie \"__Host-\" o \"__Secure-\" por las aplicaciones PHP"
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N",
                    "baseScore": 6.5,
                    "baseSeverity": "MEDIUM",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "REQUIRED",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "NONE",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 2.8,
                "impactScore": 3.6
            },
            {
                "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N",
                    "baseScore": 6.5,
                    "baseSeverity": "MEDIUM",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "REQUIRED",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "NONE",
                    "integrityImpact": "HIGH",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 2.8,
                "impactScore": 3.6
            }
        ]
    },
    "weaknesses": [
        {
            "source": "security@php.net",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-20"
                }
            ]
        },
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "NVD-CWE-noinfo"
                }
            ]
        },
        {
            "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-1284"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
                            "versionEndExcluding": "7.4.31",
                            "matchCriteriaId": "CE52893E-2C1E-4E15-87AA-F61CD2F49783"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "8.0.0",
                            "versionEndExcluding": "8.0.24",
                            "matchCriteriaId": "E9E90EE8-1091-4D52-A070-E378CCE5A344"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "8.1.0",
                            "versionEndExcluding": "8.1.11",
                            "matchCriteriaId": "3A9D0A59-77E8-4003-90BF-6E062540B8AD"
                        }
                    ]
                }
            ]
        },
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*",
                            "matchCriteriaId": "80E516C0-98A4-4ADE-B69F-66A772E2BAAA"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:*",
                            "matchCriteriaId": "5C675112-476C-4D7C-BCB9-A2FB2D0BC9FD"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:fedoraproject:fedora:37:*:*:*:*:*:*:*",
                            "matchCriteriaId": "E30D0E6F-4AE8-4284-8716-991DFA48CC5D"
                        }
                    ]
                }
            ]
        },
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*",
                            "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:*",
                            "matchCriteriaId": "FA6FEEC2-9F11-4643-8827-749718254FED"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "http://www.openwall.com/lists/oss-security/2024/04/12/11",
            "source": "security@php.net"
        },
        {
            "url": "https://bugs.php.net/bug.php?id=81727",
            "source": "security@php.net",
            "tags": [
                "Exploit",
                "Permissions Required",
                "Vendor Advisory"
            ]
        },
        {
            "url": "https://lists.debian.org/debian-lts-announce/2022/12/msg00030.html",
            "source": "security@php.net",
            "tags": [
                "Mailing List",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2L5SUVYGAKSWODUQPZFBUB3AL6E6CSEV/",
            "source": "security@php.net"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KJZK3X6B7FBE32FETDSMRLJXTFTHKWSY/",
            "source": "security@php.net"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LSJVPJTX7T3J5V7XHR4MFNHZGP44R5XE/",
            "source": "security@php.net"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VI3E6A3ZTH2RP7OMLJHSVFIEQBIFM6RF/",
            "source": "security@php.net"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XNIEABBH5XCXLFWWZYIDE457SPEDZTXV/",
            "source": "security@php.net"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZGWIK3HMBACERGB4TSBB2JUOMPYY2VKY/",
            "source": "security@php.net"
        },
        {
            "url": "https://security.gentoo.org/glsa/202211-03",
            "source": "security@php.net",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://security.netapp.com/advisory/ntap-20221209-0001/",
            "source": "security@php.net",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://www.debian.org/security/2022/dsa-5277",
            "source": "security@php.net",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "http://www.openwall.com/lists/oss-security/2024/04/12/11",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://bugs.php.net/bug.php?id=81727",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Exploit",
                "Permissions Required",
                "Vendor Advisory"
            ]
        },
        {
            "url": "https://lists.debian.org/debian-lts-announce/2022/12/msg00030.html",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Mailing List",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/2L5SUVYGAKSWODUQPZFBUB3AL6E6CSEV/",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/KJZK3X6B7FBE32FETDSMRLJXTFTHKWSY/",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/LSJVPJTX7T3J5V7XHR4MFNHZGP44R5XE/",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VI3E6A3ZTH2RP7OMLJHSVFIEQBIFM6RF/",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XNIEABBH5XCXLFWWZYIDE457SPEDZTXV/",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ZGWIK3HMBACERGB4TSBB2JUOMPYY2VKY/",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://security.gentoo.org/glsa/202211-03",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://security.netapp.com/advisory/ntap-20221209-0001/",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://www.debian.org/security/2022/dsa-5277",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Third Party Advisory"
            ]
        }
    ],
    "techniques": [
        {
            "techniqueID": "TA0001",
            "comment": "CVE-2022-31629 - PHP Deserialization allows attackers to set insecure cookies which can be exploited for session hijacking, API abuse, or other malicious purposes. Defend against it by limiting access to sensitive data and implementing a secure session management system."
        },
        {
            "techniqueID": "TA1533",
            "comment": "CVE-2022-31629 - PHP Deserialization allows attackers to set insecure cookies which can be exploited for session hijacking, API abuse, or other malicious purposes. Defend against it by implementing a Web Application Firewall (WAF) and configuring it to block malicious requests."
        },
        {
            "techniqueID": "T1190",
            "comment": "CVE-2022-31629 - PHP Deserialization allows attackers to set insecure cookies which can be exploited for session hijacking, API abuse, or other malicious purposes. Defend against it by implementing a secure password policy, using multiple authentication factors, and enabling account lockout policies."
        },
        {
            "techniqueID": "T1027",
            "comment": "CVE-2022-31629 - PHP Deserialization allows attackers to set insecure cookies which can be exploited for session hijacking, API abuse, or other malicious purposes. Defend against it by implementing a secure network segmentation and access control mechanisms."
        }
    ],
    "technical_analysis": {
        "Introduction": "CVE-2022-31629 is a vulnerability in PHP that allows attackers to set insecure cookies which can be exploited for session hijacking, API abuse, or other malicious purposes.",
        "Impact and Scope": "The vulnerability affects PHP versions before 7.4.31, 8.0.24, and 8.1.11 and has a CVSS score of 6.5 (Severity: Medium,CVSS: 3.1). The attack vector is network-based and same-site attacks can be used.",
        "Related MITRE ATT&CK Techniques": "TA0001, TA1533, T1190, T1027",
        "Technical Details": "The vulnerability occurs when PHP applications trust and process untrusted data for cookie value deserialization. Attackers can exploit this vulnerability by sending a crafted request to set an insecure cookie, which can be exploited for session hijacking or API abuse.",
        "Detection": "Detection of this vulnerability involves monitoring network traffic for suspicious requests and analyzing system logs for cookie setting events.",
        "Mitigation": "Mitigation strategies include updating PHP to a vulnerable version, implementing a secure cookie policy, and configuring firewalls to block malicious requests.",
        "Conclusion": "CVE-2022-31629 is a moderately severe vulnerability that should be prioritized for remediation. Implementing secure coding practices, monitoring network traffic, and configuring access control mechanisms are crucial for mitigating this vulnerability."
    },
    "executive_analysis": {
        "Overview": "CVE-2022-31629 is a PHP vulnerability that allows attackers to set insecure cookies, which can be exploited for session hijacking, API abuse, or other malicious purposes.",
        "Business Impact": "The vulnerability can lead to unauthorized access to sensitive data, financial losses, and reputation damage if not addressed promptly.",
        "Technical Impact": "The vulnerability allows attackers to set insecure cookies, which can be exploited for session hijacking, API abuse, or other malicious purposes.",
        "Mitigation Strategies": "Update PHP, implement secure cookie policies, and configure firewalls to block malicious requests.",
        "Recommendations": "Prioritize updating PHP, implement secure coding practices, and monitor network traffic for suspicious requests.",
        "Conclusions": "CVE-2022-31629 is a moderately severe vulnerability that requires immediate attention. Implementing secure coding practices, monitoring network traffic, and configuring access control mechanisms are crucial for mitigating this vulnerability."
    }
}