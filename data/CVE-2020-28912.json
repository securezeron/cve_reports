{"id": "CVE-2020-28912", "sourceIdentifier": "cve@mitre.org", "published": "2020-12-24T20:15:12.460", "lastModified": "2020-12-30T18:09:29.443", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "With MariaDB running on Windows, when local clients connect to the server over named pipes, it's possible for an unprivileged user with an ability to run code on the server machine to intercept the named pipe connection and act as a man-in-the-middle, gaining access to all the data passed between the client and the server, and getting the ability to run SQL commands on behalf of the connected user. This occurs because of an incorrect security descriptor. This affects MariaDB Server before 10.1.48, 10.2.x before 10.2.35, 10.3.x before 10.3.26, 10.4.x before 10.4.16, and 10.5.x before 10.5.7. NOTE: this issue exists because certain details of the MariaDB CVE-2019-2503 fix did not comprehensively address attack variants against MariaDB. This situation is specific to MariaDB, and thus CVE-2020-28912 does NOT apply to other vendors that were originally affected by CVE-2019-2503."}, {"lang": "es", "value": "\"Con MariaDB ejecut\u00e1ndose en Windows, cuando los clientes locales se conectan al servidor por medio de tuber\u00edas nombradas, es posible para un usuario no privilegiado con la habilidad de ejecutar c\u00f3digo en la m\u00e1quina del servidor interceptar la conexi\u00f3n de la tuber\u00eda nombrada y actuar como un man-in-the-middle, consiguiendo acceso a todos los datos transmitidos entre el cliente y el servidor, y obteniendo la capacidad de ejecutar comandos SQL en nombre del usuario conectado.&#xa0;Esto ocurre debido a un descriptor de seguridad incorrecto.&#xa0;Esto afecta a MariaDB Server versiones anteriores a 10.1.48, versiones 10.2.x anteriores a 10.2.35, versiones 10.3.x anteriores a 10.3.26, versiones 10.4.x anteriores a 10.4.16 y versiones 10.5.x anteriores a 10.5.7.&#xa0;NOTA: este problema se presenta porque determinados detalles de la soluci\u00f3n del CVE-2019-2503 de MariaDB no abordaron de manera integral las variantes de ataque contra MariaDB.&#xa0;Esta situaci\u00f3n es espec\u00edfica de MariaDB, \ny, por lo tanto, CVE-2020-28912 NO se aplica a otros proveedores que originalmente fueron afectados por CVE-2019-2503"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.0, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.0, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.4}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mariadb:mariadb:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.1.48", "matchCriteriaId": "AEA7A403-EA8B-4380-BE56-20B1A3374F57"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mariadb:mariadb:*:*:*:*:*:*:*:*", "versionStartIncluding": "10.2.0", "versionEndExcluding": "10.2.35", "matchCriteriaId": "5CC7D30E-CFBC-44E4-AC6F-012ED7B5BFED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mariadb:mariadb:*:*:*:*:*:*:*:*", "versionStartIncluding": "10.3.0", "versionEndExcluding": "10.3.26", "matchCriteriaId": "BF08B6B8-FB2D-4AAB-AB0A-D1B058C870EA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mariadb:mariadb:*:*:*:*:*:*:*:*", "versionStartIncluding": "10.4.0", "versionEndExcluding": "10.4.16", "matchCriteriaId": "75516973-6172-4478-8F5B-E95AE39C9A82"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mariadb:mariadb:*:*:*:*:*:*:*:*", "versionStartIncluding": "10.5.0", "versionEndExcluding": "10.5.7", "matchCriteriaId": "A6DA1CBD-89B4-4D16-A1E3-C9B0BFFD1939"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows:-:*:*:*:*:*:*:*", "matchCriteriaId": "A2572D17-1DE6-457B-99CC-64AFD54487EA"}]}]}], "references": [{"url": "https://hackerone.com/reports/1019891", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://jira.mariadb.org/browse/MDEV-24040", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "This threat group uses local access to exploit the vulnerability, CVE-2020-28912, to steal sensitive data. This could be achieved by intercepting the named pipe connection and acting as a man-in-the-middle. This attack can be prevented by implementing strong Security Descriptors on the server."}, {"techniqueID": "T1567", "comment": "The threat group could exploit this vulnerability, CVE-2020-28912, to gain a foothold on the system and then move laterally within the network. This could be done by exploiting the incorrect security descriptor and using the stolen data to authenticate as a legitimate user."}], "stix_bundle": {"@stix2": "2.1", "bundle_id": "b5b82ba1-aa4d-48d7-8ac5-51e5bb77edd3", "objects": [{"type": "indicator", "id": "i-1", "created_by_ref": "u-1", "name": "MariaDB Named Pipe Connection", "description": "Indicator of potential data theft or man-in-the-middle attack", "created": "2022-02-16T11:30:12"}, {"type": "identity", "id": "u-1", "created_by_ref": "c-1", "name": "Threat Actor", "description": " Threat actor responsible for the attack", "created": "2022-02-16T11:30:12"}, {"type": "course_of_action", "id": "ca-1", "created_by_ref": "u-1", "name": "Implement Strong Security Descriptors", "description": "Implement strong security descriptors on the server to prevent exploitation", "created": "2022-02-16T11:30:12", "mitigated_to": ["T1210"]}, {"type": "relationship", "id": "r-1", "source_ref": "i-1", "target_ref": "u-1", "relationship_type": "was_observed_by"}, {"type": "relationship", "id": "r-2", "source_ref": "ca-1", "target_ref": "u-1", "relationship_type": "recommended_by"}]}, "technical_analysis": {"Introduction": "The CVE-2020-28912 vulnerability in MariaDB allows an unprivileged user to intercept named pipe connections and act as a man-in-the-middle, gaining access to sensitive data.", "Impact and Scope": "This vulnerability has a CVSS score of 7.0 and can be exploited using local access. It affects MariaDB Server versions before 10.1.48, 10.2.x before 10.2.35, 10.3.x before 10.3.26, 10.4.x before 10.4.16, and 10.5.x before 10.5.7.", "Related MITRE ATT&CK Techniques": "T1210, T1567", "Technical Details": "The vulnerability is caused by an incorrect security descriptor in MariaDB, which allows an unprivileged user to intercept named pipe connections and act as a man-in-the-middle.", "Detection": "Detection of this vulnerability is challenging, as it requires monitoring for local access attempts and suspicious network traffic.", "Mitigation": "Implementing strong security descriptors on the server, limiting access to sensitive areas, and monitoring for suspicious traffic are effective mitigation strategies.", "Conclusion": "The CVE-2020-28912 vulnerability in MariaDB highlights the importance of implementing strong security measures on servers to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2020-28912 vulnerability in MariaDB can have significant business and technical impacts if left unpatched.", "Business Impact": "Exploitation of this vulnerability could result in data theft, loss of confidentiality, and reputational damage.", "Technical Impact": "The vulnerability allows an unprivileged user to intercept named pipe connections and act as a man-in-the-middle, making it a serious threat to the integrity of the system.", "Mitigation Strategies": "Implementing strong security descriptors, limiting access to sensitive areas, and monitoring for suspicious traffic are high-level mitigation strategies.", "Recommendations": "Executives should prioritize patching and updating their MariaDB instances to the latest versions, and implement strong security measures to prevent exploitation.", "Conclusions": "The CVE-2020-28912 vulnerability in MariaDB is a serious threat that requires immediate attention and action to prevent exploitation."}}