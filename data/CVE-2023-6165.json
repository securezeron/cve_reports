{"id": "CVE-2023-6165", "sourceIdentifier": "contact@wpscan.com", "published": "2024-01-29T15:15:09.250", "lastModified": "2024-02-03T01:25:24.337", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Restrict Usernames Emails Characters WordPress plugin before 3.1.4 does not sanitise and escape some of its settings, which could allow high privilege users such as admin to perform Cross-Site Scripting attacks even when unfiltered_html is disallowed"}, {"lang": "es", "value": "El complemento de WordPress Restrict Usernames Emails Characters anterior a 3.1.4 no sanitiza ni escapa a algunas de sus configuraciones, lo que podr\u00eda permitir a usuarios con altos privilegios, como el administrador, realizar ataques de cross site scripting incluso cuando unfiltered_html no est\u00e1 permitido."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:benaceur-php:restrict_usernames_emails_characters:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "3.1.4", "matchCriteriaId": "404964B0-8C7B-4C53-93A7-3143E5E2B4AA"}]}]}], "references": [{"url": "https://github.com/youki992/youki992.github.io/blob/master/others/apply2.md", "source": "contact@wpscan.com", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://wpscan.com/vulnerability/aba62286-9a82-4d5b-9b47-1fddde5da487/", "source": "contact@wpscan.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1046", "comment": "Cross-Site Scripting (XSS) - Web attacks can be used to inject malicious JavaScript code into vulnerable web applications, which can lead to unauthorized access to user data. - Why this is relevant and how to defend against it"}, {"techniqueID": "T1190", "comment": "Cross-Site Request Forgery (CSRF) - A malicious actor can trick a victim into performing unintended actions on a web application, leading to data compromise or other malicious activities. - Why this is relevant and how to defend against it"}, {"techniqueID": "T1567", "comment": "Phishing - Malicious actors can use phishing emails or messages to trick users into divulging sensitive information or installing malware. - Why this is relevant and how to defend against it"}, {"techniqueID": "T1078", "comment": "Web Application Scanning - Adversaries can use automated tools to scan web applications for vulnerabilities, and exploit them for unauthorized access. - Why this is relevant and how to defend against it"}, {"techniqueID": "T1190", "comment": "Cross-Site Request Forgery (CSRF) - A malicious actor can trick a victim into performing unintended actions on a web application, leading to data compromise or other malicious activities. - Why this is relevant and how to defend against it"}, {"techniqueID": "T1552", "comment": "Stealing Web Browsers Content - An adversary can use malicious JavaScript to steal sensitive information, such as login credentials, from web browsers. - Why this is relevant and how to defend against it"}, {"techniqueID": "T1032", "comment": "Network Service Scanning - Adversaries can use network scanning techniques to identify and exploit vulnerabilities in network services. - Why this is relevant and how to defend against it"}], "stix_bundle": {"@context": "https://stix2.io/schema/2.1", "entities": [{"@type": "software", "id": "cve-2023-6165-software", "name": "Restrict Usernames Emails Characters", "version": "3.1.4"}, {"@type": "attack-pattern", "id": "cve-2023-6165-attack-pattern", "name": "Cross-Site Scripting (XSS) in Restrict Usernames Emails Characters", "description": "An attacker can inject malicious JavaScript code into vulnerable web applications, leading to unauthorized access to user data."}, {"@type": "intrusion-set", "id": "cve-2023-6165-intrusion-set", "name": "Web Application Scanners"}, {"@type": "vulnerability", "id": "cve-2023-6165-vulnerability", "name": "Unsanitized and Unescaped Settings in Restrict Usernames Emails Characters", "description": "The Restrict Usernames Emails Characters plugin does not sanitize and escape some of its settings, which could allow high privilege users such as admin to perform Cross-Site Scripting attacks even when unfiltered_html is disallowed."}, {"@type": "course-of-action", "id": "cve-2023-6165-coa", "name": "Update to version 3.1.4 or later", "description": "Update the Restrict Usernames Emails Characters plugin to version 3.1.4 or later."}, {"@type": "note", "id": "cve-2023-6165-note", "name": "Defense Against Cross-Site Scripting", "description": "Implement defense-in-depth measures, such as using Content Security Policy (CSP) and input validation, to prevent Cross-Site Scripting attacks."}], "relationship": [{"type": "related-to", "source_id": "cve-2023-6165-vulnerability", "target_id": "cve-2023-6165-attack-pattern"}, {"type": "related-to", "source_id": "cve-2023-6165-software", "target_id": "cve-2023-6165-vulnerability"}, {"type": "mitigated-by", "source_id": "cve-2023-6165-vulnerability", "target_id": "cve-2023-6165-coa"}, {"type": "suggested-countermeasure", "source_id": "cve-2023-6165-vulnerability", "target_id": "cve-2023-6165-note"}]}, "technical_analysis": {"Introduction": "The Restrict Usernames Emails Characters plugin for WordPress is vulnerable to Cross-Site Scripting (XSS) due to unsanitized and unescaped settings. This allows high privilege users to perform unauthorized actions on the web application.", "Impact and Scope": "The vulnerability has a CVSS score of 4.8, with an attack vector of NETWORK and an attack complexity of LOW. The vulnerability can be exploited by high-privilege users, potentially leading to data compromise or other malicious activities.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques such as Cross-Site Scripting (T1046), Phishing (T1567), and Web Application Scanning (T1078).", "Technical Details": "The vulnerability is due to the lack of sanitization and escape of settings in the Restrict Usernames Emails Characters plugin. This can be exploited by an attacker to inject malicious JavaScript code into the web application, leading to unauthorized access to user data.", "Detection": "The vulnerability can be detected using automated tools and manual testing. Additionally, implementing defense-in-depth measures, such as using Content Security Policy (CSP) and input validation, can help prevent Cross-Site Scripting attacks.", "Mitigation": "The vulnerability can be mitigated by updating the Restrict Usernames Emails Characters plugin to version 3.1.4 or later. Additionally, implementing defense-in-depth measures, such as using Content Security Policy (CSP) and input validation, can help prevent Cross-Site Scripting attacks.", "Conclusion": "The Restrict Usernames Emails Characters plugin for WordPress is vulnerable to Cross-Site Scripting (XSS) due to unsanitized and unescaped settings. It is essential to update the plugin to version 3.1.4 or later and implement defense-in-depth measures to prevent unauthorized access to user data."}, "executive_analysis": {"Overview": "The Restrict Usernames Emails Characters plugin for WordPress is vulnerable to Cross-Site Scripting (XSS) due to unsanitized and unescaped settings. This vulnerability can allow high-privilege users to perform unauthorized actions on the web application.", "Business Impact": "This vulnerability can lead to data compromise, unauthorized access to user data, or other malicious activities, which can have significant business implications.", "Technical Impact": "The vulnerability can be exploited by an attacker to inject malicious JavaScript code into the web application, leading to unauthorized access to user data.", "Mitigation Strategies": "The vulnerability can be mitigated by updating the Restrict Usernames Emails Characters plugin to version 3.1.4 or later. Additionally, implementing defense-in-depth measures, such as using Content Security Policy (CSP) and input validation, can help prevent Cross-Site Scripting attacks.", "Recommendations": "We recommend that WordPress users update the Restrict Usernames Emails Characters plugin to version 3.1.4 or later and implement defense-in-depth measures to prevent unauthorized access to user data.", "Conclusions": "The Restrict Usernames Emails Characters plugin for WordPress is vulnerable to Cross-Site Scripting (XSS) due to unsanitized and unescaped settings. It is essential to address this vulnerability to prevent unauthorized access to user data."}}