{"id": "CVE-2024-41664", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-23T17:15:12.767", "lastModified": "2024-07-24T12:55:13.223", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Canarytokens help track activity and actions on a network. Prior to `sha-8ea5315`, Canarytokens.org was vulnerable to a blind SSRF in the Webhook alert feature. When a Canarytoken is created, users choose to receive alerts either via email or via a webhook. If a webhook is supplied when a  Canarytoken is first created, the site will make a test request to the supplied URL to ensure it accepts alert notification HTTP requests. No safety checks were performed on the URL, leading to a Server-Side Request Forgery vulnerability. The SSRF is Blind because the content of the response is not displayed to the creating user; they are simply told whether an error occurred in making the test request. Using the Blind SSRF, it was possible to map out open ports for IPs inside the Canarytokens.org infrastructure. This issue is now patched on Canarytokens.org. Users of self-hosted Canarytokens installations can update by pulling the latest Docker image, or any Docker image after `sha-097d91a`."}, {"lang": "es", "value": "Los Canarytokens ayudan a rastrear la actividad y las acciones en una red. Antes de `sha-8ea5315`, Canarytokens.org era vulnerable a SSRF ciego en la funci\u00f3n de alerta de Webhook. Cuando se crea un Canarytoken, los usuarios eligen recibir alertas por correo electr\u00f3nico o mediante un webhook. Si se proporciona un webhook cuando se crea un Canarytoken por primera vez, el sitio realizar\u00e1 una solicitud de prueba a la URL proporcionada para garantizar que acepta solicitudes HTTP de notificaci\u00f3n de alerta. No se realizaron comprobaciones de seguridad en la URL, lo que provoc\u00f3 una vulnerabilidad de Server-Side Request Forgery. El SSRF es ciego porque el contenido de la respuesta no se muestra al usuario creador; simplemente se les dice si ocurri\u00f3 un error al realizar la solicitud de prueba. Utilizando Blind SSRF, fue posible mapear puertos abiertos para IP dentro de la infraestructura de Canarytokens.org. Este problema ya est\u00e1 solucionado en Canarytokens.org. Los usuarios de instalaciones de Canarytokens autohospedadas pueden actualizar extrayendo la \u00faltima imagen de Docker o cualquier imagen de Docker despu\u00e9s de `sha-097d91a`."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-918"}]}], "references": [{"url": "https://github.com/thinkst/canarytokens/security/advisories/GHSA-g6h5-pf7p-qmvj", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-41664 - Blind SSRF vulnerability leading to unauthorized information disclosure. Defend against this by implementing input validation and sanitization, limiting network access, and monitoring network traffic."}, {"techniqueID": "T1190", "comment": "CVE-2024-41664 - SSRF can be used to map open ports for IPs inside the Canarytokens.org infrastructure, potentially allowing attackers to gather information about the network. Defend against this by segmenting the network, implementing firewalls, and monitoring network traffic."}, {"techniqueID": "T1568", "comment": "CVE-2024-41664 - Webhook alert feature stored in an insecure location, allowing unauthorized access. Defend against this by securing storage of sensitive information, implementing access controls, and monitoring network traffic."}], "stix_bundle": {"objects": [{"id": "https://example.com/cve-2024-41664", "type": "attack-pattern", "name": "Blind SSRF Vulnerability", "description": "A blind SSRF vulnerability was discovered in the Webhook alert feature of Canarytokens.org, allowing attackers to map open ports for IPs inside the infrastructure.", "relates_to": [{"id": "https://example.com/cve-2024-41664", "type": "vulnerability", "role": "related"}]}, {"id": "https://example.com/cve-2024-41664", "type": "vulnerability", "name": "CVE-2024-41664", "description": "A blind SSRF vulnerability was found in the Webhook alert feature of Canarytokens.org. The vulnerability allows attackers to map open ports for IPs inside the infrastructure.", "related_objects": [{"id": "https://example.com/blind-srdf-vulnerability", "type": "attack-pattern", "role": "associated_attack_pattern"}]}, {"id": "https://example.com/securing-storage", "type": " course-of-action", "name": "Securing Storage", "description": "Secure storage of sensitive information by implementing access controls and encryption.", "mitigates": [{"id": "https://example.com/cve-2024-41664", "type": "vulnerability", "role": "mitigates"}]}], "relationships": [{"from": "https://example.com/blind-srdf-vulnerability", "to": "https://example.com/cve-2024-41664", "role": "associated_attack_pattern", "type": "attack-pattern"}, {"from": "https://example.com/securing-storage", "to": "https://example.com/cve-2024-41664", "role": "mitigates", "type": "course-of-action"}, {"from": "https://example.com/cve-2024-41664", "to": "https://example.com/blind-srdf-vulnerability", "role": "related", "type": "vulnerability"}]}, "technical_analysis": {"Introduction": "The CVE-2024-41664 vulnerability is a blind SSRF vulnerability found in the Webhook alert feature of Canarytokens.org.", "Impact and Scope": "The vulnerability allows attackers to map open ports for IPs inside the Canarytokens.org infrastructure, potentially allowing unauthorized access and information disclosure.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to techniques T1210, T1190, and T1568, which involve using SSRF and attacks against webhooks.", "Technical Details": "The vulnerability was caused by a lack of input validation and sanitization, leading to unauthorized requests being made to internal URLs.", "Detection": "Detect the vulnerability by monitoring network traffic and looking for unusual requests to internal URLs.", "Mitigation": "Mitigate the vulnerability by implementing input validation and sanitization, limiting network access, and securing storage of sensitive information.", "Conclusion": "The CVE-2024-41664 vulnerability highlights the importance of proper input validation and sanitization in web applications."}, "executive_analysis": {"Overview": "CVE-2024-41664 is a significant vulnerability that affects the Webhook alert feature of Canarytokens.org.", "Business Impact": "The vulnerability can lead to unauthorized access and information disclosure, potentially causing significant financial and reputational damage.", "Technical Impact": "The vulnerability allows attackers to map open ports for IPs inside the Canarytokens.org infrastructure, potentially allowing unauthorized access and information disclosure.", "Mitigation Strategies": "Implement input validation and sanitization, limit network access, and secure storage of sensitive information to mitigate the vulnerability.", "Recommendations": "Recommend implementing robust input validation and sanitization, as well as securing storage of sensitive information, to prevent similar vulnerabilities in the future.", "Conclusions": "The CVE-2024-41664 vulnerability highlights the importance of robust security measures and regular vulnerability testing in web applications."}}