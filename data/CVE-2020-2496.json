{"id": "CVE-2020-2496", "sourceIdentifier": "security@qnapsecurity.com.tw", "published": "2020-12-10T04:15:11.923", "lastModified": "2021-06-22T21:00:38.707", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "If exploited, this cross-site scripting vulnerability could allow remote attackers to inject malicious code in File Station. QANP have already fixed these vulnerabilities in the following versions of QTS and QuTS hero. QuTS hero h4.5.1.1472 build 20201031 and later QTS 4.5.1.1456 build 20201015 and later QTS 4.4.3.1354 build 20200702 and later QTS 4.3.6.1333 build 20200608 and later QTS 4.3.4.1368 build 20200703 and later QTS 4.3.3.1315 build 20200611 and later QTS 4.2.6 build 20200611 and later"}, {"lang": "es", "value": "Si era explotada, esta vulnerabilidad de tipo cross-site scripting podr\u00eda permitir a atacantes remotos inyectar c\u00f3digo malicioso en File Station.&#xa0;QNAP ya ha corregido estas vulnerabilidades en las siguientes versiones de QTS y QuTS hero.&#xa0;QuTS hero versi\u00f3n h4.5.1.1472 build 20201031 y posterior, QTS versi\u00f3n 4.5.1.1456 build 20201015 y posterior, QTS versi\u00f3n 4.4.3.1354 build 20200702 y posterior, QTS versi\u00f3n 4.3.6.1333 build 20200608 y posterior, QTS versi\u00f3n 4.3.4.1368 build 20200703 y posterior, QTS versi\u00f3n 4.3.3.1315 build 20200611 y posterior, QTS versi\u00f3n 4.2.6 build 20200611 y posterior"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security@qnapsecurity.com.tw", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}, {"lang": "en", "value": "CWE-80"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:quts_hero:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.5.1.1472", "matchCriteriaId": "ACABFEAE-2A93-4E81-9F73-706FEE68C1DF"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:qts:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.5.1.1456", "matchCriteriaId": "0DF58F11-5E71-4EFB-8039-B4EA21C2C810"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:qts:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.4.3.1354", "matchCriteriaId": "5C993531-A910-4F15-ABD3-31261D560C76"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:qts:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.3.6.1333", "matchCriteriaId": "CED08145-C2CF-484B-B66D-5469591040E8"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:qts:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.3.4.1368", "matchCriteriaId": "BA15CC08-00FA-4682-8DD9-0B1AF10E40E7"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:qts:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.3.3.1315", "matchCriteriaId": "87533C7A-38F8-4487-A753-EBB911F2A76C"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:qnap:qts:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.2.6", "matchCriteriaId": "3777F6CC-9189-4BC0-B336-62BA1EFB91A7"}]}]}], "references": [{"url": "https://www.qnap.com/en/security-advisory/qsa-20-12", "source": "security@qnapsecurity.com.tw", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0010", "comment": "CVE-2020-2496 - A malicious script can be injected in the File Station. An attacker could use this technique to execute arbitrary code on the vulnerable system."}, {"techniqueID": "TA0036", "comment": "CVE-2020-2496 - A malicious script can be injected in the File Station. This technique allows an attacker to move laterally within the network."}, {"techniqueID": "TA0005", "comment": "CVE-2020-2496 - A malicious script can be injected in the File Station. This technique allows an attacker to execute arbitrary code on the vulnerable system."}, {"techniqueID": "TA0040", "comment": "CVE-2020-2496 - A malicious script can be injected in the File Station. This technique allows an attacker to move laterally within the network and execute arbitrary code on the vulnerable system."}], "stix_bundle": {"id": "urn:cve:CVE-2020-2496", "type": "indicator", "created_by": "https://stix.example.com", "created": "2021-07-22T14:30:00.000Z", "modified": "2021-07-22T14:30:00.000Z", "affected_items": [{"id": "urn:cve:CVE-2020-2496", "type": "vulnerability", "name": "CVE-2020-2496", "description": "A cross-site scripting vulnerability in QNAP QTS and QuTS hero allows remote attackers to inject malicious code in File Station."}], "reported_by": "https://www.qnap.com", "ratings": [{"id": "cvss_v3_vector", "value": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"}, {"id": "cwe_id", "value": "CWE-79"}], "indicators": [{"id": "indicator-1", "type": "network-traffic", "definition": "Network traffic pattern indicative of the vulnerability exploitation.", "description": "Network traffic pattern indicative of the vulnerability exploitation.", "created": "2021-07-22T14:30:00.000Z", "modified": "2021-07-22T14:30:00.000Z"}], "courses_of_action": [{"id": "COA-1", "type": "mitigation", "name": "Update QNAP QTS and QuTS hero to a fixed version", "description": "Update QNAP QTS and QuTS hero to a fixed version to mitigate the vulnerability.", "relationship": "PROTECTS", "target": "indicator-1"}, {"id": "COA-2", "type": "detection", "name": "Use a web application firewall to detect and block malicious traffic", "description": "Use a web application firewall to detect and block malicious traffic indicative of the vulnerability exploitation.", "relationship": "DETECTS", "target": "indicator-1"}], "notes": [{"id": "note-1", "text": "Patch management is key in mitigating this vulnerability."}]}, "technical_analysis": {"Introduction": "CVE-2020-2496 is a cross-site scripting vulnerability in QNAP QTS and QuTS hero that allows remote attackers to inject malicious code in File Station.", "Impact and Scope": "The vulnerability has a CVSS score of 6.1 and an attack vector of NETWORK. It can be exploited to inject malicious code in File Station, allowing an attacker to execute arbitrary code on the vulnerable system.", "Related MITRE ATT&CK Techniques": "The vulnerability can be exploited using TA0010, TA0036, TA0005, and TA0040 MITRE ATT&CK techniques.", "Technical Details": "The vulnerability is due to an insufficient validation of user input in the File Station web interface.", "Detection": "The vulnerability can be detected by monitoring for unusual network traffic patterns indicative of the vulnerability exploitation.", "Mitigation": "The vulnerability can be mitigated by updating QNAP QTS and QuTS hero to a fixed version and using a web application firewall to detect and block malicious traffic.", "Conclusion": "In conclusion, CVE-2020-2496 is a serious vulnerability in QNAP QTS and QuTS hero that can be exploited to inject malicious code in File Station. It is essential to update QNAP QTS and QuTS hero to a fixed version and use a web application firewall to detect and block malicious traffic."}, "executive_analysis": {"Overview": "CVE-2020-2496 is a cross-site scripting vulnerability in QNAP QTS and QuTS hero that can allow remote attackers to inject malicious code in File Station.", "Business Impact": "The vulnerability can allow an attacker to execute arbitrary code on the vulnerable system, leading to unauthorized access to sensitive data and disruption of business operations.", "Technical Impact": "The vulnerability can be exploited using TA0010, TA0036, TA0005, and TA0040 MITRE ATT&CK techniques.", "Mitigation Strategies": "The vulnerability can be mitigated by updating QNAP QTS and QuTS hero to a fixed version and using a web application firewall to detect and block malicious traffic.", "Recommendations": "Recall all affected products and update them to a fixed version, and use a web application firewall to detect and block malicious traffic.", "Conclusions": "In conclusion, CVE-2020-2496 is a serious vulnerability in QNAP QTS and QuTS hero that requires immediate attention and mitigation."}}