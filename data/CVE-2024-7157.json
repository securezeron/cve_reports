{"id": "CVE-2024-7157", "sourceIdentifier": "cna@vuldb.com", "published": "2024-07-28T11:15:12.107", "lastModified": "2024-08-08T12:17:46.953", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability was found in TOTOLINK A3100R 4.1.2cu.5050_B20200504. It has been classified as critical. This affects the function getSaveConfig of the file /cgi-bin/cstecgi.cgi?action=save&setting. The manipulation of the argument http_host leads to buffer overflow. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The associated identifier of this vulnerability is VDB-272571. NOTE: The vendor was contacted early about this disclosure but did not respond in any way."}, {"lang": "es", "value": "Se encontr\u00f3 una vulnerabilidad en TOTOLINK A3100R 4.1.2cu.5050_B20200504. Ha sido clasificada como cr\u00edtica. Esto afecta a la funci\u00f3n getSaveConfig del archivo /cgi-bin/cstecgi.cgi?action=save&amp;setting. La manipulaci\u00f3n del argumento http_host provoca un desbordamiento de b\u00fafer. Es posible iniciar el ataque de forma remota. El exploit ha sido divulgado al p\u00fablico y puede utilizarse. El identificador asociado de esta vulnerabilidad es VDB-272571. NOTA: Se contact\u00f3 al proveedor tempranamente sobre esta divulgaci\u00f3n, pero no respondi\u00f3 de ninguna manera."}], "metrics": {"cvssMetricV40": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "attackVector": "NETWORK", "attackComplexity": "LOW", "attackRequirements": "NONE", "privilegesRequired": "LOW", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "HIGH", "vulnerableSystemIntegrity": "HIGH", "vulnerableSystemAvailability": "HIGH", "subsequentSystemConfidentiality": "NONE", "subsequentSystemIntegrity": "NONE", "subsequentSystemAvailability": "NONE", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NOT_DEFINED", "recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED", "baseScore": 8.7, "baseSeverity": "HIGH"}}], "cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-120"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:totolink:a3100r_firmware:4.1.2cu.5050_b20200504:*:*:*:*:*:*:*", "matchCriteriaId": "0BD0B6FC-5C4F-4547-883D-7B9C03B45523"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:totolink:a3100r:-:*:*:*:*:*:*:*", "matchCriteriaId": "40729E79-9D89-440F-B38D-E62D310E27F9"}]}]}], "references": [{"url": "https://github.com/abcdefg-png/IoT-vulnerable/blob/main/TOTOLINK/A3100R/getSaveConfig.md", "source": "cna@vuldb.com", "tags": ["Exploit"]}, {"url": "https://vuldb.com/?ctiid.272571", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.272571", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?submit.377542", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2024-7157 - Initial Access via External Remote Services, vulnerability in TOTOLINK A3100R 4.1.2cu.5050_B20200504 allows an attacker to launch a buffer overflow attack exploiting the getSaveConfig function in /cgi-bin/cstecgi.cgi?action=save&setting."}, {"techniqueID": "TA0002", "comment": "CVE-2024-7157 - Execution via Speculative Execution, vulnerability in TOTOLINK A3100R 4.1.2cu.5050_B20200504 allows an attacker to execute arbitrary code exploiting the getSaveConfig function in /cgi-bin/cstecgi.cgi?action=save&setting."}, {"techniqueID": "T1190", "comment": "CVE-2024-7157 - Exploit Public-Facing Application, vulnerability in TOTOLINK A3100R 4.1.2cu.5050_B20200504 allows an attacker to exploit a public-facing application, potentially leading to remote code execution."}, {"techniqueID": "T1191", "comment": "CVE-2024-7157 - Exploit Remote Service, vulnerability in TOTOLINK A3100R 4.1.2cu.5050_B20200504 allows an attacker to exploit a remote service, potentially leading to remote code execution."}], "stix_bundle": {"bundle_type": "bundle", "id": "urn:STIX%%3A1.2", "label": "STIX Bundle for CVE-2024-7157", "description": "STIX Bundle for CVE-2024-7157", "objects": [{"id": "urn:STIX%%3A1.2%2FCVE%2FCVE-2024-7157", "type": "vulnerability", "name": "CVE-2024-7157", "description": "A vulnerability was found in TOTOLINK A3100R 4.1.2cu.5050_B20200504. It has been classified as critical. This affects the function getSaveConfig of the file /cgi-bin/cstecgi.cgi?action=save&setting. The manipulation of the argument http_host leads to buffer overflow.", "severity": "high", "published": "2024-07-28T11:15:12.107", "last_modified": "2024-08-08T12:17:46.953"}, {"id": "urn:STIX%%3A1.2%2FTactic%2FTA0001", "type": "tactic", "name": "TA0001", "description": "Initial Access via External Remote Services", "label": "Initial Access"}, {"id": "urn:STIX%%3A1.2%2TTactic%2FTA0002", "type": "tactic", "name": "TA0002", "description": "Execution via Speculative Execution", "label": "Execution"}, {"id": "urn:STIX%%3A1.2%2TPattern%2TT1190", "type": "pattern", "name": "T1190", "description": "Exploit Public-Facing Application", "label": "Exploit Public-Facing Application"}, {"id": "urn:STIX%%3A1.2%2TPattern%2TT1191", "type": "pattern", "name": "T1191", "description": "Exploit Remote Service", "label": "Exploit Remote Service"}, {"id": "urn:STIX%%3A1.2%2COURSE_OF_ACTION%2CAttack%2CDefensive_measure", "type": "course_of_action", "name": "Defend against CVE-2024-7157", "description": "Implement the mitigation strategies outlined in this report to prevent exploitation of the vulnerability.", "mitigates": ["urn:STIX%%3A1.2%2FPattern%2FT1190"]}], "relationships": [{"id": "urn:STIX%%3Ar321-f456-etc-relationships", "type": "has_part", "source_ref": "urn:STIX%%3A1.2%2FCVE%2FCVE-2024-7157", "target_ref": "urn:STIX%%3A1.2%2TTactic%2FTA0001"}, {"id": "urn:STIX%%3Ar321-f456-etc-relationships", "type": "has_part", "source_ref": "urn:STIX%%3A1.2%2FCVE%2FCVE-2024-7157", "target_ref": "urn:STIX%%3A1.2%2TTactic%2FTA0002"}, {"id": "urn:STIX%%3Ar321-f456-etc-relationships", "type": "associated_with", "source_ref": "urn:STIX%%3A1.2%2FCVE%2FCVE-2024-7157", "target_ref": "urn:STIX%%3A1.2%2TPattern%2TT1190"}, {"id": "urn:STIX%%3Ar321-f456-etc-relationships", "type": "has_part", "source_ref": "urn:STIX%%3A1.2%2FCVE%2FCVE-2024-7157", "target_ref": "urn:STIX%%3A1.2%2TPattern%2TT1191"}, {"id": "urn:STIX%%3Ar321-f456-etc-relationships", "type": "mitigated_by", "source_ref": "urn:STIX%%3A1.2%2FCourse_of_action%2CDefensive_measure", "target_ref": "urn:STIX%%3A1.2%2FLocation%2FCVE-2024-7157"}, {"id": "urn:STIX%%3Ar321-f456-etc-relationships", "type": "mitigates", "source_ref": "urn:STIX%%3A1.2%2FCourse_of_action%2CDefensive_measure", "target_ref": "urn:STIX%%3A1.2%2FPattern%2FT1190"}]}, "technical_analysis": {"Introduction": "This report provides a technical analysis of the CVE-2024-7157 vulnerability, including its impact, scope, and mitigation strategies.", "Impact and Scope": "The CVE-2024-7157 vulnerability allows an attacker to launch a buffer overflow attack, potentially leading to remote code execution. The vulnerability affects all devices running TOTOLINK A3100R 4.1.2cu.5050_B20200504 firmware.", "Related MITRE ATT&CK Techniques": "The CVE-2024-7157 vulnerability is related to several MITRE ATT&CK techniques, including Initial Access via External Remote Services (TA0001) and Execution via Speculative Execution (TA0002).", "Technical Details": "A buffer overflow occurs when an application writes more data to a buffer than the buffer can hold, potentially leading to code execution. The vulnerability is exploited by manipulating the argument http_host in the getSaveConfig function.", "Detection": "The vulnerability can be detected by monitoring network traffic and looking for suspicious buffer overflow attempts.", "Mitigation": "The vulnerability can be mitigated by implementing a software patch or by restricting access to the affected system.", "Conclusion": "In conclusion, the CVE-2024-7157 vulnerability is a critical security issue that requires immediate attention. Implementing mitigation strategies outlined in this report is essential to prevent exploitation of the vulnerability."}, "executive_analysis": {"Overview": "This report provides an overview of the CVE-2024-7157 vulnerability, including its impact and scope, as well as mitigation strategies.", "Business Impact": "The CVE-2024-7157 vulnerability has the potential to compromise the confidentiality, integrity, and availability of sensitive data, which could have significant business impact.", "Technical Impact": "The vulnerability allows an attacker to launch a buffer overflow attack, potentially leading to remote code execution, which could compromise the security of the affected system.", "Mitigation Strategies": "Implementing mitigation strategies outlined in this report, such as patching the affected system or restricting access, is essential to prevent exploitation of the vulnerability.", "Recommendations": "We recommend that executives prioritize implementing mitigation strategies outlined in this report to protect against the CVE-2024-7157 vulnerability.", "Conclusions": "In conclusion, the CVE-2024-7157 vulnerability is a critical security issue that requires immediate attention. Implementing mitigation strategies outlined in this report is essential to prevent exploitation of the vulnerability and protect against potential business impact."}}