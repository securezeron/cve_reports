{"id": "CVE-2021-3618", "sourceIdentifier": "secalert@redhat.com", "published": "2022-03-23T20:15:09.833", "lastModified": "2023-02-09T02:03:34.457", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "ALPACA is an application layer protocol content confusion attack, exploiting TLS servers implementing different protocols but using compatible certificates, such as multi-domain or wildcard certificates. A MiTM attacker having access to victim's traffic at the TCP/IP layer can redirect traffic from one subdomain to another, resulting in a valid TLS session. This breaks the authentication of TLS and cross-protocol attacks may be possible where the behavior of one protocol service may compromise the other at the application layer."}, {"lang": "es", "value": "ALPACA es un ataque de confusi\u00f3n de contenido de protocolo de capa de aplicaci\u00f3n, que explota servidores TLS que implementan diferentes protocolos pero que usan certificados compatibles, como certificados multidominio o comod\u00edn. Un atacante de tipo MiTM que tenga acceso al tr\u00e1fico de la v\u00edctima en la capa TCP/IP puede redirigir el tr\u00e1fico de un subdominio a otro, resultando en a una sesi\u00f3n TLS v\u00e1lida. Esto rompe la autenticaci\u00f3n de TLS y pueden ser posibles los ataques entre protocolos donde el comportamiento de un servicio de protocolo puede comprometer al otro en la capa de aplicaci\u00f3n"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-295"}]}, {"source": "nvd@nist.gov", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-295"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:f5:nginx:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.21.0", "matchCriteriaId": "777D8DB3-65CF-4A12-BCCE-30849CE07762"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sendmail:sendmail:*:*:*:*:*:*:*:*", "versionEndExcluding": "8.17", "matchCriteriaId": "2E5DF525-823F-49D0-BDD2-6BCE5EE0F66B"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:vsftpd_project:vsftpd:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.0.4", "matchCriteriaId": "CA84E5A7-7557-4805-902B-E8069F5F4091"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*", "matchCriteriaId": "E460AA51-FCDA-46B9-AE97-E6676AA5E194"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*", "matchCriteriaId": "A930E247-0B43-43CB-98FF-6CE7B8189835"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*", "matchCriteriaId": "80E516C0-98A4-4ADE-B69F-66A772E2BAAA"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}], "references": [{"url": "https://alpaca-attack.com/", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1975623", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2022/11/msg00031.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1214", "comment": "ALPACA - Exploiting TLS servers implementing different protocols but using compatible certificates. This technique targets the CVE-2021-3618 vulnerability, where a MiTM attacker can redirect traffic from one subdomain to another, resulting in a valid TLS session."}, {"techniqueID": "T1190", "comment": "Exploitation of multi-domain or wildcard certificates to establish a valid TLS session. This technique is relevant to the CVE-2021-3618 vulnerability, where the ALPACA attack can be used to compromise the authentication of TLS and enable cross-protocol attacks."}, {"techniqueID": "T1505", "comment": "Using TCP/IP layer access to redirect traffic from one subdomain to another, resulting in a valid TLS session. This technique is employed by the ALPACA attack, which targets the CVE-2021-3618 vulnerability."}, {"techniqueID": "T1102", "comment": "Using man-in-the-middle (MiTM) attacks to compromise the authentication of TLS and enable cross-protocol attacks. This technique is relevant to the CVE-2021-3618 vulnerability, where the ALPACA attack can be used to exploit TLS servers implementing different protocols but using compatible certificates."}], "stix_bundle": "INSERT_STIX_2.1_BUNDLE_HERE", "technical_analysis": {"Introduction": "The ALPACA attack exploits TLS servers implementing different protocols but using compatible certificates, allowing a MiTM attacker to redirect traffic from one subdomain to another, resulting in a valid TLS session. This vulnerability targets the confidentiality, integrity, and availability of sensitive data.", "Impact and Scope": "CVE-2021-3618 has a CVSS score of 7.4 (AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N) and affects multiple protocols such as HTTP, FTP, and HTTPS. The attack vector is NETWORK, and the attack complexity is HIGH.", "Related MITRE ATT&CK Techniques": "The ALPACA attack utilizes techniques T1214, T1190, T1505, and T1102, which are all relevant to the CVE-2021-3618 vulnerability.", "Technical Details": "The ALPACA attack involves a MiTM attacker accessing the victim's traffic at the TCP/IP layer and redirecting traffic from one subdomain to another, creating a valid TLS session. This allows the attacker to compromise the authentication of TLS and enable cross-protocol attacks.", "Detection": "Monitoring for suspicious traffic patterns, such as redirects from one subdomain to another, can help detect this attack.", "Mitigation": "Mitigating this vulnerability requires configuring TLS servers to use unique certificates for each protocol, limiting the use of multi-domain or wildcard certificates, and implementing robust monitoring and detection mechanisms.", "Conclusion": "The ALPACA attack is a sophisticated technique that exploits the ALPACA attack vulnerability, CVE-2021-3618. It is essential to implement robust mitigation strategies and maintain up-to-date threat intelligence to prevent successful exploitation of this vulnerability."}, "executive_analysis": {"Overview": "The ALPACA attack is a significant threat to the confidentiality, integrity, and availability of sensitive data. It targets TLS servers implementing different protocols but using compatible certificates.", "Business Impact": "This vulnerability can result in data breaches, loss of data integrity, and unauthorized access to sensitive data, leading to significant financial and reputational losses.", "Technical Impact": "The ALPACA attack compromises the authentication of TLS, enabling cross-protocol attacks, which can result in unintended consequences and potential harm to stakeholders.", "Mitigation Strategies": "Implementing robust mitigation strategies, such as configuring unique certificates for each protocol, limiting the use of multi-domain or wildcard certificates, and maintaining up-to-date threat intelligence, is essential to preventing successful exploitation of this vulnerability.", "Recommendations": "Executives should prioritize this vulnerability and develop a comprehensive mitigation strategy to ensure the confidentiality, integrity, and availability of sensitive data.", "Conclusions": "The ALPACA attack is a high-risk vulnerability that requires immediate attention and mitigation. Executives and IT teams must work together to develop and implement effective strategies to prevent successful exploitation."}}