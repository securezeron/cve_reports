{"id": "CVE-2021-3618", "sourceIdentifier": "secalert@redhat.com", "published": "2022-03-23T20:15:09.833", "lastModified": "2023-02-09T02:03:34.457", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "ALPACA is an application layer protocol content confusion attack, exploiting TLS servers implementing different protocols but using compatible certificates, such as multi-domain or wildcard certificates. A MiTM attacker having access to victim's traffic at the TCP/IP layer can redirect traffic from one subdomain to another, resulting in a valid TLS session. This breaks the authentication of TLS and cross-protocol attacks may be possible where the behavior of one protocol service may compromise the other at the application layer."}, {"lang": "es", "value": "ALPACA es un ataque de confusi\u00f3n de contenido de protocolo de capa de aplicaci\u00f3n, que explota servidores TLS que implementan diferentes protocolos pero que usan certificados compatibles, como certificados multidominio o comod\u00edn. Un atacante de tipo MiTM que tenga acceso al tr\u00e1fico de la v\u00edctima en la capa TCP/IP puede redirigir el tr\u00e1fico de un subdominio a otro, resultando en a una sesi\u00f3n TLS v\u00e1lida. Esto rompe la autenticaci\u00f3n de TLS y pueden ser posibles los ataques entre protocolos donde el comportamiento de un servicio de protocolo puede comprometer al otro en la capa de aplicaci\u00f3n"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-295"}]}, {"source": "nvd@nist.gov", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-295"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:f5:nginx:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.21.0", "matchCriteriaId": "777D8DB3-65CF-4A12-BCCE-30849CE07762"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sendmail:sendmail:*:*:*:*:*:*:*:*", "versionEndExcluding": "8.17", "matchCriteriaId": "2E5DF525-823F-49D0-BDD2-6BCE5EE0F66B"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:vsftpd_project:vsftpd:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.0.4", "matchCriteriaId": "CA84E5A7-7557-4805-902B-E8069F5F4091"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*", "matchCriteriaId": "E460AA51-FCDA-46B9-AE97-E6676AA5E194"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*", "matchCriteriaId": "A930E247-0B43-43CB-98FF-6CE7B8189835"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*", "matchCriteriaId": "80E516C0-98A4-4ADE-B69F-66A772E2BAAA"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}], "references": [{"url": "https://alpaca-attack.com/", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1975623", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2022/11/msg00031.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1210: Exploitation of Remote Services", "comment": "CVE-2021-3618 - This is a man-in-the-middle (MiTM) attack technique that exploits TLS servers implementing different protocols but using compatible certificates. This technique can be used for exploitation."}, {"techniqueID": "T1199: Exfiltration Over Command and Control Channel", "comment": "CVE-2021-3618 - This technique can be used for data exfiltration by exploiting the TLS protocol confusion attack."}, {"techniqueID": "T1078: Account Hijack", "comment": "CVE-2021-3618 - This technique can be used to hijack valid TLS sessions, allowing attackers to gain unauthorized access to sensitive data."}, {"techniqueID": "T1567: Malicious Configuration", "comment": "CVE-2021-3618 - This technique can be used by attackers to compromise the configuration of TLS servers, allowing them to perform other attacks."}, {"techniqueID": "T1086: Duplication of System Files", "comment": "CVE-2021-3618 - This technique can be used by attackers to duplicate system files, potentially allowing them to perform other attacks."}], "stix_bundle": {"type": "bundle", "id": "CVE-2021-3618-bundle", "title": "CVE-2021-3618 STIX Bundle", "objects": [{"type": "incident", "id": "incident-1", "created_by_ref": "actor-1", "name": "CVE-2021-3618 Incident", "description": "This incident represents a potential attack using the CVE-2021-3618 vulnerability."}, {"type": "indicator", "id": "indicator-1", "name": "CVE-2021-3618 Indicator", "description": "This indicator represents a potential exploit of the CVE-2021-3618 vulnerability.", "pattern": "pattern-1"}, {"type": "ttp", "id": "ttp-1", "name": "CVE-2021-3618 TTP", "description": "This TTP represents the attack techniques used to exploit the CVE-2021-3618 vulnerability."}, {"type": "campaign", "id": "campaign-1", "name": "CVE-2021-3618 Campaign", "description": "This campaign represents a series of attacks using the CVE-2021-3618 vulnerability."}, {"type": "course-of-action", "id": "course-of-action-1", "name": "CVE-2021-3618 Course of Action", "description": "This course of action represents a potential mitigation strategy for the CVE-2021-3618 vulnerability.", "related_ttp_ref": "ttp-1", "defensive_techniques": [{"technique_id": "T1210: Exploitation of Remote Services"}]}], "relationships": [{"type": "incident", "id": "incident-1", "related_object_refs": ["ttp-1", "indicator-1"]}, {"type": "indicator", "id": "indicator-1", "related_object_refs": ["incident-1", "ttp-1"]}, {"type": "ttp", "id": "ttp-1", "related_object_refs": ["incident-1", "indicator-1", "course-of-action-1"]}, {"type": "campaign", "id": "campaign-1", "related_object_refs": ["incident-1", "ttp-1"]}]}, "technical_analysis": {"Introduction": "The CVE-2021-3618 vulnerability is a man-in-the-middle (MiTM) attack technique that exploits TLS servers implementing different protocols but using compatible certificates.", "Impact and Scope": "The vulnerability has a CVSS score of 7.4 with a medium attack complexity and a high confidentiality impact.", "Related MITRE ATT&CK Techniques": "T1210: Exploitation of Remote Services, T1199: Exfiltration Over Command and Control Channel, T1078: Account Hijack, T1567: Malicious Configuration, T1086: Duplication of System Files", "Technical Details": "The vulnerability exploits the TLS protocol confusion attack by redirecting traffic from one subdomain to another, resulting in a valid TLS session.", "Detection": "Detection can be done by monitoring network traffic and looking for suspicious patterns of TLS session re-direction.", "Mitigation": "Mitigation strategies include disabling TLS protocol confusion attack, disabling TLS version fallback, and configuring traffic filtering to block suspicious traffic.", "Conclusion": "The CVE-2021-3618 vulnerability is a serious threat that requires immediate attention and mitigation to prevent attacks."}, "executive_analysis": {"Overview": "The CVE-2021-3618 vulnerability is a man-in-the-middle attack technique that exploits TLS servers implementing different protocols but using compatible certificates.", "Business Impact": "The vulnerability has the potential to compromise sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability has a significant technical impact, potentially allowing attackers to perform other attacks.", "Mitigation Strategies": "Disabling TLS protocol confusion attack, disabling TLS version fallback, and configuring traffic filtering to block suspicious traffic.", "Recommendations": "Recommendations include implementing regular security updates, configuring traffic filtering, and monitoring network traffic for suspicious patterns.", "Conclusions": "The CVE-2021-3618 vulnerability is a serious threat that requires immediate attention and mitigation to prevent attacks."}}