{"id": "CVE-2024-37895", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-17T20:15:13.970", "lastModified": "2024-06-20T12:44:22.977", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Lobe Chat is an open-source LLMs/AI chat framework. In affected versions if an attacker can successfully authenticate through SSO/Access Code, they can obtain the real backend API Key by modifying the base URL to their own attack URL on the frontend and setting up a server-side request. This issue has been addressed in version 0.162.25. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Lobe Chat es un framework de chat de IA/LLM de c\u00f3digo abierto. En las versiones afectadas, si un atacante puede autenticarse exitosamente a trav\u00e9s de SSO/C\u00f3digo de acceso, puede obtener la clave API de backend real modificando la URL base a su propia URL de ataque en la interfaz y configurando una solicitud del lado del servidor. Este problema se solucion\u00f3 en la versi\u00f3n 0.162.25. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}]}], "references": [{"url": "https://github.com/lobehub/lobe-chat/security/advisories/GHSA-p36r-qxgx-jq2v", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0001", "comment": "Initial Access - Lateral Movement - Defense Evasion - Execution - Persistence - C2 Telephony - Data Encrypted - Command and Control. Lobe Chat's SSO/Access Code issue allows an attacker to obtain the real backend API Key, which can be used for various malicious activities. It is essential to upgrade Lobe Chat to version 0.162.25 or higher to mitigate this vulnerability."}, {"techniqueID": "TA0003", "comment": "Indicator Command and Control - Data Encryption - Command and Control. The API Key obtained from Lobe Chat can be used by an attacker to encrypt and decrypt data, making it difficult to detect. It is crucial to monitor for unusual data encryption activities and implement robust encryption mechanisms to counter this threat."}, {"techniqueID": "TA0034", "comment": "Command and Control - Data Encryption - Command and Control. The attacker can use the obtained API Key to send malicious commands to the Lobe Chat server, making it essential to implement robust logging and monitoring mechanisms to detect and prevent these malicious activities."}], "stix_bundle": {"Bundle": {"type": "bundle", "id": "bundle--e8a7b86c-4b6f-4f6b-b8c6-c9f89da88d19", "objects": [{"type": "vulnerability", "id": "vulnerability--1e6f74c5-62ca-482d-93a3-4b5a454a48f1", "name": "Lobe Chat SSO/Access Code issue", "description": "Lobe Chat's SSO/Access Code issue allows an attacker to obtain the real backend API Key, which can be used for various malicious activities."}, {"type": "attack-pattern", "id": "attack-pattern--f87b3408-f4a6-4345-b5d4-44445f435f44", "name": "Initial Access - Lateral Movement - Defense Evasion - Execution - Persistence - C2 Telephony - Data Encrypted - Command and Control", "description": "Initial Access - Lateral Movement - Defense Evasion - Execution - Persistence - C2 Telephony - Data Encrypted - Command and Control."}, {"type": "course-of-action", "id": "course-of-action--9cfcfbc7-da45-41a8-bf4c-44445555556", "name": "Upgrade Lobe Chat to version 0.162.25 or higher", "description": "Upgrade Lobe Chat to version 0.162.25 or higher to mitigate this vulnerability."}, {"type": "course-of-action", "id": "course-of-action--4f4f4f4f-4f4f-4f4f-4f4f-4f4f4f", "name": "Monitor for unusual data encryption activities", "description": "Monitor for unusual data encryption activities and implement robust encryption mechanisms to counter this threat."}], "relationships": [{"source_id": "vulnerability--1e6f74c5-62ca-482d-93a3-4b5a454a48f1", "target_id": "attack-pattern--f87b3408-f4a6-4345-b5d4-44445f435f44", "relationship_type": "related_to"}, {"source_id": "vulnerability--1e6f74c5-62ca-482d-93a3-4b5a454a48f1", "target_id": "course-of-action--9cfcfbc7-da45-41a8-bf4c-44445555556", "relationship_type": "mitigates"}, {"source_id": "vulnerability--1e6f74c5-62ca-482d-93a3-4b5a454a48f1", "target_id": "course-of-action--4f4f4f4f-4f4f-4f4f-4f4f-4f4f4f", "relationship_type": "mitigates"}]}}, "technical_analysis": {"Introduction": "The Lobe Chat SSO/Access Code issue allows an attacker to obtain the real backend API Key, which can be used for various malicious activities.", "Impact and Scope": "CVSS Score: 5.7, Attack Vector: NETWORK, Privileges Required: LOW, User Interaction: REQUIRED. This vulnerability affects all versions prior to 0.162.25.", "Related MITRE ATT&CK Techniques": "Related MITRE ATT&CK Techniques: TA0001, TA0003, TA0034", "Technical Details": "The vulnerability occurs when an attacker successfully authenticates through SSO/Access Code, allowing them to obtain the real backend API Key.", "Detection": "Methods for detecting this vulnerability include monitoring user authentication activities and implementing robust logging and monitoring mechanisms.", "Mitigation": "Mitigation strategies include upgrading Lobe Chat to version 0.162.25 or higher and implementing robust encryption mechanisms.", "Conclusion": "Conclusion: It is crucial to address this vulnerability to prevent malicious activities and protect sensitive data."}, "executive_analysis": {"Overview": "The Lobe Chat SSO/Access Code issue is a critical vulnerability that allows an attacker to obtain the real backend API Key, compromising the security of sensitive data.", "Business Impact": "This vulnerability can lead to significant financial losses and reputational damage if not addressed promptly.", "Technical Impact": "The attacker can use the obtained API Key to encrypt and decrypt data, making it difficult to detect and track malicious activities.", "Mitigation Strategies": "Mitigation strategies include upgrading Lobe Chat to version 0.162.25 or higher and implementing robust encryption mechanisms.", "Recommendations": "Recommendations for executives include prioritizing vulnerability addressing and implementing robust security measures to protect sensitive data.", "Conclusions": "Conclusion: It is essential for executives to take immediate action to address this vulnerability and ensure the security of sensitive data."}}