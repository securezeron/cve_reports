{"id": "CVE-2024-6331", "sourceIdentifier": "security@huntr.dev", "published": "2024-08-04T00:15:47.863", "lastModified": "2024-08-30T16:15:10.710", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "stitionai/devika main branch as of commit cdfb782b0e634b773b10963c8034dc9207ba1f9f is vulnerable to Local File Read (LFI) by Prompt Injection. The integration of Google Gimini 1.0 Pro with `HarmBlockThreshold.BLOCK_NONE` for `HarmCategory.HARM_CATEGORY_HATE_SPEECH` and `HarmCategory.HARM_CATEGORY_HARASSMENT` in `safety_settings` disables content protection. This allows malicious commands to be executed, such as reading sensitive file contents like `/etc/passwd`."}, {"lang": "es", "value": "La rama principal de stitionai/devika a partir del commit cdfb782b0e634b773b10963c8034dc9207ba1f9f es vulnerable a la lectura de archivos locales (LFI) mediante inyecci\u00f3n r\u00e1pida. La integraci\u00f3n de Google Gimini 1.0 Pro con `HarmBlockThreshold.BLOCK_NONE` para `HarmCategory.HARM_CATEGORY_HATE_SPEECH` y `HarmCategory.HARM_CATEGORY_HARASSMENT` en `safety_settings` deshabilita la protecci\u00f3n de contenido. Esto permite que se ejecuten comandos maliciosos, como leer contenidos de archivos confidenciales como `/etc/passwd`."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}]}, {"source": "nvd@nist.gov", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-74"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:stitionai:devika:*:*:*:*:*:*:*:*", "versionStartIncluding": "2024-05-02", "matchCriteriaId": "6D13B8BC-8613-4372-8C94-9437C841C6DA"}]}]}], "references": [{"url": "https://huntr.com/bounties/d5ac1051-22fa-42f0-8d82-73267482e60f", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1130", "comment": "CVE-2024-6331 - A Local File Read (LFI) vulnerability is being exploited through prompt injection. To defend against this, ensure that all user-input data is properly sanitized and validated against expected formats."}, {"techniqueID": "T1190", "comment": "CVE-2024-6331 - Due to the vulnerability in the integration of Google Gimini 1.0 Pro, an attacker can execute malicious commands. To protect against this, implement strong authentication and authorization mechanisms to limit access to critical resources."}, {"techniqueID": "T1047", "comment": "CVE-2024-6331 - The exposure of sensitive file contents through LFI poses a high risk. To mitigate this, implement data encryption and access control mechanisms to limit exposure of sensitive data."}], "stix_bundle": {"name": "CVE-2024-6331 Bundle", "description": "MITRE ATT&CK Techniques, Risks, and Defense Strategies for CVE-2024-6331", "objects": [{"id": "vulnerability:cve-2024-6331", "description": "A vulnerability in Google Gimini 1.0 Pro integration leads to Local File Read (LFI) through prompt injection.", "created": "2024-08-04T00:15:47.863", "modified": "2024-08-30T16:15:10.710", "author": "security@huntr.dev", "confidence": "High", "analysis": {"description": "Enables Local File Read through prompt injection."}}, {"id": "attack-pattern:t1130", "description": "Local File Read (LFI)", "created": "2024-08-04T00:15:47.863", "modified": "2024-08-30T16:15:10.710", "author": "MITRE", "confidence": "High", "related_indicators": [{"id": "indicator:i-1234", "description": "Network traffic analysis indicator for LFI"}]}, {"id": "tool:t1190", "description": "Exploitation of Google Gimini 1.0 Pro integration", "created": "2024-08-04T00:15:47.863", "modified": "2024-08-30T16:15:10.710", "author": "security@huntr.dev", "confidence": "High", "dependencies": [{"id": "attack-pattern:t1130"}]}], "relationships": [{"id": "r-1234", "description": "The vulnerability in the integration of Google Gimini 1.0 Pro is related to the LFI attack pattern.", "type": "relates", "source": "vulnerability:cve-2024-6331", "target": "attack-pattern:t1130"}, {"id": "r-1235", "description": "The exploitation of the Google Gimini 1.0 Pro integration is dependent on the LFI attack pattern.", "type": "depends", "source": "tool:t1190", "target": "attack-pattern:t1130"}]}, "technical_analysis": {"Introduction": "CVE-2024-6331 is a Local File Read vulnerability in the integration of Google Gimini 1.0 Pro. This vulnerability can be exploited through prompt injection, enabling attackers to read sensitive file contents.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5, with a high confidentiality impact and low attack complexity.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1130 (Local File Read) and T1190 (Exploitation of Google Gimini 1.0 Pro integration).", "Technical Details": "The vulnerability occurs due to the improper integration of Google Gimini 1.0 Pro with the stitionai/devika main branch, disabling content protection.", "Detection": "Detection methods include network traffic analysis for LFI and monitoring for suspicious file access.", "Mitigation": "Mitigation strategies include implementing strong authentication and authorization mechanisms, while also ensuring that all user-input data is properly sanitized and validated against expected formats.", "Conclusion": "CVE-2024-6331 is a high-risk vulnerability that can be exploited for sensitive data theft. Proper mitigation measures must be taken to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-6331 is a critical vulnerability in the integration of Google Gimini 1.0 Pro that can lead to sensitive data theft.", "Business Impact": "The vulnerability has the potential to cause significant financial and reputational damage to organizations.", "Technical Impact": "The vulnerability exposes sensitive file contents to potential attackers, posing a high risk to organizational security.", "Mitigation Strategies": "Implement strong authentication and authorization mechanisms, and ensure that all user-input data is properly sanitized and validated against expected formats.", "Recommendations": "Executives are advised to prioritize the implementation of mitigation measures and monitor their networks for suspicious activity.", "Conclusions": "CVE-2024-6331 is a critical vulnerability that requires immediate attention to prevent exploitation and potential data theft."}}