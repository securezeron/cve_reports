{"id": "CVE-2024-24760", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-02T16:15:56.163", "lastModified": "2024-02-10T04:04:55.743", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "mailcow is a dockerized email package, with multiple containers linked in one bridged network. A security vulnerability has been identified in mailcow affecting versions < 2024-01c. This vulnerability potentially allows attackers on the same subnet to connect to exposed ports of a Docker container, even when the port is bound to 127.0.0.1. The vulnerability has been addressed by implementing additional iptables/nftables rules. These rules drop packets for Docker containers on ports 3306, 6379, 8983, and 12345, where the input interface is not `br-mailcow` and the output interface is `br-mailcow`."}, {"lang": "es", "value": "mailcow es un paquete de correo electr\u00f3nico acoplado, con m\u00faltiples contenedores vinculados en una red puente. Se ha identificado una vulnerabilidad de seguridad en mailcow que afecta a las versiones &lt;2024-01c. Esta vulnerabilidad potencialmente permite a atacantes en la misma subred conectarse a puertos expuestos de un contenedor Docker, incluso cuando el puerto est\u00e1 vinculado a 127.0.0.1. La vulnerabilidad se ha solucionado mediante la implementaci\u00f3n de reglas adicionales de iptables/nftables. Estas reglas descartan paquetes para contenedores Docker en los puertos 3306, 6379, 8983 y 12345, donde la interfaz de entrada no es \"br-mailcow\" y la interfaz de salida es \"br-mailcow\"."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.1, "impactScore": 5.2}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-610"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mailcow:mailcow\\:_dockerized:*:*:*:*:*:*:*:*", "versionEndExcluding": "2024-01c", "matchCriteriaId": "21F5C59B-FCA1-47DA-8D0F-1CB708EF9EEF"}]}]}], "references": [{"url": "https://github.com/mailcow/mailcow-dockerized/commit/087481ac12bfa5dd715f3630f0b1697be94f7e88", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/mailcow/mailcow-dockerized/security/advisories/GHSA-gmpj-5xcm-xxx6", "source": "security-advisories@github.com", "tags": ["Mitigation", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-24760 - Mailcow Dockerized Mail Server: This technique is relevant because the attacker may use a malicious container to connect to ports exposed by the mailcow Dockerized Mail Server. A patch to fix this vulnerability has been released, but it is still important to implement additional iptables/nftables rules to mitigate the attack. This technique can be used to detect and prevent malicious activity on the mailcow container."}, {"techniqueID": "T1027.002", "comment": "CVE-2024-24760 - Mailcow Dockerized Mail Server: This technique is relevant because the attacker may use a malicious container to connect to ports exposed by the mailcow Dockerized Mail Server. A patch to fix this vulnerability has been released, but it is still important to implement additional iptables/nftables rules to mitigate the attack."}, {"techniqueID": "T1204", "comment": "CVE-2024-24760 - Mailcow Dockerized Mail Server: This technique is relevant because the attacker may use a legitimate container to connect to ports exposed by the mailcow Dockerized Mail Server. A patch to fix this vulnerability has been released, but it is still important to implement additional iptables/nftables rules to mitigate the attack."}], "stix_bundle": "}", "technical_analysis": {"Introduction": "The vulnerability CVE-2024-24760 affects the mailcow Dockerized Mail Server and allows attackers to connect to exposed ports, even when the port is bound to 127.0.0.1. This is due to the exposure of Docker containers to the same subnet.", "Impact and Scope": "The vulnerability has a CVSS score of 7.3 and 8.8 with version 3.1, with an attack vector of ADJACENT_NETWORK and NETWORK respectively. The impact is HIGH for both confidentiality and integrity, and HIGH for availability.", "Related MITRE ATT&CK Techniques": "T1027.002, T1027, T1204", "Technical Details": "The vulnerability occurs when the Docker containers are exposed to the same subnet. Exploitation can occur by connecting to the exposed ports on the Docker containers. The vulnerability has been addressed by implementing additional iptables/nftables rules to drop packets for Docker containers on ports 3306, 6379, 8983, and 12345, where the input interface is not `br-mailcow` and the output interface is `br-mailcow`.", "Detection": "To detect this vulnerability, it is necessary to inspect the network traffic and identify the exposed ports and Docker containers.", "Mitigation": "To mitigate this vulnerability, it is necessary to implement additional iptables/nftables rules to drop packets for Docker containers on ports 3306, 6379, 8983, and 12345, where the input interface is not `br-mailcow` and the output interface is `br-mailcow`. Moreover, it's important to patch the vulnerability as it has a patch available.", "Conclusion": "In conclusion, the vulnerability CVE-2024-24760 affects the mailcow Dockerized Mail Server and allows attackers to connect to exposed ports, even when the port is bound to 127.0.0.1. It's important to detect and mitigate this vulnerability by implementing additional iptables/nftables rules and patching the vulnerability."}, "executive_analysis": {"Overview": "The vulnerability CVE-2024-24760 affects the mailcow Dockerized Mail Server and may allow attackers to connect to exposed ports, even when the port is bound to 127.0.0.1.", "Business Impact": "This vulnerability may result in data being stolen or modified by attackers, which could have significant business impacts.", "Technical Impact": "The vulnerability may allow attackers to connect to exposed ports, even when the port is bound to 127.0.0.1, which could result in data being stolen or modified.", "Mitigation Strategies": "Implementing additional iptables/nftables rules and patching the vulnerability are effective mitigation strategies.", "Recommendations": "Recommendations for executives include keeping systems and software up-to-date, implementing additional iptables/nftables rules, and conducting regular security audits and penetration testing.", "Conclusions": "In conclusion, the vulnerability CVE-2024-24760 affects the mailcow Dockerized Mail Server and may allow attackers to connect to exposed ports, even when the port is bound to 127.0.0.1. It's important to detect and mitigate this vulnerability by implementing additional iptables/nftables rules and patching the vulnerability."}}