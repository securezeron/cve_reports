{"id": "CVE-2020-27542", "sourceIdentifier": "cve@mitre.org", "published": "2021-01-26T18:15:46.240", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Rostelecom CS-C2SHW 5.0.082.1 is affected by: Bash command injection. The camera reads configuration from QR code (including network settings). The static IP configuration from QR code is copied to the file /config/ip-static and after reboot data from this file is inserted into bash command (without any escaping). So bash injection is possible. Camera doesn't parse QR codes if it's already successfully configured. Camera is always rebooted after successful configuration via QR code."}, {"lang": "es", "value": "Rostelecom CS-C2SHW versi\u00f3n 5.0.082.1, est\u00e1 afectado por: una Inyecci\u00f3n de comando Bash.&#xa0;La c\u00e1mara lee la configuraci\u00f3n del c\u00f3digo QR (incluyendo la configuraci\u00f3n de red).&#xa0;La configuraci\u00f3n de la IP est\u00e1tica del c\u00f3digo QR se copia al archivo /config/ip-static y despu\u00e9s de reiniciar los datos de este archivo es insertado en el comando bash (sin ning\u00fan escape).&#xa0;Entonces la inyecci\u00f3n bash es posible.&#xa0;La c\u00e1mara no analiza los c\u00f3digos QR si ya est\u00e1 configurada con \u00e9xito.&#xa0;La c\u00e1mara siempre se reinicia despu\u00e9s de una configuraci\u00f3n con \u00e9xito por medio del c\u00f3digo QR"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "PHYSICAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.6}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.9, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:company:cs-c2shw_firmware:5.0.082.1:*:*:*:*:*:*:*", "matchCriteriaId": "DA2108A4-A3BF-4ECE-99E7-9EE9233063EB"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:company:cs-c2shw:-:*:*:*:*:*:*:*", "matchCriteriaId": "C1CC4768-6258-44B3-9290-AF21DDB6E728"}]}]}], "references": [{"url": "https://dil4rd.medium.com/groundhog-day-in-iot-valley-or-5-cves-in-1-camera-7dc1d2864707", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1210: Exploit Public-Facing Application", "comment": "CVE-2020-27542 - The vulnerability in the camera's QR code configuration allows an attacker to inject Bash commands, which is a classic example of an exploit public-facing application. Defenders should focus on monitoring network traffic and logs for unusual activity related to Bash commands."}, {"techniqueID": "T1190: Exploit Other Vulnerabilities", "comment": "CVE-2020-27542 - The vulnerability allows an attacker to inject Bash commands, which can be used to exploit other vulnerabilities in the system. Defenders should prioritize patching other vulnerabilities in the system to prevent exploitation."}, {"techniqueID": "T1093: Command and Control - Additional Tool", "comment": "CVE-2020-27542 - The injected Bash commands can be used to establish a command and control channel with the attacker's system, allowing for further exploitation."}, {"techniqueID": "T1086: Read File", "comment": "CVE-2020-27542 - The injected Bash commands can be used to read sensitive files on the system, such as configuration files or sensitive data."}, {"techniqueID": "T1070: Date Query", "comment": "CVE-2020-27542 - The injected Bash commands can be used to query system dates and times, potentially revealing information about the system's configuration or usage."}], "stix_bundle": [{"id": "Bundle: Rostelecom CS-C2SHW 5.0.082.1", "type": "bundle", "created_by_ref": "Stix2: Analyst", "modified": "2021-07-21T11:39:23.747", "objects": {"vulnerability": {"id": "Vulnerability: Rostelecom CS-C2SHW 5.0.082.1", "type": "vulnerability", "description": "CWE-78", "cvss_score": 6.8, "cvss_vector": "CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attack_vector": "PHYSICAL", "references": {"reference": [{"url": "https://dil4rd.medium.com/groundhog-day-in-iot-valley-or-5-cves-in-1-camera-7dc1d2864707", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}]}}, "attack_pattern": {"id": "Attack Pattern: Bash Command Injection", "type": "attack-pattern", "name": "Bash Command Injection", "description": "A technique used to inject malicious Bash commands into a system.", "kill_chain_phases": {"kill_chain_phase": [{"id": "KillChainPhase: Initial Access", "type": "kill-chain-phase", "name": "Initial Access", "description": "The initial access phase involves the attacker gaining access to the system."}, {"id": "KillChainPhase: Command and Control", "type": "kill-chain-phase", "name": "Command and Control", "description": "The command and control phase involves the attacker using the infected system to issue commands and gather information."}]}}, "course_of_action": {"id": "Course of Action: Patch the Vulnerability", "type": "course-of-action", "name": "Patch the Vulnerability", "description": " Patching the vulnerability will prevent the Bash command injection and prevent further exploitation.", "related_techniques": {"related_technique": [{"id": "Technique: T1210 Exploit Public-Facing Application", "type": "technique", "name": "Exploit Public-Facing Application"}]}}}}], "technical_analysis": {"Introduction": "The Rostelecom CS-C2SHW 5.0.082.1 camera is affected by a Bash command injection vulnerability due to the failure to properly sanitize user input.", "Impact and Scope": "The vulnerability allows an attacker to inject Bash commands, which can be used to exploit other vulnerabilities in the system or steal sensitive information.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1210, T1190, T1093, T1086, and T1070.", "Technical Details": "The vulnerability occurs when the camera reads configuration from a QR code, which can contain malicious Bash commands.", "Detection": "Defense systems should monitor network traffic and logs for unusual activity related to Bash commands.", "Mitigation": "Patching the vulnerability will prevent Bash command injection and prevent further exploitation.", "Conclusion": "The Rostelecom CS-C2SHW 5.0.082.1 camera is vulnerable to Bash command injection, and defenders should prioritize patching the vulnerability to prevent further exploitation."}, "executive_analysis": {"Overview": "The Rostelecom CS-C2SHW 5.0.082.1 camera is vulnerable to Bash command injection, which can be used to exploit other vulnerabilities in the system or steal sensitive information.", "Business Impact": "The vulnerability can lead to data breaches, system compromise, and loss of sensitive information.", "Technical Impact": "The vulnerability allows an attacker to remotely inject Bash commands, which can be used to exploit other vulnerabilities in the system.", "Mitigation Strategies": "Patching the vulnerability will prevent Bash command injection and prevent further exploitation.", "Recommendations": "Executives should prioritize patching the vulnerability to prevent further exploitation.", "Conclusions": "The Rostelecom CS-C2SHW 5.0.082.1 camera is vulnerable to Bash command injection, and defenders should prioritize patching the vulnerability to prevent further exploitation."}}