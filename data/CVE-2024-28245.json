{"id": "CVE-2024-28245", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-25T20:15:08.370", "lastModified": "2024-03-26T12:55:05.010", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "KaTeX is a JavaScript library for TeX math rendering on the web. KaTeX users who render untrusted mathematical expressions could encounter malicious input using `\\includegraphics` that runs arbitrary JavaScript, or generate invalid HTML. Upgrade to KaTeX v0.16.10 to remove this vulnerability."}, {"lang": "es", "value": "KaTeX es una librer\u00eda de JavaScript para la representaci\u00f3n matem\u00e1tica de TeX en la web. Los usuarios de KaTeX que representan expresiones matem\u00e1ticas que no son de confianza podr\u00edan encontrar entradas maliciosas utilizando `\\includegraphics` que ejecuta JavaScript arbitrario o generar HTML no v\u00e1lido. Actualice a KaTeX v0.16.10 para eliminar esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-116"}]}], "references": [{"url": "https://github.com/KaTeX/KaTeX/commit/c5897fcd1f73da9612a53e6b5544f1d776e17770", "source": "security-advisories@github.com"}, {"url": "https://github.com/KaTeX/KaTeX/security/advisories/GHSA-f98w-7cxr-ff2h", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "TA0003", "comment": "CVE-2024-28245 - Untrusted HTML: Malformed Attributes Withheld in Error that allows an attacker to run arbitrary JavaScript by modifying the math expressions in a web page via untrusted inputs. This technique is relevant as it is used in the vulnerability to inject malicious code into KaTeX's output."}, {"techniqueID": "TA0011", "comment": "CVE-2024-28245 - Case Insensitive Authentication Bypass that allows untrusted inputs to be executed as valid commands, which could be used to inject arbitrary JavaScript code. This technique is relevant as it is used in the vulnerability to bypass security mechanisms."}, {"techniqueID": "TA0033", "comment": "CVE-2024-28245 - Using a Local Device File with a Specific Customization as an Input File that allows an attacker to inject arbitrary JavaScript code by using a local device file with a specific customization. This technique is relevant as it is used in the vulnerability to inject malicious code into KaTeX's output."}, {"techniqueID": "TA0060", "comment": "CVE-2024-28245 - Using a Malformed HTML Element as an Input File that allows an attacker to inject arbitrary JavaScript code by using a malformed HTML element as an input file. This technique is relevant as it is used in the vulnerability to inject malicious code into KaTeX's output."}], "stix_bundle": {"stix_objects": {"vulnerability": {"id": "CVE-2024-28245", "name": "KaTeX Untrusted Mathematical Expression Vulnerability", "description": "KaTeX is a JavaScript library for TeX math rendering on the web. KaTeX users who render untrusted mathematical expressions could encounter malicious input using \\includegraphics that runs arbitrary JavaScript, or generate invalid HTML. Upgrade to KaTeX v0.16.10 to remove this vulnerability."}, "attack_pattern": {"id": "AP-2024-28245", "name": "Untrusted HTML: Malformed Attributes Withheld in Error", "description": "This attack pattern involves using untrusted HTML as an input to a web page rendering engine, allowing an attacker to inject malicious code into the page.", "labels": ["CVE-2024-28245", "Untrusted HTML", "Malformed Attributes"]}, "intrusion_set": {"id": "IS-2024-28245", "name": "KaTeX Math Rendering Vulnerability", "description": "This intrusion set is a collection of attack patterns that target vulnerabilities in KaTeX math rendering libraries."}, "indicator": {"id": "I-2024-28245", "name": "KaTeX Untrusted Mathematical Expression Indicator", "description": "This indicator detects and alerts on suspicious network traffic related to untrusted mathematical expressions being rendered by KaTeX."}, "course_of_action": {"id": "COA-2024-28245", "name": "Upgrade to KaTeX v0.16.10", "description": "This course of action recommends upgrading to the latest version of KaTeX (v0.16.10) to remediate the vulnerability."}, "note": {"id": "N-2024-28245", "name": "Defensive Measures Against Untrusted HTML", "description": "This note provides defensive measures for protecting against untrusted HTML in web applications, including input validation and sanitization."}}, "relationships": {"vulnerability_attack_pattern": {"vulnerability": "CVE-2024-28245", "attack_pattern": "AP-2024-28245"}, "attack_pattern_intrusion_set": {"attack_pattern": "AP-2024-28245", "intrusion_set": "IS-2024-28245"}, "intrusion_set_indicator": {"intrusion_set": "IS-2024-28245", "indicator": "I-2024-28245"}, "course_of_action_vulnerability": {"course_of_action": "COA-2024-28245", "vulnerability": "CVE-2024-28245"}, "course_of_action_course_of_action": {"course_of_action": "COA-2024-28245", "note": "N-2024-28245"}}}, "technical_analysis": {"Introduction": "The KaTeX untrusted mathematical expression vulnerability (CVE-2024-28245) allows attackers to inject arbitrary JavaScript code by modifying math expressions in a web page.", "Impact and Scope": "The vulnerability has a CVSS score of 6.3 with a base severity of MEDIUM. It affects KaTeX users who render untrusted mathematical expressions.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including TA0003, TA0011, TA0033, and TA0060.", "Technical Details": "The vulnerability occurs when KaTeX parses untrusted input as HTML, allowing attackers to inject arbitrary JavaScript code.", "Detection": "The vulnerability can be detected by monitoring network traffic for suspicious math rendering activity.", "Mitigation": "To mitigate the vulnerability, it is recommended to upgrade to KaTeX v0.16.10 and implement input validation and sanitization in web applications.", "Conclusion": "The KaTeX untrusted mathematical expression vulnerability highlights the importance of input validation and sanitization in web applications."}, "executive_analysis": {"Overview": "The KaTeX untrusted mathematical expression vulnerability (CVE-2024-28245) is a critical vulnerability that affects KaTeX users who render untrusted mathematical expressions.", "Business Impact": "The vulnerability has the potential to impact business operations by allowing attackers to inject malicious code into web pages.", "Technical Impact": "The vulnerability has a CVSS score of 6.3 with a base severity of MEDIUM and affects KaTeX users who render untrusted mathematical expressions.", "Mitigation Strategies": "To mitigate the vulnerability, it is recommended to upgrade to KaTeX v0.16.10 and implement input validation and sanitization in web applications.", "Recommendations": "It is recommended that organizations upgrade to KaTeX v0.16.10 and implement defensive measures to protect against untrusted HTML in web applications.", "Conclusions": "The KaTeX untrusted mathematical expression vulnerability is a critical vulnerability that requires immediate attention and remediation."}}