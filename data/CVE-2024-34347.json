{"id": "CVE-2024-34347", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-08T15:15:11.310", "lastModified": "2024-05-08T17:05:24.083", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "@hoppscotch/cli is a CLI to run Hoppscotch Test Scripts in CI environments. Prior to 0.8.0, the @hoppscotch/js-sandbox package provides a Javascript sandbox that uses the Node.js vm module. However, the vm module is not safe for sandboxing untrusted Javascript code. This is because code inside the vm context can break out if it can get a hold of any reference to an object created outside of the vm. In the case of @hoppscotch/js-sandbox, multiple references to external objects are passed into the vm context to allow pre-request scripts interactions with environment variables and more. But this also allows the pre-request script to escape the sandbox. This vulnerability is fixed in 0.8.0."}, {"lang": "es", "value": "@hoppscotch/cli es una CLI para ejecutar scripts de prueba de Hoppscotch en entornos de CI. Antes de 0.8.0, el paquete @hoppscotch/js-sandbox proporciona un entorno limitado de Javascript que utiliza el m\u00f3dulo vm de Node.js. Sin embargo, el m\u00f3dulo vm no es seguro para el c\u00f3digo Javascript que no es de confianza. Esto se debe a que el c\u00f3digo dentro del contexto de la m\u00e1quina virtual puede romperse si puede obtener cualquier referencia a un objeto creado fuera de la m\u00e1quina virtual. En el caso de @hoppscotch/js-sandbox, se pasan m\u00faltiples referencias a objetos externos al contexto de la m\u00e1quina virtual para permitir interacciones de scripts de solicitud previa con variables de entorno y m\u00e1s. Pero esto tambi\u00e9n permite que el script de solicitud previa escape del entorno limitado. Esta vulnerabilidad se solucion\u00f3 en 0.8.0."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.6, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-77"}]}], "references": [{"url": "https://github.com/hoppscotch/hoppscotch/commit/22c6eabd133195d22874250a5ae40cb26b851b01", "source": "security-advisories@github.com"}, {"url": "https://github.com/hoppscotch/hoppscotch/security/advisories/GHSA-qmmm-73r2-f8xr", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-34347 - This vulnerability allows an attacker to break out of the Node.js JavaScript sandbox by exploiting the use of the vm module, which can provide access to sensitive data and functionality. This is a relevant technique to detect, as it allows for exfiltration and further exploitation capabilities."}, {"techniqueID": "T1059", "comment": "CVE-2024-34347 - This technique is related to the use of the vm module in the Node.js JavaScript sandbox, which can be exploited to execute arbitrary code. This technique can be used to discover and exploit vulnerable systems."}], "stix_bundle": {"TYPE": "bundle", "id": "bundle--CVE-2024-34347", "description": "A bundle expressing the mitigation strategies and related techniques for CVE-2024-34347", "objects": [{"id": "indicator--CVE-2024-34347", "type": "indicator", "description": "Indicator for CVE-2024-34347", "created_by_ref": "organization--my-org", "modified": "2024-05-08T17:05:24.083", "created": "2024-05-08T15:15:11.310", "valid_from": "2024-05-08T00:00:00.000", "valid_until": "2030-05-08T00:00:00.000", "name": "CVE-2024-34347 Indicator", "sensor_data_refs": [{"id": "sensor_data--traffic", "relationship": "observed-data"}]}, {"id": "observable--traffic", "type": "traffic", "description": "Traffic data related to CVE-2024-34347", "created_by_ref": "organization--my-org", "modified": "2024-05-08T17:05:24.083", "created": "2024-05-08T15:15:11.310", "valid_from": "2024-05-08T00:00:00.000", "valid_until": "2030-05-08T00:00:00.000", "name": "CVE-2024-34347 Traffic Data"}, {"id": "course_of_action--deploy_patching", "type": "course-of-action", "description": "Deploy patch mitigation for CVE-2024-34347", "created_by_ref": "organization--my-org", "modified": "2024-05-08T17:05:24.083", "created": "2024-05-08T15:15:11.310", "valid_from": "2024-05-08T00:00:00.000", "valid_until": "2030-05-08T00:00:00.000", "name": "Deploy Patch Mitigation", "target_ref": "indicator--CVE-2024-34347", "relationship": "mitigates"}], "relationships": [{"id": "object--indicator--CVE-2024-34347", "type": "relation", "direction": "out", "ids": ["indicator--CVE-2024-34347"]}]}, "technical_analysis": {"Introduction": "CVE-2024-34347 is a vulnerability in the @hoppscotch/cli package that allows an attacker to break out of the Node.js JavaScript sandbox by exploiting the use of the vm module.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 8.3. The attack vector is NETWORK, and the attack complexity is HIGH. This vulnerability can be exploited by an attacker to gain unauthorized access to sensitive data and functionality.", "Technical Details": "The vulnerability is caused by the use of the vm module in the @hoppscotch/js-sandbox package, which allows an attacker to create a reference to an object created outside of the vm context. This can be exploited to escape the sandbox and gain access to sensitive data and functionality.", "Detection": "Detection of this vulnerability can be achieved by analyzing network traffic and system logs for signs of exploitation. This may include looking for unusual patterns of activity or suspicious network connections.", "Mitigation": "Mitigation strategies include deploying patches, disabling the vm module, and implementing additional security measures to prevent exploitation.", "Conclusion": "In conclusion, CVE-2024-34347 is a critical vulnerability that requires immediate attention and mitigation. Organizations should take steps to deploy patches and implement additional security measures to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-34347 is a critical vulnerability in the @hoppscotch/cli package that allows an attacker to break out of the Node.js JavaScript sandbox.", "Business Impact": "The business impact of this vulnerability is significant, as it can compromise sensitive data and functionality and potentially lead to financial losses.", "Technical Impact": "The technical impact of this vulnerability is high, with a CVSS score of 8.3. The attack vector is NETWORK, and the attack complexity is HIGH.", "Mitigation Strategies": "Mitigation strategies include deploying patches, disabling the vm module, and implementing additional security measures to prevent exploitation.", "Recommendations": "We recommend that executives take immediate action to mitigate this vulnerability and protect their organizations from potential attacks.", "Conclusions": "In conclusion, CVE-2024-34347 is a critical vulnerability that requires immediate attention and mitigation. We recommend that executives take swift action to protect their organizations."}}