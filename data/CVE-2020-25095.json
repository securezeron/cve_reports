{"id": "CVE-2020-25095", "sourceIdentifier": "cve@mitre.org", "published": "2020-12-17T03:15:13.180", "lastModified": "2020-12-21T14:31:42.137", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "LogRhythm Platform Manager (PM) 7.4.9 allows CSRF. The Web interface is vulnerable to Cross-site WebSocket Hijacking (CSWH). If a logged-in PM user visits a malicious site in the same browser session, that site can perform a CSRF attack to create a WebSocket from the victim client to the vulnerable PM server. Once the socket is created, the malicious site can interact with the vulnerable web server in the context of the logged-in user. This can include WebSocket payloads that result in command execution."}, {"lang": "es", "value": "LogRhythm Platform Manager (PM) versi\u00f3n 7.4.9, permite un ataque de tipo CSRF.&#xa0;La interfaz Web es vulnerable a un ataque de tipo Cross-site WebSocket Hijacking (CSWH).&#xa0;Si un usuario de PM que ha iniciado sesi\u00f3n visita un sitio malicioso en la misma sesi\u00f3n del navegador, ese sitio puede llevar a cabo un ataque de tipo CSRF para crear un WebSocket desde el cliente v\u00edctima al servidor de PM vulnerable.&#xa0;Una vez que es creado el socket, el sitio malicioso puede interactuar con el servidor web vulnerable en el contexto del usuario que inici\u00f3 sesi\u00f3n.&#xa0;Esto puede incluir cargas \u00fatiles de WebSocket que resultan en una ejecuci\u00f3n de comandos"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:logrhythm:platform_manager:7.4.9:*:*:*:*:*:*:*", "matchCriteriaId": "2768A358-81BC-4B38-ABE7-C9D44ECA716E"}]}]}], "references": [{"url": "https://cybercx.com.au/blog/2020/12/15/logrhythm-zero-days/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0010", "comment": "Cross-Site WebSocket Hijacking (CSWH) - CSRF-like attack targeting WebSocket connections. {CVE ID Being Analysed} is vulnerable to CSWH which could allow an attacker to steal sensitive data or trigger unwanted actions in the context of a logged-in user."}, {"techniqueID": "TA0036", "comment": "Cross-Site Request Forgery (CSRF) - An attacker can trick a user into performing unintended actions, such as creating a WebSocket connection. {CVE ID Being Analysed} is vulnerable to CSRF which could allow an attacker to create a WebSocket connection and interact with the server in the context of a logged-in user."}, {"techniqueID": "TA0037", "comment": "Command and Control (C2) - An attacker can use the created WebSocket connection to send and receive commands, allowing for remote code execution. {CVE ID Being Analysed} is vulnerable to C2 which could allow an attacker to execute malicious code on the server."}, {"techniqueID": "T1210", "comment": "Exploitation of Authentication Mechanism - The vulnerable Web interface fails to properly validate user authentication, allowing an attacker to exploit the system. {CVE ID Being Analysed} is vulnerable to authentication exploitation which could allow an attacker to gain unauthorized access to the system."}], "stix_bundle": {"bundle": {"cve": {"id": "CVE-2020-25095", "name": "LogRhythm Platform Manager (PM) 7.4.9 CSRF Vulnerability"}}, "observables": [{"id": "observable-1", "type": "indicator", "created_by_ref": "observer-1", "name": "WebSocket Hijacking Attempt", "description": "An attempt to create a WebSocket connection to a LogRhythm server", "parsed_text": ["WebSocket Hijacking Attempt"], "observable_content_type": " Indicator"}, {"id": "observable-2", "type": "indicator", "created_by_ref": "observer-1", "name": "CSRF Attack", "description": "An attempt to create a WebSocket connection to a LogRhythm server using a Cross-Site Request Forgery (CSRF) attack", "parsed_text": ["CSRF Attack"], "observable_content_type": " Indicator"}, {"id": "observable-3", "type": "indicator", "created_by_ref": "observer-1", "name": "C2 Command Execution", "description": "An attempt to execute a command on a LogRhythm server using a WebSocket connection", "parsed_text": ["C2 Command Execution"], "observable_content_type": " Indicator"}], "courses_of_action": [{"id": "course-of-action-1", "name": "Disable WebSocket Protocol", "description": "Disable the WebSocket protocol to prevent unauthorized WebSocket connections", "technique_id_refs": ["TA0010", "TA0036", "TA0037"]}, {"id": "course-of-action-2", "name": "Monitor WebSocket Connections", "description": "Monitor WebSocket connections for suspicious activity and terminate any unauthorized connections", "technique_id_refs": ["TA0010", "TA0036", "TA0037"]}, {"id": "course-of-action-3", "name": "Implement CSRF Prevention", "description": "Implement CSRF prevention measures such as verifying user authentication and validating user input", "technique_id_refs": ["TA0036"]}]}, "technical_analysis": {"Introduction": "This vulnerability allows attackers to exploit LogRhythm Platform Manager (PM) 7.4.9 using Cross-Site WebSocket Hijacking (CSWH) and Cross-Site Request Forgery (CSRF) attacks.", "Impact and Scope": "This vulnerability has a CVSS score of 8.8 and an attack vector of NETWORK. It allows attackers to perform command execution, stealing sensitive data, and interacting with the server in the context of a logged-in user.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to TA0010, TA0036, TA0037, and T1210.", "Technical Details": "The vulnerability is caused by a lack of proper validation of user authentication and input. This allows attackers to exploit the system using CSRF and CSWH attacks.", "Detection": "This vulnerability can be detected by monitoring WebSocket connections for suspicious activity and implementing CSRF prevention measures.", "Mitigation": "The vulnerability can be mitigated by disabling the WebSocket protocol, monitoring WebSocket connections, and implementing CSRF prevention measures.", "Conclusion": "The LogRhythm Platform Manager (PM) 7.4.9 CSRF vulnerability is a significant risk that can be exploited using CSWH and CSRF attacks. It is essential to implement appropriate mitigations to protect against this vulnerability."}, "executive_analysis": {"Overview": "The LogRhythm Platform Manager (PM) 7.4.9 CSRF vulnerability is a critical issue that requires immediate attention.", "Business Impact": "This vulnerability can result in data theft, unauthorized access, and operation disruption, which can significantly impact business operations and reputation.", "Technical Impact": "The vulnerability allows attackers to perform command execution, stealing sensitive data, and interacting with the server in the context of a logged-in user.", "Mitigation Strategies": "Disable the WebSocket protocol, monitor WebSocket connections, and implement CSRF prevention measures to mitigate this vulnerability.", "Recommendations": "Implement these mitigations as soon as possible and consider conducting a vulnerability assessment to identify any other potential vulnerabilities in the system.", "Conclusions": "Immediate attention is required to mitigate the LogRhythm Platform Manager (PM) 7.4.9 CSRF vulnerability. Implementing the recommended mitigations and conducting a vulnerability assessment will help protect against this vulnerability and ensure the security of the system."}}