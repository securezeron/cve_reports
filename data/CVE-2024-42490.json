{"id": "CVE-2024-42490", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-22T16:15:09.117", "lastModified": "2024-08-23T16:18:28.547", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "authentik is an open-source Identity Provider. Several API endpoints can be accessed by users without correct authentication/authorization. The main API endpoints affected by this are /api/v3/crypto/certificatekeypairs/<uuid>/view_certificate/, /api/v3/crypto/certificatekeypairs/<uuid>/view_private_key/, and /api/v3/.../used_by/. Note that all of the affected API endpoints require the knowledge of the ID of an object, which especially for certificates is not accessible to an unprivileged user. Additionally the IDs for most objects are UUIDv4, meaning they are not easily guessable/enumerable. authentik 2024.4.4, 2024.6.4 and 2024.8.0 fix this issue."}, {"lang": "es", "value": "authentik es un proveedor de identidades de c\u00f3digo abierto. Los usuarios pueden acceder a varios endpoints de API sin la autenticaci\u00f3n/autorizaci\u00f3n correcta. Los principales endpoints de API afectados por esto son /api/v3/crypto/certificatekeypairs//view_certificate/, /api/v3/crypto/certificatekeypairs//view_private_key/ y /api/v3/.../ used_by/. Tenga en cuenta que todos los endpoints de API afectados requieren el conocimiento del ID de un objeto, que, especialmente en el caso de los certificados, no es accesible para un usuario sin privilegios. Adem\u00e1s, los ID de la mayor\u00eda de los objetos son UUIDv4, lo que significa que no son f\u00e1ciles de adivinar ni enumerar. authentik 2024.4.4, 2024.6.4 y 2024.8.0 solucionan este problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 4.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-285"}]}], "references": [{"url": "https://github.com/goauthentik/authentik/commit/19318d4c00bb02c4ec3c4f8f15ac2e1dbe8d846c", "source": "security-advisories@github.com"}, {"url": "https://github.com/goauthentik/authentik/commit/359b343f51524342a5ca03828e7c975a1d654b11", "source": "security-advisories@github.com"}, {"url": "https://github.com/goauthentik/authentik/security/advisories/GHSA-qxqc-27pr-wgc8", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1110 - Brute Force", "comment": "CVE-2024-42490 - Attackers may use brute force to guess IDs of objects, especially certificates, to access sensitive information."}, {"techniqueID": "T1056 - Multi-Vector Command and Control", "comment": "CVE-2024-42490 - An attacker can use the compromised API endpoints to control the system and execute malicious commands."}, {"techniqueID": "T1130 - PW Stealing", "comment": "CVE-2024-42490 - Attackers may steal passwords and credentials by accessing the compromised API endpoints."}, {"techniqueID": "T1048 - Web Shell", "comment": "CVE-2024-42490 - An attacker can use the compromised API endpoints to deploy a web shell and execute malicious commands."}], "stix_bundle": "{\"bundle\": {\n  \"id\": \"b7df5ba4-3d49-4c9a-8eb9-b10fc21b5e16\",\n  \"type\": \"bundle\",\n  \"created_by_ref\": \"user:TestUser\",\n  \"created\": \"2024-08-25T10:00:00.000\",\n  \"modified\": \"2024-08-25T10:00:00.000\",\n  \"object_refs\": [\n    {\n      \"id\": \"https://example.com/stix/CVE-2024-42490\",\n      \"type\": \"course-of-action\",\n      \"created_by_ref\": \"user:TestUser\",\n      \"created\": \"2024-08-25T10:00:00.000\",\n      \"modified\": \"2024-08-25T10:00:00.000\",\n      \"name\": \"CVE-2024-42490 - Restrict API Endpoint Access\"\n    },\n    {\n      \"id\": \"https://example.com/stix/T1110\",\n      \"type\": \"technique\",\n      \"created_by_ref\": \"user:TestUser\",\n      \"created\": \"2024-08-25T10:00:00.000\",\n      \"modified\": \"2024-08-25T10:00:00.000\",\n      \"name\": \"Brute Force\"\n    }\n  ],\n  \"objects\": [\n    {\n      \"id\": \"https://example.com/stix/CVE-2024-42490\",\n      \"type\": \"vulnerability\",\n      \"created_by_ref\": \"user:TestUser\",\n      \"created\": \"2024-08-25T10:00:00.000\",\n      \"modified\": \"2024-08-25T10:00:00.000\",\n      \"name\": \"CVE-2024-42490\",\n      \"description\": \"authentik is an open-source Identity Provider. Several API endpoints can be accessed by users without correct authentication/authorization. The main API endpoints affected by this are /api/v3/crypto/certificatekeypairs/<uuid>/view_certificate/, /api/v3/crypto/certificatekeypairs/<uuid>/view_private_key/, and /api/v3/.../used_by/. Note that all of the affected API endpoints require the knowledge of the ID of an object, which especially for certificates is not accessible to an unprivileged user. Additionally the IDs for most objects are UUIDv4, meaning they are not easily guessable/enumerable. authentik 2024.4.4, 2024.6.4 and 2024.8.0 fix this issue.\",\n      \"cvssV3Vector\": \"CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:L/A:N\",\n      \"cvssV3Score\": 7.5,\n      \"refs\": [\n        {\n          \"id\": \"https://github.com/goauthentik/authentik/commit/19318d4c00bb02c4ec3c4f8f15ac2e1dbe8d846c\",\n          \"type\": \"reference\",\n          \"name\": \"CVE-2024-42490 Fix Commit\"\n        },\n        {\n          \"id\": \"https://github.com/goauthentik/authentik/commit/359b343f51524342a5ca03828e7c975a1d654b11\",\n          \"type\": \"reference\",\n          \"name\": \"CVE-2024-42490 Fix Commit\"\n        },\n        {\n          \"id\": \"https://github.com/goauthentik/authentik/security/advisories/GHSA-qxqc-27pr-wgc8\",\n          \"type\": \"reference\",\n          \"name\": \"CVE-2024-42490 Advisory\"\n        }\n      ],\n      \"related_indicators\": [\n        {\n          \"id\": \"https://example.com/stix/T1110\",\n          \"type\": \"technique\",\n          \"name\": \"Brute Force\"\n        }\n      ]\n    },\n    {\n      \"id\": \"https://example.com/stix/T1110\",\n      \"type\": \"technique\",\n      \"created_by_ref\": \"user:TestUser\",\n      \"created\": \"2024-08-25T10:00:00.000\",\n      \"modified\": \"2024-08-25T10:00:00.000\",\n      \"name\": \"Brute Force\"\n    }\n  ]\n}}", "technical_analysis": {"Introduction": "The CVE-2024-42490 vulnerability is a critical issue in authentik, an open-source Identity Provider. The vulnerability allows attackers to access sensitive information without proper authentication/authorization.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5, indicating high confidentiality, integrity, and availability impacts. The vulnerability affects several API endpoints in authentik, including /api/v3/crypto/certificatekeypairs/<uuid>/view_certificate/, /api/v3/crypto/certificatekeypairs/<uuid>/view_private_key/, and /api/v3/.../used_by/.", "Related MITRE ATT&CK Techniques": "T1110 - Brute Force, T1056 - Multi-Vector Command and Control, T1130 - PW Stealing, and T1048 - Web Shell.", "Technical Details": "The vulnerability is due to the lack of proper authentication/authorization checks in the affected API endpoints. Attackers can exploit this vulnerability by guessing the IDs of objects, especially certificates, to access sensitive information.", "Detection": "Detecting this vulnerability requires monitoring for brute force attacks and unauthorized access to the affected API endpoints.", "Mitigation": "Mitigating this vulnerability involves restricting access to the affected API endpoints and implementing proper authentication/authorization checks. Additionally, it is recommended to update authentik to the latest version, which includes the fix for this vulnerability.", "Conclusion": "In conclusion, CVE-2024-42490 is a critical vulnerability in authentik that requires immediate attention. It is essential to implement mitigation strategies to prevent unauthorized access and to detect and prevent brute force attacks."}, "executive_analysis": {"Overview": "The CVE-2024-42490 vulnerability is a serious issue that could compromise the security of authentik users. It is essential to take immediate action to mitigate this vulnerability.", "Business Impact": "The vulnerability could result in unauthorized access to sensitive information, potentially leading to financial losses and reputational damage.", "Technical Impact": "The vulnerability could allow attackers to access sensitive information, potentially leading to the compromise of user credentials and data.", "Mitigation Strategies": "Restricting access to the affected API endpoints and implementing proper authentication/authorization checks are essential mitigation strategies.", "Recommendations": "It is recommended to update authentik to the latest version, implement proper authentication/authorization checks, and conduct regular security testing and vulnerability assessments.", "Conclusions": "In conclusion, it is essential to take immediate action to mitigate the CVE-2024-42490 vulnerability to prevent unauthorized access and protect the security of authentik users."}}