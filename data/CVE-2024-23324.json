{"id": "CVE-2024-23324", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-09T23:15:09.223", "lastModified": "2024-02-15T04:46:33.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Envoy is a high-performance edge/middle/service proxy. External authentication can be bypassed by downstream connections. Downstream clients can force invalid gRPC requests to be sent to ext_authz, circumventing ext_authz checks when failure_mode_allow is set to true. This issue has been addressed in released 1.29.1, 1.28.1, 1.27.3, and 1.26.7. Users are advised to upgrade. There are no known workarounds for this vulnerability.\n"}, {"lang": "es", "value": "Envoy es un proxy de servicio/intermedio/perimetral de alto rendimiento. La autenticaci\u00f3n externa se puede omitir mediante conexiones descendentes. Los clientes intermedios pueden forzar el env\u00edo de solicitudes gRPC no v\u00e1lidas a ext_authz, eludiendo las comprobaciones de ext_authz cuando Failure_mode_allow se establece en verdadero. Este problema se solucion\u00f3 en las versiones 1.29.1, 1.28.1, 1.27.3 y 1.26.7. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 8.6, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 4.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.26.0", "versionEndExcluding": "1.26.7", "matchCriteriaId": "0324E095-98B4-4B78-9242-989EC45E011F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.27.0", "versionEndExcluding": "1.27.3", "matchCriteriaId": "2E838B16-C6DC-4701-B955-D96D4CAEF4F6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.28.0", "versionEndExcluding": "1.28.1", "matchCriteriaId": "770D5713-48E3-4F9B-B05C-9CB9C6B272E3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.29.0", "versionEndExcluding": "1.29.1", "matchCriteriaId": "638F3351-3ACD-47C8-9B8F-568A930FAECA"}]}]}], "references": [{"url": "https://github.com/envoyproxy/envoy/commit/29989f6cc8bfd8cd2ffcb7c42711eb02c7a5168a", "source": "security-advisories@github.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-gq3v-vvhj-96j6", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-23324 - Envoy HTTP/2 and gRPC proxy vulnerability can be exploited by sending gRPC requests with a downstream connection, bypassing external authentication checks. This technique can be used to gain unauthorized access."}, {"techniqueID": "T1204", "comment": "CVE-2024-23324 - This vulnerability enables the exploitation of a high-impact HTTP/2 and gRPC proxy weakness. By sending malformed gRPC requests, an attacker can bypass authentication checks, compromising confidentiality and integrity."}, {"techniqueID": "T1024", "comment": "CVE-2024-23324 - This vulnerability is relevant to C2 server and command and control communication. An attacker can use this weakness to send unauthorized gRPC requests to ext_authz."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "https://example.com/stix_bundle_1", "spec_version": "2.1", "created_by": "Your Name", "created": "2024-02-22T14:30:00.000Z", "modified": "2024-02-22T14:30:00.000Z", "objects": [{"id": "https://example.com/stix_object_1", "type": "relationship", "relationship": "related_to", "target_ref": "https://example.com/stix_object_2", "source_ref": "https://example.com/stix_object_1"}, {"id": "CVE-2024-23324", "type": "vulnerability", "name": "Envoy HTTP/2 and gRPC proxy vulnerability", "description": [{"lang": "en", "value": "Envoy is a high-performance edge/middle/service proxy. External authentication can be bypassed by downstream connections."}], "severity": "HIGH", "discovered_by": "envoyproxy", "published": "2024-02-09T23:15:09.223"}]}}, "technical_analysis": {"Introduction": "The CVE-2024-23324 vulnerability is a high-severity weakness in Envoy, an HTTP/2 and gRPC proxy.", "Impact and Scope": "The vulnerability allows attackers to bypass authentication checks and send unauthorized gRPC requests with a downstream connection.", "Related MITRE ATT&CK Techniques": "T1190, T1204, and T1024.", "Technical Details": "The vulnerability occurs when a server is configured to use failure_mode_allow=true and allows downstream connections. An attacker can exploit this weakness by sending gRPC requests to ext_authz.", "Detection": "To detect this vulnerability, monitor for gRPC requests with a downstream connection.", "Mitigation": "To mitigate this vulnerability, upgrade Envoy to a patched version.", "Conclusion": "In conclusion, CVE-2024-23324 is a high-severity vulnerability in Envoy, allowing attackers to bypass authentication checks."}, "executive_analysis": {"Overview": "The CVE-2024-23324 vulnerability is a significant weakness in Envoy, an HTTP/2 and gRPC proxy.", "Business Impact": "This vulnerability can compromise confidentiality, integrity, and availability of data.", "Technical Impact": "The vulnerability can be exploited to bypass authentication checks and send unauthorized gRPC requests.", "Mitigation Strategies": "Upgrade Envoy to a patched version.", "Recommendations": "Implement robust authentication and authorization mechanisms.", "Conclusions": "In conclusion, CVE-2024-23324 is a critical vulnerability that requires immediate attention and remediation."}}