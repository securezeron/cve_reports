{"id": "CVE-2024-23850", "sourceIdentifier": "cve@mitre.org", "published": "2024-01-23T09:15:36.120", "lastModified": "2024-06-25T22:15:17.963", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In btrfs_get_root_ref in fs/btrfs/disk-io.c in the Linux kernel through 6.7.1, there can be an assertion failure and crash because a subvolume can be read out too soon after its root item is inserted upon subvolume creation."}, {"lang": "es", "value": "En btrfs_get_root_ref en fs/btrfs/disk-io.c en el kernel de Linux hasta 6.7.1, puede haber una falla de aserci\u00f3n y un bloqueo porque un subvolumen se puede leer demasiado pronto despu\u00e9s de que se inserta su elemento ra\u00edz durante la creaci\u00f3n del subvolumen."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.7.1", "matchCriteriaId": "0AE666E7-4818-4C34-948C-9ECD1822ED8E"}]}]}], "references": [{"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "cve@mitre.org"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/EZOU3745CWCDZ7EMKMXB2OEEIB5Q3IWM/", "source": "cve@mitre.org"}, {"url": "https://lore.kernel.org/all/6a80cb4b32af89787dadee728310e5e2ca85343f.1705741883.git.wqu%40suse.com/", "source": "cve@mitre.org", "tags": ["Mailing List", "Vendor Advisory"]}, {"url": "https://lore.kernel.org/lkml/CALGdzuo6awWdau3X=8XK547x2vX_-VoFmH1aPsqosRTQ5WzJVA%40mail.gmail.com/", "source": "cve@mitre.org", "tags": ["Mailing List", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-23850 - The use of an unvalidated user-supplied input as a filename can lead to a denial-of-service (DoS) or potentially allow an attacker to execute arbitrary code leading to execution of arbitrary system commands or script execution within the kernel context. This technique can be used to exploit the vulnerability."}, {"techniqueID": "T1027", "comment": "CVE-2024-23850 - The vulnerability can be exploited by an attacker to gain unauthorized access to the affected system. The attacker can use this to gain control of the system or to exfiltrate sensitive data. This technique can be used to exploit the vulnerability."}, {"techniqueID": "T1210", "comment": "CVE-2024-23850 - An attacker can exploit the vulnerability to gain unauthorized access to sensitive data stored on the affected system. This technique can be used to exploit the vulnerability."}, {"techniqueID": "T1499", "comment": "CVE-2024-23850 - The vulnerability can be exploited by an attacker to escalate privileges on the affected system. This technique can be used to exploit the vulnerability."}, {"techniqueID": "T1496", "comment": "CVE-2024-23850 - The use of an unvalidated user-supplied input as a filename can lead to a denial-of-service (DoS) or potentially allow an attacker to execute arbitrary code leading to execution of arbitrary system commands or script execution within the kernel context. This technique can be used to exploit the vulnerability."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2024-23850", "description": "A vulnerability in the Linux kernel's btrfs_get_root_ref function that can lead to an assertion failure and crash due to reading a subvolume too soon after its root item is inserted.", "published": "2024-01-23T09:15:36.120", "lastModified": "2024-06-25T22:15:17.963", "cveTags": [], "severity": "MEDIUM", "refs": [{"rel_type": "reference", "url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "cve@mitre.org"}]}, {"type": "technique", "id": "T1190", "name": "Local File Inclusion", "description": "The use of an unvalidated user-supplied input as a filename can lead to a denial-of-service (DoS) or potentially allow an attacker to execute arbitrary code leading to execution of arbitrary system commands or script execution within the kernel context."}, {"type": "technique", "id": "T1027", "name": " Privileged Account Discovery", "description": "The vulnerability can be exploited by an attacker to gain unauthorized access to the affected system."}, {"type": "technique", "id": "T1210", "name": "Exploitation of Remote Services", "description": "An attacker can exploit the vulnerability to gain unauthorized access to sensitive data stored on the affected system."}, {"type": "technique", "id": "T1499", "name": " Privilege Escalation", "description": "The vulnerability can be exploited by an attacker to escalate privileges on the affected system."}, {"type": "technique", "id": "T1496", "name": "Data Stolen Through an Alternate Location", "description": "The use of an unvalidated user-supplied input as a filename can lead to a denial-of-service (DoS) or potentially allow an attacker to execute arbitrary code leading to execution of arbitrary system commands or script execution within the kernel context."}], "relations": [{"from": "CVE-2024-23850", "to": "T1190", "rel_type": "exploits"}, {"from": "CVE-2024-23850", "to": "T1027", "rel_type": "exploits"}, {"from": "CVE-2024-23850", "to": "T1210", "rel_type": "exploits"}, {"from": "CVE-2024-23850", "to": "T1499", "rel_type": "exploits"}, {"from": "CVE-2024-23850", "to": "T1496", "rel_type": "exploits"}]}, "technical_analysis": {"Introduction": "The CVE-2024-23850 vulnerability is a critical security issue in the Linux kernel's btrfs_get_root_ref function that can lead to an assertion failure and crash due to reading a subvolume too soon after its root item is inserted.", "Impact and Scope": "The vulnerability has a CVSS score of 5.5 and an attack vector of Local. It can be exploited by an attacker to gain unauthorized access to the affected system, escalate privileges, or exfiltrate sensitive data.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1027, T1210, T1499, and T1496.", "Technical Details": "The vulnerability occurs due to the way the Linux kernel handles the creation of subvolumes. An attacker can exploit this by creating a subvolume with a filename that is not valid, leading to an assertion failure and crash.", "Detection": "Detection of the vulnerability can be done by monitoring system logs for errors related to the btrfs_get_root_ref function. Additionally, system hardening and configuration changes can be implemented to mitigate the vulnerability.", "Mitigation": "Mitigation strategies for the vulnerability include updating the Linux kernel to a patched version, implementing system hardening and configuration changes, and monitoring system logs for errors related to the btrfs_get_root_ref function.", "Conclusion": "The CVE-2024-23850 vulnerability is a critical security issue that affects the Linux kernel's btrfs_get_root_ref function. It can be exploited by an attacker to gain unauthorized access to the affected system, escalate privileges, or exfiltrate sensitive data."}, "executive_analysis": {"Overview": "The CVE-2024-23850 vulnerability is a critical security issue that affects the Linux kernel's btrfs_get_root_ref function. It can be exploited by an attacker to gain unauthorized access to the affected system, escalate privileges, or exfiltrate sensitive data.", "Business Impact": "The vulnerability can have significant business impact by allowing an attacker to gain unauthorized access to sensitive data or systems, which can result in financial losses, reputational damage, and regulatory non-compliance.", "Technical Impact": "The vulnerability can have significant technical impact by allowing an attacker to gain unauthorized access to sensitive data or systems, which can result in security breaches, data theft, and system compromise.", "Mitigation Strategies": "Mitigation strategies for the vulnerability include updating the Linux kernel to a patched version, implementing system hardening and configuration changes, and monitoring system logs for errors related to the btrfs_get_root_ref function.", "Recommendations": "Recommendations for executives include updating the Linux kernel to a patched version, implementing system hardening and configuration changes, and monitoring system logs for errors related to the btrfs_get_root_ref function.", "Conclusions": "In conclusion, the CVE-2024-23850 vulnerability is a critical security issue that affects the Linux kernel's btrfs_get_root_ref function. It can be exploited by an attacker to gain unauthorized access to the affected system, escalate privileges, or exfiltrate sensitive data. Mitigation strategies and recommendations are provided to protect against this vulnerability."}}