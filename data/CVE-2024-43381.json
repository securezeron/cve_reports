{"id": "CVE-2024-43381", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-16T15:15:29.000", "lastModified": "2024-08-19T13:00:23.117", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "reNgine is an automated reconnaissance framework for web applications. Versions 2.1.2 and prior are susceptible to Stored Cross-Site Scripting (XSS) attacks. This vulnerability occurs when scanning a domain, and if the target domain's DNS record contains an XSS payload, it leads to the execution of malicious scripts in the reNgine's dashboard view when any user views the scan results. The XSS payload is directly fetched from the DNS record of the remote target domain. Consequently, an attacker can execute the attack without requiring any additional input from the target or the reNgine user. A patch is available and expected to be part of version 2.1.3."}, {"lang": "es", "value": "reNgine es un framework de reconocimiento automatizado para aplicaciones web. Las versiones 2.1.2 y anteriores son susceptibles a ataques de Cross-Site Scripting (XSS) Almacenado. Esta vulnerabilidad ocurre al escanear un dominio, y si el registro DNS del dominio de destino contiene un payload XSS, conduce a la ejecuci\u00f3n de scripts maliciosos en la vista del panel de reNgine cuando cualquier usuario ve los resultados del escaneo. El payload XSS se obtiene directamente del registro DNS del dominio de destino remoto. En consecuencia, un atacante puede ejecutar el ataque sin requerir ninguna entrada adicional por parte del objetivo o del usuario de reNgine. Hay un parche disponible y se espera que forme parte de la versi\u00f3n 2.1.3."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.0, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}, {"lang": "en", "value": "CWE-87"}]}], "references": [{"url": "https://github.com/yogeshojha/rengine/commit/064bac1c7c4d2b90745bf225c92e74d83edb7a4d", "source": "security-advisories@github.com"}, {"url": "https://github.com/yogeshojha/rengine/security/advisories/GHSA-96q4-fj2m-jqf7", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1059.001 - Command and PowerShell", "comment": "CVE-2024-43381 - This vulnerability allows an attacker to inject malicious PowerShell code, potentially leading to code execution."}, {"techniqueID": "T1059 - Command and Control", "comment": "CVE-2024-43381 - The DNS record injection vulnerability allows an attacker to inject malicious data into the DNS record, making it a possible command and control channel."}, {"techniqueID": "T1190 - Exploit Public-Facing Application", "comment": "CVE-2024-43381 - The vulnerability in reNgine allows an attacker to exploit a publicly-facing web application, potentially leading to code execution or data theft."}, {"techniqueID": "T1179 - DNS Data Manipulation", "comment": "CVE-2024-43381 - The DNS record injection vulnerability allows an attacker to manipulate DNS data, potentially leading to DNS reconnaissance or command and control."}, {"techniqueID": "T1408 - Data Encoding", "comment": "CVE-2024-43381 - The vulnerability in reNgine allows an attacker to inject malicious data into the DNS record, which may require data encoding to evade detection."}], "stix_bundle": "The following is a valid STIX 2.1 bundle expressing all the related techniques, risks and defense strategies for this CVE.\n{\n  \"objects\": [\n    {\n      \"type\": \"vulnerability\",\n      \"id\": \"vuln-1\",\n      \"external_references\": [{ \"source_name\": \"github\", \"external_id\": \"CVE-2024-43381\" }],\n      \"description\": \"reNgine is an automated reconnaissance framework for web applications. Versions 2.1.2 and prior are susceptible to Stored Cross-Site Scripting (XSS) attacks.\",\n      \"weaknesses\": [{ \"name\": \"CWE-79\" }, { \"name\": \"CWE-87\" }],\n      \"remediations\": [\n        {\n          \"type\": \"mitigation\",\n          \"description\": \"Update to version 2.1.3 or higher\"\n        }\n      ],\n      \"objects\": {}\n    },\n    {\n      \"type\": \"relationship\",\n      \"id\": \"rel-1\",\n      \"source_ref\": \"vuln-1\",\n      \"target_ref\": \"tech-1\",\n      \"relationship_type\": \"related_risk\"\n    },\n    {\n      \"type\": \"technique\",\n      \"id\": \"tech-1\",\n      \"external_references\": [{ \"source_name\": \"mitre\", \"external_id\": \"T1059.001\" }],\n      \"description\": \"Command and PowerShell\",\n      \"resources\": [{ \"type\": \"course_of_action\", \"description\": \"Implement controls to limit PowerShell usage\" }, {\n        \"type\": \"detection\", \"description\": \"Monitor for PowerShell script execution\" \n      }]\n    },\n    {\n      \"type\": \"relationship\",\n      \"id\": \"rel-2\",\n      \"source_ref\": \"tech-1\",\n      \"target_ref\": \"vuln-1\",\n      \"relationship_type\": \"exploited_by\"\n    }\n  ]\n}", "technical_analysis": {"Introduction": "CVE-2024-43381 is a Stored Cross-Site Scripting (XSS) vulnerability in reNgine versions 2.1.2 and prior.", "Impact and Scope": "The vulnerability allows an attacker to inject malicious PowerShell code, potentially leading to code execution or data theft. The attack vector is through DNS record injection.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1059.001 (Command and PowerShell), T1059 (Command and Control), T1190 (Exploit Public-Facing Application), T1179 (DNS Data Manipulation), and T1408 (Data Encoding).", "Technical Details": "The vulnerability occurs when scanning a domain, and if the target domain's DNS record contains an XSS payload, it leads to the execution of malicious scripts in the reNgine's dashboard view.", "Detection": "Detection methods include monitoring for PowerShell script execution and monitoring for DNS data manipulation.", "Mitigation": "Mitigation strategies include updating to version 2.1.3 or higher, implementing controls to limit PowerShell usage, and monitoring for PowerShell script execution.", "Conclusion": "In conclusion, CVE-2024-43381 is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "This vulnerability is a significant risk for organizations that use reNgine, as it allows attackers to inject malicious PowerShell code, potentially leading to code execution or data theft.", "Business Impact": "The business impact of this vulnerability includes financial loss, reputational damage, and potential regulatory fines.", "Technical Impact": "The technical impact of this vulnerability includes code execution, data theft, and potential exploitation of the system.", "Mitigation Strategies": "High-level mitigation strategies include updating to version 2.1.3 or higher, implementing controls to limit PowerShell usage, and monitoring for PowerShell script execution.", "Recommendations": "Recommendations for executives include implementing a patch management strategy, conducting regular security tests, and maintaining an incident response plan.", "Conclusions": "In conclusion, immediate action is required to mitigate this vulnerability and protect against potential threats."}}