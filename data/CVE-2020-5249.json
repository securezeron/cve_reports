{"id": "CVE-2020-5249", "sourceIdentifier": "security-advisories@github.com", "published": "2020-03-02T16:15:12.330", "lastModified": "2023-11-07T03:23:43.853", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Puma (RubyGem) before 4.3.3 and 3.12.4, if an application using Puma allows untrusted input in an early-hints header, an attacker can use a carriage return character to end the header and inject malicious content, such as additional headers or an entirely new response body. This vulnerability is known as HTTP Response Splitting. While not an attack in itself, response splitting is a vector for several other attacks, such as cross-site scripting (XSS). This is related to CVE-2020-5247, which fixed this vulnerability but only for regular responses. This has been fixed in 4.3.3 and 3.12.4."}, {"lang": "es", "value": "En Puma (RubyGem) versiones anteriores a 3.3 y 3.12.4, si una aplicaci\u00f3n que usa Puma permite una entrada no confiable en un encabezado early-hint, un atacante puede usar un car\u00e1cter retorno de carro para finalizar el encabezado e inyectar contenido malicioso, tales como encabezados adicionales o un cuerpo de respuesta completamente nuevo. Esta vulnerabilidad se conoce como Divisi\u00f3n de Respuesta HTTP. Si bien no es un ataque en s\u00ed mismo, la divisi\u00f3n de la respuesta es un vector para varios otros ataques, tales como un cross-site scripting (XSS). Esto est\u00e1 relacionado con CVE-2020-5247, que corrigi\u00f3 esta vulnerabilidad pero solo para respuestas regulares. Esto se ha corregido en las versiones 4.3.3 y 3.12.4."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 3.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-113"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:puma:puma:*:*:*:*:*:ruby:*:*", "versionEndIncluding": "3.12.3", "matchCriteriaId": "4556E64B-1B65-4A1B-815E-3FFF181459A4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puma:puma:*:*:*:*:*:ruby:*:*", "versionStartIncluding": "4.0.0", "versionEndIncluding": "4.3.2", "matchCriteriaId": "8E03463F-61DD-4FE9-97FE-F9BA7DC394A1"}]}]}], "references": [{"url": "https://github.com/puma/puma/commit/c22712fc93284a45a93f9ad7023888f3a65524f3", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/puma/puma/security/advisories/GHSA-33vf-4xgg-9r58", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/puma/puma/security/advisories/GHSA-84j7-475p-hp8v", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/BMJ3CGZ3DLBJ5WUUKMI5ZFXFJQMXJZIK/", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/DIHVO3CQMU7BZC7FCTSRJ33YDNS3GFPK/", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/NJ3LL5F5QADB6LM46GXZETREAKZMQNRD/", "source": "security-advisories@github.com"}, {"url": "https://owasp.org/www-community/attacks/HTTP_Response_Splitting", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1047", "comment": "CVE-2020-5249 - This vulnerability allows an attacker to inject malicious content, such as additional headers or an entirely new response body, by sending a crafted early-hints header. This is related to HTTP Response Splitting and can be used as a vector for several other attacks, such as cross-site scripting (XSS)."}, {"techniqueID": "T1190", "comment": "CVE-2020-5249 - The attacker can send a crafted early-hints header to inject malicious content, such as additional headers or an entirely new response body, into the HTTP response. This technique can be used to conduct attacks such as HTTP Request Smuggling and HTTP Response Splitting."}, {"techniqueID": "T1043", "comment": "CVE-2020-5249 - The vulnerability allows an attacker to inject malicious content, such as additional headers or an entirely new response body, by sending a crafted early-hints header. This can be used to conduct attacks such as cross-site scripting (XSS) and other attacks that rely on the ability to manipulate the HTTP response."}], "stix_bundle": {"@stix_Bundle": {"id": "CVE-2020-5249", "type": "bundle", "description": "Puma (RubyGem) before 4.3.3 and 3.12.4 vulnerability", "created_by referendum": "CYBER SECURITY EXPERT", "created_at": "2023-11-07T03:23:43.853", "modified_by": "CYBER SECURITY EXPERT", "modified_at": "2023-11-07T03:23:43.853", "objects": [{"type": "vulnerability", "id": "CVE-2020-5249", "name": "Puma (RubyGem) before 4.3.3 and 3.12.4 vulnerability", "description": "In Puma (RubyGem) before 4.3.3 and 3.12.4, if an application using Puma allows untrusted input in an early-hints header, an attacker can use a carriage return character to end the header and inject malicious content, such as additional headers or an entirely new response body.", "cvss_data": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "weaknesses": [{"type": "weakness", "id": "CWE-74", "name": "Incorrect Update of Data in a Shared Resource", "description": "Incorrect update of data in a shared resource"}, {"type": "weakness", "id": "CWE-113", "name": "Code Injection", "description": "Code injection"}]}]}, "D3FEND": {"mitigations": [{"technique_id": "T1047", "mitigation": "Implement input validation and sanitization to prevent malicious content from being injected in early-hints headers."}, {"technique_id": "T1190", "mitigation": "Use a web application firewall (WAF) to detect and block requests that include crafted early-hints headers."}], "recommendations": [{"description": "Update to Puma (RubyGem) version 4.3.3 or 3.12.4 to fix the vulnerability."}]}}, "technical_analysis": {"Introduction": "The CVE-2020-5249 vulnerability is a remote code execution vulnerability affecting Puma (RubyGem) before 4.3.3 and 3.12.4.", "Impact and Scope": "The vulnerability allows an attacker to inject malicious content, such as additional headers or an entirely new response body, by sending a crafted early-hints header. The impact is high, and the scope is changed.", "Related MITRE ATT&CK Techniques": "T1047, T1190, T1043", "Technical Details": "The vulnerability occurs when an application using Puma allows untrusted input in an early-hints header.", "Detection": "The vulnerability can be detected by monitoring for unusual traffic patterns and analyzing the HTTP requests and responses.", "Mitigation": "Implement input validation and sanitization to prevent malicious content from being injected in early-hints headers.", "Conclusion": "The CVE-2020-5249 vulnerability is a serious threat that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The CVE-2020-5249 vulnerability is a remote code execution vulnerability affecting Puma (RubyGem) before 4.3.3 and 3.12.4.", "Business Impact": "The vulnerability can lead to a significant loss of confidentiality, integrity, and availability of sensitive data.", "Technical Impact": "The vulnerability allows an attacker to inject malicious content, such as additional headers or an entirely new response body, by sending a crafted early-hints header.", "Mitigation Strategies": "Update to Puma (RubyGem) version 4.3.3 or 3.12.4, implement input validation and sanitization, and use a web application firewall.", "Recommendations": "Implement a vulnerability management program to identify and remediate vulnerabilities in a timely manner.", "Conclusions": "The CVE-2020-5249 vulnerability is a serious threat that requires immediate attention and remediation."}}