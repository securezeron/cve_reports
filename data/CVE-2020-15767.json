{"id": "CVE-2020-15767", "sourceIdentifier": "cve@mitre.org", "published": "2020-09-18T14:15:12.073", "lastModified": "2021-12-21T00:47:43.990", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered in Gradle Enterprise before 2020.2.5. The cookie used to convey the CSRF prevention token is not annotated with the \u201csecure\u201d attribute, which allows an attacker with the ability to MITM plain HTTP requests to obtain it, if the user mistakenly uses a HTTP instead of HTTPS address to access the server. This cookie value could then be used to perform CSRF."}, {"lang": "es", "value": "Se detect\u00f3 un problema en Gradle Enterprise versiones anteriores a 2020.2.5. La cookie utilizada para transmitir el token de prevenci\u00f3n del CSRF no est\u00e1 anotada con el atributo \"seguro\", lo que permite a un atacante con capacidad de MITM peticiones HTTP simples obtenerlo, si el usuario utiliza por error una direcci\u00f3n HTTP en lugar de HTTPS para acceder al servidor. Este valor de la cookie podr\u00eda entonces ser utilizado para realizar CSRF"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:H/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "HIGH", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 2.6}, "baseSeverity": "LOW", "exploitabilityScore": 4.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-311"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gradle:enterprise:*:*:*:*:*:*:*:*", "versionEndExcluding": "2020.2.5", "matchCriteriaId": "BD367EF2-3F92-43C8-A18F-BE0F679521AF"}]}]}], "references": [{"url": "https://github.com/gradle/gradle/security/advisories", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://security.gradle.com/advisory/CVE-2020-15767", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2020-15767 - This technique is relevant as it demonstrates the use of Cross-Site Request Forgery (CSRF) attacks on an unsuspecting user, highlighting the importance of secure cookie attributes such as the 'secure' attribute, which helps protect against MITM attacks."}, {"techniqueID": "TA0002", "comment": "CVE-2020-15767 - This technique is relevant as it showcases the importance of securing cookies, particularly the 'secure' attribute, to prevent unauthorized access to sensitive information and protect against various types of attacks."}, {"techniqueID": "TA0023", "comment": "CVE-2020-15767 - This technique is relevant as it illustrates the consequences of an unprotected cookie, demonstrating how an attacker can manipulate the contents of the cookie to perform malicious actions, highlighting the need for secure cookie attributes."}, {"techniqueID": "TA0040", "comment": "CVE-2020-15767 - This technique is relevant as it shows the attacker's ability to obtain the CSRF token through a MITM attack, which is a typical scenario in this type of vulnerability, emphasizing the importance of secure communication protocols."}], "stix_bundle": {"$id": "https://example.com/att&ck", "type": "bundle", "objects": [{"id": "CVE-2020-15767", "type": "vulnerability", "name": "CVE-2020-15767", "description": "An issue was discovered in Gradle Enterprise before 2020.2.5. The cookie used to convey the CSRF prevention token is not annotated with the \u201csecure\u201d attribute, which allows an attacker with the ability to MITM plain HTTP requests to obtain it, if the user mistakenly uses a HTTP instead of HTTPS address to access the server. This cookie value could then be used to perform CSRF.", "monitored_resources": [{"id": "GRADLE_ENTERPRISE", "type": "software", "name": "Gradle Enterprise"}], "related_threat_actors": [{"id": "unknown", "type": "threat_actor", "name": " Unknown threat actor"}], "related_courses_of_action": [{"id": "TA0001", "type": "course_of_action", "name": "Defend against Cross-Site Request Forgery (CSRF) attacks"}, {"id": "TA0023", "type": "course_of_action", "name": "Secure cookies with the 'secure' attribute"}], "stix_core_id": "CVE-2020-15767", "created_by_ref": "https://example.com/att&ck", "modified": "2021-12-21T00:47:43.990"}], "relationships": [{"id": "1", "type": "has_course_of_action", "source_ref": "CVE-2020-15767", "target_ref": "TA0001"}, {"id": "2", "type": "has_course_of_action", "source_ref": "CVE-2020-15767", "target_ref": "TA0023"}]}, "technical_analysis": {"Introduction": "CVE-2020-15767 is a vulnerability in Gradle Enterprise that allows an attacker to obtain a CSRF token through a MITM attack. This vulnerability occurs due to the absence of the 'secure' attribute in the cookie used to convey the CSRF prevention token.", "Impact and Scope": "The vulnerability affects users who access Gradle Enterprise through HTTP instead of HTTPS, as the cookie used to convey the CSRF prevention token is not annotated with the 'secure' attribute, making it vulnerable to MITM attacks.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to TTPs such as TA0001, TA0002, TA0023, and TA0040, which are all related to CSRF attacks and the importance of secure cookie attributes.", "Technical Details": "The vulnerability occurs due to the absence of the 'secure' attribute in the cookie used to convey the CSRF prevention token.", "Detection": "Detection of this vulnerability involves monitoring for MITM attacks and looking for inconsistencies in cookie values.", "Mitigation": "Mitigation strategies include securing cookies with the 'secure' attribute, using HTTPS instead of HTTP, and implementing additional security measures to prevent MITM attacks.", "Conclusion": "In conclusion, CVE-2020-15767 is a vulnerability in Gradle Enterprise that allows an attacker to obtain a CSRF token through a MITM attack. To mitigate this vulnerability, it is recommended to secure cookies with the 'secure' attribute, use HTTPS instead of HTTP, and implement additional security measures to prevent MITM attacks."}, "executive_analysis": {"Overview": "CVE-2020-15767 is a vulnerability in Gradle Enterprise that affects users who access the system through HTTP instead of HTTPS, allowing an attacker to obtain a CSRF token through a MITM attack.", "Business Impact": "The vulnerability has a significant business impact as it could compromise the security of sensitive data and allow attackers to perform malicious actions.", "Technical Impact": "The vulnerability has a significant technical impact as it affects the security of the cookie used to convey the CSRF prevention token, making it vulnerable to MITM attacks.", "Mitigation Strategies": "Mitigation strategies include securing cookies with the 'secure' attribute, using HTTPS instead of HTTP, and implementing additional security measures to prevent MITM attacks.", "Recommendations": "We recommend that users take immediate action to mitigate this vulnerability by securing cookies and using HTTPS instead of HTTP.", "Conclusions": "In conclusion, CVE-2020-15767 is a vulnerability in Gradle Enterprise that affects users who access the system through HTTP instead of HTTPS. To mitigate this vulnerability, it is recommended to secure cookies with the 'secure' attribute, use HTTPS instead of HTTP, and implement additional security measures to prevent MITM attacks."}}