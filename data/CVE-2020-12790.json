{"id": "CVE-2020-12790", "sourceIdentifier": "cve@mitre.org", "published": "2020-05-11T19:15:11.327", "lastModified": "2020-05-14T20:13:50.283", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the SEOmatic plugin before 3.2.49 for Craft CMS, helpers/DynamicMeta.php does not properly sanitize the URL. This leads to Server-Side Template Injection and credentials disclosure via a crafted Twig template after a semicolon."}, {"lang": "es", "value": "En el plugin SEOmatic versiones anteriores a 3.2.49 para Craft CMS, el archivo helpers/DynamicMeta.php no sanea apropiadamente la URL. Esto conlleva a una Inyecci\u00f3n de Plantilla del Lado del Servidor y a una divulgaci\u00f3n de credenciales por medio de una plantilla Twig dise\u00f1ada despu\u00e9s de un punto y coma."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:nystudio107:seomatic:*:*:*:*:*:craft_cms:*:*", "versionEndExcluding": "3.2.49", "matchCriteriaId": "F4272633-725D-48B9-9C76-A19EF1C0CA85"}]}]}], "references": [{"url": "https://github.com/nystudio107/craft-seomatic/blob/v3/CHANGELOG.md#3249---20200324", "source": "cve@mitre.org", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/nystudio107/craft-seomatic/commit/82f4a25b28fd622393da6592dc9e5ccee7fc5be3#diff-52fd042c50432133a00a8f840f4a6165", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/nystudio107/craft-seomatic/releases/tag/3.2.49", "source": "cve@mitre.org", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://isec.pl/en/vulnerabilities/isec-0028-seomatic-ssti-23032020.txt", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059.001", "comment": "CVE-2020-12790 - An attacker could use Server-Side Template Injection to inject arbitrary Twig code to gain arbitrary Server-Side Template Injection."}, {"techniqueID": "T1190", "comment": "CVE-2020-12790 - An attacker could use Credentials Disclosure to obtain sensitive information, potentially leading to further exploitation."}], "stix_bundle": {"cybox_common": {"original": "/", "type": "directory"}, "stix_bundle": {"id": "bundle-1.0", "label": "Bundle 1", "description": "Bundle for CVE-2020-12790"}, "indicators": [{"id": "indicator-1", "type": "url", "value": "http://example.com"}], "observed_data": [{"id": "observed_data-1", "type": "network traffic", "info_type": "network", "description": "Suspicious network traffic"}], "controls": [{"id": "control-1", "type": "network", "description": "Network control"}], "vulnerabilities": [{"id": "vulnerability-1", "type": "server-side template injection", "description": "Server-Side Template Injection vulnerability in Craft CMS"}], "roles": [{"id": "role-1", "type": "attack", "description": "Attackers role in the attack"}], "notes": [{"id": "note-1", "type": "note", "description": "Note on the vulnerability"}]}, "technical_analysis": {"Introduction": "The CVE-2020-12790 vulnerability in Craft CMS allows attackers to inject arbitrary Twig code on the server-side, potentially leading to arbitrary code execution and data disclosure. The vulnerability exists in the SEOmatic plugin, which is vulnerable to Server-Side Template Injection before version 3.2.49.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 and an attack vector of NETWORK, making it a high-severity vulnerability. If exploited, it could allow attackers to execute arbitrary code on the server, potentially leading to data disclosure and unauthorized access.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1059.001 (Server-Side Template Injection) and T1190 (Credentials Disclosure).", "Technical Details": "The vulnerability exists in the helpers/DynamicMeta.php file of the SEOmatic plugin, which does not properly sanitize input. This allows attackers to inject arbitrary Twig code, which can be executed on the server.", "Detection": "To detect this vulnerability, it is recommended to monitor network traffic for suspicious requests and inspect server-side logs for any signs of unauthorized code execution.", "Mitigation": "The vulnerability can be mitigated by updating the SEOmatic plugin to version 3.2.49 or later, as well as implementing appropriate input validation and sanitization for any user input.", "Conclusion": "The CVE-2020-12790 vulnerability in Craft CMS is a high-severity vulnerability that can be exploited to inject arbitrary Twig code on the server-side. It is recommended to update the SEOmatic plugin and implement proper input validation and sanitization to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2020-12790 vulnerability in Craft CMS affects the SEOmatic plugin, which is used to manage search engine optimization in Craft CMS. The vulnerability allows attackers to inject arbitrary Twig code on the server-side, potentially leading to data disclosure and unauthorized access.", "Business Impact": "The vulnerability has the potential to impact the confidentiality, integrity, and availability of sensitive data. If exploited, it could allow attackers to steal sensitive information, modify critical data, or disrupt business operations.", "Technical Impact": "The vulnerability could allow attackers to execute arbitrary code on the server, potentially leading to data disclosure and unauthorized access.", "Mitigation Strategies": "To mitigate this vulnerability, it is recommended to update the SEOmatic plugin to version 3.2.49 or later, as well as implement appropriate input validation and sanitization for any user input.", "Recommendations": "Executives should recommend that the development team update the SEOmatic plugin and implement proper input validation and sanitization. Additionally, executives should ensure that regular security assessments are performed to identify vulnerabilities and prevent future attacks.", "Conclusions": "The CVE-2020-12790 vulnerability in Craft CMS is a high-severity vulnerability that requires immediate attention. Executives should prioritize the mitigation of this vulnerability and ensure that the development team implements proper input validation and sanitization to prevent future attacks."}}