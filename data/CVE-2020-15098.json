{"id": "CVE-2020-15098", "sourceIdentifier": "security-advisories@github.com", "published": "2020-07-29T17:15:13.387", "lastModified": "2021-11-18T18:26:55.187", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In TYPO3 CMS greater than or equal to 9.0.0 and less than 9.5.20, and greater than or equal to 10.0.0 and less than 10.4.6, it has been discovered that an internal verification mechanism can be used to generate arbitrary checksums. This allows to inject arbitrary data having a valid cryptographic message authentication code (HMAC-SHA1) and can lead to various attack chains including potential privilege escalation, insecure deserialization & remote code execution. The overall severity of this vulnerability is high based on mentioned attack chains and the requirement of having a valid backend user session (authenticated). This has been patched in versions 9.5.20 and 10.4.6."}, {"lang": "es", "value": "En TYPO3 CMS versiones posteriores o igual a 9.0.0 y anteriores a 9.5.20, y versiones posteriores o igual a 10.0.0 y anteriores a 10.4.6, se ha detectado que puede ser usado un mecanismo de verificaci\u00f3n interna para generar sumas de comprobaci\u00f3n arbitrarias. Esto permite inyectar datos arbitrarios que tienen un c\u00f3digo de autenticaci\u00f3n de mensaje criptogr\u00e1fico v\u00e1lido (HMAC-SHA1) y puede conllevar a varias cadenas de ataque, incluyendo una escalada potencial de privilegios, una deserializaci\u00f3n no segura y una ejecuci\u00f3n de c\u00f3digo remota. La gravedad general de esta vulnerabilidad es alta seg\u00fan las cadenas de ataque mencionadas y el requisito de tener una sesi\u00f3n de usuario del backend v\u00e1lida (autenticada). Esto ha sido parcheado en las versiones 9.5.20 y 10.4.6"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-327"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}, {"lang": "en", "value": "CWE-200"}, {"lang": "en", "value": "CWE-325"}, {"lang": "en", "value": "CWE-502"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.0.0", "versionEndExcluding": "9.5.20", "matchCriteriaId": "533733E0-9B24-41B2-A9A3-BF03785B6A85"}, {"vulnerable": true, "criteria": "cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*", "versionStartIncluding": "10.0.0", "versionEndExcluding": "10.4.6", "matchCriteriaId": "22121C59-1C9F-4079-AD4F-965F872BAC58"}]}]}], "references": [{"url": "https://github.com/TYPO3/TYPO3.CMS/commit/85d3e70dff35a99ef53f4b561114acfa9e5c47e1", "source": "security-advisories@github.com", "tags": ["Broken Link"]}, {"url": "https://github.com/TYPO3/TYPO3.CMS/security/advisories/GHSA-m5vr-3m74-jwxp", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://typo3.org/security/advisory/typo3-core-sa-2016-013", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://typo3.org/security/advisory/typo3-core-sa-2020-008", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2020-15098 - This weak verification mechanism can be exploited to inject arbitrary data with a valid HMAC-SHA1, leading to various attack chains, including potential privilege escalation, insecure deserialization, and remote code execution."}, {"techniqueID": "T1509", "comment": "CVE-2020-15098 - Abusing internal verification mechanisms to generate arbitrary checksums can facilitate various attack chains, including potential privilege escalation, insecure deserialization, and remote code execution."}, {"techniqueID": "T1508", "comment": "CVE-2020-15098 - Deserialization of user-controlled data may lead to remote code execution, if an attacker can inject a malicious serialized object into the internal checksum generation mechanism."}, {"techniqueID": "T1566", "comment": "CVE-2020-15098 - Abusing the internal verification mechanism to generate arbitrary checksums may allow attackers to inject malicious data into the system, leading to various attack chains, including potential privilege escalation and remote code execution."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "indicator--a349a38a-412d-411c-89f4-944d4fc4a68c", "created_by_ref": "identity--6c99a380-45c9-41b2-8a2a-0cdaedd2126c", "modified": "2021-11-18T18:26:55.187Z", "name": "CVE-2020-15098 - Weak Verification Mechanism Abused", "description": "Weak verification mechanism in TYPO3 CMS 9.x and 10.x allows attackers to inject arbitrary data with a valid HMAC-SHA1, leading to various attack chains.", "observable": {"type": "file", "name": "typo3_internal_verification_mechanism", "url": " https://example.com/typo3/internal/verification/mechanism"}}, {"type": "course-of-action", "id": "course-of-action--ef35c730-45f4-4e3b-9bc3-455f3f9a5453", "created_by_ref": "identity--6c99a380-45c9-41b2-8a2a-0cdaedd2126c", "modified": "2021-11-18T18:26:55.187Z", "name": "COA: Remediate Weak Verification Mechanism", "description": "Remediate the weak verification mechanism in TYPO3 CMS by updating to versions 9.5.20 and 10.4.6.", "related_techniques": {"types": ["technique"]}}, {"type": "note", "id": "note--0b00a95c-42e2-44e2-95a7-65f73a5fe48a", "created_by_ref": "identity--6c99a380-45c9-41b2-8a2a-0cdaedd2126c", "modified": "2021-11-18T18:26:55.187Z", "name": "Defense Point: Input Validation", "description": "Implement input validation to prevent malicious data from being injected into the system."}], "relations": [{"from": "indicator--a349a38a-412d-411c-89f4-944d4fc4a68c", "to": "course-of-action--ef35c730-45f4-4e3b-9bc3-455f3f9a5453", "type": "associated-with"}, {"from": "indicator--a349a38a-412d-411c-89f4-944d4fc4a68c", "to": "note--0b00a95c-42e2-44e2-95a7-65f73a5fe48a", "type": "related-to"}]}, "technical_analysis": {"Introduction": "The vulnerability CVE-2020-15098 affects TYPO3 CMS 9.x and 10.x, allowing attackers to inject arbitrary data with a valid HMAC-SHA1, leading to various attack chains.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 and an attack vector of NETWORK. It is highly critical and has a high severity.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1210, T1509, T1508, and T1566.", "Technical Details": "The vulnerability is caused by a weak verification mechanism in the internal checksum generation mechanism.", "Detection": "Detect this vulnerability by monitoring for suspicious network traffic related to the internal verification mechanism.", "Mitigation": "Remediate the weak verification mechanism by updating to versions 9.5.20 and 10.4.6.", "Conclusion": "The vulnerability is highly critical and requires immediate attention to prevent potential privilege escalation, insecure deserialization, and remote code execution."}, "executive_analysis": {"Overview": "The vulnerability CVE-2020-15098 is a high-severity issue that affects TYPO3 CMS 9.x and 10.x.", "Business Impact": "The vulnerability could allow attackers to inject malicious data into the system, leading to various attack chains and potential business disruption.", "Technical Impact": "The vulnerability could lead to privilege escalation, insecure deserialization, and remote code execution.", "Mitigation Strategies": "Update to versions 9.5.20 and 10.4.6, and implement input validation to prevent malicious data from being injected into the system.", "Recommendations": "Apply the necessary mitigations and monitor for suspicious network traffic related to the internal verification mechanism.", "Conclusions": "The vulnerability is highly critical and requires immediate attention to prevent potential business disruption and data breaches."}}