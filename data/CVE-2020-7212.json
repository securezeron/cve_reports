{"id": "CVE-2020-7212", "sourceIdentifier": "cve@mitre.org", "published": "2020-03-06T20:15:12.707", "lastModified": "2020-03-09T16:55:14.563", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The _encode_invalid_chars function in util/url.py in the urllib3 library 1.25.2 through 1.25.7 for Python allows a denial of service (CPU consumption) because of an inefficient algorithm. The percent_encodings array contains all matches of percent encodings. It is not deduplicated. For a URL of length N, the size of percent_encodings may be up to O(N). The next step (normalize existing percent-encoded bytes) also takes up to O(N) for each step, so the total time is O(N^2). If percent_encodings were deduplicated, the time to compute _encode_invalid_chars would be O(kN), where k is at most 484 ((10+6*2)^2)."}, {"lang": "es", "value": "La funci\u00f3n _encode_invalid_chars en el archivo util/url.py en la biblioteca urllib3 versiones 1.25.2 hasta 1.25.7 para Python, permite una denegaci\u00f3n de servicio (consumo de CPU) debido a un algoritmo ineficiente. La matriz percent_encodings contiene todas las coincidencias de las codificaciones porcentuales. No est\u00e1 desdoblada. Para una URL de longitud N, el tama\u00f1o de percent_encodings puede ser hasta O(N). El siguiente paso (normalizar los bytes codificados porcentualmente existentes) tambi\u00e9n ocupa hasta O(N) para cada paso, por lo que el tiempo total es O(N^2). Si se desdoblaran los porcentajes de codificaci\u00f3n, el tiempo para calcular _encode_invalid_chars ser\u00eda O(kN), donde k es como m\u00e1ximo 484 ((10+6*2)^2)."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "COMPLETE", "baseScore": 7.8}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-400"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:python:urllib3:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.25.2", "versionEndIncluding": "1.25.7", "matchCriteriaId": "C6E2E571-FF01-4577-BEE4-CD2F2448A06E"}]}]}], "references": [{"url": "https://github.com/urllib3/urllib3/blob/master/CHANGES.rst", "source": "cve@mitre.org", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/urllib3/urllib3/commit/a74c9cfbaed9f811e7563cfc3dce894928e0221a", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://pypi.org/project/urllib3/1.25.8/", "source": "cve@mitre.org", "tags": ["Release Notes", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1004.002", "comment": "CVE-2020-7212 - This technique is relevant because it discusses inefficient algorithms which can lead to denial-of-service attacks, and how to defend against them. The inefficient algorithm in the _encode_invalid_chars function in util/url.py in the urllib3 library can be exploited."}, {"techniqueID": "T1190", "comment": "CVE-2020-7212 - This technique is relevant because it discusses the exploitation of CPU consumption, which can lead to denial-of-service attacks, and how to defend against them. The _encode_invalid_chars function in util/url.py in the urllib3 library can be exploited to consume CPU resources."}], "stix_bundle": "{\"bundle\":{\"type\":\"bundle\",\"spec_version\":\"2.1\"},{\"observation\":\"CVE-2020-7212\":{\"name\":\"CVE-2020-7212\",\"description\":{\"lang\":\"en\",\"value\":\"The _encode_invalid_chars function in util/url.py in the urllib3 library 1.25.2 through 1.25.7 for Python allows a denial of service (CPU consumption) because of an inefficient algorithm.\",\"href\":\"https://nvd.nist.gov/vuln/detail/CVE-2020-7212\"}},\"vulnerability\":{\"vulnerability_id\":\"CVE-2020-7212\"},\"cwe\":{\"cwe_id\":\"CWE-400\",\"description\":{\"lang\":\"en\",\"value\":\"CWE-400: Use of Hard-coded crypto key\",\"href\":\"https://cwe.mitre.org/data/definitions/400.html\"}},\"mitre_attack_patterns\":{\"mitre_attack_patterns\":[{\"attack_pattern\":{\"name\":\"Memory Corruption\",\"description\":{\"lang\":\"en\",\"value\":\"Memory Corruption: This is a type of attack where a piece of malware injects malicious code into the memory of a process.\"}}},{\"attack_pattern\":{\"name\":\"Denial of Service\",\"description\":{\"lang\":\"en\",\"value\":\"Denial of Service: This is a type of attack where a piece of malware consumes CPU resources, causing a denial of service.\"}}}]},{\"relationship\":{\"type\":\"has-parts\",\"object\":{\"object\":{\"type\":\"object\",\"id\":\"CVE-2020-7212\"}}}},{\"course_of_action\":{\"id\":\"Mitigation Strategies\",\"description\":{\"lang\":\"en\",\"value\":\"To mitigate the risk of this vulnerability, it is recommended to upgrade to a version that has been found to be secure.\",\"href\":\"https://nvd.nist.gov/vuln/detail/CVE-2020-7212\"}},\"controls\":{\"controls\":[{\"description\":{\"lang\":\"en\",\"value\":\"Update urllib3 to a secure version\",\"href\":\"https://pypi.org/project/urllib3/1.25.8/\"}}]}},\"last_updated\":\"2020-03-09T16:55:14.563\",\"created\":\"2020-03-06T20:15:12.707\",\"language\":\"en\",\"title\":\"CVE-2020-7212\"}", "technical_analysis": {"Introduction": "The CVE-2020-7212 vulnerability is a denial-of-service vulnerability in the urllib3 library of Python. It allows an attacker to consume CPU resources, leading to a denial-of-service attack.", "Impact and Scope": "The impact of this vulnerability is a denial-of-service attack, which can lead to unavailability of the system. The scope of this vulnerability is limited to systems using the urllib3 library of Python, specifically versions 1.25.2 through 1.25.7.", "Related MITRE ATT&CK Techniques": "Related MITRE ATT&CK techniques include T1004.002, T1190.", "Technical Details": "The vulnerability is caused by an inefficient algorithm in the _encode_invalid_chars function in util/url.py in the urllib3 library. This algorithm can be exploited to consume CPU resources, leading to a denial-of-service attack.", "Detection": "Detection methods for this vulnerability include monitoring system logs for any unusual CPU consumption patterns.", "Mitigation": "To mitigate the risk of this vulnerability, it is recommended to upgrade to a version that has been found to be secure.", "Conclusion": "In conclusion, the CVE-2020-7212 vulnerability is a denial-of-service vulnerability in the urllib3 library of Python, and it can be exploited to consume CPU resources, leading to a denial-of-service attack."}, "executive_analysis": {"Overview": "The CVE-2020-7212 vulnerability is a denial-of-service vulnerability in the urllib3 library of Python.", "Business Impact": "The business impact of this vulnerability is the potential for unavailability of the system, leading to lost productivity and revenue.", "Technical Impact": "The technical impact of this vulnerability is the potential for denial-of-service attacks, which can lead to unavailability of the system.", "Mitigation Strategies": "To mitigate the risk of this vulnerability, it is recommended to upgrade to a version that has been found to be secure.", "Recommendations": "Recommendations for executives include upgrading to a secure version of the urllib3 library, monitoring system logs for any unusual CPU consumption patterns, and having an incident response plan in place.", "Conclusions": "In conclusion, the CVE-2020-7212 vulnerability is a denial-of-service vulnerability in the urllib3 library of Python, and it can be exploited to consume CPU resources, leading to a denial-of-service attack. It is recommended to upgrade to a secure version of the urllib3 library to mitigate the risk of this vulnerability."}}