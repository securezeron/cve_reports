{"id": "CVE-2009-0094", "sourceIdentifier": "secure@microsoft.com", "published": "2009-03-11T14:19:15.250", "lastModified": "2019-02-26T14:04:00.993", "vulnStatus": "Modified", "cveTags": [], "evaluatorComment": "Per: http://www.microsoft.com/technet/security/Bulletin/MS09-008.mspx\r\n\r\nMitigating Factors for WPAD WINS Server Registration Vulnerability - CVE-2009-0094\r\n\r\nMitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation.\t\r\n\r\nIf WINS server already has WPAD and ISATAP registered than an attacker will not be able to register these as well.\r\n", "descriptions": [{"lang": "en", "value": "The WINS server in Microsoft Windows 2000 SP4 and Server 2003 SP1 and SP2 does not restrict registration of the (1) \"wpad\" and (2) \"isatap\" NetBIOS names, which allows remote authenticated users to hijack the Web Proxy Auto-Discovery (WPAD) and Intra-Site Automatic Tunnel Addressing Protocol (ISATAP) features, and conduct man-in-the-middle attacks by spoofing a proxy server or ISATAP route, by registering one of these names in the WINS database, aka \"WPAD WINS Server Registration Vulnerability,\" a related issue to CVE-2007-1692."}, {"lang": "es", "value": "El servidor WINS en Microsoft Windows 2000 SP4  y Server 2003 SP1 y SP2 no limita el registro de los nombres NetBIOS (1) \"wpad\" y (2) \"isatap\", lo que permite a usuarios autenticados remotamente secuestrar las caracter\u00edsticas Web Proxy Auto-Discovery (WPAD) y Intra-Site Automatic Tunnel Addressing Protocol (ISATAP), y llevar a cabo ataques del tipo \"Man in The Middle (hombre en el medio)\" mediante la suplantaci\u00f3n de un servidor proxy o ruta ISATAP registrando uno de esos nombres en la base de datos del WINS. Tambi\u00e9n conocida como \"Vulnerabilidad WPAD WINS Server Registration\", cuesti\u00f3n relacionada con el CVE-2007-1692."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_2000:*:sp4:*:*:*:*:*:*", "matchCriteriaId": "83E7C4A0-78CF-4B56-82BF-EC932BDD8ADF"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2003:*:*:*:*:*:*:*:*", "matchCriteriaId": "31A64C69-D182-4BEC-BA8A-7B405F5B2FC0"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2003:*:sp1:*:*:*:*:*:*", "matchCriteriaId": "DA778424-6F70-4AB6-ADD5-5D4664DFE463"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2003:*:sp1:itanium:*:*:*:*:*", "matchCriteriaId": "BCE2197B-7C58-4693-B9BB-0B31EABB6B66"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2003:*:sp2:*:*:*:*:*:*", "matchCriteriaId": "4D3B5E4F-56A6-4696-BBB4-19DF3613D020"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:*:*:*:*:*:*:*:*", "matchCriteriaId": "6B33C9BD-FC34-4DFC-A81F-C620D3DAA79D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:*:*:x64:*:*:*:*:*", "matchCriteriaId": "7F9C7616-658D-409D-8B53-AC00DC55602A"}]}]}], "references": [{"url": "http://blogs.technet.com/srd/archive/2009/03/13/ms09-008-dns-and-wins-server-security-update-in-more-detail.aspx", "source": "secure@microsoft.com"}, {"url": "http://osvdb.org/52520", "source": "secure@microsoft.com"}, {"url": "http://secunia.com/advisories/34217", "source": "secure@microsoft.com"}, {"url": "http://support.avaya.com/elmodocs2/security/ASA-2009-083.htm", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/bid/34013", "source": "secure@microsoft.com"}, {"url": "http://www.securitytracker.com/id?1021829", "source": "secure@microsoft.com"}, {"url": "http://www.us-cert.gov/cas/techalerts/TA09-069A.html", "source": "secure@microsoft.com", "tags": ["US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2009/0661", "source": "secure@microsoft.com"}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-008", "source": "secure@microsoft.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6117", "source": "secure@microsoft.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CWE 2009-0094 - Using Web Proxy Auto-Discovery (WPAD) to compromise user session"}, {"techniqueID": "T1599", "comment": "CWE 2009-0094 - Manipulating Windows Server configuration to enable unauthorized access"}, {"techniqueID": "T1190", "comment": "CWE 2009-0094 - Registering unauthorized NetBIOS names on a Windows Server to hijack WPAD and ISATAP features"}, {"techniqueID": "T1021", "comment": "CWE 2009-0094 - Registering unauthorized NetBIOS names on a Windows Server to conduct man-in-the-middle attacks"}, {"techniqueID": "T1561", "comment": "CWE 2009-0094 - Using an existing vulnerability to elevate privileges on a Windows Server"}], "stix_bundle": {"_bundle": {"type": "bundle", "id": "https://example.com/cve-2009-0094.stix", "meta": {"created": "2023-02-27T14:00:00.000Z", "updated": "2023-02-27T14:00:00.000Z"}, "objects": [{"Object": {"type": "vulnerability", "id": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0094", "name": "CVE-2009-0094 - WINS Server Registration Vulnerability", "description": "The WINS server in Microsoft Windows 2000 SP4 and Server 2003 SP1 and SP2 does not restrict registration of the (1) \"wpad\" and (2) \"isatap\" NetBIOS names, which allows remote authenticated users to hijack the Web Proxy Auto-Discovery (WPAD) and Intra-Site Automatic Tunnel Addressing Protocol (ISATAP) features, and conduct man-in-the-middle attacks by spoofing a proxy server or ISATAP route, by registering one of these names in the WINS database."}}, {"Object": {"type": "observable", "id": "https://example.com/network-traffic/malicious", "name": "Suspicious network traffic", "description": "Unusual network traffic patterns indicating potential exploitation of the CVE-2009-0094 vulnerability."}}, {"Object": {"type": "action", "id": "https://example.com/defend-against-cve-2009-0094", "name": "Defend against CVE-2009-0094", "description": "Implement strict access controls, regularly update Windows Server software, and monitor network traffic to prevent exploitation of the CVE-2009-0094 vulnerability."}}], "relationships": [{"_rel": "related_to", "from": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0094", "to": "https://example.com/network-traffic/malicious"}, {"rel": "mitigates", "from": "https://example.com/defend-against-cve-2009-0094", "to": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0094"}]}}, "technical_analysis": {"Introduction": "The CVE-2009-0094 vulnerability is a remote code execution flaw in the Microsoft Windows WINS server. An attacker can register unauthorized NetBIOS names on a Windows Server to hijack WPAD and ISATAP features, allowing them to conduct man-in-the-middle attacks.", "Impact and Scope": "The vulnerability affects Windows 2000 SP4 and Server 2003 SP1 and SP2. The attack vector is NETWORK, with a cvss score of 5.5 (CVSS:2.0/AV:N/AC:L/Au:S/C:N/I:P/A:P).", "Related MITRE ATT&CK Techniques": "T1210, T1599, T1190, T1021, and T1561.", "Technical Details": "The vulnerability is caused by a lack of input validation in the WINS server, which allows an attacker to register unauthorized NetBIOS names. This can be exploited by an authenticated attacker to hijack WPAD and ISATAP features, allowing them to conduct man-in-the-middle attacks.", "Detection": "Monitor network traffic for unusual patterns, and implement strict access controls.", "Mitigation": "Implement strict access controls, regularly update Windows Server software, and monitor network traffic.", "Conclusion": "The CVE-2009-0094 vulnerability is a critical remote code execution flaw that allows attackers to conduct man-in-the-middle attacks. It is essential to implement strict access controls, regularly update Windows Server software, and monitor network traffic to prevent exploitation of this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2009-0094 vulnerability is a critical remote code execution flaw in the Microsoft Windows WINS server.", "Business Impact": "Exploitation of this vulnerability could lead to significant financial losses and reputational damage.", "Technical Impact": "An attacker can hijack WPAD and ISATAP features, allowing them to conduct man-in-the-middle attacks.", "Mitigation Strategies": "Implement strict access controls, regularly update Windows Server software, and monitor network traffic.", "Recommendations": "Executives should prioritize patching and implementing mitigation strategies to prevent exploitation of this vulnerability.", "Conclusions": "The CVE-2009-0094 vulnerability is a critical remote code execution flaw that requires immediate attention from executives and IT professionals."}}