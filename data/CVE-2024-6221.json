{"id": "CVE-2024-6221", "sourceIdentifier": "security@huntr.dev", "published": "2024-08-18T19:15:04.730", "lastModified": "2024-08-20T19:37:23.077", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability in corydolphin/flask-cors version 4.0.1 allows the `Access-Control-Allow-Private-Network` CORS header to be set to true by default, without any configuration option. This behavior can expose private network resources to unauthorized external access, leading to significant security risks such as data breaches, unauthorized access to sensitive information, and potential network intrusions."}, {"lang": "es", "value": "Una vulnerabilidad en corydolphin/flask-cors versi\u00f3n 4.0.1 permite que el encabezado CORS `Access-Control-Allow-Private-Network` se establezca en verdadero de forma predeterminada, sin ninguna opci\u00f3n de configuraci\u00f3n. Este comportamiento puede exponer los recursos de la red privada a un acceso externo no autorizado, lo que genera importantes riesgos de seguridad, como violaciones de datos, acceso no autorizado a informaci\u00f3n confidencial y posibles intrusiones en la red."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-284"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:corydolphin:flask-cors:4.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "489D084D-F1F0-4345-ACD8-44B2CF18BDCF"}]}]}], "references": [{"url": "https://huntr.com/bounties/a42935fc-6f57-4818-bca4-3d528235df4d", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1129", "comment": "CWECVE-2024-6221 - This technique is relevant because it allows an attacker to bypass access controls and potentially access sensitive information, which can lead to data breaches and unauthorized access. Defense against this technique can be achieved by configuring the server to validate CORS headers and setting the `Access-Control-Allow-Private-Network` header to false."}, {"techniqueID": "T1190", "comment": "CWECVE-2024-6221 - This technique is relevant because it allows an attacker to exploit the default behavior of the `Access-Control-Allow-Private-Network` header, which can lead to unauthorized access to private network resources. Defense against this technique can be achieved by configuring the server to disable access to private network resources or by validating the `Access-Control-Allow-Private-Network` header."}, {"techniqueID": "T1027", "comment": "CWECVE-2024-6221 - This technique is relevant because it allows an attacker to conduct reconnaissance on the network, potentially identifying vulnerable systems and applications, which can lead to further exploitation. Defense against this technique can be achieved by implementing network segmentation and isolating vulnerable systems and applications."}, {"techniqueID": "T1191", "comment": "CWECVE-2024-6221 - This technique is relevant because it allows an attacker to exploit the default behavior of the `Access-Control-Allow-Private-Network` header to access unauthorized resources, which can lead to data breaches and unauthorized access. Defense against this technique can be achieved by configuring the server to validate access to resources and setting the `Access-Control-Allow-Private-Network` header to false."}], "stix_bundle": {"bundle_id": "CVE-2024-6221", "bundle_name": "CVE-2024-6221 Bundled Analysis", "bundle_type": "STIX Bundle", "objects": [{"type": "vulnerability", "id": "CVE-2024-6221", "created_by": " security@huntr.dev", "description": "A vulnerability in corydolphin/flask-cors version 4.0.1 allows the `Access-Control-Allow-Private-Network` CORS header to be set to true by default, without any configuration option.", "exploitability": "Unauthenticated", "attack_vector": "Network", "attack_complexity": "Low", "privileges_required": "None", "user_interaction": "None", "scope": "Unchanged", "cvss_score": 7.5, "cvss_metric_version": "3.1", "effective_score": 7.5, "impact_score": 3.6, "exploitability_score": 3.9, "weaknesses": [{"type": "Weakness", "id": "CWE-284", "name": "Incorrect Default Permissions", "description": "The `Access-Control-Allow-Private-Network` CORS header is set to true by default, allowing unauthorized access to private network resources."}], "references": [{"source": "security@huntr.dev", "type": "Vulnerability Bulletin", "id": "a42935fc-6f57-4818-bca4-3d528235df4d", "url": "https://huntr.com/bounties/a42935fc-6f57-4818-bca4-3d528235df4d", "title": "A vulnerability in corydolphin/flask-cors version 4.0.1 allows unauthorized access to private network resources"}], "tags": ["Exploit", "Third Party Advisory"]}, {"type": "course_of_action", "id": "Mitigate Default Permissions", "title": "Mitigate Default Permissions", "description": "Configure the server to validate CORS headers and set the `Access-Control-Allow-Private-Network` header to false.", "mitigates": ["CVE-2024-6221"], "techniques": ["T1129"]}, {"type": "course_of_action", "id": "Implement Network Segmentation", "title": "Implement Network Segmentation", "description": "Implement network segmentation to isolate vulnerable systems and applications and limit the attack surface.", "mitigates": ["CVE-2024-6221"], "techniques": ["T1027"]}]}, "technical_analysis": {"Introduction": "The CVE-2024-6221 is a vulnerability in the flask-cors library that allows the `Access-Control-Allow-Private-Network` CORS header to be set to true by default, without any configuration option.", "Impact and Scope": "The vulnerability allows an attacker to access private network resources without authentication, which can lead to data breaches and unauthorized access.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to techniques such as T1129, T1190, T1027, and T1191.", "Technical Details": "The vulnerability is caused by the default behavior of the `Access-Control-Allow-Private-Network` header, which allows unauthorized access to private network resources.", "Detection": "Detection of this vulnerability can be achieved by logging and monitoring network traffic and identifying suspicious access to private network resources.", "Mitigation": "Mitigation of this vulnerability can be achieved by configuring the server to validate CORS headers and setting the `Access-Control-Allow-Private-Network` header to false, and implementing network segmentation to isolate vulnerable systems and applications.", "Conclusion": "In conclusion, the CVE-2024-6221 is a critical vulnerability that requires immediate attention and remediation to prevent data breaches and unauthorized access."}, "executive_analysis": {"Overview": "The CVE-2024-6221 is a critical vulnerability that allows unauthorized access to private network resources without authentication.", "Business Impact": "The vulnerability can lead to data breaches and unauthorized access, which can result in significant financial and reputational losses.", "Technical Impact": "The vulnerability is caused by the default behavior of the `Access-Control-Allow-Private-Network` header, which allows unauthorized access to private network resources.", "Mitigation Strategies": "Mitigation of this vulnerability can be achieved by configuring the server to validate CORS headers and setting the `Access-Control-Allow-Private-Network` header to false, and implementing network segmentation to isolate vulnerable systems and applications.", "Recommendations": "We recommend that organizations implement the following measures to mitigate this vulnerability: configuring the server to validate CORS headers, setting the `Access-Control-Allow-Private-Network` header to false, and implementing network segmentation.", "Conclusions": "In conclusion, the CVE-2024-6221 is a critical vulnerability that requires immediate attention and remediation to prevent data breaches and unauthorized access."}}