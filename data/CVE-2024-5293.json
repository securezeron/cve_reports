{"id": "CVE-2024-5293", "sourceIdentifier": "zdi-disclosures@trendmicro.com", "published": "2024-05-23T22:15:15.000", "lastModified": "2024-05-24T01:15:30.977", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "D-Link DIR-2640 HTTP Referer Stack-Based Buffer Overflow Remote Code Execution Vulnerability. This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of D-Link DIR-2640-US routers. Authentication is not required to exploit this vulnerability.\n\nThe specific flaw exists within prog.cgi, which handles HNAP requests made to the lighttpd webserver listening on TCP ports 80 and 443. The issue results from the lack of proper validation of the length of user-supplied data prior to copying it to a fixed-length stack-based buffer. An attacker can leverage this vulnerability to execute code in the context of root. Was ZDI-CAN-21853."}, {"lang": "es", "value": "Vulnerabilidad de ejecuci\u00f3n remota de c\u00f3digo de desbordamiento de b\u00fafer basado en pila de referencia HTTP D-Link DIR-2640. Esta vulnerabilidad permite a atacantes adyacentes a la red ejecutar c\u00f3digo arbitrario en instalaciones afectadas de enrutadores D-Link DIR-2640-US. No se requiere autenticaci\u00f3n para aprovechar esta vulnerabilidad. La falla espec\u00edfica existe dentro de prog.cgi, que maneja las solicitudes HNAP realizadas al servidor web lighttpd que escucha en los puertos TCP 80 y 443. El problema se debe a la falta de una validaci\u00f3n adecuada de la longitud de los datos proporcionados por el usuario antes de copiarlos en un archivo fijo. -b\u00fafer basado en pila de longitud. Un atacante puede aprovechar esta vulnerabilidad para ejecutar c\u00f3digo en el contexto de la ra\u00edz. Era ZDI-CAN-21853."}], "metrics": {"cvssMetricV30": [{"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-121"}]}], "references": [{"url": "https://www.zerodayinitiative.com/advisories/ZDI-24-444/", "source": "zdi-disclosures@trendmicro.com"}], "techniques": [{"techniqueID": "T1210", "comment": "D-Link DIR-2640 HTTP Referer Stack-Based Buffer Overflow Remote Code Execution Vulnerability - Attackers can leverage this vulnerability to execute code in the context of root. Mitigation strategies include updating the firmware to the latest version and enabling firewall rules to block unauthorized HNAP requests."}, {"techniqueID": "T1078", "comment": "D-Link DIR-2640 HTTP Referer Stack-Based Buffer Overflow Remote Code Execution Vulnerability - The attacker can use this vulnerability to execute arbitrary code. Defenses such as network segmentation and strict network access controls can help prevent attacks."}, {"techniqueID": "T1083", "comment": "D-Link DIR-2640 HTTP Referer Stack-Based Buffer Overflow Remote Code Execution Vulnerability - The attacker can use this vulnerability to execute arbitrary code. Defenses such as intrusion detection systems and web application firewalls can help detect and prevent attacks."}], "technical_analysis": {"Introduction": "The D-Link DIR-2640 HTTP Referer Stack-Based Buffer Overflow Remote Code Execution Vulnerability is a critical vulnerability that allows remote attackers to execute arbitrary code on affected devices. This vulnerability is located in the prog.cgi script and can be exploited by sending a crafted HNAP request to the affected device.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 (High) and an attack vector of adjacent network. This means that an attacker does not need to access the network to exploit the vulnerability.", "Related MITRE ATT&CK Techniques": "T1210, T1078, T1083", "Technical Details": "The vulnerability is caused by a stack-based buffer overflow in the prog.cgi script. This script handles HNAP requests and is vulnerable to buffer overflow attacks.", "Detection": "Detection of this vulnerability can be done by analyzing network traffic and monitoring for suspicious HNAP requests.", "Mitigation": "Mitigation strategies include updating the firmware to the latest version, enabling firewall rules to block unauthorized HNAP requests, and configuring the device to only accept HNAP requests from trusted sources.", "Conclusion": "The D-Link DIR-2640 HTTP Referer Stack-Based Buffer Overflow Remote Code Execution Vulnerability is a critical vulnerability that can be exploited by remote attackers. Mitigation strategies are available to help prevent attacks."}, "executive_analysis": {"Overview": "The D-Link DIR-2640 HTTP Referer Stack-Based Buffer Overflow Remote Code Execution Vulnerability is a critical vulnerability that can be exploited by remote attackers. This vulnerability affects devices that are running older firmware and are accessible from the internet.", "Business Impact": "This vulnerability can result in the compromise of sensitive data and can also be used to launch additional attacks against the network. This could result in significant financial losses and reputational damage.", "Technical Impact": "This vulnerability can result in the execution of arbitrary code on affected devices. This could result in the compromise of sensitive data and can also be used to launch additional attacks against the network.", "Mitigation Strategies": "Updating the firmware to the latest version, enabling firewall rules to block unauthorized HNAP requests, and configuring the device to only accept HNAP requests from trusted sources can help prevent attacks.", "Recommendations": "Executives should recommend updating the firmware to the latest version and enabling firewall rules to block unauthorized HNAP requests. They should also recommend configuring the device to only accept HNAP requests from trusted sources.", "Conclusions": "The D-Link DIR-2640 HTTP Referer Stack-Based Buffer Overflow Remote Code Execution Vulnerability is a critical vulnerability that requires immediate attention. Executives should work with their security teams to implement mitigation strategies and prevent attacks."}, "stix_bundle": {"type": "s Bundle", "id": "bundle-D-Link DIR-2640 HTTP Referer Stack-Based Buffer Overflow Remote Code Execution Vulnerability", "objects": [{"type": "vulnerability", "id": "vulnerability-D-Link DIR-2640 HTTP Referer Stack-Based Buffer Overflow Remote Code Execution Vulnerability", "objects": [{"type": "indicator", "id": "indicator-http-referrer-stack-based-buffer-overflow", "label": "D-Link DIR-2640 HTTP Referer Stack-Based Buffer Overflow Indicators", "description": "Indicators of this attack include the presence of arbitrary code execution on the affected device."}]}, {"type": "course-of-action", "id": "course-of-action-update-firmware", "label": "Update Firmware", "description": "The most effective mitigation strategy is to update the firmware of the affected device to the latest version.", "related_techniques": ["T1210"]}, {"type": "course-of-action-enable-firewall-rules", "id": "course-of-action-enable-firewall-rules", "label": "Enable Firewall Rules", "description": "Enabling firewall rules to block unauthorized HNAP requests can help prevent attacks.", "related_techniques": ["T1078", "T1083"]}]}}