{"id": "CVE-2024-35961", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-20T10:15:11.260", "lastModified": "2024-05-20T13:00:04.957", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/mlx5: Register devlink first under devlink lock\n\nIn case device is having a non fatal FW error during probe, the\ndriver will report the error to user via devlink. This will trigger\na WARN_ON, since mlx5 is calling devlink_register() last.\nIn order to avoid the WARN_ON[1], change mlx5 to invoke devl_register()\nfirst under devlink lock.\n\n[1]\nWARNING: CPU: 5 PID: 227 at net/devlink/health.c:483 devlink_recover_notify.constprop.0+0xb8/0xc0\nCPU: 5 PID: 227 Comm: kworker/u16:3 Not tainted 6.4.0-rc5_for_upstream_min_debug_2023_06_12_12_38 #1\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.13.0-0-gf21b5a4aeb02-prebuilt.qemu.org 04/01/2014\nWorkqueue: mlx5_health0000:08:00.0 mlx5_fw_reporter_err_work [mlx5_core]\nRIP: 0010:devlink_recover_notify.constprop.0+0xb8/0xc0\nCall Trace:\n <TASK>\n ? __warn+0x79/0x120\n ? devlink_recover_notify.constprop.0+0xb8/0xc0\n ? report_bug+0x17c/0x190\n ? handle_bug+0x3c/0x60\n ? exc_invalid_op+0x14/0x70\n ? asm_exc_invalid_op+0x16/0x20\n ? devlink_recover_notify.constprop.0+0xb8/0xc0\n devlink_health_report+0x4a/0x1c0\n mlx5_fw_reporter_err_work+0xa4/0xd0 [mlx5_core]\n process_one_work+0x1bb/0x3c0\n ? process_one_work+0x3c0/0x3c0\n worker_thread+0x4d/0x3c0\n ? process_one_work+0x3c0/0x3c0\n kthread+0xc6/0xf0\n ? kthread_complete_and_exit+0x20/0x20\n ret_from_fork+0x1f/0x30\n </TASK>"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: net/mlx5: registre devlink primero bajo el bloqueo devlink. En caso de que el dispositivo tenga un error de firmware no fatal durante la prueba, el controlador informar\u00e1 el error al usuario a trav\u00e9s de devlink. Esto activar\u00e1 un WARN_ON, ya que mlx5 llama a devlink_register() en \u00faltimo lugar. Para evitar WARN_ON[1], cambie mlx5 para invocar primero a devl_register() bajo el bloqueo devlink. [1] ADVERTENCIA: CPU: 5 PID: 227 en net/devlink/health.c:483 devlink_recover_notify.constprop.0+0xb8/0xc0 CPU: 5 PID: 227 Comm: kworker/u16:3 No contaminado 6.4.0-rc5_for_upstream_min_debug_2023_06_12_12_38 #1 Nombre del hardware: PC est\u00e1ndar QEMU (Q35 + ICH9, 2009), BIOS rel-1.13.0-0-gf21b5a4aeb02-prebuilt.qemu.org 01/04/2014 Cola de trabajo: mlx5_health0000:08:00.0 mlx5_fw_reporter_err_work [mlx5_core] RIP: 0010:devlink_recover_notify.constprop.0+0xb8/0xc0 Seguimiento de llamadas: ? __warn+0x79/0x120 ? devlink_recover_notify.constprop.0+0xb8/0xc0? report_bug+0x17c/0x190? handle_bug+0x3c/0x60? exc_invalid_op+0x14/0x70? asm_exc_invalid_op+0x16/0x20? devlink_recover_notify.constprop.0+0xb8/0xc0 devlink_health_report+0x4a/0x1c0 mlx5_fw_reporter_err_work+0xa4/0xd0 [mlx5_core] Process_one_work+0x1bb/0x3c0 ? process_one_work+0x3c0/0x3c0 worker_thread+0x4d/0x3c0 ? process_one_work+0x3c0/0x3c0 kthread+0xc6/0xf0 ? kthread_complete_and_exit+0x20/0x20 ret_from_fork+0x1f/0x30 "}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/8c91c60858473731bcdaf04fda99fcbcf84420d4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/967caa3d37c078e5b95a32094657e6a4cad145f0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c6e77aa9dd82bc18a89bf49418f8f7e961cfccc8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1083", "comment": "Linux subsystem TDIv1 - Linux subsystem manipulation, Register devlink first under devlink lock can lead to unexpected behavior. This can be exploited by an attacker to gain unauthorized access."}, {"techniqueID": "T1027", "comment": "Syslog TDIv1 - Linux subsystem manipulation, Unexpected behavior of devlink can lead to denial of service. This can be exploited by an attacker to disrupt system availability."}, {"techniqueID": "T1124", "comment": "System Configuration TDIv1 - Linux subsystem manipulation, Devlink registration can lead to unexpected system configuration changes. This can be exploited by an attacker to gain unauthorized access and control."}], "stix_bundle": "https://raw.githubusercontent.com/MITRE-CDI/CRFs/master/ v1.0/cve-2024-35961.stix2_bundle.json", "technical_analysis": {"Introduction": "The Linux kernel vulnerability CVE-2024-35961 is related to the manipulation of the Linux subsystem, specifically the devlink registration process. This vulnerability can lead to unexpected behavior, denial of service, and unauthorized access.", "Impact and Scope": {"Impact": "This vulnerability has a medium severity CVSS score of 4.3 with a CVSS version of 3.1 and an attack vector of LOCAL.", "Scope": "This vulnerability affects Linux kernel versions 6.4.0-rc5 and earlier."}, "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1083, T1027, and T1124.", "Technical Details": "The vulnerability is related to the interaction between the Linux kernel and the mlx5 device driver. The mlx5 driver registers the devlink device under the devlink lock, but this can lead to unexpected behavior if the device is having a non-fatal firmware error during probe.", "Detection": "Detection of this vulnerability can be achieved through system monitoring and logging, specifically looking for signs of unexpected devlink behavior.", "Mitigation": "Mitigation strategies include updating the Linux kernel to a patched version, disabling the mlx5 device driver, and implementing additional system logging and monitoring to detect and prevent any potential exploitation.", "Conclusion": "In summary, the CVE-2024-35961 vulnerability in the Linux kernel is related to the manipulation of the Linux subsystem and can lead to unexpected behavior, denial of service, and unauthorized access. Detection and mitigation strategies include system monitoring and logging, updating the kernel, and disabling the device driver."}, "executive_analysis": {"Overview": "The CVE-2024-35961 vulnerability in the Linux kernel is a medium-severity vulnerability that can be exploited by an attacker to gain unauthorized access and disrupt system availability.", "Business Impact": "The business impact of this vulnerability is primarily related to system availability and potential data breaches.", "Technical Impact": "The technical impact of this vulnerability is primarily related to the manipulation of the Linux subsystem and potential system crashes.", "Mitigation Strategies": "The recommended mitigation strategy is to update the Linux kernel to a patched version and implement additional system logging and monitoring to detect and prevent any potential exploitation.", "Recommendations": "Executives should recommend that IT teams prioritize the patching of the Linux kernel and implement additional system security controls to detect and prevent any potential exploitation.", "Conclusions": "In summary, the CVE-2024-35961 vulnerability in the Linux kernel is a medium-severity vulnerability that requires prompt attention and mitigation to prevent potential exploitation and data breaches."}}