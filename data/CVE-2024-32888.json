{"id": "CVE-2024-32888", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-15T03:15:12.627", "lastModified": "2024-05-15T16:40:19.330", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Amazon JDBC Driver for Redshift is a Type 4 JDBC driver that provides database connectivity through the standard JDBC application program interfaces (APIs) available in the Java Platform, Enterprise Editions. Prior to version 2.1.0.28, SQL injection is possible when using the non-default connection property `preferQueryMode=simple` in combination with application code which has a vulnerable SQL that negates a parameter value. There is no vulnerability in the driver when using the default, extended query mode. Note that `preferQueryMode` is not a supported parameter in Redshift JDBC driver, and is inherited code from Postgres JDBC driver. Users who do not override default settings to utilize this unsupported query mode are not affected. This issue is patched in driver version 2.1.0.28. As a workaround, do not use the connection property `preferQueryMode=simple`. (NOTE: Those who do not explicitly specify a query mode use the default of extended query mode and are not affected by this issue.)"}, {"lang": "es", "value": "El controlador Amazon JDBC para Redshift es un controlador JDBC de tipo 4 que proporciona conectividad de bases de datos a trav\u00e9s de las interfaces de programas de aplicaci\u00f3n (API) JDBC est\u00e1ndar disponibles en Java Platform, Enterprise Editions. Antes de la versi\u00f3n 2.1.0.28, la inyecci\u00f3n SQL es posible cuando se usa la propiedad de conexi\u00f3n no predeterminada `preferQueryMode=simple` en combinaci\u00f3n con c\u00f3digo de aplicaci\u00f3n que tiene un SQL vulnerable que niega el valor de un par\u00e1metro. No hay vulnerabilidad en el controlador cuando se utiliza el modo de consulta extendido predeterminado. Tenga en cuenta que `preferQueryMode` no es un par\u00e1metro admitido en el controlador JDBC de Redshift y es un c\u00f3digo heredado del controlador JDBC de Postgres. Los usuarios que no anulen la configuraci\u00f3n predeterminada para utilizar este modo de consulta no compatible no se ver\u00e1n afectados. Este problema se solucion\u00f3 en la versi\u00f3n del controlador 2.1.0.28. Como workaround, no utilice la propiedad de conexi\u00f3n `preferQueryMode=simple`. (NOTA: Aquellos que no especifican expl\u00edcitamente un modo de consulta utilizan el modo de consulta extendido predeterminado y no se ven afectados por este problema)."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-89"}]}], "references": [{"url": "https://github.com/aws/amazon-redshift-jdbc-driver/commit/0d354a5f26ca23f7cac4e800e3b8734220230319", "source": "security-advisories@github.com"}, {"url": "https://github.com/aws/amazon-redshift-jdbc-driver/commit/12a5e8ecfbb44c8154fc66041cca2e20ecd7b339", "source": "security-advisories@github.com"}, {"url": "https://github.com/aws/amazon-redshift-jdbc-driver/commit/bc93694201a291493778ce5369a72befeca5ba7d", "source": "security-advisories@github.com"}, {"url": "https://github.com/aws/amazon-redshift-jdbc-driver/security/advisories/GHSA-x3wm-hffr-chwm", "source": "security-advisories@github.com"}, {"url": "https://github.com/pgjdbc/pgjdbc/security/advisories/GHSA-24rp-q3w6-vc56", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "The CVE-2024-32888 vulnerability CAN BE exploited using SQL injection, which is a relevant technique for attackers. Defending against this by implementing input validation and sanitization can prevent this attack."}, {"techniqueID": "T1059", "comment": "The vulnerability in the Amazon JDBC Driver for Redshift can be exploited using SQL injection, which might involve creating a malicious SQL query to manipulate the database. This can be detected by monitoring database queries and implementing logging and auditing mechanisms."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "uuid", "version": "2.1", "created_by_ref": "identity", "object_refs": [{"id": "uuid", "type": "indicator", "name": "CVE-2024-32888", "description": "The Amazon JDBC Driver for Redshift vulnerability", "first_seen": "date", "last_seen": "date"}], "objects": [{"type": "vulnerability", "id": "uuid", "created_by_ref": "identity", "object_marking_refs": [{"id": "id", "type": "marking-definition-ref"}], "modified": "date", "modified_by_ref": "identity", "created": "date", "name": "CVE-2024-32888", "description": "The Amazon JDBC Driver for Redshift vulnerability"}, {"type": "attack-pattern", "id": "uuid", "created_by_ref": "identity", "object_marking_refs": [{"id": "id", "type": "marking-definition-ref"}], "modified": "date", "modified_by_ref": "identity", "created": "date", "name": "T1190", "description": "Exploitation of remote services"}, {"type": "attack-pattern", "id": "uuid", "created_by_ref": "identity", "object_marking_refs": [{"id": "id", "type": "marking-definition-ref"}], "modified": "date", "modified_by_ref": "identity", "created": "date", "name": "T1059", "description": "Software Component Discovery"}], "relationships": [{"id": "uuid", "type": "has-object", "relation": "uses", "object_ref": {"id": "uuid", "type": "attack-pattern"}}]}}, "technical_analysis": {"Introduction": "The CVE-2024-32888 vulnerability is a remote code execution vulnerability in the Amazon JDBC Driver for Redshift, which allows an attacker to inject and execute malicious SQL code on a database.", "Impact and Scope": "The attack vector is high (CVSS: 3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H) and the attack complexity is low. It is scored as 10.0 due to the potential impact of data being stolen, modified, or deleted.", "Related MITRE ATT&CK Techniques": "T1190: Exploitation of remote services and T1059: Software component discovery.", "Technical Details": "The vulnerability is caused by the use of the `preferQueryMode=simple` connection property in combination with application code that negates a parameter value.", "Detection": "Detection involves monitoring database queries, implementing logging and auditing mechanisms, and monitoring for unusual database activity.", "Mitigation": "Mitigation involves implementing input validation and sanitization, using default query mode, and not utilizing the `preferQueryMode=simple` connection property.", "Conclusion": "The CVE-2024-32888 vulnerability is a significant vulnerability that allows remote code execution on a database. It is essential to implement mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "An overview of the CVE-2024-32888 vulnerability and its potential impact.", "Business Impact": "The business impact is high, as it allows an attacker to steal, modify, or delete sensitive data.", "Technical Impact": "The technical impact is high, as it allows an attacker to inject and execute malicious SQL code on a database.", "Mitigation Strategies": "Implement input validation and sanitization, use default query mode, and avoid utilizing the `preferQueryMode=simple` connection property.", "Recommendations": "Recommendations include implementing robust security policies, conducting regular security audits, and educating employees on security best practices.", "Conclusions": "The CVE-2024-32888 vulnerability is a significant vulnerability that requires immediate attention and mitigation strategies."}}