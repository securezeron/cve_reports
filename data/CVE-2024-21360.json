{"id": "CVE-2024-21360", "sourceIdentifier": "secure@microsoft.com", "published": "2024-02-13T18:15:52.887", "lastModified": "2024-05-29T00:15:27.987", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability"}, {"lang": "es", "value": "Proveedor Microsoft WDAC OLE DB para la vulnerabilidad de ejecuci\u00f3n remota de c\u00f3digo de SQL Server"}], "metrics": {"cvssMetricV31": [{"source": "secure@microsoft.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "secure@microsoft.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-122"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1507:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.10240.20469", "matchCriteriaId": "448534CE-1C07-4DF1-8EDD-C43C3492898B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1607:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.14393.6709", "matchCriteriaId": "2D282E53-ABBF-4832-9C93-A988586AE96E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_1809:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.17763.5458", "matchCriteriaId": "A1689DFD-D52D-4121-BFD7-DBF2BE4E7DE8"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_21h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.19044.4046", "matchCriteriaId": "C78776CC-3A9C-41A3-8BEB-D71D92F6579D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_10_22h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.19045.4046", "matchCriteriaId": "806CA6D2-42B2-4244-A5ED-D23E6DD56772"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_21h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22000.2777", "matchCriteriaId": "3F7F8173-9E59-48E4-98C9-4BEB6AE79451"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_22h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22621.3155", "matchCriteriaId": "84EDBE52-EFE0-4D6D-AA76-698B6F9687D1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_11_23h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.22631.3155", "matchCriteriaId": "900D1DA2-6DA7-4681-966A-B9973B1329EA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:-:sp2:*:*:*:*:*:*", "matchCriteriaId": "5F422A8C-2C4E-42C8-B420-E0728037E15C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:r2:*:*:*:*:*:*:*", "matchCriteriaId": "36559BC0-44D7-48B3-86FF-1BFF0257B5ED"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:-:*:*:*:*:*:*:*", "matchCriteriaId": "A7DF96F8-BA6A-4780-9CA3-F719B3F81074"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:r2:*:*:*:*:*:*:*", "matchCriteriaId": "DB18C4CE-5917-401E-ACF7-2747084FD36E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2016:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.14393.6709", "matchCriteriaId": "14F86494-7001-40DB-A99E-34A9490F5B58"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2019:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.17763.5458", "matchCriteriaId": "A9098F92-79E7-4762-A37C-99B4CFA8CDD1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.20348.2322", "matchCriteriaId": "5C8F0436-3AFE-48BD-AE92-8F8392DD0A1D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2022_23h2:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.25398.709", "matchCriteriaId": "B6FCF1A0-6B8E-457A-AB6A-2DE939B9D18B"}]}]}], "references": [{"url": "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-21360", "source": "secure@microsoft.com", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-21360 - Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability executes arbitrary code with elevated privileges, note that this is a high-impact vulnerability and organizations should plan to patch as soon as possible."}, {"techniqueID": "T1068", "comment": "CVE-2024-21360 - Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability exploits a vulnerability in the OLE DB provider for SQL Server, note that this is a high-impact vulnerability and organizations should plan to patch as soon as possible."}, {"techniqueID": "T1204", "comment": "CVE-2024-21360 - Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability compromises the confidentiality, integrity, and availability of sensitive data, note that this is a high-impact vulnerability and organizations should plan to patch as soon as possible."}], "stix_bundle": {"bundle": {"id": "bundle-cve-2024-21360", "type": "bundle", "created_by_ref": "user", "modified": "2024-05-29T00:15:27.987", "objects": [{"id": "vulnerability-cve-2024-21360", "type": "vulnerability", "name": "Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability", "description": "Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability", "exploitability": "Exploitable", "impact": "High", "risk_score": "8.8", "references": [{"id": "reference-1", "type": "reference", "name": "Microsoft Security Advisory", "url": "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-21360"}], "relationships": [{"id": "relationship-1", "type": "relationship", "relationship": "exploits", "object_refs": ["technique-T1190", "technique-T1068"]}]}, {"id": "technique-T1190", "type": "attack-pattern", "name": "Exploit Public-Facing Application", "description": "An adversary exploits a publicly-facing application, such as a web server, to gain access to the target environment", "mitre_attack_id": "T1190", "references": [{"id": "reference-1", "type": "reference", "name": "Mitre ATT&CK", "url": "https://attack.mitre.org/wiki/Technique/T1190"}]}, {"id": "technique-T1068", "type": "attack-pattern", "name": "Exploitation of Authentication Mechanism", "description": "An adversary exploits an authentication mechanism, such as an RDP or SSH connection, to gain access to the target environment", "mitre_attack_id": "T1068", "references": [{"id": "reference-1", "type": "reference", "name": "Mitre ATT&CK", "url": "https://attack.mitre.org/wiki/Technique/T1068"}]}]}}, "technical_analysis": {"Introduction": "The Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability allows an attacker to execute arbitrary code with elevated privileges, which can lead to a range of malicious activities.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8, indicating a high severity risk. It affects various versions of Windows Server, including Windows Server 2008, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, and Windows Server 2022.", "Related MITRE ATT&CK Techniques": "T1190, T1068, and T1204", "Technical Details": "The vulnerability can be exploited by sending a specially crafted OLE DB query to the affected SQL Server instance.", "Detection": "Detection of this vulnerability can be challenging, as there are no clear indicator(s) of compromise (IOCs). Therefore, detection methods should focus on monitoring for unusual activity, such as authentication failures or system crashes.", "Mitigation": "To mitigate this vulnerability, organizations should apply the available patch as soon as possible, disable the OLE DB provider for SQL Server, or use a firewall to block incoming connections to the affected SQL Server instance.", "Conclusion": "In conclusion, the Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability is a high-severity vulnerability that can have significant impact on an organization's security posture. Organizations should prioritize patching and monitoring for suspicious activity."}, "executive_analysis": {"Overview": "The Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability is a critical vulnerability that affects various versions of Windows Server.", "Business Impact": "The vulnerability can lead to a range of malicious activities, including data theft, privilege escalation, and system compromise.", "Technical Impact": "The vulnerability can be exploited by an attacker to execute arbitrary code with elevated privileges, which can have significant technical impact on the organization.", "Mitigation Strategies": "To mitigate this vulnerability, organizations should prioritize patching, disable the OLE DB provider for SQL Server, or use a firewall to block incoming connections to the affected SQL Server instance.", "Recommendations": "Executive management should prioritise patching as soon as possible, and ensure that the organization's monitoring and detection capabilities are in place to detect and respond to any potential exploitation of this vulnerability.", "Conclusions": "In conclusion, the Microsoft WDAC OLE DB provider for SQL Server Remote Code Execution Vulnerability is a critical vulnerability that requires immediate attention from executive management."}}