{"id": "CVE-2007-4610", "sourceIdentifier": "cve@mitre.org", "published": "2007-08-31T00:17:00.000", "lastModified": "2018-10-15T21:36:41.903", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Unrestricted file upload vulnerability in config/upload.php in Moonware (aka Dale Mooney Gallery) allows remote attackers to upload and execute arbitrary PHP files in images/, possibly related to config/admin.php."}, {"lang": "es", "value": "Vulnerabilidad en el subida de un fichero sin restricciones en el config/upload.php del Moonware (tambi\u00e9n conocido como Dale Mooney Gallery) permite a atacantes remotos la subir y ejecutar c\u00f3digo PHP de su elecci\u00f3n en images/, posiblemente relacionado con el config/admin.php."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:dale_mooney:moon_gallery:*:*:*:*:*:*:*:*", "matchCriteriaId": "1FB23005-D50E-4F4D-9218-541B5953485C"}]}]}], "references": [{"url": "http://secunia.com/advisories/26633", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://securityreason.com/securityalert/3079", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/477851/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/25455", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/36288", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059.001", "comment": "CVE-2007-4610 - attackers can upload and execute arbitrary PHP files. This is a classic example of file inclusion vulnerability that allows attackers to include and execute PHP files."}, {"techniqueID": "T1190", "comment": "CVE-2007-4610 - The unauthenticated file upload vulnerability in Moonware (aka Dale Mooney Gallery) allows attackers to upload and execute arbitrary PHP files."}], "stix_bundle": [{"type": "attack-pattern", "id": "b45f45b1-4437-41e5-a47c-c73fce4fcf35", "name": "Unauthenticated File Upload Vulnerability in Moonware", "description": "An unauthenticated file upload vulnerability exists in Moonware (aka Dale Mooney Gallery) that allows attackers to upload and execute arbitrary PHP files.", "kill_chain_phases": {"initial-access": [{"kill_chain_name": "mitre-attack", "kill_chain_phase": "initial-access", "kill_chain_phase_id": "T1059.001"}]}}, {"type": "intrusion-set", "id": "27a9a51c-4212-4e72-bf7a-94f8a95c04dd", "name": "Arbitrary PHP File Execution", "description": "Arbitrary PHP file execution through file inclusion attacks."}, {"type": " malware", "id": "63a6c6a8-49f6-4f5a-b53a-6bf5dc1421a9", "name": "PHP Shell", "description": "A PHP shell that can be used to execute arbitrary PHP commands and scripts."}, {"type": "indicator", "id": "d85e51c9-4a7e-48b8-85a0-6c54e1421a9", "name": "Arbitrary PHP File Upload", "description": "The presence of arbitrary PHP files uploaded through the file inclusion vulnerability in Moonware (aka Dale Mooney Gallery)."}, {"type": "course-of-action", "id": "0d05373a-4f4b-4c89-a8df-5e4d6f9f2f81", "name": "Block File Uploads", "description": "Block file uploads in Moonware (aka Dale Mooney Gallery) to prevent arbitrary PHP file execution."}, {"type": "course-of-action", "id": "f24c5f4f-471a-4b9f-bff4-9f94171f9f5b", "name": "Validate User Input", "description": "Validate user input data to prevent malicious file inclusion attacks in Moonware (aka Dale Mooney Gallery)."}, {"type": "note", "id": "d2b7d4e6-4861-41c8-a95c-7e6a45271b77", "name": "Defense", "description": "Implement file upload validation, restrict file types, and scan for suspicious PHP files."}], "technical_analysis": {"Introduction": "The unauthenticated file upload vulnerability in Moonware (aka Dale Mooney Gallery) allows attackers to upload and execute arbitrary PHP files.", "Impact and Scope": "CVSS Score: 6.8 (CVSS 2.0), Attack Vector: NETWORK, Attack Complexity: MEDIUM, Authentication: NONE, Confidentiality Impact: PARTIAL, Integrity Impact: PARTIAL, Availability Impact: PARTIAL.", "Related MITRE ATT&CK Techniques": "T1059.001, T1190", "Technical Details": "The vulnerability exists in the config/upload.php file in Moonware (aka Dale Mooney Gallery), which allows attackers to upload and execute arbitrary PHP files.", "Detection": "Detect file uploads to the images/ directory, and monitor for suspicious PHP file executions.", "Mitigation": "Block file uploads, validate user input data, restrict file types, and scan for suspicious PHP files.", "Conclusion": "To mitigate the vulnerability, implement file upload validation, restrict file types, and scan for suspicious PHP files."}, "executive_analysis": {"Overview": "The unauthenticated file upload vulnerability in Moonware (aka Dale Mooney Gallery) allows attackers to upload and execute arbitrary PHP files.", "Business Impact": "The vulnerability can allow attackers to execute arbitrary PHP code, leading to unauthorized access, data tampering, and system compromise.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary PHP code, which can lead to unauthorized access, data tampering, and system compromise.", "Mitigation Strategies": "Implement file upload validation, restrict file types, and scan for suspicious PHP files.", "Recommendations": "Recommend upgrading Moonware (aka Dale Mooney Gallery) to a patched version or disabling file uploads.", "Conclusions": "To protect against this vulnerability, implement file upload validation, restrict file types, and scan for suspicious PHP files."}}