{"id": "CVE-2024-39315", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-02T20:15:06.110", "lastModified": "2024-07-03T12:53:24.977", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Pomerium is an identity and context-aware access proxy. Prior to version 0.26.1, the Pomerium user info page (at `/.pomerium`) unintentionally included serialized OAuth2 access and ID tokens from the logged-in user's session. These tokens are not intended to be exposed to end users. This issue may be more severe in the presence of a cross-site scripting vulnerability in an upstream application proxied through Pomerium. If an attacker could insert a malicious script onto a web page proxied through Pomerium, that script could access these tokens by making a request to the `/.pomerium` endpoint. Upstream applications that authenticate only the ID token may be vulnerable to user impersonation using a token obtained in this manner. Note that an OAuth2 access token or ID token by itself is not sufficient to hijack a user's Pomerium session. Upstream applications should not be vulnerable to user impersonation via these tokens provided the application verifies the Pomerium JWT for each request, the connection between Pomerium and the application is secured by mTLS, or the connection between Pomerium and the application is otherwise secured at the network layer. The issue is patched in Pomerium v0.26.1. No known workarounds are available."}, {"lang": "es", "value": "Pomerium es un proxy de acceso consciente de la identidad y el contexto. Antes de la versi\u00f3n 0.26.1, la p\u00e1gina de informaci\u00f3n del usuario de Pomerium (en `/.pomerium`) inclu\u00eda involuntariamente tokens de ID y acceso OAuth2 serializados de la sesi\u00f3n del usuario que hab\u00eda iniciado sesi\u00f3n. Estos tokens no est\u00e1n destinados a ser expuestos a los usuarios finales. Este problema puede ser m\u00e1s grave en presencia de una vulnerabilidad de cross-site scripting en una aplicaci\u00f3n ascendente enviada a trav\u00e9s de Pomerium. Si un atacante pudiera insertar un script malicioso en una p\u00e1gina web proxy a trav\u00e9s de Pomerium, ese script podr\u00eda acceder a estos tokens realizando una solicitud al endpoint `/.pomerium`. Las aplicaciones ascendentes que autentican solo el token de ID pueden ser vulnerables a la suplantaci\u00f3n del usuario utilizando un token obtenido de esta manera. Tenga en cuenta que un token de acceso OAuth2 o un token de identificaci\u00f3n por s\u00ed solo no es suficiente para secuestrar la sesi\u00f3n de Pomerium de un usuario. Las aplicaciones ascendentes no deben ser vulnerables a la suplantaci\u00f3n del usuario a trav\u00e9s de estos tokens, siempre que la aplicaci\u00f3n verifique el Pomerium JWT para cada solicitud, la conexi\u00f3n entre Pomerium y la aplicaci\u00f3n est\u00e9 protegida por mTLS, o la conexi\u00f3n entre Pomerium y la aplicaci\u00f3n est\u00e9 asegurada de otro modo en la capa de red. . El problema se solucion\u00f3 en Pomerium v0.26.1. No hay workarounds disponibles."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-201"}]}], "references": [{"url": "https://github.com/pomerium/pomerium/commit/4c7c4320afb2ced70ba19b46de1ac4383f3daa48", "source": "security-advisories@github.com"}, {"url": "https://github.com/pomerium/pomerium/security/advisories/GHSA-rrqr-7w59-637v", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1568", "comment": "CVE-2024-39315 - The vulnerability allows an attacker to access and exfiltrate sensitive user data, which could be used to facilitate further attacks. To defend against this, implement proper access controls and monitor user activity."}, {"techniqueID": "T1190", "comment": "CVE-2024-39315 - The vulnerability could be used to access and manipulate user data, which could be used to launch further attacks. To defend against this, monitor user activity and implement proper data protection measures."}, {"techniqueID": "T1046", "comment": "CVE-2024-39315 - The vulnerability could be used to gain unauthorized access to user data, which could be used to facilitate further attacks. To defend against this, implement proper access controls and monitor user activity."}], "stix_bundle": {"$id": "CVE-2024-39315", "$schema": "https://docs.oasis-open.org/cti/stix/v2.1/stix-core.json", "type": "bundle", "id": "bundled_cve_poms_2.1", "created": "2024-07-02T20:15:06.110", "modified": "2024-07-03T12:53:24.977", "objects": [{"type": "vulnerability", "id": "vuln-CVE-2024-39315", "created": "2024-07-02T20:15:06.110", "modified": "2024-07-03T12:53:24.977", "name": "Pomerium: Authentication Bypass via User Info Page", "description": "Pomerium is an identity and context-aware access proxy. Prior to version 0.26.1, the Pomerium user info page (at `/.pomerium`) unintentionally included serialized OAuth2 access and ID tokens from the logged-in user's session.", "cve": {"id": "CVE-2024-39315"}, "severity": "MEDIUM", "base_score": 5.7, "base_severity": "MEDIUM"}, {"type": "technique", "id": "tech-T1568", "created": "2024-07-02T20:15:06.110", "modified": "2024-07-03T12:53:24.977", "name": "Cross-Site Scripting (XSS)", "description": "An attacker injects client-side script into a web page viewed by another user, potentially allowing for the execution of malicious code.", "mitre": {"id": "T1568"}, "vulnerabilities": [{"id": "vuln-CVE-2024-39315"}]}, {"type": "course-of-action", "id": "coa-CVE-2024-39315-1", "created": "2024-07-02T20:15:06.110", "modified": "2024-07-03T12:53:24.977", "name": "Implement proper access controls", "description": "Implement proper access controls to prevent unauthorized access to sensitive user data.", "techniques": [{"id": "tech-T1568"}]}], "relationships": [{"type": "indicated-by", "relationship_id": "rel-ref-1", "object_ref": "vuln-CVE-2024-39315", "object": "tech-T1568"}]}, "technical_analysis": {"Introduction": "The vulnerability CVE-2024-39315 is a medium-severity vulnerability in the Pomerium identity and context-aware access proxy.", "Impact and Scope": "The vulnerability allows an attacker to access and exfiltrate sensitive user data, which could be used to facilitate further attacks. The attack vector is network-based, and the complexity is low.", "Related MITRE ATT&CK Techniques": "The vulnerabilities exploit the following MITRE ATT&CK techniques: T1568, T1190, and T1046.", "Technical Details": "The vulnerability was patched in Pomerium v0.26.1. No known workarounds are available.", "Detection": "Detection methods include monitoring user activity and implementing proper access controls.", "Mitigation": "Mitigation strategies include implementing proper access controls, monitoring user activity, and protecting data.", "Conclusion": "In conclusion, the vulnerability CVE-2024-39315 is a significant threat to the security of user data. It is essential to implement proper access controls and monitor user activity to defend against this vulnerability."}, "executive_analysis": {"Overview": "The vulnerability CVE-2024-39315 is a medium-severity vulnerability in the Pomerium identity and context-aware access proxy.", "Business Impact": "The vulnerability could allow an attacker to access and exfiltrate sensitive user data, which could be used to facilitate further attacks. This could have significant business implications, including reputational damage and financial loss.", "Technical Impact": "The technical impact of the vulnerability includes the potential for unauthorized access to sensitive user data, which could be used to launch further attacks.", "Mitigation Strategies": "Mitigation strategies include implementing proper access controls, monitoring user activity, and protecting data.", "Recommendations": "Recommendations include conducting regular security audits, implementing proper access controls, and monitoring user activity.", "Conclusions": "In conclusion, the vulnerability CVE-2024-39315 is a significant threat to the security of user data. It is essential to implement proper access controls and monitor user activity to defend against this vulnerability."}}