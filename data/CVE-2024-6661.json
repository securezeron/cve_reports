{"id": "CVE-2024-6661", "sourceIdentifier": "security@wordfence.com", "published": "2024-07-27T02:15:12.780", "lastModified": "2024-07-29T14:12:08.783", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The ParityPress \u2013 Parity Pricing with Discount Rules plugin for WordPress is vulnerable to Stored Cross-Site Scripting via  'Discount Text' in all versions up to, and including, 1.0.0 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with administrator-level permissions and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page. This only affects multi-site installations and installations where unfiltered_html has been disabled."}, {"lang": "es", "value": " El complemento ParityPress \u2013 Parity Pricing with Discount Rules para WordPress es vulnerable a Cross Site Scripting almacenado a trav\u00e9s de 'Discount Text' en todas las versiones hasta la 1.0.0 incluida debido a una sanitizaci\u00f3n de entrada y un escape de salida insuficientes. Esto hace posible que atacantes autenticados, con permisos de nivel de administrador y superiores, inyecten scripts web arbitrarios en p\u00e1ginas que se ejecutar\u00e1n cada vez que un usuario acceda a una p\u00e1gina inyectada. Esto solo afecta a las instalaciones multisitio y a las instalaciones en las que se ha deshabilitado unfiltered_html."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}]}, "weaknesses": [{"source": "security@wordfence.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "references": [{"url": "https://plugins.trac.wordpress.org/browser/paritypress/trunk/app/Hooks/Activator.php#L22", "source": "security@wordfence.com"}, {"url": "https://wordpress.org/plugins/paritypress/#developers", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/f015ff9b-a7dc-47de-83d4-d6b91ec433f7?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1059.005", "comment": "CVE-2024-6661 - This technique ID is related to Stored Cross-Site Scripting (XSS), which is used to inject malicious script in the system, allowing attackers to execute arbitrary code. Defending against this vulnerability requires input validation and sanitization to prevent injected script from executing."}, {"techniqueID": "T1190", "comment": "CVE-2024-6661 - This technique ID is related to Cross-Site Scripting (XSS), which is used to inject malicious script in the system, allowing attackers to execute arbitrary code. Defending against this vulnerability requires input validation and sanitization to prevent injected script from executing."}, {"techniqueID": "T1040", "comment": "CVE-2024-6661 - This technique ID is related to Web Shell, which is used to gain access to the system, execute commands, and steal sensitive data. Defending against this vulnerability requires patching the vulnerability and implementing security controls such as Web Application Firewalls (WAFs) and Content Security Policy (CSP)."}], "stix_bundle": {"type": "bundle", "objects": [{"type": "indicator", "id": "indicator--1644f1f8-d1a7-4657-8e1b-cc0f8f1b16b7", "created_by_ref": "identity--1ef5f2af-77a8-48c6-b45a-8b19a24d7e45", "name": "ParityPress \u2013 Parity Pricing with Discount Rules plugin Stored Cross-Site Scripting", "description": "The ParityPress \u2013 Parity Pricing with Discount Rules plugin for WordPress is vulnerable to Stored Cross-Site Scripting via 'Discount Text' in all versions up to, and including, 1.0.0 due to insufficient input sanitization and output escaping.", "first_seen": "2024-07-27T02:15:12.780", "last_seen": "2024-07-29T14:12:08.783", "identity_REF": "identity--1ef5f2af-77a8-48c6-b45a-8b19a24d7e45", "label": "Stored Cross-Site Scripting", "created_at": "2024-07-27T02:15:12.780"}, {"type": "course_of_action", "id": "course_of_action--bc3f4d50-4159-4587-8a3f-5e8be4c5a1a0", "created_by_ref": "identity--1ef5f2af-77a8-48c6-b45a-8b19a24d7e45", "name": "Update to a fixed version of the plugin", "description": "Update to a fixed version of the plugin to patch the vulnerability.", "status": "recommended", "based_on_ref": ["technique--t1059.005", "technique--t1190"], "created_at": "2024-07-27T02:15:12.780"}], "relationships": [{"source_ref": "indicator--1644f1f8-d1a7-4657-8e1b-cc0f8f1b16b7", "type": "indicates", "target_ref": "course_of_action--bc3f4d50-4159-4587-8a3f-5e8be4c5a1a0"}]}, "technical_analysis": {"Introduction": "The ParityPress \u2013 Parity Pricing with Discount Rules plugin for WordPress is vulnerable to Stored Cross-Site Scripting (XSS) due to insufficient input sanitization and output escaping.", "Impact and Scope": "The vulnerability affects multi-site installations and installations where unfiltered_html has been disabled.", "Related MITRE ATT&CK Techniques": "T1059.005, T1190", "Technical Details": "The vulnerability exists due to the plugin's failure to sanitize and escape user input in the 'Discount Text' field.", "Detection": "Detection may involve analyzing web server logs for suspicious script injection activity.", "Mitigation": "Patching the vulnerability by updating to a fixed version of the plugin is the recommended mitigation strategy.", "Conclusion": "The ParityPress \u2013 Parity Pricing with Discount Rules plugin Stored Cross-Site Scripting vulnerability presents a significant risk to affected systems, and prompt action is recommended to patch and remediate the vulnerability."}, "executive_analysis": {"Overview": "The ParityPress \u2013 Parity Pricing with Discount Rules plugin for WordPress is vulnerable to Stored Cross-Site Scripting (XSS), which poses a significant risk to affected systems.", "Business Impact": "The vulnerability could allow attackers to inject malicious script in the system, potentially leading to data theft, account compromise, and other serious security risks.", "Technical Impact": "The vulnerability affects multi-site installations and installations where unfiltered_html has been disabled.", "Mitigation Strategies": "Patching the vulnerability by updating to a fixed version of the plugin is the recommended mitigation strategy.", "Recommendations": "Apply the patch as soon as possible, and conduct regular security scans and vulnerability assessments to ensure the system remains secure.", "Conclusions": "Prompt action is recommended to patch and remediate the vulnerability, and affected organizations should prioritize addressing this issue to avoid potential security risks."}}