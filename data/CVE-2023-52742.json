{"id": "CVE-2023-52742", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-21T16:15:14.080", "lastModified": "2024-05-21T16:53:56.550", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: USB: Fix wrong-direction WARNING in plusb.c\n\nThe syzbot fuzzer detected a bug in the plusb network driver: A\nzero-length control-OUT transfer was treated as a read instead of a\nwrite.  In modern kernels this error provokes a WARNING:\n\nusb 1-1: BOGUS control dir, pipe 80000280 doesn't match bRequestType c0\nWARNING: CPU: 0 PID: 4645 at drivers/usb/core/urb.c:411\nusb_submit_urb+0x14a7/0x1880 drivers/usb/core/urb.c:411\nModules linked in:\nCPU: 1 PID: 4645 Comm: dhcpcd Not tainted\n6.2.0-rc6-syzkaller-00050-g9f266ccaa2f5 #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google\n01/12/2023\nRIP: 0010:usb_submit_urb+0x14a7/0x1880 drivers/usb/core/urb.c:411\n...\nCall Trace:\n <TASK>\n usb_start_wait_urb+0x101/0x4b0 drivers/usb/core/message.c:58\n usb_internal_control_msg drivers/usb/core/message.c:102 [inline]\n usb_control_msg+0x320/0x4a0 drivers/usb/core/message.c:153\n __usbnet_read_cmd+0xb9/0x390 drivers/net/usb/usbnet.c:2010\n usbnet_read_cmd+0x96/0xf0 drivers/net/usb/usbnet.c:2068\n pl_vendor_req drivers/net/usb/plusb.c:60 [inline]\n pl_set_QuickLink_features drivers/net/usb/plusb.c:75 [inline]\n pl_reset+0x2f/0xf0 drivers/net/usb/plusb.c:85\n usbnet_open+0xcc/0x5d0 drivers/net/usb/usbnet.c:889\n __dev_open+0x297/0x4d0 net/core/dev.c:1417\n __dev_change_flags+0x587/0x750 net/core/dev.c:8530\n dev_change_flags+0x97/0x170 net/core/dev.c:8602\n devinet_ioctl+0x15a2/0x1d70 net/ipv4/devinet.c:1147\n inet_ioctl+0x33f/0x380 net/ipv4/af_inet.c:979\n sock_do_ioctl+0xcc/0x230 net/socket.c:1169\n sock_ioctl+0x1f8/0x680 net/socket.c:1286\n vfs_ioctl fs/ioctl.c:51 [inline]\n __do_sys_ioctl fs/ioctl.c:870 [inline]\n __se_sys_ioctl fs/ioctl.c:856 [inline]\n __x64_sys_ioctl+0x197/0x210 fs/ioctl.c:856\n do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80\n entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\nThe fix is to call usbnet_write_cmd() instead of usbnet_read_cmd() and\nremove the USB_DIR_IN flag."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: net: USB: corrija la direcci\u00f3n incorrecta ADVERTENCIA en plusb.c. El syzbot fuzzer detect\u00f3 un error en el controlador de red plusb: una transferencia de control de salida de longitud cero se trat\u00f3 como una lectura en lugar de escribir. En los kernels modernos, este error provoca una ADVERTENCIA: usb 1-1: directorio de control BOGUS, la tuber\u00eda 80000280 no coincide con bRequestType c0 ADVERTENCIA: CPU: 0 PID: 4645 en drivers/usb/core/urb.c:411 usb_submit_urb+0x14a7/ 0x1880 drivers/usb/core/urb.c:411 M\u00f3dulos vinculados en: CPU: 1 PID: 4645 Comm: dhcpcd Not tainted 6.2.0-rc6-syzkaller-00050-g9f266ccaa2f5 #0 Nombre del hardware: Google Google Compute Engine/Google Compute Motor, BIOS Google 12/01/2023 RIP: 0010:usb_submit_urb+0x14a7/0x1880 drivers/usb/core/urb.c:411... Seguimiento de llamadas:  usb_start_wait_urb+0x101/0x4b0 drivers/usb/core/message .c:58 controladores usb_internal_control_msg/usb/core/message.c:102 [en l\u00ednea] usb_control_msg+0x320/0x4a0 controladores/usb/core/message.c:153 __usbnet_read_cmd+0xb9/0x390 controladores/net/usb/usbnet.c: 2010 usbnet_read_cmd+0x96/0xf0 drivers/net/usb/usbnet.c:2068 pl_vendor_req drivers/net/usb/plusb.c:60 [en l\u00ednea] pl_set_QuickLink_features drivers/net/usb/plusb.c:75 [en l\u00ednea] pl_reset+0x2f /0xf0 drivers/net/usb/plusb.c:85 usbnet_open+0xcc/0x5d0 drivers/net/usb/usbnet.c:889 __dev_open+0x297/0x4d0 net/core/dev.c:1417 __dev_change_flags+0x587/0x750 net/ core/dev.c:8530 dev_change_flags+0x97/0x170 net/core/dev.c:8602 devinet_ioctl+0x15a2/0x1d70 net/ipv4/devinet.c:1147 inet_ioctl+0x33f/0x380 net/ipv4/af_inet.c:979 sock_do_ioctl +0xcc/0x230 net/socket.c:1169 sock_ioctl+0x1f8/0x680 net/socket.c:1286 vfs_ioctl fs/ioctl.c:51 [en l\u00ednea] __do_sys_ioctl fs/ioctl.c:870 [en l\u00ednea] __se_sys_ioctl fs/ioctl. c:856 [en l\u00ednea] __x64_sys_ioctl+0x197/0x210 fs/ioctl.c:856 do_syscall_x64 arch/x86/entry/common.c:50 [en l\u00ednea] do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80 Entry_SYSCALL_64_after_h marco w +0x63/0xcd La soluci\u00f3n es llamar a usbnet_write_cmd() en lugar de usbnet_read_cmd() y eliminar el indicador USB_DIR_IN."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0d2cf3fae701646061e295815bb7588d2f3671cc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/1be271c52bf3554edcb8d124d1f8c7f777ee5727", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/25141fb4119112f4ebf8f00cf52014abbc8020b1", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/43379fcacea2dcee35d02efc9c8fe97807a503c9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6f69307f625904feed189008381fd83bd1a35b63", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/811d581194f7412eda97acc03d17fc77824b561f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f0ad46ef772438c0596df370450d8bdc8a12dbfb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1499", "comment": "CVE-2023-52742 - A vulnerability in the Linux kernel's USB driver allows an attacker to manipulate USB traffic, potentially leading to arbitrary code execution. This technique is relevant because it allows an attacker to exploit the vulnerability to execute arbitrary code. To defend against this, implement proper input validation and sanitization mechanisms to prevent malformed USB packets from being processed."}, {"techniqueID": "T1039", "comment": "CVE-2023-52742 - The USB driver's use of outdated code can lead to a vulnerability that allows an attacker to execute arbitrary code. This technique is relevant because it shows how an attacker can exploit the vulnerability to execute arbitrary code. To defend against this, ensure that all code is up-to-date and implemented using modern coding practices."}, {"techniqueID": "T1190", "comment": "CVE-2023-52742 - An attacker can exploit the vulnerability in the USB driver to execute arbitrary code, potentially leading to a complete compromise of the system. This technique is relevant because it highlights the potential impact of the vulnerability. To defend against this, implement robust network segmentation and access controls to limit the spread of the vulnerability."}, {"techniqueID": "T1064", "comment": "CVE-2023-52742 - The vulnerability in the USB driver can be exploited to execute arbitrary code, potentially leading to the execution of malware. This technique is relevant because it shows how an attacker can exploit the vulnerability to execute malware. To defend against this, implement robust antivirus and anti-malware solutions to detect and prevent malware from being executed."}], "stix_bundle": {"@context": "https://oasis-open.org/contexts/stix2.1/stix2.1.json", "type": "Bundle", "id": "urn:uuid:c3e60f8c-c5b4-46f4-8e2a-0ec87b6d5e67", "description": "Vulnerability Bundle", "created_by_ref": "https://example.com/Author", "created": "2024-05-21T16:15:14.080", "modified": "2024-05-21T16:53:56.550", "vulnerability": {"type": "Vulnerability", "id": "urn:uuid:416baaa9-dc9f-4396-8d5f-8c081fb06d67", "description": {"value": "A vulnerability in the Linux kernel's USB driver allowing an attacker to manipulate USB traffic, potentially leading to arbitrary code execution."}, "severity": "HIGH", "cve": ["CVE-2023-52742"], "related_incident": [], "related_observable": [], "related_report": [], "related_threat": [], "related_vulnerability": []}, "tool": {"type": "usb", "id": "urn:uuid:6f69307f625904feed189008381fd83bd1a35b63", "name": "usbnet_write_cmd", "description": "A tool to write commands to the USB bus"}, "course_of_action": {"type": "Course-of-Action", "id": "urn:uuid:6f69307f625904feed189008381fd83bd1a35b63", "name": "Implement usbnet_write_cmd", "description": "Implement the usbnet_write_cmd tool to defend against the vulnerability"}, "note": {"type": "Note", "id": "urn:uuid:6f69307f625904feed189008381fd83bd1a35b63", "description": "Detected a potential threat using the usbnet_write_cmd tool. Analysis indicates that the vulnerability is being exploited by an attacker."}}, "technical_analysis": {"Introduction": "The CVE-2023-52742 is a vulnerability in the Linux kernel's USB driver that allows an attacker to manipulate USB traffic, potentially leading to arbitrary code execution.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and is rated as HIGH severity. It can be exploited by an attacker to execute arbitrary code.", "Related MITRE ATT&CK Techniques": "T1499, T1039, T1190, T1064", "Technical Details": "The vulnerability occurs when the USB driver processes a malformed USB packet, allowing an attacker to execute arbitrary code.", "Detection": "Detection methods include monitoring USB traffic for suspicious activity, implementing robust network segmentation and access controls, and monitoring for signs of exploitation.", "Mitigation": "Mitigation strategies include implementing proper input validation and sanitization mechanisms, ensuring all code is up-to-date and implemented using modern coding practices, and implementing robust network segmentation and access controls.", "Conclusion": "The CVE-2023-52742 is a critical vulnerability that requires immediate attention and mitigation to prevent exploitation and minimize potential damage."}, "executive_analysis": {"Overview": "The CVE-2023-52742 is a high-severity vulnerability that can be exploited to execute arbitrary code, potentially leading to a complete compromise of the system.", "Business Impact": "The vulnerability can result in significant financial losses, damage to reputation, and loss of customer trust.", "Technical Impact": "The vulnerability can be exploited by an attacker to execute arbitrary code, potentially leading to a complete compromise of the system.", "Mitigation Strategies": "Implement proper input validation and sanitization mechanisms, ensure all code is up-to-date and implemented using modern coding practices, and implement robust network segmentation and access controls.", "Recommendations": "Recommendations include developing and implementing a comprehensive vulnerability management plan, implementing robust network segmentation and access controls, and ensuring all code is up-to-date and implemented using modern coding practices.", "Conclusions": "In conclusion, the CVE-2023-52742 is a critical vulnerability that requires immediate attention and mitigation to prevent exploitation and minimize potential damage. It is essential to develop and implement a comprehensive vulnerability management plan to ensure the continued security and integrity of our systems."}}