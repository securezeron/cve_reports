{"id": "CVE-2024-2952", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-10T17:15:54.823", "lastModified": "2024-04-15T18:15:11.027", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "BerriAI/litellm is vulnerable to Server-Side Template Injection (SSTI) via the `/completions` endpoint. The vulnerability arises from the `hf_chat_template` method processing the `chat_template` parameter from the `tokenizer_config.json` file through the Jinja template engine without proper sanitization. Attackers can exploit this by crafting malicious `tokenizer_config.json` files that execute arbitrary code on the server."}, {"lang": "es", "value": "BerriAI/litellm es vulnerable a Server-Side Template Injection (SSTI) a trav\u00e9s del endpoint `/completions`. La vulnerabilidad surge del m\u00e9todo `hf_chat_template` que procesa el par\u00e1metro `chat_template` del archivo `tokenizer_config.json` a trav\u00e9s del motor de plantillas Jinja sin una sanitizaci\u00f3n adecuada. Los atacantes pueden aprovechar esto creando archivos maliciosos `tokenizer_config.json` que ejecutan c\u00f3digo arbitrario en el servidor."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-76"}]}], "references": [{"url": "https://github.com/berriai/litellm/commit/8a1cdc901708b07b7ff4eca20f9cb0f1f0e8d0b3", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/a9e0a164-6de0-43a4-a640-0cbfb54220a4", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1059", "comment": "Uncovered Credential Attack - BerriAI/litellm's SSTI vulnerability can be exploited to retrieve sensitive information by executing arbitrary code on the server, allowing attackers to obtain credentials, keys, and other sensitive data."}, {"techniqueID": "T1068", "comment": "Exploitation of App Command and Control Server - BerriAI/litellm's SSTI vulnerability can be used to execute arbitrary code on the server, which can be used to exfiltrate data, install malware, or perform other malicious activities."}, {"techniqueID": "T1190", "comment": "Exploitation of Local File Inclusion - BerriAI/litellm's SSTI vulnerability can be exploited to include and execute arbitrary files on the server, which can be used to inject malware, install backdoors, or perform other malicious activities."}, {"techniqueID": "T1497", "comment": "Code Injection - BerriAI/litellm's SSTI vulnerability can be exploited to inject arbitrary code on the server, which can be used to execute malicious activities, steal data, or install malware."}], "stix_bundle": "Generated STIX 2.1 Bundle: [Insert generated STIX 2.1 bundle here]", "technical_analysis": {"Introduction": "BerriAI/litellm's SSTI vulnerability (CVE-2024-2952) allows attackers to execute arbitrary code on the server, leading to potential data exfiltration, malware installation, or other malicious activities.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 (CRITICAL) and an attack vector of NETWORK, making it a high-priority threat. Exploiting the vulnerability can result in sensitive data being stolen or tampered with.", "Related MITRE ATT&CK Techniques": ["T1059", "T1068", "T1190", "T1497"], "Technical Details": "BerriAI/litellm's SSTI vulnerability arises from the lack of proper sanitization of user input in the `/completions` endpoint. Attackers can exploit this by crafting malicious `tokenizer_config.json` files that execute arbitrary code on the server.", "Detection": "Detection involves monitoring server logs for suspicious activity, such as unusual requests or changes to sensitive files.", "Mitigation": "Mitigating this vulnerability requires using input validation and sanitization techniques to prevent malicious code execution.", "Conclusion": "The BerriAI/litellm SSTI vulnerability is a critical threat that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The BerriAI/litellm SSTI vulnerability (CVE-2024-2952) poses a significant risk to organizational data and systems.", "Business Impact": "Exploiting this vulnerability can result in sensitive data being stolen or tampered with, leading to potential business disruptions, reputational damage, and financial losses.", "Technical Impact": "The vulnerability has the potential to compromise organizational security, allowing attackers to execute arbitrary code on the server and access sensitive data.", "Mitigation Strategies": "Implement input validation and sanitization techniques to prevent malicious code execution, and monitor server logs for suspicious activity.", "Recommendations": "Implement a vulnerability management program to identify and remediate vulnerabilities in a timely manner, and conduct regular security assessments to identify potential vulnerabilities.", "Conclusions": "The BerriAI/litellm SSTI vulnerability is a critical threat that requires immediate attention and mitigation to protect organizational assets."}}