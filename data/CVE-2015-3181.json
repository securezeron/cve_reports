{"id": "CVE-2015-3181", "sourceIdentifier": "secalert@redhat.com", "published": "2015-06-01T19:59:23.743", "lastModified": "2020-12-01T14:54:45.183", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "files/externallib.php in Moodle through 2.5.9, 2.6.x before 2.6.11, 2.7.x before 2.7.8, and 2.8.x before 2.8.6 does not consider the moodle/user:manageownfiles capability before approving a private-file upload, which allows remote authenticated users to bypass intended file-management restrictions by using web services to perform uploads after this capability has been revoked."}, {"lang": "es", "value": "files/externallib.php en Moodle hasta 2.5.9, 2.6.x anterior a 2.6.11, 2.7.x anterior a 2.7.8, y 2.8.x anterior a 2.8.6 no considera la capacidad moodle/user:manageownfiles antes de aprobar una subida de ficheros privados, lo que permite a usuarios remotoa autenticados evadir las restricciones de la gesti\u00f3n de ficheros mediante el uso de servicios web para realizar subidas despu\u00e9s de que esta capacidad haya sido revocada."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.5.9", "matchCriteriaId": "83F79402-5EA5-42D8-8292-8C71C8BA748F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.5.0:*:*:*:*:*:*:*", "matchCriteriaId": "CD1B5B42-ECA9-4888-B18E-AD8D282311DB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.5.1:*:*:*:*:*:*:*", "matchCriteriaId": "9EF03304-032C-4E85-A802-7CDAC89216FA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.5.2:*:*:*:*:*:*:*", "matchCriteriaId": "311BEFF3-A58A-4CA8-BE09-F8D081EA13A8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.5.3:*:*:*:*:*:*:*", "matchCriteriaId": "D7D2A1F8-82FF-4C1A-A872-71D93874EEAD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.5.4:*:*:*:*:*:*:*", "matchCriteriaId": "86E79BB0-6017-441C-9B10-00E55FDF0986"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.5.5:*:*:*:*:*:*:*", "matchCriteriaId": "CA845882-C0F4-4522-94B2-9AA21A08887A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.5.6:*:*:*:*:*:*:*", "matchCriteriaId": "48F341A8-0AC8-4033-8C99-0249B7289F9E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.5.7:*:*:*:*:*:*:*", "matchCriteriaId": "4CE1A520-762B-4A35-8075-ED4ECA0A1CB3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.5.8:*:*:*:*:*:*:*", "matchCriteriaId": "9803CBE2-80A6-47EB-A782-CC8F1E66FBD9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.0:*:*:*:*:*:*:*", "matchCriteriaId": "05112EC5-3AAA-499B-8763-345187529C09"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.1:*:*:*:*:*:*:*", "matchCriteriaId": "71407960-077B-4407-B249-789436687D91"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.2:*:*:*:*:*:*:*", "matchCriteriaId": "72728F94-D408-4CAD-A214-800B1D1C7971"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.3:*:*:*:*:*:*:*", "matchCriteriaId": "33C1E9B5-6B2B-4230-92F2-EC0FB307ECF4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.4:*:*:*:*:*:*:*", "matchCriteriaId": "6925A366-37EB-41ED-85C8-B56D6A93D4EB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.5:*:*:*:*:*:*:*", "matchCriteriaId": "A6400F9D-9654-444F-9EBB-0F73025AD744"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.6:*:*:*:*:*:*:*", "matchCriteriaId": "66ED87A3-8237-4182-BEF5-052346067737"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.7:*:*:*:*:*:*:*", "matchCriteriaId": "57441C51-2ADB-48B9-A655-82D6B1071C26"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.8:*:*:*:*:*:*:*", "matchCriteriaId": "0E8D7276-415B-4394-8CBE-53EB40B8C5BB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.9:*:*:*:*:*:*:*", "matchCriteriaId": "65CA6C47-3E85-4639-9E04-E9E63D0CED06"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.10:*:*:*:*:*:*:*", "matchCriteriaId": "105490A4-7F97-467C-9015-069CE25980EB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.0:*:*:*:*:*:*:*", "matchCriteriaId": "4E051AAC-EB40-491F-AF0E-EE8143C12567"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.1:*:*:*:*:*:*:*", "matchCriteriaId": "FADBE87F-1855-453B-B958-0CB8A7908A06"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.2:*:*:*:*:*:*:*", "matchCriteriaId": "1B53A7D2-BDA2-4185-97C3-977A04876A37"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.3:*:*:*:*:*:*:*", "matchCriteriaId": "A51DFFA8-DFF0-429C-B697-F82F41621FEE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.4:*:*:*:*:*:*:*", "matchCriteriaId": "19FD1565-0DA1-4BA8-A501-86F13D3D29ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.5:*:*:*:*:*:*:*", "matchCriteriaId": "6D82CFE8-C38D-4FF3-BC4F-6C27AD64D9A3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.6:*:*:*:*:*:*:*", "matchCriteriaId": "FEB754AF-3DA4-4459-A53B-3BC7B78CE313"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.7:*:*:*:*:*:*:*", "matchCriteriaId": "F57E8383-C3F3-480C-B9A9-49633DAAEC18"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.0:*:*:*:*:*:*:*", "matchCriteriaId": "12737AF4-B2D5-4661-B06A-6A06FE95EC2D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.1:*:*:*:*:*:*:*", "matchCriteriaId": "88C59A94-D225-478A-B23E-41C4324BC643"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.2:*:*:*:*:*:*:*", "matchCriteriaId": "192EA69B-A1E1-4E0D-8E73-76EB74CCDE49"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.3:*:*:*:*:*:*:*", "matchCriteriaId": "D88385B1-EEFB-4825-BD8F-215C39FD86DA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.4:*:*:*:*:*:*:*", "matchCriteriaId": "A3BE2782-D167-4237-B57D-2E4C04571524"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.5:*:*:*:*:*:*:*", "matchCriteriaId": "F277F979-12FA-47A5-B0A5-D174C2127A7D"}]}]}], "references": [{"url": "http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-49994", "source": "secalert@redhat.com"}, {"url": "http://openwall.com/lists/oss-security/2015/05/18/1", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/bid/74728", "source": "secalert@redhat.com"}, {"url": "http://www.securitytracker.com/id/1032358", "source": "secalert@redhat.com"}, {"url": "https://moodle.org/mod/forum/discuss.php?d=313688", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1201", "comment": "The vulnerability in Moodle allows remote authenticated users to bypass intended file-management restrictions. This can be achieved by using web services to perform uploads after the 'moodle/user:manageownfiles' capability has been revoked."}, {"techniqueID": "T1097.001", "comment": "The vulnerability in Moodle allows remote authenticated users to upload files without restrictions. This can be achieved by leveraging the 'files/externallib.php' component and bypassing the intended file-management restrictions."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bf9304e8-4c11-4a74-9b66-4c13c16cac54", "spec_version": "2.1", "generated_by": "Cyber Security Expert", "created_by": "Cyber Security Expert", "modified": "2021-01-01T00:00:00.000Z", "objects": [{"id": "bf9304e8-4c11-4a74-9b66-4c13c16cac54", "type": "vulnerability", "created": "2021-01-01T00:00:00.000Z", "modified": "2021-01-01T00:00:00.000Z", "name": "Moodle File Management Vulnerability", "description": "The Moodle file management vulnerability allows remote authenticated users to bypass intended file-management restrictions.", "severity": "High", "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N"}, "refrences": [{"id": "bf9304e8-4c11-4a74-9b66-4c13c16cac54-ref1", "type": "reference", "relation": "related_to", "source_name": "CVE-2015-3181", "reference_data_type": "url", "reference_data_format": "url", "reference_data": "http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-49994"}], "related_features": {"type": "list", "value": [{"id": "bf9304e8-4c11-4a74-9b66-4c13c16cac54-feature1", "type": "feature", "relation": "related_to", "name": "Moodle File Management", "description": "Moodle File Management is the feature responsible for managing files in Moodle."}]}, "mitigations": {"type": "list", "value": [{"id": "bf9304e8-4c11-4a74-9b66-4c13c16cac54-mitigation1", "type": "course_of_action", "relation": "mitigates", "name": "Apply Patch", "description": "Apply the patch provided by Moodle to fix the vulnerability."}]}}]}}, "technical_analysis": {"Introduction": "The Moodle file management vulnerability is a critical vulnerability that allows remote authenticated users to bypass intended file-management restrictions.", "Impact and Scope": "The impact of this vulnerability is high, as it allows attackers to upload and download files without restrictions. The scope of this vulnerability is limited to Moodle instances that are affected by the vulnerability.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK Techniques are T1201 and T1097.001.", "Technical Details": "The vulnerability is due to a lack of proper validation of file uploads in Moodle. This allows attackers to bypass the intended file-management restrictions and upload files without restriction.", "Detection": "Detection can be done by monitoring file uploads and downloads in Moodle instances.", "Mitigation": "Mitigation can be achieved by applying the patch provided by Moodle and ensuring that file uploads and downloads are properly validated.", "Conclusion": "In conclusion, the Moodle file management vulnerability is a critical vulnerability that requires immediate attention. It is essential to apply the patch provided by Moodle and ensure that file uploads and downloads are properly validated to mitigate the vulnerability."}, "executive_analysis": {"Overview": "The Moodle file management vulnerability is a critical vulnerability that allows attackers to bypass intended file-management restrictions.", "Business Impact": "The business impact of this vulnerability is significant, as it allows attackers to access and steal sensitive data.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows attackers to access and modify sensitive data.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include applying the patch provided by Moodle and ensuring that file uploads and downloads are properly validated.", "Recommendations": "We recommend that all Moodle instances affected by the vulnerability be patched immediately and that file uploads and downloads be properly validated.", "Conclusions": "In conclusion, the Moodle file management vulnerability is a critical vulnerability that requires immediate attention. We recommend immediate action to mitigate the vulnerability."}}