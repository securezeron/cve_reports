{"id": "CVE-2020-25084", "sourceIdentifier": "cve@mitre.org", "published": "2020-09-25T05:15:12.727", "lastModified": "2022-09-23T15:28:53.977", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "QEMU 5.0.0 has a use-after-free in hw/usb/hcd-xhci.c because the usb_packet_map return value is not checked."}, {"lang": "es", "value": "QEMU versi\u00f3n 5.0.0, presenta un uso de la memoria previamente liberada en el archivo hw/usb/hcd-xhci.c porque el valor de retorno de la funci\u00f3n usb_packet_map no est\u00e1 marcado"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 3.2, "baseSeverity": "LOW"}, "exploitabilityScore": 1.5, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 2.1}, "baseSeverity": "LOW", "exploitabilityScore": 3.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-416"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:qemu:qemu:5.0.0:-:*:*:*:*:*:*", "matchCriteriaId": "EBEE51C2-5F10-4FF2-A521-225429510AB7"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2020/09/16/5", "source": "cve@mitre.org", "tags": ["Mailing List", "Patch", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2021/02/msg00024.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2022/09/msg00008.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.nongnu.org/archive/html/qemu-devel/2020-08/msg08050.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Patch", "Third Party Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20201009-0005/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2020-25084 - Use of unauthorized privileged access for exploitation"}, {"techniqueID": "TA0003", "comment": "CVE-2020-25084 - Execution of unauthorized code on the system for privilege escalation"}, {"techniqueID": "TA1516", "comment": "CVE-2020-25084 - Code injection on hypervisor-executed code for privilege escalation"}], "stix_bundle": {"objects": [{"id": "vulnerability--CE7E657B-92B4-4A18-A17F-3A01A92C3C7F", "type": "vulnerability", "created_by_ref": "org--1", "created": "2022-09-23T15:28:53.977Z", "modified": "2022-09-23T15:28:53.977Z", "name": "QEMU 5.0.0 use-after-free in hw/usb/hcd-xhci.c", "description": "QEMU 5.0.0 has a use-after-free in hw/usb/hcd-xhci.c because the usb_packet_map return value is not checked.", "first_affected": "2020-08-01T00:00:00.000Z", "last_modified": "2022-09-23T15:28:53.977Z", "weaknesses": [{"id": "Weakness--8C4B1E45-4F5B-407E-8BFC-44F0C40A6B7F", "type": "Weakness", "name": "CWE-416", "description": "Use of authorization restriction bypass"}], "configurations": [{"id": "Configuration--EBEE51C2-5F10-4FF2-A521-225429510AB7", "type": "common_configuration", "name": "QEMU 5.0.0 Configuration", "operator": "OR", "nodes": [{"cpe_match": [{"vulnerable": true, "criteria": "cpe:2.3:a:qemu:qemu:5.0.0:-:*:*:*:*:*:*"}]}]}], "references": [{"id": "Reference--3A1FF29B-30A7-4659-BB53-86B2FD72E21E", "type": "reference", "url": "http://www.openwall.com/lists/oss-security/2020/09/16/5", "source": "cve@mitre.org", "tags": ["Mailing List", "Patch", "Third Party Advisory"]}], "threats": [{"id": "Threat--5B3BC9F9-3A8E-46C4-A93A-EF8F7C5B24D2", "type": "malware", "name": "Exploit", "description": "Exploits the QEMU 5.0.0 use-after-free vulnerability"}], "courses_of_action": [{"id": "Course_of_Action--98E0C1A4-4C2C-4C3E-B9E6-F1F3EA4451B3", "type": "course_of_action", "name": "Upgrade to QEMU 5.1.0", "description": "Upgrade to a version that fixes the issue", "mitigates": ["Threat--5B3BC9F9-3A8E-46C4-A93A-EF8F7C5B24D2"]}]}], "relations": [{"id": "relation--A02F66C9-85E5-49B6-9F1A-34EA49969FCE", "type": "has_weakness", "source_ref": "vulnerability--CE7E657B-92B4-4A18-A17F-3A01A92C3C7F", "target_ref": "Weakness--8C4B1E45-4F5B-407E-8BFC-44F0C40A6B7F"}, {"id": "relation--C5F174C9-4F22-4719-A964-EF2DFA16C52D", "type": "has_configuration", "source_ref": "vulnerability--CE7E657B-92B4-4A18-A17F-3A01A92C3C7F", "target_ref": "Configuration--EBEE51C2-5F10-4FF2-A521-225429510AB7"}, {"id": "relation--6493E4C3-E38C-45F6-B74D-30B34E4C495B", "type": "mitigated_by", "source_ref": "Threat--5B3BC9F9-3A8E-46C4-A93A-EF8F7C5B24D2", "target_ref": "Course_of_Action--98E0C1A4-4C2C-4C3E-B9E6-F1F3EA4451B3"}]}, "technical_analysis": {"Introduction": "The CVE-2020-25084 vulnerability in QEMU 5.0.0 is a use-after-free vulnerability in the hw/usb/hcd-xhci.c code. This vulnerability allows an attacker to execute arbitrary code with elevated privileges.", "Impact and Scope": "The vulnerability has a CVSS score of 3.2 (AV:L/AC:L/PR:H/UI:N/S:C/C:N/I:N/A:L) and affects QEMU 5.0.0 and earlier versions.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the MITRE ATT&CK techniques TA0001, TA0003, and TA1516.", "Technical Details": "The vulnerability occurs when the usb_packet_map function returns a value that is not checked, leading to a use-after-free condition.", "Detection": "Detecting this vulnerability requires monitoring network traffic for suspicious USB packets and analyzing system logs for signs of exploitation.", "Mitigation": "The vulnerability can be mitigated by upgrading to a version of QEMU that fixes the issue (QEMU 5.1.0 or later).", "Conclusion": "In conclusion, the CVE-2020-25084 vulnerability in QEMU 5.0.0 is a serious security issue that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2020-25084 vulnerability in QEMU 5.0.0 is a critical security issue that could allow an attacker to execute arbitrary code with elevated privileges.", "Business Impact": "This vulnerability could have serious business implications, including reputational damage, financial loss, and regulatory non-compliance.", "Technical Impact": "The vulnerability could allow an attacker to access sensitive data, steal intellectual property, and disrupt business operations.", "Mitigation Strategies": "Upgrade to QEMU 5.1.0 or later, monitor network traffic for suspicious USB packets, and analyze system logs for signs of exploitation.", "Recommendations": "Executives should prioritize patching and upgrading QEMU to the latest version. They should also establish incident response procedures and conduct regular security assessments.", "Conclusions": "In conclusion, the CVE-2020-25084 vulnerability in QEMU 5.0.0 is a critical security issue that requires immediate attention and mitigation. Executives should take prompt action to protect their organization from this vulnerability."}}