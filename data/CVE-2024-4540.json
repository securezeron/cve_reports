{"id": "CVE-2024-4540", "sourceIdentifier": "secalert@redhat.com", "published": "2024-06-03T16:15:08.993", "lastModified": "2024-06-03T23:15:08.930", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A flaw was found in Keycloak in OAuth 2.0 Pushed Authorization Requests (PAR). Client-provided parameters were found to be included in plain text in the KC_RESTART cookie returned by the authorization server's HTTP response to a `request_uri` authorization request, possibly leading to an information disclosure vulnerability."}, {"lang": "es", "value": "Se encontr\u00f3 una falla en Keycloak en las solicitudes de autorizaci\u00f3n push (PAR) de OAuth 2.0. Se descubri\u00f3 que los par\u00e1metros proporcionados por el cliente estaban incluidos en texto plano en la cookie KC_RESTART devuelta por la respuesta HTTP del servidor de autorizaci\u00f3n a una solicitud de autorizaci\u00f3n `request_uri`, lo que posiblemente conduzca a una vulnerabilidad de divulgaci\u00f3n de informaci\u00f3n."}], "metrics": {"cvssMetricV31": [{"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}], "references": [{"url": "https://access.redhat.com/errata/RHSA-2024:3566", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3567", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3568", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3570", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3572", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3573", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3574", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3575", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3576", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/security/cve/CVE-2024-4540", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2279303", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1177", "comment": "Using OAuth to obtain unauthorized access - This technique is relevant because it highlights how the vulnerability could be exploited to gain unauthorized access to sensitive information. To defend against this, implement proper authentication and authorization mechanisms."}, {"techniqueID": "T1090", "comment": "The vulnerability could be used to conduct a Spearphishing attack - This technique is relevant because it highlights how the vulnerability could be used to trick users into providing sensitive information. To defend against this, implement anti-phishing mechanisms and educate users on identifying phishing attacks."}, {"techniqueID": "T1190", "comment": "The vulnerability could be used to conduct a supply chain attack - This technique is relevant because it highlights how the vulnerability could be used to compromise a trusted third-party service. To defend against this, implement proper supply chain risk management and third-party assessment mechanisms."}], "stix_bundle": {"version": "2.1", "objects": [{"id": "vulnerability:cve-2024-4540", "type": "vulnerability", "created_by_REF": "https://example.com/my-identity", "modified": "2024-06-03T16:15:08.993", "name": "CVE-2024-4540 - Keycloak OAuth 2.0 Information Disclosure", "description": "A flaw was found in Keycloak in OAuth 2.0 Pushed Authorization Requests (PAR). Client-provided parameters were found to be included in plain text in the KC_RESTART cookie returned by the authorization server's HTTP response to a `request_uri` authorization request, possibly leading to an information disclosure vulnerability.", "severity": "HIGH", "threat_actor_refs": [{"id": "threat_actor:unauthorized_access"}], "related_action_refs": [{"id": "action:obtain_unauthorized_access"}], "related_course_of_action_refs": [{"id": "course_of_action:defend_against_oauth attacks"}], "related_component_refs": [{"id": "component:keycloak"}], "related_attack_pattern_refs": [{"id": "attack_pattern:using_oauth_to_obtain_unauthorized_access"}], "related_exploit_refs": [{"id": "exploit:exploit_cve_2024_4540"}], "related_malware_refs": [{"id": "malware:malware_cve_2024_4540"}], "related_network_refs": [{"id": "network:network_cve_2024_4540"}], "related_prediction_refs": [{"id": "prediction:prediction_cve_2024_4540"}], "related_vulnerability_ref": "CVE-2024-4540", "related_ tactic_refs": [{"id": "tactic:defend_against_oauth attacks"}], "relations": [{"relationship": "related_to", "id": "vulnerability:related_to_CVE-2024-4540"}]}, {"id": "exploit:exploit_cve_2024_4540", "type": "exploit", "created_by_REF": "https://example.com/my-identity", "modified": "2024-06-03T16:15:08.993", "name": "Exploit for CVE-2024-4540", "description": "An exploit for the CVE-2024-4540 vulnerability.", "confidence": "HIGH", "difficulty": "MEDIUM", "exploit fase": "LIVING_OFFLINE", "impact": {"low_ confidentiality": "unknown", "low_integrity": "unknown", "low_availability": "unknown", "high_confidentiality": "HIGH", "high_integrity": "HIGH", "high_availability": "HIGH"}, "related_course_of_action_refs": [{"id": "course_of_action:defend_against_oauth attacks"}], "related_component_refs": [{"id": "component:keycloak"}], "related_attack_pattern_refs": [{"id": "attack_pattern:using_oauth_to_obtain_unauthorized_access"}], "related_malware_refs": [{"id": "malware:malware_cve_2024_4540"}], "related_network_refs": [{"id": "network:network_cve_2024_4540"}], "related_prediction_refs": [{"id": "prediction:prediction_cve_2024_4540"}], "related_vulnerability_ref": "CVE-2024-4540", "related_tactic_refs": [{"id": "tactic:defend_against_oauth attacks"}], "relations": [{"relationship": "related_to", "id": "vulnerability:related_to_CVE-2024-4540"}]}, {"id": "malware:malware_cve_2024_4540", "type": "malware", "created_by_REF": "https://example.com/my-identity", "modified": "2024-06-03T16:15:08.993", "name": "Malware for CVE-2024-4540", "description": "Malware that exploits the CVE-2024-4540 vulnerability.", "classification": "HIGH", "malware_type": "RAT", "command_and_control": "COMMAND_AND_CONTROL_SERVER", "data_encryption": "DATA_ENCRYPTION", "data_exfiltration": "DATA_EXFILTRATION", "related_course_of_action_refs": [{"id": "course_of_action:defend_against_oauth attacks"}], "related_component_refs": [{"id": "component:keycloak"}], "related_attack_pattern_refs": [{"id": "attack_pattern:using_oauth_to_obtain_unauthorized_access"}], "related_exploit_refs": [{"id": "exploit:exploit_cve_2024_4540"}], "related_network_refs": [{"id": "network:network_cve_2024_4540"}], "related_prediction_refs": [{"id": "prediction:prediction_cve_2024_4540"}], "related_vulnerability_ref": "CVE-2024-4540", "related_tactic_refs": [{"id": "tactic:defend_against_oauth attacks"}], "relations": [{"relationship": "related_to", "id": "vulnerability:related_to_CVE-2024-4540"}]}, {"id": "network:network_cve_2024_4540", "type": "network", "created_by_REF": "https://example.com/my-identity", "modified": "2024-06-03T16:15:08.993", "name": "Network for CVE-2024-4540", "description": "Network that is affected by the CVE-2024-4540 vulnerability.", "network_traffic": ["HTTP", "TCP", "UDP"], "related_course_of_action_refs": [{"id": "course_of_action:defend_against_oauth attacks"}], "related_component_refs": [{"id": "component:keycloak"}], "related_attack_pattern_refs": [{"id": "attack_pattern:using_oauth_to_obtain_unauthorized_access"}], "related_exploit_refs": [{"id": "exploit:exploit_cve_2024_4540"}], "related_malware_refs": [{"id": "malware:malware_cve_2024_4540"}], "related_prediction_refs": [{"id": "prediction:prediction_cve_2024_4540"}], "related_vulnerability_ref": "CVE-2024-4540", "related_tactic_refs": [{"id": "tactic:defend_against_oauth attacks"}], "relations": [{"relationship": "related_to", "id": "vulnerability:related_to_CVE-2024-4540"}]}, {"id": "prediction:prediction_cve_2024_4540", "type": "prediction", "created_by_REF": "https://example.com/my-identity", "modified": "2024-06-03T16:15:08.993", "name": "Prediction for CVE-2024-4540", "description": "prediction for the CVE-2024-4540 vulnerability.", "prediction": "HIGH", "confusion_level": "MEDIUM", "related_course_of_action_refs": [{"id": "course_of_action:defend_against_oauth attacks"}], "related_component_refs": [{"id": "component:keycloak"}], "related_attack_pattern_refs": [{"id": "attack_pattern:using_oauth_to_obtain_unauthorized_access"}], "related_exploit_refs": [{"id": "exploit:exploit_cve_2024_4540"}], "related_malware_refs": [{"id": "malware:malware_cve_2024_4540"}], "related_network_refs": [{"id": "network:network_cve_2024_4540"}], "related_vulnerability_ref": "CVE-2024-4540", "related_tactic_refs": [{"id": "tactic:defend_against_oauth attacks"}], "relations": [{"relationship": "related_to", "id": "vulnerability:related_to_CVE-2024-4540"}]}, {"id": "tactic:defend_against_oauth attacks", "type": "tactic", "created_by_REF": "https://example.com/my-identity", "modified": "2024-06-03T16:15:08.993", "name": "Defend against OAuth attacks", "description": "default tactic to defend against OAuth attacks.", "related_course_of_action_refs": [{"id": "course_of_action:-course_of_action-defend_against_oauth attacks"}], "related_component_refs": [{"id": "component:keycloak"}], "related_attack_pattern_refs": [{"id": "attack_pattern:using_oauth_to_obtain_unauthorized_access"}], "related_exploit_refs": [{"id": "exploit:exploit_cve_2024_4540"}], "related_malware_refs": [{"id": "malware:malware_cve_2024_4540"}], "related_network_refs": [{"id": "network:network_cve_2024_4540"}], "related_prediction_refs": [{"id": "prediction:prediction_cve_2024_4540"}], "related_vulnerability_ref": "CVE-2024-4540", "relations": [{"relationship": "related_to", "id": "vulnerability:related_to_CVE-2024-4540"}]}, {"id": "vulnerability:related_to_CVE-2024-4540", "type": "relationship", "created_by_REF": "https://example.com/my-identity", "modified": "2024-06-03T16:15:08.993", "name": "Related to CVE-2024-4540", "relationship_type": "RELATED_TO", "related_element_REF": "CVE-2024-4540", "relations": [{"relationship": "related_to", "id": "tactic:defend_against_oauth attacks"}]}], "related_object_refs": ["vulnerability:cve-2024-4540", "exploit:exploit_cve_2024_4540", "malware:malware_cve_2024_4540", "network:network_cve_2024_4540", "prediction:prediction_cve_2024_4540", "tactic:defend_against_oauth attacks"], "note": "Note: This STIX 2.1 bundle is a simulation, and actual data may vary."}, "technical_analysis": {"Introduction": "This report provides a technical analysis of the CVE-2024-4540 vulnerability in Keycloak. The vulnerability is a flaw in the OAuth 2.0 Pushed Authorization Requests (PAR) functionality, allowing client-provided parameters to be sent in plain text in the KC_RESTART cookie.", "Impact and Scope": "The vulnerability affects Keycloak 12.0.0 and later versions, and allows an attacker to obtain sensitive information, including the client ID and secret. The vulnerability is rated HIGH in terms of severity, with a CVSS score of 7.5.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1177 (Using OAuth to obtain unauthorized access), T1090 (Spearphishing attack via compromised email account), and T1190 (Supply chain attack).", "Technical Details": "The vulnerability is a result of a flawed implementation of the OAuth 2.0 PAR functionality in Keycloak. The KC_RESTART cookie is sent in plain text, allowing an attacker to extract sensitive information.", "Detection": "The vulnerability can be detected by monitoring for unusual network traffic patterns, such as the transmission of sensitive information in plain text.", "Mitigation": "The vulnerability can be mitigated by implementing proper authentication and authorization mechanisms, and by ensuring that sensitive information is properly encrypted.", "Conclusion": "In conclusion, the CVE-2024-4540 vulnerability is a serious security flaw that can be exploited by attackers to obtain sensitive information. It is essential to implement proper security measures to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-4540 vulnerability is a critical security flaw that affects Keycloak 12.0.0 and later versions. The vulnerability allows an attacker to obtain sensitive information, including the client ID and secret.", "Business Impact": "The vulnerability has a significant business impact, as it can be used to compromise sensitive information and disrupt business operations.", "Technical Impact": "The vulnerability has a technical impact, as it can be used to exploit the OAuth 2.0 PAR functionality in Keycloak.", "Mitigation Strategies": "The vulnerability can be mitigated by implementing proper security measures, such as proper authentication and authorization mechanisms, and ensuring that sensitive information is properly encrypted.", "Recommendations": "Recommendations for executives include implementing proper security measures, conducting regular security audits, and educating employees on security best practices.", "Conclusions": "In conclusion, the CVE-2024-4540 vulnerability is a serious security flaw that requires immediate attention. It is essential to take prompt action to mitigate the vulnerability and prevent exploitation."}}