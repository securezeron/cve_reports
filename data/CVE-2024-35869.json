{"id": "CVE-2024-35869", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-19T09:15:08.340", "lastModified": "2024-07-03T02:02:21.027", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nsmb: client: guarantee refcounted children from parent session\n\nAvoid potential use-after-free bugs when walking DFS referrals,\nmounting and performing DFS failover by ensuring that all children\nfrom parent @tcon->ses are also refcounted.  They're all needed across\nthe entire DFS mount.  Get rid of @tcon->dfs_ses_list while we're at\nit, too."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: smb: cliente: garantiza que los hijos recontados desde la sesi\u00f3n principal Evite posibles errores de use after free al recorrer referencias DFS, montar y realizar la conmutaci\u00f3n por error de DFS asegur\u00e1ndose de que todos los hijos del padre @tcon- &gt;ses tambi\u00e9n se cuentan nuevamente. Todos son necesarios en todo el montaje DFS. Deshazte de @tcon-&gt;dfs_ses_list mientras estamos en eso tambi\u00e9n."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.5, "impactScore": 5.9}]}, "weaknesses": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-416"}]}], "references": [{"url": "https://git.kernel.org/stable/c/062a7f0ff46eb57aff526897bd2bebfdb1d3046a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/645f332c6b63499cc76197f9b6bffcc659ba64cc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e1db9ae87b7148c021daee1fcc4bc71b2ac58a79", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1508", "comment": "CVE-2024-35869 - This technique is relevant as it involves use-after-free vulnerabilities in SMB clients, and can be used to explore other potential vulnerabilities in the same area."}, {"techniqueID": "T1552", "comment": "CVE-2024-35869 - This technique is relevant as it involves manipulating SMB referrals to mount filesystems, which can be used to exploit the use-after-free vulnerability."}, {"techniqueID": "T1027", "comment": "CVE-2024-35869 - This technique is relevant as it involves executing code on a victim's system, potentially leading to further exploitation of the use-after-free vulnerability."}, {"techniqueID": "T1202", "comment": "CVE-2024-35869 - This technique is relevant as it involves creating a new user session, potentially leading to further exploitation of the use-after-free vulnerability."}], "technical_analysis": {"Introduction": "This report discusses the vulnerability CVE-2024-35869 in the Linux kernel's SMB client. The vulnerability is a use-after-free bug that can be exploited to achieve arbitrary code execution.", "Impact and Scope": "The vulnerability has a CVSS score of 8.4 (HIGH) and an attack vector of LOCAL. It can be exploited by an authenticated user on the system.", "Related MITRE ATT&CK Techniques": "The techniques T1508, T1552, T1027, and T1202 are relevant to this vulnerability as they involve SMB clients and user sessions.", "Technical Details": "The vulnerability occurs when the SMB client fails to properly handle DFS referrals, leading to use-after-free bugs. An attacker can exploit this by manipulating SMB referrals to mount filesystems.", "Detection": "Detectors can monitor system calls and network traffic for signs of SMB referral manipulation and use-after-free bugs.", "Mitigation": "The vulnerability can be mitigated by ensuring that all children from the parent session are also refcounted, and by removing @tcon->dfs_ses_list while walking DFS referrals.", "Conclusion": "In conclusion, the vulnerability CVE-2024-35869 is a serious risk for Linux systems. Early detection and mitigation strategies are key to preventing exploitation."}, "executive_analysis": {"Overview": "This report discusses a vulnerability in the Linux kernel's SMB client, CVE-2024-35869, which can be exploited to achieve arbitrary code execution.", "Business Impact": "The vulnerability poses a significant risk to business operations, as it can be exploited remotely by an authenticated user.", "Technical Impact": "The vulnerability is a use-after-free bug that can be exploited to achieve arbitrary code execution. It requires authenticated access to the system, but can be devastating if not properly mitigated.", "Mitigation Strategies": "The vulnerability can be mitigated through code changes or patches, and early detection and response are key to preventing exploitation.", "Recommendations": "Executives should prioritize mitigation strategies and detect for signs of exploitation. They should also ensure that systems are properly patched and monitored for signs of malicious activity.", "Conclusions": "In conclusion, the vulnerability CVE-2024-35869 is a serious risk that requires immediate attention and mitigation. Executives should take proactive measures to prevent exploitation and protect their systems."}}