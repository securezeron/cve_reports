{"id": "CVE-2009-3287", "sourceIdentifier": "cve@mitre.org", "published": "2009-09-22T10:30:00.640", "lastModified": "2009-09-22T10:30:00.640", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "lib/thin/connection.rb in Thin web server before 1.2.4 relies on the X-Forwarded-For header to determine the IP address of the client, which allows remote attackers to spoof the IP address and hide activities via a modified X-Forwarded-For header."}, {"lang": "es", "value": "lib/thin/connection.rb en el servidor web Thin anterior a v1.2.4 permite determinar la direcci\u00f3n IP del cliente sobre la cabecera X-Forwarded-For, lo que permite a atacantes remotos suplantar la direcci\u00f3n IP y ocultar la actividad a trav\u00e9s de una cabecera X-Forwarded-For."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.2.2", "matchCriteriaId": "DDB8B96B-7544-4ED1-97AF-BED85A6E02A2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.4.0:*:*:*:*:*:*:*", "matchCriteriaId": "3722C121-CA76-4BD6-9B17-059C1051BD3D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "A8DFE094-2523-47F6-9310-BE48DF205825"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.5.0:*:*:*:*:*:*:*", "matchCriteriaId": "DCA76B41-8699-4AB9-8569-98D792359C53"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.5.1:*:*:*:*:*:*:*", "matchCriteriaId": "D9BDC31A-0F16-4817-802B-C603050D7E83"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.5.2:*:*:*:*:*:*:*", "matchCriteriaId": "EB082342-11F8-479C-B884-0D3E6074A600"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.5.3:*:*:*:*:*:*:*", "matchCriteriaId": "C5367748-33ED-4AFC-951A-B3B10B9CA94F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.5.4:*:*:*:*:*:*:*", "matchCriteriaId": "627C15A0-669D-4E56-9C31-8B8FBF60F3C0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.6.0:*:*:*:*:*:*:*", "matchCriteriaId": "72D1B13B-96DE-4151-BEEC-2D438CBD4B7E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.6.3:*:*:*:*:*:*:*", "matchCriteriaId": "F90B1079-9276-486F-86B8-B7E2FEF49B84"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.6.4:*:*:*:*:*:*:*", "matchCriteriaId": "9A8E67F2-6A68-4DF2-BBFC-CD5FB8401CCF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.7.0:*:*:*:*:*:*:*", "matchCriteriaId": "7D151CA6-9C63-489D-B4AC-19F357E75C73"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.7.1:*:*:*:*:*:*:*", "matchCriteriaId": "A47C57AC-1892-40FE-9F03-DAFBAF509976"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.8.0:*:*:*:*:*:*:*", "matchCriteriaId": "9EB06946-318C-4E86-8F73-43E16A9EFEA3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.8.1:*:*:*:*:*:*:*", "matchCriteriaId": "5F03A874-0753-49F6-A9BD-3798929B3C1C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.8.2:*:*:*:*:*:*:*", "matchCriteriaId": "57048132-7659-444A-B78A-12B199E935B7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:1.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "F00DA27E-EB76-4773-A7DE-14246C24FFFA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:1.1.0:*:*:*:*:*:*:*", "matchCriteriaId": "1A8B33E0-77F2-405F-8755-02C30509C652"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:1.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "49E5A94C-3262-4AA3-90F0-5E7B45E213A5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:1.2.0:*:*:*:*:*:*:*", "matchCriteriaId": "63C61B64-0B37-4F7B-8C47-BCA425E09A97"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:1.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "2F2E2ACB-9ED2-4712-8A25-DE288DBF27DE"}]}]}], "references": [{"url": "http://github.com/macournoyer/thin/blob/master/CHANGELOG", "source": "cve@mitre.org"}, {"url": "http://github.com/macournoyer/thin/commit/7bd027914c5ffd36bb408ef47dc749de3b6e063a", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://www.openwall.com/lists/oss-security/2009/09/12/1", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2009-3287 - An attacker can spoof IPs by injecting a modified X-Forwarded-For header, which allows for unauthorized access to the server."}, {"techniqueID": "TA0002", "comment": "CVE-2009-3287 - By injecting a modified X-Forwarded-For header, an attacker can bypass IP blocking and access restrictions, potentially leading to unauthorized data access or command execution."}, {"techniqueID": "TA0042", "comment": "CVE-2009-3287 - This vulnerability can be exploited by sending a crafted HTTP request to the Thin server, which can lead to unauthorized access and potential command execution."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "CVE-2009-3287", "created_by_ref": "sd-uuid", "created": "2019-08-15T14:30:00.000Z", "modified": "2019-08-15T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "CVE-2009-3287", "created_by_ref": "sd-uuid", "created": "2019-08-15T14:30:00.000Z", "modified": "2019-08-15T14:30:00.000Z", "name": "Thin Server X-Forwarded-For Header Vulnerability", "description": "lib/thin/connection.rb in Thin web server before 1.2.4 relies on the X-Forwarded-For header to determine the IP address of the client, which allows remote attackers to spoof the IP address and hide activities via a modified X-Forwarded-For header.", "weaknesses": [{"type": "weakness", "id": "CWE-20", "name": "Incorrect Default Permissions", "description": "The web server's default permissions allow unauthorized access to the system."}]}, {"type": "course_of_action", "id": "COA-1", "created_by_ref": "sd-uuid", "created": "2019-08-15T14:30:00.000Z", "modified": "2019-08-15T14:30:00.000Z", "name": "Update to Thin Server 1.2.4 or later", "description": "Update the Thin server to version 1.2.4 or later to address this vulnerability.", "mitigates": [{"type": "vulnerability", "id": "CVE-2009-3287"}]}, {"type": "course_of_action", "id": "COA-2", "created_by_ref": "sd-uuid", "created": "2019-08-15T14:30:00.000Z", "modified": "2019-08-15T14:30:00.000Z", "name": "Use a reverse proxy server", "description": "Configure a reverse proxy server to filter incoming requests and prevent unauthorized access.", "mitigates": [{"type": "vulnerability", "id": "CVE-2009-3287"}]}]}}, "technical_analysis": {"Introduction": "The Thin Server X-Forwarded-For Header Vulnerability (CVE-2009-3287) is a remote code execution vulnerability in the Thin web server.", "Impact and Scope": "The vulnerability allows remote attackers to spoof the IP address of the client and hide activities via a modified X-Forwarded-For header, potentially leading to unauthorized data access or command execution.", "Related MITRE ATT&CK Techniques": "TA0001, TA0002, and TA0042.", "Technical Details": "The vulnerability is caused by the web server relying on the X-Forwarded-For header to determine the IP address of the client, which can be modified by an attacker.", "Detection": "Detection methods include using IDs, IP addresses, and data transmitted.", "Mitigation": "Mitigation strategies include updating to a later version, using a reverse proxy server, and validating X-Forwarded-For headers.", "Conclusion": "This vulnerability indicates a lack of input validation and can lead to remote code execution. It is important to update the Thin server to the latest version and use a reverse proxy server to prevent unauthorized access."}, "executive_analysis": {"Overview": "The Thin Server X-Forwarded-For Header Vulnerability (CVE-2009-3287) is a remote code execution vulnerability in the Thin web server.", "Business Impact": "This vulnerability can allow unauthorized data access or command execution, potentially leading to financial loss, loss of intellectual property, or damage to reputation.", "Technical Impact": "This vulnerability can be exploited by sending a crafted HTTP request to the Thin server, which can lead to unauthorized access and potential command execution.", "Mitigation Strategies": "Update to the latest version, use a reverse proxy server, and validate X-Forwarded-For headers.", "Recommendations": "Recommend employees to use a reverse proxy server and update the Thin server to the latest version.", "Conclusions": "This vulnerability is a significant risk to organizations using the Thin web server. It is important to update and maintain the server to prevent unauthorized access and minimize potential damage."}}