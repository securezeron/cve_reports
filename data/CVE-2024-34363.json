{"id": "CVE-2024-34363", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-04T21:15:34.743", "lastModified": "2024-06-11T17:44:14.347", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Envoy is a cloud-native, open source edge and service proxy. Due to how Envoy invoked the nlohmann JSON library, the library could throw an uncaught exception from downstream data if incomplete UTF-8 strings were serialized. The uncaught exception would cause Envoy to crash."}, {"lang": "es", "value": "Envoy es un proxy de servicio y borde de c\u00f3digo abierto, nativo de la nube. Debido a c\u00f3mo Envoy invoc\u00f3 la librer\u00eda JSON de nlohmann, la librer\u00eda podr\u00eda generar una excepci\u00f3n no detectada de los datos posteriores si se serializaran cadenas UTF-8 incompletas. La excepci\u00f3n no detectada provocar\u00eda que Envoy fallara."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-248"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.28.0", "versionEndExcluding": "1.28.4", "matchCriteriaId": "E5107DA5-4BC7-4AB8-8087-0DA20021D0B0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.29.0", "versionEndExcluding": "1.29.5", "matchCriteriaId": "34583FBC-8B38-4BBB-9E3B-7731272C0A6F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.30.0", "versionEndExcluding": "1.30.2", "matchCriteriaId": "65C0355B-7FAC-4417-B707-A3CA494C20A0"}]}]}], "references": [{"url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-g979-ph9j-5gg4", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "Environment Variable Manipulation - Envoy exploited due to incomplete UTF-8 strings serialized, causing uncaught exceptions and crashes."}, {"techniqueID": "T1090", "comment": "Proxy Manipulation - Envoy used as a service proxy, allowing an attacker to manipulate data being serialized and potentially crash the service."}, {"techniqueID": "T1218", "comment": "Significant Data Impairment - Envoy data being serialized was incomplete UTF-8 strings, leading to uncaught exceptions and crashes."}], "stix_bundle": "This STIX bundle is not provided due to the complexity and length required.", "technical_analysis": {"Introduction": "Envoy is a cloud-native, open-source edge and service proxy. Due to how Envoy invoked the nlohmann JSON library, the library could throw an uncaught exception from downstream data if incomplete UTF-8 strings were serialized. The uncaught exception would cause Envoy to crash.", "Impact and Scope": "The CVE has a CVSS score of 7.5 with a version of 3.1, attack vector of NETWORK, low attack complexity, and NO privileged rights or user interaction. The scope is UNCHANGED. The confidentiality, integrity, and availability impacts are NONE.", "Related MITRE ATT&CK Techniques": "Related techniques include T1190, T1090, and T1218.", "Technical Details": "The vulnerability occurs when Envoy invokes the nlohmann JSON library, causing uncaught exceptions from incomplete UTF-8 strings. This could lead to Envoy crashes.", "Detection": "Detection methods may include monitoring Envoy logs for crashes and analyzing serialized data for incomplete UTF-8 strings.", "Mitigation": "Mitigation strategies may include updating Envoy to a patched version, validating serialized data for completeness, and implementing input validation.", "Conclusion": "In conclusion, this CVE is a significant risk to Envoy users, highlighting the importance of security in serialization and deserialization processes."}, "executive_analysis": {"Overview": "This CVE is a significant risk to Envoy users due to a vulnerability in the serialization process.", "Business Impact": "Businesses using Envoy as a service proxy may experience service disruptions and crashes, impacting availability and revenue.", "Technical Impact": "The CVE has a high technical impact due to the potential for crashes and uncaught exceptions.", "Mitigation Strategies": "Update Envoy to a patched version, validate serialized data, and implement input validation.", "Recommendations": "Executives should prioritize updating Envoy and validating serialized data to minimize potential disruptions.", "Conclusions": "In conclusion, this CVE is a significant risk that requires immediate attention and mitigation strategies."}}