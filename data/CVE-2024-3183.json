{"id": "CVE-2024-3183", "sourceIdentifier": "secalert@redhat.com", "published": "2024-06-12T09:15:18.683", "lastModified": "2024-06-27T03:15:50.447", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability was found in FreeIPA in a way when a Kerberos TGS-REQ is encrypted using the client\u2019s session key. This key is different for each new session, which protects it from brute force attacks. However, the ticket it contains is encrypted using the target principal key directly. For user principals, this key is a hash of a public per-principal randomly-generated salt and the user\u2019s password.\r\n\r\nIf a principal is compromised it means the attacker would be able to retrieve tickets encrypted to any principal, all of them being encrypted by their own key directly. By taking these tickets and salts offline, the attacker could run brute force attacks to find character strings able to decrypt tickets when combined to a principal salt (i.e. find the principal\u2019s password)."}, {"lang": "es", "value": "Se encontr\u00f3 una vulnerabilidad en FreeIPA cuando un Kerberos TGS-REQ se cifra utilizando la clave de sesi\u00f3n del cliente. Esta clave es diferente para cada nueva sesi\u00f3n, lo que la protege de ataques de fuerza bruta. Sin embargo, el ticket que contiene se cifra utilizando directamente la clave principal de destino. Para los usuarios principales, esta clave es un hash de un salt p\u00fablico generado aleatoriamente por principal y la contrase\u00f1a del usuario. Si un principal se ve comprometido, significa que el atacante podr\u00eda recuperar tickets cifrados para cualquier principal, y todos ellos estar\u00e1n cifrados directamente con su propia clave. Al desconectar estos tickets y salts, el atacante podr\u00eda ejecutar ataques de fuerza bruta para encontrar cadenas de caracteres capaces de descifrar tickets cuando se combinan con un salt principal (es decir, encontrar la contrase\u00f1a del principal)."}], "metrics": {"cvssMetricV31": [{"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-916"}]}], "references": [{"url": "https://access.redhat.com/errata/RHSA-2024:3754", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3755", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3756", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3757", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3758", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3759", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3760", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3761", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3775", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/security/cve/CVE-2024-3183", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2270685", "source": "secalert@redhat.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/WT3JL7JQDIAFKKEFARWYES7GZNWGQNCI/", "source": "secalert@redhat.com"}, {"url": "https://www.freeipa.org/release-notes/4-12-1.html", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1199", "comment": "CVE-2024-3183 - This vulnerability involves Kerberos ticket encryption, which can be exploited by an attacker to retrieve tickets and breach the entire Kerberos infrastructure. Relevant MITRE ATT&CK technique for lateral movement and credential access."}, {"techniqueID": "T1003.005", "comment": "CVE-2024-3183 - This vulnerability allows an attacker to decrypt Kerberos tickets, which can be used to gain access to the system and escalate privileges. Relevant MITRE ATT&CK technique for exploitation and privilege escalation."}, {"techniqueID": "T1204", "comment": "CVE-2024-3183 - This vulnerability involves Kerberos ticket decryption, which can be used to extract credentials and conduct lateral movement. Relevant MITRE ATT&CK technique for exploitation and credential access."}], "stix_bundle": "[STIX 2.1 Bundle Object]", "technical_analysis": {"Introduction": "A vulnerability was found in FreeIPA's Kerberos ticket encryption mechanism, allowing an attacker to decrypt Kerberos tickets and potentially gain access to the system.", "Impact and Scope": "The vulnerability has a CVSS score of 8.1 (High) and affects the FreeIPA system's Kerberos ticket encryption mechanism.", "Related MITRE ATT&CK Techniques": "T1199, T1003.005, T1204", "Technical Details": "The vulnerability arises from the use of a session key to encrypt Kerberos tickets, which can be exploited by an attacker to decrypt the tickets and gain access to the system.", "Detection": "Detection involves monitoring network traffic and system logs for suspicious activity, such as unauthorized access to Kerberos tickets.", "Mitigation": "Mitigation involves patching the FreeIPA system and implementing additional security measures, such as kerberize the environment.", "Conclusion": "This vulnerability highlights the importance of robust Kerberos ticket encryption and the need for regular security updates to prevent exploitation."}, "executive_analysis": {"Overview": "A vulnerability has been found in FreeIPA's Kerberos ticket encryption mechanism, which can be exploited by an attacker to gain access to the system.", "Business Impact": "The vulnerability has the potential to compromise sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability affects the FreeIPA system and requires immediate attention and patching.", "Mitigation Strategies": "Implement additional security measures, such as kerberize the environment and patch the system immediately.", "Recommendations": "Executives should prioritize patching and security updates to prevent exploitation and ensure the integrity of sensitive data.", "Conclusions": "This vulnerability highlights the importance of robust security measures and regular security updates to prevent exploitation and minimize the risk of data breaches."}}