{"id": "CVE-2020-15487", "sourceIdentifier": "cve@mitre.org", "published": "2020-09-30T18:15:22.273", "lastModified": "2020-10-09T18:53:24.427", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Re:Desk 2.3 contains a blind unauthenticated SQL injection vulnerability in the getBaseCriteria() function in the protected/models/Ticket.php file. By modifying the folder GET parameter, it is possible to execute arbitrary SQL statements via a crafted URL. Unauthenticated remote command execution is possible by using this SQL injection to update certain database values, which are then executed by a bizRule eval() function in the yii/framework/web/auth/CAuthManager.php file. Resultant authorization bypass is also possible, by recovering or modifying password hashes and password reset tokens, allowing for administrative privileges to be obtained."}, {"lang": "es", "value": "Re:Desk versi\u00f3n 2.3, contiene una vulnerabilidad de inyecci\u00f3n SQL ciega no autenticada en la funci\u00f3n getBaseCriteria() en el archivo protected/models/Ticket.php.&#xa0;Al modificar el par\u00e1metro GET de la carpeta, es posible ejecutar sentencias SQL arbitrarias por medio de una URL dise\u00f1ada.&#xa0;La ejecuci\u00f3n de comandos remotos no autenticados es posible usando esta inyecci\u00f3n SQL para actualizar determinados valores de la base de datos, que luego son ejecutados por una funci\u00f3n eval() de bizRule en el archivo yii/framework/web/auth/CAuthManager.php.&#xa0;La omisi\u00f3n de autorizaci\u00f3n resultante tambi\u00e9n es posible, recuperando o modificando hashes de contrase\u00f1a y tokens de restablecimiento de contrase\u00f1a, permitiendo obtener privilegios administrativos"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:re-desk:re\\:desk:2.3:*:*:*:*:*:*:*", "matchCriteriaId": "34C4228B-7583-4BC3-A0D1-A5E60AF4E874"}]}]}], "references": [{"url": "https://labs.f-secure.com/advisories/redesk-v2-3-multiple-issues/", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://www.re-desk.com/download-help-desk-software.html", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2020-15487 - This technique details on how attackers can exploit the blind unauthenticated SQL injection vulnerability in the getBaseCriteria() function in the protected/models/Ticket.php file. Attacker can execute arbitrary SQL statements, including remote command execution and authorization bypass, using a crafted URL."}, {"techniqueID": "T1027", "comment": "CVE-2020-15487 - This technique details on how attackers can use the vulnerability to perform command injection attacks, enabling remote code execution and unauthorized system access."}, {"techniqueID": "T1105", "comment": "CVE-2020-15487 - This technique details on how attackers can use the vulnerability to conduct SQL injection attacks, enabling data theft, data manipulation, and privilege escalation."}, {"techniqueID": "T1190", "comment": "CVE-2020-15487 - This technique details on how attackers can use the vulnerability to gain access to a system by executing arbitrary code, enabling unauthorized system access and potential data theft."}], "stix_bundle": {"@context": "https://stix2.io/context", "incidents": [{"id": "incident--1", "created_by_ref": "organization--1", "published": true, "extended_properties": [{"name": "description", "description": "CVE-2020-15487", "type": "string", "created_by": "organization--1"}]}], "observed_data": [{"id": "observed_data--1", "created_by_ref": "organization--1", "observed_data_type": "http://cybox.mitre.org/cybox-2#NetworkObject-2", "created": "2020-09-30T18:15:22.273", "last_observed": "2020-09-30T18:15:22.273", "extended_properties": [{"name": "source", "description": "External Source", "type": "string", "created_by": "organization--1"}]}], " analysts_notes": [{"note_id": "note--1", "note_text": "Potential exploitation of CVE-2020-15487 by modifying the folder GET parameter to execute arbitrary SQL statements", "note_type": "analysis", "created_by": "organization--1"}], "identifiers": [{"id": "identity--1", "value": "CVE-2020-15487", "description": "Common Vulnerabilities and Exposures", "created_by": "organization--1"}], "attack_pattern": [{"id": "attack_pattern--1", "name": "Unauthenticated SQL Injection", "description": "An attacker sends a crafted SQL query to an application without authenticating and exploits the vulnerability to execute arbitrary SQL statements.", "created_by": "organization--1"}]}, "technical_analysis": {"Introduction": "CVE-2020-15487 is a blind unauthenticated SQL injection vulnerability in the getBaseCriteria() function in the protected/models/Ticket.php file of Re:Desk 2.3. This vulnerability can be exploited by modifying the folder GET parameter to execute arbitrary SQL statements.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) and can be exploited by an attacker to execute arbitrary SQL statements, including remote command execution and authorization bypass. This can lead to unauthorized access to the system and potential data theft.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1059, T1027, T1105, and T1190.", "Technical Details": "The vulnerability is caused by the lack of input validation and sanitization in the getBaseCriteria() function. An attacker can exploit this vulnerability by sending a crafted SQL query to the application without authenticating and executing arbitrary SQL statements.", "Detection": "The vulnerability can be detected by monitoring network traffic for suspicious SQL queries and by conducting regular security audits and penetration testing.", "Mitigation": "The vulnerability can be mitigated by implementing input validation and sanitization in the getBaseCriteria() function, as well as by restricting access to the application and monitoring network traffic for suspicious activity.", "Conclusion": "CVE-2020-15487 is a critical vulnerability that can be exploited by an attacker to gain unauthorized access to the system and potentially steal sensitive data. It is essential to implement mitigation strategies to prevent exploitation of this vulnerability."}, "executive_analysis": {"Overview": "CVE-2020-15487 is a critical vulnerability in Re:Desk 2.3 that can be exploited by an attacker to gain unauthorized access to the system and potentially steal sensitive data.", "Business Impact": "The exploitation of this vulnerability can result in significant financial and reputational loss to the organization, as well as potential legal and regulatory consequences.", "Technical Impact": "The vulnerability can be exploited to execute arbitrary SQL statements, including remote command execution and authorization bypass, which can lead to unauthorized access to the system and potential data theft.", "Mitigation Strategies": "Implement input validation and sanitization in the getBaseCriteria() function, restrict access to the application, and monitor network traffic for suspicious activity.", "Recommendations": "Executives should implement mitigation strategies to prevent exploitation of this vulnerability and conduct regular security audits and penetration testing to detect potential vulnerabilities.", "Conclusions": "CVE-2020-15487 is a critical vulnerability that requires immediate attention and action by executives and technical teams to prevent exploitation and minimize potential impact."}}