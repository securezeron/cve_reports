{"id": "CVE-2024-23636", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-23T18:15:19.433", "lastModified": "2024-02-01T20:17:34.393", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "SOFARPC is a Java RPC framework. SOFARPC defaults to using the SOFA Hessian protocol to deserialize received data, while the SOFA Hessian protocol uses a blacklist mechanism to restrict deserialization of potentially dangerous classes for security protection. But, prior to version 5.12.0, there is a gadget chain that can bypass the SOFA Hessian blacklist protection mechanism, and this gadget chain only relies on JDK and does not rely on any third-party components. Version 5.12.0 fixed this issue by adding a blacklist. SOFARPC also provides a way to add additional blacklists. Users can add a class like `-Drpc_serialize_blacklist_override=org.apache.xpath.` to avoid this issue."}, {"lang": "es", "value": "SOFARPC es un framework Java RPC. SOFARPC utiliza de forma predeterminada el protocolo SOFA Hessian para deserializar los datos recibidos, mientras que el protocolo SOFA Hessian utiliza un mecanismo de lista negra para restringir la deserializaci\u00f3n de clases potencialmente peligrosas para la protecci\u00f3n de la seguridad. Pero, antes de la versi\u00f3n 5.12.0, exist\u00eda una cadena de dispositivos que pod\u00eda eludir el mecanismo de protecci\u00f3n de la lista negra de SOFA Hessian, y esta cadena de dispositivos solo se basa en JDK y no depende de ning\u00fan componente de terceros. La versi\u00f3n 5.12.0 solucion\u00f3 este problema agregando una lista negra. SOFARPC tambi\u00e9n proporciona una forma de agregar listas negras adicionales. Los usuarios pueden agregar una clase como `-Drpc_serialize_blacklist_override=org.apache.xpath.` para evitar este problema."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-502"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sofastack:sofarpc:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.12.0", "matchCriteriaId": "5B157065-0631-4FFB-8A18-D8BA348F3166"}]}]}], "references": [{"url": "https://github.com/sofastack/sofa-rpc/commit/42d19b1b1d14a25aafd9ef7c219c04a19f90fc76", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/sofastack/sofa-rpc/security/advisories/GHSA-7q8p-9953-pxvr", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1228", "comment": "CVE-2024-23636 - Exploitation of SOFARPC vulnerability using JDK gadget chain, can be prevented by updating to version 5.12.0 and applying custom blacklists"}, {"techniqueID": "T1574", "comment": "CVE-2024-23636 - Deserialization of untrusted data through SOFA Hessian protocol, can be prevented by validating user input and restricting deserialization"}, {"techniqueID": "T1190", "comment": "CVE-2024-23636 - Adding a blacklist bypass, mitigated by updating to version 5.12.0 and applying custom blacklists"}], "stix_bundle": {"type": "bundle", "id": "bundle-1", "name": "SOFARPC Vulnerability Bundle", "created_by_ref": "https://example.com/user/john.doe", "created": "2024-02-01T20:17:34.393", "modified": "2024-02-01T20:17:34.393", "objects": [{"type": "vulnerability", "id": "vulnerability-1", "name": "SOFARPC Deserialization Vulnerability", "description": "SOFARPC is vulnerable to deserialization attacks due to the use of SOFA Hessian protocol and JDK gadget chain", "cvssScore": 9.8, "cvssVector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "references": [{"type": "reference", "href": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-23636"}]}, {"type": "course-of-action", "id": "course-of-action-1", "name": "Update to version 5.12.0", "description": "Update to the latest version of SOFARPC to mitigate the vulnerability", "related_techniques": ["T1228"]}, {"type": "course-of-action", "id": "course-of-action-2", "name": "Apply custom blacklists", "description": "Apply custom blacklists to Prevent deserialization attacks", "related_techniques": ["T1190"]}, {"type": "note", "id": "note-1", "name": "MITRE ATT&CK Techniques", "description": "Related MITRE ATT&CK Techniques: T1228, T1190, T1574"}], " relationships": [{"type": "vulnerability Relates to", "source_ref": "vulnerability-1", "target_ref": "T1228"}, {"type": "vulnerability Relates to", "source_ref": "vulnerability-1", "target_ref": "T1190"}, {"type": "vulnerability Relates to", "source_ref": "vulnerability-1", "target_ref": "T1574"}]}, "technical_analysis": {"Introduction": "SOFARPC is a Java RPC framework used for communication between microservices. The framework is vulnerable to deserialization attacks due to the use of SOFA Hessian protocol and JDK gadget chain.", "Impact and Scope": "The vulnerability is rated 9.8/10 on the CVSS scale, with a high impact on confidentiality, integrity, and availability. The vulnerability can be exploited by an attacker to execute arbitrary code and exfiltrate sensitive data.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1228, T1190, and T1574, which are used to exploit the vulnerability and execute malicious code.", "Technical Details": "The vulnerability is caused by the use of SOFA Hessian protocol and JDK gadget chain in SOFARPC. The protocol is used to deserialize received data, which can be exploited by an attacker to execute arbitrary code.", "Detection": "The vulnerability can be detected using tools such as Burp Suite and ZAP.", "Mitigation": "The vulnerability can be mitigated by updating to the latest version of SOFARPC and applying custom blacklists.", "Conclusion": "In conclusion, the vulnerability in SOFARPC is a serious security issue that can be exploited by an attacker to execute arbitrary code and exfiltrate sensitive data. It is recommended to update to the latest version of SOFARPC and apply custom blacklists to mitigate the vulnerability."}, "executive_analysis": {"Overview": "SOFARPC is a Java RPC framework used for communication between microservices. The framework is vulnerable to deserialization attacks due to the use of SOFA Hessian protocol and JDK gadget chain.", "Business Impact": "The vulnerability can result in the loss of sensitive data, disruption of business operations, and damage to the company's reputation.", "Technical Impact": "The vulnerability can be exploited by an attacker to execute arbitrary code and exfiltrate sensitive data, resulting in a high impact on confidentiality, integrity, and availability.", "Mitigation Strategies": "The vulnerability can be mitigated by updating to the latest version of SOFARPC and applying custom blacklists.", "Recommendations": "It is recommended to update to the latest version of SOFARPC and apply custom blacklists to mitigate the vulnerability.", "Conclusions": "In conclusion, the vulnerability in SOFARPC is a serious security issue that requires prompt attention and mitigation."}}