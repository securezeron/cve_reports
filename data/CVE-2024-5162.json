{"id": "CVE-2024-5162", "sourceIdentifier": "security@wordfence.com", "published": "2024-06-06T04:15:14.463", "lastModified": "2024-07-24T17:53:33.277", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The WordPress prettyPhoto plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the \u2018url\u2019 parameter in all versions up to, and including, 1.2.3 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with Contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page."}, {"lang": "es", "value": "El complemento WordPress PrettyPhoto para WordPress es vulnerable a Cross-Site Scripting Almacenado a trav\u00e9s del par\u00e1metro 'url' en todas las versiones hasta la 1.2.3 incluida debido a una sanitizaci\u00f3n de entrada y un escape de salida insuficientes. Esto hace posible que atacantes autenticados, con acceso de nivel de Colaborador y superior, inyecten scripts web arbitrarios en p\u00e1ginas que se ejecutar\u00e1n cada vez que un usuario acceda a una p\u00e1gina inyectada."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.1, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:master-addons:prettyphoto:*:*:*:*:*:wordpress:*:*", "versionEndIncluding": "1.2.3", "matchCriteriaId": "3F69CFB7-7101-4E1F-8C76-5720791BD533"}]}]}], "references": [{"url": "https://plugins.trac.wordpress.org/browser/prettyphoto/trunk/addon/jltma-wpf-addon.php#L96", "source": "security@wordfence.com", "tags": ["Patch"]}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/c581616d-c9e7-46f2-9c2f-5e082a13fd0b?source=cve", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0040", "comment": "Stored Cross-Site Scripting - CVE-2024-5162 - Insufficient input sanitization and output escaping in the WordPress prettyPhoto plugin allow authenticated attackers to inject arbitrary web scripts in pages."}, {"techniqueID": "TA0041", "comment": "Cross-Site Scripting via Injection - CVE-2024-5162 - Using the \u2018url\u2019 parameter, an authenticated attacker can inject arbitrary scripts in pages that will execute whenever a user accesses an injected page."}, {"techniqueID": "TA0001", "comment": "Initial Access via Software Vulnerability - CVE-2024-5162 - The vulnerability can be exploited by an authenticated attacker, with Contributor-level access and above, to execute arbitrary code in the context of the affected application."}, {"techniqueID": "TA0010", "comment": "Command and Control - CVE-2024-5162 - An attacker can use the injected scripts to establish command and control channels and execute arbitrary commands on the affected application."}], "stix_bundle": {"type": "stix_bundle", "id": "cve-2024-5162-bundle", "created_by referees": "Me", "created": "2024-08-01T14:00:00Z", "object_refs": [{"id": "cve-2024-5162", "idref": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-5162"}], "containers": [{"type": "vulnerability", "id": "cve-2024-5162", "description": {"lang": "en", "value": "The WordPress prettyPhoto plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the \u2018url\u2019 parameter in all versions up to, and including, 1.2.3 due to insufficient input sanitization and output escaping."}, "severity": "MEDIUM", "cvssV3": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "baseScore": 5.4}, "attack_vector": "NETWORK", "attack_complexity": "LOW", "privileges_required": "LOW", "user_interaction": "REQUIRED", "scope": "CHANGED", "confidentiality_impact": "LOW", "integrity_impact": "LOW", "availability_impact": "NONE"}], "relationships": [{"relationship_type": "exploited_by", "source_ref": "cve-2024-5162", "target_ref": "TA0040"}, {"relationship_type": "exploited_by", "source_ref": "cve-2024-5162", "target_ref": "TA0041"}, {"relationship_type": "exploited_by", "source_ref": "cve-2024-5162", "target_ref": "TA0001"}, {"relationship_type": "mitigated_by", "source_ref": "TA0010", "target_ref": "cve-2024-5162"}]}, "technical_analysis": {"Introduction": "The CVE-2024-5162 vulnerability in the WordPress prettyPhoto plugin allows authenticated attackers to inject arbitrary web scripts in pages.", "Impact and Scope": "The vulnerability is exploitable by an authenticated attacker with Contributor-level access and above, and has a CVSS score of 5.4.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to TA0040, TA0041, TA0001, and TA0010.", "Technical Details": "The vulnerability is caused by insufficient input sanitization and output escaping in the WordPress prettyPhoto plugin.", "Detection": "Vulnerability scanners and web application firewalls can be used to detect and prevent exploitation of this vulnerability.", "Mitigation": "Applying the patches and implementing web application firewalls can mitigate this vulnerability.", "Conclusion": "The CVE-2024-5162 vulnerability is a significant security risk and should be addressed promptly."}, "executive_analysis": {"Overview": "The CVE-2024-5162 vulnerability in the WordPress prettyPhoto plugin is a significant security risk.", "Business Impact": "The vulnerability could allow unauthorized access to sensitive data and could have significant business implications.", "Technical Impact": "The vulnerability allows authenticated attackers to inject arbitrary web scripts in pages, which can have significant technical implications.", "Mitigation Strategies": "Applying the patches and implementing web application firewalls can mitigate this vulnerability.", "Recommendations": "All organizations using the WordPress prettyPhoto plugin should apply the patches and implement web application firewalls to prevent exploitation of this vulnerability.", "Conclusions": "The CVE-2024-5162 vulnerability is a serious security risk and should be addressed promptly."}}