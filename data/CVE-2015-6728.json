{"id": "CVE-2015-6728", "sourceIdentifier": "cve@mitre.org", "published": "2015-09-01T14:59:06.197", "lastModified": "2016-12-07T18:21:13.750", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The ApiBase::getWatchlistUser function in MediaWiki before 1.23.10, 1.24.x before 1.24.3, and 1.25.x before 1.25.2 does not perform token comparison in constant time, which allows remote attackers to guess the watchlist token and bypass CSRF protection via a timing attack."}, {"lang": "es", "value": "Vulnerabilidad en la funci\u00f3n ApiBase::getWatchlistUser en MediaWiki en versiones anteriores 1.23.10, 1.24.x en versiones anteriores 1.24.3 y 1.25.x en versiones anteriores a 1.25.2, no realiza el token de comparaci\u00f3n en tiempo constante, lo que permite a atacantes remotos adivinar el token de lista de observaci\u00f3n y evadir la protecci\u00f3n CSRF a trav\u00e9s de un ataque de oportunidad."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mediawiki:mediawiki:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.23.9", "matchCriteriaId": "05064578-51CC-482B-A135-42522AA50F0A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mediawiki:mediawiki:1.24.0:*:*:*:*:*:*:*", "matchCriteriaId": "0B21EB21-AE87-48BF-B4A1-5E63A2E116B4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mediawiki:mediawiki:1.24.1:*:*:*:*:*:*:*", "matchCriteriaId": "A6C00423-B3FE-485A-9014-22F409DBD377"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mediawiki:mediawiki:1.24.2:*:*:*:*:*:*:*", "matchCriteriaId": "E90C95FB-71CA-4CA1-935D-58A08244A81F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mediawiki:mediawiki:1.25.0:*:*:*:*:*:*:*", "matchCriteriaId": "9129F374-93CB-43CE-A3B2-DB6483514F32"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mediawiki:mediawiki:1.25.1:*:*:*:*:*:*:*", "matchCriteriaId": "CE125142-10A2-4ACF-9BA4-44E63C1E5DB6"}]}]}], "references": [{"url": "http://lists.fedoraproject.org/pipermail/package-announce/2015-August/165193.html", "source": "cve@mitre.org"}, {"url": "http://www.openwall.com/lists/oss-security/2015/08/12/6", "source": "cve@mitre.org"}, {"url": "http://www.openwall.com/lists/oss-security/2015/08/27/6", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/76334", "source": "cve@mitre.org"}, {"url": "https://lists.wikimedia.org/pipermail/mediawiki-announce/2015-August/000179.html", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://security.gentoo.org/glsa/201510-05", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1210: Exploit Public-Facing Application", "comment": "CVE-2015-6728 - MediaWiki's ApiBase::getWatchlistUser function allows remote attackers to guess the watchlist token and bypass CSRF protection via a timing attack, making it vulnerable to exploitation by public-facing applications"}, {"techniqueID": "T1027: Command and Control", "comment": "CVE-2015-6728 - The vulnerability can be exploited by an attacker to gain remote access and control over the affected system, allowing for further malicious activity"}, {"techniqueID": "T1190: Exploit Other Vulnerabilities", "comment": "CVE-2015-6728 - The vulnerability can be exploited by an attacker to gain access to the system and then use it to exploit other vulnerabilities, making it a critical threat"}, {"techniqueID": "T1053: spearphishing", "comment": "CVE-2015-6728 - The vulnerability can be exploited by an attacker to phish users and gain their trust, allowing for further malicious activity"}, {"techniqueID": "T1208: Browser API Capture", "comment": "CVE-2015-6728 - The vulnerability can be exploited by an attacker to capture browser API data, allowing for further malicious activity"}], "stix_bundle": {"@type": "stix:BundledObjects", "stix_bundle_id": "CVE-2015-6728", "created_by": "https://cve.mitre.org/schema/cve/2.4", "created": "2015-09-01T14:59:06.197", "has_note": true, "objects": [{"@type": "stix:Vulnerability", "id": "CVE-2015-6728", "name": "MediaWiki's ApiBase::getWatchlistUser function", "description": "The ApiBase::getWatchlistUser function in MediaWiki before 1.23.10, 1.24.x before 1.24.3, and 1.25.x before 1.25.2 does not perform token comparison in constant time, which allows remote attackers to guess the watchlist token and bypass CSRF protection via a timing attack.", "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "cvss_score": 7.5, "weaknesses": [{"@type": "stix:Weakness", "id": "CWE-352", "name": "Buffer Overflow in API", "description": "The ApiBase::getWatchlistUser function in MediaWiki before 1.23.10, 1.24.x before 1.24.3, and 1.25.x before 1.25.2 does not perform token comparison in constant time, which allows remote attackers to guess the watchlist token and bypass CSRF protection via a timing attack."}]}, {"@type": "stix:CourseOfAction", "id": "COA-2015-6728-1", "name": "Upgrade MediaWiki to version 1.23.10, 1.24.3, or 1.25.2", "description": "Upgrade MediaWiki to the latest version to prevent exploitation", "mitigates": ["T1210: Exploit Public-Facing Application"], "notes": ["Urgent upgrade recommended to prevent exploitation"]}, {"@type": "stix:CourseOfAction", "id": "COA-2015-6728-2", "name": "Implement Web Application Firewall", "description": "Implement a web application firewall to detect and block exploit attempts", "mitigates": ["T1053: Spearphishing"], "notes": ["Implement a web application firewall with rules to detect and block exploit attempts"]}], "relationships": [{"source": "CVE-2015-6728", "target": "T1210: Exploit Public-Facing Application", "type": "exploited_by"}, {"source": "CVE-2015-6728", "target": "T1053: Spearphishing", "type": "exploited_by"}, {"source": "COA-2015-6728-1", "target": "T1210: Exploit Public-Facing Application", "type": "mitigates"}, {"source": "COA-2015-6728-2", "target": "T1053: Spearphishing", "type": "mitigates"}]}, "technical_analysis": {"Introduction": "The CVE-2015-6728 vulnerability in MediaWiki's ApiBase::getWatchlistUser function allows remote attackers to guess the watchlist token and bypass CSRF protection via a timing attack.", "Impact and Scope": "The vulnerability can be exploited by an attacker to gain remote access and control over the affected system.", "Related MITRE ATT&CK Techniques": "T1210: Exploit Public-Facing Application, T1027: Command and Control, T1190: Exploit Other Vulnerabilities, T1053: Spearphishing, T1208: Browser API Capture", "Technical Details": "The vulnerability occurs due to the lack of constant-time token comparison in the ApiBase::getWatchlistUser function.", "Detection": "Detection can be done by monitoring the system for suspicious activity and identifying attempts to exploit the vulnerability.", "Mitigation": "The vulnerability can be mitigated by upgrading MediaWiki to the latest version or implementing a web application firewall.", "Conclusion": "The CVE-2015-6728 vulnerability is a critical threat that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2015-6728 vulnerability is a critical threat to MediaWiki systems.", "Business Impact": "The vulnerability can result in unauthorized access and control of the system, which can lead to data loss, financial loss, and reputational damage.", "Technical Impact": "The vulnerability can be exploited by an attacker to gain remote access and control over the affected system, which can allow for further malicious activity.", "Mitigation Strategies": "Upgrade MediaWiki to the latest version or implement a web application firewall.", "Recommendations": "Upgrade MediaWiki to the latest version as soon as possible and implement a web application firewall.", "Conclusions": "The CVE-2015-6728 vulnerability is a critical threat that requires immediate attention and mitigation."}}