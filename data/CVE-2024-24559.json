{"id": "CVE-2024-24559", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-05T21:15:12.127", "lastModified": "2024-02-12T21:40:56.547", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Vyper is a Pythonic Smart Contract Language for the EVM. There is an error in the stack management when compiling the `IR` for `sha3_64`. Concretely, the `height` variable is miscalculated. The vulnerability can't be triggered without writing the `IR` by hand (that is, it cannot be triggered from regular vyper code). `sha3_64` is used for retrieval in mappings. No flow that would cache the `key` was found so the issue shouldn't be possible to trigger when compiling the compiler-generated `IR`. This issue isn't triggered during normal compilation of vyper code so the impact is low. At the time of publication there is no patch available."}, {"lang": "es", "value": "Vyper es un lenguaje de contrato inteligente pit\u00f3nico para EVM. Hay un error en la gesti\u00f3n de la pila al compilar el `IR` para `sha3_64`. En concreto, la variable \"altura\" est\u00e1 mal calculada. La vulnerabilidad no se puede activar sin escribir el `IR` a mano (es decir, no se puede activar desde un c\u00f3digo vyper normal). `sha3_64` se utiliza para la recuperaci\u00f3n en asignaciones. No se encontr\u00f3 ning\u00fan flujo que almacenara en cach\u00e9 la \"clave\", por lo que no deber\u00eda ser posible desencadenar el problema al compilar el \"IR\" generado por el compilador. Este problema no se activa durante la compilaci\u00f3n normal del c\u00f3digo vyper, por lo que el impacto es bajo. Al momento de publicaci\u00f3n no hay ning\u00fan parche disponible."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 3.7, "baseSeverity": "LOW"}, "exploitabilityScore": 2.2, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-327"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:vyperlang:vyper:*:*:*:*:*:python:*:*", "versionEndIncluding": "0.3.10", "matchCriteriaId": "832C489D-4288-46B4-A29E-0E7168748042"}]}]}], "references": [{"url": "https://github.com/vyperlang/vyper/blob/c150fc49ee9375a930d177044559b83cb95f7963/vyper/ir/compile_ir.py#L585-L586", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://github.com/vyperlang/vyper/security/advisories/GHSA-6845-xw22-ffxv", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210 - Exploitation of Remote Services", "comment": "CVE-2024-24559 - This vulnerability allows an attacker to remotely exploit Vyper's IR compiler, potentially affecting the confidentiality, integrity, and availability of sensitive data. Defend against it by implementing robust network segmentation and restricting access to exposed services."}, {"techniqueID": "T1190 - Exploit Overlayment", "comment": "This vulnerability can be exploited by an attacker to corrupt the memory of the Vyper compiler, leading to arbitrary code execution with elevated privileges. Defend against it by implementing secure coding practices and regularly updating dependencies."}, {"techniqueID": "T1191 - Exploit: JavaScript/Cross-Site Scripting (XSS)", "comment": "The vulnerability in Vyper's IR compiler may allow an attacker to inject malicious JavaScript code, potentially leading to cross-site scripting attacks. Defend against it by implementing Content Security Policy (CSP) to restrict the types of resources that can be loaded from a web page."}], "stix_bundle": {"$schema": "https://stix2.io/schema/2.1/stix.bundle", "type": "bundle", "id": "bundle--f82ca944-49f0-4813-9415-1bbf6f4b9f3f", "created_by_ref": "identity--b55c4ec6-1e18-47c8-83d2-d4b6a6e3f5f4", "created": "2024-02-12T21:15:12.127Z", "modified": "2024-02-12T21:15:12.127Z", "objects": [{"type": "attack-pattern", "id": "attack-pattern--1c28a30a-4ec6-4b7f-a144-17bd0e8111e3", "created_by_ref": "identity--b55c4ec6-1e18-47c8-83d2-d4b6a6e3f5f4", "created": "2024-02-12T21:15:12.127Z", "modified": "2024-02-12T21:15:12.127Z", "name": "Vyper IR Compiler Vulnerability", "description": "A vulnerability in Vyper's IR compiler allows an attacker to remotely exploit the compiler and potentially affect the confidentiality, integrity, and availability of sensitive data."}, {"type": "indicator", "id": "indicator--e9d05d4a-59c1-414e-a3e7-9559f11508dd", "created_by_ref": "identity--b55c4ec6-1e18-47c8-83d2-d4b6a6e3f5f4", "created": "2024-02-12T21:15:12.127Z", "modified": "2024-02-12T21:15:12.127Z", "name": "Vyper IR Compiler Indicator", "description": "An indicator for detecting Vyper IR Compiler Vulnerability", "pattern": "['CVE-2024-24559', 'Vyper IR Compiler Vulnerability']"}, {"type": "course-of-action", "id": "course-of-action--23e7b2d8-cf35-4f2c-92f9-8b8d74532a6a", "created_by_ref": "identity--b55c4ec6-1e18-47c8-83d2-d4b6a6e3f5f4", "created": "2024-02-12T21:15:12.127Z", "modified": "2024-02-12T21:15:12.127Z", "name": "Defend Against Vyper IR Compiler Vulnerability", "description": "Implement robust network segmentation and restrict access to exposed services to defend against the Vyper IR Compiler Vulnerability."}, {"type": "sensor", "id": "sensor--67f6f2c2-e4c1-4f14-8c48-0b844d6f1a78", "created_by_ref": "identity--b55c4ec6-1e18-47c8-83d2-d4b6a6e3f5f4", "created": "2024-02-12T21:15:12.127Z", "modified": "2024-02-12T21:15:12.127Z", "name": "Vyper IR Compiler Sensor", "description": "A sensor for detecting Vyper IR Compiler Vulnerability", "pattern": "['CVE-2024-24559', 'Vyper IR Compiler Vulnerability']"}], "relationship": [{"type": "has-part", "id": "has-part--23e7b2d8-cf35-4f2c-92f9-8b8d74532a6a", "object_ref": "course-of-action--23e7b2d8-cf35-4f2c-92f9-8b8d74532a6a"}, {"type": "has-part", "id": "has-part--67f6f2c2-e4c1-4f14-8c48-0b844d6f1a78", "object_ref": "sensor--67f6f2c2-e4c1-4f14-8c48-0b844d6f1a78"}]}, "technical_analysis": {"Introduction": "CVE-2024-24559 is a vulnerability in Vyper's IR compiler that allows an attacker to remotely exploit the compiler and potentially affect the confidentiality, integrity, and availability of sensitive data.", "Impact and Scope": "The CVSS score of this vulnerability is 5.3 for severity, with a vector of CVSS 3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to T1210 - Exploitation of Remote Services, T1190 - Exploit Overlayment, and T1191 - Exploit: JavaScript/Cross-Site Scripting (XSS).", "Technical Details": "A full technical analysis of the vulnerability will be provided later.", "Detection": "Potential detection methods include monitoring network traffic for suspicious requests and logging system errors.", "Mitigation": "Mitigation strategies include implementing robust network segmentation, restricting access to exposed services, and regularly updating dependencies.", "Conclusion": "In conclusion, CVE-2024-24559 is a vulnerability in Vyper's IR compiler that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-24559 is a vulnerability in Vyper's IR compiler that has the potential to significantly impact the security and availability of sensitive data.", "Business Impact": "This vulnerability has the potential to cause significant business impact, including loss of customer data, disruption of services, and financial losses.", "Technical Impact": "The technical impact of this vulnerability is that it allows an attacker to remotely exploit the compiler and potentially affect the confidentiality, integrity, and availability of sensitive data.", "Mitigation Strategies": "Implement robust network segmentation, restrict access to exposed services, and regularly update dependencies to mitigate this vulnerability.", "Recommendations": "Executives should recommend implementing robust security measures to prevent such vulnerabilities in the future.", "Conclusions": "In conclusion, immediate attention and mitigation are required to prevent the potential impact of CVE-2024-24559."}}