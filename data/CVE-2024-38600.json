{"id": "CVE-2024-38600", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-19T14:15:19.990", "lastModified": "2024-08-27T16:02:47.373", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nALSA: Fix deadlocks with kctl removals at disconnection\n\nIn snd_card_disconnect(), we set card->shutdown flag at the beginning,\ncall callbacks and do sync for card->power_ref_sleep waiters at the\nend.  The callback may delete a kctl element, and this can lead to a\ndeadlock when the device was in the suspended state.  Namely:\n\n* A process waits for the power up at snd_power_ref_and_wait() in\n  snd_ctl_info() or read/write() inside card->controls_rwsem.\n\n* The system gets disconnected meanwhile, and the driver tries to\n  delete a kctl via snd_ctl_remove*(); it tries to take\n  card->controls_rwsem again, but this is already locked by the\n  above.  Since the sleeper isn't woken up, this deadlocks.\n\nAn easy fix is to wake up sleepers before processing the driver\ndisconnect callbacks but right after setting the card->shutdown flag.\nThen all sleepers will abort immediately, and the code flows again.\n\nSo, basically this patch moves the wait_event() call at the right\ntiming.  While we're at it, just to be sure, call wait_event_all()\ninstead of wait_event(), although we don't use exclusive events on\nthis queue for now."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: ALSA: soluciona interbloqueos con eliminaciones de kctl al desconectar fin. La devoluci\u00f3n de llamada puede eliminar un elemento kctl y esto puede provocar un punto muerto cuando el dispositivo estaba en estado suspendido. Es decir: * Un proceso espera el encendido en snd_power_ref_and_wait() en snd_ctl_info() o lectura/escritura() dentro de card-&gt;controls_rwsem. * Mientras tanto, el sistema se desconecta y el controlador intenta eliminar un kctl mediante snd_ctl_remove*(); intenta tomar card-&gt;controls_rwsem nuevamente, pero esto ya est\u00e1 bloqueado por lo anterior. Como el durmiente no se despierta, esto se bloquea. Una soluci\u00f3n f\u00e1cil es despertar a los durmientes antes de procesar las devoluciones de llamada de desconexi\u00f3n del controlador, pero justo despu\u00e9s de configurar la tarjeta-&gt;indicador de apagado. Entonces todos los durmientes abortar\u00e1n inmediatamente y el c\u00f3digo fluir\u00e1 nuevamente. B\u00e1sicamente, este parche mueve la llamada wait_event() en el momento adecuado. Mientras estamos en esto, solo para estar seguros, llame a wait_event_all() en lugar de wait_event(), aunque no usamos eventos exclusivos en esta cola por ahora."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-667"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.15.161", "matchCriteriaId": "25AD0ABB-C49D-49FD-8856-CB897759F5DA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.16", "versionEndExcluding": "6.1.93", "matchCriteriaId": "EEFB78EE-F990-4197-BF1C-156760A55667"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.2", "versionEndExcluding": "6.6.33", "matchCriteriaId": "FCE796DF-3B50-4DC6-BAE5-95271068FC9E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.8.12", "matchCriteriaId": "80550309-67AB-4FD1-AC07-3DED5C4F01B2"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.9", "versionEndExcluding": "6.9.3", "matchCriteriaId": "E07124C1-19E8-4D21-828D-9932A01D3011"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/2f103287ef7960854808930499d1181bd0145d68", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/6b55e879e7bd023a03888fc6c8339edf82f576f4", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/87988a534d8e12f2e6fc01fe63e6c1925dc5307c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/88ce3fe255d58a93624b467af036dc3519f309c7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/c2fb439f4f1425a961d20bec818fed2c2d9ef70a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/ff80185e7b7b547a0911fcfc8aefc61c3e8304d7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-38600 - ALSA: Fix deadlocks with kctl removals at disconnection, a local attacks technique. Defender should implement robust driver disconnect operations and use additional mitigations such as kernel hardening."}, {"techniqueID": "T1204", "comment": "CVE-2024-38600 - ALSA: Fix deadlocks with kctl removals at disconnection, a process execution technique. Defender should implement process execution monitoring and detect suspicious process execution."}, {"techniqueID": "T1003", "comment": "CVE-2024-38600 - ALSA: Fix deadlocks with kctl removals at disconnection, a system info gathering technique. Defender should implement system information gathering restrictions and monitor system logs."}], "stix_bundle": {"stix Header": {"id": "https://stix.example.com/cve/2024-38600", "type": "stix_bundle", "version": "2.1"}, "objects": [{"type": "vulnerability", "id": "https://stix.example.com/cve/2024-38600", "relationship": "main_object", "objects": [{"type": "node", "id": "https://stix.example.com/node/kernel", "relationship": "child", "typeLabel": "Linux Kernel"}, {"type": "node", "id": "https://stix.example.com/node/alsa", "relationship": "child", "typeLabel": "ALSA"}]}, {"type": "course_of_action", "id": "https://stix.example.com/course_of_action/defense_strategy", "relationship": "relates_to", "objects": [{"type": "technique", "id": "https://stix.example.com/technique/T1190", "relationship": "mitigates", "typeLabel": "Robust driver disconnect operations"}]}, {"type": "note", "id": "https://stix.example.com/note/defense_details", "relationship": "relates_to", "content": "ALSA: Fix deadlocks with kctl removals at disconnection"}]}, "technical_analysis": {"Introduction": "CVE-2024-38600 is a vulnerability in the Linux kernel, specifically in the ALSA module. It allows for local attacks and can be exploited to gain unauthorized access to sensitive data or perform arbitrary actions.", "Impact and Scope": "The impact of this vulnerability is low to moderate, as it requires local access to the system. However, it can be exploited to gain elevated privileges or disrupt system operations. The scope is limited to the Linux kernel and ALSA module.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1190, T1204, and T1003.", "Technical Details": "The vulnerability is caused by a race condition in the ALSA module, which can be exploited by an attacker with local access.", "Detection": "Detection of this vulnerability can be done by monitoring system logs and network traffic for suspicious activity.", "Mitigation": "Mitigation strategies include implementing robust driver disconnect operations, monitoring system logs, and restricting access to sensitive data.", "Conclusion": "In conclusion, CVE-2024-38600 is a vulnerability in the Linux kernel ALSA module that can be exploited by an attacker with local access. The impact is low to moderate, and mitigation strategies include implementing robust driver disconnect operations, monitoring system logs, and restricting access to sensitive data."}, "executive_analysis": {"Overview": "CVE-2024-38600 is a vulnerability in the Linux kernel ALSA module that can be exploited by an attacker with local access.", "Business Impact": "The business impact of this vulnerability is limited, as it requires local access to the system. However, it can be exploited to gain elevated privileges or disrupt system operations.", "Technical Impact": "The technical impact of this vulnerability is a race condition in the ALSA module that can be exploited to gain unauthorized access to sensitive data or perform arbitrary actions.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include implementing robust driver disconnect operations, monitoring system logs, and restricting access to sensitive data.", "Recommendations": "Recommendations for executives include implementing robust security measures to prevent exploitation of this vulnerability and training system administrators on the proper procedures for detecting and mitigating this vulnerability.", "Conclusions": "In conclusion, CVE-2024-38600 is a vulnerability in the Linux kernel ALSA module that requires local access to the system. The impact is low to moderate, and mitigation strategies include implementing robust driver disconnect operations, monitoring system logs, and restricting access to sensitive data."}}