{"id": "CVE-2020-35659", "sourceIdentifier": "cve@mitre.org", "published": "2020-12-24T16:15:15.490", "lastModified": "2020-12-28T17:40:47.570", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The DNS query log in Pi-hole before 5.2.2 is vulnerable to stored XSS. An attacker with the ability to directly or indirectly query DNS with a malicious hostname can cause arbitrary JavaScript to execute when the Pi-hole administrator visits the Query Log or Long-term data Query Log page."}, {"lang": "es", "value": "El registro de consultas DNS en Pi-hole versiones anteriores a 5.2.2, es vulnerable a un ataque XSS almacenado.&#xa0;Un atacante con la capacidad de consultar directa o indirectamente el DNS con un hostname malicioso puede causar que se ejecute un JavaScript arbitrario cuando el administrador de Pi-hole visita la p\u00e1gina Query Log o Long-term data Query Log"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:pi-hole:pi-hole:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.2.2", "matchCriteriaId": "494247D2-D97C-4464-BFDE-FC5E784A473F"}]}]}], "references": [{"url": "https://blog.mirch.io/2020/12/24/pihole-xss/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://discourse.pi-hole.net/t/pi-hole-core-web-v5-2-2-and-ftl-v5-3-3-released/41998", "source": "cve@mitre.org", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "https://github.com/pi-hole/AdminLTE/pull/1665", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-35659 - This vulnerable DNS query log in Pi-hole allows an attacker to inject malicious HTML or JavaScript code, which can be executed by an administrator visiting the Query Log or Long-term data Query Log page, highlighting the importance of regular software updates and secure querying practices."}, {"techniqueID": "T1193", "comment": "CVE-2020-35659 - Storing persistent XSS payloads in the DNS query log for Pi-hole, which can be used to steal sensitive information or execute arbitrary code on the administrator's machine, emphasizes the need for robust web application security and input validation."}, {"techniqueID": "T1032", "comment": "CVE-2020-35659 - Manipulating the DNS query log in Pi-hole for malicious purposes, such as executing arbitrary JavaScript code or stealing sensitive information, underscores the importance of securing web applications and monitoring network traffic for suspicious activity."}], "technical_analysis": {"Introduction": "Pi-hole's DNS query log vulnerability affects versions prior to 5.2.2, allowing stored XSS attacks to be executed when an administrator views the Query Log or Long-term data Query Log page.", "Impact and Scope": "The vulnerability has a CVSS score of 6.1 (MEDIUM) with an attack vector of NETWORK, and an attacker can exploit this to execute arbitrary JavaScript code. This highlights the need for regular software updates and secure querying practices.", "Related MITRE ATT&CK Techniques": "T1190, T1193, and T1032 are relevant to this CVE, as they describe techniques used to manipulate and execute malicious code in web applications and DNS servers.", "Technical Details": "The vulnerability occurs when an attacker can directly or indirectly query DNS with a malicious hostname, causing arbitrary JavaScript code to be executed on the administrator's machine.", "Detection": "Detecting this vulnerability requires monitoring network traffic for suspicious DNS queries and anomalous behavior.", "Mitigation": "The vulnerability can be mitigated by updating to Pi-hole version 5.2.2 or later, and implementing robust web application security and input validation.", "Conclusion": "This vulnerability highlights the importance of staying up-to-date with software updates and implementing robust web application security and input validation."}, "executive_analysis": {"Overview": "The Pi-hole DNS query log vulnerability affects versions prior to 5.2.2 and can allow stored XSS attacks, potentially compromising sensitive information and disrupting business operations.", "Business Impact": "This vulnerability could result in financial losses, reputational damage, and regulatory non-compliance due to the potential compromise of sensitive information.", "Technical Impact": "The vulnerability affects Pi-hole's DNS query log, which is a critical component of DNS servers, and could result in disrupted service and compromise of sensitive information.", "Mitigation Strategies": "Regular software updates, robust web application security, and secure querying practices are recommended to mitigate this vulnerability.", "Recommendations": "Executives should prioritize software updates, conduct threat intelligence monitoring, and develop incident response plans to ensure timely detection and response to this vulnerability.", "Conclusions": "Immediate action is required to protect against this vulnerability, and regular software updates and robust web application security are crucial to preventing similar incidents in the future."}}