{"id": "CVE-2024-5004", "sourceIdentifier": "contact@wpscan.com", "published": "2024-07-22T06:15:02.423", "lastModified": "2024-08-01T13:59:37.913", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The CM Popup Plugin for WordPress  WordPress plugin before 1.6.6 does not sanitise and escape some of the campaign settings, which could allow high privilege users such as contributor to perform Stored Cross-Site Scripting attacks"}, {"lang": "es", "value": " El CM Popup Plugin complemento de WordPress anterior a 1.6.6 no sanitiza ni escapa a algunas de las configuraciones de la campa\u00f1a, lo que podr\u00eda permitir a usuarios con altos privilegios, como los contribuyentes, realizar ataques de Cross Site Scripting almacenado."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:cminds:cm_popup:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "1.6.6", "matchCriteriaId": "2BCC2026-1564-4533-8F28-11F8FE4295D6"}]}]}], "references": [{"url": "https://wpscan.com/vulnerability/4bea7baa-84a2-4b21-881c-4f17822329e7/", "source": "contact@wpscan.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-5004 - An attacker may leverage this vulnerability to perform Stored Cross-Site Scripting attacks, potentially with high privilege users. Defend against this by validating and sanitizing user input, and implementing input validation and sanitization controls."}, {"techniqueID": "T1003", "comment": "CVE-2024-5004 - An attacker may use exploitation techniques such as fuzzing to identify vulnerable systems. Defend against this by implementing input validation and sanitization controls, and frequently updating software and plugins."}, {"techniqueID": "T1190", "comment": "CVE-2024-5004 - An attacker may use cross-site scripting to steal sensitive information or take control of user's session. Defend against this by implementing input validation and sanitization controls, and using browser extensions that can detect and block malicious scripts."}], "stix_bundle": "This STIX 2.1 bundle represents the vulnerability and related techniques, risks, and defense strategies for CVE-2024-5004.\n{\n    \"bundle\": {\n        \"id\": \"https://mitre.org/stix/stix2.1/CVE-2024-5004\",\n        \"standard_id\": \"STIX 2.1\",\n        \"title\": \"CVE-2024-5004 - CM Popup Plugin for WordPress Stored Cross-Site Scripting Vulnerability\",\n        \"published\": \"2024-08-01T14:00:00.000\",\n        \"versions\": [\"1.0\"],\n        \"objects\": [\n            {\n                \"id\": \"https://mitre.org/stix/stix2.1/CVE-2024-5004\",\n                \"type\": \"vulnerability\",\n                \"name\": \"CM Popup Plugin for WordPress Stored Cross-Site Scripting Vulnerability\",\n                \"description\": \"[CVE ID Being Analysed] - The CM Popup Plugin for WordPress before 1.6.6 does not sanitize and escape some of the campaign settings, which could allow high privilege users to perform Stored Cross-Site Scripting attacks.\",\n                \"cvssV2Metrics\": {},\n                \"cvssV3Metrics\": {\n                    \"baseSeverity\": \"MEDIUM\",\n                    \"baseScore\": 4.8,\n                    \"attackVector\": \"NETWORK\",\n                    \"attackComplexity\": \"LOW\",\n                    \"privilegesRequired\": \"HIGH\",\n                    \"userInteraction\": \"REQUIRED\",\n                    \"scope\": \"CHANGED\",\n                    \"confidentialityImpact\": \"LOW\",\n                    \"integrityImpact\": \"LOW\",\n                    \"availabilityImpact\": \"NONE\"\n                },\n                \"categories\": [],\n                \"related_threats\": [\n                    {\n                        \"id\": \"https://mitre.org/attack/techniques/T1210\",\n                        \"type\": \"technique\",\n                        \"name\": \"Exploitation of Command Injection\"\n                    },\n                    {\n                        \"id\": \"https://mitre.org/attack/techniques/T1003\",\n                        \"type\": \"technique\",\n                        \"name\": \"Fuzzing\"\n                    },\n                    {\n                        \"id\": \"https://mitre.org/attack/techniques/T1190\",\n                        \"type\": \"technique\",\n                        \"name\": \"Cross-Site Scripting\"\n                    }\n                ],\n                \"mitigated_by\": [\n                    {\n                        \"id\": \"https://mitre.org/stix/stix2.1/CVE-2024-5004/defense/validate-and-sanitize-user-input\",\n                        \"type\": \"defense\",\n                        \"name\": \"Validate and Sanitize User Input\",\n                        \"description\": \"Validate and sanitize user input, and implement input validation and sanitization controls to prevent and detect vulnerabilities.\",\n                        \"techniques\": [\n                            {\n                                \"id\": \"https://mitre.org/attack/techniques/T1210\",\n                                \"type\": \"technique\",\n                                \"name\": \"Exploitation of Command Injection\"\n                            },\n                            {\n                                \"id\": \"https://mitre.org/attack/techniques/T1003\",\n                                \"type\": \"technique\",\n                                \"name\": \"Fuzzing\"\n                            },\n                            {\n                                \"id\": \"https://mitre.org/attack/techniques/T1190\",\n                                \"type\": \"technique\",\n                                \"name\": \"Cross-Site Scripting\"\n                            }\n                        ]\n                    }\n                ],\n                \"related_attack_descriptions\": [],\n                \"notes\": [\n                    {\n                        \"content\": \"Frequently update software and plugins, and implement input validation and sanitization controls.\",\n                        \"type\": \"note\",\n                        \"label\": \"Defense\"\n                    },\n                    {\n                        \"content\": \"Use browser extensions that can detect and block malicious scripts.\",\n                        \"type\": \"note\",\n                        \"label\": \"Defense\"\n                    }\n                ]\n            }\n        ],\n        \" relationships\": {}\n    }\n}", "technical_analysis": {"Introduction": "The CM Popup Plugin for WordPress before 1.6.6 contains a vulnerability that allows high privilege users to perform Stored Cross-Site Scripting attacks.", "Impact and Scope": "The vulnerability has a CVSS score of 4.8 with a version of 3.1, and an attack vector of NETWORK. It has a low attack complexity, requires high privileges, and is required to be user-interactive.", "Related MITRE ATT&CK Techniques": "T1210 - Exploitation of Command Injection, T1003 - Fuzzing, and T1190 - Cross-Site Scripting", "Technical Details": "The vulnerability is due to the plugin's failure to sanitize and escape some of the campaign settings, which could allow attackers to inject malicious scripts into the system.", "Detection": "Detection of this vulnerability can be performed by analyzing the system logs for suspicious script injection attempts and by using security tools that can detect and prevent cross-site scripting.", "Mitigation": "The vulnerability can be mitigated by updating the plugin to version 1.6.6 or later, and by implementing input validation and sanitization controls to prevent and detect vulnerabilities.", "Conclusion": "In conclusion, the CM Popup Plugin for WordPress before 1.6.6 contains a vulnerability that allows high privilege users to perform Stored Cross-Site Scripting attacks. The vulnerability can be mitigated by updating the plugin and implementing input validation and sanitization controls."}, "executive_analysis": {"Overview": "The CM Popup Plugin for WordPress before 1.6.6 contains a vulnerability that allows high privilege users to perform Stored Cross-Site Scripting attacks.", "Business Impact": "The vulnerability has a significant impact on the business, as it allows attackers to inject malicious scripts into the system and potentially steal sensitive information.", "Technical Impact": "The vulnerability has a technical impact on the system, as it allows attackers to inject malicious scripts and potentially take control of the system.", "Mitigation Strategies": "The vulnerability can be mitigated by updating the plugin to version 1.6.6 or later, and by implementing input validation and sanitization controls to prevent and detect vulnerabilities.", "Recommendations": "We recommend updating the plugin to version 1.6.6 or later, and implementing input validation and sanitization controls to prevent and detect vulnerabilities.", "Conclusions": "In conclusion, the CM Popup Plugin for WordPress before 1.6.6 contains a vulnerability that allows high privilege users to perform Stored Cross-Site Scripting attacks. We recommend implementing the mitigation strategies and recommendations to prevent and detect vulnerabilities."}}