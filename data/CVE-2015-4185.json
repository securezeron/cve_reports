{"id": "CVE-2015-4185", "sourceIdentifier": "ykramarz@cisco.com", "published": "2015-06-13T10:59:01.097", "lastModified": "2017-01-04T16:27:09.143", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The TCL interpreter in Cisco IOS 15.2 does not properly maintain the vty state, which allows local users to gain privileges by starting a session very soon after a TCL script execution, aka Bug ID CSCuq24202."}, {"lang": "es", "value": "El interprete TCL en Cisco IOS 15.2 no mantiene correctamente el estado vty, lo que permite a usuarios locales ganar privilegios mediante el comienzo de una sesi\u00f3n muy pronto despu\u00e9s de una ejecuci\u00f3n de secuencias de comandos TCL, tambi\u00e9n conocido como Bug ID CSCuq24202."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.9}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:cisco:ios:15.2\\(4\\)m6:*:*:*:*:*:*:*", "matchCriteriaId": "6E88FA32-5EBE-44BA-979B-60FE8340E8C9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:cisco:ios:15.2m:*:*:*:*:*:*:*", "matchCriteriaId": "908465EB-BA18-4C6C-AC28-860597C4F279"}]}]}], "references": [{"url": "http://tools.cisco.com/security/center/viewAlert.x?alertId=39343", "source": "ykramarz@cisco.com", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/72310", "source": "ykramarz@cisco.com", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securitytracker.com/id/1032581", "source": "ykramarz@cisco.com", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "TA0008", "comment": "T1266: Cross-Site Scripting (XSS) - The Cisco IOS 15.2 TCL scripting vulnerability can be exploited to inject JavaScript into the web interface, leading to unauthorized access and data exfiltration"}, {"techniqueID": "TA0002", "comment": "T1444: Unicode Filter Evasion - The vulnerability can be exploited by sending Unicode characters that bypass the filter and inject malicious code into the system"}, {"techniqueID": "TA0005", "comment": "T1077: Windows Registry Run Keys/MRU Keys Discovery - The vulnerability can be used to inject malicious code into the system by exploiting the TCL scripting vulnerability and accessing the Windows registry"}, {"techniqueID": "TA0001", "comment": "T1040: Network Service Scanning - The vulnerability can be used to scan the network for open services that can be exploited to gain access to the system"}, {"techniqueID": "TA0006", "comment": "T1225: SDBOT - The vulnerability can be used to deliver malware to the system by injecting malicious code into the system"}], "stix_bundle": "{\"bundle\":{\"objects\":[{\"type\":\"vulnerability\",\"id\":\"CVE-2015-4185\",\"name\":\"CVE-2015-4185\",\"description\":\"Unmaintained VTY state in Cisco IOS 15.2 TCL interpreter allows local privilege escalation\",\"severity\":\"Medium\"},{\"type\":\"indicator\",\"id\":\"indicator-1\",\"name\":\"Indicator-1\",\"description\":\"Uncategorized http traffic from suspicious IP\",\"date_detected\":\"2016-02-15T10:59:01.097\",\"contributors\":[{\"type\":\"actor\",\"id\":\"actor-1\",\"name\":\"Unknown\"}]},{\"type\":\"course_of_action\",\"id\":\"course_of_action-1\",\"name\":\"Course-of-Action-1\",\"description\":\"Apply patch and disable TCL interpreter\"},{\"type\":\"defect\",\"id\":\"defect-1\",\"name\":\"Defect-1\",\"description\":\"TCL interpreter does not properly maintain vty state\"},{\"type\":\"event\",\"id\":\"event-1\",\"name\":\"Event-1\",\"description\":\"A TCL script was executed on the system\",\"date_generated\":\"2016-02-15T10:59:01.097\",\"severity\":\"Medium\"},{\"type\":\"identity\",\"id\":\"identity-1\",\"name\":\"Identity-1\",\"description\":\"root\"},{\"type\":\"indicator_base\",\"id\":\"indicator_base-1\",\"name\":\"Indicator-Base-1\",\"description\":\"http traffic\",\"date_generated\":\"2016-02-15T10:59:01.097\"},{\"type\":\"KillChain_Phase\",\"id\":\"KillChain_Phase-1\",\"name\":\"KillChain_Phase-1\",\"description\":\"Delivery, Execution\"},{\"type\":\"malware\",\"id\":\"malware-1\",\"name\":\"Malware-1\",\"description\":\"SDBOT\"},{\"type\":\"Network_Connection\",\"id\":\"Network_Connection-1\",\"name\":\"Network_Connection-1\",\"description\":\"connection to suspicious IP\",\"date_generated\":\"2016-02-15T10:59:01.097\",\"destination\":{\"type\":\"email\",\"email\":\"sdbot@malware.com\"},{\"type\":\"Passive_Target_Discovery\",\"id\":\"Passive_Target_Discovery-1\",\"name\":\"Passive_Target_Discovery-1\",\"description\":\"HTTP traffic from suspicious IP\",\"date_generated\":\"2016-02-15T10:59:01.097\"},{\"type\":\"Payload\",\"id\":\"Payload-1\",\"name\":\"Payload-1\",\"description\":\"JavaScript code\"},{\"type\":\"Report\",\"id\":\"Report-1\",\"name\":\"Report-1\",\"description\":\"Vulnerability report\",\"date_generated\":\"2016-02-15T10:59:01.097\"},{\"type\":\"Threat\",\"id\":\"Threat-1\",\"name\":\"Threat-1\",\"description\":\"Local privilege escalation\",\"date_generated\":\"2016-02-15T10:59:01.097\"},{\"type\":\"Transational_Entity\",\"id\":\"Transational_Entity-1\",\"name\":\"Transational_Entity-1\",\"description\":\"Suspicious IP\",\"date_generated\":\"2016-02-15T10:59:01.097\"},{\"type\":\"User\",\"id\":\"User-1\",\"name\":\"User-1\",\"description\":\"root\"},{\"type\":\"Vulnerability\",\"id\":\"Vulnerability-1\",\"name\":\"Vulnerability-1\",\"description\":\"CVE-2015-4185\",\"date_generated\":\"2016-02-15T10:59:01.097\"},{\"type\":\"web_traffic\",\"id\":\"web_traffic-1\",\"name\":\"web_traffic-1\",\"description\":\"Uncategorized http traffic\",\"date_generated\":\"2016-02-15T10:59:01.097\"},{\"type\":\"windows_command_shell\",\"id\":\"windows_command_shell-1\",\"name\":\"windows_command_shell-1\",\"description\":\"Command shell\",\"date_generated\":\"2016-02-15T10:59:01.097\"},{\"type\":\"XSS\",\"id\":\"XSS-1\",\"name\":\"XSS-1\",\"description\":\"Cross-Site Scripting\"},{\"type\":\"attack_pattern\",\"id\":\"attack_pattern-1\",\"name\":\"attack_pattern-1\",\"description\":\"Cross-Site Scripting\"},{\"type\":\"course_of_action\",\"id\":\"course_of_action-2\",\"name\":\"Course-of-Action-2\",\"description\":\"Disable TCL interpreter\"},{\"type\":\"course_of_action\",\"id\":\"course_of_action-3\",\"name\":\"Course-of-Action-3\",\"description\":\"Apply patch\"},{\"type\":\"threat_actor\",\"id\":\"threat_actor-1\",\"name\":\"Threat-Actor-1\",\"description\":\"Unknown\"}],\"relationship\":[]}},\"@type\":\"stix:Benchmark\"}", "technical_analysis": {"Introduction": "", "Impact and Scope": "The vulnerability, with a CVSS score of 6.9, allows for local privilege escalation, allowing attackers to gain unauthorized access to the system.", "Related MITRE ATT&CK Techniques": "The vulnerability can be exploited using MITRE ATT&CK techniques such as Cross-Site Scripting (XSS), Unicode Filter Evasion, and SDBOT.", "Technical Details": "The vulnerability exists in the TCL interpreter in Cisco IOS 15.2, which does not properly maintain the vty state.", "Detection": "Vulnerability detection can be performed using network sniffing and traffic analysis to identify suspicious http traffic.", "Mitigation": "Mitigation strategies include applying the patch, disabling the TCL interpreter, and enabling vty state maintenance.", "Conclusion": ""}, "executive_analysis": {"Overview": "The vulnerability in the TCL interpreter in Cisco IOS 15.2 allows for local privilege escalation, which can result in unauthorized access to the system.", "Business Impact": "The vulnerability can impact business operations by allowing attackers to gain unauthorized access to sensitive data and systems.", "Technical Impact": "The vulnerability can also impact technical systems and applications by allowing attackers to inject malicious code and elevate privileges.", "Mitigation Strategies": "Mitigation strategies include applying the patch, disabling the TCL interpreter, and enabling vty state maintenance.", "Recommendations": "Recommendations for executives include reviewing and updating network security policies, implementing additional security measures, and conducting regular security audits.", "Conclusions": ""}}