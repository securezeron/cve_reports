{"id": "CVE-2024-34457", "sourceIdentifier": "security@apache.org", "published": "2024-07-22T10:15:03.607", "lastModified": "2024-07-22T14:15:04.883", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "On versions before 2.1.4, after a regular user successfully logs in, they can manually make a request using the authorization token to view everyone's user flink information, including executeSQL and config.\n\nMitigation:\n\nall users should upgrade to 2.1.4\n\n"}, {"lang": "es", "value": "En versiones anteriores a la 2.1.4, despu\u00e9s de que un usuario normal inicia sesi\u00f3n con \u00e9xito, puede realizar una solicitud manualmente utilizando el token de autorizaci\u00f3n para ver la informaci\u00f3n de flink de todos los usuarios, incluidos runSQL y config. Mitigaci\u00f3n: todos los usuarios deben actualizar a 2.1.4"}], "metrics": {}, "weaknesses": [{"source": "security@apache.org", "type": "Primary", "description": [{"lang": "en", "value": "CWE-269"}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/07/22/2", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread/brlfrmvw9dcv38zoofmhxg7qookmwn7j", "source": "security@apache.org"}], "techniques": [{"techniqueID": "T1056", "comment": "CVE-2024-34457 - Persistence through exploitation of Apache Flink's authorization token vulnerability, allowing unauthorized access to sensitive information. Defend against this by upgrading to version 2.1.4 and restricting user access to sensitive features."}, {"techniqueID": "T1438", "comment": "CVE-2024-34457 - Initial access gained through exploitation of Apache Flink's authorization token vulnerability, allowing attackers to view sensitive information. Defend against this by implementing robust access controls and monitoring user activity."}, {"techniqueID": "T1047", "comment": "CVE-2024-34457 - Data exfiltration achieved through exploitation of Apache Flink's authorization token vulnerability, allowing attackers to view and access sensitive information. Defend against this by implementing data encryption and monitoring for suspicious activity."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve-2024-34457.stix2.1.0.zip", "description": "STIX 2.1 bundle for CVE-2024-34457", "created_by_ref": "https://example.com/author", "valid_from": "2024-07-22T10:15:03.607Z", "valid_until": "9999-12-31T23:59:59.999Z", "objects": [{"id": "https://example.com/cve-2024-34457", "type": "vulnerability", "name": "CVE-2024-34457", "description": "Apache Flink's authorization token vulnerability", "severity": "moderate", "consequence": "Unauthorized access to sensitive information", "exploit_status": "known", "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/07/22/2", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread/brlfrmvw9dcv38zoofmhxg7qookmwn7j", "source": "security@apache.org"}], "mitigations": [{"mitigation": "Upgrade to Apache Flink version 2.1.4", "source": "Apache Security Team"}, {"mitigation": "Restrict user access to sensitive features", "source": "Apache Security Team"}], "related_cve_items": [{"id": "CWE-269", "type": "weakness", "description": "Authentication and Authorization"}]}, {"id": "https://example.com/technique-T1056", "type": "indicator", "name": "T1056", "description": "Persistence through exploitation of Apache Flink's authorization token vulnerability, allowing unauthorized access to sensitive information", "created_by_ref": "https://example.com/author", "valid_from": "2024-07-22T10:15:03.607Z", "valid_until": "9999-12-31T23:59:59.999Z", "confidence": "high", "source_data_identifiers": ["Apache Flink", "Threat Intelligence"]}, {"id": "https://example.com/technique-T1438", "type": "indicator", "name": "T1438", "description": "Initial access gained through exploitation of Apache Flink's authorization token vulnerability, allowing attackers to view sensitive information", "created_by_ref": "https://example.com/author", "valid_from": "2024-07-22T10:15:03.607Z", "valid_until": "9999-12-31T23:59:59.999Z", "confidence": "high", "source_data_identifiers": ["Apache Flink", "Threat Intelligence"]}, {"id": "https://example.com/technique-T1047", "type": "indicator", "name": "T1047", "description": "Data exfiltration achieved through exploitation of Apache Flink's authorization token vulnerability, allowing attackers to view and access sensitive information", "created_by_ref": "https://example.com/author", "valid_from": "2024-07-22T10:15:03.607Z", "valid_until": "9999-12-31T23:59:59.999Z", "confidence": "high", "source_data_identifiers": ["Apache Flink", "Threat Intelligence"]}], "relationships": [{"id": "https://example.com/cve-2024-34457", "type": "has_attack_pattern", "to_id": "https://example.com/technique-T1056", "to_type": "observable"}, {"id": "https://example.com/cve-2024-34457", "type": "has_attack_pattern", "to_id": "https://example.com/technique-T1438", "to_type": "observable"}, {"id": "https://example.com/cve-2024-34457", "type": "has_attack_pattern", "to_id": "https://example.com/technique-T1047", "to_type": "observable"}, {"id": "https://example.com/technique-T1056", "type": "mitigates", "to_id": "https://example.com/mitigation-1", "to_type": "observable"}, {"id": "https://example.com/technique-T1438", "type": "mitigates", "to_id": "https://example.com/mitigation-2", "to_type": "observable"}, {"id": "https://example.com/technique-T1047", "type": "mitigates", "to_id": "https://example.com/mitigation-3", "to_type": "observable"}]}, "technical_analysis": {"Introduction": "Apache Flink's authorization token vulnerability allows unauthorized access to sensitive information. This vulnerability affects Apache Flink versions prior to 2.1.4.", "Impact and Scope": "This vulnerability has a moderate severity and affects all users who have Apache Flink installed. The attack vector is exploitation of the authorization token vulnerability to gain unauthorized access to sensitive information.", "Related MITRE ATT&CK Techniques": "T1056, T1438, T1047", "Technical Details": "The vulnerability occurs in Apache Flink's authorization token handling. An attacker can exploit this vulnerability by accessing the affected Apache Flink version and exploiting the authorization token.", "Detection": "Detection of this vulnerability involves monitoring for unusual activity in Apache Flink's authorization token handling and implementing controls to restrict access to sensitive features.", "Mitigation": "Mitigation of this vulnerability involves upgrading to Apache Flink version 2.1.4 and restricting user access to sensitive features.", "Conclusion": "In conclusion, Apache Flink's authorization token vulnerability is a moderate severity vulnerability that affects all users who have Apache Flink installed. Detection and mitigation strategies should be implemented to prevent exploitation of this vulnerability."}, "executive_analysis": {"Overview": "Apache Flink's authorization token vulnerability is a moderate severity vulnerability that affects all users who have Apache Flink installed.", "Business Impact": "This vulnerability may allow attackers to gain unauthorized access to sensitive information, which could result in significant financial and reputational damage to the organization.", "Technical Impact": "This vulnerability affects Apache Flink's authorization token handling, allowing attackers to gain unauthorized access to sensitive information.", "Mitigation Strategies": "Upgrade to Apache Flink version 2.1.4, restrict user access to sensitive features, and implement controls to detect and prevent unauthorized access.", "Recommendations": "Organizations should upgrade to Apache Flink version 2.1.4 and implement controls to detect and prevent unauthorized access to sensitive information.", "Conclusions": "In conclusion, the Apache Flink's authorization token vulnerability is a significant threat to organizational data and should be taken seriously."}}