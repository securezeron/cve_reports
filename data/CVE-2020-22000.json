{"id": "CVE-2020-22000", "sourceIdentifier": "cve@mitre.org", "published": "2021-04-27T18:15:07.863", "lastModified": "2021-05-06T14:05:04.557", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "HomeAutomation 3.3.2 suffers from an authenticated OS command execution vulnerability using custom command v0.1 plugin. This can be exploited with a CSRF vulnerability to execute arbitrary shell commands as the web user via the 'set_command_on' and 'set_command_off' POST parameters in '/system/systemplugins/customcommand/customcommand.plugin.php' by using an unsanitized PHP exec() function."}, {"lang": "es", "value": "HomeAutomation versi\u00f3n 3.3.2, sufre de una vulnerabilidad de ejecuci\u00f3n de comandos del Sistema Operativo autenticado usando el complemento de comando personalizado versi\u00f3n v0.1.&#xa0;Esto puede ser explotado con una vulnerabilidad CSRF para ejecutar comandos de shell arbitrarios como un usuario web por medio de los par\u00e1metros POST \"set_command_on\" y \"set_command_off\" en el archivo \"/system/systemplugins/customcommand/customcommand.plugin.php\" usando una funci\u00f3n PHP exec( )"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.0, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.1, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 8.5}, "baseSeverity": "HIGH", "exploitabilityScore": 6.8, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}, {"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:homeautomation_project:homeautomation:3.3.2:*:*:*:*:*:*:*", "matchCriteriaId": "28A14AE8-CCA1-4402-A897-1011C31935A4"}]}]}], "references": [{"url": "https://www.exploit-db.com/exploits/47809", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://www.zeroscience.mk/en/vulnerabilities/ZSL-2019-5560.php", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2020-22000 - This vulnerability allows for OS command execution as the web user, making it a great candidate for abusing with a CSRF vulnerability. The attacker can execute arbitrary shell commands by sending a specially crafted POST request to the custom command plugin."}, {"techniqueID": "T1190", "comment": "CVE-2020-22000 - This vulnerability also allows for unauthorized file upload via the custom command plugin. The attacker can execute arbitrary shell commands by uploading a PHP script and then executing it using the exec() function."}, {"techniqueID": "T1086", "comment": "CVE-2020-22000 - This vulnerability demonstrates how an authenticated attacker can execute arbitrary OS commands, potentially leading to privilege escalation or system compromise. D3FEND's 'CmdExec' strategy should be implemented to prevent command execution and privilege escalation attacks."}, {"techniqueID": "T1504", "comment": "CVE-2020-22000 - This vulnerability also demonstrates how a CSRF vulnerability can be used to execute arbitrary OS commands. D3FEND's 'CSRF' strategy should be implemented to prevent such attacks."}], "technical_analysis": {"Introduction": "The CVE-2020-22000 vulnerability in HomeAutomation 3.3.2 allows for authenticated OS command execution via the custom command plugin. The vulnerability can be exploited using a CSRF vulnerability to execute arbitrary shell commands.", "Impact and Scope": "CVSS 3.1: 8.0 (AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H), CVSS 2.0: 8.5 (AV:N/AC:M/Au:S/C:C/I:C/A:C). The vulnerability can be exploited by authenticated attackers, potentially leading to privilege escalation, system compromise, and data exfiltration.", "Related MITRE ATT&CK Techniques": "T1210, T1190, T1086, T1504.", "Technical Details": "The vulnerability is caused by the use of the exec() function in the custom command plugin without proper input validation. An attacker can exploit this vulnerability by sending a specially crafted POST request to the custom command plugin.", "Detection": "Detection is possible using signature-based detection systems, as well as behavior-based detection systems that monitor for suspicious command execution and privilege escalation attempts.", "Mitigation": "Mitigation is possible by implementing the 'CmdExec' and 'CSRF' strategies in D3FEND and restricting access to the custom command plugin. Additionally, implementing proper input validation and authorization checks can prevent exploitation of this vulnerability.", "Conclusion": "The CVE-2020-22000 vulnerability is a significant threat to HomeAutomation 3.3.2 and demonstrates the importance of proper input validation, authorization checks, and command execution prevention in modern software applications."}, "executive_analysis": {"Overview": "The CVE-2020-22000 vulnerability in HomeAutomation 3.3.2 allows for authenticated OS command execution, potentially leading to privilege escalation, system compromise, and data exfiltration.", "Business Impact": "The vulnerability has a significant business impact, as it can compromise the integrity and confidentiality of sensitive data, as well as disrupt business operations.", "Technical Impact": "The vulnerability has a significant technical impact, as it can allow attackers to execute arbitrary OS commands, potentially leading to system compromise and data exfiltration.", "Mitigation Strategies": "Implement D3FEND's 'CmdExec' and 'CSRF' strategies to prevent command execution and privilege escalation attacks.", "Recommendations": "Recommendations for executives include implementing strong access controls, regular vulnerability assessments, and incident response planning.", "Conclusions": "The CVE-2020-22000 vulnerability is a critical risk to HomeAutomation 3.3.2 and requires immediate attention and remediation."}}