{"id": "CVE-2024-7347", "sourceIdentifier": "f5sirt@f5.com", "published": "2024-08-14T15:15:31.870", "lastModified": "2024-08-20T19:25:17.513", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "NGINX Open Source and NGINX Plus have a vulnerability in the ngx_http_mp4_module, which might allow an attacker to over-read NGINX worker memory resulting in its termination, using a specially crafted mp4 file. The issue only affects NGINX if it is built with the ngx_http_mp4_module and the mp4 directive is used in the configuration file. Additionally, the attack is possible only if an attacker can trigger the processing of a specially crafted mp4 file with the ngx_http_mp4_module.\u00a0 Note: Software versions which have reached End of Technical Support (EoTS) are not evaluated."}, {"lang": "es", "value": " NGINX Open Source y NGINX Plus tienen una vulnerabilidad en ngx_http_mp4_module, que podr\u00eda permitir a un atacante sobreleer la memoria de trabajo de NGINX, lo que provocar\u00eda su terminaci\u00f3n, utilizando un archivo mp4 especialmente dise\u00f1ado. El problema solo afecta a NGINX si est\u00e1 construido con ngx_http_mp4_module y la directiva mp4 se usa en el archivo de configuraci\u00f3n. Adem\u00e1s, el ataque s\u00f3lo es posible si un atacante puede activar el procesamiento de un archivo mp4 especialmente dise\u00f1ado con el m\u00f3dulo ngx_http_mp4_module. Nota: Las versiones de software que han llegado al final del soporte t\u00e9cnico (EoTS) no se eval\u00faan."}], "metrics": {"cvssMetricV40": [{"source": "f5sirt@f5.com", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:L/AC:H/AT:P/PR:L/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "attackVector": "LOCAL", "attackComplexity": "HIGH", "attackRequirements": "PRESENT", "privilegesRequired": "LOW", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "NONE", "vulnerableSystemIntegrity": "NONE", "vulnerableSystemAvailability": "HIGH", "subsequentSystemConfidentiality": "NONE", "subsequentSystemIntegrity": "NONE", "subsequentSystemAvailability": "NONE", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NOT_DEFINED", "recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED", "baseScore": 5.7, "baseSeverity": "MEDIUM"}}], "cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 3.6}, {"source": "f5sirt@f5.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-125"}]}, {"source": "f5sirt@f5.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-126"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:f5:nginx_open_source:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.5.13", "versionEndExcluding": "1.26.2", "matchCriteriaId": "F0EA24A0-D4CA-4394-9A01-D7B9A5DBAF0C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:f5:nginx_plus:*:*:*:*:*:*:*:*", "versionStartIncluding": "r27", "versionEndExcluding": "r31", "matchCriteriaId": "462BF1FE-417D-4D78-B77E-CD34AA6E792B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:f5:nginx_plus:r31:-:*:*:*:*:*:*", "matchCriteriaId": "8248517E-D805-4928-8252-2168472341EF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:f5:nginx_plus:r31:p1:*:*:*:*:*:*", "matchCriteriaId": "9D5BB4C0-B862-4CDD-AA54-1BC1BDF27005"}, {"vulnerable": true, "criteria": "cpe:2.3:a:f5:nginx_plus:r32:-:*:*:*:*:*:*", "matchCriteriaId": "36C4308E-651E-437C-84E7-10C542E3ADC2"}]}]}], "references": [{"url": "https://my.f5.com/manage/s/article/K000140529", "source": "f5sirt@f5.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-7347 - This vulnerability allows an attacker to overwrite a buffer by sending a specially crafted mp4 file, leading to the termination of the NGINX worker, and thus achieving code execution. Defenders should focus on network segmentation and limiting the access to the affected NGINX instances."}, {"techniqueID": "T1211", "comment": "CVE-2024-7347 - attackers may leverage this vulnerability to perform server-side request forgery (SSRF). Defenders should enforce strict input validation and filtering, and consider implementing Content Security Policy (CSP) to prevent this attack."}, {"techniqueID": "T1112", "comment": "CVE-2024-7347 - a successful attack could be used to escalate privileges or access sensitive data. Defenders should implement multi-factor authentication and enforce least privilege access."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "CVE-2024-7347-Bundle", "created_by_ref": "cve@mitre.org", "created": "2024-08-20T19:25:17.513Z", "modified": "2024-08-20T19:25:17.513Z", "objects": [{"type": "vulnerability", "id": "CVE-2024-7347", "created_by_ref": "cve@mitre.org", "created": "2024-08-20T19:25:17.513Z", "modified": "2024-08-20T19:25:17.513Z", "name": "NGINX Open Source and NGINX Plus Vulnerability", "description": "NGINX Open Source and NGINX Plus have a vulnerability in the ngx_http_mp4_module, which might allow an attacker to over-read NGINX worker memory resulting in its termination, using a specially crafted mp4 file.", "severity": "MEDIUM", "baseSeverity": "MEDIUM", "cveId": "CVE-2024-7347", "cvssV3": {"baseScore": 4.7, "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH"}, "cvssV4": {"baseScore": 5.7, "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH"}, "related_threats": [{"type": "ttp", "id": "T1190", "relationship": "related_to", "role": "exploit"}, {"type": "ttp", "id": "T1211", "relationship": "related_to", "role": "exploit"}, {"type": "ttp", "id": "T1112", "relationship": "related_to", "role": "exploit"}], "mitigation": [{"type": "course_of_action", "id": "MITigation-1", "description": "Implement network segmentation and limit access to affected NGINX instances", "relationship": "mitigates", "ttp_id": "T1190"}, {"type": "course_of_action", "id": "MITigation-2", "description": "Enforce strict input validation and filtering, and consider implementing Content Security Policy (CSP)", "relationship": "mitigates", "ttp_id": "T1211"}, {"type": "course_of_action", "id": "MITigation-3", "description": "Implement multi-factor authentication and enforce least privilege access", "relationship": "mitigates", "ttp_id": "T1112"}]}]}}, "technical_analysis": {"Introduction": "CVE-2024-7347 is a vulnerability in NGINX Open Source and NGINX Plus affecting the ngx_http_mp4_module, which allows an attacker to overwrite a buffer by sending a specially crafted mp4 file, leading to the termination of the NGINX worker.", "Impact and Scope": "The impact of this vulnerability is a potential denial-of-service (DoS) attack, as well as the possibility of escalating privileges or accessing sensitive data. The scope of this vulnerability is bounded to the NGINX instances that have the ngx_http_mp4_module enabled.", "Related MITRE ATT&CK Techniques": "T1190, T1211, T1112", "Technical Details": "This vulnerability occurs due to the way the ngx_http_mp4_module handles the ngx_mp4_handler function. An attacker can send a specially crafted mp4 file to the module, which will cause it to overwrite a buffer, leading to the termination of the NGINX worker.", "Detection": "Detection of this vulnerability can be done by monitoring for HTTP requests containing specially crafted mp4 files and monitoring for NGINX worker crashes.", "Mitigation": "Mitigation strategies include implementing network segmentation and limiting access to affected NGINX instances, enforcing strict input validation and filtering, and considering implementing Content Security Policy (CSP).", "Conclusion": "In conclusion, CVE-2024-7347 is a vulnerability in NGINX Open Source and NGINX Plus that can be exploited to trigger a DoS attack or escalate privileges. It is essential to apply the recommended mitigation strategies to prevent this vulnerability from being exploited."}, "executive_analysis": {"Overview": "CVE-2024-7347 is a vulnerability in NGINX Open Source and NGINX Plus that affects the ngx_http_mp4_module, which allows an attacker to overwrite a buffer by sending a specially crafted mp4 file, leading to the termination of the NGINX worker.", "Business Impact": "The business impact of this vulnerability is the potential for a denial-of-service (DoS) attack, which can cause downtime and financial losses, as well as the potential for escalating privileges or accessing sensitive data.", "Technical Impact": "The technical impact of this vulnerability is the possibility of code execution, escalating privileges, or accessing sensitive data.", "Mitigation Strategies": "Implement network segmentation and limit access to affected NGINX instances, enforce strict input validation and filtering, and consider implementing Content Security Policy (CSP).", "Recommendations": "Recommendations for executives include prioritizing the patching of the affected NGINX instances, ensuring that the organization's incident response plan is up to date, and conducting regular security assessments to identify potential vulnerabilities.", "Conclusions": "In conclusion, CVE-2024-7347 is a critical vulnerability that requires immediate attention. Organizations should prioritize patching and develop a comprehensive incident response plan to address this vulnerability."}}