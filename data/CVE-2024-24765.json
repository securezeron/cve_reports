{"id": "CVE-2024-24765", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-06T18:15:46.807", "lastModified": "2024-03-06T21:42:48.053", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "CasaOS-UserService provides user management functionalities to CasaOS. Prior to version 0.4.7, path filtering of the URL for user avatar image files was not strict, making it possible to get any file on the system. This could allow an unauthorized actor to access, for example, the CasaOS user database, and possibly obtain system root privileges. Version 0.4.7 fixes this issue."}, {"lang": "es", "value": "CasaOS-UserService proporciona funcionalidades de gesti\u00f3n de usuarios a CasaOS. Antes de la versi\u00f3n 0.4.7, el filtrado de rutas de la URL para los archivos de im\u00e1genes de avatar de usuario no era estricto, lo que hac\u00eda posible obtener cualquier archivo en el sistema. Esto podr\u00eda permitir que un actor no autorizado acceda, por ejemplo, a la base de datos de usuarios de CasaOS y posiblemente obtenga privilegios de ra\u00edz del sistema. La versi\u00f3n 0.4.7 soluciona este problema."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}]}], "references": [{"url": "https://github.com/IceWhaleTech/CasaOS-UserService/commit/3f4558e23c0a9958f9a0e20aabc64aa8fd51840e", "source": "security-advisories@github.com"}, {"url": "https://github.com/IceWhaleTech/CasaOS-UserService/releases/tag/v0.4.7", "source": "security-advisories@github.com"}, {"url": "https://github.com/IceWhaleTech/CasaOS-UserService/security/advisories/GHSA-h5gf-cmm8-cg7c", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210 - Map IT Infrastructure", "comment": "CVE-2024-24765 - CasaOS-UserService path filtering vulnerability allows unauthorized access to system files, which can lead to privilege escalation. Mapping the IT infrastructure is crucial to understand the potential attack paths and identify vulnerable components."}, {"techniqueID": "T1040 - Network Exploitation", "comment": "CVE-2024-24765 - CasaOS-UserService path filtering vulnerability can be exploited over a network, allowing an attacker to gain unauthorized access to system files and potentially escalate privileges. Network exploitation is a key technique to consider when defending against this vulnerability."}, {"techniqueID": "T1083 - File and Directory Discovery", "comment": "CVE-2024-24765 - CasaOS-UserService path filtering vulnerability allows unauthorized access to system files. File and directory discovery is essential to identify potential sensitive files and directories that an attacker could access and exploit."}, {"techniqueID": "T1107 - Registry Run Keys/Auto Start", "comment": "CVE-2024-24765 - CasaOS-UserService path filtering vulnerability can be used to gain unauthorized access to system files and potentially maintain persistence on the compromised system. Registry run keys and auto start are related techniques that can be used to maintain persistence."}], "stix_bundle": {"stixheader": {"identity": {"history": "Created"}}, "objects": [{" Object": {"object_type": "indicator", "id": "CVE-2024-24765-Indicator", "created_by_ref": "https://stix.io", "modified": "2024-03-06T21:42:48.053", "description": "CVE-2024-24765 - CasaOS-UserService path filtering vulnerability allows unauthorized access to system files, which can lead to privilege escalation.", "first_seen": "2024-03-06T18:15:46.807", "last_seen": "2024-03-06T21:42:48.053", "confidence": "High", "type": "vulnerability"}}, {"Object": {"object_type": "course-of-action", "id": "CVE-2024-24765-COA", "created_by_ref": "https://stix.io", "modified": "2024-03-06T21:42:48.053", "description": "Implement strict path filtering to prevent unauthorized access to system files.", "relationship": {"target_ref": "https://stix.io/CVE-2024-24765-Indicator"}}}, {"Object": {"object_type": "course-of-action", "id": "CVE-2024-24765-COA-2", "created_by_ref": "https://stix.io", "modified": "2024-03-06T21:42:48.053", "description": "Regularly patch and update CasaOS-UserService to ensure the latest security fixes are applied.", "relationship": {"target_ref": "https://stix.io/CVE-2024-24765-Indicator"}}}], "relationship": {"objects": [{"start_node_ref": "https://stix.io/CVE-2024-24765-Indicator", "end_node_ref": "https://stix.io/CVE-2024-24765-COA"}, {"start_node_ref": "https://stix.io/CVE-2024-24765-COA-2", "end_node_ref": "https://stix.io/CVE-2024-24765-Indicator"}]}}, "technical_analysis": {"Introduction": "CVE-2024-24765 is a CasaOS-UserService path filtering vulnerability that allows unauthorized access to system files, which can lead to privilege escalation.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 (HIGH) and affects CasaOS-UserService prior to version 0.4.7. It can be exploited over a network and can potentially lead to system compromise.", "Related MITRE ATT&CK Techniques": "T1210 - Map IT Infrastructure, T1040 - Network Exploitation, T1083 - File and Directory Discovery, and T1107 - Registry Run Keys/Auto Start", "Technical Details": "The vulnerability occurs due to a path filtering issue in CasaOS-UserService. This allows an attacker to access system files without proper authorization.", "Detection": "Detection methods include monitoring for unusual network traffic and file access patterns.", "Mitigation": "Mitigation strategies include implementing strict path filtering, regularly patching and updating CasaOS-UserService, and restricting network access to sensitive areas.", "Conclusion": "CVE-2024-24765 is a high-severity vulnerability that affects CasaOS-UserService. It is essential to prioritize mitigation strategies to prevent unauthorized access to system files and potentially prevent system compromise."}, "executive_analysis": {"Overview": "CVE-2024-24765 is a critical vulnerability that affects CasaOS-UserService.", "Business Impact": "The vulnerability can lead to unauthorized access to system files, which can compromise sensitive data and potentially lead to system takeover.", "Technical Impact": "The vulnerability can be exploited over a network and can potentially lead to system compromise.", "Mitigation Strategies": "Implementing strict path filtering, regularly patching and updating CasaOS-UserService, and restricting network access to sensitive areas.", "Recommendations": "Prioritize mitigation strategies to prevent unauthorized access to system files and potentially prevent system compromise.", "Conclusions": "CVE-2024-24765 is a critical vulnerability that requires immediate attention and action."}}