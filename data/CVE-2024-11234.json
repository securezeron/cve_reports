{
    "id": "CVE-2024-11234",
    "sourceIdentifier": "security@php.net",
    "published": "2024-11-24T01:15:03.987",
    "lastModified": "2024-11-26T19:06:10.243",
    "vulnStatus": "Analyzed",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "In PHP versions 8.1.* before 8.1.31, 8.2.* before 8.2.26, 8.3.* before 8.3.14, when using streams with configured proxy and \"request_fulluri\" option, the URI is not properly sanitized which can lead to HTTP request smuggling and allow the attacker to use the proxy to perform arbitrary HTTP requests originating from the server, thus potentially gaining access to resources not normally available to the external user."
        },
        {
            "lang": "es",
            "value": "En las versiones de PHP 8.1.* anteriores a 8.1.31, 8.2.* anteriores a 8.2.26, 8.3.* anteriores a 8.3.14, cuando se utilizan flujos con proxy configurado y la opci\u00f3n \"request_fulluri\", la URI no se desinfecta correctamente, lo que puede provocar contrabando de solicitudes HTTP y permitir que el atacante use el proxy para realizar solicitudes HTTP arbitrarias que se originan en el servidor, obteniendo as\u00ed potencialmente acceso a recursos que normalmente no est\u00e1n disponibles para el usuario externo."
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "security@php.net",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N",
                    "baseScore": 4.8,
                    "baseSeverity": "MEDIUM",
                    "attackVector": "NETWORK",
                    "attackComplexity": "HIGH",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "LOW",
                    "integrityImpact": "LOW",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 2.2,
                "impactScore": 2.5
            },
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N",
                    "baseScore": 7.2,
                    "baseSeverity": "HIGH",
                    "attackVector": "NETWORK",
                    "attackComplexity": "LOW",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "CHANGED",
                    "confidentialityImpact": "LOW",
                    "integrityImpact": "LOW",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 3.9,
                "impactScore": 2.7
            }
        ]
    },
    "weaknesses": [
        {
            "source": "security@php.net",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-20"
                }
            ]
        },
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-74"
                }
            ]
        }
    ],
    "configurations": [
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "8.1.0",
                            "versionEndExcluding": "8.1.31",
                            "matchCriteriaId": "CE6E1B68-3EB9-4C67-97A6-226EA02CC2EA"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "8.2.0",
                            "versionEndExcluding": "8.2.26",
                            "matchCriteriaId": "C160D91A-CF97-4DD1-A34F-8B8C852B3CEC"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "8.3.0",
                            "versionEndExcluding": "8.3.14",
                            "matchCriteriaId": "35B1BA7F-0EAE-4F40-ACA4-EBC5D63F609A"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https://github.com/php/php-src/security/advisories/GHSA-c5f2-jwm7-mmq2",
            "source": "security@php.net",
            "tags": [
                "Exploit",
                "Third Party Advisory"
            ]
        }
    ],
    "techniques": [
        {
            "techniqueID": "T1059",
            "comment": "CVE-2024-11234 - Exploitation of a vulnerable PHP version without proper sanitization of the URI can lead to HTTP request smuggling, allowing an attacker to perform arbitrary HTTP requests originating from the server."
        },
        {
            "techniqueID": "T1050",
            "comment": "CVE-2024-11234 - The use of a proxy server with the 'request_fulluri' option in vulnerable PHP versions can enable an attacker to use the proxy to perform arbitrary HTTP requests, increasing the attackability of the server."
        },
        {
            "techniqueID": "T1190",
            "comment": "CVE-2024-11234 - This vulnerability can be used to perform HTTP request smuggling, allowing an attacker to bypass security controls and access sensitive data."
        }
    ],
    "stix_bundle": {
        "type": "bundle",
        "id": "https://example.com/vulnerability_bundle",
        "created_by_ref": "https://example.com/author",
        "created": "2024-01-01T12:00:00.000Z",
        "modified": "2024-01-01T12:00:00.000Z",
        "objects": [
            {
                "type": "indicator",
                "id": "https://example.com/vulnerability/indicator",
                "created_by_ref": "https://example.com/author",
                "created": "2024-01-01T12:00:00.000Z",
                "modified": "2024-01-01T12:00:00.000Z",
                "name": "Vulnerable PHP Version Indicator",
                "description": "Indicator for vulnerable PHP versions",
                "pattern": "PHP 8.1.* before 8.1.31, 8.2.* before 8.2.26, 8.3.* before 8.3.14",
                "value": "PHP 8.1.* before 8.1.31, 8.2.* before 8.2.26, 8.3.* before 8.3.14",
                "confidence": 0.9
            },
            {
                "type": "attack_pattern",
                "id": "https://example.com/vulnerability/attack_pattern",
                "created_by_ref": "https://example.com/author",
                "created": "2024-01-01T12:00:00.000Z",
                "modified": "2024-01-01T12:00:00.000Z",
                "name": "HTTP Request Smuggling",
                "description": "Attack pattern for exploiting HTTP request smuggling",
                "kill_chain_phase": "Exploit",
                "objective": "Perform arbitrary HTTP requests originating from the server"
            },
            {
                "type": "course_of_action",
                "id": "https://example.com/vulnerability/course_of_action",
                "created_by_ref": "https://example.com/author",
                "created": "2024-01-01T12:00:00.000Z",
                "modified": "2024-01-01T12:00:00.000Z",
                "name": "Upgrade PHP Version",
                "description": "Course of action to upgrade PHP version",
                "description_type": "Notes",
                "notes": "Upgrade to PHP 8.1.31, 8.2.26, 8.3.14 or later"
            }
        ],
        "relationships": [
            {
                "type": "has_indicator",
                "id": "https://example.com/vulnerability/indicator",
                "object_refs": [
                    "https://example.com/vulnerability/attack_pattern"
                ]
            },
            {
                "type": "mitigates",
                "id": "https://example.com/vulnerability/course_of_action",
                "object_refs": [
                    "https://example.com/vulnerability/attack_pattern"
                ]
            }
        ]
    },
    "technical_analysis": {
        "Introduction": "The vulnerability CVE-2024-11234 is a security issue in PHP versions 8.1.* before 8.1.31, 8.2.* before 8.2.26, 8.3.* before 8.3.14, which affects the sanitization of the URI when using streams with a configured proxy and the 'request_fulluri' option.",
        "Impact and Scope": "This vulnerability allows an attacker to perform arbitrary HTTP requests originating from the server, which can lead to HTTP request smuggling and potentially gain access to resources not normally available to the external user. CVSS score: 4.8, CVSS version: 3.1",
        "Related MITRE ATT&CK Techniques": "T1059, T1050, T1190",
        "Technical Details": "The vulnerability occurs when the 'request_fulluri' option is enabled in the PHP configuration and streams are used with a configured proxy. This allows an attacker to manipulate the HTTP request and use the proxy to perform arbitrary HTTP requests.",
        "Detection": "Detection of this vulnerability can be challenging, but it may be detected through logging and monitoring of HTTP requests and responses.",
        "Mitigation": "The vulnerability can be mitigated by upgrading to PHP 8.1.31, 8.2.26, 8.3.14 or later, or by disabling the 'request_fulluri' option and using an alternative approach for handling HTTP requests.",
        "Conclusion": "In conclusion, the vulnerability CVE-2024-11234 is a significant security issue that can be exploited by an attacker to perform arbitrary HTTP requests originating from the server. It is essential to take prompt action to mitigate this vulnerability to prevent potential security breaches."
    },
    "executive_analysis": {
        "Overview": "The vulnerability CVE-2024-11234 is a significant security issue in PHP versions 8.1.* before 8.1.31, 8.2.* before 8.2.26, 8.3.* before 8.3.14, which affects the sanitization of the URI when using streams with a configured proxy and the 'request_fulluri' option.",
        "Business Impact": "This vulnerability can lead to HTTP request smuggling and potentially gain access to resources not normally available to the external user, which can have significant business impact.",
        "Technical Impact": "The vulnerability can allow an attacker to perform arbitrary HTTP requests originating from the server, which can compromise the confidentiality, integrity, and availability of sensitive data.",
        "Mitigation Strategies": "Upgrade to PHP 8.1.31, 8.2.26, 8.3.14 or later, or disable the 'request_fulluri' option and use an alternative approach for handling HTTP requests.",
        "Recommendations": "Recommendations for executives are to take prompt action to mitigate this vulnerability and ensure that all PHP versions are up-to-date.",
        "Conclusions": "In conclusion, the vulnerability CVE-2024-11234 is a significant security issue that requires prompt action to mitigate. It is essential to ensure that all PHP versions are up-to-date and that the 'request_fulluri' option is disabled and an alternative approach is used for handling HTTP requests."
    }
}