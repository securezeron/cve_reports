{"id": "CVE-2023-6507", "sourceIdentifier": "cna@python.org", "published": "2023-12-08T19:15:08.440", "lastModified": "2024-05-07T22:15:07.297", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was found in CPython 3.12.0 `subprocess` module on POSIX platforms. The issue was fixed in CPython 3.12.1 and does not affect other stable releases.\n\nWhen using the `extra_groups=` parameter with an empty list as a value (ie `extra_groups=[]`) the logic regressed to not call `setgroups(0, NULL)` before calling `exec()`, thus not dropping the original processes' groups before starting the new process. There is no issue when the parameter isn't used or when any value is used besides an empty list.\n\nThis issue only impacts CPython processes run with sufficient privilege to make the `setgroups` system call (typically `root`).\n\n"}, {"lang": "es", "value": "Se encontr\u00f3 un problema en el m\u00f3dulo `subproceso` de CPython 3.12.0 en plataformas POSIX. El problema se solucion\u00f3 en CPython 3.12.1 y no afecta a otras versiones estables. Cuando se utiliza el par\u00e1metro `extra_groups=` con una lista vac\u00eda como valor (es decir, `extra_groups=[]`), la l\u00f3gica retrocede para no llamar a `setgroups(0, NULL)` antes de llamar a `exec()`, por lo que no se descarta el grupos de procesos originales antes de iniciar el nuevo proceso. No hay ning\u00fan problema cuando no se usa el par\u00e1metro o cuando se usa cualquier valor adem\u00e1s de una lista vac\u00eda. Este problema solo afecta los procesos de CPython que se ejecutan con privilegios suficientes para realizar la llamada al sistema \"setgroups\" (normalmente \"root\")."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.6}, {"source": "cna@python.org", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "cna@python.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-269"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:python:python:3.12.0:-:*:*:*:*:*:*", "matchCriteriaId": "5C76EDC2-43FF-448B-B65C-20AC83D680FE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:python:python:3.13.0:alpha1:*:*:*:*:*:*", "matchCriteriaId": "978582FF-B8F3-479F-AE77-359E9AEE6F23"}, {"vulnerable": true, "criteria": "cpe:2.3:a:python:python:3.13.0:alpha2:*:*:*:*:*:*", "matchCriteriaId": "84E3F62C-7218-4DC3-8473-8A576739643A"}]}]}], "references": [{"url": "https://github.com/python/cpython/commit/10e9bb13b8dcaa414645b9bd10718d8f7179e82b", "source": "cna@python.org"}, {"url": "https://github.com/python/cpython/commit/85bbfa8a4bbdbb61a3a84fbd7cb29a4096ab8a06", "source": "cna@python.org"}, {"url": "https://github.com/python/cpython/commit/9fe7655c6ce0b8e9adc229daf681b6d30e6b1610", "source": "cna@python.org"}, {"url": "https://github.com/python/cpython/issues/112334", "source": "cna@python.org", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://mail.python.org/archives/list/security-announce@python.org/thread/AUL7QFHBLILGISS7U63B47AYSSGJJQZD/", "source": "cna@python.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2023-6507 - Using of elevated privileges, using extra_groups parameter to drop original processes' groups"}, {"techniqueID": "T1190", "comment": "CVE-2023-6507 - Potential unintended impact of setgroups call, potential misuse of elevated privileges"}, {"techniqueID": "T1221", "comment": "CVE-2023-6507 - Potential data loss or corruption, potential impact on confidentiality and integrity"}], "stix_bundle": {"bundle": {"type": "bundle", "id": "urn:uuid:c645e56a-1f41-4764-bce1-4f08d6e1501a", "created_by_ref": "https://stix.example.com/identity", "created": "2023-06-14T14:30:00.000Z", "modified": "2023-06-14T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "urn:uuid:c645e56a-1f41-4764-bce1-4f08d6e1501a", "created_by_ref": "https://stix.example.com/identity", "created": "2023-06-14T14:30:00.000Z", "modified": "2023-06-14T14:30:00.000Z", "name": "CVE-2023-6507", "description": "Vulnerability in CPython 3.12.0 subprocess module on POSIX platforms", "impact": {"impactScore": 3.6, "baseScore": 4.9}, "risk": {"CVSS": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N"}}, "references": [{"resource_url": "https://github.com/python/cpython/commit/10e9bb13b8dcaa414645b9bd10718d8f7179e82b", "type": "commit"}, {"resource_url": "https://github.com/python/cpython/commit/85bbfa8a4bbdbb61a3a84fbd7cb29a4096ab8a06", "type": "commit"}, {"resource_url": "https://github.com/python/cpython/commit/9fe7655c6ce0b8e9adc229daf681b6d30e6b1610", "type": "commit"}, {"resource_url": "https://github.com/python/cpython/issues/112334", "type": "issue"}, {"resource_url": "https://mail.python.org/archives/list/security-announce@python.org/thread/AUL7QFHBLILGISS7U63B47AYSSGJJQZD/", "type": "email"}], "relatedobjects": [{"type": "course-of-action", "id": "urn:uuid:76a3456f-1234-4567-89ab-c45edcba7890", "created_by_ref": "https://stix.example.com/identity", "created": "2023-06-14T14:30:00.000Z", "modified": "2023-06-14T14:30:00.000Z", "name": "Remove use of extra_groups parameter", "description": "Recommendation: Remove the use of extra_groups parameter to prevent misuse of elevated privileges.", "related_techniques": ["TA0001"]}, {"type": "course-of-action", "id": "urn:uuid:98fghi90-abcd-adef-1234-567890123456", "created_by_ref": "https://stix.example.com/identity", "created": "2023-06-14T14:30:00.000Z", "modified": "2023-06-14T14:30:00.000Z", "name": "Upgrade to CPython 3.12.1", "description": "Recommendation: Upgrade to CPython 3.12.1 to address the vulnerability and ensure proper use of elevated privileges.", "related_techniques": ["T1190"]}]}], "relationships": [{"type": "has_course-of-action", "id": "urn:uuid:fa65e56a-1f41-4764-bce1-4f08d6e1501a", "created_by_ref": "https://stix.example.com/identity", "created": "2023-06-14T14:30:00.000Z", "modified": "2023-06-14T14:30:00.000Z", "source_ref": "urn:uuid:c645e56a-1f41-4764-bce1-4f08d6e1501a", "target_ref": "urn:uuid:76a3456f-1234-4567-89ab-c45edcba7890"}, {"type": "has_course-of-action", "id": "urn:uuid:df65e56a-1f41-4764-bce1-4f08d6e1501a", "created_by_ref": "https://stix.example.com/identity", "created": "2023-06-14T14:30:00.000Z", "modified": "2023-06-14T14:30:00.000Z", "source_ref": "urn:uuid:c645e56a-1f41-4764-bce1-4f08d6e1501a", "target_ref": "urn:uuid:98fghi90-abcd-adef-1234-567890123456"}]}}, "technical_analysis": {"Introduction": "The CVE-2023-6507 vulnerability is present in CPython 3.12.0 subprocess module on POSIX platforms. It allows the misuse of elevated privileges when using the extra_groups parameter.", "Impact and Scope": "The vulnerability allows an attacker to potentially drop the original processes' groups, impacting confidentiality and integrity.", "Related MITRE ATT&CK Techniques": "Mitre ATT&CK techniques T1190 and T1221 are related to the vulnerability, as they involve the use of elevated privileges and potential data loss or corruption.", "Technical Details": "The vulnerability is caused by the improper use of the setgroups call in the subprocess module.", "Detection": "Detection methods include monitoring for suspicious use of elevated privileges and monitoring for potential data loss or corruption.", "Mitigation": "Mitigation strategies include removing the use of the extra_groups parameter, upgrading to CPython 3.12.1, and monitoring for suspicious activity.", "Conclusion": "The CVE-2023-6507 vulnerability highlights the importance of proper use of elevated privileges and monitoring for potential data loss or corruption."}, "executive_analysis": {"Overview": "CVE-2023-6507 is a vulnerability in the CPython 3.12.0 subprocess module on POSIX platforms that allows the misuse of elevated privileges.", "Business Impact": "The vulnerability has the potential to impact confidentiality and integrity, which could lead to serious consequences for the organization.", "Technical Impact": "The vulnerability is present in the subprocess module, which is used to manage child processes.", "Mitigation Strategies": "Remove the use of the extra_groups parameter, upgrade to CPython 3.12.1, and monitor for suspicious activity.", "Recommendations": "Executives should recommend the implementation of these mitigation strategies to ensure the security of their organization.", "Conclusions": "The CVE-2023-6507 vulnerability is a critical issue that requires prompt attention to ensure the security and integrity of the organization."}}