{"id": "CVE-2024-3271", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-16T00:15:12.017", "lastModified": "2024-04-16T13:24:07.103", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A command injection vulnerability exists in the run-llama/llama_index repository, specifically within the safe_eval function. Attackers can bypass the intended security mechanism, which checks for the presence of underscores in code generated by LLM, to execute arbitrary code. This is achieved by crafting input that does not contain an underscore but still results in the execution of OS commands. The vulnerability allows for remote code execution (RCE) on the server hosting the application."}, {"lang": "es", "value": "Existe una vulnerabilidad de inyecci\u00f3n de comandos en el repositorio run-llama/llama_index, espec\u00edficamente dentro de la funci\u00f3n safe_eval. Los atacantes pueden eludir el mecanismo de seguridad previsto, que comprueba la presencia de guiones bajos en el c\u00f3digo generado por LLM, para ejecutar c\u00f3digo arbitrario. Esto se logra elaborando entradas que no contienen guiones bajos pero que aun as\u00ed dan como resultado la ejecuci\u00f3n de comandos del sistema operativo. La vulnerabilidad permite la ejecuci\u00f3n remota de c\u00f3digo (RCE) en el servidor que aloja la aplicaci\u00f3n."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-77"}]}], "references": [{"url": "https://github.com/run-llama/llama_index/commit/5fbcb5a8b9f20f81b791c7fc8849e352613ab475", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/9b32490e-7cf9-470e-8d49-ba083ae7a279", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-3271 - Command Injection via unsafe_eval function in llama_index repository. Attackers can bypass security checks and execute arbitrary code, allowing for remote code execution (RCE) on the server. Defend against by utilizing secure coding practices, validating user input, and implementing input validation and sanitization."}, {"techniqueID": "T1199", "comment": "CVE-2024-3271 - Use of unsafe Eval function in llama_index repository. Attackers can inject custom code to execute arbitrary commands. Defend against by ensuring safe and secure code practices, validating user input, and implementing input validation and sanitization."}, {"techniqueID": "T1210", "comment": "CVE-2024-3271 - Web Shell injection vulnerability in llama_index repository. Attackers can inject and execute arbitrary code, allowing for remote code execution (RCE) on the server. Defend against by using Web Application Firewalls (WAFs), detecting and blocking suspicious traffic, and implementing secure coding practices."}], "stix_bundle": "Paste your STIX Bundle JSON content here.", "technical_analysis": {"Introduction": "The CVE-2024-3271 vulnerability affects the run-llama/llama_index repository, specifically the safe_eval function, allowing for remote code execution (RCE) due to command injection.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 (CRITICAL) with an attack vector of NETWORK, attack complexity of LOW, privileges required of NONE, user interaction of NONE, and scope of UNCHANGED.", "Related MITRE ATT&CK Techniques": "T1059, T1199, T1210", "Technical Details": "The vulnerability occurs when the safe_eval function is called with user-controlled input, allowing attackers to bypass security checks and execute arbitrary code.", "Detection": "Detection can be achieved through monitoring for suspicious traffic patterns, such as unusual network requests or system crashes, and analyzing logs for signs of command injection.", "Mitigation": "Mitigation strategies include implementing secure coding practices, validating user input, and utilizing input validation and sanitization, as well as using Web Application Firewalls (WAFs) and detecting and blocking suspicious traffic.", "Conclusion": "The CVE-2024-3271 vulnerability is a critical remote code execution vulnerability in the safe_eval function of the llama_index repository, allowing attackers to execute arbitrary code and potentially gain-control of the server."}, "executive_analysis": {"Overview": "The CVE-2024-3271 vulnerability is a critical remote code execution vulnerability in the llama_index repository, affecting the safe_eval function.", "Business Impact": "This vulnerability can result in significant business disruption, data breaches, and reputational damage.", "Technical Impact": "This vulnerability can allow attackers to execute arbitrary code on the server, potentially leading to further attacks, data theft, and system compromise.", "Mitigation Strategies": "Implement secure coding practices, validate user input, and utilize input validation and sanitization, as well as use Web Application Firewalls (WAFs) and detect and block suspicious traffic.", "Recommendations": "Recommendations include implementing a secure coding practice, conducting regular security testing, and ensuring timely software updates.", "Conclusions": "The CVE-2024-3271 vulnerability is a critical vulnerability and requires immediate attention and mitigation to prevent potential attacks and data breaches."}}