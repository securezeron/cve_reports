{"id": "CVE-2024-24565", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-30T17:15:12.110", "lastModified": "2024-02-05T20:55:23.270", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "CrateDB is a distributed SQL database that makes it simple to store and analyze massive amounts of data in real-time. There is a COPY FROM function in the CrateDB database that is used to import file data into database tables. This function has a flaw, and authenticated attackers can use the COPY FROM function to import arbitrary file content into database tables, resulting in information leakage. This vulnerability is patched in 5.3.9, 5.4.8, 5.5.4, and 5.6.1."}, {"lang": "es", "value": "CrateDB es una base de datos SQL distribuida que simplifica el almacenamiento y an\u00e1lisis de cantidades masivas de datos en tiempo real. Hay una funci\u00f3n COPIAR DESDE en la base de datos CrateDB que se utiliza para importar datos de archivos a tablas de bases de datos. Esta funci\u00f3n tiene un defecto y los atacantes autenticados pueden utilizar la funci\u00f3n COPIAR DE para importar contenido de archivos arbitrario en tablas de bases de datos, lo que provoca una fuga de informaci\u00f3n. Esta vulnerabilidad est\u00e1 parcheada en 5.3.9, 5.4.8, 5.5.4 y 5.6.1."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:cratedb:cratedb:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.3.9", "matchCriteriaId": "FAF44B85-F769-493B-A674-7A8456A874F8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:cratedb:cratedb:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.4.0", "versionEndExcluding": "5.4.8", "matchCriteriaId": "64B0DBA5-7EA3-4398-ACF8-D852EFA5C744"}, {"vulnerable": true, "criteria": "cpe:2.3:a:cratedb:cratedb:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.5.0", "versionEndExcluding": "5.5.4", "matchCriteriaId": "A4ABD3EE-2E41-4CF6-BC26-F947BB6499E2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:cratedb:cratedb:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.6.0", "versionEndExcluding": "5.6.1", "matchCriteriaId": "80901C4B-6B82-40BF-BC22-DA206B95003C"}]}]}], "references": [{"url": "https://github.com/crate/crate/commit/4e857d675683095945dd524d6ba03e692c70ecd6", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/crate/crate/security/advisories/GHSA-475g-vj6c-xf96", "source": "security-advisories@github.com", "tags": ["Exploit", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-24565 - Unauthenticated Remote File Inclusion allows authenticated attackers to import arbitrary file content into database tables, resulting in information leakage, which is mitigated by CrateDB patches 5.3.9, 5.4.8, 5.5.4, and 5.6.1."}, {"techniqueID": "T1224", "comment": "CVE-2024-24565 - Data Injection using the COPY FROM function in CrateDB allows authenticated attackers to import arbitrary file content into database tables, resulting in information leakage, which is mitigated by CrateDB patches 5.3.9, 5.4.8, 5.5.4, and 5.6.1."}, {"techniqueID": "T1190", "comment": "CVE-2024-24565 - Information Disclosure allows authenticated attackers to leak sensitive information, which is mitigated by CrateDB patches 5.3.9, 5.4.8, 5.5.4, and 5.6.1."}, {"techniqueID": "T1068", "comment": "CVE-2024-24565 - File Manipulation using the COPY FROM function in CrateDB allows authenticated attackers to manipulate file content, which is mitigated by CrateDB patches 5.3.9, 5.4.8, 5.5.4, and 5.6.1."}], "stix_bundle": {}, "technical_analysis": {"Introduction": "CrateDB's COPY FROM function allows authenticated attackers to import arbitrary file content into database tables, resulting in information leakage.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5 with a network attack vector, allowing attackers to leak sensitive information.", "Related MITRE ATT&CK Techniques": "T1027, T1224, T1190, and T1068", "Technical Details": "The vulnerability is caused by a flaw in CrateDB's COPY FROM function, which allows authenticated attackers to import arbitrary file content into database tables.", "Detection": "Detecting this vulnerability requires monitoring database logs for suspicious COPY FROM function usage and analyzing database traffic for potential information leakage.", "Mitigation": "Applying CrateDB patches 5.3.9, 5.4.8, 5.5.4, and 5.6.1 is recommended to mitigate this vulnerability.", "Conclusion": "CrateDB users should patch their systems to prevent information leakage and other potential attacks."}, "executive_analysis": {"Overview": "A vulnerability in CrateDB's COPY FROM function allows authenticated attackers to import arbitrary file content into database tables, resulting in information leakage.", "Business Impact": "This vulnerability can lead to information leakage, which can result in significant business risk and reputation damage.", "Technical Impact": "The vulnerability allows attackers to manipulate file content and potentially gain unauthorized access to sensitive information.", "Mitigation Strategies": "Applying CrateDB patches and monitoring database logs for suspicious activity are recommended mitigation strategies.", "Recommendations": "Executives should ensure that all CrateDB systems are patched and configured to prevent information leakage and other potential attacks.", "Conclusions": "Proper patching and configuration of CrateDB systems is critical to preventing information leakage and other potential attacks."}}