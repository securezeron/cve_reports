{"id": "CVE-2007-6479", "sourceIdentifier": "cve@mitre.org", "published": "2007-12-20T20:46:00.000", "lastModified": "2017-09-29T01:29:57.567", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Unrestricted file upload vulnerability in the \"My productions\" component for main/auth/profile.php (aka the \"My profile\" page) in Dokeos 1.8.4 allows remote authenticated users to upload and execute arbitrary PHP files via a filename with a double extension, which can then be accessed through a URI under main/upload/users/."}, {"lang": "es", "value": "Vulnerabilidad de actualizaci\u00f3n de archivos no restrictiva en el componente \"Mis producciones\"  para main/auth/profile.php (tambi\u00e9n conocido como la p\u00e1gina \"Mi perfil\" page) en Dokeos 1.8.4 permite a usuarios remotos validados actualizar y ejecutar archivos PHP de su elecci\u00f3n a trav\u00e9s de un nombre de archivo con una extensi\u00f3n doble, la cual puede ser accedida a trav\u00e9s de una URI bajo main/upload/users/."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.9}, "baseSeverity": "MEDIUM", "exploitabilityScore": 6.8, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:dokeos:dokeos:1.8.4:*:*:*:*:*:*:*", "matchCriteriaId": "644AA10C-A929-4844-8A7A-B4C14FA88744"}]}]}], "references": [{"url": "http://secunia.com/advisories/28154", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/26940", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/39148", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/4753", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059.005", "comment": "CVE-2007-6479 - Unrestricted file upload vulnerability in the Dokeos 1.8.4 allows attackers to upload and execute arbitrary PHP files. This technique can be used to compromise the web application by uploading malicious files"}, {"techniqueID": "T1518.001", "comment": "CVE-2007-6479 - The vulnerability can be exploited by creating a script with the same name as a legitimate file, this can be used to conduct Lateral Movement and gain access to other systems"}, {"techniqueID": "T1218.002", "comment": "CVE-2007-6479 - The unauthorized upload of an arbitrary file can be used to maintain persistence, this can be used to conduct Persistence and maintain access to the system"}, {"techniqueID": "T1505.003", "comment": "CVE-2007-6479 - The vulnerability can be used to conduct command and control, by uploading a malicious file that can be used to execute commands on the system"}], "stix_bundle": "[\n  {\n    \"objects\": [\n      {\n        \"type\": \"vulnerability\",\n        \"id\": \"CVE-2007-6479\",\n        \"name\": \"Unrestricted File Upload Vulnerability in Dokeos\",\n        \"description\": \"Unrestricted file upload vulnerability in Dokeos 1.8.4\",\n        \"published\": \"2007-12-20T20:46:00.000\",\n        \"modified\": \"2017-09-29T01:29:57.567\",\n        \"cvssScore\": 4.9,\n        \"references\": [\n          {\n            \"source\": \"secunia.com\",\n            \"url\": \"http://secunia.com/advisories/28154\"\n          },\n          {\n            \"source\": \"securityfocus.com\",\n            \"url\": \"http://www.securityfocus.com/bid/26940\"\n          },\n          {\n            \"source\": \"exchange.xforce.ibmcloud.com\",\n            \"url\": \"https://exchange.xforce.ibmcloud.com/vulnerabilities/39148\"\n          },\n          {\n            \"source\": \"exploit-db.com\",\n            \"url\": \"https://www.exploit-db.com/exploits/4753\"\n          }\n        ],\n        \"weaknesses\": [\n          {\n            \"source\": \"nvd@nist.gov\",\n            \"type\": \"Primary\",\n            \"description\": {\n              \"lang\": \"en\",\n              \"value\": \"CWE-264\"\n            }\n          }\n        ],\n        \"mitreThreat\":{\"techniques\":[{\"techniqueID\":\"T1059.005\"},{\"techniqueID\":\"T1518.001\"},{\"techniqueID\":\"T1218.002\"},{\"techniqueID\":\"T1505.003\"}],\"tactics\":[{\"tacticID\":\"TA0003\"},{\"tacticID\":\"TA0040\"}]}\n    }\n  ]\n}\n", "technical_analysis": {"Introduction": "Unrestricted file upload vulnerability in the Dokeos 1.8.4 allows attackers to upload and execute arbitrary PHP files.", "Impact and Scope": "The vulnerability has a CVSS score of 4.9 and is rated as medium severity, it is a remote code execution vulnerability.", "Related MITRE ATT&CK Techniques": "T1059.005, T1518.001, T1218.002, T1505.003", "Technical Details": "The vulnerability is due to the lack of restrictions on the upload of files in the application, this allows an attacker to upload a malicious file that can be executed by the web server.", "Detection": "Detection can be done by monitoring the web server logs for suspicious file uploads.", "Mitigation": "Mitigation can be done by implementing a whitelist of allowed file extensions and monitoring the web server logs for suspicious file uploads.", "Conclusion": "The vulnerability can be exploited to conduct remote code execution and can be mitigated by implementing a whitelist of allowed file extensions and monitoring the web server logs for suspicious file uploads."}, "executive_analysis": {"Overview": "The vulnerability is an unrestricted file upload vulnerability in the Dokeos 1.8.4, it is a remote code execution vulnerability.", "Business Impact": "The vulnerability can be used to conduct espionage and intellectual property theft.", "Technical Impact": "The vulnerability can be used to conduct remote code execution and can be mitigated by implementing a whitelist of allowed file extensions and monitoring the web server logs for suspicious file uploads.", "Mitigation Strategies": "Implementing a whitelist of allowed file extensions and monitoring the web server logs for suspicious file uploads can mitigate the vulnerability.", "Recommendations": "Recommendations for executives include conducting penetration testing and vulnerability assessments to identify and remediate vulnerabilities in the network and systems.", "Conclusions": "In conclusion, the vulnerability is an unrestricted file upload vulnerability in the Dokeos 1.8.4 and can be mitigated by implementing a whitelist of allowed file extensions and monitoring the web server logs for suspicious file uploads."}}