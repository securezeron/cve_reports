{"id": "CVE-2020-11077", "sourceIdentifier": "security-advisories@github.com", "published": "2020-05-22T15:15:11.507", "lastModified": "2023-11-07T03:14:29.117", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Puma (RubyGem) before 4.3.5 and 3.12.6, a client could smuggle a request through a proxy, causing the proxy to send a response back to another unknown client. If the proxy uses persistent connections and the client adds another request in via HTTP pipelining, the proxy may mistake it as the first request's body. Puma, however, would see it as two requests, and when processing the second request, send back a response that the proxy does not expect. If the proxy has reused the persistent connection to Puma to send another request for a different client, the second response from the first client will be sent to the second client. This is a similar but different vulnerability from CVE-2020-11076. The problem has been fixed in Puma 3.12.6 and Puma 4.3.5."}, {"lang": "es", "value": "En Puma (RubyGem) versiones anteriores a 4.3.5 y 3.12.6, un cliente podr\u00eda hacer pasar sin autorizaci\u00f3n una petici\u00f3n por medio de un proxy, causando que el proxy env\u00ede una respuesta a otro cliente desconocido. Si el proxy usa conexiones persistentes y el cliente agrega otra petici\u00f3n por medio de la canalizaci\u00f3n HTTP, el proxy puede confundirlo como el cuerpo de la primera petici\u00f3n. Sin embargo, Puma lo ver\u00eda como dos peticiones y, al procesar la segunda petici\u00f3n, devolver\u00eda una respuesta que el proxy no espera. Si el proxy ha reutilizado la conexi\u00f3n persistente a Puma para enviar otra petici\u00f3n para un cliente diferente, la segunda respuesta desde el primer cliente ser\u00e1 enviada al segundo cliente. Esta es una vulnerabilidad similar pero diferente de CVE-2020-11076. El problema se ha corregido en Puma versi\u00f3n 3.12.6 y Puma versi\u00f3n 4.3.5."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.2, "impactScore": 4.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-444"}]}, {"source": "nvd@nist.gov", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-444"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:puma:puma:*:*:*:*:*:ruby:*:*", "versionStartIncluding": "3.0.0", "versionEndExcluding": "3.12.6", "matchCriteriaId": "94D6645C-59B2-466F-A147-B23EF284DEBA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puma:puma:*:*:*:*:*:ruby:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.3.5", "matchCriteriaId": "916E4164-0951-4145-85D6-684EF781F13A"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*", "matchCriteriaId": "E460AA51-FCDA-46B9-AE97-E6676AA5E194"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*", "matchCriteriaId": "B620311B-34A3-48A6-82DF-6F078D7A4493"}, {"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:15.2:*:*:*:*:*:*:*", "matchCriteriaId": "B009C22E-30A4-4288-BCF6-C3E81DEAF45A"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-07/msg00034.html", "source": "security-advisories@github.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2020-07/msg00038.html", "source": "security-advisories@github.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://github.com/puma/puma/blob/master/History.md#434435-and-31253126--2020-05-22", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/puma/puma/security/advisories/GHSA-w64w-qqph-5gxm", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2020/10/msg00009.html", "source": "security-advisories@github.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/SKIY5H67GJIGJL6SMFWFLUQQQR3EMVPR/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-11077 - This vulnerability allows an attacker to smuggle a request through a proxy, potentially leading to unintended behavior. Defend against this by implementing robust proxy management and limitation of HTTP pipelining."}, {"techniqueID": "T1210", "comment": "CVE-2020-11077 - This vulnerability can be used to manipulate persistent connections and send unexpected responses. Defend against this by implementing strict connection limits and close connections after a timeout."}, {"techniqueID": "T1568", "comment": "CVE-2020-11077 - This vulnerability can be used to send unexpected responses, potentially leading to unauthorized data access. Defend against this by implementing strict response validation and error handling."}], "stix_bundle": {"stix_dollars": "http://xml.mitre.org/XMLSchema/cybox_core-2.1/STIX_Package_2.1", "stix_bundle": {"id": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "type": "bundle", "created_by_ref": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "created": "2022-01-01T00:00:00.000", "modified": "2022-01-01T00:00:00.000", "objects": [{"id": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "type": "vulnerability", "stix_id": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "name": "CVE-2020-11077", "description": "In Puma (RubyGem) before 4.3.5 and 3.12.6, a client could smuggle a request through a proxy, causing the proxy to send a response back to another unknown client.", "objects": [{"id": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "type": "course-of-action", "title": "Mitigation 1", "description": "Implement robust proxy management and limitation of HTTP pipelining", "related_objects": [{"id": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "type": "technique", "technique_id": "T1190"}]}, {"id": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "type": "course-of-action", "title": "Mitigation 2", "description": "Implement strict connection limits and close connections after a timeout", "related_objects": [{"id": "urn:uuid:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", "type": "technique", "technique_id": "T1210"}]}]}]}}, "technical_analysis": {"Introduction": "CVE-2020-11077 is a remote code execution vulnerability in Puma, a RubyGem. It allows an attacker to smuggle a request through a proxy, potentially leading to unintended behavior.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5, with an attack vector of NETWORK and attack complexity of LOW. It can be exploited to send unexpected responses, potentially leading to unauthorized data access.", "Related MITRE ATT&CK Techniques": "The vulnerability can be used to execute attacks related to T1190, T1210, and T1568.", "Technical Details": "The vulnerability occurs due to a bug in Puma's handling of persistent connections.", "Detection": "The vulnerability can be detected by monitoring network traffic for suspicious requests and responses.", "Mitigation": "Implement robust proxy management and limitation of HTTP pipelining, and implement strict connection limits and close connections after a timeout.", "Conclusion": "CVE-2020-11077 is a serious vulnerability that requires prompt attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2020-11077 is a remote code execution vulnerability in Puma that can be used to send unexpected responses and access unauthorized data.", "Business Impact": "The vulnerability can lead to data breaches and unauthorized access to sensitive information.", "Technical Impact": "The vulnerability affects the security and integrity of the system.", "Mitigation Strategies": "Implement robust proxy management and limitation of HTTP pipelining, and implement strict connection limits and close connections after a timeout.", "Recommendations": "Recommend that the system administrator take immediate action to mitigate the vulnerability.", "Conclusions": "CVE-2020-11077 is a serious vulnerability that requires prompt attention and mitigation to ensure the security and integrity of the system."}}