{"id": "CVE-2024-39943", "sourceIdentifier": "cve@mitre.org", "published": "2024-07-04T23:15:09.940", "lastModified": "2024-07-08T16:42:25.603", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "rejetto HFS (aka HTTP File Server) 3 before 0.52.10 on Linux, UNIX, and macOS allows OS command execution by remote authenticated users (if they have Upload permissions). This occurs because a shell is used to execute df (i.e., with execSync instead of spawnSync in child_process in Node.js)."}, {"lang": "es", "value": "rejetto HFS (tambi\u00e9n conocido como servidor de archivos HTTP) 3 anterior a 0.52.10 en Linux, UNIX y macOS permite la ejecuci\u00f3n de comandos del sistema operativo por parte de usuarios remotos autenticados (si tienen permisos de carga). Esto ocurre porque se usa un shell para ejecutar df (es decir, con execSync en lugar de spawnSync en child_process en Node.js)."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "cve@mitre.org", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.9, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.1, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}, {"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-284"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:rejetto:http_file_server:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.52.10", "matchCriteriaId": "349B809F-44A2-4734-B8E1-95E1A17CB734"}]}]}], "references": [{"url": "https://github.com/rejetto/hfs/commit/305381bd36eee074fb238b64302a252668daad1d", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://github.com/rejetto/hfs/compare/v0.52.9...v0.52.10", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://www.rejetto.com/wiki/index.php/HFS:_Working_with_uploads", "source": "cve@mitre.org", "tags": ["Product"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-39943 - Allows remote authenticated users to execute OS commands via shell injection. Defend against by implementing sane default settings, validating user input, and restricting permissions."}, {"techniqueID": "T1068", "comment": "CVE-2024-39943 - Allows remote authenticated users to execute OS commands via shell injection. Defend against by implementing sane default settings, validating user input, and restricting permissions."}, {"techniqueID": "T1190", "comment": "CVE-2024-39943 - Allows remote authenticated users to execute OS commands via shell injection. Defend against by implementing sane default settings, validating user input, and restricting permissions."}], "stix_bundle": "{\"type\":\"bundle\",\"objects\":[{\"id\":\"CVE-2024-39943\",\"type\":\"vulnerability\",\"name\":\"CVE-2024-39943\",\"description\":{\"lang\":\"en\",\"value\":\"rejetto HFS (aka HTTP File Server) 3 before 0.52.10 on Linux, UNIX, and macOS allows OS command execution by remote authenticated users (if they have Upload permissions). This occurs because a shell is used to execute df (i.e., with execSync instead of spawnSync in child_process in Node.js).\",\"references\":[{\"url\":\"https://github.com/rejetto/hfs/commit/305381bd36eee074fb238b64302a252668daad1d\",\"source\":\"cve@mitre.org\",\"tags\":[\"Patch\"]},{\"url\":\"https://github.com/rejetto/hfs/compare/v0.52.9...v0.52.10\",\"source\":\"cve@mitre.org\",\"tags\":[\"Patch\"]},{\"url\":\"https://www.rejetto.com/wiki/index.php/HFS:_Working_with_uploads\",\"source\":\"cve@mitre.org\",\"tags\":[\"Product\"]}],\"weaknesses\":[{\"source\":\"nvd@nist.gov\",\"type\":\"Primary\",\"description\":[{\"lang\":\"en\",\"value\":\"CWE-78\"}]},{\"source\":\"134c704f-9b21-4f2e-91b3-4a467353bcc0\",\"type\":\"Secondary\",\"description\":[{\"lang\":\"en\",\"value\":\"CWE-284\"}]}],\"configurations\":[{\"nodes\":[{\"operator\":\"OR\",\"negate\":false,\"cpeMatch\":[{\"vulnerable\":true,\"criteria\":\"cpe:2.3:a:rejetto:http_file_server:*:*:*:*:*:*:*:*\",\"versionEndExcluding\":\"0.52.10\",\"matchCriteriaId\":\"349B809F-44A2-4734-B8E1-95E1A17CB734\"}]}]}],\"metrics\":{\"cvssMetricV31\":[{\"source\":\"nvd@nist.gov\",\"type\":\"Primary\",\"cvssData\":{\"version\":\"3.1\",\"vectorString\":\"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H\",\"attackVector\":\"NETWORK\",\"attackComplexity\":\"LOW\",\"privilegesRequired\":\"LOW\",\"userInteraction\":\"NONE\",\"scope\":\"UNCHANGED\",\"confidentialityImpact\":\"HIGH\",\"integrityImpact\":\"HIGH\",\"availabilityImpact\":\"HIGH\",\"baseScore\":8.8,\"baseSeverity\":\"HIGH\"},\"exploitabilityScore\":2.8,\"impactScore\":5.9},{\"source\":\"cve@mitre.org\",\"type\":\"Secondary\",\"cvssData\":{\"version\":\"3.1\",\"vectorString\":\"CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H\",\"attackVector\":\"NETWORK\",\"attackComplexity\":\"LOW\",\"privilegesRequired\":\"LOW\",\"userInteraction\":\"NONE\",\"scope\":\"CHANGED\",\"confidentialityImpact\":\"HIGH\",\"integrityImpact\":\"HIGH\",\"availabilityImpact\":\"HIGH\",\"baseScore\":9.9,\"baseSeverity\":\"CRITICAL\"},\"exploitabilityScore\":3.1,\"impactScore\":6.0}]}],\"id\":\"CVE-2024-39943\",\"type\":\"Vulnerability\",\"created\":\"2024-07-04T23:15:09.940Z\",\"modified\":\"2024-07-08T16:42:25.603Z\"},{\"id\":\"CWE-78\",\"type\":\"Weakness\",\"name\":\" CWE-78 - Improper Neutralization of Special Elements used in an OS Command\"}]}\n", "technical_analysis": {"Introduction": "rejetto HFS (aka HTTP File Server) 3 before 0.52.10 on Linux, UNIX, and macOS allows OS command execution by remote authenticated users. This occurs because a shell is used to execute df (i.e., with execSync instead of spawnSync in child_process in Node.js).", "Impact and Scope": "The vulnerability has a CVSS score of 9.9 (CRITICAL) with an attack vector of NETWORK, and affects rejetto HFS (aka HTTP File Server) 3 before 0.52.10 on Linux, UNIX, and macOS.", "Related MITRE ATT&CK Techniques": "[T1059, T1068, T1190]", "Technical Details": "The vulnerability is caused by the usage of execSync instead of spawnSync in child_process in Node.js, which allows a remote authenticated user to execute OS commands.", "Detection": "Detection methods include monitoring for suspicious commands being executed and monitoring for changes to configuration files.", "Mitigation": "Mitigation strategies include implementing sane default settings, validating user input, and restricting permissions.", "Conclusion": "In conclusion, the vulnerability is severe and should be addressed promptly."}, "executive_analysis": {"Overview": "rejetto HFS (aka HTTP File Server) 3 before 0.52.10 on Linux, UNIX, and macOS allows OS command execution by remote authenticated users, which has significant business and technical implications.", "Business Impact": "The vulnerability could allow attackers to execute unauthorized commands, which could lead to data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability has significant technical implications, including the potential for remote code execution, data breaches, and system compromise.", "Mitigation Strategies": "Implement sane default settings, validate user input, and restrict permissions.", "Recommendations": "Recommendations include applying security patches, implementing network segmentation, and conducting regular security testing.", "Conclusions": "In conclusion, the vulnerability is severe and requires immediate attention and remediation."}}