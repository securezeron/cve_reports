{
    "id": "CVE-2021-32791",
    "sourceIdentifier": "security-advisories@github.com",
    "published": "2021-07-26T17:15:08.100",
    "lastModified": "2024-11-21T06:07:44.937",
    "vulnStatus": "Modified",
    "cveTags": [],
    "descriptions": [
        {
            "lang": "en",
            "value": "mod_auth_openidc is an authentication/authorization module for the Apache 2.x HTTP server that functions as an OpenID Connect Relying Party, authenticating users against an OpenID Connect Provider. In mod_auth_openidc before version 2.4.9, the AES GCM encryption in mod_auth_openidc uses a static IV and AAD. It is important to fix because this creates a static nonce and since aes-gcm is a stream cipher, this can lead to known cryptographic issues, since the same key is being reused. From 2.4.9 onwards this has been patched to use dynamic values through usage of cjose AES encryption routines."
        },
        {
            "lang": "es",
            "value": "mod_auth_openidc es un m\u00f3dulo de autenticaci\u00f3n/autorizaci\u00f3n para el servidor HTTP Apache versi\u00f3n 2.x que funciona como OpenID Connect Relying Party, autenticando a usuarios contra un OpenID Connect Provider. En mod_auth_openidc versiones anteriores a 2.4.9, el cifrado AES GCM en mod_auth_openidc usa un IV est\u00e1tico y un AAD. Es importante corregirlo porque esto crea un nonce est\u00e1tico y como aes-gcm es un cifrado de flujo, esto puede conllevar a problemas criptogr\u00e1ficos conocidos, ya que se est\u00e1 reutilizando la misma clave. A partir de la versi\u00f3n 2.4.9 esto ha sido parcheado para usar valores din\u00e1micos mediante el uso de rutinas de cifrado AES cjose"
        }
    ],
    "metrics": {
        "cvssMetricV31": [
            {
                "source": "security-advisories@github.com",
                "type": "Secondary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
                    "baseScore": 5.9,
                    "baseSeverity": "MEDIUM",
                    "attackVector": "NETWORK",
                    "attackComplexity": "HIGH",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "NONE",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 2.2,
                "impactScore": 3.6
            },
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "3.1",
                    "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
                    "baseScore": 5.9,
                    "baseSeverity": "MEDIUM",
                    "attackVector": "NETWORK",
                    "attackComplexity": "HIGH",
                    "privilegesRequired": "NONE",
                    "userInteraction": "NONE",
                    "scope": "UNCHANGED",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "NONE",
                    "availabilityImpact": "NONE"
                },
                "exploitabilityScore": 2.2,
                "impactScore": 3.6
            }
        ],
        "cvssMetricV2": [
            {
                "source": "nvd@nist.gov",
                "type": "Primary",
                "cvssData": {
                    "version": "2.0",
                    "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
                    "baseScore": 4.3,
                    "accessVector": "NETWORK",
                    "accessComplexity": "MEDIUM",
                    "authentication": "NONE",
                    "confidentialityImpact": "PARTIAL",
                    "integrityImpact": "NONE",
                    "availabilityImpact": "NONE"
                },
                "baseSeverity": "MEDIUM",
                "exploitabilityScore": 8.6,
                "impactScore": 2.9,
                "acInsufInfo": false,
                "obtainAllPrivilege": false,
                "obtainUserPrivilege": false,
                "obtainOtherPrivilege": false,
                "userInteractionRequired": false
            }
        ]
    },
    "weaknesses": [
        {
            "source": "security-advisories@github.com",
            "type": "Secondary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-323"
                },
                {
                    "lang": "en",
                    "value": "CWE-330"
                }
            ]
        },
        {
            "source": "nvd@nist.gov",
            "type": "Primary",
            "description": [
                {
                    "lang": "en",
                    "value": "CWE-330"
                }
            ]
        }
    ],
    "configurations": [
        {
            "operator": "AND",
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:a:openidc:mod_auth_openidc:*:*:*:*:*:*:*:*",
                            "versionEndExcluding": "2.4.9",
                            "matchCriteriaId": "FAEFDBA2-55AD-410B-95C4-D2524C65B4A8"
                        }
                    ]
                },
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": false,
                            "criteria": "cpe:2.3:a:apache:http_server:*:*:*:*:*:*:*:*",
                            "versionStartIncluding": "2.0.0",
                            "versionEndIncluding": "2.4.48",
                            "matchCriteriaId": "BC9C65B5-0989-4D64-9BED-1E391AD971AE"
                        }
                    ]
                }
            ]
        },
        {
            "nodes": [
                {
                    "operator": "OR",
                    "negate": false,
                    "cpeMatch": [
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*",
                            "matchCriteriaId": "E460AA51-FCDA-46B9-AE97-E6676AA5E194"
                        },
                        {
                            "vulnerable": true,
                            "criteria": "cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*",
                            "matchCriteriaId": "A930E247-0B43-43CB-98FF-6CE7B8189835"
                        }
                    ]
                }
            ]
        }
    ],
    "references": [
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/commit/375407c16c61a70b56fdbe13b0d2c8f11398e92c",
            "source": "security-advisories@github.com",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/releases/tag/v2.4.9",
            "source": "security-advisories@github.com",
            "tags": [
                "Release Notes",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/security/advisories/GHSA-px3c-6x7j-3r9r",
            "source": "security-advisories@github.com",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://lists.debian.org/debian-lts-announce/2023/04/msg00034.html",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FZVF6BSJLRQZ7PFFR4X5JSU6KUJYNOCU/",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QXAWKPT5LXZSUTFSJ6IWSZC7RMYYQXQD/",
            "source": "security-advisories@github.com"
        },
        {
            "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
            "source": "security-advisories@github.com",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/commit/375407c16c61a70b56fdbe13b0d2c8f11398e92c",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/releases/tag/v2.4.9",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Release Notes",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://github.com/zmartzone/mod_auth_openidc/security/advisories/GHSA-px3c-6x7j-3r9r",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        },
        {
            "url": "https://lists.debian.org/debian-lts-announce/2023/04/msg00034.html",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FZVF6BSJLRQZ7PFFR4X5JSU6KUJYNOCU/",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QXAWKPT5LXZSUTFSJ6IWSZC7RMYYQXQD/",
            "source": "af854a3a-2127-422b-91ae-364da2661108"
        },
        {
            "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
            "source": "af854a3a-2127-422b-91ae-364da2661108",
            "tags": [
                "Patch",
                "Third Party Advisory"
            ]
        }
    ],
    "techniques": [
        {
            "techniqueID": "T1548.001",
            "comment": "CVE-2021-32791 - Reusing a static IV and AAD in AES-GCM encryption can be exploited by an attacker to bypass authentication and access sensitive data. A defender can detect this by monitoring for unusual authentication patterns andimplementing dynamic IVs and AADs."
        },
        {
            "techniqueID": "T1134.003",
            "comment": "CVE-2021-32791 - The reuse of a static IV can be exploited by an attacker to downgrade the encryption of sensitive data. A defender can detect this by monitoring for unusual encryption patterns and implementing dynamic IVs."
        },
        {
            "techniqueID": "T1190",
            "comment": "CVE-2021-32791 - The static IV and AAD used in AES-GCM encryption can be exploited by an attacker to compromise the confidentiality and integrity of sensitive data. A defender can detect this by monitoring for unusual authentication patterns and implementing countermeasures like intrusion detection systems."
        }
    ],
    "technical_analysis": {
        "Introduction": "mod_auth_openidc is an authentication/authorization module for the Apache 2.x HTTP server that functions as an OpenID Connect Relying Party, authenticating users against an OpenID Connect Provider. In mod_auth_openidc before version 2.4.9, the AES GCM encryption uses a static IV and AAD, which can be exploited by an attacker to bypass authentication and access sensitive data.",
        "Impact and Scope": "This vulnerability has a CVSS score of 5.9 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H). It affects mod_auth_openidc versions prior to 2.4.9 and allows an attacker to compromise the confidentiality and integrity of sensitive data.",
        "Related MITRE ATT&CK Techniques": "related techniques include T1548.001, T1134.003, and T1190",
        "Technical Details": "The mod_auth_openidc module uses AES-GCM encryption to protect sensitive data. However, before version 2.4.9, it uses a static IV and AAD, which can be exploited by an attacker to bypass authentication and access sensitive data.",
        "Detection": "A defender can detect this vulnerability by monitoring for unusual authentication patterns and implementing dynamic IVs and AADs. Furthermore, they can use intrusion detection systems and network monitoring tools to detect and prevent attacks.",
        "Mitigation": "The vulnerability is fixed in mod_auth_openidc versions 2.4.9 and above. A defender can mitigate this vulnerability by upgrading to the latest version and implementing dynamic IVs and AADs.",
        "Conclusion": "The CVE-2021-32791 vulnerability is a critical issue that can be exploited by an attacker to bypass authentication and access sensitive data. It is essential to patch the vulnerability and implement countermeasures to detect and prevent attacks."
    },
    "executive_analysis": {
        "Overview": "The CVE-2021-32791 vulnerability is a critical issue that affects the mod_auth_openidc module in Apache 2.x HTTP server. It can be exploited by an attacker to bypass authentication and access sensitive data.",
        "Business Impact": "This vulnerability can have a significant business impact as it allows an attacker to access sensitive data, which can lead to financial loss, reputational damage, and compliance issues.",
        "Technical Impact": "This vulnerability has a technical impact on the mod_auth_openidc module, as it allows an attacker to bypass authentication and access sensitive data.",
        "Mitigation Strategies": "To mitigate this vulnerability, it is essential to patch the mod_auth_openidc module and implement dynamic IVs and AADs.",
        "Recommendations": "We recommend that executives prioritize patching the mod_auth_openidc module and implementing countermeasures to detect and prevent attacks.",
        "Conclusions": "In conclusion, the CVE-2021-32791 vulnerability is a critical issue that requires immediate attention. Patching the mod_auth_openidc module and implementing countermeasures is essential to prevent attacks."
    }
}