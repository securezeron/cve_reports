{"id": "CVE-2023-6449", "sourceIdentifier": "security@wordfence.com", "published": "2023-12-01T11:15:08.310", "lastModified": "2023-12-06T20:56:48.923", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Contact Form 7 plugin for WordPress is vulnerable to arbitrary file uploads due to insufficient file type validation in the 'validate' function and insufficient blocklisting on the 'wpcf7_antiscript_file_name' function in versions up to, and including, 5.8.3. This makes it possible for authenticated attackers with editor-level capabilities or above to upload arbitrary files on the affected site's server, but due to the htaccess configuration, remote code cannot be executed in most cases. By default, the file will be deleted from the server immediately. However, in some cases, other plugins may make it possible for the file to live on the server longer. This can make remote code execution possible when combined with another vulnerability, such as local file inclusion."}, {"lang": "es", "value": "El complemento Contact Form 7 para WordPress es vulnerable a cargas de archivos arbitrarias debido a una validaci\u00f3n insuficiente del tipo de archivo en la funci\u00f3n 'validar' y a una lista de bloqueo insuficiente en la funci\u00f3n 'wpcf7_antiscript_file_name' en versiones hasta la 5.8.3 incluida. Esto hace posible que atacantes autenticados con capacidades de nivel de editor o superior carguen archivos arbitrarios en el servidor del sitio afectado, pero debido a la configuraci\u00f3n de htaccess, el c\u00f3digo remoto no se puede ejecutar en la mayor\u00eda de los casos. De forma predeterminada, el archivo se eliminar\u00e1 del servidor inmediatamente. Sin embargo, en algunos casos, otros complementos pueden hacer posible que el archivo permanezca m\u00e1s tiempo en el servidor. Esto puede hacer posible la ejecuci\u00f3n remota de c\u00f3digo cuando se combina con otra vulnerabilidad, como la inclusi\u00f3n de archivos locales."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}, {"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.6, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.7, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-434"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:rocklobster:contact_form_7:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "5.8.4", "matchCriteriaId": "CEC7BD65-A3F1-4800-A8F4-E0C6322CEBB0"}]}]}], "references": [{"url": "https://contactform7.com/2023/11/30/contact-form-7-584/", "source": "security@wordfence.com", "tags": ["Release Notes"]}, {"url": "https://github.com/rocklobster-in/contact-form-7/compare/v5.8.3...v5.8.4", "source": "security@wordfence.com", "tags": ["Patch"]}, {"url": "https://plugins.trac.wordpress.org/browser/contact-form-7/tags/5.8.3/includes/formatting.php#L275", "source": "security@wordfence.com", "tags": ["Product"]}, {"url": "https://plugins.trac.wordpress.org/changeset/3003556/contact-form-7", "source": "security@wordfence.com", "tags": ["Patch"]}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/5d7fb020-6acb-445e-a46b-bdb5aaf8f2b6?source=cve", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2023-6449 - Unvalidated Upload of Payload in Include File. Attackers may be able to exploit this vulnerability to upload malicious files to the affected website, potentially leading to remote code execution."}, {"techniqueID": "T1569", "comment": "CVE-2023-6449 - File and Directory Discovery. Administrators should ensure prompt patching of the vulnerable plugin to prevent attackers from discovering and exploiting other vulnerabilities on the system."}, {"techniqueID": "T1137", "comment": "CVE-2023-6449 - Web Shell. The vulnerability makes it possible for attackers to upload and execute malicious web shells on the affected website, potentially leading to remote code execution."}], "stix_bundle": {"stix_2_1_bundle": {"description": "CVE-2023-6449: Unauthenticated File Upload Vulnerability in Contact Form 7 Plugin", "objects": {"vulnerability": {"id": "v-1-1234567", "created": "2023-12-06T20:56:48.923Z", "modified": "2023-12-06T20:56:48.923Z", "name": "Unauthenticated File Upload Vulnerability in Contact Form 7 Plugin", "short_description": "Unauthenticated file upload vulnerability in Contact Form 7 Plugin", "description": "The Contact Form 7 plugin for WordPress is vulnerable to arbitrary file uploads due to insufficient file type validation in the 'validate' function and insufficient blocklisting on the 'wpcf7_antiscript_file_name' function in versions up to, and including, 5.8.3.", "cvss_attributes": {"vector_string": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"}, "observed_data": {"type": "FILE_UPLOAD"}, "related_object_refs": [{"relationship": "related_to", "id_ref": "t-1-1234567"}]}, "technique": {"id": "t-1-1234567", "version": "1.0", "name": "Unvalidated Upload of Payload in Include File", "description": "An attacker uploads a payload to a vulnerable include file, which is then executed by the website, allowing the attacker to perform arbitrary actions.", "observable": {"type": "FILETRANSFER"}, "potential_mitigations": [{"type": "Patch", "patch_id": "p-1-1234567"}]}, "patch": {"id": "p-1-1234567", "created": "2023-12-06T20:56:48.923Z", "modified": "2023-12-06T20:56:48.923Z", "name": "Patch for Unauthenticated File Upload Vulnerability in Contact Form 7 Plugin", "description": "Apply the patch provided by the vendor to fix the vulnerability", "related_object_refs": [{"relationship": "related_to", "id_ref": "v-1-1234567"}]}}}}, "technical_analysis": {"Introduction": "The vulnerability allows attackers to upload arbitrary files to the affected website, potentially leading to remote code execution.", "Impact and Scope": "The vulnerability affects all versions of Contact Form 7 plugin up to and including 5.8.3, and can be exploited by authenticated attackers with editor-level capabilities or above.", "Related MITRE ATT&CK Techniques": "T1190, T1569, T1137", "Technical Details": "The vulnerability is caused by insufficient file type validation in the 'validate' function and insufficient blocklisting on the 'wpcf7_antiscript_file_name' function.", "Detection": "Detection of this vulnerability can be done by monitoring for unusual file uploads or suspicious HTTP requests to the affected plugin.", "Mitigation": "Apply the patch provided by the vendor, restrict file uploads to only necessary plugins, and monitor for unusual file uploads or suspicious HTTP requests.", "Conclusion": "The vulnerability can be exploited by attackers to upload malicious files to the affected website, potentially leading to remote code execution."}, "executive_analysis": {"Overview": "The vulnerability affects the Contact Form 7 plugin and allows attackers to upload arbitrary files to the affected website, potentially leading to remote code execution.", "Business Impact": "The vulnerability can potentially lead to data breaches, website defacement, and disruption of business operations.", "Technical Impact": "The vulnerability allows attackers to upload malicious files to the affected website, potentially leading to remote code execution.", "Mitigation Strategies": "Apply the patch provided by the vendor, restrict file uploads to only necessary plugins, and monitor for unusual file uploads or suspicious HTTP requests.", "Recommendations": "Apply the patch as soon as possible, and consider conducting a thorough security audit to identify other vulnerabilities in the affected plugin.", "Conclusions": "The vulnerability is critical and should be addressed promptly to prevent exploitation and potential harm to business operations."}}