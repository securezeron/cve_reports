{"id": "CVE-2020-7261", "sourceIdentifier": "trellixpsirt@trellix.com", "published": "2020-04-15T12:15:12.090", "lastModified": "2023-11-07T03:25:46.680", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Buffer Overflow via Environment Variables vulnerability in AMSI component in McAfee Endpoint Security (ENS) Prior to 10.7.0 February 2020 Update allows local users to disable Endpoint Security via a carefully crafted user input."}, {"lang": "es", "value": "Una vulnerabilidad de Desbordamiento de B\u00fafer por medio de Variables de Entorno en el componente AMSI en McAfee Endpoint Security (ENS) versiones anteriores a 10.7.0 Update de Febrero de 2020, permite a usuarios locales desactivar Endpoint Security por medio de una entrada de usuario cuidadosamente dise\u00f1ada."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}, {"source": "trellixpsirt@trellix.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:H/I:L/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.8, "impactScore": 4.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:N/I:P/A:N", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 2.1}, "baseSeverity": "LOW", "exploitabilityScore": 3.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-120"}]}, {"source": "trellixpsirt@trellix.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mcafee:endpoint_security:10.5.0:*:*:*:*:windows:*:*", "matchCriteriaId": "6AC514CA-D094-433D-9561-99048D43902F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mcafee:endpoint_security:10.5.1:*:*:*:*:windows:*:*", "matchCriteriaId": "1B7AE3E9-DDCE-4119-B57D-B3D471E05B16"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mcafee:endpoint_security:10.5.2:*:*:*:*:windows:*:*", "matchCriteriaId": "603FE358-FADA-4FE6-B3F2-169D032A57E9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mcafee:endpoint_security:10.5.3:*:*:*:*:windows:*:*", "matchCriteriaId": "66461D42-AE21-41B3-9FCB-3F6D09AC323E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mcafee:endpoint_security:10.5.4:*:*:*:*:windows:*:*", "matchCriteriaId": "DCC441CF-5EA0-41C1-AE15-6672FF20B73A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mcafee:endpoint_security:10.5.5:*:*:*:*:windows:*:*", "matchCriteriaId": "A6551AB4-1B0F-4EE3-8ED1-99413E3F19DD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mcafee:endpoint_security:10.6.0:*:*:*:*:windows:*:*", "matchCriteriaId": "94732038-F35D-41AB-A550-E6F5FF9004DF"}]}]}], "references": [{"url": "https://kc.mcafee.com/corporate/index?page=content&id=SB10309", "source": "trellixpsirt@trellix.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-7261 - Local File Inclusion attack using a carefully crafted environment variable, allowing attackers to disable McAfee Endpoint Security. This technique is relevant as it can be used to bypass security controls."}, {"techniqueID": "T1204", "comment": "CVE-2020-7261 - Command Injection using a crafted environment variable, allowing attackers to execute arbitrary commands. This technique is relevant as it can be used to elevate privileges and gain a foothold."}, {"techniqueID": "T1027", "comment": "CVE-2020-7261 - Windows API call hooking by manipulating environment variables, allowing attackers to intercept API calls and execute malicious code. This technique is relevant as it can be used to achieve persistence and elevate privileges."}], "technical_analysis": {"Introduction": "The CVE-2020-7261 vulnerability in McAfee Endpoint Security allows attackers to disable the security feature by manipulating environment variables. This vulnerability can be exploited by local users, making it a significant threat.", "Impact and Scope": "The vulnerability has a CVSS score of 5.5, with an attack vector of local and a base severity of high. It can be exploited by local users to disable the security feature, allowing attackers to elevate privileges and gain a foothold.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the T1190, T1204, and T1027 MITRE ATT&CK techniques. These techniques can be used to exploit the vulnerability and achieve persistence, elevate privileges, and execute malicious code.", "Technical Details": "The vulnerability occurs due to the improper handling of environment variables in the AMSI component of McAfee Endpoint Security. By manipulating environment variables, attackers can execute arbitrary code and disable the security feature.", "Detection": "The vulnerability can be detected using memory forensics and process monitoring. Security analysts can look for unexpected changes in environment variables and API calls.", "Mitigation": "The vulnerability can be mitigated by patching the vulnerable component, using security features like Windows Firewall to restrict API calls, and implementing strict access controls for environment variables.", "Conclusion": "The CVE-2020-7261 vulnerability in McAfee Endpoint Security is a significant threat that can be exploited by local users. Security analysts and administrators must take proactive measures to detect and mitigate the vulnerability."}, "executive_analysis": {"Overview": "The CVE-2020-7261 vulnerability in McAfee Endpoint Security allows attackers to disable the security feature by manipulating environment variables. This vulnerability can be exploited by local users, making it a significant threat to the organization.", "Business Impact": "The vulnerability can impact the organization's security posture, allowing attackers to elevate privileges and gain access to sensitive data. This can result in significant financial and reputational losses.", "Technical Impact": "The vulnerability can allow attackers to execute arbitrary code, disable security features, and gain a foothold on the system. This can lead to further exploitation and compromise of the system.", "Mitigation Strategies": "The organization should patch the vulnerable component, implement strict access controls for environment variables, and monitor system logs for suspicious activity.", "Recommendations": "Security analysts and administrators should take proactive measures to detect and mitigate the vulnerability. Regular security audits and assessments should be conducted to identify and address vulnerabilities like this.", "Conclusions": "The CVE-2020-7261 vulnerability in McAfee Endpoint Security is a significant threat that requires immediate attention and mitigation. The organization should take a proactive approach to ensure its security posture is robust and effective."}}