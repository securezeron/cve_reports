{"id": "CVE-2024-3135", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-01T19:15:46.257", "lastModified": "2024-04-16T12:15:10.367", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A Cross-Site Request Forgery (CSRF) vulnerability exists in the mudler/localai application, allowing attackers to craft malicious webpages that, when visited by a victim, perform unauthorized actions on the victim's local LocalAI instance without their consent. This vulnerability enables attackers to exhaust system resources, consume credits, and fill disk space by making numerous resource-intensive API calls, such as generating images or uploading files. The vulnerability stems from the application's acceptance of simple request content-types without requiring CSRF tokens or implementing other CSRF mitigation measures. Successful exploitation does not require network access to the vulnerable LocalAI environment."}, {"lang": "es", "value": "El servidor web carec\u00eda de tokens CSRF, lo que permit\u00eda a un atacante alojar JavaScript malicioso en un host que, cuando lo visitaba un usuario de LocalAI, pod\u00eda permitirle al atacante llenar espacio en el disco para denegar el servicio o abusar de los cr\u00e9ditos."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "references": [{"url": "https://huntr.com/bounties/7afdc4d3-4b68-45ea-96d0-cf9ed3712ae8", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1550", "comment": "CVE-2024-3135 - This Cross-Site Request Forgery (CSRF) vulnerability enables attackers to craft malicious webpages that, when visited by a victim, perform unauthorized actions on the victim's local LocalAI instance without their consent."}, {"techniqueID": "T1190", "comment": "CVE-2024-3135 - This exploitation of the vulnearbility can be used to perform CSRF attacks, making it a potential vector for delivering malware or escalating privileges."}, {"techniqueID": "T1566", "comment": "CVE-2024-3135 - Attackers can use this vulnerability to make numerous resource-intensive API calls, consuming system resources, filling disk space and exhausting system resources, potentially leading to a Denial of Service (DoS) or exfiltration of data."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/bundle/CVE-2024-3135", "created_by_ref": "https://example.com/user/MitreAttck", "modified": "2024-04-16T12:15:10.367", "stix_objects": [{"type": "vulnerability", "id": "https://example.com/object/CVE-2024-3135", "created_by_ref": "https://example.com/user/MitreAttck", "modified": "2024-04-16T12:15:10.367", "name": "CVE-2024-3135: Cross-Site Request Forgery (CSRF) Vulnerability", "description": "A Cross-Site Request Forgery (CSRF) vulnerability exists in the mudler/localai application, allowing attackers to craft malicious webpages that, when visited by a victim, perform unauthorized actions on the victim's local LocalAI instance without their consent.", "x_mitre_attack_pattern": "https://example.com/object/T1550", "x_mitre_sector": "https://example.com/object/Finance_and_Banking", "objects": [{"type": "exploit", "id": "https://example.com/object/CVE-2024-3135/Exploit", "created_by_ref": "https://example.com/user/MitreAttck", "modified": "2024-04-16T12:15:10.367", "name": "Exploit for CVE-2024-3135", "description": "An exploit for the CVE-2024-3135 vulnerability, allowing attackers to craft malicious webpages that, when visited by a victim, perform unauthorized actions on the victim's local LocalAI instance without their consent."}], "relationships": [{"type": "exploits", "id": "https://example.com/relationship/CVE-2024-3135/Exploit", "source_ref": "https://example.com/object/CVE-2024-3135", "target_ref": "https://example.com/object/CVE-2024-3135/Exploit", "label": "exploits"}]}, {"type": "course_of_action", "id": "https://example.com/object/CVE-2024-3135/Course_of_Action", "created_by_ref": "https://example.com/user/MitreAttck", "modified": "2024-04-16T12:15:10.367", "name": "Mitigating CVE-2024-3135", "description": "Implementing CSRF protection and validation in the LocalAI application to prevent exploitation of this vulnerability.", "x_mitre_attack_pattern": "https://example.com/object/T1190", "relationships": [{"type": "mitigates", "id": "https://example.com/relationship/CVE-2024-3135/Course_of_Action", "source_ref": "https://example.com/object/CVE-2024-3135/Course_of_Action", "target_ref": "https://example.com/object/T1190", "label": "mitigates"}]}]}, "technical_analysis": {"Introduction": "The Cross-Site Request Forgery (CSRF) vulnerability in the LocalAI application allows attackers to craft malicious webpages that, when visited by a victim, perform unauthorized actions on the victim's local LocalAI instance without their consent.", "Impact and Scope": "CVSS 3.0 score: 6.5, Attack Vector: NETWORK, Attack Complexity: LOW, Privileges Required: NONE, User Interaction: REQUIRED, Scope: UNCHANGED, Confidentiality Impact: NONE, Integrity Impact: NONE, Availability Impact: HIGH.", "Related MITRE ATT&CK Techniques": "T1550, T1190, T1566", "Technical Details": "The vulnerability stems from the application's acceptance of simple request content-types without requiring CSRF tokens or implementing other CSRF mitigation measures.", "Detection": "Signature-based detection is possible, but more advanced methods such as behavior-based detection or memory analysis may be required.", "Mitigation": "Implementing CSRF protection and validation in the LocalAI application, rate limiting API calls, and monitoring for suspicious activity can help mitigate this vulnerability.", "Conclusion": "A thorough analysis of the vulnerability and its impact on the LocalAI application is crucial for understanding the potential risks and developing effective mitigation strategies."}, "executive_analysis": {"Overview": "CVE-2024-3135 is a CSRF vulnerability in the LocalAI application that allows attackers to craft malicious webpages that, when visited by a victim, perform unauthorized actions on the victim's local LocalAI instance without their consent.", "Business Impact": "This vulnerability has the potential to result in unauthorized changes to the victim's local AI instance, potentially leading to a loss of productivity, confidentiality, and integrity.", "Technical Impact": "The vulnerability is a serious threat to the confidentiality, integrity, and availability of the LocalAI application, as it allows attackers to perform unauthorized actions without user consent.", "Mitigation Strategies": "Implementing CSRF protection and validation in the LocalAI application, rate limiting API calls, and monitoring for suspicious activity are key strategies for mitigating this vulnerability.", "Recommendations": "We recommend that the LocalAI development team address this vulnerability as soon as possible to prevent potential attacks and ensure the continued security and reliability of the application.", "Conclusions": "A comprehensive analysis of the vulnerability and its impact on the LocalAI application is crucial for understanding the potential risks and developing effective mitigation strategies."}}