{"id": "CVE-2024-38564", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-19T14:15:16.560", "lastModified": "2024-06-20T12:44:01.637", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Add BPF_PROG_TYPE_CGROUP_SKB attach type enforcement in BPF_LINK_CREATE\n\nbpf_prog_attach uses attach_type_to_prog_type to enforce proper\nattach type for BPF_PROG_TYPE_CGROUP_SKB. link_create uses\nbpf_prog_get and relies on bpf_prog_attach_check_attach_type\nto properly verify prog_type <> attach_type association.\n\nAdd missing attach_type enforcement for the link_create case.\nOtherwise, it's currently possible to attach cgroup_skb prog\ntypes to other cgroup hooks."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: bpf: agregue la aplicaci\u00f3n del tipo de archivo adjunto BPF_PROG_TYPE_CGROUP_SKB en BPF_LINK_CREATE bpf_prog_attach usa adjunto_type_to_prog_type para aplicar el tipo de archivo adjunto adecuado para BPF_PROG_TYPE_CGROUP_SKB. link_create usa bpf_prog_get y se basa en bpf_prog_attach_check_attach_type para verificar correctamente la asociaci\u00f3n prog_type &lt;&gt; adjunto_tipo. Agregue la aplicaci\u00f3n de adjunto_tipo faltante para el caso link_create. De lo contrario, actualmente es posible adjuntar tipos de programa cgroup_skb a otros enlaces de cgroup."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/543576ec15b17c0c93301ac8297333c7b6e84ac7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6675c541f540a29487a802d3135280b69b9f568d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/67929e973f5a347f05fef064fea4ae79e7cdb5fd", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b34bbc76651065a5eafad8ddff1eb8d1f8473172", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2024-38564 - Initial Access via Network: This is relevant as the Linux kernel vulnerability could be exploited to gain initial access to a vulnerable system."}, {"techniqueID": "TA0002", "comment": "CVE-2024-38564 - Execution via Exploitation: The vulnerability in the Linux kernel could be exploited to execute malicious code, allowing an attacker to further compromise the system."}, {"techniqueID": "TA0005", "comment": "CVE-2024-38564 - Defense Evasion via Code Injection: An attacker could use this vulnerability to inject malicious code into the Linux kernel, which could evade detection by security software."}, {"techniqueID": "TA0006", "comment": "CVE-2024-38564 - Command and Control: The vulnerability could be used to establish a command and control (C2) channel with a remote server, allowing an attacker to remotely control the compromised system."}], "stix_bundle": "{\"stix Bundle\":{\"vulnerability:\":{\"id\":\"CVE-2024-38564\",\"description\":\"In the Linux kernel, the following vulnerability has been resolved:\nbpf: Add BPF_PROG_TYPE_CGROUP_SKB attach type enforcement in BPF_LINK_CREATE\\n\\nbpf_prog_attach uses attach_type_to_prog_type to enforce proper\\nattach type for BPF_PROG_TYPE_CGROUP_SKB. link_create uses\\nbpf_prog_get and relies on bpf_prog_attach_check_attach_type\\nto properly verify prog_type <> attach_type association.\\n\\nAdd missing attach_type enforcement for the link_create case.\\nOtherwise, it's currently possible to attach cgroup_skb prog\\ntypes to other cgroup hooks.\"},\"mitigations\":{\"mitigation-1\":{\"description\":\"Apply the relevant kernel patch\",\"tactics\":{\"tactic-1\":{\"name\":\"Patch Management\"}}},\"mitigation-2\":{\"description\":\"Use a validated and up-to-date Linux kernel\",\"tactics\":{\"tactic-1\":{\"name\":\"Configuration Management\"}}},\"references\":[{\"url\":\"https://git.kernel.org/stable/c/543576ec15b17c0c93301ac8297333c7b6e84ac7\",\"source\":\"416baaa9-dc9f-4396-8d5f-8c081fb06d67\"},{\"url\":\"https://git.kernel.org/stable/c/6675c541f540a29487a802d3135280b69b9f568d\",\"source\":\"416baaa9-dc9f-4396-8d5f-8c081fb06d67\"},{\"url\":\"https://git.kernel.org/stable/c/67929e973f5a347f05fef064fea4ae79e7cdb5fd\",\"source\":\"416baaa9-dc9f-4396-8d5f-8c081fb06d67\"},{\"url\":\"https://git.kernel.org/stable/c/b34bbc76651065a5eafad8ddff1eb8d1f8473172\",\"source\":\"416baaa9-dc9f-4396-8d5f-8c081fb06d67\"}]}}", "technical_analysis": {"Introduction": "The CVE-2024-38564 vulnerability is a Linux kernel vulnerability that affects the bpf program type enforcement in BPF_LINK_CREATE.", "Impact and Scope": "This vulnerability has a CVSS score of 8.1 (AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H).", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are TA0001, TA0002, TA0005, and TA0006.", "Technical Details": "The vulnerability is caused by missing attach type enforcement for the link_create case, which allows an attacker to attach cgroup_skb prog types to other cgroup hooks.", "Detection": "Detection of this vulnerability can be done by using security software that checks for kernel-level exploitation.", "Mitigation": "Mitigation strategies include applying the relevant kernel patch, using a validated and up-to-date Linux kernel, and implementing strict control over cgroup_skb prog types.", "Conclusion": "In conclusion, the CVE-2024-38564 vulnerability is a significant threat to Linux systems and requires immediate attention to mitigate the risk of exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-38564 vulnerability is a critical Linux kernel vulnerability that affects the bpf program type enforcement in BPF_LINK_CREATE.", "Business Impact": "This vulnerability has the potential to cause significant business disruptions and data breaches.", "Technical Impact": "The vulnerability allows an attacker to gain initial access to a vulnerable system, execute malicious code, and evade detection.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability are applying the relevant kernel patch, using a validated and up-to-date Linux kernel, and implementing strict control over cgroup_skb prog types.", "Recommendations": "Recommendations for executives include prioritizing patching and kernel updates, implementing robust security measures, and conducting regular security assessments.", "Conclusions": "In conclusion, the CVE-2024-38564 vulnerability is a critical threat that requires immediate attention and prioritization."}}