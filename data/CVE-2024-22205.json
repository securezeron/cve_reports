{"id": "CVE-2024-22205", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-23T18:15:18.667", "lastModified": "2024-01-29T19:48:58.590", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Whoogle Search is a self-hosted metasearch engine. In versions 0.8.3 and prior, the `window` endpoint does not sanitize user-supplied input from the `location` variable and passes it to the `send` method which sends a `GET` request on lines 339-343 in `request.py,` which leads to a server-side request forgery. This issue allows for crafting GET requests to internal and external resources on behalf of the server. For example, this issue would allow for accessing resources on the internal network that the server has access to, even though these resources may not be accessible on the internet. This issue is fixed in version 0.8.4.\n\n"}, {"lang": "es", "value": "Whoogle Search es un metabuscador autohospedado. En las versiones 0.8.3 y anteriores, el punto final `window` no desinfecta la entrada proporcionada por el usuario desde la variable `location` y la pasa al m\u00e9todo `send` que env\u00eda una solicitud `GET` en las l\u00edneas 339-343 en `request .py`, lo que conduce a server-side request forgery. Este problema permite elaborar solicitudes GET a recursos internos y externos en nombre del servidor. Por ejemplo, este problema permitir\u00eda acceder a recursos en la red interna a la que tiene acceso el servidor, aunque es posible que no se pueda acceder a estos recursos en Internet. Este problema se solucion\u00f3 en la versi\u00f3n 0.8.4."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-918"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:benbusby:whoogle_search:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.8.4", "matchCriteriaId": "D3DA218E-B891-4381-97E4-F0F1147E6309"}]}]}], "references": [{"url": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/request.py#L339-L343", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L479", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L496-L557", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://github.com/benbusby/whoogle-search/blob/92e8ede24e9277a5440d403f75877209f1269884/app/routes.py#L497", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://github.com/benbusby/whoogle-search/commit/3a2e0b262e4a076a20416b45e6b6f23fd265aeda", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://securitylab.github.com/advisories/GHSL-2023-186_GHSL-2023-189_benbusby_whoogle-search/", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-22205 - This Server-Side Request Forgery (SSRF) vulnerability allows an attacker to send arbitrary GET requests on behalf of the server, which can be used to access internal and external resources. This technique is relevant as it allows an attacker to bypass security controls and gain unauthorized access to sensitive data."}, {"techniqueID": "T1036", "comment": "CVE-2024-22205 - This vulnerability also allows an attacker to craft GET requests to internal and external resources, which can be used to gather information about the internal infrastructure and network layout. This technique is relevant as it allows an attacker to gather sensitive information and plan future attacks."}, {"techniqueID": "T1191", "comment": "CVE-2024-22205 - This vulnerability can also be used to transmit arbitrary data to external servers, which can be used to conduct data exfiltration attacks. This technique is relevant as it allows an attacker to exfiltrate sensitive data from the affected system."}, {"techniqueID": "T1130", "comment": "CVE-2024-22205 - This vulnerability can also be used to conduct man-in-the-middle (MitM) attacks, which can be used to intercept and manipulate traffic between the affected system and external servers. This technique is relevant as it allows an attacker to intercept sensitive data and manipulate it for malicious purposes."}], "stix_bundle": {"type": "bundle", "id": "urn:ietf:params:stix:bundle:1.0", "timestamp": "2024-02-01T00:00:00.000Z", "spec_version": "2.1", "handles": [{"id": "urn:ietf:params:stix:indicator:1.2", "type": "indicator", "created": "2024-02-01T00:00:00.000Z", "modified": "2024-02-01T00:00:00.000Z", "name": "CVE-2024-22205", "description": "CVE-2024-22205 is a Server-Side Request Forgery (SSRF) vulnerability in Whoogle Search 0.8.3 and prior.", "tags": ["CVE", "SSRF", "Whoogle Search"], "objects": [{"id": "urn:ietf:params:stix:observable-8:example:1.0", "type": "observable", "created": "2024-02-01T00:00:00.000Z", "modified": "2024-02-01T00:00:00.000Z", "value": "https://example.com", "observable_type": "url"}], "relationships": [{"type": "related", "relationship_name": "contains", "object_label": "Indicator", "object_type": "indicator", "object_id": "urn:ietf:params:stix:indicator:1.2"}]}]}, "technical_analysis": {"Introduction": "CVE-2024-22205 is a Server-Side Request Forgery (SSRF) vulnerability in Whoogle Search 0.8.3 and prior, which allows an attacker to send arbitrary GET requests on behalf of the server.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 9.8. The scope of the vulnerability is limited to Whoogle Search 0.8.3 and prior, and it is assumed that the vulnerable software is not running in a trusted environment.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190, T1036, T1191, and T1130.", "Technical Details": "The vulnerability occurs because the `window` endpoint in Whoogle Search 0.8.3 and prior does not sanitize user-supplied input from the `location` variable, which allows an attacker to craft arbitrary GET requests.", "Detection": "Detection of this vulnerability can be done by monitoring for unusual network traffic patterns and logging suspicious activity.", "Mitigation": "The mitigation for this vulnerability is to upgrade Whoogle Search to version 0.8.4 or later, and to restrict access to the `window` endpoint.", "Conclusion": "In conclusion, CVE-2024-22205 is a high-impact vulnerability that can be exploited by an attacker to send arbitrary GET requests on behalf of the server. The recommended mitigation is to upgrade Whoogle Search to version 0.8.4 or later, and to restrict access to the `window` endpoint."}, "executive_analysis": {"Overview": "CVE-2024-22205 is a critical vulnerability in Whoogle Search that allows an attacker to send arbitrary GET requests on behalf of the server.", "Business Impact": "The business impact of this vulnerability is significant, as it can be used to conduct data exfiltration attacks and potentially compromise sensitive data.", "Technical Impact": "The technical impact of this vulnerability is high, with a CVSS score of 9.8. It requires a high level of technical expertise to exploit, but can be devastating if not properly mitigated.", "Mitigation Strategies": "The recommended mitigation strategies are to upgrade Whoogle Search to version 0.8.4 or later, and to restrict access to the `window` endpoint.", "Recommendations": "Recommendations for executives include conducting a thorough risk assessment, implementing mitigation strategies, and providing education and awareness training to employees.", "Conclusions": "In conclusion, CVE-2024-22205 is a critical vulnerability that requires immediate attention. It is essential to implement mitigation strategies and provide education and awareness training to employees to minimize the risk of exploitation."}}