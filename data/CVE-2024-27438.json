{"id": "CVE-2024-27438", "sourceIdentifier": "security@apache.org", "published": "2024-03-21T10:15:08.370", "lastModified": "2024-08-01T13:48:27.240", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Download of Code Without Integrity Check vulnerability in Apache Doris.\nThe jdbc driver files used for JDBC catalog is not checked and may\u00a0resulting in remote command execution.\nOnce the attacker is authorized to create a JDBC catalog, he/she can use arbitrary driver jar file with unchecked code snippet. This\u00a0code snippet will be run when catalog is initializing without any check.\nThis issue affects Apache Doris: from 1.2.0 through 2.0.4.\n\nUsers are recommended to upgrade to version 2.0.5 or 2.1.x, which fixes the issue.\n\n"}, {"lang": "es", "value": "Descarga de C\u00f3digo Sin Integridad Check vulnerabilidad en Apache Doris. Los archivos del controlador jdbc utilizados para el cat\u00e1logo JDBC no est\u00e1n verificados y pueden provocar la ejecuci\u00f3n remota de comandos. Una vez que el atacante est\u00e1 autorizado a crear un cat\u00e1logo JDBC, puede utilizar un archivo jar de controlador arbitrario con un fragmento de c\u00f3digo no verificado. Este fragmento de c\u00f3digo se ejecutar\u00e1 cuando el cat\u00e1logo se inicialice sin ninguna verificaci\u00f3n. Este problema afecta a Apache Doris: desde 1.2.0 hasta 2.0.4. Se recomienda a los usuarios actualizar a la versi\u00f3n 2.0.5 o 2.1.x, que soluciona el problema."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@apache.org", "type": "Primary", "description": [{"lang": "en", "value": "CWE-494"}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/03/21/1", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread/h95h82b0svlnwcg6c2xq4b08j6gwgczh", "source": "security@apache.org"}], "techniques": [{"techniqueID": "T1210", "comment": "Apache Doris code download without integrity check - attackers can download arbitrary code and execute it without verification, making this a remote command execution vulnerability. Related to CVE-2024-27438, this technique highlights the importance of code integrity checks in Apache Doris configurations."}, {"techniqueID": "T1059", "comment": "Apache Doris JDBC catalog creation without code integrity check - attackers can create a JDBC catalog and execute arbitrary code without verification, making this a remote command execution vulnerability. Related to CVE-2024-27438, this technique highlights the importance of code integrity checks in Apache Doris configurations."}, {"techniqueID": "T1190", "comment": "Apache Doris code injection through unvalidated input - attackers can inject arbitrary code through unvalidated input, making this a remote command execution vulnerability. Related to CVE-2024-27438, this technique highlights the importance of input validation in Apache Doris configurations."}], "stix_bundle": {"objects": [{"id": "stix_bundle:https://example.com/stix_bundle", "type": "stix:Bund", "created_by": "security@apache.org", "created": "2024-03-21T10:15:08.370", "updated": "2024-08-01T13:48:27.240", "objects": [{"id": "stix_vulnerability: CVE-2024-27438", "type": "stix:Vulnerability", "name": "Apache Doris Download of Code Without Integrity Check", "description": "Download of Code Without Integrity Check vulnerability in Apache Doris.", "published": "2024-03-21T10:15:08.370", "last_modified": "2024-08-01T13:48:27.240", "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "cvss_score": 9.8, "references": [{"id": "stix_reference:http://www.openwall.com/lists/oss-security/2024/03/21/1", "type": "stix:Reference", "href": "http://www.openwall.com/lists/oss-security/2024/03/21/1", "name": "OSS Security"}, {"id": "stix_reference:https://lists.apache.org/thread/h95h82b0svlnwcg6c2xq4b08j6gwgczh", "type": "stix:Reference", "href": "https://lists.apache.org/thread/h95h82b0svlnwcg6c2xq4b08j6gwgczh", "name": "Apache Mailing List"}]}, {"id": "stix_related_tactics: T1210", "type": "stix:RelatedTactic", "tactic_id": "T1210", "tactic_name": "Exploit Public-Facing Application", "notes": ["Apache Doris code download without integrity check is a relevant tactic for exploitation, as it allows attackers to download arbitrary code and execute it without verification."]}, {"id": "stix_related_tactics: T1059", "type": "stix:RelatedTactic", "tactic_id": "T1059", "tactic_name": "Program Phoning Home", "notes": ["Apache Doris JDBC catalog creation without code integrity check is a relevant tactic for exploitation, as it allows attackers to create a JDBC catalog and execute arbitrary code without verification."]}, {"id": "stix_related_tactics: T1190", "type": "stix:RelatedTactic", "tactic_id": "T1190", "tactic_name": "Exploit Remote Code Execution", "notes": ["Apache Doris code injection through unvalidated input is a relevant tactic for exploitation, as it allows attackers to inject arbitrary code and execute it without verification."]}]}]}, "technical_analysis": {"Introduction": "The Apache Doris vulnerability CVE-2024-27438 allows attackers to download and execute arbitrary code without integrity checks, making it a critical remote command execution vulnerability.", "Impact and Scope": "The vulnerability affects Apache Doris versions 1.2.0 through 2.0.4, and can result in remote command execution with high confidentiality, integrity, and availability impact.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1210, T1059, and T1190, which highlight the importance of code integrity checks and input validation in Apache Doris configurations.", "Technical Details": "The vulnerability is caused by the lack of integrity checks in Apache Doris's download of code feature, which allows attackers to download and execute arbitrary code without verification.", "Detection": "Detecting this vulnerability requires monitoring for suspicious log entries and unusual network traffic, particularly during Apache Doris's download of code feature.", "Mitigation": "Mitigating this vulnerability requires updating to Apache Doris version 2.0.5 or 2.1.x, which fixes the issue, and implementing additional security measures such as input validation and code integrity checks.", "Conclusion": "The Apache Doris vulnerability CVE-2024-27438 emphasizes the importance of code integrity checks and input validation in Apache Doris configurations, and the need for regular updates and monitoring to prevent exploitation."}, "executive_analysis": {"Overview": "The Apache Doris vulnerability CVE-2024-27438 is a critical remote command execution vulnerability that affects Apache Doris versions 1.2.0 through 2.0.4.", "Business Impact": "The vulnerability can result in significant business disruptions and losses, particularly in industries that rely heavily on Apache Doris for data processing and analysis.", "Technical Impact": "The vulnerability can result in remote command execution with high confidentiality, integrity, and availability impact, making it a significant technical threat.", "Mitigation Strategies": "Updating to Apache Doris version 2.0.5 or 2.1.x, implementing input validation and code integrity checks, and monitoring for suspicious log entries and network traffic are recommended mitigation strategies.", "Recommendations": "Executive-level stakeholders should prioritize updating Apache Doris, implementing additional security measures, and regularly monitoring for suspicious activity to prevent exploitation.", "Conclusions": "The Apache Doris vulnerability CVE-2024-27438 emphasizes the importance of prioritizing security and regularly updating software to prevent exploitation."}}