{"id": "CVE-2024-41066", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-29T15:15:14.480", "lastModified": "2024-07-29T16:21:52.517", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nibmvnic: Add tx check to prevent skb leak\n\nBelow is a summary of how the driver stores a reference to an skb during\ntransmit:\n    tx_buff[free_map[consumer_index]]->skb = new_skb;\n    free_map[consumer_index] = IBMVNIC_INVALID_MAP;\n    consumer_index ++;\nWhere variable data looks like this:\n    free_map == [4, IBMVNIC_INVALID_MAP, IBMVNIC_INVALID_MAP, 0, 3]\n                                               \tconsumer_index^\n    tx_buff == [skb=null, skb=<ptr>, skb=<ptr>, skb=null, skb=null]\n\nThe driver has checks to ensure that free_map[consumer_index] pointed to\na valid index but there was no check to ensure that this index pointed\nto an unused/null skb address. So, if, by some chance, our free_map and\ntx_buff lists become out of sync then we were previously risking an\nskb memory leak. This could then cause tcp congestion control to stop\nsending packets, eventually leading to ETIMEDOUT.\n\nTherefore, add a conditional to ensure that the skb address is null. If\nnot then warn the user (because this is still a bug that should be\npatched) and free the old pointer to prevent memleak/tcp problems."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: ibmvnic: agregue verificaci\u00f3n de tx para evitar fugas de skb A continuaci\u00f3n se muestra un resumen de c\u00f3mo el controlador almacena una referencia a un skb durante la transmisi\u00f3n: tx_buff[free_map[consumer_index]]-&gt;skb = new_skb ; free_map[consumer_index] = IBMVNIC_INVALID_MAP; consumer_index++; Donde los datos variables se ven as\u00ed: free_map == [4, IBMVNIC_INVALID_MAP, IBMVNIC_INVALID_MAP, 0, 3] consumer_index^ tx_buff == [skb=null, skb=, skb=, skb=null, skb=null ] El controlador tiene comprobaciones para garantizar que free_map[consumer_index] apunte a un \u00edndice v\u00e1lido, pero no hubo ninguna verificaci\u00f3n para garantizar que este \u00edndice apunte a una direcci\u00f3n skb nula o no utilizada. Entonces, si, por casualidad, nuestras listas free_map y tx_buff no est\u00e1n sincronizadas, entonces est\u00e1bamos arriesg\u00e1ndonos a una p\u00e9rdida de memoria skb. Esto podr\u00eda provocar que el control de congesti\u00f3n de TCP deje de enviar paquetes, lo que eventualmente provocar\u00eda ETIMEDOUT. Por lo tanto, agregue un condicional para garantizar que la direcci\u00f3n skb sea nula. De lo contrario, advierta al usuario (porque todav\u00eda es un error que debe corregirse) y libere el puntero antiguo para evitar problemas de memleak/tcp."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0983d288caf984de0202c66641577b739caad561", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/16ad1557cae582e79bb82dddd612d9bdfaa11d4c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/267c61c4afed0ff9a2e83462abad3f41d8ca1f06", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e7b75def33eae61ddaad6cb616c517dc3882eb2a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1638 .005: Disable or Uninstall Features", "comment": "CVE-2024-41066 - Disabling or uninstalling the ibmvnic feature can prevent exploitation of this vulnerability."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "CVE-2024-41066 - Attackers can exploit this vulnerability by sending specially crafted network traffic to the ibmvnic interface, which can cause a memory leak and lead to system crashes."}, {"techniqueID": "T1189: Drive-by Compromise", "comment": "CVE-2024-41066 - Visiting a compromised website or clicking on a malicious link can trigger the exploitation of this vulnerability, leading to a memory leak and system crashes."}], "stix_bundle": {"objects": [{"type": "windows-threat-actor", "id": " threat-actor-1", "url": "https://example.com/threat-actor-1", "metadata": {"description": "A malicious threat actor exploiting the CVE-2024-41066 vulnerability."}, "relationships": []}, {"type": "network-traffic", "id": "nc-traffic-1", "url": "https://example.com/network-traffic-1", "metadata": {"description": " Malicious network traffic exploiting the CVE-2024-41066 vulnerability."}, "relationships": []}, {"type": "indicator", "id": "indicator-1", "url": "https://example.com/indicator-1", "metadata": {"description": "An indicator of compromise for the CVE-2024-41066 vulnerability."}, "relationships": []}], "relationships": [{"id": "threat-actor-1-is-associated-with", "type": "is-associated-with", "object_id": "threat-actor-1", "object_type": "windows-threat-actor"}, {"id": "nc-traffic-1-is-associated-with", "type": "is-associated-with", "object_id": "nc-traffic-1", "object_type": "network-traffic"}, {"id": "indicator-1-is-associated-with", "type": "is-associated-with", "object_id": "indicator-1", "object_type": "indicator"}]}, "technical_analysis": {"Introduction": "The CVE-2024-41066 vulnerability is a memory leak in the ibmvnic interface of the Linux kernel, which can be exploited by attackers to cause system crashes and data corruption. This vulnerability is remotely exploitable over the network.", "Impact and Scope": "The impact of this vulnerability is high, as it allows attackers to control the system and execute arbitrary code. The scope of the vulnerability is widespread, as it affects multiple Linux distributions and kernel versions.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1638 .005: Disable or Uninstall Features, T1190: Exploit Public-Facing Application, and T1189: Drive-by Compromise.", "Technical Details": "The vulnerability is caused by the kernel module implementing the ibmvnic interface, which does not properly validate the skb data structure, leading to a memory leak.", "Detection": "Detection of this vulnerability can be done by monitoring for unusual network traffic patterns and system crashes. Additionally, the ibmvnic interface can be disabled or uninstalled to prevent exploitation.", "Mitigation": "The mitigation for this vulnerability is to apply the patch released by the kernel developers or disable the ibmvnic interface. Additionally, strong network segmentation and access controls can help prevent exploitation.", "Conclusion": "The CVE-2024-41066 vulnerability is a serious issue that requires immediate attention. It is recommended to apply the patch released by the kernel developers and disable the ibmvnic interface to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-41066 vulnerability is a serious issue that affects multiple Linux distributions and kernel versions. This vulnerability can be exploited by attackers to control the system and execute arbitrary code.", "Business Impact": "The business impact of this vulnerability is high, as it can cause system crashes and data corruption. Additionally, it can lead to reputational damage and financial losses if not addressed promptly.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows attackers to execute arbitrary code and control the system. This can lead to data breaches, system crashes, and data corruption.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include applying the patch released by the kernel developers, disabling the ibmvnic interface, and implementing strong network segmentation and access controls.", "Recommendations": "It is recommended to prioritize the remediation of this vulnerability as soon as possible. Additionally, regular security testing and vulnerability scanning can help identify and address similar issues in the future.", "Conclusions": "The CVE-2024-41066 vulnerability is a serious issue that requires immediate attention. It is recommended to take prompt action to address this vulnerability and implement strong security measures to prevent exploitation."}}