{"id": "CVE-2024-45388", "sourceIdentifier": "security-advisories@github.com", "published": "2024-09-02T18:15:38.063", "lastModified": "2024-09-03T12:59:02.453", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Hoverfly is a lightweight service virtualization/ API simulation / API mocking tool for developers and testers. The `/api/v2/simulation` POST handler allows users to create new simulation views from the contents of a user-specified file. This feature can be abused by an attacker to read arbitrary files from the Hoverfly server. Note that, although the code prevents absolute paths from being specified, an attacker can escape out of the `hf.Cfg.ResponsesBodyFilesPath` base path by using `../` segments and reach any arbitrary files. This issue was found using the Uncontrolled data used in path expression CodeQL query for python. Users are advised to make sure the final path (`filepath.Join(hf.Cfg.ResponsesBodyFilesPath, filePath)`) is contained within the expected base path (`filepath.Join(hf.Cfg.ResponsesBodyFilesPath, \"/\")`). This issue is also tracked as GHSL-2023-274."}, {"lang": "es", "value": "Hoverfly es una herramienta liviana de simulaci\u00f3n de API/virtualizaci\u00f3n de servicios/simulaci\u00f3n de API para desarrolladores y evaluadores. El controlador POST `/api/v2/simulation` permite a los usuarios crear nuevas vistas de simulaci\u00f3n a partir del contenido de un archivo especificado por el usuario. Un atacante puede abusar de esta caracter\u00edstica para leer archivos arbitrarios del servidor Hoverfly. Tenga en cuenta que, aunque el c\u00f3digo evita que se especifiquen rutas absolutas, un atacante puede escapar de la ruta base `hf.Cfg.ResponsesBodyFilesPath` mediante segmentos `../` y llegar a cualquier archivo arbitrario. Este problema se encontr\u00f3 utilizando la consulta CodeQL de expresi\u00f3n de ruta de datos no controlados para Python. Se recomienda a los usuarios asegurarse de que la ruta final (`filepath.Join(hf.Cfg.ResponsesBodyFilesPath, filePath)`) est\u00e9 contenida dentro de la ruta base esperada (`filepath.Join(hf.Cfg.ResponsesBodyFilesPath, \"/\")`). Este problema tambi\u00e9n se registra como GHSL-2023-274."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}]}], "references": [{"url": "https://codeql.github.com/codeql-query-help/go/go-path-injection", "source": "security-advisories@github.com"}, {"url": "https://github.com/SpectoLabs/hoverfly/releases/tag/v1.10.3", "source": "security-advisories@github.com"}, {"url": "https://github.com/SpectoLabs/hoverfly/security/advisories/GHSA-6xx4-x46f-f897", "source": "security-advisories@github.com"}, {"url": "https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/handlers/v2/simulation_handler.go#L87", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-45388 - Abuse of functionality to manipulate file reads and writes, potentially leading to unauthorized access and data exfiltration"}, {"techniqueID": "T1190", "comment": "CVE-2024-45388 - Path manipulation using '../' segments to escape base path and read arbitrary files, potentially leading to unauthorized access and data exfiltration"}, {"techniqueID": "T1110", "comment": "CVE-2024-45388 - Using a CodeQL query to find and exploit path injection vulnerabilities, potentially leading to unauthorized access and data exfiltration"}], "stix_bundle": {"@stix_package": {"type": "stix_bundle", "id": "https://example.com/Bundle-CVE-2024-45388", "created_by_ref": "https://example.com/User-v1", "created": "2024-09-02T18:15:38.063", "modified": "2024-09-03T12:59:02.453"}, "objects": [{"kind": "Indicator", "id": "Indicator-CVE-2024-45388", "type": "indicator", "last_observed": "2024-09-02T18:15:38.063", "first_observed": "2024-09-02T18:15:38.063", "number_observed": 1, "modified": "2024-09-03T12:59:02.453", "created": "2024-09-02T18:15:38.063", "name": "Code injection vulnerability in Hoverfly", "description": "Unauthenticated code injection vulnerability in Hoverfly", "valid_from": "2024-09-02T18:15:38.063", "valid_until": "2024-09-03T12:59:02.453", "keywords": ["code injection", "vulnerability", "unauthenticated"], "handling": "report", "indicator_types": ["malware"], "network_peers": [{"id": "Network-Peer-1", "name": "Network Peer 1"}], "related_indicators": [], "related_objects": [{"id": "Technique-T1210", "type": "technique"}]}, {"kind": "Tactics", "id": "Tactics-CVE-2024-45388", "type": "tactics", "name": "Data Exfiltration", "description": "Data Exfiltration through API simulation tool"}, {"kind": "Courses Of Action", "id": "Courses-Of-Action-CVE-2024-45388", "type": "courses_of_action", "name": "Address the vulnerability", "description": "Apply patch to address the vulnerability and prevent further exploitation"}]}, "technical_analysis": {"Introduction": "The Hoverfly API simulation tool contains a vulnerability that allows an attacker to read arbitrary files on the server. This vulnerability can be exploited by an attacker who can abuse the `/api/v2/simulation` POST handler to create a new simulation view that points to a user-specified file.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 and is medium-severity. It can be exploited by an attacker to read arbitrary files on the server, which can potentially lead to data exfiltration.", "Related MITRE ATT&CK Techniques": "T1210, T1190, T1110", "Technical Details": "The vulnerability is caused by the use of '../' segments in the file path, which allows an attacker to escape the base path and read arbitrary files.", "Detection": "The vulnerability can be detected by monitoring network traffic and identifying suspicious requests to the `/api/v2/simulation` POST handler.", "Mitigation": "The vulnerability can be mitigated by applying a patch that restricts the use of '../' segments in the file path.", "Conclusion": "In conclusion, the Hoverfly API simulation tool contains a vulnerability that can be exploited by an attacker to read arbitrary files on the server. This vulnerability has a medium-severity CVSS score and can be mitigated by applying a patch that restricts the use of '../' segments in the file path."}, "executive_analysis": {"Overview": "The Hoverfly API simulation tool contains a vulnerability that can be exploited by an attacker to read arbitrary files on the server. This vulnerability has a medium-severity CVSS score and can be mitigated by applying a patch that restricts the use of '../' segments in the file path.", "Business Impact": "The vulnerability can potentially lead to data exfiltration, which can result in the theft of sensitive information. This can have serious business consequences, including reputational damage and financial losses.", "Technical Impact": "The vulnerability can be exploited by an attacker to read arbitrary files on the server, which can potentially lead to data exfiltration. This can be mitigated by applying a patch that restricts the use of '../' segments in the file path.", "Mitigation Strategies": "The vulnerability can be mitigated by applying a patch that restricts the use of '../' segments in the file path. This can be done by updating the Hoverfly API simulation tool to a patched version.", "Recommendations": "Recommendations for executives include updating the Hoverfly API simulation tool to a patched version, monitoring network traffic and identifying suspicious requests to the `/api/v2/simulation` POST handler, and implementing additional security controls such as access control lists (ACLs) and intrusion detection systems (IDS).", "Conclusions": "In conclusion, the Hoverfly API simulation tool contains a vulnerability that can be exploited by an attacker to read arbitrary files on the server. This vulnerability has a medium-severity CVSS score and can be mitigated by applying a patch that restricts the use of '../' segments in the file path. We recommend that executives take immediate action to update the Hoverfly API simulation tool to a patched version and implement additional security controls to prevent exploitation."}}