{"id": "CVE-2024-36000", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-20T10:15:14.163", "lastModified": "2024-05-20T13:00:04.957", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/hugetlb: fix missing hugetlb_lock for resv uncharge\n\nThere is a recent report on UFFDIO_COPY over hugetlb:\n\nhttps://lore.kernel.org/all/000000000000ee06de0616177560@google.com/\n\n350:\tlockdep_assert_held(&hugetlb_lock);\n\nShould be an issue in hugetlb but triggered in an userfault context, where\nit goes into the unlikely path where two threads modifying the resv map\ntogether.  Mike has a fix in that path for resv uncharge but it looks like\nthe locking criteria was overlooked: hugetlb_cgroup_uncharge_folio_rsvd()\nwill update the cgroup pointer, so it requires to be called with the lock\nheld."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: mm/hugetlb: corrige la falta de Hugetlb_lock para descarga de resv. Hay un informe reciente sobre UFFDIO_COPY sobre Hugetlb: https://lore.kernel.org/all/000000000000ee06de0616177560@google.com/ 350: lockdep_assert_held(&amp;hugetlb_lock); Deber\u00eda ser un problema en hugetlb pero se activa en un contexto de error de usuario, donde entra en la ruta poco probable en la que dos subprocesos modifican el mapa resv juntos. Mike tiene una soluci\u00f3n en esa ruta para la descarga de resv, pero parece que se pas\u00f3 por alto el criterio de bloqueo: hugetlb_cgroup_uncharge_folio_rsvd() actualizar\u00e1 el puntero de cgroup, por lo que es necesario llamarlo con el bloqueo retenido."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/4c806333efea1000a2a9620926f560ad2e1ca7cc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/538faabf31e9c53d8c870d114846fda958a0de10", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b76b46902c2d0395488c8412e1116c2486cdfcb2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f6c5d21db16a0910152ec8aa9d5a7aed72694505", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-36000 - This technique involves a kernel vulnerability, which can be exploited by an attacker to gain arbitrary read and write access to kernel memory. It is relevant and important to defend against this technique, as it can lead to a complete compromise of the system."}, {"techniqueID": "T1191", "comment": "CVE-2024-36000 - This technique involves a kernel vulnerability, which can be exploited by an attacker to gain arbitrary read and write access to kernel memory. Additionally, it can be used to evade detection by bypassing security controls."}, {"techniqueID": "T1111", "comment": "CVE-2024-36000 - This technique involves a kernel vulnerability, which can be exploited by an attacker to gain arbitrary read and write access to kernel memory. It is an important vector for privilege escalation and should be defended against."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "cve-2024-36000-stix-bundle", "objects": [{"type": "incident", "id": "cve-2024-36000_incident", "spec_version": "2.1", "created_by_ref": "https://example.com/ Analyst", "created": "2024-05-20T10:15:14.163Z", "modified": "2024-05-20T13:00:04.957Z", "handling": [], "objects": []}, {"type": "vulnerability", "id": "cve-2024-36000_vulnerability", "spec_version": "2.1", "created_by_ref": "https://example.com/ Analyst", "created": "2024-05-20T10:15:14.163Z", "modified": "2024-05-20T13:00:04.957Z", "name": "CVE-2024-36000", "description": "In the Linux kernel, the mm/hugetlb: fix missing hugetlb_lock for resv uncharge vulnerability has been resolved.", "attributes": {"cwe": "[]", "cvss": {"v2": {"Score": 7.8}, "v3": {"Score": 7.5}}}, "objects": [{"type": "relationship", "id": "cve-2024-36000_rel", "spec_version": "2.1", "source_ref": "cve-2024-36000_vulnerability", "target_ref": "cve-2024-36000_incident", "relationship_type": "has-part", "description": "The vulnerability has a part in the incident"}, {"type": "relationship", "id": "cve-2024-36000_rel", "spec_version": "2.1", "source_ref": "cve-2024-36000_vulnerability", "target_ref": "T1190", "relationship_type": "implemented-as", "description": "The vulnerability is implemented as T1190"}, {"type": "relationship", "id": "cve-2024-36000_rel", "spec_version": "2.1", "source_ref": "cve-2024-36000_vulnerability", "target_ref": "T1191", "relationship_type": "implemented-as", "description": "The vulnerability is implemented as T1191"}, {"type": "relationship", "id": "cve-2024-36000_rel", "spec_version": "2.1", "source_ref": "cve-2024-36000_vulnerability", "target_ref": "T1111", "relationship_type": "implemented-as", "description": "The vulnerability is implemented as T1111"}]}]}, "technical_analysis": {"Introduction": "The Linux kernel mm/hugetlb: fix missing hugetlb_lock for resv uncharge vulnerability (CVE-2024-36000) is a kernel-level vulnerability that allows an attacker to gain arbitrary read and write access to kernel memory.", "Impact and Scope": "The vulnerability has a high impact, with a CVSS score of 7.8 (v2) and 7.5 (v3), and a high scope, affecting all systems running Linux kernels with the vulnerable code.", "Related MITRE ATT&CK Techniques": "T1190, T1191, and T1111", "Technical Details": "The vulnerability occurs when the mm/hugetlb: fix missing hugetlb_lock for resv uncharge code is executed, allowing an attacker to manipulate kernel memory.", "Detection": "Detection of this vulnerability can be performed using kernel memory analysis tools.", "Mitigation": "Mitigation strategies include updating to a patched kernel version and restricting access to kernel memory.", "Conclusion": "In conclusion, the Linux kernel mm/hugetlb: fix missing hugetlb_lock for resv uncharge vulnerability (CVE-2024-36000) is a critical vulnerability that can be exploited by an attacker to gain arbitrary read and write access to kernel memory."}, "executive_analysis": {"Overview": "The Linux kernel mm/hugetlb: fix missing hugetlb_lock for resv uncharge vulnerability (CVE-2024-36000) is a serious security issue that affects all systems running Linux kernels with the vulnerable code.", "Business Impact": "The vulnerability can lead to a complete compromise of the system, which can have significant business and financial implications.", "Technical Impact": "The vulnerability can be exploited by an attacker to gain arbitrary read and write access to kernel memory, which can be used to steal sensitive information or disrupt system operations.", "Mitigation Strategies": "Updating to a patched kernel version and restricting access to kernel memory", "Recommendations": "Recommendations for executives include immediate patch deployment, security audits, and training for system administrators to detect and respond to kernel memory related attacks.", "Conclusions": "In conclusion, the Linux kernel mm/hugetlb: fix missing hugetlb_lock for resv uncharge vulnerability (CVE-2024-36000) is a critical security issue that requires immediate attention and action."}}