{"id": "CVE-2024-5616", "sourceIdentifier": "security@huntr.dev", "published": "2024-07-06T09:15:02.050", "lastModified": "2024-07-08T15:49:22.437", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A Cross-Site Request Forgery (CSRF) vulnerability exists in mudler/LocalAI versions up to and including 2.15.0, which allows attackers to trick victims into deleting installed models. By crafting a malicious HTML page, an attacker can cause the deletion of a model, such as 'gpt-4-vision-preview', without the victim's consent. The vulnerability is due to insufficient CSRF protection mechanisms on the model deletion functionality."}, {"lang": "es", "value": " Existe una vulnerabilidad de Cross Site Request Forgery (CSRF) en las versiones de mudler/LocalAI hasta la 2.15.0 incluida, que permite a los atacantes enga\u00f1ar a las v\u00edctimas para que eliminen los modelos instalados. Al crear una p\u00e1gina HTML maliciosa, un atacante puede provocar la eliminaci\u00f3n de un modelo, como 'gpt-4-vision-preview', sin el consentimiento de la v\u00edctima. La vulnerabilidad se debe a mecanismos de protecci\u00f3n CSRF insuficientes en la funcionalidad de eliminaci\u00f3n del modelo."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-352"}]}], "references": [{"url": "https://github.com/mudler/localai/commit/4e1463fec291612a59a16db60b3fd12d4c49d64b", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/fd753fb6-ba04-4dd8-abef-918fb97120af", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "TA0005", "comment": "CVE-2024-5616 being a CSRF vulnerability, this technique's 'Malicious File' stage is relevant, as an attacker can use this stage to trick users into installing a malicious file, which can then be used to delete installed models without consent."}, {"techniqueID": "TA0029", "comment": "Attackers can use this technique's 'Web Shell' stage to create a malicious HTML page, which can be used to delete installed models without consent, as per the vulnerability description."}, {"techniqueID": "TA0040", "comment": "This technique's 'Data Stewardship' stage can be used to delete installed models, which is a potential impact of the CVE."}, {"techniqueID": "TA0035", "comment": "Attackers can use this technique's 'User Execution' stage to trick users into installing a malicious file, which can then be used to delete installed models without consent, as per the vulnerability description."}, {"techniqueID": "TA0003", "comment": "This technique's 'Initial Access' stage can be used to trick users into installing a malicious file, which can then be used to delete installed models without consent, as per the vulnerability description."}], "stix_bundle": {"type": "bundle", "id": " bundle:CVE-2024-5616", "title": "MITRE STIX 2.1 Bundle for CVE-2024-5616", "created_by_ref": " organisation:myorg", "created": "2024-07-08T15:49:22.437", "modified": "2024-07-08T15:49:22.437", "objects": [{"type": "vulnerability", "id": "vuln:CVE-2024-5616", "created_by_ref": "organisation:myorg", "created": "2024-07-08T15:49:22.437", "modified": "2024-07-08T15:49:22.437", "name": "CVE-2024-5616 - Cross-Site Request Forgery in mudler/LocalAI", "description": "A Cross-Site Request Forgery (CSRF) vulnerability exists in mudler/LocalAI versions up to and including 2.15.0, which allows attackers to trick victims into deleting installed models.", "severity": "MEDIUM", "impact": "LOW", "probability": "HIGH", "references": [{"id": "ref:https://github.com/mudler/localai/commit/4e1463fec291612a59a16db60b3fd12d4c49d64b", "type": "WebPage", "name": "GitHub Commit"}, {"id": "ref:https://huntr.com/bounties/fd753fb6-ba04-4dd8-abef-918fb97120af", "type": "WebPage", "name": "Huntr Bounty"}]}, {"type": "course-of-action", "id": "cao:delete-installed-models", "created_by_ref": "organisation:myorg", "created": "2024-07-08T15:49:22.437", "modified": "2024-07-08T15:49:22.437", "name": "Delete Installed Models", "description": "Delete all installed models to mitigate the impact of the vulnerability.", "techniques": [{"id": "tec:TA0005", "type": " mitigation", "name": "Malicious File Stage"}]}]}, "technical_analysis": {"Introduction": "CVE-2024-5616 is a Cross-Site Request Forgery vulnerability in mudler/LocalAI versions up to and including 2.15.0, which allows attackers to trick victims into deleting installed models.", "Impact and Scope": "The impact of this vulnerability is LOW, as it only allows attackers to delete installed models. The scope is UNCHANGED, as the vulnerability only affects the model deletion functionality.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are relevant to this vulnerability: TA0005, TA0029, TA0040, TA0035, and TA0003.", "Technical Details": "The vulnerability exists due to insufficient CSRF protection mechanisms on the model deletion functionality.", "Detection": "Detecting this vulnerability involves monitoring for malicious HTTP requests to the model deletion endpoint.", "Mitigation": "Mitigation strategies include patching the vulnerable version of mudler/LocalAI, disabling the model deletion functionality, or implementing additional CSRF protection mechanisms.", "Conclusion": "In conclusion, CVE-2024-5616 is a relatively low-severity vulnerability, but it is still important to patch or mitigate it to prevent attackers from deleting installed models without consent."}, "executive_analysis": {"Overview": "CVE-2024-5616 is a Cross-Site Request Forgery vulnerability in mudler/LocalAI versions up to and including 2.15.0.", "Business Impact": "The business impact of this vulnerability is minimal, as it only affects the model deletion functionality.", "Technical Impact": "The technical impact of this vulnerability is LOW, as it only allows attackers to delete installed models.", "Mitigation Strategies": "Mitigation strategies include patching the vulnerable version of mudler/LocalAI, disabling the model deletion functionality, or implementing additional CSRF protection mechanisms.", "Recommendations": "We recommend patching the vulnerable version of mudler/LocalAI or disabling the model deletion functionality.", "Conclusions": "In conclusion, CVE-2024-5616 is a relatively low-severity vulnerability, but it is still important to patch or mitigate it to prevent attackers from deleting installed models without consent."}}