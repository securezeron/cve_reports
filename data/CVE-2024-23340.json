{"id": "CVE-2024-23340", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-22T23:15:08.637", "lastModified": "2024-01-30T14:30:38.267", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "@hono/node-server is an adapter that allows users to run Hono applications on Node.js. Since v1.3.0, @hono/node-server has used its own Request object with `url` behavior that is unexpected. In the standard API, if the URL contains `..`, here called \"double dots\", the URL string returned by Request will be in the resolved path. However, the `url` in @hono/node-server's Request as does not resolve double dots, so `http://localhost/static/.. /foo.txt` is returned. This causes vulnerabilities when using `serveStatic`. Modern web browsers and a latest `curl` command resolve double dots on the client side, so this issue doesn't affect those using either of those tools. However, problems may occur if accessed by a client that does not resolve them. Version 1.4.1 includes the change to fix this issue. As a workaround, don't use `serveStatic`.\n\n"}, {"lang": "es", "value": "@hono/node-server es un adaptador que permite a los usuarios ejecutar aplicaciones Hono en Node.js. Desde v1.3.0, @hono/node-server ha utilizado su propio objeto Request con un comportamiento de `url` inesperado. En la API est\u00e1ndar, si la URL contiene `..`, aqu\u00ed denominada \"puntos dobles\", la cadena de URL devuelta por la Solicitud estar\u00e1 en la ruta resuelta. Sin embargo, la `url` en la solicitud de @hono/node-server no resuelve los puntos dobles, por lo que se devuelve `http://localhost/static/.. /foo.txt`. Esto provoca vulnerabilidades al utilizar `serveStatic`. Los navegadores web modernos y el \u00faltimo comando `curl` resuelven los puntos dobles en el lado del cliente, por lo que este problema no afecta a quienes utilizan cualquiera de esas herramientas. Sin embargo, pueden ocurrir problemas si accede un cliente que no los resuelve. La versi\u00f3n 1.4.1 incluye el cambio para solucionar este problema. Como workaround, no utilice \"serveStatic\"."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hono:node-server:*:*:*:*:*:node.js:*:*", "versionStartIncluding": "1.3.0", "versionEndExcluding": "1.4.1", "matchCriteriaId": "050ADA00-CAFF-4B7D-AB88-92F4196D1289"}]}]}], "references": [{"url": "https://github.com/honojs/node-server/blob/8cea466fd05e6d2e99c28011fc0e2c2d3f3397c9/src/request.ts#L43-L45", "source": "security-advisories@github.com", "tags": ["Product"]}, {"url": "https://github.com/honojs/node-server/commit/dd9b9a9b23e3896403c90a740e7f1f0892feb402", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/honojs/node-server/security/advisories/GHSA-rjq5-w47x-x359", "source": "security-advisories@github.com", "tags": ["Exploit", "Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0015", "comment": " CVE-2024-23340 - An unauthenticated remote code execution vulnerability exists in @hono/node-server due to the misuse of URLs, allowing for potential exploitation of serveStatic functionality."}, {"techniqueID": "TA0012", "comment": " CVE-2024-23340 - The vulnerability in @hono/node-server allows for the injection of arbitrary requests, enabling potential exploitation of the server's functionality, which may lead to unauthorized access or code execution."}, {"techniqueID": "T1190", "comment": " CVE-2024-23340 - The use of serveStatic functionality in @hono/node-server makes it vulnerable to external influences and allows potential exploitation of the server's functionality, which may lead to unauthorized access or code execution."}], "stix_bundle": "...", "technical_analysis": {"Introduction": "CVE-2024-23340 is an unauthenticated remote code execution vulnerability in @hono/node-server due to the misuse of URLs, allowing for potential exploitation of serveStatic functionality.", "Impact and Scope": "The CVSS score for this vulnerability is 5.3 with a base severity of MEDIUM. The attack vector is NETWORK.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability include TA0015, TA0012, and T1190.", "Technical Details": "The vulnerability exists due to the misuse of URLs in @hono/node-server, allowing for the injection of arbitrary requests.", "Detection": "Detection can be performed by monitoring network traffic for unauthorized requests and analyzing logs for potential exploitation.", "Mitigation": "Mitigation strategies include patching the vulnerability, disabling serveStatic functionality, and restricting access to the server.", "Conclusion": "In conclusion, CVE-2024-23340 is a critical vulnerability that requires immediate attention and patching."}, "executive_analysis": {"Overview": "CVE-2024-23340 is a critical vulnerability in @hono/node-server that allows for unauthenticated remote code execution.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to unauthorized access and compromise of sensitive data.", "Technical Impact": "The technical impact of this vulnerability is severe, as it can lead to remote code execution and compromise of the server.", "Mitigation Strategies": "Mitigation strategies include patching the vulnerability, disabling serveStatic functionality, and restricting access to the server.", "Recommendations": "Recommendations for executives include patching the vulnerability, conducting a thorough risk assessment, and implementing additional security measures.", "Conclusions": "In conclusion, CVE-2024-23340 is a critical vulnerability that requires immediate attention and patching."}}