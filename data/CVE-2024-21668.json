{"id": "CVE-2024-21668", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-09T19:15:12.330", "lastModified": "2024-01-16T20:37:23.550", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "react-native-mmkv is a library that allows easy use of MMKV inside React Native applications. Before version 2.11.0, the react-native-mmkv logged the optional encryption key for the MMKV database into the Android system log. The key can be obtained by anyone with access to the Android Debugging Bridge (ADB) if it is enabled in the phone settings. This bug is not present on iOS devices. By logging the encryption secret to the system logs, attackers can trivially recover the secret by enabling ADB and undermining an app's thread model. This issue has been patched in version 2.11.0."}, {"lang": "es", "value": "react-native-mmkv es una librer\u00eda que permite el uso sencillo de MMKV dentro de aplicaciones React Native. Antes de la versi\u00f3n 2.11.0, react-native-mmkv registraba la clave de cifrado opcional para la base de datos MMKV en el registro del sistema Android. Cualquier persona con acceso al Android Debugging Bridge (ADB) puede obtener la clave si est\u00e1 habilitado en la configuraci\u00f3n del tel\u00e9fono. Este error no est\u00e1 presente en dispositivos iOS. Al registrar el secreto de cifrado en los registros del sistema, los atacantes pueden recuperar trivialmente el secreto habilitando ADB y socavando el modelo de subprocesos de una aplicaci\u00f3n. Este problema se solucion\u00f3 en la versi\u00f3n 2.11.0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-532"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mrousavy:react-native-mmkv:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "2.11.0", "matchCriteriaId": "2F0F4C50-CDEB-4A18-A8BC-E087D59E6D75"}]}]}], "references": [{"url": "https://github.com/mrousavy/react-native-mmkv/commit/a8995ccb7184281f7d168bad3e9987c9bd05f00d", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/mrousavy/react-native-mmkv/releases/tag/v2.11.0", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/mrousavy/react-native-mmkv/security/advisories/GHSA-4jh3-6jhv-2mgp", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0003 - Command and Control", "comment": "CVE-2024-21668 - Before version 2.11.0, the react-native-mmkv logged the optional encryption key for the MMKV database into the Android system log, which can be obtained by anyone with access to the Android Debugging Bridge (ADB) if it is enabled in the phone settings, enabling ADB and undermining an app's thread model."}, {"techniqueID": "TA0040 - Data Encryption", "comment": "CVE-2024-21668 - The encryption secret is logged in the system logs, which can be trivially recovered by enabling ADB, undermining the app's thread model."}, {"techniqueID": "TA0041 - Authentication Credentials Dumping", "comment": "CVE-2024-21668 - The encryption secret is logged in the system logs, which can be used to obtain authentication credentials for the MMKV database."}, {"techniqueID": "TA0042 - Execution with Unexpected Features", "comment": "CVE-2024-21668 - An attacker can use the logged encryption secret to obtain a foothold in the app's thread model, potentially allowing for arbitrary code execution."}, {"techniqueID": "TA0043 - Component Firmware Manipulation", "comment": "CVE-2024-21668 - An attacker can use the logged encryption secret to manipulate the component firmware of the MMKV database, potentially allowing for arbitrary data manipulation."}], "stix_bundle": "Insert STIX 2.1 bundle here", "technical_analysis": {"Introduction": "The CVE-2024-21668 vulnerability in react-native-mmkv allows an attacker to obtain the optional encryption key for the MMKV database, which can be used to undermine the app's thread model.", "Impact and Scope": "The impact of this CVE is a HIGH confidentiality impact, as the encryption key can be obtained by an unauthorized party. The attack vector is LOCAL, with LOW attack complexity. The CVSS score is 4.9.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this CVE: TA0003, TA0040, TA0041, TA0042, TA0043.", "Technical Details": "The react-native-mmkv library logs the optional encryption key for the MMKV database into the Android system log, which can be obtained by an attacker with access to the Android Debugging Bridge (ADB) if it is enabled in the phone settings.", "Detection": "Detection of this CVE can be done by monitoring the system logs for the presence of the encryption key.", "Mitigation": "Mitigation strategies include: patching to version 2.11.0 or later, disabling ADB on all devices, monitoring system logs for cryptographic secrets.", "Conclusion": "In conclusion, the CVE-2024-21668 vulnerability in react-native-mmkv is a critical issue that allows an attacker to obtain the encryption key for the MMKV database, which can be used to undermine the app's thread model."}, "executive_analysis": {"Overview": "The CVE-2024-21668 vulnerability in react-native-mmkv is a critical issue that can have significant business and technical impacts.", "Business Impact": "The business impact of this CVE is a potential compromise of sensitive data, including authentication credentials, which can lead to significant financial losses and reputational damage.", "Technical Impact": "The technical impact of this CVE is a potential compromise of the app's thread model, which can lead to arbitrary code execution and data manipulation.", "Mitigation Strategies": "Mitigation strategies include: patching to version 2.11.0 or later, disabling ADB on all devices, implementing robust logging and monitoring to detect potential attacks.", "Recommendations": "Recommendations for executives include: prioritizing patching and mitigation, implementing robust logging and monitoring, and conducting thorough risk assessments.", "Conclusions": "In conclusion, the CVE-2024-21668 vulnerability in react-native-mmkv is a critical issue that requires immediate attention and action to mitigate the risks and impacts."}}