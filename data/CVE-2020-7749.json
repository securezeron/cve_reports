{"id": "CVE-2020-7749", "sourceIdentifier": "report@snyk.io", "published": "2020-10-20T11:15:12.660", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "This affects all versions of package osm-static-maps. User input given to the package is passed directly to a template without escaping ({{{ ... }}}). As such, it is possible for an attacker to inject arbitrary HTML/JS code and depending on the context. It will be outputted as an HTML on the page which gives opportunity for XSS or rendered on the server (puppeteer) which also gives opportunity for SSRF and Local File Read."}, {"lang": "es", "value": "Esto afecta a todas las versiones del paquete osm-static-maps.&#xa0;Una entrada de usuario dada al paquete es pasada directamente a una plantilla sin escapar ({{{...}}}).&#xa0;Como tal, es posible que un atacante inyecte c\u00f3digo HTML/JS arbitrario y dependiendo del contexto.&#xa0;Se generar\u00e1 como un HTML en la p\u00e1gina que otorga la oportunidad de un XSS o se renderizaba en el servidor (puppeteer) que tambi\u00e9n otorga la oportunidad de un SSRF y una lectura de archivos locales"}], "metrics": {"cvssMetricV31": [{"source": "report@snyk.io", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 7.6, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:osm-static-maps_project:osm-static-maps:*:*:*:*:*:node.js:*:*", "matchCriteriaId": "02D6B0BB-1A95-4C5B-861B-598C32A63812"}]}]}], "references": [{"url": "https://github.com/jperelli/osm-static-maps/blob/master/src/template.html%23L142", "source": "report@snyk.io", "tags": ["Broken Link"]}, {"url": "https://github.com/jperelli/osm-static-maps/pull/24", "source": "report@snyk.io", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://snyk.io/vuln/SNYK-JS-OSMSTATICMAPS-609637", "source": "report@snyk.io", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059 - Command and Control", "comment": "CVE-2020-7749 - Untrusted user input modification enables arbitrary code execution and command injection, potentially allowing a threat actor to execute malicious commands and maintain a persistent command and control infrastructure."}, {"techniqueID": "T1034 - Web Shell", "comment": "CVE-2020-7749 - User input modification enables arbitrary code execution, potentially allowing a threat actor to create a web shell for future access and command execution."}, {"techniqueID": "T1204 - User Execution", "comment": "CVE-2020-7749 - User input modification enables arbitrary code execution, potentially allowing a threat actor to execute malicious code and carry out subsequent attacks."}, {"techniqueID": "T1253 - Web Beacons", "comment": "CVE-2020-7749 - User input modification enables arbitrary code execution, potentially allowing a threat actor to create Web Beacons for IP reputation analysis and tracking."}, {"techniqueID": "T1189 - Web Fraud, Forging and Improper Input Handling", "comment": "CVE-2020-7749 - User input modification enables arbitrary code execution, potentially allowing a threat actor to falsify data, tamper with web-based input, and create malicious payloads."}], "technical_analysis": {"Introduction": "The CVE-2020-7749 vulnerability is a server-side template injection vulnerability in the OSM-Static-Maps package, allowing a threat actor to inject arbitrary HTML/JS code and execute malicious commands.", "Impact and Scope": "The vulnerability has a CVSS score of 7.6 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L) and affects all versions of the OSM-Static-Maps package.", "Related MITRE ATT&CK Techniques": "The identified MITRE ATT&CK techniques related to this vulnerability are T1059, T1034, T1204, T1253, and T1189.", "Technical Details": "The vulnerability is caused by the package's use of a template engine without proper input validation, allowing user input to be injected directly into the template without escaping.", "Detection": "Detection involves analyzing server-side logs for suspicious web traffic and identifying potential command injection patterns.", "Mitigation": "Mitigation involves updating the OSM-Static-Maps package to a patched version, restricting user input, and implementing proper input validation and sanitization.", "Conclusion": "The CVE-2020-7749 vulnerability is a critical risk and requires immediate attention to prevent exploitation and maintain the integrity of web-based applications."}, "executive_analysis": {"Overview": "The CVE-2020-7749 vulnerability is a server-side template injection vulnerability in the OSM-Static-Maps package, allowing a threat actor to inject arbitrary HTML/JS code and execute malicious commands.", "Business Impact": "The vulnerability has a significant business impact, as it allows a threat actor to compromise web-based applications and potentially gain unauthorized access to sensitive information.", "Technical Impact": "The vulnerability has a technical impact in that it allows a threat actor to inject malicious code, potentially creating a backdoor or web shell.", "Mitigation Strategies": "Recommendations for mitigation include updating the OSM-Static-Maps package, restricting user input, and implementing proper input validation and sanitization.", "Recommendations": "It is recommended that executives prioritize this vulnerability and allocate necessary resources for remediation and testing.", "Conclusions": "The CVE-2020-7749 vulnerability is a critical risk and requires immediate attention to prevent exploitation and maintain the integrity of web-based applications."}}