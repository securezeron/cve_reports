{"id": "CVE-2024-38574", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-19T14:15:17.520", "lastModified": "2024-06-20T12:44:01.637", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nlibbpf: Prevent null-pointer dereference when prog to load has no BTF\n\nIn bpf_objec_load_prog(), there's no guarantee that obj->btf is non-NULL\nwhen passing it to btf__fd(), and this function does not perform any\ncheck before dereferencing its argument (as bpf_object__btf_fd() used to\ndo). As a consequence, we get segmentation fault errors in bpftool (for\nexample) when trying to load programs that come without BTF information.\n\nv2: Keep btf__fd() in the fix instead of reverting to bpf_object__btf_fd()."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: libbpf: evita la desreferencia del puntero nulo cuando el programa a cargar no tiene BTF. En bpf_objec_load_prog(), no hay garant\u00eda de que obj-&gt;btf no sea NULL al pasarlo a btf__fd() , y esta funci\u00f3n no realiza ninguna verificaci\u00f3n antes de eliminar la referencia a su argumento (como sol\u00eda hacer bpf_object__btf_fd()). Como consecuencia, obtenemos errores de segmentaci\u00f3n en bpftool (por ejemplo) cuando intentamos cargar programas que vienen sin informaci\u00f3n BTF. v2: Mantenga btf__fd() en la soluci\u00f3n en lugar de volver a bpf_object__btf_fd()."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/1fd91360a75833b7110af9834ae26c977e1273e0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9bf48fa19a4b1d186e08b20bf7e5de26a15644fb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ef80b59acfa4dee4b5eaccb15572b69248831104", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2024-38574 - Use of NULL Pointer Dereference. Permits identification and exploitation. Unpatched systems may be vulnerable"}, {"techniqueID": "TA0020", "comment": "CVE-2024-38574 - Execution with Unprivileged Access. Allows attackers to load programs without verified BTF information leading to potential crashes"}, {"techniqueID": "TA0037", "comment": "CVE-2024-38574 - Code Injection. By loading unverified BTF information, attackers can inject malicious code"}], "stix_bundle": {"objects": [{"id": "https://example.com/cve/CVE-2024-38574", "type": "vulnerability", "name": "CVE-2024-38574", "description": "In the Linux kernel, the following vulnerability has been resolved: libbpf: Prevent null-pointer dereference when prog to load has no BTF", "created_by_ref": "https://example.com/user/admin", "modified": "2024-06-20T12:44:01.637", "categories": ["linux", "kernel", "securing-linux"], "relations": [{"id": "https://example.com/tactic/TA0001", "type": "uses", "role": "vulnerable", "target_ref": "https://example.com/attack_pattern/TA0001"}, {"id": "https://example.com/tactic/TA0020", "type": "uses", "role": "vulnerable", "target_ref": "https://example.com/attack_pattern/TA0020"}, {"id": "https://example.com/tactic/TA0037", "type": "used_by", "role": "attacker", "target_ref": "https://example.com/attack_pattern/TA0037"}]}, {"id": "https://example.com/attack_pattern/TA0001", "type": "attack-pattern", "name": "TA0001", "description": "Use of NULL Pointer Dereference", "created_by_ref": "https://example.com/user/admin", "modified": "2024-06-20T12:44:01.637", "patterns": ["used_by", "uses"]}, {"id": "https://example.com/attack_pattern/TA0020", "type": "attack-pattern", "name": "TA0020", "description": "Execution with Unprivileged Access", "created_by_ref": "https://example.com/user/admin", "modified": "2024-06-20T12:44:01.637", "patterns": ["used_by", "uses"]}, {"id": "https://example.com/attack_pattern/TA0037", "type": "attack-pattern", "name": "TA0037", "description": "Code Injection", "created_by_ref": "https://example.com/user/admin", "modified": "2024-06-20T12:44:01.637", "patterns": ["uses"]}]}, "technical_analysis": {"Introduction": "CVE-2024-38574 is a NULL pointer dereference vulnerability in the Linux kernel's libbpf module, which allows an attacker to load programs without verified BTF information.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). An attacker can exploit this vulnerability to execute code with unprivileged access.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: TA0001, TA0020, and TA0037.", "Technical Details": "The vulnerability occurs when an attacker loads a program without verified BTF information, which can lead to a NULL pointer dereference and potential code execution.", "Detection": "Detection methods for this vulnerability include monitoring for crashes or segmentation faults in the libbpf module.", "Mitigation": "Mitigation strategies include patching the affected kernel version, restricting access to the libbpf module, and verifying BTF information before loading programs.", "Conclusion": "CVE-2024-38574 is a significant vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-38574 is a critical vulnerability in the Linux kernel's libbpf module that can allow attackers to execute code with unprivileged access.", "Business Impact": "The impact of this vulnerability is significant, as it can be exploited by attackers to compromise sensitive data or disrupt critical systems.", "Technical Impact": "The vulnerability has a CVSS score of 6.5 and can lead to code execution with unprivileged access.", "Mitigation Strategies": "To mitigate this vulnerability, it is recommended to patch the affected kernel version, restrict access to the libbpf module, and verify BTF information before loading programs.", "Recommendations": "Executives should prioritize mitigating this vulnerability and ensure that their organizations have a robust security posture.", "Conclusions": "CVE-2024-38574 is a critical vulnerability that requires immediate attention and mitigation to prevent potential security breaches."}}