{"id": "CVE-2024-0798", "sourceIdentifier": "security@huntr.dev", "published": "2024-02-26T16:27:51.563", "lastModified": "2024-04-16T12:15:09.113", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A privilege escalation vulnerability exists in mintplex-labs/anything-llm, allowing users with 'default' role to delete documents uploaded by 'admin'. Despite the intended restriction that prevents 'default' role users from deleting admin-uploaded documents, an attacker can exploit this vulnerability by sending a crafted DELETE request to the /api/system/remove-document endpoint. This vulnerability is due to improper access control checks, enabling unauthorized document deletion and potentially leading to loss of data integrity."}, {"lang": "es", "value": "Un usuario con un rol \"predeterminado\" que le haya asignado el administrador puede enviar solicitudes HTTP \"ELIMINAR\" a \"eliminar carpeta\" y \"eliminar documento\" para eliminar carpetas y archivos fuente de la instancia, incluso cuando su rol no deber\u00eda permitir expl\u00edcitamente esta acci\u00f3n en el sistema."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-272"}]}], "references": [{"url": "https://github.com/mintplex-labs/anything-llm/commit/d5cde8b7c27a47ab45b05b441db16751537f1733", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/607f03a0-ab4d-4905-b253-3d28bbbd363c", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1203", "comment": "CVE-2024-0798 - An attacker can delete documents uploaded by 'admin' using a crafted DELETE request, allowing for unauthorized document deletion and potential data loss."}, {"techniqueID": "T1102", "comment": "CVE-2024-0798 - Improper access control checks enable users with 'default' role to perform actions that should be restricted to 'admin' role, leading to privilege escalation."}, {"techniqueID": "T1210", "comment": "CVE-2024-0798 - An attacker can exploit the vulnerability by sending a crafted DELETE request to the /api/system/remove-document endpoint, demonstrating an insecure direct object reference."}], "technical_analysis": {"Introduction": "This vulnerability exists in mintplex-labs/anything-llm, allowing users with 'default' role to delete documents uploaded by 'admin'.", "Impact and Scope": "The vulnerability has a CVSS score of 8.1 (HIGH) with a version of 3.0, attack vector of NETWORK, and privileges required of LOW.", "Related MITRE ATT&CK Techniques": ["T1203", "T1102", "T1210"], "Technical Details": "The vulnerability is due to improper access control checks, enabling unauthorized document deletion and potentially leading to loss of data integrity.", "Detection": "Detection methods include identifying unauthorized DELETE requests to the /api/system/remove-document endpoint.", "Mitigation": "Mitigation strategies include updating the /api/system/remove-document endpoint to include proper access control checks and restricting users with 'default' role from deleting documents uploaded by 'admin'.", "Conclusion": "This vulnerability highlights the importance of proper access control checks and secure resource management."}, "executive_analysis": {"Overview": "A privilege escalation vulnerability exists in mintplex-labs/anything-llm, allowing users with 'default' role to delete documents uploaded by 'admin'.", "Business Impact": "This vulnerability has a significant business impact, as it could lead to loss of data integrity and potential security breaches.", "Technical Impact": "The vulnerability is technical in nature, as it relates to improper access control checks and insecure resource management.", "Mitigation Strategies": "Implement proper access control checks and restrict users with 'default' role from deleting documents uploaded by 'admin'.", "Recommendations": "Executives should prioritize patching and updating the /api/system/remove-document endpoint to ensure secure resource management.", "Conclusions": "This vulnerability emphasizes the importance of proactive security measures and regular vulnerability assessments."}}