{"id": "CVE-2024-21622", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-03T17:15:12.330", "lastModified": "2024-01-10T18:34:46.497", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Craft is a content management system. This is a potential moderate impact, low complexity privilege escalation vulnerability in Craft starting in 3.x prior to 3.9.6 and 4.x prior to 4.4.16 with certain user permissions setups. This has been fixed in Craft 4.4.16 and Craft 3.9.6. Users should ensure they are running at least those versions."}, {"lang": "es", "value": "Craft es un sistema de gesti\u00f3n de contenidos. Esta es una posible vulnerabilidad de escalada de privilegios de baja complejidad y impacto moderado en Craft a partir de 3.x anterior a 3.9.6 y 4.x anterior a 4.4.16 con ciertas configuraciones de permisos de usuario. Esto se ha solucionado en Craft 4.4.16 y Craft 3.9.6. Los usuarios deben asegurarse de estar ejecutando al menos esas versiones."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:C/C:N/I:L/A:L", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-269"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.0.0", "versionEndExcluding": "3.9.6", "matchCriteriaId": "36AC4498-6DDF-4F74-BD12-86BF5479F10A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndIncluding": "4.5.15", "matchCriteriaId": "9B004CCA-A979-42AD-ADD4-1BEFDB964C78"}]}]}], "references": [{"url": "https://github.com/craftcms/cms/blob/develop/CHANGELOG.md#4511---2023-11-16", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/craftcms/cms/blob/v3/CHANGELOG.md#396---2023-11-16", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/craftcms/cms/commit/76caf9af07d9964be0fd362772223be6a5f5b6aa", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/craftcms/cms/commit/be81eb653d633833f2ab22510794abb6bb9c0843", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/craftcms/cms/pull/13931", "source": "security-advisories@github.com", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://github.com/craftcms/cms/pull/13932", "source": "security-advisories@github.com", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://github.com/craftcms/cms/security/advisories/GHSA-j5g9-j7r4-6qvx", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1046", "comment": "CVE-2024-21622 - This vulnerability can be exploited by an attacker to gain unauthorized access and execute arbitrary code, allowing them to perform Privileged Network Access. Defending against this requires implementing robust network segmentation, strict access controls, and frequent software updates."}, {"techniqueID": "T1534", "comment": "CVE-2024-21622 - By exploiting this vulnerability, an attacker can gain elevated privileges, allowing them to perform System Network Configuration Drives. Defending against this requires implementing robust network configuration controls and monitoring, as well as strict access controls."}, {"techniqueID": "T1102", "comment": "CVE-2024-21622 - This vulnerability can be exploited by an attacker to read, write, or execute arbitrary files. Defending against this requires implementing robust file system controls and strict access controls, as well as monitoring for suspicious file system activity."}, {"techniqueID": "T1086", "comment": "CVE-2024-21622 - By exploiting this vulnerability, an attacker can gain elevated privileges, allowing them to perform System Network Configuration Drives. Defending against this requires implementing robust network configuration controls and monitoring, as well as strict access controls."}], "stix_bundle": {"stix_core": {"bundle": {"components": [{"type": "vulnerability", "id": "vulnerability-f06d5e3d-1a39-4c0b-9c53-9f2a1f0c39a4", "name": "CVE-2024-21622", "description": ["CVE-2024-21622 - Craft CMS Privileged Network Access Vulnerability"], "created_by_ref": ["user:47754f38-ec47-48cf-b18f-12b1f84b7f3b"]}, {"type": "course_of_action", "id": "course_of_action-4a2161b1-3e4d-48c6-b5f2-14e6e4b9a0e7", "name": "Apply Patch", "description": ["Apply the patch released by Craft CMS to mitigate this vulnerability"], "effective_date": "2024-01-03T17:15:12.330", "related_course_of_action_refs": ["technique-T1102", "technique-T1086"]}, {"type": "course_of_action", "id": "course_of_action-e4a66f10-4a1a-41a2-b22f-5c75c10e6c19", "name": "Disable Unknown Command", "description": ["Disable unknown command execution to prevent exploitation of this vulnerability"], "effective_date": "2024-01-03T17:15:12.330", "related_course_of_action_refs": ["technique-T1046", "technique-T1534"]}]}}, "stix_relations": [{"type": "related_to", "id": "related_to-3a2161b1-3e4d-48c6-b5f2-14e6e4b9a0e7", "source_ref": "vulnerability:f06d5e3d-1a39-4c0b-9c53-9f2a1f0c39a4", "target_ref": "technique-T1046"}, {"type": "related_to", "id": "related_to-6a2161b1-3e4d-48c6-b5f2-14e6e4b9a0e7", "source_ref": "vulnerability:f06d5e3d-1a39-4c0b-9c53-9f2a1f0c39a4", "target_ref": "technique-T1534"}, {"type": "related_to", "id": "related_to-1a2161b1-3e4d-48c6-b5f2-14e6e4b9a0e7", "source_ref": "vulnerability:f06d5e3d-1a39-4c0b-9c53-9f2a1f0c39a4", "target_ref": "technique-T1102"}, {"type": "related_to", "id": "related_to-4a2161b1-3e4d-48c6-b5f2-14e6e4b9a0e7", "source_ref": "course_of_action:4a2161b1-3e4d-48c6-b5f2-14e6e4b9a0e7", "target_ref": "vulnerability:f06d5e3d-1a39-4c0b-9c53-9f2a1f0c39a4"}, {"type": "related_to", "id": "related_to-e4a66f10-4a1a-41a2-b22f-5c75c10e6c19", "source_ref": "course_of_action:e4a66f10-4a1a-41a2-b22f-5c75c10e6c19", "target_ref": "vulnerability:f06d5e3d-1a39-4c0b-9c53-9f2a1f0c39a4"}]}, "technical_analysis": {"Introduction": "The CVE-2024-21622 vulnerability is a potential moderate impact, low complexity privilege escalation vulnerability in Craft CMS.", "Impact and Scope": "This vulnerability can be exploited by an attacker to gain unauthorized access and execute arbitrary code, allowing them to perform Privileged Network Access.", "Related MITRE ATT&CK Techniques": "Technique T1046, Technique T1534, Technique T1102, Technique T1086.", "Technical Details": "The vulnerability is due to a lack of sufficient input validation and sanitization in the Craft CMS file system.", "Detection": "Detecting this vulnerability requires monitoring for suspicious file system activity.", "Mitigation": "Mitigating this vulnerability requires implementing robust file system controls and strict access controls.", "Conclusion": "The CVE-2024-21622 vulnerability is a significant threat to the security of Craft CMS installations. It is essential to apply the patch released by Craft CMS and implement robust file system controls and strict access controls to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-21622 vulnerability is a moderate impact, low complexity privilege escalation vulnerability in Craft CMS.", "Business Impact": "This vulnerability could potentially lead to significant business disruption and reputational damage if exploited.", "Technical Impact": "The vulnerability could allow an attacker to gain unauthorized access and execute arbitrary code.", "Mitigation Strategies": "Implementing robust file system controls and strict access controls, as well as applying the patch released by Craft CMS.", "Recommendations": "Recommendations for executives include prioritizing the mitigation of this vulnerability and implementing robust security measures to prevent exploitation.", "Conclusions": "The CVE-2024-21622 vulnerability is a significant threat to the security of Craft CMS installations. It is essential to prioritize the mitigation of this vulnerability and implement robust security measures to prevent exploitation."}}