{"id": "CVE-2024-27894", "sourceIdentifier": "security@apache.org", "published": "2024-03-12T19:15:47.970", "lastModified": "2024-05-01T17:15:30.557", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Pulsar Functions Worker includes a capability that permits authenticated users to create functions where the function's implementation is referenced by a URL. The supported URL schemes include \"file\", \"http\", and \"https\". When a function is created using this method, the Functions Worker will retrieve the implementation from the URL provided by the user. However, this feature introduces a vulnerability that can be exploited by an attacker to gain unauthorized access to any file that the Pulsar Functions Worker process has permissions to read. This includes reading the process environment which potentially includes sensitive information, such as secrets. Furthermore, an attacker could leverage this vulnerability to use the Pulsar Functions Worker as a proxy to access the content of remote HTTP and HTTPS endpoint URLs. This could also be used to carry out denial of service attacks.\nThis vulnerability also applies to the Pulsar Broker when it is configured with \"functionsWorkerEnabled=true\".\n\nThis issue affects Apache Pulsar versions from 2.4.0 to 2.10.5, from 2.11.0 to 2.11.3, from 3.0.0 to 3.0.2, from 3.1.0 to 3.1.2, and 3.2.0. \n\n2.10 Pulsar Function Worker users should upgrade to at least 2.10.6.\n2.11 Pulsar Function Worker users should upgrade to at least 2.11.4.\n3.0 Pulsar Function Worker users should upgrade to at least 3.0.3.\n3.1 Pulsar Function Worker users should upgrade to at least 3.1.3.\n3.2 Pulsar Function Worker users should upgrade to at least 3.2.1.\n\nUsers operating versions prior to those listed above should upgrade to the aforementioned patched versions or newer versions.\n\nThe updated versions of Pulsar Functions Worker will, by default, impose restrictions on the creation of functions using URLs. For users who rely on this functionality, the Function Worker configuration provides two configuration keys: \"additionalEnabledConnectorUrlPatterns\" and \"additionalEnabledFunctionsUrlPatterns\". These keys allow users to specify a set of URL patterns that are permitted, enabling the creation of functions using URLs that match the defined patterns. This approach ensures that the feature remains available to those who require it, while limiting the potential for unauthorized access and exploitation."}, {"lang": "es", "value": "Pulsar Functions Worker incluye una capacidad que permite a los usuarios autenticados crear funciones donde se hace referencia a la implementaci\u00f3n de la funci\u00f3n mediante una URL. Los esquemas de URL admitidos incluyen \"archivo\", \"http\" y \"https\". Cuando se crea una funci\u00f3n utilizando este m\u00e9todo, Functions Worker recuperar\u00e1 la implementaci\u00f3n de la URL proporcionada por el usuario. Sin embargo, esta caracter\u00edstica introduce una vulnerabilidad que puede ser aprovechada por un atacante para obtener acceso no autorizado a cualquier archivo para el que el proceso Pulsar Functions Worker tenga permisos de lectura. Esto incluye la lectura del entorno del proceso, que potencialmente incluye informaci\u00f3n confidencial, como secretos. Adem\u00e1s, un atacante podr\u00eda aprovechar esta vulnerabilidad para utilizar Pulsar Functions Worker como proxy para acceder al contenido de las URL de endpoints HTTP y HTTPS remotos. Esto tambi\u00e9n podr\u00eda usarse para llevar a cabo ataques de denegaci\u00f3n de servicio. Esta vulnerabilidad tambi\u00e9n se aplica al Pulsar Broker cuando est\u00e1 configurado con \"functionsWorkerEnabled=true\". Este problema afecta a las versiones de Apache Pulsar de 2.4.0 a 2.10.5, de 2.11.0 a 2.11.3, de 3.0.0 a 3.0.2, de 3.1.0 a 3.1.2 y 3.2.0. 2.10 Los usuarios de Pulsar Function Worker deben actualizar al menos a 2.10.6. 2.11 Los usuarios de Pulsar Function Worker deben actualizar al menos a 2.11.4. Los usuarios de 3.0 Pulsar Function Worker deben actualizar al menos a 3.0.3. 3.1 Los usuarios de Pulsar Function Worker deben actualizar al menos a 3.1.3. 3.2 Los usuarios de Pulsar Function Worker deben actualizar al menos a 3.2.1. Los usuarios que utilicen versiones anteriores a las enumeradas anteriormente deben actualizar a las versiones parcheadas antes mencionadas o a versiones m\u00e1s nuevas. Las versiones actualizadas de Pulsar Functions Worker impondr\u00e1n, de forma predeterminada, restricciones a la creaci\u00f3n de funciones mediante URL. Para los usuarios que dependen de esta funcionalidad, la configuraci\u00f3n de Function Worker proporciona dos claves de configuraci\u00f3n: \"additionalEnabledConnectorUrlPatterns\" y \"additionalEnabledFunctionsUrlPatterns\". Estas claves permiten a los usuarios especificar un conjunto de patrones de URL permitidos, lo que permite la creaci\u00f3n de funciones utilizando URL que coinciden con los patrones definidos. Este enfoque garantiza que la funci\u00f3n permanezca disponible para quienes la requieren, al tiempo que limita el potencial de acceso y explotaci\u00f3n no autorizados."}], "metrics": {"cvssMetricV31": [{"source": "security@apache.org", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 6.0}]}, "weaknesses": [{"source": "security@apache.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}, {"lang": "en", "value": "CWE-552"}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2024/03/12/11", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread/45cqhgqg8d19ongjw18ypcss8vwh206p", "source": "security@apache.org"}, {"url": "https://pulsar.apache.org/security/CVE-2024-27894/", "source": "security@apache.org"}], "techniques": [{"techniqueID": "TA0003", "comment": "This technique is relevant as it highlights the importance of configuration management and the potential for malicious actors to exploit unsanitized input. The ability to create functions using URLs introduces a vulnerability that can be exploited to gain unauthorized access to files and sensitive information."}, {"techniqueID": "TA0005", "comment": "The 'additionalEnabledConnectorUrlPatterns' and 'additionalEnabledFunctionsUrlPatterns' configuration keys can be used to limit the potential for unauthorized access and exploitation, highlighting the importance of proper configuration and access control."}, {"techniqueID": "TA0023", "comment": "This technique is relevant as it highlights the potential for denial-of-service attacks, which can be achieved by leveraging the ability to create functions using URLs."}, {"techniqueID": "TA0040", "comment": "The vulnerability can be exploited to retrieve sensitive information, such as secrets, from the process environment, making it important to ensure proper permissions and access control."}, {"techniqueID": "TA0043", "comment": "The ability to create functions using URLs can be used to bypass access controls and gain unauthorized access to files and sensitive information, making it important to validate input and sanitize data."}], "stix_bundle": {"stix": {"extensions": {"markings-definition-1.2.0": {"marking-definition": {"id": "https://maec-project.github.io/MAEC-JSON1_2/index.html#marking-definition-1.2.0", "name": "MAEC Marking Definition 1.2.0"}}}, "objects": [{"id": "https://example.com/cve-2024-27894", "type": "vulnerability", "subType": "2.10", "name": "CVE-2024-27894", "description": "The Pulsar Functions Worker includes a capability that permits authenticated users to create functions where the function's implementation is referenced by a URL.", "references": [{"id": "https://www.openwall.com/lists/oss-security/2024/03/12/11", "name": "openwall"}, {"id": "https://lists.apache.org/thread/45cqhgqg8d19ongjw18ypcss8vwh206p", "name": "Apache List"}, {"id": "https://pulsar.apache.org/security/CVE-2024-27894/", "name": "Pulsar Security"}], "attacks": [{"id": "https://attack.mitre.org/techniques/T1189", "name": "File and Directory Discovery", "description": "An adversary may use the vulnerability to retrieve sensitive information, such as secrets, from the process environment."}, {"id": "https://attack.mitre.org/techniques/T1190", "name": "Path Validation", "description": "An adversary may use the vulnerability to bypass access controls and gain unauthorized access to files and sensitive information."}]}]}}, "technical_analysis": {"Introduction": "The Pulsar Functions Worker vulnerability, CVE-2024-27894, is a remote code execution vulnerability that allows authenticated users to create functions where the function's implementation is referenced by a URL. This vulnerability has a CVSS score of 8.5 and is classified as HIGH.", "Impact and Scope": "This vulnerability can be exploited by any authenticated user to gain unauthorized access to files and sensitive information, including secrets. The potential impact is HIGH, with a CVSS base score of 8.5.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques include TA0003, TA0005, TA0023, TA0040, and TA0043.", "Technical Details": "The vulnerability is due to the lack of proper input validation and sanitization in the Pulsar Functions Worker. An adversary can exploit this vulnerability by creating a function with a malicious URL.", "Detection": "Detection methods include monitoring for suspicious activity, such as changes to system configurations or unexpected function creations.", "Mitigation": "Mitigation strategies include configuring the Pulsar Functions Worker to only allow trusted sources, validating input data, and monitoring for suspicious activity.", "Conclusion": "The Pulsar Functions Worker vulnerability, CVE-2024-27894, is a HIGH-priority vulnerability that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "The Pulsar Functions Worker vulnerability, CVE-2024-27894, is a remote code execution vulnerability that can be exploited by authenticated users to gain unauthorized access to files and sensitive information.", "Business Impact": "The business impact of this vulnerability is significant, as it can be exploited to gain access to sensitive information and disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is also significant, as it can be exploited to gain unauthorized access to files and sensitive information, including secrets.", "Mitigation Strategies": "Mitigation strategies include configuring the Pulsar Functions Worker to only allow trusted sources, validating input data, and monitoring for suspicious activity.", "Recommendations": "Recommendations for executives include prioritizing the remediation of this vulnerability, implementing additional security measures to prevent future exploitation, and monitoring for suspicious activity.", "Conclusions": "The Pulsar Functions Worker vulnerability, CVE-2024-27894, is a HIGH-priority vulnerability that requires immediate attention and remediation. Executive-level Buy-in is essential to ensure prompt remediation and mitigation strategies are implemented."}}