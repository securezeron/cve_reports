{"id": "CVE-2020-7460", "sourceIdentifier": "secteam@freebsd.org", "published": "2020-08-06T17:15:11.317", "lastModified": "2022-07-01T18:44:30.037", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In FreeBSD 12.1-STABLE before r363918, 12.1-RELEASE before p8, 11.4-STABLE before r363919, 11.4-RELEASE before p2, and 11.3-RELEASE before p12, the sendmsg system call in the compat32 subsystem on 64-bit platforms has a time-of-check to time-of-use vulnerability allowing a mailcious userspace program to modify control message headers after they were validation."}, {"lang": "es", "value": "En FreeBSD versiones 12.1-ESTABLE anteriores a r363918, versiones 12.1-RELEASE anteriores a p8, versiones 11.4-ESTABLE anteriores a r363919, versiones 11.4-RELEASE anteriores a p2 y versiones 11.3-RELEASE anteriores a p12, la llamada al sistema sendmsg en el subsistema compat32 en plataformas de 64 bits presenta una vulnerabilidad de tipo time-of-check to time-of-use permitiendo a un programa de espacio de usuario malicioso modificar encabezados de mensajes de control despu\u00e9s de que fueron comprobados"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.0, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.0, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.4}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-367"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:-:*:*:*:*:*:*", "matchCriteriaId": "F35957CE-AF9F-40CA-BDD1-FA6A0E73783F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p1:*:*:*:*:*:*", "matchCriteriaId": "EA929713-B797-494A-853D-C121D9D69519"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p10:*:*:*:*:*:*", "matchCriteriaId": "B87AF171-95AC-4DDA-8D94-694F85638B46"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p11:*:*:*:*:*:*", "matchCriteriaId": "1CC8B031-41BB-4846-B092-7E4BC6F35D6B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p2:*:*:*:*:*:*", "matchCriteriaId": "3C3D8EDC-91D3-45B2-AC1D-EF4346D4A714"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p3:*:*:*:*:*:*", "matchCriteriaId": "EA5006FF-06A5-4D95-BF5B-29F26248D11F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p4:*:*:*:*:*:*", "matchCriteriaId": "A705031B-FD63-4076-B92E-E826E11D7111"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p5:*:*:*:*:*:*", "matchCriteriaId": "11C1EFB1-68E5-45F4-A7E1-744574F290D1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p6:*:*:*:*:*:*", "matchCriteriaId": "25F649A7-9265-4552-8934-BCE083363982"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p7:*:*:*:*:*:*", "matchCriteriaId": "F202C856-5B95-4796-AC4A-1F210E7BAB8F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p8:*:*:*:*:*:*", "matchCriteriaId": "9419C866-C478-4CDE-A9A1-E592D8FF0933"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.3:p9:*:*:*:*:*:*", "matchCriteriaId": "2B6DFC23-A7A1-431A-9AD9-A820579F95F0"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.4:-:*:*:*:*:*:*", "matchCriteriaId": "4A865EA1-01D7-4E5A-9D13-80780F8A9D7A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:11.4:p1:*:*:*:*:*:*", "matchCriteriaId": "9FCA6A72-2A72-45FD-A43D-B5BF7C329121"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.1:-:*:*:*:*:*:*", "matchCriteriaId": "BD730B6A-F123-4685-ACB3-4F20AAAB77F3"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.1:p1:*:*:*:*:*:*", "matchCriteriaId": "508150E3-2C0C-4EEB-BFC9-BB5CEB404C06"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.1:p2:*:*:*:*:*:*", "matchCriteriaId": "B5D692EF-A5D7-430E-91BA-4CD137343B66"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.1:p3:*:*:*:*:*:*", "matchCriteriaId": "D50C60A7-4C9F-4636-92E9-9F5B8B01BE5B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.1:p4:*:*:*:*:*:*", "matchCriteriaId": "6C49F6C7-A740-42F4-93BB-512CBF334516"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.1:p6:*:*:*:*:*:*", "matchCriteriaId": "9DCAA10A-C612-45E0-84B7-55897F49D65E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:12.1:p7:*:*:*:*:*:*", "matchCriteriaId": "CB6258A5-8066-48B8-A417-09A1547DD57A"}]}]}], "references": [{"url": "https://security.FreeBSD.org/advisories/FreeBSD-SA-20:23.sendmsg.asc", "source": "secteam@freebsd.org", "tags": ["Vendor Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20200821-0005/", "source": "secteam@freebsd.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.zerodayinitiative.com/advisories/ZDI-20-949/", "source": "secteam@freebsd.org", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-7460 - This technique is relevant because it allows an attacker to modify control message headers after they were validated, which can be used to inject malicious code. Defending against this requires implementing proper input validation and sanitization."}, {"techniqueID": "T1499", "comment": "CVE-2020-7460 - This technique is relevant because it allows an attacker to inject malicious code by modifying control message headers. Defending against this requires implementing proper input validation and sanitization."}], "stix_bundle": {"@stix_v": "2.1", "Bundle": {"id": "https://example.com/cve-2020-7460", "type": "bundle", "created_by_ref": "user", "created": "2022-07-01T18:44:30.037", "modified": "2022-07-01T18:44:30.037", "name": "CVE-2020-7460", "description": "FreeBSD sendmsg subsystem time-of-check to time-of-use vulnerability", "objects": [{"id": "https://example.com/cve-2020-7460", "type": "vulnerability", "created_by_ref": "user", "created": "2022-07-01T18:44:30.037", "modified": "2022-07-01T18:44:30.037", "name": "CVE-2020-7460", "description": "FreeBSD sendmsg subsystem time-of-check to time-of-use vulnerability", "cve": {"CVE_data_meta": {"ID": "CVE-2020-7460", "ASSIGNER": "secteam@freebsd.org"}, "problemtype": {"problemtype_data": [{"description": [{"lang": "en", "value": "In FreeBSD 12.1-STABLE before r363918, 12.1-RELEASE before p8, 11.4-STABLE before r363919, 11.4-RELEASE before p2, and 11.3-RELEASE before p12, the sendmsg system call in the compat32 subsystem on 64-bit platforms has a time-of-check to time-of-use vulnerability allowing a malicious userspace program to modify control message headers after they were validation."}]}]}}, "analyzed": true, "cwe": {"CWE_ID": "CWE-367"}, "cvss": {"baseMetricV3": {"score": 7.0}}, "affected": {"cpe23": [{"vulnerable": true, "cpe_match": "cpe:2.3:o:freebsd:freebsd:11.3:p1:*:*:*:*:*:*"}]}}, {"id": "https://example.com/mitre-attack", "type": "attack-pattern", "created_by_ref": "user", "created": "2022-07-01T18:44:30.037", "modified": "2022-07-01T18:44:30.037", "name": "T1190", "description": "Drive-by Compromise", "attack_pattern_data": {"description": [{"lang": "en", "value": "This attack pattern involves compromising a system by tricking the user into opening a malicious document, image, or other file that contains dangerous code."}]}, "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "initial-access"}]}, {"id": "https://example.com/mitre-attack", "type": "attack-pattern", "created_by_ref": "user", "created": "2022-07-01T18:44:30.037", "modified": "2022-07-01T18:44:30.037", "name": "T1499", "description": "Data Destruction", "attack_pattern_data": {"description": [{"lang": "en", "value": "This attack pattern involves destroying data on a system or network, often as part of a more sophisticated attack."}]}, "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "impact"}]}], "relationships": [{"relationship_type": "related_to", "source_ref": "https://example.com/cve-2020-7460", "target_ref": "https://example.com/mitre-attack"}]}}, "technical_analysis": {"Introduction": "The CVE-2020-7460 vulnerability in FreeBSD's sendmsg subsystem allows an attacker to modify control message headers after they were validated, which can be used to inject malicious code. This technique is relevant because it allows an attacker to compromise a system without the need for user interaction.", "Impact and Scope": "The impact of this vulnerability is significant, as it allows an attacker to inject malicious code into a system without the need for user interaction. The scope of this vulnerability is limited to systems that are running the affected versions of FreeBSD's sendmsg subsystem.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1190 and T1499. T1190 is the drive-by compromise technique, which involves compromising a system by tricking the user into opening a malicious document, image, or other file that contains dangerous code. T1499 is the data destruction technique, which involves destroying data on a system or network, often as part of a more sophisticated attack.", "Technical Details": "The technical details of this vulnerability can be found in the CVE-2020-7460 advisory. It is recommended to upgrade the affected versions of FreeBSD to patched versions.", "Detection": "Methods for detecting this vulnerability include monitoring system logs for signs of malicious activity, using intrusion detection systems to identify suspicious network traffic, and conducting regular security audits and vulnerability assessments.", "Mitigation": "Mitigation strategies for this vulnerability include upgrading the affected versions of FreeBSD to patched versions, configuring the system to prevent unknown code from executing, and implementing boundary controls to prevent unauthorized data transmission.", "Conclusion": "In conclusion, the CVE-2020-7460 vulnerability in FreeBSD's sendmsg subsystem is a significant security risk that requires immediate attention. It is recommended to upgrade the affected versions of FreeBSD to patched versions, monitor system logs for signs of malicious activity, and implement additional security measures to prevent unauthorized data transmission."}, "executive_analysis": {"Overview": "The CVE-2020-7460 vulnerability in FreeBSD's sendmsg subsystem is a significant security risk that requires immediate attention.", "Business Impact": "The business impact of this vulnerability is significant, as it can be used to inject malicious code into a system without the need for user interaction.", "Technical Impact": "The technical impact of this vulnerability is significant, as it can be used to compromise a system without the need for user interaction.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include upgrading the affected versions of FreeBSD to patched versions, configuring the system to prevent unknown code from executing, and implementing boundary controls to prevent unauthorized data transmission.", "Recommendations": "Recommendations for executives include reviewing system logs for signs of malicious activity, conducting regular security audits and vulnerability assessments, and implementing additional security measures to prevent unauthorized data transmission.", "Conclusions": "In conclusion, the CVE-2020-7460 vulnerability in FreeBSD's sendmsg subsystem is a significant security risk that requires immediate attention. It is recommended to upgrade the affected versions of FreeBSD to patched versions, monitor system logs for signs of malicious activity, and implement additional security measures to prevent unauthorized data transmission."}}