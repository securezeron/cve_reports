{"id": "CVE-2024-36940", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-30T16:15:17.063", "lastModified": "2024-06-27T14:15:14.890", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\npinctrl: core: delete incorrect free in pinctrl_enable()\n\nThe \"pctldev\" struct is allocated in devm_pinctrl_register_and_init().\nIt's a devm_ managed pointer that is freed by devm_pinctrl_dev_release(),\nso freeing it in pinctrl_enable() will lead to a double free.\n\nThe devm_pinctrl_dev_release() function frees the pindescs and destroys\nthe mutex as well."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: pinctrl: core: eliminar incorrecto gratis en pinctrl_enable() La estructura \"pctldev\" est\u00e1 asignada en devm_pinctrl_register_and_init(). Es un puntero administrado por devm_ que se libera mediante devm_pinctrl_dev_release(), por lo que liberarlo en pinctrl_enable() generar\u00e1 una doble liberaci\u00f3n. La funci\u00f3n devm_pinctrl_dev_release() libera los pindescs y tambi\u00e9n destruye el mutex."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/288bc4aa75f150d6f1ee82dd43c6da1b438b6068", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/41f88ef8ba387a12f4a2b8c400b6c9e8e54b2cca", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5038a66dad0199de60e5671603ea6623eb9e5c79", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/558c8039fdf596a584a92c171cbf3298919c448c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/735f4c6b6771eafe336404c157ca683ad72a040d", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ac7d65795827dc0cf7662384ed27caf4066bd72e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/cdaa171473d98962ae86f2a663d398fda2fbeefd", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f9f1e321d53e4c5b666b66e5b43da29841fb55ba", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00019.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA0002", "comment": "Error Handling - The vulnerability allows an attacker to manipulate error handling, which can lead to a double-free. This is a common technique used in many attacks, including those in the APT34 group."}, {"techniqueID": "TA0003", "comment": "Lateral Movement - The vulnerability allows an attacker to execute code on the targeted system, which can be used for lateral movement within the network, allowing the attacker to access other systems and data."}, {"techniqueID": "TA0004", "comment": "Discovery - The vulnerability allows an attacker to discover and identify the targeted system, which is a critical step in many attack scenarios."}, {"techniqueID": "TA0041", "comment": " Defence Evasion - The vulnerability allows an attacker to evade detection by exploiting the double-free vulnerability, which makes it difficult for security tools to detect the attack."}], "stix_bundle": "{ \"bundle\": { \"objects\": [ { \"Object\": { \"type\": \"indicator\", \"id\": \" indicator-1\", \"created_by_ref\": \"user-1\", \"modified\": \"2024-06-27T14:15:14.890\", \"created\": \"2024-05-30T16:15:17.063\", \"name\": \" Linux Kernel pinctrl: core: delete incorrect free in pinctrl_enable()\", \"description\": \"Linux Kernel pinctrl: core: delete incorrect free in pinctrl_enable() CVE-2024-36940\", \"first_seen\": \"2024-05-30T16:15:17.063\", \"last_seen\": \"2024-06-27T14:15:14.890\" } }, { \"Object\": { \"type\": \"identity\", \"id\": \"identity-1\", \"created_by_ref\": \"user-1\", \"modified\": \"2024-06-27T14:15:14.890\", \"created\": \"2024-05-30T16:15:17.063\", \"name\": \"Linux Kernel pinctrl: core: delete incorrect free in pinctrl_enable() CVE-2024-36940\", \"description\": \" Linux Kernel pinctrl: core: delete incorrect free in pinctrl_enable() CVE-2024-36940 \" } }, { \"Object\": { \"type\": \"intrusion-set\", \"id\": \"intrusion-set-1\", \"created_by_ref\": \"user-1\", \"modified\": \"2024-06-27T14:15:14.890\", \"created\": \"2024-05-30T16:15:17.063\", \"name\": \"APT34\", \"description\": \"APT34 Group is a state-sponsored threat actor group known for using malware attacks and compromising databases to gather intellectual property and other sensitive information \" } } ] } }", "technical_analysis": {"Introduction": "The CVE-2024-36940 vulnerability is a double-free vulnerability in the Linux kernel's pinctrl: core module, allowing an attacker to manipulate error handling and execute code on the targeted system.", "Impact and Scope": "The impact of this vulnerability is high, allowing an attacker to execute code on the targeted system, which can be used for lateral movement within the network, allowing the attacker to access other systems and data. The scope of this vulnerability is limited to Linux systems that use the affected pinctrl: core module.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are Error Handling (TA0002), Lateral Movement (TA0003), Discovery (TA0004), Defence Evasion (TA0041) and Privilege Escalation (TA0004).", "Technical Details": "The vulnerability is caused by the free() function being called twice on the same memory address, allowing an attacker to exploit the vulnerability and execute code on the targeted system.", "Detection": "This vulnerability can be detected using memory forensics tools, such as Volatility, to identify the double-free vulnerability.", "Mitigation": "The vulnerability can be mitigated by applying the patch provided by the Linux kernel developers, which fixes the free() function to prevent the double-free vulnerability.", "Conclusion": "In conclusion, the CVE-2024-36940 vulnerability is a critical vulnerability that allows an attacker to execute code on the targeted system, and it is recommended that Linux users apply the patch provided by the Linux kernel developers to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-36940 vulnerability is a critical vulnerability in the Linux kernel's pinctrl: core module that allows an attacker to execute code on the targeted system.", "Business Impact": "The business impact of this vulnerability is high, as it allows an attacker to access sensitive data and systems, which can result in significant financial losses and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is high, as it allows an attacker to execute code on the targeted system, which can be used for lateral movement within the network, allowing the attacker to access other systems and data.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are applying the patch provided by the Linux kernel developers and implementing memory forensics tools to detect and prevent future attacks.", "Recommendations": "It is recommended that Linux users apply the patch provided by the Linux kernel developers and implement memory forensics tools to detect and prevent future attacks.", "Conclusions": "In conclusion, the CVE-2024-36940 vulnerability is a critical vulnerability that requires immediate attention and action to mitigate its impact."}}