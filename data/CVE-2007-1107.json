{"id": "CVE-2007-1107", "sourceIdentifier": "cve@mitre.org", "published": "2007-02-26T17:28:00.000", "lastModified": "2018-10-16T16:36:47.407", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "SQL injection vulnerability in thumbnails.php in Coppermine Photo Gallery (CPG) 1.3.x allows remote authenticated users to execute arbitrary SQL commands via a cpg131_fav cookie.  NOTE: it was later reported that 1.4.10, 1.4.14, and other 1.4.x versions are also affected using similar cookies."}, {"lang": "es", "value": "Vulnerabilidad de inyecci\u00f3n SQL en thumbnails.php en Coppermine Photo Gallery (CPG) 1.3.x permite a usuarios autenticados remotos ejecutar comandos SQL de su elecci\u00f3n mediante una cookie cpg131_fav."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.3:*:*:*:*:*:*:*", "matchCriteriaId": "AB182E1B-9E32-46CA-9B49-5029107955D5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.3.2:*:*:*:*:*:*:*", "matchCriteriaId": "6DD2CA54-6534-4A4F-9667-8A594B7E43CD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.3.3:*:*:*:*:*:*:*", "matchCriteriaId": "BFF90F7F-070C-4ABE-8F94-7192F18B1A9D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.3.4:*:*:*:*:*:*:*", "matchCriteriaId": "91D223FD-D53B-45DA-AB15-B446ADA7B0A6"}]}]}], "references": [{"url": "http://osvdb.org/33133", "source": "cve@mitre.org"}, {"url": "http://securityreason.com/securityalert/2297", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/461158/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/22709", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/27372", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/32688", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/39806", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/3371", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/4950", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/4961", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2007-1107 - SQL Injection - Coppermine Photo Gallery 1.3.x vulnerable to SQL injection via cpg131_fav cookie. Attackers can execute arbitrary SQL commands. Relevant technique for TTPs like 'Input Validation and Sanitization' and 'Error Handling'."}, {"techniqueID": "T1190", "comment": "CVE-2007-1107 - Authentication Bypass - Coppermine Photo Gallery 1.3.x authenticated user can execute arbitrary SQL commands. Relevant technique for TTPs like 'Cookie Manipulation' and 'Authentication Bypass'."}, {"techniqueID": "T1078", "comment": "CVE-2007-1107 - Software Deployment - Coppermine Photo Gallery 1.3.x vulnerable to SQL injection via cookie. Attackers can deploy malware. Relevant technique for TTPs like 'Code Execution' and 'Data Execution'."}], "technical_analysis": {"Introduction": "Coppermine Photo Gallery 1.3.x contains a SQL injection vulnerability in thumbnails.php, allowing authenticated users to execute arbitrary SQL commands via a cpg131_fav cookie.", "Impact and Scope": "CVSS Score: 7.5 (AV:N/AC:L/Au:N/C:P/I:P/A:P). This vulnerability can cause partial confidentiality, integrity, and availability attacks.", "Related MITRE ATT&CK Techniques": "Input Validation and Sanitization, Error Handling, Authentication Bypass, Cookie Manipulation, Code Execution, Data Execution.", "Technical Details": "The vulnerability is caused by insufficient input validation and sanitization in the thumbnails.php file, allowing attackers to inject malicious SQL code.", "Detection": "Detecting this vulnerability involves analyzing web server logs for suspicious SQL commands and identifying affected versions of Coppermine Photo Gallery.", "Mitigation": "Apply the latest patches, avoid using affected versions of Coppermine Photo Gallery, and implement strict input validation and sanitization practices.", "Conclusion": "The CVE-2007-1107 vulnerability in Coppermine Photo Gallery 1.3.x is a serious threat that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "Coppermine Photo Gallery 1.3.x contains a critical SQL injection vulnerability that can be exploited by authenticated users.", "Business Impact": "This vulnerability can cause data breaches, compromised user data, and disruption of business operations.", "Technical Impact": "The vulnerability can cause partial system compromise, data tampering, and unauthorized access to sensitive data.", "Mitigation Strategies": "Update to the latest patch, restrict access to affected versions, and implement strict security protocols.", "Recommendations": "Executives should prioritize patching and security upgrades, train employees on security best practices, and conduct regular security audits.", "Conclusions": "The CVE-2007-1107 vulnerability is a significant threat that requires immediate attention from executives and technical teams."}}