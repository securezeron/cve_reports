{"id": "CVE-2020-11100", "sourceIdentifier": "cve@mitre.org", "published": "2020-04-02T15:15:17.483", "lastModified": "2023-11-07T03:14:30.167", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In hpack_dht_insert in hpack-tbl.c in the HPACK decoder in HAProxy 1.8 through 2.x before 2.1.4, a remote attacker can write arbitrary bytes around a certain location on the heap via a crafted HTTP/2 request, possibly causing remote code execution."}, {"lang": "es", "value": "En la funci\u00f3n hpack_dht_insert en el archivo hpack-tbl.c en el decodificador HPACK en HAProxy versiones 1.8 hasta 2.x anteriores a 2.1.4, un atacante remoto puede escribir bytes arbitrarios alrededor de una determinada ubicaci\u00f3n en la pila (heap) por medio de una petici\u00f3n HTTP/2 dise\u00f1ada, causando posiblemente una ejecuci\u00f3n de c\u00f3digo remoto."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-787"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:haproxy:haproxy:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.8.0", "versionEndExcluding": "2.1.4", "matchCriteriaId": "2876323F-F324-48B3-BD7D-D559EA0E856E"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform:3.11:*:*:*:*:*:*:*", "matchCriteriaId": "2F87326E-0B56-4356-A889-73D026DB1D4B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:openshift_container_platform:4.0:*:*:*:*:*:*:*", "matchCriteriaId": "932D137F-528B-4526-9A89-CD59FA1AB0FE"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:30:*:*:*:*:*:*:*", "matchCriteriaId": "97A4B8DF-58DA-4AB6-A1F9-331B36409BA3"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:31:*:*:*:*:*:*:*", "matchCriteriaId": "80F0FA5D-8D3B-4C0E-81E2-87998286AF33"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*", "matchCriteriaId": "23A7C53F-B80F-4E6A-AFA9-58EEA84BE11D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:19.10:*:*:*:*:*:*:*", "matchCriteriaId": "A31C8344-3E02-4EB8-8BD8-4C84B7959624"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*", "matchCriteriaId": "B620311B-34A3-48A6-82DF-6F078D7A4493"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-04/msg00002.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://packetstormsecurity.com/files/157323/haproxy-hpack-tbl.c-Out-Of-Bounds-Write.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.haproxy.org", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1819111", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://bugzilla.suse.com/show_bug.cgi?id=1168023", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://git.haproxy.org/?p=haproxy.git%3Ba=commit%3Bh=5dfc5d5cd0d2128d77253ead3acf03a421ab5b88", "source": "cve@mitre.org"}, {"url": "https://lists.debian.org/debian-security-announce/2020/msg00052.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/264C7UL3X7L7QE74ZJ557IOUFS3J4QQC/", "source": "cve@mitre.org"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/MNW5RZLIX7LOXRLV7WMHX22CI43XSXKW/", "source": "cve@mitre.org"}, {"url": "https://security.gentoo.org/glsa/202012-22", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/4321-1/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2020/dsa-4649", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.haproxy.org/download/2.1/src/CHANGELOG", "source": "cve@mitre.org", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "https://www.mail-archive.com/haproxy%40formilux.org/msg36876.html", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1407", "comment": "CVE-2020-11100 - This is a classic example of a remote code execution vulnerability that can be exploited using a crafted HTTP/2 request. It is essential to check the code execution logic for any user-controlled data and validate all input data to prevent such attacks."}, {"techniqueID": "T1210", "comment": "CVE-2020-11100 - This vulnerability demonstrates the importance of proper input validation and sanitization to prevent buffer overflow attacks. It is crucial to identify and isolate all vulnerable components and update them with the latest security patches."}, {"techniqueID": "T1204", "comment": "CVE-2020-11100 - This CVE highlights the significance of secure coding practices in software development. It is essential to follow secure coding guidelines and conduct thorough security testing and validation to prevent similar vulnerabilities."}], "stix_bundle": {"objects": [{"id": "Vulnerability--3eefec03-45df-4c17-a0c9-f18f17a89b8e", "type": "vulnerability", "name": "HPACK decoder remote code execution vulnerability", "description": "In hpack_dht_insert in hpack-tbl.c in the HPACK decoder in HAProxy 1.8 through 2.x before 2.1.4, a remote attacker can write arbitrary bytes around a certain location on the heap via a crafted HTTP/2 request, possibly causing remote code execution.", "vulnerability_type": "remote_code_executation", "cvss": {"score": 8.8, "version": "3.1", "vector_string": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"}}, {"id": "Technique--5f6ecc5a-8f4c-432f-9609-41a5a94f43a8", "type": "technique", "name": "Buffer Overflow", "description": "Attempts to overflow a buffer with user-controled data in order to execute arbitrary code or to crash the application."}, {"id": "Threat--c7a9c53a-1e8f-4c26-b0e6-3be3d29f1a8a", "type": "threat", "name": "Remote Code Execution", "description": "An attack used to execute code on a remote system."}, {"id": "Course_of_Action--6f3476eb-43b6-4691-b9a1-8a7dd7ba14ce", "type": "course_of_action", "name": "Update HAProxy to versions 2.1.4 or higher", "description": "Update the HAProxy package to versions 2.1.4 or higher to fix the remote code execution vulnerability.", "mitigates": {"source": "Technique--5f6ecc5a-8f4c-432f-9609-41a5a94f43a8"}}], "relationship": [{"id": "Relationship--9f62cda3-1a45-48f8-9a5b-51f9d1c24b6c", "source": "Vulnerability--3eefec03-45df-4c17-a0c9-f18f17a89b8e", "target": "Technique--5f6ecc5a-8f4c-432f-9609-41a5a94f43a8", "type": "uses"}, {"id": "Relationship--7c6f7c3a-6a6d-49f4-95d5-b5d6a5cde8d1", "source": "Vulnerability--3eefec03-45df-4c17-a0c9-f18f17a89b8e", "target": "Threat--c7a9c53a-1e8f-4c26-b0e6-3be3d29f1a8a", "type": "targeted_by"}, {"id": "Relationship--3f3a45c7-3a4f-4f5e-bd28-f4af4156c32c", "source": "Course_of_Action--6f3476eb-43b6-4691-b9a1-8a7dd7ba14ce", "target": "Technique--5f6ecc5a-8f4c-432f-9609-41a5a94f43a8", "type": "mitigates"}]}, "technical_analysis": {"Introduction": "HPACK decoder remote code execution vulnerability in HAProxy 1.8 through 2.x before 2.1.4 allows an attacker to write arbitrary bytes around a certain location on the heap via a crafted HTTP/2 request.", "Impact and Scope": "The vulnerability allows for remote code execution, which can lead to the compromise of the system, data theft, and denial-of-service attacks. The impact is high as HAProxy is widely used and the vulnerability can be exploited remotely.", "Related MITRE ATT&CK Techniques": ["T1407", "T1210", "T1204"], "Technical Details": "The vulnerability is due to a buffer overflow in the HPACK decoder, which can be exploited by sending a crafted HTTP/2 request. The attack requires no authentication and can be launched from a remote location.", "Detection": "Network traffic monitoring and analysis are essential to detect this vulnerability. Network traffic monitoring tools, such as Wireshark, can be used to capture and analyze HTTP/2 traffic.", "Mitigation": ["Update HAProxy to versions 2.1.4 or higher", "Disable HTTP/2 protocol in HAProxy", "Configure HAProxy to only accept requests from trusted sources"], "Conclusion": "The HPACK decoder remote code execution vulnerability in HAProxy 1.8 through 2.x before 2.1.4 is a high-severity vulnerability that can be exploited remotely. Prompt action must be taken to update HAProxy, disable HTTP/2 protocol, and configure HAProxy to only accept requests from trusted sources."}, "executive_analysis": {"Overview": "The HPACK decoder remote code execution vulnerability in HAProxy 1.8 through 2.x before 2.1.4 is a critical vulnerability that requires immediate attention.", "Business Impact": "The vulnerability can lead to the compromise of HAProxy servers, data theft, and denial-of-service attacks, which can result in significant financial losses and damage to reputation.", "Technical Impact": "The vulnerability allows for remote code execution, which can lead to the compromise of the system, data theft, and denial-of-service attacks.", "Mitigation Strategies": ["Update HAProxy to versions 2.1.4 or higher", "Discontinue use of HAProxy 1.8 through 2.x before 2.1.4"], "Recommendations": ["Prioritize patching and updating HAProxy servers", "Implement network traffic monitoring and analysis", "Configure HAProxy to only accept requests from trusted sources"], "Conclusions": "The HPACK decoder remote code execution vulnerability in HAProxy 1.8 through 2.x before 2.1.4 is a critical vulnerability that requires immediate attention. Prompt action must be taken to update HAProxy, implement network traffic monitoring and analysis, and configure HAProxy to only accept requests from trusted sources."}}