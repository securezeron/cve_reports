{"id": "CVE-2015-8325", "sourceIdentifier": "cve@mitre.org", "published": "2016-05-01T01:59:00.143", "lastModified": "2022-12-13T12:15:18.010", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The do_setup_env function in session.c in sshd in OpenSSH through 7.2p2, when the UseLogin feature is enabled and PAM is configured to read .pam_environment files in user home directories, allows local users to gain privileges by triggering a crafted environment for the /bin/login program, as demonstrated by an LD_PRELOAD environment variable."}, {"lang": "es", "value": "La funci\u00f3n do_setup_env en session.c en sshd en OpenSSH hasta la versi\u00f3n 7.2p2, cuando la funcionalidad UseLogin est\u00e1 activa y PAM est\u00e1 configurado para leer archivos .pam_environment en directorios home de usuario, permite a usuarios locales obtener privilegios desencadenando un entorno manipulado para el programa /bin/login, seg\u00fan lo demostrado por una variable de entorno LD_PRELOAD."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "16F59A04-14CF-49E2-9973-645477EA09DA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:*:p2:*:*:*:*:*:*", "versionEndIncluding": "7.2", "matchCriteriaId": "4AFA4267-E15B-4826-9B98-63F68AB1627F"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_core:15.04:*:*:*:*:*:*:*", "matchCriteriaId": "91DF0C2A-2F5A-4C41-8793-FF132F8072FD"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:12.04:*:*:*:lts:*:*:*", "matchCriteriaId": "B6B7CAD7-9D4E-4FDB-88E3-1E583210A01F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:lts:*:*:*", "matchCriteriaId": "B5A6F2F3-4894-4392-8296-3B8DD2679084"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:15.10:*:*:*:*:*:*:*", "matchCriteriaId": "E88A537F-F4D0-46B9-9E37-965233C2A355"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_touch:15.04:*:*:*:*:*:*:*", "matchCriteriaId": "A6F2578E-045A-4B94-817A-57F4031D7565"}]}]}], "references": [{"url": "http://rhn.redhat.com/errata/RHSA-2016-2588.html", "source": "cve@mitre.org"}, {"url": "http://rhn.redhat.com/errata/RHSA-2017-0641.html", "source": "cve@mitre.org"}, {"url": "http://www.debian.org/security/2016/dsa-3550", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/86187", "source": "cve@mitre.org"}, {"url": "http://www.securitytracker.com/id/1036487", "source": "cve@mitre.org"}, {"url": "https://anongit.mindrot.org/openssh.git/commit/?id=85bdcd7c92fe7ff133bbc4e10a65c91810f88755", "source": "cve@mitre.org"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1328012", "source": "cve@mitre.org"}, {"url": "https://cert-portal.siemens.com/productcert/pdf/ssa-412672.pdf", "source": "cve@mitre.org"}, {"url": "https://people.canonical.com/~ubuntu-security/cve/2015/CVE-2015-8325.html", "source": "cve@mitre.org"}, {"url": "https://security-tracker.debian.org/tracker/CVE-2015-8325", "source": "cve@mitre.org"}, {"url": "https://security.gentoo.org/glsa/201612-18", "source": "cve@mitre.org"}, {"url": "https://security.netapp.com/advisory/ntap-20180628-0001/", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0005", "comment": "CVE-2015-8325 - Manipulation of Environment Variables for Elevation of Privilege (PowerLifting) utilizing PAM's ability to read .pam_environment files in user home directories, allowing a local user to gain elevated privileges. To defend against this attack, restrict access to sensitive directories and implement secure environment variable handling."}, {"techniqueID": "T1197", "comment": "CVE-2015-8325 - Credential Dumping from Process Memory using environment variables. An attacker can utilize LD_PRELOAD to manipulate environment variables, allowing them to dump credentials. To defend against this attack, implement credential store encryption, limit access to sensitive directories, and monitor process memory for suspicious activity."}], "stix_bundle": [{"type": "indicator", "id": "indicator--02e544a7-2e13-47db-a5a1-5ac38c5bceca", "created_by_ref": "identity--02e544a7-2e13-47db-a5a1-5ac38c5bceca", "modified": "2022-12-13T12:15:18.010", "created": "2016-05-01T01:59:00.143", "name": "CVE-2015-8325 Indicator", "description": "Indicator for CVE-2015-8325", "labels": ["vulnerability", "Local Elevation of Privilege", "Man-in-the-Middle"], "observable_data": [{"type": "windows-registry-key", "id": "observable--02e544a7-2e13-47db-a5a1-5ac38c5bceca", "created_by_ref": "identity--02e544a7-2e13-47db-a5a1-5ac38c5bceca", "modified": "2022-12-13T12:15:18.010", "created": "2016-05-01T01:59:00.143", "name": "HKEY_CURRENT_USER\\Environment\\LD_PRELOAD", "value": "LD_PRELOAD", "description": "Indicator for CVE-2015-8325"}], "objects": [{"type": "identity", "id": "identity--02e544a7-2e13-47db-a5a1-5ac38c5bceca", "name": "CVE-2015-8325"}], "relationships": [{"type": "has-note", "id": "has-note--02e544a7-2e13-47db-a5a1-5ac38c5bceca", "from_ref": "indicator--02e544a7-2e13-47db-a5a1-5ac38c5bceca", "to_ref": "note--02e544a7-2e13-47db-a5a1-5ac38c5bceca"}]}, {"type": "note", "id": "note--02e544a7-2e13-47db-a5a1-5ac38c5bceca", "created_by_ref": "identity--02e544a7-2e13-47db-a5a1-5ac38c5bceca", "modified": "2022-12-13T12:15:18.010", "created": "2016-05-01T01:59:00.143", "name": "Note for CVE-2015-8325", "description": "Note for CVE-2015-8325", "content": "To defend against this attack, restrict access to sensitive directories and implement secure environment variable handling."}], "technical_analysis": {"Introduction": "CVE-2015-8325 is a vulnerability in OpenSSH through 7.2p2 that allows a local user to gain elevated privileges by manipulating environment variables. The vulnerability is due to the way PAM's ability to read .pam_environment files in user home directories is handled.", "Impact and Scope": "The vulnerability has a CVSS score of 7.8, with an attack vector of LOCAL and privileges required of LOW.", "Related MITRE ATT&CK Techniques": "TA0005, T1197", "Technical Details": "The vulnerability is exploited by manipulating environment variables, allowing an attacker to gain elevated privileges. PAM's ability to read .pam_environment files in user home directories is the key to the vulnerability.", "Detection": "Detection can be done by monitoring process memory for suspicious activity and implementing credential store encryption.", "Mitigation": "Mitigation strategies include restricting access to sensitive directories, implementing secure environment variable handling, and monitoring process memory for suspicious activity.", "Conclusion": "In conclusion, CVE-2015-8325 is a vulnerability that allows a local user to gain elevated privileges by manipulating environment variables. It is important to implement secure environment variable handling and monitor process memory for suspicious activity to defend against this attack."}, "executive_analysis": {"Overview": "CVE-2015-8325 is a vulnerability in OpenSSH that allows a local user to gain elevated privileges by manipulating environment variables.", "Business Impact": "Business impact includes the potential for unauthorized access to sensitive information and systems.", "Technical Impact": "Technical impact includes the potential for data breaches, system compromise, and sensitive information theft.", "Mitigation Strategies": "Mitigation strategies include restricting access to sensitive directories, implementing secure environment variable handling, and monitoring process memory for suspicious activity.", "Recommendations": "Recommendations for executives include implementing secure environment variable handling, monitoring process memory for suspicious activity, and restricting access to sensitive directories.", "Conclusions": "In conclusion, CVE-2015-8325 is a serious vulnerability that requires immediate attention and action to mitigate. Implementing secure environment variable handling and monitoring process memory for suspicious activity can help prevent this attack."}}