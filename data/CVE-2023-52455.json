{"id": "CVE-2023-52455", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-02-23T15:15:08.193", "lastModified": "2024-04-30T19:34:34.080", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\niommu: Don't reserve 0-length IOVA region\n\nWhen the bootloader/firmware doesn't setup the framebuffers, their\naddress and size are 0 in \"iommu-addresses\" property. If IOVA region is\nreserved with 0 length, then it ends up corrupting the IOVA rbtree with\nan entry which has pfn_hi < pfn_lo.\nIf we intend to use display driver in kernel without framebuffer then\nit's causing the display IOMMU mappings to fail as entire valid IOVA\nspace is reserved when address and length are passed as 0.\nAn ideal solution would be firmware removing the \"iommu-addresses\"\nproperty and corresponding \"memory-region\" if display is not present.\nBut the kernel should be able to handle this by checking for size of\nIOVA region and skipping the IOVA reservation if size is 0. Also, add\na warning if firmware is requesting 0-length IOVA region reservation."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: iommu: no reservar regi\u00f3n IOVA de longitud 0 Cuando el gestor de arranque/firmware no configura los framebuffers, su direcci\u00f3n y tama\u00f1o son 0 en la propiedad \"iommu-addresses\". Si la regi\u00f3n IOVA est\u00e1 reservada con una longitud de 0, termina corrompiendo el rbtree de IOVA con una entrada que tiene pfn_hi &lt; pfn_lo. Si pretendemos utilizar el controlador de pantalla en el kernel sin framebuffer, entonces las asignaciones IOMMU de pantalla fallar\u00e1n ya que se reserva todo el espacio IOVA v\u00e1lido cuando la direcci\u00f3n y la longitud se pasan como 0. Una soluci\u00f3n ideal ser\u00eda que el firmware elimine la propiedad \"iommu-addresses\". y la \"regi\u00f3n de memoria\" correspondiente si la pantalla no est\u00e1 presente. Pero el kernel deber\u00eda poder manejar esto verificando el tama\u00f1o de la regi\u00f3n IOVA y omitiendo la reserva de IOVA si el tama\u00f1o es 0. Adem\u00e1s, agregue una advertencia si el firmware solicita una reserva de regi\u00f3n IOVA de longitud 0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.3.0", "versionEndExcluding": "6.6.14", "matchCriteriaId": "723F5211-5C37-4F95-A4D3-FA6C2E6F914C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7.0", "versionEndExcluding": "6.7.2", "matchCriteriaId": "0EA3778C-730B-464C-8023-18CA6AC0B807"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/5e23e283910c9f30248732ae0770bcb0c9438abf", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/98b8a550da83cc392a14298c4b3eaaf0332ae6ad", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/bb57f6705960bebeb832142ce9abf43220c3eab1", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2023-52455 - Example of a potential exploitation of an IOVA region reservation vulnerability leading to a display IOMMU mapping failure."}, {"techniqueID": "T1218", "comment": "CVE-2023-52455 - Example of a potential exploitation of a weakness in IOVA region handling by an opponent leading to arbitrary memory mapping."}, {"techniqueID": "T1043", "comment": "CVE-2023-52455 - Example of a potential exploitation of a weakness in display IOMMU handling by an opponent leading to memory exploitation."}], "stix_bundle": "{\"type\":\"bundle\",\"spec_version\":\"2.1\",\"objects\":[{\"type\":\"vulnerability\",\"id\":\"CVE-2023-52455\",\"name\":\"Linux Kernel IOVA Region Reservation Vulnerability\",\"description\":\"NVD-CWE-noinfo\",\"severity\":\"HIGH\",\"cvssv3\":{\"base_score\":7.8,\"base_severity\":\"HIGH\",\"vectorString\":\"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H\"},\" exploited\":{\"primary\":{\"technique_ids\":[\"T1190\",\"T1218\",\"T1043\"]}}},{\"type\":\"course-of-action\",\"id\":\"mitigation-strategy-1\",\"name\":\"Disable IOVA region reservation\",\"description\":\"Disable IOVA region reservation to prevent potential exploitation of the vulnerability.\",\"mitigated_by\":{\"technique_ids\":[\"T1190\",\"T1218\",\"T1043\"]}},{\"type\":\"course-of-action\",\"id\":\"mitigation-strategy-2\",\"name\":\"Validate IOVA region size\",\"description\":\"Validate IOVA region size before reserving it to prevent potential exploitation of the vulnerability.\",\"mitigated_by\":{\"technique_ids\":[\"T1190\",\"T1218\",\"T1043\"]}}],\"relationships\":[{\"type\":\"related-to\",\"id\":\"CVE-2023-52455\",\"source\":\"mitigation-strategy-1\",\"destination\":\"mitigation-strategy-2\"},{\"type\":\"mitigated-by\",\"id\":\"CVE-2023-52455\",\"source\":\"mitigation-strategy-1\",\"destination\":\"T1190\",\"destination\":\"T1218\",\"destination\":\"T1043\"}]}\n", "technical_analysis": {"Introduction": "The CVE-2023-52455 vulnerability is a high-severity IOVA region reservation vulnerability in the Linux kernel.", "Impact and Scope": "The vulnerability has a CVSS score of 7.8, with an attack vector of LOCAL, and can lead to arbitrary memory mapping and subsequent exploitation.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190, T1218, and T1043, which describe potential exploitation scenarios.", "Technical Details": "The vulnerability occurs due to a weakness in IOVA region handling, which can be exploited by an opponent to gain arbitrary memory mapping.", "Detection": "Detection of the vulnerability can be achieved by monitoring for suspicious memory mapping calls.", "Mitigation": "Mitigation strategies include disabling IOVA region reservation and validating IOVA region size before reserving it.", "Conclusion": "The CVE-2023-52455 vulnerability is a high-severity vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2023-52455 vulnerability is a critical security issue that can lead to exploitation and data breaches.", "Business Impact": "The vulnerability can have significant business impact, disrupting operations and resulting in financial losses.", "Technical Impact": "The vulnerability can be exploited to gain arbitrary memory mapping, leading to unauthorized access and data breaches.", "Mitigation Strategies": "Immediate mitigation strategies include disabling IOVA region reservation and validating IOVA region size before reserving it.", "Recommendations": "We recommend implementing these mitigation strategies and monitoring for suspicious memory mapping calls.", "Conclusions": "The CVE-2023-52455 vulnerability is a serious security issue that requires immediate attention and mitigation."}}