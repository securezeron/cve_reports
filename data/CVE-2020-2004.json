{"id": "CVE-2020-2004", "sourceIdentifier": "psirt@paloaltonetworks.com", "published": "2020-05-13T19:15:13.190", "lastModified": "2020-05-15T18:40:39.377", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Under certain circumstances a user's password may be logged in cleartext in the PanGPS.log diagnostic file when logs are collected for troubleshooting on GlobalProtect app (also known as GlobalProtect Agent) for MacOS and Windows. For this issue to occur all of these conditions must be true: (1) 'Save User Credential' option should be set to 'Yes' in the GlobalProtect Portal's Agent configuration, (2) the GlobalProtect user manually selects a gateway, (3) and the logging level is set to 'Dump' while collecting troubleshooting logs. This issue does not affect GlobalProtect app on other platforms (for example iOS/Android/Linux). This issue affects GlobalProtect app 5.0 versions earlier than 5.0.9, GlobalProtect app 5.1 versions earlier than 5.1.2 on Windows or MacOS. Since becoming aware of the issue, Palo Alto Networks has safely deleted all the known GlobalProtectLogs zip files sent by customers with the credentials. We now filter and remove these credentials from all files sent to Customer Support. The GlobalProtectLogs zip files uploaded to Palo Alto Networks systems were only accessible by authorized personnel with valid Palo Alto Networks credentials. We do not have any evidence of malicious access or use of these credentials."}, {"lang": "es", "value": "Bajo determinadas circunstancias, la contrase\u00f1a de usuario puede ser registrada en texto sin cifrar en el archivo de diagn\u00f3stico PanGPS.log cuando registros son recolectados para la soluci\u00f3n de problemas en la aplicaci\u00f3n GlobalProtect (tambi\u00e9n se conoce como Agente GlobalProtect) para MacOS y Windows. Para que este problema se presente, todas estas condiciones deben ser ciertas: (1) la opci\u00f3n \"Save User Credential\" debe establecerse en \"Yes\" en la configuraci\u00f3n del Agente del portal de GlobalProtect, (2) el usuario de GlobalProtect selecciona manualmente una puerta de enlace, (3) y el nivel de registro se establece en \"Dump\" al recolectar registros de soluci\u00f3n de problemas. Este problema no afecta a la aplicaci\u00f3n GlobalProtect en otras plataformas (por ejemplo, iOS/Android/Linux). Este problema afecta a la aplicaci\u00f3n GlobalProtect versiones 5.0 anteriores a 5.0.9, la aplicaci\u00f3n GlobalProtect versiones 5.1 anteriores a 5.1.2 en Windows o MacOS. Desde que se percibi\u00f3 el problema, Palo Alto Networks ha eliminado de forma segura todos los archivos zip de GlobalProtectLogs conocidos enviados por los clientes con las credenciales. Ahora filtramos y eliminamos estas credenciales de todos los archivos enviados a Atenci\u00f3n al Cliente. Los archivos zip de GlobalProtectLogs cargados en los sistemas de Palo Alto Networks solo fueron accesibles por personal autorizado con credenciales v\u00e1lidas de Palo Alto Networks. No tenemos evidencia de acceso malicioso o uso de estas credenciales."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}, {"source": "psirt@paloaltonetworks.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 5.5}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 1.7}, "baseSeverity": "LOW", "exploitabilityScore": 3.1, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-532"}]}, {"source": "psirt@paloaltonetworks.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-534"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:paloaltonetworks:globalprotect:*:*:*:*:*:macos:*:*", "versionStartIncluding": "5.0.0", "versionEndExcluding": "5.0.9", "matchCriteriaId": "E1C3559D-B1AF-4E7E-B478-064B03BC4B74"}, {"vulnerable": true, "criteria": "cpe:2.3:a:paloaltonetworks:globalprotect:*:*:*:*:*:windows:*:*", "versionStartIncluding": "5.0.0", "versionEndExcluding": "5.0.9", "matchCriteriaId": "ED7517A7-68E4-485B-B0A0-FDCADA3813E0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:paloaltonetworks:globalprotect:*:*:*:*:*:macos:*:*", "versionStartIncluding": "5.1.0", "versionEndExcluding": "5.1.2", "matchCriteriaId": "16065771-C1A9-4EF1-A3FD-482F862E68FE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:paloaltonetworks:globalprotect:*:*:*:*:*:windows:*:*", "versionStartIncluding": "5.1.0", "versionEndExcluding": "5.1.2", "matchCriteriaId": "DA6691CC-A568-4E6B-95FC-E30A6F6D493D"}]}]}], "references": [{"url": "https://security.paloaltonetworks.com/CVE-2020-2004", "source": "psirt@paloaltonetworks.com", "tags": ["Mitigation", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1568.001", "comment": " CVE-2020-2004 - This vulnerability allows an attacker to log in cleartext using GlobalProtect due to improper configuration. To defend against this, ensure that 'Save User Credential' is set to 'No' in the GlobalProtect Portal's Agent configuration, and do not set the logging level to 'Dump' while collecting troubleshooting logs."}, {"techniqueID": "TA0008", "comment": " CVE-2020-2004 - This vulnerability demonstrates the importance of configuring logging correctly to prevent unauthorized access to sensitive information. To defend against this, implement proper logging and monitoring configurations to detect and prevent unauthorized access."}, {"techniqueID": "T1190", "comment": " CVE-2020-2004 - This vulnerability highlights the need for secure configuration and monitoring of security appliances. To defend against this, ensure that security appliances are configured securely and monitored regularly to detect and prevent malicious activity."}, {"techniqueID": "T1561.001", "comment": " CVE-2020-2004 - This vulnerability allows an attacker to access sensitive information due to improper configuration. To defend against this, ensure that sensitive information is properly secured and access controls are configured to prevent unauthorized access."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/2020-2004.stix2.1", "description": "STIX Bundle for CVE-2020-2004", "objects": [{"type": "vulnerability", "id": "https://example.com/2020-2004", "description": "Under certain circumstances, a user's password may be logged in cleartext in the PanGPS.log diagnostic file when logs are collected for troubleshooting on GlobalProtect app for MacOS and Windows.", "mitigation": [{"type": "mitigation", "id": "https://example.com/2020-2004-mitigation", "description": "Configure logging correctly to prevent unauthorized access to sensitive information."}], "related_threats": [{"type": "threat_actor", "id": "https://example.com/advanced_threat_actor", "description": "Advanced Persistent Threat (APT) groups, nation-state actors, and other sophisticated threat actors"}]}]}, "technical_analysis": {"Introduction": "The CVE-2020-2004 vulnerability is a privilege escalation vulnerability that allows an attacker to log in cleartext using GlobalProtect due to improper configuration.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to access sensitive information. The scope of this vulnerability is limited to GlobalProtect users who have the 'Save User Credential' option set to 'Yes' in the GlobalProtect Portal's Agent configuration.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are TA0008, T1190, T1561.001, and T1568.001.", "Technical Details": "The vulnerability is caused by improper configuration of the GlobalProtect Portal's Agent configuration, which allows an attacker to log in cleartext. The logging level can be set to 'Dump' to collect troubleshooting logs, which can also reveal sensitive information.", "Detection": "Detection of this vulnerability can be done by monitoring logs for sensitive information and monitoring user activity for suspicious behavior.", "Mitigation": "Mitigation strategies include configuring logging correctly, monitoring logs for sensitive information, and implementing proper access controls to prevent unauthorized access.", "Conclusion": "In conclusion, the CVE-2020-2004 vulnerability is a serious vulnerability that can allow an attacker to access sensitive information. It is important to implement proper mitigation strategies to prevent exploitation of this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2020-2004 vulnerability is a privilege escalation vulnerability that allows an attacker to log in cleartext using GlobalProtect due to improper configuration.", "Business Impact": "This vulnerability can have a significant business impact, as it can allow an attacker to access sensitive information and disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is the potential for data breaches and unauthorized access to sensitive information.", "Mitigation Strategies": "Mitigation strategies include configuring logging correctly, monitoring logs for sensitive information, and implementing proper access controls to prevent unauthorized access.", "Recommendations": "We recommend that you implement proper mitigation strategies to prevent exploitation of this vulnerability and ensure the security of your organization's sensitive information.", "Conclusions": "In conclusion, the CVE-2020-2004 vulnerability is a serious vulnerability that requires immediate attention and mitigation. We recommend that you take immediate action to prevent exploitation of this vulnerability and ensure the security of your organization's sensitive information."}}