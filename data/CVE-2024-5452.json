{"id": "CVE-2024-5452", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T18:15:20.970", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A remote code execution (RCE) vulnerability exists in the lightning-ai/pytorch-lightning library version 2.2.1 due to improper handling of deserialized user input and mismanagement of dunder attributes by the `deepdiff` library. The library uses `deepdiff.Delta` objects to modify application state based on frontend actions. However, it is possible to bypass the intended restrictions on modifying dunder attributes, allowing an attacker to construct a serialized delta that passes the deserializer whitelist and contains dunder attributes. When processed, this can be exploited to access other modules, classes, and instances, leading to arbitrary attribute write and total RCE on any self-hosted pytorch-lightning application in its default configuration, as the delta endpoint is enabled by default."}, {"lang": "es", "value": "Existe una vulnerabilidad de ejecuci\u00f3n remota de c\u00f3digo (RCE) en la versi\u00f3n 2.2.1 de la librer\u00eda Lightning-ai/pytorch-lightning debido al manejo inadecuado de la entrada del usuario deserializada y a la mala administraci\u00f3n de los atributos dunder por parte de la librer\u00eda \"deepdiff\". La librer\u00eda utiliza objetos `deepdiff.Delta` para modificar el estado de la aplicaci\u00f3n en funci\u00f3n de las acciones del frontend. Sin embargo, es posible eludir las restricciones previstas sobre la modificaci\u00f3n de los atributos de dunder, lo que permite a un atacante construir un delta serializado que pasa la lista blanca de deserializadores y contiene atributos de dunder. Cuando se procesa, esto se puede aprovechar para acceder a otros m\u00f3dulos, clases e instancias, lo que lleva a una escritura de atributos arbitraria y un RCE total en cualquier aplicaci\u00f3n pytorch-lightning autohospedada en su configuraci\u00f3n predeterminada, ya que el endpoint delta est\u00e1 habilitado de forma predeterminada."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-915"}]}], "references": [{"url": "https://huntr.com/bounties/486add92-275e-4a7b-92f9-42d84bc759da", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-5452 - Improper Input Validation can be used to exploit the vulnerability and execute arbitrary code, which can be mitigated by implementing input validation and sanitization techniques."}, {"techniqueID": "T1194", "comment": "CVE-2024-5452 - Deserialization of Untrusted Data can lead to code execution, which can be mitigated by using secure deserialization practices and validating user input."}, {"techniqueID": "T1210", "comment": "CVE-2024-5452 - Injection can be used to exploit the vulnerability, which can be mitigated by implementing secure coding practices and validating user input."}, {"techniqueID": "T1562", "comment": "CVE-2024-5452 - A remote code execution (RCE) vulnerability can be exploited to execute arbitrary code, which can be mitigated by implementing secure coding practices and validated user input."}, {"techniqueID": "T1133", "comment": "CVE-2024-5452 - File and Objects with Write Access can be exploited to write arbitrary files, which can be mitigated by implementing secure file permissions and access controls."}, {"techniqueID": "T1505", "comment": "CVE-2024-5452 - Pre-Authentication Command Injection can be used to exploit the vulnerability, which can be mitigated by implementing secure coding practices and validating user input."}], "stix_bundle": {"stix_version": "2.1", "bundle_info": {"name": "CVE-2024-5452 Vulnerability Bundle", "description": "A STIX 2.1 bundle expressing the vulnerability, related techniques, risks and defense strategies for CVE-2024-5452"}, "objects": [{"type": "vulnerability", "id": "vulnerability--CVE-2024-5452", "name": "CVE-2024-5452 Vulnerability", "description": "A remote code execution (RCE) vulnerability in the lightning-ai/pytorch-lightning library version 2.2.1", "published": "2024-06-06T18:15:20.970", "last_modified": "2024-06-07T14:56:05.647"}, {"type": "relationship", "id": "relationship--1", "vulnerability_id": "vulnerability--CVE-2024-5452", "technique_id": "attack_pattern--T1190", "relationship_type": "associated_with"}, {"type": "relationship", "id": "relationship--2", "vulnerability_id": "vulnerability--CVE-2024-5452", "technique_id": "attack_pattern--T1194", "relationship_type": "associated_with"}, {"type": "relationship", "id": "relationship--3", "vulnerability_id": "vulnerability--CVE-2024-5452", "technique_id": "attack_pattern--T1210", "relationship_type": "associated_with"}, {"type": "relationship", "id": "relationship--4", "vulnerability_id": "vulnerability--CVE-2024-5452", "technique_id": "attack_pattern--T1562", "relationship_type": "associated_with"}, {"type": "relationship", "id": "relationship--5", "vulnerability_id": "vulnerability--CVE-2024-5452", "technique_id": "attack_pattern--T1133", "relationship_type": "associated_with"}, {"type": "relationship", "id": "relationship--6", "vulnerability_id": "vulnerability--CVE-2024-5452", "technique_id": "attack_pattern--T1505", "relationship_type": "associated_with"}]}, "technical_analysis": {"Introduction": "The CVE-2024-5452 vulnerability is a remote code execution vulnerability in the lightning-ai/pytorch-lightning library version 2.2.1.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8, an attack vector of NETWORK, and can lead to arbitrary code execution.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1190, T1194, T1210, T1562, T1133, and T1505.", "Technical Details": "The vulnerability is due to improper handling of deserialized user input and mismanagement of dunder attributes by the `deepdiff` library.", "Detection": "The vulnerability can be detected by monitoring for suspicious network traffic and analyzing system logs.", "Mitigation": "The vulnerability can be mitigated by updating the lightning-ai/pytorch-lightning library to a safe version and implementing secure coding practices.", "Conclusion": "In conclusion, the CVE-2024-5452 vulnerability is a critical vulnerability that requires immediate attention and action to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-5452 vulnerability is a remote code execution vulnerability that can lead to arbitrary code execution and has a high potential for exploitation.", "Business Impact": "The vulnerability has the potential to cause significant harm to an organization's operations and reputation.", "Technical Impact": "The vulnerability can be exploited to execute arbitrary code and take control of a system.", "Mitigation Strategies": "The vulnerability can be mitigated by updating the lightning-ai/pytorch-lightning library to a safe version and implementing secure coding practices.", "Recommendations": "It is recommended that organizations complete a thorough risk assessment and implement the necessary mitigation strategies to prevent exploitation.", "Conclusions": "In conclusion, the CVE-2024-5452 vulnerability is a critical vulnerability that requires immediate attention and action to prevent exploitation."}}