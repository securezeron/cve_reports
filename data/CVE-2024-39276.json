{"id": "CVE-2024-39276", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-25T15:15:13.903", "lastModified": "2024-06-25T18:50:42.040", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: fix mb_cache_entry's e_refcnt leak in ext4_xattr_block_cache_find()\n\nSyzbot reports a warning as follows:\n\n============================================\nWARNING: CPU: 0 PID: 5075 at fs/mbcache.c:419 mb_cache_destroy+0x224/0x290\nModules linked in:\nCPU: 0 PID: 5075 Comm: syz-executor199 Not tainted 6.9.0-rc6-gb947cc5bf6d7\nRIP: 0010:mb_cache_destroy+0x224/0x290 fs/mbcache.c:419\nCall Trace:\n <TASK>\n ext4_put_super+0x6d4/0xcd0 fs/ext4/super.c:1375\n generic_shutdown_super+0x136/0x2d0 fs/super.c:641\n kill_block_super+0x44/0x90 fs/super.c:1675\n ext4_kill_sb+0x68/0xa0 fs/ext4/super.c:7327\n[...]\n============================================\n\nThis is because when finding an entry in ext4_xattr_block_cache_find(), if\next4_sb_bread() returns -ENOMEM, the ce's e_refcnt, which has already grown\nin the __entry_find(), won't be put away, and eventually trigger the above\nissue in mb_cache_destroy() due to reference count leakage.\n\nSo call mb_cache_entry_put() on the -ENOMEM error branch as a quick fix."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: ext4: soluciona la fuga de e_refcnt de mb_cache_entry en ext4_xattr_block_cache_find() Syzbot informa una advertencia de la siguiente manera: ======================= ======================= ADVERTENCIA: CPU: 0 PID: 5075 en fs/mbcache.c:419 mb_cache_destroy+0x224/0x290 M\u00f3dulos vinculados en: CPU: 0 PID: 5075 Comm: syz-executor199 No contaminado 6.9.0-rc6-gb947cc5bf6d7 RIP: 0010:mb_cache_destroy+0x224/0x290 fs/mbcache.c:419 Seguimiento de llamadas:  ext4_put_super+0x6d4/0xcd0 fs/ext4/super .c:1375 generic_shutdown_super+0x136/0x2d0 fs/super.c:641 kill_block_super+0x44/0x90 fs/super.c:1675 ext4_kill_sb+0x68/0xa0 fs/ext4/super.c:7327 [...] === ========================================= Esto se debe a que al encontrar una entrada en ext4_xattr_block_cache_find (), si ext4_sb_bread() devuelve -ENOMEM, el e_refcnt del ce, que ya ha crecido en __entry_find(), no se guardar\u00e1 y, eventualmente, desencadenar\u00e1 el problema anterior en mb_cache_destroy() debido a una fuga del recuento de referencias. Entonces llame a mb_cache_entry_put() en la rama de error -ENOMEM como soluci\u00f3n r\u00e1pida."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0c0b4a49d3e7f49690a6827a41faeffad5df7e21", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/681ff9a09accd8a4379f8bd30b7a1641ee19bb3e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/76dc776153a47372719d664e0fc50d6355791abb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/896a7e7d0d555ad8b2b46af0c2fa7de7467f9483", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9ad75e78747b5a50dc5a52f0f8e92e920a653f16", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/a95df6f04f2c37291adf26a74205cde0314d4577", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b37c0edef4e66fb21a2fbc211471195a383e5ab8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e941b712e758f615d311946bf98216e79145ccd9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-39276 - This vulnerability allows for a reference count leakage, which can be exploited by an attacker to gain arbitrary memory access. This is relevant to the Linux kernel and can be defended against by implementing proper memory management and access controls."}, {"techniqueID": "T1193", "comment": "CVE-2024-39276 - The vulnerability in the Linux kernel's ext4 filesystem can be exploited by an attacker to crash the system or potentially gain elevated privileges. This is relevant to the ext4 filesystem and can be defended against by implementing proper access controls and validation checks."}, {"techniqueID": "T1354", "comment": "CVE-2024-39276 - The vulnerability in the Linux kernel's mbcache component can be exploited by an attacker to crash the system or potentially gain elevated privileges. This is relevant to the mbcache component and can be defended against by implementing proper access controls and validation checks."}], "stix_bundle": {"type": "bundle", "description": "STIX 2.1 bundle for CVE-2024-39276", "objects": [{"type": "threat-actor", "id": " threat-actor-1", "name": "Unknown Threat Actor", "description": "A unknown threat actor is believed to be behind the attacks"}, {"type": "vulnerability", "id": "vulnerability-1", "name": "Linux Kernel Vulnerability", "description": "A vulnerability in the Linux kernel's ext4 filesystem allows an attacker to crash the system or potentially gain elevated privileges"}, {"type": "indicator", "id": "indicator-1", "name": "Linux Kernel Indicator", "description": "Indicates the presence of the vulnerability in the Linux kernel's ext4 filesystem"}, {"type": "tactic", "id": "tactic-1", "name": "Persistence", "description": "Tactic used by the threat actor to achieve persistence"}, {"type": "technique", "id": "technique-1", "name": "Exploit Public-Facing Application", "description": "Exploit the public-facing application to gain access to the system"}, {"type": "malware", "id": "malware-1", "name": "Linux Kernel Rootkit", "description": "A malware that allows an attacker to gain elevated privileges and control over the system"}, {"type": "course-of-action", "id": "course-of-action-1", "name": "Update the Linux Kernel", "description": "Update the Linux kernel to the latest version to address the vulnerability"}], "relationships": [{"source_ref": "vulnerability-1", "target_ref": "indicator-1", "type": "indicates"}, {"source_ref": "vulnerability-1", "target_ref": "tactic-1", "type": "uses"}, {"source_ref": "tactic-1", "target_ref": "technique-1", "type": "uses"}, {"source_ref": "technique-1", "target_ref": "malware-1", "type": "uses"}, {"source_ref": "malware-1", "target_ref": "course-of-action-1", "type": "mitigates"}]}, "technical_analysis": {"Introduction": "This technical analysis provides a detailed overview of the CVE-2024-39276 vulnerability in the Linux kernel's ext4 filesystem.", "Impact and Scope": "The vulnerability allows an attacker to crash the system or potentially gain elevated privileges, making it a high-risk vulnerability.", "Related MITRE ATT&CK Techniques": "T1190, T1193, T1354", "Technical Details": "The vulnerability is caused by a reference count leakage in the mbcache component of the Linux kernel.", "Detection": "Detection of the vulnerability can be done using system logs and network traffic analysis.", "Mitigation": "Mitigation strategies include updating the Linux kernel to the latest version and implementing proper access controls and validation checks.", "Conclusion": "In conclusion, the CVE-2024-39276 vulnerability is a significant security risk that requires prompt attention and mitigation."}, "executive_analysis": {"Overview": "This executive analysis provides a high-level overview of the CVE-2024-39276 vulnerability and its potential impact on the organization.", "Business Impact": "The vulnerability has the potential to compromise the confidentiality, integrity, and availability of sensitive data, making it a significant business risk.", "Technical Impact": "The vulnerability has the potential to cause system crashes, data loss, and unauthorized access to sensitive data.", "Mitigation Strategies": "The recommended mitigation strategies include updating the Linux kernel to the latest version and implementing proper access controls and validation checks.", "Recommendations": "Recommendations for executives include prioritizing the mitigation of the vulnerability and implementing a comprehensive incident response plan.", "Conclusions": "In conclusion, the CVE-2024-39276 vulnerability is a significant security risk that requires prompt attention and mitigation."}}