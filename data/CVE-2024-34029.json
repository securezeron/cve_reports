{"id": "CVE-2024-34029", "sourceIdentifier": "responsibledisclosure@mattermost.com", "published": "2024-05-26T14:15:09.367", "lastModified": "2024-05-28T12:39:28.377", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Mattermost versions 9.5.x <= 9.5.3, 9.7.x <= 9.7.1 and 8.1.x <= 8.1.12 fail to perform a proper authorization check in the /api/v4/groups/<group-id>/channels/<channel-id>/link endpoint\u00a0which allows a user\u00a0to learn the members of\u00a0an AD/LDAP group that is linked to a team by adding the group to a channel, even if the user has no access to the team."}, {"lang": "es", "value": "Las versiones 9.5.x &lt;= 9.5.3, 9.7.x &lt;= 9.7.1 y 8.1.x &lt;= 8.1.12 de Mattermost no realizan una verificaci\u00f3n de autorizaci\u00f3n adecuada en /api/v4/groups// canales//link endpoint que permite a un usuario conocer los miembros de un grupo AD/LDAP que est\u00e1 vinculado a un equipo agregando el grupo a un canal, incluso si el usuario no tiene acceso al equipo."}], "metrics": {"cvssMetricV31": [{"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "responsibledisclosure@mattermost.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}]}], "references": [{"url": "https://mattermost.com/security-updates", "source": "responsibledisclosure@mattermost.com"}], "techniques": [{"techniqueID": "TA0003", "comment": "CVE-2024-34029 - Lateral Movement through AD/LDAP Group Linking, Attackers can move laterally through a network by linking AD/LDAP groups to teams, which can lead to unauthorized access to sensitive information."}, {"techniqueID": "TA0002", "comment": "CVE-2024-34029 - Initial Access through Misconfigured Link Endpoint, Attackers can utilise the misconfigured /api/v4/groups/<group-id>/channels/<channel-id>/link endpoint to access unauthorized information."}, {"techniqueID": "TA0005", "comment": "CVE-2024-34029 - Defense Evasion through Lack of Proper Authorization, Attackers can evade detection by leveraging the lack of proper authorization checks in the vulnerable endpoint."}, {"techniqueID": "TA0008", "comment": "CVE-2024-34029 - Command and Control through Misconfigured Link Endpoint, Attackers can establish command and control channels through the misconfigured /api/v4/groups/<group-id>/channels/<channel-id>/link endpoint."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle--CVE-2024-34029", "created_by_ref": "user--some-user", "created": "2024-05-26T14:15:09.367Z", "modified": "2024-05-28T12:39:28.377Z", "objects": [{"type": "vulnerability", "id": "vulnerability--CVE-2024-34029", "created_by_ref": "user--some-user", "created": "2024-05-26T14:15:09.367Z", "modified": "2024-05-28T12:39:28.377Z", "name": "CVE-2024-34029", "description": "Mattermost versions 9.5.x <= 9.5.3, 9.7.x <= 9.7.1 and 8.1.x <= 8.1.12 fail to perform a proper authorization check in the /api/v4/groups/<group-id>/channels/<channel-id>/link endpoint", "attack_vector": "NETWORK", "attack_complexity": "LOW", "privileges_required": "LOW", "user_interaction": "NONE", "scope": "UNCHANGED", "confidentiality_impact": "LOW", "integrity_impact": "NONE", "availability_impact": "NONE", "base_severity": "MEDIUM", "base_score": 4.3, "exploitability_score": 2.8, "impact_score": 1.4}, {"type": "intrusion-set", "id": "intrusion-set--AD-LDAP-Group-Linking", "created_by_ref": "user--some-user", "created": "2024-05-26T14:15:09.367Z", "modified": "2024-05-28T12:39:28.377Z", "name": "AD/LDAP Group Linking", "description": "An attacker exploits the misconfigured /api/v4/groups/<group-id>/channels/<channel-id>/link endpoint to link AD/LDAP groups to teams, allowing for unauthorized access to sensitive information."}, {"type": "course-of-action", "id": "course-of-action--Defend-Against-Link-Endpoint", "created_by_ref": "user--some-user", "created": "2024-05-26T14:15:09.367Z", "modified": "2024-05-28T12:39:28.377Z", "name": "Defend Against Link Endpoint", "description": "Implement proper authorization checks in the /api/v4/groups/<group-id>/channels/<channel-id>/link endpoint."}, {"type": "note", "id": "note--AD-LDAP-Group-Linking-Defense", "created_by_ref": "user--some-user", "created": "2024-05-26T14:15:09.367Z", "modified": "2024-05-28T12:39:28.377Z", "content": "Defend against AD/LDAP group linking by implementing proper authorization checks in the /api/v4/groups/<group-id>/channels/<channel-id>/link endpoint."}], "relationships": [{"type": "vulnerability", "object_ref": "vulnerability--CVE-2024-34029", "relationship_type": "affected-by"}, {"type": "intrusion-set", "object_ref": "intrusion-set--AD-LDAP-Group-Linking", "relationship_type": "exploits-vulnerability"}, {"type": "course-of-action", "object_ref": "course-of-action--Defend-Against-Link-Endpoint", "relationship_type": "mitigates-vulnerability"}, {"type": "note", "object_ref": "note--AD-LDAP-Group-Linking-Defense", "relationship_type": "provides-defense"}]}}, "technical_analysis": {"Introduction": "This vulnerability allows attackers to link AD/LDAP groups to teams, granting unauthorized access to sensitive information.", "Impact and Scope": "The vulnerability has a CVSS score of 4.3, with an attack vector of NETWORK and low attack complexity.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to techniques TA0003, TA0002, TA0005, and TA0008.", "Technical Details": "The vulnerability occurs due to the lack of proper authorization checks in the /api/v4/groups/<group-id>/channels/<channel-id>/link endpoint.", "Detection": "Detection can be done by monitoring for suspicious activity related to AD/LDAP group linking.", "Mitigation": "Mitigation involves implementing proper authorization checks in the vulnerable endpoint.", "Conclusion": "This vulnerability poses a moderate risk and requires immediate attention to prevent unauthorized access to sensitive information."}, "executive_analysis": {"Overview": "This vulnerability allows attackers to link AD/LDAP groups to teams, granting unauthorized access to sensitive information.", "Business Impact": "The vulnerability has a moderate impact on business operations, as it allows attackers to access sensitive information.", "Technical Impact": "The vulnerability has a significant technical impact, as it allows attackers to bypass authorization checks.", "Mitigation Strategies": "Implementing proper authorization checks in the vulnerable endpoint is the recommended mitigation strategy.", "Recommendations": "Executives should prioritize this vulnerability and allocate resources for mitigation and remediation.", "Conclusions": "This vulnerability poses a significant risk and requires immediate attention to prevent unauthorized access to sensitive information."}}