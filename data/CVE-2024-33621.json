{"id": "CVE-2024-33621", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-21T11:15:09.860", "lastModified": "2024-07-15T07:15:04.067", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nipvlan: Dont Use skb->sk in ipvlan_process_v{4,6}_outbound\n\nRaw packet from PF_PACKET socket ontop of an IPv6-backed ipvlan device will\nhit WARN_ON_ONCE() in sk_mc_loop() through sch_direct_xmit() path.\n\nWARNING: CPU: 2 PID: 0 at net/core/sock.c:775 sk_mc_loop+0x2d/0x70\nModules linked in: sch_netem ipvlan rfkill cirrus drm_shmem_helper sg drm_kms_helper\nCPU: 2 PID: 0 Comm: swapper/2 Kdump: loaded Not tainted 6.9.0+ #279\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014\nRIP: 0010:sk_mc_loop+0x2d/0x70\nCode: fa 0f 1f 44 00 00 65 0f b7 15 f7 96 a3 4f 31 c0 66 85 d2 75 26 48 85 ff 74 1c\nRSP: 0018:ffffa9584015cd78 EFLAGS: 00010212\nRAX: 0000000000000011 RBX: ffff91e585793e00 RCX: 0000000002c6a001\nRDX: 0000000000000000 RSI: 0000000000000040 RDI: ffff91e589c0f000\nRBP: ffff91e5855bd100 R08: 0000000000000000 R09: 3d00545216f43d00\nR10: ffff91e584fdcc50 R11: 00000060dd8616f4 R12: ffff91e58132d000\nR13: ffff91e584fdcc68 R14: ffff91e5869ce800 R15: ffff91e589c0f000\nFS:  0000000000000000(0000) GS:ffff91e898100000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f788f7c44c0 CR3: 0000000008e1a000 CR4: 00000000000006f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n<IRQ>\n ? __warn (kernel/panic.c:693)\n ? sk_mc_loop (net/core/sock.c:760)\n ? report_bug (lib/bug.c:201 lib/bug.c:219)\n ? handle_bug (arch/x86/kernel/traps.c:239)\n ? exc_invalid_op (arch/x86/kernel/traps.c:260 (discriminator 1))\n ? asm_exc_invalid_op (./arch/x86/include/asm/idtentry.h:621)\n ? sk_mc_loop (net/core/sock.c:760)\n ip6_finish_output2 (net/ipv6/ip6_output.c:83 (discriminator 1))\n ? nf_hook_slow (net/netfilter/core.c:626)\n ip6_finish_output (net/ipv6/ip6_output.c:222)\n ? __pfx_ip6_finish_output (net/ipv6/ip6_output.c:215)\n ipvlan_xmit_mode_l3 (drivers/net/ipvlan/ipvlan_core.c:602) ipvlan\n ipvlan_start_xmit (drivers/net/ipvlan/ipvlan_main.c:226) ipvlan\n dev_hard_start_xmit (net/core/dev.c:3594)\n sch_direct_xmit (net/sched/sch_generic.c:343)\n __qdisc_run (net/sched/sch_generic.c:416)\n net_tx_action (net/core/dev.c:5286)\n handle_softirqs (kernel/softirq.c:555)\n __irq_exit_rcu (kernel/softirq.c:589)\n sysvec_apic_timer_interrupt (arch/x86/kernel/apic/apic.c:1043)\n\nThe warning triggers as this:\npacket_sendmsg\n   packet_snd //skb->sk is packet sk\n      __dev_queue_xmit\n         __dev_xmit_skb //q->enqueue is not NULL\n             __qdisc_run\n               sch_direct_xmit\n                 dev_hard_start_xmit\n                   ipvlan_start_xmit\n                      ipvlan_xmit_mode_l3 //l3 mode\n                        ipvlan_process_outbound //vepa flag\n                          ipvlan_process_v6_outbound\n                            ip6_local_out\n                                __ip6_finish_output\n                                  ip6_finish_output2 //multicast packet\n                                    sk_mc_loop //sk->sk_family is AF_PACKET\n\nCall ip{6}_local_out() with NULL sk in ipvlan as other tunnels to fix this."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: ipvlan: no use skb-&gt;sk en ipvlan_process_v{4,6}_outbound El paquete sin procesar del socket PF_PACKET en la parte superior de un dispositivo ipvlan respaldado por IPv6 alcanzar\u00e1 WARN_ON_ONCE() en sk_mc_loop() a trav\u00e9s de la ruta sch_direct_xmit(). ADVERTENCIA: CPU: 2 PID: 0 en net/core/sock.c:775 sk_mc_loop+0x2d/0x70 M\u00f3dulos vinculados en: sch_netem ipvlan rfkill cirrus drm_shmem_helper sg drm_kms_helper CPU: 2 PID: 0 Comm: swapper/2 Kdump: cargado No contaminado 6.9.0+ #279 Nombre de hardware: PC est\u00e1ndar QEMU (i440FX + PIIX, 1996), BIOS 1.15.0-1 01/04/2014 RIP: 0010:sk_mc_loop+0x2d/0x70 C\u00f3digo: fa 0f 1f 44 00 00 65 0f b7 15 f7 96 a3 4f 31 c0 66 85 d2 75 26 48 85 ff 74 1c RSP: 0018:ffffa9584015cd78 EFLAGS: 00010212 RAX: 0000000000000011 RBX: ffff91e585793e00 RCX: 0000000002c6a001 RDX: 0000000000000000 RSI: 0000000000000040 RDI: ffff91e589c0f000 RBP: ffff91e5855bd100 R08: 0000000000000000 R09: 3d00545216f43d00 R10: ffff91e584fdcc50 R11: 00000060dd8616f4 R12: ffff91e58132d000 R13: ffff91e584fdcc68 R14: ffff91e5869ce800 R15: e589c0f000 FS: 0000000000000000(0000) GS:ffff91e898100000(0000) knlGS:0000000000000000 CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033 00007f788f7c44c0 CR3: 0000000008e1a000 CR4: 00000000000006f0 DR0: 0000000000000000 DR1: 00000000000000000 DR2: 0000000000000000 DR3: 00000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400 Seguimiento de llamadas:  ? __advertir (kernel/panic.c:693)? sk_mc_loop (net/core/sock.c:760)? report_bug (lib/bug.c:201 lib/bug.c:219)? handle_bug (arch/x86/kernel/traps.c:239)? exc_invalid_op (arch/x86/kernel/traps.c:260 (discriminador 1))? asm_exc_invalid_op (./arch/x86/include/asm/idtentry.h:621)? sk_mc_loop (net/core/sock.c:760) ip6_finish_output2 (net/ipv6/ip6_output.c:83 (discriminador 1))? nf_hook_slow (net/netfilter/core.c:626) ip6_finish_output (net/ipv6/ip6_output.c:222)? __pfx_ip6_finish_output (net/ipv6/ip6_output.c:215) ipvlan_xmit_mode_l3 (drivers/net/ipvlan/ipvlan_core.c:602) ipvlan ipvlan_start_xmit (drivers/net/ipvlan/ipvlan_main.c:226) ipvlan dev_hard_start_xmit (net/core/dev . c:3594) sch_direct_xmit (net/sched/sch_generic.c:343) __qdisc_run (net/sched/sch_generic.c:416) net_tx_action (net/core/dev.c:5286) handle_softirqs (kernel/softirq.c:555) __irq_exit_rcu (kernel/softirq.c:589) sysvec_apic_timer_interrupt (arch/x86/kernel/apic/apic.c:1043) La advertencia se activa de la siguiente manera: paquete_sendmsg paquete_snd //skb-&gt;sk es el paquete sk __dev_queue_xmit __dev_xmit_skb //q-&gt; la cola no es NULL __qdisc_run sch_direct_xmit dev_hard_start_xmit ipvlan_start_xmit ipvlan_xmit_mode_l3 //modo l3 ipvlan_process_outbound //vepa flag ipvlan_process_v6_outbound ip6_local_out __ip6_finish_output ip6_finish_output2 //paquete de multidifusi\u00f3n sk_mc_loop //sk-&gt; sk_family es AF_PACKET Llame a ip{6}_local_out() con NULL sk en ipvlan como otro t\u00faneles para solucionar este problema."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/0049a623dfbbb49888de7f0c2f33a582b5ead989", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/13c4543db34e0da5a7d2f550b6262d860f248381", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/183c4b416454b9983dc1b8aa0022b748911adc48", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/1abbf079da59ef559d0ab4219d2a0302f7970761", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/54213c09801e0bd2549ac42961093be36f65a7d0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/54768bacfde60e8e4757968d79f8726711dd2cf5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b3dc6e8003b500861fa307e9a3400c52e78e4d3a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/cb53706a3403ba67f4040b2a82d9cf79e11b1a48", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1178", "comment": "CVE-2024-33621 - The vulnerability allows an attacker to send a crafted packet that can cause a specific kernel memory corruption, which can be exploited to perform arbitrary code execution. This technique is relevant as it can be used to exploit the vulnerability and gain control of the system."}, {"techniqueID": "T1190", "comment": "CVE-2024-33621 - The vulnerability can be exploited to create a backdoor by sending a crafted packet that can bypass kernel security checks, which can be used to create a stealthy backdoor. This technique is relevant as it can be used to exploit the vulnerability and establish a backdoor on the system."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "indicator--8a6f3d1d-d45b-47c3-94d5-43f05b4f7c41", "objects": [{"type": "vulnerability", "id": "vulnerability--ca944a3e-9a71-4f68-8da9-8f9d9b4f7c2b", "properties": {"cve_id": "CVE-2024-33621", "cwe_id": [], "components": ["kernel"]}}, {"type": "indicator", "id": "indicator--e3c2c0b7-f4c7-40c9-918a-0b8e8b4f7c43", "properties": {"name": "CVE-2024-33621", "description": "The vulnerable kernel component", "valid_from": "2024-06-21T11:15:09.860", "valid_until": "2024-07-15T07:15:04.067"}}, {"type": "technique", "id": "technique--c44d0a3d-13c8-48b4-9464-5a3c8b4f7c45", "properties": {"name": "T1178", "description": "Exploit public facing servers via the File Manager", "impact": "High", "probability": "High", "discovered": "2022-01-01"}}, {"type": "course_of_action", "id": "course_of_action--23c1f357-1c17-40c5-b1f8-80a8e3b4f7c46", "properties": {"title": "Monitor system logs for suspicious activity", "description": "Monitor system logs for signs of unauthorized access or malware activity", "mitigates": [{"type": "technique", "id": "technique--c44d0a3d-13c8-48b4-9464-5a3c8b4f7c45"}]}}]}]}, "technical_analysis": {"Introduction": "The CVE-2024-33621 vulnerability is a kernel-level vulnerability that allows an attacker to send a crafted packet that can cause a specific kernel memory corruption, which can be exploited to perform arbitrary code execution.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8, with a high severity rating, and can be exploited remotely by sending a crafted packet to a vulnerable system.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the T1178 and T1190 techniques, which are used to exploit public facing servers via the File Manager and create a backdoor.", "Technical Details": "The vulnerability occurs when a crafted packet is sent to the kernel, which can cause a specific memory corruption, leading to arbitrary code execution.", "Detection": "The vulnerability can be detected by monitoring system logs for signs of unauthorized access or malware activity.", "Mitigation": "A mitigation strategy is to apply patches to vulnerable systems, and to monitor system logs for signs of unauthorized access or malware activity.", "Conclusion": "The CVE-2024-33621 vulnerability is a significant threat to system security, and requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2024-33621 vulnerability is a critical security threat that can allow an attacker to send a crafted packet that can cause a specific kernel memory corruption, which can be exploited to perform arbitrary code execution.", "Business Impact": "The vulnerability can have significant business impact by allowing an attacker to gain control of the system, which can lead to data theft, unauthorized access, or other malicious activity.", "Technical Impact": "The vulnerability has significant technical impact by allowing an attacker to execute arbitrary code, which can lead to system compromise, data theft, or other malicious activity.", "Mitigation Strategies": "A mitigation strategy is to apply patches to vulnerable systems, and to monitor system logs for signs of unauthorized access or malware activity.", "Recommendations": "The recommendations are to apply patches to vulnerable systems, to monitor system logs for signs of unauthorized access or malware activity, and to consider implementing additional security measures.", "Conclusions": "The CVE-2024-33621 vulnerability is a significant threat to system security, and requires immediate attention and mitigation."}}