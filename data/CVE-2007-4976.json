{"id": "CVE-2007-4976", "sourceIdentifier": "cve@mitre.org", "published": "2007-09-19T18:17:00.000", "lastModified": "2018-10-15T21:39:11.893", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Directory traversal vulnerability in viewlog.php in Coppermine Photo Gallery (CPG) 1.4.12 and earlier allows remote authenticated administrators to include and execute arbitrary local files via a .. (dot dot) in the log parameter."}, {"lang": "es", "value": "Vulnerabilidad de salto de directorio en viewlog.php de Coppermine Photo Gallery (CPG) 1.4.12 y anteriores permite a administradores remotos autenticados incluir y ejecutar ficheros locales mediante secuencias .. (punto punto) en el par\u00e1metro log."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": true, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4:*:*:*:*:*:*:*", "matchCriteriaId": "183F2FD0-A6D4-4F86-98D7-FC7D22443654"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "EAA317DD-C804-4349-9BDC-B23FAE493516"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4.4:*:*:*:*:*:*:*", "matchCriteriaId": "4D3BB681-16F8-441F-912C-9488791A6420"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4.9:*:*:*:*:*:*:*", "matchCriteriaId": "D7A89B92-8323-4240-80CE-102070202A09"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4.10:*:*:*:*:*:*:*", "matchCriteriaId": "F1BCC40D-EF9C-4843-9183-EA725C9C03FA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4.11:*:*:*:*:*:*:*", "matchCriteriaId": "F0D02234-2729-499B-A686-F1F85401FEDF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4.12:*:*:*:*:*:*:*", "matchCriteriaId": "E21C42CB-86B1-4EC1-A508-809316F83CC0"}]}]}], "references": [{"url": "http://coppermine-gallery.net/forum/index.php?topic=46847.0", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://osvdb.org/37101", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/26843", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://securityreason.com/securityalert/3152", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/479757/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/25698", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://www.securitytracker.com/id?1018704", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/3194", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/36660", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2007-4976 - Directory traversal vulnerability in Coppermine Photo Gallery allows an authenticated administrator to include and execute arbitrary local files. This MITRE ATT&CK technique is relevant as it allows the attacker to execute code remotely."}, {"techniqueID": "T1027", "comment": "CVE-2007-4976 - The vulnerability allows an attacker to include and execute arbitrary local files, giving them a foothold in the system. This MITRE ATT&CK technique is relevant as it allows the attacker to move laterally within the network."}, {"techniqueID": "T1078", "comment": "CVE-2007-4976 - The vulnerability allows an attacker to execute arbitrary local files, giving them command and control of the system. This MITRE ATT&CK technique is relevant as it allows the attacker to execute code remotely and maintain persistence."}, {"techniqueID": "T1499", "comment": "CVE-2007-4976 - The vulnerability allows an attacker to execute arbitrary local files, giving them a possible channel for data exfiltration. This MITRE ATT&CK technique is relevant as it allows the attacker to extract sensitive data from the system."}], "stix_bundle": {"type": "bundle", "label": "CVE-2007-4976 Bundle", "description": "A bundle expressing all the related techniques, risks and defense strategies for this CVE.", "objects": [{"type": "indicator", "label": "Directory Traversal Vulnerability", "description": "A directory traversal vulnerability in Coppermine Photo Gallery allows an authenticated administrator to include and execute arbitrary local files."}, {"type": "attack-pattern", "label": "Executing Arbitrary Local Files", "description": "Executing arbitrary local files on the system, giving the attacker code execution and command and control."}, {"type": "course-of-action", "label": "Patch Coppermine Photo Gallery", "description": "Patch Coppermine Photo Gallery to the latest version to mitigate this vulnerability.", "object_refs": ["#attack-pattern-1"]}, {"type": "note", "label": "Defense-in-Depth", "description": "Implement defense-in-depth strategies to prevent attackers from exploiting this vulnerability, such as using a web application firewall or restricting access to sensitive areas of the server."}], "relationships": [{"type": "indicated-by", "id": "indicator-1", "object_refs": ["#indicator-1"]}, {"type": "uses", "id": "course-of-action-1", "object_refs": ["#attack-pattern-1"]}, {"type": "includes", "id": "note-1", "object_refs": ["#course-of-action-1"]}]}, "technical_analysis": {"Introduction": "Directory traversal vulnerability in Coppermine Photo Gallery allows an authenticated administrator to include and execute arbitrary local files.", "Impact and Scope": "CVSS score 6.5, attack vector NETWORK, confidentiality impact PARTIAL, integrity impact PARTIAL, availability impact PARTIAL.", "Related MITRE ATT&CK Techniques": "T1059, T1027, T1078, T1499", "Technical Details": "The vulnerability is due to the use of user-provided data in the construction of file paths without proper sanitization and validation.", "Detection": "Detect directory traversal attempts by monitoring file system access and network communication.", "Mitigation": "Patch Coppermine Photo Gallery, implement web application firewall, restrict access to sensitive areas of the server.", "Conclusion": "The vulnerability in Coppermine Photo Gallery allows an authenticated administrator to include and execute arbitrary local files, giving them command and control of the system."}, "executive_analysis": {"Overview": "Coppermine Photo Gallery has a directory traversal vulnerability that allows an authenticated administrator to include and execute arbitrary local files, giving them command and control of the system.", "Business Impact": "This vulnerability can lead to data theft, system compromise, and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary local files, giving them code execution and command and control.", "Mitigation Strategies": "Patch Coppermine Photo Gallery, implement web application firewall, restrict access to sensitive areas of the server.", "Recommendations": "Patched version of Coppermine Photo Gallery should be installed, and regular security scans and vulnerability assessments should be conducted.", "Conclusions": "This vulnerability highlights the importance of patching and regular security assessments to prevent future vulnerabilities."}}