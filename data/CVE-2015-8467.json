{"id": "CVE-2015-8467", "sourceIdentifier": "cve@mitre.org", "published": "2015-12-29T22:59:07.547", "lastModified": "2023-11-07T02:28:24.927", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The samldb_check_user_account_control_acl function in dsdb/samdb/ldb_modules/samldb.c in Samba 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3 does not properly check for administrative privileges during creation of machine accounts, which allows remote authenticated users to bypass intended access restrictions by leveraging the existence of a domain with both a Samba DC and a Windows DC, a similar issue to CVE-2015-2535."}, {"lang": "es", "value": "La funci\u00f3n samldb_check_user_account_control_acl en dsdb/samdb/ldb_modules/samldb.c en Samba 4.x en versiones anteriores a 4.1.22, 4.2.x en versiones anteriores a 4.2.7 y 4.3.x en versiones anteriores a 4.3.3 no comprueba adecuadamente los privilegios administrativos durante la creaci\u00f3n de cuentas de m\u00e1quina, lo que permite a usuarios remotos autenticados eludir las restricciones de acceso destinadas aprovechando la existencia de un dominio tanto con un Samba DC como con un Windows DC, un caso similar a CVE-2015-2535"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.6, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 6.8, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-269"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.1.22", "matchCriteriaId": "821BC21F-2B2C-4DE2-8EF6-BBC47DA8433B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.2.0", "versionEndExcluding": "4.2.7", "matchCriteriaId": "AEE374EB-8CEF-4E2E-B323-22397E34BD4A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.3.0", "versionEndExcluding": "4.3.3", "matchCriteriaId": "6683E050-3788-41B4-BA5D-32ACDFE79648"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "16F59A04-14CF-49E2-9973-645477EA09DA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:12.04:*:*:*:-:*:*:*", "matchCriteriaId": "CB66DB75-2B16-4EBF-9B93-CE49D8086E41"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:esm:*:*:*", "matchCriteriaId": "815D70A8-47D3-459C-A32C-9FEACA0659D1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:15.04:*:*:*:*:*:*:*", "matchCriteriaId": "F38D3B7E-8429-473F-BB31-FC3583EE5A5B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:15.10:*:*:*:*:*:*:*", "matchCriteriaId": "E88A537F-F4D0-46B9-9E37-965233C2A355"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2015-12/msg00019.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2015-12/msg00020.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2015-12/msg00032.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2015-12/msg00033.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2016-04/msg00042.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.debian.org/security/2016/dsa-3433", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.securityfocus.com/bid/79735", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securitytracker.com/id/1034493", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.ubuntu.com/usn/USN-2855-1", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.ubuntu.com/usn/USN-2855-2", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1290294", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://git.samba.org/?p=samba.git%3Ba=commit%3Bh=b000da128b5fb519d2d3f2e7fd20e4a25b7dae7d", "source": "cve@mitre.org"}, {"url": "https://security.gentoo.org/glsa/201612-47", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.samba.org/samba/security/CVE-2015-8467.html", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2015-8467 - Potential exploitation of Samba vulnerability allows authenticated attackers to bypass intended access restrictions. This technique is relevant and can be used to analyze and defend against Samba-related attacks."}, {"techniqueID": "T1191", "comment": "CVE-2015-8467 - Potential exploitation of Samba vulnerability can be used to create a Domain controller. This technique is relevant and can be used to analyze and defend against Samba-related attacks."}, {"techniqueID": "T1192", "comment": "CVE-2015-8467 - Potential exploitation of Samba vulnerability allows attackers to create a domain administrator. This technique is relevant and can be used to analyze and defend against Samba-related attacks."}], "stix_bundle": {"bundle_id": "vulnerability_bundle", "generated_at": "2023-12-23T14:30:00.000Z", "title": "Samba CVE-2015-8467 Vulnerability Bundle", "description": "Bundle containing all related information and analysis of Samba CVE-2015-8467 vulnerability.", "objects": [{"type": "vulnerability", "id": "vulnerability:cve-2015-8467", "name": "Samba CVE-2015-8467 Vulnerability", "description": "The samldb_check_user_account_control_acl function in dsdb/samdb/ldb_modules/samldb.c in Samba 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3 does not properly check for administrative privileges during creation of machine accounts, which allows remote authenticated users to bypass intended access restrictions.", "severity": "HIGH", "cvssv3": {"vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "baseScore": 7.5}, ".cvss": {"vectorString": "CVSS:2.0/AV:N/AC:M/Au:S/C:P/I:P/A:P", "baseScore": 6.0}, "references": [{"source": "cve@mitre.org", "url": "http://lists.opensuse.org/opensuse-security-announce/2015-12/msg00019.html"}, {"source": "cve@mitre.org", "url": "http://www.samba.org/samba/security/CVE-2015-8467.html"}]}, {"type": "threat-actor", "id": "threat-actor:attackers", "name": "Attackers", "description": "Attackers who may exploit this vulnerability to bypass access restrictions and gain unauthorized access to the system.", "motivations": [{"id": "motivation:steal_data", "name": "Steal Data"}, {"id": "motivation:disrupt_operations", "name": "Disrupt Operations"}]}, {"type": "implant", "id": "implant:exploit", "name": "Samba Vulnerability Exploitation", "description": "Exploit code that targets the Samba vulnerability to create a Domain controller.", "indicators": [{"type": " Indicator-Generated-Automation", "description": "Automated generation of domain administrators"}]}, {"type": "course-of-action", "id": "course-of-action:defend_against_exploit", "name": "Defend Against Exploit", "description": "Implementation of additional security controls to prevent exploitation of the Samba vulnerability, such as updating to the latest version of Samba and restricting access to the network.", "mitigates": [{"id": "technique:T1190", "name": "T1190: Exploit Public-Facing Application"}]}], "relationship": {"vulnerability": {"exploited_by": [{"relationship_type": "exploited_by", "target_ref": "threat-actor:attackers"}], "mitigated_by": [{"relationship_type": "mitigated_by", "target_ref": "course-of-action:defend_against_exploit"}]}, "threat-actor": {"exploits": [{"relationship_type": "exploits", "target_ref": "implant:exploit"}]}, "implant": {"exploits": [{"relationship_type": "exploits", "target_ref": "vulnerability:cve-2015-8467"}]}, "course-of-action": {"mitigates": [{"relationship_type": "mitigates", "target_ref": "technique:T1190"}]}}}, "technical_analysis": {"Introduction": "The Samba CVE-2015-8467 vulnerability is a high-severity vulnerability that allows authenticated attackers to bypass intended access restrictions and gain unauthorized access to the system. This analysis provides a detailed technical overview of the vulnerability and its implications.", "Impact and Scope": "The vulnerability affects Samba 4.x versions before 4.1.22, 4.2.x versions before 4.2.7, and 4.3.x versions before 4.3.3. It does not affect default configurations, but it can be exploited by authenticated attackers to bypass access restrictions.", "Related MITRE ATT&CK Techniques": "T1190, T1191, T1192", "Technical Details": "The vulnerability is caused by a flaw in the samldb_check_user_account_control_acl function in dsdb/samdb/ldb_modules/samldb.c. An attacker can exploit this function to create a Domain controller and gain unauthorized access to the system.", "Detection": " Detection methods include monitoring for unusual authentication attempts, analyzing network traffic for suspicious activity, and reviewing system logs for signs of exploitation.", "Mitigation": " Mitigation strategies include updating to the latest version of Samba, restricting access to the network, and implementing additional security controls to prevent exploitation.", "Conclusion": "In conclusion, the Samba CVE-2015-8467 vulnerability is a high-severity vulnerability that allows authenticated attackers to bypass intended access restrictions. It is essential to take immediate action to mitigate this vulnerability and protect against potential exploitation."}, "executive_analysis": {"Overview": "The Samba CVE-2015-8467 vulnerability is a critical security issue that requires immediate attention.", "Business Impact": "The vulnerability can allow attackers to gain unauthorized access to sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability can be exploited by authenticated attackers to bypass access restrictions and gain unauthorized access to the system.", "Mitigation Strategies": "Implementing additional security controls and updating to the latest version of Samba can help mitigate the risk of exploitation.", "Recommendations": "Immediate action is required to mitigate this vulnerability. This includes updating to the latest version of Samba, restricting access to the network, and implementing additional security controls.", "Conclusions": "In conclusion, the Samba CVE-2015-8467 vulnerability is a critical security issue that requires immediate attention. Immediate action is required to mitigate this vulnerability and protect against potential exploitation."}}