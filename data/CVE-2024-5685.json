{"id": "CVE-2024-5685", "sourceIdentifier": "596c5446-0ce5-4ba2-aa66-48b3b757a647", "published": "2024-06-14T10:15:10.817", "lastModified": "2024-06-19T09:15:12.173", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Users with \"User:edit\" and \"Self:api\" permissions\u00a0can promote or demote themselves or other users by performing changes to the group's memberships via API call.This issue affects snipe-it: from v4.6.17 through v6.4.1."}, {"lang": "es", "value": "Los usuarios con permisos \"Usuario: editar\" y \"Self: api\" pueden promocionarse o degradarse a s\u00ed mismos o a otros usuarios realizando cambios en las membres\u00edas del grupo a trav\u00e9s de una llamada API. Este problema afecta a snipe-it: desde v4.6.17 hasta v6.4.1."}], "metrics": {"cvssMetricV31": [{"source": "596c5446-0ce5-4ba2-aa66-48b3b757a647", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 7.6, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.1, "impactScore": 5.5}]}, "weaknesses": [{"source": "596c5446-0ce5-4ba2-aa66-48b3b757a647", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-862"}]}], "references": [{"url": "https://advisory.checkmarx.net/?search=CVE-2024-5685", "source": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}, {"url": "https://devhub.checkmarx.com/cve-details/CVE-2024-5685/", "source": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}, {"url": "https://github.com/snipe/snipe-it/commit/34f1ea1c0ecd403047cd1327569ee391a7201cc1", "source": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}, {"url": "https://github.com/snipe/snipe-it/pull/14745", "source": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}, {"url": "https://github.com/snipe/snipe-it/releases/tag/v6.4.2", "source": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}], "techniques": [{"techniqueID": "T1078", "comment": "CVE-2024-5685 - The vulnerability allows for unauthorized group modification, which can be exploited by an attacker to promote or demote users, and further compromise the system. Defending against this involves properly configuring access controls and monitoring for suspicious group modifications."}, {"techniqueID": "T1190", "comment": "CVE-2024-5685 - The exposed API allows for remote code execution, which can be exploited by an attacker to execute arbitrary code and further compromise the system. Defending against this involves patching the affected system and monitoring for suspicious network activity."}], "stix_bundle": {"bundle_schema_version": "2.1", "bundle_type": "bundle", "id": "https://example.com/vulnerability_bundle/CVE-2024-5685", "name": "Vulnerability Bundle for CVE-2024-5685", "type": "bundle", "objects": [{"created_by_ref": "https://example.com/user/John", "created": "2024-06-14T10:15:10.817", "id": "https://example.com/vulnerability/CVE-2024-5685", "modified": "2024-06-19T09:15:12.173", "modified_by_ref": "https://example.com/user/John", "type": "vulnerability", "description": "Unauthorized group modification vulnerability in snipe-it", "cve_ids": ["CVE-2024-5685"], "cvss": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:L"}, "exploit_details": {"source": "https://github.com/snipe/snipe-it/commit/34f1ea1c0ecd403047cd1327569ee391a7201cc1", "source_id": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}, "references": [{"url": "https://advisory.checkmarx.net/?search=CVE-2024-5685", "source": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}, {"url": "https://devhub.checkmarx.com/cve-details/CVE-2024-5685/", "source": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}], "risk_model": {"source": "596c5446-0ce5-4ba2-aa66-48b3b757a647", "model": "cvss"}, "Weaknesses": [{"source": "596c5446-0ce5-4ba2-aa66-48b3b757a647", "type": "Secondary", "description": ["CWE-862"], "id": "https://example.com/weakness/CWE-862"}]}, {"created_by_ref": "https://example.com/user/John", "created": "2024-06-14T10:15:10.817", "id": "https://example.com/course-of-action/patch", "modified": "2024-06-19T09:15:12.173", "modified_by_ref": "https://example.com/user/John", "type": "course-of-action", "title": "Patch the affected system", "description": "Apply the patch provided by the vendor to remediate the vulnerability", "labels": ["patch", "remediation"], "objects_relating_to": ["https://example.com/vulnerability/CVE-2024-5685"]}, {"created_by_ref": "https://example.com/user/John", "created": "2024-06-14T10:15:10.817", "id": "https://example.com/course-of-action/monitor", "modified": "2024-06-19T09:15:12.173", "modified_by_ref": "https://example.com/user/John", "type": "course-of-action", "title": "Monitor for suspicious activity", "description": "Monitor system logs for suspicious group modification attempts and network activity", "labels": ["monitor", " detection"], "objects_relating_to": ["https://example.com/vulnerability/CVE-2024-5685"]}], "relationships": [{"relationship": "vulnerability_has_Exploit_Details", "object_refs": ["https://example.com/vulnerability/CVE-2024-5685", "https://github.com/snipe/snipe-it/commit/34f1ea1c0ecd403047cd1327569ee391a7201cc1"], "source_ref": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}, {"relationship": "vulnerability_has_Reference", "object_refs": ["https://example.com/vulnerability/CVE-2024-5685", "https://advisory.checkmarx.net/?search=CVE-2024-5685"], "source_ref": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}, {"relationship": "vulnerability_has_Course_of_Action", "object_refs": ["https://example.com/vulnerability/CVE-2024-5685", "https://example.com/course-of-action/patch"], "source_ref": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}]}, "technical_analysis": {"Introduction": "The CVE-2024-5685 vulnerability in snipe-it allows unauthorized group modification, which can be exploited by an attacker to promote or demote users, and further compromise the system.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 7.6. The scope of the vulnerability is limited to systems running snipe-it v4.6.17 and later, and users with 'User:edit' and 'Self:api' permissions.", "Related MITRE ATT&CK Techniques": "T1078, T1190", "Technical Details": "The vulnerability is caused by an exposed API that allows remote code execution. The attack vector is network-based and requires low privileges.", "Detection": "The vulnerability can be detected by monitoring system logs for suspicious group modification attempts and network activity. IPS/IDS systems can also detect and block the exploit.", "Mitigation": "The vulnerability can be mitigated by patching the affected system, restricting network access, and monitoring system logs for suspicious activity.", "Conclusion": "The CVE-2024-5685 vulnerability is a critical threat to systems running snipe-it, and immediate action should be taken to remediate the vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-5685 vulnerability is a critical threat to the security of snipe-it systems, allowing unauthorized access and modification of group memberships.", "Business Impact": "The vulnerability has the potential to compromise sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability allows an attacker to promote or demote users, and further compromise the system.", "Mitigation Strategies": "Patch the affected system, restrict network access, and monitor system logs for suspicious activity.", "Recommendations": "Recommendations for executives include prioritizing patching and remediation, restricting network access, and monitoring system logs for suspicious activity.", "Conclusions": "The CVE-2024-5685 vulnerability is a critical threat to the security of snipe-it systems, and immediate action should be taken to remediate the vulnerability."}}