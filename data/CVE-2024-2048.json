{"id": "CVE-2024-2048", "sourceIdentifier": "security@hashicorp.com", "published": "2024-03-04T20:15:50.690", "lastModified": "2024-06-10T17:16:25.067", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Vault and Vault Enterprise (\u201cVault\u201d) TLS certificate auth method did not correctly validate client certificates when configured with a non-CA certificate as trusted certificate. In this configuration, an attacker may be able to craft a malicious certificate that could be used to bypass authentication. Fixed in Vault 1.15.5 and 1.14.10."}, {"lang": "es", "value": "El m\u00e9todo de autenticaci\u00f3n de certificados TLS de Vault y Vault Enterprise (\u201cVault\u201d) no validaba correctamente los certificados de cliente cuando se configuraba con un certificado que no era CA como certificado confiable. En esta configuraci\u00f3n, un atacante puede crear un certificado malicioso que podr\u00eda usarse para eludir la autenticaci\u00f3n. Corregido en Vault 1.15.5 y 1.14.10."}], "metrics": {"cvssMetricV31": [{"source": "security@hashicorp.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@hashicorp.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-295"}]}], "references": [{"url": "https://discuss.hashicorp.com/t/hcsec-2024-05-vault-cert-auth-method-did-not-correctly-validate-non-ca-certificates/63382", "source": "security@hashicorp.com"}, {"url": "https://security.netapp.com/advisory/ntap-20240524-0009/", "source": "security@hashicorp.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-2048 - An attacker may be able to craft a malicious certificate that could be used to bypass authentication. Attackers can use certificate spoofing to make it appear that the malicious certificate is a trusted entity. This can be mitigated by validating client certificates correctly and not allowing non-CA certificates to be trusted."}, {"techniqueID": "T1566.1", "comment": "CVE-2024-2048 - Attackers may use Certificate Spoofing to bypass authentication. This can be achieved by crafting a malicious certificate that is signed by a trusted CA and using it to authenticate to Vault. This can be mitigated by implementing proper certificate validation and revocation checks."}, {"techniqueID": "T1190", "comment": "CVE-2024-2048 - Attackers may use Certificates for Authentication and Authorization without validating the certificate correctly. This can be mitigated by implementing proper certificate validation and revocation checks to ensure only trusted certificates are used for authentication."}], "stix_bundle": {"@type": "stix_bundle", "label": "CVE-2024-2048 STIX 2.1 Bundle", "description": "A STIX 2.1 bundle expressing all the related techniques, risks and defense strategies for this CVE.", "objects": [{"@type": "stix_malware", "name": "CVE-2024-2048", "description": "A vulnerability in Vault's TLS certificate authentication method allows attackers to craft malicious certificates bypass authentication.", "extension": {"reporting_authorities": [{"@type": "stix_reporter", "name": "security@hashicorp.com"}]}}, {"@type": "stix_tactic", "name": "Certificate Spoofing", "description": "The act of creating a fake certificate that appears to be valid.", "extension": {"related_threats": [{"@type": "stix_related_threat", "name": "Lateral Movement"}]}}, {"@type": "stix_observable", "name": "Malicious Certificate", "description": "A certificate signed by a trusted CA that is used to bypass authentication.", "extension": {"related_defenses": [{"@type": "stix_related-defense", "name": "Certificate Validation"}]}}], "relationship": {"reporter": {"object_ref": "stix_malware/CVE-2024-2048"}, "related": {"tactic": {"relationship_type": "uses", "object_ref": "stix_tactic/Certificate Spoofing"}, "observable": {"relationship_type": "creates", "object_ref": "stix_observable/Malicious Certificate"}, "defense": {"relationship_type": "mitigates", "object_ref": "stix_related-defense/Certificate Validation"}}}}, "technical_analysis": {"Introduction": "CVE-2024-2048 is a vulnerability in Vault's TLS certificate authentication method that allows attackers to craft malicious certificates to bypass authentication.", "Impact and Scope": "The vulnerability has a CVSS score of 8.1 (HIGH) and an attack vector of NETWORK. It allows attackers to craft malicious certificates that can be used to bypass authentication.", "Related MITRE ATT&CK Techniques": "T1210, T1566.1, T1190", "Technical Details": "The vulnerability occurs because Vault does not correctly validate client certificates when configured with a non-CA certificate as trusted certificate.", "Detection": "Detecting this vulnerability requires monitoring for suspicious certificate authentication requests and verifying the authenticity of certificates.", "Mitigation": "Mitigating this vulnerability requires implementing proper certificate validation and revocation checks to ensure only trusted certificates are used for authentication.", "Conclusion": "CVE-2024-2048 is a significant vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-2048 is a vulnerability in Vault's TLS certificate authentication method that allows attackers to craft malicious certificates to bypass authentication.", "Business Impact": "This vulnerability can have significant business impacts, including data breaches and loss of sensitive information.", "Technical Impact": "The vulnerability can be exploited to gain unauthorized access to Vault and sensitive data.", "Mitigation Strategies": "Implementing proper certificate validation and revocation checks is crucial to mitigating this vulnerability.", "Recommendations": "We recommend implementing immediate mitigation strategies and monitoring for suspicious certificate authentication requests.", "Conclusions": "CVE-2024-2048 is a significant vulnerability that requires immediate attention and mitigation."}}