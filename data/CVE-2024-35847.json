{"id": "CVE-2024-35847", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-17T15:15:21.620", "lastModified": "2024-06-27T12:15:25.567", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nirqchip/gic-v3-its: Prevent double free on error\n\nThe error handling path in its_vpe_irq_domain_alloc() causes a double free\nwhen its_vpe_init() fails after successfully allocating at least one\ninterrupt. This happens because its_vpe_irq_domain_free() frees the\ninterrupts along with the area bitmap and the vprop_page and\nits_vpe_irq_domain_alloc() subsequently frees the area bitmap and the\nvprop_page again.\n\nFix this by unconditionally invoking its_vpe_irq_domain_free() which\nhandles all cases correctly and by removing the bitmap/vprop_page freeing\nfrom its_vpe_irq_domain_alloc().\n\n[ tglx: Massaged change log ]"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: irqchip/gic-v3-its: Evitar el double free en caso de error. La ruta de manejo de errores en its_vpe_irq_domain_alloc() provoca un double free cuando its_vpe_init() falla despu\u00e9s de asignar exitosamente al menos una interrupci\u00f3n. Esto sucede porque its_vpe_irq_domain_free() libera las interrupciones junto con el mapa de bits del \u00e1rea y la vprop_page y its_vpe_irq_domain_alloc() posteriormente libera nuevamente el mapa de bits del \u00e1rea y la vprop_page. Solucione este problema invocando incondicionalmente its_vpe_irq_domain_free() que maneja todos los casos correctamente y eliminando el mapa de bits/vprop_page que se libera de its_vpe_irq_domain_alloc()."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/03170e657f62c26834172742492a8cb8077ef792", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5b012f77abde89bf0be8a0547636184fea618137", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5dbdbe1133911ca7d8466bb86885adec32ad9438", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/aa44d21574751a7d6bca892eb8e0e9ac68372e52", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b72d2b1448b682844f995e660b77f2a1fabc1662", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/c26591afd33adce296c022e3480dea4282b7ef91", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/dd681710ab77c8beafe2e263064cb1bd0e2d6ca9", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f5417ff561b8ac9a7e53c747b8627a7ab58378ae", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA0005", "comment": "CVE-2024-35847 - Unvalidated input in the Linux kernel's irqchip/gic-v3-its module can lead to a double-free vulnerability, potentially allowing attackers to crash the system or escalate privileges. Defending against this requires validating all inputs and ensuring proper error handling."}, {"techniqueID": "T1195", "comment": "The Linux kernel's handling of the GICv3 ITS (Interrupt Translation Service) can lead to a double-free vulnerability when an invalid interrupt number is provided. This can be mitigated by ensuring proper input validation and error handling."}, {"techniqueID": "T1030", "comment": "The Linux kernel's irqchip/gic-v3-its module can be exploited by attackers to crash the system or escalate privileges. Defending against this requires validating all inputs and ensuring proper error handling, as well as implementing memory protection mechanisms."}], "stix_bundle": {"type": "STIX Bundle", "id": "stix_bundle--1.0.0", "/specification_version": "2.1", "created_by_ref": "organization--1.0.0--00fa7b40-c8f8-4b85-96b6-d6b46fe5a2de", "created": "2024-07-17T12:00:00.000", "modified": "2024-07-17T12:00:00.000", "description": "STIX Bundle for CVE-2024-35847", "objects": [{"id": "vulnerability--cve-2024-35847--1.0.0", "type": "vulnerability", "created_by_ref": "organization--1.0.0--00fa7b40-c8f8-4b85-96b6-d6b46fe5a2de", "created": "2024-07-17T12:00:00.000", "modified": "2024-07-17T12:00:00.000", "name": "CVE-2024-35847", "description": "Double-free vulnerability in the Linux kernel's irqchip/gic-v3-its module", "cvss3_score": "8.1", "cvss3_vector": "AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}, {"id": "tactic--1.0.0", "type": "tactic", "created_by_ref": "organization--1.0.0--00fa7b40-c8f8-4b85-96b6-d6b46fe5a2de", "created": "2024-07-17T12:00:00.000", "modified": "2024-07-17T12:00:00.000", "name": "Impaired Functionality", "description": "Impaired Functionality"}, {"id": "technique--ta0005--1.0.0", "type": "technique", "created_by_ref": "organization--1.0.0--00fa7b40-c8f8-4b85-96b6-d6b46fe5a2de", "created": "2024-07-17T12:00:00.000", "modified": "2024-07-17T12:00:00.000", "name": "TA0005", "description": "Command and Control", "kill_chain_phases": [{"id": "kill_chain_phase--ta0005--1.0.0", "type": "kill_chain_phase", "created_by_ref": "organization--1.0.0--00fa7b40-c8f8-4b85-96b6-d6b46fe5a2de", "created": "2024-07-17T12:00:00.000", "modified": "2024-07-17T12:00:00.000", "name": "Initial Access", "description": "Initial Access"}], "related_vulnerability_refs": [{"id": "vulnerability--cve-2024-35847--1.0.0", "type": "vulnerability", "created_by_ref": "organization--1.0.0--00fa7b40-c8f8-4b85-96b6-d6b46fe5a2de", "created": "2024-07-17T12:00:00.000", "modified": "2024-07-17T12:00:00.000", "name": "CVE-2024-35847", "description": "Double-free vulnerability in the Linux kernel's irqchip/gic-v3-its module"}]}], "relationships": [{"id": "relationship--vulnerability--cve-2024-35847--1.0.0", "type": "relationship", "created_by_ref": "organization--1.0.0--00fa7b40-c8f8-4b85-96b6-d6b46fe5a2de", "created": "2024-07-17T12:00:00.000", "modified": "2024-07-17T12:00:00.000", "source": "vulnerability--cve-2024-35847--1.0.0", "target": "technique--ta0005--1.0.0"}]}, "technical_analysis": {"Introduction": "The CVE-2024-35847 vulnerability is a double-free vulnerability in the Linux kernel's irqchip/gic-v3-its module.", "Impact and Scope": "The vulnerability affects Linux kernels and can be exploited by attackers to crash the system or escalate privileges.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK Techniques include TA0005, T1195, and T1030.", "Technical Details": "The vulnerability is caused by an error in the handling of the GICv3 ITS (Interrupt Translation Service) which can lead to a double-free vulnerability.", "Detection": "The vulnerability can be detected using system calls such as brk and sbrk to track memory allocation and deallocation.", "Mitigation": "The vulnerability can be mitigated by applying the patch and ensuring proper input validation and error handling.", "Conclusion": "In conclusion, the CVE-2024-35847 vulnerability is a double-free vulnerability in the Linux kernel's irqchip/gic-v3-its module and can be exploited by attackers to crash the system or escalate privileges."}, "executive_analysis": {"Overview": "The CVE-2024-35847 vulnerability is a double-free vulnerability in the Linux kernel's irqchip/gic-v3-its module that can be exploited by attackers to crash the system or escalate privileges.", "Business Impact": "The vulnerability has a significant business impact as it can be exploited to gain unauthorized access to sensitive information or disrupt critical systems.", "Technical Impact": "The vulnerability has a technical impact as it requires the victim to have Linux kernel with the vulnerable code.", "Mitigation Strategies": "The vulnerability can be mitigated by patching the vulnerable code and ensuring proper input validation and error handling.", "Recommendations": "Recommendations include applying the patch, ensuring proper input validation and error handling, and limiting the use of vulnerable code.", "Conclusions": "In conclusion, the CVE-2024-35847 vulnerability is a critical vulnerability that requires immediate attention, and recommended patches and mitigations should be applied promptly."}}