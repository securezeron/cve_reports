{"id": "CVE-2020-15628", "sourceIdentifier": "zdi-disclosures@trendmicro.com", "published": "2020-07-28T17:15:15.663", "lastModified": "2023-01-24T18:57:12.680", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "This vulnerability allows remote attackers to disclose sensitive information on affected installations of CentOS Web Panel cwp-e17.0.9.8.923. Authentication is not required to exploit this vulnerability. The specific flaw exists within ajax_mail_autoreply.php. When parsing the user parameter, the process does not properly validate a user-supplied string before using it to construct SQL queries. An attacker can leverage this vulnerability to disclose information in the context of root. Was ZDI-CAN-9710."}, {"lang": "es", "value": "Esta vulnerabilidad permite a atacantes remotos revelar informaci\u00f3n confidencial sobre las instalaciones afectadas de CentOS Web Panel versi\u00f3n cwp-e17.0.9.8.923. No es requerida una autenticaci\u00f3n para explotar esta vulnerabilidad. El fallo espec\u00edfico se presenta dentro del archivo ajax_mail_autoreply.php. Cuando se analiza el par\u00e1metro user, el proceso no comprueba apropiadamente una cadena suministrada por el usuario antes de usarla para construir consultas SQL. Un atacante puede aprovechar esta vulnerabilidad para revelar informaci\u00f3n en el contexto de root. Fue ZDI-CAN-9710"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV30": [{"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.8}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "zdi-disclosures@trendmicro.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}, {"source": "nvd@nist.gov", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:control-webpanel:webpanel:0.9.8.923:*:*:*:*:*:*:*", "matchCriteriaId": "CF0BE231-2D95-4605-B989-85EF6D5B1216"}]}]}], "references": [{"url": "https://www.zerodayinitiative.com/advisories/ZDI-20-775/", "source": "zdi-disclosures@trendmicro.com", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1059.001", "comment": "CVE-2020-15628 - This vulnerability allows remote attackers to disclose sensitive information, indicating a potential Code Injection attack, which is mitigated by implementing input validation and sanitization"}, {"techniqueID": "T1190", "comment": "CVE-2020-15628 - This vulnerability allows remote attackers to disclose sensitive information, indicating a potential SQL Injection attack, which is mitigated by implementing input validation and sanitization"}, {"techniqueID": "T1027", "comment": "CVE-2020-15628 - This vulnerability allows remote attackers to disclose sensitive information, indicating a potential Web Shell attack, which is mitigated by implementing robust authentication and authorization mechanisms"}], "stix_bundle": {"_bundle": {"$schema": "https://docs.oasis-open.org/STIX/STIX_2.1/schema/stix-core.xsd", "id": "a7ea96ce-a99b-47c0-a1eb-c43e1515c97a", "spec_version": "2.1", "created_by_ref": "https://example.com/STIX-Publisher", "created": "2023-02-20T14:30:00.000Z", "modified": "2023-02-20T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "CVE-2020-15628", "name": "CVE-2020-15628", "description": "This vulnerability allows remote attackers to disclose sensitive information on affected installations of CentOS Web Panel cwp-e17.0.9.8.923.", "severity": "High", "cvssv3": {"base_score": 7.5, "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"}, "cvssv2": {"base_score": 7.8, "vectorString": "AV:N/AC:L/Au:N/C:C/I:N/A:N"}}, {"type": "indicator", "id": "indicator-1", "name": "Indicator for Code Injection Attack", "description": "Indicator for a Code Injection attack attempting to exploit the vulnerability", "pattern": ".*Code Injection.*"}, {"type": "mitigation", "id": "mitigation-1", "name": "Implement Input Validation and Sanitization", "description": "Implement input validation and sanitization to prevent Code Injection attacks"}, {"type": "tactic", "id": "tactic-1", "name": "Defense Evasion", "description": "Defense Evasion tactic mitigates the vulnerability by detecting and preventing unwanted actions"}, {"type": "course_of_action", "id": "course_of_action-1", "name": "Implement Robust Authentication and Authorization Mechanisms", "description": "Implement robust authentication and authorization mechanisms to prevent unauthorized access"}], "relationships": [{"relationship": "indicates", "from": "CVE-2020-15628", "to": "indicator-1"}, {"relationship": "mitigates", "from": "indicator-1", "to": "mitigation-1"}, {"relationship": "uses", "from": "mitigation-1", "to": "tactic-1"}, {"relationship": "uses", "from": "course_of_action-1", "to": "tactic-1"}]}}, "technical_analysis": {"Introduction": "The vulnerability CVE-2020-15628 allows remote attackers to disclose sensitive information on affected installations of CentOS Web Panel cwp-e17.0.9.8.923.", "Impact and Scope": "The vulnerability has a CVSSv3 score of 7.5 and a CVSSv2 score of 7.8, indicating high severity.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to Code Injection, SQL Injection, and Web Shell attacks.", "Technical Details": "The vulnerability exists in the Ajax Mail Autoreply PHP file and can be exploited by parsing the user parameter without proper validation.", "Detection": "The vulnerability can be detected through Network Traffic Analysis and Penetration Testing.", "Mitigation": "The vulnerability can be mitigated by implementing input validation and sanitization, robust authentication and authorization mechanisms, and robust configuration management.", "Conclusion": "The vulnerability is a high-severity remote code execution vulnerability and should be addressed promptly."}, "executive_analysis": {"Overview": "The vulnerability CVE-2020-15628 is a high-severity remote code execution vulnerability that can be exploited by remote attackers.", "Business Impact": "The vulnerability can lead to unauthorized access to sensitive information and potential data breaches.", "Technical Impact": "The vulnerability can be exploited by remote attackers to disclose sensitive information, indicating a potential Code Injection attack.", "Mitigation Strategies": "Implement input validation and sanitization, robust authentication and authorization mechanisms, and robust configuration management.", "Recommendations": "Allocate resources for patching and vulnerability assessment to ensure timely detection and mitigation.", "Conclusions": "The vulnerability is a high-risk threat and should be addressed promptly to prevent potential data breaches."}}