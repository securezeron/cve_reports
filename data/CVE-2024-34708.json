{"id": "CVE-2024-34708", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-14T15:39:31.083", "lastModified": "2024-05-14T16:12:23.490", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Directus is a real-time API and App dashboard for managing SQL database content. A user with permission to view any collection using redacted hashed fields can get access the raw stored version using the `alias` functionality on the API. Normally, these redacted fields will return `**********` however  if we change the request to `?alias[workaround]=redacted` we can instead retrieve the plain text value for the field. This can be avoided by removing permission to view the sensitive fields entirely from users or roles that should not be able to see them. This vulnerability is fixed in 10.11.0."}, {"lang": "es", "value": "Directus es una API y un panel de aplicaciones en tiempo real para administrar el contenido de la base de datos SQL. Un usuario con permiso para ver cualquier colecci\u00f3n utilizando campos hash redactados puede acceder a la versi\u00f3n almacenada sin formato utilizando la funcionalidad \"alias\" en la API. Normalmente, estos campos redactados devolver\u00e1n `**********`; sin embargo, si cambiamos la solicitud a `?alias[workaround]=redacted`, podemos recuperar el valor de texto sin formato para el campo. Esto se puede evitar eliminando el permiso para ver los campos confidenciales por completo a los usuarios o roles que no deber\u00edan poder verlos. Esta vulnerabilidad se solucion\u00f3 en 10.11.0."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}]}], "references": [{"url": "https://github.com/directus/directus/commit/e70a90c267bea695afce6545174c2b77517d617b", "source": "security-advisories@github.com"}, {"url": "https://github.com/directus/directus/security/advisories/GHSA-p8v3-m643-4xqx", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1027: Custom Command and Control", "comment": "CVE-2024-34708 - This CVE allows an attacker to access the raw stored version of a redacted hashed field, which can be exploited to gain unauthorized access to sensitive data. Defending against this involves removing permissions to view sensitive fields or patching the vulnerability."}, {"techniqueID": "T1555: Post Exploitation", "comment": "CVE-2024-34708 - This CVE provides an attacker with sensitive information, allowing them to further exploit the system. Defending against this involves monitoring for unusual access to sensitive data and implementing role-based access control."}, {"techniqueID": "T1190: Exploit PUBLIC-FACING APPLICATION", "comment": "CVE-2024-34708 - This CVE allows an attacker to exploit a publicly-facing application, allowing them to gain unauthorized access to sensitive data. Defending against this involves patching the application and implementing web application firewalls."}], "technical_analysis": {"Introduction": "Directus, a real-time API and App dashboard, suffers from a vulnerability that allows an unauthorized user to access raw stored versions of redacted hashed fields.", "Impact and Scope": "The vulnerability has a CVSS score of 4.9, version 3.1, with an attack vector of NETWORK, and affects Directus versions prior to 10.11.0.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1027, T1555, and T1190.", "Technical Details": "The vulnerability is caused by the `alias` functionality in the Directus API, which allows an attacker to access the raw stored version of a redacted hashed field by modifying the request.", "Detection": "Detection involves monitoring for unusual access to sensitive data and implementing role-based access control.", "Mitigation": "Mitigation involves patching the vulnerability in Directus versions prior to 10.11.0, removing permissions to view sensitive fields, or implementing web application firewalls.", "Conclusion": "The vulnerability can be exploited to gain unauthorized access to sensitive data and further exploit the system."}, "executive_analysis": {"Overview": "Directus, a real-time API and App dashboard, suffers from a vulnerability that allows an unauthorized user to access raw stored versions of redacted hashed fields.", "Business Impact": "The vulnerability can allow an attacker to access sensitive data, potentially leading to financial loss and reputational damage.", "Technical Impact": "The vulnerability can be exploited to gain unauthorized access to sensitive data and further exploit the system.", "Mitigation Strategies": "Patching the vulnerability, removing permissions to view sensitive fields, or implementing web application firewalls can mitigate the risk.", "Recommendations": "Executive Recommendation: Patch the vulnerability, remove permissions to view sensitive fields, or implement web application firewalls to mitigate the risk.", "Conclusions": "The vulnerability requires immediate attention and action to mitigate the risk."}}