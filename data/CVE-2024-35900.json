{"id": "CVE-2024-35900", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-19T09:15:10.887", "lastModified": "2024-06-25T22:15:32.823", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nf_tables: reject new basechain after table flag update\n\nWhen dormant flag is toggled, hooks are disabled in the commit phase by\niterating over current chains in table (existing and new).\n\nThe following configuration allows for an inconsistent state:\n\n  add table x\n  add chain x y { type filter hook input priority 0; }\n  add table x { flags dormant; }\n  add chain x w { type filter hook input priority 1; }\n\nwhich triggers the following warning when trying to unregister chain w\nwhich is already unregistered.\n\n[  127.322252] WARNING: CPU: 7 PID: 1211 at net/netfilter/core.c:50                                                                     1 __nf_unregister_net_hook+0x21a/0x260\n[...]\n[  127.322519] Call Trace:\n[  127.322521]  <TASK>\n[  127.322524]  ? __warn+0x9f/0x1a0\n[  127.322531]  ? __nf_unregister_net_hook+0x21a/0x260\n[  127.322537]  ? report_bug+0x1b1/0x1e0\n[  127.322545]  ? handle_bug+0x3c/0x70\n[  127.322552]  ? exc_invalid_op+0x17/0x40\n[  127.322556]  ? asm_exc_invalid_op+0x1a/0x20\n[  127.322563]  ? kasan_save_free_info+0x3b/0x60\n[  127.322570]  ? __nf_unregister_net_hook+0x6a/0x260\n[  127.322577]  ? __nf_unregister_net_hook+0x21a/0x260\n[  127.322583]  ? __nf_unregister_net_hook+0x6a/0x260\n[  127.322590]  ? __nf_tables_unregister_hook+0x8a/0xe0 [nf_tables]\n[  127.322655]  nft_table_disable+0x75/0xf0 [nf_tables]\n[  127.322717]  nf_tables_commit+0x2571/0x2620 [nf_tables]"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: netfilter: nf_tables: rechazar nueva cadena base despu\u00e9s de actualizar la bandera de la tabla Cuando se activa la bandera inactiva, los enlaces se desactivan en la fase de confirmaci\u00f3n al iterar sobre las cadenas actuales en la tabla (existentes y nuevas). La siguiente configuraci\u00f3n permite un estado inconsistente: agregar tabla x agregar cadena xy { tipo filtro gancho entrada prioridad 0; } agregar tabla x {banderas inactivas; } agregar cadena xw {tipo filtro gancho entrada prioridad 1; } que activa la siguiente advertencia al intentar cancelar el registro de la cadena w que ya est\u00e1 cancelada. [127.322252] ADVERTENCIA: CPU: 7 PID: 1211 en net/netfilter/core.c:50 1 __nf_unregister_net_hook+0x21a/0x260 [...] [ 127.322519] Seguimiento de llamadas: [ 127.322521]  [ 127.322524] ? __advertir+0x9f/0x1a0 [ 127.322531] ? __nf_unregister_net_hook+0x21a/0x260 [127.322537]? report_bug+0x1b1/0x1e0 [127.322545]? handle_bug+0x3c/0x70 [127.322552]? exc_invalid_op+0x17/0x40 [127.322556]? asm_exc_invalid_op+0x1a/0x20 [127.322563]? kasan_save_free_info+0x3b/0x60 [127.322570]? __nf_unregister_net_hook+0x6a/0x260 [127.322577]? __nf_unregister_net_hook+0x21a/0x260 [127.322583]? __nf_unregister_net_hook+0x6a/0x260 [127.322590]? __nf_tables_unregister_hook+0x8a/0xe0 [nf_tables] [ 127.322655] nft_table_disable+0x75/0xf0 [nf_tables] [ 127.322717] nf_tables_commit+0x2571/0x2620 [nf_tables]"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/41bad13c0e8a5a2b47a7472cced922555372daab", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/420132bee3d0136b7fba253a597b098fe15493a7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6d12f21f8bbe23fde25b77c2bf5973c136b8bef8", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/745cf6a843896cdac8766c74379300ed73c78830", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/7b6fba6918714afee3e17796113ccab636255c7b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/8ba81dca416adf82fc5a2a23abc1a8cc02ad32fb", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/994209ddf4f430946f6247616b2e33d179243769", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e95bb4cba94c018be24b11f017d1c55dd6cda31a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-35900 - This is a vulnerability in the Linux kernel related to netfilter, which can allow for inconsistent state and possible kernel crashes. Defending against this vulnerability requires closely monitoring kernel logs and implementing proper chain and hook management."}, {"techniqueID": "T1036", "comment": "CVE-2024-35900 - This vulnerability can be used by attackers to manipulate kernel state and potentially crash the system. To defend against this, implement proper access controls and monitor kernel logs for suspicious activity."}, {"techniqueID": "T1191", "comment": "CVE-2024-35900 - This vulnerability can be used to disable hooks and create a inconsistent state in the kernel. Defending against this requires implementing proper hook management and monitoring kernel logs for suspicious activity."}], "stix_bundle": {"objects": [{"id": "vuln:CVE-2024-35900", "type": "vulnerability", "description": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nf_tables: reject new basechain after table flag update\n\nWhen dormant flag is toggled, hooks are disabled in the commit phase by\niterating over current chains in table (existing and new).\n\nThe following configuration allows for an inconsistent state:\n\n  add table x\n  add chain x y { type filter hook input priority 0; }\n  add table x { flags dormant; }\n  add chain x w { type filter hook input priority 1; }\n\nwhich triggers the following warning when trying to unregister chain w\nwhich is already unregistered.\n\n[  127.322252] WARNING: CPU: 7 PID: 1211 at net/netfilter/core.c:50                                                                     1 __nf_unregister_net_hook+0x21a/0x260\n[...]\n[  127.322519] Call Trace:\n[  127.322521]  <TASK>\n[  127.322524]  ? __warn+0x9f/0x1a0\n[  127.322531]  ? __nf_unregister_net_hook+0x21a/0x260\n[  127.322537]  ? report_bug+0x1b1/0x1e0\n[  127.322545]  ? handle_bug+0x3c/0x70\n[  127.322552]  ? exc_invalid_op+0x17/0x40\n[  127.322556]  ? asm_exc_invalid_op+0x1a/0x20\n[  127.322563]  ? kasan_save_free_info+0x3b/0x60\n[  127.322570]  ? __nf_unregister_net_hook+0x6a/0x260\n[  127.322577]  ? __nf_unregister_net_hook+0x21a/0x260\n[  127.322583]  ? __nf_unregister_net_hook+0x6a/0x260\n[  127.322590]  ? __nf_tables_unregister_hook+0x8a/0xe0 [nf_tables]\n[  127.322655]  nft_table_disable+0x75/0xf0 [nf_tables]\n[  127.322717]  nf_tables_commit+0x2571/0x2620 [nf_tables]"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: netfilter: nf_tables: rechazar nueva cadena base despu\u00e9s de actualizar la bandera de la tabla Cuando se activa la bandera inactiva, los enlaces se desactivan en la fase de confirmaci\u00f3n al iterar sobre las cadenas actuales en la tabla (existentes y nuevas). La siguiente configuraci\u00f3n permite un estado inconsistente: agregar tabla x agregar cadena xy { tipo filtro gancho entrada prioridad 0; } agregar tabla x {banderas inactivas; } agregar cadena xw {tipo filtro gancho entrada prioridad 1; } que activa la siguiente advertencia al intentar cancelar el registro de la cadena w que ya est\u00e1 cancelada."}], "vulnerability-cvss": {"vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "score": 8.7}}], "relationships": [{"relationship_id": "vuln:CVE-2024-35900-technique:T1190", "object_id": "technique:T1190", "relationship_type": "exploits", "direction": "from_to"}, {"relationship_id": "vuln:CVE-2024-35900-technique:T1036", "object_id": "technique:T1036", "relationship_type": "exploits", "direction": "from_to"}, {"relationship_id": "vuln:CVE-2024-35900-technique:T1191", "object_id": "technique:T1191", "relationship_type": "exploits", "direction": "from_to"}]}, "technical_analysis": {"Introduction": "The Linux kernel vulnerability CVE-2024-35900 is a kernel-level vulnerability that allows attackers to manipulate kernel state and potentially crash the system.", "Impact and Scope": "The impact of this vulnerability is high, as it can be used to disable hooks and create a inconsistent state in the kernel. The scope is restricted to systems running Linux kernel version 5.17 and above.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1190, T1036, and T1191.", "Technical Details": "The vulnerability is located in the network filter framework of the Linux kernel and affects systems running kernel version 5.17 and above.", "Detection": "Detection of this vulnerability can be done by monitoring kernel logs for suspicious activity and implementing proper hook management.", "Mitigation": "Mitigation strategies for this vulnerability include implementing proper access controls, monitoring kernel logs, and closely monitoring kernel state.", "Conclusion": "In conclusion, the vulnerability CVE-2024-35900 is a high-severity vulnerability that can be used to manipulate kernel state and potentially crash the system."}, "executive_analysis": {"Overview": "The Linux kernel vulnerability CVE-2024-35900 is a high-severity vulnerability that can be used to manipulate kernel state and potentially crash the system.", "Business Impact": "The business impact of this vulnerability is high, as it can lead to system crashes and potential data loss.", "Technical Impact": "The technical impact of this vulnerability is also high, as it can be used to disable hooks and create a inconsistent state in the kernel.", "Mitigation Strategies": "To mitigate this vulnerability, implement proper access controls, monitor kernel logs, and closely monitor kernel state.", "Recommendations": "Recommendations for executives include prioritizing patching and upgrading the Linux kernel, implementing proper security controls, and conducting regular security testing and assessments.", "Conclusions": "In conclusion, the vulnerability CVE-2024-35900 is a high-severity vulnerability that requires immediate attention and mitigation."}}