{"id": "CVE-2020-8561", "sourceIdentifier": "jordan@liggitt.net", "published": "2021-09-20T17:15:08.187", "lastModified": "2021-11-06T03:04:43.630", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A security issue was discovered in Kubernetes where actors that control the responses of MutatingWebhookConfiguration or ValidatingWebhookConfiguration requests are able to redirect kube-apiserver requests to private networks of the apiserver. If that user can view kube-apiserver logs when the log level is set to 10, they can view the redirected responses and headers in the logs."}, {"lang": "es", "value": "Se ha detectado un problema de seguridad en Kubernetes donde los actores que controlan las respuestas de las peticiones MutatingWebhookConfiguration o ValidatingWebhookConfiguration son capaces de redirigir las peticiones de kube-apiserver a redes privadas del apiserver. Si ese usuario puede visualizar los registros de kube-apiserver cuando el nivel de registro se establece en 10, puede visualizar las respuestas redirigidas y los encabezados en los registros"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 1.4}, {"source": "jordan@liggitt.net", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-610"}]}, {"source": "jordan@liggitt.net", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-441"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:kubernetes:kubernetes:1.20.11:-:*:*:*:*:*:*", "matchCriteriaId": "1E602175-D34A-44F2-88CD-C0D2C5D240EB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kubernetes:kubernetes:1.21.5:-:*:*:*:*:*:*", "matchCriteriaId": "0CBB908A-7235-4F5A-AD59-9E11B77A4CA3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kubernetes:kubernetes:1.22.2:-:*:*:*:*:*:*", "matchCriteriaId": "8A1DF02D-B561-445F-8262-3A9F6762CBC3"}]}]}], "references": [{"url": "https://github.com/kubernetes/kubernetes/issues/104720", "source": "jordan@liggitt.net", "tags": ["Mitigation", "Third Party Advisory"]}, {"url": "https://groups.google.com/g/kubernetes-security-announce/c/RV2IhwcrQsY", "source": "jordan@liggitt.net", "tags": ["Mailing List", "Mitigation"]}, {"url": "https://security.netapp.com/advisory/ntap-20211014-0002/", "source": "jordan@liggitt.net", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1027.005: Command and Control - Web Service", "comment": "CVE-2020-8561 - An attacker can use this vulnerability to redirect kube-apiserver requests to private networks, allowing them to gather sensitive information or launch further attacks."}, {"techniqueID": "T1402: Data Flow - Directed Request", "comment": "CVE-2020-8561 - An attacker can use this vulnerability to redirect kube-apiserver requests to private networks, allowing them to gather sensitive information or launch further attacks."}, {"techniqueID": "T1204.001: File and Directory Discovery - Gather Directory Information", "comment": "CVE-2020-8561 - An attacker can use this vulnerability to gather sensitive information about the kube-apiserver's directory structure, allowing them to launch further attacks."}, {"techniqueID": "T1102: Data Encoding: Unicode", "comment": "CVE-2020-8561 - An attacker can use this vulnerability to redirect kube-apiserver requests to private networks, allowing them to gather sensitive information or launch further attacks."}], "stix_bundle": {"type": "bundle", "id": "CVE-2020-8561", "created_by_ref": "https://stix.foundation/built_in/identifiers/entity/www.stixfoundation.org", "objects": [{"id": "CVE-2020-8561", "type": "vulnerability", "name": "CVE-2020-8561", "description": "A security issue was discovered in Kubernetes where actors that control the responses of MutatingWebhookConfiguration or ValidatingWebhookConfiguration requests are able to redirect kube-apiserver requests to private networks of the apiserver."}, {"id": "T1027.005", "type": "attack-pattern", "name": "Command and Control - Web Service", "description": "The adversary uses web services to communicate with other malicious actors or command centers."}, {"id": "T1402", "type": "attack-pattern", "name": "Data Flow - Directed Request", "description": "The adversary uses directed requests to communicate with other malicious actors or command centers."}, {"id": "T1204.001", "type": "attack-pattern", "name": "File and Directory Discovery - Gather Directory Information", "description": "The adversary uses file and directory discovery techniques to gather information about the victim's system."}, {"id": "T1102", "type": "attack-pattern", "name": "Data Encoding: Unicode", "description": "The adversary uses data encoding techniques to communicate with other malicious actors or command centers."}, {"id": "response_to_CVE-2020-8561_1", "type": "action", "name": "Apply CVE-2020-8561 Patch", " description": "Apply the patch for CVE-2020-8561 to mitigate the vulnerability."}, {"id": "response_to_CVE-2020-8561_2", "type": "action", "name": "Monitor Kubernetes Logins", "description": "Monitor Kubernetes logins for suspicious activity."}, {"id": "response_to_CVE-2020-8561_3", "type": "action", "name": "Restrict Webhook Configuration", "description": "Restrict webhook configuration to prevent unauthorized access."}], "relationships": [{"id": "response_to_CVE-2020-8561_1", "type": "related_to", "object_ref": "CVE-2020-8561"}, {"id": "response_to_CVE-2020-8561_2", "type": "related_to", "object_ref": "CVE-2020-8561"}, {"id": "response_to_CVE-2020-8561_3", "type": "related_to", "object_ref": "CVE-2020-8561"}]}, "technical_analysis": {"Introduction": "The vulnerability CVE-2020-8561 is a security issue in Kubernetes where actors that control the responses of MutatingWebhookConfiguration or ValidatingWebhookConfiguration requests can redirect kube-apiserver requests to private networks.", "Impact and Scope": "The vulnerability allows an attacker to redirect kube-apiserver requests to private networks, allowing them to gather sensitive information or launch further attacks. The CVSS score for this vulnerability is 4.1 with a vector of AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:N/A:N.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1027.005, T1402, T1204.001, and T1102.", "Technical Details": "The vulnerability occurs when an actor controls the response of a MutatingWebhookConfiguration or ValidatingWebhookConfiguration request, allowing them to redirect kube-apiserver requests to private networks.", "Detection": "To detect this vulnerability, monitor Kubernetes logins for suspicious activity and restrict webhook configuration to prevent unauthorized access.", "Mitigation": "Apply the patch for CVE-2020-8561, monitor Kubernetes logins, and restrict webhook configuration.", "Conclusion": "The CVE-2020-8561 vulnerability is a serious security issue in Kubernetes that allows an attacker to redirect kube-apiserver requests to private networks, allowing them to gather sensitive information or launch further attacks."}, "executive_analysis": {"Overview": "The CVE-2020-8561 vulnerability is a security issue in Kubernetes that allows an attacker to redirect kube-apiserver requests to private networks.", "Business Impact": "The business impact of this vulnerability is significant, as it allows an attacker to gather sensitive information or launch further attacks.", "Technical Impact": "The technical impact of this vulnerability is that it allows an attacker to redirect kube-apiserver requests to private networks, allowing them to gather sensitive information or launch further attacks.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are to apply the patch, monitor Kubernetes logins, and restrict webhook configuration.", "Recommendations": "We recommend applying the patch, monitoring Kubernetes logins, and restricting webhook configuration to prevent unauthorized access.", "Conclusions": "In conclusion, the CVE-2020-8561 vulnerability is a serious security issue in Kubernetes that allows an attacker to redirect kube-apiserver requests to private networks, allowing them to gather sensitive information or launch further attacks. We recommend applying the patch, monitoring Kubernetes logins, and restricting webhook configuration to prevent unauthorized access."}}