{"id": "CVE-2024-3605", "sourceIdentifier": "security@wordfence.com", "published": "2024-06-20T02:15:10.817", "lastModified": "2024-07-15T17:12:36.967", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The WP Hotel Booking plugin for WordPress is vulnerable to SQL Injection via the 'room_type' parameter of the /wphb/v1/rooms/search-rooms REST API endpoint in all versions up to, and including, 2.1.0 due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query.  This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database."}, {"lang": "es", "value": "El complemento WP Hotel Booking para WordPress es vulnerable a la inyecci\u00f3n SQL a trav\u00e9s del par\u00e1metro 'room_type' del endpoint de la API REST /wphb/v1/rooms/search-rooms en todas las versiones hasta la 2.1.0 incluida debido a un escape insuficiente en el par\u00e1metro proporcionado por el usuario y la falta de preparaci\u00f3n suficiente en la consulta SQL existente. Esto hace posible que atacantes no autenticados agreguen consultas SQL adicionales a consultas ya existentes que pueden usarse para extraer informaci\u00f3n confidencial de la base de datos."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:thimpress:wp_hotel_booking:*:*:*:*:*:wordpress:*:*", "versionEndIncluding": "2.1.0", "matchCriteriaId": "4F290C07-897E-411E-8C9D-6EBBDB144AF6"}]}]}], "references": [{"url": "https://wordpress.org/plugins/wp-hotel-booking/", "source": "security@wordfence.com", "tags": ["Product"]}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/5931ad4e-7de3-41ac-b783-f7e58aaef569?source=cve", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2024-3605 - SQL Injection via User-supplied Data in WordPress Plugin - Allows unauthenticated attackers to append additional SQL queries into existing queries, making it possible to extract sensitive information from the database."}, {"techniqueID": "T1190", "comment": "CVE-2024-3605 - Web Shell - The vulnerability makes it possible for attackers to create a web shell, allowing remote access and control of the affected system."}, {"techniqueID": "T1076", "comment": "CVE-2024-3605 - Credential Dumping - The vulnerability makes it possible for attackers to extract sensitive information, including credentials, from the database."}], "stix_bundle": {"spec_version": "2.1", "id": "https://example.com/cve-2024-3605", "type": "bundle", "objects": [{"id": "https://example.com/cve-2024-3605", "type": "vulnerability", "name": "CVE-2024-3605", "description": {"lang": "en", "value": "The WP Hotel Booking plugin for WordPress is vulnerable to SQL Injection via the 'room_type' parameter of the /wphb/v1/rooms/search-rooms REST API endpoint in all versions up to, and including, 2.1.0 due to insufficient escaping on the user supplied parameter and lack of sufficient preparation on the existing SQL query."}, "cvss": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "baseScore": 9.8}, "exploitability": {"score": 3.9}, "impact": {"score": 5.9}}, {"id": "https://example.com/t1059", "type": "attack-pattern", "name": "T1059: SQL Injection", "description": {"lang": "en", "value": "The attacker injects malicious SQL code into the application, allowing them to manipulate and extract data."}}, {"id": "https://example.com/t1190", "type": "attack-pattern", "name": "T1190: Web Shell", "description": {"lang": "en", "value": "The attacker creates a web shell on the affected system, allowing remote access and control."}}, {"id": "https://example.com/t1076", "type": "attack-pattern", "name": "T1076: Credential Dumping", "description": {"lang": "en", "value": "The attacker extracts sensitive information, including credentials, from the affected system."}}, {"id": "https://example.com/d3fend-pr-1", "type": "intrusion-set", "name": "D3FEND Prevention - 1", "description": {"lang": "en", "value": "A set of preventive measures to block the exploitation of the vulnerability, including SQL injection prevention and web shell detection."}}], "relationships": [{"type": "related-to", "idRef": "https://example.com/cve-2024-3605", "id": "https://example.com/t1059"}, {"type": "related-to", "idRef": "https://example.com/cve-2024-3605", "id": "https://example.com/t1190"}, {"type": "related-to", "idRef": "https://example.com/cve-2024-3605", "id": "https://example.com/t1076"}, {"type": "prevented-by", "idRef": "https://example.com/d3fend-pr-1", "id": "https://example.com/cve-2024-3605"}]}, "technical_analysis": {"Introduction": "The CVE-2024-3605 vulnerability is a SQL Injection vulnerability in the WP Hotel Booking plugin for WordPress, allowing unauthenticated attackers to extract sensitive information from the database.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8, indicating a high level of risk, and can be exploited to extract sensitive information, including credentials, from the database.", "Related MITRE ATT&CK Techniques": "T1059: SQL Injection, T1190: Web Shell, T1076: Credential Dumping", "Technical Details": "The vulnerability is caused by insufficient escaping on the user-supplied parameter and lack of sufficient preparation on the existing SQL query, making it possible for attackers to append additional SQL queries into existing queries.", "Detection": "Detection methods include SQL injection detection tools and web application firewalls.", "Mitigation": "Mitigation strategies include patching the vulnerability, configuring web application firewalls to block SQL injection attacks, and implementing SQL injection prevention measures.", "Conclusion": "The CVE-2024-3605 vulnerability is a high-risk vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2024-3605 vulnerability is a high-risk vulnerability in the WP Hotel Booking plugin for WordPress, allowing unauthenticated attackers to extract sensitive information from the database.", "Business Impact": "The vulnerability has a significant business impact, as it can lead to unauthorized access and control of sensitive data.", "Technical Impact": "The vulnerability has a high technical impact, as it can lead to the extraction of sensitive information, including credentials, from the database.", "Mitigation Strategies": "Patching the vulnerability, configuring web application firewalls to block SQL injection attacks, and implementing SQL injection prevention measures.", "Recommendations": "Administrators should patch the vulnerability as soon as possible and implement measures to prevent SQL injection attacks.", "Conclusions": "The CVE-2024-3605 vulnerability is a high-risk vulnerability that requires immediate attention and mitigation."}}