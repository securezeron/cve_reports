{"id": "CVE-2024-41674", "sourceIdentifier": "security-advisories@github.com", "published": "2024-08-21T15:15:08.770", "lastModified": "2024-08-23T17:06:58.063", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "CKAN is an open-source data management system for powering data hubs and data portals. If there were connection issues with the Solr server, the internal Solr URL (potentially including credentials) could be leaked to package_search calls as part of the returned error message. This has been patched in CKAN 2.10.5 and 2.11.0."}, {"lang": "es", "value": "CKAN es un sistema de gesti\u00f3n de datos de c\u00f3digo abierto para impulsar centros y portales de datos. Si hubo problemas de conexi\u00f3n con el servidor Solr, la URL interna de Solr (que potencialmente incluye las credenciales) podr\u00eda filtrarse a llamadas package_search como parte del mensaje de error devuelto. Esto ha sido parcheado en CKAN 2.10.5 y 2.11.0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-209"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-209"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:okfn:ckan:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.0", "versionEndExcluding": "2.10.5", "matchCriteriaId": "E92554C7-B668-4F24-9781-5E5F2A284989"}]}]}], "references": [{"url": "https://github.com/ckan/ckan/commit/f6b032cd7082d784938165bbd113557639002ca7", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/ckan/ckan/security/advisories/GHSA-2rqw-cfhc-35fh", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1499", "comment": "CVE-2024-41674 - Leaked internal Solr URL could be used to disclose sensitive information, such as credentials. Defend against this by implementing proper authentication and access control for Solr connections."}, {"techniqueID": "T1027", "comment": "CVE-2024-41674 - Unvalidated user input could lead to arbitrary package search queries, allowing attackers to extract sensitive information. Defend against this by validating and sanitizing user input."}, {"techniqueID": "T1133", "comment": "CVE-2024-41674 - Connection issues with the Solr server could lead to leaked internal Solr URL, exposing sensitive information. Defend against this by implementing redundant connections and implementing failovers."}, {"techniqueID": "T1190", "comment": "CVE-2024-41674 - Leaked internal Solr URL could be used to disclose sensitive information, such as credentials. Defend against this by implementing encryption and secure communication protocols for Solr connections."}, {"techniqueID": "T1197", "comment": "CVE-2024-41674 - Connection issues with the Solr server could lead to leaked internal Solr URL, exposing sensitive information. Defend against this by implementing monitoring and detection mechanisms to identify potential attacks."}], "technical_analysis": {"Introduction": "CVE-2024-41674 is a vulnerability in CKAN, a data management system, that allows for the leakage of internal Solr URL, potentially including credentials.", "Impact and Scope": "The vulnerability has a CVSS score of 5.3, with an attack vector of NETWORK and a base severity of MEDIUM. It is possible to exploit this vulnerability to gain unauthorized access to sensitive information.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this CVE are T1499, T1027, T1133, T1190, and T1197.", "Technical Details": "The vulnerability occurs when connection issues with the Solr server lead to the leakage of internal Solr URL, potentially including credentials. This could be exploited to gain unauthorized access to sensitive information.", "Detection": "Detection of this vulnerability can be done by monitoring for suspicious activity related to Solr connections, such as unusual changes to Solr configuration or unauthorized access to Solr credentials.", "Mitigation": "Mitigation strategies include implementing proper authentication and access control for Solr connections, validating and sanitizing user input, implementing redundant connections and failovers, implementing encryption and secure communication protocols for Solr connections, and implementing monitoring and detection mechanisms to identify potential attacks.", "Conclusion": "CVE-2024-41674 is a vulnerability in CKAN that allows for the leakage of internal Solr URL, potentially including credentials. Defend against this by implementing proper authentication and access control, validating and sanitizing user input, and implementing monitoring and detection mechanisms."}, "executive_analysis": {"Overview": "CVE-2024-41674 is a vulnerability in CKAN that allows for the leakage of internal Solr URL, potentially including credentials, which could be exploited to gain unauthorized access to sensitive information.", "Business Impact": "The business impact of this vulnerability is the potential for unauthorized access to sensitive information, which could lead to data breaches, reputational damage, and financial losses.", "Technical Impact": "The technical impact of this vulnerability is the potential for unauthorized access to sensitive information, which could lead to data breaches, reputational damage, and financial losses.", "Mitigation Strategies": "Mitigation strategies include implementing proper authentication and access control for Solr connections, validating and sanitizing user input, and implementing monitoring and detection mechanisms to identify potential attacks.", "Recommendations": "Recommendations for executives include prioritizing the remediation of this vulnerability, implementing a vulnerability management program, and conducting regular security audits and risk assessments.", "Conclusions": "In conclusion, CVE-2024-41674 is a vulnerability in CKAN that allows for the leakage of internal Solr URL, potentially including credentials, and has significant business and technical impacts. It is essential to prioritize the remediation of this vulnerability and implement mitigation strategies to prevent exploitation."}}