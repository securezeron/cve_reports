{"id": "CVE-2020-4041", "sourceIdentifier": "security-advisories@github.com", "published": "2020-06-08T22:15:10.697", "lastModified": "2022-10-07T01:24:57.117", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In Bolt CMS before version 3.7.1, the filename of uploaded files was vulnerable to stored XSS. It is not possible to inject javascript code in the file name when creating/uploading the file. But, once created/uploaded, it can be renamed to inject the payload in it. Additionally, the measures to prevent renaming the file to disallowed filename extensions could be circumvented. This is fixed in Bolt 3.7.1."}, {"lang": "es", "value": "En Bolt CMS versi\u00f3n anterior a 3.7.1, el nombre de archivo de los archivos cargados eran vulnerables a un ataque de tipo XSS almacenado. No es posible inyectar c\u00f3digo javascript en el nombre del archivo al crear y cargar el archivo. Pero, una vez creado y cargado, se puede cambiar el nombre para inyectar la carga \u00fatil en \u00e9l. Adem\u00e1s, las medidas para impedir cambiar el nombre del archivo a extensiones de nombre de archivo no permitidas podr\u00edan ser omitidas. Esto es corregido en Bolt versi\u00f3n 3.7.1"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:boltcms:bolt:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.7.1", "matchCriteriaId": "00F61767-4ADE-48D3-B45B-7F500002E79D"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/158299/Bolt-CMS-3.7.0-XSS-CSRF-Shell-Upload.html", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://seclists.org/fulldisclosure/2020/Jul/4", "source": "security-advisories@github.com", "tags": ["Exploit", "Mailing List", "Third Party Advisory"]}, {"url": "https://github.com/bolt/bolt/commit/b42cbfcf3e3108c46a80581216ba03ef449e419f", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/bolt/bolt/pull/7853", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/bolt/bolt/security/advisories/GHSA-68q3-7wjp-7q3j", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2020-4041 is a stored XSS vulnerability, which requires user interaction. This could lead to a variety of attacks such as stealing user credentials, injecting malware, or manipulating user actions. Techniques like initial access, privilege escalation, and credential phoning home are all relevant to this vulnerability."}, {"techniqueID": "TA0002", "comment": "The fact that the vulnerability allows an attacker to rename a file to inject the payload, indicates the possibility of exploiting the vulnerability without user interaction. This could be achieved by guessing the possible filename extensions or by using directory traversal attacks. Techniques like file access, data destruction, and data encoding may be relevant in this case."}, {"techniqueID": "TA0010", "comment": "As a stored XSS vulnerability, CVE-2020-4041 also means that an attacker can inject arbitrary content into a web page, which could lead to various attacks. Techniques like web application exploitation, credential phoning home, and data encoding may be involved in this case."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2020-4041", "label": "Bolt CMS Stored XSS Vulnerability", "created_by": "Your Name", "created": "2023-09-20T14:00:00.000Z", "description": "A stored XSS vulnerability in Bolt CMS before version 3.7.1 allows an attacker to inject arbitrary content into a web page, which could lead to various attacks.", "first_published": "2020-06-08T22:15:10.697", "last_modified": "2022-10-07T01:24:57.117", "cvss": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:H/A:N"}, "references": [{"relationship": "related_to", "idref": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-4041"}], "courses_of_action": [{"id": "COA-1", "description": "Apply the patch provided by the vendor and upgrade to version 3.7.1", "mitigates": [{"id": "T1204", "description": "Web Application Exploitation"}]}]}, {"type": "course_of_action", "id": "COA-1", "label": "Apply the patch and upgrade to version 3.7.1", "description": "Apply the patch provided by the vendor and upgrade to version 3.7.1", "mitigates": [{"id": "T1204", "description": "Web Application Exploitation"}]}, {"type": "note", "id": "note-1", "label": "Detection and Defense", "description": "Detect and monitor for unauthorized file uploads and file renames. Implement a web application firewall to block suspicious traffic."}]}, "technical_analysis": {"Introduction": "Bolt CMS is a popular open-source content management system that due to a stored XSS vulnerability, CVE-2020-4041, attacks can be performed remotely without the need for interaction.", "Impact and Scope": "The impact of this vulnerability is significant, as it allows an attacker to inject arbitrary content into a web page, which could lead to various attacks. The scope of this vulnerability is broad, as it affects all versions of Bolt CMS before version 3.7.1.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability include initial access, privilege escalation, and credential phoning home.", "Technical Details": "The vulnerability occurs due to the lack of proper input validation and sanitization of file names in Bolt CMS, which allows an attacker to inject arbitrary content into a web page.", "Detection": "Detect and monitor for unauthorized file uploads and file renames. Implement a web application firewall to block suspicious traffic.", "Mitigation": "Apply the patch provided by the vendor and upgrade to version 3.7.1. Detect and monitor for unauthorized file uploads and file renames. Implement a web application firewall to block suspicious traffic.", "Conclusion": "In conclusion, CVE-2020-4041 is a significant stored XSS vulnerability that requires attention. Implementing the recommended countermeasures can help mitigate the risk of this vulnerability."}, "executive_analysis": {"Overview": "The Bolt CMS stored XSS vulnerability, CVE-2020-4041, is a significant threat that requires immediate attention.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to various attacks, including theft of user credentials, injection of malware, and manipulation of user actions.", "Technical Impact": "The technical impact of this vulnerability is also significant, as it allows an attacker to inject arbitrary content into a web page, which could lead to various attacks.", "Mitigation Strategies": "Apply the patch provided by the vendor and upgrade to version 3.7.1. Implement a web application firewall to block suspicious traffic.", "Recommendations": "We recommend that all users of Bolt CMS upgrade to version 3.7.1 or later and ensure that all systems are properly configured to detect and prevent attacks.", "Conclusions": "In conclusion, immediate attention is required to address the Bolt CMS stored XSS vulnerability, CVE-2020-4041."}}