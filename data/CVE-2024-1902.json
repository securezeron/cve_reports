{"id": "CVE-2024-1902", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-10T17:15:53.680", "lastModified": "2024-04-15T18:15:10.070", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "lunary-ai/lunary is vulnerable to a session reuse attack, allowing a removed user to change the organization name without proper authorization. The vulnerability stems from the lack of validation to check if a user is still part of an organization before allowing them to make changes. An attacker can exploit this by using an old authorization token to send a PATCH request, modifying the organization's name even after being removed from the organization. This issue is due to incorrect synchronization and affects the orgs.patch route."}, {"lang": "es", "value": "lunary-ai/lunary es vulnerable a un ataque de reutilizaci\u00f3n de sesi\u00f3n, lo que permite que un usuario eliminado cambie el nombre de la organizaci\u00f3n sin la autorizaci\u00f3n adecuada. La vulnerabilidad surge de la falta de validaci\u00f3n para verificar si un usuario todav\u00eda es parte de una organizaci\u00f3n antes de permitirle realizar cambios. Un atacante puede aprovechar esto utilizando un token de autorizaci\u00f3n antiguo para enviar una solicitud PATCH, modificando el nombre de la organizaci\u00f3n incluso despu\u00e9s de haber sido eliminada de ella. Este problema se debe a una sincronizaci\u00f3n incorrecta y afecta la ruta orgs.patch."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-821"}]}], "references": [{"url": "https://github.com/lunary-ai/lunary/commit/d8e2e73efd53ab4e92cf47bbf4b639a9f08853d2", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/e536310e-abe7-4585-9cf6-21f77390a5e8", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2024-1902 - This credential stuffing technique is used to exploit the lack of validation in the orgs.patch route, allowing an attacker to modify an organization's name using an old authorization token."}, {"techniqueID": "TA0002", "comment": "CVE-2024-1902 - This technique can be used to exploit the incorrect synchronization of user roles, allowing a removed user to change an organization's name without proper authorization."}, {"techniqueID": "TA0023", "comment": "CVE-2024-1902 - This technique can be used to exploit the lack of validation to check if a user is still part of an organization, allowing an attacker to send a PATCH request and modify the organization's name even after being removed."}], "technical_analysis": {"Introduction": "CVE-2024-1902 is a serious vulnerability in Lunary-ai/Lunary that allows a removed user to change an organization's name without proper authorization.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 (HIGH) with a high attack complexity and an attack vector of NETWORK. The scope is LIMITED to the orgs.patch route.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this CVE: TA0001, TA0002, and TA0023.", "Technical Details": "The vulnerability occurs in the orgs.patch route due to incorrect synchronization of user roles and the lack of validation to check if a user is still part of an organization.", "Detection": "Detection can be challenging, but monitoring for unauthorized changes to organization names and analyzing PATCH requests to the orgs.patch route can help identify potential attacks.", "Mitigation": "To mitigate this vulnerability, implement proper validation to check if a user is still part of an organization before allowing changes, and restrict access to the orgs.patch route.", "Conclusion": "In conclusion, CVE-2024-1902 is a significant vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-1902 is a critical vulnerability in Lunary-ai/Lunary that allows unauthorized changes to organization names.", "Business Impact": "This vulnerability can have significant business impacts, including reputational damage and financial losses.", "Technical Impact": "The technical impact is limited to the orgs.patch route, but the potential consequences are severe.", "Mitigation Strategies": "Implement proper validation and restrict access to the orgs.patch route to mitigate this vulnerability.", "Recommendations": "We recommend immediate attention and mitigation of this vulnerability to prevent potential attacks.", "Conclusions": "In conclusion, CVE-2024-1902 is a critical vulnerability that requires immediate attention and mitigation."}}