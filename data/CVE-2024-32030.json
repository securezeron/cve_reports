{"id": "CVE-2024-32030", "sourceIdentifier": "security-advisories@github.com", "published": "2024-06-19T17:15:57.863", "lastModified": "2024-06-20T12:43:25.663", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Kafka UI is an Open-Source Web UI for Apache Kafka Management. Kafka UI API allows users to connect to different Kafka brokers by specifying their network address and port. As a separate feature, it also provides the ability to monitor the performance of Kafka brokers by connecting to their JMX ports. JMX is based on the RMI protocol, so it is inherently susceptible to deserialization attacks. A potential attacker can exploit this feature by connecting Kafka UI backend to its own malicious broker. This vulnerability affects the deployments where one of the following occurs: 1. dynamic.config.enabled property is set in settings. It's not enabled by default, but it's suggested to be enabled in many tutorials for Kafka UI, including its own README.md. OR  2. an attacker has access to the Kafka cluster that is being connected to Kafka UI. In this scenario the attacker can exploit this vulnerability to expand their access and execute code on Kafka UI as well. Instead of setting up a legitimate JMX port, an attacker can create an RMI listener that returns a malicious serialized object for any RMI call. In the worst case it could lead to remote code execution as Kafka UI has the required gadget chains in its classpath. This issue may lead to post-auth remote code execution. This is particularly dangerous as Kafka-UI does not have authentication enabled by default. This issue has been addressed in version 0.7.2. All users are advised to upgrade. There are no known workarounds for this vulnerability. These issues were discovered and reported by the GitHub Security lab and is also tracked as GHSL-2023-230."}, {"lang": "es", "value": "Kafka UI es una interfaz de usuario web de c\u00f3digo abierto para la administraci\u00f3n de Apache Kafka. La API de Kafka UI permite a los usuarios conectarse a diferentes corredores de Kafka especificando su direcci\u00f3n de red y puerto. Como caracter\u00edstica independiente, tambi\u00e9n brinda la capacidad de monitorear el desempe\u00f1o de los corredores de Kafka conect\u00e1ndose a sus puertos JMX. JMX se basa en el protocolo RMI, por lo que es inherentemente susceptible a ataques de deserializaci\u00f3n. Un atacante potencial puede aprovechar esta caracter\u00edstica conectando el backend de la interfaz de usuario de Kafka a su propio agente malicioso. Esta vulnerabilidad afecta las implementaciones donde ocurre una de las siguientes situaciones: 1. La propiedad dynamic.config.enabled est\u00e1 configurada en la configuraci\u00f3n. No est\u00e1 habilitado de forma predeterminada, pero se sugiere habilitarlo en muchos tutoriales para Kafka UI, incluido su propio README.md. O 2. un atacante tiene acceso al cl\u00faster de Kafka que se est\u00e1 conectando a la interfaz de usuario de Kafka. En este escenario, el atacante puede aprovechar esta vulnerabilidad para ampliar su acceso y ejecutar c\u00f3digo tambi\u00e9n en la interfaz de usuario de Kafka. En lugar de configurar un puerto JMX leg\u00edtimo, un atacante puede crear un detector RMI que devuelva un objeto serializado malicioso para cualquier llamada RMI. En el peor de los casos, podr\u00eda conducir a la ejecuci\u00f3n remota de c\u00f3digo, ya que Kafka UI tiene las cadenas de dispositivos necesarias en su classpath. Este problema puede provocar la ejecuci\u00f3n remota de c\u00f3digo posterior a la autenticaci\u00f3n. Esto es particularmente peligroso ya que Kafka-UI no tiene la autenticaci\u00f3n habilitada de forma predeterminada. Este problema se solucion\u00f3 en la versi\u00f3n 0.7.2. Se recomienda a todos los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad. Estos problemas fueron descubiertos e informados por el laboratorio de seguridad de GitHub y tambi\u00e9n se rastrean como GHSL-2023-230."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-502"}, {"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://github.com/provectus/kafka-ui/commit/83b5a60cc08501b570a0c4d0b4cdfceb1b88d6b7#diff-37e769f4709c1e78c076a5949bbcead74e969725bfd89c7c4ba6d6f229a411e6R36", "source": "security-advisories@github.com"}, {"url": "https://github.com/provectus/kafka-ui/pull/4427", "source": "security-advisories@github.com"}, {"url": "https://securitylab.github.com/advisories/GHSL-2023-229_GHSL-2023-230_kafka-ui/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1204.001", "comment": "CVE-2024-32030 - An attacker may exploit this vulnerability by creating a malicious RMI listener to return a serialized object for any RMI call, leading to remote code execution as Kafka UI has gadget chains in its classpath."}, {"techniqueID": "T1190", "comment": "CVE-2024-32030 - An attacker may exploit this vulnerability by connecting Kafka UI to a malicious broker, allowing the attacker to expand their access and execute code as Kafka UI."}, {"techniqueID": "T1497.001", "comment": "CVE-2024-32030 - An attacker may exploit this vulnerability by creating a serialized object that returns a malicious RMI object, leading to remote code execution."}, {"techniqueID": "T1191", "comment": "CVE-2024-32030 - An attacker may exploit this vulnerability by using a deserialization attack to execute code on Kafka UI."}, {"techniqueID": "T1195", "comment": "CVE-2024-32030 - An attacker may exploit this vulnerability by using a remote code execution attack to execute malicious code on Kafka UI."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle--e81f98ca-1d24-43df-8f33-f3db35fceeb4", "created_by_ref": "identity--5f36b38c-93ab-40f4-bc89-35bfc77d79a1", "created": "2024-06-20T12:43:25.663", "updated": "2024-06-20T12:43:25.663", "objects": [{"type": "vulnerability", "id": "vulnerability--e81f98ca-1d24-43df-8f33-f3db35fceeb4", "created_by_ref": "identity--5f36b38c-93ab-40f4-bc89-35bfc77d79a1", "created": "2024-06-20T12:43:25.663", "updated": "2024-06-20T12:43:25.663", "name": "CVE-2024-32030", "description": "Kafka UI is an Open-Source Web UI for Apache Kafka Management. ...", "score": 8.1, "cvss_vector_string": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "references": [{"type": "reference", "id": "reference--e81f98ca-1d24-43df-8f33-f3db35fceeb4", "href": "https://github.com/provectus/kafka-ui/commit/83b5a60cc08501b570a0c4d0b4cdfceb1b88d6b7#diff-37e769f4709c1e78c076a5949bbcead74e969725bfd89c7c4ba6d6f229a411e6R36"}], "related_objects": [{"type": "course_of_action", "id": "course_of_action--e81f98ca-1d24-43df-8f33-f3db35fceeb4", "name": "Upgrade to Version 0.7.2"}]}, {"type": "course_of_action", "id": "course_of_action--e81f98ca-1d24-43df-8f33-f3db35fceeb4", "name": "Upgrade to Version 0.7.2"}], "relationship": [{"type": "HAS_COURSE_OF_ACTION", "id": "relationship--e81f98ca-1d24-43df-8f33-f3db35fceeb4", "source_ref": "vulnerability--e81f98ca-1d24-43df-8f33-f3db35fceeb4", "target_ref": "course_of_action--e81f98ca-1d24-43df-8f33-f3db35fceeb4", "relationship_type": "FINDS_ARISES_FROM"}]}}, "technical_analysis": {"Introduction": "Kafka UI is vulnerable to deserialization attacks, which could lead to remote code execution.", "Impact and Scope": "CVSS score 8.1, high severity, high attack complexity.", "Related MITRE ATT&CK Techniques": "T1204.001, T1190, T1497.001, T1191, T1195.", "Technical Details": "The vulnerability allows an attacker to connect to the Kafka UI backend and provide a malicious RMI listener, leading to remote code execution.", "Detection": "Monitor system logs for indication of remote command execution.", "Mitigation": "Upgrade to version 0.7.2.", "Conclusion": "This vulnerability highlights the importance of proper configuration and security measures to prevent deserialization attacks."}, "executive_analysis": {"Overview": "Kafka UI is vulnerable to deserialization attacks, which could lead to remote code execution.", "Business Impact": "Immediate visibility into business impact is not available.", "Technical Impact": "Adversaries may exploit this vulnerability to gain remote access to Kafka UI.", "Mitigation Strategies": "Upgrade to version 0.7.2.", "Recommendations": "Implement security measures to prevent deserialization attacks.", "Conclusions": "Kafka UI users should prioritize upgrading to version 0.7.2."}}