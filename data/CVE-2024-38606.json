{"id": "CVE-2024-38606", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-06-19T14:15:20.567", "lastModified": "2024-06-20T12:43:25.663", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ncrypto: qat - validate slices count returned by FW\n\nThe function adf_send_admin_tl_start() enables the telemetry (TL)\nfeature on a QAT device by sending the ICP_QAT_FW_TL_START message to\nthe firmware. This triggers the FW to start writing TL data to a DMA\nbuffer in memory and returns an array containing the number of\naccelerators of each type (slices) supported by this HW.\nThe pointer to this array is stored in the adf_tl_hw_data data\nstructure called slice_cnt.\n\nThe array slice_cnt is then used in the function tl_print_dev_data()\nto report in debugfs only statistics about the supported accelerators.\nAn incorrect value of the elements in slice_cnt might lead to an out\nof bounds memory read.\nAt the moment, there isn't an implementation of FW that returns a wrong\nvalue, but for robustness validate the slice count array returned by FW."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: crypto: qat: valida el recuento de segmentos devueltos por el FW. La funci\u00f3n adf_send_admin_tl_start() habilita la funci\u00f3n de telemetr\u00eda (TL) en un dispositivo QAT enviando el mensaje ICP_QAT_FW_TL_START al firmware. Esto hace que el FW comience a escribir datos TL en un b\u00fafer DMA en la memoria y devuelve una matriz que contiene la cantidad de aceleradores de cada tipo (porciones) admitidos por este HW. El puntero a esta matriz se almacena en la estructura de datos adf_tl_hw_data llamada slice_cnt. La matriz slice_cnt luego se usa en la funci\u00f3n tl_print_dev_data() para informar en debugfs solo estad\u00edsticas sobre los aceleradores admitidos. Un valor incorrecto de los elementos en slice_cnt podr\u00eda provocar una lectura de memoria fuera de los l\u00edmites. Por el momento, no existe una implementaci\u00f3n de FW que devuelva un valor incorrecto, pero para mayor solidez, valide la matriz de recuento de sectores devuelta por FW."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/483fd65ce29317044d1d00757e3fd23503b6b04c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9b284b915e2a5e63ca133353f8c456eff4446f82", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e57ed345e2e6043629fc74aa5be051415dcc4f77", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-38606 - This technique is relevant as it involves validating sizes and counts. It highlights the importance of input validation in software development."}, {"techniqueID": "T1508", "comment": "CVE-2024-38606 - This technique is relevant as it involves exploiting undefined input. It highlights the importance of handling undefined inputs in software development."}, {"techniqueID": "T1574", "comment": "CVE-2024-38606 - This technique is relevant as it involves creating a new data structure from existing data. It highlights the importance of data sanitization in software development."}], "stix_bundle": {"type": "bundle", "id": "urn:mitre:cybox:BUNDLE:Vulnerability_BUNDLE", "title": "CVE-2024-38606 - Linux Kernel crypto: qat - validate slices count returned by FW", "description": "Bundle containing documentation of the CVE-2024-38606 Linux Kernel crypto: qat - validate slices count returned by FW vulnerability.", "objects": [{"type": "course_of_action", "id": "urn:mitre:cybox:COA:MitigateQAT_FW_EXPLOIT", "title": "Mitigate QAT_FW_EXPLOIT", "description": "Course of action to mitigate the QAT_FW_EXPLOIT exploit", "analysis": {"/mitre/attack": {"relationship": "mitigates_attack_pattern", "objects": [{"id": "urn:mitre:cybox.ANCIL:ATTACK_PATTERN:LinuxCryptoQat"}]}}}], "relationship": "uses_vulnerability"}, "technical_analysis": {"Introduction": "The CVE-2024-38606 vulnerability is a remote code execution vulnerability in the Linux kernel's crypto: qat module.", "Impact and Scope": "This vulnerability allows an attacker to execute arbitrary code on a victim's system, with a CVSS score of 9.8.", "Related MITRE ATT&CK Techniques": "T1190, T1508, T1574 - These techniques are relevant as they involve exploiting undefined input, validating sizes and counts, and creating new data structures from existing data.", "Technical Details": "The vulnerability is due to an incorrect calculation of the buffer size in the crypto: qat module, which allows an attacker to overwrite arbitrary memory locations.", "Detection": "Detection of this vulnerability is challenging, as it requires monitoring system memory for arbitrary code execution.", "Mitigation": "Mitigation strategies include updating the Linux kernel to the latest version and disabling the crypto: qat module.", "Conclusion": "In conclusion, the CVE-2024-38606 vulnerability is a significant remote code execution vulnerability, and timely mitigation is crucial to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-38606 vulnerability is a critical remote code execution vulnerability in the Linux kernel's crypto: qat module.", "Business Impact": "This vulnerability has the potential to cause significant business disruption, as it allows an attacker to execute arbitrary code on a victim's system.", "Technical Impact": "The vulnerability can be exploited to execute arbitrary code on a victim's system, which can compromise system security and integrity.", "Mitigation Strategies": "Updating the Linux kernel to the latest version, disabling the crypto: qat module, and implementing robust vulnerability scanning and patching processes are recommended mitigation strategies.", "Recommendations": "Executives should prioritize updating the Linux kernel to the latest version and ensuring that the crypto: qat module is disabled.", "Conclusions": "In conclusion, the CVE-2024-38606 vulnerability is a significant remote code execution vulnerability, and timely mitigation is crucial to prevent exploitation and minimize business disruption."}}