{"id": "CVE-2024-35875", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-19T09:15:08.833", "lastModified": "2024-05-20T13:00:04.957", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nx86/coco: Require seeding RNG with RDRAND on CoCo systems\n\nThere are few uses of CoCo that don't rely on working cryptography and\nhence a working RNG. Unfortunately, the CoCo threat model means that the\nVM host cannot be trusted and may actively work against guests to\nextract secrets or manipulate computation. Since a malicious host can\nmodify or observe nearly all inputs to guests, the only remaining source\nof entropy for CoCo guests is RDRAND.\n\nIf RDRAND is broken -- due to CPU hardware fault -- the RNG as a whole\nis meant to gracefully continue on gathering entropy from other sources,\nbut since there aren't other sources on CoCo, this is catastrophic.\nThis is mostly a concern at boot time when initially seeding the RNG, as\nafter that the consequences of a broken RDRAND are much more\ntheoretical.\n\nSo, try at boot to seed the RNG using 256 bits of RDRAND output. If this\nfails, panic(). This will also trigger if the system is booted without\nRDRAND, as RDRAND is essential for a safe CoCo boot.\n\nAdd this deliberately to be \"just a CoCo x86 driver feature\" and not\npart of the RNG itself. Many device drivers and platforms have some\ndesire to contribute something to the RNG, and add_device_randomness()\nis specifically meant for this purpose.\n\nAny driver can call it with seed data of any quality, or even garbage\nquality, and it can only possibly make the quality of the RNG better or\nhave no effect, but can never make it worse.\n\nRather than trying to build something into the core of the RNG, consider\nthe particular CoCo issue just a CoCo issue, and therefore separate it\nall out into driver (well, arch/platform) code.\n\n  [ bp: Massage commit message. ]"}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: x86/coco: requiere inicializaci\u00f3n de RNG con RDRAND en sistemas CoCo. Hay pocos usos de CoCo que no dependan de una criptograf\u00eda funcional y, por lo tanto, de un RNG funcional. Desafortunadamente, el modelo de amenaza CoCo significa que no se puede confiar en el host de la VM y puede trabajar activamente contra los invitados para extraer secretos o manipular los c\u00e1lculos. Dado que un host malicioso puede modificar u observar casi todas las entradas de los invitados, la \u00fanica fuente de entrop\u00eda restante para los invitados CoCo es RDRAND. Si RDRAND se rompe (debido a una falla del hardware de la CPU), el RNG en su conjunto debe continuar recopilando entrop\u00eda de otras fuentes, pero como no hay otras fuentes en CoCo, esto es catastr\u00f3fico. Esto es principalmente una preocupaci\u00f3n en el momento del arranque cuando se siembra inicialmente el RNG, ya que despu\u00e9s de eso las consecuencias de un RDRAND roto son mucho m\u00e1s te\u00f3ricas. Entonces, intente en el arranque inicializar el RNG usando 256 bits de salida RDRAND. Si esto falla, entra en p\u00e1nico(). Esto tambi\u00e9n se activar\u00e1 si el sistema se inicia sin RDRAND, ya que RDRAND es esencial para un inicio CoCo seguro. Agregue esto deliberadamente para que sea \"solo una caracter\u00edstica del controlador CoCo x86\" y no parte del RNG en s\u00ed. Muchos controladores de dispositivos y plataformas desean contribuir con algo al RNG, y add_device_randomness() est\u00e1 dise\u00f1ado espec\u00edficamente para este prop\u00f3sito. Cualquier conductor puede llamarlo con datos semilla de cualquier calidad, o incluso calidad basura, y solo puede mejorar la calidad del RNG o no tener ning\u00fan efecto, pero nunca puede empeorarlo. En lugar de intentar construir algo en el n\u00facleo del RNG, considere el problema particular de CoCo solo como un problema de CoCo y, por lo tanto, sep\u00e1relo todo en c\u00f3digo de controlador (bueno, arco/plataforma)."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/08044b08b37528b82f70a87576c692b4e4b7716e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/453b5f2dec276c1bb4ea078bf8c0da57ee4627e5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/99485c4c026f024e7cb82da84c7951dbe3deb584", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-35875 - The vulnerability exists in the Linux kernel and allows an attacker to manipulate the RNG, which can lead to a catastrophic failure in cryptographic services. This technique is relevant because it highlights the importance of securing the RNG in cryptographic operations."}, {"techniqueID": "T1574", "comment": "CVE-2024-35875 - The vulnerability demonstrates an absence of protection for cryptographic primitives, allowing attackers to manipulate the RNG. This technique is relevant because it shows how a vulnerable RNG can be exploited to compromise cryptographic operations."}, {"techniqueID": "T1192", "comment": "CVE-2024-35875 - The vulnerability highlights the importance of segregating cryptographic operations from non-cryptographic code. This technique is relevant because it shows how an attacker can use a vulnerable RNG to compromise cryptographic services."}], "technical_analysis": {"Introduction": "CVE-2024-35875 is a vulnerability in the Linux kernel that exists in the x86/coco driver and allows an attacker to manipulate the RNG, which can lead to a catastrophic failure in cryptographic services.", "Impact and Scope": "The impact of this vulnerability is the ability for an attacker to manipulate the RNG, leading to a catastrophic failure in cryptographic services. The scope of this vulnerability is limited to Linux systems using the x86/coco driver.", "Related MITRE ATT&CK Techniques": "T1190, T1574, T1192", "Technical Details": "The vulnerability exists in the way the RNG is seeded in the x86/coco driver. The severity of the vulnerability is high due to the potential for catastrophic failure in cryptographic services.", "Detection": "The vulnerability can be detected by analyzing the RNG seeding process in the x86/coco driver and checking for any discrepancies or anomalies.", "Mitigation": "The mitigation for this vulnerability is to implement strict controls on the RNG seeding process in the x86/coco driver and ensure that it is properly audited and monitored.", "Conclusion": "In conclusion, CVE-2024-35875 is a high-impact vulnerability in the Linux kernel that exists in the x86/coco driver. It is essential to implement strict controls on the RNG seeding process and ensure that it is properly audited and monitored."}, "executive_analysis": {"Overview": "CVE-2024-35875 is a high-impact vulnerability in the Linux kernel that exists in the x86/coco driver. It is essential to implement strict controls on the RNG seeding process and ensure that it is properly audited and monitored.", "Business Impact": "The business impact of this vulnerability is the potential for catastrophic failure in cryptographic services, which can lead to significant financial losses and reputational damage.", "Technical Impact": "The technical impact of this vulnerability is the potential for an attacker to manipulate the RNG, leading to a catastrophic failure in cryptographic services. This can lead to significant technical debt and resource cleanup.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are to implement strict controls on the RNG seeding process, ensure that it is properly audited and monitored, and implement security patches as they become available.", "Recommendations": "Recommendations for executives are to ensure that the organization has a robust incident response plan in place, ensure that the organization has a solid understanding of the technical details of the vulnerability, and ensure that the organization has a plan in place for patching and updating affected systems.", "Conclusions": "In conclusion, it is essential for executives to understand the high-impact nature of CVE-2024-35875 and take immediate action to mitigate the vulnerability."}}