{"id": "CVE-2007-3429", "sourceIdentifier": "cve@mitre.org", "published": "2007-06-27T00:30:00.000", "lastModified": "2017-10-11T01:32:48.550", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Unrestricted file upload vulnerability in signup.php in e107 0.7.8 and earlier, when photograph upload is enabled, allows remote attackers to upload and execute arbitrary PHP code via a filename with a double extension such as .php.jpg."}, {"lang": "es", "value": "Vulnerabilidad de subida de fichero no restringida en signup.php de e107 0.7.8 y anteriores, cuando la subida de fotograf\u00edas est\u00e1 habilitada, permite a atacantes remotos subir y ejecutar c\u00f3digo PHP de su elecci\u00f3n mediante un nombre de fichero con una extensi\u00f3n doble como .php.jpg."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:e107:e107:0.7:*:*:*:*:*:*:*", "matchCriteriaId": "70AB914E-D616-45D2-A451-1C247B8B6E4C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:e107:e107:0.7.1:*:*:*:*:*:*:*", "matchCriteriaId": "CA03C1AC-97EA-47ED-9558-A7CA48420AB2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:e107:e107:0.7.2:*:*:*:*:*:*:*", "matchCriteriaId": "32695A82-B042-46B7-9CB4-20F3446E0C9E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:e107:e107:0.7.3:*:*:*:*:*:*:*", "matchCriteriaId": "6716A040-0CBE-4402-AB2A-1621B1240B0F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:e107:e107:0.7.4:*:*:*:*:*:*:*", "matchCriteriaId": "81627355-AB45-4D47-8DD2-4087E6971EF2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:e107:e107:0.7.5:*:*:*:*:*:*:*", "matchCriteriaId": "D2DAAA4F-B893-4914-8538-E68DDA211225"}, {"vulnerable": true, "criteria": "cpe:2.3:a:e107:e107:0.7.6:*:*:*:*:*:*:*", "matchCriteriaId": "B649DDC6-EEE6-47E1-A69A-831E5C2DD58C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:e107:e107:0.7.7:*:*:*:*:*:*:*", "matchCriteriaId": "2FEEC90E-8640-4786-B014-CAD83EC4F2E6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:e107:e107:0.7.8:*:*:*:*:*:*:*", "matchCriteriaId": "E29B9B12-4C94-4A8D-B407-2D288502EFE2"}]}]}], "references": [{"url": "http://osvdb.org/45426", "source": "cve@mitre.org"}, {"url": "http://www.g00ns-forum.net/showthread.php?t=9388", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/24609", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/35022", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/4099", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1050: Execution", "comment": "CVE-2007-3429 - Unrestricted file upload vulnerability in e107 allows remote attackers to upload and execute arbitrary PHP code. Defend against this by implementing adequate permissions and restrictions on file uploads."}, {"techniqueID": "T1219: Remote File Copy", "comment": "This technique is related to the vulnerability, as the attackers can upload and execute arbitrary PHP code, which can lead to the creation of malicious files on the system."}, {"techniqueID": "T1036: Upload and Execute Files", "comment": "The vulnerability allows attackers to upload and execute arbitrary PHP code, which is a prime example of this technique. Defend against this by implementing adequate permissions and restrictions on file uploads."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "The vulnerability in e107 can be exploited by an attacker to execute arbitrary code on the system, which is a type of public-facing application exploitation."}], "stix_bundle": {"stix_common_incident_identifier": "CVE-2007-3429", "stix_common_vulnerability": {"vulnerability_id": "CVE-2007-3429", "vulnerability_name": "Unrestricted File Upload Vulnerability in E107", "vulnerability_description": "Unrestricted file upload vulnerability in signup.php in e107 0.7.8 and earlier, when photograph upload is enabled, allows remote attackers to upload and execute arbitrary PHP code via a filename with a double extension such as .php.jpg."}, "stix_threat_actors": [{"stix_threat_actor": {"id": "cve-2007-3429-threat-actor", "name": "Remote Attackers"}}], "stix_exploits": [{"stix_exploit": {"id": "cve-2007-3429-exploit", "name": "Unrestricted File Upload Vulnerability Exploit"}, "stix_exploit_relationships": [{"from": "cve-2007-3429-exploit", "to": "cve-2007-3429-vulnerability", "relationship": "exploits"}]}], "stix_courses_of_action": [{"stix_course_of_action": {"id": "cve-2007-3429-course-of-action", "name": "Fix E107 0.7.8 and earlier, and enable photograph upload only for trusted users"}, "stix_course_of_action_relationships": [{"from": "cve-2007-3429-course-of-action", "to": "cve-2007-3429-vulnerability", "relationship": "mitigates"}]}], "stix_defense_use_cases": [{"stix_defense_use_case": {"id": "cve-2007-3429-defense-use-case", "name": "Monitor and Detect Unusual File Uploads"}, "stix_defense_use_case_relationships": [{"from": "cve-2007-3429-defense-use-case", "to": "cve-2007-3429-vulnerability", "relationship": "defends_against"}]}]}, "technical_analysis": {"Introduction": "The unauthenticated unrestricted file upload vulnerability in e107 0.7.8 and earlier allows remote attackers to upload and execute arbitrary PHP code, potentially leading to the execution of malicious code.", "Impact and Scope": "The vulnerability is rated as Medium severity (CVSS score 6.8) and has a moderate attack vector (AV:N/AC:M/Au:N/C:P/I:P/A:P).", "Related MITRE ATT&CK Techniques": "Execution, Remote File Copy, Upload and Execute Files, and Exploit Public-Facing Application", "Technical Details": "The vulnerability is caused by the improper validation of file extensions in the signup.php file, which allows attackers to upload and execute arbitrary PHP code. Defeating the validation is achieved by using a filename with a double extension such as .php.jpg.", "Detection": "Detection involves monitoring for suspicious file uploads and execution of PHP code.", "Mitigation": "Mitigation involves implementing adequate permissions and restrictions on file uploads, only allowing trusted users to upload photographs.", "Conclusion": "In conclusion, the vulnerability in e107 0.7.8 and earlier can be exploited by remote attackers to upload and execute arbitrary PHP code. Defending against this involves implementing adequate permissions and restrictions on file uploads."}, "executive_analysis": {"Overview": "The vulnerability in e107 0.7.8 and earlier allows remote attackers to upload and execute arbitrary PHP code.", "Business Impact": "The vulnerability has a moderate impact on the business, as it can lead to the execution of malicious code and potential damage to the system.", "Technical Impact": "The vulnerability has a moderate technical impact, as it is difficult to exploit and requires a specific set of circumstances to occur.", "Mitigation Strategies": "Implementing adequate permissions and restrictions on file uploads, only allowing trusted users to upload photographs.", "Recommendations": "Recommendations for executives include ensuring that the vulnerability is patched, implementing adequate permissions and restrictions on file uploads, and monitoring for suspicious file uploads and execution of PHP code.", "Conclusions": "In conclusion, the vulnerability in e107 0.7.8 and earlier is a significant threat that requires immediate attention and mitigation strategies."}}