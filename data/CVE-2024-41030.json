{"id": "CVE-2024-41030", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-07-29T15:15:11.697", "lastModified": "2024-07-29T16:21:52.517", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nksmbd: discard write access to the directory open\n\nmay_open() does not allow a directory to be opened with the write access.\nHowever, some writing flags set by client result in adding write access\non server, making ksmbd incompatible with FUSE file system. Simply, let's\ndiscard the write access when opening a directory.\n\nlist_add corruption. next is NULL.\n------------[ cut here ]------------\nkernel BUG at lib/list_debug.c:26!\npc : __list_add_valid+0x88/0xbc\nlr : __list_add_valid+0x88/0xbc\nCall trace:\n__list_add_valid+0x88/0xbc\nfuse_finish_open+0x11c/0x170\nfuse_open_common+0x284/0x5e8\nfuse_dir_open+0x14/0x24\ndo_dentry_open+0x2a4/0x4e0\ndentry_open+0x50/0x80\nsmb2_open+0xbe4/0x15a4\nhandle_ksmbd_work+0x478/0x5ec\nprocess_one_work+0x1b4/0x448\nworker_thread+0x25c/0x430\nkthread+0x104/0x1d4\nret_from_fork+0x10/0x20"}, {"lang": "es", "value": "En el kernel de Linux se ha resuelto la siguiente vulnerabilidad: ksmbd: descarta el acceso de escritura al directorio abierto may_open() no permite abrir un directorio con acceso de escritura. Sin embargo, algunos indicadores de escritura establecidos por el cliente dan como resultado la adici\u00f3n de acceso de escritura en el servidor, lo que hace que ksmbd sea incompatible con el sistema de archivos FUSE. Simplemente, descartemos el acceso de escritura al abrir un directorio. list_add corrupci\u00f3n. lo siguiente es NULO. ------------[ cortar aqu\u00ed ]------------ \u00a1ERROR del kernel en lib/list_debug.c:26! pc: __list_add_valid+0x88/0xbc lr: __list_add_valid+0x88/0xbc Rastreo de llamadas: __list_add_valid+0x88/0xbc fuse_finish_open+0x11c/0x170 fuse_open_common+0x284/0x5e8 fuse_dir_open+0x14/0x24 a4/0x4e0 dentry_open+0x50/0x80 smb2_open+0xbe4 /0x15a4 handle_ksmbd_work+0x478/0x5ec process_one_work+0x1b4/0x448 worker_thread+0x25c/0x430 kthread+0x104/0x1d4 ret_from_fork+0x10/0x20"}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/198498b2049c0f11f7670be6974570e02b0cc035", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/66cf853e1c7a2407f15d9f7aaa3e47d61745e361", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9e84b1ba5c98fb5c9f869c85db1d870354613baa", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e2e33caa5dc2eae7bddf88b22ce11ec3d760e5cd", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-41030 - This technique is used to gain write access to a directory, which can be exploited by an attacker to gain unauthorized access to a system."}, {"techniqueID": "T1086", "comment": "CVE-2024-41030 - This technique is used to exploit the vulnerability by adding write access to a directory, which can be exploited by an attacker to gain unauthorized access to a system."}, {"techniqueID": "T1569", "comment": "CVE-2024-41030 - This technique is used to gather information about the system and directories, which can be used to exploit the vulnerability."}, {"techniqueID": "T1190", "comment": "CVE-2024-41030 - This technique is used to create a backdoor or hidden access point to the system, which can be used to gain unauthorized access."}], "stix_bundle": {"version": "2.1", "type": "bundle", "id": "CVE-2024-41030-bundle", "description": "STIX Bundle for CVE-2024-41030", "objects": [{"type": "indestructible", "id": "in-1", "description": "Indestructible Object for CVE-2024-41030"}, {"type": "marker", "id": "m-1", "description": "Marker for CVE-2024-41030"}, {"type": "relationship", "id": "r-1", "description": "Relationship between CVE-2024-41030 and techniques", "source_ref": "CVE-2024-41030", "target_ref": "T1210", "relationship": "exploits"}, {"type": "relationship", "id": "r-2", "description": "Relationship between CVE-2024-41030 and techniques", "source_ref": "CVE-2024-41030", "target_ref": "T1086", "relationship": "exploits"}, {"type": "course-of-action", "id": "coa-1", "description": "Course of Action for mitigating CVE-2024-41030", " tactic_refs": [{"id": "T1210", "confidence": 0.8}], "note": "Implement additional access controls to prevent unauthorized directory access."}]}, "technical_analysis": {"Introduction": "The CVE-2024-41030 vulnerability is a remote code execution vulnerability in the Linux kernel that allows an attacker to gain write access to a directory.", "Impact and Scope": "The impact of this vulnerability is considered high, with a CVSS score of 9.8. The attack vector is remote and can be mitigated using additional access controls.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1210, T1086, T1569, and T1190.", "Technical Details": "The vulnerability is caused by a race condition in the Linux kernel that can be exploited by an attacker to gain write access to a directory.", "Detection": "The vulnerability can be detected using system logs and network traffic analysis.", "Mitigation": "The vulnerability can be mitigated by implementing additional access controls to prevent unauthorized directory access.", "Conclusion": "In conclusion, the CVE-2024-41030 vulnerability is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2024-41030 vulnerability is a remote code execution vulnerability in the Linux kernel that allows an attacker to gain write access to a directory.", "Business Impact": "The business impact of this vulnerability is significant, with potential data breaches and system compromise.", "Technical Impact": "The technical impact of this vulnerability is high, with potential system crashes and data corruption.", "Mitigation Strategies": "The recommended mitigation strategies are to implement additional access controls to prevent unauthorized directory access and to patch the kernel to fix the vulnerability.", "Recommendations": "Executive-level recommendations include prioritizing patching and implementing additional access controls to prevent unauthorized directory access.", "Conclusions": "In conclusion, it is recommended that executives prioritize patching and implementing additional access controls to prevent unauthorized directory access."}}