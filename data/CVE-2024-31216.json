{"id": "CVE-2024-31216", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-15T16:15:10.097", "lastModified": "2024-05-15T16:40:19.330", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The source-controller is a Kubernetes operator, specialised in artifacts acquisition from external sources such as Git, OCI, Helm repositories and S3-compatible buckets. The source-controller implements the source.toolkit.fluxcd.io API and is a core component of the GitOps toolkit. Prior to version 1.2.5, when source-controller was configured to use an Azure SAS token when connecting to Azure Blob Storage, the token was logged along with the Azure URL when the controller encountered a connection error. An attacker with access to the source-controller logs could use the token to gain access to the Azure Blob Storage until the token expires. This vulnerability was fixed in source-controller v1.2.5. There is no workaround for this vulnerability except for using a different auth mechanism such as Azure Workload Identity."}, {"lang": "es", "value": "El controlador de fuente es un operador de Kubernetes, especializado en la adquisici\u00f3n de artefactos de fuentes externas como Git, OCI, repositorios Helm y dep\u00f3sitos compatibles con S3. El controlador de fuente implementa la API source.toolkit.fluxcd.io y es un componente central del kit de herramientas GitOps. Antes de la versi\u00f3n 1.2.5, cuando el controlador de origen se configuraba para usar un token SAS de Azure al conectarse a Azure Blob Storage, el token se registraba junto con la direcci\u00f3n URL de Azure cuando el controlador encontraba un error de conexi\u00f3n. Un atacante con acceso a los registros del controlador de origen podr\u00eda usar el token para obtener acceso a Azure Blob Storage hasta que caduque el token. Esta vulnerabilidad se solucion\u00f3 en el controlador de fuente v1.2.5. No existe ninguna soluci\u00f3n para esta vulnerabilidad excepto el uso de un mecanismo de autenticaci\u00f3n diferente, como Azure Workload Identity."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.5, "impactScore": 2.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-532"}]}], "references": [{"url": "https://github.com/fluxcd/source-controller/commit/915d1a072a4f37dd460ba33079dc094aa6e72fa9", "source": "security-advisories@github.com"}, {"url": "https://github.com/fluxcd/source-controller/pull/1430", "source": "security-advisories@github.com"}, {"url": "https://github.com/fluxcd/source-controller/security/advisories/GHSA-v554-xwgw-hc3w", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1584.001", "comment": "CVE-2024-31216 - Logging sensitive data, Azure SAS token exposure, and potential abuse. This technique is relevant for attackers who try to gain unauthorized access to Azure Blob Storage data."}, {"techniqueID": "T1059.007", "comment": "CVE-2024-31216 - Exfiltration of data, Azure SAS token compromise. This technique is relevant for attackers who try to extract sensitive data from Azure Blob Storage."}, {"techniqueID": "T1190", "comment": "CVE-2024-31216 - Authorization flaws, Azure SAS token exposure. This technique is relevant for attackers who try to bypass authorization checks and access Azure Blob Storage data."}, {"techniqueID": "T1083", "comment": "CVE-2024-31216 - File and directory discovery, Azure Blob Storage access. This technique is relevant for attackers who try to discover and access Azure Blob Storage data."}], "stix_bundle": {"$schema": "https://docs.oasis-open.org/openscapesecurity/stix/v2.1/stix-2.1.xsd", "STIX_Header": {"Title": "CVE-2024-31216", "Handle": "cve:CVE-2024-31216", "Id": "cve-CVE-2024-31216-1", "Created_By": "security-advisories@github.com"}, "Vulnerability": {"Type": "vulnerability", "Id": "cve-CVE-2024-31216-1", "Description": [{"lang": "en", "Value": "The source-controller is a Kubernetes operator, specialised in artifacts acquisition from external sources such as Git, OCI, Helm repositories and S3-compatible buckets. The source-controller implements the source.toolkit.fluxcd.io API and is a core component of the GitOps toolkit. Prior to version 1.2.5, when source-controller was configured to use an Azure SAS token when connecting to Azure Blob Storage, the token was logged along with the Azure URL when the controller encountered a connection error. An attacker with access to the source-controller logs could use the token to gain access to the Azure Blob Storage until the token expires. This vulnerability was fixed in source-controller v1.2.5."}]}, "Related_Indicators": {"Indicator": [{"id": "related-indicator-1", "type": "vulnerability-indicator", "title": "Azure SAS Token Exposure", "description": [{"lang": "en", "Value": "Exposure of Azure SAS token in source-controller logs which can be used to access Azure Blob Storage"}]}]}, "Courses_of_Action": {"Course_of_Action": [{"id": "course-of-action-1", "type": "mitigation", "title": "Update to 1.2.5 or later", "description": [{"lang": "en", "Value": "Update the source-controller to version 1.2.5 or later to fix the vulnerability"}]}]}, "Defense_Context": {"Defense_Point": [{"id": "defense-point-1", "type": "logging", "title": "Monitor source-controller logs for Azure SAS token exposure", "description": [{"lang": "en", "Value": "Monitor source-controller logs for Azure SAS token exposure to detect and respond to potential attacks"}]}]}}, "technical_analysis": {"Introduction": "Azure SAS token exposure in source-controller logs prior to version 1.2.5 allows attackers to gain unauthorized access to Azure Blob Storage.", "Impact and Scope": "The attack vector is LOCAL and the impact is LOW with regards to confidentiality and integrity, and NONE with regards to availability.", "Related MITRE ATT&CK Techniques": "T1584.001, T1059.007, T1190, T1083", "Technical Details": "The source-controller logs Azure SAS token when encountering a connection error. An attacker can use this information to access Azure Blob Storage.", "Detection": "Monitor source-controller logs for Azure SAS token exposure.", "Mitigation": "Update the source-controller to version 1.2.5 or later.", "Conclusion": "The vulnerability is fixed in source-controller v1.2.5. It is recommended to update the source-controller and monitor logs for Azure SAS token exposure."}, "executive_analysis": {"Overview": "Azure SAS token exposure in source-controller logs prior to version 1.2.5 allows attackers to gain unauthorized access to Azure Blob Storage.", "Business Impact": "The vulnerability can lead to unauthorized access to sensitive data stored in Azure Blob Storage.", "Technical Impact": "Attackers can use the Azure SAS token to access Azure Blob Storage.", "Mitigation Strategies": "Update the source-controller to version 1.2.5 or later.", "Recommendations": "Implement logging and monitoring to detect Azure SAS token exposure and update the source-controller to version 1.2.5 or later.", "Conclusions": "The vulnerability is fixed in source-controller v1.2.5. It is recommended to update the source-controller and monitor logs for Azure SAS token exposure."}}