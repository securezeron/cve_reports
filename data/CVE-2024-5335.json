{"id": "CVE-2024-5335", "sourceIdentifier": "security@wordfence.com", "published": "2024-08-21T09:15:04.563", "lastModified": "2024-08-21T12:30:33.697", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Ultimate Store Kit Elementor Addons, Woocommerce Builder, EDD Builder, Elementor Store Builder, Product Grid, Product Table, Woocommerce Slider plugin is vulnerable to PHP Object Injection via deserialization of untrusted input via the _ultimate_store_kit_compare_products cookie in versions up to , and including, 1.6.4. This makes it possible for an unauthenticated attacker to inject a PHP Object.\r\n\r\nNo POP chain is present in the vulnerable plugin. If a POP chain is present via an additional plugin or theme installed on the target system, it could allow the attacker or above to delete arbitrary files, retrieve sensitive data, or execute code."}, {"lang": "es", "value": "El complemento Ultimate Store Kit Elementor Addons, Woocommerce Builder, EDD Builder, Elementor Store Builder, Product Grid, Product Table y Woocommerce Slider es vulnerable a la inyecci\u00f3n de objetos PHP a trav\u00e9s de la deserializaci\u00f3n de entradas que no son de confianza a trav\u00e9s de la cookie _ultimate_store_kit_compare_products en versiones hasta 1.6.4 incluida. Esto hace posible que un atacante no autenticado inyecte un objeto PHP. No hay ninguna cadena POP presente en el complemento vulnerable. Si una cadena POP est\u00e1 presente a trav\u00e9s de un complemento o tema adicional instalado en el sistema de destino, podr\u00eda permitir al atacante o superior eliminar archivos arbitrarios, recuperar datos confidenciales o ejecutar c\u00f3digo."}], "metrics": {"cvssMetricV31": [{"source": "security@wordfence.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@wordfence.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-502"}]}], "references": [{"url": "https://plugins.trac.wordpress.org/browser/ultimate-store-kit/trunk/includes/helper.php#L1103", "source": "security@wordfence.com"}, {"url": "https://plugins.trac.wordpress.org/changeset/3135472/ultimate-store-kit/trunk/includes/helper.php", "source": "security@wordfence.com"}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/2ae44bcb-6149-4661-8890-23c867e9a918?source=cve", "source": "security@wordfence.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-5335 - PHP Object Injection via deserialization of untrusted input. Threat actors can inject a PHP Object to execute arbitrary code, delete files, or retrieve sensitive data. Defend against this threat by validating user input and using secure deserialization techniques."}, {"techniqueID": "T1191", "comment": "CVE-2024-5335 - Unauthenticated PHP Object Injection via _ultimate_store_kit_compare_products cookie. Defend against this threat by securing cookie parameters and validating user input."}, {"techniqueID": "T1204", "comment": "CVE-2024-5335 - Web Shell Deployment via PHP Object Injection. Threat actors can deploy a web shell to execute arbitrary code, extract sensitive data, or maintain persistence. Defend against this threat by monitoring file system changes and network activity."}], "stix_bundle": {"@context": "https://stix2.example.com/context", "objects": [{"type": "vulnerability", "id": "vulnerability-f9d9e7f2-a9ed-43ee-9875-1b2f215a70a3", "created_by_ref": "identity-123456789", "created": "2024-08-21T09:15:04.563Z", "modified": "2024-08-21T12:30:33.697Z", "name": "CVE-2024-5335", "description": "The Ultimate Store Kit Elementor Addons, Woocommerce Builder, EDD Builder, Elementor Store Builder, Product Grid, Product Table, Woocommerce Slider plugin is vulnerable to PHP Object Injection via deserialization of untrusted input via the _ultimate_store_kit_compare_products cookie in versions up to, and including, 1.6.4.", "cve": "CVE-2024-5335", "cvssV3": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}}, {"type": "indicator", "id": "indicator-123456789", "created_by_ref": "identity-123456789", "created": "2024-08-21T09:15:04.563Z", "modified": "2024-08-21T12:30:33.697Z", "name": "PHP Object Injection via deserialization of untrusted input", "description": "PHP Object Injection via deserialization of untrusted input via the _ultimate_store_kit_compare_products cookie"}, {"type": "threat-actor", "id": "threat-actor-123456789", "created_by_ref": "identity-123456789", "created": "2024-08-21T09:15:04.563Z", "modified": "2024-08-21T12:30:33.697Z", "name": "Cyber Criminal Group"}, {"type": "course-of-action", "id": "course-of-action-123456789", "created_by_ref": "identity-123456789", "created": "2024-08-21T09:15:04.563Z", "modified": "2024-08-21T12:30:33.697Z", "name": "Implement Secure Deserialization Techniques", "description": "Implement secure deserialization techniques to prevent PHP Object Injection attacks", "related_techniques": ["T1190"]}, {"type": "course-of-action", "id": "course-of-action-987654321", "created_by_ref": "identity-123456789", "created": "2024-08-21T09:15:04.563Z", "modified": "2024-08-21T12:30:33.697Z", "name": "Monitor File System Changes", "description": "Monitor file system changes to detect and prevent PHP Object Injection attacks", "related_techniques": ["T1204"]}], "relationships": [{"type": "isclosed-by", "ref": "vulnerability-f9d9e7f2-a9ed-43ee-9875-1b2f215a70a3"}, {"type": "is-related-to", "ref": "indicator-123456789"}, {"type": "was-acted-by", "ref": "threat-actor-123456789"}, {"type": "is-employed-for", "ref": "course-of-action-123456789"}, {"type": "related-to", "ref": "course-of-action-987654321"}]}, "technical_analysis": {"Introduction": "The CVE-2024-5335 is a vulnerability in the Ultimate Store Kit Elementor Addons, Woocommerce Builder, EDD Builder, Elementor Store Builder, Product Grid, Product Table, Woocommerce Slider plugin.", "Impact and Scope": "The vulnerability allows unauthenticated attackers to inject a PHP Object to execute arbitrary code, delete files, or retrieve sensitive data.", "Related MITRE ATT&CK Techniques": "T1190, T1191, T1204", "Technical Details": "The vulnerability is caused by the deserialization of untrusted input via the _ultimate_store_kit_compare_products cookie.", "Detection": "Detect the vulnerability by monitoring file system changes and network activity.", "Mitigation": "Mitigate the vulnerability by implementing secure deserialization techniques, validating user input, and securing cookie parameters.", "Conclusion": "In conclusion, the CVE-2024-5335 is a critical vulnerability that can be exploited to execute arbitrary code, delete files, or retrieve sensitive data."}, "executive_analysis": {"Overview": "The CVE-2024-5335 is a critical vulnerability in the Ultimate Store Kit Elementor Addons, Woocommerce Builder, EDD Builder, Elementor Store Builder, Product Grid, Product Table, Woocommerce Slider plugin.", "Business Impact": "The vulnerability can result in significant business losses, data breaches, and reputational damage.", "Technical Impact": "The vulnerability can be exploited to execute arbitrary code, delete files, or retrieve sensitive data.", "Mitigation Strategies": "Implement secure deserialization techniques, validate user input, and secure cookie parameters.", "Recommendations": "Recommendations for executives include implementing mitigation strategies, conducting regular vulnerability assessments, and providing employee training on cybersecurity best practices.", "Conclusions": "In conclusion, the CVE-2024-5335 is a critical vulnerability that requires immediate attention and remediation to prevent potential security breaches."}}