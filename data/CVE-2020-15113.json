{"id": "CVE-2020-15113", "sourceIdentifier": "security-advisories@github.com", "published": "2020-08-05T20:15:14.647", "lastModified": "2023-11-07T03:17:25.210", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In etcd before versions 3.3.23 and 3.4.10, certain directory paths are created (etcd data directory and the directory path when provided to automatically generate self-signed certificates for TLS connections with clients) with restricted access permissions (700) by using the os.MkdirAll. This function does not perform any permission checks when a given directory path exists already. A possible workaround is to ensure the directories have the desired permission (700)."}, {"lang": "es", "value": "En etcd versiones anteriores a 3.3.23 y 3.4.10, determinadas rutas de directorio son creadas (directorio de datos de etcd y la ruta de directorio cuando se proporcionaba para generar autom\u00e1ticamente certificados autofirmados para conexiones TLS con clientes) con permisos de acceso restringido (700) usando os.MkdirAll. Esta funci\u00f3n no realiza ninguna comprobaci\u00f3n de permisos cuando una ruta de directorio dada ya existe. Una posible soluci\u00f3n es asegurarse de que los directorios tengan el permiso deseado (700)"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.2}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.5, "impactScore": 5.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:N", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.6}, "baseSeverity": "LOW", "exploitabilityScore": 3.9, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-281"}]}, {"source": "nvd@nist.gov", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-281"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:etcd:etcd:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.3.23", "matchCriteriaId": "60E61F81-923E-4EB5-ABFD-F46AF0978E0B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:etcd:etcd:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.4.0", "versionEndExcluding": "3.4.10", "matchCriteriaId": "6A6101FF-FA05-42EB-AB82-108A9372B8E6"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*", "matchCriteriaId": "36D96259-24BD-44E2-96D9-78CE1D41F956"}]}]}], "references": [{"url": "https://github.com/etcd-io/etcd/security/advisories/GHSA-chh6-ppwq-jh92", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1225", "comment": "CVE-2020-15113 - This technique is relevant in the context of the use of os.MkdirAll, which can be used for directory traversal and privilege escalation. Defending against this vulnerability requires properly configuring permissions and access controls."}, {"techniqueID": "T1134", "comment": "CVE-2020-15113 - This technique is relevant in the context of the use of restricted permissions for directory creation. Defending against this vulnerability requires properly configuring permissions and access controls."}, {"techniqueID": "T1563.2", "comment": "CVE-2020-15113 - This technique is relevant in the context of directory traversal and privilege escalation. Defending against this vulnerability requires properly configuring permissions and access controls."}], "stix_bundle": "{\"@type\": \"malleable-stix-tactics\", \"objects\": [{\"@type\": \"vulnerability\", \"id\": \"CVE-2020-15113\", \"description\": \"In etcd before versions 3.3.23 and 3.4.10, certain directory paths are created (etcd data directory and the directory path when provided to automatically generate self-signed certificates for TLS connections with clients) with restricted access permissions (700) by using the os.MkdirAll. This function does not perform any permission checks when a given directory path exists already.\", \"cwe\": [\"CWE-281\"], \"weaknesses\": [\"CWE-281\"], \"permissions_required\": 700, \"techniques\": [\"T1225\", \"T1134\", \"T1563.2\"]}, {...Object Nodes...}\"]}", "technical_analysis": {"Introduction": "This vulnerability represents a directory traversal and privilege escalation weakness in etcd before versions 3.3.23 and 3.4.10.", "Impact and Scope": "The vulnerability has a CVSS score of 7.1 (HIGH) and an exploitability score of 5.2. The attack vector is LOCAL.", "Related MITRE ATT&CK Techniques": "T1225, T1134, and T1563.2 are related techniques applicable to this vulnerability.", "Technical Details": "The os.MkdirAll function is used to create directories with restricted permissions. This function does not check for existing directory paths, allowing for directory traversal and privilege escalation.", "Detection": "Detection methods include monitoring for abnormal directory creation and access patterns, as well as checking for improper permissions configuration.", "Mitigation": "Mitigation strategies include properly configuring permissions and access controls, as well as restricting directory creation to authorized users and groups.", "Conclusion": "This vulnerability should be treated with high priority and remediated promptly to prevent potential exploitation."}, "executive_analysis": {"Overview": "This is a high-priority vulnerability that requires immediate attention.", "Business Impact": "The vulnerability poses a significant risk to business operations and data integrity.", "Technical Impact": "The vulnerability allows for directory traversal and privilege escalation, leading to potential data breaches and system compromise.", "Mitigation Strategies": "Implement proper permissions and access controls, and restrict directory creation to authorized users and groups.", "Recommendations": "Implement proper security measures and procedures to prevent exploitation, and regularly monitor system activity for abnormal patterns.", "Conclusions": "This vulnerability should be treated with high priority and remediated promptly to prevent potential exploitation."}}