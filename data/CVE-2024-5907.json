{"id": "CVE-2024-5907", "sourceIdentifier": "psirt@paloaltonetworks.com", "published": "2024-06-12T17:15:53.127", "lastModified": "2024-08-07T16:59:29.527", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A privilege escalation (PE) vulnerability in the Palo Alto Networks Cortex XDR agent on Windows devices enables a local user to execute programs with elevated privileges. However, execution does require the local user to successfully exploit a race condition, which makes this vulnerability difficult to exploit."}, {"lang": "es", "value": "Una vulnerabilidad de escalada de privilegios (PE) en el agente Cortex XDR de Palo Alto Networks en dispositivos Windows permite a un usuario local ejecutar programas con privilegios elevados. Sin embargo, la ejecuci\u00f3n requiere que el usuario local aproveche con \u00e9xito una condici\u00f3n de ejecuci\u00f3n, lo que hace que esta vulnerabilidad sea dif\u00edcil de explotar."}], "metrics": {"cvssMetricV40": [{"source": "psirt@paloaltonetworks.com", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:L/AC:H/AT:N/PR:L/UI:N/VC:N/VI:L/VA:N/SC:H/SI:H/SA:H/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:N/R:U/V:D/RE:M/U:Amber", "attackVector": "LOCAL", "attackComplexity": "HIGH", "attackRequirements": "NONE", "privilegesRequired": "LOW", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "NONE", "vulnerableSystemIntegrity": "LOW", "vulnerableSystemAvailability": "NONE", "subsequentSystemConfidentiality": "HIGH", "subsequentSystemIntegrity": "HIGH", "subsequentSystemAvailability": "HIGH", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NO", "recovery": "USER", "valueDensity": "DIFFUSE", "vulnerabilityResponseEffort": "MODERATE", "providerUrgency": "AMBER", "baseScore": 5.2, "baseSeverity": "MEDIUM"}}], "cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.0, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.0, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "psirt@paloaltonetworks.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-269"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:paloaltonetworks:cortex_xdr_agent:*:*:*:*:critical_environment:*:*:*", "versionStartIncluding": "7.9", "versionEndExcluding": "7.9.102", "matchCriteriaId": "E7510DB5-E41B-484D-8BE8-12F7BECA18C6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:paloaltonetworks:cortex_xdr_agent:*:*:*:*:*:*:*:*", "versionStartIncluding": "8.1", "versionEndExcluding": "8.2.3", "matchCriteriaId": "84B436C7-8804-4860-BA71-F9052BD339F6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:paloaltonetworks:cortex_xdr_agent:*:*:*:*:*:*:*:*", "versionStartIncluding": "8.3", "versionEndExcluding": "8.3.1", "matchCriteriaId": "12439BD7-6910-403C-B970-AE14A841DEBD"}]}]}], "references": [{"url": "https://security.paloaltonetworks.com/CVE-2024-5907", "source": "psirt@paloaltonetworks.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1078", "comment": "CVE-2024-5907 - Exploitation of a privilege escalation vulnerability in the Palo Alto Networks Cortex XDR agent, requiring local user interaction and potentially high attack complexity."}, {"techniqueID": "T1190", "comment": "CVE-2024-5907 - Exploitation of a race condition to execute programs with elevated privileges, potentially requiring successful interaction with a user and having a low attack complexity."}, {"techniqueID": "T1204", "comment": "CVE-2024-5907 - Execution of programs with elevated privileges, potentially with the same attack vector as T1078 and T1190."}], "stix_bundle": {"objects": [{"id": "vulnerability:26734565", "type": "vulnerability", "name": "CVE-2024-5907", "description": "A privilege escalation vulnerability in the Palo Alto Networks Cortex XDR agent on Windows devices enables a local user to execute programs with elevated privileges.", "relationships": [{"type": "related_technique", "object_ref": "technique:T1078", "relationship": "exploited"}, {"type": "related_technique", "object_ref": "technique:T1190", "relationship": "exploited"}, {"type": "related_technique", "object_ref": "technique:T1204", "relationship": "exploited"}]}, {"id": "technique:T1078", "type": "technique", "name": "OS Credential Dumping", "description": "The adversary attempts to obtain valid credentials from the operating system."}, {"id": "technique:T1190", "type": "technique", "name": "Exploit Public-Facing Application", "description": "The adversary identifies a publicly facing application that can be exploited."}, {"id": "technique:T1204", "type": "technique", "name": "User Execution", "description": "The adversary tries to get the user to execute a malicious file."}]}, "technical_analysis": {"Introduction": "The CVE-2024-5907 is a privilege escalation vulnerability in the Palo Alto Networks Cortex XDR agent on Windows devices, which allows a local user to execute programs with elevated privileges.", "Impact and Scope": "This vulnerability has a CVSS score of 5.2 and an attack vector of LOCAL, requiring a local user interaction and potentially high attack complexity.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1078, T1190, and T1204, which all relate to the exploitation and execution of a privilege escalation vulnerability.", "Technical Details": "The vulnerability is related to a race condition in the Cortex XDR agent's privilege escalation mechanism, which can be exploited by a local user.", "Detection": "Detection methods include monitoring for abnormal system behavior, such as unexpected program execution, and analyzing system logs for signs of privilege escalation.", "Mitigation": "Mitigation strategies include updating the Cortex XDR agent to the latest version, implementing least privilege principles, and monitoring system behavior for signs of privilege escalation.", "Conclusion": "The CVE-2024-5907 is a serious privilege escalation vulnerability in the Palo Alto Networks Cortex XDR agent, and it is essential to take measures to mitigate its impact."}, "executive_analysis": {"Overview": "The CVE-2024-5907 is a vulnerability in the Palo Alto Networks Cortex XDR agent that allows a local user to execute programs with elevated privileges.", "Business Impact": "This vulnerability has significant business implications, as it allows attackers to execute programs with elevated privileges, potentially leading to unauthorized activity.", "Technical Impact": "The vulnerability has technical implications, as it requires a local user interaction and potentially high attack complexity, making it a high-risk threat.", "Mitigation Strategies": "Mitigation strategies include updating the Cortex XDR agent, implementing least privilege principles, and monitoring system behavior.", "Recommendations": "We recommend immediate action to update the Cortex XDR agent and to implement least privilege principles to minimize the risk associated with this vulnerability.", "Conclusions": "The CVE-2024-5907 is a serious vulnerability that requires immediate attention to mitigate its impact. It is essential to take proactive measures to prevent its exploitation."}}