{"id": "CVE-2024-24754", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-01T16:17:14.877", "lastModified": "2024-02-09T01:56:35.890", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Bref enable serverless PHP on AWS Lambda. When Bref is used with the Event-Driven Function runtime and the handler is a `RequestHandlerInterface`, then the Lambda event is converted to a PSR7 object. During the conversion process, if the request is a MultiPart, each part is parsed and its content added in the `$files` or `$parsedBody` arrays. The conversion process produces a different output compared to the one of plain PHP when keys ending with and open square bracket ([) are used. Based on the application logic the difference in the body parsing might lead to vulnerabilities and/or undefined behaviors. This vulnerability is patched in 2.1.13."}, {"lang": "es", "value": "Bref habilita PHP sin servidor en AWS Lambda. Cuando se usa Bref con el tiempo de ejecuci\u00f3n de la funci\u00f3n controlada por eventos y el controlador es \"RequestHandlerInterface\", el evento Lambda se convierte en un objeto PSR7. Durante el proceso de conversi\u00f3n, si la solicitud es MultiPart, cada parte se analiza y su contenido se agrega en las matrices `$files` o `$parsedBody`. El proceso de conversi\u00f3n produce un resultado diferente en comparaci\u00f3n con el de PHP simple cuando se utilizan claves que terminan en un corchete abierto ([). Seg\u00fan la l\u00f3gica de la aplicaci\u00f3n, la diferencia en el an\u00e1lisis del cuerpo podr\u00eda generar vulnerabilidades y/o comportamientos indefinidos. Esta vulnerabilidad est\u00e1 parcheada en 2.1.13."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.7, "baseSeverity": "LOW"}, "exploitabilityScore": 2.2, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-436"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mnapoli:bref:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.1.13", "matchCriteriaId": "D8473D9F-5007-4ADC-B256-FD331BB522A0"}]}]}], "references": [{"url": "https://github.com/brefphp/bref/commit/c77d9f5abf021f29fa96b5720b7b84adbd199092", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/brefphp/bref/security/advisories/GHSA-82vx-mm6r-gg8w", "source": "security-advisories@github.com", "tags": ["Exploit", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-24754 - This technique involves conversion of the Lambda event to a PSR7 object, which could be exploited by an attacker to inject malicious data into the application."}, {"techniqueID": "T1132", "comment": "CVE-2024-24754 - This technique involves exploitation of the difference in the body parsing produced by the conversion process, which could lead to vulnerabilities and undefined behaviors."}, {"techniqueID": "T1569", "comment": "CVE-2024-24754 - This technique involves exploitation of the ability to inject malicious data into the application through the Event-Driven Function runtime and the handler being a RequestHandlerInterface."}, {"techniqueID": "T1185", "comment": "CVE-2024-24754 - This technique involves exploitation of the vulnerability by an attacker to gain unauthorized access to the system or data."}, {"techniqueID": "T1191", "comment": "CVE-2024-24754 - This technique involves exploitation of the vulnerability by an attacker to create a backdoor or trapdoor in the system or data."}, {"techniqueID": "T1194", "comment": "CVE-2024-24754 - This technique involves exploitation of the vulnerability by an attacker to create a file or data persistence."}], "stix_bundle": {"type": "bundle", "id": "cve-2024-24754", "name": "CVE-2024-24754 STIX Bundle", "created_by_ref": "https://stix2.readthedocs.io/en/latest/objects/bundle/", "modified": "2024-02-09T01:56:35.890", "objects": [{"type": "incident", "id": "incident-1", "name": "CVE-2024-24754 Incident", "created_by_ref": "https://stix2.readthedocs.io/en/latest/objects/indicator/", "modified": "2024-02-09T01:56:35.890", "first_seen": "2024-02-01T16:17:14.877", "last_seen": "2024-02-09T01:56:35.890", "title": "CVE-2024-24754 Incident", "description": "This incident represents the exploitation of the CVE-2024-24754 vulnerability.", "related_object": {"type": "vulnerability", "id": "vulnerability-1", "name": "CVE-2024-24754 Vulnerability", "description": "This vulnerability represents the CVE-2024-24754 vulnerability."}}, {"type": "vulnerability", "id": "vulnerability-1", "name": "CVE-2024-24754 Vulnerability", "description": "This vulnerability represents the CVE-2024-24754 vulnerability."}, {"type": "threat_actor", "id": "threat-actor-1", "name": "Malicious Actor", "description": "This threat actor is responsible for exploiting the CVE-2024-24754 vulnerability."}, {"type": "course_of_action", "id": "course-of-action-1", "name": "Mitigate CVE-2024-24754 Vulnerability", "description": "This course of action represents the mitigation of the CVE-2024-24754 vulnerability."}, {"type": "note", "id": "note-1", "name": "Note on CVE-2024-24754 Vulnerability", "description": "This note represents additional information on the CVE-2024-24754 vulnerability.", "related_object": {"type": "vulnerability", "id": "vulnerability-1", "name": "CVE-2024-24754 Vulnerability", "description": "This vulnerability represents the CVE-2024-24754 vulnerability."}}], "relationships": [{"type": "related_to", "id": "related-1", "source_ref": "incident-1", "target_ref": "vulnerability-1"}, {"type": "compromised_by", "id": "compromised-by-1", "source_ref": "vulnerability-1", "target_ref": "threat-actor-1"}, {"type": "mitigated_by", "id": "mitigated-by-1", "source_ref": "vulnerability-1", "target_ref": "course-of-action-1"}, {"type": "notes", "id": "notes-1", "source_ref": "vulnerability-1", "target_ref": "note-1"}]}, "technical_analysis": {"Introduction": "The CVE-2024-24754 vulnerability is an exploitable weakness in the Bref PHP framework that allows an attacker to inject malicious data into the application.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and is considered critical, as it allows an attacker to gain unauthorized access to the system and data.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques involve conversion of the Lambda event to a PSR7 object, exploitation of the difference in the body parsing produced by the conversion process, and exploitation of the ability to inject malicious data into the application.", "Technical Details": "The vulnerability is caused by the conversion of the Lambda event to a PSR7 object, which can be exploited by an attacker to inject malicious data into the application.", "Detection": "Detection of the vulnerability can be done by using a web application scanner or a code review tool to identify the vulnerability.", "Mitigation": "Mitigation of the vulnerability can be done by patching the Bref PHP framework to version 2.1.13 or later.", "Conclusion": "The vulnerability is a serious threat to the security of the application, and immediate action should be taken to patch the vulnerability and prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2024-24754 vulnerability is a critical vulnerability in the Bref PHP framework that allows an attacker to inject malicious data into the application.", "Business Impact": "The vulnerability has significant business impact, as it can allow an attacker to gain unauthorized access to the system and data, which can result in financial loss, reputational damage, and compromise of sensitive information.", "Technical Impact": "The vulnerability has technical impact, as it can allow an attacker to inject malicious data into the application, which can result in compromise of the system and data.", "Mitigation Strategies": "The mitigation strategies for the vulnerability include patching the Bref PHP framework to version 2.1.13 or later, disabling the vulnerable functionality, and implementing additional security controls such as web application firewalls and intrusion detection systems.", "Recommendations": "Recommendations for executives include conducting a thorough risk assessment to determine the potential impact of the vulnerability, developing a plan to mitigate the vulnerability, and implementing additional security controls to prevent exploitation.", "Conclusions": "In conclusion, the CVE-2024-24754 vulnerability is a critical vulnerability that requires immediate attention and mitigation. It is recommended that executives take immediate action to patch the vulnerability and prevent exploitation."}}