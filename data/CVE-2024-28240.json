{"id": "CVE-2024-28240", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-25T17:15:49.010", "lastModified": "2024-04-25T17:24:59.967", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The GLPI Agent is a generic management agent. A vulnerability that only affects GLPI-Agent installed on windows via MSI packaging can allow a local user to cause denial of agent service by replacing GLPI server url with a wrong url or disabling the service. Additionally, in the case the Deploy task is installed, a local malicious user can trigger privilege escalation configuring a malicious server providing its own deploy task payload. GLPI-Agent 1.7.2 contains a patch for this issue. As a workaround, edit GLPI-Agent related key under `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall` and add `SystemComponent` DWORD value setting it to `1` to hide GLPI-Agent from installed applications."}, {"lang": "es", "value": "El Agente GLPI es un agente de gesti\u00f3n gen\u00e9rico. Una vulnerabilidad que solo afecta al GLPI-Agent instalado en Windows a trav\u00e9s del paquete MSI puede permitir que un usuario local provoque la denegaci\u00f3n del servicio del agente reemplazando la URL del servidor GLPI con una URL incorrecta o deshabilitando el servicio. Adem\u00e1s, en el caso de que se instale la tarea de implementaci\u00f3n, un usuario malicioso local puede desencadenar una escalada de privilegios configurando un servidor malicioso que proporcione su propio payload de la tarea de implementaci\u00f3n. GLPI-Agent 1.7.2 contiene un parche para este problema. Como workaround, edite la clave relacionada con GLPI-Agent en `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall` y agregue el valor DWORD `SystemComponent` configur\u00e1ndolo en `1` para ocultar GLPI-Agent de las aplicaciones instaladas."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.3, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "https://github.com/glpi-project/glpi-agent/commit/41bbb1169e899bd15350a9e2fdbf9269a3b7a14f", "source": "security-advisories@github.com"}, {"url": "https://github.com/glpi-project/glpi-agent/security/advisories/GHSA-hx3x-mmqg-h3jp", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1063", "comment": "CVE-2024-28240 - This relates to the exploitation of a vulnerability in GLPI-Agent, where a local user can cause denial of service by replacing the GLPI server URL with a wrong URL or disabling the service. This technique is relevant for malicious actors trying to escalate privileges within a local system."}, {"techniqueID": "T1000", "comment": "CVE-2024-28240 - This relates to the exploitation of a vulnerability in GLPI-Agent, where a local user can cause escalation of privileges by configuring a malicious server providing a deploy task payload. This technique is relevant for malicious actors trying to gain control of a local system."}, {"techniqueID": "T1134", "comment": "CVE-2024-28240 - This relates to the exploitation of a vulnerability in GLPI-Agent, where a local user can cause denial of service by replacing the GLPI server URL with a wrong URL or disabling the service. This technique is relevant for malicious actors trying to disrupt system operations."}], "stix_bundle": {"@stix_schema_version": "2.1", "objects": [{"type": "attack-pattern", "id": "attack-pattern--8f12e5d6-b6c2-4bb1-af12-fa3d4d14e09e", "name": "Denial of Service via GLPI Server URL Manipulation"}, {"type": "attack-pattern", "id": "attack-pattern--6a41be1e-6f75-4c03-a25c-f1a4dd4c0bc5", "name": "Privilege Escalation via Malicious Deploy Task Payload"}, {"type": "indicator", "id": "indicator--5a19c9d3-5ba5-49f2-8c13-ae5b2a94a6b9", "name": "GLPI-Agent Misconfigured Server URL Indicator"}, {"type": "course-of-action", "id": "course-of-action--54298ce1-f1e0-4eef-a9d9-ebd5f75b85fc", "name": "Mitigate GLPI-Agent Denial of Service via Correct Server URL Configuration"}, {"type": "course-of-action", "id": "course-of-action--f5f7c4dd-03a3-4b84-93a5-cf5b016c5eba", "name": "Mitigate GLPI-Agent Privilege Escalation via Secure Deploy Task Payload"}], "relationships": [{"type": "relates", "id": "relationship--f54a944e-4f3c-4c5f-a8c9-d4c6eaf5b6c3", "target_ref": "attack-pattern--8f12e5d6-b6c2-4bb1-af12-fa3d4d14e09e", "source_ref": "vulnerability--5c44f7c5-e8fd-4daa-96ee-4a79a3e1f44f"}, {"type": "relates", "id": "relationship--55c1e0e2-64e3-4af4-a352-a1a3a1a6cf0d", "target_ref": "attack-pattern--6a41be1e-6f75-4c03-a25c-f1a4dd4c0bc5", "source_ref": "vulnerability--5c44f7c5-e8fd-4daa-96ee-4a79a3e1f44f"}, {"type": "indicated-by", "id": "relationship--9c77a7c9-61b4-4a3d-aa1e-d7e6bbecf5c8", "target_ref": "indicator--5a19c9d3-5ba5-49f2-8c13-ae5b2a94a6b9", "source_ref": "course-of-action--54298ce1-f1e0-4eef-a9d9-ebd5f75b85fc"}, {"type": "indicated-by", "id": "relationship--e7f63f7a-db4c-4a19-be8f-2a151c142cda", "target_ref": "indicator--5a19c9d3-5ba5-49f2-8c13-ae5b2a94a6b9", "source_ref": "course-of-action--f5f7c4dd-03a3-4b84-93a5-cf5b016c5eba"}, {"type": "mitigated-by", "id": "relationship--f5f7c4dd-03a3-4b84-93a5-cf5b016c5eba", "target_ref": "course-of-action--54298ce1-f1e0-4eef-a9d9-ebd5f75b85fc", "source_ref": "vulnerability--5c44f7c5-e8fd-4daa-96ee-4a79a3e1f44f"}]}, "technical_analysis": {"Introduction": "GLPI-Agent vulnerability CVE-2024-28240 allows local users to cause denial of service or privilege escalation by manipulating the GLPI server URL.", "Impact and Scope": "The vulnerability has a CVSS score of 7.3, with an attack vector of LOCAL and a required user interaction.", "Related MITRE ATT&CK Techniques": "T1063, T1000, and T1134", "Technical Details": "The vulnerability allows an attacker to manipulate the GLPI server URL, causing denial of service or privilege escalation.", "Detection": "The vulnerability can be detected by monitoring system logs for suspicious GLPI server URL changes.", "Mitigation": "The vulnerability can be mitigated by configuring the GLPI server URL correctly and implementing secure deploy task payloads.", "Conclusion": "The GLPI-Agent vulnerability CVE-2024-28240 poses a significant threat to local systems and must be prioritized for mitigation."}, "executive_analysis": {"Overview": "The GLPI-Agent vulnerability CVE-2024-28240 poses a significant threat to local systems, allowing attackers to cause denial of service or privilege escalation.", "Business Impact": "The vulnerability can have a significant impact on business operations, including system downtime and data breaches.", "Technical Impact": "The vulnerability can give attackers control over local systems, allowing them to execute malicious commands and steal sensitive data.", "Mitigation Strategies": "Implementing secure deploy task payloads and configuring the GLPI server URL correctly can help mitigate the vulnerability.", "Recommendations": "Prioritize vulnerability remediation and implement regular system monitoring to detect and prevent attacks.", "Conclusions": "The GLPI-Agent vulnerability CVE-2024-28240 requires immediate attention and prioritization for mitigation to prevent potential threats to local systems."}}