{"id": "CVE-2024-6760", "sourceIdentifier": "secteam@freebsd.org", "published": "2024-08-12T13:38:40.447", "lastModified": "2024-08-13T15:08:51.977", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A logic bug in the code which disables kernel tracing for setuid programs meant that tracing was not disabled when it should have, allowing unprivileged users to trace and inspect the behavior of setuid programs.\n\nThe bug may be used by an unprivileged user to read the contents of files to which they would not otherwise have access, such as the local password database."}, {"lang": "es", "value": "Un error l\u00f3gico en el c\u00f3digo que deshabilita el rastreo del kernel para programas setuid signific\u00f3 que el rastreo no se deshabilit\u00f3 cuando deber\u00eda haberlo hecho, permitiendo a los usuarios sin privilegios rastrear e inspeccionar el comportamiento de los programas setuid. Un usuario sin privilegios puede utilizar el error para leer el contenido de archivos a los que de otro modo no tendr\u00eda acceso, como la base de datos de contrase\u00f1as local."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:*:*:*:*:*:*:*:*", "versionEndExcluding": "13.0", "matchCriteriaId": "18A4E85D-70A5-4382-AAB7-4A531615613D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:*:*:*:*:*:*:*:*", "versionStartIncluding": "13.1", "versionEndExcluding": "13.3", "matchCriteriaId": "FEC367A5-24D1-414E-BC77-07968E787D01"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:p1:*:*:*:*:*:*", "matchCriteriaId": "ABEA48EC-24EA-4106-9465-CE66B938635F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:p2:*:*:*:*:*:*", "matchCriteriaId": "8DFB5BD0-E777-4CAA-B2E0-3F3357D06D01"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:p3:*:*:*:*:*:*", "matchCriteriaId": "BC8C769C-A23E-4F61-AC42-4DA64421B096"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:13.3:p4:*:*:*:*:*:*", "matchCriteriaId": "45B0589E-2E7D-4516-A8A0-88F30038EAB0"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:beta5:*:*:*:*:*:*", "matchCriteriaId": "DB7B021E-F4AD-44AC-96AB-8ACAF8AB1B88"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p1:*:*:*:*:*:*", "matchCriteriaId": "69A72B5A-2189-4700-8E8B-1E5E7CA86C40"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p2:*:*:*:*:*:*", "matchCriteriaId": "5771F187-281B-4680-B562-EFC7441A8F88"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p3:*:*:*:*:*:*", "matchCriteriaId": "0A4437F5-9DDA-4769-974E-23BFA085E0DB"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p4:*:*:*:*:*:*", "matchCriteriaId": "A9C3A3D4-C9F4-41EB-B532-821AF83470B1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p5:*:*:*:*:*:*", "matchCriteriaId": "878A1F0A-087F-47D7-9CA5-A54BB8D6676A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p6:*:*:*:*:*:*", "matchCriteriaId": "CE73CDC3-B5A7-4921-89C6-8F9DC426CB3E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p7:*:*:*:*:*:*", "matchCriteriaId": "50A5E650-31FB-45BE-8827-641B58A83E45"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:p8:*:*:*:*:*:*", "matchCriteriaId": "D59CFDD3-AEC3-43F1-A620-0B1F0BAD9048"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:rc3:*:*:*:*:*:*", "matchCriteriaId": "038E5B85-7F60-4D71-8D3F-EDBF6E036CE0"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.0:rc4-p1:*:*:*:*:*:*", "matchCriteriaId": "BF309824-D379-4749-A1FA-BCB2987DD671"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.1:p1:*:*:*:*:*:*", "matchCriteriaId": "AA813990-8C8F-4EE8-9F2B-9F73C510A7B2"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:14.1:p2:*:*:*:*:*:*", "matchCriteriaId": "D4DFA201-27D5-4C01-B90F-E24778943C3B"}]}]}], "references": [{"url": "https://security.freebsd.org/advisories/FreeBSD-SA-24:06.ktrace.asc", "source": "secteam@freebsd.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-6760 - This method uses a setuid program to enable the kernel tracing, which allows an unprivileged user to trace and inspect the behavior of setuid programs. Defending against this is crucial as it could lead to unauthorized access to sensitive information."}, {"techniqueID": "T1017", "comment": "CVE-2024-6760 - The vulnerability is a type of kernel tracing, which could be used for reconnaissance or lateral movement. Defending against this is crucial as it could lead to unauthorized access to sensitive information."}, {"techniqueID": "T1068", "comment": "CVE-2024-6760 - The issue can be exploited by an unprivileged user to access information they are not entitled to. Defending against this is crucial as it could lead to unauthorized access to sensitive information."}, {"techniqueID": "T1027", "comment": "CVE-2024-6760 - The vulnerability can be used for privilege escalation, as an unprivileged user can use this issue to access information they are not entitled to. Defending against this is crucial as it could lead to unauthorized access to sensitive information."}], "stix_bundle": {"@context": "https://stix2.io/v2_CONTEXT", "object_type": "bundle", "id": "bundle--b02d4b36-96ae-4c9b-b346-94d1a5d6bd00", "type": "bundle", "created_by_ref": "user--24c6c24c-ff1c-4a6f-84c4-6f5fac9e5f30", "created": "2024-08-12T13:38:40.447Z", "modified": "2024-08-13T15:08:51.977Z", "objects": [{"id": "vulnerability--cve-2024-6760", "type": "vulnerability", "description": "CVE-2024-6760 - A logic bug in the code which disables kernel tracing for setuid programs meant that tracing was not disabled when it should have, allowing unprivileged users to trace and inspect the behavior of setuid programs.", "reporting_authority_ref": "organization--freebsd.org", "exploit_target": "FreeBSD", "impact": "High", "risk_rating": "Moderate", "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attack_vector": "Network", "attack_complexity": "Low", "privileges_required": "None", "user_interaction": "None", "scope": "Unchanged", "confidentiality_impact": "High", "integrity_impact": "None", "availability_impact": "None", "base_score": 7.5, "base_severity": "High"}, {"id": "course_of_action--mitigation-1", "type": "course_of_action", "description": "Implement kernel tracing for setuid programs", "related_course_of_action_ref": "technique-T1190", "status": "In Progress"}, {"id": "course_of_action--mitigation-2", "type": "course_of_action", "description": "Disable kernel tracing for setuid programs", "related_course_of_action_ref": "technique-T1017", "status": "In Progress"}, {"id": "note--defense-1", "type": "note", "value": "Use secure coding practices when developing kernel tracing code", "lang": "en", "external_id": "defense-strategy"}], " relationships": [{"id": "relationships--mitigation-1-technique-T1190", "type": "relates_to", "object_ref": "course_of_action--mitigation-1", "related_object_ref": "technique--T1190"}, {"id": "relationships--mitigation-2-technique-T1017", "type": "relates_to", "object_ref": "course_of_action--mitigation-2", "related_object_ref": "technique--T1017"}, {"id": "relationships--defense-1-vulnerability--cve-2024-6760", "type": "related_to", "object_ref": "note--defense-1", "related_object_ref": "vulnerability--cve-2024-6760"}]}, "technical_analysis": {"Introduction": "The CVE-2024-6760 vulnerability is a logic bug in the code which disables kernel tracing for setuid programs. This allows unprivileged users to trace and inspect the behavior of setuid programs.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 and a high impact on confidentiality. It affects FreeBSD versions 13.0 and later.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to techniques T1190, T1017, T1068, and T1027.", "Technical Details": "The vulnerability occurs due to a logic bug in the code which disables kernel tracing for setuid programs.", "Detection": "Detection of this vulnerability is challenging as it requires identifying setuid programs and analyzing their behavior.", "Mitigation": "Mitigating this vulnerability requires implementing kernel tracing for setuid programs or disabling kernel tracing for setuid programs.", "Conclusion": "Conclusion: CVE-2024-6760 is a critical vulnerability that requires immediate attention. Implementing kernel tracing for setuid programs is the recommended mitigation strategy."}, "executive_analysis": {"Overview": "The CVE-2024-6760 vulnerability is a critical security issue that affects FreeBSD versions 13.0 and later.", "Business Impact": "The vulnerability could lead to unauthorized access to sensitive information, which could result in financial losses and reputational damage.", "Technical Impact": "The vulnerability is a logic bug in the code which disables kernel tracing for setuid programs.", "Mitigation Strategies": "Implementing kernel tracing for setuid programs or disabling kernel tracing for setuid programs are the recommended mitigation strategies.", "Recommendations": "Executives should prioritize this vulnerability and ensure that developers implement kernel tracing for setuid programs or disable kernel tracing for setuid programs.", "Conclusions": "In conclusion, CVE-2024-6760 is a critical vulnerability that requires immediate attention. Executives should prioritize this and ensure that developers implement kernel tracing for setuid programs or disable kernel tracing for setuid programs."}}