{"id": "CVE-2024-1880", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T19:15:51.703", "lastModified": "2024-06-07T14:56:05.647", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "An OS command injection vulnerability exists in the MacOS Text-To-Speech class MacOSTTS of the significant-gravitas/autogpt project, affecting versions up to v0.5.0. The vulnerability arises from the improper neutralization of special elements used in an OS command within the `_speech` method of the MacOSTTS class. Specifically, the use of `os.system` to execute the `say` command with user-supplied text allows for arbitrary code execution if an attacker can inject shell commands. This issue is triggered when the AutoGPT instance is run with the `--speak` option enabled and configured with `TEXT_TO_SPEECH_PROVIDER=macos`, reflecting back a shell injection snippet. The impact of this vulnerability is the potential execution of arbitrary code on the instance running AutoGPT. The issue was addressed in version 5.1.0."}, {"lang": "es", "value": "Existe una vulnerabilidad de inyecci\u00f3n de comandos del sistema operativo en la clase MacOSTTS Text-To-Speech de MacOS del proyecto significant-gravitas/autogpt, que afecta a las versiones hasta la v0.5.0. La vulnerabilidad surge de la neutralizaci\u00f3n inadecuada de elementos especiales utilizados en un comando del sistema operativo dentro del m\u00e9todo `_speech` de la clase MacOSTTS. Espec\u00edficamente, el uso de `os.system` para ejecutar el comando `say` con texto proporcionado por el usuario permite la ejecuci\u00f3n de c\u00f3digo arbitrario si un atacante puede inyectar comandos de shell. Este problema se activa cuando la instancia de AutoGPT se ejecuta con la opci\u00f3n `--speak` habilitada y configurada con `TEXT_TO_SPEECH_PROVIDER=macos`, lo que refleja un fragmento de inyecci\u00f3n de shell. El impacto de esta vulnerabilidad es la posible ejecuci\u00f3n de c\u00f3digo arbitrario en la instancia que ejecuta AutoGPT. El problema se solucion\u00f3 en la versi\u00f3n 5.1.0."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "references": [{"url": "https://github.com/significant-gravitas/autogpt/commit/26324f29849967fa72c207da929af612f1740669", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/4e742624-8771-4f3c-9634-3eaf33d6d58e", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1204", "comment": "CVE-2024-1880 - OS Command Injection through Text-to-Speech Feature. This technique allows attackers to execute arbitrary OS commands during the processing of user-supplied text, which can lead to code execution or data tampering."}, {"techniqueID": "T1140", "comment": "CVE-2024-1880 - Deobfuscation through Text-to-Speech Feature. This technique involves using the Text-to-Speech feature to obfuscate and then deobfuscate malicious code, which can help evade detection and execution."}, {"techniqueID": "T1190", "comment": "CVE-2024-1880 - Exploit of Text-to-Speech Feature for Code Execution. This technique exploits the Text-to-Speech feature to execute arbitrary code, which can lead to code execution or data tampering."}], "stix_bundle": {"description": "Vulnerability Exploit: Text-to-Speech Feature", "objects": [{"type": "malleable-rcd", "id": "f13f7e24-d630-45a5-8d7b-944c0d6f14a4", "name": "Text-to-Speech Feature Malleable RCD", "objects": [{"type": "stix-core-relationship", "id": "c0f9d6c6-d15d-41bf-9a34-74f44a4d2a7a", "object_ref": "f13f7e24-d630-45a5-8d7b-944c0d6f14a4", "target_ref": "c13f7e24-d630-45a5-8d7b-944c0d6f14a4"}]}, {"type": "stix-cybox-observable", "id": "c13f7e24-d630-45a5-8d7b-944c0d6f14a4", "name": "Text-to-Speech Feature", "properties": {"x_openIOC_data": "{\"platform\": \"MacOS\", \"process-name\": \"say\", \"command\": \"os.system(\\\"say \\{\"", "x_openIOC_type": "Command"}}], "relations": [{"type": "stix-core-relationship", "id": "c0f9d6c6-d15d-41bf-9a34-74f44a4d2a7a", "object_ref": "f13f7e24-d630-45a5-8d7b-944c0d6f14a4", "target_ref": "c13f7e24-d630-45a5-8d7b-944c0d6f14a4"}]}, "technical_analysis": {"Introduction": "The vulnerability exists in the MacOS Text-To-Speech class MacOSTTS of the significant-gravitas/autogpt project, affecting versions up to v0.5.0.", "Impact and Scope": "The vulnerability allows for arbitrary code execution if an attacker can inject shell commands.", "Related MITRE ATT&CK Techniques": "T1204, T1140, and T1190", "Technical Details": "The vulnerability arises from the improper neutralization of special elements used in an OS command within the `_speech` method of the MacOSTTS class.", "Detection": "Detection involves monitoring for suspicious system commands and monitoring for unexpected changes to system settings.", "Mitigation": "Mitigation involves limiting system privileges and implementing strict input validation and sanitization.", "Conclusion": "The vulnerability is exploitable and should be mitigated as soon as possible."}, "executive_analysis": {"Overview": "The vulnerability presents a high-level risk and should be prioritized for remediation.", "Business Impact": "The vulnerability could result in unauthorized data access or modification, which could compromise business operations.", "Technical Impact": "The vulnerability could result in code execution or data tampering, which could compromise system integrity.", "Mitigation Strategies": "Limiting system privileges, implementing strict input validation and sanitization, and monitoring for suspicious system commands are recommended.", "Recommendations": "Executives should prioritize remediation and consider implementing additional security controls to minimize the risk of exploitation.", "Conclusions": "The vulnerability is exploitable and should be mitigated as soon as possible to minimize the risk of exploitation."}}