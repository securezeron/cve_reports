{"id": "CVE-2024-1968", "sourceIdentifier": "security@huntr.dev", "published": "2024-05-20T08:15:08.850", "lastModified": "2024-05-20T13:00:04.957", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In scrapy/scrapy, an issue was identified where the Authorization header is not removed during redirects that only change the scheme (e.g., HTTPS to HTTP) but remain within the same domain. This behavior contravenes the Fetch standard, which mandates the removal of Authorization headers in cross-origin requests when the scheme, host, or port changes. Consequently, when a redirect downgrades from HTTPS to HTTP, the Authorization header may be inadvertently exposed in plaintext, leading to potential sensitive information disclosure to unauthorized actors. The flaw is located in the _build_redirect_request function of the redirect middleware."}, {"lang": "es", "value": " En scrapy/scrapy, se identific\u00f3 un problema por el cual el encabezado Authorization no se elimina durante las redirecciones que solo cambian el esquema (por ejemplo, HTTPS a HTTP) pero permanecen dentro del mismo dominio. Este comportamiento contraviene el est\u00e1ndar Fetch, que exige la eliminaci\u00f3n de encabezados de Autorizaci\u00f3n en solicitudes de origen cruzado cuando cambia el esquema, el host o el puerto. En consecuencia, cuando una redirecci\u00f3n degrada de HTTPS a HTTP, el encabezado de Autorizaci\u00f3n puede quedar expuesto inadvertidamente en texto sin formato, lo que lleva a una posible divulgaci\u00f3n de informaci\u00f3n confidencial a actores no autorizados. La falla se encuentra en la funci\u00f3n _build_redirect_request del middleware de redirecci\u00f3n."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}], "references": [{"url": "https://github.com/scrapy/scrapy/commit/1d0502f25bbe55a22899af915623fda1aaeb9dd8", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/27f6a021-a891-446a-ada5-0226d619dd1a", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-1968 - An unauthorized actor may be able to intercept and read sensitive information due to the failure to remove the Authorization header during redirects, which is a type of exfiltration. Defend against this by enabling strict redirect handling and ensuring that sensitive information is properly encrypted."}, {"techniqueID": "T1046", "comment": "CVE-2024-1968 - An attacker may be able to use the Authorization header to access sensitive information, which is a type of command and control. Defend against this by implementing strict access controls and monitoring for unusual activity."}], "stix_bundle": {"objects": [{"id": "https://example.com/CVE-2024-1968", "type": "Vulnerability", "created_by_ref": "https://example.com/user-1", "modified": "2024-05-20T13:00:04.957", "reported_by_ref": "https://example.com/orphan", "name": "CVE-2024-1968: Unauthorized Information Disclosure in Scrapy", "description": "In scrapy/scrapy, an issue was identified where the Authorization header is not removed during redirects that only change the scheme (e.g., HTTPS to HTTP) but remain within the same domain.", "objects": [{"id": "https://example.com/T1190", "type": "Attack Pattern", "created_by_ref": "https://example.com/user-1", "modified": "2024-05-20T13:00:04.957", "name": "T1190: Exfiltration Over Command and Control Channel", "description": "An unauthorized actor may be able to intercept and read sensitive information due to the failure to remove the Authorization header during redirects.", "spec_id": "https://example.com/T1190"}, {"id": "https://example.com/T1046", "type": "Attack Pattern", "created_by_ref": "https://example.com/user-1", "modified": "2024-05-20T13:00:04.957", "name": "T1046: Web Shell", "description": "An attacker may be able to use the Authorization header to access sensitive information.", "spec_id": "https://example.com/T1046"}], "relations": [{"type": "indicated_by", "id_ref": "https://example.com/T1190"}, {"type": "indicated_by", "id_ref": "https://example.com/T1046"}]}], "courses_of_action": [{"id": "https://example.com/COA-1", "type": "Course of Action", "created_by_ref": "https://example.com/user-1", "modified": "2024-05-20T13:00:04.957", "name": "COA-1: Disable HTTP Redirects", "description": "Disable HTTP redirects in Scrapy to prevent unauthorized access to sensitive information.", "mitigated_by_ref": "https://example.com/T1190", "notes": ["This course of action mitigates technique T1190: Exfiltration Over Command and Control Channel"]}]}, "technical_analysis": {"Introduction": "CVE-2024-1968 is a vulnerability in Scrapy that allows unauthorized access to sensitive information due to the failure to remove the Authorization header during redirects.", "Impact and Scope": "This vulnerability has a CVSS score of 7.5 and an attack vector of NETWORK. It allows an attacker to intercept and read sensitive information.", "Related MITRE ATT&CK Techniques": "T1190: Exfiltration Over Command and Control Channel, T1046: Web Shell", "Technical Details": "The vulnerability is located in the _build_redirect_request function of the redirect middleware.", "Detection": "Monitor for unusual activity and inspect redirects for missing Authorization headers.", "Mitigation": "Enable strict redirect handling and encrypt sensitive information.", "Conclusion": "CVE-2024-1968 is a serious vulnerability that requires immediate attention to prevent unauthorized access to sensitive information."}, "executive_analysis": {"Overview": "CVE-2024-1968 is a vulnerability in Scrapy that allows unauthorized access to sensitive information, which can have significant business impact.", "Business Impact": "This vulnerability can allow unauthorized access to sensitive information, which can result in data breaches and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to intercept and read sensitive information, which can be used to compromise business operations.", "Mitigation Strategies": "Implement strict access controls, encrypt sensitive information, and monitor for unusual activity.", "Recommendations": "Prioritize patching and applying mitigations to prevent unauthorized access to sensitive information.", "Conclusions": "CVE-2024-1968 is a serious vulnerability that requires immediate attention to prevent business impact."}}