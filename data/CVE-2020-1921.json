{"id": "CVE-2020-1921", "sourceIdentifier": "cve-assign@fb.com", "published": "2021-03-10T16:15:14.547", "lastModified": "2021-03-15T15:29:38.527", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the crypt function, we attempt to null terminate a buffer using the size of the input salt without validating that the offset is within the buffer. This issue affects HHVM versions prior to 4.56.3, all versions between 4.57.0 and 4.80.1, all versions between 4.81.0 and 4.93.1, and versions 4.94.0, 4.95.0, 4.96.0, 4.97.0, 4.98.0."}, {"lang": "es", "value": "En la funci\u00f3n crypt, intentamos anular la finalizaci\u00f3n de un b\u00fafer usando el tama\u00f1o de la sal de entrada sin comprobar que el desplazamiento est\u00e9 dentro del b\u00fafer.&#xa0;Este problema afecta a HHVM versiones anteriores a 4.56.3, todas las versiones entre 4.57.0 y 4.80.1, todas las versiones entre 4.81.0 y 4.93.1 y versiones 4.94.0, 4.95.0, 4.96.0, 4.97.0 , 4.98.0"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-787"}]}, {"source": "cve-assign@fb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-121"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:facebook:hhvm:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.56.3", "matchCriteriaId": "069C0B7D-5233-4EFF-BBA7-8B84D9227044"}, {"vulnerable": true, "criteria": "cpe:2.3:a:facebook:hhvm:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.57.0", "versionEndExcluding": "4.80.2", "matchCriteriaId": "59DAD37C-9F51-4BE3-B045-537CA259F7F7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:facebook:hhvm:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.81.0", "versionEndExcluding": "4.93.2", "matchCriteriaId": "3B78720F-AA79-459F-A66C-5C4D67D7EE31"}, {"vulnerable": true, "criteria": "cpe:2.3:a:facebook:hhvm:4.94.0:*:*:*:*:*:*:*", "matchCriteriaId": "1C4B9A3C-6A5A-45C4-A490-C13CF6D6A867"}, {"vulnerable": true, "criteria": "cpe:2.3:a:facebook:hhvm:4.95.0:*:*:*:*:*:*:*", "matchCriteriaId": "18D33DC0-E6A7-4DC6-8E9A-2B85842EC21B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:facebook:hhvm:4.96.0:*:*:*:*:*:*:*", "matchCriteriaId": "B0B9078D-3C25-45B2-B5F2-59585A47BACB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:facebook:hhvm:4.97.0:*:*:*:*:*:*:*", "matchCriteriaId": "7B8F5C11-8610-4099-8A45-E6241F3D24E0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:facebook:hhvm:4.98.0:*:*:*:*:*:*:*", "matchCriteriaId": "47FF13C3-19DC-4F53-BF9D-38AC89D647D5"}]}]}], "references": [{"url": "https://github.com/facebook/hhvm/commit/08193b7f0cd3910256e00d599f0f3eb2519c44ca", "source": "cve-assign@fb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://hhvm.com/blog/2021/02/25/security-update.html", "source": "cve-assign@fb.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1048", "comment": "CVE-2020-1921 - Potential buffer overflow vulnerability in HHVM's crypt function, allowing an attacker to gain unauthorized access and potentially execute arbitrary code. This technique can be used to carry out an exploit leveraging this vulnerability."}, {"techniqueID": "T1210", "comment": "CVE-2020-1921 - HHVM's crypt function allows an attacker to inject arbitrary data into the buffer, which can lead to a buffer overflow. This technique can be used to inject malicious data into the buffer, causing the system to crash or behave unexpectedly."}, {"techniqueID": "T1190", "comment": "CVE-2020-1921 - HHVM's crypt function does not properly validate the size of the input data, allowing an attacker to provide a buffer size that is larger than the allocated buffer. This technique can be used to send a malformed input to the crypt function, causing it to overflow the buffer and potentially allowing arbitrary code execution."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2020-1921", "name": "HHVM Crypt Function Buffer Overflow Vulnerability"}, {"type": "x-mitre-technique", "id": "T1048", "name": "RSPLUGG_Domain_Filter_Client", "description": "Hides the existence of a client on the network by using Domain Name System (DNS) redirection."}, {"type": "x-mitre-technique", "id": "T1210", "name": "Patch_Upload", "description": "Uploads potentially malicious software to a system using a file transfer protocol."}, {"type": "x-mitre-technique", "id": "T1190", "name": "Staged_File_Write", "description": "Writes a file to a system in stages, with each stage consisting of a small amount of data."}], "relationships": [{"relationship": "relates_to", "subject": "CVE-2020-1921", "object": "T1048"}, {"relationship": "relates_to", "subject": "CVE-2020-1921", "object": "T1210"}, {"relationship": "relates_to", "subject": "CVE-2020-1921", "object": "T1190"}]}, "technical_analysis": {"Introduction": "HHVM's crypt function has a buffer overflow vulnerability that can be exploited by an attacker to gain unauthorized access and potentially execute arbitrary code.", "Impact and Scope": "This vulnerability has a CVSS score of 7.5 with a version of 3.1, indicating a high severity impact and scope. The attack vector is network-based.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to MITRE ATT&CK techniques T1048, T1210, and T1190.", "Technical Details": "The vulnerability is caused by HHVM's crypt function not properly validating the size of the input data, allowing an attacker to provide a buffer size that is larger than the allocated buffer.", "Detection": "Detection of this vulnerability may involve monitoring for unusual network traffic patterns or signs of exploitation, such as unexpected system crashes or unusual system behavior.", "Mitigation": "Mitigation strategies include patching the affected HHVM versions, restricting network access to trusted sources, and implementing network segmentation.", "Conclusion": "In conclusion, this vulnerability has a high severity impact and scope, and it is essential to take immediate action to mitigate it."}, "executive_analysis": {"Overview": "The HHVM Crypt Function Buffer Overflow Vulnerability is a high-severity vulnerability that can grant unauthorized access and potentially execute arbitrary code.", "Business Impact": "This vulnerability can have significant business impacts, including data breaches, system crashes, and compromised system integrity.", "Technical Impact": "The technical impact of this vulnerability is the potential for arbitrary code execution, which can lead to data breaches, system crashes, and compromised system integrity.", "Mitigation Strategies": "The recommended mitigation strategies are patching the affected HHVM versions, restricting network access to trusted sources, and implementing network segmentation.", "Recommendations": "Executives should recommend that their IT teams take immediate action to patch the affected HHVM versions, restrict network access to trusted sources, and implement network segmentation.", "Conclusions": "In conclusion, this vulnerability has significant consequences and should be addressed promptly to minimize potential harm."}}