{"id": "CVE-2020-13359", "sourceIdentifier": "cve@gitlab.com", "published": "2020-11-19T00:15:12.277", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Terraform API in GitLab CE/EE 12.10+ exposed the object storage signed URL on the delete operation allowing a malicious project maintainer to overwrite the Terraform state, bypassing audit and other business controls. Affected versions are >=12.10, <13.3.9,>=13.4, <13.4.5,>=13.5, <13.5.2."}, {"lang": "es", "value": "la API Terraform en GitLab CE/EE versi\u00f3n superior a 12.10, expuso la URL firmada de almacenamiento de objetos en la operaci\u00f3n de borrado permitiendo a un mantenedor de proyectos malicioso sobrescribir el estado de Terraform, omitiendo una auditor\u00eda y otros controles de negocios. Las versiones afectadas son versiones posteriores a 12.10 incluy\u00e9ndola, versiones anteriores a 13.3.9, versiones posteriores a 13.4 incluy\u00e9ndola, versiones anteriores a 13.4.5, versiones posteriores a 13.5 incluy\u00e9ndola, versiones anteriores a 13.5.2"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.6, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.3, "impactScore": 4.7}, {"source": "cve@gitlab.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.6, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.3, "impactScore": 4.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "12.10.0", "versionEndExcluding": "13.3.9", "matchCriteriaId": "93E08F95-81D5-4B75-8B33-34339D59ECCC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "12.10.0", "versionEndExcluding": "13.3.9", "matchCriteriaId": "A29D5B2B-05B3-47EE-9519-CBD914002E94"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "13.4.0", "versionEndExcluding": "13.4.5", "matchCriteriaId": "C7D38168-5E74-4B9C-B0DA-9757D19DA5D5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "13.4.0", "versionEndExcluding": "13.4.5", "matchCriteriaId": "E04A3096-9883-4120-ADE4-8CEBE811E242"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "13.5.0", "versionEndExcluding": "13.5.2", "matchCriteriaId": "46B55443-7215-4998-A3D7-6B1014513756"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "13.5.0", "versionEndExcluding": "13.5.2", "matchCriteriaId": "59FA227C-599B-4636-8FD9-71A60D0C8ABC"}]}]}], "references": [{"url": "https://gitlab.com/gitlab-org/cves/-/blob/master/2020/CVE-2020-13359.json", "source": "cve@gitlab.com", "tags": ["Vendor Advisory"]}, {"url": "https://gitlab.com/gitlab-org/gitlab/-/issues/250266", "source": "cve@gitlab.com", "tags": ["Broken Link"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-13359 - The Terraform API exposed the object storage signed URL on the delete operation allowing a malicious project maintainer to overwrite the Terraform state, bypassing audit and other business controls."}, {"techniqueID": "T1078", "comment": "CVE-2020-13359 - A malicious project maintainer can exploit the exposed signed URL to overwrite the Terraform state, allowing for unauthorized changes to be made to the infrastructure."}, {"techniqueID": "T1068", "comment": "CVE-2020-13359 - The vulnerability allows a malicious project maintainer to bypass audit and other business controls, enabling unauthorized changes to be made to the infrastructure."}], "stix_bundle": {"objects": [{"id": "node-1", "type": "vulnerability", "created_by_ref": " Organization:GitLab", "description": "The Terraform API exposed the object storage signed URL on the delete operation allowing a malicious project maintainer to overwrite the Terraform state, bypassing audit and other business controls.", "modified": "2020-11-19T00:15:12.277", "published": "2020-11-19T00:15:12.277", "cvssV3": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:H/A:N"}, "cvssV2": {"vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:N"}, " weaknesses": [{"cwe": "NVD-CWE-noinfo"}], "references": [{"url": "https://gitlab.com/gitlab-org/cves/-/blob/master/2020/CVE-2020-13359.json", "source": "cve@gitlab.com", "tags": ["Vendor Advisory"]}]}], "relationships": [{"from": "node-1", "to": "node-2", "relationship_type": "relates_to"}]}, "technical_analysis": {"Introduction": "The Terraform API in GitLab CE/EE 12.10+ exposed the object storage signed URL on the delete operation allowing a malicious project maintainer to overwrite the Terraform state, bypassing audit and other business controls.", "Impact and Scope": "The vulnerability has a CVSS score of 7.6 and an attack vector of NETWORK. It allows a malicious project maintainer to bypass audit and other business controls, enabling unauthorized changes to be made to the infrastructure.", "Related MITRE ATT&CK Techniques": "T1190, T1078, T1068", "Technical Details": "The vulnerability is caused by the exposure of the object storage signed URL on the delete operation, allowing a malicious project maintainer to overwrite the Terraform state.", "Detection": "Detecting this vulnerability will require monitoring for unusual activity in the Terraform state file.", "Mitigation": "Mitigation strategies include ensuring that only authorized personnel have access to the Terraform state file and implementing additional security controls to prevent unauthorized changes.", "Conclusion": "This vulnerability highlights the importance of ensuring that the Terraform state file is properly secured and monitored."}, "executive_analysis": {"Overview": "The Terraform API in GitLab CE/EE 12.10+ exposed the object storage signed URL on the delete operation, allowing a malicious project maintainer to overwrite the Terraform state, bypassing audit and other business controls.", "Business Impact": "This vulnerability has significant business impact, as it allows a malicious project maintainer to bypass audit and other business controls, enabling unauthorized changes to be made to the infrastructure.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows a malicious project maintainer to overwrite the Terraform state, enabling unauthorized changes to be made to the infrastructure.", "Mitigation Strategies": "Implementing additional security controls to prevent unauthorized changes and ensuring that only authorized personnel have access to the Terraform state file are recommended.", "Recommendations": "It is recommended that organizations implementing Terraform take immediate action to address this vulnerability, as it has significant business and technical impact.", "Conclusions": "In conclusion, this vulnerability highlights the importance of ensuring that the Terraform state file is properly secured and monitored. Organizations must take immediate action to address this vulnerability to prevent unauthorized changes to their infrastructure."}}