{"id": "CVE-2024-7143", "sourceIdentifier": "secalert@redhat.com", "published": "2024-08-07T17:15:52.337", "lastModified": "2024-08-07T19:09:46.290", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A flaw was found in the Pulp package. When a role-based access control (RBAC) object in Pulp is set to assign permissions on its creation, it uses the `AutoAddObjPermsMixin` (typically the add_roles_for_object_creator method). This method finds the object creator by checking the current authenticated user. For objects that are created within a task, this current user is set by the first user with any permissions on the task object. This means the oldest user with model/domain-level task permissions will always be set as the current user of a task, even if they didn't dispatch the task. Therefore, all objects created in tasks will have their permissions assigned to this oldest user, and the creating user will receive nothing."}, {"lang": "es", "value": "Se encontr\u00f3 un defecto en el paquete Pulp. Cuando un objeto de control de acceso basado en roles (RBAC) en Pulp est\u00e1 configurado para asignar permisos en su creaci\u00f3n, utiliza `AutoAddObjPermsMixin` (normalmente el m\u00e9todo add_roles_for_object_creator). Este m\u00e9todo encuentra al creador del objeto verificando el usuario autenticado actual. Para los objetos que se crean dentro de una tarea, este usuario actual lo establece el primer usuario con permisos en el objeto de la tarea. Esto significa que el usuario m\u00e1s antiguo con permisos de tareas a nivel de modelo/dominio siempre se configurar\u00e1 como el usuario actual de una tarea, incluso si no envi\u00f3 la tarea. Por lo tanto, todos los objetos creados en tareas tendr\u00e1n sus permisos asignados a este usuario m\u00e1s antiguo y el usuario creador no recibir\u00e1 nada."}], "metrics": {"cvssMetricV30": [{"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 6.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 5.5}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-277"}]}], "references": [{"url": "https://access.redhat.com/security/cve/CVE-2024-7143", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2300125", "source": "secalert@redhat.com"}, {"url": "https://github.com/pulp/pulpcore/blob/93f241f34c503da0fbac94bdba739feda2636e12/pulpcore/tasking/_util.py#L108", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1016", "comment": "CVE-2024-7143 - This vulnerability can be exploited using the 'Masquerading as System' attack technique, which involves impersonating a valid user to gain unauthorized access."}, {"techniqueID": "T1108", "comment": "CVE-2024-7143 - This vulnerability can also be exploited using the 'Secondary Shell' attack technique, which involves using a malicious shell to execute arbitrary code on the system."}, {"techniqueID": "T1204", "comment": "CVE-2024-7143 - This vulnerability can also be exploited using the 'File and Directory Discovery' attack technique, which involves discovering and exploiting sensitive files and directories on the system."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2024-7143", "description": "A flaw was found in the Pulp package. When a role-based access control (RBAC) object in Pulp is set to assign permissions on its creation, it uses the `AutoAddObjPermsMixin` (typically the add_roles_for_object_creator method). This method finds the object creator by checking the current authenticated user. For objects that are created within a task, this current user is set by the first user with any permissions on the task object. This means the oldest user with model/domain-level task permissions will always be set as the current user of a task, even if they didn't dispatch the task. Therefore, all objects created in tasks will have their permissions assigned to this oldest user, and the creating user will receive nothing.", "severity": "MEDIUM", "cvss": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 6.7, "baseSeverity": "MEDIUM"}}, {"type": "course-of-action", "id": "COA-1", "description": "Update the Pulp package to the latest version.", "technique": "T1016"}, {"type": "course-of-action", "id": "COA-2", "description": "Implement role-based access control (RBAC) to restrict access to sensitive areas of the system.", "technique": "T1108"}, {"type": "course-of-action", "id": "COA-3", "description": "Regularly audit and monitor the system for suspicious activities.", "technique": "T1204"}], "relationship": [{"type": "related-to", "object1": "CVE-2024-7143", "object2": "COA-1"}, {"type": "related-to", "object1": "CVE-2024-7143", "object2": "COA-2"}, {"type": "related-to", "object1": "CVE-2024-7143", "object2": "COA-3"}]}, "technical_analysis": {"Introduction": "A vulnerability was discovered in the Pulp package, which can be exploited to gain unauthorized access to sensitive areas of the system.", "Impact and Scope": "The impact of this vulnerability is HIGH for confidentiality, integrity, and availability. The scope of the vulnerability is limited to the Pulp package and its dependencies.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1016, T1108, and T1204.", "Technical Details": "The vulnerability occurs when the `AutoAddObjPermsMixin` method is used to assign permissions to an object, which can be exploited to impersonate a valid user.", "Detection": "The vulnerability can be detected by monitoring the system for suspicious activities, such as unusual login attempts or changes to sensitive files and directories.", "Mitigation": "The vulnerability can be mitigated by updating the Pulp package to the latest version, implementing role-based access control (RBAC), and regularly auditing and monitoring the system.", "Conclusion": "In conclusion, the vulnerability in the Pulp package can be exploited to gain unauthorized access to sensitive areas of the system. It is essential to update the package and implement mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "A vulnerability was discovered in the Pulp package, which can be exploited to gain unauthorized access to sensitive areas of the system.", "Business Impact": "The vulnerability can result in significant business disruption and financial loss if left unaddressed.", "Technical Impact": "The vulnerability can result in compromise of sensitive data and system resources if exploited.", "Mitigation Strategies": "The recommended mitigation strategies are to update the Pulp package to the latest version, implement role-based access control (RBAC), and regularly audit and monitor the system.", "Recommendations": "Executive stakeholders should prioritize the remediation of this vulnerability and allocate resources to implement mitigation strategies.", "Conclusions": "In conclusion, the vulnerability in the Pulp package poses a significant risk to the organization and requires immediate attention and action."}}