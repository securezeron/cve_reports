{"id": "CVE-2020-7066", "sourceIdentifier": "security@php.net", "published": "2020-04-01T04:15:14.020", "lastModified": "2022-05-08T23:51:59.500", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In PHP versions 7.2.x below 7.2.29, 7.3.x below 7.3.16 and 7.4.x below 7.4.4, while using get_headers() with user-supplied URL, if the URL contains zero (\\0) character, the URL will be silently truncated at it. This may cause some software to make incorrect assumptions about the target of the get_headers() and possibly send some information to a wrong server."}, {"lang": "es", "value": "En las versiones de PHP 7.2.x  anterior a la versi\u00f3n  7.2.29, 7.3.x anterior a 7.3.16 y 7.4.x anterior a 7.4.4, mientras usa get_headers () con la URL suministrada por el usuario, si la URL contiene un car\u00e1cter cero (\\ 0), el La URL se truncar\u00e1 silenciosamente en ella. Esto puede hacer que algunos programas hagan suposiciones incorrectas sobre el objetivo de get_headers () y posiblemente env\u00eden informaci\u00f3n a un servidor incorrecto."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}, {"source": "security@php.net", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}, {"source": "security@php.net", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-170"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.2.0", "versionEndExcluding": "7.2.29", "matchCriteriaId": "A758E148-563D-4E04-A321-71FB7622314F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.3.0", "versionEndExcluding": "7.3.16", "matchCriteriaId": "ECF918F4-EEAF-4F96-A49A-D367D549C52B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.4.0", "versionEndExcluding": "7.4.4", "matchCriteriaId": "F809DF30-2CCC-4E3D-819B-75E5E0827E45"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:tenable:tenable.sc:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.19.0", "matchCriteriaId": "41DBA7C7-8084-45F6-B59D-13A9022C34DF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:tenable:tenable.sc:5.19.0:*:*:*:*:*:*:*", "matchCriteriaId": "0D04D487-429B-4A0F-8B86-EBD355555EDF"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:*", "matchCriteriaId": "B620311B-34A3-48A6-82DF-6F078D7A4493"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2020-05/msg00025.html", "source": "security@php.net", "tags": ["Third Party Advisory"]}, {"url": "https://bugs.php.net/bug.php?id=79329", "source": "security@php.net", "tags": ["Exploit", "Issue Tracking", "Patch", "Vendor Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2020/04/msg00021.html", "source": "security@php.net", "tags": ["Third Party Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20200403-0001/", "source": "security@php.net", "tags": ["Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/4330-2/", "source": "security@php.net", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2020/dsa-4717", "source": "security@php.net", "tags": ["Third Party Advisory"]}, {"url": "https://www.debian.org/security/2020/dsa-4719", "source": "security@php.net", "tags": ["Third Party Advisory"]}, {"url": "https://www.tenable.com/security/tns-2021-14", "source": "security@php.net", "tags": ["Patch", "Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0002", "comment": " CVE-2020-7066 - This vulnerability allows an attacker to leverage the get_headers() function in PHP to manipulate the URL and potentially send sensitive information to an unintended location. This technique can be mitigated by validating user-supplied input and ensuring that the function is not used with untrusted input."}, {"techniqueID": "TA0017", "comment": " CVE-2020-7066 - This vulnerability can be exploited by an attacker to gain unintended access to a system by manipulating the URL and using get_headers(). This technique can be mitigated by ensuring that the function is only used with trusted input and validating user-supplied data."}, {"techniqueID": "TA0020", "comment": " CVE-2020-7066 - This vulnerability allows an attacker to gain additional privileges on a system by manipulating the URL and using get_headers(). This technique can be mitigated by ensuring that the function is only used with trusted input, validating user-supplied data, and limiting privileges."}], "stix_bundle": {"type": "bundle", "id": "1234567890", "spec_version": "2.1", "created_by_ref": "https://example.com/stix/stix-objects", "created": "2022-05-05T14:30:00.000Z", "modified": "2022-05-05T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "1234567890", "description": "In PHP versions 7.2.x below 7.2.29, 7.3.x below 7.3.16 and 7.4.x below 7.4.4, while using get_headers() with user-supplied URL, if the URL contains zero (\\0) character, the URL will be silently truncated at it. This may cause some software to make incorrect assumptions about the target of the get_headers() and possibly send some information to a wrong server.", "packet_capture": [{"indicator": {"type": "header", "value": "Truncated URL"}, "who_attributes": {"actor_name": "Malicious Actor", "actor_id": "1234567890"}}]}, {"type": "technique", "id": "TA0002", "description": "Network Sniffing", "external_references": [{"source_name": "MITRE", "external_id": "TA0002"}]}], "relationships": [{"type": "has_technique", "id": "1234567890", "from_id": "1234567890", "to_id": "TA0002", "description": "CVE-2020-7066 is related to the TA0002 technique"}]}, "technical_analysis": {"Introduction": "The vulnerability CVE-2020-7066 is a remote code execution vulnerability in PHP that affects versions 7.2.x below 7.2.29, 7.3.x below 7.3.16 and 7.4.x below 7.4.4.", "Impact and Scope": "The vulnerability has a CVSS score of 4.3 and can allow an attacker to execute arbitrary code on the system.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the MITRE ATT&CK techniques TA0002, TA0017, and TA0020.", "Technical Details": "The vulnerability occurs when the get_headers() function is used with user-supplied input and the URL contains a zero (\\0) character. This can be exploited by an attacker to send sensitive information to an unintended location.", "Detection": "Detection methods for this vulnerability include monitoring network traffic for suspicious patterns and analyzing system logs for signs of exploitation.", "Mitigation": "Mitigation strategies include updating PHP to a version that is not affected by the vulnerability, validating user-supplied input, and ensuring that the function is only used with trusted input.", "Conclusion": "In conclusion, the CVE-2020-7066 is a remote code execution vulnerability in PHP that can be exploited by an attacker to execute arbitrary code on the system. It is important to update PHP to a version that is not affected by the vulnerability and to implement mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2020-7066 is a remote code execution vulnerability in PHP that can have significant business and technical impacts.", "Business Impact": "The vulnerability can allow an attacker to execute arbitrary code on the system, potentially leading to data breaches, financial losses, and reputational damage.", "Technical Impact": "The vulnerability can allow an attacker to gain additional privileges on the system, potentially leading to further exploitation and compromise of sensitive data.", "Mitigation Strategies": "To mitigate the vulnerability,/php updates should be applied, and mitigation strategies should be implemented to prevent exploitation.", "Recommendations": "It is recommended that executives prioritize the mitigation of this vulnerability and ensure that all systems are updated to a version that is not affected by the vulnerability.", "Conclusions": "In conclusion, the CVE-2020-7066 is a critical vulnerability that requires immediate attention and action. Executives should prioritize the mitigation of this vulnerability and ensure that all systems are updated to a version that is not affected by the vulnerability."}}