{"id": "CVE-2024-22195", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-11T03:15:11.200", "lastModified": "2024-01-27T03:15:08.043", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Jinja is an extensible templating engine. Special placeholders in the template allow writing code similar to Python syntax. It is possible to inject arbitrary HTML attributes into the rendered HTML template, potentially leading to Cross-Site Scripting (XSS). The Jinja `xmlattr` filter can be abused to inject arbitrary HTML attribute keys and values, bypassing the auto escaping mechanism and potentially leading to XSS. It may also be possible to bypass attribute validation checks if they are blacklist-based.\n"}, {"lang": "es", "value": "Jinja es un motor de plantillas extensible. Los marcadores de posici\u00f3n especiales en la plantilla permiten escribir c\u00f3digo similar a la sintaxis de Python. Es posible inyectar atributos HTML arbitrarios en la plantilla HTML renderizada, lo que podr\u00eda generar cross site scripting (XSS). Se puede abusar del filtro Jinja `xmlattr` para inyectar claves y valores de atributos HTML arbitrarios, evitando el mecanismo de escape autom\u00e1tico y potencialmente conduciendo a XSS. Tambi\u00e9n es posible omitir las comprobaciones de validaci\u00f3n de atributos si est\u00e1n basadas en listas negras."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.5}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:palletsprojects:jinja:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.1.3", "matchCriteriaId": "9DAFDD87-5F1B-4485-9393-7FCA343D18DD"}]}]}], "references": [{"url": "https://github.com/pallets/jinja/releases/tag/3.1.3", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/pallets/jinja/security/advisories/GHSA-h5c8-rqwp-cp95", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2024/01/msg00010.html", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/5XCWZD464AJJJUBOO7CMPXQ4ROBC6JX2/", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DELCVUUYX75I5K4Q5WMJG4MUZJA6VAIP/", "source": "security-advisories@github.com"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/O7YWRBX6JQCWC2XXCTZ55C7DPMGICCN3/", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1169", "comment": "Jinja Template Injection - CVE-2024-22195 - This technique involves injecting modified template code to execute arbitrary commands. To defend against this, ensure proper template input validation and escaping of special characters."}, {"techniqueID": "T1222", "comment": "Cross-Site Scripting (XSS) - CVE-2024-22195 - This technique involves injecting malicious scripts into a web page to steal user data. To defend against this, implement proper input validation and sanitization of user input, and use Content Security Policy (CSP) to define allowed sources of content."}, {"techniqueID": "T1210", "comment": "Map View - CVE-2024-22195 - This technique involves creating a map of vulnerable components to identify potential attack vectors. To defend against this, conduct regular vulnerability scanning and maintain an inventory of software components."}], "stix_bundle": {"type": "bundle", "id": " https://example.com/cve-2024-22195", "created_by_ref": " https://example.com/organization", "objects": [{"id": " https://example.com/cve-2024-22195", "type": "vulnerability", "name": "Jinja Template Injection", "description": "The Jinja templating engine is affected by a vulnerability that allows attackers to inject arbitrary code using XML attribute injection.", "cvss": {"base_score": 6.1, "base_severity": "MEDIUM", "vector_string": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"}}, {"id": " https://example.com/technique-1169", "type": "attack-pattern", "name": "Jinja Template Injection", "description": "This attack pattern involves injecting modified template code to execute arbitrary commands.", "kill_chain_phases": [{"kill_chain_name": "Mitre ATT&CK", "kill_chain_phase_name": "Initial Access"}]}, {"id": " https://example.com/technique-1222", "type": "attack-pattern", "name": "Cross-Site Scripting (XSS)", "description": "This attack pattern involves injecting malicious scripts into a web page to steal user data.", "kill_chain_phases": [{"kill_chain_name": "Mitre ATT&CK", "kill_chain_phase_name": "Persistence"}]}, {"id": " https://example.com/technique-1210", "type": "attack-pattern", "name": "Map View", "description": "This attack pattern involves creating a map of vulnerable components to identify potential attack vectors.", "kill_chain_phases": [{"kill_chain_name": "Mitre ATT&CK", "kill_chain_phase_name": "Intelligence Gathering"}]}, {"id": " https://example.com/course-of-action-1", "type": "course-of-action", "name": "Invalid Template Input Validation", "description": "Ensure proper template input validation to prevent code injection attacks.", "related_spcs": [{"id_ref": " https://example.com/technique-1169"}]}, {"id": " https://example.com/course-of-action-2", "type": "course-of-action", "name": "Escaping of Special Characters", "description": "Escape special characters to prevent code injection attacks.", "related_spcs": [{"id_ref": " https://example.com/technique-1169"}]}], " relationships": [{"sourced_id": " https://example.com/cve-2024-22195", "target_id": " https://example.com/technique-1169", "relationship": "related_to"}, {"sourced_id": " https://example.com/cve-2024-22195", "target_id": " https://example.com/technique-1222", "relationship": "related_to"}, {"sourced_id": " https://example.com/cve-2024-22195", "target_id": " https://example.com/technique-1210", "relationship": "related_to"}, {"sourced_id": " https://example.com/technique-1169", "target_id": " https://example.com/course-of-action-1", "relationship": "mitigates"}, {"sourced_id": " https://example.com/technique-1169", "target_id": " https://example.com/course-of-action-2", "relationship": "mitigates"}]}, "technical_analysis": {"Introduction": "The Jinja templating engine is affected by a vulnerability that allows attackers to inject arbitrary code using XML attribute injection. This vulnerability can be exploited to execute arbitrary commands and steal user data.", "Impact and Scope": "The impact of this vulnerability is moderate, with a CVSS base score of 6.1. The scope of the vulnerability is limited to the Jinja templating engine, but it can be exploited to access sensitive data and execute arbitrary commands.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1169, T1222, and T1210.", "Technical Details": "The vulnerability is caused by the Jinja templating engine's lack of proper input validation and escaping of special characters. Attackers can exploit this vulnerability to inject arbitrary code and execute it.", "Detection": "Detection of this vulnerability can be done using vulnerability scanning tools and by reviewing web application logs for suspicious activity.", "Mitigation": "Mitigation strategies for this vulnerability include invalidating template input validation, escaping special characters, and implementing Content Security Policy (CSP) to define allowed sources of content.", "Conclusion": "In conclusion, the Jinja templating engine vulnerability is a significant risk that requires immediate attention. It is essential to implement mitigation strategies to prevent this vulnerability from being exploited."}, "executive_analysis": {"Overview": "The Jinja templating engine vulnerability is a moderate risk that requires immediate attention.", "Business Impact": "The business impact of this vulnerability is significant, with potential losses of sensitive data and revenue.", "Technical Impact": "The technical impact of this vulnerability is moderate, with a potential CVSS base score of 6.1.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include invalidating template input validation, escaping special characters, and implementing Content Security Policy (CSP) to define allowed sources of content.", "Recommendations": "Recommendations for executives include prioritizing vulnerability remediation, implementing security awareness training, and conducting regular vulnerability scanning.", "Conclusions": "In conclusion, the Jinja templating engine vulnerability is a significant risk that requires immediate attention. It is essential to implement mitigation strategies to prevent this vulnerability from being exploited."}}