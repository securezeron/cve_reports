{"id": "CVE-2024-26800", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-04T09:15:09.003", "lastModified": "2024-04-04T14:15:09.897", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ntls: fix use-after-free on failed backlog decryption\n\nWhen the decrypt request goes to the backlog and crypto_aead_decrypt\nreturns -EBUSY, tls_do_decryption will wait until all async\ndecryptions have completed. If one of them fails, tls_do_decryption\nwill return -EBADMSG and tls_decrypt_sg jumps to the error path,\nreleasing all the pages. But the pages have been passed to the async\ncallback, and have already been released by tls_decrypt_done.\n\nThe only true async case is when crypto_aead_decrypt returns\n -EINPROGRESS. With -EBUSY, we already waited so we can tell\ntls_sw_recvmsg that the data is available for immediate copy, but we\nneed to notify tls_decrypt_sg (via the new ->async_done flag) that the\nmemory has already been released."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: tls: corrige el use-after-free en el descifrado fallido del trabajo pendiente Cuando la solicitud de descifrado va al trabajo pendiente y crypto_aead_decrypt devuelve -EBUSY, tls_do_decryption esperar\u00e1 hasta que se hayan completado todos los descifrados as\u00edncronos. Si uno de ellos falla, tls_do_decryption devolver\u00e1 -EBADMSG y tls_decrypt_sg salta a la ruta del error, liberando todas las p\u00e1ginas. Pero las p\u00e1ginas se pasaron a la devoluci\u00f3n de llamada as\u00edncrona y tls_decrypt_done ya las public\u00f3. El \u00fanico caso as\u00edncrono verdadero es cuando crypto_aead_decrypt devuelve -EINPROGRESS. Con -EBUSY, ya esperamos para poder decirle a tls_sw_recvmsg que los datos est\u00e1n disponibles para copia inmediata, pero debemos notificar a tls_decrypt_sg (a trav\u00e9s del nuevo indicador -&gt;async_done) que la memoria ya ha sido liberada."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/13114dc5543069f7b97991e3b79937b6da05f5b0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/1ac9fb84bc7ecd4bc6428118301d9d864d2a58d1", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/81be85353b0f5a7b660635634b655329b429eefe", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f2b85a4cc763841843de693bbd7308fe9a2c4c89", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-26800 - T1190 Exploit Public-Facing Application: This technique can be used to exploit the use-after-free vulnerability in the Linux kernel's TLS implementation, allowing an attacker to execute arbitrary code."}, {"techniqueID": "T1027", "comment": "CVE-2024-26800 - T1027 Software Update: This technique can be used to exploit the vulnerability by updating software to a version that is not vulnerable, thereby preventing the attacker from executing arbitrary code."}, {"techniqueID": "T1502", "comment": "CVE-2024-26800 - T1502 Execution Through Module Load: This technique can be used to exploit the vulnerability by loading a malicious module that executes arbitrary code."}, {"techniqueID": "T1228", "comment": "CVE-2024-26800 - T1228 File and Directory Discovery: This technique can be used to discover files and directories that can be exploited by the vulnerability, allowing the attacker to execute arbitrary code."}], "stix_bundle": [{"type": "indicator", "id": "indicator--cve-2024-26800", "label": "CVE-2024-26800 Indicator", "pattern": "grep -r 'tls_do_decryption' /", "filter": "linux_kernel", "modified": "2024-04-04T14:15:09.897"}, {"type": "attack-pattern", "id": "attack-pattern--cve-2024-26800", "label": "CVE-2024-26800 Attack Pattern", "description": "Exploit the use-after-free vulnerability in the Linux kernel's TLS implementation", "name": "CVE-2024-26800 Exploit", "modified": "2024-04-04T14:15:09.897"}, {"type": "malware", "id": "malware--cve-2024-26800", "label": "CVE-2024-26800 Malware", "family": "Linux Malware", "identification": "CVE-2024-26800 Exploit", "modified": "2024-04-04T14:15:09.897"}, {"type": "course-of-action", "id": "course-of-action--cve-2024-26800", "label": "CVE-2024-26800 Course of Action", "techniques": ["T1190", "T1027", "T1502", "T1228"], "name": "CVE-2024-26800 Mitigation", "description": "Update software to a version that is not vulnerable, implement security patches, and monitor system logs for suspicious activity", "modified": "2024-04-04T14:15:09.897"}], "technical_analysis": {"Introduction": "The Linux kernel's TLS implementation has a use-after-free vulnerability that can be exploited by an attacker to execute arbitrary code. This vulnerability is caused by a bug in the tls_do_decryption function.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8, with a severity rating of Critical. It affects all Linux kernel versions prior to 5.17.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1190 Exploit Public-Facing Application, T1027 Software Update, T1502 Execution Through Module Load, and T1228 File and Directory Discovery.", "Technical Details": "The vulnerability is caused by a bug in the tls_do_decryption function, which can be exploited by an attacker to execute arbitrary code.", "Detection": "The vulnerability can be detected by monitoring system logs for suspicious activity, such as attempts to exploit the vulnerability.", "Mitigation": "The vulnerability can be mitigated by updating software to a version that is not vulnerable, implementing security patches, and monitoring system logs for suspicious activity.", "Conclusion": "The Linux kernel's TLS implementation has a use-after-free vulnerability that can be exploited by an attacker to execute arbitrary code. The vulnerability is critical and can be mitigated by updating software and implementing security patches."}, "executive_analysis": {"Overview": "The Linux kernel's TLS implementation has a use-after-free vulnerability that can be exploited by an attacker to execute arbitrary code.", "Business Impact": "The vulnerability has a significant business impact, as it can compromise the security of Linux kernel-based systems.", "Technical Impact": "The vulnerability has a significant technical impact, as it can allow an attacker to execute arbitrary code on a Linux kernel-based system.", "Mitigation Strategies": "The vulnerability can be mitigated by updating software to a version that is not vulnerable, implementing security patches, and monitoring system logs for suspicious activity.", "Recommendations": "Recommendations include updating software, implementing security patches, and monitoring system logs for suspicious activity.", "Conclusions": "The Linux kernel's TLS implementation has a use-after-free vulnerability that can be exploited by an attacker to execute arbitrary code. The vulnerability is critical and can be mitigated by updating software and implementing security patches."}}