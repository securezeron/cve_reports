{"id": "CVE-2020-11940", "sourceIdentifier": "cve@mitre.org", "published": "2020-04-23T15:15:14.153", "lastModified": "2020-05-06T19:48:23.020", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "In nDPI through 3.2 Stable, an out-of-bounds read in concat_hash_string in ssh.c can be exploited by a network-positioned attacker that can send malformed SSH protocol messages on a network segment monitored by nDPI's library."}, {"lang": "es", "value": "En nDPI versiones hasta 3.2 Stable, una lectura fuera de l\u00edmites en la funci\u00f3n concat_hash_string en el archivo ssh.c puede ser explotada por un atacante posicionado en red que puede enviar mensajes en protocolo SSH malformado en un segmento de red monitoreado por la biblioteca de nDPI."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-125"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ntop:ndpi:*:*:*:*:*:*:*:*", "versionEndIncluding": "3.2", "matchCriteriaId": "97EDB1C6-9886-4C0B-8F09-5A4C52DC5A45"}]}]}], "references": [{"url": "https://github.com/ntop/nDPI/commit/3bbb0cd3296023f6f922c71d21a1c374d2b0a435", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://securitylab.github.com/advisories/GHSL-2020-051_052-ntop-ndpi", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-11940 - This technique allows an attacker to use a network-positioned attacker to send malformed SSH protocol messages, resulting in an out-of-bounds read in concat_hash_string in ssh.c. This can be exploited by an attacker to gain unauthorized access."}, {"techniqueID": "T1027", "comment": "CVE-2020-11940 - This technique can be used by an attacker to exploit the vulnerability by sending a malformed SSH protocol message, resulting in an out-of-bounds read in concat_hash_string in ssh.c."}, {"techniqueID": "T1191", "comment": "CVE-2020-11940 - This technique can be used by an attacker to exploit the vulnerability by sending a malformed SSH protocol message, resulting in an out-of-bounds read in concat_hash_string in ssh.c."}], "stix_bundle": {"objects": [{"id": "https://example.com/cve-2020-11940", "type": "Vulnerability", "name": "CVE-2020-11940", "description": "The nDPI library before 3.2 Stable has an out-of-bounds read in concat_hash_string in ssh.c.", "cvssv3": {"baseSeverity": "HIGH", "baseScore": 7.5}, "cvssv2": {"baseSeverity": "MEDIUM", "baseScore": 5.0}, "exploitability": {"exploitabilityScore": 3.9}}, {"id": "https://example.com/T1190", "type": "Attack Pattern", "name": "Path traversal using SSH", "description": "An attacker sends a malformed SSH protocol message to an affected system to exploit the vulnerability."}, {"id": "https://example.com/T1027", "type": "Network Sniffing", "name": "Network sniffing using SSH", "description": "An attacker sends a malformed SSH protocol message to an affected system to sniff network traffic."}, {"id": "https://example.com/T1191", "type": "Command and Control", "name": "Command and Control using SSH", "description": "An attacker sends a malformed SSH protocol message to an affected system to execute malicious code."}, {"id": "https://example.com/detection", "type": "indicator", "name": "Suspicious SSH protocol message", "description": "An indicator of suspicious activity is the presence of a malformed SSH protocol message.", "pattern": "regex: pattern_malformed_ssh_message"}, {"id": "https://example.com/mitigation", "type": "course_of_action", "name": "Install patched nDPI library", "description": "Install a patched version of nDPI library to mitigate the vulnerability.", "mitigates": {"techniques": ["T1190", "T1027", "T1191"]}}], "_incident_report": {"id": "https://example.com/report", "incident_id": "incident_1234", "title": "CVE-2020-11940 Exploitation", "description": "An attacker exploited the CVE-2020-11940 vulnerability in an nDPI system.", "state": "open", "created_at": "2020-04-23T15:15:14.153", "updated_at": "2020-05-06T19:48:23.020"}}, "technical_analysis": {"Introduction": "This analysis focuses on the vulnerability CVE-2020-11940 in the nDPI library.", "Impact and Scope": "The vulnerability allows an attacker to send a malformed SSH protocol message to an affected system, resulting in an out-of-bounds read in concat_hash_string in ssh.c.", "Related MITRE ATT&CK Techniques": "T1190, T1027, and T1191.", "Technical Details": "The vulnerability is caused by an out-of-bounds read in concat_hash_string in ssh.c.", "Detection": "Detecting suspicious SSH protocol messages can indicate exploitation of the vulnerability.", "Mitigation": "Install a patched version of nDPI library to mitigate the vulnerability.", "Conclusion": "This analysis highlights the importance of patching the nDPI library to prevent exploitation of the CVE-2020-11940 vulnerability."}, "executive_analysis": {"Overview": "The CVE-2020-11940 vulnerability affects the nDPI library and can be exploited by an attacker to send a malformed SSH protocol message.", "Business Impact": "The vulnerability can lead to unauthorized access and data theft.", "Technical Impact": "The vulnerability can be exploited to execute malicious code and sniff network traffic.", "Mitigation Strategies": "Install a patched version of nDPI library.", "Recommendations": "Update nDPI library to the latest version.", "Conclusions": "The vulnerability highlights the importance of patching and updating libraries to ensure the security of systems."}}