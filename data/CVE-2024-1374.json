{"id": "CVE-2024-1374", "sourceIdentifier": "product-cna@github.com", "published": "2024-02-13T19:15:10.497", "lastModified": "2024-03-06T15:26:34.817", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A command injection vulnerability was identified in GitHub Enterprise Server that allowed an attacker with an editor role in the Management Console to gain admin SSH access to the appliance via\u00a0nomad templates when configuring audit log forwarding. Exploitation of this vulnerability required access to the GitHub Enterprise Server instance and access to the Management Console with the editor role. This vulnerability affected all versions of GitHub Enterprise Server prior to 3.12 and was fixed in versions 3.11.5, 3.10.7, 3.9.10, and 3.8.15. This vulnerability was reported via the  GitHub Bug Bounty program https://bounty.github.com .\n"}, {"lang": "es", "value": "Se identific\u00f3 una vulnerabilidad de inyecci\u00f3n de comandos en GitHub Enterprise Server que permiti\u00f3 a un atacante con una funci\u00f3n de editor en Management Console obtener acceso SSH de administrador al dispositivo a trav\u00e9s de plantillas n\u00f3madas al configurar el reenv\u00edo de registros de auditor\u00eda. La explotaci\u00f3n de esta vulnerabilidad requiri\u00f3 acceso a la instancia de GitHub Enterprise Server y acceso a la Consola de administraci\u00f3n con la funci\u00f3n de editor. Esta vulnerabilidad afect\u00f3 a todas las versiones de GitHub Enterprise Server anteriores a la 3.12 y se solucion\u00f3 en las versiones 3.11.5, 3.10.7, 3.9.10 y 3.8.15. Esta vulnerabilidad se inform\u00f3 a trav\u00e9s del programa GitHub Bug Bounty https://bounty.github.com."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.3, "impactScore": 6.0}, {"source": "product-cna@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.3, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-77"}]}, {"source": "product-cna@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:github:enterprise_server:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.8.15", "matchCriteriaId": "DC6BA1DD-5194-4738-B23D-07FCEAFFB3DF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:github:enterprise_server:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.9.0", "versionEndExcluding": "3.9.10", "matchCriteriaId": "8C3BDFFD-8A83-4D52-8A6E-B87B8070A046"}, {"vulnerable": true, "criteria": "cpe:2.3:a:github:enterprise_server:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.10.0", "versionEndExcluding": "3.10.7", "matchCriteriaId": "EB406BB2-7ABF-4A44-830F-7012CDB3D81D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:github:enterprise_server:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.11.0", "versionEndExcluding": "3.11.5", "matchCriteriaId": "0529566C-AC2F-4385-93D7-578230AC453E"}]}]}], "references": [{"url": "https://docs.github.com/en/enterprise-server@3.10/admin/release-notes#3.10.7", "source": "product-cna@github.com", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "https://docs.github.com/en/enterprise-server@3.11/admin/release-notes#3.11.5", "source": "product-cna@github.com", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "https://docs.github.com/en/enterprise-server@3.8/admin/release-notes#3.8.15", "source": "product-cna@github.com", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "https://docs.github.com/en/enterprise-server@3.9/admin/release-notes#3.9.10", "source": "product-cna@github.com", "tags": ["Release Notes", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1204", "comment": "CVE-2024-1374 - Command injection vulnerability in GitHub Enterprise Server allows attackers to gain admin SSH access. This can lead to privilege escalation and unauthorized access to sensitive information. D3FEND tactic: Validate User Input can help prevent this attack by verifying the legitimacy of user-supplied input."}, {"techniqueID": "T1027", "comment": "CVE-2024-1374 - The vulnerability requires access to the GitHub Enterprise Server instance and access to the Management Console with the editor role. This can be achieved through tactic T1027 - Remote Services. D3FEND tactic: Limit Network Ports can help restrict access to the vulnerable service."}, {"techniqueID": "T1210", "comment": "CVE-2024-1374 - The vulnerability allows attackers to gain admin SSH access, which can be used for lateral movement and privilege escalation. D3FEND tactic: Implement Network Segmentation can help prevent the spread of malware and unauthorized access."}], "stix_bundle": "{\"bundle\": {\n  \"objects\": [\n    {\n      \"type\": \"attack-pattern\",\n      \"id\": \"ap:00006\",\n      \"name\": \"GitHub Enterprise Server Command Injection Vulnerability\",\n      \"description\": \"A command injection vulnerability in GitHub Enterprise Server allows an attacker with an editor role in the Management Console to gain admin SSH access.\",\n      \"kill_chain_phases\": [{\"kill_chain_name\": \"MITRE CYBER ADVISORY\", \"phase_name\": \"Compromise\"}],\n      \"external_references\": [{\"source_name\": \"MITRE\", \"external_id\": \"T1204\"}]\n    },\n    {\n      \"type\": \"intrusion-set\",\n      \"id\": \"is:00001\",\n      \"name\": \"GitHub Enterprise Server Attackers\",\n      \"description\": \"Attackers exploiting the GitHub Enterprise Server Command Injection Vulnerability.\",\n      \"kill_chain_phases\": [{\"kill_chain_name\": \"MITRE CYBER ADVISORY\", \"phase_name\": \"Action\"}],\n      \"external_references\": [{\"source_name\": \"MITRE\", \"external_id\": \"T1027\"}]\n    },\n    {\n      \"type\": \"intrusion-set\",\n      \"id\": \"is:00002\",\n      \"name\": \"Lateral Movement Threat Actors\",\n      \"description\": \"Threat actors gaining admin SSH access and performing lateral movement.\",\n      \"kill_chain_phases\": [{\"kill_chain_name\": \"MITRE CYBER ADVISORY\", \"phase_name\": \"Actions on Objectives\"}],\n      \"external_references\": [{\"source_name\": \"MITRE\", \"external_id\": \"T1210\"}]\n    },\n    {\n      \"type\": \"indicator\",\n      \"id\": \"i:00001\",\n      \"name\": \"GitHub Enterprise Server Command Injection Vulnerability Indicator\",\n      \"description\": \"Indicator for the GitHub Enterprise Server Command Injection Vulnerability.\",\n      \"pattern\": \"[IPv4]\n  protocol=17\n  src_ip=\\{IP\\}\n  dst_port=22\",\n      \"created_by_ref\": \"user:00001\",\n      \"modified_by_ref\": \"user:00001\",\n      \"observed_data\": [{\"source_data_refs\": [{\"id\": \"i:00001\"}, {\"id\": \"i:00002\"}]}]\n    }\n  ],\n  \" relationships\": [{\n    \"relationship\": \"related_to\",\n    \"source\": \"ap:00006\",\n    \"target\": \"is:00001\"\n  }, {\n    \"relationship\": \"related_to\",\n    \"source\": \"ap:00006\",\n    \"target\": \"i:00001\"\n  }, {\n    \"relationship\": \"related_to\",\n    \"source\": \"is:00001\",\n    \"target\": \"is:00002\"\n  }, {\n    \"relationship\": \"related_to\",\n    \"source\": \"is:00002\",\n    \"target\": \"d3fend:00001\"\n  }, {\n    \"relationship\": \"related_to\",\n    \"source\": \"d3fend:00001\",\n    \"target\": \"d3fend:00002\"\n  }, {\n    \"relationship\": \"related_to\",\n    \"source\": \"d3fend:00001\",\n    \"target\": \"d3fend:00003\"\n  }\n],\n  \"objects_by_type\": {\n    \"attack-pattern\": [\n      \"ap:00006\"\n    ],\n    \"intrusion-set\": [\n      \"is:00001\",\n      \"is:00002\"\n    ],\n    \"indicator\": [\n      \"i:00001\",\n      \"i:00002\"\n    ],\n    \"defense-automation\": [],\n    \"course-of-action\": [],\n    \"note\": []\n}\n}\n}", "technical_analysis": {"Introduction": "The GitHub Enterprise Server Command Injection Vulnerability (CVE-2024-1374) is a serious threat that allows attackers to gain admin SSH access to the affected system.", "Impact and Scope": "The vulnerability has a CVSS score of 9.1, indicating a critical severity. It affects all versions of GitHub Enterprise Server prior to 3.12 and requires access to the GitHub Enterprise Server instance and access to the Management Console with the editor role.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1204, T1027, and T1210, which are used to compromise and leverage access to the affected system.", "Technical Details": "The vulnerability occurs when an attacker with an editor role in the Management Console configures audit log forwarding using nomad templates. This allows the attacker to inject arbitrary commands and gain admin SSH access.", "Detection": "Detection is challenging due to the nature of the vulnerability. However, monitoring for unusual login attempts and system access can help identify potential exploitation.", "Mitigation": "Mitigation strategies include validating user input, limiting network ports, implementing network segmentation, and updating the affected system to a patched version.", "Conclusion": "The GitHub Enterprise Server Command Injection Vulnerability is a critical threat that requires immediate attention. It is essential to implement effective defenses to prevent exploitation and protect the affected system."}, "executive_analysis": {"Overview": "The GitHub Enterprise Server Command Injection Vulnerability is a critical threat that affects all versions of GitHub Enterprise Server prior to 3.12.", "Business Impact": "The vulnerability has significant business implications, including potential data breaches, unauthorized access, and reputational damage.", "Technical Impact": "The vulnerability allows attackers to gain admin SSH access and perform lateral movement, which can lead to further exploitation and data destruction.", "Mitigation Strategies": "The recommended mitigation strategies include validating user input, limiting network ports, implementing network segmentation, and updating the affected system to a patched version.", "Recommendations": "It is recommended that organizations prioritize the patching of affected systems, implement effective defenses, and conduct thorough security assessments to identify and mitigate similar vulnerabilities.", "Conclusions": "The GitHub Enterprise Server Command Injection Vulnerability is a critical threat that requires immediate attention. Effective defenses and timely patching are essential to prevent exploitation and protect the affected system."}}