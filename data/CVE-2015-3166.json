{"id": "CVE-2015-3166", "sourceIdentifier": "secalert@redhat.com", "published": "2019-11-20T21:15:11.413", "lastModified": "2019-11-22T15:08:18.277", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The snprintf implementation in PostgreSQL before 9.0.20, 9.1.x before 9.1.16, 9.2.x before 9.2.11, 9.3.x before 9.3.7, and 9.4.x before 9.4.2 does not properly handle system-call errors, which allows attackers to obtain sensitive information or have other unspecified impact via unknown vectors, as demonstrated by an out-of-memory error."}, {"lang": "es", "value": "La implementaci\u00f3n de snprintf en PostgreSQL versiones anteriores a 9.0.20, versiones 9.1.x anteriores a 9.1.16, versiones 9.2.x anteriores a 9.2.11, versiones 9.3.x anteriores a 9.3.7 y versiones 9.4.x anteriores a 9.4.2, no maneja apropiadamente los errores de llamadas al sistema , lo que permite a atacantes obtener informaci\u00f3n confidencial o tener otro impacto no especificado por medio de vectores desconocidos, como es demostrado por un error fuera de la memoria."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionEndExcluding": "9.0.20", "matchCriteriaId": "21D435C2-4D3A-447E-A8A5-66CC6925C105"}, {"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.1", "versionEndExcluding": "9.1.16", "matchCriteriaId": "25EBF3A0-EC2E-4B96-8CC4-82AD2F0B9E67"}, {"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.2", "versionEndExcluding": "9.2.11", "matchCriteriaId": "220353A0-CF8E-45B7-9C4F-940310C4C34F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.3", "versionEndExcluding": "9.3.7", "matchCriteriaId": "0A08DED3-2C75-4953-99D0-4CF86C6AF091"}, {"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*", "versionStartIncluding": "9.4", "versionEndExcluding": "9.4.2", "matchCriteriaId": "9C830AA7-9F35-41C5-930B-A5BEFDCB3864"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "16F59A04-14CF-49E2-9973-645477EA09DA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:12.04:*:*:*:lts:*:*:*", "matchCriteriaId": "B6B7CAD7-9D4E-4FDB-88E3-1E583210A01F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:lts:*:*:*", "matchCriteriaId": "B5A6F2F3-4894-4392-8296-3B8DD2679084"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:14.10:*:*:*:*:*:*:*", "matchCriteriaId": "49A63F39-30BE-443F-AF10-6245587D3359"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:15.04:*:*:*:*:*:*:*", "matchCriteriaId": "F38D3B7E-8429-473F-BB31-FC3583EE5A5B"}]}]}], "references": [{"url": "http://ubuntu.com/usn/usn-2621-1", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://www.debian.org/security/2015/dsa-3269", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://www.debian.org/security/2015/dsa-3270", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://www.postgresql.org/about/news/1587/", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://www.postgresql.org/docs/9.0/static/release-9-0-20.html", "source": "secalert@redhat.com", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "http://www.postgresql.org/docs/9.1/static/release-9-1-16.html", "source": "secalert@redhat.com", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "http://www.postgresql.org/docs/9.2/static/release-9-2-11.html", "source": "secalert@redhat.com", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "http://www.postgresql.org/docs/9.3/static/release-9-3-7.html", "source": "secalert@redhat.com", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "http://www.postgresql.org/docs/9.4/static/release-9-4-2.html", "source": "secalert@redhat.com", "tags": ["Release Notes", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2015-3166 - An insecure snprintf function in PostgreSQL versions 9.0 to 9.4 allows an attacker to obtain sensitive information or cause the system to hang. This technique can be used by an attacker to execute arbitrary code by crafting a malicious string input."}, {"techniqueID": "T1191", "comment": "CVE-2015-3166 - An insecure snprintf function in PostgreSQL versions 9.0 to 9.4 allows an attacker to obtain sensitive information or cause the system to hang. This technique can be used by an attacker to gain elevated privileges by executing a sudo command."}, {"techniqueID": "T1199", "comment": "CVE-2015-3166 - An insecure snprintf function in PostgreSQL versions 9.0 to 9.4 allows an attacker to obtain sensitive information or cause the system to hang. This technique can be used by an attacker to steal credentials by exploiting a known vulnerability in the system."}], "stix_bundle": {"stix_bundles": [{"identity": {"id": "CVE-2015-3166", "type": "Observed-Data", "created_by_ref": "https://siem.example.com/user/jsmith"}, "objects": [{"id": "System-Component", "type": "System-Component", "name": "PostgreSQL", "description": "PostgreSQL database server", "additional_properties": {"patched_versions": ["9.0.21", "9.1.17", "9.2.12", "9.3.8", "9.4.3"]}}, {"id": "Threat-Action", "type": "Threat-Action", "name": "System Hacking", "description": "Attempt to exploit vulnerable system to gain unauthorized access"}, {"id": "Vulnerability", "type": "Vulnerability", "name": "CVE-2015-3166", "description": "Insecure snprintf function in PostgreSQL versions 9.0 to 9.4 allows an attacker to obtain sensitive information or cause the system to hang", "severity": "High"}, {"id": "Course-of-Action", "type": "Course-of-Action", "name": "Patch Systems", "description": "Apply patches to vulnerable systems to prevent exploitation", "recommended_action": "Patch systems immediately", "related_course_of_action_refs": [" courses-of-action/Course-of-Action-1"]}, {"id": "Course-of-Action", "type": "Course-of-Action", "name": "Disable Unused Services", "description": "Disable unused services to reduce attack surface", "recommended_action": "Disable unused services", "related_course_of_action_refs": ["courses-of-actions/Course-of-Action-1"]}], " relations": [{"from": "System-Component", "to": "Threat-Action", "relationship_type": "exploits"}, {"from": "Threat-Action", "to": "Vulnerability", "relationship_type": "uses"}, {"from": "Vulnerability", "to": "Course-of-Action", "relationship_type": "exploited_by"}]}]}, "technical_analysis": {"Introduction": "CVE-2015-3166 is a critical vulnerability in PostgreSQL versions 9.0 to 9.4 that allows an attacker to obtain sensitive information or cause the system to hang.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8 and an attack vector of NETWORK. It affects systems running PostgreSQL versions 9.0 to 9.4.", "Related MITRE ATT&CK Techniques": "T1190, T1191, and T1199", "Technical Details": "The vulnerability is caused by an insecure snprintf function in PostgreSQL versions 9.0 to 9.4 that allows an attacker to craft a malicious string input to execute arbitrary code.", "Detection": "Detection methods include monitoring system logs for suspicious activity and implementing intrusion detection systems.", "Mitigation": "Mitigation strategies include patching systems, disabling unused services, and implementing intrusion detection systems.", "Conclusion": "CVE-2015-3166 is a high-severity vulnerability that requires immediate attention to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2015-3166 is a critical vulnerability in PostgreSQL versions 9.0 to 9.4 that requires immediate attention.", "Business Impact": "The vulnerability can have significant business impact by allowing an attacker to gain unauthorized access to sensitive information.", "Technical Impact": "The vulnerability has a significant technical impact by allowing an attacker to execute arbitrary code and gain elevated privileges.", "Mitigation Strategies": "The recommended mitigation strategies are to patch systems, disable unused services, and implement intrusion detection systems.", "Recommendations": "Executive recommendation: prioritize patching systems and disable unused services to minimize the risk of exploitation.", "Conclusions": "In conclusion, CVE-2015-3166 is a critical vulnerability that requires immediate attention and swift action to prevent exploitation."}}