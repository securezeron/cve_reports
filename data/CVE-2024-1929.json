{"id": "CVE-2024-1929", "sourceIdentifier": "patrick@puiterwijk.org", "published": "2024-05-08T02:15:09.300", "lastModified": "2024-05-08T13:15:00.690", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Local Root Exploit via Configuration Dictionary  in dnf5daemon-server\u00a0before 5.1.17 allows a malicious user to impact Confidentiality and Integrity via Configuration Dictionary.\n\nThere are issues with the D-Bus interface long before Polkit is invoked. The `org.rpm.dnf.v0.SessionManager.open_session` method takes a key/value map of configuration entries. A sub-entry in this map, placed under the \"config\" key, is another key/value map. The configuration values found in it will be forwarded as configuration overrides to the `libdnf5::Base` configuration.\u00a0\n\nPractically all libdnf5 configuration aspects can be influenced here. Already when opening the session via D-Bus, the libdnf5 will be initialized using these override configuration values. There is no sanity checking of the content of this \"config\" map, which is untrusted data.\u00a0It is possible to make the library loading a plug-in shared library under control of an unprivileged user, hence achieving root access.\u00a0\n\n"}, {"lang": "es", "value": "El exploit de ra\u00edz local a trav\u00e9s del diccionario de configuraci\u00f3n en dnf5daemon-server anterior a 5.1.17 permite que un usuario malintencionado afecte la confidencialidad y la integridad a trav\u00e9s del diccionario de configuraci\u00f3n. Hay problemas con la interfaz D-Bus mucho antes de que se invoque Polkit. El m\u00e9todo `org.rpm.dnf.v0.SessionManager.open_session` toma un mapa clave/valor de las entradas de configuraci\u00f3n. Una subentrada en este mapa, ubicada debajo de la clave \"config\", es otro mapa de clave/valor. Los valores de configuraci\u00f3n que se encuentran en \u00e9l se reenviar\u00e1n como anulaciones de configuraci\u00f3n a la configuraci\u00f3n `libdnf5::Base`. Aqu\u00ed se pueden influir pr\u00e1cticamente todos los aspectos de configuraci\u00f3n de libdnf5. Ya al abrir la sesi\u00f3n a trav\u00e9s de D-Bus, libdnf5 se inicializar\u00e1 utilizando estos valores de configuraci\u00f3n de anulaci\u00f3n. No hay ninguna verificaci\u00f3n de cordura del contenido de este mapa de \"configuraci\u00f3n\", que son datos que no son de confianza. Es posible hacer que la librer\u00eda cargue una librer\u00eda compartida de complemento bajo el control de un usuario sin privilegios, logrando as\u00ed acceso de root."}], "metrics": {"cvssMetricV31": [{"source": "patrick@puiterwijk.org", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.1, "impactScore": 5.8}]}, "weaknesses": [{"source": "patrick@puiterwijk.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-20"}]}], "references": [{"url": "https://www.openwall.com/lists/oss-security/2024/03/04/2", "source": "patrick@puiterwijk.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-1929 - Lateral movement through exploitation of configuration dictionary in dnf5daemon-server before 5.1.17 allows an attacker to impact Confidentiality and Integrity."}, {"techniqueID": "T1047", "comment": "CVE-2024-1929 - Exploitation of dnf5daemon-server configuration dictionary to inject and load shared libraries with elevated privileges enables privilege escalation."}, {"techniqueID": "T1192", "comment": "CVE-2024-1929 - Unvalidated input in the dnf5daemon-server configuration dictionary allows an attacker to inject malicious code and achieve arbitrary code execution."}, {"techniqueID": "T1568", "comment": "CVE-2024-1929 - Exploitation of the dnf5daemon-server D-Bus interface to manipulate configuration settings and gain a foothold in an environment."}, {"techniqueID": "T1094", "comment": "CVE-2024-1929 - Analysis of system calls and application crashes to determine the effectiveness of the exploitation and potential impact of the vulnerability."}, {"techniqueID": "T1569", "comment": "CVE-2024-1929 - Network reconnaissance to identify potential victims and determine the effectiveness of the exploitation of the dnf5daemon-server configuration dictionary."}], "stix_bundle": {"@metadata": {"generated": "2024-05-08T02:15:09.300", "generator": "patrick@puiterwijk.org"}, "objects": [{"id": "vuln:CVE-2024-1929", "type": "vulnerability", "title": "Local Root Exploit via Configuration Dictionary in dnf5daemon-server before 5.1.17", "description": "Local Root Exploit via Configuration Dictionary in dnf5daemon-server before 5.1.17 allows a malicious user to impact Confidentiality and Integrity via Configuration Dictionary.", "published": "2024-05-08T02:15:09.300", "last_modified": "2024-05-08T13:15:00.690", "cvss_v3": {"vector_string": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:N", "attack_vector": "LOCAL", "attack_complexity": "HIGH", "privileges_required": "LOW", "user_interaction": "NONE", "scope": "CHANGED", "confidentiality_impact": "HIGH", "integrity_impact": "HIGH", "availability_impact": "NONE", "base_score": 7.5, "base_severity": "HIGH"}}, {"id": "technique:T1190", "type": "technique", "name": "Lateral Movement via Exploitation of Configuration Dictionary", "description": "Exploitation of configuration dictionary in dnf5daemon-server before 5.1.17 to inject and load shared libraries with elevated privileges enables privilege escalation."}, {"id": "technique:T1047", "type": "technique", "name": "Exploitation of Configuration Dictionary", "description": "Exploitation of dnf5daemon-server configuration dictionary to inject and load shared libraries with elevated privileges enables privilege escalation."}, {"id": "technique:T1192", "type": "technique", "name": "Unvalidated Input via D-Bus Interface", "description": "Unvalidated input in the dnf5daemon-server D-Bus interface allows an attacker to inject malicious code and achieve arbitrary code execution."}, {"id": "technique:T1568", "type": "technique", "name": "Exploitation of Configuration Settings", "description": "Exploitation of the dnf5daemon-server D-Bus interface to manipulate configuration settings and gain a foothold in an environment."}, {"id": "technique:T1094", "type": "technique", "name": "System Call Analysis", "description": "Analysis of system calls and application crashes to determine the effectiveness of the exploitation and potential impact of the vulnerability."}, {"id": "technique:T1569", "type": "technique", "name": "Network Reconnaissance", "description": "Network reconnaissance to identify potential victims and determine the effectiveness of the exploitation of the dnf5daemon-server configuration dictionary."}], "relationships": [{"source_ref": "vuln:CVE-2024-1929", "target_ref": "technique:T1190", "relationship_type": "EXPLOITS"}, {"source_ref": "vuln:CVE-2024-1929", "target_ref": "technique:T1047", "relationship_type": "EXPLOITS"}, {"source_ref": "vuln:CVE-2024-1929", "target_ref": "technique:T1192", "relationship_type": "EXPLOITS"}, {"source_ref": "vuln:CVE-2024-1929", "target_ref": "technique:T1568", "relationship_type": "EXPLOITS"}, {"source_ref": "vuln:CVE-2024-1929", "target_ref": "technique:T1094", "relationship_type": "EXPLOITS"}, {"source_ref": "vuln:CVE-2024-1929", "target_ref": "technique:T1569", "relationship_type": "EXPLOITS"}], "/course_of_action": [{"id": "COA-1", "name": "Update dnf5daemon-server to 5.1.17 or later", "description": "Update dnf5daemon-server to 5.1.17 or later to prevent exploitation of the vulnerability.", "mitigates": ["technique:T1190", "technique:T1047", "technique:T1192", "technique:T1568", "technique:T1094", "technique:T1569"]}]}, "technical_analysis": {"Introduction": "The CVE-2024-1929 vulnerability affects the dnf5daemon-server before 5.1.17, which allows a malicious user to impact Confidentiality and Integrity via Configuration Dictionary.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 and can be exploited locally through unvalidated input in the dnf5daemon-server D-Bus interface.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1047, T1192, T1568, T1094, and T1569.", "Technical Details": "Details on the technical details of the vulnerability, including the exploitability and impact.", "Detection": "Methods for detecting the vulnerability, including system call analysis and network reconnaissance.", "Mitigation": "Mitigation strategies for the vulnerability, including updating dnf5daemon-server to 5.1.17 or later.", "Conclusion": "Summary and conclusions on the vulnerability."}, "executive_analysis": {"Overview": "This is a high-severity vulnerability in dnf5daemon-server before 5.1.17 that allows local exploitation.", "Business Impact": "The exploitation of this vulnerability can lead to the loss of Confidentiality and Integrity of data.", "Technical Impact": "The vulnerability can be exploited locally through unvalidated input in the dnf5daemon-server D-Bus interface.", "Mitigation Strategies": "The recommended mitigation strategies are to update dnf5daemon-server to 5.1.17 or later.", "Recommendations": "Recommendations for executives on how to address the vulnerability.", "Conclusions": "Final conclusions and next steps on the vulnerability."}}