{"id": "CVE-2024-34066", "sourceIdentifier": "security-advisories@github.com", "published": "2024-05-03T18:15:09.363", "lastModified": "2024-05-06T12:44:56.377", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Pterodactyl wings is the server control plane for Pterodactyl Panel. If the Wings token is leaked either by viewing the node configuration or posting it accidentally somewhere, an attacker can use it to gain arbitrary file write and read access on the node the token is associated to. This issue has been addressed in version 1.11.12 and users are advised to upgrade. Users unable to upgrade may enable the `ignore_panel_config_updates` option as a workaround."}, {"lang": "es", "value": "Pterodactyl Wings es el plano de control del servidor para Pterodactyl Panel. Si el token Wings se filtra al ver la configuraci\u00f3n del nodo o al publicarlo accidentalmente en alg\u00fan lugar, un atacante puede usarlo para obtener acceso de escritura y lectura de archivos arbitrarios en el nodo al que est\u00e1 asociado el token. Este problema se solucion\u00f3 en la versi\u00f3n 1.11.12 y se recomienda a los usuarios que actualicen. Los usuarios que no puedan actualizar pueden habilitar la opci\u00f3n `ignore_panel_config_updates` como workaround."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.7, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-552"}]}], "references": [{"url": "https://github.com/pterodactyl/wings/commit/5415f8ae07f533623bd8169836dd7e0b933964de", "source": "security-advisories@github.com"}, {"url": "https://github.com/pterodactyl/wings/security/advisories/GHSA-gqmf-jqgv-v8fw", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1078", "comment": "CVE-2024-34066 - leverage of leaked Wings token for file read and write access, similar to other TTPs of Credentials from past attacks"}, {"techniqueID": "T1190", "comment": "CVE-2024-34066 - use of leaked Wings token for Initial Access, similar to other TTPs of Lateral Movement"}], "stix_bundle": {"@schema": "https://docs.oasis-open.org/stop/stop/v2.1/stop-v2.1.json schema.xsd", "id": "cve-2024-34066-stix-bundle", "type": "bundle", "spec_version": "2.1", "created_by_ref": "cve-2024-34066", "objects": [{"id": "cve-2024-34066", "type": "vulnerability", "name": "CVE-2024-34066", "description": "Pterodactyl wings is the server control plane for Pterodactyl Panel. If the Wings token is leaked either by viewing the node configuration or posting it accidentally somewhere, an attacker can use it to gain arbitrary file write and read access on the node the token is associated to.", "properties": [{"name": "cvss-score", "value": "8.4", "type": "string"}, {"name": "attack-vector", "value": "NETWORK", "type": "string"}], "related_object_refs": [{"ref_id": "cve-2024-34066-technique", "type": "technique"}]}, {"id": "cve-2024-34066-technique", "type": "technique", "name": "T1078: Exploitation of Remote Services", "description": "Exploiting a remote service using leaked credentials", "properties": [{"name": "name", "value": "T1078", "type": "string"}], "relationships": [{"relationship_type": "includes", "object_ref": "cve-2024-34066"}]}]}, "technical_analysis": {"Introduction": "The CVE-2024-34066 is a remote code execution vulnerability in Pterodactyl Wings, which allows an attacker to gain arbitrary file write and read access on the node the token is associated to.", "Impact and Scope": "The impact of this CVE is high, with a CVSS score of 8.4, due to its potential to allow an attacker to take control of the system. The scope is limited to systems running Pterodactyl Wings with an unpatched version.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this CVE: T1078: Exploitation of Remote Services, T1190: Exploit via Social Engineering.", "Technical Details": "The vulnerability occurs due to the use of a weak token in the Pterodactyl Wings configuration. An attacker can exploit this by gaining access to the node configuration and using the token to gain elevated privileges.", "Detection": "Detection can be done by monitoring for unusual network traffic and login attempts, as well as by performing regular security audits and vulnerability scans.", "Mitigation": "The mitigation for this CVE is to update to a patched version of Pterodactyl Wings, or to disable the Wings token if upgrading is not possible.", "Conclusion": "In conclusion, the CVE-2024-34066 is a critical vulnerability that can be exploited to gain arbitrary file write and read access on the node the token is associated to. It is essential to patch the vulnerability and monitor for any unusual activity."}, "executive_analysis": {"Overview": "The CVE-2024-34066 is a critical vulnerability in Pterodactyl Wings that can be exploited to gain arbitrary file write and read access on the node the token is associated to.", "Business Impact": "The business impact of this CVE is significant, as it can potentially allow an attacker to take control of the system, leading to data breaches and denial-of-service attacks.", "Technical Impact": "The technical impact of this CVE is high, due to its potential to allow an attacker to gain elevated privileges and take control of the system.", "Mitigation Strategies": "The mitigation strategies for this CVE include updating to a patched version of Pterodactyl Wings, or disabling the Wings token if upgrading is not possible.", "Recommendations": "We recommend that all Pterodactyl Wings users update to a patched version as soon as possible, and monitor for any unusual activity.", "Conclusions": "In conclusion, the CVE-2024-34066 is a critical vulnerability that requires immediate attention and action."}}