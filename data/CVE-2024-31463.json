{"id": "CVE-2024-31463", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-17T16:15:08.637", "lastModified": "2024-04-17T16:51:07.347", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Ironic-image is an OpenStack Ironic deployment packaged and configured by Metal3. When the reverse proxy mode is enabled by the `IRONIC_REVERSE_PROXY_SETUP` variable set to `true`, 1) HTTP basic credentials are validated on the HTTPD side in a separate container, not in the Ironic service itself and 2) Ironic listens in host network on a private port 6388 on localhost by default. As a result, when the reverse proxy mode is used, any Pod or local Unix user on the control plane Node can access the Ironic API on the private port without authentication. A similar problem affects Ironic Inspector (`INSPECTOR_REVERSE_PROXY_SETUP` set to `true`), although the attack potential is smaller there. This issue affects operators deploying ironic-image in the reverse proxy mode, which is the recommended mode when TLS is used (also recommended), with the `IRONIC_PRIVATE_PORT` variable unset or set to a numeric value. In this case, an attacker with enough privileges to launch a pod on the control plane with host networking can access Ironic API and use it to modify bare-metal machine, e.g. provision them with a new image or change their BIOS settings. This vulnerability is fixed in 24.1.1. "}, {"lang": "es", "value": "Ironic-image es una implementaci\u00f3n de OpenStack Ironic empaquetada y configurada por Metal3. Cuando el modo de proxy inverso est\u00e1 habilitado mediante la variable `IRONIC_REVERSE_PROXY_SETUP` establecida en `true`, 1) las credenciales b\u00e1sicas HTTP se validan en el lado HTTPD en un contenedor separado, no en el servicio Ironic en s\u00ed y 2) Ironic escucha en la red host en un puerto privado 6388 en localhost de forma predeterminada. Como resultado, cuando se utiliza el modo de proxy inverso, cualquier usuario Pod o Unix local en el plano de control Node puede acceder a la API Ironic en el puerto privado sin autenticaci\u00f3n. Un problema similar afecta a Ironic Inspector (`INSPECTOR_REVERSE_PROXY_SETUP` establecido en `true`), aunque el potencial de ataque es menor all\u00ed. Este problema afecta a los operadores que implementan ironic-image en el modo de proxy inverso, que es el modo recomendado cuando se usa TLS (tambi\u00e9n recomendado), con la variable `IRONIC_PRIVATE_PORT` desarmada o configurada en un valor num\u00e9rico. En este caso, un atacante con privilegios suficientes para iniciar un pod en el plano de control con red de host puede acceder a la API Ironic y usarla para modificar la m\u00e1quina b\u00e1sica, por ejemplo, aprovisionarla con una nueva imagen o cambiar la configuraci\u00f3n del BIOS. Esta vulnerabilidad se soluciona en 24.1.1."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-288"}]}], "references": [{"url": "https://github.com/metal3-io/ironic-image/commit/48e40bd30d49aefabac6fc80204a8650b13d10b4", "source": "security-advisories@github.com"}, {"url": "https://github.com/metal3-io/ironic-image/pull/494", "source": "security-advisories@github.com"}, {"url": "https://github.com/metal3-io/ironic-image/security/advisories/GHSA-g2cm-9v5f-qg7r", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1210: Exploitation of Removable Storage Devices", "comment": "CVE-2024-31463 - An attacker can use removable storage devices to exploit the vulnerability and access the Ironic API without authentication."}, {"techniqueID": "T1199: Customized malware", "comment": "CVE-2024-31463 - The attacker can create customized malware to take advantage of the vulnerability and access the Ironic API without authentication."}, {"techniqueID": "T1473: Job Control", "comment": "CVE-2024-31463 - The attacker can use job control to exploit the vulnerability and execute commands on the system without authentication."}, {"techniqueID": "T1078: Exploitation of Application Functionality", "comment": "CVE-2024-31463 - The attacker can exploit the functionality of the Ironic API to access and modify bare-metal machines without authentication."}], "stix_bundle": "https://example.com/cve-2024-31463/stix_bundle.xml", "technical_analysis": {"Introduction": "CVE-2024-31463 is a vulnerability in the Ironic-image software that allows an attacker to access the Ironic API without authentication when the reverse proxy mode is enabled.", "Impact and Scope": "The vulnerability has a CVSS score of 4.7 (MEDIUM) and is exploitable on Local (AV:L) systems with High Attack Complexity (AC:H) and Low Privileges Required (PR:L).", "Related MITRE ATT&CK Techniques": "The vulnerability can be used to exploit the T1210: Exploitation of Removable Storage Devices, T1199: Customized malware, T1473: Job Control, and T1078: Exploitation of Application Functionality techniques.", "Technical Details": "The vulnerability occurs when the `IRONIC_REVERSE_PROXY_SETUP` variable is set to `true` and the `IRONIC_PRIVATE_PORT` variable is unset or set to a numeric value.", "Detection": "To detect this vulnerability, monitoring tools can be used to identify and block suspicious traffic patterns and network communication.", "Mitigation": "The vulnerability can be mitigated by setting the `IRONIC_REVERSE_PROXY_SETUP` variable to `false` or setting the `IRONIC_PRIVATE_PORT` variable to a non-numeric value.", "Conclusion": "CVE-2024-31463 is a significant vulnerability that requires prompt attention and mitigation to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2024-31463 is a vulnerability in the Ironic-image software that can be exploited to access the Ironic API without authentication.", "Business Impact": "The vulnerability can result in unauthorized access to sensitive data and systems, which can lead to financial losses and reputational damage.", "Technical Impact": "The vulnerability can be used to exploit the T1210: Exploitation of Removable Storage Devices, T1199: Customized malware, T1473: Job Control, and T1078: Exploitation of Application Functionality techniques.", "Mitigation Strategies": "Prompt mitigation efforts are required to prevent exploitation of this vulnerability.", "Recommendations": "Executives are recommended to prioritize the mitigation of this vulnerability and ensure that the necessary security controls are in place to prevent exploitation.", "Conclusions": "The CVE-2024-31463 vulnerability is a high-priority concern that requires immediate attention and action to prevent exploitation and minimize the potential impact."}}