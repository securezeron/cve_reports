{"id": "CVE-2024-37151", "sourceIdentifier": "security-advisories@github.com", "published": "2024-07-11T15:15:11.847", "lastModified": "2024-07-12T18:46:55.207", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Suricata is a network Intrusion Detection System, Intrusion Prevention System and Network Security Monitoring engine. \nMishandling of multiple fragmented packets using the same IP ID value can lead to packet reassembly failure, which can lead to policy bypass. Upgrade to 7.0.6 or 6.0.20. When using af-packet, enable `defrag` to reduce the scope of the problem."}, {"lang": "es", "value": "Suricata es un sistema de detecci\u00f3n de intrusiones en la red, un sistema de prevenci\u00f3n de intrusiones y un motor de monitoreo de seguridad de la red. El mal manejo de varios paquetes fragmentados que utilizan el mismo valor de ID de IP puede provocar un error en el reensamblaje del paquete, lo que puede provocar una omisi\u00f3n de pol\u00edticas. Actualice a 7.0.6 o 6.0.20. Cuando utilice af-packet, habilite `defrag` para reducir el alcance del problema."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-754"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-754"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:oisf:suricata:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.0.0", "versionEndExcluding": "6.0.20", "matchCriteriaId": "C796A1DA-B8E9-45E4-BBCF-7673AB7DDC99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oisf:suricata:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.0.0", "versionEndExcluding": "7.0.6", "matchCriteriaId": "108D4F28-A795-4119-A750-9108C85201DC"}]}]}], "references": [{"url": "https://github.com/OISF/suricata/commit/9d5c4273cb7e5ca65f195f7361f0d848c85180e0", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/OISF/suricata/commit/aab7f35c76721df19403a7c0c0025feae12f3b6b", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/OISF/suricata/security/advisories/GHSA-qrp7-g66m-px24", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://redmine.openinfosecfoundation.org/issues/7041", "source": "security-advisories@github.com", "tags": ["Issue Tracking"]}, {"url": "https://redmine.openinfosecfoundation.org/issues/7042", "source": "security-advisories@github.com", "tags": ["Issue Tracking"]}], "techniques": [{"techniqueID": "T1021", "comment": "CVE-2024-37151 - This is a known vulnerability in Suricata, an open-source Intrusion Detection System (IDS) and Network Security Monitoring (NSM) engine. It is vulnerable to packet reassembly failure, which can lead to policy bypass. Defense against this can be achieved by upgrading to a patched version or applying a fix."}, {"techniqueID": "T1048", "comment": "CVE-2024-37151 - This vulnerability also allows an attacker to inject wrong packet sequence numbers, which can be used for evasion. Defense against this can be achieved by implementing strict packet sequence checking and validating packet order."}, {"techniqueID": "T1078", "comment": "CVE-2024-37151 - This vulnerability can also be used for data exfiltration by hijacking network traffic. Defense against this can be achieved by implementing strict network traffic inspection and monitoring."}, {"techniqueID": "T1200", "comment": "CVE-2024-37151 - This vulnerability can also be used for command and control (C2) communication by hijacking network traffic. Defense against this can be achieved by implementing strict network traffic inspection and monitoring."}], "stix_bundle": {"bundle": {"type": "bundle", "spec_version": "2.1", "id": "https://example.com/2024-07-12T15:15:11.847Z", "created_by_ref": "https://example.com/2024-07-12T15:15:11.847Z", "objects": [{"type": "incident", "id": "https://example.com/2024-07-12T15:15:11.847Z", "created_by_ref": "https://example.com/2024-07-12T15:15:11.847Z", "objects": [{"type": "vulnerability", "id": "https://example.com/2024-07-12T15:15:11.847Z", "description": "CVE-2024-37151", "cvssv3": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "baseScore": "7.5"}, "mitre_attack_techniques": [{"techniqueID": "T1021"}, {"techniqueID": "T1048"}, {"techniqueID": "T1078"}, {"techniqueID": "T1200"}]}]}]}}, "technical_analysis": {"Introduction": "Suricata is a network IDS/NSM engine that is vulnerable to a packet reassembly failure, which can lead to policy bypass.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 and affects versions 6.0.0 to 6.0.20 and 7.0.0 to 7.0.6.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1021, T1048, T1078, and T1200.", "Technical Details": "The vulnerability occurs when Suricata fails to assemble packets correctly, allowing an attacker to inject wrong packet sequence numbers, which can be used for evasion.", "Detection": "Detection can be achieved by monitoring network traffic for policy bypass and implementing strict packet sequence checking and validating packet order.", "Mitigation": "Mitigation strategies include upgrading to a patched version or applying a fix, implementing strict network traffic inspection and monitoring, and validating packet order.", "Conclusion": "In conclusion, this vulnerability is a serious threat that can be mitigated by implementing proper security measures."}, "executive_analysis": {"Overview": "The Suricata vulnerability is a critical security threat that can lead to policy bypass and data exfiltration.", "Business Impact": "The vulnerability can have significant business impact by allowing attackers to manipulate network traffic and steal valuable data.", "Technical Impact": "The vulnerability can have significant technical impact by allowing attackers to bypass security controls and exfiltrate data.", "Mitigation Strategies": "Mitigation strategies include upgrading to a patched version or applying a fix, implementing strict network traffic inspection and monitoring, and validating packet order.", "Recommendations": "We recommend upgrading to a patched version or applying a fix, and considering implementing strict network traffic inspection and monitoring tools.", "Conclusions": "In conclusion, this vulnerability is a serious threat that requires immediate attention and mitigation."}}