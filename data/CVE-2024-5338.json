{"id": "CVE-2024-5338", "sourceIdentifier": "cna@vuldb.com", "published": "2024-05-25T16:15:08.390", "lastModified": "2024-06-04T19:21:05.170", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A vulnerability was found in Ruijie RG-UAC up to 20240516. It has been classified as critical. Affected is an unknown function of the file /view/vpn/autovpn/online.php. The manipulation of the argument peernode leads to os command injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. The identifier of this vulnerability is VDB-266244. NOTE: The vendor was contacted early about this disclosure but did not respond in any way."}, {"lang": "es", "value": "Una vulnerabilidad fue encontrada en Ruijie RG-UAC hasta 20240516 y clasificada como cr\u00edtica. Una funci\u00f3n desconocida del archivo /view/vpn/autovpn/online.php es afectada por esta vulnerabilidad. La manipulaci\u00f3n del argumento peernode conduce a la inyecci\u00f3n de comandos del sistema operativo. Es posible lanzar el ataque de forma remota. El exploit ha sido divulgado al p\u00fablico y puede utilizarse. El identificador de esta vulnerabilidad es VDB-266244. NOTA: Se contact\u00f3 primeramente con el proveedor sobre esta divulgaci\u00f3n, pero no respondi\u00f3 de ninguna manera."}], "metrics": {"cvssMetricV40": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:N/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "attackVector": "NETWORK", "attackComplexity": "LOW", "attackRequirements": "NONE", "privilegesRequired": "HIGH", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "LOW", "vulnerableSystemIntegrity": "LOW", "vulnerableSystemAvailability": "LOW", "subsequentSystemConfidentiality": "NONE", "subsequentSystemIntegrity": "NONE", "subsequentSystemAvailability": "NONE", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NOT_DEFINED", "recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED", "baseScore": 5.1, "baseSeverity": "MEDIUM"}}], "cvssMetricV31": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:M/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "MULTIPLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 6.4, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "references": [{"url": "https://github.com/h0e4a0r1t/h0e4a0r1t.github.io/blob/master/2024/z%7CYVDv%7CHKA)*%5CdK!/Ruijie%20RG-UAC%20Unified%20Internet%20Behavior%20Management%20Audit%20System%20Backend%20RCE%20Vulnerability-autovpn%3Aonline.php.pdf", "source": "cna@vuldb.com"}, {"url": "https://vuldb.com/?ctiid.266244", "source": "cna@vuldb.com"}, {"url": "https://vuldb.com/?id.266244", "source": "cna@vuldb.com"}, {"url": "https://vuldb.com/?submit.336036", "source": "cna@vuldb.com"}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2024-5338 - Spearphishing via Employee Supplication is relevant because it can be used in conjunction with the vulnerability to launch a remote attack. Defending against this technique includes educating employees on the importance of verifying requests and using secure communication channels."}, {"techniqueID": "T1518", "comment": "CVE-2024-5338 - OS Command Injection is relevant because the vulnerability can be exploited to launch a command injection attack. Defending against this technique includes securing PHP code and limiting user input."}, {"techniqueID": "T1078", "comment": "CVE-2024-5338 - Web Shell is relevant because the vulnerability can be exploited to install a web shell. Defending against this technique includes monitoring web traffic and using web application firewalls."}], "stix_bundle": "...", "technical_analysis": {"Introduction": "The CVE-2024-5338 vulnerability affects the Ruijie RG-UAC unified internet behavior management audit system backend and can be exploited to launch an OS command injection attack.", "Impact and Scope": "The vulnerability has a CVSS score of 5.1 (Medium) and an attack vector of Network. It can be exploited remotely and has a low impact on confidentiality, integrity, and availability.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to the CVE-2024-5338 vulnerability: TA0001 (Spearphishing via Employee Supplication), T1518 (OS Command Injection), and T1078 (Web Shell).", "Technical Details": "The vulnerability exists in the online.php file of the Ruijie RG-UAC unified internet behavior management audit system backend and can be exploited by manipulating the peernode argument.", "Detection": "Detecting the vulnerability requires monitoring web traffic and analyzing system logs for suspicious activity. Defenders should also review system configurations and ensure that they are up-to-date.", "Mitigation": "Mitigating the vulnerability requires securing PHP code, limiting user input, and monitoring web traffic. Defenders should also educate employees on the importance of verifying requests and using secure communication channels.", "Conclusion": "The CVE-2024-5338 vulnerability is a significant threat to the Ruijie RG-UAC unified internet behavior management audit system backend and can be exploited to launch an OS command injection attack. Defenders should prioritize patching and implementing mitigation strategies to protect against this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-5338 vulnerability is a critical issue affecting the Ruijie RG-UAC unified internet behavior management audit system backend.", "Business Impact": "The vulnerability can be exploited to launch an OS command injection attack, which can have significant business impact, including compromised data and system stability.", "Technical Impact": "The vulnerability has a technical impact on the Ruijie RG-UAC unified internet behavior management audit system backend, including the potential for command injection and web shell installation.", "Mitigation Strategies": "Priority mitigation strategies include patching the vulnerability, securing PHP code, limiting user input, and monitoring web traffic.", "Recommendations": "Executives are recommended to prioritize patching and implementing mitigation strategies to protect against the CVE-2024-5338 vulnerability.", "Conclusions": "The CVE-2024-5338 vulnerability is a high-priority issue that requires immediate attention. Executives should work closely with their IT teams to prioritize mitigation strategies and ensure the protection of their systems and data."}}