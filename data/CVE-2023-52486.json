{"id": "CVE-2023-52486", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-03-11T18:15:16.427", "lastModified": "2024-06-27T13:15:53.220", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm: Don't unref the same fb many times by mistake due to deadlock handling\n\nIf we get a deadlock after the fb lookup in drm_mode_page_flip_ioctl()\nwe proceed to unref the fb and then retry the whole thing from the top.\nBut we forget to reset the fb pointer back to NULL, and so if we then\nget another error during the retry, before the fb lookup, we proceed\nthe unref the same fb again without having gotten another reference.\nThe end result is that the fb will (eventually) end up being freed\nwhile it's still in use.\n\nReset fb to NULL once we've unreffed it to avoid doing it again\nuntil we've done another fb lookup.\n\nThis turned out to be pretty easy to hit on a DG2 when doing async\nflips (and CONFIG_DEBUG_WW_MUTEX_SLOWPATH=y). The first symptom I\nsaw that drm_closefb() simply got stuck in a busy loop while walking\nthe framebuffer list. Fortunately I was able to convince it to oops\ninstead, and from there it was easier to track down the culprit."}, {"lang": "es", "value": "En el kernel de Linux se ha resuelto la siguiente vulnerabilidad: drm: No desreferenciar el mismo fb muchas veces por error debido al manejo de interbloqueos Si obtenemos un punto muerto despu\u00e9s de la b\u00fasqueda de fb en drm_mode_page_flip_ioctl() procedemos a desreferenciar el fb y luego Vuelva a intentarlo todo desde arriba. Pero nos olvidamos de restablecer el puntero fb a NULL, por lo que si obtenemos otro error durante el reintento, antes de la b\u00fasqueda de fb, procedemos a desref el mismo fb nuevamente sin haber obtenido otra referencia. El resultado final es que el Facebook (eventualmente) terminar\u00e1 siendo liberado mientras todav\u00eda est\u00e1 en uso. Restablezca fb a NULL una vez que lo hayamos eliminado para evitar hacerlo nuevamente hasta que hayamos realizado otra b\u00fasqueda de fb. Esto result\u00f3 ser bastante f\u00e1cil de lograr en un DG2 cuando se realizan volteos as\u00edncronos (y CONFIG_DEBUG_WW_MUTEX_SLOWPATH=y). El primer s\u00edntoma que vi fue que drm_closefb() simplemente se qued\u00f3 atascado en un bucle ocupado mientras recorr\u00eda la lista de framebuffer. Afortunadamente, pude convencerlo de que lo hiciera, y a partir de ah\u00ed fue m\u00e1s f\u00e1cil localizar al culpable."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/376e21a9e4c2c63ee5d8d3aa74be5082c3882229", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/62f2e79cf9f4f47cc9dea9cebdf58d9f7b5695e0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9dd334a8245011ace45e53298175c7b659edb3e7", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b4af63da9d94986c529d74499fdfe44289acd551", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/bfd0feb1b109cb63b87fdcd00122603787c75a1a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/cb4daf271302d71a6b9a7c01bd0b6d76febd8f0c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d7afdf360f4ac142832b098b4de974e867cc063c", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f55261469be87c55df13db76dc945f6bcd825105", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2023-52486 - The vulnerability allows for the potential of a deadlock or busy loop in the Linux kernel, potentially leading to a denial-of-service (DoS) condition. Defending against this involves updating the Linux kernel to the affected version, as well as implementing proper deadlock handling mechanisms."}, {"techniqueID": "T1574", "comment": "CVE-2023-52486 - The use of asynchronous flips in the Linux kernel without proper deadlock handling can lead to a busy loop or deadlock. Defending against this involves updating the Linux kernel to the affected version, as well as implementing proper deadlock handling mechanisms."}, {"techniqueID": "T1194", "comment": "CVE-2023-52486 - The vulnerability allows for the potential of a denial-of-service (DoS) condition in the Linux kernel. Defending against this involves updating the Linux kernel to the affected version, as well as implementing proper denial-of-service mitigation mechanisms."}], "stix_bundle": {"bundle_id": "CVE-2023-52486", "name": "Linux Kernel DRM Deadlock Vulnerability", "description": "A vulnerability in the Linux kernel's DRM subsystem allows for the potential of a deadlock or busy loop, potentially leading to a denial-of-service (DoS) condition.", "objects": [{"id": "Win32ExploitPackage-1", "type": "exploit", "name": "Linux Kernel DRM Exploit", "description": "An exploit that targets the Linux kernel's DRM subsystem to cause a deadlock or busy loop, potentially leading to a denial-of-service (DoS) condition.", "modified": "2024-03-11T18:15:16.427", "created": "2024-03-11T18:15:16.427", "objects_relation": [{"id": "cve-2023-52486", "type": "vulnerability", "relation": "exploited_by"}]}, {"id": "SoftwarePatch-1", "type": "patch", "name": "Linux Kernel DRM Patch", "description": "A software patch that addresses the vulnerability in the Linux kernel's DRM subsystem by implementing proper deadlock handling mechanisms.", "modified": "2024-06-27T13:15:53.220", "created": "2024-06-27T13:15:53.220", "objects_relation": [{"id": "cve-2023-52486", "type": "vulnerability", "relation": "patches"}]}], "relationship": [{"id": "exploit-rel-1", "type": "exploits", "entities": [{"id": "Win32ExploitPackage-1", "type": "exploit", "role": "exploit"}, {"id": "cve-2023-52486", "type": "vulnerability", "role": "vulnerability"}]}, {"id": "patch-rel-1", "type": "patches", "entities": [{"id": "SoftwarePatch-1", "type": "patch", "role": "patch"}, {"id": "cve-2023-52486", "type": "vulnerability", "role": "vulnerability"}]}]}, "technical_analysis": {"Introduction": "The Linux kernel's DRM subsystem is vulnerable to a deadlock or busy loop, potentially leading to a denial-of-service (DoS) condition.", "Impact and Scope": "The vulnerability allows for the potential of a denial-of-service (DoS) condition in the Linux kernel's DRM subsystem, with a CVSS score of 5.5 and an attack vector of ' Network'.", "Related MITRE ATT&CK Techniques": "T1190, T1574 and T1194", "Technical Details": "The vulnerability occurs when the DRM subsystem is used with asynchronous flips without proper deadlock handling mechanisms, leading to a potential deadlock or busy loop.", "Detection": "Methods for detecting the CVE include monitoring for signs of a denial-of-service (DoS) condition, such as high CPU utilization or network Traffic.", "Mitigation": "Mitigation strategies for the CVE include updating the Linux kernel to the affected version, implementing proper deadlock handling mechanisms, and using denial-of-service mitigation mechanisms.", "Conclusion": "In conclusion, the Linux kernel's DRM subsystem is vulnerable to a deadlock or busy loop, potentially leading to a denial-of-service (DoS) condition."}, "executive_analysis": {"Overview": "The Linux kernel's DRM subsystem is vulnerable to a deadlock or busy loop, potentially leading to a denial-of-service (DoS) condition.", "Business Impact": "The vulnerability has the potential to cause significant business disruption and financial loss.", "Technical Impact": "The vulnerability allows for the potential of a denial-of-service (DoS) condition in the Linux kernel's DRM subsystem, potentially leading to system crashes and instability.", "Mitigation Strategies": "Updating the Linux kernel to the affected version, implementing proper deadlock handling mechanisms, and using denial-of-service mitigation mechanisms.", "Recommendations": "Executives should prioritize updating the Linux kernel to the affected version and implementing proper deadlock handling mechanisms to minimize the risk of a denial-of-service (DoS) condition.", "Conclusions": "In conclusion, it is essential to address this vulnerability to minimize the risk of a denial-of-service (DoS) condition and ensure the stability of the Linux kernel's DRM subsystem."}}