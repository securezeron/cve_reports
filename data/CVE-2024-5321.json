{"id": "CVE-2024-5321", "sourceIdentifier": "jordan@liggitt.net", "published": "2024-07-18T19:15:12.607", "lastModified": "2024-07-19T13:01:44.567", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users\u00a0may be able to read container logs and NT AUTHORITY\\Authenticated Users\u00a0may be able to modify container logs."}, {"lang": "es", "value": "Se descubri\u00f3 un problema de seguridad en cl\u00fasteres de Kubernetes con nodos de Windows donde BUILTIN\\Users pueden leer registros de contenedores y NT AUTHORITY\\Authenticated Users pueden modificar registros de contenedores."}], "metrics": {"cvssMetricV31": [{"source": "jordan@liggitt.net", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 4.2}]}, "weaknesses": [{"source": "jordan@liggitt.net", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-276"}]}], "references": [{"url": "https://github.com/kubernetes/kubernetes/issues/126161", "source": "jordan@liggitt.net"}, {"url": "https://groups.google.com/g/kubernetes-security-announce/c/81c0BHkKNt0", "source": "jordan@liggitt.net"}], "techniques": [{"techniqueID": "T1566.001", "comment": "A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users may be able to read container logs and NT AUTHORITY\\Authenticated Users may be able to modify container logs - Unprivileged escalation of privileges on Windows nodes"}, {"techniqueID": "T1003.001", "comment": "A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users may be able to read container logs and NT AUTHORITY\\Authenticated Users may be able to modify container logs - Credential dump, leveraging existing credentials"}, {"techniqueID": "T1070", "comment": "A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users may be able to read container logs and NT AUTHORITY\\Authenticated Users may be able to modify container logs - Remote access to the compromised node for further lateral movement"}, {"techniqueID": "T1027.005", "comment": "A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users may be able to read container logs and NT AUTHORITY\\Authenticated Users may be able to modify container logs - Log collection, using existing log collection mechanisms"}, {"techniqueID": "T1521", "comment": "A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users may be able to read container logs and NT AUTHORITY\\Authenticated Users may be able to modify container logs - Network exploitation, using known vulnerabilities in network services"}], "stix_bundle": "/* This STIX 2.1 bundle represents the vulnerability and its related techniques, risks and defense strategies.\n\n*/ {\n  \"id\": \"urn:uuid:1e1a8de2-c0e5-4b4d-94a4-94a93ed68e4\",\n  \"type\": \"bundle\",\n  \"name\": \"CVE-2024-5321\",\n  \"created_by\": \"jordan@liggitt.net\",\n  \"created\": \"2024-07-18T19:15:12.607\",\n  \"modified\": \"2024-07-19T13:01:44.567\",\n  \"objects\": {\n    \"vulnerability\": {\n      \"id\": \"urn:uuid:27a1d2c2-ba4f-441f-9f4c-7efe9c5a5d8a\",\n      \"type\": \"vulnerability\",\n      \"name\": \"CVE-2024-5321\",\n      \"description\": [\n        {\n          \"lang\": \"en\",\n          \"value\": \"A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users\\u00a0may be able to read container logs and NT AUTHORITY\\Authenticated Users\\u00a0may be able to modify container logs.\"\n        }\n      ],\n      \"cvss\": {\n        \"version\": \"3.1\",\n        \"vectorString\": \"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N\",\n        \"attackVector\": \"LOCAL\",\n        \"attackComplexity\": \"LOW\",\n        \"privilegesRequired\": \"LOW\",\n        \"userInteraction\": \"NONE\",\n        \"scope\": \"UNCHANGED\",\n        \"confidentialityImpact\": \"HIGH\",\n        \"integrityImpact\": \"LOW\",\n        \"availabilityImpact\": \"NONE\",\n        \"baseScore\": 6.1,\n        \"baseSeverity\": \"MEDIUM\"\n      },\n      \"weaknesses\": [\n        {\n          \"id\": \"urn:uuid:ec82a9f0-5b2f-48e3-83bb-346e6d4e0d9a\",\n          \"type\": \"weakness\",\n          \"name\": \"CWE-276\",\n          \"description\": [\n            {\n              \"lang\": \"en\",\n              \"value\": \"CWE-276\"\n            }\n          ]\n        }\n      ],\n      \"references\": [\n        {\n          \"id\": \"urn:uuid:ec82a9f0-5b2f-48e3-83bb-346e6d4e0d9a\",\n          \"type\": \"reference\",\n          \"name\": \"https://github.com/kubernetes/kubernetes/issues/126161\",\n          \"description\": [\n            {\n              \"lang\": \"en\",\n              \"value\": \"https://github.com/kubernetes/kubernetes/issues/126161\"\n            }\n          ]\n        },\n        {\n          \"id\": \"urn:uuid:ec82a9f0-5b2f-48e3-83bb-346e6d4e0d9a\",\n          \"type\": \"reference\",\n          \"name\": \"https://groups.google.com/g/kubernetes-security-announce/c/81c0BHkKNt0\",\n          \"description\": [\n            {\n              \"lang\": \"en\",\n              \"value\": \"https://groups.google.com/g/kubernetes-security-announce/c/81c0BHkKNt0\"\n            }\n          ]\n        }\n      ],\n      \"related_techniques\": [\n        {\n          \"id\": \"urn:uuid:1e1a8de2-c0e5-4b4d-94a4-94a93ed68e4\",\n          \"type\": \"related_technique\",\n          \"name\": \"T1566.001\",\n          \"description\": [\n            {\n              \"lang\": \"en\",\n              \"value\": \"A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users\\u00a0may be able to read container logs and NT AUTHORITY\\Authenticated Users\\u00a0may be able to modify container logs - Unprivileged escalation of privileges on Windows nodes\"\n            }\n          ]\n        },\n        {\n          \"id\": \"urn:uuid:1e1a8de2-c0e5-4b4d-94a4-94a93ed68e4\",\n          \"type\": \"related_technique\",\n          \"name\": \"T1003.001\",\n          \"description\": [\n            {\n              \"lang\": \"en\",\n              \"value\": \"A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users\\u00a0may be able to read container logs and NT AUTHORITY\\Authenticated Users\\u00a0may be able to modify container logs - Credential dump, leveraging existing credentials\"\n            }\n          ]\n        },\n        {\n          \"id\": \"urn:uuid:1e1a8de2-c0e5-4b4d-94a4-94a93ed68e4\",\n          \"type\": \"related_technique\",\n          \"name\": \"T1070\",\n          \"description\": [\n            {\n              \"lang\": \"en\",\n              \"value\": \"A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users\\u00a0may be able to read container logs and NT AUTHORITY\\Authenticated Users\\u00a0may be able to modify container logs - Remote access to the compromised node for further lateral movement\"\n            }\n          ]\n        },\n        {\n          \"id\": \"urn:uuid:1e1a8de2-c0e5-4b4d-94a4-94a93ed68e4\",\n          \"type\": \"related_technique\",\n          \"name\": \"T1027.005\",\n          \"description\": [\n            {\n              \"lang\": \"en\",\n              \"value\": \"A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users\\u00a0may be able to read container logs and NT AUTHORITY\\Authenticated Users\\u00a0may be able to modify container logs - Log collection, using existing log collection mechanisms\"\n            }\n          ]\n        },\n        {\n          \"id\": \"urn:uuid:1e1a8de2-c0e5-4b4d-94a4-94a93ed68e4\",\n          \"type\": \"related_technique\",\n          \"name\": \"T1521\",\n          \"description\": [\n            {\n              \"lang\": \"en\",\n              \"value\": \"A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users\\u00a0may be able to read container logs and NT AUTHORITY\\Authenticated Users\\u00a0may be able to modify container logs - Network exploitation, using known vulnerabilities in network services\"\n            }\n          ]\n        }\n      ]\n    }\n  },\n  \"links\": {\n    \"related_techniques\": {\n      \"T1566.001\": \"urn:uuid:1e1a8de2-c0e5-4b4d-94a4-94a93ed68e4\",\n      \"T1003.001\": \"urn:uuid:1e1a8de2-c0e5-4b4d-94a4-94a93ed68e4\",\n      \"T1070\": \"urn:uuid:1e1a8de2-c0e5-4b4d-94a4-94a93ed68e4\",\n      \"T1027.005\": \"urn:uuid:1e1a8de2-c0e5-4b4d-94a4-94a93ed68e4\",\n      \"T1521\": \"urn:uuid:1e1a8de2-c0e5-4b4d-94a4-94a93ed68e4\"\n    }\n  }\n}\n", "technical_analysis": {"Introduction": "A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users may be able to read container logs and NT AUTHORITY\\Authenticated Users may be able to modify container logs.", "Impact and Scope": "The CVE-2024-5321 vulnerability has a CVSS score of 6.1 and an attack vector of LOCAL, meaning it can be exploited by a malicious actor with low-level access to the system. The vulnerability could allow an attacker to gain elevated privileges, dump credentials, access the network, and collect logs.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including T1566.001, T1003.001, T1070, T1027.005, and T1521.", "Technical Details": "The vulnerability is due to a lack of proper permission checks in the Kubernetes logging mechanism.", "Detection": "Detection of this vulnerability is difficult, as it requires observing unusual log access patterns.", "Mitigation": "To mitigate this vulnerability, administrators should implement proper permission checks for log access and ensure that only authorized users have access to sensitive data.", "Conclusion": "The CVE-2024-5321 vulnerability is a serious security issue that requires prompt attention and remediation."}, "executive_analysis": {"Overview": "A security issue was discovered in Kubernetes clusters with Windows nodes where BUILTIN\\Users may be able to read container logs and NT AUTHORITY\\Authenticated Users may be able to modify container logs.", "Business Impact": "The vulnerability could allow an attacker to gain elevated privileges, dump credentials, access the network, and collect logs, which could lead to significant business disruption and financial loss.", "Technical Impact": "The vulnerability has a significant technical impact, as it allows an attacker to gain elevated privileges, dump credentials, access the network, and collect logs.", "Mitigation Strategies": "The recommended mitigation strategies are to implement proper permission checks for log access and ensure that only authorized users have access to sensitive data.", "Recommendations": "It is recommended that administrators take immediate action to remediate this vulnerability and implement the recommended mitigation strategies.", "Conclusions": "The CVE-2024-5321 vulnerability is a significant security risk that requires prompt attention and remediation."}}