{"id": "CVE-2024-28175", "sourceIdentifier": "security-advisories@github.com", "published": "2024-03-13T21:16:00.570", "lastModified": "2024-03-14T12:52:16.723", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. Due to the improper URL protocols filtering of links specified in the `link.argocd.argoproj.io` annotations in the application summary component, an attacker can achieve cross-site scripting with elevated permissions. All unpatched versions of Argo CD starting with v1.0.0 are vulnerable to a cross-site scripting (XSS) bug allowing a malicious user to inject a javascript: link in the UI. When clicked by a victim user, the script will execute with the victim's permissions (up to and including admin). This vulnerability allows an attacker to perform arbitrary actions on behalf of the victim via the API, such as creating, modifying, and deleting Kubernetes resources. A patch for this vulnerability has been released in Argo CD versions v2.10.3 v2.9.8, and v2.8.12. There are no completely-safe workarounds besides upgrading. The safest alternative, if upgrading is not possible, would be to create a Kubernetes admission controller to reject any resources with an annotation starting with link.argocd.argoproj.io or reject the resource if the value use an improper URL protocol. This validation will need to be applied in all clusters managed by ArgoCD.\n\n"}, {"lang": "es", "value": "Argo CD es una herramienta declarativa de entrega continua de GitOps para Kubernetes. Debido al filtrado inadecuado de los protocolos URL de los enlaces especificados en las anotaciones `link.argocd.argoproj.io` en el componente de resumen de la aplicaci\u00f3n, un atacante puede lograr Cross Site Scripting con permisos elevados. Todas las versiones sin parches de Argo CD que comienzan con v1.0.0 son vulnerables a un error de Cross Site Scripting (XSS) que permite a un usuario malintencionado inyectar un enlace javascript: en la interfaz de usuario. Cuando un usuario v\u00edctima hace clic en \u00e9l, el script se ejecutar\u00e1 con los permisos de la v\u00edctima (hasta administrador incluido). Esta vulnerabilidad permite a un atacante realizar acciones arbitrarias en nombre de la v\u00edctima a trav\u00e9s de la API, como crear, modificar y eliminar recursos de Kubernetes. Se lanz\u00f3 un parche para esta vulnerabilidad en las versiones de Argo CD v2.10.3 v2.9.8 y v2.8.12. No existen soluciones alternativas completamente seguras adem\u00e1s de actualizar. La alternativa m\u00e1s segura, si no es posible la actualizaci\u00f3n, ser\u00eda crear un controlador de admisi\u00f3n de Kubernetes para rechazar cualquier recurso con una anotaci\u00f3n que comience con link.argocd.argoproj.io o rechazar el recurso si el valor utiliza un protocolo URL inadecuado. Esta validaci\u00f3n deber\u00e1 aplicarse en todos los cl\u00fasteres gestionados por ArgoCD."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.3, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "references": [{"url": "https://github.com/argoproj/argo-cd/commit/479b5544b57dc9ef767d49f7003f39602c480b71", "source": "security-advisories@github.com"}, {"url": "https://github.com/argoproj/argo-cd/security/advisories/GHSA-jwv5-8mqv-g387", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-28175: Argo CD Cross-Site Scripting - This technique is relevant as an attacker can inject a script: link in the UI to perform arbitrary actions on behalf of the victim via the API."}, {"techniqueID": "T1087", "comment": "CVE-2024-28175: Argo CD Cross-Site Scripting - This technique is relevant as an attacker can inject a script: link in the UI to perform arbitrary actions on behalf of the victim via the API."}, {"techniqueID": "T1192", "comment": "CVE-2024-28175: Argo CD Cross-Site Scripting - This technique is relevant as an attacker can inject a script: link in the UI to perform arbitrary actions on behalf of the victim via the API."}], "stix_bundle": {"stix": [{"type": "report", "id": "http://CVE-2024-28175-report", "created_by_ref": "http://MITRE_ANALYST", "created": "2024-03-13T21:16:00.570", "title": "CVE-2024-28175: Argo CD Cross-Site Scripting", "description": "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. Due to the improper URL protocols filtering of links specified in the link.argocd.argoproj.io annotations in the application summary component, an attacker can achieve cross-site scripting with elevated permissions.", "object_marking_refs": ["http://my_marking"], "based_on_ref": "http://CVE-2024-28175"}, {"type": "course-of-action", "id": "http://COA-DEFENSE-TACTIC-1", "title": "Defense Tactic 1", "description": "Defense Tactic 1 details.", "related_tactics_refs": ["T1190", "T1087", "T1192"], "based_on_ref": "http://CVE-2024-28175"}, {"type": "course-of-action", "id": "http://COA-DEFENSE-TACTIC-2", "title": "Defense Tactic 2", "description": "Defense Tactic 2 details.", "related_tactics_refs": ["T1190", "T1087", "T1192"], "based_on_ref": "http://CVE-2024-28175"}], "objects": [{"type": "vulnerability", "id": "http://CVE-2024-28175", "name": "CVE-2024-28175: Argo CD Cross-Site Scripting", "description": "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. Due to the improper URL protocols filtering of links specified in the link.argocd.argoproj.io annotations in the application summary component, an attacker can achieve cross-site scripting with elevated permissions.", "cvss": {"version": "3.1", "vector_string": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H", "base_severity": "CRITICAL"}}], "relationship": [{"id": "http://Relationship-1", "type": "related_to", "target_ref": "http://COA-DEFENSE-TACTIC-1", "source_ref": "http://CVE-2024-28175"}, {"id": "http://Relationship-2", "type": "related_to", "target_ref": "http://COA-DEFENSE-TACTIC-2", "source_ref": "http://CVE-2024-28175"}]}, "technical_analysis": {"Introduction": "Argo CD is a declarative, GitOps continuous delivery tool for Kubernetes. Due to the improper URL protocols filtering of links specified in the link.argocd.argoproj.io annotations in the application summary component, an attacker can achieve cross-site scripting with elevated permissions.", "Impact and Scope": "The vulnerability allows an attacker to perform arbitrary actions on behalf of the victim via the API, such as creating, modifying, and deleting Kubernetes resources.", "Related MITRE ATT&CK Techniques": "T1190, T1087, T1192", "Technical Details": "The vulnerability exists due to the improper URL protocols filtering of links specified in the link.argocd.argoproj.io annotations in the application summary component.", "Detection": "Detection methods.", "Mitigation": "Mitigation strategies include creating a Kubernetes admission controller to reject any resources with an annotation starting with link.argocd.argoproj.io or rejecting the resource if the value uses an improper URL protocol.", "Conclusion": "Summary of the vulnerability."}, "executive_analysis": {"Overview": "Overview of the vulnerability.", "Business Impact": "Explanation of the business impact of the vulnerability.", "Technical Impact": "Explanation of the technical impact of the vulnerability.", "Mitigation Strategies": "High-level mitigation strategies include creating a Kubernetes admission controller to reject any resources with an annotation starting with link.argocd.argoproj.io or rejecting the resource if the value uses an improper URL protocol.", "Recommendations": "Recommendations for executives.", "Conclusions": "Final conclusions and next steps."}}