{"id": "CVE-2020-15400", "sourceIdentifier": "cve@mitre.org", "published": "2020-06-30T12:15:12.587", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "CakePHP before 4.0.6 mishandles CSRF token generation. This might be remotely exploitable in conjunction with XSS."}, {"lang": "es", "value": "CakePHP versiones anteriores a  4.0.6, maneja inapropiadamente una generaci\u00f3n de tokens CSRF. Esto podr\u00eda ser explotable remotamente junto con un ataque de tipo XSS"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:cakefoundation:cakephp:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.0.6", "matchCriteriaId": "B30D3014-CBF2-4D4C-8AD8-62FCDD5FCFFC"}]}]}], "references": [{"url": "https://bakery.cakephp.org/2020/04/18/cakephp_406_released.html", "source": "cve@mitre.org", "tags": ["Release Notes", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1068", "comment": "CVE-2020-15400 - An attacker could exploit this vulnerability by injecting malicious code into a CSRF token, allowing them to perform unintended actions on a user's behalf. This is a potential example of a cross-site scripting (XSS) vulnerability, and defenders should consider implementing measures to protect against XSS attacks."}, {"techniqueID": "T1204", "comment": "CVE-2020-15400 - The exploitation of this vulnerability could involve the use of a web shell, allowing an attacker to execute malicious commands on the victim's system. Detecting for unusual web shell traffic patterns or monitoring for suspicious changes in the web application could help identify potential exploitation attempts."}, {"techniqueID": "T1505", "comment": "CVE-2020-15400 - An attacker exploiting this vulnerability may seek to gain access to sensitive files or directories, potentially allowing them to steal or modify critical data. Defenders should consider implementing strict access controls and monitoring for unauthorized access attempts."}], "stix_bundle": "{\"bundle\": {\n  \"objects\": [\n    {\n      \"id\": \"vuln:CVE-2020-15400\",\n      \"type\": \"indicator\",\n      \"spec_version\": \"2.1\",\n      \"stix_id\": \"indicator:vuln:CVE-2020-15400\",\n      \"created_by\": \"MITRE\",\n      \"title\": \"CVE-2020-15400 - CakePHP CSRF token generation vulnerability\",\n      \"description\": \"A vulnerability in CakePHP before 4.0.6 allows an attacker to inject malicious code into a CSRF token, leading to unintended actions on a user's behalf.\",\n      \"first_seen\": \"2020-06-30T12:15:12.587Z\",\n      \"last_seen\": \"2021-07-21T11:39:23.747Z\",\n      \"data_stream\": \"MITRE\",\n      \"objects\": [\n        {\n          \"id\": \"tactic:T1204\",\n          \"type\": \"attack_pattern\",\n          \"spec_version\": \"2.1\",\n          \"stix_id\": \"attack_pattern:tactic:T1204\",\n          \"created_by\": \"MITRE\",\n          \"title\": \"Web Shell\",\n          \"description\": \"An attacker creates a web shell to execute commands on the victim's system.\",\n          \"relations\": [\n            {\n              \"type\": \"uses\",\n              \"id_ref\": \"vuln:CVE-2020-15400\"\n            }\n          ]\n        },\n        {\n          \"id\": \"technique:T1505\",\n          \"type\": \"attack_pattern\",\n          \"spec_version\": \"2.1\",\n          \"stix_id\": \"attack_pattern:technique:T1505\",\n          \"created_by\": \"MITRE\",\n          \"title\": \"File and Directory Discovery\",\n          \"description\": \"An attacker seeks to gain access to sensitive files or directories.\",\n          \"relations\": [\n            {\n              \"type\": \"uses\",\n              \"id_ref\": \"vuln:CVE-2020-15400\"\n            }\n          ]\n        },\n        {\n          \"id\": \"technique:T1068\",\n          \"type\": \"attack_pattern\",\n          \"spec_version\": \"2.1\",\n          \"stix_id\": \"attack_pattern:technique:T1068\",\n          \"created_by\": \"MITRE\",\n          \"title\": \"Exfiltration Over Command and Control Channel\",\n          \"description\": \"An attacker exfiltrates data through a command and control channel.\",\n          \"relations\": [\n            {\n              \"type\": \"uses\",\n              \"id_ref\": \"vuln:CVE-2020-15400\"\n            }\n          ]\n        }\n      ]\n    }\n  ],\n  \"incidents\": [],\n  \"observables\": []\n}}", "technical_analysis": {"Introduction": "CVE-2020-15400 is a vulnerability in CakePHP before 4.0.6 that allows an attacker to inject malicious code into a CSRF token, leading to unintended actions on a user's behalf.", "Impact and Scope": "The vulnerability has a CVSS score of 4.3 with a high attack complexity, and it affects all versions of CakePHP prior to 4.0.6.", "Related MITRE ATT&CK Techniques": "T1068, T1204, and T1505", "Technical Details": "The vulnerability occurs when a CSRF token is generated without proper validation or sanitization, allowing an attacker to inject malicious code into the token.", "Detection": "Defenders can detect this vulnerability by monitoring for unusual web shell traffic patterns or monitoring for suspicious changes in the web application.", "Mitigation": "The vulnerability can be mitigated by updating to CakePHP 4.0.6 or later, implementing strict access controls, and monitoring for unauthorized access attempts.", "Conclusion": "In conclusion, CVE-2020-15400 is a high-risk vulnerability that requires immediate attention and action to patch and protect against."}, "executive_analysis": {"Overview": "CVE-2020-15400 is a critical vulnerability in CakePHP that allows an attacker to inject malicious code into a CSRF token, potentially leading to unintended actions on a user's behalf.", "Business Impact": "The vulnerability could result in significant business losses and reputational damage if exploited.", "Technical Impact": "The vulnerability affects all versions of CakePHP prior to 4.0.6, making it a high-priority patching requirement.", "Mitigation Strategies": "Implementing strict access controls, monitoring for unauthorized access attempts, and updating to CakePHP 4.0.6 or later can help mitigate the vulnerability.", "Recommendations": "Executives should prioritize patching this vulnerability and provide resources for implementing mitigation strategies.", "Conclusions": "In conclusion, CVE-2020-15400 is a critical vulnerability that requires immediate attention and action to patch and protect against."}}