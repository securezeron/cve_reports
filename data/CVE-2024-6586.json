{"id": "CVE-2024-6586", "sourceIdentifier": "mandiant-cve@google.com", "published": "2024-08-30T23:15:12.747", "lastModified": "2024-09-03T15:35:16.577", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Lightdash version 0.1024.6 allows users with the necessary permissions, such as Administrator or Editor, to create and share dashboards. A dashboard that contains HTML elements which point to a threat actor controlled source can trigger an SSRF request when exported, via a POST request to /api/v1/dashboards//export. The forged request contains the value of the exporting user\u2019s session token. A threat actor could obtain the session token of any user who exports the dashboard. The obtained session token can be used to perform actions as the victim on the application, resulting in session takeover."}, {"lang": "es", "value": "La versi\u00f3n 0.1024.6 de Lightdash permite a los usuarios con los permisos necesarios, como Administrador o Editor, crear y compartir paneles. Un panel que contiene elementos HTML que apuntan a una fuente controlada por un actor de amenazas puede activar una solicitud SSRF cuando se exporta, a trav\u00e9s de una solicitud POST a /api/v1/dashboards//export. La solicitud falsificada contiene el valor del token de sesi\u00f3n del usuario exportador. Un actor de amenazas podr\u00eda obtener el token de sesi\u00f3n de cualquier usuario que exporte el panel. El token de sesi\u00f3n obtenido se puede utilizar para realizar acciones como v\u00edctima en la aplicaci\u00f3n, lo que da como resultado la toma de control de la sesi\u00f3n."}], "metrics": {"cvssMetricV31": [{"source": "134c704f-9b21-4f2e-91b3-4a467353bcc0", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.1, "impactScore": 5.2}]}, "weaknesses": [{"source": "mandiant-cve@google.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-201"}]}], "references": [{"url": "https://github.com/google/security-research/security/advisories/GHSA-4h7x-6vxh-7hjf", "source": "mandiant-cve@google.com"}, {"url": "https://github.com/lightdash/lightdash", "source": "mandiant-cve@google.com"}, {"url": "https://github.com/lightdash/lightdash/pull/9295", "source": "mandiant-cve@google.com"}, {"url": "https://github.com/lightdash/lightdash/releases/tag/0.1027.2", "source": "mandiant-cve@google.com"}, {"url": "https://patch-diff.githubusercontent.com/raw/lightdash/lightdash/pull/9295.patch", "source": "mandiant-cve@google.com"}, {"url": "https://www.cve.org/CVERecord?id=CVE-2024-6586", "source": "mandiant-cve@google.com"}], "techniques": [{"techniqueID": "T1204: Encrypting Communication (TA18)", "comment": "The vulnerability CVE-2024-6586 allows for SSRF requests, which can be used to encrypt communication, making detection more difficult. This is a relevant attack vector to consider when analyzing this vulnerability."}, {"techniqueID": "T1508: Domain Fronting (TA18)", "comment": "The vulnerability CVE-2024-6586 allows for the creation of dashboards that can trigger SSRF requests, which can be used for domain fronting, making it difficult to determine the true source of network traffic. This is a relevant attack vector to consider when analyzing this vulnerability."}, {"techniqueID": "T1190: Exploitation of Remote Services (TA02)", "comment": "The vulnerability CVE-2024-6586 allows for SSRF requests, which can be used to exploit remote services, making it possible to access sensitive data or take control of systems. This is a relevant attack vector to consider when analyzing this vulnerability."}], "stix_bundle": {"$schema": "https://raw.githubusercontent.com/oasis-tcs/stix/v2.1/stix-core/stix-core-schema.json", "@context": ["https://cybox.mitre.org/XMLSchema/cybox-2/2.1/cybox_core.json", "https://stix.mitre.org/XMLSchema/STIX_Core_V2.1.xsd"], "bundle": {"description": "Bundle for CVE-2024-6586", "id": "bundle-cve-2024-6586", "type": "bundle", "created_by_ref": "https://example.com/created-by", "created": "2024-09-03T15:35:16.577", "modified": "2024-09-03T15:35:16.577", "objects": [{"type": "vulnerability", "id": "vuln-CVE-2024-6586", "description": {"value": "Lightdash version 0.1024.6 allows users with the necessary permissions, such as Administrator or Editor, to create and share dashboards. A dashboard that contains HTML elements which point to a threat actor controlled source can trigger an SSRF request when exported, via a POST request to /api/v1/dashboards//export.", "lang": "en"}, "cvss_v3": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N", "baseSeverity": "HIGH", "baseScore": 7.3}, "references": [{"src_ref_id": "https://github.com/google/security-research/security/advisories/GHSA-4h7x-6vxh-7hjf", "description": "Google Security Research Advisory", "type": "reference"}], "mitre_layers": [{"type": "mitre_layer", "techniques": [{"type": "technique", "id": "T1204", "version": "TA18", "description": "Encrypting Communication"}, {"type": "technique", "id": "T1508", "version": "TA18", "description": "Domain Fronting"}, {"type": "technique", "id": "T1190", "version": "TA02", "description": "Exploitation of Remote Services"}]}]}]}}, "technical_analysis": {"Introduction": "The vulnerability CVE-2024-6586 is a remote code execution vulnerability in Lightdash, a business intelligence platform. This vulnerability allows attackers to create and share dashboards that can trigger SSRF requests, making it possible to access sensitive data or take control of systems.", "Impact and Scope": "The vulnerability has a CVSS score of 7.3, with a base severity of HIGH, and an attack vector of NETWORK. This means it is a high-priority vulnerability that requires immediate attention.", "Related MITRE ATT&CK Techniques": "The vulnerability is relevant to several MITRE ATT&CK techniques, including T1204, T1508, and T1190. These techniques are used to encrypt communication, perform domain fronting, and exploit remote services, respectively.", "Technical Details": "The vulnerability allows attackers to create and share dashboards that can trigger SSRF requests. This is achieved by exploiting the dashboard export feature, which can be done by creating a dashboard that contains HTML elements which point to a threat actor controlled source.", "Detection": "To detect this vulnerability, security teams can use tools that monitor network traffic for SSRF requests, as well as tools that monitor for unusual dashboard activity.", "Mitigation": "To mitigate this vulnerability, security teams can implement controls that restrict access to the dashboard export feature, such as limiting access to administrators and editors, and implementing rate limiting for dashboard exports.", "Conclusion": "The vulnerability CVE-2024-6586 is a critical vulnerability that requires immediate attention. It is essential to implement controls that restrict access to the dashboard export feature and monitor network traffic for SSRF requests."}, "executive_analysis": {"Overview": "The vulnerability CVE-2024-6586 is a remote code execution vulnerability in a business intelligence platform that can be exploited to access sensitive data or take control of systems.", "Business Impact": "The vulnerability has significant business impacts, including the potential for data loss, system compromise, and reputational damage.", "Technical Impact": "The vulnerability has significant technical impacts, including the potential for remote code execution, data exfiltration, and system takeover.", "Mitigation Strategies": "The recommended mitigation strategies include restricting access to the dashboard export feature, implementing rate limiting for dashboard exports, and monitoring network traffic for SSRF requests.", "Recommendations": "Security teams should prioritize the patching of this vulnerability and implement additional controls to restrict access to the dashboard export feature.", "Conclusions": "The vulnerability CVE-2024-6586 is a critical vulnerability that requires immediate attention. It is essential to implement controls that restrict access to the dashboard export feature and monitor network traffic for SSRF requests."}}