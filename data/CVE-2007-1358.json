{"id": "CVE-2007-1358", "sourceIdentifier": "secalert@redhat.com", "published": "2007-05-10T00:19:00.000", "lastModified": "2023-11-07T02:00:22.203", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in certain applications using Apache Tomcat 4.0.0 through 4.0.6 and 4.1.0 through 4.1.34 allows remote attackers to inject arbitrary web script or HTML via crafted \"Accept-Language headers that do not conform to RFC 2616\"."}, {"lang": "es", "value": "Vulnerabilidad de secuencias de comandos en sitios cruzados (XSS) en ciertas aplicaciones que usan Apache Tomcat 4.0.0 hasta 4.0.6 y 4.1.0 hasta 4.1.34 permite a atacantes remotos inyectar secuencias de comandos web o HTML de su elecci\u00f3n mediante \"cabeceras Accept-Language que no cumplen la RFC 2616\" artesanales."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:H/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "HIGH", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 2.6}, "baseSeverity": "LOW", "exploitabilityScore": 4.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:tomcat:*:*:*:*:*:*:*:*", "versionEndIncluding": "4.1.31", "matchCriteriaId": "CBB47E3B-ECDD-4A05-9920-90696089C4C0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:tomcat:4.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "914E1404-01A2-4F94-AA40-D5EA20F55AD3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:tomcat:4.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "81FB1106-B26D-45BE-A511-8E69131BBA52"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:tomcat:4.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "401A213A-FED3-49C0-B823-2E02EA528905"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:tomcat:4.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "0BFE5AD8-DB14-4632-9D2A-F2013579CA7D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:tomcat:4.0.4:*:*:*:*:*:*:*", "matchCriteriaId": "7641278D-3B8B-4CD2-B284-2047B65514A2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:tomcat:4.0.5:*:*:*:*:*:*:*", "matchCriteriaId": "BB7B9911-E836-4A96-A0E8-D13C957EC0EE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:tomcat:4.0.6:*:*:*:*:*:*:*", "matchCriteriaId": "D2341C51-A239-4A4A-B0DC-30F18175442C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:tomcat:4.1.0:*:*:*:*:*:*:*", "matchCriteriaId": "0E300013-0CE7-4313-A553-74A6A247B3E9"}]}]}], "references": [{"url": "http://community.ca.com/blogs/casecurityresponseblog/archive/2009/01/23.aspx", "source": "secalert@redhat.com"}, {"url": "http://docs.info.apple.com/article.html?artnum=306172", "source": "secalert@redhat.com"}, {"url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c01178795", "source": "secalert@redhat.com"}, {"url": "http://jvn.jp/jp/JVN%2316535199/index.html", "source": "secalert@redhat.com"}, {"url": "http://lists.apple.com/archives/security-announce//2007/Jul/msg00004.html", "source": "secalert@redhat.com"}, {"url": "http://osvdb.org/34881", "source": "secalert@redhat.com"}, {"url": "http://rhn.redhat.com/errata/RHSA-2008-0630.html", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/25721", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/26235", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/26660", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/27037", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/27727", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/30899", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/30908", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/31493", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/33668", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://sunsolve.sun.com/search/document.do?assetkey=1-26-239312-1", "source": "secalert@redhat.com"}, {"url": "http://support.ca.com/irj/portal/anonymous/phpsupcontent?contentID=197540", "source": "secalert@redhat.com"}, {"url": "http://tomcat.apache.org/security-4.html", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://www.fujitsu.com/global/support/software/security/products-f/interstage-200704e.html", "source": "secalert@redhat.com"}, {"url": "http://www.redhat.com/support/errata/RHSA-2008-0261.html", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/archive/1/471719/100/0/threaded", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/archive/1/500396/100/0/threaded", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/archive/1/500412/100/0/threaded", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/bid/24524", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/bid/25159", "source": "secalert@redhat.com"}, {"url": "http://www.securitytracker.com/id?1018269", "source": "secalert@redhat.com"}, {"url": "http://www.vupen.com/english/advisories/2007/1729", "source": "secalert@redhat.com"}, {"url": "http://www.vupen.com/english/advisories/2007/2732", "source": "secalert@redhat.com"}, {"url": "http://www.vupen.com/english/advisories/2007/3087", "source": "secalert@redhat.com"}, {"url": "http://www.vupen.com/english/advisories/2007/3386", "source": "secalert@redhat.com"}, {"url": "http://www.vupen.com/english/advisories/2008/1979/references", "source": "secalert@redhat.com"}, {"url": "http://www.vupen.com/english/advisories/2009/0233", "source": "secalert@redhat.com"}, {"url": "https://lists.apache.org/thread.html/29dc6c2b625789e70a9c4756b5a327e6547273ff8bde7e0327af48c5%40%3Cdev.tomcat.apache.org%3E", "source": "secalert@redhat.com"}, {"url": "https://lists.apache.org/thread.html/c62b0e3a7bf23342352a5810c640a94b6db69957c5c19db507004d74%40%3Cdev.tomcat.apache.org%3E", "source": "secalert@redhat.com"}, {"url": "https://lists.apache.org/thread.html/rb71997f506c6cc8b530dd845c084995a9878098846c7b4eacfae8db3%40%3Cdev.tomcat.apache.org%3E", "source": "secalert@redhat.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A10679", "source": "secalert@redhat.com"}, {"url": "https://www.redhat.com/archives/fedora-package-announce/2007-November/msg00525.html", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1059: Command and Control", "comment": "The attacker may use command and control (C2) channels to communicate with the compromised Apache Tomcat server, which could be exploited to achieve Code Execution and Web Shell. This is relevant because any C2 channel can be used to control the compromised server and execute malicious code. To defend against this, implement security measures such as network segmentation, and use of Web Application Firewalls."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": " Apache Tomcat is a public-facing application that can be targeted by attackers to exploit the vulnerability. The attacker may use publicly available exploits to exploit the vulnerability and gain access to the system. This is relevant because public-facing applications are more vulnerable to attacks. To defend against this, ensure that public-facing applications are updated regularly and use a web application firewall."}, {"techniqueID": "T1078: Exploitation of Remote Services", "comment": "The compromised Apache Tomcat server may be used to exploit remote services, which could be used to gain access to other systems on the network. This is relevant because remote services can be used to pivot and gain access to other systems. To defend against this, ensure that remote services are properly configured and monitored."}, {"techniqueID": "T1552: Modifying Existing Content", "comment": "The attacker may use the vulnerability to modify existing content on the compromised Apache Tomcat server, which could be used to maintain access to the system. This is relevant because existing content can be used to maintain access to the system. To defend against this, implement security measures such as monitoring and log analysis."}, {"techniqueID": "T1231: Remote File Copy", "comment": "The attacker may use the vulnerability to copy files from the compromised Apache Tomcat server to a remote location, which could be used to exfiltrate data. This is relevant because remote file copy can be used to exfiltrate data. To defend against this, implement security measures such as monitoring and log analysis."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve-2007-1358", "name": "CVE-2007-1358", "created": "2023-11-07T02:00:22.203", "modified": "2023-11-07T02:00:22.203", "description": "Cross-site scripting (XSS) vulnerability in certain applications using Apache Tomcat 4.0.0 through 4.0.6 and 4.1.0 through 4.1.34 allows remote attackers to inject arbitrary web script or HTML via crafted 'Accept-Language headers that do not conform to RFC 2616'.", "objects": [{"type": "vulnerability", "id": "https://example.com/cve-2007-1358", "name": "CVE-2007-1358", "description": "Cross-site scripting (XSS) vulnerability in certain applications using Apache Tomcat 4.0.0 through 4.0.6 and 4.1.0 through 4.1.34 allows remote attackers to inject arbitrary web script or HTML via crafted 'Accept-Language headers that do not conform to RFC 2616'.", "properties": {"cvss": {"score": 2.6, "vectorString": "AV:N/AC:H/Au:N/C:N/I:P/A:N"}}}], "relationships": [{"type": "relates_to", "target_id": "https://example.com/cve-2007-1358", "source_id": "https://example.com/technique/T1059", "relationship": "exploits"}, {"type": "relates_to", "target_id": "https://example.com/cve-2007-1358", "source_id": "https://example.com/technique/T1190", "relationship": "exploits"}, {"type": "relates_to", "target_id": "https://example.com/cve-2007-1358", "source_id": "https://example.com/technique/T1078", "relationship": "exploits"}, {"type": "relates_to", "target_id": "https://example.com/cve-2007-1358", "source_id": "https://example.com/technique/T1552", "relationship": "mitigates"}, {"type": "relates_to", "target_id": "https://example.com/cve-2007-1358", "source_id": "https://example.com/technique/T1231", "relationship": "mitigates"}]}, "technical_analysis": {"Introduction": "Apache Tomcat is a widely used web server software that is vulnerable to a cross-site scripting (XSS) vulnerability. The vulnerability exists because Tomcat does not properly validate user-supplied input.", "Impact and Scope": "The impact of this vulnerability is that an attacker can inject arbitrary web script or HTML into the affected application, allowing them to steal sensitive data or take control of the application. The scope of the vulnerability is all applications that use Apache Tomcat 4.0.0 through 4.0.6 and 4.1.0 through 4.1.34.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1059, T1190, T1078, T1552, and T1231.", "Technical Details": "The vulnerability exists in the Tomcat HTTP processor when handling HTTP requests with specially crafted 'Accept-Language' headers. An attacker can exploit this vulnerability by sending a request with a malicious 'Accept-Language' header that contains a script or HTML code.", "Detection": " Detection of this vulnerability can be done by monitoring the application's logs for suspicious activity, such as unusual HTTP requests or unusual behavior from users.", "Mitigation": "The mitigation for this vulnerability is to upgrade to a version of Apache Tomcat that is not vulnerable to this exploit, or to apply the Tomcat patches that fix this vulnerability.", "Conclusion": "In conclusion, the Apache Tomcat XSS vulnerability is a serious security risk that can be exploited by attackers to inject malicious code into the affected application. It is essential to upgrade to a version of Apache Tomcat that is not vulnerable to this exploit, or to apply the Tomcat patches that fix this vulnerability."}, "executive_analysis": {"Overview": "The Apache Tomcat XSS vulnerability is a critical security risk that can be exploited by attackers to inject malicious code into the affected application.", "Business Impact": "The business impact of this vulnerability is that it can compromise sensitive data and put the organization's reputation at risk.", "Technical Impact": "The technical impact of this vulnerability is that it can allow attackers to inject malicious code into the affected application, which can be used to steal sensitive data or take control of the application.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are to upgrade to a version of Apache Tomcat that is not vulnerable to this exploit, or to apply the Tomcat patches that fix this vulnerability.", "Recommendations": "Recommendations for executives are to prioritize the patching and upgrading of Apache Tomcat, and to ensure that all applications that use Apache Tomcat are properly configured and monitored.", "Conclusions": "In conclusion, the Apache Tomcat XSS vulnerability is a critical security risk that requires immediate attention. Executives should prioritize the patching and upgrading of Apache Tomcat, and ensure that all applications that use Apache Tomcat are properly configured and monitored."}}