{"id": "CVE-2024-7634", "sourceIdentifier": "f5sirt@f5.com", "published": "2024-08-22T18:15:10.553", "lastModified": "2024-08-23T16:18:28.547", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "NGINX Agent's \"config_dirs\" restriction feature allows a highly privileged attacker to gain the ability to write/overwrite files outside of the designated secure directory."}, {"lang": "es", "value": "La funci\u00f3n de restricci\u00f3n \"config_dirs\" del agente NGINX permite a un atacante con privilegios elevados obtener la capacidad de escribir/sobrescribir archivos fuera del directorio seguro designado."}], "metrics": {"cvssMetricV40": [{"source": "f5sirt@f5.com", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "attackVector": "NETWORK", "attackComplexity": "LOW", "attackRequirements": "NONE", "privilegesRequired": "HIGH", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "NONE", "vulnerableSystemIntegrity": "HIGH", "vulnerableSystemAvailability": "NONE", "subsequentSystemConfidentiality": "NONE", "subsequentSystemIntegrity": "NONE", "subsequentSystemAvailability": "NONE", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NOT_DEFINED", "recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED", "baseScore": 6.9, "baseSeverity": "MEDIUM"}}], "cvssMetricV31": [{"source": "f5sirt@f5.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.6}]}, "weaknesses": [{"source": "f5sirt@f5.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-22"}]}], "references": [{"url": "https://my.f5.com/manage/s/article/K000140630", "source": "f5sirt@f5.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2024-7634 - `NGINX Agent's config dirs' feature allows a highly privileged attacker to gain the ability to write/overwrite files outside of the designated secure directory, which can be used to facilitate privilege escalation and maintain persistence. This technique can be used to perform a file write operation to access sensitive data."}, {"techniqueID": "T1047", "comment": "CVE-2024-7634 - The attacker can use the file overwrite capability to delete or modify system files, which can impact confidentiality, integrity, and availability. This technique can be used to disrupt or destroy data."}, {"techniqueID": "T1027", "comment": "CVE-2024-7634 - The attacker can use the file overwrite capability to create or modify system files, which can be used to implement persistence or hide malicious code. This technique can be used to maintain persistence."}, {"techniqueID": "T1190", "comment": "CVE-2024-7634 - The attacker can use the privilege escalation capability to execute arbitrary system commands, which can be used to maintain persistence or perform lateral movement. This technique can be used to perform command execution."}], "stix_bundle": "{\"stix_bundle\":{\n    \"objects\":{\"vulnerability\":{\n        \"id\":\"CVE-2024-7634\",\n        \"severity\":\"MEDIUM\",\n        \"description\":{\"en\":\"NGINX Agent's config dirs' feature allows a highly privileged attacker to gain the ability to write/overwrite files outside of the designated secure directory.\",\"es\":\"La funci\u00f3n de restricci\u00f3n \"config_dirs\" del agente NGINX permite a un atacante con privilegios elevados obtener la capacidad de escribir/sobrescribir archivos fuera del directorio seguro designado.\"},\n        \"references\":[{\"url\":\"https://my.f5.com/manage/s/article/K000140630\",\"source\":\"f5sirt@f5.com\"}],\n        \"exploit_availability\":true,\n        \"exploit_maturity\":true,\n        \"cvss\":{\"v3.1\":{\"score\":4.9,\"vector\":\"CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:N\"},\"v4.0\":{\"score\":6.9,\"vector\":\"CVSS:4.0/AV:N/AC:L/AT:N/PR:H/UI:N/VC:N/VI:H/VA:N/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X\"}},\n        \"relatedINCattackPatterns\":[{\"id\":\"T1210\"},{\"id\":\"T1047\"},{\"id\":\"T1027\"},{\"id\":\"T1190\"}],\n        \"mitigations\":[{\"id\":\"D3FEND\",\"name\":\"DShield\",\"description\":\"DShield is a network-based system that collects and analyzes network traffic data, and provides real-time threat intelligence and incident response.\",\"url\":\"https://www.dshield.org\"}\n        ]\n    }},\"relations\":{\"vulnerability_related_attack_pattern\":{\"vulnerability\":\"CVE-2024-7634\",\"attack_pattern\":{\"id\":\"T1210\"}},\"vulnerability_related_attack_pattern\":{\"vulnerability\":\"CVE-2024-7634\",\"attack_pattern\":{\"id\":\"T1047\"}},\"vulnerability_related_attack_pattern\":{\"vulnerability\":\"CVE-2024-7634\",\"attack_pattern\":{\"id\":\"T1027\"}},\"vulnerability_related_attack_pattern\":{\"vulnerability\":\"CVE-2024-7634\",\"attack_pattern\":{\"id\":\"T1190\"}}}", "technical_analysis": {"Introduction": "The NGINX Agent's config dirs' feature allows a highly privileged attacker to gain the ability to write/overwrite files outside of the designated secure directory, which can be used to facilitate privilege escalation and maintain persistence.", "Impact and Scope": "The vulnerability has a CVSS score of 6.9 and presents a high risk of data exfiltration, system compromise, and disruption.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to techniques such as T1210, T1047, T1027, and T1190, which can be used to perform file write operations, delete or modify system files, create or modify system files, and execute arbitrary system commands.", "Technical Details": "The vulnerability is due to the lack of proper validation and sanitization of the 'config_dirs' feature in the NGINX Agent, which allows an attacker to write/overwrite files outside of the designated secure directory.", "Detection": "Detection of the vulnerability can be performed by monitoring for unusual file write operations, log analysis, and network traffic behavior.", "Mitigation": "Mitigation strategies include patching the NGINX Agent, implementing a secure configuration, and monitoring for suspicious activity.", "Conclusion": "The NGINX Agent's config dirs' feature is vulnerable to privilege escalation and data exfiltration, and it is essential to implement mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "The NGINX Agent's config dirs' feature is vulnerable to privilege escalation and data exfiltration.", "Business Impact": "The vulnerability can result in significant financial losses, damage to reputation, and compromised data.", "Technical Impact": "The vulnerability presents a high risk of system compromise, data exfiltration, and disruption.", "Mitigation Strategies": "Implement patch management, secure configuration, and monitoring for suspicious activity.", "Recommendations": "Recommendations include implementing a robust patch management process, performing regular security testing, and implementing incident response and disaster recovery plans.", "Conclusions": "The NGINX Agent's config dirs' feature is vulnerable to privilege escalation and data exfiltration, and it is essential to implement mitigation strategies to prevent exploitation."}}