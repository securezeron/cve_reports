{"id": "CVE-2020-7009", "sourceIdentifier": "bressers@elastic.co", "published": "2020-03-31T19:15:14.447", "lastModified": "2020-04-09T14:58:36.340", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Elasticsearch versions from 6.7.0 before 6.8.8 and 7.0.0 before 7.6.2 contain a privilege escalation flaw if an attacker is able to create API keys. An attacker who is able to generate an API key can perform a series of steps that result in an API key being generated with elevated privileges."}, {"lang": "es", "value": "Elasticsearch versiones desde 6.7.0 en versiones anteriores a la 6.8.8 y versiones 7.0.0 en versiones anteriores a la 7.6.2 contienen  un fallo de escalada de privilegios si un atacante es capaz de crear claves de la API. Un atacante que es capaz de generar una clave API puede llevar a cabo una serie de pasos que dan como resultado que se genere una clave API con privilegios elevados."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-269"}]}, {"source": "bressers@elastic.co", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-266"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:elastic:elasticsearch:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7.0", "versionEndExcluding": "6.8.8", "matchCriteriaId": "B1505B55-8739-46A0-874D-8A13FE402975"}, {"vulnerable": true, "criteria": "cpe:2.3:a:elastic:elasticsearch:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.0.0", "versionEndExcluding": "7.6.2", "matchCriteriaId": "226FB38D-4A53-4B74-AD24-24940DB7B40D"}]}]}], "references": [{"url": "https://discuss.elastic.co/t/elastic-stack-6-8-8-and-7-6-2-security-update/225920", "source": "bressers@elastic.co", "tags": ["Mitigation", "Release Notes", "Vendor Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20200403-0004/", "source": "bressers@elastic.co", "tags": ["Third Party Advisory"]}, {"url": "https://www.elastic.co/community/security/", "source": "bressers@elastic.co", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-7009 - An attacker can leverage the API key creation feature to escalate privileges if the Elasticsearch version is not updated to a supported version."}, {"techniqueID": "T1078", "comment": "CVE-2020-7009 - An attacker can potential utilize the privilege escalation vulnerability to obtain elevated privileges and maintain access to the system."}, {"techniqueID": "T1210", "comment": "CVE-2020-7009 - An attacker can exploit the privilege escalation vulnerability to execute system commands with elevated privileges, leading to a potential lateral movement."}], "stix_bundle": {"spec_version": "2.1", "id": "CVE-2020-7009-STIX-Bundle", "type": "bundle", "objects": [{"id": "CVE-2020-7009", "type": "vulnerability", "spec_version": "2.1", "object_marking_refs": [], "description": "Elasticsearch versions from 6.7.0 before 6.8.8 and 7.0.0 before 7.6.2 contain a privilege escalation flaw if an attacker is able to create API keys.", "external_references": [{"source_name": "nvd", "external_id": "CVE-2020-7009"}], "objects": [{"id": "CWE-269", "type": "weakness", "spec_version": "2.1", "description": "Use of Hard-coded Credentials", "external_references": [{"source_name": "cwe", "external_id": "269"}]}, {"id": "CWE-266", "type": "weakness", "spec_version": "2.1", "description": "Weakness in Process Scheduling", "external_references": [{"source_name": "cwe", "external_id": "266"}]}, {"id": "Elasticsearch Configuration", "type": "binding_opinion", "spec_version": "2.1", "description": "The Elasticsearch configuration is not secure", "objects": []}]}, {"id": "T1190", "type": "attack-pattern", "spec_version": "2.1", "description": "Exploit Public-Facing Application", "name": "Exploit Public-Facing Application", "external_references": [{"source_name": "mitre", "external_id": "T1190"}]}, {"id": "T1078", "type": "attack-pattern", "spec_version": "2.1", "description": "Software Update", "name": "Software Update", "external_references": [{"source_name": "mitre", "external_id": "T1078"}]}, {"id": "T1210", "type": "attack-pattern", "spec_version": "2.1", "description": "Exploit Public-Facing Application", "name": "Exploit Public-Facing Application", "external_references": [{"source_name": "mitre", "external_id": "T1210"}]}], "relationship": [{"id": "related_to", "type": "relationship", "spec_version": "2.1", "description": "The vulnerability CVE-2020-7009 is related to the attack pattern T1190", "start_node": "CVE-2020-7009", "end_node": "T1190"}, {"id": "related_to", "type": "relationship", "spec_version": "2.1", "description": "The vulnerability CVE-2020-7009 is related to the attack pattern T1078", "start_node": "CVE-2020-7009", "end_node": "T1078"}, {"id": "related_to", "type": "relationship", "spec_version": "2.1", "description": "The vulnerability CVE-2020-7009 is related to the attack pattern T1210", "start_node": "CVE-2020-7009", "end_node": "T1210"}]}, "technical_analysis": {"Introduction": "CVE-2020-7009 is a privilege escalation vulnerability in Elasticsearch versions from 6.7.0 before 6.8.8 and 7.0.0 before 7.6.2.", "Impact and Scope": "The vulnerability allows an attacker to create an API key with elevated privileges, which can be used to execute system commands, upload and download data, and manipulate the Elasticsearch configuration.", "Related MITRE ATT&CK Techniques": "T1190 - Exploit Public-Facing Application, T1078 - Software Update, T1210 - Exploit Public-Facing Application", "Technical Details": "The vulnerability is caused by the use of hard-coded credentials in the Elasticsearch configuration.", "Detection": "Detection of the vulnerability is possible by monitoring for unusual API key creation and privileges grant.", "Mitigation": "Mitigation strategies include updating to a supported version of Elasticsearch, disabling the API key creation feature, and implementing a strict access control mechanism.", "Conclusion": "CVE-2020-7009 is a serious vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2020-7009 is a privilege escalation vulnerability in Elasticsearch that can be exploited by an attacker to gain elevated privileges.", "Business Impact": "The vulnerability can lead to a loss of sensitive data, disruptions to business operations, and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to compromise the integrity and confidentiality of the Elasticsearch data.", "Mitigation Strategies": "Update to a supported version of Elasticsearch, disable API key creation, and implement strict access control.", "Recommendations": "Immediate action is required to mitigate the vulnerability.", "Conclusions": "CVE-2020-7009 is a serious vulnerability that requires immediate attention and mitigation."}}