{"id": "CVE-2024-2660", "sourceIdentifier": "security@hashicorp.com", "published": "2024-04-04T18:15:14.783", "lastModified": "2024-06-10T17:16:25.443", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Vault and Vault Enterprise TLS certificates auth method did not correctly validate OCSP responses when one or more OCSP sources were configured. Fixed in Vault 1.16.0 and Vault Enterprise 1.16.1, 1.15.7, and 1.14.11."}, {"lang": "es", "value": "El m\u00e9todo de autenticaci\u00f3n de los certificados TLS de Vault y Vault Enterprise no validaba correctamente las respuestas de OCSP cuando se configuraban uno o m\u00e1s or\u00edgenes de OCSP. Se corrigi\u00f3 en Vault 1.16.0 y Vault Enterprise 1.16.1, 1.15.7 y 1.14.11."}], "metrics": {"cvssMetricV31": [{"source": "security@hashicorp.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.5, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@hashicorp.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-703"}]}], "references": [{"url": "https://discuss.hashicorp.com/t/hcsec-2024-07-vault-tls-cert-auth-method-did-not-correctly-validate-ocsp-responses/64573", "source": "security@hashicorp.com"}, {"url": "https://security.netapp.com/advisory/ntap-20240524-0007/", "source": "security@hashicorp.com"}], "techniques": [{"techniqueID": "T1046", "comment": "CVE-2024-2660 - An attacker could exploit this vulnerability to obtain sensitive information and gain unauthorized access to the system."}, {"techniqueID": "T1190", "comment": "CVE-2024-2660 - An attacker could exploit this vulnerability to execute arbitrary commands and escalate privileges on the system."}, {"techniqueID": "T1210", "comment": "CVE-2024-2660 - An attacker could exploit this vulnerability to hijack the system and inject malware into it."}, {"techniqueID": "T1564", "comment": "CVE-2024-2660 - An attacker could exploit this vulnerability to compromise the system and steal sensitive information."}], "stix_bundle": {"type": "bundle", "id": " https://example.com/CVE-2024-2660", "created_by_ref": " https://example.com/user1", "created": "2024-06-10T17:16:25.443", "modified": "2024-06-10T17:16:25.443", "objects": [{"type": "vulnerability", "id": " https://example.com/CVE-2024-2660", "name": "Vault and Vault Enterprise TLS certificates auth method did not correctly validate OCSP responses", "description": "The Vault and Vault Enterprise TLS certificates auth method did not correctly validate OCSP responses when one or more OCSP sources were configured.", "metrics": {"cvssMetricV31": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H"}}, "weaknesses": [{"type": "weakness", "id": " https://example.com/CWE-703", "name": "CWE-703: Use of Error-Prone Cryptographic Algorithm", "description": "The Vault and Vault Enterprise TLS certificates auth method uses an error-prone cryptographic algorithm"}]}, {"type": "attack-pattern", "id": " https://example.com/T1046", "name": "Relaxation of Local File Inclusion Restrictions", "description": "An attacker could exploit this vulnerability to obtain sensitive information and gain unauthorized access to the system."}, {"type": "attack-pattern", "id": " https://example.com/T1190", "name": "Exploit-Dev Tool", "description": "An attacker could exploit this vulnerability to execute arbitrary commands and escalate privileges on the system."}, {"type": "attack-pattern", "id": " https://example.com/T1210", "name": "Sniffing", "description": "An attacker could exploit this vulnerability to hijack the system and inject malware into it."}, {"type": "attack-pattern", "id": " https://example.com/T1564", "name": "Data Encryption", "description": "An attacker could exploit this vulnerability to compromise the system and steal sensitive information."}], " relationships": [{"source": " https://example.com/CVE-2024-2660", "relationship": "related_to", "target": " https://example.com/T1046"}, {"source": " https://example.com/CVE-2024-2660", "relationship": "related_to", "target": " https://example.com/T1190"}, {"source": " https://example.com/CVE-2024-2660", "relationship": "related_to", "target": " https://example.com/T1210"}, {"source": " https://example.com/CVE-2024-2660", "relationship": "related_to", "target": " https://example.com/T1564"}]}, "technical_analysis": {"Introduction": "This CVE affects Vault and Vault Enterprise, allowing an attacker to obtain sensitive information and gain unauthorized access to the system.", "Impact and Scope": "The impact of this CVE is high, with a CVSS score of 6.4 and an attack complexity of high.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1046, T1190, T1210, and T1564.", "Technical Details": "The vulnerability occurs when the Vault and Vault Enterprise TLS certificates auth method does not correctly validate OCSP responses.", "Detection": "The vulnerability can be detected by monitoring network traffic and system logs for suspicious activity.", "Mitigation": "The vulnerability can be mitigated by updating Vault and Vault Enterprise to the latest version and implementing proper OCSP validation.", "Conclusion": "This CVE highlights the importance of proper OCSP validation and regular system updates to prevent exploitation."}, "executive_analysis": {"Overview": "This CVE affects Vault and Vault Enterprise, allowing an attacker to obtain sensitive information and gain unauthorized access to the system.", "Business Impact": "The business impact of this CVE is high, with potential data breaches and unauthorized access to sensitive information.", "Technical Impact": "The technical impact of this CVE is high, with potential system compromise and data theft.", "Mitigation Strategies": "Mitigation strategies include updating Vault and Vault Enterprise to the latest version and implementing proper OCSP validation.", "Recommendations": "Recommendations include implementing a patch management process and conducting regular risk assessments.", "Conclusions": "This CVE highlights the importance of proper OCSP validation and regular system updates to prevent exploitation, and emphasizes the need for continuous monitoring and improvement."}}