{"id": "CVE-2024-6873", "sourceIdentifier": "cb7ba516-3b07-4c98-b0c2-715220f1a8f6", "published": "2024-08-01T16:15:07.187", "lastModified": "2024-08-01T16:45:25.400", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "It is possible to crash or redirect the execution flow of the ClickHouse server process from an unauthenticated vector by sending a specially crafted request to the ClickHouse server native interface. This redirection is limited to what is available within a 256-byte range of memory at the time of execution, and no known remote code execution (RCE) code has been produced or exploited.\n\n\u00a0Fixes have been merged to all currently supported version of ClickHouse.\u00a0If you are maintaining your own forked version of ClickHouse or using an older version and cannot upgrade, the fix for this vulnerability can be found in this commit\u00a0 https://github.com/ClickHouse/ClickHouse/pull/64024 ."}, {"lang": "es", "value": "Es posible bloquear o redirigir el flujo de ejecuci\u00f3n del proceso del servidor ClickHouse desde un vector no autenticado enviando una solicitud especialmente manipulada a la interfaz nativa del servidor ClickHouse. Esta redirecci\u00f3n se limita a lo que est\u00e1 disponible dentro de un rango de memoria de 256 bytes en el momento de la ejecuci\u00f3n, y no se ha producido ni explotado ning\u00fan c\u00f3digo de ejecuci\u00f3n remota de c\u00f3digo (RCE) conocido.  Las correcciones se han combinado en todas las versiones actualmente compatibles de ClickHouse. Si mantiene su propia versi\u00f3n bifurcada de ClickHouse o utiliza una versi\u00f3n anterior y no puede actualizar, la soluci\u00f3n para esta vulnerabilidad se puede encontrar en esta confirmaci\u00f3n https://github.com/ClickHouse/ClickHouse/pull/64024."}], "metrics": {"cvssMetricV31": [{"source": "cb7ba516-3b07-4c98-b0c2-715220f1a8f6", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "HIGH", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.2, "impactScore": 5.3}]}, "weaknesses": [{"source": "cb7ba516-3b07-4c98-b0c2-715220f1a8f6", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-122"}]}], "references": [{"url": "https://github.com/ClickHouse/ClickHouse/security/advisories/GHSA-432f-r822-j66f", "source": "cb7ba516-3b07-4c98-b0c2-715220f1a8f6"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-6873 - This technique can be used to restart the ClickHouse server process from an unauthenticated vector, potentially leading to a denial of service or data manipulation. Defending against this technique can be achieved by implementing rate limiting and access controls."}, {"techniqueID": "T1036", "comment": "CVE-2024-6873 - This technique can be used to redirect the execution flow of the ClickHouse server process from an unauthenticated vector, potentially leading to a data manipulation or corruption. Defending against this technique can be achieved by implementing input validation and sanitization."}, {"techniqueID": "T1196", "comment": "CVE-2024-6873 - This technique can be used to disrupt the normal operation of the ClickHouse server process from an unauthenticated vector, potentially leading to a denial of service. Defending against this technique can be achieved by implementing logging and monitoring."}], "stix_bundle": {"@type": "bundle", "objects": [{"@type": "marker", "id": "marker-1", "url": "https://github.com/ClickHouse/ClickHouse/security/advisories/GHSA-432f-r822-j66f"}, {"@type": "event", "id": "event-1", "type": "vulnerability-discovery", "created_by_ref": "user-1", "created": "2024-08-01T16:45:25.400", "description": "It is possible to crash or redirect the execution flow of the ClickHouse server process from an unauthenticated vector by sending a specially crafted request to the ClickHouse server native interface.", "contributed_to_by": [{"@type": "entity", "id": "CVE-2024-6873"}], "related_to": [{"@type": "entity", "id": "MITRE ATT&CK Technique T1190"}, {"@type": "entity", "id": "MITRE ATT&CK Technique T1036"}, {"@type": "entity", "id": "MITRE ATT&CK Technique T1196"}]}], "objects_relation": [{"from": "event-1", "to": "marker-1", "relationship": "referenced"}], "scores": [{"@type": "vulnerability-score", "cvss_v3": {"value": 8.1, "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:L/A:H"}}]}, "technical_analysis": {"Introduction": "CVE-2024-6873 is a remote code execution vulnerability in ClickHouse that allows an attacker to crash or redirect the execution flow of the server process from an unauthenticated vector.", "Impact and Scope": "The vulnerability has a CVSS score of 8.1 and can be exploited remotely from an unauthenticated vector.", "Related MITRE ATT&CK Techniques": "The techniques T1190, T1036, and T1196 are related to this vulnerability and can be used to exploit it.", "Technical Details": "The vulnerability is caused by a lack of input validation and sanitization in the ClickHouse server native interface.", "Detection": "The vulnerability can be detected by monitoring the ClickHouse server logs for suspicious activity and by running regular vulnerability scans.", "Mitigation": "The vulnerability can be mitigated by implementing rate limiting and access controls, as well as by patching the affected version of ClickHouse.", "Conclusion": "In conclusion, CVE-2024-6873 is a serious vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2024-6873 is a remote code execution vulnerability in ClickHouse that can be exploited from an unauthenticated vector.", "Business Impact": "The vulnerability can be used to deny service or manipulate data, which can have significant business impact.", "Technical Impact": "The vulnerability requires technical knowledge to exploit and can be mitigated by implementing security controls.", "Mitigation Strategies": "Patching the affected version of ClickHouse, implementing rate limiting and access controls, and monitoring the ClickHouse server logs are recommended mitigation strategies.", "Recommendations": "CISOs and IT teams should prioritize patching the affected version of ClickHouse and implementing security controls to mitigate the vulnerability.", "Conclusions": "In conclusion, CVE-2024-6873 is a critical vulnerability that requires immediate attention and mitigation to prevent exploitation."}}