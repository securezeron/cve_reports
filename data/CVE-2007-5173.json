{"id": "CVE-2007-5173", "sourceIdentifier": "cve@mitre.org", "published": "2007-10-03T14:17:00.000", "lastModified": "2018-10-15T21:41:08.680", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHP remote file inclusion vulnerability in includes/openid/Auth/OpenID/BBStore.php in phpBB Openid 0.2.0 allows remote attackers to execute arbitrary PHP code via a URL in the openid_root_path parameter."}, {"lang": "es", "value": "Vulnerabilidad de inclusi\u00f3n remota de archivo en PHP en include/openid/Auth/OpenID/BBStore.php de phpBB  Openid 0.2.0 permite a atacantes remotos ejecutar c\u00f3digo PHP de su elecci\u00f3n mediante un URL en el par\u00e1metro openid_root_path."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:openid:openid:0.2.0:*:*:*:*:*:*:*", "matchCriteriaId": "43999A8D-766E-4646-B275-C7AA535C75DF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpbb:phpbb:*:*:*:*:*:*:*:*", "matchCriteriaId": "8370A82D-83E8-4A70-8D04-1FCC6D24CAFC"}]}]}], "references": [{"url": "http://osvdb.org/37419", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27001", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/481215/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/25867", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.vupen.com/english/advisories/2007/3330", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/36876", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/4471", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0002", "comment": "PHP Remote File Inclusion (RFI) allows an attacker to remotely include a malicious PHP file, which can lead to code injection and arbitrary command execution. This vulnerability can be exploited using a crafted URL in the openid_root_path parameter."}, {"techniqueID": "T1190", "comment": "The openid_root_path parameter does not sanitize the input, allowing an attacker to inject malicious PHP code and execute it. Defenders can detect this by monitoring the include paths and looking for suspicious activity."}, {"techniqueID": "T1055", "comment": "To exploit this vulnerability, an attacker can use a URL in the openid_root_path parameter to include a malicious PHP file. An IDS/IPS can detect this by monitoring for unusual traffic patterns."}, {"techniqueID": "T1086", "comment": "After successful exploitation, an attacker can execute arbitrary PHP code, which can lead to further attacks. Defense can incorporate PHP restrictions and monitoring for suspicious code execution."}], "stix_bundle": "{\"main\": {\n  \"id\": \"CVE-2007-5173\",\n  \"type\": \"vulnerability\",\n  \"name\": \"PHP Remote File Inclusion in OpenID 0.2.0\",\n  \"description\": \"PHP remote file inclusion vulnerability in includes/openid/Auth/OpenID/BBStore.php in phpBB Openid 0.2.0 allows remote attackers to execute arbitrary PHP code via a URL in the openid_root_path parameter.\",\n  \"references\": [\n    {\n      \"id\": \"CVE-2007-5173\",\n      \"type\": \"external_reference\",\n      \"url\": \"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-5173\"\n    }\n  ],\n  \"exploitability\": [\n    {\n      \"id\": \"TA0002\",\n      \"type\": \"exploit\",\n      \"description\": \"The vulnerability can be exploited using a crafted URL in the openid_root_path parameter.\",\n      \"score\": 6.8,\n      \"cvss\": {\n        \"vector\": \"AV:N/AC:M/Au:N/C:P/I:P/A:P\"\n      }\n    }\n  ],\n  \"mitigations\": [\n    {\n      \"id\": \"T1190\",\n      \"type\": \"mitigation\",\n      \"description\": \"Defenders can detect this by monitoring the include paths and looking for suspicious activity.\",\n      \"score\": 2.5,\n      \"cvss\": {\n        \"vector\": \"AV:N/AC:M/Au:N/C:P/I:P/A:P\"\n      }\n    },\n    {\n      \"id\": \"T1055\",\n      \"type\": \"mitigation\",\n      \"description\": \"An IDS/IPS can detect this by monitoring for unusual traffic patterns.\",\n      \"score\": 2.5,\n      \"cvss\": {\n        \"vector\": \"AV:N/AC:M/Au:N/C:P/I:P/A:P\"\n      }\n    },\n    {\n      \"id\": \"T1086\",\n      \"type\": \"mitigation\",\n      \"description\": \"Defense can incorporate PHP restrictions and monitoring for suspicious code execution.\",\n      \"score\": 2.5,\n      \"cvss\": {\n        \"vector\": \"AV:N/AC:M/Au:N/C:P/I:P/A:P\"\n      }\n    }\n  ]\n  }\n}", "technical_analysis": {"Introduction": "The PHP Remote File Inclusion (RFI) vulnerability in OpenID 0.2.0 allows an attacker to include a malicious PHP file and execute arbitrary code. This vulnerability is particularly significant due to its potential impact and relatively high exploitability score.", "Impact and Scope": "The vulnerability has a CVSS score of 6.8, indicating a medium severity problem. It can be exploited remotely and can lead to arbitrary code execution, which can cause significant business impacts and reputational damage.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including TA0002 (Remote File Inclusion), T1190 (Software Installation), T1055 (Network Denial of Service), and T1086 (Web Shell", "Technical Details": "The vulnerability is caused by the lack of proper input sanitization in the openid_root_path parameter, which allows an attacker to inject malicious PHP code and execute it. This can be exploited using a crafted URL in the parameter.", "Detection": "Vulnerable systems can be detected by monitoring the include paths and looking for suspicious activity.", "Mitigation": "To mitigate this vulnerability, defenders can adopt a few strategies, including limiting access to sensitive areas of the system, implementing proper input sanitization, and monitoring for suspicious activity.", "Conclusion": "This vulnerability is a significant risk and should be addressed promptly to prevent exploitation."}, "executive_analysis": {"Overview": "The PHP Remote File Inclusion (RFI) vulnerability in OpenID 0.2.0 is a significant security risk that can be exploited to gain unauthorized access to systems and execute arbitrary code.", "Business Impact": "The vulnerability has the potential to cause significant business impacts by allowing an attacker to steal sensitive business data, disrupt operations, and damage the organization's reputation.", "Technical Impact": "The vulnerability has a technical impact on the system, allowing an attacker to gain unauthorized access and execute arbitrary code.", "Mitigation Strategies": "Defenders can mitigate this vulnerability by implementing proper input sanitization, limiting access to sensitive areas of the system, and monitoring for suspicious activity.", "Recommendations": "We recommend that the system administrator promptly address this vulnerability to prevent exploitation.", "Conclusions": "This vulnerability is a significant security risk and should be addressed promptly to prevent exploitation."}}