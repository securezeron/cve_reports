{"id": "CVE-2020-5256", "sourceIdentifier": "security-advisories@github.com", "published": "2020-03-09T16:15:15.750", "lastModified": "2020-03-10T13:34:56.837", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "BookStack before version 0.25.5 has a vulnerability where a user could upload PHP files through image upload functions, which would allow them to execute code on the host system remotely. They would then have the permissions of the PHP process. This most impacts scenarios where non-trusted users are given permission to upload images in any area of the application. The issue was addressed in a series of patches in versions 0.25.3, 0.25.4 and 0.25.5. Users should upgrade to at least v0.25.5 to avoid this vulnerability."}, {"lang": "es", "value": "BookStack versiones anteriores a 0.25.5, presenta una vulnerabilidad donde un usuario puede cargar archivos PHP por medio de funciones de carga de im\u00e1genes, lo que le permitir\u00eda ejecutar c\u00f3digo sobre el sistema host remotamente. Luego tendr\u00edan los permisos del proceso de PHP. Esto impacta m\u00e1s a los escenarios donde los usuarios no confiables tienen permiso para cargar im\u00e1genes en cualquier \u00e1rea de la aplicaci\u00f3n. El problema fue abordado en una serie de parches en las versiones 0.25.3, 0.25.4 y 0.25.5. Los usuarios deben actualizar al menos a la versi\u00f3n v0.25.5 para evitar esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 7.9, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.3, "impactScore": 6.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-434"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-95"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:bookstackapp:bookstack:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.25.3", "matchCriteriaId": "B8B4AD81-4EED-4873-A781-F389F361A132"}]}]}], "references": [{"url": "https://github.com/BookStackApp/BookStack/releases/tag/v0.25.3", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/BookStackApp/BookStack/releases/tag/v0.25.4", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/BookStackApp/BookStack/releases/tag/v0.25.5", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/BookStackApp/BookStack/security/advisories/GHSA-g9rq-x4fj-f5hx", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2020-5256 - This technique is relevant to RCE attacks via PHP upload and execution. Defending against this technique requires strict control over file uploads and validating user input."}, {"techniqueID": "T1204", "comment": "CVE-2020-5256 - This technique is relevant to web shell deployment and execution. Defending against this technique requires monitoring for suspicious file uploads and execution of unknown PHP files."}, {"techniqueID": "T1547", "comment": "CVE-2020-5256 - This technique is relevant to file upload and execution. Defending against this technique requires validating user input and controlling file uploads to prevent RCE attacks."}, {"techniqueID": "T1534", "comment": "CVE-2020-5256 - This technique is relevant to data validation and sanitization. Defending against this technique requires validating user input to prevent RCE attacks and enforcement of secure coding practices."}], "stix_bundle": {"objects": [{"id": "bundle-V-CVE-2020-5256", "type": "bundle", "created_by_ref": "author-V-Alan", "created": "2023-02-20T14:30:00.000Z", "modified": "2023-02-20T14:30:00.000Z", "objects": [{"id": "vulnerability-CVE-2020-5256", "type": "vulnerability", "name": "CVE-2020-5256", "description": "BookStack before version 0.25.5 has a vulnerability where a user could upload PHP files through image upload functions, which would allow them to execute code on the host system remotely.", "created_by_ref": "author-V-Alan", "created": "2023-02-20T14:30:00.000Z", "modified": "2023-02-20T14:30:00.000Z", "severity": "HIGH", "exploitability": "MEDIUM", "impact": "CRITICAL", "cvss_v3": {"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}}, {"id": "technique-T1190-V-CVE-2020-5256", "type": "technique", "name": "Bootloader Attack", "description": " Attempts to load and execute a malicious bootloader on a targeted system.", "created_by_ref": "author-V-Alan", "created": "2023-02-20T14:30:00.000Z", "modified": "2023-02-20T14:30:00.000Z", "relationship": {"target_ref": "vulnerability-CVE-2020-5256", "relationship_type": "related-technique", "strength": "Low"}}, {"id": "indicator-I-V-CVE-2020-5256", "type": "indicator", "name": "CVE-2020-5256 PHP File Upload", "description": "Monitoring for PHP file uploads to the BookStack application.", "created_by_ref": "author-V-Alan", "created": "2023-02-20T14:30:00.000Z", "modified": "2023-02-20T14:30:00.000Z", "relationship": {"target_ref": "vulnerability-CVE-2020-5256", "relationship_type": "indicated-by", "strength": "Medium"}}]}]}, "technical_analysis": {"Introduction": "CVE-2020-5256 is a remote code execution vulnerability in BookStack before version 0.25.5, which allows an attacker to upload and execute a PHP file.", "Impact and Scope": "The vulnerability affects BookStack versions 0.25.3 and below, and has a CVSS score of 8.8, with an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "T1190, T1204, T1547, and T1534", "Technical Details": "The vulnerability is caused by a lack of input validation and sanitization in the BookStack application.", "Detection": "Detecting this vulnerability requires monitoring for suspicious PHP file uploads and unusual system behavior.", "Mitigation": "The vulnerability can be mitigated by updating to the latest version of BookStack and implementing secure coding practices.", "Conclusion": "CVE-2020-5256 is a critical vulnerability that requires immediate attention and remediation."}, "executive_analysis": {"Overview": "CVE-2020-5256 is a critical remote code execution vulnerability in BookStack.", "Business Impact": "This vulnerability has the potential to cause significant disruption to business operations and damage to the organization's reputation.", "Technical Impact": "The vulnerability allows an attacker to execute code on the host system remotely, which can enable further exploitation and data compromise.", "Mitigation Strategies": "Updating to the latest version of BookStack, implementing secure coding practices, and monitoring for suspicious activity.", "Recommendations": "Executives should prioritize updating to the latest version of BookStack and implementing secure coding practices to prevent exploitation.", "Conclusions": "CVE-2020-5256 is a critical vulnerability that requires immediate attention and remediation to avoid compromise."}}