{"id": "CVE-2020-13870", "sourceIdentifier": "cve@mitre.org", "published": "2020-06-05T19:15:13.517", "lastModified": "2020-06-09T13:06:12.007", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered in the Comments plugin before 1.5.5 for Craft CMS. There is stored XSS via an asset volume name."}, {"lang": "es", "value": "Se detect\u00f3 un problema en el plugin Comments versiones anteriores a 1.5.5 para Craft CMS. Se presenta una vulnerabilidad de tipo XSS almacenado por medio de un nombre de volumen de activo"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:verbb:comments:*:*:*:*:*:craft_cms:*:*", "versionEndExcluding": "1.5.5", "matchCriteriaId": "1F1EAFB3-35F0-42AE-BDDA-E95AB228A29E"}]}]}], "references": [{"url": "https://github.com/verbb/comments/blob/craft-3/CHANGELOG.md#155---2020-05-28-critical", "source": "cve@mitre.org", "tags": ["Release Notes", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059.005 - Command and Scripting Interpreter: Web Shell", "comment": "CVE-2020-13870 - Stored XSS vulnerability allows an attacker to inject malicious JavaScript. Defend against it by validating user input and using Content Security Policy (CSP) to restrict the types of scripts that can be executed."}, {"techniqueID": "T1190 - Exploit Public-Facing Application", "comment": "CVE-2020-13870 - Vulnerable applications can be exploited by an attacker to inject malicious JavaScript. Defend against it by keeping applications up-to-date and patching vulnerabilities."}, {"techniqueID": "T1086 - Input Validation", "comment": "CVE-2020-13870 - Input validation failure allows an attacker to inject malicious JavaScript. Defend against it by validating user input and using SQL injection prevention techniques."}], "stix_bundle": {"objects": [{"type": "malware", "id": "malware-1", "name": "craft cms comments plugin stored xss"}, {"type": "indicator", "id": "indicator-1", "name": "craft cms comments plugin stored xss indicator", "description": "Indicates the presence of a stored XSS vulnerability in the Craft CMS comments plugin."}, {"type": "relationship", "id": "relationship-1", "from": "malware-1", "to": "indicator-1", "relationship_type": "Has"}, {"type": "note", "id": "note-1", "content": "This malware is exploitable by an attacker to inject malicious JavaScript. To prevent exploitation, patch the vulnerable Craft CMS comments plugin and ensure proper input validation is performed."}], "relationships": [{"id": "relationship-2", "from": "malware-1", "to": "note-1", "relationship_type": "Notes"}]}, "technical_analysis": {"Introduction": "The Craft CMS comments plugin stored XSS vulnerability (CVE-2020-13870) allows an attacker to inject malicious JavaScript code into a user's browser, potentially leading to data theft, account tampering, or other malicious activities. This analysis provides an in-depth look at the vulnerability and its potential implications.", "Impact and Scope": "The vulnerability has a CVSS 3.1 score of 5.4, with a medium severity rating and a network attack vector. The impact is low, with some potential for inconvenience or disruption. However, the scope is wide, potentially affecting any user who interacts with the vulnerable Craft CMS comments plugin.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are relevant to this vulnerability: T1059.005 - Command and Scripting Interpreter: Web Shell, T1190 - Exploit Public-Facing Application, and T1086 - Input Validation.", "Technical Details": "The vulnerability is caused by a stored XSS vulnerability in the Craft CMS comments plugin. An attacker can inject malicious JavaScript code into the plugin, which can then be executed by users who interact with the affected pages.", "Detection": "Detection of this vulnerability can be done by monitoring for suspicious JavaScript code injection and monitoring for user interactions with the affected pages.", "Mitigation": "Mitigation strategies for this vulnerability include patching the vulnerable Craft CMS comments plugin, ensuring proper input validation is performed, and using Content Security Policy (CSP) to restrict the types of scripts that can be executed.", "Conclusion": "The Craft CMS comments plugin stored XSS vulnerability is a significant threat that requires immediate attention. By understanding the vulnerability and implementing effective mitigation strategies, users can protect themselves from potential attacks."}, "executive_analysis": {"Overview": "The Craft CMS comments plugin stored XSS vulnerability is a security risk that can lead to data theft, account tampering, or other malicious activities.", "Business Impact": "The impact of this vulnerability on the business is significant, as it can compromise user data and potentially disrupt operations.", "Technical Impact": "The vulnerability is caused by a stored XSS vulnerability in the Craft CMS comments plugin, which can be exploited by an attacker to inject malicious JavaScript code.", "Mitigation Strategies": "Mitigation strategies include patching the vulnerable Craft CMS comments plugin, ensuring proper input validation is performed, and using Content Security Policy (CSP) to restrict the types of scripts that can be executed.", "Recommendations": "We recommend that users patch the vulnerable Craft CMS comments plugin and ensure proper input validation is performed. Additionally, users should consider implementing Content Security Policy (CSP) to restrict the types of scripts that can be executed.", "Conclusions": "The Craft CMS comments plugin stored XSS vulnerability is a significant threat that requires immediate attention. By understanding the vulnerability and implementing effective mitigation strategies, users can protect themselves from potential attacks."}}