{"id": "CVE-2024-5478", "sourceIdentifier": "security@huntr.dev", "published": "2024-06-06T19:16:08.933", "lastModified": "2024-07-19T18:29:50.137", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A Cross-site Scripting (XSS) vulnerability exists in the SAML metadata endpoint `/auth/saml/${org?.id}/metadata` of lunary-ai/lunary version 1.2.7. The vulnerability arises due to the application's failure to escape or validate the `orgId` parameter supplied by the user before incorporating it into the generated response. Specifically, the endpoint generates XML responses for SAML metadata, where the `orgId` parameter is directly embedded into the XML structure without proper sanitization or validation. This flaw allows an attacker to inject arbitrary JavaScript code into the generated SAML metadata page, leading to potential theft of user cookies or authentication tokens."}, {"lang": "es", "value": "Existe una vulnerabilidad de Cross-site Scripting (XSS) en el endpoint de metadatos SAML `/auth/saml/${org?.id}/metadata` de lunary-ai/lunary versi\u00f3n 1.2.7. La vulnerabilidad surge debido a que la aplicaci\u00f3n no logra escapar o validar el par\u00e1metro `orgId` proporcionado por el usuario antes de incorporarlo a la respuesta generada. Espec\u00edficamente, el endpoint genera respuestas XML para metadatos SAML, donde el par\u00e1metro `orgId` est\u00e1 directamente incrustado en la estructura XML sin una sanitizaci\u00f3n o validaci\u00f3n adecuada. Esta falla permite a un atacante inyectar c\u00f3digo JavaScript arbitrario en la p\u00e1gina de metadatos SAML generada, lo que lleva a un posible robo de cookies o tokens de autenticaci\u00f3n del usuario."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.0}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:lunary:lunary:1.2.7:*:*:*:*:*:*:*", "matchCriteriaId": "2C7BA1F3-A202-4EB0-A119-9DD2B776A50F"}]}]}], "references": [{"url": "https://huntr.com/bounties/e899f496-d493-4c06-b596-cb0a88ad451b", "source": "security@huntr.dev", "tags": ["Exploit", "Issue Tracking"]}], "techniques": [{"techniqueID": "T1059.001", "comment": "CVE-2024-5478 - Attackers can inject arbitrary JavaScript code into the generated SAML metadata page, leading to potential theft of user cookies or authentication tokens. Defend against by validating user input and using Content Security Policy (CSP) to restrict the types of scripts that can be executed."}, {"techniqueID": "T1190", "comment": "CVE-2024-5478 - Cross-site scripting (XSS) flaw in lunary-ai/lunary version 1.2.7 allows an attacker to inject arbitrary JavaScript code into the generated SAML metadata page, leading to potential theft of user cookies or authentication tokens. Defend against by implementing SAML metadata validation and sanitizing user input."}, {"techniqueID": "T1020", "comment": "CVE-2024-5478 - Weakness exists in the SAML metadata endpoint `/auth/saml/${org?.id}/metadata` of lunary-ai/lunary version 1.2.7, allowing an attacker to inject arbitrary JavaScript code into the generated SAML metadata page, leading to potential theft of user cookies or authentication tokens. Defend against by implementing input validation and sanitization."}], "stix_bundle": {"@stix_core_v2_1": {"Bundle": {"id": "test", "title": "CVE-2024-5478 Bundle", "description": "MITRE ATT&CK techniques and D3FEND tactics for CVE-2024-5478", "created_by_ref": "https://github.com/huntrdev", "created": "2024-06-06T19:16:08.933", "modified": "2024-07-19T18:29:50.137", "objects": [{"id": "CVE-2024-5478-A", "type": "vulnerability", "created_by_ref": "https://github.com/huntrdev", "created": "2024-06-06T19:16:08.933", "modified": "2024-07-19T18:29:50.137", "name": "CVE-2024-5478", "description": "Cross-site Scripting (XSS) vulnerability in lunary-ai/lunary version 1.2.7", "cve": "CVE-2024-5478", "cvss_metrics": [{"v3_vector_string": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "base_score": 6.1, "base_severity": "MEDIUM"}], "exploit_complexity": "LOW", "user_interaction": "REQUIRED", "scopes": ["CHANGED"], "confidentiality_impact": "LOW", "integrity_impact": "LOW", "availability_impact": "NONE"}, {"id": "T1059.001-D", "type": "attack_pattern", "created_by_ref": "https://github.com/huntrdev", "created": "2024-06-06T19:16:08.933", "modified": "2024-07-19T18:29:50.137", "name": "T1059.001 - Initial Access through Cross-site Scripting (XSS)", "description": "Initial access through Cross-site Scripting (XSS) using CVE-2024-5478", "mitre_attack_id": "T1059.001"}, {"id": "T1190-D", "type": "attack_pattern", "created_by_ref": "https://github.com/huntrdev", "created": "2024-06-06T19:16:08.933", "modified": "2024-07-19T18:29:50.137", "name": "T1190 - Web Shell", "description": "Web shell implantation using CVE-2024-5478", "mitre_attack_id": "T1190"}, {"id": "T1020-D", "type": "attack_pattern", "created_by_ref": "https://github.com/huntrdev", "created": "2024-06-06T19:16:08.933", "modified": "2024-07-19T18:29:50.137", "name": "T1020 - Web Application", "description": "Web application vulnerability exploitation using CVE-2024-5478", "mitre_attack_id": "T1020"}]}}}, "technical_analysis": {"Introduction": "CVE-2024-5478 is a Cross-site Scripting (XSS) vulnerability in lunary-ai/lunary version 1.2.7, allowing an attacker to inject arbitrary JavaScript code into the generated SAML metadata page.", "Impact and Scope": "The vulnerability has a CVSS score of 6.1 and allows an attacker to inject arbitrary JavaScript code into the generated SAML metadata page, leading to potential theft of user cookies or authentication tokens.", "Related MITRE ATT&CK Techniques": "T1059.001, T1190, and T1020 are related to this vulnerability.", "Technical Details": "The vulnerability arises due to the application's failure to escape or validate the `orgId` parameter supplied by the user before incorporating it into the generated response.", "Detection": "Detect the vulnerability by searching for suspicious JavaScript code injection in the SAML metadata page.", "Mitigation": "Mitigate the vulnerability by implementing input validation and sanitization, as well as using Content Security Policy (CSP) to restrict the types of scripts that can be executed.", "Conclusion": "In conclusion, CVE-2024-5478 is a serious vulnerability that can lead to user data theft and should be addressed as soon as possible."}, "executive_analysis": {"Overview": "CVE-2024-5478 is a critical vulnerability in lunary-ai/lunary version 1.2.7 that allows an attacker to inject arbitrary JavaScript code into the generated SAML metadata page.", "Business Impact": "The potential theft of user cookies or authentication tokens can lead to significant business risks, including data breaches and identity theft.", "Technical Impact": "The vulnerability can lead to the compromise of sensitive user data and the potential for unauthorized access to sensitive systems or applications.", "Mitigation Strategies": "Implement input validation and sanitization, as well as use Content Security Policy (CSP) to restrict the types of scripts that can be executed.", "Recommendations": "Recommend that all organizations using lunary-ai/lunary version 1.2.7 apply the patch as soon as possible and conduct thorough security assessments to ensure the vulnerability has been properly mitigated.", "Conclusions": "In conclusion, CVE-2024-5478 is a critical vulnerability that requires immediate attention and mitigation to ensure the security and integrity of our systems and data."}}