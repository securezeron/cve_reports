{"id": "CVE-2024-24753", "sourceIdentifier": "security-advisories@github.com", "published": "2024-02-01T16:17:14.690", "lastModified": "2024-02-09T01:46:12.560", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Bref enable serverless PHP on AWS Lambda. When Bref is used in combination with an API Gateway with the v2 format, it does not handle multiple values headers. If PHP generates a response with two headers having the same key but different values only the latest one is kept. If an application relies on multiple headers with the same key being set for security reasons, then Bref would lower the application security. For example, if an application sets multiple `Content-Security-Policy` headers, then Bref would just reflect the latest one. This vulnerability is patched in 2.1.13."}, {"lang": "es", "value": "Bref habilita PHP sin servidor en AWS Lambda. Cuando Bref se usa en combinaci\u00f3n con una API Gateway con el formato v2, no maneja encabezados de valores m\u00faltiples. Si PHP genera una respuesta con dos encabezados que tienen la misma clave pero valores diferentes, solo se conserva el \u00faltimo. Si una aplicaci\u00f3n se basa en varios encabezados con la misma clave configurada por razones de seguridad, Bref reducir\u00eda la seguridad de la aplicaci\u00f3n. Por ejemplo, si una aplicaci\u00f3n establece varios encabezados \"Content-Security-Policy\", Bref solo reflejar\u00e1 el \u00faltimo. Esta vulnerabilidad est\u00e1 parcheada en 2.1.13."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 2.5}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.2, "impactScore": 2.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-436"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mnapoli:bref:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.1.13", "matchCriteriaId": "D8473D9F-5007-4ADC-B256-FD331BB522A0"}]}]}], "references": [{"url": "https://github.com/brefphp/bref/commit/f834027aaf88b3885f4aa8edf6944ae920daf2dc", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/brefphp/bref/security/advisories/GHSA-99f9-gv72-fw9r", "source": "security-advisories@github.com", "tags": ["Exploit", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-24753 - This vulnerability allows an attacker to lower the security of a web application by setting multiple headers with the same key, which can be exploited to inject malicious code. Defending against this vulnerability involves ensuring that web applications properly handle multiple headers with the same key."}, {"techniqueID": "T1191", "comment": "CVE-2024-24753 - This vulnerability can be exploited by an attacker to inject malicious code into a web application. Defending against this vulnerability involves ensuring that web applications properly sanitize user input and validate requests."}], "technical_analysis": {"Introduction": "Bref enable serverless PHP on AWS Lambda allows multiple values headers, which can be exploited by an attacker to inject malicious code. This vulnerability was patched in version 2.1.13.", "Impact and Scope": "This vulnerability has a CVSS score of 6.5 with a base severity of MEDIUM. It is rated as LOW for confidentiality, integrity, and availability. This vulnerability can be exploited by an attacker to inject malicious code into a web application.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to techniques T1190 and T1191, which involve compromising web servers and injecting malicious code.", "Technical Details": "Bref enable serverless PHP on AWS Lambda allows multiple values headers, which can be exploited by an attacker to inject malicious code. This vulnerability is patched in version 2.1.13.", "Detection": "Detection involves monitoring for multiple headers with the same key being set in a web application.", "Mitigation": "Mitigation involves ensuring that web applications properly handle multiple headers with the same key and sanitize user input.", "Conclusion": "This vulnerability is a Medium severity vulnerability that can be exploited by an attacker to inject malicious code into a web application."}, "executive_analysis": {"Overview": "Bref enable serverless PHP on AWS Lambda allows multiple values headers, which can be exploited by an attacker to inject malicious code.", "Business Impact": "This vulnerability can have a significant business impact, as it can allow an attacker to inject malicious code into a web application.", "Technical Impact": "This vulnerability has a technical impact, as it can allow an attacker to inject malicious code into a web application.", "Mitigation Strategies": "Mitigation strategies include ensuring that web applications properly handle multiple headers with the same key and sanitize user input.", "Recommendations": "Recommendations include upgrading to the latest version of Bref and monitoring for multiple headers with the same key being set in a web application.", "Conclusions": "This vulnerability is a Medium severity vulnerability that can be exploited by an attacker to inject malicious code into a web application. It is recommended that organizations take steps to mitigate this vulnerability."}}