{"id": "CVE-2020-36079", "sourceIdentifier": "cve@mitre.org", "published": "2021-02-26T23:15:11.187", "lastModified": "2024-08-04T18:15:38.710", "vulnStatus": "Modified", "cveTags": [{"sourceIdentifier": "cve@mitre.org", "tags": ["disputed"]}], "descriptions": [{"lang": "en", "value": "Zenphoto through 1.5.7 is affected by authenticated arbitrary file upload, leading to remote code execution. The attacker must navigate to the uploader plugin, check the elFinder box, and then drag and drop files into the Files(elFinder) portion of the UI. This can, for example, place a .php file in the server's uploaded/ directory. NOTE: the vendor disputes this because exploitation can only be performed by an admin who has \"lots of other possibilities to harm a site."}, {"lang": "es", "value": "** EN DISPUTA ** Zenphoto versiones hasta 1.5.7, est\u00e1 afectado por una carga de archivos arbitraria autenticada, conllevando a una ejecuci\u00f3n de c\u00f3digo remota. El atacante debe navegar hasta el plugin del cargador, marcar la casilla elFinder y luego arrastrar y soltar archivos en la parte Files(elFinder) de la Interfaz de Usuario. Esto puede, por ejemplo, colocar un archivo .php en el directorio uploaded/ del servidor. NOTA: el vendedor discute esto porque la explotaci\u00f3n s\u00f3lo puede ser realizada por un administrador que tiene \"muchas otras posibilidades de da\u00f1ar un sitio\""}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.2, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-434"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:zenphoto:zenphoto:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.5.7", "matchCriteriaId": "776AEF1F-758A-4080-BBB9-FDE3020D499A"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/161569/Zenphoto-CMS-1.5.7-Shell-Upload.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/zenphoto/zenphoto/issues/1292", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.zenphoto.org/news/why-not-every-security-issue-is-really-an-issue/", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "Initial Access - Spearphishing via compromised account - CVE-2020-36079 - Unauthorised upload of files in Zenphoto lead to path traversal."}, {"techniqueID": "TA0002", "comment": "Initial Access - Phishing - CVE-2020-36079 - Social Engineering attack using email to gain access to Zenphoto account"}, {"techniqueID": "TA0005", "comment": "Command and Control - Web Service - CVE-2020-36079 - Remote Code Execution in Zenphoto using uploaded files"}, {"techniqueID": "T1078", "comment": "Exploitation - File and Directory Discovery - CVE-2020-36079 - Enumerating uploaded files and directories in Zenphoto"}, {"techniqueID": "T1210", "comment": "Exploitation - File Write - CVE-2020-36079 - Writing files to unauthorized locations in Zenphoto"}, {"techniqueID": "T1098", "comment": "Command and Control - Command and Control - CVE-2020-36079 - Malicious code execution in Zenphoto using Remote Code Execution"}], "technical_analysis": {"Introduction": "Zenphoto through 1.5.7 is affected by an authenticated arbitrary file upload vulnerability, leading to remote code execution.", "Impact and Scope": "The vulnerability allows an authenticated attacker to upload arbitrary files to the server, leading to remote code execution. CVSS Score: 7.2 (CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H).", "Related MITRE ATT&CK Techniques": "TA0001, TA0002, TA0005, T1078, T1210, T1098", "Technical Details": "The vulnerability is due to the mishandling of file uploads in the uploader plugin. An authenticated attacker can exploit this by uploading a malicious file, which will be executed on the server.", "Detection": "Detecting this vulnerability requires monitoring for suspicious file uploads and investigating for anomalies.", "Mitigation": "Apply the patch released by the vendor, disable the uploader plugin, or restrict file uploads to specific directories.", "Conclusion": "The vulnerability is a serious issue and should be addressed promptly to prevent exploitation."}, "executive_analysis": {"Overview": "Zenphoto through 1.5.7 is vulnerable to an authenticated arbitrary file upload vulnerability, leading to remote code execution.", "Business Impact": "The vulnerability can allow an attacker to execute malicious code on the server, potentially leading to data breaches or other security incidents.", "Technical Impact": "The vulnerability affects the integrity and availability of the Zenphoto application.", "Mitigation Strategies": "Apply patches, restrict file uploads, and monitor for suspicious activity.", "Recommendations": "Apply patches as soon as possible, conduct regular vulnerability scans, and monitor for suspicious activity.", "Conclusions": "The vulnerability is a high-priority issue and should be addressed promptly to prevent exploitation."}}