{"id": "CVE-2024-30386", "sourceIdentifier": "sirt@juniper.net", "published": "2024-04-12T16:15:37.650", "lastModified": "2024-05-16T21:16:08.487", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A Use-After-Free vulnerability in the\u00a0Layer 2 Address Learning Daemon (l2ald)\n\n of Juniper Networks Junos OS and Junos OS Evolved allows an unauthenticated, adjacent attacker to cause l2ald to crash leading to a Denial-of-Service (DoS).\n\nIn an EVPN-VXLAN scenario,\u00a0when \n\nstate updates are received and processed by the affected system, the correct order of some processing steps is not ensured, which can lead to an l2ald crash and restart. Whether the crash occurs depends on system internal timing which is outside the attackers control.\nThis issue affects:\n\nJunos OS:\u00a0\n\n\n\n  *  All versions before 20.4R3-S8,\n  *  21.2 versions before 21.2R3-S6,\n  *  21.3 versions before 21.3R3-S5,\n  *  21.4 versions before 21.4R3-S4,\n  *  22.1 versions before 22.1R3-S3,\n  *  22.2 versions before 22.2R3-S1,\n  *  22.3 versions before 22.3R3,,\n  *  22.4 versions before 22.4R2;\n\n\n\n\nJunos OS Evolved:\u00a0\n\n\n\n  *  All versions before 20.4R3-S8-EVO,\n  *  21.2-EVO versions before 21.2R3-S6-EVO,\u00a0\n  *  21.3-EVO\n\n versions before 21.3R3-S5-EVO,\n  *  21.4-EVO\n\n versions before 21.4R3-S4-EVO,\n  *  22.1-EVO\n\n versions before 22.1R3-S3-EVO,\n  *  22.2-EVO\n\n versions before 22.2R3-S1-EVO,\n  *  22.3-EVO\n\n versions before 22.3R3-EVO,\n  *  22.4-EVO\n\n versions before 22.4R2-EVO."}, {"lang": "es", "value": "Una vulnerabilidad de Use-After-Free en el daemon de aprendizaje de direcciones de capa 2 (l2ald) de Juniper Networks Junos OS y Junos OS Evolved permite que un atacante adyacente no autenticado provoque que l2ald falle, lo que provoca una denegaci\u00f3n de servicio (DoS). En un escenario EVPN-VXLAN, cuando el sistema afectado recibe y procesa actualizaciones de estado, no se garantiza el orden correcto de algunos pasos de procesamiento, lo que puede provocar un bloqueo y reinicio de l2ald. Que se produzca el fallo depende de la sincronizaci\u00f3n interna del sistema, que est\u00e1 fuera del control de los atacantes. Este problema afecta a: Junos OS: * Todas las versiones anteriores a 20.4R3-S8, * Versiones 21.2 anteriores a 21.2R3-S6, * Versiones 21.3 anteriores a 21.3R3-S5, * Versiones 21.4 anteriores a 21.4R3-S4, * Versiones 22.1 anteriores a 22.1R3- S3, * 22.2 versiones anteriores a 22.2R3-S1, * 22.3 versiones anteriores a 22.3R3, * 22.4 versiones anteriores a 22.4R2; Junos OS Evolved: * Todas las versiones anteriores a 20.4R3-S8-EVO, * Versiones 21.2-EVO anteriores a 21.2R3-S6-EVO, * Versiones 21.3-EVO anteriores a 21.3R3-S5-EVO, * Versiones 21.4-EVO anteriores a 21.4R3- S4-EVO, *versiones 22.1-EVO anteriores a 22.1R3-S3-EVO, *versiones 22.2-EVO anteriores a 22.2R3-S1-EVO, *versiones 22.3-EVO anteriores a 22.3R3-EVO, *versiones 22.4-EVO anteriores a 22.4R2- EVO."}], "metrics": {"cvssMetricV40": [{"source": "sirt@juniper.net", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:A/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:L/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "attackVector": "ADJACENT", "attackComplexity": "LOW", "attackRequirements": "NONE", "privilegesRequired": "NONE", "userInteraction": "NONE", "vulnerableSystemConfidentiality": "NONE", "vulnerableSystemIntegrity": "NONE", "vulnerableSystemAvailability": "HIGH", "subsequentSystemConfidentiality": "NONE", "subsequentSystemIntegrity": "NONE", "subsequentSystemAvailability": "LOW", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NOT_DEFINED", "recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED", "baseScore": 7.1, "baseSeverity": "HIGH"}}], "cvssMetricV31": [{"source": "sirt@juniper.net", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.6}]}, "weaknesses": [{"source": "sirt@juniper.net", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-416"}]}], "references": [{"url": "http://supportportal.juniper.net/JSA79184", "source": "sirt@juniper.net"}, {"url": "https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:A/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:L", "source": "sirt@juniper.net"}], "techniques": [{"techniqueID": "T1188", "comment": " CVE-2024-30386 - A Use-After-Free vulnerability in the Layer 2 Address Learning Daemon (l2ald) of Juniper Networks Junos OS and Junos OS Evolved allows an unauthenticated, adjacent attacker to cause l2ald to crash leading to a Denial-of-Service (DoS). This technique allows an attacker to use unauthenticated adjacent network access to exploit the vulnerability."}, {"techniqueID": "T1005", "comment": " CVE-2024-30386 - An attacker can use adjacent network access to exploit the Use-After-Free vulnerability and cause l2ald to crash, leading to a Denial-of-Service (DoS). This technique allows an attacker to use adjacent network access to exploit the vulnerability."}, {"techniqueID": "T1055", "comment": " CVE-2024-30386 - An attacker can use adjacent network access to exploit the Use-After-Free vulnerability and cause l2ald to crash, leading to a Denial-of-Service (DoS). This technique allows an attacker to use adjacent network access to exploit the vulnerability and gain unauthorized access to the system."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "vuln-1", "created": "2024-04-12T16:15:37.650", "modified": "2024-05-16T21:16:08.487", "name": "CVE-2024-30386", "description": "A Use-After-Free vulnerability in the Layer 2 Address Learning Daemon (l2ald) of Juniper Networks Junos OS and Junos OS Evolved allows an unauthenticated, adjacent attacker to cause l2ald to crash leading to a Denial-of-Service (DoS).", "reference": "https://supportportal.juniper.net/JSA79184"}, {"type": "note", "id": "note-1", "created": "2024-04-12T16:15:37.650", "modified": "2024-05-16T21:16:08.487", "content": "An attacker can use adjacent network access to exploit the Use-After-Free vulnerability and cause l2ald to crash, leading to a Denial-of-Service (DoS).", "relationship": {"target": "vuln-1", "type": "mitigated-by", "id": "rel-1"}}, {"type": "course-of-action", "id": "coa-1", "created": "2024-04-12T16:15:37.650", "modified": "2024-05-16T21:16:08.487", "title": "Update Junos OS and Junos OS Evolved to a patched version", "description": "Update Junos OS and Junos OS Evolved to a patched version to mitigate the vulnerability.", "relationship": {"target": "vuln-1", "type": "mitigates", "id": "rel-2"}}], "relationships": [{"id": "rel-1", "type": "mitigated-by", "source": "note-1", "target": "vuln-1"}, {"id": "rel-2", "type": "mitigates", "source": "coa-1", "target": "vuln-1"}]}, "technical_analysis": {"Introduction": "The CVE-2024-30386 vulnerability is a Use-After-Free vulnerability in the Layer 2 Address Learning Daemon (l2ald) of Juniper Networks Junos OS and Junos OS Evolved, which allows an unauthenticated, adjacent attacker to cause l2ald to crash leading to a Denial-of-Service (DoS).", "Impact and Scope": "The vulnerability affects Junos OS and Junos OS Evolved versions before 20.4R3-S8, 21.2R3-S6, 21.3R3-S5, 21.4R3-S4, 22.1R3-S3, 22.2R3-S1, and 22.3R3, and Junos OS Evolved versions before 20.4R3-S8-EVO, 21.2-EVO R3-S6-EVO, 21.3-EVO R3-S5-EVO, 21.4-EVO R3-S4-EVO, 22.1-EVO R3-S3-EVO, 22.2-EVO R3-S1-EVO, and 22.3-EVO R3-EVO.", "Related MITRE ATT&CK Techniques": "T1188, T1005, and T1055", "Technical Details": "The vulnerability is caused by a Use-After-Free in the Layer 2 Address Learning Daemon (l2ald), which allows an attacker to cause the daemon to crash, leading to a Denial-of-Service (DoS).", "Detection": "The vulnerability can be detected by monitoring for unusual network activity and system crashes.", "Mitigation": "The vulnerability can be mitigated by updating Junos OS and Junos OS Evolved to a patched version.", "Conclusion": "The CVE-2024-30386 vulnerability is a serious vulnerability that affects Junos OS and Junos OS Evolved, and should be mitigated by updating the software to a patched version."}, "executive_analysis": {"Overview": "The CVE-2024-30386 vulnerability is a critical vulnerability in the Layer 2 Address Learning Daemon (l2ald) of Juniper Networks Junos OS and Junos OS Evolved.", "Business Impact": "The vulnerability can cause a Denial-of-Service (DoS) attack, which can affect the availability and integrity of the network.", "Technical Impact": "The vulnerability can be exploited by an unauthenticated, adjacent attacker to cause a Denial-of-Service (DoS) attack.", "Mitigation Strategies": "Update Junos OS and Junos OS Evolved to a patched version.", "Recommendations": "Executives should recommend updating Junos OS and Junos OS Evolved to a patched version to mitigate the vulnerability.", "Conclusions": "The CVE-2024-30386 vulnerability is a critical vulnerability that requires immediate attention and action to mitigate."}}