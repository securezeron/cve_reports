{"id": "CVE-2024-4067", "sourceIdentifier": "596c5446-0ce5-4ba2-aa66-48b3b757a647", "published": "2024-05-14T15:42:47.947", "lastModified": "2024-08-28T00:15:04.130", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The NPM package `micromatch` prior to 4.0.8 is vulnerable to Regular Expression Denial of Service (ReDoS). The vulnerability occurs in `micromatch.braces()` in `index.js` because the pattern `.*` will greedily match anything. By passing a malicious payload, the pattern matching will keep backtracking to the input while it doesn't find the closing bracket. As the input size increases, the consumption time will also increase until it causes the application to hang or slow down. There was a merged fix but further testing shows the issue persists. This issue should be mitigated by using a safe pattern that won't start backtracking the regular expression due to greedy matching. This issue was fixed in version 4.0.8."}, {"lang": "es", "value": "El paquete NPM `micromatch` es vulnerable a la denegaci\u00f3n de servicio de expresi\u00f3n regular (ReDoS). La vulnerabilidad ocurre en `micromatch.braces()` en `index.js` porque el patr\u00f3n `.*` coincidir\u00e1 con avidez con cualquier cosa. Al pasar un payload malicioso, la coincidencia de patrones seguir\u00e1 retrocediendo hasta la entrada hasta que no encuentre el corchete de cierre. A medida que aumenta el tama\u00f1o de la entrada, el tiempo de consumo tambi\u00e9n aumentar\u00e1 hasta provocar que la aplicaci\u00f3n se cuelgue o se ralentice. Hubo una soluci\u00f3n combinada, pero pruebas adicionales muestran que el problema persiste. Este problema se debe mitigar mediante el uso de un patr\u00f3n seguro que no comience a retroceder la expresi\u00f3n regular debido a coincidencias codiciosas."}], "metrics": {"cvssMetricV31": [{"source": "596c5446-0ce5-4ba2-aa66-48b3b757a647", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "596c5446-0ce5-4ba2-aa66-48b3b757a647", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1333"}]}], "references": [{"url": "https://advisory.checkmarx.net/advisory/CVE-2024-4067/", "source": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}, {"url": "https://devhub.checkmarx.com/cve-details/CVE-2024-4067/", "source": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}, {"url": "https://github.com/micromatch/micromatch/commit/03aa8052171e878897eee5d7bb2ae0ae83ec2ade", "source": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}, {"url": "https://github.com/micromatch/micromatch/pull/266", "source": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}, {"url": "https://github.com/micromatch/micromatch/releases/tag/4.0.8", "source": "596c5446-0ce5-4ba2-aa66-48b3b757a647"}], "techniques": [{"techniqueID": "T1171", "comment": "Using Inefficient Regular Expressions (T1171) - The vulnerability in micromatch enables an attacker to exploit the ReDoS attack, causing a denial-of-service by consuming excessive CPU resources. This technique can be used to identify and mitigate this vulnerability by using safe patterns in regular expressions."}, {"techniqueID": "T1060", "comment": "File and Directory Discovery (T1060) - The vulnerability in micromatch allows an attacker to discover and exploit the regular expression Denial of Service vulnerability. This technique can be used to identify and mitigate this vulnerability by restricting access to sensitive files and directories."}, {"techniqueID": "T1204", "comment": "File Discovery (T1204) - The vulnerability in micromatch enables an attacker to discover and exploit the regular expression Denial of Service vulnerability. This technique can be used to identify and mitigate this vulnerability by restricting access to sensitive files and directories."}], "stix_bundle": {"identity": {"type": "identity", "id": "identity", "created_by_ref": "STIXTZ-2024-07-02T15:30:00.000Z"}, "observations": [{"type": "observed-data", "id": "observed-data", "created_by_ref": "STIXTZ-2024-07-02T15:30:00.000Z"}], "notes": [{"type": "note", "id": "note", "created_by_ref": "STIXTZ-2024-07-02T15:30:00.000Z"}], "relationship": [{"type": "has-observation", "id": "has-observation", "created_by_ref": "STIXTZ-2024-07-02T15:30:00.000Z"}, {"type": "has-note", "id": "has-note", "created_by_ref": "STIXTZ-2024-07-02T15:30:00.000Z"}]}, "technical_analysis": {"Introduction": "The CVE-2024-4067 vulnerability in micromatch is a Regular Expression Denial of Service (ReDoS) vulnerability that can be exploited by attackers to consume excessive CPU resources.", "Impact and Scope": "The vulnerability has a CVSS score of 5.3 with a version of 3.1, with an attack vector of NETWORK, and an attack complexity of LOW.", "Related MITRE ATT&CK Techniques": "T1171, T1060, T1204", "Technical Details": "The vulnerability occurs in the `micromatch.braces()` function in `index.js` due to the greedy matching of the pattern `.*`. This allows an attacker to pass a malicious payload that will result in the pattern continuing to match the input until it finds the closing bracket.", "Detection": "The detection of this vulnerability can be done by monitoring system logs for significant CPU usage and resource consumption.", "Mitigation": "The mitigation of this vulnerability can be done by updating the micromatch package to version 4.0.8, which includes a fix for the issue.", "Conclusion": "The CVE-2024-4067 vulnerability in micromatch is a ReDoS vulnerability that can be exploited by attackers to consume excessive CPU resources, leading to a denial-of-service. The mitigation of this vulnerability involves updating the package to version 4.0.8."}, "executive_analysis": {"Overview": "The CVE-2024-4067 vulnerability in micromatch is a significant security risk that can be exploited by attackers to consume excessive CPU resources.", "Business Impact": "The vulnerability has the potential to significantly impact business operations by causing denial-of-service and reducing the overall performance of the system.", "Technical Impact": "The vulnerability has a CVSS score of 5.3 with a version of 3.1, with an attack vector of NETWORK, and an attack complexity of LOW, making it a relatively easy vulnerability to exploit.", "Mitigation Strategies": "Updating the micromatch package to version 4.0.8, monitoring system logs for significant CPU usage and resource consumption, and implementing defense strategies such as rate limiting and IP blocking.", "Recommendations": "Executives should prioritize updating the micromatch package to version 4.0.8, and implementing defense strategies to mitigate the risk of exploitation.", "Conclusions": "The CVE-2024-4067 vulnerability in micromatch is a significant security risk that requires immediate attention and action to mitigate its impact."}}