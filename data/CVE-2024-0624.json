{"id": "CVE-2024-0624", "sourceIdentifier": "security@wordfence.com", "published": "2024-01-25T02:15:53.243", "lastModified": "2024-01-31T19:03:53.193", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Paid Memberships Pro \u2013 Content Restriction, User Registration, & Paid Subscriptions plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 2.12.7. This is due to missing or incorrect nonce validation on the pmpro_update_level_order() function. This makes it possible for unauthenticated attackers to update the order of levels via a forged request granted they can trick a site administrator into performing an action such as clicking on a link."}, {"lang": "es", "value": "El complemento Paid Memberships Pro \u2013 Content Restriction, User Registration, &amp; Paid Subscriptions para WordPress es vulnerable a Cross-Site Request Forgery en todas las versiones hasta la 2.12.7 incluida. Esto se debe a una validaci\u00f3n nonce faltante o incorrecta en la funci\u00f3n pmpro_update_level_order(). Esto hace posible que atacantes no autenticados actualicen el orden de los niveles a trav\u00e9s de una solicitud falsificada, siempre que puedan enga\u00f1ar al administrador del sitio para que realice una acci\u00f3n como hacer clic en un enlace."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}, {"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:strangerstudios:paid_memberships_pro:*:*:*:*:*:wordpress:*:*", "versionEndIncluding": "2.12.7", "matchCriteriaId": "866394BC-8BCA-4D6E-97BC-CF430518C975"}]}]}], "references": [{"url": "https://plugins.trac.wordpress.org/browser/paid-memberships-pro/trunk/includes/services.php#L139", "source": "security@wordfence.com", "tags": ["Product"]}, {"url": "https://plugins.trac.wordpress.org/changeset/3025164/paid-memberships-pro/tags/2.12.8/includes/services.php", "source": "security@wordfence.com", "tags": ["Patch"]}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/ae68d083-b6e2-409b-8c91-d4eb7e62dba9?source=cve", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2024-0624 - Cross-Site Request Forgery (CSRF) vulnerability in Paid Memberships Pro plugin can be used by an attacker to trick a site administrator into updating the order of levels via a forged request. This technique can be used to gain unauthorized access to the system."}, {"techniqueID": "TA0040", "comment": "CVE-2024-0624 - Insufficient Verification of Data Authenticity in Paid Memberships Pro plugin can allow an attacker to send a forged request and trick a site administrator into updating the order of levels. This technique can be used to gain unauthorized access to the system."}, {"techniqueID": "TA0041", "comment": "CVE-2024-0624 - Input Validation in Paid Memberships Pro plugin can be bypassed through CSRF attack, allowing an attacker to send a forged request and trick a site administrator into updating the order of levels. This technique can be used to gain unauthorized access to the system."}, {"techniqueID": "TA0042", "comment": "CVE-2024-0624 - Inadequate Exception Handling in Paid Memberships Pro plugin can allow an attacker to send a forged request and trick a site administrator into updating the order of levels. This technique can be used to gain unauthorized access to the system."}, {"techniqueID": "TA0045", "comment": "CVE-2024-0624 - Server-Side Request Forgery (SSRF) vulnerability in Paid Memberships Pro plugin can be used by an attacker to trick a site administrator into making a request to an arbitrary URL. This technique can be used to gain unauthorized access to the system."}], "stix_bundle": {"@alertpattern": "{\"pattern\":{\"id\":\"https://stix2.io/v2/attack-pattern/*\",\"type\":\"attack-pattern\"}}", "@bundle": "{\"id\":\"https://stix2.io/v2/bundle/*\",\"type\":\"bundle\"}", "bundle_references": [{"ref_id": "https://stix2.io/v2/bundle/*", "relationship": "bundle"}], "inferred_actors": [{"id": "https://stix2.io/v2/course-of-action/*", "type": "course-of-action", "object_label": "Potential Attacker"}], "objects": [{"id": "https://stix2.io/v2/vulnerability/CVE-2024-0624", "type": "vulnerability", "version": "2.12.7", "name": "CVE-2024-0624: Paid Memberships Pro Plugin CSRF Vulnerability", "description": "The Paid Memberships Pro \u2013 Content Restriction, User Registration, & Paid Subscriptions plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 2.12.7.\n\nThis is due to missing or incorrect nonce validation on the pmpro_update_level_order() function.", "analysis": {"sensitivity": "high", "impact": "HIGH"}, "references": [{"id": "https://plugins.trac.wordpress.org/browser/paid-memberships-pro/trunk/includes/services.php#L139", "type": "source-code", "relationship": "related"}, {"id": "https://plugins.trac.wordpress.org/changeset/3025164/paid-memberships-pro/tags/2.12.8/includes/services.php", "type": "source-code", "relationship": "related"}]}], "relationship": [{"id": "https://stix2.io/v2/relationship/*", "type": "relationship", "start": "https://stix2.io/v2/vulnerability/CVE-2024-0624", "end": "https://stix2.io/v2/course-of-action/*", "relationship": "is-targeted-by"}]}, "technical_analysis": {"Introduction": "Paid Memberships Pro plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 2.12.7 due to missing or incorrect nonce validation on the pmpro_update_level_order() function.", "Impact and Scope": "This vulnerability allows an attacker to trick a site administrator into updating the order of levels via a forged request, which can lead to unauthorized access to the system.", "Related MITRE ATT&CK Techniques": "TA0001, TA0040, TA0041, TA0042, and TA0045", "Technical Details": "The vulnerability is caused by the lack of proper nonce validation on the pmpro_update_level_order() function, which allows an attacker to send a forged request and trick a site administrator into updating the order of levels.", "Detection": "Detection of this vulnerability requires monitoring of network traffic and analyzing requests to identify potential CSRF attacks.", "Mitigation": "Mitigation of this vulnerability requires updating the Paid Memberships Pro plugin to version 2.12.8 or higher and implementing proper nonce validation on the pmpro_update_level_order() function.", "Conclusion": "In conclusion, the Paid Memberships Pro plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 2.12.7. This vulnerability allows an attacker to trick a site administrator into updating the order of levels via a forged request, which can lead to unauthorized access to the system."}, "executive_analysis": {"Overview": "The Paid Memberships Pro plugin for WordPress has a vulnerability that allows an attacker to trick a site administrator into updating the order of levels via a forged request.", "Business Impact": "This vulnerability can lead to unauthorized access to the system, which can result in financial losses, loss of customer data, and damage to reputation.", "Technical Impact": "The vulnerability is caused by the lack of proper nonce validation on the pmpro_update_level_order() function, which allows an attacker to send a forged request and trick a site administrator into updating the order of levels.", "Mitigation Strategies": "Implementation of proper nonce validation on the pmpro_update_level_order() function, updating the Paid Memberships Pro plugin to version 2.12.8 or higher, and monitoring of network traffic for potential CSRF attacks.", "Recommendations": "Update the Paid Memberships Pro plugin to version 2.12.8 or higher, implement proper nonce validation on the pmpro_update_level_order() function, and monitor network traffic for potential CSRF attacks.", "Conclusions": "In conclusion, this vulnerability is a high-severity issue that requires prompt attention and mitigation."}}