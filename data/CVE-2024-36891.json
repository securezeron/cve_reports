{"id": "CVE-2024-36891", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-05-30T16:15:12.603", "lastModified": "2024-06-16T13:15:52.713", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmaple_tree: fix mas_empty_area_rev() null pointer dereference\n\nCurrently the code calls mas_start() followed by mas_data_end() if the\nmaple state is MA_START, but mas_start() may return with the maple state\nnode == NULL.  This will lead to a null pointer dereference when checking\ninformation in the NULL node, which is done in mas_data_end().\n\nAvoid setting the offset if there is no node by waiting until after the\nmaple state is checked for an empty or single entry state.\n\nA user could trigger the events to cause a kernel oops by unmapping all\nvmas to produce an empty maple tree, then mapping a vma that would cause\nthe scenario described above."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: maple_tree: corrige la desreferencia del puntero nulo mas_empty_area_rev() Actualmente el c\u00f3digo llama a mas_start() seguido de mas_data_end() si el estado del arce es MA_START, pero mas_start() puede regresar con el estado del arce nodo == NULL. Esto dar\u00e1 lugar a una desreferencia del puntero nulo al verificar la informaci\u00f3n en el nodo NULL, lo cual se realiza en mas_data_end(). Evite establecer el desplazamiento si no hay ning\u00fan nodo esperando hasta que se verifique el estado del arce para detectar un estado vac\u00edo o de entrada \u00fanica. Un usuario podr\u00eda desencadenar los eventos para causar un kernel ups al desasignar todos los vmas para producir un \u00e1rbol de arce vac\u00edo y luego mapear un vma que causar\u00eda el escenario descrito anteriormente."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-476"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.1", "versionEndExcluding": "6.6.31", "matchCriteriaId": "910CE724-0711-4456-AE26-78D967455C4C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionStartIncluding": "6.7", "versionEndExcluding": "6.8.10", "matchCriteriaId": "6A6B920C-8D8F-4130-86B4-AD334F4CF2E3"}]}]}], "references": [{"url": "https://git.kernel.org/stable/c/6c9c7c1e63b198a8b979ad963eb21410f10ccb00", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/883e5d542bbdddbddeba60250cb482baf3ae2415", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/955a923d2809803980ff574270f81510112be9cf", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}, {"url": "https://git.kernel.org/stable/c/f3956791cf526540addd3295e4c1e0f0442486cc", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "tags": ["Patch"]}], "techniques": [{"techniqueID": "TA0003", "comment": "CVE-2024-36891 - This is a null pointer dereference vulnerability, an attacker could trigger a kernel oops, it's related to maple_tree's mas_empty_area_rev() function, and could be exploited by unmapping all vmas to produce an empty maple tree, and then mapping a vma that would cause the scenario described above."}, {"techniqueID": "TA0004", "comment": "CVE-2024-36891 - This vulnerability could be exploited by an attacker to gain elevated privileges, as it allows for the execution of arbitrary code with kernel-level permissions."}, {"techniqueID": "T1222", "comment": "CVE-2024-36891 - This is a subdomain of the 'Use of Outdated or Vulnerable COTS-based Design' attack pattern, as it relies on the use of an outdated kernel feature."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2024-36891", "title": "Linux kernel maple_tree null pointer dereference vulnerability"}, {"type": "indicator", "id": "indicator-cve-2024-36891", "title": "Indicator for CVE-2024-36891 exploitation"}, {"type": "attack-pattern", "id": "TA0003", "title": "Null Pointer Dereference"}, {"type": "malware", "id": "malware-cve-2024-36891", "title": "Malware exploiting CVE-2024-36891"}, {"type": "course-of-action", "id": "COA-1", "title": "Apply the patch", "notes": "Apply the patch to the kernel to fix the vulnerability"}, {"type": "course-of-action", "id": "COA-2", "title": "Update to latest kernel version", "notes": "Update to the latest kernel version to receive the patch"}], "relationships": [{"type": "related_to", "id": "related_to-cve-2024-36891", "source_ref": "indicator-cve-2024-36891", "target_ref": "CVE-2024-36891"}, {"type": "exploits", "id": "exploits-cve-2024-36891", "source_ref": "malware-cve-2024-36891", "target_ref": "CVE-2024-36891"}, {"type": "mitigated_by", "id": "mitigated_by-1", "source_ref": "COA-1", "target_ref": "CVE-2024-36891"}, {"type": "mitigated_by", "id": "mitigated_by-2", "source_ref": "COA-2", "target_ref": "CVE-2024-36891"}]}, "technical_analysis": {"Introduction": "This vulnerability is a null pointer dereference in the Linux kernel's maple_tree implementation, which could be exploited by an attacker to gain elevated privileges.", "Impact and Scope": "This vulnerability affects Linux kernel versions 6.1 to 6.6.31 and 6.7 to 6.8.10, with a CVSS score of 5.5.", "Related MITRE ATT&CK Techniques": "TA0003, TA0004, and T1222", "Technical Details": "The vulnerability is caused by a null pointer dereference in the mas_empty_area_rev() function, which could be triggered by unmapping all vmas to produce an empty maple tree, and then mapping a vma that would cause the scenario described above.", "Detection": "This vulnerability can be detected by monitoring system calls and memory access patterns, and by looking for signs of kernel-level privilege escalation.", "Mitigation": "Apply the patch to the kernel, or update to the latest kernel version to receive the patch", "Conclusion": "This vulnerability is a significant threat to Linux kernel security, and users are advised to take immediate action to patch or update their systems."}, "executive_analysis": {"Overview": "This vulnerability is a null pointer dereference in the Linux kernel's maple_tree implementation, which could be exploited by an attacker to gain elevated privileges.", "Business Impact": "This vulnerability could result in significant business disruption and financial loss if exploited successfully.", "Technical Impact": "This vulnerability could allow an attacker to execute arbitrary code with kernel-level permissions, giving them access to sensitive data and systems.", "Mitigation Strategies": "Apply the patch to the kernel, or update to the latest kernel version to receive the patch", "Recommendations": "Immediately apply the patch to the kernel, or update to the latest kernel version to receive the patch.", "Conclusions": "This vulnerability is a significant threat to Linux kernel security, and users are advised to take immediate action to patch or update their systems."}}