{"id": "CVE-2024-2494", "sourceIdentifier": "secalert@redhat.com", "published": "2024-03-21T14:15:10.350", "lastModified": "2024-06-10T17:16:25.307", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A flaw was found in the RPC library APIs of libvirt. The RPC server deserialization code allocates memory for arrays before the non-negative length check is performed by the C API entry points. Passing a negative length to the g_new0 function results in a crash due to the negative length being treated as a huge positive number. This flaw allows a local, unprivileged user to perform a denial of service attack by causing the libvirt daemon to crash."}, {"lang": "es", "value": "Se encontr\u00f3 una falla en las API de la librer\u00eda RPC de libvirt. El c\u00f3digo de deserializaci\u00f3n del servidor RPC asigna memoria para las matrices antes de que los puntos de entrada de la API de C realicen la verificaci\u00f3n de longitud no negativa. Pasar una longitud negativa a la funci\u00f3n g_new0 provoca un bloqueo debido a que la longitud negativa se trata como un n\u00famero positivo enorme. Esta falla permite que un usuario local sin privilegios realice un ataque de denegaci\u00f3n de servicio provocando la falla del demonio libvirt."}], "metrics": {"cvssMetricV31": [{"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.2, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.5, "impactScore": 3.6}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-789"}]}], "references": [{"url": "https://access.redhat.com/errata/RHSA-2024:2560", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/errata/RHSA-2024:3253", "source": "secalert@redhat.com"}, {"url": "https://access.redhat.com/security/cve/CVE-2024-2494", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2270115", "source": "secalert@redhat.com"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/04/msg00000.html", "source": "secalert@redhat.com"}, {"url": "https://lists.libvirt.org/archives/list/devel@lists.libvirt.org/thread/BKRQXPLPC6B7FLHJXSBQYW7HNDEBW6RJ/", "source": "secalert@redhat.com"}, {"url": "https://security.netapp.com/advisory/ntap-20240517-0009/", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-2494 - This is a classic example of a memory corruption vulnerability, which can be exploited by an attacker to cause a denial of service. To defend against this, implement memory protection mechanisms, such as SMEP, SMEP, and PTE, as well as use a reliable operating system and avoid legacy software."}, {"techniqueID": "T1027", "comment": "CVE-2024-2494 - This vulnerability can be exploited by an attacker to gain access to sensitive information such as the memory contents of the libvirt daemon. To defend against this, implement memory protection mechanisms, such as SMEP, SMEP, and PTE, as well as use a reliable operating system and avoid legacy software."}, {"techniqueID": "T1508", "comment": "CVE-2024-2494 - This vulnerability can also be exploited by an attacker to crash the system or cause a denial of service. To defend against this, implement memory protection mechanisms, such as SMEP, SMEP, and PTE, as well as use a reliable operating system and avoid legacy software."}, {"techniqueID": "T1408", "comment": "CVE-2024-2494 - This vulnerability can be found in the RPC library of the libvirt daemon. To defend against this, ensure that the libvirt daemon is updated with the latest patches and only use trusted and up-to-date dependencies."}], "stix_bundle": {"Bundle": {"title": "CVE-2024-2494 Bundle", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "objects": [{"type": "vulnerability", "id": "vulnerability--1", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "vulnerability_name": "CVE-2024-2494", "description": "A flaw was found in the RPC library APIs of libvirt. The RPC server deserialization code allocates memory for arrays before the non-negative length check is performed by the C API entry points. Passing a negative length to the g_new0 function results in a crash due to the negative length being treated as a huge positive number.", "references": [{"source_name": "secalert@redhat.com", "reference_url": "https://access.redhat.com/errata/RHSA-2024:2560"}], "related_indentifiers": [{"related_identifier_type": "CVE", "related_identifier_value": "CVE-2024-2494"}]}, {"type": "identity", "id": "identity--1", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "identity_class": "org", "name": "secalert@redhat.com"}, {"type": "course-of-action", "id": "course-of-action--1", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "title": "Apply latest patches", "description": "Apply the latest patches to the libvirt daemon to prevent exploitation of this vulnerability.", "mitigates": [{"mitigated_vulnerability_ref": "vulnerability--1", "mitigation_technique": "T1408", "technique_comment": "Apply the latest patches to the RPC library of the libvirt daemon to prevent exploitation of this vulnerability."}]}, {"type": "course-of-action", "id": "course-of-action--2", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "title": "Use trusted dependencies", "description": "Only use trusted and up-to-date dependencies for the libvirt daemon to prevent exploitation of this vulnerability.", "mitigates": [{"mitigated_vulnerability_ref": "vulnerability--1", "mitigation_technique": "T1408", "technique_comment": "Use trusted dependencies for the RPC library of the libvirt daemon to prevent exploitation of this vulnerability."}]}, {"type": "x_mitre_ttp", "id": "x_mitre_ttp--1", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "name": "T1190", "description": "Exploit memory corruption vulnerability"}, {"type": "x_mitre_ttp", "id": "x_mitre_ttp--2", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "name": "T1027", "description": "Deny write access"}, {"type": "x_mitre_ttp", "id": "x_mitre_ttp--3", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "name": "T1508", "description": "Cause system crash"}, {"type": "role", "id": "role--1", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "role_name": "Vulnerable User"}, {"type": "relationship", "id": "relationship--1", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "source_ref": "role--1", "target_ref": "vulnerability--1", "relationship_type": "Has vulnerabilities"}, {"type": "relationship", "id": "relationship--2", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "source_ref": "course-of-action--1", "target_ref": "vulnerability--1", "relationship_type": "Mitigates"}, {"type": "relationship", "id": "relationship--3", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "source_ref": "course-of-action--2", "target_ref": "vulnerability--1", "relationship_type": "Mitigates"}, {"type": "relationship", "id": "relationship--4", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "source_ref": "x_mitre_ttp--1", "target_ref": "vulnerability--1", "relationship_type": "Exploits"}, {"type": "relationship", "id": "relationship--5", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "source_ref": "x_mitre_ttp--2", "target_ref": "vulnerability--1", "relationship_type": "Mitigates"}, {"type": "relationship", "id": "relationship--6", "created_by_ref": "https://stix2.io", "modified": "2024-06-10T17:16:25.307Z", "source_ref": "x_mitre_ttp--3", "target_ref": "vulnerability--1", "relationship_type": "Exploits"}]}}, "technical_analysis": {"Introduction": "The CVE-2024-2494 vulnerability is a memory corruption vulnerability in the RPC library APIs of libvirt.", "Impact and Scope": "This vulnerability allows an attacker to cause a denial of service or crash the system by passing a negative length to the g_new0 function.", "Related MITRE ATT&CK Techniques": "The MITRE ATT&CK techniques related to this vulnerability are T1190, T1027, and T1508.", "Technical Details": "The vulnerability is caused by the RPC server deserialization code allocating memory for arrays before the non-negative length check is performed by the C API entry points.", "Detection": "Detection of this vulnerability requires monitoring for system crashes or denial of service attacks.", "Mitigation": "Mitigation of this vulnerability requires applying the latest patches to the libvirt daemon and only using trusted and up-to-date dependencies.", "Conclusion": "In conclusion, the CVE-2024-2494 vulnerability is a memory corruption vulnerability that can cause a denial of service or crash the system. It is essential to apply the latest patches and use trusted and up-to-date dependencies to mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-2494 vulnerability is a critical memory corruption vulnerability in the RPC library APIs of libvirt.", "Business Impact": "This vulnerability can cause significant business disruption by causing system crashes or denial of service attacks.", "Technical Impact": "This vulnerability can be exploited by an attacker to gain access to sensitive information or cause system crashes.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are to apply the latest patches to the libvirt daemon and only use trusted and up-to-date dependencies.", "Recommendations": "We recommend that organizations apply the latest patches to the libvirt daemon and only use trusted and up-to-date dependencies to mitigate this vulnerability.", "Conclusions": "In conclusion, the CVE-2024-2494 vulnerability is a critical memory corruption vulnerability that requires prompt attention and mitigation."}}