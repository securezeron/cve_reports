{"id": "CVE-2024-3568", "sourceIdentifier": "security@huntr.dev", "published": "2024-04-10T17:15:58.160", "lastModified": "2024-04-10T19:49:51.183", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "The huggingface/transformers library is vulnerable to arbitrary code execution through deserialization of untrusted data within the `load_repo_checkpoint()` function of the `TFPreTrainedModel()` class. Attackers can execute arbitrary code and commands by crafting a malicious serialized payload, exploiting the use of `pickle.load()` on data from potentially untrusted sources. This vulnerability allows for remote code execution (RCE) by deceiving victims into loading a seemingly harmless checkpoint during a normal training process, thereby enabling attackers to execute arbitrary code on the targeted machine."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:C/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 3.4, "baseSeverity": "LOW"}, "exploitabilityScore": 1.6, "impactScore": 1.4}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-502"}]}], "references": [{"url": "https://github.com/huggingface/transformers/commit/693667b8ac8138b83f8adb6522ddaf42fa07c125", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/b3c36992-5264-4d7f-9906-a996efafba8f", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1204", "comment": "CVE-2024-3568 - The \"Hugging Face Transformers library code execution through deserialization\" vulnerability allows attackers to execute arbitrary code and commands. This technique can be used to gain access to the targeted machine."}, {"techniqueID": "T1203", "comment": "CVE-2024-3568 - The malicious pickle payload can be used to exploit the vulnerability and execute arbitrary code. This technique can be used to perform code injection attacks."}, {"techniqueID": "T1059", "comment": "CVE-2024-3568 - The vulnerability can be exploited by creating a malicious serialized payload and deceiving victims into loading the payload. This technique can be used to perform command injection attacks."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2024-3568", "created_by_ref": "https://stix-example.com/CVE-2024-3568", "modified": "2024-04-10T19:49:51.183", "description": "The huggingface/transformers library is vulnerable to arbitrary code execution through deserialization of untrusted data within the `load_repo_checkpoint()` function of the `TFPreTrainedModel()` class.", "refs": [{"relationship": "related", "id_ref": "https://github.com/huggingface/transformers/commit/693667b8ac8138b83f8adb6522ddaf42fa07c125", "type": "github-commit"}, {"relationship": "related", "id_ref": "https://huntr.com/bounties/b3c36992-5264-4d7f-9906-a996efafba8f", "type": "huntr-bounty"}]}, {"type": "attack-pattern", "id": "T1204", "created_by_ref": "https://stix-example.com/T1204", "modified": "2024-04-10T19:49:51.183", "name": "Code Injection via Deserialization", "description": "The ability to inject code into a vulnerable application by deserializing untrusted data."}, {"type": "attack-pattern", "id": "T1203", "created_by_ref": "https://stix-example.com/T1203", "modified": "2024-04-10T19:49:51.183", "name": "Code Injection via Untrusted Payload", "description": "The ability to inject code into a vulnerable application by using an untrusted payload."}, {"type": "attack-pattern", "id": "T1059", "created_by_ref": "https://stix-example.com/T1059", "modified": "2024-04-10T19:49:51.183", "name": "Command and Control- Remote File Copy", "description": "The ability to execute arbitrary commands on a remote system by using a command injector."}, {"type": "cve", "id": "CVE-2024-3568", "created_by_ref": "https://stix-example.com/CVE-2024-3568", "modified": "2024-04-10T19:49:51.183", "name": "CVE-2024-3568", "description": "The huggingface/transformers library is vulnerable to arbitrary code execution through deserialization of untrusted data within the `load_repo_checkpoint()` function of the `TFPreTrainedModel()` class."}, {"type": "analyzer", "id": "Python Analyzer", "created_by_ref": "https://stix-example.com/Python Analyzer", "modified": "2024-04-10T19:49:51.183", "name": "Python Analyzer", "description": "An analyzer that detects the CVE-2024-3568 vulnerability in Python code."}], "relationships": [{"type": "vulnerability", "id": "CVE-2024-3568", "source_ref": "https://stix-example.com/CVE-2024-3568", "target_ref": "https://stix-example.com/T1204"}, {"type": "vulnerability", "id": "CVE-2024-3568", "source_ref": "https://stix-example.com/CVE-2024-3568", "target_ref": "https://stix-example.com/T1203"}, {"type": "vulnerability", "id": "CVE-2024-3568", "source_ref": "https://stix-example.com/CVE-2024-3568", "target_ref": "https://stix-example.com/T1059"}]}, "technical_analysis": {"Introduction": "The CVE-2024-3568 vulnerability is a code injection vulnerability in the huggingface/transformers library. This vulnerability can be exploited by deserializing untrusted data into the `load_repo_checkpoint()` function of the `TFPreTrainedModel()` class.", "Impact and Scope": "The vulnerability affects multiple versions of the huggingface/transformers library and has a CVSS score of 3.4. The vulnerability can be exploited by creating a malicious serialized payload and deceiving victims into loading the payload.", "Related MITRE ATT&CK Techniques": "The CVE-2024-3568 vulnerability is related to the following MITRE ATT&CK techniques: T1204, T1203, and T1059", "Technical Details": "The vulnerability is caused by the use of `pickle.load()` on data from potentially untrusted sources in the `load_repo_checkpoint()` function of the `TFPreTrainedModel()` class.", "Detection": "The vulnerability can be detected by using a Python analyzer that detects the CVE-2024-3568 vulnerability in Python code.", "Mitigation": "The vulnerability can be mitigated by patching the affected versions of the huggingface/transformers library and ensuring that untrusted data is not deserializable.", "Conclusion": "The CVE-2024-3568 vulnerability is a serious code injection vulnerability that can be exploited by creating a malicious serialized payload and deceiving victims into loading the payload. This vulnerability can be mitigated by patching the affected versions of the huggingface/transformers library and ensuring that untrusted data is not deserializable."}, "executive_analysis": {"Overview": "The CVE-2024-3568 vulnerability is a serious code injection vulnerability in the huggingface/transformers library.", "Business Impact": "This vulnerability can lead to unauthorized code execution, data breaches, and other security incidents.", "Technical Impact": "The vulnerability can be exploited by creating a malicious serialized payload and deceiving victims into loading the payload.", "Mitigation Strategies": "The vulnerability can be mitigated by patching the affected versions of the huggingface/transformers library and ensuring that untrusted data is not deserializable.", "Recommendations": "Recommendations for executives include patching the affected versions of the huggingface/transformers library, ensuring that untrusted data is not deserializable, and implementing additional security measures to prevent code injection attacks.", "Conclusions": "In conclusion, the CVE-2024-3568 vulnerability is a serious code injection vulnerability that can be exploited by creating a malicious serialized payload and deceiving victims into loading the payload. It is recommended that all affected versions of the huggingface/transformers library be patched and untrusted data not be deserializable."}}