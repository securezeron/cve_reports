{"id": "CVE-2020-13347", "sourceIdentifier": "cve@gitlab.com", "published": "2020-10-07T14:15:11.827", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "A command injection vulnerability was discovered in Gitlab runner versions prior to 13.2.4, 13.3.2 and 13.4.1. When the runner is configured on a Windows system with a docker executor, which allows the attacker to run arbitrary commands on Windows host, via DOCKER_AUTH_CONFIG build variable."}, {"lang": "es", "value": "Se detect\u00f3 una vulnerabilidad de inyecci\u00f3n de comandos en el ejecutor de Gitlab versiones anteriores a 13.2.4, 13.3.2 y 13.4.1.&#xa0;Cuando el ejecutor est\u00e1 configurado en un sistema Windows con un ejecutor docker, permitiendo al atacante ejecutar comandos arbitrarios en el host de Windows, por medio de la variable de compilaci\u00f3n DOCKER_AUTH_CONFIG"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.3, "impactScore": 6.0}, {"source": "cve@gitlab.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.3, "impactScore": 6.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "12.0.0", "versionEndExcluding": "13.2.4", "matchCriteriaId": "CA7D66F8-0E12-4063-83C1-06CBCD8D0001"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "12.0.0", "versionEndExcluding": "13.2.4", "matchCriteriaId": "51687A1F-1E2E-4FCF-AA2F-4B5800F53996"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "13.3.0", "versionEndExcluding": "13.3.2", "matchCriteriaId": "F87394D4-69DE-4BFB-A83E-5D5AB69A4393"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "13.3.0", "versionEndExcluding": "13.3.2", "matchCriteriaId": "A201A36B-5D81-4D1D-BE92-F06CD9009C4F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*", "versionStartIncluding": "13.4.0", "versionEndExcluding": "13.4.1", "matchCriteriaId": "2FEB2D55-423B-4CE6-9A38-CFABD960DBDF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "13.4.0", "versionEndExcluding": "13.4.1", "matchCriteriaId": "D28DF4FF-6C22-4212-9889-83997BE787D9"}]}]}], "references": [{"url": "https://gitlab.com/gitlab-org/cves/-/blob/master/2020/CVE-2020-13347.json", "source": "cve@gitlab.com", "tags": ["Vendor Advisory"]}, {"url": "https://gitlab.com/gitlab-org/gitlab-runner/-/issues/26725", "source": "cve@gitlab.com", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "https://hackerone.com/reports/955016", "source": "cve@gitlab.com", "tags": ["Permissions Required", "Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0003: Command and Control", "comment": "CVE-2020-13347 - As a command injection vulnerability, an attacker can potentially use the DOCKER_AUTH_CONFIG build variable to execute arbitrary commands on the Windows host. This technique can be used by the attacker to maintain persistence or move laterally within the network."}, {"techniqueID": "TA0004: Initial Access", "comment": "CVE-2020-13347 - As a command injection vulnerability, an attacker can potentially use the DOCKER_AUTH_CONFIG build variable to execute arbitrary commands on the Windows host. This technique can be used by the attacker to gain initial access to the network."}, {"techniqueID": "TA0005: Encryption", "comment": "CVE-2020-13347 - As a command injection vulnerability, an attacker can potentially use the DOCKER_AUTH_CONFIG build variable to execute arbitrary commands on the Windows host. This technique can be used by the attacker to encrypt data before exfiltrating it."}, {"techniqueID": "TA0006: Data Encoding", "comment": "CVE-2020-13347 - As a command injection vulnerability, an attacker can potentially use the DOCKER_AUTH_CONFIG build variable to execute arbitrary commands on the Windows host. This technique can be used by the attacker to encode sensitive data before exfiltrating it."}, {"techniqueID": "TA0011: Exploitation of Authentication Mechanism", "comment": "CVE-2020-13347 - As a command injection vulnerability, an attacker can potentially use the DOCKER_AUTH_CONFIG build variable to execute arbitrary commands on the Windows host. This technique can be used by the attacker to exploit the authentication mechanism of the targeted system."}, {"techniqueID": "TA0033: Lateral Movement", "comment": "CVE-2020-13347 - As a command injection vulnerability, an attacker can potentially use the DOCKER_AUTH_CONFIG build variable to execute arbitrary commands on the Windows host. This technique can be used by the attacker to move laterally within the network and maintain persistence."}], "stix_bundle": {"stix": [{"type": "vulnerability", "id": "vulnerability--e9a3a65c-4a12-4545-8a5c-54c1db74b10d", "created_by_ref": "identity--a62c8f6c-44a1-43f0-a35a-9c5af49b50ca", "modified": "2021-07-21T11:39:23.747", "name": "CVE-2020-13347: Command Injection in GitLab Runner", "description": "A command injection vulnerability was discovered in Gitlab runner versions prior to 13.2.4, 13.3.2 and 13.4.1. When the runner is configured on a Windows system with a docker executor, which allows the attacker to run arbitrary commands on Windows host, via DOCKER_AUTH_CONFIG build variable.", "severity": "critical", "vulnerability_score": 9.1, "risk_level": "High", "resource_id": "cve--cve--2020--13347", "resource_type": "CVE"}, {"type": "identity", "id": "identity--a62c8f6c-44a1-43f0-a35a-9c5af49b50ca", "created_by_ref": "identity--a62c8f6c-44a1-43f0-a35a-9c5af49b50ca", "modified": "2021-07-21T11:39:23.747", "name": "Vulnerability Analyst", "description": "Vulnerability Analyst"}, {"type": "course-of-action", "id": "course-of-action--98f26e4f-b7b6-4a3c-b1e1-0ad5fa5f5b1c", "created_by_ref": "identity--a62c8f6c-44a1-43f0-a35a-9c5af49b50ca", "modified": "2021-07-21T11:39:23.747", "name": "Update GitLab Runner to latest version", "description": "Update GitLab Runner to the latest version to fix the command injection vulnerability", "mitigated_by_ref": "vulnerability--e9a3a65c-4a12-4545-8a5c-54c1db74b10d", "mitigated_vulnerability_ref": "vulnerability--e9a3a65c-4a12-4545-8a5c-54c1db74b10d", "resource_id": "course-of-action--98f26e4f-b7b6-4a3c-b1e1-0ad5fa5f5b1c", "resource_type": "Course-Of-Action"}, {"type": "technical", "id": "note--e3c4f3e6-4c6f-4d36-b5a5-a79e7a3a6f7d", "created_by_ref": "identity--a62c8f6c-44a1-43f0-a35a-9c5af49b50ca", "modified": "2021-07-21T11:39:23.747", "note": "This note describes the technical details of the vulnerability", "resource_id": "note--e3c4f3e6-4c6f-4d36-b5a5-a79e7a3a6f7d", "resource_type": "Note"}, {"type": "mitigation", "id": "note--83e5eb41-d2f7-424c-b48c-54f24bb27a5c", "created_by_ref": "identity--a62c8f6c-44a1-43f0-a35a-9c5af49b50ca", "modified": "2021-07-21T11:39:23.747", "note": "This note describes the mitigation strategies for the vulnerability", "resource_id": "note--83e5eb41-d2f7-424c-b48c-54f24bb27a5c", "resource_type": "Note"}]}, "technical_analysis": {"Introduction": "CVE-2020-13347 is a command injection vulnerability in GitLab Runner versions prior to 13.2.4, 13.3.2 and 13.4.1.", "Impact and Scope": "The vulnerability allows an attacker to run arbitrary commands on the Windows host, which can be used to gain initial access to the network, move laterally within the network and maintain persistence.", "Related MITRE ATT&CK Techniques": "TA0003: Command and Control, TA0004: Initial Access, TA0011: Exploitation of Authentication Mechanism, TA0033: Lateral Movement", "Technical Details": "The vulnerability is caused by a command injection in the DOCKER_AUTH_CONFIG build variable, which allows the attacker to execute arbitrary commands on the Windows host.", "Detection": "Detecting the vulnerability requires monitoring for unusual command injection activity in the DOCKER_AUTH_CONFIG build variable.", "Mitigation": "The vulnerability can be mitigated by updating GitLab Runner to the latest version, which fixes the command injection vulnerability.", "Conclusion": "In conclusion, CVE-2020-13347 is a critical vulnerability in GitLab Runner that allows an attacker to run arbitrary commands on the Windows host. It is essential to update GitLab Runner to the latest version to mitigate the vulnerability."}, "executive_analysis": {"Overview": "CVE-2020-13347 is a critical vulnerability in GitLab Runner that allows an attacker to run arbitrary commands on the Windows host.", "Business Impact": "The vulnerability can be used to gain initial access to the network, move laterally within the network and maintain persistence, which can result in significant business disruptions.", "Technical Impact": "The vulnerability can be used to execute arbitrary commands on the Windows host, which can result in unauthorized access to sensitive data and systems.", "Mitigation Strategies": "The vulnerability can be mitigated by updating GitLab Runner to the latest version, which fixes the command injection vulnerability.", "Recommendations": "We recommend that GitLab Runner be updated to the latest version as soon as possible to mitigate the vulnerability.", "Conclusions": "In conclusion, CVE-2020-13347 is a critical vulnerability in GitLab Runner that requires immediate attention and mitigation."}}