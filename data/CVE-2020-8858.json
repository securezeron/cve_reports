{"id": "CVE-2020-8858", "sourceIdentifier": "zdi-disclosures@trendmicro.com", "published": "2020-02-14T18:15:11.433", "lastModified": "2020-02-19T18:53:46.037", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "This vulnerability allows remote attackers to execute arbitrary code on affected installations of Moxa MGate 5105-MB-EIP firmware version 4.1. Authentication is required to exploit this vulnerability. The specific flaw exists within the DestIP parameter within MainPing.asp. The issue results from the lack of proper validation of a user-supplied string before using it to execute a system call. An attacker can leverage this vulnerability to execute code in the context of root. Was ZDI-CAN-9552."}, {"lang": "es", "value": "Esta vulnerabilidad permite a atacantes remotos ejecutar c\u00f3digo arbitrario en las instalaciones afectadas de Moxa MGate 5105-MB-EIP versi\u00f3n de firmware 4.1. Es requerida una autenticaci\u00f3n para explotar esta vulnerabilidad. El fallo espec\u00edfico se presenta dentro del par\u00e1metro DestIP dentro del archivo MainPing.asp. El problema resulta de una falta de comprobaci\u00f3n apropiada de una cadena suministrada por parte del usuario antes de usarla para ejecutar una llamada al sistema. Un atacante puede aprovechar esta vulnerabilidad para ejecutar c\u00f3digo en el contexto de root. Fue ZDI-CAN-9552."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV30": [{"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}, {"source": "zdi-disclosures@trendmicro.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:moxa:mgate_5105-mb-eip_firmware:*:*:*:*:*:*:*:*", "versionEndIncluding": "4.1", "matchCriteriaId": "8CE13572-489E-4979-80EF-14A57A74B6E7"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:moxa:mgate_5105-mb-eip:-:*:*:*:*:*:*:*", "matchCriteriaId": "C8183845-C267-481A-A0F6-8B701A1BDDFD"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:moxa:mgate_5105-mb-eip-t_firmware:*:*:*:*:*:*:*:*", "versionEndIncluding": "4.1", "matchCriteriaId": "ED26DD65-9445-455B-931D-43F1B9C36BB6"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:moxa:mgate_5105-mb-eip-t:-:*:*:*:*:*:*:*", "matchCriteriaId": "E402E877-096E-412D-8FF9-B669F196D4FF"}]}]}], "references": [{"url": "https://www.moxa.com/en/support/support/security-advisory/mgate-5105-mb-eip-series-protocol-gateways-vulnerability", "source": "zdi-disclosures@trendmicro.com", "tags": ["Vendor Advisory"]}, {"url": "https://www.zerodayinitiative.com/advisories/ZDI-20-214/", "source": "zdi-disclosures@trendmicro.com", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1564.001", "comment": "CVE-2020-8858 is a remote command execution vulnerability that allows attackers to execute arbitrary code on affected installations of Moxa MGate 5105-MB-EIP firmware version 4.1. This vulnerability can be exploited by an attacker to gain unauthorized access to the system, execute code in the context of root, and disrupt system operations."}, {"techniqueID": "T1210", "comment": "This vulnerability can be exploited by an attacker to execute arbitrary code on the affected system, allowing them to manipulate the system configuration and data, and potentially leading to data breaches or system compromise."}, {"techniqueID": "T1190", "comment": "The vulnerability in CVE-2020-8858 is due to a lack of proper validation of a user-supplied string before using it to execute a system call. This can be exploited by an attacker to inject arbitrary commands and execute code on the system, leading to unauthorized system access and control."}, {"techniqueID": "T1059.005", "comment": "An attacker could use this vulnerability to execute custom shellcode, allowing them to obtain sensitive data, manipulate system files, and maintain persistence on the system."}, {"techniqueID": "T1047", "comment": "The vulnerability in CVE-2020-8858 can be used by an attacker to execute arbitrary code on the system, allowing them to conduct lateral movement, maintain persistence, and potentially gain access to sensitive data."}], "stix_bundle": {"id": "vx-2020-8858", "type": "bundle", "created_by_ref": "vx-2020-8858", "modified": "2020-02-19T18:53:46.037", "objects": [{"id": "vx-2020-8858", "type": "attack-pattern", "name": "CVE-2020-8858: Moxa MGate 5105-MB-EIP Remote Command Execution", "description": "This attack pattern corresponds to the CVE-2020-8858 vulnerability in Moxa MGate 5105-MB-EIP firmware version 4.1.", "kill_chain_phases": [{"id": "vx-2020-8858", "type": "kill-chain-phase", "name": "Exploit", "description": "The vulnerability is exploited by an attacker to execute arbitrary code on the affected system."}, {"id": "vx-2020-8858", "type": "kill-chain-phase", "name": "Post Exploitation", "description": "The attacker uses the executed code to manipulate the system configuration and data, and potentially gain unauthorized access to the system."}], "techniques": [{"id": "vx-2020-8858-T1564.001", "type": "technique", "name": " CVE-2020-8858: T1564.001", "description": "The vulnerability can be exploited by an attacker to execute arbitrary code on the affected system, allowing them to manipulate the system configuration and data."}], "courses_of_action": [{"id": "vx-2020-8858-C002", "type": "course-of-action", "name": "Update firmware to version 4.2 or later", "description": "Apply the firmware update to mitigate the vulnerability."}, {"id": "vx-2020-8858-C003", "type": "course-of-action", "name": "Restrict network access", "description": "Restrict network access to the affected system to prevent exploitation."}]}, {"id": "vx-2020-8858-risks", "type": "impact", "name": "CVE-2020-8858: Risks", "description": "This attack pattern corresponds to the CVE-2020-8858 vulnerability in Moxa MGate 5105-MB-EIP firmware version 4.1.", "impact_types": [{"id": "vx-2020-8858-I01", "type": "impact-type", "name": "Data Breach", "description": "The attacker can access sensitive data on the affected system."}, {"id": "vx-2020-8858-I02", "type": "impact-type", "name": "System Compromise", "description": "The attacker can gain unauthorized access to the system."}]}], "knowledge_location": "https://www.moxa.com/en/support/support/security-advisory/mgate-5105-mb-eip-series-protocol-gateways-vulnerability"}, "technical_analysis": {"Introduction": "The CVE-2020-8858 vulnerability is a remote command execution vulnerability in Moxa MGate 5105-MB-EIP firmware version 4.1.", "Impact and Scope": "The vulnerability allows an attacker to execute arbitrary code on the affected system, gaining unauthorized access and control.", "Related MITRE ATT&CK Techniques": "The vulnerability can be used to exploit the T1210, T1047, T1190, and T1059.005 techniques.", "Technical Details": "The vulnerability is due to a lack of proper validation of a user-supplied string before using it to execute a system call.", "Detection": "Detection methods include monitoring system logs for suspicious activity and analyzing network traffic for signs of exploitation.", "Mitigation": "Mitigation strategies include updating firmware to version 4.2 or later, restricting network access, and implementing intrusion detection and prevention systems.", "Conclusion": "The CVE-2020-8858 vulnerability is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2020-8858 vulnerability is a critical remote command execution vulnerability that allows an attacker to execute arbitrary code on the affected system.", "Business Impact": "The vulnerability can lead to data breaches, system compromise, and unauthorized access to sensitive data.", "Technical Impact": "The vulnerability can be used to exploit multiple MITRE ATT&CK techniques, allowing the attacker to gain control of the system.", "Mitigation Strategies": "Mitigation strategies include updating firmware, restricting network access, and implementing security controls.", "Recommendations": "Recommendations include conducting a thorough security assessment, implementing a vulnerability management program, and providing training on security best practices.", "Conclusions": "The CVE-2020-8858 vulnerability is a critical issue that requires immediate attention and mitigation to prevent exploitation and minimize the impact on the organization."}}