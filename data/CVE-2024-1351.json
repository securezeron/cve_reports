{"id": "CVE-2024-1351", "sourceIdentifier": "cna@mongodb.com", "published": "2024-03-07T17:15:12.740", "lastModified": "2024-06-10T17:16:16.907", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Under certain configurations of --tlsCAFile and tls.CAFile, MongoDB Server may skip peer certificate validation which may result in untrusted connections to succeed. This may effectively reduce the security guarantees provided by TLS and open connections  that should have been closed due to failing certificate validation. This issue affects MongoDB Server v7.0 versions prior to and including 7.0.5, MongoDB Server v6.0 versions prior to and including 6.0.13, MongoDB Server v5.0 versions prior to and including 5.0.24 and MongoDB Server v4.4 versions prior to and including 4.4.28.\n\nRequired Configuration : A server process will allow incoming connections to skip peer certificate validation if the server process was started with TLS enabled (net.tls.mode set to allowTLS, preferTLS, or requireTLS) and without a net.tls.CAFile configured.\n\n"}, {"lang": "es", "value": "Bajo ciertas configuraciones de --tlsCAFile y tls.CAFile, el servidor MongoDB puede omitir la validaci\u00f3n de certificados de pares, lo que puede resultar en conexiones que no son de confianza para tener \u00e9xito. Esto puede reducir efectivamente las garant\u00edas de seguridad proporcionadas por TLS y abrir conexiones que deber\u00edan haberse cerrado debido a una validaci\u00f3n fallida del certificado. Este problema afecta a las versiones de MongoDB Server v7.0 anteriores a 7.0.5 incluida, a las versiones de MongoDB Server v6.0 anteriores a 6.0.13 incluida, a las versiones de MongoDB Server v5.0 anteriores a 5.0.24 incluida y a MongoDB Server v4.4 Versiones anteriores a la 4.4.28 incluida. Configuraci\u00f3n requerida: un proceso de servidor permitir\u00e1 que las conexiones entrantes omitan la validaci\u00f3n del certificado de pares si el proceso del servidor se inici\u00f3 con TLS habilitado (net.tls.mode configurado en enableTLS, preferTLS o requireTLS) y sin un archivo net.tls.CAFile configurado."}], "metrics": {"cvssMetricV31": [{"source": "cna@mongodb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "cna@mongodb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-295"}]}], "references": [{"url": "https://jira.mongodb.org/browse/SERVER-72839", "source": "cna@mongodb.com"}, {"url": "https://security.netapp.com/advisory/ntap-20240524-0010/", "source": "cna@mongodb.com"}, {"url": "https://www.mongodb.com/docs/manual/release-notes/4.4/#4.4.29---february-28--2024", "source": "cna@mongodb.com"}, {"url": "https://www.mongodb.com/docs/manual/release-notes/7.0/#7.0.6---feb-28--2024", "source": "cna@mongodb.com"}, {"url": "https://www.mongodb.com/docs/v5.0/release-notes/5.0/#5.0.25---february-28--2024", "source": "cna@mongodb.com"}, {"url": "https://www.mongodb.com/docs/v6.0/release-notes/6.0/#6.0.14---feb-28--2024", "source": "cna@mongodb.com"}], "techniques": [{"techniqueID": "TA0010-001", "comment": "CVE-2024-1351 - Configurable environment variable manipulation attack. The attacker can manipulate the network settings to establish a trusted connection with the affected MongoDB server."}, {"techniqueID": "TA0010-002", "comment": "CVE-2024-1351 - Missing network encryption attack. The affected MongoDB server may skip peer certificate validation, allowing an attacker to establish an untrusted connection."}, {"techniqueID": "TA0011-001", "comment": "CVE-2024-1351 - Use of weak default settings attack. The affected MongoDB server may use weak default settings for the net.tls.mode and net.tls.CAFile configuration options, allowing an attacker to exploit the vulnerability."}], "stix_bundle": {"objects": {"instancetype": "vulnerability", "created_by_ref": "https://mitre ATT&CK", "modified": "2024-03-07T17:15:12.740", "stix_id": "CVE-2024-1351", "description": "Under certain configurations of --tlsCAFile and tls.CAFile, MongoDB Server may skip peer certificate validation which may result in untrusted connections to succeed.", "created": "2024-03-07T17:15:12.740", "modified_by_ref": "https://mitre ATT&CK", "identifiers": ["CVE-2024-1351"], "languages": ["en"], "external_references": [{"source_name": "cna@mongodb.com", "external_id": "CVE-2024-1351", "url": "https://jira.mongodb.org/browse/SERVER-72839"}, {"source_name": "cna@mongodb.com", "external_id": "CVE-2024-1351", "url": "https://security.netapp.com/advisory/ntap-20240524-0010/"}]}, "relationships": {"related_indicators": [{"type": "indicator", "idRef": "https://mitre-attack.github.io/attack-data/d76e9a1c-a09b-4e92-9d54-7edd45d3f1fa", "relation_type": "uses"}], "related_vulnerabilities": [{"type": "vulnerability", "idRef": "CVE-2024-1351", "relation_type": "referenced"}]}}, "technical_analysis": {"Introduction": "The CVE-2024-1351 vulnerability is a configuration-based issue in MongoDB Server that allows untrusted connections to establish a connection with the affected MongoDB server.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to establish an untrusted connection with the affected MongoDB server. The scope of this vulnerability is limited to the affected MongoDB Server versions prior to and including 7.0.5, 6.0.13, 5.0.24, and 4.4.28.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to the TA0010-001, TA0010-002, and TA0011-001 MITRE ATT&CK techniques.", "Technical Details": "The vulnerability arises from the lack of proper configuration of the net.tls.mode and net.tls.CAFile options in the affected MongoDB Server versions. This allows an attacker to establish an untrusted connection with the affected MongoDB server.", "Detection": "Detection of this vulnerability can be done by monitoring network traffic and verifying the integrity of the affected MongoDB server configuration.", "Mitigation": "Mitigation strategies for this vulnerability include ensuring that the net.tls.mode and net.tls.CAFile options are properly configured, monitoring network traffic, and verifying the integrity of the affected MongoDB server configuration.", "Conclusion": "In conclusion, the CVE-2024-1351 vulnerability is a high-severity issue that allows an attacker to establish an untrusted connection with the affected MongoDB server. Proper configuration and monitoring of the affected MongoDB server can help mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2024-1351 vulnerability is a high-severity issue that affects MongoDB Server versions prior to and including 7.0.5, 6.0.13, 5.0.24, and 4.4.28.", "Business Impact": "The business impact of this vulnerability is significant, as it allows an attacker to establish an untrusted connection with the affected MongoDB server, potentially leading to data breaches and unauthorized access.", "Technical Impact": "The technical impact of this vulnerability is high, as it allows an attacker to establish an untrusted connection with the affected MongoDB server, potentially leading to data breaches and unauthorized access.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability include ensuring that the net.tls.mode and net.tls.CAFile options are properly configured, monitoring network traffic, and verifying the integrity of the affected MongoDB server configuration.", "Recommendations": "It is recommended that MongoDB Server administrators ensure that the net.tls.mode and net.tls.CAFile options are properly configured, monitor network traffic, and verify the integrity of the affected MongoDB server configuration to mitigate this vulnerability.", "Conclusions": "In conclusion, the CVE-2024-1351 vulnerability is a high-severity issue that requires immediate attention and mitigation. Proper configuration and monitoring of the affected MongoDB server can help prevent this vulnerability from being exploited."}}