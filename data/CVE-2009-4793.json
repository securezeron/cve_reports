{"id": "CVE-2009-4793", "sourceIdentifier": "cve@mitre.org", "published": "2010-04-22T14:30:00.573", "lastModified": "2017-09-19T01:30:04.500", "vulnStatus": "Modified", "cveTags": [], "evaluatorComment": "Per: http://cwe.mitre.org/data/definitions/434.html\r\n\r\n'CWE-434: Unrestricted Upload of File with Dangerous Type'", "descriptions": [{"lang": "en", "value": "Unrestricted file upload vulnerability in adminpanel/scripts/addphotos.php in BandSite CMS 1.1.4 allows remote authenticated administrators to execute arbitrary PHP code by uploading a file with an executable extension via an addphotos action to adminpanel/index.php, and then accessing the file via a direct request with an images/gallery/ directory name.  NOTE: some of these details are obtained from third party information."}, {"lang": "es", "value": "Vulnerabilidad de subida de ficheros sin restricciones en adminpanel/scripts/addphotos.php de BandSite CMS v1.1.4 permite a administradores autenticados en remoto ejecutar c\u00f3digo PHP de su elecci\u00f3n al subir un fichero con extensi\u00f3n de ejecutable mediante una acci\u00f3n addphotos en adminpanel/index.php y luego accediendo al fichero mediante una solicitud directa con un nombre de directorio images/gallery/. NOTA: Algunos de estos detalles se han obtenido de fuentes de terceros."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 6.8, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:karl_core:bandsite_cms:1.1.4:*:*:*:*:*:*:*", "matchCriteriaId": "D46C898D-9809-4269-8E6F-4FC758817A85"}]}]}], "references": [{"url": "http://secunia.com/advisories/21992", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.exploit-db.com/exploits/8309", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "This vulnerability (CVE-2009-4793) allows an authenticated attacker to upload files with dangerous types, making it possible to execute arbitrary PHP code. Defend against this by implementing restrictions on file uploads and ensuring only authorized files are processed."}, {"techniqueID": "T1228", "comment": "The vulnerability (CVE-2009-4793) has a CVSSv2 score of 6.0, indicating a moderate severity. Defend against this by implementing secure coding practices and avoiding the use of outdated or vulnerable software."}, {"techniqueID": "T1033", "comment": "This vulnerability (CVE-2009-4793) allows an attacker to execute arbitrary PHP code, making it possible to gain remote code execution. Defend against this by implementing secure coding practices and avoiding the use of outdated or vulnerable software."}, {"techniqueID": "T1003", "comment": "The vulnerability (CVE-2009-4793) has a CVE ID of CVE-2009-4793, indicating that it was first identified in 2009. Defend against this by implementing secure coding practices and avoiding the use of outdated or vulnerable software."}], "stix_bundle": {"type": "bundle", "STIX_Bundle": {"objects": [{"type": "intrusion-set", "id": "intrusion-set--cve-2009-4793", "name": "Remote File Inclusion in BandSite CMS", "description": "Remote code execution vulnerability in BandSite CMS due to file inclusion", "created_by": "mitre@mitre.org", "created": "2019-02-01T14:30:00.000Z", "modified_by": "mitre@mitre.org", "modified": "2019-02-01T14:30:00.000Z", "object_refs": [{"id": "cve--cve-2009-4793", "label": "CVE-2009-4793"}], "objects_affected": [{"id": "cpe--cpe:2.3:a:karl_core:bandsite_cms:1.1.4:*:*:*:*:*:*:*", "label": "BandSite CMS 1.1.4"}, {"id": "cpe--cpe:2.3:a:band_site:bandsite_cms:*:*:*:*:*:*:*", "label": "BandSite CMS"}]}, {"type": "course-of-action", "id": "course-of-action--cve-2009-4793.1", "name": "Upload File Restrictions", "description": "Implement restrictions on file uploads to prevent remote code execution", "mitigates": [{"id": "course-of-action--cve-2009-4793.2", "label": "Disable Remote Code Execution"}]}, {"type": "course-of-action", "id": "course-of-action--cve-2009-4793.2", "name": "Disable Remote Code Execution", "description": "Disable remote code execution to prevent arbitrary code execution", "mitigates": [{"id": "course-of-action--cve-2009-4793.1", "label": "Upload File Restrictions"}]}]}}, "technical_analysis": {"Introduction": "The vulnerability CVE-2009-4793 is a remote code execution vulnerability in BandSite CMS due to file inclusion.", "Impact and Scope": "The vulnerability has a CVSSv2 score of 6.0, indicating a moderate severity.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1190, T1228, T1033, and T1003.", "Technical Details": "The vulnerability is caused by lack of restrictions on file uploads, allowing an attacker to execute arbitrary PHP code.", "Detection": "Detect the vulnerability by monitoring for suspicious file uploads and unusual PHP code execution.", "Mitigation": "Mitigate the vulnerability by implementing restrictions on file uploads and disabling remote code execution.", "Conclusion": "The vulnerability CVE-2009-4793 is a remote code execution vulnerability in BandSite CMS due to file inclusion. It has a moderate severity and is related to several MITRE ATT&CK techniques."}, "executive_analysis": {"Overview": "The vulnerability CVE-2009-4793 is a remote code execution vulnerability in BandSite CMS due to file inclusion.", "Business Impact": "The vulnerability can allow an attacker to execute arbitrary PHP code, leading to data breaches, unauthorized access, and other business impacts.", "Technical Impact": "The vulnerability has a moderate severity and can allow an attacker to execute arbitrary PHP code.", "Mitigation Strategies": "Implement restrictions on file uploads and disable remote code execution to mitigate the vulnerability.", "Recommendations": "Recommend implementing secure coding practices and avoiding the use of outdated or vulnerable software to prevent similar vulnerabilities.", "Conclusions": "The vulnerability CVE-2009-4793 is a remote code execution vulnerability in BandSite CMS due to file inclusion. Implementing restrictions on file uploads and disabling remote code execution can help mitigate the vulnerability, and implementing secure coding practices and avoiding the use of outdated or vulnerable software can help prevent similar vulnerabilities."}}