{"id": "CVE-2020-8818", "sourceIdentifier": "cve@mitre.org", "published": "2020-02-25T02:15:12.097", "lastModified": "2020-03-05T18:06:25.017", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "An issue was discovered in the CardGate Payments plugin through 2.0.30 for Magento 2. Lack of origin authentication in the IPN callback processing function in Controller/Payment/Callback.php allows an attacker to remotely replace critical plugin settings (merchant ID, secret key, etc.) and therefore bypass the payment process (e.g., spoof an order status by manually sending an IPN callback request with a valid signature but without real payment) and/or receive all of the subsequent payments."}, {"lang": "es", "value": "Se detect\u00f3 un problema en el plugin CardGate Payments versiones hasta 2.0.30 para Magento 2. Una falta de autenticaci\u00f3n de origen en la funci\u00f3n de procesamiento de una devoluci\u00f3n de llamada IPN en el archivo Controller/Payment/Callback.php, permite a un atacante reemplazar remotamente las configuraciones de plugin criticas (ID del comerciante, clave secreta , etc.) y, por lo tanto, omitir el proceso de pago (por ejemplo, falsificar el estado de un pedido enviando manualmente una petici\u00f3n de devoluci\u00f3n de llamada IPN con una firma v\u00e1lida pero sin pago real) y/o recibir todos los pagos posteriores."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-346"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:cardgate:cardgate_payments:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.0.30", "matchCriteriaId": "7BD035FF-55DF-417A-99B2-8D6B574A8010"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:adobe:magento:2.3.4:*:*:*:*:*:*:*", "matchCriteriaId": "13054AA9-B4EF-40F2-9768-C4C00F766D40"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/156505/Magento-WooCommerce-CardGate-Payment-Gateway-2.0.30-Bypass.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/cardgate/magento2/blob/715979e54e1a335d78a8c5586f9e9987c3bf94fd/Controller/Payment/Callback.php#L88-L107", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/cardgate/magento2/issues/54", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}], "techniques": [{"techniqueID": "T1083", "comment": "This vulnerability could be exploited by an attacker to remotely replace critical plugin settings, potentially allowing them to bypass the payment process. - This is a relevant technique as it highlights the importance of secure origin authentication in web applications."}, {"techniqueID": "T1190", "comment": "Bypassing authentication mechanisms is a critical aspect of this vulnerability, making it relevant to this technique, which focuses on the bypass of security controls."}, {"techniqueID": "T1566", "comment": "The lack of origin authentication in this vulnerability can be exploited to manipulate the system, which is a key aspect of this technique, which focuses on the exploitation of misconfigurations."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/STIX_Bundle_1.0", "created_by_ref": "https://example.com/creator_1.0", "created": "2022-01-01T00:00:00.000Z", "modified": "2022-01-01T00:00:00.000Z", "description": "STIX Bundle for CVE-2020-8818", "objects": [{"type": "attack_pattern", "id": "https://example.com/attack_pattern_1.0", "name": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "description": "Exploit the vulnerability in the CardGate Payments plugin in Magento 2.", "created": "2022-01-01T00:00:00.000Z", "modified": "2022-01-01T00:00:00.000Z"}, {"type": "indicator", "id": "https://example.com/indicator_1.0", "name": "CardGate Payments Plugin in Magento 2", "description": "The CardGate Payments plugin in Magento 2 is vulnerable to origin authentication bypass.", "pattern": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "created": "2022-01-01T00:00:00.000Z", "modified": "2022-01-01T00:00:00.000Z"}, {"type": "course_of_action", "id": "https://example.com/course_of_action_1.0", "name": "Apply Origin Authentication", "description": "Apply origin authentication to prevent attackers from bypassing security controls.", "related_object_ref": "https://example.com/attack_pattern_1.0", "created": "2022-01-01T00:00:00.000Z", "modified": "2022-01-01T00:00:00.000Z"}], "relationships": [{"simplified_object_ref": "https://example.com/attack_pattern_1.0", "related_object_ref": "https://example.com/indicator_1.0", "label": "exploits"}, {"simplified_object_ref": "https://example.com/course_of_action_1.0", "related_object_ref": "https://example.com/attack_pattern_1.0", "label": "mitigates"}]}, "technical_analysis": {"Introduction": "The CardGate Payments plugin in Magento 2 is vulnerable to origin authentication bypass, allowing attackers to remotely replace critical plugin settings.", "Impact and Scope": "The vulnerability has a high CVSS score of 8.1 and affects versions of the plugin up to 2.0.30.", "Related MITRE ATT&CK Techniques": "T1083, T1190, and T1566", "Technical Details": "The vulnerability occurs in the IPN callback processing function in the Controller/Payment/Callback.php file.", "Detection": "The vulnerability can be detected by monitoring for unauthorized changes to the plugin settings.", "Mitigation": "Apply origin authentication to prevent attackers from bypassing security controls.", "Conclusion": "The vulnerability highlights the importance of secure origin authentication in web applications."}, "executive_analysis": {"Overview": "The CardGate Payments plugin in Magento 2 is vulnerable to origin authentication bypass.", "Business Impact": "The vulnerability could allow attackers to bypass the payment process, resulting in financial losses.", "Technical Impact": "The vulnerability could allow attackers to remotely replace critical plugin settings, potentially compromising the security of the system.", "Mitigation Strategies": "Apply origin authentication to prevent attackers from bypassing security controls.", "Recommendations": "Update the plugin to a secure version and implement origin authentication mechanisms.", "Conclusions": "The vulnerability highlights the importance of secure origin authentication in web applications and the need for timely updates and security patches."}}