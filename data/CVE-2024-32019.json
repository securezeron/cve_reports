{"id": "CVE-2024-32019", "sourceIdentifier": "security-advisories@github.com", "published": "2024-04-12T21:15:12.133", "lastModified": "2024-04-15T13:15:31.997", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Netdata is an open source observability tool. In affected versions the `ndsudo` tool shipped with affected versions of the Netdata Agent allows an attacker to run arbitrary programs with root permissions. The `ndsudo` tool is packaged as a `root`-owned executable with the SUID bit set. It only runs a restricted set of external commands, but its search paths are supplied by the `PATH` environment variable. This allows an attacker to control where `ndsudo` looks for these commands, which may be a path the attacker has write access to. This may lead to local privilege escalation. This vulnerability has been addressed in versions 1.45.3 and 1.45.2-169. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Netdata es una herramienta de observabilidad de c\u00f3digo abierto. En las versiones afectadas, la herramienta `ndsudo` incluida con las versiones afectadas del Netdata Agent permite a un atacante ejecutar programas arbitrarios con permisos de root. La herramienta `ndsudo` est\u00e1 empaquetada como un ejecutable propiedad de `root` con el bit SUID configurado. Solo ejecuta un conjunto restringido de comandos externos, pero sus rutas de b\u00fasqueda las proporciona la variable de entorno `PATH`. Esto permite a un atacante controlar d\u00f3nde busca `ndsudo` estos comandos, que puede ser una ruta a la que el atacante tiene acceso de escritura. Esto puede conducir a una escalada de privilegios locales. Esta vulnerabilidad se ha solucionado en las versiones 1.45.3 y 1.45.2-169. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.0, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-426"}]}], "references": [{"url": "https://github.com/netdata/netdata/pull/17377", "source": "security-advisories@github.com"}, {"url": "https://github.com/netdata/netdata/security/advisories/GHSA-pmhq-4cxq-wj93", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1078", "comment": "Accessing Credential Data (T1078) - This technique is relevant as an attacker can potentially gain access to sensitive information using the vulnerability in the Netdata Agent."}, {"techniqueID": "T1210", "comment": "Exploitation of Public-Facing Application (T1210) - This technique is relevant as an attacker can potentially exploit the vulnerability in the Netdata Agent to gain access to the system."}, {"techniqueID": "T1262", "comment": "Mimicry (T1262) - This technique is relevant as an attacker can potentially use the vulnerability in the Netdata Agent to create a copy of a legitimate process, further increasing the attack surface."}], "stix_bundle": {"objects": [{"id": "cve-2024-32019", "type": "vulnerability", "name": "Netdata Agent - SUID ndsudo Privilege Escalation", "description": ["This vulnerability allows an attacker to run arbitrary programs with root permissions."], "published": "2024-04-12T21:15:12.133", "last Modified": "2024-04-15T13:15:31.997", "cvss": {"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "baseScore": 8.8, "baseSeverity": "HIGH"}}, {"id": "t1078", "type": "attack-pattern", "name": "Accessing Credential Data", "description": ["Accessing Credential Data is a technique used by an attacker to gain unauthorized access to sensitive information."], "labels": ["T1078"]}, {"id": "t1210", "type": "attack-pattern", "name": "Exploitation of Public-Facing Application", "description": ["Exploitation of Public-Facing Application is a technique used by an attacker to exploit vulnerabilities in an application."], "labels": ["T1210"]}, {"id": "t1262", "type": "attack-pattern", "name": "Mimicry", "description": ["Mimicry is a technique used by an attacker to create a copy of a legitimate process."], "labels": ["T1262"]}, {"id": "d3fend-defense", "type": "course-of-action", "name": "CIS Compliance and Logging", "description": ["Implementing CIS compliance and logging can help detect and prevent attacks like this."], "techniques": ["t1078", "t1210", "t1262"]}], "relationships": [{"sourcedId": "cve-2024-32019", "targetId": "t1078", "relationshipType": "related-to"}, {"sourcedId": "cve-2024-32019", "targetId": "t1210", "relationshipType": "related-to"}, {"sourcedId": "cve-2024-32019", "targetId": "t1262", "relationshipType": "related-to"}, {"sourcedId": "d3fend-defense", "targetId": "cve-2024-32019", "relationshipType": "mitigates"}]}, "technical_analysis": {"Introduction": "The Netdata Agent vulnerability allows an attacker to run arbitrary programs with root permissions.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 8.8. The attack vector is local, and the attack complexity is low.", "Related MITRE ATT&CK Techniques": "The techniques related to this vulnerability are Accessing Credential Data (T1078), Exploitation of Public-Facing Application (T1210), and Mimicry (T1262).", "Technical Details": "The vulnerability is in the ndsudo tool, which is a SUID-rooted executable. The attacker can use this tool to run arbitrary commands with root permissions.", "Detection": "Detection is challenging, but logging and monitoring can help identify suspicious activity.", "Mitigation": "Mitigation strategies include updating to a patched version of the Netdata Agent and implementing CIS compliance and logging.", "Conclusion": "This vulnerability is a serious threat, and it is essential to take immediate action to mitigate it."}, "executive_analysis": {"Overview": "The Netdata Agent vulnerability is a serious threat that allows an attacker to run arbitrary programs with root permissions.", "Business Impact": "The business impact of this vulnerability is high, as it could lead to unauthorized access to sensitive information.", "Technical Impact": "The technical impact is also high, as the attacker can use this vulnerability to gain control of the system.", "Mitigation Strategies": "The mitigation strategies include updating to a patched version of the Netdata Agent, implementing CIS compliance and logging, and monitoring for suspicious activity.", "Recommendations": "Executives are recommended to take immediate action to mitigate this vulnerability, as it is a serious threat.", "Conclusions": "This vulnerability is a wake-up call for organizations to prioritize vulnerability management and patching."}}