{"id": "CVE-2024-38858", "sourceIdentifier": "security@checkmk.com", "published": "2024-09-02T12:15:19.370", "lastModified": "2024-09-04T14:39:10.203", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Improper neutralization of input in Checkmk before version 2.3.0p14 allows attackers to inject and run malicious scripts in the Robotmk logs view."}, {"lang": "es", "value": "La neutralizaci\u00f3n incorrecta de la entrada en Checkmk anterior a la versi\u00f3n 2.3.0p14 permite a los atacantes inyectar y ejecutar scripts maliciosos en la vista de registros de Robotmk."}], "metrics": {"cvssMetricV40": [{"source": "security@checkmk.com", "type": "Secondary", "cvssData": {"version": "4.0", "vectorString": "CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:P/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X", "attackVector": "NETWORK", "attackComplexity": "LOW", "attackRequirements": "PRESENT", "privilegesRequired": "NONE", "userInteraction": "PASSIVE", "vulnerableSystemConfidentiality": "NONE", "vulnerableSystemIntegrity": "NONE", "vulnerableSystemAvailability": "NONE", "subsequentSystemConfidentiality": "LOW", "subsequentSystemIntegrity": "LOW", "subsequentSystemAvailability": "NONE", "exploitMaturity": "NOT_DEFINED", "confidentialityRequirements": "NOT_DEFINED", "integrityRequirements": "NOT_DEFINED", "availabilityRequirements": "NOT_DEFINED", "modifiedAttackVector": "NOT_DEFINED", "modifiedAttackComplexity": "NOT_DEFINED", "modifiedAttackRequirements": "NOT_DEFINED", "modifiedPrivilegesRequired": "NOT_DEFINED", "modifiedUserInteraction": "NOT_DEFINED", "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED", "modifiedVulnerableSystemIntegrity": "NOT_DEFINED", "modifiedVulnerableSystemAvailability": "NOT_DEFINED", "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED", "modifiedSubsequentSystemIntegrity": "NOT_DEFINED", "modifiedSubsequentSystemAvailability": "NOT_DEFINED", "safety": "NOT_DEFINED", "automatable": "NOT_DEFINED", "recovery": "NOT_DEFINED", "valueDensity": "NOT_DEFINED", "vulnerabilityResponseEffort": "NOT_DEFINED", "providerUrgency": "NOT_DEFINED", "baseScore": 2.3, "baseSeverity": "LOW"}}], "cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security@checkmk.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.3.0", "matchCriteriaId": "784262E3-E643-4564-9FFE-BB8FEDB0A662"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:-:*:*:*:*:*:*", "matchCriteriaId": "83202950-840A-4CB7-AD96-CE62E84FABD8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:p1:*:*:*:*:*:*", "matchCriteriaId": "310A2FA2-633A-48FB-A5C2-9A9A922E72E2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:p10:*:*:*:*:*:*", "matchCriteriaId": "3C0F1DC8-D9DF-4A7A-80DC-618FAB091375"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:p11:*:*:*:*:*:*", "matchCriteriaId": "9B0A1E3E-1B5A-4346-95BC-DE6FF6EE14CA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:p12:*:*:*:*:*:*", "matchCriteriaId": "EB52B2A7-BDC1-4A4F-ABAF-69C1BA8E83C2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:p13:*:*:*:*:*:*", "matchCriteriaId": "9F89225F-6969-4D89-B889-9CB09972825B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:p2:*:*:*:*:*:*", "matchCriteriaId": "7D1993E3-C4F9-4D78-BD02-A0B22D93BF1F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:p3:*:*:*:*:*:*", "matchCriteriaId": "B28A0C9D-072A-413C-8587-CD57CB918190"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:p4:*:*:*:*:*:*", "matchCriteriaId": "DF22D0A7-82B1-4598-B8C5-BDFE523D07F2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:p5:*:*:*:*:*:*", "matchCriteriaId": "20035AFB-75B4-4164-9833-A2FCAE24B577"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:p6:*:*:*:*:*:*", "matchCriteriaId": "8BCBACEB-7130-455D-B4BE-243053C116DC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:p7:*:*:*:*:*:*", "matchCriteriaId": "156384E2-E04B-4153-A91F-3F307C9FEAE8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:p8:*:*:*:*:*:*", "matchCriteriaId": "EEC0ED95-F43B-46D7-9AA0-A0FB1C32EF1D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:checkmk:checkmk:2.3.0:p9:*:*:*:*:*:*", "matchCriteriaId": "91C194C1-5292-4E2A-BB71-9C5CD3CE6194"}]}]}], "references": [{"url": "https://checkmk.com/werk/17232", "source": "security@checkmk.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-38858 - CWE-79: Command Injection, Attackers may inject malicious commands through user-input to execute unauthorized actions."}, {"techniqueID": "T1027", "comment": "CVE-2024-38858 - CWE-79: Command Injection, Attackers may inject malicious commands through user-input to execute unauthorized actions."}, {"techniqueID": "T1210", "comment": "CVE-2024-38858 - CWE-79: Command Injection, Attackers may inject malicious commands through user-input to execute unauthorized actions."}], "stix_bundle": {"stix_header": {"attack_pattern": [{"idref": "attack_pattern:CVE-2024-38858", "name": "CVE-2024-38858 - CWE-79: Command Injection", "description": "Command injection vulnerability in Checkmk before version 2.3.0p14 allows attackers to inject and run malicious scripts in the Robotmk logs view."}]}, "intrusion_set": {"idref": "intrusion_set:AIS-2024-38858"}, "malware": {"idref": "malware:AIS-2024-38858"}, "attack_pattern_exploit": {"idref": "attack_pattern_exploit:AIS-2024-38858"}, "campaign": {"idref": "campaign:AIS-2024-38858"}, "vulnerability": {"idref": "vulnerability:CVE-2024-38858", "name": "CVE-2024-38858 - CWE-79: Command Injection", "description": "Command injection vulnerability in Checkmk before version 2.3.0p14 allows attackers to inject and run malicious scripts in the Robotmk logs view."}}, "technical_analysis": {"Introduction": "The CVE-2024-38858 vulnerability is a command injection vulnerability in Checkmk before version 2.3.0p14. It allows attackers to inject and run malicious scripts in the Robotmk logs view.", "Impact and Scope": "The vulnerability has a CVSS score of 2.3 and an attack vector of NETWORK. It has a low impact on confidentiality, integrity, and availability.", "Related MITRE ATT&CK Techniques": "T1190, T1027, T1210", "Technical Details": "The vulnerability occurs when Checkmk does not properly neutralize user-input data. This allows attackers to inject and run malicious commands through user-input to execute unauthorized actions.", "Detection": "Detecting this vulnerability requires monitoring for suspicious network traffic and system logs. The vulnerability can be detected by searching for commands that are outside of the normal usage patterns of the system.", "Mitigation": "The vulnerability can be mitigated by updating Checkmk to version 2.3.0p14 or later. Additionally, ensuring that user-input data is properly sanitized and validated can help prevent this type of vulnerability.", "Conclusion": "The CVE-2024-38858 vulnerability is a command injection vulnerability that allows attackers to inject and run malicious scripts in the Robotmk logs view. It can be detected by monitoring for suspicious network traffic and system logs, and mitigated by updating Checkmk to a patched version."}, "executive_analysis": {"Overview": "The CVE-2024-38858 vulnerability is a command injection vulnerability in Checkmk before version 2.3.0p14.", "Business Impact": "The vulnerability has a low impact on confidentiality, integrity, and availability.", "Technical Impact": "The vulnerability allows attackers to inject and run malicious scripts in the Robotmk logs view.", "Mitigation Strategies": "Update Checkmk to version 2.3.0p14 or later, and ensure that user-input data is properly sanitized and validated.", "Recommendations": "Monitor for suspicious network traffic and system logs, and implement a patch management strategy to ensure timely updates.", "Conclusions": "The CVE-2024-38858 vulnerability is a low-severity vulnerability that can be mitigated by updating Checkmk and ensuring proper user-input data handling."}}