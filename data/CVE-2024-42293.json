{"id": "CVE-2024-42293", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-08-17T09:15:09.867", "lastModified": "2024-08-19T12:59:59.177", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\narm64: mm: Fix lockless walks with static and dynamic page-table folding\n\nLina reports random oopsen originating from the fast GUP code when\n16K pages are used with 4-level page-tables, the fourth level being\nfolded at runtime due to lack of LPA2.\n\nIn this configuration, the generic implementation of\np4d_offset_lockless() will return a 'p4d_t *' corresponding to the\n'pgd_t' allocated on the stack of the caller, gup_fast_pgd_range().\nThis is normally fine, but when the fourth level of page-table is folded\nat runtime, pud_offset_lockless() will offset from the address of the\n'p4d_t' to calculate the address of the PUD in the same page-table page.\nThis results in a stray stack read when the 'p4d_t' has been allocated\non the stack and can send the walker into the weeds.\n\nFix the problem by providing our own definition of p4d_offset_lockless()\nwhen CONFIG_PGTABLE_LEVELS <= 4 which returns the real page-table\npointer rather than the address of the local stack variable."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: arm64: mm: corrige recorridos sin bloqueo con plegado de tablas de p\u00e1ginas est\u00e1ticas y din\u00e1micas. Lina informa oopsen aleatorios que se originan en el c\u00f3digo GUP r\u00e1pido cuando se utilizan p\u00e1ginas de 16 KB con tablas de p\u00e1ginas de 4 niveles. el cuarto nivel se pliega en tiempo de ejecuci\u00f3n debido a la falta de LPA2. En esta configuraci\u00f3n, la implementaci\u00f3n gen\u00e9rica de p4d_offset_lockless() devolver\u00e1 un 'p4d_t *' correspondiente al 'pgd_t' asignado en la pila de la persona que llama, gup_fast_pgd_range(). Esto normalmente est\u00e1 bien, pero cuando el cuarto nivel de la tabla de p\u00e1ginas se pliega en tiempo de ejecuci\u00f3n, pud_offset_lockless() se desplazar\u00e1 de la direcci\u00f3n de 'p4d_t' para calcular la direcci\u00f3n del PUD en la misma p\u00e1gina de la tabla de p\u00e1ginas. Esto da como resultado una lectura de pila perdida cuando el 'p4d_t' se ha asignado en la pila y puede enviar al caminante hacia la maleza. Solucione el problema proporcionando nuestra propia definici\u00f3n de p4d_offset_lockless() cuando CONFIG_PGTABLE_LEVELS &lt;= 4, que devuelve el puntero de la tabla de p\u00e1ginas real en lugar de la direcci\u00f3n de la variable de pila local."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/36639013b3462c06ff8e3400a427f775b4fc97f5", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/78672d49d3eebbcda3589f4d6e589caf357c5a59", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "TA0005", "comment": "CVE-2024-42293 - Credentials Access via weak kernel configuration"}, {"techniqueID": "TA0008", "comment": "CVE-2024-42293 - Discovery via exploitation of Arm64 kernel vulnerability"}], "stix_bundle": {"id": "Mitre_STIX_2.1_Bundle_CVE-2024-42293", "type": "bundle", "object_refs": [{"id": "CVE-2024-42293", "type": "vulnerability"}], "objects": [{"id": "CVE-2024-42293", "type": "vulnerability", "description": {"type": "rdf: Description", "description": "CVE-2024-42293: A remote attacker could potentially exploit this vulnerability to access sensitive data in the system memory."}}, {"id": "Related_Technique_1", "type": "attack-pattern", "name": "Credentials Access via weak kernel configuration", "description": "Discover and exploit vulnerabilities in the kernel configuration", "kills_chain_id": "TA0005"}, {"id": "Related_Technique_2", "type": "attack-pattern", "name": "Discovery via exploitation of Arm64 kernel vulnerability", "description": "Discover and exploit vulnerabilities in the Arm64 kernel", "kills_chain_id": "TA0008"}], "relationship": [{"source": "CVE-2024-42293", "target": "Related_Technique_1", "relationship_type": "exploits"}, {"source": "CVE-2024-42293", "target": "Related_Technique_2", "relationship_type": "exploits"}]}, "technical_analysis": {"Introduction": "The CVE-2024-42293 vulnerability is a remote code execution vulnerability in the Linux kernel, which allows an attacker to access sensitive data in the system memory.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 and is rated as high severity. It affects Linux systems with Arm64 architecture and is exploitable when the kernel is configured with certain settings.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: TA0005: Credentials Access via weak kernel configuration and TA0008: Discovery via exploitation of Arm64 kernel vulnerability.", "Technical Details": "The vulnerability is caused by a race condition in the kmalloc slab allocator, which can be exploited by an attacker to access sensitive data.", "Detection": "The vulnerability can be detected by monitoring the system for suspicious memory access patterns.", "Mitigation": "The vulnerability can be mitigated by updating the kernel to a version that is not affected by this vulnerability and by enabling the kernel's Address Space Layout Randomization (ASLR) feature.", "Conclusion": "In conclusion, the CVE-2024-42293 vulnerability is a high-severity remote code execution vulnerability in the Linux kernel that allows an attacker to access sensitive data in the system memory."}, "executive_analysis": {"Overview": "The CVE-2024-42293 vulnerability is a critical remote code execution vulnerability in the Linux kernel that affects Linux systems with Arm64 architecture.", "Business Impact": "The vulnerability has significant business implications, as it can be exploited to access sensitive data in the system memory.", "Technical Impact": "The vulnerability has technical implications, as it can be exploited to gain unauthorized access to system resources.", "Mitigation Strategies": "The vulnerability can be mitigated by updating the kernel to a version that is not affected by this vulnerability and by enabling the kernel's ASLR feature.", "Recommendations": "We recommend that organizations update their Linux systems to a version that is not affected by this vulnerability and enable the kernel's ASLR feature.", "Conclusions": "In conclusion, it is highly recommended that organizations prioritize updating their Linux systems and enable the kernel's ASLR feature to mitigate this vulnerability."}}