{"id": "CVE-2024-3924", "sourceIdentifier": "security@huntr.dev", "published": "2024-05-30T15:15:49.653", "lastModified": "2024-05-30T18:19:11.743", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A code injection vulnerability exists in the huggingface/text-generation-inference repository, specifically within the `autodocs.yml` workflow file. The vulnerability arises from the insecure handling of the `github.head_ref` user input, which is used to dynamically construct a command for installing a software package. An attacker can exploit this by forking the repository, creating a branch with a malicious payload as the name, and then opening a pull request to the base repository. Successful exploitation could lead to arbitrary code execution within the context of the GitHub Actions runner. This issue affects versions up to and including v2.0.0 and was fixed in version 2.0.0."}, {"lang": "es", "value": "Existe una vulnerabilidad de inyecci\u00f3n de c\u00f3digo en el repositorio huggingface/text-generation-inference, espec\u00edficamente dentro del archivo de flujo de trabajo `autodocs.yml`. La vulnerabilidad surge del manejo inseguro de la entrada del usuario `github.head_ref`, que se utiliza para construir din\u00e1micamente un comando para instalar un paquete de software. Un atacante puede aprovechar esto bifurcando el repositorio, creando una rama con una carga \u00fatil maliciosa como nombre y luego abriendo una solicitud de extracci\u00f3n al repositorio base. La explotaci\u00f3n exitosa podr\u00eda conducir a la ejecuci\u00f3n de c\u00f3digo arbitrario dentro del contexto del ejecutor de GitHub Actions. Este problema afecta a las versiones hasta la v2.0.0 incluida y se solucion\u00f3 en la versi\u00f3n 2.0.0."}], "metrics": {"cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.3, "impactScore": 2.7}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "references": [{"url": "https://github.com/huggingface/text-generation-inference/commit/88702d876383f7200eccf67e28ba00500dc804bb", "source": "security@huntr.dev"}, {"url": "https://huntr.com/bounties/8af92fc2-0103-4d29-bb28-c3893154c422", "source": "security@huntr.dev"}], "techniques": [{"techniqueID": "T1086", "comment": "CVE-2024-3924 - Code injection vulnerability allows attackers to execute arbitrary code within the context of the GitHub Actions runner, exploiting the insecure handling of the `github.head_ref` user input."}, {"techniqueID": "T1036", "comment": "CVE-2024-3924 - The vulnerability can be exploited by creating a malicious branch with a payload as the name and opening a pull request to the base repository, allowing attackers to execute arbitrary code within the context of the GitHub Actions runner."}, {"techniqueID": "T1204", "comment": "CVE-2024-3924 - The vulnerability affects versions up to and including v2.0.0 of the huggingface/text-generation-inference repository and was fixed in version 2.0.0, making it important to update to the latest version to patch the vulnerability."}, {"techniqueID": "T1568", "comment": "CVE-2024-3924 - The vulnerability can be exploited by an attacker with a low privilege level, making it a low-privileged attack vector, and can be utilized as part of a larger attack campaign to gain higher privileges."}], "technical_analysis": {"Introduction": "A code injection vulnerability exists in the huggingface/text-generation-inference repository, potentially allowing attackers to execute arbitrary code within the context of the GitHub Actions runner.", "Impact and Scope": "The vulnerability affects versions up to and including v2.0.0 of the huggingface/text-generation-inference repository, with a CVSS score of 4.4 (Medium) and an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "T1086, T1036, T1204, T1568", "Technical Details": "The vulnerability arises from the insecure handling of the `github.head_ref` user input, which is used to dynamically construct a command for installing a software package.", "Detection": "The vulnerability can be detected by reviewing the code injection vulnerability in the `autodocs.yml` workflow file and ensuring that the `github.head_ref` user input is properly sanitized.", "Mitigation": "The vulnerability can be mitigated by updating to the latest version of the huggingface/text-generation-inference repository, v2.0.1, which includes the patch for the vulnerability.", "Conclusion": "The vulnerability presents a significant risk to the integrity and confidentiality of the affected systems and data, and prompt action should be taken to patch and remediate the issue."}, "executive_analysis": {"Overview": "A code injection vulnerability exists in the huggingface/text-generation-inference repository, potentially allowing attackers to execute arbitrary code within the context of the GitHub Actions runner.", "Business Impact": "The vulnerability could potentially enable unauthorized code execution, leading to data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability affects the security and integrity of the affected systems and data, potentially compromising sensitive information and business operations.", "Mitigation Strategies": "Update to the latest version of the huggingface/text-generation-inference repository, v2.0.1, and ensure proper sanitization of user input to prevent code injection attacks.", "Recommendations": "Executive leadership should prioritize patching and remediating the issue, and consider implementing additional security measures to prevent and detect similar attacks in the future.", "Conclusions": "The vulnerability presents a significant risk to the business and should be treated with urgency to minimize the potential impact."}}