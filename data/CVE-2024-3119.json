{"id": "CVE-2024-3119", "sourceIdentifier": "41c37e40-543d-43a2-b660-2fee83ea851a", "published": "2024-04-10T00:15:12.107", "lastModified": "2024-04-10T13:23:38.787", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "A buffer overflow vulnerability exists in all versions of sngrep since v0.4.2, due to improper handling of 'Call-ID' and 'X-Call-ID' SIP headers. The functions sip_get_callid and sip_get_xcallid in sip.c use the strncpy function to copy header contents into fixed-size buffers without checking the data length. This flaw allows remote attackers to execute arbitrary code or cause a denial of service (DoS) through specially crafted SIP messages.\n"}, {"lang": "es", "value": "Existe una vulnerabilidad de desbordamiento del b\u00fafer en todas las versiones de sngrep desde la v0.4.2, debido al manejo inadecuado de los encabezados SIP 'Call-ID' y 'X-Call-ID'. Las funciones sip_get_callid y sip_get_xcallid en sip.c usan la funci\u00f3n strncpy para copiar el contenido del encabezado en buffers de tama\u00f1o fijo sin verificar la longitud de los datos. Esta falla permite a atacantes remotos ejecutar c\u00f3digo arbitrario o provocar una denegaci\u00f3n de servicio (DoS) a trav\u00e9s de mensajes SIP especialmente manipulados."}], "metrics": {"cvssMetricV31": [{"source": "41c37e40-543d-43a2-b660-2fee83ea851a", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.2, "impactScore": 6.0}]}, "weaknesses": [{"source": "41c37e40-543d-43a2-b660-2fee83ea851a", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-120"}]}], "references": [{"url": "https://github.com/irontec/sngrep/pull/480/commits/73c15c82d14c69df311e05fa75da734faafd365f", "source": "41c37e40-543d-43a2-b660-2fee83ea851a"}, {"url": "https://github.com/irontec/sngrep/releases/tag/v1.8.1", "source": "41c37e40-543d-43a2-b660-2fee83ea851a"}, {"url": "https://pentraze.com/vulnerability-reports/", "source": "41c37e40-543d-43a2-b660-2fee83ea851a"}], "techniques": [{"techniqueID": "TA1002", "comment": "CVE-2024-3119 - Remote attackers can potentially execute arbitrary code or cause a denial of service (DoS) through specially crafted SIP messages. This technique is related to Lateral Movement and Initial Access."}, {"techniqueID": "TA0005", "comment": "CVE-2024-3119 - The vulnerability allows remote attackers to execute arbitrary code or cause a denial of service (DoS) which is a characteristic of Defence Evaluation and Action on Mobile Electronic Devices (Demoed) attacks. This technique is related to Execution and Defence Evaluation."}, {"techniqueID": "TA0040", "comment": "CVE-2024-3119 - The vulnerability is a buffer overflow which can be exploited to execute arbitrary code, a characteristic of many demonstration and proof-of-concept exploits. This technique is related to Spoofing and Data Tampering."}], "stix_bundle": {"type": "binder", "id": "cve-2024-3119-stix-2.1", "created_by_ref": "https://cve.mitre.org/schema/cve/2.2", "modified": "2024-04-10T13:23:38.787", "name": "CVE-2024-3119 STIX 2.1 Bundle", "description": "A STIX 2.1 bundle expressing all the related techniques, risks and defense strategies for this CVE.", "objects": [{"type": "vulnerability", "id": "CVE-2024-3119", "modified": "2024-04-10T13:23:38.787", "created_by_ref": "https://cve.mitre.org/schema/cve/2.2", "name": "CVE-2024-3119", "description": "A buffer overflow vulnerability exists in all versions of sngrep since v0.4.2, due to improper handling of 'Call-ID' and 'X-Call-ID' SIP headers.", "cve": {"id": "CVE-2024-3119", "source_identifier": "41c37e40-543d-43a2-b660-2fee83ea851a"}, "references": [{"type": "external_reference", "id": "41c37e40-543d-43a2-b660-2fee83ea851a", "url": "https://github.com/irontec/sngrep/pull/480/commits/73c15c82d14c69df311e05fa75da734faafd365f"}]}, {"type": "indicator", "id": "indicator-1", "name": "SIP Message Poisoning", "description": "Specially crafted SIP messages can be used to exploit the buffer overflow vulnerability", "pattern": ["sip-header"]}, {"type": "tactic", "id": "tactic-1", "name": "Lateral Movement", "description": "The vulnerability can be used to execute arbitrary code or cause a denial of service (DoS)"}, {"type": "procedure", "id": "procedure-1", "name": " Defence Against SIP Message Poisoning", "description": "Use of packet inspection and filtering to detect and prevent specially crafted SIP messages", "course_of_action": [{"type": "related_tactic_id", "id_refs": {"tactic-1": "1"}}]}]}, "technical_analysis": {"Introduction": "A vulnerability in sngrep allows remote attackers to execute arbitrary code or cause a denial of service (DoS) through specially crafted SIP messages.", "Impact and Scope": "The vulnerability affects all versions of sngrep since v0.4.2, with a CVSS score of 9.0 and an attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "TA1002, TA0005, TA0040", "Technical Details": "The vulnerability is a buffer overflow caused by improper handling of 'Call-ID' and 'X-Call-ID' SIP headers.", "Detection": "Detection can be done through packet inspection and filtering", "Mitigation": "Mitigation can be achieved through the use of packet inspection and filtering", "Conclusion": "The vulnerability is a serious threat that can be exploited to execute arbitrary code or cause a denial of service (DoS)"}, "executive_analysis": {"Overview": "A vulnerability in sngrep allows remote attackers to execute arbitrary code or cause a denial of service (DoS) through specially crafted SIP messages.", "Business Impact": "The vulnerability has serious business implications, including potential data breaches and system compromise.", "Technical Impact": "The vulnerability can be exploited to execute arbitrary code or cause a denial of service (DoS)", "Mitigation Strategies": "Implement packet inspection and filtering to detect and prevent specially crafted SIP messages", "Recommendations": "Apply patches and updates to sngrep, and implement packet inspection and filtering", "Conclusions": "The vulnerability is a serious threat that requires immediate attention and mitigation"}}