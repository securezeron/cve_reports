{"id": "CVE-2020-17522", "sourceIdentifier": "security@apache.org", "published": "2021-01-26T18:15:40.787", "lastModified": "2023-11-07T03:19:12.947", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "When ORT (now via atstccfg) generates ip_allow.config files in Apache Traffic Control 3.0.0 to 3.1.0 and 4.0.0 to 4.1.0, those files include permissions that allow bad actors to push arbitrary content into and remove arbitrary content from CDN cache servers. Additionally, these permissions are potentially extended to IP addresses outside the desired range, resulting in them being granted to clients possibly outside the CDN arcitechture."}, {"lang": "es", "value": "Cuando ORT (ahora mediante atstccfg) genera archivos ip_allow.config en Apache Traffic Control versiones 3.0.0 hasta 3.1.0 y 4.0.0 hasta 4.1.0, esos archivos incluyen permisos que permiten a los actores malos introducir contenido arbitrario y eliminar contenido arbitrario desde servidores de cach\u00e9 CDN.&#xa0;Adem\u00e1s, estos permisos son extendidos potencialmente para direcciones IP fuera del rango deseado, resultando en que sean otorgados a clientes posiblemente fuera de la arquitectura CDN"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-732"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:traffic_control:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.0.0", "versionEndIncluding": "3.1.0", "matchCriteriaId": "F0BE820F-BA51-432C-AE24-91E5912D7BEF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apache:traffic_control:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndIncluding": "4.1.0", "matchCriteriaId": "0450F450-F8E6-42F3-B596-3769439E3CC5"}]}]}], "references": [{"url": "https://lists.apache.org/thread.html/r3c675031ac220b5eae64a9c84a03ee60045c6045738607dca4a96cb8%40%3Ccommits.trafficcontrol.apache.org%3E", "source": "security@apache.org"}, {"url": "https://lists.apache.org/thread.html/r3de212a3da73bcf98fa2db7eafb75b2eb8e131ff466e6efc4284df09%40%3Cdev.trafficcontrol.apache.org%3E", "source": "security@apache.org", "tags": ["Mailing List", "Vendor Advisory"]}, {"url": "https://lists.apache.org/thread.html/rc8bfd7d4f71d61e9193efcd4699eccbab3c202ec1d75ed9d502f08bf%40%3Ccommits.trafficcontrol.apache.org%3E", "source": "security@apache.org"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2020-17522 - Allow bad actors to push arbitrary content into and remove arbitrary content from CDN cache servers. This is a vulnerability in Apache Traffic Control, which allows attackers to manipulate traffic control configuration files."}, {"techniqueID": "T1190", "comment": "CVE-2020-17522 - The vulnerability also allows potentially extended permissions to IP addresses outside the desired range, resulting in them being granted to clients possibly outside the CDN architecture."}, {"techniqueID": "T1078", "comment": "CVE-2020-17522 - Attackers can use this vulnerability to manipulate HTTP requests and responses, allowing them to inject arbitrary content into and remove arbitrary content from CDN cache servers."}, {"techniqueID": "T1098", "comment": "CVE-2020-17522 - This vulnerability can be used as a stepping stone for further attacks, such as data exfiltration or lateral movement."}, {"techniqueID": "T1040", "comment": "CVE-2020-17522 - Attackers can use this vulnerability to attempt to read, write, and execute arbitrary files on the CDN cache server."}, {"techniqueID": "T1568", "comment": "CVE-2020-17522 - This vulnerability can be used to establish a foothold on the CDN cache server and then pivot to other systems or networks."}], "technical_analysis": {"Introduction": "Apache Traffic Control is a popular open-source traffic control solution used by many organizations to control and monitor their network traffic. However, a recently discovered vulnerability in Apache Traffic Control (CVE-2020-17522) allows attackers to manipulate traffic control configuration files, which can result in arbitrary content being injected or removed from CDN cache servers.", "Impact and Scope": "The vulnerability affects Apache Traffic Control versions 3.0.0 to 3.1.0 and 4.0.0 to 4.1.0. The CVSS score is 5.8 (Medium) with a attack vector of NETWORK.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1210, T1190, T1078, T1098, T1040, and T1568.", "Technical Details": "The vulnerability occurs when ORT (now via atstccfg) generates ip_allow.config files that include permissions that allow bad actors to push arbitrary content into and remove arbitrary content from CDN cache servers.", "Detection": "To detect this vulnerability, security professionals can look for unauthorized changes to traffic control configuration files or suspicious network traffic patterns.", "Mitigation": "The recommended mitigation is to upgrade to a patched version of Apache Traffic Control or disable the vulnerable feature.", "Conclusion": "In conclusion, the CVE-2020-17522 vulnerability in Apache Traffic Control is a significant risk to organizations that use this software. It is essential to apply the recommended mitigation measures to prevent attackers from exploiting this vulnerability."}, "executive_analysis": {"Overview": "A recently discovered vulnerability in Apache Traffic Control (CVE-2020-17522) allows attackers to manipulate traffic control configuration files, which can result in arbitrary content being injected or removed from CDN cache servers.", "Business Impact": "The business impact of this vulnerability is significant, as it can result in the unauthorized manipulation of network traffic and data exfiltration.", "Technical Impact": "The technical impact of this vulnerability is the potential for attackers to inject or remove arbitrary content from CDN cache servers, which can result in unauthorized access to sensitive data.", "Mitigation Strategies": "The recommended mitigation strategies are to upgrade to a patched version of Apache Traffic Control or disable the vulnerable feature.", "Recommendations": "Executive stakeholders should recommend that network administrators upgrade to a patched version of Apache Traffic Control or disable the vulnerable feature.", "Conclusions": "In conclusion, the CVE-2020-17522 vulnerability in Apache Traffic Control is a significant risk to organizations that use this software. It is essential to apply the recommended mitigation measures to prevent attackers from exploiting this vulnerability."}}