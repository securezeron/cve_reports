{"id": "CVE-2024-45313", "sourceIdentifier": "security-advisories@github.com", "published": "2024-09-02T18:15:37.850", "lastModified": "2024-09-03T12:59:02.453", "vulnStatus": "Undergoing Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "Overleaf is a web-based collaborative LaTeX editor. When installing Server Pro using the Overleaf Toolkit from before 2024-07-17 or legacy docker-compose.yml from before 2024-08-28, the configuration for LaTeX compiles was insecure by default, requiring the administrator to enable the security features via a configuration setting (`SIBLING_CONTAINERS_ENABLED` in Toolkit, `SANDBOXED_COMPILES` in legacy docker-compose/custom deployments). If these security features are not enabled then users have access to the `sharelatex` container resources (filesystem, network, environment variables) when running compiles, leading to multiple file access vulnerabilities, either directly or via symlinks created during compiles. The setting has now been changed to be secure by default for new installs in the Toolkit and legacy docker-compose deployment. The Overleaf Toolkit has been updated to set `SIBLING_CONTAINERS_ENABLED=true` by default for new installs. It is recommended that any existing installations using the previous default setting migrate to using sibling containers. Existing installations can set `SIBLING_CONTAINERS_ENABLED=true` in `config/overleaf.rc` as a mitigation. In legacy docker-compose/custom deployments `SANDBOXED_COMPILES=true` should be used."}, {"lang": "es", "value": "Overleaf es un editor colaborativo de LaTeX basado en la web. Al instalar Server Pro utilizando el kit de herramientas de Overleaf anterior al 17 de julio de 2024 o el archivo docker-compose.yml anterior al 28 de agosto de 2024, la configuraci\u00f3n para las compilaciones de LaTeX era insegura de forma predeterminada, lo que requer\u00eda que el administrador habilitara las funciones de seguridad a trav\u00e9s de una opci\u00f3n de configuraci\u00f3n (`SIBLING_CONTAINERS_ENABLED` en el kit de herramientas, `SANDBOXED_COMPILES` en las implementaciones tradicionales de docker-compose/custom). Si estas funciones de seguridad no est\u00e1n habilitadas, los usuarios tienen acceso a los recursos del contenedor `sharelatex` (sistema de archivos, red, variables de entorno) al ejecutar compilaciones, lo que genera m\u00faltiples vulnerabilidades de acceso a archivos, ya sea directamente o a trav\u00e9s de enlaces simb\u00f3licos creados durante las compilaciones. La configuraci\u00f3n ahora se ha cambiado para que sea segura de forma predeterminada para las nuevas instalaciones en el kit de herramientas y la implementaci\u00f3n tradicional de docker-compose. Se actualiz\u00f3 el kit de herramientas de Overleaf para configurar `SIBLING_CONTAINERS_ENABLED=true` de manera predeterminada para las nuevas instalaciones. Se recomienda que todas las instalaciones existentes que utilicen la configuraci\u00f3n predeterminada anterior migren al uso de contenedores hermanos. Las instalaciones existentes pueden configurar `SIBLING_CONTAINERS_ENABLED=true` en `config/overleaf.rc` como mitigaci\u00f3n. En las implementaciones docker-compose/custom heredadas, se debe utilizar `SANDBOXED_COMPILES=true`."}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1188"}, {"lang": "en", "value": "CWE-284"}]}], "references": [{"url": "https://github.com/overleaf/overleaf/security/advisories/GHSA-m95q-g8qg-wgj4", "source": "security-advisories@github.com"}, {"url": "https://github.com/overleaf/overleaf/wiki/Server-Pro:-Sandboxed-Compiles", "source": "security-advisories@github.com"}, {"url": "https://github.com/overleaf/toolkit/blob/master/doc/sandboxed-compiles.md#enabling-sibling-containers", "source": "security-advisories@github.com"}, {"url": "https://github.com/overleaf/toolkit/commit/7a8401897b24777b47338452ff8d12e2fb6dd5ff", "source": "security-advisories@github.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2024-45313 - The vulnerability allows for code execution and file access, making it a potential entry point for attackers. To defend against this, it is recommended to enable `SIBLING_CONTAINERS_ENABLED` and `SANDBOXED_COMPILES` settings in Overleaf Toolkit."}, {"techniqueID": "T1218", "comment": "CVE-2024-45313 - The vulnerability allows for file access and modification, which can be used to execute malicious code. To defend against this, it is recommended to monitor file access and implement access controls."}, {"techniqueID": "T1222", "comment": "CVE-2024-45313 - The vulnerability allows for code execution, which can be used to execute malicious code. To defend against this, it is recommended to implement memory protections and monitor for suspicious code execution."}, {"techniqueID": "T1537", "comment": "CVE-2024-45313 - The vulnerability allows for file access and modification, which can be used to execute malicious code. To defend against this, it is recommended to monitor file access and implement access controls."}, {"techniqueID": "T1564", "comment": "CVE-2024-45313 - The vulnerability allows for code execution and file access, making it a potential entry point for attackers. To defend against this, it is recommended to enable `SIBLING_CONTAINERS_ENABLED` and `SANDBOXED_COMPILES` settings in Overleaf Toolkit."}], "stix_bundle": {"version": "2.1", "objects": [{"type": "Vulnerability", "id": "CVE-2024-45313", "name": "Overleaf Toolkit - Unauthenticated File Access", "description": "Overleaf is a web-based collaborative LaTeX editor. When installing Server Pro using the Overleaf Toolkit from before 2024-07-17 or legacy docker-compose.yml from before 2024-08-28, the configuration for LaTeX compiles was insecure by default, requiring the administrator to enable the security features via a configuration setting (`SIBLING_CONTAINERS_ENABLED` in Toolkit, `SANDBOXED_COMPILES` in legacy docker-compose/custom deployments).", "mitigations": [{"type": "TTP", "techniqueID": "T1190", "title": "Enable `SIBLING_CONTAINERS_ENABLED` and `SANDBOXED_COMPILES` settings in Overleaf Toolkit", "description": "Enabling `SIBLING_CONTAINERS_ENABLED` and `SANDBOXED_COMPILES` settings in Overleaf Toolkit can help prevent the vulnerability from being exploited."}, {"type": "TTP", "techniqueID": "T1218", "title": "Monitor file access and implement access controls", "description": "Monitoring file access and implementing access controls can help prevent the vulnerability from being exploited."}, {"type": "TTP", "techniqueID": "T1222", "title": "Implement memory protections and monitor for suspicious code execution", "description": "Implementing memory protections and monitoring for suspicious code execution can help prevent the vulnerability from being exploited."}, {"type": "TTP", "techniqueID": "T1537", "title": "Monitor file access and implement access controls", "description": "Monitoring file access and implementing access controls can help prevent the vulnerability from being exploited."}, {"type": "TTP", "techniqueID": "T1564", "title": "Enable `SIBLING_CONTAINERS_ENABLED` and `SANDBOXED_COMPILES` settings in Overleaf Toolkit", "description": "Enabling `SIBLING_CONTAINERS_ENABLED` and `SANDBOXED_COMPILES` settings in Overleaf Toolkit can help prevent the vulnerability from being exploited."}], "relations": [{"type": "related_to", "target_id": "CVE-2024-45313", "object_type": "Vulnerability"}]}]}, "technical_analysis": {"Introduction": "The vulnerability in Overleaf Toolkit allows for unauthenticated file access and code execution, making it a potential entry point for attackers.", "Impact and Scope": "The vulnerability has a CVSS score of 5.4 (MEDIUM) and allows for code execution and file access, making it a potentially serious threat.", "Related MITRE ATT&CK Techniques": "T1190, T1218, T1222, T1537, T1564", "Technical Details": "The vulnerability is caused by the insecure default configuration of the Overleaf Toolkit, which allows for unauthenticated file access and code execution.", "Detection": "The vulnerability can be detected by monitoring for suspicious file access and code execution.", "Mitigation": "The vulnerability can be mitigated by enabling `SIBLING_CONTAINERS_ENABLED` and `SANDBOXED_COMPILES` settings in Overleaf Toolkit and monitoring for suspicious file access and code execution.", "Conclusion": "The vulnerability in Overleaf Toolkit is a potentially serious threat that can be mitigated by enabling `SIBLING_CONTAINERS_ENABLED` and `SANDBOXED_COMPILES` settings in Overleaf Toolkit and monitoring for suspicious file access and code execution."}, "executive_analysis": {"Overview": "The vulnerability in Overleaf Toolkit is a potential entry point for attackers and can lead to code execution and file access.", "Business Impact": "The vulnerability can lead to financial loss and reputational damage if exploited.", "Technical Impact": "The vulnerability can lead to code execution and file access, making it a potentially serious threat.", "Mitigation Strategies": "Enabling `SIBLING_CONTAINERS_ENABLED` and `SANDBOXED_COMPILES` settings in Overleaf Toolkit and monitoring for suspicious file access and code execution.", "Recommendations": "We recommend that all Overleaf Toolkit installations be updated to the latest version and that `SIBLING_CONTAINERS_ENABLED` and `SANDBOXED_COMPILES` settings be enabled.", "Conclusions": "The vulnerability in Overleaf Toolkit is a potential entry point for attackers and can be mitigated by enabling `SIBLING_CONTAINERS_ENABLED` and `SANDBOXED_COMPILES` settings in Overleaf Toolkit and monitoring for suspicious file access and code execution."}}