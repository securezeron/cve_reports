{"id": "CVE-2024-26783", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-04T09:15:08.077", "lastModified": "2024-04-04T12:48:41.700", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/vmscan: fix a bug calling wakeup_kswapd() with a wrong zone index\n\nWith numa balancing on, when a numa system is running where a numa node\ndoesn't have its local memory so it has no managed zones, the following\noops has been observed.  It's because wakeup_kswapd() is called with a\nwrong zone index, -1.  Fixed it by checking the index before calling\nwakeup_kswapd().\n\n> BUG: unable to handle page fault for address: 00000000000033f3\n> #PF: supervisor read access in kernel mode\n> #PF: error_code(0x0000) - not-present page\n> PGD 0 P4D 0\n> Oops: 0000 [#1] PREEMPT SMP NOPTI\n> CPU: 2 PID: 895 Comm: masim Not tainted 6.6.0-dirty #255\n> Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\n>    rel-1.16.0-0-gd239552ce722-prebuilt.qemu.org 04/01/2014\n> RIP: 0010:wakeup_kswapd (./linux/mm/vmscan.c:7812)\n> Code: (omitted)\n> RSP: 0000:ffffc90004257d58 EFLAGS: 00010286\n> RAX: ffffffffffffffff RBX: ffff88883fff0480 RCX: 0000000000000003\n> RDX: 0000000000000000 RSI: 0000000000000000 RDI: ffff88883fff0480\n> RBP: ffffffffffffffff R08: ff0003ffffffffff R09: ffffffffffffffff\n> R10: ffff888106c95540 R11: 0000000055555554 R12: 0000000000000003\n> R13: 0000000000000000 R14: 0000000000000000 R15: ffff88883fff0940\n> FS:  00007fc4b8124740(0000) GS:ffff888827c00000(0000) knlGS:0000000000000000\n> CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n> CR2: 00000000000033f3 CR3: 000000026cc08004 CR4: 0000000000770ee0\n> DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\n> DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\n> PKRU: 55555554\n> Call Trace:\n>  <TASK>\n> ? __die\n> ? page_fault_oops\n> ? __pte_offset_map_lock\n> ? exc_page_fault\n> ? asm_exc_page_fault\n> ? wakeup_kswapd\n> migrate_misplaced_page\n> __handle_mm_fault\n> handle_mm_fault\n> do_user_addr_fault\n> exc_page_fault\n> asm_exc_page_fault\n> RIP: 0033:0x55b897ba0808\n> Code: (omitted)\n> RSP: 002b:00007ffeefa821a0 EFLAGS: 00010287\n> RAX: 000055b89983acd0 RBX: 00007ffeefa823f8 RCX: 000055b89983acd0\n> RDX: 00007fc2f8122010 RSI: 0000000000020000 RDI: 000055b89983acd0\n> RBP: 00007ffeefa821a0 R08: 0000000000000037 R09: 0000000000000075\n> R10: 0000000000000000 R11: 0000000000000202 R12: 0000000000000000\n> R13: 00007ffeefa82410 R14: 000055b897ba5dd8 R15: 00007fc4b8340000\n>  </TASK>"}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: mm/vmscan: corrige un error al llamar a wakeup_kswapd() con un \u00edndice de zona incorrecto Con el equilibrio numa activado, cuando se ejecuta un SYSTEM numa donde un nodo numa no tiene su memoria local por lo que no tiene zonas administradas, se ha observado lo siguiente. Es porque se llama a wakeup_kswapd() con un \u00edndice de zona incorrecto, -1. Se solucion\u00f3 verificando el \u00edndice antes de llamar a wakeup_kswapd(). &gt; ERROR: no se puede manejar el error de p\u00e1gina para la direcci\u00f3n: 00000000000033f3 &gt; #PF: acceso de lectura del supervisor en modo kernel &gt; #PF: error_code(0x0000) - p\u00e1gina no presente &gt; PGD 0 P4D 0 &gt; Ups: 0000 [#1] SMP PREEMPT NOPTI &gt; CPU: 2 PID: 895 Comm: masim Not tainted 6.6.0-dirty #255 &gt; Nombre del hardware: PC est\u00e1ndar QEMU (i440FX + PIIX, 1996), BIOS &gt; rel-1.16.0-0-gd239552ce722-prebuilt.qemu .org 01/04/2014 &gt; RIP: 0010:wakeup_kswapd (./linux/mm/vmscan.c:7812) &gt; C\u00f3digo: (omitido) &gt; RSP: 0000:ffffc90004257d58 EFLAGS: 00010286 &gt; RAX: ffffffffffffffff RBX: ffff88883f ff0480RCX: 0000000000000003 &gt; RDX: 0000000000000000 RSI: 0000000000000000 RDI: ffff88883fff0480 &gt; RBP: ffffffffffffffff R08: ff0003ffffffffff R09: ffffffffffffffff &gt; R10: ff ff888106c95540 R11: 0000000055555554 R12: 0000000000000003 &gt; R13: 0000000000000000 R14: 00000000000000000 R15: ffff88883fff0940 &gt; FS: 0000 7fc4b8124740(0000) GS: ffff888827c00000(0000) knlGS:0000000000000000 &gt; CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033 &gt; CR2: 00000000000033f3 CR3: 000000026cc08004 CR4: 0000000000770ee0 &gt; DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 &gt; DR3: 00000000000000000 DR6: 00000000ffe0ff0 DR7: 000 0000000000400 &gt; PKRU: 55555554 &gt; Rastreo de llamadas: &gt;  &gt; ? __morir &gt; ? page_fault_oops &gt; ? __pte_offset_map_lock &gt; ? exc_page_fault &gt; ? asm_exc_page_fault &gt; ? wakeup_kswapd &gt; migrar_misplaced_page &gt; __handle_mm_fault &gt; handle_mm_fault &gt; do_user_addr_fault &gt; exc_page_fault &gt; asm_exc_page_fault &gt; RIP: 0033:0x55b897ba0808 &gt; C\u00f3digo: (omitido) &gt; RSP: 002b:00007ffeefa821a0 EFLAGS: 00 010287 &gt; RAX: 000055b89983acd0 RBX: 00007ffeefa823f8 RCX: 000055b89983acd0 &gt; RDX: 00007fc2f8122010 RSI: 0000000000020000 RDI: 000055b89983acd0 &gt; RBP: 00007ffeefa821a0 R08: 0000000000000037 R09: 00000000000000075 &gt; R10: 0000000000000000 R11: 0 000000000000202 R12: 0000000000000000 &gt; R13: 00007ffeefa82410 R14: 000055b897ba5dd8 R15: 00007fc4b8340000 &gt; "}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/2774f256e7c0219e2b0a0894af1c76bdabc4f974", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/bdd21eed8b72f9e28d6c279f6db258e090c79080", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/d6159bd4c00594249e305bfe02304c67c506264e", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1130", "comment": "CVE-2024-26783 - This technique is used to execute arbitrary code within the kernel, allowing the attacker to gain system-level access and potentially take control of the system."}, {"techniqueID": "T1135", "comment": "CVE-2024-26783 - This technique is used to run unauthorized code, allowing the attacker to execute arbitrary code within the kernel, potentially leading to system compromise."}, {"techniqueID": "T1178", "comment": "CVE-2024-26783 - This technique is used to disable or evade security controls and countermeasures, potentially allowing the attacker to move laterally or execute malicious code."}], "stix_bundle": {"type": "bundle", "id": "bundle--cve-2024_26783", "description": "CVE-2024-26783 Vulnerability Analysis", "objects": [{"type": "vulnerability", "id": "vulnerability--cve-2024_26783", "description": "mm/vmscan: fix a bug calling wakeup_kswapd() with a wrong zone index", "published": "2024-04-04T09:15:08.077", "lastModified": "2024-04-04T12:48:41.700", "cve": {"id": "CVE-2024-26783"}}, {"type": "attack-pattern", "id": "attack_pattern--t1130", "description": "Executing Arbitrary Code within the Kernel", "name": "Executing Arbitrary Code within the Kernel", "x_mitre_version": "1.2"}, {"type": "attack-pattern", "id": "attack_pattern--t1135", "description": "Running Unauthorized Code", "name": "Running Unauthorized Code", "x_mitre_version": "1.2"}, {"type": "attack-pattern", "id": "attack_pattern--t1178", "description": "Disabling or Evading Security Controls and Countermeasures", "name": "Disabling or Evading Security Controls and Countermeasures", "x_mitre_version": "1.2"}, {"type": "course-of-action", "id": "course_of_action--mitigate-attack-pattern", "description": "Implement kernel hardening and strict access controls", "assessment": "This course of action can mitigate the risk of an attacker exploiting this vulnerability to execute arbitrary code within the kernel."}], "relationships": [{"type": "has-part", "id": "relationship--cve-vulnerability", "source": "vulnerability--cve-2024_26783", "target": "attack_pattern--t1130"}, {"type": "has-part", "id": "relationship--cve-vulnerability", "source": "vulnerability--cve-2024_26783", "target": "attack_pattern--t1135"}, {"type": "has-part", "id": "relationship--cve-vulnerability", "source": "vulnerability--cve-2024_26783", "target": "attack_pattern--t1178"}, {"type": "mitigates", "id": "relationship--mitigate-attack-pattern", "source": "course_of_action--mitigate-attack-pattern", "target": "attack_pattern--t1130"}]}, "technical_analysis": {"Introduction": "The CVE-2024-26783 vulnerability is a kernel-level vulnerability that affects the Linux operating system. It allows an attacker to execute arbitrary code within the kernel, giving them system-level access and potentially leading to system compromise.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to gain system-level access and potentially take control of the system. The scope of this vulnerability is limited to Linux systems that are running a kernel version that is affected by this vulnerability.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1130, T1135, and T1178. These techniques are used to execute arbitrary code within the kernel, run unauthorized code, and disable or evade security controls and countermeasures.", "Technical Details": "The vulnerability occurs due to a bug in the mm/vmscan.c file in the Linux kernel. This bug allows an attacker to call the wakeup_kswapd() function with a wrong zone index, leading to a kernel panic.", "Detection": "Detection of this vulnerability is difficult, as it requires a deep understanding of the Linux kernel and the vulnerability itself. However, detection can be achieved by analyzing system logs for signs of kernel panics or unusual system behavior.", "Mitigation": "Mitigation of this vulnerability can be achieved by implementing kernel hardening and strict access controls. This can help prevent an attacker from exploiting the vulnerability to gain system-level access.", "Conclusion": "In conclusion, the CVE-2024-26783 vulnerability is a high-impact kernel-level vulnerability that affects the Linux operating system. It allows an attacker to execute arbitrary code within the kernel, giving them system-level access and potentially leading to system compromise. Detection and mitigation of this vulnerability require a deep understanding of the Linux kernel and the vulnerability itself."}, "executive_analysis": {"Overview": "The CVE-2024-26783 vulnerability is a serious security threat that affects the Linux operating system.", "Business Impact": "The business impact of this vulnerability is high, as it can lead to system compromise and potential data exfiltration.", "Technical Impact": "The technical impact of this vulnerability is also high, as it allows an attacker to execute arbitrary code within the kernel, giving them system-level access.", "Mitigation Strategies": "Implementation of kernel hardening and strict access controls can help mitigate the risk of this vulnerability.", "Recommendations": "Recommendations for executives include ensuring that all Linux systems are updated to the latest kernel version, implementing kernel hardening and strict access controls, and implementing regular security audits and penetration testing.", "Conclusions": "In conclusion, the CVE-2024-26783 vulnerability poses a serious security threat to Linux systems, and executives should take immediate action to mitigate the risk and ensure the security of their systems."}}