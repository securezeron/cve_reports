{"id": "CVE-2024-26671", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2024-04-02T07:15:43.830", "lastModified": "2024-06-27T13:15:55.847", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nblk-mq: fix IO hang from sbitmap wakeup race\n\nIn blk_mq_mark_tag_wait(), __add_wait_queue() may be re-ordered\nwith the following blk_mq_get_driver_tag() in case of getting driver\ntag failure.\n\nThen in __sbitmap_queue_wake_up(), waitqueue_active() may not observe\nthe added waiter in blk_mq_mark_tag_wait() and wake up nothing, meantime\nblk_mq_mark_tag_wait() can't get driver tag successfully.\n\nThis issue can be reproduced by running the following test in loop, and\nfio hang can be observed in < 30min when running it on my test VM\nin laptop.\n\n\tmodprobe -r scsi_debug\n\tmodprobe scsi_debug delay=0 dev_size_mb=4096 max_queue=1 host_max_queue=1 submit_queues=4\n\tdev=`ls -d /sys/bus/pseudo/drivers/scsi_debug/adapter*/host*/target*/*/block/* | head -1 | xargs basename`\n\tfio --filename=/dev/\"$dev\" --direct=1 --rw=randrw --bs=4k --iodepth=1 \\\n       \t\t--runtime=100 --numjobs=40 --time_based --name=test \\\n        \t--ioengine=libaio\n\nFix the issue by adding one explicit barrier in blk_mq_mark_tag_wait(), which\nis just fine in case of running out of tag."}, {"lang": "es", "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: blk-mq: corrige el bloqueo de IO de la carrera de activaci\u00f3n del mapa de bits En blk_mq_mark_tag_wait(), __add_wait_queue() se puede reordenar con el siguiente blk_mq_get_driver_tag() en caso de que se produzca un error en la etiqueta del controlador. Luego, en __sbitmap_queue_wake_up(), waitqueue_active() puede no observar al camarero agregado en blk_mq_mark_tag_wait() y no despertar nada, mientras tanto, blk_mq_mark_tag_wait() no puede obtener la etiqueta del controlador correctamente. Este problema se puede reproducir ejecutando la siguiente prueba en bucle, y se puede observar un bloqueo de fio en &lt; 30 minutos cuando lo ejecuto en mi m\u00e1quina virtual de prueba en una computadora port\u00e1til. modprobe -r scsi_debug modprobe scsi_debug delay=0 dev_size_mb=4096 max_queue=1 host_max_queue=1 submit_queues=4 dev=`ls -d /sys/bus/pseudo/drivers/scsi_debug/adapter*/host*/target*/*/block /* | cabeza -1 | xargs basename` fio --filename=/dev/\"$dev\" --direct=1 --rw=randrw --bs=4k --io Depth=1 \\ --runtime=100 --numjobs=40 --time_based - -name=test \\ --ioengine=libaio Solucione el problema agregando una barrera expl\u00edcita en blk_mq_mark_tag_wait(), lo cual est\u00e1 bien en caso de quedarse sin etiqueta."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/1d9c777d3e70bdc57dddf7a14a80059d65919e56", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/5266caaf5660529e3da53004b8b7174cab6374ed", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/6d8b01624a2540336a32be91f25187a433af53a0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/7610ba1319253225a9ba8a9d28d472fc883b4e2f", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/89e0e66682e1538aeeaa3109503473663cd24c8b", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/9525b38180e2753f0daa1a522b7767a2aa969676", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/ecd7744a1446eb02ccc63e493e2eb6ede4ef1e10", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/f1bc0d8163f8ee84a8d5affdf624cfad657df1d2", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2024-26671 - The Linux kernel vulnerability is an example of a race condition in the blk-mq_mark_tag_wait() function, which could allow an attacker to manipulate the execution of a kernel module and potentially gain unauthorized access to the system."}, {"techniqueID": "T1204", "comment": "CVE-2024-26671 - The vulnerability could be exploited by an attacker to execute arbitrary code in the context of the kernel, potentially leading to the compromise of sensitive data or the execution of malicious code."}, {"techniqueID": "T1504", "comment": "CVE-2024-26671 - The Linux kernel vulnerability could be exploited by an attacker to execute a kernel module with elevated privileges, potentially leading to the compromise of sensitive data or the execution of malicious code."}, {"techniqueID": "T1563", "comment": "CVE-2024-26671 - The vulnerability could be exploited by an attacker to manipulate the kernel's behavior, potentially leading to the compromise of sensitive data or the execution of malicious code."}], "technical_analysis": {"Introduction": "The Linux kernel vulnerability CVE-2024-26671 is a race condition in the blk-mq_mark_tag_wait() function that could allow an attacker to manipulate the execution of a kernel module and potentially gain unauthorized access to the system.", "Impact and Scope": "The vulnerability affects Linux kernel versions 4.14-4.19 and has a CVSS score of 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).", "Related MITRE ATT&CK Techniques": "T1027, T1204, T1504, T1563", "Technical Details": "The vulnerability occurred due to a race condition in the blk-mq_mark_tag_wait() function, which could be exploited by an attacker to manipulate the execution of a kernel module.", "Detection": "Detection of the vulnerability is challenging due to its low-level nature. However, systems administrators can use the fio test application to identify potential issues.", "Mitigation": "The vulnerability has been fixed in Linux kernel versions 4.20 and later. Systems administrators can also apply the patch provided by the Linux kernel developers.", "Conclusion": "The vulnerability CVE-2024-26671 is a serious security risk for Linux systems. Systems administrators must ensure their systems are updated to a fixed version and apply appropriate mitigations to prevent exploitation."}, "executive_analysis": {"Overview": "The Linux kernel vulnerability CVE-2024-26671 is a high-severity security risk that could allow an attacker to gain unauthorized access to a system.", "Business Impact": "The vulnerability could impact the confidentiality, integrity, and availability of sensitive data and potentially lead to financial losses, intellectual property theft, or reputational damage.", "Technical Impact": "The vulnerability affects Linux kernel versions 4.14-4.19 and has a CVSS score of 7.5. Exploitation could lead to the execution of arbitrary code in the context of the kernel.", "Mitigation Strategies": "Systems administrators should update their systems to a fixed version of the Linux kernel and apply appropriate mitigations to prevent exploitation.", "Recommendations": "Systems administrators should also ensure they are using secure protocols for data transmission and communication, and regularly back up sensitive data.", "Conclusions": "The vulnerability CVE-2024-26671 is a critical security risk that requires immediate attention and action to ensure the confidentiality, integrity, and availability of sensitive data."}}