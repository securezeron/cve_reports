{"id": "CVE-2020-7385", "sourceIdentifier": "cve@rapid7.com", "published": "2021-04-23T16:15:08.440", "lastModified": "2021-05-14T14:00:07.463", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "By launching the drb_remote_codeexec exploit, a Metasploit Framework user will inadvertently expose Metasploit to the same deserialization issue that is exploited by that module, due to the reliance on the vulnerable Distributed Ruby class functions. Since Metasploit Framework typically runs with elevated privileges, this can lead to a system compromise on the Metasploit workstation. Note that an attacker would have to lie in wait and entice the Metasploit user to run the affected module against a malicious endpoint in a \"hack-back\" type of attack. Metasploit is only vulnerable when the drb_remote_codeexec module is running. In most cases, this cannot happen automatically."}, {"lang": "es", "value": "Al lanzar el exploit drb_remote_codeexec, un usuario de Metasploit Framework expondr\u00e1 inadvertidamente un Metasploit al mismo problema de deserializaci\u00f3n que explota ese m\u00f3dulo, debido a la dependencia de las funciones vulnerables de la clase Distributed Ruby.&#xa0;Dado que Metasploit Framework generalmente se ejecuta con privilegios elevados, esto puede conllevar a un compromiso del sistema en la estaci\u00f3n de trabajo Metasploit.&#xa0;Tome en cuenta a un atacante tendr\u00eda que esperar y convencer al usuario de Metasploit para que ejecute el m\u00f3dulo afectado contra un endpoint malicioso en un tipo de ataque de \"hack-back\".&#xa0;Metasploit solo es vulnerable cuando se est\u00e1 ejecutando el m\u00f3dulo drb_remote_codeexec.&#xa0;En la mayor\u00eda de los casos, esto no puede suceder autom\u00e1ticamente"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "cve@rapid7.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-502"}]}, {"source": "cve@rapid7.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-502"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:rapid7:metasploit:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.19.0", "matchCriteriaId": "EFF91D8C-A041-42A6-9732-7A03C7DD14B8"}]}]}], "references": [{"url": "https://github.com/rapid7/metasploit-framework/pull/14300", "source": "cve@rapid7.com", "tags": ["Exploit", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/rapid7/metasploit-framework/pull/14335", "source": "cve@rapid7.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://help.rapid7.com/metasploit/release-notes/archive/2020/10/", "source": "cve@rapid7.com", "tags": ["Release Notes", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "Using the 'drb_remote_codeexec' exploit, a Metasploit Framework user will inadvertently expose Metasploit to the same deserialization issue that is exploited by that module, due to the reliance on the vulnerable Distributed Ruby class functions."}, {"techniqueID": "T1027", "comment": "A Metasploit user may run the affected module against a malicious endpoint, which is a necessary condition for exploitation. This requires a user interaction."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "vuln Bundle 10", "created_by": "Vulnerability Analyst", "created": "2021-04-23T16:15:08.440", "modified": "2021-05-14T14:00:07.463", "objects": [{"type": "vulnerability", "id": "CVE-2020-7385", "created_by": "Vulnerability Analyst", "created": "2021-04-23T16:15:08.440", "modified": "2021-05-14T14:00:07.463", "name": "Metasploit Framework DRB Remote Code Execution Vulnerability", "description": "By launching the drb_remote_codeexec exploit, a Metasploit Framework user will inadvertently expose Metasploit to the same deserialization issue that is exploited by that module, due to the reliance on the vulnerable Distributed Ruby class functions.", "ref": [{"type": "url", "value": "https://github.com/rapid7/metasploit-framework/pull/14300"}], "relationships": [{"type": "has_technique", "id_ref": "T1210"}, {"type": "has_technique", "id_ref": "T1027"}]}, {"type": "technique", "id": "T1210", "created_by": "Vulnerability Analyst", "created": "2021-04-23T16:15:08.440", "modified": "2021-05-14T14:00:07.463", "name": "Exploit Public-Facing Application", "description": "Exploits public-facing applications, such as vulnerabilities in web servers, browsers, and other public-facing services."}, {"type": "technique", "id": "T1027", "created_by": "Vulnerability Analyst", "created": "2021-04-23T16:15:08.440", "modified": "2021-05-14T14:00:07.463", "name": "Modifying Existing Content", "description": "Modifying existing content, such as injecting malicious code into a web application, or injecting malicious data into a database."}]}, "technical_analysis": {"Introduction": "This vulnerability affects the Metasploit Framework, a popular open-source penetration testing tool, and can allow an attacker to execute arbitrary code with elevated privileges. The vulnerability is due to the reliance on a vulnerable Distributed Ruby class function.", "Impact and Scope": "The vulnerability has a CVSS score of 8.8 (HIGH) due to the potential impact of arbitrary code execution with elevated privileges.", "Related MITRE ATT&CK Techniques": "The vuln-erable Metasploit Framework DRB Remote Code Execution vulnerability is related to the 'Exploit Public-Facing Application' (T1210) and 'Modifying Existing Content' (T1027) MITRE ATT&CK techniques.", "Technical Details": "The vulnerability is due to the reliance on the vulnerable Distributed Ruby class function, which can be exploited by launching the 'drb_remote_codeexec' exploit.", "Detection": "Detecting this vulnerability is challenging, as it requires identifying the Metasploit Framework version being used and the presence of the vulnerable Distributed Ruby class function.", "Mitigation": "The vulnerability can be mitigated by upgrading the Metasploit Framework to a version that is not vulnerable to the DRB Remote Code Execution vulnerability.", "Conclusion": "In conclusion, the Metasploit Framework DRB Remote Code Execution vulnerability is a critical issue that can allow an attacker to execute arbitrary code with elevated privileges. It is essential to upgrade the Metasploit Framework to a version that is not vulnerable to this issue."}, "executive_analysis": {"Overview": "The Metasploit Framework DRB Remote Code Execution vulnerability is a critical issue that can allow an attacker to execute arbitrary code with elevated privileges.", "Business Impact": "This vulnerability can have a significant business impact, as it can allow an attacker to execute arbitrary code with elevated privileges, potentially leading to data breaches or system compromises.", "Technical Impact": "The vulnerability has a CVSS score of 8.8 (HIGH) due to the potential impact of arbitrary code execution with elevated privileges.", "Mitigation Strategies": "The recommended mitigation strategy is to upgrade the Metasploit Framework to a version that is not vulnerable to the DRB Remote Code Execution vulnerability.", "Recommendations": "Executives should recommend that the information security team upgrade the Metasploit Framework to a version that is not vulnerable to this issue.", "Conclusions": "In conclusion, the Metasploit Framework DRB Remote Code Execution vulnerability is a critical issue that requires immediate attention to prevent potential data breaches or system compromises."}}