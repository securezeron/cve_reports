{"id": "CVE-2007-2730", "sourceIdentifier": "cve@mitre.org", "published": "2007-05-16T22:30:00.000", "lastModified": "2018-10-16T16:45:16.087", "vulnStatus": "Modified", "cveTags": [], "evaluatorSolution": "ZoneAlarm Pro 6.5.737.000 and higher are not vulnerable.", "descriptions": [{"lang": "en", "value": "Check Point ZoneAlarm Pro before 6.5.737.000 does not properly test for equivalence of process identifiers for certain Microsoft Windows API functions in the NT kernel 5.0 and greater, which allows local users to call these functions, and bypass firewall rules or gain privileges, via a modified identifier that is one, two, or three greater than the canonical identifier."}, {"lang": "es", "value": "Check Point Zonealarm Pro anterior a 6.5.737.000 no comprueba adecuadamente la equivalencia de identificadores de proceso para determinadas funciones de la API de Windows en el n\u00facleo de NT5.0 y superiores, lo cual permite a usuarios locales llamar a estas funciones y evitar reglas del cortafuegos u obtener privilegios, mediante un identificador modificado que es uno, dos, o tres unidades mayor que el identificador can\u00f3nico."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_2000:*:*:*:*:*:*:*:*", "matchCriteriaId": "4E545C63-FE9C-4CA1-AF0F-D999D84D2AFD"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_2003_server:*:*:*:*:*:*:*:*", "matchCriteriaId": "60EC86B8-5C8C-4873-B364-FB1F8EFE1CFF"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_xp:*:*:*:*:*:*:*:*", "matchCriteriaId": "E61F1C9B-44AF-4B35-A7B2-948EEF7639BD"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:checkpoint:zonealarm:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.1.744.001", "matchCriteriaId": "7C7FDE10-07B9-4F86-8419-9F459B1DDD02"}, {"vulnerable": true, "criteria": "cpe:2.3:a:comodo:comodo_firewall_pro:2.4.18.184:*:*:*:*:*:*:*", "matchCriteriaId": "6518A7E2-C299-4985-BCAD-0A52FB9E850D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:comodo:comodo_personal_firewall:2.3.6.81:*:*:*:*:*:*:*", "matchCriteriaId": "27A1D441-3366-4F5C-944B-76472ACCBC29"}]}]}], "references": [{"url": "http://osvdb.org/37383", "source": "cve@mitre.org"}, {"url": "http://securityreason.com/securityalert/2714", "source": "cve@mitre.org"}, {"url": "http://www.matousec.com/info/advisories/Bypassing-PWF-HIPS-open-process-control-with-uncommon-identifier.php", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/468643/100/0/threaded", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1210:Exploit Public-Facing Application", "comment": "CVE-2007-2730 - This vulnerability allows local users to bypass firewall rules or gain privileges by calling Microsoft Windows API functions with a modified process identifier. This technique is relevant to defend against this vulnerability."}, {"techniqueID": "T1055:Remote File Copy", "comment": "CVE-2007-2730 - This technique is used to exploit the vulnerability by copying a malicious file to a remote system. This technique is relevant to defend against this vulnerability."}, {"techniqueID": "T1220:Remote Service Checks", "comment": "CVE-2007-2730 - This technique is used to detect the presence of a vulnerable system and exploit the vulnerability. This technique is relevant to defend against this vulnerability."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "CVE-2007-2730-bundle", "created_by_ref": "Org-Cyb3r-Sec-Team", "modified": "2023-03-17T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "CVE-2007-2730", "created_by_ref": "Org-Cyb3r-Sec-Team", "modified": "2023-03-17T14:30:00.000Z", "name": "CVE-2007-2730", "description": "Check Point ZoneAlarm Pro before 6.5.737.000 does not properly test for equivalence of process identifiers for certain Microsoft Windows API functions in the NT kernel 5.0 and greater, which allows local users to call these functions, and bypass firewall rules or gain privileges, via a modified identifier that is one, two, or three greater than the canonical identifier.", "severity": "HIGH", "cvss": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "references": [{"type": "reference", "id": "OSVDB-37383", "url": "http://osvdb.org/37383", "source": "cve@mitre.org"}, {"type": "reference", "id": "SecurityFocus-468643", "url": "http://www.securityfocus.com/archive/1/468643/100/0/threaded", "source": "cve@mitre.org"}]}, {"type": "course-of-action", "id": "T1210-Exploit Public-Facing Application", "created_by_ref": "Org-Cyb3r-Sec-Team", "modified": "2023-03-17T14:30:00.000Z", "name": "Exploit the vulnerability", "description": "Exploit the vulnerability by calling Microsoft Windows API functions with a modified process identifier.", "related_analysis": {"techniqueID": "T1210:Exploit Public-Facing Application"}}, {"type": "course-of-action", "id": "T1055-Remote File Copy", "created_by_ref": "Org-Cyb3r-Sec-Team", "modified": "2023-03-17T14:30:00.000Z", "name": "Copy a malicious file", "description": "Copy a malicious file to a remote system to exploit the vulnerability.", "related_analysis": {"techniqueID": "T1055:Remote File Copy"}}, {"type": "course-of-action", "id": "T1220-Remote Service Checks", "created_by_ref": "Org-Cyb3r-Sec-Team", "modified": "2023-03-17T14:30:00.000Z", "name": "Detect the presence of a vulnerable system", "description": "Detect the presence of a vulnerable system by checking remote services.", "related_analysis": {"techniqueID": "T1220:Remote Service Checks"}}], "relationships": [{"type": "has-part", "id": "CVE-2007-2730-bundle-part-1", "object_ref": "CVE-2007-2730"}, {"type": "mitigated-by", "id": "CVE-2007-2730-bundle-mitigated-by-1", "object_ref": "T1210-Exploit Public-Facing Application"}, {"type": "mitigated-by", "id": "CVE-2007-2730-bundle-mitigated-by-2", "object_ref": "T1055-Remote File Copy"}, {"type": "mitigated-by", "id": "CVE-2007-2730-bundle-mitigated-by-3", "object_ref": "T1220-Remote Service Checks"}]}}, "technical_analysis": {"Introduction": "This vulnerability is a remote code execution vulnerability that affects Check Point ZoneAlarm Pro before 6.5.737.000. It allows local users to bypass firewall rules or gain privileges by calling Microsoft Windows API functions with a modified process identifier.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2 and can be exploited by remote attackers. It affects all systems running Check Point ZoneAlarm Pro before 6.5.737.000.", "Related MITRE ATT&CK Techniques": "This vulnerability is relevant to T1210:Exploit Public-Facing Application, T1055:Remote File Copy, and T1220:Remote Service Checks.", "Technical Details": "The vulnerability is caused by a lack of proper validation of process identifiers in Check Point ZoneAlarm Pro before 6.5.737.000.", "Detection": "This vulnerability can be detected by monitoring for suspicious activity on the system, such as unexpected network traffic or changes to system settings.", "Mitigation": "This vulnerability can be mitigated by applying the recommended patches to Check Point ZoneAlarm Pro.", "Conclusion": "This vulnerability is a critical risk and should be addressed promptly."}, "executive_analysis": {"Overview": "This vulnerability is a critical remote code execution vulnerability that affects Check Point ZoneAlarm Pro before 6.5.737.000.", "Business Impact": "This vulnerability can result in significant business risks, including data breaches and system compromise.", "Technical Impact": "This vulnerability can result in significant technical risks, including system compromise and data loss.", "Mitigation Strategies": "Apply the recommended patches to Check Point ZoneAlarm Pro.", "Recommendations": "Recommend that all systems running Check Point ZoneAlarm Pro before 6.5.737.000 be patched as soon as possible.", "Conclusions": "This vulnerability is a critical risk and should be addressed promptly."}}