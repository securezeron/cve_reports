{"id": "CVE-2009-1699", "sourceIdentifier": "cve@mitre.org", "published": "2009-06-10T18:00:00.517", "lastModified": "2024-02-10T02:48:38.187", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The XSL stylesheet implementation in WebKit in Apple Safari before 4.0, iPhone OS 1.0 through 2.2.1, and iPhone OS for iPod touch 1.1 through 2.2.1 does not properly handle XML external entities, which allows remote attackers to read arbitrary files via a crafted DTD, as demonstrated by a file:///etc/passwd URL in an entity declaration, related to an \"XXE attack.\""}, {"lang": "es", "value": "La implementaci\u00f3n de la hoja de estilo XSL en WebKit en Apple Safari anterior a v4.0 no maneja adecuadamente las entidades externas XML, lo cual permite a atacantes remotos leer ficheros arbitrarios a trav\u00e9s de un DTD elaborado, como lo demuestra un fichero: ///etc/passwd URL en una declaraci\u00f3n de entidad, relacionado con un \"ataque XXE\"."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:C/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.1}, "baseSeverity": "HIGH", "exploitabilityScore": 8.6, "impactScore": 6.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-611"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apple:safari:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.0", "matchCriteriaId": "212BF588-5C81-4801-A76D-73FB1DE211EA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:iphone_os:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.0.0", "versionEndIncluding": "2.2.1", "matchCriteriaId": "614C28E3-3645-4B20-95E5-42E7F123ADDB"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:8.10:*:*:*:*:*:*:*", "matchCriteriaId": "4747CC68-FAF4-482F-929A-9DA6C24CB663"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:9.04:*:*:*:*:*:*:*", "matchCriteriaId": "A5D026D0-EF78-438D-BEDD-FC8571F3ACEB"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:opensuse:11.2:*:*:*:*:*:*:*", "matchCriteriaId": "A01C8B7E-EB19-40EA-B1D2-9AE5EA536C95"}, {"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:opensuse:11.3:*:*:*:*:*:*:*", "matchCriteriaId": "5646FDE9-CF21-46A9-B89D-F5BBDB4249AF"}]}]}], "references": [{"url": "http://lists.apple.com/archives/security-announce/2009/Jun/msg00005.html", "source": "cve@mitre.org", "tags": ["Mailing List"]}, {"url": "http://lists.apple.com/archives/security-announce/2009/jun/msg00002.html", "source": "cve@mitre.org", "tags": ["Broken Link", "Mailing List", "Patch", "Vendor Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2011-01/msg00006.html", "source": "cve@mitre.org", "tags": ["Mailing List"]}, {"url": "http://osvdb.org/54972", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://scary.beasts.org/security/CESA-2009-006.html", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://scarybeastsecurity.blogspot.com/2009/06/apples-safari-4-fixes-local-file-theft.html", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://secunia.com/advisories/35379", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/43068", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://support.apple.com/kb/HT3613", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://support.apple.com/kb/HT3639", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/35260", "source": "cve@mitre.org", "tags": ["Broken Link", "Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securityfocus.com/bid/35321", "source": "cve@mitre.org", "tags": ["Broken Link", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.ubuntu.com/usn/USN-857-1", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2009/1522", "source": "cve@mitre.org", "tags": ["Broken Link", "Patch", "Vendor Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2009/1621", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.vupen.com/english/advisories/2011/0212", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "https://www.exploit-db.com/exploits/8907", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2009-1699 - XXE attack enables remote attackers to read arbitrary files via a crafted DTD, related to WebKit XSL stylesheet implementation vulnerability in Apple Safari, iPhone OS, and iPod touch."}, {"techniqueID": "T1036", "comment": "CVE-2009-1699 - XXE attack enables remote attackers to read arbitrary files via a crafted DTD, related to WebKit XSL stylesheet implementation vulnerability in Apple Safari, iPhone OS, and iPod touch, which can be used to steal sensitive information."}, {"techniqueID": "T1130", "comment": "CVE-2009-1699 - XXE attack enables remote attackers to read arbitrary files via a crafted DTD, related to WebKit XSL stylesheet implementation vulnerability in Apple Safari, iPhone OS, and iPod touch, which can be used to read sensitive files."}], "stix_bundle": [{"objects": [{"type": "indicator", "id": "indicator--63a1e2e8-d7f6-49d6-bc7c-bd7f5cda5448", "created_by_ref": "identity--a456b8b6-8e64-4b8d-b4fc-f372d51c9344", "modified": "2024-02-10T02:48:38.187Z", "created": "2009-06-10T18:00:00.517Z", "name": "CVE-2009-1699 WebKit XSL Stylesheet Implementation Vulnerability", "description": "The WebKit XSL Stylesheet Implementation in Apple Safari before 4.0, iPhone OS 1.0 through 2.2.1, and iPhone OS for iPod touch 1.1 through 2.2.1 does not properly handle XML external entities, allowing remote attackers to read arbitrary files via a crafted DTD.", "confidence": "HIGH", "modified_by_ref": "identity--a456b8b6-8e64-4b8d-b4fc-f372d51c9344", "objects": [{"type": "note", "id": "note--d92a3ee5-88ea-4764-85df-97e78a9a63be", "contents": "Note 1"}], "note_reports": [{"report": "Note 2"}], "references": [{"href": "http://lists.apple.com/archives/security-announce/2009/Jun/msg00005.html", "name": "Security Alert"}]}, {"type": "malware", "id": "malware--ee5cd442-23a8-4797-ac35-6af66e3f0f54", "created_by_ref": "identity--a456b8b6-8e64-4b8d-b4fc-f372d51c9344", "modified": "2024-02-10T02:48:38.187Z", "created": "2009-06-10T18:00:00.517Z", "name": "CVE-2009-1699 XXE Remote File Read Malware", "description": "XXE Remote File Read Malware exploits the CVE-2009-1699 vulnerability in Apple Safari, iPhone OS, and iPod touch, to read arbitrary files via a crafted DTD.", "confidence": "HIGH", "modified_by_ref": "identity--a456b8b6-8e64-4b8d-b4fc-f372d51c9344", "objects": [{"type": "note", "id": "note--d92a3ee5-88ea-4764-85df-97e78a9a63be", "contents": "Note 1"}], "note_reports": [{"report": "Note 2"}], "references": [{"href": "http://lists.apple.com/archives/security-announce/2009/Jun/msg00005.html", "name": "Security Alert"}]}, {"type": "course_of_action", "id": "course_of_action--f9a36e69-d46a-4f2e-95b5-1d3e3e1c77f2", "created_by_ref": "identity--a456b8b6-8e64-4b8d-b4fc-f372d51c9344", "modified": "2024-02-10T02:48:38.187Z", "created": "2009-06-10T18:00:00.517Z", "name": "Patch and Update", "description": "Patch and update Apple Safari, iPhone OS, and iPod touch to the latest version to mitigate the XXE Remote File Read Malware.", "confidence": "HIGH", "modified_by_ref": "identity--a456b8b6-8e64-4b8d-b4fc-f372d51c9344", "objects": [{"type": "note", "id": "note--d92a3ee5-88ea-4764-85df-97e78a9a63be", "contents": "Note 1"}], "note_reports": [{"report": "Note 2"}], "references": [{"href": "http://lists.apple.com/archives/security-announce/2009/Jun/msg00005.html", "name": "Security Alert"}]}], "relationships": [{"type": "has", "id_ref": "indicator--63a1e2e8-d7f6-49d6-bc7c-bd7f5cda5448", "object_ref": "malware--ee5cd442-23a8-4797-ac35-6af66e3f0f54"}]}], "technical_analysis": {"Introduction": "The WebKit XSL Stylesheet Implementation in Apple Safari before 4.0, iPhone OS 1.0 through 2.2.1, and iPhone OS for iPod touch 1.1 through 2.2.1 does not properly handle XML external entities, allowing remote attackers to read arbitrary files via a crafted DTD.", "Impact and Scope": "The affected systems are vulnerable to XXE Remote File Read Malware, which can read arbitrary files on the system.", "Related MITRE ATT&CK Techniques": "T1190, T1036, T1130", "Technical Details": "The vulnerability is due to the lack of proper validation of XML external entities in the WebKit XSL Stylesheet Implementation.", "Detection": "Detection of this vulnerability is difficult as it requires direct access to the affected system and requires a thorough understanding of the vulnerability.", "Mitigation": "Patch and update Apple Safari, iPhone OS, and iPod touch to the latest version to mitigate the XXE Remote File Read Malware.", "Conclusion": "This vulnerability is highly critical and should be treated with high priority. Patches and updates should be applied as soon as possible to prevent exploitation."}, "executive_analysis": {"Overview": "The WebKit XSL Stylesheet Implementation in Apple Safari before 4.0, iPhone OS 1.0 through 2.2.1, and iPhone OS for iPod touch 1.1 through 2.2.1 does not properly handle XML external entities, allowing remote attackers to read arbitrary files via a crafted DTD.", "Business Impact": "This vulnerability can result in the exposure of sensitive files and compromise business data confidentiality.", "Technical Impact": "This vulnerability can result in the exposure of sensitive files and compromise system security.", "Mitigation Strategies": "Patch and update Apple Safari, iPhone OS, and iPod touch to the latest version.", "Recommendations": "Recommend that all Apple Safari, iPhone OS, and iPod touch users patch and update their systems to the latest version.", "Conclusions": "This vulnerability is highly critical and should be treated with high priority. Patches and updates should be applied as soon as possible to prevent exploitation."}}