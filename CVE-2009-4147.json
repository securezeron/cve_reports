{"id": "CVE-2009-4147", "sourceIdentifier": "cve@mitre.org", "published": "2009-12-02T19:30:00.217", "lastModified": "2019-05-22T03:29:00.597", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The _rtld function in the Run-Time Link-Editor (rtld) in libexec/rtld-elf/rtld.c in FreeBSD 7.1 and 8.0 does not clear the (1) LD_LIBMAP, (2) LD_LIBRARY_PATH, (3) LD_LIBMAP_DISABLE, (4) LD_DEBUG, and (5) LD_ELF_HINTS_PATH environment variables, which allows local users to gain privileges by executing a setuid or setguid program with a modified variable containing an untrusted search path that points to a Trojan horse library, different vectors than CVE-2009-4146."}, {"lang": "es", "value": "La funci\u00f3n _rtld en Run-Time Link-Editor (rtld) en libexec/rtld-elf/rtld.c en FreeBSD v7.1 y v8.0 no limpia las variables de entorno de (1) LD_LIBMAP, (2) LD_LIBRARY_PATH, (3) LD_LIBMAP_DISABLE, (4) LD_DEBUG, and (5) LD_ELF_HINTS_PATH lo que permite a usuarios locales conseguir privilegios mediante la ejecuci\u00f3n de un programa setuid o setguid con una variable modificada que contiene una ruta de b\u00fasqueda sin confianza que apunta a una libreria de un troyano con vectores diferentes que CVE-2009-4146."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.1:*:*:*:*:*:*:*", "matchCriteriaId": "803EFA9F-B7CB-4511-B1C1-381170CA9A23"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "3CF1F9EF-01AF-4708-AE02-765360AF3D66"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/152997/FreeBSD-rtld-execl-Privilege-Escalation.html", "source": "cve@mitre.org"}, {"url": "http://people.freebsd.org/~cperciva/rtld.patch", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://secunia.com/advisories/37517", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/508142/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/508146/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/37154", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.securitytracker.com/id?1023250", "source": "cve@mitre.org", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1190", "comment": "The vulnerability allows for privilege escalation by setting environment variables that are not cleared properly. This can be mitigated by ensuring that all environment variables are cleared after use."}, {"techniqueID": "T1003", "comment": "The vulnerability allows for the execution of malicious code by not validating input properly. This can be mitigated by implementing input validation and sanitization."}, {"techniqueID": "T1078", "comment": "The vulnerability allows for the exploitation of a vulnerability through the use of a Trojan horse library. This can be mitigated by ensuring that all libraries used are trusted and validated."}, {"techniqueID": "T1202", "comment": "The vulnerability allows for the creation of a backdoor by modifying environment variables. This can be mitigated by monitoring environment variables for suspicious changes."}], "stix_bundle": [{"type": "marker", "id": "marker-CVE-2009-4147", "name": "CVE-2009-4147", "description": "The _rtld function in the Run-Time Link-Editor (rtld) in libexec/rtld-elf/rtld.c in FreeBSD 7.1 and 8.0 does not clear the (1) LD_LIBMAP, (2) LD_LIBRARY_PATH, (3) LD_LIBMAP_DISABLE, (4) LD_DEBUG, and (5) LD_ELF_HINTS_PATH environment variables, which allows local users to gain privileges by executing a setuid or setguid program with a modified variable containing an untrusted search path that points to a Trojan horse library, different vectors than CVE-2009-4146.", "indicator": [{"type": "windows-registry-key", "id": "rkey-CVE-2009-4147", "name": "rkey-CVE-2009-4147", "description": "Modify the registry key to set environment variables", "value": "{\"match\":{\"windows-registry-key\":{\"value\":\"1\"}}}", "relationship": "indicates"}, {"type": "file-modify", "id": "filemodify-CVE-2009-4147", "name": "filemodify-CVE-2009-4147", "description": "Modify the file to execute setuid or setguid program", "value": "{\"match\":{\"file\":{\"path\":\"/usr/sbin/freebsd_update\"}}}", "relationship": "indicates"}]}], "technical_analysis": {"Introduction": "This CVE allows for privilege escalation by setting environment variables that are not cleared properly.", "Impact and Scope": {"cvssVersion": "CVSS 2.0", "cvssScore": "7.2", "attackVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE"}, "Related MITRE ATT&CK Techniques": ["T1190", "T1003", "T1078", "T1202"], "Technical Details": "The vulnerability is caused by the lack of proper environment variable clearing in the _rtld function.", "Detection": "Monitor environment variables for suspicious changes and monitor file modifications.", "Mitigation": "Clear environment variables after use, validate input properly, and ensure that all libraries used are trusted and validated.", "Conclusion": "This CVE has a high impact on the confidentiality, integrity, and availability of the system, and should be addressed promptly."}, "executive_analysis": {"Overview": "This CVE allows for privilege escalation by setting environment variables that are not cleared properly.", "Business Impact": "The vulnerability can be exploited to gain unauthorized access to sensitive data or systems, which can cause reputational damage and financial losses.", "Technical Impact": "The vulnerability can be exploited by modifying environment variables, which can lead to the execution of unauthorized code.", "Mitigation Strategies": "Implement proper environment variable clearing, validate input properly, and ensure that all libraries used are trusted and validated.", "Recommendations": "Apply the patch provided by the vendor, and implement additional security measures to mitigate the risk of exploitation.", "Conclusions": "The vulnerability should be addressed promptly to prevent unauthorized access to sensitive data or systems."}}