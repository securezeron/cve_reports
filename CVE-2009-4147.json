{"id": "CVE-2009-4147", "sourceIdentifier": "cve@mitre.org", "published": "2009-12-02T19:30:00.217", "lastModified": "2019-05-22T03:29:00.597", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The _rtld function in the Run-Time Link-Editor (rtld) in libexec/rtld-elf/rtld.c in FreeBSD 7.1 and 8.0 does not clear the (1) LD_LIBMAP, (2) LD_LIBRARY_PATH, (3) LD_LIBMAP_DISABLE, (4) LD_DEBUG, and (5) LD_ELF_HINTS_PATH environment variables, which allows local users to gain privileges by executing a setuid or setguid program with a modified variable containing an untrusted search path that points to a Trojan horse library, different vectors than CVE-2009-4146."}, {"lang": "es", "value": "La funci\u00f3n _rtld en Run-Time Link-Editor (rtld) en libexec/rtld-elf/rtld.c en FreeBSD v7.1 y v8.0 no limpia las variables de entorno de (1) LD_LIBMAP, (2) LD_LIBRARY_PATH, (3) LD_LIBMAP_DISABLE, (4) LD_DEBUG, and (5) LD_ELF_HINTS_PATH lo que permite a usuarios locales conseguir privilegios mediante la ejecuci\u00f3n de un programa setuid o setguid con una variable modificada que contiene una ruta de b\u00fasqueda sin confianza que apunta a una libreria de un troyano con vectores diferentes que CVE-2009-4146."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.1:*:*:*:*:*:*:*", "matchCriteriaId": "803EFA9F-B7CB-4511-B1C1-381170CA9A23"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "3CF1F9EF-01AF-4708-AE02-765360AF3D66"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/152997/FreeBSD-rtld-execl-Privilege-Escalation.html", "source": "cve@mitre.org"}, {"url": "http://people.freebsd.org/~cperciva/rtld.patch", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://secunia.com/advisories/37517", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/508142/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/508146/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/37154", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.securitytracker.com/id?1023250", "source": "cve@mitre.org", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1065", "comment": "CVE-2009-4147 - This technique of environment variable manipulation is used to elevate privileges by modifying the LD_LIBRARY_PATH environment variable to point to a malicious library. This attack is relevant and can be defended against by restricting access to sensitive areas of the file system and monitoring for unusual changes in environment variables."}, {"techniqueID": "T1190", "comment": "CVE-2009-4147 - This technique of Executable Control leads to privilege escalation due to untrusted libraries being executed. This attack is relevant and can be defended against by implementing strict library loading restrictions and monitoring for suspicious executable execution."}, {"techniqueID": "T1210", "comment": "CVE-2009-4147 - This technique of Command and Scripting Interpreter Attack is used to execute malicious commands to elevate privileges. This attack is relevant and can be defended against by restricting access to sensitive areas of the file system and monitoring for unusual command execution."}], "stix_bundle": {"bundle_id": "CVE-2009-4147-Bundle", "title": "CVE-2009-4147 STIX Bundle", "description": "STIX Bundle for CVE-2009-4147: Freebsd _rtld Function Privilege Escalation Vulnerability", "objects": [{"id": "CVE-2009-4147", "type": "vulnerability", "description": "The _rtld function in the Run-Time Link-Editor (rtld) in libexec/rtld-elf/rtld.c in FreeBSD 7.1 and 8.0 does not clear the (1) LD_LIBMAP, (2) LD_LIBRARY_PATH, (3) LD_LIBMAP_DISABLE, (4) LD_DEBUG, and (5) LD_ELF_HINTS_PATH environment variables, which allows local users to gain privileges by executing a setuid or setguid program with a modified variable containing an untrusted search path that points to a Trojan horse library, different vectors than CVE-2009-4146.", "references": [{"id": "CVE-2009-4147", "type": "vulnerability", "relation": "related", "object_relation": "exploit"}]}, {"id": "T1065", "type": "attack-pattern", "description": "Environment Variable Manipulation", "relation": "uses", "object_relation": "technique", "objects": [{"id": "CVE-2009-4147", "type": "vulnerability", "relation": "related", "object_relation": "exploit"}]}, {"id": "T1190", "type": "attack-pattern", "description": "Executable Control", "relation": "uses", "object_relation": "technique", "objects": [{"id": "CVE-2009-4147", "type": "vulnerability", "relation": "related", "object_relation": "exploit"}]}, {"id": "T1210", "type": "attack-pattern", "description": "Command and Scripting Interpreter Attack", "relation": "uses", "object_relation": "technique", "objects": [{"id": "CVE-2009-4147", "type": "vulnerability", "relation": "related", "object_relation": "exploit"}]}, {"id": "Executable Control", "type": "course-of-action", "description": "This course of action is to implement strict library loading restrictions to prevent privilege escalation", "relation": "mitigates", "object_relation": "technique", "objects": [{"id": "T1190", "type": "attack-pattern", "relation": "uses", "object_relation": "technique"}]}], "package": {"id": "CVE-2009-4147-Bundle", "type": "package", "description": "STIX Bundle for CVE-2009-4147: Freebsd _rtld Function Privilege Escalation Vulnerability"}}, "technical_analysis": {"Introduction": "This vulnerability is a privilege escalation vulnerability in the Freebsd _rtld function, which allows local attackers to gain privileges by modifying the LD_LIBRARY_PATH environment variable.", "Impact and Scope": "The vulnerability is rated as High severity with a CVSS score of 7.2, making it a critical vulnerability that requires immediate attention.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including Environment Variable Manipulation (T1065), Executable Control (T1190), and Command and Scripting Interpreter Attack (T1210).", "Technical Details": "The vulnerability is caused by the _rtld function not clearing the LD_LIBRARY_PATH environment variable, allowing attackers to modify it and execute a setuid or setguid program with a modified variable containing an untrusted search path that points to a Trojan horse library.", "Detection": "Detection can be done by monitoring for unusual changes in environment variables, especially the LD_LIBRARY_PATH.", "Mitigation": "Mitigation strategies include implementing strict library loading restrictions, monitoring for suspicious executable execution, and restricting access to sensitive areas of the file system.", "Conclusion": "Conclusion: This vulnerability is a critical privilege escalation vulnerability that requires immediate attention. Implementing strict library loading restrictions, monitoring for suspicious executable execution, and restricting access to sensitive areas of the file system can help mitigate the vulnerability."}, "executive_analysis": {"Overview": "This is a critical privilege escalation vulnerability in the Freebsd _rtld function that allows local attackers to gain privileges.", "Business Impact": "The vulnerability could lead to data breaches, financial losses, and reputational damage if left unPatch.", "Technical Impact": "The vulnerability could allow attackers to execute malicious code, steal sensitive data, and gain unauthorized access to systems.", "Mitigation Strategies": "Implementing strict library loading restrictions, monitoring for suspicious executable execution, and restricting access to sensitive areas of the file system are mitigation strategies.", "Recommendations": "Recommendations for executives include implementing a vulnerability management program, conducting regular security audits, and training employees on security best practices.", "Conclusions": "In conclusion, this vulnerability is a critical issue that requires immediate attention. Implementing the recommended mitigation strategies and conducting regular security audits can help prevent incidents and maintain business continuity."}}