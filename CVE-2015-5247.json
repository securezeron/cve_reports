{"id": "CVE-2015-5247", "sourceIdentifier": "secalert@redhat.com", "published": "2016-04-14T15:59:01.090", "lastModified": "2016-04-18T18:37:02.677", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The virStorageVolCreateXML API in libvirt 1.2.14 through 1.2.19 allows remote authenticated users with a read-write connection to cause a denial of service (libvirtd crash) by triggering a failed unlink after creating a volume on a root_squash NFS pool."}, {"lang": "es", "value": "La API virStorageVolCreateXML en libvirt 1.2.14 hasta la versi\u00f3n 1.2.19 permite a usuarios remotos autenticados con una conexi\u00f3n de lectura-escritura causar una denegaci\u00f3n de servicio (ca\u00edda de libvirtd) desencadenando una desvinculaci\u00f3n fallida despu\u00e9s de crear un volumen en un pool NFS root_squash."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-284"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:libvirt:1.2.14:*:*:*:*:*:*:*", "matchCriteriaId": "57AFB8C5-5798-4029-81CE-E56AD2DB34D5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:libvirt:1.2.15:*:*:*:*:*:*:*", "matchCriteriaId": "FCF25808-E322-43C1-8BB4-F233787DAAF8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:libvirt:1.2.16:*:*:*:*:*:*:*", "matchCriteriaId": "32836083-B8C3-48C3-B2BB-5C752BC048C3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:libvirt:1.2.17:*:*:*:*:*:*:*", "matchCriteriaId": "26DF8FF3-4261-460A-81D1-D0F9CC8A1E8E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:libvirt:1.2.18:*:*:*:*:*:*:*", "matchCriteriaId": "7E6F0C3B-64A3-497D-9150-F71D499D4CE3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:libvirt:1.2.19:*:*:*:*:*:*:*", "matchCriteriaId": "7F84E1F2-52A9-43C8-A784-603CF03E0078"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:12.04:*:*:*:lts:*:*:*", "matchCriteriaId": "B6B7CAD7-9D4E-4FDB-88E3-1E583210A01F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:lts:*:*:*", "matchCriteriaId": "B5A6F2F3-4894-4392-8296-3B8DD2679084"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:15.04:*:*:*:*:*:*:*", "matchCriteriaId": "F38D3B7E-8429-473F-BB31-FC3583EE5A5B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:15.10:*:*:*:*:*:*:*", "matchCriteriaId": "E88A537F-F4D0-46B9-9E37-965233C2A355"}]}]}], "references": [{"url": "http://security.libvirt.org/2015/0003.html", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://www.ubuntu.com/usn/USN-2867-1", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1203", "comment": "CVE-2015-5247 - The use of vulnerability CVE-2015-5247 by an attacker to crash the libvirtd service, which can be used to gain a foothold in the system or as a denial-of-service attack."}, {"techniqueID": "T1027", "comment": "CVE-2015-5247 - The use of vulnerability CVE-2015-5247 to create a volume on a root_squash NFS pool, which can be used to dump files or execute arbitrary code."}, {"techniqueID": "T1499", "comment": "CVE-2015-5247 - The use of vulnerability CVE-2015-5247 to crash the libvirtd service, which can be used to disrupt operations or create a condition that allows for further exploitation."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "cve-2015-5247/stix-bundle", "created_by_ref": "http://nvd.nist.gov", "modified": "2022-02-22T14:30:00.000Z", "object_refs": [{"type": "vulnerability", "id": "cve-2015-5247"}], "objects": {"cve-2015-5247": {"type": "vulnerability", "id": "cve-2015-5247", "created_by_ref": "http://nvd.nist.gov", "modified": "2022-02-22T14:30:00.000Z", "name": "CVE-2015-5247", "description": "The virStorageVolCreateXML API in libvirt 1.2.14 through 1.2.19 allows remote authenticated users with a read-write connection to cause a denial of service (libvirtd crash) by triggering a failed unlink after creating a volume on a root_squash NFS pool.", "cvssV3": {"baseScore": 6.5, "baseSeverity": "MEDIUM", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"}, "cvssV2": {"baseScore": 4.0, "baseSeverity": "MEDIUM", "vectorString": "AV:N/AC:L/Au:S/C:N/I:N/A:P"}}, "t1203": {"type": "attack-pattern", "id": "t1203", "created_by_ref": "http://nvd.nist.gov", "modified": "2022-02-22T14:30:00.000Z", "name": "Denial of Service: Crashing a Service", "description": "The use of vulnerability CVE-2015-5247 by an attacker to crash the libvirtd service, which can be used to gain a foothold in the system or as a denial-of-service attack.", "kill_chain_phases": [{"id": "t1203", "name": "Phases"}]}, "t1027": {"type": "attack-pattern", "id": "t1027", "created_by_ref": "http://nvd.nist.gov", "modified": "2022-02-22T14:30:00.000Z", "name": "File and Directory Discovery", "description": "The use of vulnerability CVE-2015-5247 to create a volume on a root_squash NFS pool, which can be used to dump files or execute arbitrary code.", "kill_chain_phases": [{"id": "t1027", "name": "Phases"}]}, "t1499": {"type": "attack-pattern", "id": "t1499", "created_by_ref": "http://nvd.nist.gov", "modified": "2022-02-22T14:30:00.000Z", "name": "Service Disruption", "description": "The use of vulnerability CVE-2015-5247 to crash the libvirtd service, which can be used to disrupt operations or create a condition that allows for further exploitation.", "kill_chain_phases": [{"id": "t1499", "name": "Phases"}]}}, "relationships": [{"type": "related_to", "id": "cve-2015-5247", "object_ref": "t1203"}, {"type": "used_by", "id": "t1027", "object_ref": "cve-2015-5247"}, {"type": "used_by", "id": "t1499", "object_ref": "cve-2015-5247"}]}, "technical_analysis": {"Introduction": "The vulnerability CVE-2015-5247 is a remote authenticated vulnerability in the virStorageVolCreateXML API of libvirt 1.2.14 through 1.2.19. An attacker can exploit this vulnerability to crash the libvirtd service.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 6.5. The scope of the vulnerability is limited to systems running libvirt 1.2.14 through 1.2.19 with a read-write connection.", "Related MITRE ATT&CK Techniques": "T1203, T1027, T1499", "Technical Details": "The vulnerability is caused by a race condition in the virStorageVolCreateXML API, which allows an attacker to create a volume on a root_squash NFS pool and cause a denial of service.", "Detection": "Detection methods include monitoring system logs for crashes of the libvirtd service and monitoring network traffic for suspicious activity.", "Mitigation": "Mitigation strategies include updating to a version of libvirt that is not affected by the vulnerability, disabling the virStorageVolCreateXML API, and implementing a firewall rule to block traffic to the libvirtd service.", "Conclusion": "In conclusion, CVE-2015-5247 is a remote authenticated vulnerability that can be exploited to crash the libvirtd service. It is important to take steps to mitigate this vulnerability to prevent exploitation."}, "executive_analysis": {"Overview": "The vulnerability CVE-2015-5247 is a remote authenticated vulnerability in the virStorageVolCreateXML API of libvirt 1.2.14 through 1.2.19. It is important to take steps to mitigate this vulnerability to prevent exploitation and minimize the risk of disruption.", "Business Impact": "The business impact of this vulnerability is high, with potential disruptions to operations and financial losses.", "Technical Impact": "The technical impact of this vulnerability is high, with potential crashes of the libvirtd service and disruption of operations.", "Mitigation Strategies": "Strategies for mitigating this vulnerability include updating to a version of libvirt that is not affected by the vulnerability, disabling the virStorageVolCreateXML API, and implementing a firewall rule to block traffic to the libvirtd service.", "Recommendations": "Recommendations for executives include updating to a version of libvirt that is not affected by the vulnerability, disabling the virStorageVolCreateXML API, and implementing a firewall rule to block traffic to the libvirtd service.", "Conclusions": "In conclusion, it is important to take steps to mitigate this vulnerability to prevent exploitation and minimize the risk of disruption. This includes updating to a version of libvirt that is not affected by the vulnerability, disabling the virStorageVolCreateXML API, and implementing a firewall rule to block traffic to the libvirtd service."}}