{"id": "CVE-2009-3648", "sourceIdentifier": "cve@mitre.org", "published": "2009-10-09T14:30:00.420", "lastModified": "2017-08-17T01:31:13.477", "vulnStatus": "Modified", "cveTags": [], "evaluatorSolution": "Per: http://www.madirish.net/?article=251\r\n\r\n\r\nPatch\r\n\r\nApplying the following patch mitigates these threats.\r\n\r\n--- service_links/service_links.module\t2008-02-26 12:01:27.000000000 -0500\r\n+++ service_links/service_links.module\t2009-10-02 06:33:21.000000000 -0400\r\n@@ -35,11 +35,12 @@ function service_links_admin_settings() \r\n     '#title' => t('Where to show the service links'),\r\n     '#description' => t('Set the node types and categories you want to display links for.'),\r\n   );\r\n+  $names = array_map('filter_xss', node_get_types('names'));\r\n   $form['where_to_show_the_links']['service_links_node_types'] = array(\r\n     '#type' => 'checkboxes',\r\n     '#title' => t('Node types'),\r\n     '#default_value' => variable_get('service_links_node_types', array()),\r\n-    '#options' => node_get_types('names'),\r\n+    '#options' => $names,\r\n   );\r\n   if (module_exists('taxonomy')) {\r\n     $form['where_to_show_the_links']['service_links_category_types'] = array(\r\n", "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in Service Links 6.x-1.0, a module for Drupal, allows remote authenticated users, with 'administer content types' permissions, to inject arbitrary web script or HTML via unspecified vectors when displaying content type names."}, {"lang": "es", "value": "Una vulnerabilidad de ejecuci\u00f3n de secuencias de comandos en sitios cruzados (XSS) en el m\u00f3dulo de Drupal \"Service Links\" v6.x-1.0, permite inyectar HTML o scripts we aleatorios a usuarios remotos autenticados, con permisos para \"administrar tipos de contenido \", a trav\u00e9s de vectores no especificados cuando se muestran los nombres de tipo de contenido."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apsivam:service_links:6.x-1.0:*:*:*:*:*:*:*", "matchCriteriaId": "9DF61CB4-6946-493A-AB36-BF7DBBBE08BF"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:a:drupal:drupal:*:*:*:*:*:*:*:*", "matchCriteriaId": "799CA80B-F3FA-4183-A791-2071A7DA1E54"}]}]}], "references": [{"url": "http://www.madirish.net/?article=251", "source": "cve@mitre.org", "tags": ["Exploit", "Patch"]}, {"url": "http://www.securityfocus.com/bid/36584", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/53633", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2009-3648 - Cross-site scripting (XSS) vulnerability in Service Links 6.x-1.0 allows remote authenticated users with 'administer content types' permissions to inject arbitrary web script or HTML via unspecified vectors when displaying content type names. This demonstrates an attack vector in which an attacker could use a service such as a web-based application or website to inject malicious code into the system, potentially leading to the disclosure of sensitive information or unauthorized access to data."}, {"techniqueID": "T1190", "comment": "CVE-2009-3648 - The vulnerability in Service Links 6.x-1.0 allows an attacker to inject arbitrary web script or HTML via unspecified vectors when displaying content type names. This demonstrates an example of command and control (C2) communication, where an attacker could use the injected code to communicate with the compromised system and potentially control it."}, {"techniqueID": "T1508", "comment": "CVE-2009-3648 - The cross-site scripting (XSS) vulnerability in Service Links 6.x-1.0 allows an attacker to inject arbitrary web script or HTML via unspecified vectors when displaying content type names. This demonstrates an instance of web attack, where an attacker could use the injected code to gather sensitive information or perform malicious actions."}], "stix_bundle": {"objects": [{"id": " https://example.com/cve-2009-3648", "type": "vulnerability", "schema": "https://example.com/stix2.1", "name": "CVE-2009-3648", "description": "Cross-site scripting (XSS) vulnerability in Service Links 6.x-1.0 allows remote authenticated users with 'administer content types' permissions to inject arbitrary web script or HTML via unspecified vectors when displaying content type names.", "published": "2009-10-09T14:30:00.420", "modified": "2017-08-17T01:31:13.477", "cve_id": "CVE-2009-3648", "cve_url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3648", "risk_level": "MEDIUM", "vulnerability_score": 3.5, "attack_vector": "NETWORK", "cwe_id": "CWE-79", "cwe_url": "https://cwe.mitre.org/data/etc/cwe/CWE-79.html"}, {"id": "https://example.com/mitre-attack", "type": "attack-pattern", "schema": "https://example.com/stix2.1", "name": "T1059", "description": "Command and Control (C2) and Command and Control (C2) Communication.", "attack_pattern_type": "network", "attack_vector": "NETWORK", "privileges_required": "Authenticated User", "resource_level": "System", "network_ protocol": "TCP/IP"}, {"id": "https://example.com/mitre-attack-1", "type": "attack-pattern", "schema": "https://example.com/stix2.1", "name": "T1190", "description": "Post-exfiltration Action on Obtained Data.", "attack_pattern_type": "network", "attack_vector": "NETWORK", "privileges_required": "Authenticated User", "resource_level": "System", "network_ protocol": "TCP/IP"}, {"id": "https://example.com/mitre-attack-2", "type": "attack-pattern", "schema": "https://example.com/stix2.1", "name": "T1508", "description": "Web Attack: Cross-site Scripting.", "attack_pattern_type": "web", "attack_vector": "WEB", "privileges_required": "Authenticated User", "resource_level": "System", "web_protocol": "HTTP/HTTPS"}], "relationships": [{"id": "https://example.com/cve-2009-3648-Mitre-Attack-Relationship", "type": "has_attack_pattern", "source_node": "https://example.com/cve-2009-3648", "target_node": "https://example.com/mitre-attack", "relationship": "utilizes", "note": "CVE-2009-3648 utilizes the T1059 attack pattern, which demonstrates an attack vector in which an attacker could use a service such as a web-based application or website to inject malicious code into the system, potentially leading to the disclosure of sensitive information or unauthorized access to data."}, {"id": "https://example.com/cve-2009-3648-Mitre-Attack-Relationship-1", "type": "has_attack_pattern", "source_node": "https://example.com/cve-2009-3648", "target_node": "https://example.com/mitre-attack-1", "relationship": "utilizes", "note": "CVE-2009-3648 utilizes the T1190 attack pattern, which demonstrates an example of command and control (C2) communication, where an attacker could use the injected code to communicate with the compromised system and potentially control it."}, {"id": "https://example.com/cve-2009-3648-Mitre-Attack-Relationship-2", "type": "has_attack_pattern", "source_node": "https://example.com/cve-2009-3648", "target_node": "https://example.com/mitre-attack-2", "relationship": "utilizes", "note": "CVE-2009-3648 utilizes the T1508 attack pattern, which demonstrates an instance of web attack, where an attacker could use the injected code to gather sensitive information or perform malicious actions."}]}, "technical_analysis": {"Introduction": "The cross-site scripting (XSS) vulnerability in Service Links 6.x-1.0 (CVE-2009-3648) allows remote authenticated users with 'administer content types' permissions to inject arbitrary web script or HTML via unspecified vectors when displaying content type names.", "Impact and Scope": "The vulnerability has a CVSS score of 3.5, with an attack vector of NETWORK. It has a moderate risk level, as it can potentially lead to the disclosure of sensitive information or unauthorized access to data.", "Related MITRE ATT&CK Techniques": "The vulnerability utilizes the following MITRE ATT&CK techniques: T1059, T1190, and T1508.", "Technical Details": "The vulnerability allows an attacker to inject arbitrary web script or HTML via unspecified vectors when displaying content type names. This can be done by targeting the service links module in a Drupal instance, specifically in versions 6.x-1.0.", "Detection": "Detection of this vulnerability can be done by monitoring for suspicious network traffic and analyzing logs for signs of malicious activity. Additionally, penetration testing and vulnerability scanning can help identify potential vulnerabilities.", "Mitigation": "The vulnerability can be mitigated by patching the service links module in Drupal instances to version 6.x-1.1, which includes the fix for the vulnerability.", "Conclusion": "In conclusion, the cross-site scripting (XSS) vulnerability in Service Links 6.x-1.0 (CVE-2009-3648) is a significant security flaw that can potentially lead to the disclosure of sensitive information or unauthorized access to data. It is important to prioritize the patching of affected systems and to continue monitoring for suspicious activity."}, "executive_analysis": {"Overview": "The cross-site scripting (XSS) vulnerability in Service Links 6.x-1.0 (CVE-2009-3648) is a critical security issue that affects Drupal instances running the affected module.", "Business Impact": "The vulnerability can potentially lead to the disclosure of sensitive information or unauthorized access to data, which can result in financial losses, reputational damage, and legal liabilities.", "Technical Impact": "The vulnerability can be exploited to inject arbitrary web script or HTML into the system, allowing an attacker to control the compromised system and potentially access sensitive data.", "Mitigation Strategies": "The vulnerability can be mitigated by patching the service links module in Drupal instances to version 6.x-1.1, which includes the fix for the vulnerability.", "Recommendations": "We recommend that all affected systems be patched immediately to minimize the risk of exploitation. Additionally, penetration testing and vulnerability scanning should be performed regularly to identify potential vulnerabilities.", "Conclusions": "In conclusion, the cross-site scripting (XSS) vulnerability in Service Links 6.x-1.0 (CVE-2009-3648) is a critical security issue that requires immediate attention. We recommend that all affected systems be patched and that regular penetration testing and vulnerability scanning be performed to minimize the risk of exploitation."}}