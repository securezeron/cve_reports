{"id": "CVE-2009-4221", "sourceIdentifier": "cve@mitre.org", "published": "2009-12-07T17:30:00.453", "lastModified": "2017-08-17T01:31:29.537", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "SQL injection vulnerability in classified.php in phpBazar 2.1.1fix and earlier allows remote attackers to execute arbitrary SQL commands via the catid parameter, a different vector than CVE-2008-3767."}, {"lang": "es", "value": "Vulnerabilidad de inyecci\u00f3n SQL en classified.php en phpBazar v2.1.1fix y anterior permite a atacantes remotos ejecutar comandos SQL de su elecci\u00f3n a trav\u00e9s del par\u00e1metro catid, un vector diferente que CVE-2008-3767."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:smartisoft:phpbazar:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.1.1fix", "matchCriteriaId": "61F44A78-C3D3-4E36-B65D-DAB11B08C8BF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:smartisoft:phpbazar:2.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "03D850F2-66A0-4F0F-B946-E3300EF403EE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:smartisoft:phpbazar:2.1.0:*:*:*:*:*:*:*", "matchCriteriaId": "B5677BF8-F12C-4C81-92A2-6B9D3FB668BA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:smartisoft:phpbazar:2.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "A83EFFDF-EF57-4B41-907B-EC124118D512"}]}]}], "references": [{"url": "http://packetstormsecurity.org/0911-exploits/phpbazar211fix-sql.txt", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.exploit-db.com/exploits/10245", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.securityfocus.com/bid/37144", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/54447", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059.005", "comment": "CVE-2009-4221 - An attacker may abuse the SQL injection vulnerability to execute arbitrary SQL commands, which is a common technique used in web application attacks."}, {"techniqueID": "T1110", "comment": "CVE-2009-4221 - An attacker may exploit the vulnerability to gain unauthorized access to the database, which is a key step in a broader attack campaign."}, {"techniqueID": "T1047", "comment": "CVE-2009-4221 - An attacker may use the SQL injection vulnerability to gain access to sensitive data, which can be used to compromise the confidentiality, integrity, and availability of data."}, {"techniqueID": "T1190", "comment": "CVE-2009-4221 - An attacker may use the vulnerability to execute arbitrary system commands, which can allow them to elevate privileges and achieve persistence."}, {"techniqueID": "T1567.002", "comment": "CVE-2009-4221 - An attacker may use the SQL injection vulnerability to execute arbitrary SQL commands, which can be used to disrupt or destroy data."}, {"techniqueID": "T1036", "comment": "CVE-2009-4221 - An attacker may use the vulnerability to move laterally within the network, which can allow them to gain access to additional systems and data."}], "stix_bundle": {"type": "course-of-action", "name": "CVE-2009-4221 Defense Bundle", "description": "Defense bundle for CVE-2009-4221", "relationships": [{"type": "related-to", "object": {"type": "vulnerability", "id": "CVE-2009-4221"}, "to": true}, {"type": "mitigates", "object": {"type": "technique", " technik": "T1059.005"}}], "objects": [{"type": "course-of-action", "id": "Defense-1", "name": "Update PHPBazar to version 2.1.2", "description": "Update PHPBazar to version 2.1.2 to prevent exploitation of the SQL injection vulnerability"}, {"type": "course-of-action", "id": "Defense-2", "name": "Disable classified.php", "description": "Disable classified.php to prevent exploitation of the SQL injection vulnerability"}]}, "technical_analysis": {"Introduction": "The vulnerability CVE-2009-4221 is a SQL injection vulnerability in phpBazar 2.1.1fix and earlier, which allows remote attackers to execute arbitrary SQL commands.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 and an attack vector of NETWORK, and it is highly exploitable, making it a critical vulnerability.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK Techniques, including T1059.005, T1110, T1047, T1190, and T1567.002.", "Technical Details": "The vulnerability occurs when the classified.php script in phpBazar does not properly sanitize user input, allowing an attacker to inject malicious SQL code.", "Detection": "Detection can be done by monitoring database logs for suspicious activity, and by performing regular security audits and vulnerability scans.", "Mitigation": "Mitigation strategies include updating PHPBazar to version 2.1.2, disabling classified.php, and implementing input validation and sanitization.", "Conclusion": "In conclusion, the vulnerability CVE-2009-4221 is a critical web application vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The vulnerability CVE-2009-4221 is a critical web application vulnerability that exists in phpBazar 2.1.1fix and earlier.", "Business Impact": "The vulnerability can allow attackers to gain unauthorized access to sensitive data, which can result in severe business and reputational damage.", "Technical Impact": "The vulnerability can allow attackers to execute arbitrary SQL commands, which can result in the theft or destruction of data, or disruption of business operations.", "Mitigation Strategies": "The mitigation strategies include updating PHPBazar to version 2.1.2, disabling classified.php, and implementing input validation and sanitization.", "Recommendations": "We recommend that you update your PHPBazar installations to version 2.1.2 as soon as possible, and that you conduct regular security audits and vulnerability scans to identify and remediate potential vulnerabilities.", "Conclusions": "In conclusion, the vulnerability CVE-2009-4221 is a critical vulnerability that requires immediate attention and mitigation. We recommend that you take immediate action to protect your systems and data."}}