{"id": "CVE-2007-2166", "sourceIdentifier": "cve@mitre.org", "published": "2007-04-22T19:19:00.000", "lastModified": "2017-10-11T01:32:06.923", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHP remote file inclusion vulnerability in administration/user/lib/group.inc.php in OpenSurveyPilot (osp) 1.2.1 and earlier allows remote attackers to execute arbitrary PHP code via a URL in the cfgPathToProjectAdmin parameter."}, {"lang": "es", "value": "Vulnerabilidad de inclusi\u00f3n remota de archivo en PHP en administration/user/lib/group.inc.php de OpenSurveyPilot (osp) 1.2.1 y anteriores permite a atacantes remotos ejecutar c\u00f3digo de su elecci\u00f3n en PHP a trav\u00e9s de una URL en el par\u00e1metro cfgPathToProjectAdmin."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:opensurveypilot:opensurveypilot:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.2.1", "matchCriteriaId": "C0E3B8CF-64B6-41D0-8295-9131B388A058"}]}]}], "references": [{"url": "http://osp.cvs.sourceforge.net/osp/osp12/administration/user/lib/group.inc.php?revision=1.1.1.1&view=markup", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/35022", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/24915", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/23563", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/1460", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/33749", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/3765", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": " Spearphishing Attachment - The attacker can leverage this vulnerability to gain initial access by sending a malicious attachment to a user. This can be mitigated by implementing email filtering and monitoring systems, and educating users on the importance of verifying attachments before opening them."}, {"techniqueID": "T1194", "comment": "Content Injection - The attacker can exploit this vulnerability to inject malicious content into the targeted system. This can be mitigated by implementing Content Security Policy (CSP) and validating all user-uploaded content."}, {"techniqueID": "T1204", "comment": "Email Collection - The attacker can use this vulnerability to collect email addresses or other sensitive information from the targeted system. This can be mitigated by implementing email notification and alert systems, and configuring email clients to block suspicious incoming emails."}], "stix_bundle": {"id": "https://example.com/vulnerability/cve-2007-2166", "type": "indicator", "created_by_REF": "https://example.com/organisation", "created": "2023-02-16T14:30:00.000Z", "modified": "2023-02-16T14:30:00.000Z", "name": "OpenSurveyPilot (Osp) Remote File Inclusion Vulnerability (CVE-2007-2166)", "description": "A remote file inclusion vulnerability in OpenSurveyPilot (Osp) 1.2.1 and earlier allows remote attackers to execute arbitrary PHP code via a URL in the cfgPathToProjectAdmin parameter.", "granular_markings": [{"type": "cve", "id": "CVE-2007-2166"}], "object_marking_refs": [{"id": "https://example.com/markings/Marking_123", "type": "marking-definition"}], "object_refs": [{"id": "https://example.com/vulnerability/cve-2007-2166-vuln", "type": "vulnerability"}], "relationships": [{"type": "indicates", "from": "https://example.com/vulnerability/cve-2007-2166", "to": "https://example.com/technique/T1190"}, {"type": "indicates", "from": "https://example.com/vulnerability/cve-2007-2166", "to": "https://example.com/technique/T1194"}, {"type": "indicates", "from": "https://example.com/vulnerability/cve-2007-2166", "to": "https://example.com/technique/T1204"}]}, "technical_analysis": {"Introduction": "The OpenSurveyPilot (Osp) remote file inclusion vulnerability (CVE-2007-2166) is a severe vulnerability that allows remote attackers to execute arbitrary PHP code. This vulnerability affects OpenSurveyPilot versions 1.2.1 and earlier.", "Impact and Scope": "The impact of this vulnerability is significant, as it allows attackers to execute arbitrary PHP code, which can lead to further exploitation. The attack vector is network-based, and the vulnerability can be exploited by sending a specially crafted URL to the affected system.", "Related MITRE ATT&CK Techniques": "The MITRE ATT&CK techniques T1190, T1194, and T1204 are related to this vulnerability.", "Technical Details": "The vulnerability occurs due to a remote file inclusion vulnerability in the administration/user/lib/group.inc.php file of OpenSurveyPilot. This file contains a parameter named cfgPathToProjectAdmin, which can be manipulated to include an arbitrary PHP file.", "Detection": "Detection methods include monitoring for unusual network traffic patterns, analyzing system logs for suspicious activity, and implementing security information and event management (SIEM) systems.", "Mitigation": "Mitigation strategies include updating OpenSurveyPilot to the latest version, disabling remote file inclusion, and implementing security measures to prevent unauthorized access.", "Conclusion": "In conclusion, the OpenSurveyPilot remote file inclusion vulnerability is a significant vulnerability that requires immediate attention. Implementing the recommended mitigation strategies and performing regular security audits are essential for protecting against this vulnerability."}, "executive_analysis": {"Overview": "The OpenSurveyPilot remote file inclusion vulnerability (CVE-2007-2166) is a severe vulnerability that poses a significant risk to organizations using OpenSurveyPilot. This vulnerability can lead to remote code execution and data theft.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to loss of confidential data, reputational damage, and financial loss.", "Technical Impact": "The technical impact of this vulnerability is severe, as it allows attackers to execute arbitrary PHP code, which can lead to further exploitation.", "Mitigation Strategies": "The recommended mitigation strategies include updating OpenSurveyPilot to the latest version, disabling remote file inclusion, and implementing security measures to prevent unauthorized access.", "Recommendations": "We recommend that all organizations using OpenSurveyPilot update to the latest version and implement security measures to prevent unauthorized access.", "Conclusions": "In conclusion, the OpenSurveyPilot remote file inclusion vulnerability is a significant vulnerability that requires immediate attention. Implementing the recommended mitigation strategies and performing regular security audits are essential for protecting against this vulnerability."}}