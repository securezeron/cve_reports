{"id": "CVE-2009-3660", "sourceIdentifier": "cve@mitre.org", "published": "2009-10-11T22:30:00.467", "lastModified": "2017-09-19T01:29:42.937", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHP remote file inclusion vulnerability in libraries/database.php in Efront 3.5.4 and earlier, when register_globals is enabled, allows remote attackers to execute arbitrary PHP code via a URL in the path parameter.  NOTE: this is only a vulnerability when the administrator does not follow recommendations in the product's security documentation."}, {"lang": "es", "value": "Vulnerabilidad de inclusi\u00f3n remota de archivos PHP en libraries/database.php en Efront v3.5.4 y anteriores, cuando register_globals est\u00e1 activado, permite a atacantes remotos ejecutar c\u00f3digo PHP arbitrario a trav\u00e9s de una URL en el par\u00e1metro \"path\". NOTA: esto es s\u00f3lo una vulnerabilidad cuando el administrador no sigue las recomendaciones de seguridad en la documentaci\u00f3n del producto."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:efrontlearning:efront:*:*:*:*:*:*:*:*", "versionEndIncluding": "3.5.4", "matchCriteriaId": "136730A5-4699-4292-89DF-AB19E8081FA6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:efrontlearning:efront:3.1.0:*:*:*:*:*:*:*", "matchCriteriaId": "DC4945EB-C2DC-41FB-8B49-8F27D1EBF19E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:efrontlearning:efront:3.1.2:*:*:*:*:*:*:*", "matchCriteriaId": "9648CD63-D34E-4298-8D54-2FF72C257477"}, {"vulnerable": true, "criteria": "cpe:2.3:a:efrontlearning:efront:3.1.3:*:*:*:*:*:*:*", "matchCriteriaId": "E993440A-7730-4540-B6BC-5CFC1636FE0C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:efrontlearning:efront:3.1.4:*:*:*:*:*:*:*", "matchCriteriaId": "B9A7A13D-A022-49A0-BED7-701D333724B5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:efrontlearning:efront:3.5.0:*:*:*:*:*:*:*", "matchCriteriaId": "8802C5D3-64CD-4199-ABBC-F5AEE5AFDE46"}, {"vulnerable": true, "criteria": "cpe:2.3:a:efrontlearning:efront:3.5.0:beta1:*:*:*:*:*:*", "matchCriteriaId": "BD62DC8C-619B-4B61-AFAC-B7F6AFCBEB79"}, {"vulnerable": true, "criteria": "cpe:2.3:a:efrontlearning:efront:3.5.0:beta2:*:*:*:*:*:*", "matchCriteriaId": "A230995D-9925-4774-9CFC-4329F756EE36"}, {"vulnerable": true, "criteria": "cpe:2.3:a:efrontlearning:efront:3.5.0:beta3:*:*:*:*:*:*", "matchCriteriaId": "395AFAEC-9811-4CB8-A105-AB9B9C85DA68"}, {"vulnerable": true, "criteria": "cpe:2.3:a:efrontlearning:efront:3.5.0:beta4:*:*:*:*:*:*", "matchCriteriaId": "E7699ABE-E6AB-490F-9D1E-34F1EE2467B6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:efrontlearning:efront:3.5.1:*:*:*:*:*:*:*", "matchCriteriaId": "964B61AA-BB5B-4B19-8077-0AD5415D4788"}]}]}], "references": [{"url": "http://forum.efrontlearning.net/viewtopic.php?f=1&t=1354&p=7174#p7174", "source": "cve@mitre.org"}, {"url": "http://www.exploit-db.com/exploits/9681", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/36411", "source": "cve@mitre.org", "tags": ["Exploit", "Patch"]}], "techniques": [{"techniqueID": "T1059.007", "comment": "CVE-2009-3660 - Remote File Inclusion vulnerability allows attackers to execute arbitrary PHP code by exploiting the inclusion of a PHP file through the path parameter. This technique can be used to deliver malware or escalate privileges. Defend against this by implementing proper input validation and sanitization, as well as using a Web Application Firewall (WAF) to detect and block suspicious traffic."}, {"techniqueID": "T1190", "comment": "CVE-2009-3660 - The vulnerability can be exploited by attackers to upload and execute arbitrary files. Defend against this by implementing proper file upload validation and sanitization, as well as using a File Integrity Monitor to detect and alert on suspicious changes to system files."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2009-3660", "created_by": "MITRE", "created": "2009-10-11T22:30:00.467", "first_published_at": "2009-10-11T22:30:00.467", "last_updated_at": "2017-09-19T01:29:42.937", "description": "PHP remote file inclusion vulnerability in libraries/database.php in Efront 3.5.4 and earlier, when register_globals is enabled, allows remote attackers to execute arbitrary PHP code via a URL in the path parameter.", "attributes": {"name": "Efront 3.5.4 File Inclusion Vulnerability", "description": "PHP remote file inclusion vulnerability in libraries/database.php in Efront 3.5.4 and earlier, when register_globals is enabled, allows remote attackers to execute arbitrary PHP code via a URL in the path parameter.", "exploit_status": "Verified", "severity": "Medium"}}, {"type": "course-of-action", "id": "COA-1", "related_object": "CVE-2009-3660", "description": "Implement proper input validation and sanitization to prevent remote file inclusion attacks.", "mitigated_by": "MITRE Technique T1059.007"}, {"type": "course-of-action", "id": "COA-2", "related_object": "CVE-2009-3660", "description": "Use a Web Application Firewall (WAF) to detect and block suspicious traffic.", "mitigated_by": "MITRE Technique T1059.007"}, {"type": "note", "id": "N-1", "related_object": "CVE-2009-3660", "note": "Defenders can also implement file upload validation and sanitization to prevent arbitrary file uploads and execution."}], "relationships": [{"from": "CVE-2009-3660", "to": "COA-1", "type": "mitigated_by"}, {"from": "CVE-2009-3660", "to": "COA-2", "type": "mitigated_by"}, {"from": "COA-1", "to": "N-1", "type": "notes"}]}, "technical_analysis": {"Introduction": "The CVE-2009-3660 vulnerability is a remote file inclusion vulnerability in the Efront 3.5.4 and earlier PHP application.", "Impact and Scope": "The vulnerability allows attackers to execute arbitrary PHP code via a URL in the path parameter, which can lead to data breaches, privilege escalation, and system compromise. The CVSS score for this vulnerability is 6.8, with a medium severity rating.", "Related MITRE ATT&CK Techniques": "T1059.007 and T1190", "Technical Details": "The vulnerability occurs when the PHP application includes a PHP file through the path parameter without proper validation, allowing attackers to inject malicious code.", "Detection": "Defenders can detect this vulnerability by monitoring the web application logs for suspicious URL requests or file uploads.", "Mitigation": "Implement proper input validation and sanitization, use a WAF to detect and block suspicious traffic, and use a File Integrity Monitor to detect and alert on suspicious changes to system files.", "Conclusion": "The CVE-2009-3660 vulnerability is a significant risk to PHP applications and requires immediate attention to mitigate the risk of attack."}, "executive_analysis": {"Overview": "The CVE-2009-3660 vulnerability is a remote file inclusion vulnerability in the Efront 3.5.4 and earlier PHP application.", "Business Impact": "The vulnerability can lead to data breaches, privilege escalation, and system compromise, which can result in significant financial and reputational losses.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary PHP code, which can lead to system compromise and privilege escalation.", "Mitigation Strategies": "Implement proper input validation and sanitization, use a WAF to detect and block suspicious traffic, and use a File Integrity Monitor to detect and alert on suspicious changes to system files.", "Recommendations": "Immediately patch the vulnerability, implement proper security controls, and conduct regular vulnerability assessments.", "Conclusions": "The CVE-2009-3660 vulnerability is a critical risk to PHP applications and requires immediate attention to mitigate the risk of attack."}}