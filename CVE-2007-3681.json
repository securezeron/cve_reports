{"id": "CVE-2007-3681", "sourceIdentifier": "cve@mitre.org", "published": "2007-07-11T17:30:00.000", "lastModified": "2018-10-15T21:29:50.300", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The IOCTL 9031 (BIOCGSTATS) handler in the NPF.SYS device driver in WinPcap before 4.0.1 allows local users to overwrite memory and execute arbitrary code via malformed Interrupt Request Packet (Irp) parameters."}, {"lang": "es", "value": "El manejador IOCTL 9031 (BIOCGSTATS) del dispositivo controlador NPF.SYS en el WinPcap anterior al 4.0.1 permite a usuarios locales sobrescribir la memoria y ejecutar c\u00f3digo de su elecci\u00f3n a trav\u00e9s de par\u00e1metros Interrupt Request Packet (Irp) mal formados."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:S/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.6}, "baseSeverity": "MEDIUM", "exploitabilityScore": 2.7, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:winpcap:winpcap:3.1:*:*:*:*:*:*:*", "matchCriteriaId": "E6238750-894A-4C83-9686-86364ADCF971"}, {"vulnerable": true, "criteria": "cpe:2.3:a:winpcap:winpcap:4.0:*:*:*:*:*:*:*", "matchCriteriaId": "AB92E2F4-FAB4-4E79-9EA3-BF3023898EC8"}]}]}], "references": [{"url": "http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=550", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/37889", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/25982", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://securitytracker.com/id?1018350", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/473270/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/473297/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/473301/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/24829", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://www.vupen.com/english/advisories/2007/2468", "source": "cve@mitre.org"}, {"url": "http://www.winpcap.org/misc/changelog.htm", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/35309", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/4165", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1133 - Exploitation of Remote Services", "comment": "CVE-2007-3681 - This vulnerability can be exploited by sending malformed Interrupt Request Packet (Irp) parameters, which can lead to the execution of arbitrary code. This is a remote exploitation technique that can be used to gain access to the system."}, {"techniqueID": "T1194 - Exploitation Through Service Attacks", "comment": "CVE-2007-3681 - This vulnerability can be exploited by sending malformed Interrupt Request Packet (Irp) parameters to the NPF.SYS device driver, which can lead to the execution of arbitrary code. This is a service attack that can be used to gain access to the system."}, {"techniqueID": "T1210 - Exploitation of Remote Code Execution", "comment": "CVE-2007-3681 - This vulnerability can be exploited by sending malformed Interrupt Request Packet (Irp) parameters, which can lead to the execution of arbitrary code. This is a remote code execution technique that can be used to gain access to the system."}, {"techniqueID": "T1197 - Exploitation Through Connection to the System", "comment": "CVE-2007-3681 - This vulnerability can be exploited by sending malformed Interrupt Request Packet (Irp) parameters to the NPF.SYS device driver, which can lead to the execution of arbitrary code. This is a connection-based attack that can be used to gain access to the system."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "bundle--6a944d21-4fe3-43c7-9f44-d2c31d98e6a2", "created_by_ref": "https://json.crowdstrike.com/users/123456", "objects": [{"type": "vulnerability", "id": "vulnerability--f3c3c6f4-4415-4a46-a4f4-e5b73f7d3a95", "created_by_ref": "https://json.crowdstrike.com/users/123456", "name": "CVE-2007-3681", "description": "The IOCTL 9031 (BIOCGSTATS) handler in the NPF.SYS device driver in WinPcap before 4.0.1 allows local users to overwrite memory and execute arbitrary code via malformed Interrupt Request Packet (Irp) parameters.", "objects": [{"type": "endpoint", "id": "endpoint--5dd93fe6-faa4-4a44-87ce-d44b6a3e4b7a", "created_by_ref": "https://json.crowdstrike.com/users/123456", "name": "Endpoint 1", "description": "Endpoint 1 is vulnerable to CVE-2007-3681."}, {"type": "technique", "id": "technique--5ec94a1a-a55f-4462-b5c5-93a464e4bc83", "created_by_ref": "https://json.crowdstrike.com/users/123456", "name": "T1194 - Exploitation Through Service Attacks", "description": "T1194 is a technique used to exploit CVE-2007-3681."}], "relationship": {"type": "relates", "id": "relationship--5ec94a1a-a55f-4462-b5c5-93a464e4bc83", "created_by_ref": "https://json.crowdstrike.com/users/123456", "start": "2022-02-22T14:30:00.000Z", "end": "2022-02-22T14:30:00.000Z", "notes": ["This relationship represents the connection between CVE-2007-3681 and the T1194 technique."]}}]}}, "technical_analysis": {"Introduction": "CVE-2007-3681 is a remote code execution vulnerability in the WinPcap NPF.SYS device driver that allows attackers to execute arbitrary code on the system.", "Impact and Scope": "The vulnerability has a CVSS score of 6.6 and affects WinPcap versions 3.1 and 4.0 before 4.0.1.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including T1133, T1194, T1210, and T1197.", "Technical Details": "The vulnerability occurs when the NPF.SYS device driver processes a malformed Interrupt Request Packet (Irp) parameter, which can lead to arbitrary code execution.", "Detection": "Detection can be performed using endpoint detection and response systems, as well as network traffic monitoring tools.", "Mitigation": "Mitigation can be performed by applying the patch from WinPcap version 4.0.1 or later, as well as implementing network segmentation and access controls.", "Conclusion": "In conclusion, CVE-2007-3681 is a significant remote code execution vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2007-3681 is a remote code execution vulnerability in the WinPcap NPF.SYS device driver that poses significant risks to the organization's system and data.", "Business Impact": "The vulnerability could lead to unauthorized access, data theft, and reputational damage.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary code on the system, leading to potential data breaches and system compromise.", "Mitigation Strategies": "Apply the patch from WinPcap version 4.0.1 or later, and implement network segmentation and access controls.", "Recommendations": "Prioritize patching, implement network segmentation, and conduct regular security audits and risk assessments.", "Conclusions": "In conclusion, CVE-2007-3681 is a critical vulnerability that requires immediate attention and mitigation to ensure the organization's security and compliance."}}