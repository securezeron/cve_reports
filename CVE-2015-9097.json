{"id": "CVE-2015-9097", "sourceIdentifier": "cve@mitre.org", "published": "2017-06-12T20:29:00.237", "lastModified": "2017-07-05T16:43:21.987", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The mail gem before 2.5.5 for Ruby (aka A Really Ruby Mail Library) is vulnerable to SMTP command injection via CRLF sequences in a RCPT TO or MAIL FROM command, as demonstrated by CRLF sequences immediately before and after a DATA substring."}, {"lang": "es", "value": "La mail gem versiones anteriores a 2.5.5 para Ruby (tambi\u00e9n conocida como A Really Ruby Mail Library) es vulnerable a inyecci\u00f3n de comandos SMTP mediante secuencias CRLF con el comando RCPT TO o MAIL FROM, como lo demuestran las secuencias CRLF inmediatamente antes y despu\u00e9s de una subcadena DATA."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-93"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mail_project:mail:*:*:*:*:*:ruby:*:*", "versionEndIncluding": "2.5.4", "matchCriteriaId": "99D6663F-F6E8-4892-8DD4-AAEECBEF6329"}]}]}], "references": [{"url": "http://openwall.com/lists/oss-security/2015/12/11/3", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.mbsd.jp/Whitepaper/smtpi.pdf", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/mikel/mail/commit/72befdc4dab3e6e288ce226a7da2aa474cf5be83", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/mikel/mail/pull/1097", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/rubysec/ruby-advisory-db/issues/215", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://hackerone.com/reports/137631", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://rubysec.com/advisories/mail-OSVDB-131677", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2015-9097 - Mail Command Injection, allows an attacker to inject malicious commands into the mail server, compromising the confidentiality, integrity, and availability of data. This can be mitigated by validating all input data and limiting the commands that can be executed by the mail server."}, {"techniqueID": "T1075", "comment": "CVE-2015-9097 - Command Injection, allows an attacker to inject malicious commands into the mail server, compromising the confidentiality, integrity, and availability of data. This can be mitigated by validating all input data and limiting the commands that can be executed by the mail server."}, {"techniqueID": "T1196", "comment": "CVE-2015-9097 - Email Command Injection, allows an attacker to inject malicious commands into the mail server, compromising the confidentiality, integrity, and availability of data. This can be mitigated by validating all input data and limiting the commands that can be executed by the mail server."}], "stix_bundle": {"Bundle": {"id": "CVE-2015-9097", "type": "bundle", "created_by_ref": "cve@mitre.org", "objects": [{"id": "CVE-2015-9097", "type": "incident", "created_by_ref": "cve@mitre.org", "title": "SMTP Command Injection in mail gem", "description": "SMTP command injection vulnerability in the mail gem", "modified": "2017-06-12T20:29:00.237", "vulnerability": {"id": "CVE-2015-9097", "type": "vulnerability", "description": "SMTP command injection vulnerability in the mail gem"}, "exploit": {"id": "CVE-2015-9097", "type": "exploit", "description": "SMTP command injection exploit for the mail gem"}}, {"id": "Mail Command Injection", "type": "attack-pattern", "title": "Mail Command Injection", "description": "Mail Command Injection is a technique used to inject malicious commands into a mail server", "created_by_ref": "cve@mitre.org", "modified": "2017-06-12T20:29:00.237", "relationship": {"type": "related", "to_leader": "CVE-2015-9097", "to_member": "Mail Command Injection"}}, {"id": "Command Injection", "type": "attack-pattern", "title": "Command Injection", "description": "Command Injection is a technique used to inject malicious commands into a system", "created_by_ref": "cve@mitre.org", "modified": "2017-06-12T20:29:00.237", "relationship": {"type": "related", "to_leader": "CVE-2015-9097", "to_member": "Command Injection"}}, {"id": "Email Command Injection", "type": "attack-pattern", "title": "Email Command Injection", "description": "Email Command Injection is a technique used to inject malicious commands into an email server", "created_by_ref": "cve@mitre.org", "modified": "2017-06-12T20:29:00.237", "relationship": {"type": "related", "to_leader": "CVE-2015-9097", "to_member": "Email Command Injection"}}]}}, "technical_analysis": {"Introduction": "CVE-2015-9097 is a vulnerability in the mail gem that allows an attacker to inject malicious commands into the mail server.", "Impact and Scope": "The vulnerability has a CVSS score of 6.1, with a CVSS vector of CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N. This indicates that it is a medium-severity vulnerability with a network access vector, low attack complexity, and a required user interaction.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1075, and T1196.", "Technical Details": "The vulnerability is caused by a lack of input validation in the mail gem, which allows an attacker to inject malicious commands into the mail server.", "Detection": "The vulnerability can be detected by monitoring for unusual network traffic patterns and auditing system logs for suspicious activity.", "Mitigation": "The vulnerability can be mitigated by validating all input data and limiting the commands that can be executed by the mail server.", "Conclusion": "In conclusion, CVE-2015-9097 is a vulnerability in the mail gem that allows an attacker to inject malicious commands into the mail server. The vulnerability is of medium severity and can be mitigated by validating all input data and limiting the commands that can be executed by the mail server."}, "executive_analysis": {"Overview": "CVE-2015-9097 is a vulnerability in the mail gem that allows an attacker to inject malicious commands into the mail server.", "Business Impact": "The vulnerability can cause a disruption to business operations and could result in the loss of sensitive information.", "Technical Impact": "The vulnerability can be exploited by an attacker to gain access to the mail server and steal sensitive information.", "Mitigation Strategies": "The vulnerability can be mitigated by validating all input data and limiting the commands that can be executed by the mail server.", "Recommendations": "Recommendations include implementing input validation and limiting the commands that can be executed by the mail server.", "Conclusions": "In conclusion, CVE-2015-9097 is a vulnerability in the mail gem that allows an attacker to inject malicious commands into the mail server. The vulnerability is of medium severity and can be mitigated by implementing input validation and limiting the commands that can be executed by the mail server."}}