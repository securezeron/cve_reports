{"id": "CVE-2007-4485", "sourceIdentifier": "cve@mitre.org", "published": "2007-08-22T23:17:00.000", "lastModified": "2018-10-15T21:35:45.933", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHP remote file inclusion vulnerability in visitor.php in Butterfly online visitors counter 1.08, when used with certain older versions of PHP with improper SERVER superglobal handling, allows remote attackers to execute arbitrary PHP code via a URL in the _SERVER[DOCUMENT_ROOT] parameter.  NOTE: it could be argued that this vulnerability is caused by a problem in PHP and the proper fix should be in PHP; if so, then this should not be treated as a vulnerability in Butterfly online visitors counter."}, {"lang": "es", "value": "Vulnerabilidad de inclusi\u00f3n remota de archivo en PHP en visitor.php de Butterfly online visitors counter 1.08, al ser utilizado con ciertas versiones antiguas de PHP que no manejan adecuadamente la superglobal SERVER, permite a atacantes remotos ejecutar c\u00f3digo PHP de su elecci\u00f3n mediante un URL en el par\u00e1metro _SERVER[DOCUMENT_ROOT]. NOTA: se podr\u00eda argumentar que esta vulnerabilidad es causada por un problema en PHP y el parche adecuado deber\u00eda estar en PHP; en este caso, entonces no deber\u00eda tratarse como una vulnerabilidad en Butterfly online visitors counter."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:butterfly:butterfly:1.08:*:*:*:*:*:*:*", "matchCriteriaId": "D759E359-E8FF-4271-A607-2D4C96E8107A"}]}]}], "references": [{"url": "http://osvdb.org/38327", "source": "cve@mitre.org"}, {"url": "http://securityvulns.com/Rdocument845.html", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://securityvulns.com/source26994.html", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/477253/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/482006/100/0/threaded", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/36147", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "The vulnerability in Butterfly online visitors counter 1.08 allows an attacker to remotely include arbitrary PHP code, making it a potential entry point for attackers. Defending against this technique requires implementing proper input validation and sanitization to prevent code injection attacks."}, {"techniqueID": "T1191", "comment": "The vulnerable version of PHP, used with Butterfly online visitors counter 1.08, allows an attacker to access the server's document root, making it a potential entry point for attackers. Defending against this technique requires updating to a patched version of PHP or implementing a web application firewall to block malicious requests."}, {"techniqueID": "T1086", "comment": "The vulnerability in Butterfly online visitors counter 1.08 allows an attacker to access the server's document root, making it a potential entry point for attackers. Defending against this technique requires implementing proper access controls and least privilege principles to limit the impact of a potential attack."}], "stix_bundle": {"vulnerability": {"id": "CVE-2007-4485", "name": "PHP remote file inclusion vulnerability in visitor.php", "description": "A remote file inclusion vulnerability in visitor.php in Butterfly online visitors counter 1.08, when used with certain older versions of PHP with improper SERVER superglobal handling, allows remote attackers to execute arbitrary PHP code via a URL in the _SERVER[DOCUMENT_ROOT] parameter."}, "threat_actor": [{"id": "TA0007", "name": "Unaffiliated Hacking Group", "description": "An unaffiliated hacking group that targets low-hanging fruit to gain credibility and reputation."}], "malware": [{"id": "MALWARE-1", "name": "PHP Shell", "description": "A basic PHP shell that allows an attacker to interact with the system and execute arbitrary PHP code."}], "attack_pattern": [{"id": "AP-1", "name": "PHP Remote File Inclusion Attack", "description": "An attack pattern that leverages the PHP remote file inclusion vulnerability in visitor.php to execute arbitrary PHP code."}], "course_of_action": [{"id": "COA-1", "name": "Update PHP to a Patched Version", "description": "One of the courses of action to mitigate the vulnerability is to update the version of PHP to a patched version to prevent attacks.", "mitigates": "T1191"}, {"id": "COA-2", "name": "Implement Web Application Firewall", "description": "Another course of action to mitigate the vulnerability is to implement a web application firewall to block malicious requests.", "mitigates": "T1191"}], "note": [{"id": "NOTE-1", "value": "The vulnerability in Butterfly online visitors counter 1.08 is often exploited by unaffiliated hacking groups to gain credibility and reputation."}]}, "technical_analysis": {"Introduction": "The vulnerability in Butterfly online visitors counter 1.08 allows an attacker to remotely include arbitrary PHP code, making it a potential entry point for attackers.", "Impact and Scope": "The vulnerability has a CVSS score of 6.8 with a version of 2.0, and an attack vector of NETWORK. It allows an attacker to execute arbitrary PHP code, which can lead to unauthorized data manipulation, data exfiltration, and denial of service.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1191, and T1086.", "Technical Details": "The vulnerability is caused by improper SERVER superglobal handling in visitor.php, which allows an attacker to include arbitrary PHP code. The vulnerability can be exploited by sending a specially crafted URL to the vulnerable system.", "Detection": "The vulnerability can be detected by monitoring system logs for unusual PHP code execution requests. Additionally, vulnerability scanners can be used to identify the vulnerable version of PHP and visitor.php.", "Mitigation": "The vulnerability can be mitigated by updating the version of PHP to a patched version, implementing a web application firewall, and implementing proper input validation and sanitization to prevent code injection attacks.", "Conclusion": "The vulnerability in Butterfly online visitors counter 1.08 is a significant security risk that requires immediate attention. Updating the version of PHP to a patched version and implementing proper input validation and sanitization can help mitigate the vulnerability."}, "executive_analysis": {"Overview": "The vulnerability in Butterfly online visitors counter 1.08 is a critical security risk that requires immediate attention.", "Business Impact": "The vulnerability can lead to unauthorized data manipulation, data exfiltration, and denial of service, which can result in significant financial losses and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary PHP code, which can result in system compromise and data theft.", "Mitigation Strategies": "The mitigation strategies for the vulnerability include updating the version of PHP to a patched version, implementing a web application firewall, and implementing proper input validation and sanitization to prevent code injection attacks.", "Recommendations": "Recommendations for executives include prioritizing the remediation of the vulnerability, implementing additional security measures to protect against future attacks, and conducting regular security audits and vulnerability assessments.", "Conclusions": "The vulnerability in Butterfly online visitors counter 1.08 is a serious security risk that requires immediate attention. Executives should take immediate action to remediate the vulnerability and implement additional security measures to protect against future attacks."}}