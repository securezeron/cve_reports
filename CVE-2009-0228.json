{"id": "CVE-2009-0228", "sourceIdentifier": "secure@microsoft.com", "published": "2009-06-10T18:00:00.217", "lastModified": "2018-10-12T21:50:15.487", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Stack-based buffer overflow in the EnumeratePrintShares function in Windows Print Spooler Service (win32spl.dll) in Microsoft Windows 2000 SP4 allows remote printer servers to execute arbitrary code via a crafted ShareName in a response to an RPC request, related to \"printing data structures,\" aka \"Buffer Overflow in Print Spooler Vulnerability.\""}, {"lang": "es", "value": "Desbordamiento de buffer basado en pila en la funci\u00f3n EnumeratePrintShares en Windows Print Spooler Service (win32spl.dll) en Microsoft Windows 2000 SP4 permite a servidores de impresi\u00f3n remotos ejecutar c\u00f3digo arbitrario a trav\u00e9s de un ShareName manipulado en respuesta a una petici\u00f3n RPC, relacionado con \"estructuras de datos impresos\", tambi\u00e9n conocido como \"Buffer Overflow in Print Spooler Vulnerability.\""}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_2000:*:sp4:*:*:*:*:*:*", "matchCriteriaId": "83E7C4A0-78CF-4B56-82BF-EC932BDD8ADF"}]}]}], "references": [{"url": "http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=806", "source": "secure@microsoft.com"}, {"url": "http://osvdb.org/54932", "source": "secure@microsoft.com"}, {"url": "http://secunia.com/advisories/35365", "source": "secure@microsoft.com"}, {"url": "http://support.avaya.com/elmodocs2/security/ASA-2009-217.htm", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/bid/35206", "source": "secure@microsoft.com"}, {"url": "http://www.securitytracker.com/id?1022352", "source": "secure@microsoft.com"}, {"url": "http://www.us-cert.gov/cas/techalerts/TA09-160A.html", "source": "secure@microsoft.com", "tags": ["US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2009/1541", "source": "secure@microsoft.com"}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-022", "source": "secure@microsoft.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6317", "source": "secure@microsoft.com"}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2009-0228 - This vulnerability allows remote code execution, making it a high-risk vulnerability. Defending against it requires implementing proper buffer overflow protection and ensuring that the Windows Print Spooler Service is properly configured."}, {"techniqueID": "T1190", "comment": "CVE-2009-0228 - This vulnerability can be exploited using a crafted RPC request, making it a difficult vulnerability to defend against. Implementing intrusion detection systems and firewalls that monitor and block suspicious traffic can help mitigate this vulnerability."}, {"techniqueID": "T1060", "comment": "CVE-2009-0228 - This vulnerability allows remote code execution, making it a high-risk vulnerability. Defending against it requires implementing proper file permissions and access control to prevent unauthorized access to the Windows Print Spooler Service."}], "stix_bundle": "{\"type\":\"bundle\",\"id\":\"CVE-2009-0228\",\"created\":\"2021-07-16T14:30:00.000\",\"modified\":\"2021-07-16T14:30:00.000\",\"name\":\"CVE-2009-0228 Security Incident\",\"description\":\"Security incident related to CVE-2009-0228\",\"objects\":[{\"type\":\"vulnerability\",\"id\":\"CVE-2009-0228\",\"name\":\"CVE-2009-0228\",\"description\":\"Stack-based buffer overflow in the EnumeratePrintShares function in Windows Print Spooler Service (win32spl.dll) in Microsoft Windows 2000 SP4 allows remote printer servers to execute arbitrary code via a crafted ShareName in a response to an RPC request, related to \\\"printing data structures,\\\" aka \\\"Buffer Overflow in Print Spooler Vulnerability.\\\"\"},{\"type\":\"attack-pattern\",\"id\":\"T1210\",\"name\":\"Code Injection\\\"},{\"type\":\"attack-pattern\",\"id\":\"T1190\",\"name\":\"RPC Buffer Overflow\\\"},{\"type\":\"attack-pattern\",\"id\":\"T1060\",\"name\":\"File and Directory Discovery\\\"},{\"type\":\"incident\",\"id\":\"CVE-2009-0228 Incident\",\"name\":\"CVE-2009-0228 Incident\",\"description\":\"Security incident related to CVE-2009-0228\"},{\"type\":\"note\",\"id\":\"Buffer Overflow Defense\",\"name\":\"Buffer Overflow Defense\",\"description\":\"Defense strategy for the CVE-2009-0228 vulnerability based on buffer overflow protection and proper configuration of the Windows Print Spooler Service\"},{\"type\":\"note\",\"id\":\"Intrusion Detection System\",\"name\":\"Intrusion Detection System\",\"description\":\"Defense strategy for the CVE-2009-0228 vulnerability based on intrusion detection systems and firewalls that monitor and block suspicious traffic\"},{\"type\":\"note\",\"id\":\"File Permissions\",\"name\":\"File Permissions\",\"description\":\"Defense strategy for the CVE-2009-0228 vulnerability based on proper file permissions and access control to prevent unauthorized access to the Windows Print Spooler Service\"},{\"type\":\"relationship\",\"id\":\"CVE-2009-0228 - T1210\",\"type\":\"related_to\",\"source\":\"CVE-2009-0228\",\"target\":\"T1210\"},{\"type\":\"relationship\",\"id\":\"CVE-2009-0228 - T1190\",\"type\":\"related_to\",\"source\":\"CVE-2009-0228\",\"target\":\"T1190\"},{\"type\":\"relationship\",\"id\":\"CVE-2009-0228 - T1060\",\"type\":\"related_to\",\"source\":\"CVE-2009-0228\",\"target\":\"T1060\"},{\"type\":\"relationship\",\"id\":\"CVE-2009-0228 Incident - Buffer Overflow Defense\",\"type\":\"mitigated_by\",\"source\":\"CVE-2009-0228 Incident\",\"target\":\"Buffer Overflow Defense\"},{\"type\":\"relationship\",\"id\":\"CVE-2009-0228 Incident - Intrusion Detection System\",\"type\":\"mitigated_by\",\"source\":\"CVE-2009-0228 Incident\",\"target\":\"Intrusion Detection System\"},{\"type\":\"relationship\",\"id\":\"CVE-2009-0228 Incident - File Permissions\",\"type\":\"mitigated_by\",\"source\":\"CVE-2009-0228 Incident\",\"target\":\"File Permissions\"}]\"}", "technical_analysis": {"Introduction": "The CVE-2009-0228 vulnerability is a stack-based buffer overflow in the EnumeratePrintShares function in Windows Print Spooler Service (win32spl.dll) in Microsoft Windows 2000 SP4. This vulnerability allows remote attacker to execute arbitrary code via a crafted ShareName in a response to an RPC request.", "Impact and Scope": "The impact of this vulnerability is high, as it allows remote code execution. The scope of the vulnerability is limited to Windows Print Spooler Service in Microsoft Windows 2000 SP4.", "Related MITRE ATT&CK Techniques": "T1210 - Code Injection, T1190 - RPC Buffer Overflow, T1060 - File and Directory Discovery", "Technical Details": "The vulnerability occurs when the EnumeratePrintShares function does not properly validate the size of the ShareName buffer, leading to a stack-based buffer overflow. An attacker can exploit this vulnerability by sending a crafted RPC request to the Windows Print Spooler Service.", "Detection": "Detection can be performed by analyzing network traffic for suspicious RPC requests and monitoring system logs for signs of code execution.", "Mitigation": "Mitigation strategies include implementing buffer overflow protection, configuring the Windows Print Spooler Service to restrict access, and implementing intrusion detection systems and firewalls that monitor and block suspicious traffic.", "Conclusion": "The CVE-2009-0228 vulnerability is a high-risk vulnerability that requires immediate attention. Implementing proper buffer overflow protection, configuring the Windows Print Spooler Service to restrict access, and implementing intrusion detection systems and firewalls that monitor and block suspicious traffic can help mitigate this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2009-0228 vulnerability is a high-risk vulnerability that allows remote code execution. This vulnerability affects Windows Print Spooler Service in Microsoft Windows 2000 SP4.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to unauthorized access to sensitive data and system compromise.", "Technical Impact": "The technical impact of this vulnerability is high, as it allows remote code execution. This can lead to system compromise and data theft.", "Mitigation Strategies": "Implementing buffer overflow protection, configuring the Windows Print Spooler Service to restrict access, and implementing intrusion detection systems and firewalls that monitor and block suspicious traffic can help mitigate this vulnerability.", "Recommendations": "Immediate attention is required to address this vulnerability. It is recommended to implement mitigation strategies and to monitor system logs and network traffic for signs of code execution.", "Conclusions": "The CVE-2009-0228 vulnerability is a high-risk vulnerability that requires immediate attention. Implementing proper buffer overflow protection, configuring the Windows Print Spooler Service to restrict access, and implementing intrusion detection systems and firewalls that monitor and block suspicious traffic can help mitigate this vulnerability."}}