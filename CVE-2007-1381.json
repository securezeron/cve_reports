{"id": "CVE-2007-1381", "sourceIdentifier": "cve@mitre.org", "published": "2007-03-10T00:19:00.000", "lastModified": "2008-09-05T21:20:21.140", "vulnStatus": "Analyzed", "cveTags": [], "evaluatorImpact": "This vulnerability impacts PHP CVS as of 2007-02-24", "descriptions": [{"lang": "en", "value": "The wddx_deserialize function in wddx.c 1.119.2.10.2.12 and 1.119.2.10.2.13 in PHP 5, as modified in CVS on 20070224 and fixed on 20070304, calls strlcpy where strlcat was intended and uses improper arguments, which allows context-dependent attackers to execute arbitrary code via a WDDX packet with a malformed overlap of a STRING element, which triggers a buffer overflow."}, {"lang": "es", "value": "La funci\u00f3n wddx_deserialize en wddx.c versiones 1.119.2.10.2.12 y 1.119.2.10.2.13 en PHP versi\u00f3n 5, como fue modificada en CVS en 20070224 y corregida en 20070304, llama a strlcpy donde strlcat fue prevista y usa argumentos inapropiados, lo que permite a atacantes dependiendo del contexto ejecutar c\u00f3digo arbitrario por medio de un paquete WDDX con un solapamiento de un elemento STRING malformado, lo que desencadena un desbordamiento de b\u00fafer."}], "vendorComments": [{"organization": "Red Hat", "comment": "Not vulnerable. These issues did not affect the versions of PHP as shipped with Red Hat Enterprise Linux 2.1, 3, 4, 5, Stronghold 4.0, or Red Hat Application Stack 1.", "lastModified": "2007-04-16T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:H/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "HIGH", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.6}, "baseSeverity": "HIGH", "exploitabilityScore": 4.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "7007E77F-60EF-44D8-9676-15B59DF1325F"}]}]}], "references": [{"url": "http://cvs.php.net/viewvc.cgi/php-src/ext/wddx/wddx.c?r1=1.119.2.10.2.13&r2=1.119.2.10.2.14", "source": "cve@mitre.org"}, {"url": "http://cvs.php.net/viewvc.cgi/php-src/ext/wddx/wddx.c?revision=1.119.2.10.2.14&view=markup", "source": "cve@mitre.org"}, {"url": "http://www.osvdb.org/32775", "source": "cve@mitre.org"}, {"url": "http://www.php-security.org/MOPB/MOPB-09-2007.html", "source": "cve@mitre.org", "tags": ["Exploit"]}], "techniques": [{"techniqueID": "T1353", "comment": "CVE-2007-1381 uses improper arguments in the wddx_deserialize function, leading to a buffer overflow vulnerability. This technique can be used by attackers to execute arbitrary code. To defend against this, ensure proper configuration of PHP and limits on the number of elements allowed in WDDX packets."}, {"techniqueID": "T1190", "comment": "The vulnerability in CWE-119 can be exploited through manipulated WDDX packets with malformed STRING elements, which can lead to a buffer overflow. To detect this, monitor for unusual traffic patterns and inspect WDDX packets for malicious data."}], "stix_bundle": {"type": "bundle", "id": "CVE-2007-1381", "spec_version": "2.1", "labels": ["vulnerability"], "objects": [{"type": "vulnerability", "id": "CVE-2007-1381", "name": "CVE-2007-1381", "description": "The wddx_deserialize function in wddx.c in PHP 5 uses improper arguments, which allows context-dependent attackers to execute arbitrary code via a WDDX packet with a malformed overlap of a STRING element.", "objects": [{"type": "indicator", "id": "arbitrary_code_execution", "name": "Arbitrary Code Execution", "description": "Arbitrary code execution can occur through manipulated WDDX packets with malformed STRING elements."}, {"type": "intrusion-set", "id": "Attackers", "name": "Attackers", "description": "Attackers can exploit this vulnerability to execute arbitrary code."}, {"type": "course-of-action", "id": "proper_configPHP_limits", "name": "Proper Configuration of PHP and Limits", "description": "Ensure proper configuration of PHP and limits on the number of elements allowed in WDDX packets to defend against this vulnerability."}, {"type": "course-of-action", "id": "monitor_unusual_traffic", "name": "Monitor Unusual Traffic", "description": "Monitor for unusual traffic patterns and inspect WDDX packets for malicious data to detect this vulnerability."}]}]}, "technical_analysis": {"Introduction": "CVE-2007-1381 is a buffer overflow vulnerability in the wddx_deserialize function of PHP 5, which can be exploited through manipulated WDDX packets with malformed STRING elements.", "Impact and Scope": "This vulnerability has a CVSS score of 7.6 and an attack vector of NETWORK. It can lead to arbitrary code execution, which can result in a complete compromise of confidentiality, integrity, and availability.", "Related MITRE ATT&CK Techniques": "T1353, T1190", "Technical Details": "The vulnerability occurs due to improper arguments in the wddx_deserialize function, which can be exploited through manipulated WDDX packets with malformed STRING elements.", "Detection": "Monitor for unusual traffic patterns and inspect WDDX packets for malicious data.", "Mitigation": "Ensure proper configuration of PHP and limits on the number of elements allowed in WDDX packets. Monitor for unusual traffic patterns and inspect WDDX packets for malicious data.", "Conclusion": "CVE-2007-1381 is a significant vulnerability that can be exploited by attackers to execute arbitrary code. It is essential to ensure proper configuration of PHP and limits on the number of elements allowed in WDDX packets to detect and prevent this vulnerability."}, "executive_analysis": {"Overview": "CVE-2007-1381 is a buffer overflow vulnerability in the wddx_deserialize function of PHP 5, which can be exploited through manipulated WDDX packets with malformed STRING elements.", "Business Impact": "This vulnerability can result in a complete compromise of confidentiality, integrity, and availability, which can have significant business and financial implications.", "Technical Impact": "The vulnerability can be exploited through manipulated WDDX packets with malformed STRING elements, which can lead to arbitrary code execution.", "Mitigation Strategies": "Ensure proper configuration of PHP and limits on the number of elements allowed in WDDX packets. Monitor for unusual traffic patterns and inspect WDDX packets for malicious data.", "Recommendations": "Develop a comprehensive vulnerability management strategy that includes regular patching, monitoring, and testing. Implement a web application firewall (WAF) to detect and prevent malicious traffic.", "Conclusions": "CVE-2007-1381 is a significant vulnerability that requires immediate attention. Implementing proper configuration of PHP and limits on the number of elements allowed in WDDX packets and monitoring for unusual traffic patterns and inspecting WDDX packets for malicious data can help prevent this vulnerability."}}