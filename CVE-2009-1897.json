{"id": "CVE-2009-1897", "sourceIdentifier": "secalert@redhat.com", "published": "2009-07-20T17:30:54.733", "lastModified": "2023-02-13T02:20:14.337", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The tun_chr_poll function in drivers/net/tun.c in the tun subsystem in the Linux kernel 2.6.30 and 2.6.30.1, when the -fno-delete-null-pointer-checks gcc option is omitted, allows local users to gain privileges via vectors involving a NULL pointer dereference and an mmap of /dev/net/tun, a different vulnerability than CVE-2009-1894."}, {"lang": "es", "value": "La funci\u00f3n tun_chr_poll en drivers/net/tun.c en el subsistema tun del kernel de Linux v2.6.30 y v2.6.30.1, cuando se omite la opci\u00f3n -fno-delete-null-pointer-checks en gcc, permite a atacantes locales obtener privilegios a trav\u00e9s de vectores que implican desreferenciacion de punteros NULL y un nmap de /dev/net/tun, es una vulnerabilidad diferente a CVE-2009-1894."}], "vendorComments": [{"organization": "Red Hat", "comment": "Red Hat is aware of this issue and is tracking it via the following bug:\nhttps://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=CVE-2009-1897\n\nThe flaw only affects the Red Hat Enterprise Linux 5.4 beta kernel, which includes a backport of the upstream bug fix introducing this flaw (git commit 33dccbb0). This issue did not affect the final released Red Hat Enterprise Linux 5.4 kernel.  It is also possible to mitigate this flaw by ensuring that the permissions for /dev/net/tun is restricted to root only.\n\nThis issue does not affect any other released kernel in any Red Hat product.", "lastModified": "2009-09-02T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.9}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.30:*:*:*:*:*:*:*", "matchCriteriaId": "10E55450-F6D9-483C-9CC8-E651E5A12AB1"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.30:rc1:*:*:*:*:*:*", "matchCriteriaId": "45273823-29EA-44DE-8444-3933402C5793"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.30:rc2:*:*:*:*:*:*", "matchCriteriaId": "88F60E74-09DB-4D4A-B922-4A46EED0EC20"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.30:rc3:*:*:*:*:*:*", "matchCriteriaId": "E242D3DE-D1DC-406A-BCC3-C4380B7EC369"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.30:rc4:x86_32:*:*:*:*:*", "matchCriteriaId": "06EFB3F7-2EAE-4A56-A9A1-E8C734E6B91E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.30:rc5:*:*:*:*:*:*", "matchCriteriaId": "8598D6E5-0C5C-4A31-841A-C12801DB7D91"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.30:rc6:*:*:*:*:*:*", "matchCriteriaId": "59800B0A-477B-42F8-A58A-5144F455AE01"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.30:rc7-git6:*:*:*:*:*:*", "matchCriteriaId": "F166BF6B-BFB0-4206-BD59-179701572F1C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.30.1:*:*:*:*:*:*:*", "matchCriteriaId": "99AC6D46-A0BF-4F1D-88BB-03BF74FDB84F"}]}]}], "references": [{"url": "http://archives.neohapsis.com/archives/fulldisclosure/2009-07/0241.html", "source": "secalert@redhat.com"}, {"url": "http://archives.neohapsis.com/archives/fulldisclosure/2009-07/0246.html", "source": "secalert@redhat.com"}, {"url": "http://article.gmane.org/gmane.linux.network/124939", "source": "secalert@redhat.com"}, {"url": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=3c8a9c63d5fd738c261bd0ceece04d9c8357ca13", "source": "secalert@redhat.com"}, {"url": "http://grsecurity.net/~spender/cheddar_bay.tgz", "source": "secalert@redhat.com", "tags": ["Patch"]}, {"url": "http://isc.sans.org/diary.html?storyid=6820", "source": "secalert@redhat.com", "tags": ["Exploit"]}, {"url": "http://lkml.org/lkml/2009/7/6/19", "source": "secalert@redhat.com", "tags": ["Exploit"]}, {"url": "http://secunia.com/advisories/35839", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2009/07/17/1", "source": "secalert@redhat.com"}, {"url": "http://www.vupen.com/english/advisories/2009/1925", "source": "secalert@redhat.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=512284", "source": "secalert@redhat.com"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/51803", "source": "secalert@redhat.com"}, {"url": "https://www.redhat.com/en/blog/security-flaws-caused-compiler-optimizations", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1003 - OS Credential Dumping", "comment": "CVE-2009-1897 - This vulnerability allows local users to gain privileges via a NULL pointer dereference and an mmap of /dev/net/tun, enabling OS credential dumping attacks."}, {"techniqueID": "T1055 - Process Injection", "comment": "CVE-2009-1897 - This vulnerability allows local users to inject malicious code into kernel processes, enabling process injection attacks and potentially leading to escalated privileges."}, {"techniqueID": "T1072 - Process Hollowing", "comment": "CVE-2009-1897 - This vulnerability allows local users to hollow out kernel processes, enabling process hollowing attacks and potentially leading to escalated privileges."}, {"techniqueID": "T1409 - OS Discovery", "comment": "CVE-2009-1897 - This vulnerability allows local users to discover kernel information and manipulate OS components, enabling OS discovery and potentially leading to escalation of privileges."}, {"techniqueID": "T1134 - Access Token Manipulation", "comment": "CVE-2009-1897 - This vulnerability allows local users to manipulate kernel access tokens, enabling access token manipulation attacks and potentially leading to escalated privileges."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "vuln-1", "aliases": ["CVE-2009-1897"], "description": "The tun_chr_poll function in drivers/net/tun.c in the tun subsystem in the Linux kernel 2.6.30 and 2.6.30.1, when the -fno-delete-null-pointer-checks gcc option is omitted, allows local users to gain privileges via vectors involving a NULL pointer dereference and an mmap of /dev/net/tun.", "object_reference": ["attack-pattern-1", "exploit-1", "vulnerability-1"]}, {"type": "attack-pattern", "id": "attack-pattern-1", "name": "Local Privilege Escalation via Null Pointer Dereference", "description": "An attack pattern where an attacker exploits a NULL pointer dereference vulnerability in the tun_chr_poll function to gain local privileges."}, {"type": "exploit", "id": "exploit-1", "name": "CVE-2009-1897 Linux Kernel Local Privilege Escalation Exploit", "description": "An exploit that takes advantage of the CVE-2009-1897 vulnerability to gain local privileges on Linux kernel 2.6.30 and 2.6.30.1."}, {"type": "course-of-action", "id": "course-of-action-1", "name": "Apply the Patch", "description": "Apply the official patch released by Red Hat to mitigate the vulnerability."}, {"type": "course-of-action", "id": "course-of-action-2", "name": "Restrict Permissions", "description": "Restrict permissions on the /dev/net/tun device to prevent unauthorized access."}], "relationship": [{"relationship_type": "confined-by", "from": "vuln-1", "to": "attack-pattern-1"}, {"relationship_type": "uses", "from": "attack-pattern-1", "to": "exploit-1"}, {"relationship_type": "mitigated-by", "from": "vuln-1", "to": "course-of-action-1"}, {"relationship_type": "mitigated-by", "from": "vuln-1", "to": "course-of-action-2"}]}, "technical_analysis": {"Introduction": "The CVE-2009-1897 vulnerability is a local privilege escalation vulnerability in the Linux kernel 2.6.30 and 2.6.30.1.", "Impact and Scope": "The vulnerability allows local users to gain privileges via vectors involving a NULL pointer dereference and an mmap of /dev/net/tun.", "Related MITRE ATT&CK Techniques": "T1003 - OS Credential Dumping, T1055 - Process Injection, T1072 - Process Hollowing, T1409 - OS Discovery, T1134 - Access Token Manipulation", "Technical Details": "The vulnerability occurs due to a NULL pointer dereference in the tun_chr_poll function, which can be exploited by local users to gain privileges.", "Detection": "Detection methods include examining system logs for suspicious activity and monitoring for unauthorized access to the /dev/net/tun device.", "Mitigation": "Apply the official patch released by Red Hat or restrict permissions on the /dev/net/tun device to prevent unauthorized access.", "Conclusion": "The CVE-2009-1897 vulnerability is a serious local privilege escalation vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The CVE-2009-1897 vulnerability is a local privilege escalation vulnerability in the Linux kernel 2.6.30 and 2.6.30.1.", "Business Impact": "The vulnerability could allow attackers to gain elevated privileges on compromised systems, potentially leading to data theft, integrity compromise, or disruption of business operations.", "Technical Impact": "The vulnerability affects a specific version of the Linux kernel and requires immediate attention and mitigation to prevent exploitation.", "Mitigation Strategies": "Apply the official patch released by Red Hat or restrict permissions on the /dev/net/tun device to prevent unauthorized access.", "Recommendations": "Implement a vulnerability management program to detect and remediate vulnerabilities in a timely manner.", "Conclusions": "The CVE-2009-1897 vulnerability is a high-severity vulnerability that requires immediate attention and mitigation to prevent exploitation and potential business disruption."}}