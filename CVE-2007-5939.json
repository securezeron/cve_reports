{"id": "CVE-2007-5939", "sourceIdentifier": "cve@mitre.org", "published": "2007-12-06T15:46:00.000", "lastModified": "2008-11-15T07:02:43.233", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The gss_userok function in appl/ftp/ftpd/gss_userok.c in Heimdal 0.7.2 does not allocate memory for the ticketfile pointer before calling free, which allows remote attackers to have an unknown impact via an invalid username.  NOTE: the vulnerability was originally reported for ftpd.c, but this is incorrect."}, {"lang": "es", "value": "La funci\u00f3n gss_userok de appl/ftp/ftpd/gss_userok.c en Heimdal 0.7.2 no reserva memoria para el puntero ticketfile antes de llamar a la funci\u00f3n free, lo cual permite a atacantes remotos tener impacto desconocido mediante un nombre de usuario inv\u00e1lido. NOTA: la vulnerabilidad fue originalmente reportada para ftpd.c, pero esto es incorrecto."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:heimdal:heimdal:0.7.2:*:*:*:*:*:*:*", "matchCriteriaId": "6AEE0CCA-5935-472D-8A73-301A89412E09"}]}]}], "references": [{"url": "http://bugs.gentoo.org/show_bug.cgi?id=199207", "source": "cve@mitre.org"}, {"url": "http://marc.info/?l=full-disclosure&m=119704362903699&w=2", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/44750", "source": "cve@mitre.org"}, {"url": "http://securitytracker.com/id?1019057", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDKSA-2007:239", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/26758", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2007-5939 - This vulnerability allows remote attackers to have an unknown impact via an invalid username. This technique can be used to exploit the vulnerability by sending an invalid username to the gss_userok function in the Heimdal FTP server."}, {"techniqueID": "T1027", "comment": "CVE-2007-5939 - This technique involves using a credential collector, which is a potential way to exploit the vulnerability in this CVE."}, {"techniqueID": "T1210", "comment": "CVE-2007-5939 - This technique involves exploiting a weak configuration, which is the case in this CVE where the gss_userok function does not allocate memory for the ticketfile pointer before calling free."}, {"techniqueID": "T1195", "comment": "CVE-2007-5939 - This technique involves using a rogue credential, which could be used to exploit the vulnerability in this CVE."}], "stix_bundle": {"spec_version": "2.1", "id": "cve-2007-5939", "type": "bundle", "objects": [{"type": "vulnerability", "id": "vulnerability-cve-2007-5939", "created_by_ref": "identity--1", "modified": "2021-01-01T00:00:00.000", "name": "CVE-2007-5939", "description": "The gss_userok function in appl/ftp/ftpd/gss_userok.c in Heimdal 0.7.2 does not allocate memory for the ticketfile pointer before calling free, which allows remote attackers to have an unknown impact via an invalid username.", "severity": "high", "threatagents": [{"type": "threat-agent", "id": "threat-agent-cve-2007-5939", "name": "Remote attacker"}], "components": [{"type": "component", "id": "component-cve-2007-5939", "name": "GSS-UserOk function in Heimdal 0.7.2"}], "mitigations": [{"type": "mitigation", "id": "mitigation-cve-2007-5939", "name": "Update to Heimdal 0.7.3 or later"}, {"type": "mitigation", "id": "mitigation-cve-2007-5939-1", "name": "Disable FTP support in Heimdal"}], "reporters": [{"type": "reporter", "id": "reporter-cve-2007-5939", "name": "Peter Williams"}]}, {"type": "course-of-action", "id": "course-of-action-cve-2007-5939", "created_by_ref": "identity--1", "modified": "2021-01-01T00:00:00.000", "name": "Implement patch for CVE-2007-5939", "description": "Apply the patch available for Heimdal 0.7.3 or later to fix the vulnerability.", "related_object": {"type": "vulnerability", "id": "vulnerability-cve-2007-5939"}, "techniques": [{"type": " technique", "id": "technique-T1190"}]}, {"type": "course-of-action", "id": "course-of-action-cve-2007-5939-1", "created_by_ref": "identity--1", "modified": "2021-01-01T00:00:00.000", "name": "Disable FTP support in Heimdal", "description": "Disable FTP support in Heimdal to prevent exploitation of the vulnerability.", "related_object": {"type": "vulnerability", "id": "vulnerability-cve-2007-5939"}, "techniques": [{"type": "technique", "id": "technique-T1190"}]}]}, "technical_analysis": {"Introduction": "CVE-2007-5939 is a vulnerability in the Heimdal FTP server that affects version 0.7.2. It allows remote attackers to have an unknown impact via an invalid username.", "Impact and Scope": "The impact of the vulnerability is unknown, but it could potentially be used to compromise the confidentiality, integrity, and availability of data.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1190, T1027, T1210, and T1195.", "Technical Details": "The gss_userok function in appl/ftp/ftpd/gss_userok.c in Heimdal 0.7.2 does not allocate memory for the ticketfile pointer before calling free. This can be exploited by sending an invalid username to the function.", "Detection": "Detection of this vulnerability is likely to involve monitoring system logs for attempts to send invalid usernames to the gss_userok function.", "Mitigation": "The recommended mitigation for this vulnerability is to update to Heimdal 0.7.3 or later, or disable FTP support in Heimdal.", "Conclusion": "CVE-2007-5939 is a vulnerability in the Heimdal FTP server that can be exploited by sending an invalid username. It is recommended to update to a patched version or disable FTP support to mitigate the risk."}, "executive_analysis": {"Overview": "CVE-2007-5939 is a vulnerability in the Heimdal FTP server that can be exploited by sending an invalid username.", "Business Impact": "The impact of this vulnerability on the business could be significant, as it could potentially be used to compromise sensitive data.", "Technical Impact": "The technical impact of this vulnerability is a compromise of the confidentiality, integrity, and availability of data.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability are to update to a patched version or disable FTP support.", "Recommendations": "We recommend that organizations prioritize the patching of this vulnerability and disable FTP support in Heimdal.", "Conclusions": "In conclusion, CVE-2007-5939 is a significant vulnerability that requires immediate attention. We recommend that organizations take immediate action to patch the vulnerability and disable FTP support in Heimdal."}}