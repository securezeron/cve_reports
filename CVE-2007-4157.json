{"id": "CVE-2007-4157", "sourceIdentifier": "cve@mitre.org", "published": "2007-08-03T21:17:00.000", "lastModified": "2018-10-15T21:33:40.117", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHPBlogger stores sensitive information under the web root with insufficient access control, which allows remote attackers to download a database containing an admin password hash via a direct request for data/pref.db.  NOTE: this can be easily leveraged for administrative access because composing the authentication cookie only requires the password hash, not the cleartext version."}, {"lang": "es", "value": "PHPBlogger almacena informaci\u00f3n confidencial      bajo la ra\u00edz del web con control de acceso insuficiente, lo cual permite a atacantes remotos descargar una base de datos conteniendo  un resumen de contrase\u00f1a de admin mediante una petici\u00f3n directa de data/pref.db.\r\nNOTA: esto puede ser f\u00e1cilmente utilizado para conseguir acceso administrativo dado que la composici\u00f3n de la cookie de autenticaci\u00f3n solamente requiere el resumen de la contrase\u00f1a, no la versi\u00f3n de texto en claro."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpblogger:php-blogger:2.2.7:*:*:*:*:*:*:*", "matchCriteriaId": "6ADAC89E-D09D-45AB-B94C-DC550BF195A9"}]}]}], "references": [{"url": "http://forcehacker.com/forum/viewtopic.php?t=2352", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/38706", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/38707", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/26262", "source": "cve@mitre.org"}, {"url": "http://securityreason.com/securityalert/2957", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/474938/100/0/threaded", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1055: SMB/Windows Discovery", "comment": "CVE-2007-4157 - PHPBlogger stores sensitive information under the web root with insufficient access control, which allows remote attackers to download a database containing an admin password hash via a direct request for data/pref.db."}, {"techniqueID": "T1033: Spearphishing Attachment", "comment": "CVE-2007-4157 - The vulnerability can be exploited through a spearphishing attack, where the attacker sends a carefully crafted link to the victim, leading to the download of the sensitive database."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "CVE-2007-4157 - An attacker can exploit the vulnerable PHPBlogger application to gain unauthorized access to sensitive information."}, {"techniqueID": "T1567: Device Phishing", "comment": "CVE-2007-4157 - The vulnerability can be exploited through a device phishing attack, where the attacker tricks the victim into downloading the sensitive database by making it appear as a legitimate update."}], "stix_bundle": {"stype": "bundle", "version": "2.1", "objects": [{"type": "indicator", "id": "indicator--91b5f5e6-d0c4-4641-a5f2-6e4d70f61e43", "created_by_ref": "identity--93a10506-ee6f-47a1-a5c9-0ff7f39a68c4", "name": "PHPBlogger Vulnerability Indicator", "description": "Indicator for the PHPBlogger vulnerability (CVE-2007-4157)", "first Seen": "2007-08-03T21:17:00.000", "Last Seen": "2018-10-15T21:33:40.117", "notation": " threat-actor: Malicious Actor 1\r\naffected-component: PHPBlogger Application"}, {"type": "attack-pattern", "id": "attack-pattern--dbbe7a69-6f73-4f6a-933b-37f74bb7a7d3", "created_by_ref": "identity--93a10506-ee6f-47a1-a5c9-0ff7f39a68c4", "name": "PHPBlogger Data Download", "description": "Attack pattern for downloading sensitive data from a vulnerable PHPBlogger application", "kill_chain_phases": [{"phase_name": "Reconnaissance"}]}, {"type": "intrusion-set", "id": "intrusion-set--33b76d9a-c5f4-4fe7-954e-55cfe94bc032", "created_by_ref": "identity--93a10506-ee6f-47a1-a5c9-0ff7f39a68c4", "name": "Malicious Actor 1", "description": "Intrusion set for Malicious Actor 1, responsible for exploiting the PHPBlogger vulnerability", "goals": [{"goal_name": "Data Exfiltration"}]}, {"type": "course-of-action", "id": "course-of-action--7e4a70c1-ea4f-46a7-b8ad-6e5a09dac69c", "created_by_ref": "identity--93a10506-ee6f-47a1-a5c9-0ff7f39a68c4", "name": "Execute PHPBlogger Patch", "description": "Course of action for executing the patch to fix the PHPBlogger vulnerability", "mitigates": [{"resource_ref": "attack-pattern--dbbe7a69-6f73-4f6a-933b-37f74bb7a7d3"}]}], "relationships": [{"source_ref": "indicator--91b5f5e6-d0c4-4641-a5f2-6e4d70f61e43", "target_ref": "attack-pattern--dbbe7a69-6f73-4f6a-933b-37f74bb7a7d3", "relationship_type": "indicated-by"}, {"source_ref": "attack-pattern--dbbe7a69-6f73-4f6a-933b-37f74bb7a7d3", "target_ref": "intrusion-set--33b76d9a-c5f4-4fe7-954e-55cfe94bc032", "relationship_type": "used-by"}, {"source_ref": "intrusion-set--33b76d9a-c5f4-4fe7-954e-55cfe94bc032", "target_ref": "course-of-action--7e4a70c1-ea4f-46a7-b8ad-6e5a09dac69c", "relationship_type": "related-to"}]}, "technical_analysis": {"Introduction": "The PHPBlogger vulnerability (CVE-2007-4157) is a remote code execution vulnerability that allows attackers to download sensitive data from a vulnerable application.", "Impact and Scope": "The vulnerability has a CVSS score of 5.0 and can be exploited by remote attackers with low privileges.", "Related MITRE ATT&CK Techniques": "T1055: SMB/Windows Discovery, T1033: Spearphishing Attachment, T1190: Exploit Public-Facing Application, T1567: Device Phishing", "Technical Details": "The vulnerability occurs when the PHPBlogger application stores sensitive information under the web root with insufficient access control.", "Detection": "Detection methods include monitoring for unusual network traffic and analyzing system logs for unauthorized access attempts.", "Mitigation": "Mitigation strategies include patching the vulnerable application, restricting access to sensitive data, and implementing intrusion detection and prevention systems.", "Conclusion": "The PHPBlogger vulnerability (CVE-2007-4157) is a serious threat to sensitive data and should be prioritized for patching and mitigation."}, "executive_analysis": {"Overview": "The PHPBlogger vulnerability (CVE-2007-4157) is a critical vulnerability that affects sensitive data and should be prioritized for patching and mitigation.", "Business Impact": "The vulnerability has the potential to cause significant financial losses and reputational damage if exploited.", "Technical Impact": "The vulnerability allows attackers to download sensitive data, which can be used to gain unauthorized access to systems, steal confidential information, and disrupt business operations.", "Mitigation Strategies": "Patching the vulnerable application, restricting access to sensitive data, and implementing intrusion detection and prevention systems are recommended.", "Recommendations": "Executives should prioritize patching and mitigation efforts to minimize the risk of exploitation and ensure business continuity.", "Conclusions": "The PHPBlogger vulnerability (CVE-2007-4157) is a serious threat that requires immediate attention and action to mitigate and prevent exploitation."}}