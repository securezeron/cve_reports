{"id": "CVE-2015-4630", "sourceIdentifier": "cve@mitre.org", "published": "2018-10-18T21:29:00.270", "lastModified": "2018-12-04T19:59:10.180", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple cross-site request forgery (CSRF) vulnerabilities in Koha 3.14.x before 3.14.16, 3.16.x before 3.16.12, 3.18.x before 3.18.08, and 3.20.x before 3.20.1 allow remote attackers to (1) hijack the authentication of administrators for requests that create a user via a request to members/memberentry.pl or (2) give a user superlibrarian permission via a request to members/member-flags.pl or (3) hijack the authentication of arbitrary users for requests that conduct cross-site scripting (XSS) attacks via the addshelf parameter to opac-shelves.pl."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades Cross-Site Request Forgery (CSRF) en Koha, en versiones 3.14.x anteriores a la 3.14.16, versiones 3.16.x anteriores a la 3.16.12, versiones 3.18.x anteriores a la 3.18.08 y versiones 3.20.x anteriores a la 3.20.1, permiten que atacantes remotos (1) secuestren la autenticaci\u00f3n de los administradores para peticiones que crean un usuario mediante una petici\u00f3n a members/memberentry.pl, (2) otorguen a un usuario el permiso superlibrarian mediante una peticiones a members/member-flags.pl o (3) secuestrar la autenticaci\u00f3n de usuarios arbitrarios para peticiones que llevan a cabo ataques Cross-Site Scripting (XSS) mediante el par\u00e1metro addshelf en opac-shelves.pl."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.0, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.1, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 6.8, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:koha:koha:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.14.00", "versionEndExcluding": "3.14.16", "matchCriteriaId": "214E9AA7-580C-4028-AB21-0D723D3037FD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:koha:koha:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.16.00", "versionEndExcluding": "3.16.12", "matchCriteriaId": "CEBF9831-C8D6-4503-8192-13D04FB057DB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:koha:koha:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.18.0", "versionEndExcluding": "3.18.8", "matchCriteriaId": "A50154EE-37E5-4872-8A1C-57AA8132E91B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:koha:koha:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.20.00", "versionEndExcluding": "3.20.1", "matchCriteriaId": "AE6E0A0A-BA1C-4F6B-92E0-796FFD77AF41"}]}]}], "references": [{"url": "https://bugs.koha-community.org/bugzilla3/show_bug.cgi?id=14423", "source": "cve@mitre.org", "tags": ["Exploit", "Issue Tracking", "Vendor Advisory"]}, {"url": "https://koha-community.org/koha-3-14-16-released/", "source": "cve@mitre.org", "tags": ["Product", "Release Notes", "Vendor Advisory"]}, {"url": "https://koha-community.org/security-release-koha-3-16-12/", "source": "cve@mitre.org", "tags": ["Product", "Release Notes", "Vendor Advisory"]}, {"url": "https://koha-community.org/security-release-koha-3-18-8/", "source": "cve@mitre.org", "tags": ["Product", "Release Notes", "Vendor Advisory"]}, {"url": "https://koha-community.org/security-release-koha-3-20-1/", "source": "cve@mitre.org", "tags": ["Product", "Release Notes", "Vendor Advisory"]}, {"url": "https://packetstormsecurity.com/files/132458/Koha-ILS-3.20.x-CSRF-XSS-Traversal-SQL-Injection.html", "source": "cve@mitre.org", "tags": ["Exploit", "VDB Entry", "Third Party Advisory"]}, {"url": "https://seclists.org/fulldisclosure/2015/Jun/80", "source": "cve@mitre.org", "tags": ["Exploit", "Mailing List", "Third Party Advisory"]}, {"url": "https://www.exploit-db.com/exploits/37389/", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://www.sba-research.org/2015/06/24/researchers-of-sba-research-found-several-critical-security-vulnerabilities-in-the-koha-library-software-via-combinatorial-testing/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1055", "comment": "CVE-2015-4630 - This vulnerability allows remote attackers to conduct CSRF and XSS attacks, compromising user authentication and sessions. Defend against this by implementing proper CSRF protection and input validation."}, {"techniqueID": "T1451", "comment": "CVE-2015-4630 - This vulnerability can be exploited by injecting malicious HTML code, leading to XSS attacks. Defend against this by sanitizing user input and verifying HTTP request headers."}, {"techniqueID": "T1210", "comment": "CVE-2015-4630 - This vulnerability can be used to hijack user sessions, allowing attackers to access sensitive information. Defend against this by implementing proper session management and authentication measures."}], "stix_bundle": "{\"bundle\": {\n  \"type\": \"bundle\",\n  \"id\": \"bundle--1\",\n  \"created_by_ref\": \"user--1\",\n  \"created\": \"2022-01-01T12:00:00.000Z\",\n  \"modified\": \"2022-01-01T12:00:00.000Z\",\n  \"name\": \"Koha Library Software Vulnerability\",\n  \"description\": \"A bundle containing information about the vulnerability in Koha library software\",\n  \"objects\": [\n    {\n      \"type\": \"vulnerability\",\n      \"id\": \"vulnerability--1\",\n      \"created_by_ref\": \"user--1\",\n      \"created\": \"2022-01-01T12:00:00.000Z\",\n      \"modified\": \"2022-01-01T12:00:00.000Z\",\n      \"name\": \"Koha Library Software CSRF and XSS Vulnerability\",\n      \"description\": \"A vulnerability in Koha library software allows remote attackers to conduct CSRF and XSS attacks\",\n      \"properties\": {\n        \"cvssV3\": 8.0,\n        \"cvssV2\": 6.0,\n        \"attackVector\": \"NETWORK\",\n        \"attackComplexity\": \"LOW\",\n        \"privilegesRequired\": \"LOW\",\n        \"userInteraction\": \"REQUIRED\",\n        \"scope\": \"UNCHANGED\",\n        \"confidentialityImpact\": \"HIGH\",\n        \"integrityImpact\": \"HIGH\",\n        \"availabilityImpact\": \"HIGH\"\n      },\n      \"relationships\": {\n        \"exploit\": {\n          \"type\": \"exploit\",\n          \"id\": \"exploit--1\",\n          \"object\": {\n            \"type\": \"exploit\",\n            \"id\": \"exploit--2\",\n            \"name\": \"Koha Library Software CSRF and XSS Exploit\",\n            \"description\": \"An exploit of the CSRF and XSS vulnerability in Koha library software\",\n            \"properties\": {\n              \"platform\": \"Multi-platform\",\n              \" severity\": \"HIGH\"\n            },\n            \"relationships\": {\n              \"vulnerability\": {\n                \"type\": \"vulnerability\",\n                \"id\": \"vulnerability--1\"\n              }\n            }\n          }\n        }\n      }\n    }\n  ],\n  \"relationships\": {\n    \"vulnerability\": [\n      {\n        \"type\": \"exploit\",\n        \"id\": \"exploit--1\"\n      }\n    ]\n  }\n}}", "technical_analysis": {"Introduction": "CVE-2015-4630 is a critical vulnerability in Koha library software that allows remote attackers to conduct CSRF and XSS attacks, compromising user authentication and sessions.", "Impact and Scope": "The vulnerability has a CVSS v3 score of 8.0 and a CVSS v2 score of 6.0, with an attack vector of NETWORK, attack complexity of LOW, and user interaction required.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1055, T1451, and T1210.", "Technical Details": "The vulnerability occurs due to insufficient input validation and CSRF protection in the software, allowing attackers to inject malicious HTML code and hijack user sessions.", "Detection": "Detection of the vulnerability can be achieved bymonitoring for suspicious HTTP requests and detecting anomalies in user session activity.", "Mitigation": "Mitigation strategies include implementing proper CSRF protection, input validation, and session management measures, as well as educating users about the risks of CSRF and XSS attacks.", "Conclusion": "In conclusion, CVE-2015-4630 is a critical vulnerability that requires immediate attention and mitigation to prevent attacks and protect sensitive information."}, "executive_analysis": {"Overview": "CVE-2015-4630 is a critical vulnerability in Koha library software that has the potential to compromise user authentication and sessions.", "Business Impact": "The vulnerability has significant business implications, including potential data breaches, unauthorized access to sensitive information, and reputational damage.", "Technical Impact": "The technical impact of the vulnerability includes the potential for remote attackers to conduct CSRF and XSS attacks, hijack user sessions, and access sensitive information.", "Mitigation Strategies": "Mitigation strategies should include implementing proper CSRF protection, input validation, and session management measures, as well as educating users about the risks of CSRF and XSS attacks.", "Recommendations": "Recommendations for executives include prioritizing vulnerability remediation, providing regular security updates, and conducting security awareness training for users.", "Conclusions": "In conclusion, CVE-2015-4630 is a critical vulnerability that requires immediate attention and mitigation to prevent attacks and protect sensitive information."}}