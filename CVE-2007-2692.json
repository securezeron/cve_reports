{"id": "CVE-2007-2692", "sourceIdentifier": "cve@mitre.org", "published": "2007-05-16T01:19:00.000", "lastModified": "2019-12-17T20:16:22.603", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The mysql_change_db function in MySQL 5.0.x before 5.0.40 and 5.1.x before 5.1.18 does not restore THD::db_access privileges when returning from SQL SECURITY INVOKER stored routines, which allows remote authenticated users to gain privileges."}, {"lang": "es", "value": "La funci\u00f3n mysql_change_db en MySQL 5.0.x anterior a 5.0.40 y 5.1.x anterior a 5.1.18 no restaura los privilegios THD::db_access cuando regresa de rutinas almacenadas SQL SECURITY INVOKER, lo cual permite a usuarios autenticados remotamente obtener privilegios."}], "vendorComments": [{"organization": "Red Hat", "comment": "This issue did not affect mysql packages as shipped in Red Hat Enterprise Linux 2.1, 3 and 4.\n\nAffected mysql packages as shipped in Red Hat Enterprise Linux 5 and Red Hat Application Stack were fixed via:\n\nhttps://rhn.redhat.com/errata/CVE-2007-2692.html", "lastModified": "2008-07-25T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 6.8, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "DC198CDB-CAC0-41DD-9FCD-42536E7FE11A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "B77A2761-2B44-4061-9C29-A54F90A1AD83"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "5B3AD851-056F-4E57-B85B-4AC5A5A20C0C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "FD24EA8C-4FCA-4F40-B2EA-7DFA49432483"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.4:*:*:*:*:*:*:*", "matchCriteriaId": "754B78F2-A03C-40BE-812B-F5E57B93D20B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.5:*:*:*:*:*:*:*", "matchCriteriaId": "575039BD-A8B6-4459-B5F0-F220A94650EA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.5.0.21:*:*:*:*:*:*:*", "matchCriteriaId": "BDA03768-74D2-4C5D-ABCF-8A91F9E6C273"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.10:*:*:*:*:*:*:*", "matchCriteriaId": "542B23CB-7535-4EF7-B926-466A5161A0D4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.15:*:*:*:*:*:*:*", "matchCriteriaId": "45E686C3-4100-465C-9F45-068580B496E5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.16:*:*:*:*:*:*:*", "matchCriteriaId": "6E9F09D8-6FAE-4A5B-AE04-248CD52C5FF4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.17:*:*:*:*:*:*:*", "matchCriteriaId": "DB618DB2-6B00-4E99-8232-937D2C51986B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.20:*:*:*:*:*:*:*", "matchCriteriaId": "665E063D-355D-4A5A-A05F-36BF582DE36F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.22.1.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "214E3CF9-6362-4F5A-91B7-5E69564F7144"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.0.24:*:*:*:*:*:*:*", "matchCriteriaId": "F4C6CD84-EA5D-451F-AFC3-5F7094F0017D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.1.5:*:*:*:*:*:*:*", "matchCriteriaId": "35BED939-3366-4CBF-B6BF-29C0C42E97F7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.0:alpha:*:*:*:*:*:*", "matchCriteriaId": "19001041-22C4-4D2C-A918-378DACBB1DF4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.3:beta:*:*:*:*:*:*", "matchCriteriaId": "6F610D56-6BB6-48FB-B43A-670CE9168500"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.6:*:*:*:*:*:*:*", "matchCriteriaId": "1668BB5B-E7FB-4430-B8D5-89E308F5DD39"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.7:*:*:*:*:*:*:*", "matchCriteriaId": "E3F44DA1-1509-4AC7-AB6B-2B2A834A16AC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.8:*:*:*:*:*:*:*", "matchCriteriaId": "7A2D6DF6-FE5D-428F-BCEB-E7832C2B4FE4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.9:*:*:*:*:*:*:*", "matchCriteriaId": "7777E919-FD4B-452B-88D7-165410C703F2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.11:*:*:*:*:*:*:*", "matchCriteriaId": "A56ACB60-EC2C-45AF-B923-B3A90A2F7AE1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.12:*:*:*:*:*:*:*", "matchCriteriaId": "67C52D66-3BCA-4854-BF09-CB6DF1AC0E48"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.13:*:*:*:*:*:*:*", "matchCriteriaId": "BF54CC8D-B736-461D-B693-686E862EF969"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.14:*:*:*:*:*:*:*", "matchCriteriaId": "5E5EADE4-9E1B-4A1C-B3B5-ACF1287A19E7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.18:*:*:*:*:*:*:*", "matchCriteriaId": "053ACE9B-A146-42C0-ADB2-47F6119965D8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.19:*:*:*:*:*:*:*", "matchCriteriaId": "30B4F891-2A03-45A8-A49C-7F8B8F7D8407"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.21:*:*:*:*:*:*:*", "matchCriteriaId": "69E62AC4-954E-476C-98BE-C138E328AE7B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.22:*:*:*:*:*:*:*", "matchCriteriaId": "6B88385C-F5FB-401F-80D5-5BF11CE3C19D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.27:*:*:*:*:*:*:*", "matchCriteriaId": "11873AEA-5D6C-4AC0-915A-8A2869B2EFF5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.33:*:*:*:*:*:*:*", "matchCriteriaId": "5965032E-5BC0-4E69-B097-F9EE2B24C861"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.0.37:*:*:*:*:*:*:*", "matchCriteriaId": "35F21A5A-F9C0-4860-80AD-1D3937483F28"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "73F49A1D-BCA3-4772-8AB3-621CCC997B3A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.2:*:*:*:*:*:*:*", "matchCriteriaId": "F719DD8E-8379-43C3-97F9-DE350E457F7F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.3:*:*:*:*:*:*:*", "matchCriteriaId": "342BB65B-1358-441C-B59A-1756BCC6414A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.4:*:*:*:*:*:*:*", "matchCriteriaId": "8589B1E7-0D6D-44B4-A36E-8225C5D15828"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.6:*:*:*:*:*:*:*", "matchCriteriaId": "88FEEE64-899F-4F55-B829-641706E29E32"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.7:*:*:*:*:*:*:*", "matchCriteriaId": "D8597F56-BB14-480C-91CD-CAB96A9DDD8D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.8:*:*:*:*:*:*:*", "matchCriteriaId": "7F4C5C88-95A7-4DDA-BC2F-CAFA47B0D67A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.9:*:*:*:*:*:*:*", "matchCriteriaId": "5EB2323C-EFE2-407A-9AE9-8717FA9F8625"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.10:*:*:*:*:*:*:*", "matchCriteriaId": "6341F695-6034-4CC1-9485-ACD3A0E1A079"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.11:*:*:*:*:*:*:*", "matchCriteriaId": "D1DF5F19-ECD9-457F-89C6-6F0271CF4766"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.12:*:*:*:*:*:*:*", "matchCriteriaId": "446DB5E9-EF4C-4A53-911E-91A802AECA5D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.13:*:*:*:*:*:*:*", "matchCriteriaId": "5829BE6A-BC58-482B-9DA1-04FDD413A7A9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.14:*:*:*:*:*:*:*", "matchCriteriaId": "C85D20DF-702B-4F0B-922D-782474A4B663"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.15:*:*:*:*:*:*:*", "matchCriteriaId": "73A09785-3CA4-4797-A836-A958DCDC322F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.16:*:*:*:*:*:*:*", "matchCriteriaId": "C4DE3D79-0966-4E14-9288-7C269A2CEEC3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.17:*:*:*:*:*:*:*", "matchCriteriaId": "564F6A24-BEB3-4420-A633-8AD54C292436"}]}]}], "references": [{"url": "http://bugs.mysql.com/bug.php?id=27337", "source": "cve@mitre.org"}, {"url": "http://dev.mysql.com/doc/refman/5.1/en/news-5-1-18.html", "source": "cve@mitre.org"}, {"url": "http://lists.mysql.com/announce/470", "source": "cve@mitre.org"}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2008-02/msg00003.html", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/34765", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/25301", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/26073", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/26430", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27823", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/28637", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/28838", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/29443", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/30351", "source": "cve@mitre.org"}, {"url": "http://www.debian.org/security/2007/dsa-1413", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2008:028", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2007-0894.html", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2008-0364.html", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/473874/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/24011", "source": "cve@mitre.org"}, {"url": "http://www.securitytracker.com/id?1018070", "source": "cve@mitre.org"}, {"url": "http://www.ubuntu.com/usn/usn-588-1", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/1804", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/34348", "source": "cve@mitre.org"}, {"url": "https://issues.rpath.com/browse/RPL-1536", "source": "cve@mitre.org"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A9166", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1088", "comment": "CVE-2007-2692 - This technique demonstrates the importance of proper privilege separation and the risks of unchecked privileges in a database management system. It is a fundamental technique that can be used in various attacks, making it a high-priority target for defense strategies."}], "stix_bundle": {"Bundle": {"type": "bundle", "id": "bundle-1", "created_by": "cyber-security-expert", "created": "2023-02-20T14:30:00.000Z", "modified": "2023-02-20T14:30:00.000Z", "description": "STIX 2.1 bundle for CVE-2007-2692", "objects": [{"type": "indicator", "id": "indicator-1", "created_by": "cyber-security-expert", "created": "2023-02-20T14:30:00.000Z", "modified": "2023-02-20T14:30:00.000Z", "name": "Unauthorized Database Access", "description": "Detect unauthorized access to the database", "created_objects": [{"type": "course-of-action", "id": "coa-1", "description": "Implement proper privilege separation and restrict access to the database"}]}, {"type": "malicious-activity", "id": "ma-1", "created_by": "cyber-security-expert", "created": "2023-02-20T14:30:00.000Z", "modified": "2023-02-20T14:30:00.000Z", "name": "Database Access", "description": "Malicious actors exploiting the vulnerability to gain unauthorized access to the database", "objects": [{"type": "ttp", "id": "ttp-1", "description": "Use of publicly available exploits to gain unauthorized access to the database"}]}]}}, "technical_analysis": {"Introduction": "The CVE-2007-2692 vulnerability is a serious flaw in the MySQL database management system that allows attackers to gain unauthorized access to the database. This technical analysis provides an in-depth look at the vulnerability and its implications for security.", "Impact and Scope": "The impact of this vulnerability is significant, as it allows attackers to gain unrestricted access to the database, including sensitive data such as user credentials and financial information. The scope of this vulnerability is wide, as it affects all versions of MySQL 5.0.x and 5.1.x prior to the release of patches.", "Related MITRE ATT&CK Techniques": "The following MITRE ATT&CK techniques are related to this vulnerability: T1088 (Valid Accounts), T1204 (Exploitation of Remote Services), and T1190 (Exploit Public-Facing Application). These techniques can be used to exploit the vulnerability and gain unauthorized access to the database.", "Technical Details": "The vulnerability is caused by a flaw in the mysql_change_db function in MySQL 5.0.x and 5.1.x prior to the release of patches. This flaw allows an attacker to bypass security checks and gain unauthorized access to the database.", "Detection": "Detection of this vulnerability requires thorough analysis of database logs and system activity.", "Mitigation": "Mitigation of this vulnerability requires patching the affected systems as soon as possible, as well as implementing additional security measures such as restricting access to the database.", "Conclusion": "In conclusion, the CVE-2007-2692 vulnerability is a critical flaw in the MySQL database management system that requires immediate attention from security professionals. Patching the affected systems and implementing additional security measures are essential for preventing exploitation of this vulnerability."}, "executive_analysis": {"Overview": "The CVE-2007-2692 vulnerability is a critical flaw in the MySQL database management system that allows attackers to gain unauthorized access to the database.", "Business Impact": "This vulnerability has significant business implications, as it can compromise sensitive data and disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is significant, as it allows attackers to gain unrestricted access to the database, including sensitive data such as user credentials and financial information.", "Mitigation Strategies": "Mitigation strategies for this vulnerability should include patching the affected systems as soon as possible, as well as implementing additional security measures such as restricting access to the database.", "Recommendations": "For executives, the recommendations are to prioritize patching the affected systems and implementing additional security measures to prevent exploitation of this vulnerability.", "Conclusions": "In conclusion, the CVE-2007-2692 vulnerability is a critical flaw in the MySQL database management system that requires immediate attention from security professionals. Patching the affected systems and implementing additional security measures are essential for preventing exploitation of this vulnerability."}}