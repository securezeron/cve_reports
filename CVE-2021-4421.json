{"id": "CVE-2021-4421", "sourceIdentifier": "security@wordfence.com", "published": "2023-07-12T07:15:09.863", "lastModified": "2023-11-07T03:40:54.640", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Advanced Popups plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 1.1.1. This is due to missing or incorrect nonce validation on the metabox_popup_save() function. This makes it possible for unauthenticated attackers to save meta tags via a forged request granted they can trick a site administrator into performing an action such as clicking on a link."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}, {"source": "security@wordfence.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ashstonestudios:advanced_popups:*:*:*:*:*:wordpress:*:*", "versionEndIncluding": "1.1.1", "matchCriteriaId": "4DDAAA46-26E6-46D3-B316-12E45D7C8A5A"}]}]}], "references": [{"url": "https://blog.nintechnet.com/25-wordpress-plugins-vulnerable-to-csrf-attacks/", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}, {"url": "https://blog.nintechnet.com/more-wordpress-plugins-and-themes-vulnerable-to-csrf-attacks/", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}, {"url": "https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-1/", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}, {"url": "https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-2/", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}, {"url": "https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-3/", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}, {"url": "https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-4/", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}, {"url": "https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-5/", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}, {"url": "https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2548724%40advanced-popups&new=2548724%40advanced-popups&sfp_email=&sfph_mail=", "source": "security@wordfence.com", "tags": ["Patch"]}, {"url": "https://www.wordfence.com/threat-intel/vulnerabilities/id/dc7b51e5-6eb7-41ba-add3-f083fb34c5e1?source=cve", "source": "security@wordfence.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2021-4421 - Cross-Site Request Forgery (CSRF) vulnerability in Advanced Popups plugin for WordPress. Attackers can trick site administrators into performing actions by manipulating meta tags. This technique can be mitigated by validating nonces and performing additional checks."}, {"techniqueID": "T1190", "comment": "CVE-2021-4421 - CSRF vulnerability can be used to manipulate site functionality, which may lead to privilege escalation. This technique can be mitigated by implementing CSRF tokens and validating user input."}], "stix_bundle": {"objects": [{"type": "relationship", "id": "relationship--1", "description": "This relationship represents the vulnerability being exploited.", "objective_id_ref": "indicator--1", "subject_id_ref": "attack-pattern--1"}, {"type": "attack-pattern", "id": "attack-pattern--1", "name": "Cross-Site Request Forgery (CSRF) vulnerability in Advanced Popups plugin for WordPress", "description": "Exploit vector using Cross-Site Request Forgery (CSRF) vulnerability in Advanced Popups plugin for WordPress", "kill_chain_phases": [{"kill_chain_name": "mitre_attack", "phase_name": "Lateral Movement"}]}, {"type": "victim", "id": "victim--1", "name": "WordPress site using Advanced Popups plugin", "description": "WordPress site using vulnerable version of Advanced Popups plugin"}, {"type": "indicator", "id": "indicator--1", "name": "CSRF vulnerability in Advanced Popups plugin for WordPress", "description": "This indicator represents the vulnerable plugin and its exploitation", "observation_time": "2023-07-12T07:15:09.863", "stix_core_id": "cve:CVE-2021-4421", "x_opencti_external_id": "CVE-2021-4421"}], "relationships": [{"id": "relationship--1", "source_ref": "indicator--1", "target_ref": "attack-pattern--1"}]}, "technical_analysis": {"Introduction": "The Cross-Site Request Forgery (CSRF) vulnerability in Advanced Popups plugin for WordPress allows attackers to trick site administrators into performing malicious actions.", "Impact and Scope": "The vulnerability affects WordPress sites using vulnerable versions of the Advanced Popups plugin. The CVSS score is 4.3, with a network attack vector and low attack complexity.", "Related MITRE ATT&CK Techniques": "T1059: Command and Control - Cross-Site Request Forgery (CSRF) and T1190: Exploitation", "Technical Details": "The vulnerability is caused by missing or incorrect nonce validation in the metabox_popup_save() function.", "Detection": "Detection relies on identifying unusual user activity, such as tampering with meta tags, and monitoring for signs of CSRF exploitation.", "Mitigation": "Validating nonces and performing additional checks can help mitigate the vulnerability.", "Conclusion": "The Cross-Site Request Forgery (CSRF) vulnerability in Advanced Popups plugin for WordPress is a significant risk for WordPress sites and requires immediate attention to mitigate the threat."}, "executive_analysis": {"Overview": "The Cross-Site Request Forgery (CSRF) vulnerability in Advanced Popups plugin for WordPress is a significant risk for WordPress sites.", "Business Impact": "The vulnerability can lead to privilege escalation and unauthorized actions, potentially affecting business operations and revenue.", "Technical Impact": "The vulnerability affects WordPress sites using vulnerable versions of the Advanced Popups plugin, potentially causing data breaches and system compromise.", "Mitigation Strategies": "Implementing CSRF tokens, validating user input, and monitoring user activity can help mitigate the vulnerability.", "Recommendations": "Upgrade to a patched version of the Advanced Popups plugin, monitor user activity, and implement additional security measures to prevent CSRF exploitation.", "Conclusions": "Immediate attention is required to mitigate the Cross-Site Request Forgery (CSRF) vulnerability in Advanced Popups plugin for WordPress to protect WordPress sites and prevent potential business and technical impacts."}}