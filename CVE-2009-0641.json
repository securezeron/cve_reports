{"id": "CVE-2009-0641", "sourceIdentifier": "cve@mitre.org", "published": "2009-02-20T06:47:48.250", "lastModified": "2017-09-29T01:33:56.200", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "sys_term.c in telnetd in FreeBSD 7.0-RELEASE and other 7.x versions deletes dangerous environment variables with a method that was valid only in older FreeBSD distributions, which might allow remote attackers to execute arbitrary code by passing a crafted environment variable from a telnet client, as demonstrated by an LD_PRELOAD value that references a malicious library."}, {"lang": "es", "value": "sys_term.c en telnetd en FreeBSD v7.0-RELEASE y otras v7.x borra variables de entorno peligrosas con un m\u00e9todo que solo fue valido en distribuciones antiguas de FreeBSD, lo que permite a atacantes remotos ejecutar c\u00f3digo de su elecci\u00f3n a trav\u00e9s de un cliente de telnet de una variable de entorno manipulada, como se demuestra mediante el valor LD_PRELOAD que hace referencia a una librer\u00eda maliciosa."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.3}, "baseSeverity": "HIGH", "exploitabilityScore": 8.6, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-16"}, {"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "47E0A416-733A-4616-AE08-150D67FCEA70"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.0:beta_4:*:*:*:*:*:*", "matchCriteriaId": "CDFA5AA9-E73F-448D-9754-41AF9AECB93A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.0:current:*:*:*:*:*:*", "matchCriteriaId": "C4E775BA-6DC1-4006-83A4-D30EA57417FC"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.0-release:*:*:*:*:*:*:*", "matchCriteriaId": "EC290462-4364-464F-8CE9-6F5E5BE6F246"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.0_beta4:*:*:*:*:*:*:*", "matchCriteriaId": "F06B831E-D8F2-4380-B279-559CE103210F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.0_releng:*:*:*:*:*:*:*", "matchCriteriaId": "3ACC9072-4A33-4F1F-B790-2F9D5A52F71B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.1:*:*:*:*:*:*:*", "matchCriteriaId": "803EFA9F-B7CB-4511-B1C1-381170CA9A23"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:7.1:rc1:*:*:*:*:*:*", "matchCriteriaId": "52DBF406-9C77-4DDA-AB7D-40FAE40023D0"}]}]}], "references": [{"url": "http://lists.grok.org.uk/pipermail/full-disclosure/2009-February/067954.html", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://security.freebsd.org/advisories/FreeBSD-SA-09:05.telnetd.asc", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://www.securityfocus.com/bid/33777", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/48780", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/8055", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2009-0641 - An attacker can execute arbitrary code by passing a crafted environment variable from a telnet client, which may allow remote code execution. Defending against this requires implementing proper environment variable handling and input validation."}, {"techniqueID": "T1036", "comment": "CVE-2009-0641 - The vulnerability in the telnetd service allows an attacker to exploit the environment variable handling to execute arbitrary code. Defending against this requires implementing proper environment variable handling and input validation."}, {"techniqueID": "T1167", "comment": "CVE-2009-0641 - The telnetd service vulnerability can be exploited to execute arbitrary code by passing a crafted environment variable from a telnet client. Defending against this requires implementing proper environment variable handling and input validation."}], "stix_bundle": {"@stix2.1": {"bundle": {"description": "CVE-2009-0641 MITRE ATT&CK STIX Bundle", "entities": [{"type": "vulnerability", "id": "vuln-CVE-2009-0641", "created_by_ref": "user-1234", "created": "2022-02-20T06:47:48.250Z", "modified": "2022-02-20T06:47:48.250Z", "name": "CVE-2009-0641: FreeBSD Telnetd Environment Variable Handling Vulnerability", "description": "sys_term.c in telnetd in FreeBSD 7.0-RELEASE and other 7.x versions deletes dangerous environment variables with a method that was valid only in older FreeBSD distributions, which might allow remote attackers to execute arbitrary code by passing a crafted environment variable from a telnet client, as demonstrated by an LD_PRELOAD value that references a malicious library.", "labels": ["vulnerability", "FreeBSD", "Telnetd", "Environment Variable Handling"], "objects": []}, {"type": "technique", "id": "tech-T1190", "created_by_ref": "user-1234", "created": "2022-02-20T06:47:48.250Z", "modified": "2022-02-20T06:47:48.250Z", "name": "Command and Control - Environment Variable Manipulation", "description": "Attackers use environment variables to inject malicious code into system processes.", "labels": ["technique", "Command and Control", "Environment Variable Manipulation"], "objects": []}, {"type": "course_of_action", "id": "coa-1", "created_by_ref": "user-1234", "created": "2022-02-20T06:47:48.250Z", "modified": "2022-02-20T06:47:48.250Z", "name": "Update to a patched version of telnetd", "description": "Update telnetd to a patched version to mitigate the vulnerability.", "techniques": ["tech-T1190"], "notes": ["Update telnetd to a patched version to mitigate the vulnerability."]}], "relationships": [{"type": "related_to", "id": "rel-1", "source_ref": "vuln-CVE-2009-0641", "target_ref": "tech-T1190", "label": "exploits", "description": "The vulnerability can be exploited using the Command and Control - Environment Variable Manipulation technique."}, {"type": "mitigated_by", "id": "rel-2", "source_ref": "vuln-CVE-2009-0641", "target_ref": "coa-1", "label": "course_of_action", "description": "The vulnerability can be mitigated by updating to a patched version of telnetd."}]}}}, "technical_analysis": {"Introduction": "The FreeBSD telnetd vulnerability (CVE-2009-0641) allows remote attackers to execute arbitrary code by passing a crafted environment variable from a telnet client.", "Impact and Scope": "The vulnerability has a CVSS score of 9.3, with a high impact on confidentiality, integrity, and availability. It affects telnetd in FreeBSD 7.0-RELEASE and other 7.x versions.", "Related MITRE ATT&CK Techniques": "The vulnerability can be exploited using the Command and Control - Environment Variable Manipulation technique (T1190).", "Technical Details": "The vulnerability is caused by the telnetd service deleting environment variables using a method that was valid only in older FreeBSD distributions.", "Detection": "Detecting the vulnerability may involve monitoring telnetd logs for suspicious environment variable activity.", "Mitigation": "The vulnerability can be mitigated by updating to a patched version of telnetd.", "Conclusion": "The FreeBSD telnetd vulnerability (CVE-2009-0641) is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The FreeBSD telnetd vulnerability (CVE-2009-0641) is a critical vulnerability that allows remote attackers to execute arbitrary code.", "Business Impact": "The vulnerability has a high business impact, as it can compromise sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability has a high technical impact, as it can allow attackers to execute arbitrary code on compromised systems.", "Mitigation Strategies": "Updating to a patched version of telnetd is the recommended mitigation strategy.", "Recommendations": "Executives should prioritize updating to a patched version of telnetd and ensure that all systems are properly configured to mitigate the vulnerability.", "Conclusions": "The FreeBSD telnetd vulnerability (CVE-2009-0641) is a critical vulnerability that requires immediate attention and mitigation."}}