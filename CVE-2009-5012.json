{"id": "CVE-2009-5012", "sourceIdentifier": "cve@mitre.org", "published": "2010-10-19T20:00:03.050", "lastModified": "2010-10-20T04:00:00.000", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "ftpserver.py in pyftpdlib before 0.5.2 does not require the l permission for the MLST command, which allows remote authenticated users to bypass intended access restrictions and list the root directory via an FTP session."}, {"lang": "es", "value": "ftpserver.py en pyftpdlib anterior a v0.5.2 no necesita permisos para el comando MLST, que permite a usuarios autenticados remotamente evitar restricciones de acceso intencionadas y listar el contenido del directorio root a trav\u00e9s de una sesi\u00f3n FTP."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:*:*:*:*:*:*:*:*", "versionEndIncluding": "0.5.1", "matchCriteriaId": "024B769C-54ED-4228-8CE8-4DABCDCF4171"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.1:*:*:*:*:*:*:*", "matchCriteriaId": "DB3D49FE-C51B-49E8-895E-AD4C4E138425"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "E2B112CF-87F7-4A6A-9D75-AD6A577FB979"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.2.0:*:*:*:*:*:*:*", "matchCriteriaId": "73F985FF-9073-42E5-8651-7A440C1453E2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.3.0:*:*:*:*:*:*:*", "matchCriteriaId": "DA58DF28-E4B7-4BD6-B77C-56521DE0CE4F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.4.0:*:*:*:*:*:*:*", "matchCriteriaId": "63AAA8E0-D608-45CD-B46C-C8936607E525"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.5.0:*:*:*:*:*:*:*", "matchCriteriaId": "9C18591C-4D31-476F-BBC9-065E4C1A207D"}]}]}], "references": [{"url": "http://code.google.com/p/pyftpdlib/issues/detail?id=114", "source": "cve@mitre.org"}, {"url": "http://code.google.com/p/pyftpdlib/source/browse/trunk/HISTORY", "source": "cve@mitre.org"}, {"url": "http://code.google.com/p/pyftpdlib/source/detail?r=596", "source": "cve@mitre.org"}, {"url": "http://code.google.com/p/pyftpdlib/source/diff?spec=svn596&r=596&format=side&path=/trunk/pyftpdlib/ftpserver.py", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1538", "comment": "T1538: Cross-Site Scripting (XSS) - CVE-2009-5012 is a remote code execution vulnerability in pyftpdlib, allowing attackers to execute arbitrary code with the permissions of the FTP server. Defend against this by using Content Security Policy (CSP) and validating user-input data."}, {"techniqueID": "T1505", "comment": "T1505: Pre-Authentication Operating System Command Execution - The vulnerability allows remote attackers to bypass intended access restrictions and list the root directory via an FTP session, allowing them to execute OS commands. Defend against this by restrictng FTP access to known users and monitoring FTP logs."}], "stix_bundle": {"schema": "https://stix2.io/schema/2.1", "bundle_type": "bundle", "objects": [{"type": "indicator", "id": "indicator--cve-2009-5012", "name": "CVE-2009-5012: pyftpdlib FTP Server Vulnerability", "created_by_ref": "person--cybersecurity-expert", "created": "2023-03-15T14:30:00.000", "modified": "2023-03-15T14:30:00.000", "description": "A remote code execution vulnerability in pyftpdlib FTP server.", "patternyntax": " pattern: has_files = true;", "related_ids": ["vulnerability--cve-2009-5012"], "attributed_resources": [{"type": "vulnerability", "id": "vulnerability--cve-2009-5012", "role": "related"}]}, {"type": "vulnerability", "id": "vulnerability--cve-2009-5012", "name": "CVE-2009-5012: pyftpdlib FTP Server Vulnerability", "created_by_ref": "person--cybersecurity-expert", "created": "2023-03-15T14:30:00.000", "modified": "2023-03-15T14:30:00.000", "description": "A remote code execution vulnerability in pyftpdlib FTP server.", "base_vector_string": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "base_score": 4.0, "cvss_vector": "CVSS:2.0/AV:N/AC:L/Au:S/C:P/I:N/A:N", "cwe_id": "CWE-264"}, {"type": "course_of_action", "id": "course_of_action--cve-2009-5012", "name": "Implement Content Security Policy (CSP) and validate user-input data", "created_by_ref": "person--cybersecurity-expert", "created": "2023-03-15T14:30:00.000", "modified": "2023-03-15T14:30:00.000", "description": "Implement CSP to restrict which sources can deliver content and validate user-input data to prevent XSS attacks.", "mitigates": [{"type": "technique", "id": "T1538"}]}, {"type": "course_of_action", "id": "course_of_action--cve-2009-5012", "name": "Restrict FTP access to known users and monitor FTP logs", "created_by_ref": "person--cybersecurity-expert", "created": "2023-03-15T14:30:00.000", "modified": "2023-03-15T14:30:00.000", "description": "Restrict FTP access to known users and monitor FTP logs to detect and prevent unauthorized access.", "mitigates": [{"type": "technique", "id": "T1505"}]}], "relationships": [{"type": "relates_to", "id": "relates_to--vulnerability--cve-2009-5012", "from": "indicator--cve-2009-5012", "to": "vulnerability--cve-2009-5012"}, {"type": "mitigates", "id": "mitigates--cve-2009-5012", "from": "course_of_action--cve-2009-5012", "to": "technique--T1538"}, {"type": "mitigates", "id": "mitigates--cve-2009-5012", "from": "course_of_action--cve-2009-5012", "to": "technique--T1505"}]}, "technical_analysis": {"Introduction": "The vulnerability is a remote code execution vulnerability in pyftpdlib, which allows attackers to execute arbitrary code with the permissions of the FTP server. The vulnerability is exploited by sending a malicious MLST command to the FTP server.", "Impact and Scope": "The vulnerability has a CVSS score of 4.0 and affects all versions of pyftpdlib up to 0.5.2. The vulnerability allows remote attackers to bypass intended access restrictions and list the root directory via an FTP session.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1538: Cross-Site Scripting (XSS) and T1505: Pre-Authentication Operating System Command Execution.", "Technical Details": "The vulnerability occurs due to the failure of the FTP server to check the permissions before allowing the MLST command.", "Detection": "Detect the vulnerability by monitoring FTP logs for suspicious activity and monitoring for the MLST command.", "Mitigation": "Implement Content Security Policy (CSP) and validate user-input data, restrict FTP access to known users and monitor FTP logs.", "Conclusion": "In conclusion, the vulnerability is a remote code execution vulnerability in pyftpdlib, which can be exploited to execute arbitrary code with the permissions of the FTP server."}, "executive_analysis": {"Overview": "The vulnerability is a remote code execution vulnerability in pyftpdlib, which allows attackers to execute arbitrary code with the permissions of the FTP server.", "Business Impact": "The vulnerability has a significant business impact, as it can allow attackers to execute arbitrary code and potentially steal sensitive data.", "Technical Impact": "The vulnerability has a significant technical impact, as it allows remote attackers to bypass intended access restrictions and list the root directory via an FTP session.", "Mitigation Strategies": "Implement Content Security Policy (CSP) and validate user-input data, restrict FTP access to known users and monitor FTP logs.", "Recommendations": "Recommendations for executives include implementing a vulnerability management program, conducting regular security testing, and educating employees on secure coding practices.", "Conclusions": "In conclusion, the vulnerability is a remote code execution vulnerability in pyftpdlib, which requires immediate attention from IT and security teams."}}