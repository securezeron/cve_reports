{"id": "CVE-2009-0687", "sourceIdentifier": "cret@cert.org", "published": "2009-08-11T10:30:00.217", "lastModified": "2017-09-29T01:33:57.933", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The pf_test_rule function in OpenBSD Packet Filter (PF), as used in OpenBSD 4.2 through 4.5, NetBSD 5.0 before RC3, MirOS 10 and earlier, and MidnightBSD 0.3-current allows remote attackers to cause a denial of service (panic) via crafted IP packets that trigger a NULL pointer dereference during translation, related to an IPv4 packet with an ICMPv6 payload."}, {"lang": "es", "value": "La funci\u00f3n pf_test_rule de OpenBSD Packet Filter (PF), tal como es usada en OpenBSD v4.2 hasta v4.5, NetBSD v5.0 anterior a RC3, MirOS v10 y anteriores y MidnightBSD v0.3 hasta la versi\u00f3n actual permite a atacantes remotos causar una denegaci\u00f3n de servicio a trav\u00e9s de paquetes IP modificados que provocan una \"desreferencia\" de un puntero nulo relacionada con un paquete IPv4 con datos (\"payload\") ICMPv6."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "COMPLETE", "baseScore": 7.8}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-399"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:midnightbsd:midnightbsd:0.3-current:*:*:*:*:*:*:*", "matchCriteriaId": "0BB266CE-0E06-4094-AE00-0ADBD2364F22"}, {"vulnerable": true, "criteria": "cpe:2.3:o:mirbsd:miros:*:*:*:*:*:*:*:*", "versionEndIncluding": "10", "matchCriteriaId": "A6A4B5B9-C443-4A85-852D-F3B71732BCDA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:netbsd:netbsd:5.0:*:*:*:*:*:*:*", "matchCriteriaId": "00564BAA-066A-4627-B6A8-78724E55D363"}, {"vulnerable": true, "criteria": "cpe:2.3:o:openbsd:openbsd:4.2:*:*:*:*:*:*:*", "matchCriteriaId": "9DF8DD37-A337-4E9D-A34E-C2D561A24285"}, {"vulnerable": true, "criteria": "cpe:2.3:o:openbsd:openbsd:4.3:*:*:*:*:*:*:*", "matchCriteriaId": "F12313A0-1EAF-4652-9AB1-799171CFFEA9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:openbsd:openbsd:4.4:*:*:*:*:*:*:*", "matchCriteriaId": "89CA041B-4153-43C7-BA69-D6052F4EBEEB"}, {"vulnerable": true, "criteria": "cpe:2.3:o:openbsd:openbsd:4.5:*:*:*:*:*:*:*", "matchCriteriaId": "B32BB973-60E5-402B-83FE-547786BC7A57"}]}]}], "references": [{"url": "ftp://ftp.openbsd.org/pub/OpenBSD/patches/4.3/common/013_pf.patch", "source": "cret@cert.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://ftp.netbsd.org/pub/NetBSD/security/advisories/NetBSD-SA2009-001.txt.asc", "source": "cret@cert.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.helith.net/txt/multiple_vendor-PF_null_pointer_dereference.txt", "source": "cret@cert.org"}, {"url": "http://www.openbsd.org/errata43.html#013_pf", "source": "cret@cert.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.openbsd.org/errata44.html#013_pf", "source": "cret@cert.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.openbsd.org/errata45.html#002_pf", "source": "cret@cert.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.osvdb.org/53608", "source": "cret@cert.org"}, {"url": "http://www.securityfocus.com/archive/1/502634", "source": "cret@cert.org"}, {"url": "http://www.vupen.com/english/advisories/2009/1015", "source": "cret@cert.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/49837", "source": "cret@cert.org"}, {"url": "https://www.exploit-db.com/exploits/8406", "source": "cret@cert.org"}, {"url": "https://www.exploit-db.com/exploits/8581", "source": "cret@cert.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2009-0687 - An attacker can exploit this vulnerability to perform a denial of service (DoS) attack by sending a crafted IP packet with an ICMPv6 payload, which can cause a NULL pointer dereference in the pf_test_rule function, leading to a system crash. Defending against this attack requires configuring the firewall to restrict network traffic and implementing safeguards to prevent unexpected packets from being processed."}], "stix_bundle": {"objects": [{"id": "vulnerability-2009-0687", "type": "vulnerability", "name": "OpenBSD Packet Filter (PF) NULL Pointer Dereference Vulnerability (CVE-2009-0687)", "description": "The pf_test_rule function in OpenBSD Packet Filter (PF) allows remote attackers to cause a denial of service (panic) via crafted IP packets that trigger a NULL pointer dereference during translation, related to an IPv4 packet with an ICMPv6 payload.", "severity": "High"}, {"id": "technique-t1190", "type": "attack-pattern", "name": "Null Pointer Dereference", "description": "An attacker uses a NULL pointer dereference vulnerability to cause a denial of service (DoS) attack."}], "relationships": [{"id": "rel-2009-0687-t1190", "type": "related", "source_ref": "vulnerability-2009-0687", "target_ref": "technique-t1190"}]}, "technical_analysis": {"Introduction": "CVE-2009-0687 is a NULL pointer dereference vulnerability in the OpenBSD Packet Filter (PF) due to insufficient input validation.", "Impact and Scope": "The vulnerability allows an attacker to cause a denial of service (DoS) attack by sending a crafted IP packet with an ICMPv6 payload, which can cause a NULL pointer dereference in the pf_test_rule function, leading to a system crash.", "Related MITRE ATT&CK Techniques": "T1190: Null Pointer Dereference", "Technical Details": "The vulnerability is caused by a lack of input validation in the pf_test_rule function, which can lead to a NULL pointer dereference when processing IPv4 packets with ICMPv6 payloads.", "Detection": "Detect this vulnerability by monitoring system logs for evidence of crafted IP packets with ICMPv6 payloads.", "Mitigation": "Implement safeguards to prevent unexpected packets from being processed and restrict network traffic to limit the potential attack surface.", "Conclusion": "CVE-2009-0687 is a significant vulnerability that requires immediate attention and mitigation to prevent costly DoS attacks."}, "executive_analysis": {"Overview": "CVE-2009-0687 is a critical vulnerability in OpenBSD Packet Filter (PF) that allows an attacker to cause a denial of service (DoS) attack.", "Business Impact": "This vulnerability can cause business disruption and losses due to system crashes and downtime.", "Technical Impact": "This vulnerability can lead to a system crash, causing significant technical impact.", "Mitigation Strategies": "Implement safeguards to prevent unexpected packets from being processed and restrict network traffic to limit the potential attack surface.", "Recommendations": "Implement a vulnerability management program to address this vulnerability and other potential security issues.", "Conclusions": "Immediate attention is required to mitigate this vulnerability and prevent costly DoS attacks."}}