{"id": "CVE-2007-4661", "sourceIdentifier": "cve@mitre.org", "published": "2007-09-04T22:17:00.000", "lastModified": "2018-10-03T21:48:22.217", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The chunk_split function in string.c in PHP 5.2.3 does not properly calculate the needed buffer size due to precision loss when performing integer arithmetic with floating point numbers, which has unknown attack vectors and impact, possibly resulting in a heap-based buffer overflow.  NOTE: this is due to an incomplete fix for CVE-2007-2872."}, {"lang": "es", "value": "La funci\u00f3n chunk_split en string.c en PHP 5.2.3 no calcula adecuadamente el tama\u00f1o de b\u00fafer necesario debido a la p\u00e9rdida de precisi\u00f3n cuando se realizan operaciones de entero con n\u00fameros con punto flotante, lo cual tiene vectores de ataque e impacto desconocido, posiblemente como resultado de un desbordamiento de b\u00fafer basado en pila. NOTA: esto puede ser debido a un parche incompleto para CVE-2007-2872."}], "vendorComments": [{"organization": "Mandriva", "comment": "Not vulnerable. Mandriva has not issued an update to date to fix CVE-2007-2872 and the updates in progress are using a correct fix.", "lastModified": "2007-09-18T00:00:00"}, {"organization": "Red Hat", "comment": "Not vulnerable.  Red Hat did not include an incomplete fix for CVE-2007-2872 for PHP in Red Hat Enterprise Linux or Red Hat Application Stack.", "lastModified": "2007-09-05T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}, {"lang": "en", "value": "CWE-399"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.2.3:*:*:*:*:*:*:*", "matchCriteriaId": "86767200-6C9C-4C3E-B111-0E5BE61E197B"}]}]}], "references": [{"url": "http://cvs.php.net/viewvc.cgi/php-src/ext/standard/string.c?r1=1.445.2.14.2.58&r2=1.445.2.14.2.59", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2008-01/msg00006.html", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/26642", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://secunia.com/advisories/26838", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27102", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27864", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/28658", "source": "cve@mitre.org"}, {"url": "http://www.gentoo.org/security/en/glsa/glsa-200710-02.xml", "source": "cve@mitre.org"}, {"url": "http://www.php.net/ChangeLog-5.php#5.2.4", "source": "cve@mitre.org"}, {"url": "http://www.php.net/releases/5_2_4.php", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://www.ubuntu.com/usn/usn-549-2", "source": "cve@mitre.org"}, {"url": "https://issues.rpath.com/browse/RPL-1702", "source": "cve@mitre.org"}, {"url": "https://launchpad.net/bugs/173043", "source": "cve@mitre.org"}, {"url": "https://usn.ubuntu.com/549-1/", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1022", "comment": "CVE-2007-4661 - Exploitation of a buffer overflow vulnerability in PHP's chunk_split function, enabling attackers to execute arbitrary code, requiring a low skill level and network access."}, {"techniqueID": "T1499", "comment": "CVE-2007-4661 - Using a script to exploit the buffer overflow vulnerability in PHP's chunk_split function, which can be used by an attacker to gain unauthorized access to a system, requiring a low skill level and network access."}, {"techniqueID": "T1190", "comment": "CVE-2007-4661 - Exploitation of a buffer overflow vulnerability in PHP's chunk_split function, allowing an attacker to execute arbitrary code, requiring a low skill level and network access."}], "stix_bundle": {"@stix2.1.1": "Bundle:", "stix_bundle": {"objects": [{"id": "CVE-2007-4661", "type": "vulnerability", "label": "PHP 5.2.3 - Buffer Overflow in chunk_split Function"}, {"id": "T1022", "type": "attack-pattern", "label": "Buffer Overflow via Chunk Split Function"}, {"id": "T1499", "type": "attack-pattern", "label": "Scripted Execution of Malicious Code"}, {"id": "T1190", "type": "attack-pattern", "label": "Exploitation of Buffer Overflow"}], "relationships": [{"id": "cve-2007-4661", "type": "relates", "start": "CVE-2007-4661", "end": "T1022"}, {"id": "cve-2007-4661", "type": "relates", "start": "CVE-2007-4661", "end": "T1499"}, {"id": "cve-2007-4661", "type": "relates", "start": "CVE-2007-4661", "end": "T1190"}]}}, "technical_analysis": {"Introduction": "The CVE-2007-4661 vulnerability is a buffer overflow vulnerability in PHP's chunk_split function, allowing an attacker to execute arbitrary code with a low skill level and network access.", "Impact and Scope": "The vulnerability affects PHP 5.2.3 and has a CVSS score of 7.5 with a vector string of AV:N/AC:L/Au:N/C:P/I:P/A:P, indicating it is a serious vulnerability with a high potential for exploitation.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the T1022, T1499, and T1190 MITRE ATT&CK techniques, which involve exploiting buffer overflow vulnerabilities, scripted execution of malicious code, and exploitation of buffer overflow vulnerabilities, respectively.", "Technical Details": "The vulnerability occurs when the chunk_split function in PHP 5.2.3 fails to properly calculate the needed buffer size due to precision loss when performing integer arithmetic with floating point numbers.", "Detection": "Detecting the vulnerability involves monitoring network traffic for suspicious activity, such as unusual network packets, and analyzing system logs for signs of exploitation.", "Mitigation": "Mitigating the vulnerability involves updating to a patched version of PHP 5.2.3, implementing input validation and sanitization, and monitoring system logs for signs of exploitation.", "Conclusion": "The CVE-2007-4661 vulnerability is a serious vulnerability with a high potential for exploitation, and it is essential to take proactive measures to mitigate it."}, "executive_analysis": {"Overview": "The CVE-2007-4661 vulnerability is a critical vulnerability in PHP 5.2.3 that allows attackers to execute arbitrary code with a low skill level and network access.", "Business Impact": "The vulnerability has a significant business impact, as it can be exploited to steal sensitive data, disrupt business operations, and compromise customer trust.", "Technical Impact": "The vulnerability has a significant technical impact, as it allows attackers to execute arbitrary code, giving them access to sensitive data, and disrupting business operations.", "Mitigation Strategies": "Mitigation strategies include updating to a patched version of PHP 5.2.3, implementing input validation and sanitization, and monitoring system logs for signs of exploitation.", "Recommendations": "Recommendations for executives include prioritizing vulnerability remediation, implementing proactive monitoring, and conducting regular security assessments.", "Conclusions": "The CVE-2007-4661 vulnerability is a critical vulnerability that requires immediate attention and remediation to prevent exploitation and minimize business impact."}}