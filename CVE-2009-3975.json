{"id": "CVE-2009-3975", "sourceIdentifier": "cve@mitre.org", "published": "2009-11-18T23:30:00.750", "lastModified": "2017-09-19T01:29:51.983", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "SQL injection vulnerability in index.php in Moa Gallery 1.1.0 and 1.2.0 allows remote attackers to execute arbitrary SQL commands via the gallery_id parameter in a gallery_view action."}, {"lang": "es", "value": "Vulnerabilidad de inyecci\u00f3n SQL en index.php en Moa Gallery v 1.1.0 y v1.2.0, permite a atacantes remotos ejecutar comandos SQL de su elecci\u00f3n a trav\u00e9s del par\u00e1metro gallery_id  en una acci\u00f3n a gallery_view."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:moagallery:moa:1.1.0:*:*:*:*:*:*:*", "matchCriteriaId": "55E5FF2C-F1D2-4C0D-BCCE-B25C2EC64405"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moagallery:moa:1.2.0:*:*:*:*:*:*:*", "matchCriteriaId": "26B7D6E8-2485-4348-88C2-59D196533EAE"}]}]}], "references": [{"url": "http://secunia.com/advisories/36449", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.exploit-db.com/exploits/9481", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2009/2399", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/52707", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059.005", "comment": "CVE-2009-3975 - This SQL injection vulnerability allows attackers to execute arbitrary SQL commands, exploited through the gallery_id parameter in a gallery_view action."}, {"techniqueID": "T1190", "comment": "CVE-2009-3975 - This vulnerability can be exploited through the gallery_id parameter to inject malicious SQL code, this can be used by attackers to perform privilege escalation or data exfiltration attacks."}, {"techniqueID": "T1027", "comment": "CVE-2009-3975 - This vulnerability can be exploited to inject malicious SQL code, which can be used to retrieve sensitive data, this can be used by attackers to perform reconnaissance on the targeted system."}], "stix_bundle": {"description": "STIX Bundle for CVE-2009-3975", "objects": [{"type": "vulnerability", "id": "CVE-2009-3975", "name": "SQL Injection in Moa Gallery", "description": "A SQL injection vulnerability in index.php in Moa Gallery 1.1.0 and 1.2.0 allows remote attackers to execute arbitrary SQL commands via the gallery_id parameter in a gallery_view action.", "related_object": {"type": "attack-pattern", "id": "T1059.005", "relationship": "related_to"}}, {"type": "attack-pattern", "id": "T1059.005", "name": "SQL Injection Using Parameter Injection", "description": "An attack pattern in which an attacker injects malicious SQL code into a web application using parameter injection."}, {"type": "attack-pattern", "id": "T1190", "name": " Exploit Public-Facing Application", "description": "An attack pattern in which an attacker exploits a publicly facing application to gain access to the targeted system."}, {"type": "attack-pattern", "id": "T1027", "name": "Query File or Extension", "description": "An attack pattern in which an attacker uses a query file or extension to execute arbitrary SQL code."}, {"type": "course-of-action", "id": "mitigation", "name": "Mitigation", "description": "Apply patches, disable the gallery_id parameter, or implement input validation and sanitization to prevent SQL injection attacks."}]}, "technical_analysis": {"Introduction": "Moa Gallery version 1.1.0 and 1.2.0 suffers from a SQL injection vulnerability due to insufficient input validation and sanitization.", "Impact and Scope": "The vulnerability allows remote attackers to execute arbitrary SQL commands, which can be used to retrieve sensitive data, disrupt system operations, or compromise the entire system.", "Related MITRE ATT&CK Techniques": "T1059.005, T1190, and T1027 are related MITRE ATT&CK techniques that can be used to exploit this vulnerability.", "Technical Details": "The vulnerability is caused by insufficient input validation and sanitization of the gallery_id parameter in the gallery_view action, allowing attackers to inject malicious SQL code.", "Detection": "Detection can be done by monitoring database logs for suspicious queries, monitoring network traffic for SQL injection exploits, and implementing web application firewalls to block malicious traffic.", "Mitigation": "Apply patches, disable the gallery_id parameter, or implement input validation and sanitization to prevent SQL injection attacks.", "Conclusion": "This vulnerability highlights the importance of ensuring proper input validation and sanitization in web applications to prevent SQL injection attacks."}, "executive_analysis": {"Overview": "Moa Gallery version 1.1.0 and 1.2.0 suffers from a SQL injection vulnerability that can be exploited to gain unauthorized access to the system.", "Business Impact": "This vulnerability can result in sensitive data being compromised, system downtime, and reputational damage.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary SQL commands, which can be used to retrieve sensitive data, disrupt system operations, or compromise the entire system.", "Mitigation Strategies": "Apply patches, disable the gallery_id parameter, or implement input validation and sanitization to prevent SQL injection attacks.", "Recommendations": "Ensure proper input validation and sanitization in web applications, regularly update software and plugins, and implement a web application firewall to prevent malicious traffic.", "Conclusions": "This vulnerability highlights the importance of ensuring proper input validation and sanitization in web applications to prevent SQL injection attacks."}}