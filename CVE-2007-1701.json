{"id": "CVE-2007-1701", "sourceIdentifier": "cve@mitre.org", "published": "2007-03-27T01:19:00.000", "lastModified": "2019-10-09T22:52:34.790", "vulnStatus": "Modified", "cveTags": [], "evaluatorImpact": "Successful exploitation requires that variable \"register_globals\" is enabled.", "descriptions": [{"lang": "en", "value": "PHP 4 before 4.4.5, and PHP 5 before 5.2.1, when register_globals is enabled, allows context-dependent attackers to execute arbitrary code via deserialization of session data, which overwrites arbitrary global variables, as demonstrated by calling session_decode on a string beginning with \"_SESSION|s:39:\"."}, {"lang": "es", "value": "PHP 4 anterior a 4.4.5, y PHP 5 anterior a 5.2.1, cuando register_globals est\u00e1 activado, permiten a atacantes locales o remotos dependiendo del contexto ejecutar c\u00f3digo de su elecci\u00f3n mediante una deserializaci\u00f3n de los datos de sesi\u00f3n, lo cual sobrescribe variables globales de su elecci\u00f3n, como se ha demostrado llamando a session-decode en una cadena que comience con \"_SESSION|s:39:\"."}], "vendorComments": [{"organization": "Red Hat", "comment": "This CVE name is a duplicate as the vulnerability is addressed by CVE-2007-0910.\n", "lastModified": "2007-05-01T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-502"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.4.5", "matchCriteriaId": "FCAA3859-EAB8-4F6E-84FE-4DBBF9B1A251"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.0.0", "versionEndExcluding": "5.2.1", "matchCriteriaId": "E8CF9623-B049-425F-ADC0-3E7E94E2F7A3"}]}]}], "references": [{"url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?lang=en&cc=us&objectID=c01056506", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?lang=en&cc=us&objectID=c01086137", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/25423", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/25445", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/25850", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://security.gentoo.org/glsa/glsa-200705-19.xml", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.php-security.org/MOPB/MOPB-31-2007.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.securityfocus.com/bid/23120", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.vupen.com/english/advisories/2007/1991", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2007/2374", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/33658", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A11034", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1047", "comment": " CVE-2007-1701 - Exploring the PHP session mechanism to execute arbitrary code. Defend against this by disabling register_globals and validating user input."}, {"techniqueID": "T1140", "comment": " CVE-2007-1701 - Using the PHP session mechanism to inject malicious code. Defend against this by validating user input and securing the session mechanism."}, {"techniqueID": "T1190", "comment": " CVE-2007-1701 - Using a PHP deserialization vulnerability to execute arbitrary code. Defend against this by validating user input and using secure deserialization mechanisms."}], "stix_bundle": {"bundle": {"type": "indicator", "id": "bundle:cve-2007-1701", "created_by_ref": "user:StixBundleCreator", "created": "2022-01-01T00:00:00.000", "modified": "2022-01-01T00:00:00.000", "name": "CVE-2007-1701 Bundle", "description": "STIX Bundle for CVE-2007-1701", "objects": [{"type": "indicator", "id": "indicator:cve-2007-1701", "created_by_ref": "user:StixBundleCreator", "created": "2022-01-01T00:00:00.000", "modified": "2022-01-01T00:00:00.000", "name": "CVE-2007-1701 Indicator", "description": "Indicator for CVE-2007-1701", "first_seen": "2007-03-27T01:19:00.000", "last_seen": "2007-03-27T01:19:00.000", "confidence": 90, "risk_score": 80, "related_sigs": [{"type": "indicator", "id": "indicator:cve-2007-0910", "name": "CVE-2007-0910 Indicator", "description": "Indicator for CVE-2007-0910"}], "related_course_of_action": [{"type": "course_of_action", "id": "course_of_action: disable-register-globals", "name": "Disable register_globals", "description": "Disable register_globals to prevent exploitation of CVE-2007-1701", "mitigates": ["indicator:cve-2007-1701"]}], "notes": [{"type": "note", "id": "note:php-session-security", "text": "PHP session security is crucial to prevent exploitation of CVE-2007-1701"}]}, {"type": "tactic", "id": "tactic:cvr-enhanced", "created_by_ref": "user:StixBundleCreator", "created": "2022-01-01T00:00:00.000", "modified": "2022-01-01T00:00:00.000", "name": "CVR Enhanced Tactic", "description": "Enhanced tactic for CVE-2007-1701", "related_stix_object": ["indicator:cve-2007-1701"]}]}}, "technical_analysis": {"Introduction": "CVE-2007-1701 is a PHP deserialization vulnerability that allows an attacker to execute arbitrary code by exploiting the session mechanism.", "Impact and Scope": "CVSS Score: 6.8, Attack Vector: NETWORK, Attack Complexity: MEDIUM", "Related MITRE ATT&CK Techniques": "T1047, T1140, T1190", "Technical Details": "The vulnerability occurs when register_globals is enabled in PHP, allowing an attacker to inject malicious code into the PHP session mechanism.", "Detection": "Detect the vulnerability by monitoring PHP session data for suspicious activity.", "Mitigation": "Disable register_globals and validate user input to prevent exploitation.", "Conclusion": "CVE-2007-1701 is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2007-1701 is a PHP deserialization vulnerability that poses a significant risk to web applications.", "Business Impact": "The vulnerability can lead to unauthorized access and data theft.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary code, compromising the integrity of the system.", "Mitigation Strategies": "Disable register_globals, validate user input, and secure the PHP session mechanism.", "Recommendations": "Implement security patches, conduct regular vulnerability assessments, and educate developers on secure coding practices.", "Conclusions": "CVE-2007-1701 is a critical vulnerability that requires immediate attention and mitigation."}}