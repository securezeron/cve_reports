{"id": "CVE-2009-3250", "sourceIdentifier": "cve@mitre.org", "published": "2009-09-18T20:30:00.313", "lastModified": "2017-09-19T01:29:31.687", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The saveForwardAttachments procedure in the Compose Mail functionality in vtiger CRM 5.0.4 allows remote authenticated users to execute arbitrary code by composing an e-mail message with an attachment filename ending in (1) .php in installations based on certain Apache HTTP Server configurations, (2) .php. on Windows, or (3) .php/ on Linux, and then making a direct request to a certain pathname under storage/."}, {"lang": "es", "value": "El procedimiento \"saveForwardAttachments\" de la funcionalidad \"Crear correo\" de vtiger CRM v5.0.4 permite a usuarios remotos autenticados ejecutar c\u00f3digo de su elecci\u00f3n creando un mensaje de correo electr\u00f3nico con un fichero adjunto cuyo nombre acabe en (1) .php en entornos basados en configuraciones determinadas del servidor HTTP Apache, (2) .php. en Windows, o (3) .php/ en Linux; y, a continuaci\u00f3n, realizando una petici\u00f3n directa a una ruta de directorio bajostorage/."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:vtiger:vtiger_crm:5.0.4:*:*:*:*:*:*:*", "matchCriteriaId": "84AE51A9-59AF-47F9-8AFC-5219505FD170"}]}]}], "references": [{"url": "http://marc.info/?l=bugtraq&m=125060676515670&w=2", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/36309", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.exploit-db.com/exploits/9450", "source": "cve@mitre.org"}, {"url": "http://www.osvdb.org/57237", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/36062", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.ush.it/2009/08/18/vtiger-crm-504-multiple-vulnerabilities/", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.ush.it/team/ush/hack-vtigercrm_504/vtigercrm_504.txt", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.vupen.com/english/advisories/2009/2319", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2009-3250 - The attacker may use the vulnerability to execute arbitrary code by composing an email message with a PHP attachment and making a direct request to a certain pathname under storage/. This technique is used to execute code on the vulnerable system."}, {"techniqueID": "T1210", "comment": "CVE-2009-3250 - The vulnerability allows an attacker to execute arbitrary code, which can be used to achieve persistence, lateral movement, or other malicious activities. This technique is used to execute code on the vulnerable system."}, {"techniqueID": "T1133", "comment": "CVE-2009-3250 - The attacker may use the vulnerability to execute arbitrary code and then make a direct request to a certain pathname under storage/ to retrieve sensitive information. This technique is used to retrieve sensitive information from the vulnerable system."}], "stix_bundle": {"vulnerability": {"id": "urn:vuln:cve:2009:3250", "description": "The saveForwardAttachments procedure in the Compose Mail functionality in vtiger CRM 5.0.4 allows remote authenticated users to execute arbitrary code by composing an email message with an attachment filename ending in (1) .php in installations based on certain Apache HTTP Server configurations, (2) .php. on Windows, or (3) .php/ on Linux, and then making a direct request to a certain pathname under storage/.", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "score": 9.0, "references": [{"type": "exploit", "reference": "http://www.exploit-db.com/exploits/9450"}, {"type": "vulnerability-report", "reference": "http://secunia.com/advisories/36309"}], "related_attack_patterns": [{"type": "attack-pattern", "id": "urn:attack-pattern:cve-2009-3250", "description": "The saveForwardAttachments procedure in the Compose Mail functionality in vtiger CRM 5.0.4 allows remote authenticated users to execute arbitrary code by composing an email message with an attachment filename ending in (1) .php in installations based on certain Apache HTTP Server configurations, (2) .php. on Windows, or (3) .php/ on Linux, and then making a direct request to a certain pathname under storage/."}]}}, "technical_analysis": {"Introduction": "The saveForwardAttachments procedure in the Compose Mail functionality in vtiger CRM 5.0.4 allows remote authenticated users to execute arbitrary code by composing an email message with an attachment filename ending in (1) .php in installations based on certain Apache HTTP Server configurations, (2) .php. on Windows, or (3) .php/ on Linux, and then making a direct request to a certain pathname under storage/.", "Impact and Scope": "The vulnerability has a CVSS score of 9.0, indicating that it is highly critical and sensitive to the security of the affected systems. It is an arbitrary code execution vulnerability that allows an attacker to execute code on the vulnerable system.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1059, T1210, and T1133.", "Technical Details": "The vulnerability is due to a lack of proper validation of user input in the saveForwardAttachments procedure. When an attacker composes an email message with a PHP attachment and submits it, the vulnerable system allows the attachment to be executed as code.", "Detection": "Detection of this vulnerability can be done by monitoring system logs for suspicious activity, such as unusual file system modifications or execution of unknown executables.", "Mitigation": "Mitigation strategies include implementing input validation and sanitization, file system access controls, and network segmentation.", "Conclusion": "The vulnerability in the saveForwardAttachments procedure in the Compose Mail functionality in vtiger CRM 5.0.4 is a critical security risk that should be addressed immediately."}, "executive_analysis": {"Overview": "The vulnerability in the saveForwardAttachments procedure in the Compose Mail functionality in vtiger CRM 5.0.4 is a critical security risk that can have significant business and technical impacts.", "Business Impact": "The vulnerability can allow an attacker to execute arbitrary code on the vulnerable system, which can lead to unauthorized access, data theft, and financial loss.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary code on the vulnerable system, which can lead to system compromise, data corruption, and unauthorized access.", "Mitigation Strategies": "Implementing input validation and sanitization, file system access controls, and network segmentation can help to mitigate the vulnerability.", "Recommendations": "It is recommended that the affected systems be updated to a version that addresses the vulnerability, and that input validation and sanitization be implemented to prevent similar vulnerabilities in the future.", "Conclusions": "The vulnerability in the saveForwardAttachments procedure in the Compose Mail functionality in vtiger CRM 5.0.4 is a critical security risk that requires immediate attention and action."}}