{"id": "CVE-2007-5899", "sourceIdentifier": "cve@mitre.org", "published": "2007-11-20T19:46:00.000", "lastModified": "2018-10-15T21:46:58.753", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The output_add_rewrite_var function in PHP before 5.2.5 rewrites local forms in which the ACTION attribute references a non-local URL, which allows remote attackers to obtain potentially sensitive information by reading the requests for this URL, as demonstrated by a rewritten form containing a local session ID."}, {"lang": "es", "value": "La funci\u00f3n output_add_rewrite_var en PHP anterior a 5.2.5 rescribe formularios locales en los cuales el atributo ACTION referencia a una URL no local, lo caul permite a atacantes remotos obtener informaci\u00f3n potencialmente sensible a trav\u00e9s de la lectura de respuestas para esta URL, como se demostr\u00f3 por la rescritura del formulario contenedor de una sesi\u00f3n local ID."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionEndIncluding": "5.2.4", "matchCriteriaId": "A5B6B1C7-B7B8-495E-9FE5-FF39718DC64E"}]}]}], "references": [{"url": "http://bugs.php.net/bug.php?id=42869", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/38918", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27659", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27864", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/28249", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/30040", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/30828", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/31119", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/31124", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/31200", "source": "cve@mitre.org"}, {"url": "http://wiki.rpath.com/wiki/Advisories:rPSA-2007-0242", "source": "cve@mitre.org"}, {"url": "http://www.debian.org/security/2008/dsa-1444", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2008:125", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2008:126", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2008:127", "source": "cve@mitre.org"}, {"url": "http://www.php.net/ChangeLog-5.php#5.2.5", "source": "cve@mitre.org"}, {"url": "http://www.php.net/releases/5_2_5.php", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2008-0505.html", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2008-0544.html", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2008-0545.html", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2008-0546.html", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2008-0582.html", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/491693/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.ubuntu.com/usn/usn-549-2", "source": "cve@mitre.org"}, {"url": "http://www.ubuntu.com/usn/usn-628-1", "source": "cve@mitre.org"}, {"url": "https://issues.rpath.com/browse/RPL-1943", "source": "cve@mitre.org"}, {"url": "https://launchpad.net/bugs/173043", "source": "cve@mitre.org"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A11211", "source": "cve@mitre.org"}, {"url": "https://usn.ubuntu.com/549-1/", "source": "cve@mitre.org"}, {"url": "https://www.redhat.com/archives/fedora-package-announce/2008-June/msg00773.html", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059: Command and Scripting Interperter", "comment": "CVE-2007-5899 - Attackers can execute arbitrary code on affected PHP installations, potentially leading to remote code execution, denial of service, or other attacks. This can be mitigated by updating PHP to a version 5.2.5 or later, or disabling the output_add_rewrite_var function."}, {"techniqueID": "T1078: Exploitation of Authentication Mechanism", "comment": "CVE-2007-5899 - The vulnerability allows remote attackers to obtain sensitive information, potentially leading to unauthorized access or data theft. This can be detected by monitoring network traffic for suspicious activity, and by implementing strong authentication and authorization mechanisms."}, {"techniqueID": "T1190: PostExploitation", "comment": "CVE-2007-5899 - Attackers who successfully exploit the vulnerability may be able to execute arbitrary code on affected PHP installations, potentially leading to persistence, data exfiltration, or other malicious activities. This can be mitigated by implementing strong access controls, least privilege principles, and regular security updates."}], "stix_bundle": {"description": "STIX 2.1 Bundle for CVE-2007-5899", "bundle_id": "CVE-2007-5899-STIX-Bundle", "objects": [{"type": "indicator", "id": "indicator--b8f0e69e-0c43-4bac-a4f1-6d1bf9f6a72b", "name": "potential_vulnerability_indicator", "description": "Indicates the presence of a potential vulnerability in PHP", "first_seen": "2007-11-20T19:46:00.000", "last_seen": "2018-10-15T21:46:58.753", "created_by": "cve@mitre.org", "modified": "2018-10-15T21:46:58.753", "contributed_by": "cve@mitre.org", "stix_cve_id": "CVE-2007-5899", "relation": {"type": "has_part", "object_id": "weakness--f1c0c4e0-df44-4274-8c4c-ab5d45d9f325"}, "notes": [{"type": "note", "text": "This indicator may be used to detect potential vulnerability in PHP installations"}]}, {"type": "weakness", "id": "weakness--f1c0c4e0-df44-4274-8c4c-ab5d45d9f325", "name": "php_vulnerability", "description": "Vulnerability in PHP's output_add_rewrite_var function", "created_by": "cve@mitre.org", "modified": "2018-10-15T21:46:58.753", "contributed_by": "cve@mitre.org", "cvss_score": 4.3, "cvss_vector": "AV:N/AC:M/Au:N/C:P/I:N/A:N", "relation": {"type": "has_part", "object_id": "technique--b1af1edd-4e3c-42ba-9e73-b2f35a7d12de"}, "notes": [{"type": "note", "text": "This weakness is related to the CVE-2007-5899 vulnerability"}]}, {"type": "technique", "id": "technique--b1af1edd-4e3c-42ba-9e73-b2f35a7d12de", "name": "php_vulnerability_attack", "description": "Attack that exploits the PHP vulnerability", "created_by": "cve@mitre.org", "modified": "2018-10-15T21:46:58.753", "contributed_by": "cve@mitre.org", "relation": {"type": "is_used_by", "object_id": "indicator--b8f0e69e-0c43-4bac-a4f1-6d1bf9f6a72b"}, "notes": [{"type": "note", "text": "This technique is used to exploit the PHP vulnerability"}]}]}, "technical_analysis": {"Introduction": "This analysis discusses the vulnerability in PHP's output_add_rewrite_var function, which allows remote attackers to obtain sensitive information. The vulnerability is assigned a CVSS score of 4.3 and is considered medium severity.", "Impact and Scope": "The vulnerability affects PHP installations 5.2.4 or earlier, and can be exploited by remote attackers. The vulnerability allows attackers to obtain sensitive information, potentially leading to unauthorized access or data theft.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the Command and Scripting Interperter (T1059), Exploitation of Authentication Mechanism (T1078), and PostExploitation (T1190) techniques.", "Technical Details": "The vulnerability is caused by a bug in the output_add_rewrite_var function that allows attackers to rewrite local forms to send sensitive information to a remote server.", "Detection": "Detection can be performed by monitoring network traffic for suspicious activity, and by implementing strong authentication and authorization mechanisms.", "Mitigation": "Mitigation strategies include updating PHP to version 5.2.5 or later, disabling the output_add_rewrite_var function, and implementing strong access controls and least privilege principles.", "Conclusion": "In conclusion, the vulnerability in PHP's output_add_rewrite_var function is a serious security issue that can be exploited by remote attackers. It is recommended that PHP installations be updated to version 5.2.5 or later, and that strong security measures be implemented to prevent exploitation."}, "executive_analysis": {"Overview": "This analysis provides an overview of the security vulnerability in PHP's output_add_rewrite_var function.", "Business Impact": "The vulnerability can potentially lead to unauthorized access or data theft, which can have significant business impacts. It is recommended that PHP installations be updated to version 5.2.5 or later, and that strong security measures be implemented to prevent exploitation.", "Technical Impact": "The vulnerability allows remote attackers to obtain sensitive information, potentially leading to unauthorized access or data theft. It is recommended that PHP installations be updated to version 5.2.5 or later, and that strong security measures be implemented to prevent exploitation.", "Mitigation Strategies": "Mitigation strategies include updating PHP to version 5.2.5 or later, disabling the output_add_rewrite_var function, and implementing strong access controls and least privilege principles.", "Recommendations": "Recommendations for executives include updating PHP to version 5.2.5 or later, and implementing strong security measures to prevent exploitation.", "Conclusions": "In conclusion, the vulnerability in PHP's output_add_rewrite_var function is a serious security issue that requires immediate attention and action. It is recommended that PHP installations be updated to version 5.2.5 or later, and that strong security measures be implemented to prevent exploitation."}}