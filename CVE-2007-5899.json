{"id": "CVE-2007-5899", "sourceIdentifier": "cve@mitre.org", "published": "2007-11-20T19:46:00.000", "lastModified": "2018-10-15T21:46:58.753", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The output_add_rewrite_var function in PHP before 5.2.5 rewrites local forms in which the ACTION attribute references a non-local URL, which allows remote attackers to obtain potentially sensitive information by reading the requests for this URL, as demonstrated by a rewritten form containing a local session ID."}, {"lang": "es", "value": "La funci\u00f3n output_add_rewrite_var en PHP anterior a 5.2.5 rescribe formularios locales en los cuales el atributo ACTION referencia a una URL no local, lo caul permite a atacantes remotos obtener informaci\u00f3n potencialmente sensible a trav\u00e9s de la lectura de respuestas para esta URL, como se demostr\u00f3 por la rescritura del formulario contenedor de una sesi\u00f3n local ID."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionEndIncluding": "5.2.4", "matchCriteriaId": "A5B6B1C7-B7B8-495E-9FE5-FF39718DC64E"}]}]}], "references": [{"url": "http://bugs.php.net/bug.php?id=42869", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/38918", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27659", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27864", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/28249", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/30040", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/30828", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/31119", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/31124", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/31200", "source": "cve@mitre.org"}, {"url": "http://wiki.rpath.com/wiki/Advisories:rPSA-2007-0242", "source": "cve@mitre.org"}, {"url": "http://www.debian.org/security/2008/dsa-1444", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2008:125", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2008:126", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2008:127", "source": "cve@mitre.org"}, {"url": "http://www.php.net/ChangeLog-5.php#5.2.5", "source": "cve@mitre.org"}, {"url": "http://www.php.net/releases/5_2_5.php", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2008-0505.html", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2008-0544.html", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2008-0545.html", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2008-0546.html", "source": "cve@mitre.org"}, {"url": "http://www.redhat.com/support/errata/RHSA-2008-0582.html", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/491693/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.ubuntu.com/usn/usn-549-2", "source": "cve@mitre.org"}, {"url": "http://www.ubuntu.com/usn/usn-628-1", "source": "cve@mitre.org"}, {"url": "https://issues.rpath.com/browse/RPL-1943", "source": "cve@mitre.org"}, {"url": "https://launchpad.net/bugs/173043", "source": "cve@mitre.org"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A11211", "source": "cve@mitre.org"}, {"url": "https://usn.ubuntu.com/549-1/", "source": "cve@mitre.org"}, {"url": "https://www.redhat.com/archives/fedora-package-announce/2008-June/msg00773.html", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1204", "comment": "CVE-2007-5899 - This technique demonstrates how an attacker can obtain sensitive information by reading the requests for a non-local URL, similar to how this vulnerability rewrites local forms in PHP. Defense strategies include validating user input and configuring PHP rewrite rules accordingly."}, {"techniqueID": "T1482", "comment": "CVE-2007-5899 - This technique shows how an attacker can rewrite local forms in PHP, similar to how this vulnerability was exploited. Defense strategies include validating user input and configuring PHP rewrite rules accordingly."}, {"techniqueID": "T1505", "comment": "CVE-2007-5899 - This technique demonstrates how an attacker can obtain sensitive information by reading the requests for a non-local URL, similar to how this vulnerability rewrites local forms in PHP. Defense strategies include validating user input and configuring PHP rewrite rules accordingly."}, {"techniqueID": "T1562", "comment": "CVE-2007-5899 - This technique shows how an attacker can leverage a vulnerability in PHP's output_add_rewrite_var function, similar to how this vulnerability was exploited. Defense strategies include validating user input and configuring PHP rewrite rules accordingly."}], "stix_bundle": "[STIX Bundle Omitted]", "technical_analysis": {"Introduction": "The CVE-2007-5899 vulnerability is a PHP remote code execution vulnerability that allows an attacker to rewrite local forms. This vulnerability was exploited through a crafted URL causing the output_add_rewrite_var function to rewrite a local form with a non-local URL.", "Impact and Scope": "The impact of this vulnerability is remote code execution, allowing an attacker to execute arbitrary code on the affected system. The scope of this vulnerability is limited to PHP versions prior to 5.2.5.", "Related MITRE ATT&CK Techniques": "T1204, T1482, T1505, T1562", "Technical Details": "The vulnerability occurs when PHP's output_add_rewrite_var function is called with a crafted URL. This function rewrites local forms with non-local URLs, allowing an attacker to read requests for the non-local URL.", "Detection": "Detection of this vulnerability can be done by monitoring for suspicious request patterns and validating user input.", "Mitigation": "Mitigation strategies include validating user input, configuring PHP rewrite rules accordingly, and updating PHP to version 5.2.5 or higher.", "Conclusion": "In conclusion, CVE-2007-5899 is a severe vulnerability that can lead to remote code execution. It is essential to apply appropriate mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2007-5899 is a PHP remote code execution vulnerability that can lead to severe consequences. It is crucial to apply mitigation strategies to prevent exploitation.", "Business Impact": "The business impact of this vulnerability is significant, as it can lead to data breaches, system compromise, and financial loss.", "Technical Impact": "The technical impact of this vulnerability is remote code execution, allowing an attacker to execute arbitrary code on the affected system.", "Mitigation Strategies": "Mitigation strategies include validating user input, configuring PHP rewrite rules accordingly, and updating PHP to version 5.2.5 or higher.", "Recommendations": "Executive Recommendation: Implement mitigation strategies immediately to prevent exploitation.", "Conclusions": "In conclusion, CVE-2007-5899 is a high-risk vulnerability that requires immediate attention and action."}}