{"id": "CVE-2007-1604", "sourceIdentifier": "cve@mitre.org", "published": "2007-03-22T23:19:00.000", "lastModified": "2018-10-16T16:39:31.910", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple unrestricted file upload vulnerabilities in w-Agora (Web-Agora) allow remote attackers to upload and execute arbitrary PHP code (1) via a forum message with an attached file, which is stored under forums/hello/hello/notes/ or (2) by using browse_avatar.php to upload a file with a double extension, as demonstrated by .php.jpg."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de promoci\u00f3n de ficheros no restringida en w-Agora (Web-Agora) permiten a atacantes remotos promocionar y ejecutar c\u00f3digo PHP de su elecci\u00f3n (1) mediante  un mensaje de foro con un fichero adjunto, que se almacena bajo forums/hello/hello/notes/ \u00f3 (2) usando browse_avatar.php para promocionar un fichero con doble extensi\u00f3n, como se demuestra con .php.jpg."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:w-agora:w-agora:4.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "D6BF8356-1A1A-4BDC-A7EF-CFA34AB8399A"}]}]}], "references": [{"url": "http://osvdb.org/34383", "source": "cve@mitre.org"}, {"url": "http://osvdb.org/34384", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/24605", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://securityreason.com/securityalert/2462", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/463286/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/23055", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/33173", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1117", "comment": "Forced authentication - This technique is relevant because it's a common trick used by attackers to bypass restrictions. To defend against it, always use strong authentication and authorization mechanisms."}, {"techniqueID": "T1030", "comment": "Service exploitation - This technique is relevant because it's another way attackers can exploit vulnerabilities. To defend against it, regularly patch and update systems to ensure the latest security patches are applied."}, {"techniqueID": "T1190", "comment": "Exploit publicly known vulnerabilities - This technique is relevant because it's a common way attackers exploit unpatched systems. To defend against it, keep software up to date and use a web application firewall (WAF) to detect and block attacks."}, {"techniqueID": "T1192", "comment": "Exploit a known vulnerability through the internet - This technique is relevant because it's a similar attack vector used by attackers. To defend against it, keep internet-facing systems and services patched and up to date."}], "stix_bundle": {"@stixmime": "1.2.0", "vulnerability": {"id": "CVE-2007-1604", "created_by": "cve@mitre.org", "created_at": "2007-03-22T23:19:00.000", "modified_by": "cve@mitre.org", "modified_at": "2018-10-16T16:39:31.910", "name": "Multiple unrestricted file upload vulnerabilities in w-Agora (Web-Agora)", "description": [{"lang": "en", "value": "Multiple unrestricted file upload vulnerabilities in w-Agora (Web-Agora) allow remote attackers to upload and execute arbitrary PHP code (1) via a forum message with an attached file, which is stored under forums/hello/hello/notes/ or (2) by using browse_avatar.php to upload a file with a double extension, as demonstrated by .php.jpg."}], "baseScore": 7.5, "attackVector": "NETWORK", "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "cwe": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}]}, "exploit": {"id": "EX-2007-1604", "name": "Exploit for CVE-2007-1604", "description": [{"lang": "en", "value": "An exploit that takes advantage of the vulnerabilities in w-Agora (Web-Agora) using the forced authentication technique."}], "method": [{"idRef": "T1117"}]}, "course_of_action": {"id": "CoA-2007-1604", "name": "Recommended mitigations for CVE-2007-1604", "description": [{"lang": "en", "value": "Regularly patch and update systems to ensure the latest security patches are applied, use strong authentication and authorization mechanisms, and keep software up to date."}], "mitigates": [{"idRef": "T1190", "level": "reduces"}, {"idRef": "T1117", "level": "reduces"}, {"idRef": "T1192", "level": "reduces"}]}}, "technical_analysis": {"Introduction": "This is a vulnerability in w-Agora (Web-Agora) that allows remote attackers to upload and execute arbitrary PHP code. The vulnerability has a high severity level and affects systems running version 4.2.1.", "Impact and Scope": "The vulnerability has a base score of 7.5 and an attack vector of NETWORK. This means that an attacker can exploit the vulnerability over the network and gain access to the system.", "Related MITRE ATT&CK Techniques": "The vulnerability can be exploited using the forced authentication technique (T1117), the service exploitation technique (T1030), and the exploit publicly known vulnerabilities technique (T1190).", "Technical Details": "The vulnerability is caused by insufficient validation of file uploads, which allows an attacker to upload and execute arbitrary PHP code.", "Detection": "Detection of this vulnerability can be done using web application scanners and by monitoring system logs for suspicious activity.", "Mitigation": "Regular patching and updating, strong authentication and authorization mechanisms, and keeping software up to date are recommended to mitigate this vulnerability.", "Conclusion": "In conclusion, this vulnerability is a significant risk for systems running w-Agora (Web-Agora) and requires immediate attention and action to remediate."}, "executive_analysis": {"Overview": "This is a vulnerability in w-Agora (Web-Agora) that allows remote attackers to upload and execute arbitrary PHP code.", "Business Impact": "The vulnerability has the potential to compromise business data and systems, resulting in financial losses and reputation damage.", "Technical Impact": "The vulnerability has a high severity level and can be exploited using various techniques, including forced authentication, service exploitation, and exploit of publicly known vulnerabilities.", "Mitigation Strategies": "Regular patching and updating, strong authentication and authorization mechanisms, and keeping software up to date are recommended to mitigate this vulnerability.", "Recommendations": "Executives should prioritize patching and updating systems, as well as implementing strong authentication and authorization mechanisms to prevent unauthorized access.", "Conclusions": "In conclusion, this vulnerability is a significant risk that requires immediate attention and action to remediate."}}