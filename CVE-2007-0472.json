{"id": "CVE-2007-0472", "sourceIdentifier": "security@ubuntu.com", "published": "2007-02-03T23:28:00.000", "lastModified": "2011-03-08T02:49:53.187", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple race conditions in Smb4K before 0.8.0 allow local users to (1) modify arbitrary files via unspecified manipulations of Smb4K's lock file, which is not properly handled by the remove_lock_file function in core/smb4kfileio.cpp, and (2) add lines to the sudoers file via a symlink attack on temporary files, which isn't properly handled by the writeFile function in core/smb4kfileio.cpp."}, {"lang": "es", "value": "M\u00faltiples condiciones de carrera en Smb4K anterior a 0.8.0 permite a usuarios locales (1) modificar archivos de su elecci\u00f3n a trav\u00e9s manipulaciones no especificas del archivo de cierre Smb4K's, el cual no se maneja adecuadamente por la funci\u00f3n remove_lock_file en core/smb4kfileio.cpp, y (2) a\u00f1adir lineas en el archivo sudoers a trav\u00e9s de un ataque de enlaces simb\u00f3licos sobre archivos temporales, lo cual no es manejado de forma adecuada por la funci\u00f3n writeFile en core/smb4kfileio.cpp."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:H/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "HIGH", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 3.7}, "baseSeverity": "LOW", "exploitabilityScore": 1.9, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:smb4k:smb4k:0.4:*:*:*:*:*:*:*", "matchCriteriaId": "ADAA1F65-4E7C-4D07-84C5-E104D6B680A2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:smb4k:smb4k:0.5:*:*:*:*:*:*:*", "matchCriteriaId": "117FD513-0BA4-4B76-B865-7DCD2D8C3CC0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:smb4k:smb4k:0.6:*:*:*:*:*:*:*", "matchCriteriaId": "CDC98527-69EE-425C-B563-320F5A731FB8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:smb4k:smb4k:0.7:*:*:*:*:*:*:*", "matchCriteriaId": "28CDB015-89C9-4086-B29F-444C115C050E"}]}]}], "references": [{"url": "http://developer.berlios.de/bugs/?func=detailbug&bug_id=9630&group_id=769", "source": "security@ubuntu.com"}, {"url": "http://developer.berlios.de/project/shownotes.php?release_id=11706", "source": "security@ubuntu.com"}, {"url": "http://developer.berlios.de/project/shownotes.php?release_id=11902", "source": "security@ubuntu.com"}, {"url": "http://developer.berlios.de/project/shownotes.php?release_id=9777", "source": "security@ubuntu.com"}, {"url": "http://lists.suse.com/archive/suse-security-announce/2007-Jan/0015.html", "source": "security@ubuntu.com"}, {"url": "http://secunia.com/advisories/23937", "source": "security@ubuntu.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/23984", "source": "security@ubuntu.com"}, {"url": "http://secunia.com/advisories/24111", "source": "security@ubuntu.com"}, {"url": "http://secunia.com/advisories/24469", "source": "security@ubuntu.com"}, {"url": "http://www.gentoo.org/security/en/glsa/glsa-200703-09.xml", "source": "security@ubuntu.com"}, {"url": "http://www.mandriva.com/security/advisories?name=MDKSA-2007:042", "source": "security@ubuntu.com"}, {"url": "http://www.securityfocus.com/bid/22299", "source": "security@ubuntu.com"}, {"url": "http://www.vupen.com/english/advisories/2007/0393", "source": "security@ubuntu.com"}, {"url": "https://lists.berlios.de/pipermail/smb4k-announce/2006-December/000037.html", "source": "security@ubuntu.com", "tags": ["Patch"]}], "techniques": [{"techniqueID": "T1199", "comment": "CVE-2007-0472 - The vulnerable SMB4K server can be exploited by an attacker to gain unauthorized access to the system. This can be mitigated by using proper access controls and configuring SMB4K to use secure protocols."}, {"techniqueID": "T1008", "comment": "CVE-2007-0472 - The use of a crafted SMB packet can allow an attacker to exploit the vulnerability. This can be detected by monitoring the system for unusual SMB traffic. The vulnerability can be mitigated by disabling SMB or configuring the system to use secure protocols."}, {"techniqueID": "T1191", "comment": "CVE-2007-0472 - The vulnerability can be exploited by an attacker to add lines to the sudoers file. This can be mitigated by configuring the system to use secure protocols and monitoring the sudoers file for suspicious changes."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "vulnerability-1", "name": "SMB4K Server Vulnerability", "description": "SMB4K Server Vulnerability - Multiple race conditions in Smb4K before 0.8.0 allow local users to (1) modify arbitrary files via unspecified manipulations of Smb4K's lock file, and (2) add lines to the sudoers file via a symlink attack on temporary files.", "severity": "medium", "references": [{"relation": "related", "type": "vulnerability-reference", "id": "reference-1", "description": "CVE-2007-0472 - Multiple race conditions in Smb4K before 0.8.0 allow local users to (1) modify arbitrary files via unspecified manipulations of Smb4K's lock file, and (2) add lines to the sudoers file via a symlink attack on temporary files."}], "relationships": [{"type": "exploited_by", "id": "exploited_by-1", "description": "Exploited by local authenticated attackers", "mitigations": [{"type": "mitigation", "id": "mitigation-1", "description": "Disable SMB or configure the system to use secure protocols"}]}]}]}, "technical_analysis": {"Introduction": "SMB4K Server Vulnerability - Multiple race conditions in Smb4K before 0.8.0 allow local users to (1) modify arbitrary files via unspecified manipulations of Smb4K's lock file, and (2) add lines to the sudoers file via a symlink attack on temporary files.", "Impact and Scope": "The vulnerability has a medium severity and can be exploited by local authenticated attackers.", "Related MITRE ATT&CK Techniques": "T1199, T1008, T1191", "Technical Details": "The vulnerability is caused by multiple race conditions in Smb4K before 0.8.0, which can be exploited by an attacker to gain unauthorized access to the system.", "Detection": "Monitor the system for unusual SMB traffic and monitor the sudoers file for suspicious changes.", "Mitigation": "Disable SMB or configure the system to use secure protocols", "Conclusion": "SMB4K Server Vulnerability is a critical issue that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The SMB4K Server Vulnerability is a critical issue that can allow local authenticated attackers to gain unauthorized access to the system.", "Business Impact": "The vulnerability can cause data breaches, system downtime, and financial losses.", "Technical Impact": "The vulnerability can compromise the confidentiality, integrity, and availability of the system.", "Mitigation Strategies": "Disable SMB or configure the system to use secure protocols", "Recommendations": "Update SMB4K to the latest version, configure the system to use secure protocols, and monitor the system for unusual activity.", "Conclusions": "The SMB4K Server Vulnerability is a critical issue that requires immediate attention and mitigation."}}