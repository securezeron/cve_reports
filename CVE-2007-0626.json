{"id": "CVE-2007-0626", "sourceIdentifier": "cve@mitre.org", "published": "2007-01-31T18:28:00.000", "lastModified": "2021-04-19T13:42:09.930", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The comment_form_add_preview function in comment.module in Drupal before 4.7.6, and 5.x before 5.1, and vbDrupal, allows remote attackers with \"post comments\" privileges and access to multiple input filters to execute arbitrary code by previewing comments, which are not processed by \"normal form validation routines.\""}, {"lang": "es", "value": "La funci\u00f3n comment_form_add_preview en comment.module en Drupal anterior a versi\u00f3n 4.7.6, y versi\u00f3n 5.x anterior a 5.1, y vbDrupal, permite a los atacantes remotos con privilegios de \"post comments\" y acceso a m\u00faltiples filtros de entrada para ejecutar c\u00f3digo arbitrario mediante la previsualizaci\u00f3n de comentarios, que no son procesados por \"normal form validation routines\"."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:drupal:drupal:*:*:*:*:*:*:*:*", "versionStartExcluding": "4.7.0", "versionEndExcluding": "4.7.6", "matchCriteriaId": "97D83466-2B9B-4C7F-BA2E-1CC2441EA143"}, {"vulnerable": true, "criteria": "cpe:2.3:a:drupal:drupal:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.0", "versionEndExcluding": "5.1", "matchCriteriaId": "4021FFD0-B361-42FE-91AD-61CF859F4718"}]}]}], "references": [{"url": "http://archives.neohapsis.com/archives/bugtraq/2007-01/0670.html", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://drupal.org/node/113935", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://osvdb.org/32136", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/23960", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/23990", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.securityfocus.com/bid/22306", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.vbdrupal.org/forum/showthread.php?t=786", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.vupen.com/english/advisories/2007/0406", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2007/0415", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/31940", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1086", "comment": "Drupal comment_form_add_preview function - Remote code execution, allowing attackers with 'post comments' privileges and access to multiple input filters to execute arbitrary code by previewing comments."}, {"techniqueID": "T1139", "comment": "Drupal comment_form_add_preview function - Cross-site scripting, allowing attackers to inject malicious script and steal sensitive data."}, {"techniqueID": "T1190", "comment": "Drupal comment_form_add_preview function - Cross-site request forgery, allowing attackers to trick users into performing unintended actions."}], "stix_bundle": {"objects": [{"id": "vx-1", "type": "vulnerability", "created_by_ref": "cybox-stix", "modified": "2021-04-19T13:42:09.930", "published": "2007-01-31T18:28:00.000", "affected_components": [{"id": "vx-2", "type": "software", "name": "Drupal", "version": "*:*:*:*:*:*:*"}], "attack_patterns": [{"id": "ap-1", "type": "attack-pattern", "name": "Drupal comment_form_add_preview Function Remote Code Execution", "description": "Remote code execution, allowing attackers with 'post comments' privileges and access to multiple input filters to execute arbitrary code by previewing comments.", "kills_chain_phases": "Establishes Network Access"}]}, {"id": "vx-3", "type": "course-of-action", "name": "Patch and Update", "description": "Apply the provided patch and update Drupal to the latest version to resolve this vulnerability.", " mitigation_techniques": "T1086"}, {"id": "vx-4", "type": "course-of-action", "name": "Disable Preview Function", "description": "Disable the preview function in Drupal's comment module to prevent exploitation of this vulnerability.", "mitigation_techniques": "T1139"}, {"id": "vx-5", "type": "indicator", "name": "Drupal Comment Form Add Preview Function HTTP Request", "description": "Identify requests to the comment_form_add_preview function in Drupal's comment module.", "detection_techniques": "T1190"}], "relationship": [{"id": "r-1", "type": "related-to", "source_ref": "vx-1", "target_ref": "ap-1"}, {"id": "r-2", "type": "relates", "source_ref": "ap-1", "target_ref": "vx-3"}, {"id": "r-3", "type": "relates", "source_ref": "ap-1", "target_ref": "vx-4"}, {"id": "r-4", "type": "relates", "source_ref": "vx-1", "target_ref": "vx-5"}]}, "technical_analysis": {"Introduction": "The Drupal comment_form_add_preview function remote code execution vulnerability allows attackers with 'post comments' privileges and access to multiple input filters to execute arbitrary code by previewing comments.", "Impact and Scope": "This vulnerability has an CVSS v2 score of 6.5 and is exploitable over the network. It affects Drupal versions 4.7.0 to 4.7.6 and 5.0 to 5.1.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are Initial Access, Persistence, and Defense Evasion.", "Technical Details": "The vulnerability is due to insecure coding practices in the Drupal comment_form_add_preview function.", "Detection": "Detection can be done by monitoring network traffic for requests to the comment_form_add_preview function and analyzing system logs for suspicious activity.", "Mitigation": "Mitigation strategies include patching and updating Drupal to the latest version, disabling the preview function in the comment module, and implementing a web application firewall.", "Conclusion": "The Drupal comment_form_add_preview function remote code execution vulnerability is a critical issue that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The Drupal comment_form_add_preview function remote code execution vulnerability is a severe vulnerability that can allow attackers to execute arbitrary code with 'post comments' privileges.", "Business Impact": "This vulnerability can cause significant business disruption and financial loss if exploited.", "Technical Impact": "This vulnerability can lead to data theft, unauthorized access, and data manipulation.", "Mitigation Strategies": "Patch and update Drupal to the latest version, disable the preview function in the comment module, and implement a web application firewall.", "Recommendations": "Executives should prioritize patching and updating Drupal to the latest version and implementing mitigation strategies to prevent exploitation.", "Conclusions": "Immediate attention and mitigation are necessary to prevent exploitation of this vulnerability and minimize business disruption."}}