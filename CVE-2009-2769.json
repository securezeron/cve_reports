{"id": "CVE-2009-2769", "sourceIdentifier": "cve@mitre.org", "published": "2009-08-14T17:30:00.203", "lastModified": "2017-09-19T01:29:18.343", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "PHP remote file inclusion vulnerability in include/timesheet.php in Ultrize TimeSheet 1.2.2, when register_globals is enabled, allows remote attackers to execute arbitrary PHP code via a URL in the config[include_dir] parameter."}, {"lang": "es", "value": "Vulnerabilidad de inclusi\u00f3n remota de archivo PHP en include/timesheet.php en Ultrize TimeSheet v1.2.2, permite a atacantes remotos ejecutar c\u00f3digo PHP de su elecci\u00f3n a trav\u00e9s de la URL en el par\u00e1metro \"config[include_dir]\"."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ultrize:timesheet:1.2.2:*:*:*:*:*:*:*", "matchCriteriaId": "06931148-04EA-4996-B0B7-53D0A590B037"}]}]}], "references": [{"url": "http://secunia.com/advisories/36033", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.exploit-db.com/exploits/9297", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1047: Web Shellcode", "comment": "CVE-2009-2769 - Remote File Inclusion vulnerability. Attackers can execute arbitrary PHP code. Defend against by restricting the use of include_dir in config.php, using a Web Application Firewall and validating user input."}, {"techniqueID": "T1190: Exploit-Adjacent File Inclusion", "comment": "CVE-2009-2769 - Remote File Inclusion vulnerability. Attackers can execute arbitrary PHP code. Defend against by restricting the use of include_dir in config.php, using a Web Application Firewall and validating user input."}, {"techniqueID": "T1191: Cross-Site Scripting", "comment": "CVE-2009-2769 - Potential XSS vulnerability if the exploit code includes malicious JavaScript. Defend against by validating user input, using Content Security Policy and a Web Application Firewall."}, {"techniqueID": "T1210: Exploitation of Remotely Crafted Web Page", "comment": "CVE-2009-2769 - Remote File Inclusion vulnerability. Attackers can execute arbitrary PHP code. Defend against by restricting the use of include_dir in config.php, using a Web Application Firewall and validating user input."}], "stix_bundle": {"description": "STIX 2.1 Bundle for CVE-2009-2769", "bundle": {"Objects": [{"type": "attack-pattern", "id": "attack-pattern--425a3a5d-4cad-456b-8316-4f4b9ac59a5a", "name": "Remote File Inclusion vulnerability in Ultrize TimeSheet 1.2.2", "description": "A remote file inclusion vulnerability in the timesheet.php file of Ultrize TimeSheet 1.2.2 allows attackers to execute arbitrary PHP code via a URL in the config[include_dir] parameter."}, {"type": "malware", "id": "malware--18c80d69-18ac-44a6-a4f9-cf1a9b92c01f", "name": "PHP Web Shell", "description": "A PHP web shell that can be used to execute system commands and upload files."}, {"type": "note", "id": "note--1a2b3c4d-5678-9abc-1234-567890abcde", "name": "Defend against remote file inclusion vulnerability", "description": "Restrict the use of include_dir in config.php, use a Web Application Firewall and validate user input to prevent remote file inclusion attacks."}, {"type": "note", "id": "note--efghijklmnop-abcdef-1234-567890abcde", "name": "Potential XSS vulnerability", "description": "Validate user input, use Content Security Policy and a Web Application Firewall to prevent XSS attacks."}], "Relationships": [{"type": "related-to", "id": "related-to--1", "from": "attack-pattern--425a3a5d-4cad-456b-8316-4f4b9ac59a5a", "to": "malware--18c80d69-18ac-44a6-a4f9-cf1a9b92c01f"}, {"type": "related-to", "id": "related-to--2", "from": "attack-pattern--425a3a5d-4cad-456b-8316-4f4b9ac59a5a", "to": "note--1a2b3c4d-5678-9abc-1234-567890abcde"}, {"type": "related-to", "id": "related-to--3", "from": "attack-pattern--425a3a5d-4cad-456b-8316-4f4b9ac59a5a", "to": "note--efghijklmnop-abcdef-1234-567890abcde"}]}}, "technical_analysis": {"Introduction": "This vulnerability is an example of a remote file inclusion vulnerability, which allows attackers to run arbitrary PHP code on the affected system. This can be used to upload files, execute system commands, and alter the system configuration.", "Impact and Scope": "This vulnerability is rated 6.8 out of 10 on the CVSS v2 scale. It affects the Ultrize TimeSheet 1.2.2 application and may be exploitable by an attacker who has network access to the affected system.", "Technical Details": "The vulnerability is caused by the lack of input validation in the timesheet.php file. An attacker can include a PHP file from the attacker's server by providing a URL in the config[include_dir] parameter.", "Detection": "Detection of this vulnerability may be difficult, as it relies on the presence of malicious code in the include_dir parameter. However, monitoring for unusual system activity, such as file uploads or system command execution, may indicate the presence of this vulnerability.", "Mitigation": "Mitigating this vulnerability requires restricting the use of include_dir in config.php, using a Web Application Firewall, and validating user input to prevent remote file inclusion attacks.", "Conclusion": "In conclusion, this vulnerability highlights the importance of input validation and secure coding practices in web applications. It is essential to implement robust security measures, such as Web Application Firewalls and regular vulnerability scanning, to prevent exploitation of this vulnerability."}, "executive_analysis": {"Overview": "This vulnerability affects the Ultrize TimeSheet 1.2.2 application and may allow an attacker to execute arbitrary PHP code, resulting in unauthorized access, data theft, and system compromise.", "Business Impact": "The potential business impact of this vulnerability includes financial loss, reputational damage, and regulatory non-compliance.", "Technical Impact": "The technical impact of this vulnerability includes unauthorized access to system files, data theft, and system compromise.", "Mitigation Strategies": "Mitigation strategies include restricting include_dir in config.php, using a Web Application Firewall, and validating user input.", "Recommendations": "We recommend that affected organizations prioritize patching and remediation, implement robust security measures, and conduct regular vulnerability scanning and penetration testing.", "Conclusions": "In conclusion, prioritizing the remediation of this vulnerability is essential to protect against the potential risks of remote file inclusion attacks and to maintain the trust and confidence of customers and stakeholders."}}