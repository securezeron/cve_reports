{"id": "CVE-2009-5011", "sourceIdentifier": "cve@mitre.org", "published": "2010-10-19T20:00:03.017", "lastModified": "2010-10-20T04:00:00.000", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Race condition in the FTPHandler class in ftpserver.py in pyftpdlib before 0.5.2 allows remote attackers to cause a denial of service (daemon outage) by establishing and then immediately closing a TCP connection, leading to the getpeername function having an ENOTCONN error, a different vulnerability than CVE-2010-3494."}, {"lang": "es", "value": "Condici\u00f3n de carrera en la clase FTPHandler en ftpserver.py en pyftpdlib anterior a v0.5.2, permite a atacantes remotos provocar una denegaci\u00f3n de servicio (agotamiento de demonio) estableciendo e inmediatamente cerrando una conexi\u00f3n TCP, permitiendo a la  funci\u00f3n \"getpeername\"  que tenga un error ENOTCONN. Vector distinto de CVE-2010-3494."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-362"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:*:*:*:*:*:*:*:*", "versionEndIncluding": "0.5.1", "matchCriteriaId": "024B769C-54ED-4228-8CE8-4DABCDCF4171"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.1:*:*:*:*:*:*:*", "matchCriteriaId": "DB3D49FE-C51B-49E8-895E-AD4C4E138425"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "E2B112CF-87F7-4A6A-9D75-AD6A577FB979"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.2.0:*:*:*:*:*:*:*", "matchCriteriaId": "73F985FF-9073-42E5-8651-7A440C1453E2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.3.0:*:*:*:*:*:*:*", "matchCriteriaId": "DA58DF28-E4B7-4BD6-B77C-56521DE0CE4F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.4.0:*:*:*:*:*:*:*", "matchCriteriaId": "63AAA8E0-D608-45CD-B46C-C8936607E525"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.5.0:*:*:*:*:*:*:*", "matchCriteriaId": "9C18591C-4D31-476F-BBC9-065E4C1A207D"}]}]}], "references": [{"url": "http://code.google.com/p/pyftpdlib/issues/detail?id=100", "source": "cve@mitre.org"}, {"url": "http://code.google.com/p/pyftpdlib/source/browse/trunk/HISTORY", "source": "cve@mitre.org"}, {"url": "http://code.google.com/p/pyftpdlib/source/detail?r=543", "source": "cve@mitre.org"}, {"url": "http://code.google.com/p/pyftpdlib/source/diff?spec=svn543&r=543&format=side&path=/trunk/pyftpdlib/ftpserver.py", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1200", "comment": "CVE-2009-5011 - This technique is related to a race condition in the FTPHandler class in pyftpdlib, which can lead to a denial of service attack, a different vulnerability than CVE-2010-3494. Defending against this technique requires configuring the FTP server to handle concurrent connections properly."}, {"techniqueID": "T1408", "comment": "CVE-2009-5011 - An attacker can exploit the vulnerability by establishing and then immediately closing a TCP connection, leading to a restart of the FTP server. Defending against this technique requires implementing rate limiting and connection limiting mechanisms."}, {"techniqueID": "T1608", "comment": "CVE-2009-5011 - An attacker can use this vulnerability to perform a denial of service attack by quickly establishing and then closing multiple TCP connections to the FTP server, causing it to restart. Defending against this technique requires implementing load balancing and distributing the connections across multiple servers."}], "stix_bundle": null, "technical_analysis": {"Introduction": "CVE-2009-5011 is a vulnerability in the pyftpdlib FTP server software that allows an attacker to perform a denial of service attack by exploiting a race condition in the FTPHandler class.", "Impact and Scope": "The vulnerability affects pyftpdlib versions 0.1 to 0.5.2 and has a CVSS score of 4.3 with a moderate attack complexity. The attacker can exploit the vulnerability by establishing and then immediately closing a TCP connection, leading to a restart of the FTP server.", "Related MITRE ATT&CK Techniques": "T1200, T1408, T1608", "Technical Details": "The vulnerability occurs in the FTPHandler class in pyftpdlib, which handles incoming connections. When a connection is established, the class calls the getpeername function to get the remote host's IP address. However, the function returns an ENOTCONN error when the connection is immediately closed, causing the FTP server to restart.", "Detection": "Detecting this vulnerability requires analyzing network traffic for suspicious TCP connection establishment and closure patterns. You can also use vulnerability scanning tools to identify the affected software versions.", "Mitigation": "Mitigating the vulnerability requires configuring the FTP server to handle concurrent connections properly, implementing rate limiting and connection limiting mechanisms, and distributing the connections across multiple servers.", "Conclusion": "CVE-2009-5011 is a moderate-risk vulnerability that can be exploited to perform a denial of service attack. Defending against this vulnerability requires a combination of awareness, vigilance, and robust security practices."}, "executive_analysis": {"Overview": "CVE-2009-5011 is a vulnerability in the pyftpdlib FTP server software that affects several versions and can be exploited to perform a denial of service attack.", "Business Impact": "The vulnerability can cause significant business disruption and financial losses if it is not addressed promptly.", "Technical Impact": "The vulnerability affects the availability and reliability of the FTP server, which can have significant technical implications for business operations.", "Mitigation Strategies": "Implement rate limiting and connection limiting mechanisms, distribute connections across multiple servers, and ensure that the FTP server is configured to handle concurrent connections properly.", "Recommendations": "Recommendations for executives include prioritizing the patching and upgrading of affected software versions, ensuring that security practices are followed, and implementing robust security controls.", "Conclusions": "Conclusions and next steps should include a review of the mitigation strategies implemented, a plan for ongoing monitoring and maintenance, and a review of the organization's overall security posture."}}