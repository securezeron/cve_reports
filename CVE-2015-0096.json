{"id": "CVE-2015-0096", "sourceIdentifier": "secure@microsoft.com", "published": "2015-03-11T10:59:22.760", "lastModified": "2019-05-14T19:47:14.040", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Untrusted search path vulnerability in Microsoft Windows Server 2003 SP2, Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold and R2, and Windows RT Gold and 8.1 allows local users to gain privileges via a Trojan horse DLL in the current working directory, leading to DLL loading during Windows Explorer access to the icon of a crafted shortcut, aka \"DLL Planting Remote Code Execution Vulnerability.\""}, {"lang": "es", "value": "Vulnerabilidad de ruta de b\u00fasqueda no confiable en Microsoft Windows Server 2003 SP2, Windows Vista SP2, Windows Server 2008 SP2 y R2 SP1, Windows 7 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold y R2, y Windows RT Gold y 8.1 permite a usuarios locales ganar privilegios a trav\u00e9s de un DLL troyano en el directorio de trabajos actuales, que conduce a una carga de DLL durante el acceso de Windows Explorer al icono de un atajo manipulado, tambi\u00e9n conocido como 'vulnerabilidad de la ejecuci\u00f3n remoto de la implantaci\u00f3n de DLL.'"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.3}, "baseSeverity": "HIGH", "exploitabilityScore": 8.6, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-426"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_7:-:sp1:*:*:*:*:*:*", "matchCriteriaId": "C2B1C231-DE19-4B8F-A4AA-5B3A65276E46"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_8:-:*:*:*:*:*:*:*", "matchCriteriaId": "0D229E41-A971-4284-9657-16D78414B93F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_8.1:-:*:*:*:*:*:*:*", "matchCriteriaId": "E93068DB-549B-45AB-8E5C-00EB5D8B5CF8"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_rt:-:*:*:*:*:*:*:*", "matchCriteriaId": "ABC7A32C-4A4A-4533-B42E-350E728ADFEB"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_rt_8.1:-:*:*:*:*:*:*:*", "matchCriteriaId": "C6CE5198-C498-4672-AF4C-77AB4BE06C5C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2003:-:sp2:*:*:*:*:*:*", "matchCriteriaId": "1D929AA2-EE0B-4AA1-805D-69BCCA11B77F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:-:sp2:*:*:*:*:*:*", "matchCriteriaId": "5F422A8C-2C4E-42C8-B420-E0728037E15C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:r2:sp1:*:*:*:*:itanium:*", "matchCriteriaId": "B320A104-9037-487E-BC9A-62B4A6B49FD0"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:r2:sp1:*:*:*:*:x64:*", "matchCriteriaId": "AF07A81D-12E5-4B1D-BFF9-C8D08C32FF4F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:-:*:*:*:*:*:*:*", "matchCriteriaId": "A7DF96F8-BA6A-4780-9CA3-F719B3F81074"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:r2:*:*:*:*:*:*:*", "matchCriteriaId": "DB18C4CE-5917-401E-ACF7-2747084FD36E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_vista:-:sp2:*:*:*:*:*:*", "matchCriteriaId": "BF1AD1A1-EE20-4BCE-9EE6-84B27139811C"}]}]}], "references": [{"url": "http://www.securityfocus.com/bid/72894", "source": "secure@microsoft.com", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securitytracker.com/id/1031890", "source": "secure@microsoft.com", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2015/ms15-020", "source": "secure@microsoft.com", "tags": ["Patch", "Vendor Advisory"]}], "techniques": [{"techniqueID": "T1134", "comment": "CVE-2015-0096 - Untrusted search path vulnerability in Microsoft Windows allows local users to gain privileges via a Trojan horse DLL in the current working directory, leading to DLL loading during Windows Explorer access to the icon of a crafted shortcut."}, {"techniqueID": "T1574", "comment": "This vulnerability is related to DLL loading and execution, making it relevant to lateral movement via DLL injection. Attackers could use this vulnerability to execute malicious code with elevated privileges."}, {"techniqueID": "T1078", "comment": "This vulnerability is also related to privilege escalation, as it allows local users to gain elevated privileges. Defenders should focus on monitoring and detecting malicious DLL loading and execution."}, {"techniqueID": "T1190", "comment": "Attackers could use this vulnerability to conduct pivot attacks by escalating privileges and executing malicious code. Defenders should focus on detecting and preventing DLL loading and execution with elevated privileges."}], "stix_bundle": {"type": "bundle", "id": "CVE-2015-0096", "title": "CVE-2015-0096: Untrusted Search Path Vulnerability in Microsoft Windows", "description": "A vulnerability in Microsoft Windows allows local users to gain elevated privileges via a Trojan horse DLL in the current working directory, leading to DLL loading during Windows Explorer access to the icon of a crafted shortcut.", "created_by": "Vulnerability Analysis Team", "created": "2021-02-22T14:30:00.000Z", "modified": "2021-02-22T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "CVE-2015-0096", "title": "CVE-2015-0096: Untrusted Search Path Vulnerability in Microsoft Windows", "description": "A vulnerability in Microsoft Windows allows local users to gain elevated privileges via a Trojan horse DLL in the current working directory, leading to DLL loading during Windows Explorer access to the icon of a crafted shortcut."}, {"type": "indicator", "id": "Indicator-1", "title": "Malicious DLL Loading", "description": "Indicates the loading of malicious DLLs in the current working directory.", "created_by": "Vulnerability Analysis Team", "created": "2021-02-22T14:30:00.000Z", "modified": "2021-02-22T14:30:00.000Z", "relations": [{"relationship_type": "Related to", "target_ref": "CVE-2015-0096"}]}, {"type": "course_of_action", "id": "COA-1", "title": "Monitor and Detect Malicious DLL Loading", "description": "Monitor system logs for DLL loading events and detect suspicious activity.", "created_by": "Vulnerability Analysis Team", "created": "2021-02-22T14:30:00.000Z", "modified": "2021-02-22T14:30:00.000Z", "relations": [{"relationship_type": "Mitigates", "target_ref": "T1134"}]}]}, "technical_analysis": {"Introduction": "This vulnerability is a classic example of an untrusted search path vulnerability, where an attacker can trick the system into loading a malicious DLL.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to gain elevated privileges and execute malicious code. The scope of the vulnerability is limited to local systems, but the potential impact is significant.", "Related MITRE ATT&CK Techniques": "The MITRE ATT&CK techniques related to this vulnerability are T1134, T1574, T1078, and T1190.", "Technical Details": "The vulnerability occurs when Windows Explorer loads a DLL from a directory that is included in the system's PATH environment variable.", "Detection": "Detection of this vulnerability can be challenging, but it can be detected by monitoring system logs for DLL loading events and detecting suspicious activity.", "Mitigation": "The mitigation for this vulnerability is to ensure that the system's PATH environment variable only includes trusted directories and to monitor system logs for DLL loading events.", "Conclusion": "In conclusion, this vulnerability demonstrates the importance of monitoring system logs for DLL loading events and ensuring that the system's PATH environment variable only includes trusted directories."}, "executive_analysis": {"Overview": "This vulnerability is a significant threat to local systems, as it allows attackers to gain elevated privileges and execute malicious code.", "Business Impact": "The business impact of this vulnerability is high, as it can lead to data breaches, privilege escalation, and unauthorized access.", "Technical Impact": "The technical impact of this vulnerability is the potential for code execution with elevated privileges, which can lead to data breaches and unauthorized access.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are to ensure that the system's PATH environment variable only includes trusted directories and to monitor system logs for DLL loading events.", "Recommendations": "We recommend that all organizations prioritize patching and mitigating this vulnerability to prevent potential attacks.", "Conclusions": "In conclusion, this vulnerability is a significant threat to local systems and requires immediate attention and mitigation."}}