{"id": "CVE-2007-6741", "sourceIdentifier": "cve@mitre.org", "published": "2010-10-19T20:00:02.580", "lastModified": "2010-10-20T04:00:00.000", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The ftp_PORT function in FTPServer.py in pyftpdlib before 0.2.0 does not prevent TCP connections to privileged ports if the destination IP address matches the source IP address of the connection from the FTP client, which might allow remote authenticated users to conduct FTP bounce attacks via crafted FTP data, as demonstrated by an FTP bounce attack against a NAT server, a related issue to CVE-1999-0017."}, {"lang": "es", "value": "La funci\u00f3n ftp_PORT en FTPSErver.py en pyftpdlib anterior a v0.2.0 no previene conexiones TCP de puertos privilegiados si la direcci\u00f3n IP de destino compara el c\u00f3digo de la direcci\u00f3n IP de origen de clientes FTP, que deber\u00eda permitir autenticaci\u00f3n de usuarios remotos dirigir un ataque \"FTP bounce\" a trav\u00e9s de datos FTP manipulados, como qued\u00f3 demotrado en el ataque \"FTP bound\" contra el servidor NAT, tema relacionado con CVE-1999-0017."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:*:*:*:*:*:*:*:*", "versionEndIncluding": "0.1.1", "matchCriteriaId": "807615BB-C28B-462D-B0C7-4950E31B0CC6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.1:*:*:*:*:*:*:*", "matchCriteriaId": "DB3D49FE-C51B-49E8-895E-AD4C4E138425"}]}]}], "references": [{"url": "http://code.google.com/p/pyftpdlib/issues/detail?id=11", "source": "cve@mitre.org"}, {"url": "http://code.google.com/p/pyftpdlib/source/browse/trunk/HISTORY", "source": "cve@mitre.org"}, {"url": "http://code.google.com/p/pyftpdlib/source/detail?r=32", "source": "cve@mitre.org"}, {"url": "http://code.google.com/p/pyftpdlib/source/diff?spec=svn32&r=32&format=side&path=/trunk/pyftpdlib/FTPServer.py", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1027", "comment": "Unprivileged File Transfer - The attacker can use this vulnerability to conduct an FTP bounce attack against a NAT server, which is a variant of the T1027 technique."}, {"techniqueID": "T1190", "comment": "Use of Third-Party Libraries - The attacker can use this vulnerability to exploit the FTP PORT function in pyftpdlib, which is a third-party library, making it a variant of the T1190 technique."}, {"techniqueID": "T1505", "comment": "Tree Navigation Failed - The attacker may not be able to navigate the FTP server's directory structure, which is a variant of the T1505 technique."}], "stix_bundle": "your STIX 2.1 bundle here", "technical_analysis": {"Introduction": "Pyftpdlib, a Python FTP server library, contains a vulnerability in its FTP_PORT function that allows remote authenticated users to conduct FTP bounce attacks by crafting FTP data. The vulnerability allows an attacker to connect to a NAT-enabled FTP server and bounce attacks against other systems, making it critical to patch the vulnerability immediately.", "Impact and Scope": "The vulnerability has a CVSS score of 6.5 and an attack vector of NETWORK. It affects pyftpdlib versions prior to 0.2.0 and can be exploited by remote authenticated users.", "Related MITRE ATT&CK Techniques": "The vulnerability relates to several MITRE ATT&CK techniques, including T1027, T1190, and T1505.", "Technical Details": "The vulnerability occurs due to the FTP_PORT function not preventing TCP connections to privileged ports if the destination IP address matches the source IP address of the connection from the FTP client.", "Detection": "Detection of this vulnerability requires monitoring FTP traffic and identifying anomalous behavior, such as multiple connections to privileged ports.", "Mitigation": "The vulnerability can be mitigated by patching pyftpdlib to version 0.2.0 or later or by using a firewall to block TCP connections to privileged ports.", "Conclusion": "The pyftpdlib vulnerability is a critical issue that requires immediate attention to prevent FTP bounce attacks."}, "executive_analysis": {"Overview": "Pyftpdlib, a Python FTP server library, contains a critical vulnerability that allows remote authenticated users to conduct FTP bounce attacks, which can compromise system security.", "Business Impact": "The vulnerability has a significant business impact, as it can lead to data breaches, system compromise, and disruption of business operations.", "Technical Impact": "The vulnerability has a significant technical impact, as it can allow attackers to bypass security controls and gain unauthorized access to systems.", "Mitigation Strategies": "The recommended mitigation strategies include patching pyftpdlib, using a firewall to block TCP connections to privileged ports, and monitoring FTP traffic for anomalous behavior.", "Recommendations": "Executives should prioritize patching pyftpdlib and implementing additional security controls to mitigate the risk of FTP bounce attacks.", "Conclusions": "The pyftpdlib vulnerability is a critical issue that requires immediate attention and should be treated as a high-priority vulnerability."}}