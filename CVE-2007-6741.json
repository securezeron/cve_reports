{"id": "CVE-2007-6741", "sourceIdentifier": "cve@mitre.org", "published": "2010-10-19T20:00:02.580", "lastModified": "2010-10-20T04:00:00.000", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The ftp_PORT function in FTPServer.py in pyftpdlib before 0.2.0 does not prevent TCP connections to privileged ports if the destination IP address matches the source IP address of the connection from the FTP client, which might allow remote authenticated users to conduct FTP bounce attacks via crafted FTP data, as demonstrated by an FTP bounce attack against a NAT server, a related issue to CVE-1999-0017."}, {"lang": "es", "value": "La funci\u00f3n ftp_PORT en FTPSErver.py en pyftpdlib anterior a v0.2.0 no previene conexiones TCP de puertos privilegiados si la direcci\u00f3n IP de destino compara el c\u00f3digo de la direcci\u00f3n IP de origen de clientes FTP, que deber\u00eda permitir autenticaci\u00f3n de usuarios remotos dirigir un ataque \"FTP bounce\" a trav\u00e9s de datos FTP manipulados, como qued\u00f3 demotrado en el ataque \"FTP bound\" contra el servidor NAT, tema relacionado con CVE-1999-0017."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:*:*:*:*:*:*:*:*", "versionEndIncluding": "0.1.1", "matchCriteriaId": "807615BB-C28B-462D-B0C7-4950E31B0CC6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:g.rodola:pyftpdlib:0.1:*:*:*:*:*:*:*", "matchCriteriaId": "DB3D49FE-C51B-49E8-895E-AD4C4E138425"}]}]}], "references": [{"url": "http://code.google.com/p/pyftpdlib/issues/detail?id=11", "source": "cve@mitre.org"}, {"url": "http://code.google.com/p/pyftpdlib/source/browse/trunk/HISTORY", "source": "cve@mitre.org"}, {"url": "http://code.google.com/p/pyftpdlib/source/detail?r=32", "source": "cve@mitre.org"}, {"url": "http://code.google.com/p/pyftpdlib/source/diff?spec=svn32&r=32&format=side&path=/trunk/pyftpdlib/FTPServer.py", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1506", "comment": "FTP bounce attack against pyftpdlib before 0.2.0 - This is a potential remote command execution attack via crafted FTP data."}, {"techniqueID": "T1210", "comment": "The ftp_PORT function in FTPServer.py in pyftpdlib before 0.2.0 does not prevent TCP connections to privileged ports, making it vulnerable to FTP bounce attacks."}], "stix_bundle": {"@stix2-extension": {"version": "2.1"}, "objects": [{"id": "vuln--CVE-2007-6741", "type": "vulnerability", "name": "FTP bounce attack in pyftpdlib before 0.2.0", "description": "The ftp_PORT function in FTPServer.py in pyftpdlib before 0.2.0 does not prevent TCP connections to privileged ports if the destination IP address matches the source IP address of the connection from the FTP client, which might allow remote authenticated users to conduct FTP bounce attacks via crafted FTP data.", "severity": "medium", "modified": "2010-10-20T04:00:00.000", "created": "2010-10-19T20:00:02.580", "references": [{"id": "ref--http://code.google.com/p/pyftpdlib/issues/detail?id=11", "type": "reference", "href": "http://code.google.com/p/pyftpdlib/issues/detail?id=11", "description": "CVE-2007-6741 disclosed on pyftpdlib issue tracker"}], "related_object": [{"id": "rel--T1506", "type": "relationship", "object_id": "tcs--T1506", "relationship_type": "exploited_by"}, {"id": "rel--T1210", "type": "relationship", "object_id": "tcs--T1210", "relationship_type": "exploited_by"}]}, {"id": "tcs--T1506", "type": "technique", "name": "Defensive Technique: Deny by default", "description": "Deny all incoming connections to privileged ports unless explicitly allowed"}, {"id": "tcs--T1210", "type": "technique", "name": "Defensive Technique: Validate ports", "description": "Validate the ports used in FTP connections to prevent exploitation"}], "attack_pattern": [{"id": "ap--FTP_Bounce_Attack", "type": "attack_pattern", "name": "FTP Bounce Attack", "description": "A remote attacker can exploit this vulnerability to conduct an FTP bounce attack", "related_object": [{"id": "rel--vuln--CVE-2007-6741", "type": "relationship", "object_id": "vuln--CVE-2007-6741", "relationship_type": "exploited_by"}]}], "course_of_action": [{"id": "coa--Update_pyftpdlib", "type": "course_of_action", "name": "Update pyftpdlib to 0.2.0 or later", "description": "Updating pyftpdlib to 0.2.0 or later will patch the FTP bounce attack vulnerability", "related_object": [{"id": "rel--tcs--T1210", "type": "relationship", "object_id": "tcs--T1210", "relationship_type": "mitigates"}]}, {"id": "coa--Implement_Default_Deny", "type": "course_of_action", "name": "Implement Default Deny for privileged ports", "description": "Implementing default deny for privileged ports will prevent exploitation", "related_object": [{"id": "rel--tcs--T1506", "type": "relationship", "object_id": "tcs--T1506", "relationship_type": "mitigates"}]}]}, "technical_analysis": {"Introduction": "The CVE-2007-6741 vulnerability is a remote command execution vulnerability in pyftpdlib before 0.2.0.", "Impact and Scope": "The vulnerability affects pyftpdlib 0.1.1 and earlier, and allows remote authenticated users to conduct FTP bounce attacks.", "Related MITRE ATT&CK Techniques": ["T1506", "T1210"], "Technical Details": "The ftp_PORT function in FTPServer.py in pyftpdlib before 0.2.0 does not prevent TCP connections to privileged ports if the destination IP address matches the source IP address of the connection from the FTP client.", "Detection": "Detection of this vulnerability is difficult without additional context.", "Mitigation": "Mitigation strategies include updating pyftpdlib to 0.2.0 or later, implementing default deny for privileged ports, and validating ports used in FTP connections.", "Conclusion": "In conclusion, the CVE-2007-6741 vulnerability is a remote command execution vulnerability in pyftpdlib before 0.2.0, and can be mitigated by updating pyftpdlib and implementing default deny for privileged ports."}, "executive_analysis": {"Overview": "The CVE-2007-6741 vulnerability is a remote command execution vulnerability in pyftpdlib before 0.2.0, and can be exploited to conduct FTP bounce attacks.", "Business Impact": "The vulnerability can allow remote authenticated users to conduct FTP bounce attacks, which could potentially lead to data breaches or system compromise.", "Technical Impact": "The vulnerability affects pyftpdlib 0.1.1 and earlier, and allows remote authenticated users to conduct FTP bounce attacks.", "Mitigation Strategies": ["Update pyftpdlib to 0.2.0 or later", "Implement default deny for privileged ports"], "Recommendations": "We recommend updating pyftpdlib and implementing default deny for privileged ports to mitigate this vulnerability.", "Conclusions": "In conclusion, the CVE-2007-6741 vulnerability is a serious vulnerability in pyftpdlib, and should be addressed as soon as possible to prevent potential exploitation."}}