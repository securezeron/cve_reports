{"id": "CVE-2009-2904", "sourceIdentifier": "secalert@redhat.com", "published": "2009-10-01T15:30:00.233", "lastModified": "2017-09-19T01:29:20.907", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "A certain Red Hat modification to the ChrootDirectory feature in OpenSSH 4.8, as used in sshd in OpenSSH 4.3 in Red Hat Enterprise Linux (RHEL) 5.4 and Fedora 11, allows local users to gain privileges via hard links to setuid programs that use configuration files within the chroot directory, related to requirements for directory ownership."}, {"lang": "es", "value": "Ciertas modificaciones Ret Hat en ChrootDirectory feature en OpenSSH v4.8, como el usado en sshd en OpenSSH v4.3 en Red Hat Enterprise Linux (RHEL) v5.4 y Fedora v11, permite a usuarios locales obtener privilegios a trav\u00e9s de enlaces fuertes en programas setuid que usa una configuraci\u00f3n de ficheros con el chroot directory, relacionado con requerimientos para el propietario."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.9}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-16"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.3:*:*:*:*:*:*:*", "matchCriteriaId": "7910598E-BEC1-4644-9DE4-D8BE505A4F9E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openbsd:openssh:4.8:*:*:*:*:*:*:*", "matchCriteriaId": "40B1B209-53B8-48DC-AFFC-BD69D5978A0B"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:fedoraproject:fedora:11:*:*:*:*:*:*:*", "matchCriteriaId": "B3BB5EDB-520B-4DEF-B06E-65CA13152824"}, {"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:5:*:server:*:*:*:*:*", "matchCriteriaId": "5833A489-D6DE-4D51-9E74-189CBC2E28CA"}, {"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux_desktop:5:*:client:*:*:*:*:*", "matchCriteriaId": "AF3FB21C-AC0E-4F6C-B68A-9405E57ADCF0"}, {"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux_eus:5:*:*:*:*:*:*:*", "matchCriteriaId": "443CB3FD-014D-4C37-BB02-03DAA5A3F3C1"}]}]}], "references": [{"url": "http://lists.fedoraproject.org/pipermail/package-announce/2010-March/038214.html", "source": "secalert@redhat.com"}, {"url": "http://lists.vmware.com/pipermail/security-announce/2010/000082.html", "source": "secalert@redhat.com"}, {"url": "http://osvdb.org/58495", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/38794", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/38834", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/39182", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/bid/36552", "source": "secalert@redhat.com"}, {"url": "http://www.vupen.com/english/advisories/2010/0528", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=522141", "source": "secalert@redhat.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A9862", "source": "secalert@redhat.com"}, {"url": "https://rhn.redhat.com/errata/RHSA-2009-1470.html", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2009-2904 - This vulnerability allows an attacker to gain privileges via hard links to setuid programs that use configuration files within the chroot directory. Defending against this vulnerability requires implementing proper permissions and access controls on the chroot directory."}, {"techniqueID": "T1191", "comment": "CVE-2009-2904 - This vulnerability allows an attacker to gain privileges via hard links to setuid programs that use configuration files within the chroot directory. Defending against this vulnerability requires implementing proper permissions and access controls on the chroot directory."}], "stix_bundle": {"bundle": {"id": "vulnerability_bundle", "type": "bundle", "created_by_ref": "STIX_Core_Object", "created": "2023-03-01T12:00:00.000Z", "modified": "2023-03-01T12:00:00.000Z", "objects": [{"id": "cve-2009-2904", "type": "indicator", "name": "CVE-2009-2904", "description": "A certain Red Hat modification to the ChrootDirectory feature in OpenSSH 4.8, as used in sshd in OpenSSH 4.3 in Red Hat Enterprise Linux (RHEL) 5.4 and Fedora 11, allows local users to gain privileges via hard links to setuid programs that use configuration files within the chroot directory, related to requirements for directory ownership.", "created_by_ref": "STIX_Core_Object", "created": "2023-03-01T12:00:00.000Z", "modified": "2023-03-01T12:00:00.000Z", "labels": ["vulnerability"]}, {"id": "T1190", "type": "attack_pattern", "name": "Lateral Movement", "description": "The adversary uses a Setuid binary to gain additional privilege.", "created_by_ref": "STIX_Core_Object", "created": "2023-03-01T12:00:00.000Z", "modified": "2023-03-01T12:00:00.000Z", "labels": ["lateral_movement"], "notes": ["Description of the attack pattern."], "objects": [{"id": "d3fend-T1190", "type": "defense_technique", "name": "D3FEND-Lateral-Movement", "description": "This technique is used to detect and prevent lateral movement", "created_by_ref": "STIX_Core_Object", "created": "2023-03-01T12:00:00.000Z", "modified": "2023-03-01T12:00:00.000Z", "labels": ["detection", "prevention"]}], "relationships": [{"id": "cve-2009-2904-T1190", "type": "related", "from": "cve-2009-2904", "to": "T1190", "label": "exploits", "relationship_data": ["Description of the relationship"]}]}, {"id": "T1191", "type": "attack_pattern", "name": "Privilege Escalation", "description": "The adversary uses a Setuid binary to gain additional privilege.", "created_by_ref": "STIX_Core_Object", "created": "2023-03-01T12:00:00.000Z", "modified": "2023-03-01T12:00:00.000Z", "labels": ["privilege_escalation"], "notes": ["Description of the attack pattern."], "objects": [{"id": "d3fend-T1191", "type": "defense_technique", "name": "D3FEND-Privilege-Escalation", "description": "This technique is used to detect and prevent privilege escalation", "created_by_ref": "STIX_Core_Object", "created": "2023-03-01T12:00:00.000Z", "modified": "2023-03-01T12:00:00.000Z", "labels": ["detection", "prevention"]}], "relationships": [{"id": "cve-2009-2904-T1191", "type": "related", "from": "cve-2009-2904", "to": "T1191", "label": "exploits", "relationship_data": ["Description of the relationship"]}]}]}}, "technical_analysis": {"Introduction": "CVE-2009-2904 is a vulnerability in OpenSSH 4.3 and 4.8 that allows local users to gain privileges via hard links to setuid programs that use configuration files within the chroot directory.", "Impact and Scope": "The vulnerability has a CVSS score of 6.9 with a base severity of MEDIUM and has been disclosed in multiple advisories.", "Related MITRE ATT&CK Techniques": "T1190: Lateral Movement and T1191: Privilege Escalation", "Technical Details": "The vulnerability is due to the way OpenSSH handles chrooted connections and configuration files.", "Detection": "Detection of this vulnerability can be achieved by monitoring system logs for suspicious activity related to setuid programs.", "Mitigation": "Mitigation strategies for this vulnerability include applying the latest security patches, Implementing proper permissions and access controls on the chroot directory, and monitoring system logs for suspicious activity.", "Conclusion": "In conclusion, CVE-2009-2904 is a serious vulnerability that can be exploited by an attacker to gain privileges. It is essential to apply the latest security patches and monitor system logs for suspicious activity to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2009-2904 is a vulnerability in OpenSSH that can be exploited by an attacker to gain privileges.", "Business Impact": "The vulnerability can result in unauthorized access to sensitive data and systems, which can have significant business impacts.", "Technical Impact": "The vulnerability can result in unauthorized access to sensitive data and systems, which can have significant technical impacts.", "Mitigation Strategies": "Apply the latest security patches, Implement proper permissions and access controls on the chroot directory, and Monitor system logs for suspicious activity.", "Recommendations": "Senior executives should recommend applying the latest security patches and implementing proper permissions and access controls on the chroot directory.", "Conclusions": "In conclusion, CVE-2009-2904 is a serious vulnerability that requires immediate attention and action to prevent exploitation."}}