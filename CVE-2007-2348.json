{"id": "CVE-2007-2348", "sourceIdentifier": "secalert@redhat.com", "published": "2007-04-27T18:19:00.000", "lastModified": "2023-11-07T02:00:36.040", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "mirror --script in lftp before 3.5.9 does not properly quote shell metacharacters, which might allow remote user-assisted attackers to execute shell commands via a malicious script.  NOTE: it is not clear whether this issue crosses security boundaries, since the script already supports commands such as \"get\" which could overwrite executable files."}, {"lang": "es", "value": "La secuencia de comandos mirror en lftp anterior a 3.5.9 no cita adecaudamente el interprete de car\u00e1cteres metacaracter, lo cual podr\u00eda permitir atacantes con la intervenci\u00f3n del usuario ejecutar comandos del interprete de comandos (shell) a trav\u00e9s de secuencias de comandos maliciosas. NOTA: no est\u00e1 claro si este asunto cruza los l\u00edmites de la seguridad, puesto que que la secuencia de comandos apoya  comandos como por ejemplo \u201cget\u201d que podr\u00edan sobreescribir ficheros ejecutables."}], "vendorComments": [{"organization": "Red Hat", "comment": "This issue does not affect lftp as supplied with Red Hat Enterprise Linux 3.\n\nThis issue was addressed for Red Hat Enterprise Linux 5 by\nhttps://rhn.redhat.com/errata/RHSA-2009-1278.html\n\nThe Red Hat Security Response Team has rated this issue as having low security impact, a future update to Red Hat Enterprise Linux 4 may address this flaw.", "lastModified": "2009-09-02T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": true, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:alexander_v._lukyanov:lftp:*:*:*:*:*:*:*:*", "versionEndIncluding": "3.5.8", "matchCriteriaId": "47F5BBDA-3E9F-430B-8C79-C622ABBB14E3"}]}]}], "references": [{"url": "http://bugs.gentoo.org/show_bug.cgi?id=173524", "source": "secalert@redhat.com"}, {"url": "http://lftp.yar.ru/news.html", "source": "secalert@redhat.com"}, {"url": "http://rhn.redhat.com/errata/RHSA-2009-1278.html", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/25107", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/25132", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/36559", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/bid/23736", "source": "secalert@redhat.com"}, {"url": "http://www.vupen.com/english/advisories/2007/1590", "source": "secalert@redhat.com"}, {"url": "https://issues.rpath.com/browse/RPL-1229", "source": "secalert@redhat.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A10806", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "TA0001: Initial Access - Web Application", "comment": "CVE-2007-2348 - A malicious script can be executed due to improper shell metacharacter quoting, allowing for initial access and further execution of commands. Defend against this by restricting access to sensitive areas and implementing web application firewalls."}, {"techniqueID": "T1001: Abuse Elevation of Privilege", "comment": "CVE-2007-2348 - A successfully executed command can lead to an elevation of privileges, potentially allowing an attacker to perform arbitrary actions. Defend against this by restricting access to sensitive areas and implementing privilege access controls."}, {"techniqueID": "T1031: Application Control", "comment": "CVE-2007-2348 - Implement application control mechanisms to restrict the execution of scripts and prevent unauthorized access to sensitive applications."}], "stix_bundle": {"typ": "bundle", "spec_version": "2.1", "id": "https://example.com/cve-2007-2348", "objects": [{"typ": "identity", "spec_version": "2.1", "id": "https://example.com/cve-2007-2348", "name": "CVE-2007-2348", "description": "Script execution vulnerability in lftp before 3.5.9"}, {"typ": "attack-pattern", "spec_version": "2.1", "id": "https://example.com/T1001", "name": "T1001: Abuse Elevation of Privilege", "description": "Abusing elevation of privilege to gain unauthorized access"}, {"typ": "attack-pattern", "spec_version": "2.1", "id": "https://example.com/T1031", "name": "T1031: Application Control", "description": "Restricting access to sensitive applications"}]}, "technical_analysis": {"Introduction": "A script execution vulnerability in lftp allows for initial access and potential privilege escalation", "Impact and Scope": "CVSS v2: 6.8, attack vector 'NETWORK', confidentiality impact 'PARTIAL', integrity impact 'PARTIAL', availability impact 'PARTIAL'.", "Related MITRE ATT&CK Techniques": "T1001, T1031", "Technical Details": "The vulnerability arises from improper shell metacharacter quoting in the mirror script. An attacker can execute a malicious script, execution of which can lead to privilege escalation.", "Detection": "Detect anomalous script execution and restrict access to sensitive areas", "Mitigation": "Implement application control mechanisms, restrict access to sensitive areas, and update lftp to a version after 3.5.9", "Conclusion": "CVE-2007-2348 is a significant vulnerability with potential for privilege escalation. Immediate action is required to mitigate this risk"}, "executive_analysis": {"Overview": "A script execution vulnerability in lftp can lead to loss of data and system compromise", "Business Impact": "Potential data loss and system compromise can result in financial losses and reputational damage", "Technical Impact": "The vulnerability can be exploited to gain unauthorized access and execute arbitrary commands", "Mitigation Strategies": "Implement application control mechanisms, restrict access to sensitive areas, and update lftp to a version after 3.5.9", "Recommendations": "Immediately update lftp to a version after 3.5.9 and implement application control mechanisms", "Conclusions": "The identified vulnerability poses a significant risk and requires immediate attention"}}