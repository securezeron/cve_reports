{"id": "CVE-2009-2948", "sourceIdentifier": "cve@mitre.org", "published": "2009-10-07T18:30:00.920", "lastModified": "2022-10-31T15:03:25.217", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "mount.cifs in Samba 3.0 before 3.0.37, 3.2 before 3.2.15, 3.3 before 3.3.8 and 3.4 before 3.4.2, when mount.cifs is installed suid root, does not properly enforce permissions, which allows local users to read part of the credentials file and obtain the password by specifying the path to the credentials file and using the --verbose or -v option."}, {"lang": "es", "value": "mount.cifs en Samba v3.0 anterior a v3.0.37, v3.2  anterior a v3.2.15, v3.3  anterior a v3.3.8 y v3.4 anterior a v3.4.2, cuando mount.cifs es instalado con el suid root, no refuerza los permisos adecuadamente, lo que permite a usuarios locales leer parte del archivo de credenciales y obtener la contrase\u00f1a especificando la ruta al archivo de credenciales y usando la opci\u00f3n --verbose o -v."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:P/I:N/A:N", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 1.9}, "baseSeverity": "LOW", "exploitabilityScore": 3.4, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-732"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.0.0", "versionEndExcluding": "3.0.37", "matchCriteriaId": "C0E114F0-973F-47CA-A233-53AC718A97F1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.2.0", "versionEndExcluding": "3.2.15", "matchCriteriaId": "836C7AC0-CAE0-459A-A8A5-AA60DFD693CE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.3.0", "versionEndExcluding": "3.3.8", "matchCriteriaId": "D9C888EF-28BF-44BF-9E47-564B0C3222F4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.4.0", "versionEndExcluding": "3.4.2", "matchCriteriaId": "D3209E99-C442-4B0E-8EDB-E4EB995AC9C6"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2009-10/msg00004.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://news.samba.org/releases/3.0.37/", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://news.samba.org/releases/3.2.15/", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://news.samba.org/releases/3.3.8/", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://news.samba.org/releases/3.4.2/", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://osvdb.org/58520", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/36893", "source": "cve@mitre.org", "tags": ["Not Applicable", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/36918", "source": "cve@mitre.org", "tags": ["Not Applicable", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/36937", "source": "cve@mitre.org", "tags": ["Not Applicable", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/36953", "source": "cve@mitre.org", "tags": ["Not Applicable", "Vendor Advisory"]}, {"url": "http://slackware.com/security/viewer.php?l=slackware-security&y=2009&m=slackware-security.561439", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "http://www.samba.org/samba/security/CVE-2009-2948.html", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/36572", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securitytracker.com/id?1022975", "source": "cve@mitre.org", "tags": ["Broken Link", "Patch", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.ubuntu.com/usn/USN-839-1", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2009/2810", "source": "cve@mitre.org", "tags": ["Permissions Required", "Vendor Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/53574", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A10434", "source": "cve@mitre.org", "tags": ["Broken Link", "Third Party Advisory"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A7087", "source": "cve@mitre.org", "tags": ["Broken Link", "Third Party Advisory"]}, {"url": "https://www.redhat.com/archives/fedora-package-announce/2009-October/msg00095.html", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://www.redhat.com/archives/fedora-package-announce/2009-October/msg00098.html", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}], "techniques": [{"techniqueID": "TA0010: Command And Control", "comment": "CVE-2009-2948 - This vulnerability allows an attacker to read part of the credentials file, potentially obtaining the password. This can be exploited through the mount.cifs option --verbose or -v. Defending against this technique requires proper permissions enforcement."}, {"techniqueID": "T1204: Exploitation of Remote Services", "comment": "CVE-2009-2948 - The vulnerability in mount.cifs can be exploited remotely by an attacker, allowing them to read part of the credentials file. Proper configuration and patching of Samba can mitigate this technique."}, {"techniqueID": "T1190: Exploitation of Authentication Mechanisms", "comment": "CVE-2009-2948 - The vulnerability in mount.cifs allows an attacker to read part of the credentials file, potentially obtaining the password. This technique can be used to gain unauthorized access to systems."}, {"techniqueID": "T1554: Modifying System Resources", "comment": "CVE-2009-2948 - An attacker can use this vulnerability to access and modify system resources, such as files and registry keys. This can lead to system compromise and data breaches."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "https://example.com/cve-2009-2948-stix-bundle", "created_by_ref": "https://example.com/user administrator", "created": "2023-02-20T14:30:00.000Z"}, "objects": [{"type": "vulnerability", "id": "https://example.com/vulnerability/cve-2009-2948", "created_by_ref": "https://example.com/user administrator", "created": "2023-02-20T14:30:00.000Z", "name": "CVE-2009-2948", "description": "mount.cifs in Samba 3.0 before 3.0.37, 3.2 before 3.2.15, 3.3 before 3.3.8 and 3.4 before 3.4.2, when mount.cifs is installed suid root, does not properly enforce permissions, which allows local users to read part of the credentials file and obtain the password by specifying the path to the credentials file and using the --verbose or -v option.", "severity": "LOW", "cvss": {"vector": "AV:L/AC:M/Au:N/C:P/I:N/A:N", "score": 1.9}}, {"type": "attack_pattern", "id": "https://example.com/attack_pattern/command-control", "created_by_ref": "https://example.com/user administrator", "created": "2023-02-20T14:30:00.000Z", "name": "Command and Control", "description": "An attack pattern that involves the communication between an attacker and a compromised system to exfiltrate data or receive instructions."}, {"type": "attack_pattern", "id": "https://example.com/attack_pattern/exploitation-of-remote-services", "created_by_ref": "https://example.com/user administrator", "created": "2023-02-20T14:30:00.000Z", "name": "Exploitation of Remote Services", "description": "An attack pattern that involves the exploitation of a remote service to gain unauthorized access to a system or steal sensitive data."}, {"type": "attack_pattern", "id": "https://example.com/attack_pattern/modifying-system-resources", "created_by_ref": "https://example.com/user administrator", "created": "2023-02-20T14:30:00.000Z", "name": "Modifying System Resources", "description": "An attack pattern that involves the modification of system resources, such as files and registry keys, to gain unauthorized access or control of a system."}], " relationships": [{"type": "vulnerability-relates-to", "id": "https://example.com/vulnerability-relates-to/cve-2009-2948", "created_by_ref": "https://example.com/user administrator", "created": "2023-02-20T14:30:00.000Z", "vulnerability_ref": "https://example.com/vulnerability/cve-2009-2948", "attack_pattern_ref": "https://example.com/attack_pattern/command-control"}, {"type": "vulnerability-relates-to", "id": "https://example.com/vulnerability-relates-to/cve-2009-2948", "created_by_ref": "https://example.com/user administrator", "created": "2023-02-20T14:30:00.000Z", "vulnerability_ref": "https://example.com/vulnerability/cve-2009-2948", "attack_pattern_ref": "https://example.com/attack_pattern/exploitation-of-remote-services"}, {"type": "vulnerability-relates-to", "id": "https://example.com/vulnerability-relates-to/cve-2009-2948", "created_by_ref": "https://example.com/user administrator", "created": "2023-02-20T14:30:00.000Z", "vulnerability_ref": "https://example.com/vulnerability/cve-2009-2948", "attack_pattern_ref": "https://example.com/attack_pattern/modifying-system-resources"}]}, "technical_analysis": {"Introduction": "This vulnerability is a low-severity issue in Samba's mount.cifs module. An attacker can exploit it to read part of thecredentials file and obtain the password.", "Impact and Scope": "The attack can be launched locally, and the impact is limited to reading part of the credentials file. The cvss score is 1.9, and the attack vector is LOCAL.", "Related MITRE ATT&CK Techniques": "TA0010: Command And Control, T1204: Exploitation of Remote Services, T1190: Exploitation of Authentication Mechanisms, T1554: Modifying System Resources", "Technical Details": "The vulnerability occurs when mount.cifs is installed suid root and an attacker specifies the path to the credentials file and uses the --verbose or -v option.", "Detection": "Detection of this vulnerability can be challenging, as it relies on the attacker's ability to specify a path to thecredentials file. However, monitoring for unusual authentication attempts and file access patterns can help detect this attack.", "Mitigation": "Proper configuration and patching of Samba can mitigate this vulnerability. Enforcing proper permissions and restricting access to thecredentials file can also help prevent exploitation.", "Conclusion": "This vulnerability is a low-severity issue in Samba's mount.cifs module, and proper mitigation strategies can prevent exploitation."}, "executive_analysis": {"Overview": "This vulnerability is a low-severity issue in Samba's mount.cifs module, which can be exploited locally to read part of thecredentials file and obtain the password.", "Business Impact": "The impact of this vulnerability is limited to reading part of thecredentials file, and it does not provide a significant business risk.", "Technical Impact": "The attack can be launched locally, and the technical impact is limited to unauthorized access to thecredentials file.", "Mitigation Strategies": "Proper configuration and patching of Samba, enforcing proper permissions, and restricting access to thecredentials file can help prevent exploitation.", "Recommendations": "Executives should prioritize patching and configuration efforts and implement proper security policies.", "Conclusions": "This vulnerability is a low-severity issue in Samba's mount.cifs module, and proper mitigation strategies can prevent exploitation."}}