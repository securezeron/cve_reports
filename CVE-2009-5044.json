{"id": "CVE-2009-5044", "sourceIdentifier": "cve@mitre.org", "published": "2011-06-24T20:55:01.607", "lastModified": "2023-11-07T02:04:54.993", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "contrib/pdfmark/pdfroff.sh in GNU troff (aka groff) before 1.21 allows local users to overwrite arbitrary files via a symlink attack on a pdf#####.tmp temporary file."}, {"lang": "es", "value": "contrib/pdfmark/pdfroff.sh en GNU troff (tambi\u00e9n conocido como groff) antes de v1.21 permite sobreescribir ficheros de su elecci\u00f3n a los usuarios locales a trav\u00e9s de un ataque de enlace simb\u00f3lico sobre un fichero temporal  pdf#####.tmp ."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:N/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 3.3}, "baseSeverity": "LOW", "exploitabilityScore": 3.4, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-59"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:*:*:*:*:*:*:*:*", "versionEndIncluding": "10.10.4", "matchCriteriaId": "7883E465-932D-4C11-AA54-97E44181F906"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.20.1", "matchCriteriaId": "7FF8D628-0287-470B-B8CA-18C7BF453B4D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.10:*:*:*:*:*:*:*", "matchCriteriaId": "35017C15-4CCD-4B44-9108-F5650319A009"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.11:*:*:*:*:*:*:*", "matchCriteriaId": "B8AC4613-F1BE-4EEE-84C3-A13D2AC048B8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.11a:*:*:*:*:*:*:*", "matchCriteriaId": "2D6BD17C-0DE9-405D-BC02-E996FBC4F97A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.14:*:*:*:*:*:*:*", "matchCriteriaId": "5493392A-B8E1-4F71-A1ED-6889FD1CC217"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.15:*:*:*:*:*:*:*", "matchCriteriaId": "BDF86410-1841-4549-A0FE-3D16C6CCE383"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.16:*:*:*:*:*:*:*", "matchCriteriaId": "C91EE2C2-DE96-494D-BEEE-D07ED74EDEAC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.16.1:*:*:*:*:*:*:*", "matchCriteriaId": "EDB1389A-0F7D-4616-8553-AF1E40B05256"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.17.1:*:*:*:*:*:*:*", "matchCriteriaId": "6D4A1AC6-2820-4992-B652-EF6FD308D643"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.17.2:*:*:*:*:*:*:*", "matchCriteriaId": "59A32AD0-B019-4FAF-BC8A-01FE6F90628E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.18.1:*:*:*:*:*:*:*", "matchCriteriaId": "A81CEA14-F694-431F-BAC9-BBB8CC09BBCB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.19:*:*:*:*:*:*:*", "matchCriteriaId": "3C3A17D1-F3A9-45FC-A943-C47B8121599C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.19.1:*:*:*:*:*:*:*", "matchCriteriaId": "0D64601D-0EA0-40AD-9E25-74360051CC2C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.19.2:*:*:*:*:*:*:*", "matchCriteriaId": "1D944298-B544-4D38-96A3-5CA22C9C3C7B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:gnu:groff:1.20:*:*:*:*:*:*:*", "matchCriteriaId": "6F737E42-B8F1-4C9C-B3E9-382BCE43859D"}]}]}], "references": [{"url": "ftp://ftp.gnu.org/gnu/groff/groff-1.20.1-1.21.diff.gz", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=538330", "source": "cve@mitre.org"}, {"url": "http://cvsweb.openwall.com/cgi/cvsweb.cgi/Owl/packages/groff/groff-1.20.1-owl-tmp.diff", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://cvsweb.openwall.com/cgi/cvsweb.cgi/Owl/packages/groff/groff-1.20.1-owl-tmp.diff.diff?r1=1.1%3Br2=1.2%3Bf=h", "source": "cve@mitre.org"}, {"url": "http://lists.apple.com/archives/security-announce/2015/Aug/msg00001.html", "source": "cve@mitre.org"}, {"url": "http://openwall.com/lists/oss-security/2009/08/09/1", "source": "cve@mitre.org"}, {"url": "http://openwall.com/lists/oss-security/2009/08/10/2", "source": "cve@mitre.org"}, {"url": "http://openwall.com/lists/oss-security/2009/08/14/4", "source": "cve@mitre.org"}, {"url": "http://openwall.com/lists/oss-security/2009/08/14/5", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/44999", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2013:085", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2013:086", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/36381", "source": "cve@mitre.org"}, {"url": "https://support.apple.com/kb/HT205031", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1003", "comment": "CVE-2009-5044 - The attacker may exploit this vulnerability to overwrite arbitrary files, leading to potential system compromise. Defend against this by ensuring proper file permissions and access control."}, {"techniqueID": "T1047", "comment": "CVE-2009-5044 - The attacker may use this vulnerability to create a backdoor on the system, allowing them to maintain persistence and elevate privileges. Defend against this by implementing regular security updates and monitoring system logs for suspicious activity."}], "stix_bundle": {"objects": [{"id": "vulnerability: CVE-2009-5044", "type": "vulnerability", "name": "GNU troff (groff) PDFmark PDFroff.sh Local File Overwrite Vulnerability", "description": "The groff/PDFroff.sh in GNU troff (aka groff) before 1.21 allows local users to overwrite arbitrary files via a symlink attack on a pdf#####.tmp temporary file.", "labels": ["Vulnerability"], "notes": [{"content": "The attacker may exploit this vulnerability to overwrite arbitrary files, leading to potential system compromise.", "label": "Note 1"}, {"content": "The attacker may use this vulnerability to create a backdoor on the system, allowing them to maintain persistence and elevate privileges.", "label": "Note 2"}]}, {"id": "technique: T1003", "type": "technique", "name": "File and Directory Discovery", "description": "Exfiltrates data by operating system (e.g. files, directories, shares)", "labels": ["Evasion", "Exploitation"]}, {"id": "technique: T1047", "type": "technique", "name": "Web Shell", "description": "Creates or uses a web shell to maintain persistence.", "labels": ["Persistence", "Persistence"]}, {"id": "indicator: groff_PDFmark_PDFroff_sh_overlap", "type": "indicator", "name": "groff PDFmark PDFroff.sh Local File Overwrite Indicator", "description": "The presence of a symbolic link to a pdf#####.tmp temporary file indicating potential system compromise", "labels": ["Threat", "Anomaly"], "notes": [{"content": "Monitor system logs for attempted file overwrites to detect this indicator.", "label": "Note 1"}]}], "relationships": [{"relationship": "related_to", "from": "vulnerability: CVE-2009-5044", "to": "technique: T1003"}, {"relationship": "related_to", "from": "vulnerability: CVE-2009-5044", "to": "technique: T1047"}, {"relationship": "indicates", "from": "technique: T1003", "to": "indicator: groff_PDFmark_PDFroff_sh_overlap"}]}, "technical_analysis": {"Introduction": "The GNU troff (groff) PDFmark PDFroff.sh local file overwrite vulnerability (CVE-2009-5044) allows an attacker to overwrite arbitrary files, potentially leading to system compromise. The vulnerability resides in the use of a temporary file name that can be exploited by an attacker.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to overwrite arbitrary files. The scope of this vulnerability includes any system running groff/PDFroff.sh before version 1.21.", "Related MITRE ATT&CK Techniques": "T1003: File and Directory Discovery, T1047: Web Shell", "Technical Details": "The vulnerability is caused by the use of a temporary file name that can be exploited by an attacker to overwrite arbitrary files. The attacker can use this vulnerability to create a backdoor on the system, allowing them to maintain persistence and elevate privileges.", "Detection": "Monitor system logs for attempted file overwrites to detect this vulnerability. Verify file permissions and access control to prevent exploitation.", "Mitigation": "Apply the patch for groff 1.20.1 to version 1.21. Verify file permissions and access control to prevent exploitation.", "Conclusion": "The GNU troff (groff) PDFmark PDFroff.sh local file overwrite vulnerability (CVE-2009-5044) is a critical vulnerability that allows an attacker to overwrite arbitrary files, potentially leading to system compromise. It is essential to apply the patch and verify file permissions and access control to prevent exploitation."}, "executive_analysis": {"Overview": "The GNU troff (groff) PDFmark PDFroff.sh local file overwrite vulnerability (CVE-2009-5044) is a critical vulnerability that allows an attacker to overwrite arbitrary files, potentially leading to system compromise.", "Business Impact": "This vulnerability can lead to unauthorized data disclosure, unauthorized use, or unauthorized deletion of data, potentially resulting in reputational damage, financial loss, and regulatory non-compliance.", "Technical Impact": "This vulnerability can allow an attacker to overwrite arbitrary files, potentially leading to system compromise and data loss.", "Mitigation Strategies": "Apply the patch for groff 1.20.1 to version 1.21, verify file permissions and access control, and monitor system logs for attempted file overwrites.", "Recommendations": "Apply the patch and verify file permissions and access control. Monitor system logs for attempted file overwrites.", "Conclusions": "The GNU troff (groff) PDFmark PDFroff.sh local file overwrite vulnerability (CVE-2009-5044) is a critical vulnerability that requires immediate attention and mitigation."}}