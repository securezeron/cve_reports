{"id": "CVE-2009-4564", "sourceIdentifier": "cve@mitre.org", "published": "2010-01-04T21:30:00.627", "lastModified": "2017-09-19T01:29:59.657", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "SQL injection vulnerability in index.php in Zenphoto 1.2.5, when the ZenPage plugin is enabled, allows remote attackers to execute arbitrary SQL commands via the category parameter, related to a URI under news/category/."}, {"lang": "es", "value": "Vulnerabilidad de inyecci\u00f3n SQL en index.hpp en Zenphoto v1.2.5 cuando el complemento ZenPage est\u00e1 activado, permite a atacantes remotos ejecutar comandos SQL de su elecci\u00f3n a trav\u00e9s del par\u00e1metro category, relacionado con una URI bajo news/category/."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:zenphoto:zenphoto:1.2.5:*:*:*:*:*:*:*", "matchCriteriaId": "9A6145D8-4527-4728-900B-742C33552C4E"}]}]}], "references": [{"url": "http://www.exploit-db.com/exploits/9154", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0008", "comment": " CVE-2009-4564 - SQL Injection vulnerability allows attackers to inject malicious SQL code, inject privileged content, and manipulate database to execute arbitrary SQL commands."}, {"techniqueID": "TA0005", "comment": " CVE-2009-4564 - This vulnerability is exploited by injecting malicious SQL code into the 'category' parameter, potentially leading to unauthorized data access and disclosure."}, {"techniqueID": "T1190", "comment": " CVE-2009-4564 - This vulnerability can be exploited to inject malicious SQL code, potentially leading to elevated privileges, data manipulation, and unauthorized access."}], "stix_bundle": {"@type": "bundle", "id": "http://example.com/bundle/CVE-2009-4564", "spec_version": "2.1", "objects": [{"@type": "vulnerability", "id": "http://example.com/object/CVE-2009-4564", "name": "SQL Injection Vulnerability in Zenphoto 1.2.5", "description": "A SQL injection vulnerability in index.php in Zenphoto 1.2.5 allows remote attackers to execute arbitrary SQL commands via the category parameter, related to a URI under /news/category/."}, {"@type": "relationship", "id": "http://example.com/relationship/CVE-2009-4564-1", "from": "http://example.com/object/CVE-2009-4564", "to": "http://example.com/object/T1190", "relationship_type": "exploited_by"}, {"@type": "relationship", "id": "http://example.com/relationship/CVE-2009-4564-2", "from": "http://example.com/object/CVE-2009-4564", "to": "http://example.com/object/TA0005", "relationship_type": "exploited_by"}, {"@type": "course_of_action", "id": "http://example.com/course/CVE-2009-4564-1", "name": "Upgrade Zenphoto to a fixed version", "description": "Upgrade Zenphoto to a fixed version to mitigate the vulnerability", "recommended_by": "http://example.com/object/TA0008"}]}, "technical_analysis": {"Introduction": "The SQL injection vulnerability in Zenphoto 1.2.5, identified as CVE-2009-4564, is a critical issue that allows attackers to execute arbitrary SQL commands. This analysis provides an in-depth look at the vulnerability, its impact, and mitigation strategies.", "Impact and Scope": "The vulnerability has a CVSS score of 6.8, with a high impact on confidentiality, integrity, and availability. This means that attackers can access and manipulate sensitive data, leading to a high risk of data breaches and system compromise.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques identified are TA0008, TA0005, and T1190. These techniques are used to exploit this vulnerability and demonstrate the potential threat to the targeted organization.", "Technical Details": "The vulnerability occurs in the 'index.php' file of the Zenphoto 1.2.5 plugin, specifically in the way it handles user input in the 'category' parameter. An attacker can inject malicious SQL code into this parameter to execute arbitrary SQL commands.", "Detection": "Detection of this vulnerability requires monitoring for unusual database activity and log analysis. It is essential to monitor for suspicious database queries and identify potential indicators of compromise (IOC) to detect the vulnerability.", "Mitigation": "Mitigation strategies include upgrading to a fixed version of Zenphoto, disabling the ZenPage plugin, and implementing web application firewall (WAF) rules to block SQL injection attacks. Regularly updating software and plugins is also crucial in preventing exploitation.", "Conclusion": "In conclusion, this analysis demonstrated the severity of the SQL injection vulnerability in Zenphoto 1.2.5 and the potential risks it poses to organizations. Understanding the vulnerability, its impact, and mitigation strategies is crucial in protecting against this threat."}, "executive_analysis": {"Overview": "This vulnerability poses a significant risk to organizations using Zenphoto 1.2.5 and can lead to unauthorized data access, system compromise, and reputational damage.", "Business Impact": "The impact of this vulnerability can result in financial losses, damage to brand reputation, and regulatory penalties. It is essential to address this vulnerability promptly to minimize the risk.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary SQL commands, leading to data breaches, system compromise, and unauthorized access to sensitive information.", "Mitigation Strategies": "Organization should implement a comprehensive mitigation strategy that includes upgrading to a fixed version, disabling the ZenPage plugin, and implementing WAF rules to block SQL injection attacks.", "Recommendations": "It is recommended that organizations allocate resources to address this vulnerability promptly, implement a risk management plan, and conduct regular vulnerability assessments and penetration tests.", "Conclusions": "In conclusion, the SQL injection vulnerability in Zenphoto 1.2.5 poses a significant risk to organizations and requires immediate attention. Implementing mitigation strategies and conducting regular vulnerability assessments is crucial in protecting against this threat."}}