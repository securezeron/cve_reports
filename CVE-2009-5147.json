{"id": "CVE-2009-5147", "sourceIdentifier": "cve@mitre.org", "published": "2017-03-29T14:59:00.187", "lastModified": "2018-03-28T01:29:01.247", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "DL::dlopen in Ruby 1.8, 1.9.0, 1.9.2, 1.9.3, 2.0.0 before patchlevel 648, and 2.1 before 2.1.8 opens libraries with tainted names."}, {"lang": "es", "value": "DL::dlopen en Ruby 1.8, 1.9.0, 1.9.2, 1.9.3, 2.0.0 en versiones anteriores a patchlevel 648, y 2.1 en versiones anteriores a 2.1.8 abre librer\u00edas con nombres contaminados."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": true, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:1.8.0:*:*:*:*:*:*:*", "matchCriteriaId": "16BDFA5C-35BE-4B7E-BD2D-C28B095F62E0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:1.9.0:*:*:*:*:*:*:*", "matchCriteriaId": "52179EC7-CAF0-42AA-A21A-7105E10CA122"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:1.9.2:*:*:*:*:*:*:*", "matchCriteriaId": "5178D04D-1C29-4353-8987-559AA07443EC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:1.9.3:*:*:*:*:*:*:*", "matchCriteriaId": "D0535DC9-EB0E-4745-80AC-4A020DF26E38"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "B03B7561-A854-4EFA-9E4E-CFC4EEAE4EE1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.0.0:p195:*:*:*:*:*:*", "matchCriteriaId": "1C663278-3B2A-4B7C-959A-2AA804467F21"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.0.0:p247:*:*:*:*:*:*", "matchCriteriaId": "B7927149-A76A-48BC-8405-7375FC7D7486"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.0.0:p353:*:*:*:*:*:*", "matchCriteriaId": "3D627638-64AA-455B-9FEA-093D3773B9FD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.0.0:p481:*:*:*:*:*:*", "matchCriteriaId": "19CF27FB-DCF5-4533-B309-55615AE21A63"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.0.0:p576:*:*:*:*:*:*", "matchCriteriaId": "B9865DD1-F2AF-40B6-848A-EA9FD37034DD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.0.0:p594:*:*:*:*:*:*", "matchCriteriaId": "C10BD21E-B9FA-4B57-B617-0108A00D6132"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.0.0:p598:*:*:*:*:*:*", "matchCriteriaId": "3D5ABD47-64AC-4844-B78B-F0D3BC3B8F49"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.0.0:p643:*:*:*:*:*:*", "matchCriteriaId": "4EF7FDAD-9CAF-452D-B229-EF7C390DE712"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.0.0:p645:*:*:*:*:*:*", "matchCriteriaId": "942C4584-11B4-4E6E-BD42-6F4573E55412"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.0.0:p647:*:*:*:*:*:*", "matchCriteriaId": "49AB6D01-7AFE-4482-A6B4-C085A100A9A8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.1.0:*:*:*:*:*:*:*", "matchCriteriaId": "85A846FF-DD34-4DD6-BD61-09124C145E97"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "8DF046E4-503B-4A10-BEAB-3144BD86EA49"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.1.2:*:*:*:*:*:*:*", "matchCriteriaId": "9FCA45F1-3038-413A-B8C3-EE366A4E6248"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.1.3:*:*:*:*:*:*:*", "matchCriteriaId": "FF6AF5E3-4EB8-48A3-B8E9-C79C08C38994"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.1.4:*:*:*:*:*:*:*", "matchCriteriaId": "6AE2B154-8126-4A38-BAB6-915207764FC0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.1.5:*:*:*:*:*:*:*", "matchCriteriaId": "808FA8BE-71FC-4ADD-BDEA-637E8DF4E899"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.1.6:*:*:*:*:*:*:*", "matchCriteriaId": "523417A8-F62B-48AF-B60B-CE9A200D4A9A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:ruby-lang:ruby:2.1.7:*:*:*:*:*:*:*", "matchCriteriaId": "FAB1E0F8-F9B0-40E9-892E-C62729525CE5"}]}]}], "references": [{"url": "http://seclists.org/oss-sec/2015/q3/222", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securityfocus.com/bid/76060", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://access.redhat.com/errata/RHSA-2018:0583", "source": "cve@mitre.org"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1248935", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Patch", "Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/ruby/ruby/commit/4600cf725a86ce31266153647ae5aa1197b1215b", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://www.ruby-lang.org/en/news/2015/12/16/unsafe-tainted-string-usage-in-fiddle-and-dl-cve-2015-7551/", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2009-5147 - An attacker may exploit this vulnerability to execute arbitrary code, potentially leading to data exfiltration, privilege escalation, or unauthorized access. Defenders should monitor for unusual library loading or execution of malicious code."}, {"techniqueID": "T1191", "comment": "CVE-2009-5147 - Further exploitation of this vulnerability could lead to a backdoor being installed, allowing the attacker to maintain persistence and conduct future attacks. Defenders should investigate any unusual system behavior or network traffic."}, {"techniqueID": "T1192", "comment": "CVE-2009-5147 - The vulnerability can be exploited via a Ruby script, requiring a high level of attacker expertise. Defenders should focus on detecting and preventing the execution of malicious Ruby code."}], "stix_bundle": {"type": "STIX_2_1", "id": "bundle:cve-2009-5147", "released": "2019-02-20T14:00:00.000Z", "stix_decorators": {"version": "2.1"}, "objects": [{"type": "vulnerability", "id": "vuln:cve-2009-5147", "created_by": "vuln:cve-2009-5147"}, {"type": "indicator", "id": "ind:b23f5e71-0d8f-409d-854d-8f6d88c7d0f1", "name": "Suspicious Ruby Library Loading"}, {"type": "course_of_action", "id": "coop:cve-2009-5147-co1", "name": "Monitor for Unusual Library Loading", "description": "Monitor system logs and network traffic for suspicious Ruby library loading activity."}, {"type": "course_of_action", "id": "coop:cve-2009-5147-co2", "name": "Prevent Execution of Malicious Ruby Code", "description": "Implement measures to prevent the execution of malicious Ruby code, such as whitelisting approved Ruby scripts."}], " relationships": [{"type": "related_to", "id": "rel: vuln:cve-2009-5147-ind:b23f5e71-0d8f-409d-854d-8f6d88c7d0f1", "source": "vuln:cve-2009-5147", "target": "ind:b23f5e71-0d8f-409d-854d-8f6d88c7d0f1", "label": "associated"}, {"type": "mitigates", "id": "rel:coop:cve-2009-5147-co1-cope-2009-5147-co2", "source": "coop:cve-2009-5147-co1", "target": "coop:cve-2009-5147-co2", "label": "mitigates"}]}, "technical_analysis": {"Introduction": "CVE-2009-5147 is a remote code execution vulnerability in Ruby 1.8, 1.9.0, 1.9.2, 1.9.3, 2.0.0 before patchlevel 648, and 2.1 before 2.1.8.", "Impact and Scope": "This vulnerability allows an attacker to execute arbitrary code with the same privileges as the Ruby interpreter, which could lead to data exfiltration, privilege escalation, or unauthorized access.", "Related MITRE ATT&CK Techniques": "T1190, T1191, T1192", "Technical Details": "The vulnerability is caused by the way Ruby loads dynamic libraries, allowing an attacker to inject malicious code. An attacker can exploit this vulnerability by crafting a malicious Ruby script that is designed to load and execute arbitrary code.", "Detection": "Detection of this vulnerability can be challenging, as an attacker may access the system using a legitimate account. Defenders should investigate any unusual system behavior or network traffic.", "Mitigation": "To mitigate this vulnerability, defenders should prevent the execution of malicious Ruby code by implementing measures such as whitelisting approved Ruby scripts and monitoring for unusual library loading activity.", "Conclusion": "CVE-2009-5147 is a significant vulnerability that requires immediate attention. Defenders should prioritize its remediation and monitor for any signs of exploitation."}, "executive_analysis": {"Overview": "CVE-2009-5147 is a critical vulnerability in Ruby 1.8, 1.9.0, 1.9.2, 1.9.3, 2.0.0 before patchlevel 648, and 2.1 before 2.1.8.", "Business Impact": "The exploitation of this vulnerability could result in data breaches, unauthorized access, or system compromise, leading to significant financial losses and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to execute arbitrary code with the same privileges as the Ruby interpreter, potentially leading to a wide range of technical impacts.", "Mitigation Strategies": "Implement measures to prevent the execution of malicious Ruby code, such as whitelisting approved Ruby scripts and monitoring for unusual library loading activity.", "Recommendations": "Executives should prioritize the remediation of this vulnerability and ensure that all necessary measures are taken to prevent its exploitation.", "Conclusions": "CVE-2009-5147 is a critical vulnerability that requires immediate attention. Executives should work closely with IT teams to ensure its remediation and monitor for any signs of exploitation."}}