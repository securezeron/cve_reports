{"id": "CVE-2009-5157", "sourceIdentifier": "cve@mitre.org", "published": "2019-06-11T21:29:00.287", "lastModified": "2019-06-17T13:26:47.327", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "On Linksys WAG54G2 1.00.10 devices, there is authenticated command injection via shell metacharacters in the setup.cgi c4_ping_ipaddr variable."}, {"lang": "es", "value": "En los dispositivos Linksys WAG54G2 1.00.10, hay una inyecci\u00f3n de comando identificada a trav\u00e9s de metacaracteres de shell en la variable setup.cgi c4_ping_ipaddr."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-77"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linksys:wag54g2_firmware:1.00.10:*:*:*:*:*:*:*", "matchCriteriaId": "BEE5CC15-969F-468F-A1E8-D4AE43AFBCB0"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:h:linksys:wag54g2:-:*:*:*:*:*:*:*", "matchCriteriaId": "B79E7D49-DD32-4426-86F3-EA6CDD0BA1CA"}]}]}], "references": [{"url": "https://www.securityfocus.com/archive/1/503934", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://www.securityfocus.com/bid/35142", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2009-5157 - Command injection vulnerability in Linksys WAG54G2 1.00.10 devices. This vulnerability can be exploited by authenticated attackers to execute arbitrary commands, which can lead to a complete compromise of the device. This technique can be mitigated by restricting access to device configuration settings and implementing input validation and sanitization."}, {"techniqueID": "T1027", "comment": "CVE-2009-5157 - Network exploitation of the vulnerability allows remote attackers to execute arbitrary commands on affected devices. This technique can be mitigated by implementing network segmentation and restricting access to sensitive devices."}, {"techniqueID": "T1439", "comment": "CVE-2009-5157 - Command injection vulnerability can be exploited to escalate privileges and gain control of the device. This technique can be mitigated by implementing privilege escalation prevention and restricting access to sensitive areas of the device."}], "stix_bundle": {"objects": [{"id": "urn:stix:Indicator-50f5c57c-8e0c-4f14-b6f3-d1458a4d3d93", "type": "indicator", "external_references": [{"source_name": "mitre", "external_id": "CVE-2009-5157"}], "subschema": "CVE-2009-5157", "description": "Command injection vulnerability in Linksys WAG54G2 1.00.10 devices.", "created_by_ref": "urn:stix:User-3456", "created": "2022-01-01T14:00:00.000Z", "modified": "2022-01-01T14:00:00.000Z", "related_objects": [{"id": "urn:stix:TTP-b9f6c57c-8e0c-4f14-b6f3-d1458a4d3d93", "type": "ttp", "name": "Command Injection", "description": "Command injection technique", "threats": [{"id": "urn:stix:Threat-50f5c57c-8e0c-4f14-b6f3-d1458a4d3d93", "type": "threat"}]}, {"id": "urn:stix:Vulnerability-d9f6c57c-8e0c-4f14-b6f3-d1458a4d3d93", "type": "vulnerability", "name": "CVE-2009-5157", "description": "Command injection vulnerability in Linksys WAG54G2 1.00.10 devices.", "affected_scores": [{"cvss_version": "2.0", "score": 9.0}, {"cvss_version": "3.0", "score": 8.8}]}]}]}, "technical_analysis": {"Introduction": "This analysis focuses on the command injection vulnerability in Linksys WAG54G2 1.00.10 devices.", "Impact and Scope": "The vulnerability allows remote attackers to execute arbitrary commands on affected devices, leading to a complete compromise of the device. The CVSS score is 9.0 (CVSS 2.0) and 8.8 (CVSS 3.0).", "Related MITRE ATT&CK Techniques": "T1210, T1027, T1439", "Technical Details": "The vulnerability is caused by an authenticated command injection in the setup.cgi c4_ping_ipaddr variable.", "Detection": "Network traffic analysis can be used to detect the exploitation of this vulnerability.", "Mitigation": "Implementing input validation and sanitization, and restricting access to device configuration settings, can help mitigate this vulnerability.", "Conclusion": "This vulnerability highlights the importance of implementing robust security controls in network devices."}, "executive_analysis": {"Overview": "This analysis provides an overview of the command injection vulnerability in Linksys WAG54G2 1.00.10 devices.", "Business Impact": "The vulnerability can lead to a complete compromise of the device, resulting in sensitive data breaches and financial losses.", "Technical Impact": "The vulnerability allows remote attackers to execute arbitrary commands on affected devices, resulting in a complete compromise of the device.", "Mitigation Strategies": "Implementing robust security controls in network devices, such as input validation and sanitization, and restricting access to device configuration settings, can help mitigate this vulnerability.", "Recommendations": "Recommendations include implementing robust security controls, conducting regular security assessments, and educating users on secure network practices.", "Conclusions": "This analysis provides a comprehensive understanding of the command injection vulnerability in Linksys WAG54G2 1.00.10 devices and provides recommendations for mitigation and remediation."}}