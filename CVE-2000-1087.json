{"id": "CVE-2000-1087", "sourceIdentifier": "cve@mitre.org", "published": "2001-01-09T05:00:00.000", "lastModified": "2018-10-12T21:29:57.827", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The xp_proxiedmetadata function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) does not properly restrict the length of a buffer before calling the srv_paraminfo function in the SQL Server API for Extended Stored Procedures (XP), which allows an attacker to cause a denial of service or execute arbitrary commands, aka the \"Extended Stored Procedure Parameter Parsing\" vulnerability."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.6}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.9, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:data_engine:1.0:*:*:*:*:*:*:*", "matchCriteriaId": "F455C373-A9F7-47F9-828E-DEE2C8CC6545"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:data_engine:2000:*:*:*:*:*:*:*", "matchCriteriaId": "51ABD323-BF3F-4825-8788-8FCD614E83E4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:sql_server:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "A2AB95D7-394E-423B-884C-87A9960682EE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:sql_server:2000:*:*:*:*:*:*:*", "matchCriteriaId": "A5D559EE-727C-405C-987C-247973A84D32"}]}]}], "references": [{"url": "http://marc.info/?l=bugtraq&m=97570884410184&w=2", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/2042", "source": "cve@mitre.org", "tags": ["Exploit", "Patch", "Vendor Advisory"]}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2000/ms00-092", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1204", "comment": "CVE-2000-1087 - This technique uses an attacker-controlled buffer to overwrite a data structure in the SQL Server, allowing for Denial of Service (DoS) and potential arbitrary code execution attacks."}, {"techniqueID": "T1205", "comment": "CVE-2000-1087 - This technique uses Extended Stored Procedures to inject arbitrary code into the SQL Server, allowing for potential arbitrary code execution attacks."}, {"techniqueID": "T1580", "comment": "CVE-2000-1087 - This technique uses a vulnerable SQL Server to conduct reconnaissance and provide a foothold for further attacks."}, {"techniqueID": "T1190", "comment": "CVE-2000-1087 - This technique uses a vulnerable SQL Server to conduct privilege escalation and maintain persistence."}], "stix_bundle": {"@stix2-1": {"bundle_description": " Bundle for CVE-2000-1087", "objects": [{"id": "CVE-2000-1087/vulnerability", "type": "vulnerability", "name": "CVE-2000-1087", "description": "The xp_proxiedmetadata function in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE) does not properly restrict the length of a buffer before calling the srv_paraminfo function in the SQL Server API for Extended Stored Procedures (XP), which allows an attacker to cause a denial of service or execute arbitrary commands, aka the \"Extended Stored Procedure Parameter Parsing\" vulnerability.", "created_by_ref": "\u7ec4\u7ec7-12345", "modified": "2018-10-12T21:29:57.827", "components": [{"id": "CVE-2000-1087/exploit", "type": "exploit", "name": "CVE-2000-1087 exploit", "description": "Exploit for CVE-2000-1087", "created_by_ref": "\u7ec4\u7ec7-12345", "modified": "2018-10-12T21:29:57.827", "relationships": [{"id": "CVE-2000-1087/vulnerability-exploit", "type": "has-exploit", "from": "CVE-2000-1087/vulnerability", "to": "CVE-2000-1087/exploit"}]}], "relationships": [{"id": "CVE-2000-1087/cve-2000-1087-techniques", "type": "uses", "from": "CVE-2000-1087/vulnerability", "to": "CVE-2000-1087/T1204", "object_id": "CVE-2000-1087/T1204"}, {"id": "CVE-2000-1087/cve-2000-1087-techniques", "type": "uses", "from": "CVE-2000-1087/vulnerability", "to": "CVE-2000-1087/T1205", "object_id": "CVE-2000-1087/T1205"}, {"id": "CVE-2000-1087/cve-2000-1087-techniques", "type": "uses", "from": "CVE-2000-1087/vulnerability", "to": "CVE-2000-1087/T1580", "object_id": "CVE-2000-1087/T1580"}, {"id": "CVE-2000-1087/cve-2000-1087-techniques", "type": "uses", "from": "CVE-2000-1087/vulnerability", "to": "CVE-2000-1087/T1190", "object_id": "CVE-2000-1087/T1190"}]}]}}, "technical_analysis": {"Introduction": "The vulnerability in CVE-2000-1087 is a stack-based buffer overflow in the xp_proxiedmetadata function of Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE).", "Impact and Scope": "CVSS score: 4.6, Vector: AV:L/AC:L/Au:N/C:P/I:P/A:P. This vulnerability allows an attacker to execute arbitrary code, causing Denial of Service (DoS) and potential privilege escalation.", "Related MITRE ATT&CK Techniques": "T1204, T1205, T1580, T1190", "Technical Details": "The vulnerability is caused by a lack of bounds checking on the input buffer passed to the xp_proxiedmetadata function. This allows an attacker to overflow the buffer and inject arbitrary code.", "Detection": "To detect this vulnerability, look for unusual network traffic, such as large amounts of data being sent to the SQL Server.", "Mitigation": "To mitigate this vulnerability, apply the Microsoft patch MS00-092, and configure the SQL Server to restrict access to the xp_proxiedmetadata function.", "Conclusion": "In conclusion, CVE-2000-1087 is a serious vulnerability in Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE). It allows an attacker to execute arbitrary code and cause Denial of Service (DoS) and potential privilege escalation."}, "executive_analysis": {"Overview": "This is a high severity vulnerability affecting Microsoft SQL Server 2000 and SQL Server Desktop Engine (MSDE).", "Business Impact": "This vulnerability could allow an attacker to execute arbitrary code on the vulnerable system, causing significant financial loss.", "Technical Impact": "This vulnerability could allow an attacker to execute arbitrary code on the vulnerable system, causing significant technical disruption.", "Mitigation Strategies": "Apply the Microsoft patch MS00-092, and configure the SQL Server to restrict access to the xp_proxiedmetadata function.", "Recommendations": "Executives should prioritize patching and configuring the SQL Server to restrict access to the xp_proxiedmetadata function.", "Conclusions": "In conclusion, CVE-2000-1087 is a high severity vulnerability that requires immediate attention and action from executives."}}