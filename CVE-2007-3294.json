{"id": "CVE-2007-3294", "sourceIdentifier": "cve@mitre.org", "published": "2007-06-20T21:30:00.000", "lastModified": "2017-10-11T01:32:44.613", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple buffer overflows in libtidy, as used in the Tidy extension for PHP 5.2.3 and possibly other products, allow context-dependent attackers to execute arbitrary code via (1) a long second argument to the tidy_parse_string function or (2) an unspecified vector to the tidy_repair_string function.  NOTE: this might only be an issue in environments where vsnprintf is implemented as a wrapper for vsprintf."}, {"lang": "es", "value": "M\u00faltiples desbordamientos de b\u00fafer en libtidy, como es usado en la extensi\u00f3n Tidy para PHP versi\u00f3n 5.2.3 y posiblemente otros productos, permiten a atacantes dependiendo del contexto ejecutar c\u00f3digo arbitrario por medio de (1) un segundo argumento largo en la funci\u00f3n tidy_parse_string o (2) un vector no especificado en la funci\u00f3n tidy_repair_string. NOTA: esto solo puede ser un problema en entornos donde vsnprintf se implementa como un contenedor para vsprintf."}], "vendorComments": [{"organization": "Red Hat", "comment": "Not vulnerable. PHP is not complied with the tidy library as shipped with Red Hat Enterprise Linux 2.1, 3, 4, or 5, or Red Hat Application Stack v1 or v2.", "lastModified": "2007-09-28T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.2.3:*:*:*:*:*:*:*", "matchCriteriaId": "86767200-6C9C-4C3E-B111-0E5BE61E197B"}]}]}], "references": [{"url": "http://osvdb.org/36853", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/25735", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/34931", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/4080", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1027", "comment": " CVE-2007-3294 - The buffer overflow vulnerability in PHP can be exploited by an attacker to execute arbitrary code, making it a potential entry point for initial access. This technique is relevant as it highlights the importance of secure coding practices in software development."}, {"techniqueID": "T1050", "comment": " CVE-2007-3294 - The buffer overflow vulnerability in PHP can be exploited by an attacker to execute arbitrary code, making it a potential mechanism for command and control. This technique is relevant as it highlights the importance of network segmentation and access controls."}, {"techniqueID": "T1190", "comment": " CVE-2007-3294 - The buffer overflow vulnerability in PHP can be exploited by an attacker to execute arbitrary code, making it a potential capability for data destruction. This technique is relevant as it highlights the importance of backup and disaster recovery strategies."}], "stix_bundle": {"$schema": "https://docs.mitre.org/stix/stix-2.1/stix-core-v2.1.json", "STIX_Final": {"Package": {"id": " Bundle:CVE-2007-3294", "type": "bundle", "created_by_ref": "http://www.cpe.mitre.org/dictionary/ver2/PHP", "modified": "2017-10-11T01:32:44.613", "packages": [{"id": "Package:CVE-2007-3294", "type": "package", "title": "CVE-2007-3294", "description": "Multiple buffer overflows in libtidy, as used in the Tidy extension for PHP 5.2.3 and possibly other products, allow context-dependent attackers to execute arbitrary code via (1) a long second argument to the tidy_parse_string function or (2) an unspecified vector to the tidy_repair_string function.", "extensions": {"Vulnerability": {"id": "Vulnerability:CVE-2007-3294", "type": "vulnerability", "created_by_ref": "http://www.cpe.mitre.org/dictionary/ver2/PHP", "title": "CVE-2007-3294", "description": "Multiple buffer overflows in libtidy, as used in the Tidy extension for PHP 5.2.3 and possibly other products, allow context-dependent attackers to execute arbitrary code via (1) a long second argument to the tidy_parse_string function or (2) an unspecified vector to the tidy_repair_string function.", "exploit_attempt_refs": [{"id": "Exploit:CVE-2007-3294", "type": "exploit", "created_by_ref": "http://www.cpe.mitre.org/dictionary/ver2/PHP", "title": "Exploit for CVE-2007-3294", "description": "Exploit code for CVE-2007-3294 vulnerability", "vulnerability_refs": [{"id": "Vulnerability:CVE-2007-3294", "type": "vulnerability", "created_by_ref": "http://www.cpe.mitre.org/dictionary/ver2/PHP", "title": "CVE-2007-3294"}]}]}}, "stix_attack_patterns": [{"id": "Attack-Pattern:T1027", "type": "attack-pattern", "title": "TA0011 - Cross-Site Scripting", "description": "This attack pattern demonstrates how an attacker can exploit a cross-site scripting (XSS) vulnerability to execute arbitrary code. An attacker injects malicious script into a website, which is then executed by the victim's browser, allowing the attacker to steal sensitive information or take control of the browser."}, {"id": "Attack-Pattern:T1050", "type": "attack-pattern", "title": "TA0010 - Command and Control", "description": "This attack pattern demonstrates how an attacker can use a compromised system to establish a command and control (C2) channel with other compromised systems. The attacker uses the compromised system to issue commands to the other compromised systems, allowing the attacker to maintain control and extract sensitive information."}, {"id": "Attack-Pattern:T1190", "type": "attack-pattern", "title": "TA0015 - Data Destruction", "description": "This attack pattern demonstrates how an attacker can use a compromised system to destroy or manipulate data on target systems. The attacker uses the compromised system to issue commands to the target systems, allowing the attacker to destroy sensitive information or disrupt the operation of the systems."}]}]}}}, "technical_analysis": {"Introduction": "The CVE-2007-3294 vulnerability in PHP is a buffer overflow vulnerability that can be exploited by an attacker to execute arbitrary code. This vulnerability is relevant to organizations that use PHP and have not patched their systems.", "Impact and Scope": "The impact of this vulnerability is high, as it can be exploited to execute arbitrary code on vulnerable systems. The scope of the vulnerability is broad, as it affects all systems that use PHP and have not been patched.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1027, T1050, and T1190.", "Technical Details": "The vulnerability is due to a buffer overflow in the tidy_parse_string function, which allows an attacker to inject arbitrary code into the buffer.", "Detection": "The vulnerability can be detected using various detection methods, including signature-based detection and behavioral detection.", "Mitigation": "The vulnerability can be mitigated by patching the affected PHP systems and implementing secure coding practices.", "Conclusion": "The CVE-2007-3294 vulnerability is a significant threat to organizations that use PHP and have not patched their systems. It is essential to patch the affected systems and implement secure coding practices to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2007-3294 vulnerability in PHP is a severe vulnerability that can be exploited to execute arbitrary code on vulnerable systems.", "Business Impact": "The vulnerability has a significant business impact, as it can be exploited to steal sensitive information, disrupt operations, and cause financial loss.", "Technical Impact": "The vulnerability has a technical impact, as it can be exploited to execute arbitrary code on vulnerable systems, allowing the attacker to gain control and steal sensitive information.", "Mitigation Strategies": "The vulnerability can be mitigated by patching the affected PHP systems and implementing secure coding practices.", "Recommendations": "We recommend that organizations patch their affected PHP systems and implement secure coding practices to prevent exploitation.", "Conclusions": "The CVE-2007-3294 vulnerability is a significant threat to organizations that use PHP and have not patched their systems. It is essential to patch the affected systems and implement secure coding practices to prevent exploitation."}}