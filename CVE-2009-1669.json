{"id": "CVE-2009-1669", "sourceIdentifier": "cve@mitre.org", "published": "2009-05-18T18:30:00.967", "lastModified": "2017-09-29T01:34:30.357", "vulnStatus": "Modified", "cveTags": [], "evaluatorImpact": "Per http://secunia.com/advisories/35072\r\n\"The vulnerability is confirmed in version 2.6.22 on Windows. Other versions may also be affected.\"", "descriptions": [{"lang": "en", "value": "The smarty_function_math function in libs/plugins/function.math.php in Smarty 2.6.22 allows context-dependent attackers to execute arbitrary commands via shell metacharacters in the equation attribute of the math function.  NOTE: some of these details are obtained from third party information."}, {"lang": "es", "value": "La funci\u00f3n smarty_function_math en libs/plugins/function.math.php en Smarty v2.6.22 permite que atacantes, dependiendo del contexto, ejecutar comandos de su elecci\u00f3n a trav\u00e9s de metacaracteres en el atributo equation de la funci\u00f3n math. NOTE: algunos de esos detalles se han obtenido de informaci\u00f3n de terceros."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:smarty:smarty:2.6.22:*:*:*:*:*:*:*", "matchCriteriaId": "7B95000D-10A0-4D15-946E-24E432C6A464"}]}]}], "references": [{"url": "http://osvdb.org/54380", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/35072", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/35219", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/34918", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.ubuntu.com/usn/usn-791-3", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/50457", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/8659", "source": "cve@mitre.org"}, {"url": "https://www.redhat.com/archives/fedora-package-announce/2009-May/msg01274.html", "source": "cve@mitre.org"}, {"url": "https://www.redhat.com/archives/fedora-package-announce/2009-May/msg01283.html", "source": "cve@mitre.org"}, {"url": "https://www.redhat.com/archives/fedora-package-announce/2009-May/msg01287.html", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2009-1669 - The vulnerability allows attackers to execute arbitrary commands via shell metacharacters in the equation attribute of the math function. This type of command injection allows attackers to elevate privileges, install malware, or steal sensitive data."}, {"techniqueID": "T1059", "comment": "CVE-2009-1669 - The vulnerability allows attackers to execute arbitrary commands via shell metacharacters in the equation attribute of the math function, allowing for Command and Control (C2) activity and potential data exfiltration."}, {"techniqueID": "T1190", "comment": "CVE-2009-1669 - The vulnerability allows attackers to execute arbitrary commands via shell metacharacters in the equation attribute of the math function, allowing for privileged escalation and potential lateral movement."}, {"techniqueID": "T1055", "comment": "CVE-2009-1669 - The vulnerability allows attackers to execute arbitrary commands via shell metacharacters in the equation attribute of the math function, allowing for data manipulation and potential data exfiltration."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "urn:md:sid CWE-20", "title": "CVE-2009-1669 Bundle", "description": "Bundle for CVE-2009-1669, a CWE-20 vulnerability in Smarty 2.6.22.", "created_by_ref": "urn:md:sid:org.mitre.stix", "created": "2019-09-01T14:30:00.000Z", "modified": "2019-09-01T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "urn:md:sid CVE-2009-1669", "title": "CVE-2009-1669", "description": "The smarty_function_math function in libs/plugins/function.math.php in Smarty 2.6.22 allows context-dependent attackers to execute arbitrary commands via shell metacharacters in the equation attribute of the math function.", "published": "2009-05-18T18:30:00.967", "last_modified": "2017-09-29T01:34:30.357", "cvss_score": "CVSS:2.0/AV:N/AC:L/Au:N/C:C/I:C/A:C", "references": [{"relationship": "related_to", "id_ref": "urn:md:sid CWE-20"}]}, {"type": "course_of_action", "id": "urn:md:sid COA-1", "title": "COA-1", "description": "Update Smarty to a version that fixes the vulnerability.", "related_object_type": "vulnerability", "related_object_id": "urn:md:sid CVE-2009-1669", "mitigated_by_technique": "T1190"}, {"type": "course_of_action", "id": "urn:md:sid COA-2", "title": "COA-2", "description": "Disable the math function in Smarty.", "related_object_type": "vulnerability", "related_object_id": "urn:md:sid CVE-2009-1669", "mitigated_by_technique": "T1055"}]}}, "technical_analysis": {"Introduction": "The vulnerability,CVE-2009-1669, in Smarty 2.6.22 allows attackers to execute arbitrary commands via shell metacharacters in the equation attribute of the math function.", "Impact and Scope": "The vulnerability has a CVSS score of 10.0 and an attack vector of network, allowing for potential data exfiltration, privileged escalation, and lateral movement.", "Related MITRE ATT&CK Techniques": "T1027, T1059, T1190, and T1055", "Technical Details": "The vulnerability is caused by the lack of input validation in the smarty_function_math function, allowing attackers to inject shell commands.", "Detection": "Detection methods include monitoring for unusual network activity and analyzing system logs for suspicious commands.", "Mitigation": "Mitigation strategies include updating Smarty to a version that fixes the vulnerability, disabling the math function, and Implementing input validation.", "Conclusion": "The vulnerability poses a significant risk and requires immediate attention."}, "executive_analysis": {"Overview": "CVE-2009-1669 is a critical vulnerability in Smarty 2.6.22 that allows attackers to execute arbitrary commands.", "Business Impact": "The vulnerability could result in the theft of sensitive data, elevated privileges, and potential business disruption.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary commands, potentially leading to data exfiltration, privileged escalation, and lateral movement.", "Mitigation Strategies": "Implement input validation, update Smarty to a fixed version, and disable the math function.", "Recommendations": "Recommendations include prioritizing vulnerability remediation, enhancing threat detection capabilities, and implementing incident response planning.", "Conclusions": "The vulnerability requires immediate attention and necessitates a comprehensive remediation plan."}}