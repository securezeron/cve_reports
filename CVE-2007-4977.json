{"id": "CVE-2007-4977", "sourceIdentifier": "cve@mitre.org", "published": "2007-09-19T18:17:00.000", "lastModified": "2018-10-15T21:39:12.690", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in mode.php in Coppermine Photo Gallery (CPG) 1.4.12 and earlier allows remote attackers to inject arbitrary web script or HTML via the referer parameter."}, {"lang": "es", "value": "Vulnerabilidad de secuencias de comandos en sitios cruzados (XSS) en mode.php de Coppermine Photo Gallery (CPG) 1.4.12 y anteriores permite a atacantes remotos inyectar secuencias de comandos web o HTML de su elecci\u00f3n mediante el par\u00e1metro referer."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4:*:*:*:*:*:*:*", "matchCriteriaId": "183F2FD0-A6D4-4F86-98D7-FC7D22443654"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "EAA317DD-C804-4349-9BDC-B23FAE493516"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4.4:*:*:*:*:*:*:*", "matchCriteriaId": "4D3BB681-16F8-441F-912C-9488791A6420"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4.9:*:*:*:*:*:*:*", "matchCriteriaId": "D7A89B92-8323-4240-80CE-102070202A09"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4.10:*:*:*:*:*:*:*", "matchCriteriaId": "F1BCC40D-EF9C-4843-9183-EA725C9C03FA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4.11:*:*:*:*:*:*:*", "matchCriteriaId": "F0D02234-2729-499B-A686-F1F85401FEDF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:coppermine:coppermine_photo_gallery:1.4.12:*:*:*:*:*:*:*", "matchCriteriaId": "E21C42CB-86B1-4EC1-A508-809316F83CC0"}]}]}], "references": [{"url": "http://coppermine-gallery.net/forum/index.php?topic=46847.0", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://osvdb.org/37100", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/26843", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://securityreason.com/securityalert/3152", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/479757/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/25698", "source": "cve@mitre.org", "tags": ["Exploit", "Patch"]}, {"url": "http://www.securitytracker.com/id?1018704", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/3194", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/36659", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2007-4977 - Cross-site scripting (XSS) vulnerability in mode.php in Coppermine Photo Gallery (CPG) 1.4.12 and earlier allows remote attackers to inject arbitrary web script or HTML via the referer parameter."}], "technical_analysis": {"Introduction": "CVE-2007-4977 is a cross-site scripting (XSS) vulnerability in the mode.php file of Coppermine Photo Gallery (CPG) version 1.4.12 and earlier. This vulnerability allows remote attackers to inject arbitrary web script or HTML content into the victim's browser.", "Impact and Scope": "CVSS Score: 3.5 (Low), Attack Vector: NETWORK, Impact Level: Partially Affected. The vulnerability has amedium complexity of exploitation and requires user interaction.", "Related MITRE ATT&CK Techniques": "TXST, T1190", "Technical Details": "The vulnerability occurs when the referer parameter in the mode.php file is not properly sanitized. An attacker can inject malicious code or HTML content into the referer parameter, which is then executed by the browser.", "Detection": "Detecting this vulnerability requires analyzing network traffic and identifying suspicious requests to the mode.php file with unusual referer parameters.", "Mitigation": "Migrate to a secure version of Coppermine Photo Gallery (CPG), such as version 1.5.4 or later. Apply the patch provided by the Coppermine Photo Gallery team.", "Conclusion": "In conclusion, the CVE-2007-4977 vulnerability is a cross-site scripting (XSS) vulnerability that allows remote attackers to inject arbitrary web script or HTML content into the victim's browser. To mitigate this vulnerability, update to a secure version of Coppermine Photo Gallery (CPG) and apply the provided patch."}, "executive_analysis": {"Overview": "CVE-2007-4977 is a cross-site scripting (XSS) vulnerability in the mode.php file of Coppermine Photo Gallery (CPG) version 1.4.12 and earlier.", "Business Impact": "This vulnerability could potentially allow an attacker to inject malicious code or content into the victim's browser, resulting in various business risks, such as data theft, unauthorized access, and reputational damage.", "Technical Impact": "The vulnerability has a medium complexity of exploitation and requires user interaction, making it moderately difficult to exploit.", "Mitigation Strategies": "Update to a secure version of Coppermine Photo Gallery (CPG) and apply the provided patch.", "Recommendations": "Recommend updating to a secure version of Coppermine Photo Gallery (CPG) and applying the provided patch to ensure the security of the system.", "Conclusions": "In conclusion, it is essential to prioritize updating to a secure version of Coppermine Photo Gallery (CPG) and applying the provided patch to mitigate the risks associated with CVE-2007-4977."}}