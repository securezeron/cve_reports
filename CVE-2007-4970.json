{"id": "CVE-2007-4970", "sourceIdentifier": "cve@mitre.org", "published": "2007-09-19T01:17:00.000", "lastModified": "2018-10-15T21:39:10.160", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "ProcessGuard 3.410 does not properly validate certain parameters to System Service Descriptor Table (SSDT) function handlers, which allows local users to cause a denial of service (crash) and possibly gain privileges via kernel SSDT hooks for Windows Native API functions including (1) NtCreateFile, (2) NtCreateKey, (3) NtDeleteValueKey, (4) NtOpenFile, (5) NtOpenKey, and (6) NtSetValueKey."}, {"lang": "es", "value": "ProcessGuard 3.410 no valida adecuadamente ciertos par\u00e1metros a los manejadores de funciones de Tablas de Descripci\u00f3n de Servicios del Sistema (SSDT), lo cual permite a atacantes remotos provocar una denegaci\u00f3n de servicio (ca\u00edda) y posiblemente obtener privilegios mediante ganchos SSDT del n\u00facleo para funciones de la API nativa de Windows entre las que se incluyen (1) NtCreateFile, (2) NtCreateKey, (3) NtDeleteValueKey, (4) NtOpenFile, (5) NtOpenKey, y (6) NtSetValueKey."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.4}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:diamondcs:processguard:3.410:*:*:*:*:*:*:*", "matchCriteriaId": "B2820834-A151-4FE4-A2AF-485766777D0A"}]}]}], "references": [{"url": "http://osvdb.org/45954", "source": "cve@mitre.org"}, {"url": "http://www.matousec.com/info/advisories/plague-in-security-software-drivers.php", "source": "cve@mitre.org"}, {"url": "http://www.matousec.com/projects/windows-personal-firewall-analysis/plague-in-security-software-drivers.php", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/479830/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/25714", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2007-4970 - Local privilege escalation through Windows Native API functions utilizing kernel SSDT hooks"}, {"techniqueID": "T1027", "comment": "CVE-2007-4970 - Lateral movement through kernel SSDT hooks of Windows Native API functions"}], "stix_bundle": {"spec_version": "2.1", "type": "bundle", "id": "cve-2007-4970-analysis", "created_by_ref": "cyber-security-expert", "created": "2023-02-22T14:30:00", "modified": "2023-02-22T14:30:00", "objects": [{"type": "vulnerability", "id": "cve-2007-4970", "name": "CVE-2007-4970: ProcessGuard 3.410 Kernel SSDT Hook Vulnerability", "description": "ProcessGuard 3.410 does not properly validate certain parameters to System Service Descriptor Table (SSDT) function handlers, which allows local users to cause a denial of service (crash) and possibly gain privileges via kernel SSDT hooks for Windows Native API functions", "severity": "Medium", "cvss": {"vectorString": "AV:L/AC:M/Au:N/C:P/I:P/A:P", "score": 4.4}, "references": [{"url": "http://osvdb.org/45954", "source": "cve@mitre.org"}, {"url": "http://www.matousec.com/info/advisories/plague-in-security-software-drivers.php", "source": "cve@mitre.org"}]}, {"type": "course-of-action", "id": "mitigate-cve-2007-4970", "name": "Mitigate CVE-2007-4970", "description": "Applying kernel patch to fix SSDT handler validation vulnerability", "Related_Threat_Actor": "T1190"}, {"type": "course-of-action", "id": "detect-cve-2007-4970", "name": "Detect CVE-2007-4970", "description": "Monitoring system logs for unusual SSDT function handler activity", "Related_Threat_Actor": "T1190"}], "relationships": [{"id": "cve-2007-4970-mitigate", "type": "related_to", "from": "cve-2007-4970", "to": "mitigate-cve-2007-4970"}, {"id": "cve-2007-4970-detect", "type": "related_to", "from": "cve-2007-4970", "to": "detect-cve-2007-4970"}]}, "technical_analysis": {"Introduction": "CVE-2007-4970 is a vulnerability in ProcessGuard 3.410 that allows local users to cause a denial of service (crash) and possibly gain privileges via kernel SSDT hooks for Windows Native API functions.", "Impact and Scope": "The impact of this vulnerability is local privilege escalation, which allows an attacker to gain elevated privileges on the system.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to T1190 and T1027, which are used to expand the attacker's privileges and move laterally.", "Technical Details": "The vulnerability occurs due to the way ProcessGuard 3.410 validates parameters to System Service Descriptor Table (SSDT) function handlers, allowing an attacker to cause a denial of service (crash) and possibly gain privileges.", "Detection": "Monitoring system logs for unusual SSDT function handler activity can help detect this vulnerability.", "Mitigation": "Applying a kernel patch to fix SSDT handler validation vulnerability can help mitigate this vulnerability.", "Conclusion": "Conclusion: CVE-2007-4970 is a vulnerability that allows local privilege escalation and lateral movement, and it can be mitigated by applying a kernel patch."}, "executive_analysis": {"Overview": "CVE-2007-4970 is a vulnerability in ProcessGuard 3.410 that allows local users to cause a denial of service (crash) and possibly gain privileges.", "Business Impact": "The business impact of this vulnerability is the potential for data breaches and system downtime.", "Technical Impact": "The technical impact of this vulnerability is the potential for local privilege escalation and lateral movement.", "Mitigation Strategies": "Applying a kernel patch to fix SSDT handler validation vulnerability can help mitigate this vulnerability.", "Recommendations": "Recommendations for executives include prioritizing the patching of affected systems and implementing additional security measures to prevent attacks.", "Conclusions": "Conclusion: CVE-2007-4970 is a vulnerability that requires immediate attention and mitigation to prevent potential attacks."}}