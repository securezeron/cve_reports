{"id": "CVE-2007-1900", "sourceIdentifier": "cve@mitre.org", "published": "2007-04-10T18:19:00.000", "lastModified": "2017-10-11T01:32:01.957", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "CRLF injection vulnerability in the FILTER_VALIDATE_EMAIL filter in ext/filter in PHP 5.2.0 and 5.2.1 allows context-dependent attackers to inject arbitrary e-mail headers via an e-mail address with a '\\n' character, which causes a regular expression to ignore the subsequent part of the address string."}, {"lang": "es", "value": "Vulnerabilidad de inyecci\u00f3n CRLF (retorno de carro y nueva l\u00ednea) en el filtro FILTER_VALIDATE_EMAIL en ext/filter de PHP 5.2.0 y 5.2.1 permite a atacantes locales o remotos dependiendo del contexto inyectar cabeceras de correo electr\u00f3nico de su elecci\u00f3n mediante una direcci\u00f3n de correo con un car\u00e1cter '\\n', lo cual provoca que una expresi\u00f3n regular ignore la correspondiente parte de la cadena de direcci\u00f3n."}], "vendorComments": [{"organization": "Red Hat", "comment": "Not vulnerable. The filter extension was not shipped in the versions of PHP supplied for Red Hat Enterprise Linux 2.1, 3, 4, 5, Stronghold 4.0, or\nRed Hat Application Stack 1.\n", "lastModified": "2007-04-16T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.2.0:*:*:*:*:*:*:*", "matchCriteriaId": "CD02D837-FD28-4E0F-93F8-25E8D1C84A99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "88358D1E-BE6F-4CE3-A522-83D1FA4739E3"}]}]}], "references": [{"url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c01178795", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/24824", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/25056", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/25057", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/25062", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/25445", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/25535", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/26231", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27037", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27102", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27110", "source": "cve@mitre.org"}, {"url": "http://security.gentoo.org/glsa/glsa-200705-19.xml", "source": "cve@mitre.org"}, {"url": "http://slackware.com/security/viewer.php?l=slackware-security&y=2007&m=slackware-security.482863", "source": "cve@mitre.org"}, {"url": "http://www.debian.org/security/2007/dsa-1283", "source": "cve@mitre.org"}, {"url": "http://www.gentoo.org/security/en/glsa/glsa-200710-02.xml", "source": "cve@mitre.org"}, {"url": "http://www.novell.com/linux/security/advisories/2007_32_php.html", "source": "cve@mitre.org"}, {"url": "http://www.osvdb.org/33962", "source": "cve@mitre.org"}, {"url": "http://www.php-security.org/MOPB/PMOPB-45-2007.html", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.php.net/releases/5_2_3.php", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/23359", "source": "cve@mitre.org"}, {"url": "http://www.trustix.org/errata/2007/0023/", "source": "cve@mitre.org"}, {"url": "http://www.ubuntu.com/usn/usn-455-1", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/2016", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/3386", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/33510", "source": "cve@mitre.org"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6067", "source": "cve@mitre.org"}, {"url": "https://www.redhat.com/archives/fedora-package-announce/2007-September/msg00397.html", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059.001", "comment": "CVE-2007-1900 - PHP CRLF Injection. The attacker injects newline characters into a PHP form field using a web browser, which allows them to inject arbitrary PHP code into the script, potentially leading to unauthenticated remote code execution. This technique can be used for code injection."}, {"techniqueID": "T1190", "comment": "CVE-2007-1900 - PHP CRLF Injection. The vulnerability is a result of the FILTER_VALIDATE_EMAIL filter not properly sanitizing input, allowing attackers to inject newline characters and execute arbitrary PHP code. This technique can be used for software vulnerability exploitation."}, {"techniqueID": "T1199", "comment": "CVE-2007-1900 - PHP CRLF Injection. The vulnerability allows attackers to inject arbitrary PHP code by sending a specially crafted email address to a PHP application. This technique can be used for code injection and exploitation."}], "stix_bundle": {"type": "bundle", "id": "Bundle--2933a3e6-6f6f-46e4-83eb-89c6c5f3f6d7", "created": "2021-09-15T02:19:33.000Z", "modified": "2021-09-15T02:19:33.000Z", "objects": {"vulnerability": {"type": "vulnerability", "id": "Vulnerability--d5c4f5cc-43e5-4a8a-8d8f-5b8c4a9b1d6e", "created": "2021-09-15T02:19:33.000Z", "modified": "2021-09-15T02:19:33.000Z", "name": "PHP CRLF Injection", "description": "CRLF injection vulnerability in the FILTER_VALIDATE_EMAIL filter in PHP 5.2.0 and 5.2.1 allows context-dependent attackers to inject arbitrary e-mail headers", "vulnerable_configuration": {"type": "vulnerable_configuration", "id": "Vulnerable_configuration--c31100d2-27a4-4125-8e22-7f87f12baf10", "created": "2021-09-15T02:19:33.000Z", "modified": "2021-09-15T02:19:33.000Z", "configuration_component": {"type": "configuration_component", "id": "Configuration_component--3d15f3b8-12f6-45ec-a4ce-1f7d5d3e1f4e", "created": "2021-09-15T02:19:33.000Z", "modified": "2021-09-15T02:19:33.000Z", "name": "PHP 5.2.0 and 5.2.1"}}, "exploit": {"type": "exploit", "id": "Exploit--b5d3d2e8-93af-4821-9316-6f4a12f54c46", "created": "2021-09-15T02:19:33.000Z", "modified": "2021-09-15T02:19:33.000Z", "name": "CRLF Injection"}}, "campaign": {"type": "campaign", "id": "Campaign--567c5c02-a9f1-49a4-9df8-90c85e0d3d25", "created": "2021-09-15T02:19:33.000Z", "modified": "2021-09-15T02:19:33.000Z", "name": "CRLF Injection Attack"}, "course_of_action": {"type": "course_of_action", "id": "Course_of_action--45e74d28-221f-4546-b8e9-e6a8d1f3c38e", "created": "2021-09-15T02:19:33.000Z", "modified": "2021-09-15T02:19:33.000Z", "name": "Patch and update PHP to a secure version"}, "defense": {"type": "defense", "id": "Defense--d94af8ad-5f23-47a9-a3d9-3a5b71c7a435", "created": "2021-09-15T02:19:33.000Z", "modified": "2021-09-15T02:19:33.000Z", "name": "Use a secure PHP version"}}, "relationships": {"vulnerable_configuration_assoc": {"type": "vulnerable_configuration_assoc", "date": "2021-09-15T02:19:33.000Z", "vulnerable_configuration": {"type": "vulnerable_configuration", "id": "Vulnerable_configuration--c31100d2-27a4-4125-8e22-7f87f12baf10"}, "vulnerability": {"type": "vulnerability", "id": "Vulnerability--d5c4f5cc-43e5-4a8a-8d8f-5b8c4a9b1d6e"}}, "exploit_assoc": {"type": "exploit_assoc", "date": "2021-09-15T02:19:33.000Z", "exploit": {"type": "exploit", "id": "Exploit--b5d3d2e8-93af-4821-9316-6f4a12f54c46"}, "vulnerability": {"type": "vulnerability", "id": "Vulnerability--d5c4f5cc-43e5-4a8a-8d8f-5b8c4a9b1d6e"}}, "course_of_action_assoc": {"type": "course_of_action_assoc", "date": "2021-09-15T02:19:33.000Z", "course_of_action": {"type": "course_of_action", "id": "Course_of_action--45e74d28-221f-4546-b8e9-e6a8d1f3c38e"}, "vulnerability": {"type": "vulnerability", "id": "Vulnerability--d5c4f5cc-43e5-4a8a-8d8f-5b8c4a9b1d6e"}}, "defense_assoc": {"type": "defense_assoc", "date": "2021-09-15T02:19:33.000Z", "defense": {"type": "defense", "id": "Defense--d94af8ad-5f23-47a9-a3d9-3a5b71c7a435"}, "vulnerability": {"type": "vulnerability", "id": "Vulnerability--d5c4f5cc-43e5-4a8a-8d8f-5b8c4a9b1d6e"}}}}, "technical_analysis": {"Introduction": "CRLF injection vulnerability in the FILTER_VALIDATE_EMAIL filter in PHP 5.2.0 and 5.2.1 can lead to code injection attacks.", "Impact and Scope": "The vulnerability has a CVSS score of 5.0 with an attack vector of NETWORK. It allows attackers to inject arbitrary PHP code and can lead to unauthenticated remote code execution.", "Related MITRE ATT&CK Techniques": "T1059.001, T1190, and T1199", "Technical Details": "The FILTER_VALIDATE_EMAIL filter does not properly sanitize input and allows attackers to inject newline characters, which can be used to inject arbitrary PHP code.", "Detection": " Detection of this vulnerability can be done by analyzing HTTP requests for sensitive data exfiltration and analyzing system logs for unauthorized code execution.", "Mitigation": "Patch and update PHP to a secure version, implement security patches and harden configurations, and perform regular security audits and vulnerability scanning.", "Conclusion": "The vulnerability can be exploited to inject arbitrary PHP code and can lead to unauthenticated remote code execution. It is recommended to patch and update PHP to a secure version and to implement security hardening measures."}, "executive_analysis": {"Overview": "A CRLF injection vulnerability affects PHP 5.2.0 and 5.2.1, allowing attackers to inject arbitrary PHP code and potentially leading to unauthenticated remote code execution.", "Business Impact": "This vulnerability can lead to data breaches, unauthorized access to sensitive data, and potential financial losses.", "Technical Impact": "This vulnerability can allow attackers to execute arbitrary code, potentially leading to remote code execution, data theft, and system compromise.", "Mitigation Strategies": "Patch and update PHP to a secure version, implement security patches and harden configurations, and perform regular security audits and vulnerability scanning.", "Recommendations": "Implement a robust security posture, perform regular security audits and vulnerability scanning, and ensure that all security patches and updates are applied in a timely manner.", "Conclusions": "The vulnerability is a high-risk issue that requires immediate attention. It is recommended to prioritize patching and updating PHP to a secure version and to implement security hardening measures."}}