{"id": "CVE-2009-1922", "sourceIdentifier": "secure@microsoft.com", "published": "2009-08-12T17:30:00.627", "lastModified": "2019-02-26T14:04:00.993", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Message Queuing (aka MSMQ) service for Microsoft Windows 2000 SP4, XP SP2, Server 2003 SP2, and Vista Gold does not properly validate unspecified IOCTL request data from user mode before passing this data to kernel mode, which allows local users to gain privileges via a crafted request, aka \"MSMQ Null Pointer Vulnerability.\""}, {"lang": "es", "value": "El servicio de cola de mensajes de Microsoft Windows 2000 SP4, XP SP2, Server 2003 SP2, y Vista Gold no valida de forma adecuada los datos de una petici\u00f3n inespec\u00edfica IOCTL en el modo de usuario antes de pasar esta petici\u00f3n al modo kernel, lo que permite a usuarios locales conseguir un aumento de privilegios a trav\u00e9s de una petici\u00f3n manipulada, tambi\u00e9n conocido como \"Vulnerabilidad de puntero nulo MSMQ\""}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.9}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_2000:-:sp4:*:*:*:*:*:*", "matchCriteriaId": "CA2CBE65-F4B6-49AF-983C-D3CF6C172CC5"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2003:*:sp2:*:*:*:*:*:*", "matchCriteriaId": "4D3B5E4F-56A6-4696-BBB4-19DF3613D020"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_vista:*:*:*:*:*:*:*:*", "matchCriteriaId": "3852BB02-47A1-40B3-8E32-8D8891A53114"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_vista:-:-:x64:*:*:*:*:*", "matchCriteriaId": "CD560746-0AED-4646-934E-6742888FB6F2"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_xp:-:sp2:*:*:*:*:*:*", "matchCriteriaId": "34DF3B5E-F17F-49B4-9DC8-06749F3C9CC3"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_xp:-:sp2:x64:*:*:*:*:*", "matchCriteriaId": "FFAC3F90-77BF-4F56-A89B-8A3D2D1FC6D6"}]}]}], "references": [{"url": "http://en.securitylab.ru/lab/PT-2008-09", "source": "secure@microsoft.com"}, {"url": "http://osvdb.org/56901", "source": "secure@microsoft.com"}, {"url": "http://secunia.com/advisories/36214", "source": "secure@microsoft.com", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/505691/100/0/threaded", "source": "secure@microsoft.com"}, {"url": "http://www.securitytracker.com/id?1022714", "source": "secure@microsoft.com"}, {"url": "http://www.us-cert.gov/cas/techalerts/TA09-223A.html", "source": "secure@microsoft.com", "tags": ["US Government Resource"]}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-040", "source": "secure@microsoft.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6109", "source": "secure@microsoft.com"}], "techniques": [{"techniqueID": "TA0006", "comment": "CVE-2009-1922 - Local Privilege Escalation. This vulnerability allows a local attacker to gain privileges via a crafted IOCTL request. This vulnerability can be exploited using a variety of techniques such as using a debugger or using a specific IOCTL request. The impact of this vulnerability is high, and it is important to take immediate action to remediate it."}, {"techniqueID": "TA0007", "comment": "CVE-2009-1922 - Ability to read or modify kernel memory. This vulnerability allows a local attacker to read or modify kernel memory, which can lead to arbitrary code execution. This vulnerability can be exploited using a variety of techniques such as using a debugger or using a specific IOCTL request. The impact of this vulnerability is high, and it is important to take immediate action to remediate it."}, {"techniqueID": "TA0009", "comment": "CVE-2009-1922 - Ability to execute arbitrary code. This vulnerability allows a local attacker to execute arbitrary code, which can lead to system compromise. This vulnerability can be exploited using a variety of techniques such as using a debugger or using a specific IOCTL request. The impact of this vulnerability is high, and it is important to take immediate action to remediate it."}], "stix_bundle": {"id": "1", "type": "bundle", "created_by_ref": "https://stix-project.github.io/v2", "modified": "2019-02-26T14:04:00.993", "description": "A STIX 2.1 bundle expressing all the related techniques, risks and defense strategies for CVE-2009-1922", "objects": [{"id": "1", "type": "vulnerability", "created_by_ref": "https://stix-project.github.io/v2", "modified": "2019-02-26T14:04:00.993", "description": "A vulnerability in Microsoft Windows 2000 SP4, XP SP2, Server 2003 SP2, and Vista Gold that allows a local attacker to gain privileges via a crafted IOCTL request", "object_marking_refs": [{"id": "1", "type": "marking-definition", "created_by_ref": "https://stix-project.github.io/v2", "modified": "2019-02-26T14:04:00.993", "description": "A marking definition used to indicate that the affected system is Microsoft Windows 2000 SP4, XP SP2, Server 2003 SP2, or Vista Gold"}], "kill_chain_phases_refs": [{"id": "1", "type": "kill-chain-phase", "created_by_ref": "https://stix-project.github.io/v2", "modified": "2019-02-26T14:04:00.993", "description": "An entry into the kill chain phase that is associated with the exploitation of the vulnerability"}, {"id": "2", "type": "kill-chain-phase", "created_by_ref": "https://stix-project.github.io/v2", "modified": "2019-02-26T14:04:00.993", "description": "A maneuvering phase in the kill chain that involves the exploitation of the vulnerability"}, {"id": "3", "type": "kill-chain-phase", "created_by_ref": "https://stix-project.github.io/v2", "modified": "2019-02-26T14:04:00.993", "description": "An attack phase in the kill chain that involves the exploitation of the vulnerability"}]}, {"id": "2", "type": "course-of-action", "created_by_ref": "https://stix-project.github.io/v2", "modified": "2019-02-26T14:04:00.993", "description": "A course of action that is used to remediate the vulnerability", "background_refs": [{"id": "1", "type": "vulnerability", "created_by_ref": "https://stix-project.github.io/v2", "modified": "2019-02-26T14:04:00.993", "description": "A vulnerability in Microsoft Windows 2000 SP4, XP SP2, Server 2003 SP2, and Vista Gold that allows a local attacker to gain privileges via a crafted IOCTL request"}], "recommended_courses_of_action_refs": [{"id": "1", "type": "recommended-course-of-action", "created_by_ref": "https://stix-project.github.io/v2", "modified": "2019-02-26T14:04:00.993", "description": "A recommended course of action that involves applying a patch to remediate the vulnerability"}]}], "relationships": [{"id": "1", "type": "is-related-to", "relationship_type": "is_a_vulnerability_of", "source_ref": "1", "target_ref": "2"}]}, "technical_analysis": {"Introduction": "The vulnerability is a privilege escalation vulnerability that allows a local attacker to gain privileges via a crafted IOCTL request.", "Impact and Scope": "The vulnerability is a local privilege escalation vulnerability, which means it only affects the local system. The vulnerability has a CVSS score of 6.9, which indicates high severity.", "Related MITRE ATT&CK Techniques": "[TA0006, TA0007, TA0009]", "Technical Details": "The vulnerability is due to a flaw in the way the Message Queuing (MSMQ) service handles IOCTL requests. An attacker can exploit this vulnerability by sending a crafted IOCTL request to the MSMQ service, which allows them to gain privileges.", "Detection": "Detection can be done by monitoring the system for suspicious IOCTL requests to the MSMQ service.", "Mitigation": "Mitigation strategies include applying a patch, disabling the MSMQ service, and monitoring the system for suspicious activity.", "Conclusion": "In conclusion, the vulnerability is a high-severity local privilege escalation vulnerability that allows an attacker to gain privileges via a crafted IOCTL request. It is important to take immediate action to remediate this vulnerability."}, "executive_analysis": {"Overview": "The vulnerability is a privilege escalation vulnerability that allows a local attacker to gain privileges via a crafted IOCTL request.", "Business Impact": "The vulnerability could allow an attacker to gain unauthorized access to sensitive data or systems, which could have significant business impacts.", "Technical Impact": "The vulnerability could allow an attacker to gain unauthorized access to sensitive data or systems, which could have significant technical impacts.", "Mitigation Strategies": "Applying a patch, disabling the MSMQ service, monitoring the system for suspicious activity.", "Recommendations": "Apply a patch, disable the MSMQ service, and monitor the system for suspicious activity.", "Conclusions": "In conclusion, the vulnerability is a high-severity local privilege escalation vulnerability that allows an attacker to gain privileges via a crafted IOCTL request. It is important to take immediate action to remediate this vulnerability."}}