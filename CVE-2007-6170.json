{"id": "CVE-2007-6170", "sourceIdentifier": "cve@mitre.org", "published": "2007-11-30T01:46:00.000", "lastModified": "2018-10-26T14:17:39.037", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "SQL injection vulnerability in the Call Detail Record Postgres logging engine (cdr_pgsql) in Asterisk 1.4.x before 1.4.15, 1.2.x before 1.2.25, B.x before B.2.3.4, and C.x before C.1.0-beta6 allows remote authenticated users to execute arbitrary SQL commands via (1) ANI and (2) DNIS arguments."}, {"lang": "es", "value": "Vulnerabilidad de inyecci\u00f3n SQL en el motor de registro Call Detail Record Postgres (cdr_pgsql) de Asterisk 1.4.x anterior a 1.4.15, 1.2.x anterior a 1.2.25, B.x anterior a B.2.3.4, y C.x anterior a C.1.0-beta6 permite a usuarios remotos autenticados ejecutar comandos SQL de su elecci\u00f3n mediante los argumentos (1) ANI y (2) DNIS."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:digium:asterisk:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.2.0", "versionEndExcluding": "1.2.25", "matchCriteriaId": "5B9D3734-ECE5-4A33-AFE2-1EAD07B997A5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:digium:asterisk:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.4.0", "versionEndExcluding": "1.4.15", "matchCriteriaId": "509EE4B3-B44A-446F-B1B5-476A8BE0F4D6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:digium:asterisk:*:*:*:*:business:*:*:*", "versionStartIncluding": "b.2.3.0", "versionEndExcluding": "b.2.3.4", "matchCriteriaId": "DEF6C31E-6C5C-4CBA-B6D7-593C1292AF65"}, {"vulnerable": true, "criteria": "cpe:2.3:a:digium:asterisk:c.1.0:beta1:*:*:business:*:*:*", "matchCriteriaId": "5B85E573-3A3A-471F-906D-8A262315D0CC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:digium:asterisk:c.1.0:beta2:*:*:business:*:*:*", "matchCriteriaId": "65963B39-845B-47D9-A1BD-6ABBA160EF05"}, {"vulnerable": true, "criteria": "cpe:2.3:a:digium:asterisk:c.1.0:beta3:*:*:business:*:*:*", "matchCriteriaId": "4015BA36-F972-434D-8DA0-4ECE9992275A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:digium:asterisk:c.1.0:beta4:*:*:business:*:*:*", "matchCriteriaId": "587B6E6C-11C5-4721-B0F3-77E77B1C65A7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:digium:asterisk:c.1.0:beta5:*:*:business:*:*:*", "matchCriteriaId": "E4160773-6EA9-4339-9DD1-28D4EE591830"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:3.1:*:*:*:*:*:*:*", "matchCriteriaId": "A2E0C1F8-31F5-4F61-9DF7-E49B43D3C873"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:4.0:*:*:*:*:*:*:*", "matchCriteriaId": "0F92AB32-E7DE-43F4-B877-1F41FA162EC7"}]}]}], "references": [{"url": "http://downloads.digium.com/pub/security/AST-2007-026.html", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2008-03/msg00001.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/27827", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/27892", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/29242", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/29782", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://security.gentoo.org/glsa/glsa-200804-13.xml", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://securitytracker.com/id?1019020", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.debian.org/security/2007/dsa-1417", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/484388/100/0/threaded", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securityfocus.com/bid/26647", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.vupen.com/english/advisories/2007/4056", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/38765", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2007-6170 - This SQL Injection vulnerability allows remote authenticated users to execute arbitrary SQL commands via ANI and DNIS arguments, which can result in the execution of arbitrary system commands, data theft, and persistent presence. Defending against this vulnerability requires proper SQL injection mitigation strategies, such as whitelisting, validation of user inputs, and limiting the power of the database privileges."}, {"techniqueID": "T1190", "comment": "CVE-2007-6170 - This SQL Injection vulnerability allows remote authenticated users to execute arbitrary SQL commands via ANI and DNIS arguments, which can result in the execution of arbitrary system commands, data theft, and persistent presence. Defending against this vulnerability requires proper system hardening, restriction of network access, and monitoring of system logs."}, {"techniqueID": "T1007", "comment": "CVE-2007-6170 - This SQL Injection vulnerability allows remote authenticated users to execute arbitrary SQL commands via ANI and DNIS arguments, which can result in the execution of arbitrary system commands, data theft, and persistent presence. Defending against this vulnerability requires proper network segmentation, firewall configuration, and intrusion detection."}, {"techniqueID": "T1584", "comment": "CVE-2007-6170 - This SQL Injection vulnerability allows remote authenticated users to execute arbitrary SQL commands via ANI and DNIS arguments, which can result in the execution of arbitrary system commands, data theft, and persistent presence. Defending against this vulnerability requires proper configuration of database access controls, user authentication, and network access controls."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2007-6170", "description": "SQL injection vulnerability in the Call Detail Record Postgres logging engine (cdr_pgsql) in Asterisk 1.4.x before 1.4.15, 1.2.x before 1.2.25, B.x before B.2.3.4, and C.x before C.1.0-beta6 allows remote authenticated users to execute arbitrary SQL commands via ANI and DNIS arguments.", "related_object": {"type": "attack-pattern", "id": "att&ck:T1059", "description": "SQL Injection"}}, {"type": "intrusion-set", "id": "ISIS", "description": "ISIS is an advanced persistent threat (APT) group known for its sophisticated malware tools and tactics.", "related_object": {"type": "intrusion-set", "id": "ISIS", "description": "ISIS is involved in attacks related to CVE-2007-6170"}}, {"type": "course-of-action", "id": "Update Asterisk", "description": "Update Asterisk to version 1.4.15, 1.2.25, B.2.3.4, or C.1.0-beta6", "mitigates": {"type": "vulnerability", "id": "CVE-2007-6170"}}, {"type": "indicator", "id": "Network Traffic Analysis", "description": "Anomaly detection within network traffic", "detection": {"type": "sensitivity", "value": "high"}}], "relationship": {"object": {"type": "vulnerability", "id": "CVE-2007-6170"}, "related_objects": [{"type": "attack-pattern", "id": "att&ck:T1059"}, {"type": "intrusion-set", "id": "ISIS"}, {"type": "course-of-action", "id": "Update Asterisk"}, {"type": "indicator", "id": "Network Traffic Analysis"}]}}, "technical_analysis": {"Introduction": "The SQL injection vulnerability in Asterisk allows remote authenticated users to execute arbitrary SQL commands, which can result in the execution of arbitrary system commands, data theft, and persistent presence.", "Impact and Scope": "The vulnerability affects Asterisk 1.4.x before 1.4.15, 1.2.x before 1.2.25, B.x before B.2.3.4, and C.x before C.1.0-beta6. It has a CVSS score of 6.5.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1059, T1190, T1007, and T1584.", "Technical Details": "The vulnerability occurs when the Call Detail Record Postgres logging engine in Asterisk 1.4.x before 1.4.15, 1.2.x before 1.2.25, B.x before B.2.3.4, and C.x before C.1.0-beta6 is used with an ANI or DNIS argument.", "Detection": "Detection of the vulnerability can be done by monitoring system logs for suspicious SQL commands, network traffic, and authentication attempts.", "Mitigation": "Mitigation strategies include updating Asterisk to the latest version, restricting network access, and implementing proper SQL injection prevention techniques.", "Conclusion": "The SQL injection vulnerability in Asterisk presents a significant risk to organizations that use Asterisk 1.4.x before 1.4.15, 1.2.x before 1.2.25, B.x before B.2.3.4, and C.x before C.1.0-beta6. It is essential to prioritize patching and implementing mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "The SQL injection vulnerability in Asterisk can allow unauthorized access to critical systems and data.", "Business Impact": "The vulnerability can result in significant financial losses due to data theft, disruption of business operations, and damage to brand reputation.", "Technical Impact": "The vulnerability can allow attackers to execute arbitrary system commands, steal data, and establish a persistent presence on the system.", "Mitigation Strategies": "The recommended mitigation strategies include updating Asterisk to the latest version, restricting network access, and implementing proper SQL injection prevention techniques.", "Recommendations": "We recommend that executives prioritize patching and implementing mitigation strategies to prevent exploitation of the vulnerability.", "Conclusions": "The SQL injection vulnerability in Asterisk presents a significant risk to the organization's security and should be taken seriously."}}