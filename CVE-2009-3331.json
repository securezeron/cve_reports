{"id": "CVE-2009-3331", "sourceIdentifier": "cve@mitre.org", "published": "2009-09-23T12:08:35.670", "lastModified": "2017-09-19T01:29:34.267", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple PHP remote file inclusion vulnerabilities in DDL CMS 1.0 allow remote attackers to execute arbitrary PHP code via a URL in the wwwRoot parameter to (1) header.php, (2) submit.php, (3) submitted.php, and (4) autosubmitter/index.php."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de inclusi\u00f3n remota de archivo PHP en DDL CMS v1.0, permite a atacantes remotos ejecutar c\u00f3digo PHP de su elecci\u00f3n a trav\u00e9s del  una URL en el par\u00e1metro wwwRoot a (1) header.php, (2) submit.php, (3) submitted.php, y (4) autosubmitter/index.php."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ddlcms:ddl_cms:1.0:*:*:*:*:*:*:*", "matchCriteriaId": "610A5D1E-5554-41B6-8CB8-10A38B0367F8"}]}]}], "references": [{"url": "http://www.exploit-db.com/exploits/9722", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/53373", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2009-3331 - This technique involves exploiting a PHP remote file inclusion vulnerability, allowing an attacker to execute arbitrary PHP code. Defenders can detect this by monitoring for unusual file access and network traffic patterns."}, {"techniqueID": "T1027", "comment": "CVE-2009-3331 - This technique involves using a web shell to execute arbitrary code on a web server, which can be achieved by exploiting this PHP remote file inclusion vulnerability. Defenders can detect this by monitoring for suspicious web shell traffic and File Transfer Protocol (FTP) activity."}, {"techniqueID": "T1050", "comment": "CVE-2009-3331 - This technique involves credential dumping and stealing by exploiting this PHP remote file inclusion vulnerability. Defenders can detect this by monitoring for sensitive data being exfiltrated and authentication attempts."}, {"techniqueID": "T1120", "comment": "CVE-2009-3331 - This technique involves using the exploited PHP remote file inclusion vulnerability to deliver additional malware. Defenders can detect this by monitoring for suspicious network traffic and system calls."}], "stix_bundle": {"@context": "https://stix2.io/v2.1", "objects": [{"id": " vulnerability:/CVE-2009-3331", "type": "attack-pattern", "name": "CVE-2009-3331: PHP Remote File Inclusion Vulnerability", "description": "Multiple PHP remote file inclusion vulnerabilities in DDL CMS 1.0 allow remote attackers to execute arbitrary PHP code via a URL in the wwwRoot parameter to (1) header.php, (2) submit.php, (3) submitted.php, and (4) autosubmitter/index.php.", "created": "2023-03-03T14:30:00.000", "modified": "2023-03-03T14:30:00.000", "labels": ["php", "php-rfi", "ddl-cms"], "objects": [{"id": "technique:/T1190", "type": "intrusion-set", "name": "T1190: Data Stolen Through Web Shelling", "description": "An attacker accesses a web shell to steal data from a web server."}, {"id": "technique:/T1027", "type": "intrusion-set", "name": "T1027: Web Shell", "description": "An attacker uses a web shell to execute arbitrary code on a web server."}, {"id": "technique:/T1050", "type": "intrusion-set", "name": "T1050: Credentials from Password Stores", "description": "An attacker steals credentials from password stores on a compromised system."}, {"id": "technique:/T1120", "type": "intrusion-set", "name": "T1120: Deliver Malware", "description": "An attacker delivers malware to a compromised system."}, {"id": "course-of-action:/CoA-1", "type": "course-of-action", "name": "CoA-1: Patch and Update", "description": "Patch and update affected systems to the latest version.", "related-objects": ["technique:/T1190"], "notes": ["Regularly monitor and update system software and plugins to prevent exploitation."], "categories": ["Mitigation", "Prevention"]}]}]}, "technical_analysis": {"Introduction": "CVE-2009-3331 is a PHP remote file inclusion vulnerability in DDL CMS 1.0 that allows remote attackers to execute arbitrary PHP code. This vulnerability can be exploited using a URL in the wwwRoot parameter to header.php, submit.php, submitted.php, and autosubmitter/index.php.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 with a high severity rating. It can be exploited by injecting malicious code into the web application, resulting in unauthorized access and data manipulation.", "Related MITRE ATT&CK Techniques": "The CVE-2009-3331 vulnerability is related to the following MITRE ATT&CK techniques: T1190, T1027, T1050, and T1120.", "Technical Details": "The vulnerability occurs when a PHP script includes a remote file using the include_once() function, allowing an attacker to inject malicious code into the web application.", "Detection": "Defenders can detect this vulnerability by monitoring for suspicious network traffic and system calls.", "Mitigation": "The best defense is to patch and update affected systems to the latest version. Additional mitigation strategies include monitoring for unusual file access and network traffic patterns, as well as restricting access to sensitive areas of the web application.", "Conclusion": "In conclusion, CVE-2009-3331 is a critical vulnerability in DDL CMS 1.0 that can be exploited by remote attackers to execute arbitrary PHP code. It is essential to patch and update affected systems to the latest version and implement additional mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "CVE-2009-3331 is a high-severity vulnerability in PHP that can be exploited by remote attackers to execute arbitrary code.", "Business Impact": "The business impact of this vulnerability is significant, as it can result in unauthorized access and data manipulation. This can lead to financial losses, reputational damage, and disruption of business operations.", "Technical Impact": "The technical impact of this vulnerability is the potential to execute arbitrary code on web servers, which can result in compromised data, disrupted operations, and increased security risk.", "Mitigation Strategies": "The recommended mitigation strategies are patching and updating affected systems to the latest version, restricting access to sensitive areas of the web application, and monitoring for unusual file access and network traffic patterns.", "Recommendations": "We recommend implementing the recommended mitigation strategies as soon as possible to prevent exploitation and minimize the risk of data breaches.", "Conclusions": "In conclusion, CVE-2009-3331 is a critical vulnerability that requires immediate attention. We urge executives to prioritize patching and updating affected systems and implementing additional mitigation strategies to mitigate this risk."}}