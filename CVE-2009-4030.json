{"id": "CVE-2009-4030", "sourceIdentifier": "secalert@redhat.com", "published": "2009-11-30T17:30:00.360", "lastModified": "2023-11-07T02:04:41.513", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "MySQL 5.1.x before 5.1.41 allows local users to bypass certain privilege checks by calling CREATE TABLE on a MyISAM table with modified (1) DATA DIRECTORY or (2) INDEX DIRECTORY arguments that are originally associated with pathnames without symlinks, and that can point to tables created at a future time at which a pathname is modified to contain a symlink to a subdirectory of the MySQL data home directory, related to incorrect calculation of the mysql_unpacked_real_data_home value.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2008-4098 and CVE-2008-2079."}, {"lang": "es", "value": "MySQL v5.1.x anteriores a v5.1.41 permite a usuarios locales evitar ciertas comprobaciones de privilegios invocando CREATE TABLE en una tabla MyISAM con los argumentos (1) DATA DIRECTORY o (2) INDEX DIRECTORY modificados que estan originariamente asociados con pathnames (rutas) sin symlinks, y que pueden apuntar a tables creadas en un futuro en el cual un pathname (ruta) es modificado para contener un symlink a un subdirectorio del directorio home de datos de MySQL. Vulnerabilidad relacionada con una c\u00e1lculo incorrecto del valor mysql_unpacked_real_data_home value.  NOTA: esta vulnerabilidad existe debido a una soluci\u00f3n incompleta al CVE-2008-4098 y CVE-2008-2079."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.4}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-59"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.1.5:*:*:*:*:*:*:*", "matchCriteriaId": "35BED939-3366-4CBF-B6BF-29C0C42E97F7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.1.23:*:*:*:*:*:*:*", "matchCriteriaId": "7D0F7A49-62A2-4201-B6F3-8DB9902A4480"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mysql:mysql:5.1.32:*:*:*:*:*:*:*", "matchCriteriaId": "B2BFBC7B-5C23-4CDB-AE4F-721378C36B07"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1:*:*:*:*:*:*:*", "matchCriteriaId": "F58612F4-1CAC-4BFC-A9B2-3D4025F428FF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "73F49A1D-BCA3-4772-8AB3-621CCC997B3A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.2:*:*:*:*:*:*:*", "matchCriteriaId": "F719DD8E-8379-43C3-97F9-DE350E457F7F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.3:*:*:*:*:*:*:*", "matchCriteriaId": "342BB65B-1358-441C-B59A-1756BCC6414A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.4:*:*:*:*:*:*:*", "matchCriteriaId": "8589B1E7-0D6D-44B4-A36E-8225C5D15828"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.6:*:*:*:*:*:*:*", "matchCriteriaId": "88FEEE64-899F-4F55-B829-641706E29E32"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.7:*:*:*:*:*:*:*", "matchCriteriaId": "D8597F56-BB14-480C-91CD-CAB96A9DDD8D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.8:*:*:*:*:*:*:*", "matchCriteriaId": "7F4C5C88-95A7-4DDA-BC2F-CAFA47B0D67A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.9:*:*:*:*:*:*:*", "matchCriteriaId": "5EB2323C-EFE2-407A-9AE9-8717FA9F8625"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.10:*:*:*:*:*:*:*", "matchCriteriaId": "6341F695-6034-4CC1-9485-ACD3A0E1A079"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.11:*:*:*:*:*:*:*", "matchCriteriaId": "D1DF5F19-ECD9-457F-89C6-6F0271CF4766"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.12:*:*:*:*:*:*:*", "matchCriteriaId": "446DB5E9-EF4C-4A53-911E-91A802AECA5D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.13:*:*:*:*:*:*:*", "matchCriteriaId": "5829BE6A-BC58-482B-9DA1-04FDD413A7A9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.14:*:*:*:*:*:*:*", "matchCriteriaId": "C85D20DF-702B-4F0B-922D-782474A4B663"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.15:*:*:*:*:*:*:*", "matchCriteriaId": "73A09785-3CA4-4797-A836-A958DCDC322F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.16:*:*:*:*:*:*:*", "matchCriteriaId": "C4DE3D79-0966-4E14-9288-7C269A2CEEC3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.17:*:*:*:*:*:*:*", "matchCriteriaId": "564F6A24-BEB3-4420-A633-8AD54C292436"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.18:*:*:*:*:*:*:*", "matchCriteriaId": "047FBCCD-DE7C-41FA-80A3-AD695C643C7A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.19:*:*:*:*:*:*:*", "matchCriteriaId": "687CC501-4CB2-4295-86F6-A5E45DEC2D0D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.20:*:*:*:*:*:*:*", "matchCriteriaId": "822A718D-AD9D-4AB9-802F-5F5C6309D809"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.21:*:*:*:*:*:*:*", "matchCriteriaId": "CA2D4002-FD96-462D-BA55-4624170CAA4C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.22:*:*:*:*:*:*:*", "matchCriteriaId": "0A40FE1C-6EB0-4C75-867E-B1F8408E5A0A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:5.1.30:*:*:*:*:*:*:*", "matchCriteriaId": "31B9607A-1E58-4471-BEDE-03484A1E9739"}]}]}], "references": [{"url": "http://bugs.mysql.com/bug.php?id=32167", "source": "secalert@redhat.com"}, {"url": "http://dev.mysql.com/doc/refman/5.1/en/news-5-1-41.html", "source": "secalert@redhat.com"}, {"url": "http://lists.apple.com/archives/security-announce/2010//Mar/msg00001.html", "source": "secalert@redhat.com"}, {"url": "http://lists.mysql.com/commits/89940", "source": "secalert@redhat.com"}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2010-05/msg00001.html", "source": "secalert@redhat.com"}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2010-11/msg00005.html", "source": "secalert@redhat.com"}, {"url": "http://marc.info/?l=oss-security&m=125908040022018&w=2", "source": "secalert@redhat.com"}, {"url": "http://marc.info/?l=oss-security&m=125908080222685&w=2", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/38517", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/38573", "source": "secalert@redhat.com"}, {"url": "http://support.apple.com/kb/HT4077", "source": "secalert@redhat.com"}, {"url": "http://ubuntu.com/usn/usn-897-1", "source": "secalert@redhat.com"}, {"url": "http://www.debian.org/security/2010/dsa-1997", "source": "secalert@redhat.com"}, {"url": "http://www.openwall.com/lists/oss-security/2009/11/19/3", "source": "secalert@redhat.com"}, {"url": "http://www.openwall.com/lists/oss-security/2009/11/24/6", "source": "secalert@redhat.com"}, {"url": "http://www.redhat.com/support/errata/RHSA-2010-0109.html", "source": "secalert@redhat.com"}, {"url": "http://www.redhat.com/support/errata/RHSA-2010-0110.html", "source": "secalert@redhat.com"}, {"url": "http://www.ubuntu.com/usn/USN-1397-1", "source": "secalert@redhat.com"}, {"url": "http://www.vupen.com/english/advisories/2010/1107", "source": "secalert@redhat.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A11116", "source": "secalert@redhat.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A8156", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2009-4030 - This technique is relevant as it shows how an attacker can gain unauthorized access to the database by leveraging a vulnerability in the MySQL server. To defend against this, ensure that all databases are properly configured and up-to-date with the latest security patches."}, {"techniqueID": "TA0014", "comment": "CVE-2009-4030 - This technique is relevant as it shows how an attacker can gain unauthorized access to the database by exploiting a vulnerability in the MySQL server. To defend against this, implement strict access controls and monitor database logs for suspicious activity."}, {"techniqueID": "TA0020", "comment": "CVE-2009-4030 - This technique is relevant as it shows how an attacker can gain unauthorized access to the database by exploiting a vulnerability in the MySQL server. To defend against this, implement encryption and least privilege access."}, {"techniqueID": "TA0034", "comment": "CVE-2009-4030 - This technique is relevant as it shows how an attacker can gain unauthorized access to the database by exploiting a vulnerability in the MySQL server. To defend against this, monitor system logs and network traffic for signs of suspicious activity and implement anomaly detection."}], "stix_bundle": {"type": "bundle", "id": "Bundle-1", "created_by": "Cyber Security Expert", "created": "2023-11-07T02:04:41.513", "modified": "2023-11-07T02:04:41.513", "labels": ["Windows", "Database"], "objects": [{"type": "vulnerability", "id": "CVE-2009-4030", "created_by": "Cyber Security Expert", "created": "2023-11-07T02:04:41.513", "modified": "2023-11-07T02:04:41.513", "title": "MySQL 5.1.x before 5.1.41 allows local users to bypass certain privilege checks", "description": "MySQL 5.1.x before 5.1.41 allows local users to bypass certain privilege checks by calling CREATE TABLE on a MyISAM table with modified DATA DIRECTORY or INDEX DIRECTORY arguments that are originally associated with pathnames without symlinks, and that can point to tables created at a future time at which a pathname is modified to contain a symlink to a subdirectory of the MySQL data home directory, related to incorrect calculation of the mysql_unpacked_real_data_home value.", "cvss Vector": "AV:L/AC:M/Au:N/C:P/I:P/A:P", "cvss Score": 4.4, "affected Products": ["MySQL"], "mitigation": [{"type": "mitigation", "id": "Mitigation-1", "description": "Apply patches and updates"}, {"type": "mitigation", "id": "Mitigation-2", "description": "Configure strict access controls"}]}, {"type": "attack-pattern", "id": "TA0001", "created_by": "Cyber Security Expert", "created": "2023-11-07T02:04:41.513", "modified": "2023-11-07T02:04:41.513", "title": "Phishing", "description": "Phishing is a type of social engineering attack that involves tricking victims into revealing sensitive information by pretending to be a trustworthy entity.", "labels": ["Social Engineering"], "related_objects": [{"type": "vulnerability", "id": "CVE-2009-4030", "relationship": "uses", "label": "uses"}]}, {"type": "course-of-action", "id": "COA-1", "created_by": "Cyber Security Expert", "created": "2023-11-07T02:04:41.513", "modified": "2023-11-07T02:04:41.513", "title": "Apply patches and updates", "description": "Apply the latest patches and updates to the affected systems", "related_objects": [{"type": "vulnerability", "id": "CVE-2009-4030", "relationship": "mitigates", "label": "mitigates"}]}]}, "technical_analysis": {"Introduction": "This report provides a technical analysis of the CVE-2009-4030 vulnerability and its impact on the security of MySQL databases.", "Impact and Scope": "The vulnerability affects MySQL 5.1.x before 5.1.41 and allows an attacker to bypass certain privilege checks. This could allow an attacker to gain unauthorized access to the database.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: TA0001, TA0014, TA0020, and TA0034.", "Technical Details": "The vulnerability occurs due to an incorrect calculation of the mysql_unpacked_real_data_home value, which allows an attacker to create a MyISAM table with modified DATA DIRECTORY or INDEX DIRECTORY arguments.", "Detection": "Detection of this vulnerability is difficult without advanced monitoring tools and expertise.", "Mitigation": "The vulnerability can be mitigated by applying patches and updates, and configuring strict access controls.", "Conclusion": "This report highlights the importance of maintaining up-to-date software and configuring strict access controls to prevent unauthorized access to the database."}, "executive_analysis": {"Overview": "This report provides an executive summary of the CVE-2009-4030 vulnerability and its impact on the security of MySQL databases.", "Business Impact": "The vulnerability could allow an attacker to gain unauthorized access to sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability allows an attacker to bypass certain privilege checks, which could provide unauthorized access to the database.", "Mitigation Strategies": "Executive-level mitigation strategies include prioritizing software updates and patching, and implementing robust access controls.", "Recommendations": "Recommendations for executives include prioritizing software updates and patching, and implementing robust access controls to prevent unauthorized access to the database.", "Conclusions": "In conclusion, the CVE-2009-4030 vulnerability is a critical security issue that requires immediate attention and mitigation efforts to prevent unauthorized access to the database."}}