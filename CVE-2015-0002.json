{"id": "CVE-2015-0002", "sourceIdentifier": "secure@microsoft.com", "published": "2015-01-13T22:59:01.253", "lastModified": "2018-10-12T22:07:49.053", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The AhcVerifyAdminContext function in ahcache.sys in the Application Compatibility component in Microsoft Windows 7 SP1, Windows Server 2008 R2 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold and R2, and Windows RT Gold and 8.1 does not verify that an impersonation token is associated with an administrative account, which allows local users to gain privileges by running AppCompatCache.exe with a crafted DLL file, aka MSRC ID 20544 or \"Microsoft Application Compatibility Infrastructure Elevation of Privilege Vulnerability.\""}, {"lang": "es", "value": "La funci\u00f3n AhcVerifyAdminContext en ahcache.sys en el componente Application Compatibility en Microsoft Windows 7 SP1, Windows Server 2008 R2 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold y R2, y Windows RT Gold y 8.1 no verifica que un token de suplantaci\u00f3n est\u00e1 asociado con una cuenta administrativa, lo que permite a usuarios locales ganar privilegios mediante la activaci\u00f3n de AppCompatCache.exe con un fichero DLL manipulado, tambi\u00e9n conocido como MSRC ID 20544 o 'vulnerabilidad de la elevaci\u00f3n de privilegios de la infraestructura de la compatibilidad de aplicaciones de Microsoft.'"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_7:-:sp1:*:*:*:*:*:*", "matchCriteriaId": "C2B1C231-DE19-4B8F-A4AA-5B3A65276E46"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_8:-:*:*:*:*:*:*:*", "matchCriteriaId": "0D229E41-A971-4284-9657-16D78414B93F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_8.1:-:*:*:*:*:*:*:*", "matchCriteriaId": "E93068DB-549B-45AB-8E5C-00EB5D8B5CF8"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_rt:-:gold:*:*:*:*:*:*", "matchCriteriaId": "DC5F631C-5461-4C0B-AE80-079A987912DA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_rt_8.1:-:*:*:*:*:*:*:*", "matchCriteriaId": "C6CE5198-C498-4672-AF4C-77AB4BE06C5C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:r2:sp1:*:*:*:*:*:*", "matchCriteriaId": "2ACA9287-B475-4AF7-A4DA-A7143CEF9E57"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:-:gold:*:*:*:*:*:*", "matchCriteriaId": "AB506484-7F0C-46BF-8EA6-4FB5AF454CED"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2012:r2:*:*:*:*:x64:*:*", "matchCriteriaId": "D29A1464-D228-4E0D-8FEA-06B9CBCA7F74"}]}]}], "references": [{"url": "http://secunia.com/advisories/61277", "source": "secure@microsoft.com"}, {"url": "http://twitter.com/sambowne/statuses/550384131683520512", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/bid/71972", "source": "secure@microsoft.com"}, {"url": "http://www.zdnet.com/article/google-discloses-unpatched-windows-vulnerability/", "source": "secure@microsoft.com"}, {"url": "https://code.google.com/p/google-security-research/issues/detail?id=118", "source": "secure@microsoft.com", "tags": ["Exploit"]}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2015/ms15-001", "source": "secure@microsoft.com"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/99523", "source": "secure@microsoft.com"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/99524", "source": "secure@microsoft.com"}], "techniques": [{"techniqueID": "T1454", "comment": "CVE-2015-0002 - This is a classic example of a DLL hijacking vulnerability. An attacker can execute arbitrary code by exploiting the lack of verification of impersonation tokens in the AhcVerifyAdminContext function."}, {"techniqueID": "T1199", "comment": "CVE-2015-0002 - This vulnerability can be exploited to elevate privileges and gain remote code execution. The attacker needs to craft a DLL file and trigger it with AppCompatCache.exe. This demonstrates the importance of DLL loading whitelisting and proper validation of input parameters."}, {"techniqueID": "T1105", "comment": "CVE-2015-0002 - This vulnerability can allow an attacker to gain administrative privileges, which can be used to install backdoors, execute malicious code, and steal sensitive data. Proper access control and input validation are crucial in preventing such attacks."}], "stix_bundle": {"bundle": {"type": "stix_bundle", "spec_version": "2.1", "id": "bundle-cve-2015-0002", "created_by_ref": "org.cvent.cve-mitre", "created": "2022-01-01T12:00:00Z", "modified": "2022-01-01T12:00:00Z", "name": "CVE-2015-0002 Bundle", "description": "A bundle expressing the various MITRE ATT&CK techniques, risks, and defense strategies related to CVE-2015-0002.", "objects": [{"type": "vulnerability", "id": "vuln-cve-2015-0002", "created_by_ref": "org.cvent.cve-mitre", "created": "2022-01-01T12:00:00Z", "modified": "2022-01-01T12:00:00Z", "name": "CVE-2015-0002", "description": "The AhcVerifyAdminContext function in ahcache.sys does not verify impersonation tokens, allowing local users to gain administrative privileges.", "severity": "high", "exploit_multiplier": 3.9, "attack_vector": "local", "confidentiality_impact": "complete", "integrity_impact": "complete", "availability_impact": "complete", "references": [{"id": "ref-cve-2015-0002-1", "type": "reference", "origin_info": "secure@microsoft.com", "external_id": "CVE-2015-0002", "description": "MSRC ID 20544: Microsoft Application Compatibility Infrastructure Elevation of Privilege Vulnerability"}, {"id": "ref-cve-2015-0002-2", "type": "reference", "origin_info": "secunia.com", "external_id": "CVE-2015-0002", "description": "SecurityFocus ID 71972: Microsoft Windows AhcVerifyAdminContext function elevation of privilege vulnerability"}], "related_objects": [{"type": "course_of_action", "id": "cao-cve-2015-0002-1", "related_object_ref": "vuln-cve-2015-0002", "label": "Vulnerability Mitigation", "description": "Apply the Microsoft patch to resolve the vulnerability."}]}]}}, "technical_analysis": {"Introduction": "CVE-2015-0002 is a vulnerability in the AhcVerifyAdminContext function in ahcache.sys that allows local users to gain administrative privileges.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2 with a medium-level exploit multiplier and a local attack vector. It can result in complete loss of confidentiality, integrity, and availability.", "Related MITRE ATT&CK Techniques": "T1454, T1199, T1105", "Technical Details": "The vulnerability is due to the lack of verification of impersonation tokens, allowing an attacker to execute arbitrary code.", "Detection": "Monitor for suspicious system process execution, particularly AppCompatCache.exe.", "Mitigation": "Apply the Microsoft patch, implement DLL loading whitelisting, and validate input parameters.", "Conclusion": "CVE-2015-0002 is a critical vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2015-0002 is a critical vulnerability in the AhcVerifyAdminContext function that allows local users to gain administrative privileges.", "Business Impact": "The vulnerability can result in significant business disruption, data loss, and reputational damage.", "Technical Impact": "The vulnerability can be exploited to elevate privileges, gain remote code execution, and steal sensitive data.", "Mitigation Strategies": "Apply the Microsoft patch, implement DLL loading whitelisting, and validate input parameters.", "Recommendations": "Elevate the priority of this vulnerability, apply the patch as soon as possible, and conduct thorough testing and validation.", "Conclusions": "CVE-2015-0002 is a critical vulnerability that requires immediate attention and mitigation to ensure the security and integrity of your organization's systems."}}