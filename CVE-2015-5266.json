{"id": "CVE-2015-5266", "sourceIdentifier": "secalert@redhat.com", "published": "2016-02-22T05:59:06.300", "lastModified": "2020-12-01T14:54:45.183", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The enrol_meta_sync function in enrol/meta/locallib.php in Moodle through 2.6.11, 2.7.x before 2.7.10, 2.8.x before 2.8.8, and 2.9.x before 2.9.2 allows remote authenticated users to obtain manager privileges in opportunistic circumstances by leveraging incorrect role processing during a long-running sync script."}, {"lang": "es", "value": "La funci\u00f3n enrol_meta_sync en enrol/meta/locallib.php en Moodle hasta la versi\u00f3n 2.6.11, 2.7.x en versiones anteriores a 2.7.10, 2.8.x en versiones anteriores a 2.8.8 y 2.9.x en versiones anteriores a 2.9.2 permite a usuarios remotos autenticados obtener privilegios de administrador en circunstancias oportunistas aprovechando el procesado incorrecto del rol durante una secuencia de comandos de sincronizaci\u00f3n de larga duraci\u00f3n."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 5.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.9}, "baseSeverity": "MEDIUM", "exploitabilityScore": 6.8, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.6.11", "matchCriteriaId": "9F3E36CA-026A-4262-8CB7-73E0FC315A45"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.0:*:*:*:*:*:*:*", "matchCriteriaId": "4E051AAC-EB40-491F-AF0E-EE8143C12567"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.1:*:*:*:*:*:*:*", "matchCriteriaId": "FADBE87F-1855-453B-B958-0CB8A7908A06"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.2:*:*:*:*:*:*:*", "matchCriteriaId": "1B53A7D2-BDA2-4185-97C3-977A04876A37"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.3:*:*:*:*:*:*:*", "matchCriteriaId": "A51DFFA8-DFF0-429C-B697-F82F41621FEE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.4:*:*:*:*:*:*:*", "matchCriteriaId": "19FD1565-0DA1-4BA8-A501-86F13D3D29ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.5:*:*:*:*:*:*:*", "matchCriteriaId": "6D82CFE8-C38D-4FF3-BC4F-6C27AD64D9A3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.6:*:*:*:*:*:*:*", "matchCriteriaId": "FEB754AF-3DA4-4459-A53B-3BC7B78CE313"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.7:*:*:*:*:*:*:*", "matchCriteriaId": "F57E8383-C3F3-480C-B9A9-49633DAAEC18"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.8:*:*:*:*:*:*:*", "matchCriteriaId": "645E8B7B-1AE6-4F46-AFA9-7506685CD571"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.9:*:*:*:*:*:*:*", "matchCriteriaId": "0316A26A-8B51-4226-8D56-4A798A2D798D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.0:*:*:*:*:*:*:*", "matchCriteriaId": "12737AF4-B2D5-4661-B06A-6A06FE95EC2D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.1:*:*:*:*:*:*:*", "matchCriteriaId": "88C59A94-D225-478A-B23E-41C4324BC643"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.2:*:*:*:*:*:*:*", "matchCriteriaId": "192EA69B-A1E1-4E0D-8E73-76EB74CCDE49"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.3:*:*:*:*:*:*:*", "matchCriteriaId": "D88385B1-EEFB-4825-BD8F-215C39FD86DA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.4:*:*:*:*:*:*:*", "matchCriteriaId": "A3BE2782-D167-4237-B57D-2E4C04571524"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.5:*:*:*:*:*:*:*", "matchCriteriaId": "F277F979-12FA-47A5-B0A5-D174C2127A7D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.6:*:*:*:*:*:*:*", "matchCriteriaId": "38498617-8E45-4E73-AE9F-C7A0D18FDE47"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.7:*:*:*:*:*:*:*", "matchCriteriaId": "C9047769-BFF4-42DB-8B19-F6D16FA910A1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.9.0:*:*:*:*:*:*:*", "matchCriteriaId": "C9224D94-1C48-468C-A39B-B2694ED178F4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.9.1:*:*:*:*:*:*:*", "matchCriteriaId": "1C7EE9AD-E122-4288-9416-6D8F8790D75D"}]}]}], "references": [{"url": "http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-50744", "source": "secalert@redhat.com"}, {"url": "http://www.openwall.com/lists/oss-security/2015/09/21/1", "source": "secalert@redhat.com"}, {"url": "http://www.securitytracker.com/id/1033619", "source": "secalert@redhat.com"}, {"url": "https://moodle.org/mod/forum/discuss.php?d=320290", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1036", "comment": "CVE-2015-5266 - This vulnerability allows remote authenticated users to obtain manager privileges in opportunistic circumstances by leveraging incorrect role processing during a long-running sync script. This technique is related to T1036 as it involves exploiting incorrect role processing."}, {"techniqueID": "T1027", "comment": "CVE-2015-5266 - This vulnerability allows remote authenticated users to obtain manager privileges in opportunistic circumstances by leveraging incorrect role processing during a long-running sync script. This technique is related to T1027 as it involves exploiting a vulnerability in a web application."}], "stix_bundle": {"type": "bundle", "id": "Bundle-CVE-2015-5266", "created_by_ref": "Identity-1234567890", "created": "2022-01-01T00:00:00.000Z", "modified": "2022-01-01T00:00:00.000Z", "description": "STIX Bundle for CVE-2015-5266", "objects": [{"type": "vulnerability", "id": "CVE-2015-5266", "created_by_ref": "Identity-1234567890", "created": "2022-01-01T00:00:00.000Z", "modified": "2022-01-01T00:00:00.000Z", "description": "The enrol_meta_sync function in enrol/meta/locallib.php in Moodle through 2.6.11, 2.7.x before 2.7.10, 2.8.x before 2.8.8, and 2.9.x before 2.9.2 allows remote authenticated users to obtain manager privileges in opportunistic circumstances by leveraging incorrect role processing during a long-running sync script.", "severity": "Medium", "cvssv3": {"base_score": 6.8, "exploitability_score": 1.6, "impact_score": 5.2}, "references": [{"description": "Moodle Git Search", "url": "http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-50744"}, {"description": "OpenWall Security Advisory", "url": "http://www.openwall.com/lists/oss-security/2015/09/21/1"}]}, {"type": "attack_pattern", "id": "AP-CVE-2015-5266", "created_by_ref": "Identity-1234567890", "created": "2022-01-01T00:00:00.000Z", "modified": "2022-01-01T00:00:00.000Z", "description": "Attack pattern for CVE-2015-5266", "name": "Moodle Enrol Meta Sync Vulnerability", "kill_chain_phases": [{"kill_chain_name": "mitre_attck", "kill_chain_phase_name": "Initial Access"}], "related_siblings": ["CVE-2015-5266"], " notes": [{"content": "This attack pattern is related to the CVE-2015-5266 vulnerability in Moodle Enrol Meta Sync function.", "href": "http://www.example.com/notes"}]}, {"type": "course_of_action", "id": "COA-CVE-2015-5266", "created_by_ref": "Identity-1234567890", "created": "2022-01-01T00:00:00.000Z", "modified": "2022-01-01T00:00:00.000Z", "description": "Course of Action for CVE-2015-5266", "name": "Update Moodle to Latest Version", "notes": [{"content": "Update Moodle to the latest version to fix the vulnerability.", "href": "http://www.example.com/notes"}], "related_techniques": ["T1036", "T1027"]}]}, "technical_analysis": {"Introduction": "The Moodle Enrol Meta Sync vulnerability (CVE-2015-5266) is a medium-severity vulnerability that allows remote authenticated users to obtain manager privileges in opportunistic circumstances by leveraging incorrect role processing during a long-running sync script.", "Impact and Scope": "The vulnerability affects Moodle versions 2.6.11 and below, 2.7.x before 2.7.10, 2.8.x before 2.8.8, and 2.9.x before 2.9.2.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to techniques T1036 and T1027.", "Technical Details": "The vulnerability is caused by incorrect role processing during a long-running sync script.", "Detection": "Detection of the vulnerability is difficult without extensive knowledge of the Moodle Enrol Meta Sync function and its related configurations.", "Mitigation": "Mitigation strategies include updating Moodle to the latest version, implementing access controls, and monitoring user privileges.", "Conclusion": "In conclusion, the Moodle Enrol Meta Sync vulnerability is a significant threat to organizations that use Moodle as their learning management system."}, "executive_analysis": {"Overview": "The Moodle Enrol Meta Sync vulnerability (CVE-2015-5266) is a medium-severity vulnerability that affects Moodle versions 2.6.11 and below, 2.7.x before 2.7.10, 2.8.x before 2.8.8, and 2.9.x before 2.9.2.", "Business Impact": "The vulnerability can lead to unauthorized access to sensitive data and unauthorized changes to critical systems.", "Technical Impact": "The vulnerability can be exploited by remote attackers to obtain manager privileges.", "Mitigation Strategies": "Organizations should update Moodle to the latest version and implement access controls to prevent unauthorized access.", "Recommendations": "We recommend that organizations implementing Moodle update to the latest version and conduct regular security audits to identify and remediate vulnerabilities.", "Conclusions": "The Moodle Enrol Meta Sync vulnerability is a significant risk to organizations that use Moodle as their learning management system. It is essential to address this vulnerability to prevent security breaches and maintain the integrity of critical systems."}}