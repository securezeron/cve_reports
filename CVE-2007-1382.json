{"id": "CVE-2007-1382", "sourceIdentifier": "cve@mitre.org", "published": "2007-03-10T00:19:00.000", "lastModified": "2017-10-11T01:31:50.813", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The PHP COM extensions for PHP on Windows systems allow context-dependent attackers to execute arbitrary code via a WScript.Shell COM object, as demonstrated by using the Run method of this object to execute cmd.exe, which bypasses PHP's safe mode."}, {"lang": "es", "value": "La extensi\u00f3n PHP COM para PHP en los sistemas Windows permite a atacantes dependientes del contexto ejecutar c\u00f3digo de su elecci\u00f3n mediante el objeto COM WScript.Shell, como lo demostrado usando el m\u00e9todo Run de dicho objeto para ejecutar cmd.exe, que evita el modo seguro del PHP."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.1, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:all_windows:abstract_cpe:*:*:*:*:*:*:*", "matchCriteriaId": "595E948E-30B9-4E08-B7A7-73AFD1C29FA2"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:com_extensions:*:*:*:*:*:*:*:*", "matchCriteriaId": "73BDC038-A61B-4383-A171-32DBC6328523"}]}]}], "references": [{"url": "https://www.exploit-db.com/exploits/3429", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1204: User Execution", "comment": "CVE-2007-1382 - This technique is relevant as CVE-2007-1382 allows attackers to execute arbitrary code via a WScript.Shell COM object, which is a common behavior of user execution attacks."}, {"techniqueID": "T1190: Exploit Public-Facing Application", "comment": "CVE-2007-1382 - This technique is relevant as CVE-2007-1382 is a vulnerable public-facing application, which can be exploited by attackers to execute arbitrary code."}, {"techniqueID": "T1129: Script Execution", "comment": "CVE-2007-1382 - This technique is relevant as CVE-2007-1382 involves script execution via a WScript.Shell COM object, which is a common behavior of script execution attacks."}, {"techniqueID": "T1202: Data Validation/-sanitization", "comment": "CVE-2007-1382 - This technique is relevant as CVE-2007-1382 may involve data validation/sanitization bypass, as attackers can execute arbitrary code via a WScript.Shell COM object."}], "stix_bundle": {"$schema": "https://docs.oasis-open.org/stix/stix-2.1/json/stix-core/v1.2/schema.json", "id": "https://example.com/cve-2007-1382", "type": "Bundle", "created_by_ref": "https://example.com/cve-2007-1382/author", "created": "2022-01-01T00:00:00.000Z", "handling": "https://example.com/cve-2007-1382/handling", "intelligence": {"id": "https://example.com/cve-2007-1382/intelligence", "type": "Intelligence", "pattern_of_activity": {"id": "https://example.com/cve-2007-1382/pattern-of-activity", "type": "Pattern of Activity", "indicator": {"id": "https://example.com/cve-2007-1382/indicator", "type": "Indicator", "pattern": "WScript.Shell COM object"}}}, "threat_actor": {"id": "https://example.com/cve-2007-1382/threat-actor", "type": "Threat Actor", "identity": {"id": "https://example.com/cve-2007-1382/identity", "type": "Identity", "name": "Unknown"}}, "campaign": {"id": "https://example.com/cve-2007-1382/campaign", "type": "Campaign", "description": "Unknown"}, "report": {"id": "https://example.com/cve-2007-1382/report", "type": "Report", "description": "Unknown"}, "course_of_action": {"id": "https://example.com/cve-2007-1382/course-of-action", "type": "Course of Action", "description": "Implement input validation and sanitization to prevent arbitrary code execution."}, "note": {"id": "https://example.com/cve-2007-1382/note", "type": "Note", "description": "Implement input validation and sanitization to prevent arbitrary code execution."}}, "technical_analysis": {"Introduction": "CVE-2007-1382 is a Windows-specific vulnerability in the PHP COM extension that allows attackers to execute arbitrary code via a WScript.Shell COM object.", "Impact and Scope": "The vulnerability has a CVSS score of 6.8 with a attack vector of LOCAL and a base severity of MEDIUM.", "Related MITRE ATT&CK Techniques": "T1204: User Execution, T1190: Exploit Public-Facing Application, T1129: Script Execution, T1202: Data Validation/Sanitization", "Technical Details": "The vulnerability is a result of insufficient input validation and sanitization in the PHP COM extension, which can be exploited by attackers to execute arbitrary code.", "Detection": "Detection methods include monitoring for suspicious WScript.Shell COM object activity and analyzing system logs for signs of exploitation.", "Mitigation": "Mitigation strategies include implementing input validation and sanitization, restricting the use of the PHP COM extension, and monitoring for suspicious activity.", "Conclusion": "In conclusion, CVE-2007-1382 is a significant vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2007-1382 is a Windows-specific vulnerability in the PHP COM extension that allows attackers to execute arbitrary code via a WScript.Shell COM object.", "Business Impact": "The vulnerability can lead to data compromise, system downtime, and reputational damage.", "Technical Impact": "The vulnerability can be exploited by attackers to execute arbitrary code, which can lead to data compromise and system downtime.", "Mitigation Strategies": "Implement input validation and sanitization, restrict the use of the PHP COM extension, and monitor for suspicious activity.", "Recommendations": "Executives should prioritize patching and updating systems, as well as implementing additional security measures to prevent exploitation.", "Conclusions": "In conclusion, CVE-2007-1382 is a significant vulnerability that requires immediate attention and mitigation."}}