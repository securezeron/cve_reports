{"id": "CVE-2007-1204", "sourceIdentifier": "secure@microsoft.com", "published": "2007-04-10T21:19:00.000", "lastModified": "2018-10-16T16:37:04.987", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Stack-based buffer overflow in the Universal Plug and Play (UPnP) service in Microsoft Windows XP SP2 allows remote attackers on the same subnet to execute arbitrary code via crafted HTTP headers in request or notification messages, which trigger memory corruption."}, {"lang": "es", "value": "Un desbordamiento de b\u00fafer en la regi\u00f3n stack de la memoria en el servicio Universal Plug and Play (UPnP) en Microsoft Windows XP SP2 permite a los atacantes remotos en el misma subred ejecutar c\u00f3digo arbitrario por medio de encabezados HTTP creados  en la petici\u00f3n o mensajes notificados, lo que desencadena corrupci\u00f3n de la memoria."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:H/Au:N/C:C/I:C/A:C", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "HIGH", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.2, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_xp:*:sp2:*:*:*:*:*:*", "matchCriteriaId": "9B339C33-8896-4896-88FF-88E74FDBC543"}]}]}], "references": [{"url": "http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=509", "source": "secure@microsoft.com"}, {"url": "http://secunia.com/advisories/24822", "source": "secure@microsoft.com", "tags": ["Vendor Advisory"]}, {"url": "http://www.osvdb.org/34010", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/archive/1/466331/100/200/threaded", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/bid/23371", "source": "secure@microsoft.com"}, {"url": "http://www.securitytracker.com/id?1017895", "source": "secure@microsoft.com"}, {"url": "http://www.vupen.com/english/advisories/2007/1323", "source": "secure@microsoft.com", "tags": ["Vendor Advisory"]}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2007/ms07-019", "source": "secure@microsoft.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A2049", "source": "secure@microsoft.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2007-1204 - Stack-based buffer overflow vulnerability in UPnP service, exploited through crafted HTTP headers. Defend against by implementing measures to prevent HTML injection attacks and validating user input."}, {"techniqueID": "T1055", "comment": "CVE-2007-1204 - Exploit of the vulnerability allows remote attackers to execute arbitrary code, which can be used to distribute malware or conduct other malicious activities. Defend against by implementing robust security controls and monitoring for suspicious activity."}, {"techniqueID": "T1090", "comment": "CVE-2007-1204 - The vulnerability can be exploited through the UPnP service, which is often enabled by default. Defend against by disabling unnecessary services and configuring firewalls to restrict access."}], "stix_bundle": {"@type": "bundle", "type": "bundle", "created_by_ref": "https://stix.mitre.org/XMLSchema/data_lexicon/v2.1.1", "id": "CVE-2007-1204-cyber-attack-bundle", "title": "CVE-2007-1204 Cyber Attack Bundle", "description": "A bundle expressing all the related techniques, risks and defense strategies for CVE-2007-1204", "objects": [{"@type": "vulnerability", "id": "CVE-2007-1204", "type": "vulnerability", "name": "CVE-2007-1204", "description": "Stack-based buffer overflow in the Universal Plug and Play (UPnP) service in Microsoft Windows XP SP2 allows remote attackers on the same subnet to execute arbitrary code.", "created_by_ref": "https://stix.mitre.org/XMLSchema/data_lexicon/v2.1.1", "objects": [{"@type": "note", "id": "note-1", "type": "note", "content": "Note: CVE-2007-1204 is a remote code execution vulnerability in the UPnP service.", "note_type": "technical"}], "relationships": [{"type": "actor", "id_ref": "https://stix.mitre.org/XMLSchema/data_lexicon/v2.1.1/actors/unknown"}]}, {"@type": "technique", "id": "T1190", "type": "technique", "name": "Exploit Public-Facing Application", "description": "Exploit publicly available applications or services", "created_by_ref": "https://stix.mitre.org/XMLSchema/data_lexicon/v2.1.1", "objects": [], "relationships": [{"type": "used_by_attack_pattern", "id_ref": "https://stix.mitre.org/XMLSchema/data_lexicon/v2.1.1/attack_patterns/unknown"}]}, {"@type": "attack_pattern", "id": "AP-1", "type": "attack_pattern", "name": "Buffer Overflow Exploit", "description": "Exploit buffer overflow vulnerability to inject malicious code", "created_by_ref": "https://stix.mitre.org/XMLSchema/data_lexicon/v2.1.1", "objects": [], "relationships": [{"type": "used_by_attack", "id_ref": "https://stix.mitre.org/XMLSchema/data_lexicon/v2.1.1/attacks/unknown"}]}], "links": [{"type": "bundle", "id": "this", "href": "https://stix.mitre.org/XMLSchema/data_lexicon/v2.1.1"}]}, "technical_analysis": {"Introduction": "The CVE-2007-1204 vulnerability is a stack-based buffer overflow in the Universal Plug and Play (UPnP) service in Microsoft Windows XP SP2.", "Impact and Scope": "The vulnerability allows remote attackers on the same subnet to execute arbitrary code, which can be used to distribute malware or conduct other malicious activities.", "Related MITRE ATT&CK Techniques": "T1190 - Exploit Public-Facing Application, T1055 - Execution Through Foreign-Installed Component, T1090 - Proxy", "Technical Details": "The vulnerability occurs due to a buffer overflow in the handling of HTTP requests by the UPnP service.", "Detection": "Methods for detecting the vulnerability include network traffic analysis and system logs analysis.", "Mitigation": "Mitigation strategies include disabling unnecessary services and configuring firewalls to restrict access.", "Conclusion": "In conclusion, the CVE-2007-1204 vulnerability is a serious threat and requires immediate attention from security teams."}, "executive_analysis": {"Overview": "The CVE-2007-1204 vulnerability is a remote code execution vulnerability in the UPnP service of Microsoft Windows XP SP2.", "Business Impact": "The vulnerability can lead to unauthorized access to sensitive data, financial loss, and reputational damage.", "Technical Impact": "The vulnerability affects the confidentiality, integrity, and availability of data stored on affected systems.", "Mitigation Strategies": "Implementing robust security controls, disabling unnecessary services, and configuring firewalls to restrict access are key mitigation strategies.", "Recommendations": "We recommend that security teams take immediate action to assess and remediate affected systems.", "Conclusions": "In conclusion, the CVE-2007-1204 vulnerability is a significant threat and requires immediate attention from security teams to prevent exploitation."}}