{"id": "CVE-2009-4004", "sourceIdentifier": "cve@mitre.org", "published": "2009-11-20T02:30:00.670", "lastModified": "2023-11-07T02:04:40.830", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Buffer overflow in the kvm_vcpu_ioctl_x86_setup_mce function in arch/x86/kvm/x86.c in the KVM subsystem in the Linux kernel before 2.6.32-rc7 allows local users to cause a denial of service (memory corruption) or possibly gain privileges via a KVM_X86_SETUP_MCE IOCTL request that specifies a large number of Machine Check Exception (MCE) banks."}, {"lang": "es", "value": "Desbordamiento de b\u00fafer en la funci\u00f3n kvm_vcpu_ioctl_x86_setup_mce en arch/x86/kvm/x86.c en el subsistema KVM en el kernel de Linux anteriores a v2.6.32-rc7 permite a los usuarios locales causar una denegaci\u00f3n de servicio (corrupci\u00f3n de memoria) o posiblemente obtener privilegios a trav\u00e9s de una petici\u00f3n KVM_X86_SETUP_MCE IOCTL que especifica un elevado n\u00famero de bancos de Machine Check Exception (MCE)."}], "vendorComments": [{"organization": "Red Hat", "comment": "Not vulnerable. This issue did not affect the versions of Linux kernel as shipped with Red Hat Enterprise Linux 3, 4, and Red Hat Enterprise MRG as KVM (Kernel-based Virtual Machine) is only supported in Red Hat Enterprise Linux 5.\n\nRed Hat Enterprise Linux 5 is not vulnerable to this issue because it does not include the change that introduced this buffer overflow vulnerability.", "lastModified": "2009-11-20T00:00:00"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.6.31.14", "matchCriteriaId": "BEC4349F-7F67-435F-8909-94648A0E8F90"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.32:-:*:*:*:*:*:*", "matchCriteriaId": "37B2E2B1-3E39-4DBA-817D-08F34D9F6E53"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.32:rc1:*:*:*:*:*:*", "matchCriteriaId": "C85D4E0A-14DA-4884-AF6F-A0F54304430F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.32:rc2:*:*:*:*:*:*", "matchCriteriaId": "1C8471AA-44D7-4D19-82B6-C4B999C65F97"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.32:rc3:*:*:*:*:*:*", "matchCriteriaId": "218DE1D1-3843-4076-9AE4-70AA0FD99B3E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.32:rc4:*:*:*:*:*:*", "matchCriteriaId": "2677114B-AF05-42EB-BBC8-FA85CD631C21"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.32:rc5:*:*:*:*:*:*", "matchCriteriaId": "FA8D64E1-A700-4D9E-9063-EC3CFC1A6D98"}, {"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.32:rc6:*:*:*:*:*:*", "matchCriteriaId": "1B6C0A59-556F-4579-9AD2-4ABAE01FE2CF"}]}]}], "references": [{"url": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=a9e38c3e01ad242fe2a625354cf065c34b01e3aa", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/37357", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://www.kernel.org/pub/linux/kernel/v2.6/testing/ChangeLog-2.6.32-rc7", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.securityfocus.com/bid/37035", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.vupen.com/english/advisories/2009/3267", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/54302", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2009-4004 - This vulnerability can be exploited by an attacker to cause a denial of service or gain privileges. It can be mitigated by applying the patch or using a workaround, which can prevent the exploitation of this vulnerability."}, {"techniqueID": "T1191", "comment": "CVE-2009-4004 - This vulnerability can be used to cause a denial of service or gain privileges. It can be mitigated by applying the patch or using a workaround, which can prevent the exploitation of this vulnerability."}, {"techniqueID": "T1192", "comment": "CVE-2009-4004 - This vulnerability can be used to cause a denial of service or gain privileges. It can be mitigated by applying the patch or using a workaround, which can prevent the exploitation of this vulnerability."}], "stix_bundle": {"objects": [{"_type": "indicator", "id": "mitre_cve-2009-4004", "created_by_ref": "https://maec.mitre.org/XMLSchema/maec-core-4.1#MAEC-4.1", "modified": "2023-11-07T02:04:40.830", "name": "CVE-2009-4004 - Buffer overflow in kvm_vcpu_ioctl_x86_setup_mce function", "description": "Buffer overflow in kvm_vcpu_ioctl_x86_setup_mce function in arch/x86/kvm/x86.c in the KVM subsystem in the Linux kernel before 2.6.32-rc7 allows local users to cause a denial of service (memory corruption) or possibly gain privileges via a KVM_X86_SETUP_MCE IOCTL request that specifies a large number of Machine Check Exception (MCE) banks.", "objects": [{"_type": "identity", "id": "kvm_kernel", "name": "Linux kernel", "description": "Linux kernel version before 2.6.32-rc7"}, {"_type": "identity", "id": "local_attacker", "name": "Local attacker", "description": "An attacker with local access to the system"}]}]}, "technical_analysis": {"Introduction": "CVE-2009-4004 is a remote buffer overflow vulnerability in the Linux kernel. It is caused by a buffer overflow in the kvm_vcpu_ioctl_x86_setup_mce function in the KVM subsystem.", "Impact and Scope": "CVE-2009-4004 is a remote buffer overflow vulnerability in the Linux kernel. It is caused by a buffer overflow in the kvm_vcpu_ioctl_x86_setup_mce function in the KVM subsystem. The vulnerability can be exploited by an attacker with local access to the system to cause a denial of service (memory corruption) or possibly gain privileges.", "Related MITRE ATT&CK Techniques": "T1190, T1191, T1192", "Technical Details": "The buffer overflow vulnerability in the kvm_vcpu_ioctl_x86_setup_mce function in the KVM subsystem in the Linux kernel before 2.6.32-rc7 allows local users to cause a denial of service (memory corruption) or possibly gain privileges via a KVM_X86_SETUP_MCE IOCTL request that specifies a large number of Machine Check Exception (MCE) banks.", "Detection": "Detection of this vulnerability can be done by analyzing the system logs for suspicious activity, such as unusual system calls or network traffic.", "Mitigation": "Mitigation of this vulnerability can be done by applying the patch or using a workaround, which can prevent the exploitation of this vulnerability.", "Conclusion": "CVE-2009-4004 is a remote buffer overflow vulnerability in the Linux kernel. It is caused by a buffer overflow in the kvm_vcpu_ioctl_x86_setup_mce function in the KVM subsystem. The vulnerability can be exploited by an attacker with local access to the system to cause a denial of service (memory corruption) or possibly gain privileges."}, "executive_analysis": {"Overview": "CVE-2009-4004 is a remote buffer overflow vulnerability in the Linux kernel. It affects Linux kernels before 2.6.32-rc7 and can be exploited by an attacker with local access to the system to cause a denial of service (memory corruption) or possibly gain privileges.", "Business Impact": "The impact of this vulnerability is that it can cause a denial of service (memory corruption) or possibly gain privileges, which can lead to unauthorized access to sensitive data or systems.", "Technical Impact": "The technical impact of this vulnerability is that it can cause a denial of service (memory corruption) or possibly gain privileges, which can lead to unauthorized access to sensitive data or systems.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include applying the patch or using a workaround, which can prevent the exploitation of this vulnerability.", "Recommendations": "Recommendations for executives include applying the patch or using a workaround, which can prevent the exploitation of this vulnerability. Additionally, implementing robust security controls and monitoring can help detect and prevent exploitation of this vulnerability.", "Conclusions": "In conclusion, CVE-2009-4004 is a remote buffer overflow vulnerability in the Linux kernel that can be exploited by an attacker with local access to the system to cause a denial of service (memory corruption) or possibly gain privileges. Applying the patch or using a workaround can mitigate this vulnerability, and implementing robust security controls and monitoring can help detect and prevent exploitation."}}