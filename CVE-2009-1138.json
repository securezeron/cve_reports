{"id": "CVE-2009-1138", "sourceIdentifier": "secure@microsoft.com", "published": "2009-06-10T18:00:00.377", "lastModified": "2019-04-30T14:27:13.913", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The LDAP service in Active Directory on Microsoft Windows 2000 SP4 does not properly free memory for LDAP and LDAPS requests, which allows remote attackers to execute arbitrary code via a request that uses hexadecimal encoding, whose associated memory is not released, related to a \"DN AttributeValue,\" aka \"Active Directory Invalid Free Vulnerability.\"  NOTE: this issue is probably a memory leak."}, {"lang": "es", "value": "El servicio LDAP en Active Directory en Microsoft Windows 2000 SP4 no habilita correctamente la memoria para las solicitudes LDAP y LDAPS, lo que permite a los atacantes remotos ejecutar c\u00f3digo arbitrario a trav\u00e9s de una solicitud que utiliza codificaci\u00f3n hexadecimal, cuya memoria asociada no es liberada, relacionado con un \"DN AttributeValue,\" o \"vulnerabilidad libre inv\u00e1lida de Active Directory.\" Nota: este problema es probablemente una fuga de memoria."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-399"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_2000:*:sp4:*:*:*:*:*:*", "matchCriteriaId": "83E7C4A0-78CF-4B56-82BF-EC932BDD8ADF"}]}]}], "references": [{"url": "http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=804", "source": "secure@microsoft.com"}, {"url": "http://osvdb.org/54937", "source": "secure@microsoft.com"}, {"url": "http://secunia.com/advisories/35355", "source": "secure@microsoft.com", "tags": ["Vendor Advisory"]}, {"url": "http://support.avaya.com/elmodocs2/security/ASA-2009-214.htm", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/bid/35226", "source": "secure@microsoft.com", "tags": ["Patch"]}, {"url": "http://www.securitytracker.com/id?1022349", "source": "secure@microsoft.com"}, {"url": "http://www.us-cert.gov/cas/techalerts/TA09-160A.html", "source": "secure@microsoft.com", "tags": ["US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2009/1537", "source": "secure@microsoft.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-018", "source": "secure@microsoft.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6180", "source": "secure@microsoft.com"}], "techniques": [{"techniqueID": "T1168", "comment": "CVE-2009-1138 - This technique is related to the vulnerability due to the exploitation of a memory leak. It allows remote attackers to execute arbitrary code via a request that uses hexadecimal encoding, whose associated memory is not released."}, {"techniqueID": "T1190", "comment": "CVE-2009-1138 - This technique is related to the vulnerability due to the use of a malicious request to exploit the memory leak."}, {"techniqueID": "T1199", "comment": "CVE-2009-1138 - This technique is related to the vulnerability due to the exploitation of a memory leak to execute arbitrary code."}], "stix_bundle": {"type": "stix_bundle", "spec_version": "2.1", "id": "cve-2009-1138-stix-bundle", "title": "Vulnerability Bundle for CVE-2009-1138", "created_by_refs": [{"id_ref": "https://nvd.nist.gov/vuln/detail/CVE-2009-1138", "relationship": "CITED_BY"}], "objects": [{"id": "vulnerability: CVE-2009-1138", "type": "vulnerability", "spec_version": "2.1", "created": "2019-04-30T14:27:13.913", "modified": "2019-04-30T14:27:13.913", "name": "CVE-2009-1138: Windows 2000 Active Directory LDAP Service Memory Leak", "description": "The LDAP service in Active Directory on Microsoft Windows 2000 SP4 does not properly free memory for LDAP and LDAPS requests, which allows remote attackers to execute arbitrary code via a request that uses hexadecimal encoding, whose associated memory is not released.", "severity": "High", "exploit_maturity": "Proven", "vulnerable_software": [{"software": "Microsoft Windows 2000 SP4"}], "related_identity_malware_activity": [{"id_ref": "T1168: Reflective File Download", "relationship": "USES"}, {"id_ref": "T1190: Exploit Public-Facing Application", "relationship": "USES"}, {"id_ref": "T1199: Imp-Reflective-File-Download", "relationship": "USES"}]}], "relationships": [{"id": "vulnerability-CVE-2009-1138-relates-to", "type": "relates_to", "spec_version": "2.1", "created": "2019-04-30T14:27:13.913", "modified": "2019-04-30T14:27:13.913", "from": "vulnerability: CVE-2009-1138", "to": "technique: T1168"}, {"id": "vulnerability-CVE-2009-1138-relates-to", "type": "relates_to", "spec_version": "2.1", "created": "2019-04-30T14:27:13.913", "modified": "2019-04-30T14:27:13.913", "from": "vulnerability: CVE-2009-1138", "to": "technique: T1190"}, {"id": "vulnerability-CVE-2009-1138-relates-to", "type": "relates_to", "spec_version": "2.1", "created": "2019-04-30T14:27:13.913", "modified": "2019-04-30T14:27:13.913", "from": "vulnerability: CVE-2009-1138", "to": "technique: T1199"}]}, "technical_analysis": {"Introduction": "The vulnerability CVE-2009-1138 is a memory leak in the LDAP service of Microsoft Windows 2000 SP4. This vulnerability allows remote attackers to execute arbitrary code via a request that uses hexadecimal encoding, whose associated memory is not released.", "Impact and Scope": "The vulnerability has a CVSS score of 10.0 and an attack vector of NETWORK. This means that it is a high-severity vulnerability that can be exploited remotely.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1168, T1190, and T1199.", "Technical Details": "The vulnerability is caused by a memory leak in the LDAP service, which allows remote attackers to execute arbitrary code via a request that uses hexadecimal encoding, whose associated memory is not released.", "Detection": "The vulnerability can be detected by monitoring for suspicious LDAP traffic and by configuring vulnerability scanners to detect this vulnerability.", "Mitigation": "The vulnerability can be mitigated by patching the affected system and by configuring the LDAP service to reject requests using hexadecimal encoding.", "Conclusion": "In conclusion, the vulnerability CVE-2009-1138 is a high-severity vulnerability that can be exploited remotely. It is related to the following MITRE ATT&CK techniques: T1168, T1190, and T1199. It can be detected by monitoring for suspicious LDAP traffic and by configuring vulnerability scanners to detect this vulnerability. It can be mitigated by patching the affected system and by configuring the LDAP service to reject requests using hexadecimal encoding."}, "executive_analysis": {"Overview": "The vulnerability CVE-2009-1138 is a high-severity vulnerability that can be exploited remotely. It is related to the following MITRE ATT&CK techniques: T1168, T1190, and T1199.", "Business Impact": "The vulnerability can allow remote attackers to execute arbitrary code, which can lead to unauthorized access to sensitive data and systems. This can result in significant financial losses and reputational damage.", "Technical Impact": "The vulnerability is caused by a memory leak in the LDAP service, which allows remote attackers to execute arbitrary code via a request that uses hexadecimal encoding, whose associated memory is not released.", "Mitigation Strategies": "The vulnerability can be mitigated by patching the affected system and by configuring the LDAP service to reject requests using hexadecimal encoding.", "Recommendations": "We recommend that you patch your systems as soon as possible to address this vulnerability. Additionally, we recommend configuring your LDAP service to reject requests using hexadecimal encoding to prevent exploitation.", "Conclusions": "In conclusion, the vulnerability CVE-2009-1138 is a high-severity vulnerability that can be exploited remotely. It is related to the following MITRE ATT&CK techniques: T1168, T1190, and T1199. We recommend that you take immediate action to patch your systems and configure your LDAP service to reject requests using hexadecimal encoding."}}