{"id": "CVE-2009-2067", "sourceIdentifier": "cve@mitre.org", "published": "2009-06-15T19:30:05.657", "lastModified": "2018-10-30T16:26:33.437", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Opera detects http content in https web pages only when the top-level frame uses https, which allows man-in-the-middle attackers to execute arbitrary web script, in an https site's context, by modifying an http page to include an https iframe that references a script file on an http site, related to \"HTTP-Intended-but-HTTPS-Loadable (HPIHSL) pages.\""}, {"lang": "es", "value": "Opera detecta contenido http en una p\u00e1gina https, s\u00f3lo cuando el marco de alto nivel utiliza https, lo que permite a los atacantes \"hombre en el medio\" ejecutar arbitrariamente una secuencia de comandos web, en un contexto de p\u00e1gina https, modificando una p\u00e1gina http incluya un iframe https referenciando a un archivo de secuencia de comandos en una p\u00e1gina http, en relaci\u00f3n a p\u00e1ginas \"HTTP-Intended-but-HTTPS-Loadable (HPIHSL)\"."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-287"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:*:*:*:*:*:*:*:*", "versionEndIncluding": "9.22", "matchCriteriaId": "11F806C7-C64E-4EE7-96B1-E625CE121A88"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "D7C35850-B79C-4EE4-A6F2-CC5D2304724B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:7.23:*:*:*:*:*:*:*", "matchCriteriaId": "A8F6644C-97E6-4023-9C5C-5C1E1B0B55D7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:7.53:*:*:*:*:*:*:*", "matchCriteriaId": "D7965089-8592-47F2-958B-7DBE669BCAC9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:7.54:*:*:*:*:*:*:*", "matchCriteriaId": "E1750B2D-7AC8-45CF-9879-1D0476EEE86C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:7.60:*:*:*:*:*:*:*", "matchCriteriaId": "ECEE4473-88C0-4E28-A5B5-F7383B0E5558"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "76410AD4-78CA-48EA-83F0-099D0A49626F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:8.01:*:*:*:*:*:*:*", "matchCriteriaId": "9DF2B21F-7E97-416B-AF5C-35338A254552"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:8.02:*:*:*:*:*:*:*", "matchCriteriaId": "DBAC41D6-73D4-44E9-87E4-E1E955B9580A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:8.50:*:*:*:*:*:*:*", "matchCriteriaId": "52FCCB1C-165C-49FF-B70B-475B37BDF02A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:8.51:*:*:*:*:*:*:*", "matchCriteriaId": "4FA5A5E5-3703-44AC-9963-A20A55002B48"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:8.52:*:*:*:*:*:*:*", "matchCriteriaId": "DC3E5BEF-3F29-4929-A37C-C49322B19047"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:8.53:*:*:*:*:*:*:*", "matchCriteriaId": "7B0E7B5D-2568-4128-8F99-E74D24A7E991"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:8.54:*:*:*:*:*:*:*", "matchCriteriaId": "E6A04906-7267-4A09-87BF-D639C7CF315B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "BEA17D3F-A17B-47A6-8066-583F63D11468"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:9.01:*:*:*:*:*:*:*", "matchCriteriaId": "ED63C1B5-F52D-4C70-82D3-B427EAF5CF4F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:9.02:*:*:*:*:*:*:*", "matchCriteriaId": "98E48C83-01AE-4A33-A004-14B99792674C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:9.10:*:*:*:*:*:*:*", "matchCriteriaId": "B56A2B78-70BD-439B-B1ED-A17FA5EF0990"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:9.12:*:*:*:*:*:*:*", "matchCriteriaId": "623E4466-82CC-4BDD-BE25-3BB33B585547"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:9.20:*:*:*:*:*:*:*", "matchCriteriaId": "8F90E537-5A0F-4302-9CC3-8EE7EB21DD1D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:opera:opera_browser:9.21:*:*:*:*:*:*:*", "matchCriteriaId": "F5ECA190-D7D3-4248-A61E-0D87E67E3D31"}]}]}], "references": [{"url": "http://research.microsoft.com/apps/pubs/default.aspx?id=79323", "source": "cve@mitre.org"}, {"url": "http://research.microsoft.com/pubs/79323/pbp-final-with-update.pdf", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/35403", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA1568", "comment": "CVE-2009-2067 - This is an example of an HTTP injection vulnerability, where an attacker can inject arbitrary HTTP requests into an HTTPS site's context, potentially allowing them to execute arbitrary web scripts. This can be mitigated by validating and sanitizing user-input data."}, {"techniqueID": "TA1530", "comment": "CVE-2009-2067 - This vulnerability can be exploited by a man-in-the-middle attacker to inject arbitrary scripts into an HTTPS site, which can lead to code execution. This can be mitigated by implementing SSL/TLS validation and certificate pinning."}], "stix_bundle": {"type": "bundle", "id": "bundle-1", "spec_version": "2.1", "objects": [{"type": "vulnerability", "id": "vulnerability-1", "name": "Opera HTTP-Intended-but-HTTPS-Loadable (HPIHSL) pages vulnerability", "description": "This vulnerability allows an attacker to inject arbitrary HTTP requests into an HTTPS site's context, potentially allowing them to execute arbitrary web scripts."}, {"type": "attack-pattern", "id": "attack-pattern-1", "name": "HTTP Injection", "description": "This attack pattern involves injecting arbitrary HTTP requests into an HTTPS site's context."}, {"type": "intrusion-set", "id": "intrusion-set-1", "name": "APT34", "description": "This intrusion set is known for using various techniques to exploit vulnerabilities, including HTTP injection."}, {"type": "course-of-action", "id": "course-of-action-1", "name": "Implement SSL/TLS validation and certificate pinning", "description": "This course of action involves implementing SSL/TLS validation and certificate pinning to prevent man-in-the-middle attacks."}, {"type": "note", "id": "note-1", "name": "Defense against HTTP injection", "description": "To defend against HTTP injection, ensure that input validation and sanitization are implemented, and that SSL/TLS validation and certificate pinning are used."}], "relationships": [{"relationship": "related_to", "from": "vulnerability-1", "to": "attack-pattern-1"}, {"relationship": "exploited_by", "from": "attack-pattern-1", "to": "intrusion-set-1"}, {"relationship": "mitigated_by", "from": "vulnerability-1", "to": "course-of-action-1"}, {"relationship": "defended_against", "from": "course-of-action-1", "to": "note-1"}]}, "technical_analysis": {"Introduction": "This vulnerability allows an attacker to inject arbitrary HTTP requests into an HTTPS site's context, potentially allowing them to execute arbitrary web scripts.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to execute arbitrary web scripts in an HTTPS site's context. The scope of this vulnerability is limited to Opera web browsers.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are TA1568 and TA1530.", "Technical Details": "The vulnerability is due to the way Opera detects HTTP content in HTTPS web pages, allowing an attacker to inject arbitrary HTTP requests.", "Detection": "This vulnerability can be detected by monitoring for suspicious HTTP requests being injected into an HTTPS site.", "Mitigation": "The vulnerability can be mitigated by implementing SSL/TLS validation and certificate pinning, and by validating and sanitizing user-input data.", "Conclusion": "This vulnerability is a serious security risk and should be addressed promptly."}, "executive_analysis": {"Overview": "This vulnerability allows an attacker to inject arbitrary HTTP requests into an HTTPS site's context, potentially allowing them to execute arbitrary web scripts.", "Business Impact": "The business impact of this vulnerability is high, as it can allow an attacker to execute arbitrary web scripts in an HTTPS site's context, potentially compromising sensitive data.", "Technical Impact": "The technical impact of this vulnerability is the potential for an attacker to execute arbitrary web scripts in an HTTPS site's context.", "Mitigation Strategies": "The mitigation strategies for this vulnerability are to implement SSL/TLS validation and certificate pinning, and to validate and sanitize user-input data.", "Recommendations": "It is recommended to patch all affected systems, implement SSL/TLS validation and certificate pinning, and validate and sanitize user-input data.", "Conclusions": "This vulnerability is a serious security risk and should be addressed promptly. Implementing the recommended mitigation strategies will help to protect against this vulnerability."}}