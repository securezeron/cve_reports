{"id": "CVE-2009-3286", "sourceIdentifier": "cve@mitre.org", "published": "2009-09-22T10:30:00.627", "lastModified": "2023-11-07T02:04:24.557", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "NFSv4 in the Linux kernel 2.6.18, and possibly other versions, does not properly clean up an inode when an O_EXCL create fails, which causes files to be created with insecure settings such as setuid bits, and possibly allows local users to gain privileges, related to the execution of the do_open_permission function even when a create fails."}, {"lang": "es", "value": "NFSv4 en el kernel de Linux versi\u00f3n 2.6.18, y posiblemente otras versiones, no limpia apropiadamente un inode cuando se produce un fallo de creaci\u00f3n de O_EXCL, lo que causa que los archivos se creen con configuraciones no confiables, tales como bits setuid, y posiblemente permite a los usuarios locales alcanzar privilegios, relacionados con la ejecuci\u00f3n de la funci\u00f3n do_open_permission incluso cuando se produce un fallo en una creaci\u00f3n."}], "vendorComments": [{"organization": "Red Hat", "comment": "This issue did not affect the versions of Linux kernel as shipped with Red Hat Enterprise Linux 3, 4, and Red Hat Enterprise MRG.\n\nIt was addressed in Red Hat Enterprise Linux 5 via: https://rhn.redhat.com/errata/RHSA-2009-1548.html", "lastModified": "2009-11-04T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.6}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.9, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:2.6.18:*:*:*:*:*:*:*", "matchCriteriaId": "C06F0037-DE20-4B4A-977F-BFCFAB026517"}]}]}], "references": [{"url": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commitdiff%3Bh=81ac95c5", "source": "cve@mitre.org"}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2010-02/msg00005.html", "source": "cve@mitre.org"}, {"url": "http://lists.vmware.com/pipermail/security-announce/2010/000082.html", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/37105", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/38794", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/38834", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2009/09/21/2", "source": "cve@mitre.org"}, {"url": "http://www.ubuntu.com/usn/USN-852-1", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2010/0528", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=524520", "source": "cve@mitre.org"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A7527", "source": "cve@mitre.org"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A9757", "source": "cve@mitre.org"}, {"url": "https://rhn.redhat.com/errata/RHSA-2009-1548.html", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0011:Exploit Public-Facing Application", "comment": "CVE-2009-3286 - A remote attacker can exploit this vulnerability by sending a malicious request to a vulnerable NFSv4 server, leading to the creation of a file with insecure settings, allowing local users to gain privileges."}, {"techniqueID": "TA0018:New Account", "comment": "CVE-2009-3286 - An attacker can use this vulnerability to create a new account with elevated privileges, allowing them to continue executing malicious activities."}, {"techniqueID": "TA0023:Pre-Authentication", "comment": "CVE-2009-3286 - This vulnerability can be exploited before authentication, allowing an attacker to create a new account or gain access to sensitive information without requiring authentication."}], "stix_bundle": {"id": "CVE-2009-3286 Bundle", "type": "bundle", "spec_version": "2.1", "foreign_attributes": {"cve_id": "CVE-2009-3286"}, "objects": [{"id": "CVE-2009-3286-Vulnerability", "type": "vulnerability", "title": "NFSv4 Insecure File Creation Vulnerability", "description": "A vulnerability in the Linux kernel's NFSv4 implementation allows an attacker to create a file with insecure settings, leading to local privilege escalation.", "cve": {"id": "CVE-2009-3286", "references": [{"href": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commitdiff%3Bh=81ac95c5"}]}}, {"id": "Exploit-Public-Facing-Application-TTP", "type": "indicator", "title": "Exploit Public-Facing Application", "description": "An indicator of exploitation of the NFSv4 insecure file creation vulnerability.", "tiv": {"score": 1.0}}, {"id": "New-Account-TTP", "type": "indicator", "title": "New Account", "description": "An indicator of an attacker creating a new account with elevated privileges.", "tiv": {"score": 1.0}}, {"id": "Pre-Authentication-TTP", "type": "indicator", "title": "Pre-Authentication", "description": "An indicator of an attacker exploiting the NFSv4 insecure file creation vulnerability before authentication.", "tiv": {"score": 1.0}}], "relationships": [{"id": "CVE-2009-3286-Vulnerability_to_Exploit-Public-Facing-Application-TTP", "type": "related", "strength": "low", "relationship_type": "exploits", "object_id": "Exploit-Public-Facing-Application-TTP", "parent_id": "CVE-2009-3286-Vulnerability"}, {"id": "CVE-2009-3286-Vulnerability_to_New-Account-TTP", "type": "related", "strength": "medium", "relationship_type": "exploits", "object_id": "New-Account-TTP", "parent_id": "CVE-2009-3286-Vulnerability"}, {"id": "CVE-2009-3286-Vulnerability_to_Pre-Authentication-TTP", "type": "related", "strength": "low", "relationship_type": "exploits", "object_id": "Pre-Authentication-TTP", "parent_id": "CVE-2009-3286-Vulnerability"}]}, "technical_analysis": {"Introduction": "The NFSv4 insecure file creation vulnerability, CVE-2009-3286, is a remote code execution vulnerability in the Linux kernel's NFSv4 implementation.", "Impact and Scope": "This vulnerability allows an attacker to create a file with insecure settings, leading to local privilege escalation.", "Related MITRE ATT&CK Techniques": "TA0011:Exploit Public-Facing Application, TA0018:New Account, and TA0023:Pre-Authentication", "Technical Details": "The vulnerability is caused by a race condition in the NFSv4 implementation, allowing an attacker to create a file with insecure settings.", "Detection": "Detection of this vulnerability can be facilitated by monitoring for suspicious file creation requests or anomalous system behavior.", "Mitigation": "Mitigation strategies include patching the Linux kernel, disabling NFSv4, or implementing additional security controls such as access controls and auditing.", "Conclusion": "The NFSv4 insecure file creation vulnerability, CVE-2009-3286, is a critical remote code execution vulnerability that requires prompt attention and remediation."}, "executive_analysis": {"Overview": "The NFSv4 insecure file creation vulnerability, CVE-2009-3286, is a critical vulnerability that allows remote code execution and privilege escalation.", "Business Impact": "This vulnerability can result in unauthorized access to sensitive data and systems, potentially causing significant financial and reputational damage.", "Technical Impact": "The vulnerability can be exploited by sending a malicious request to a vulnerable NFSv4 server, allowing an attacker to create a file with insecure settings.", "Mitigation Strategies": "Patching the Linux kernel, disabling NFSv4, or implementing additional security controls such as access controls and auditing are recommended mitigation strategies.", "Recommendations": "Redouble efforts to patch the Linux kernel and disable NFSv4 in all vulnerable systems.", "Conclusions": "The NFSv4 insecure file creation vulnerability, CVE-2009-3286, is a critical vulnerability that requires immediate attention and remediation."}}