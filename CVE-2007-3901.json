{"id": "CVE-2007-3901", "sourceIdentifier": "secure@microsoft.com", "published": "2007-12-12T00:46:00.000", "lastModified": "2019-04-30T14:27:13.710", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Stack-based buffer overflow in the DirectShow Synchronized Accessible Media Interchange (SAMI) parser in quartz.dll for Microsoft DirectX 7.0 through 10.0 allows remote attackers to execute arbitrary code via a crafted SAMI file."}, {"lang": "es", "value": "El desbordamiento de b\u00fafer en la regi\u00f3n stack de la memoria en el analizador de intercambio de medios accesibles (SAMI) de DirectShow sincronizado en Quartz. dll para Microsoft DirectX versi\u00f3n 7.0 a la versi\u00f3n 10.0, permite a los atacantes remotos ejecutar c\u00f3digo arbitrario a trav\u00e9s de un archivo SAMI elaborado."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 8.5}, "baseSeverity": "HIGH", "exploitabilityScore": 6.8, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_2000:*:*:*:*:*:*:*:*", "matchCriteriaId": "4E545C63-FE9C-4CA1-AF0F-D999D84D2AFD"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_2003_server:datacenter_edition:*:*:*:*:*:*:*", "matchCriteriaId": "480D8321-EB2F-4626-A16B-F3C2B771EDB3"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_2003_server:enterprise_edition:*:*:*:*:*:*:*", "matchCriteriaId": "0095FE21-F45F-4D50-A22B-6AEF5ED4D691"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_2003_server:standard:*:*:*:*:*:*:*", "matchCriteriaId": "709E6DA0-09F8-4EAB-B1B2-D4D0A7771AC1"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_2003_server:web_edition:*:*:*:*:*:*:*", "matchCriteriaId": "E296F83E-39E1-4DA0-A410-DDD17BDB3939"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_vista:*:*:*:*:*:*:*:*", "matchCriteriaId": "3852BB02-47A1-40B3-8E32-8D8891A53114"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_xp:*:*:home:*:*:*:*:*", "matchCriteriaId": "BC176BB0-1655-4BEA-A841-C4158167CC9B"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_xp:*:*:professional:*:*:*:*:*", "matchCriteriaId": "CC5A2998-AFD9-4AD3-BC47-E653345323AB"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:5.2:*:*:*:*:*:*:*", "matchCriteriaId": "194DA1C4-F08C-4219-87DC-BC6B389372EB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:6.1:*:*:*:*:*:*:*", "matchCriteriaId": "D4A0B238-DEC5-4DFC-AB8D-2F78E03B0589"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "2BFE77B9-6C2A-45D3-A4B5-2679CC4B0DA2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:7.0a:*:*:*:*:*:*:*", "matchCriteriaId": "459D411C-4994-41DB-9594-F460EADA3351"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:7.1:*:*:*:*:*:*:*", "matchCriteriaId": "4F01F75D-4C20-4DA2-BD3B-4A3BD466F773"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "0D1C38DA-F7C2-4291-8384-E822BAE7F25D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:8.0a:*:*:*:*:*:*:*", "matchCriteriaId": "CB69C888-AAE7-4472-B2D3-76CEFFF48D7E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:8.1:*:*:*:*:*:*:*", "matchCriteriaId": "8FF0278F-AFA7-48BA-8762-5569EC174AEE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:8.1a:*:*:*:*:*:*:*", "matchCriteriaId": "CD4C6E3F-58B3-4871-AC3A-DC54F9031C1A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:8.1b:*:*:*:*:*:*:*", "matchCriteriaId": "1BBFBDA6-90F5-4A8A-BD47-2DCA5CA8D5AA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:8.2:*:*:*:*:*:*:*", "matchCriteriaId": "A84968C5-EFBE-4BC6-8A3B-0110A65EC97E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:9.0a:*:*:*:*:*:*:*", "matchCriteriaId": "B2F096A3-DD19-4D54-94F4-027DBDF1A705"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:9.0b:*:*:*:*:*:*:*", "matchCriteriaId": "70A8E96E-F752-43D2-83C3-877DE1042B80"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:9.0c:*:*:*:*:*:*:*", "matchCriteriaId": "44C68B75-2B7A-450B-BA1B-03E77E03B59B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:directx:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "5A53A6AC-74B0-4DB3-B94D-06FB969AE83C"}]}]}], "references": [{"url": "http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=632", "source": "secure@microsoft.com"}, {"url": "http://secunia.com/advisories/28010", "source": "secure@microsoft.com", "tags": ["Vendor Advisory"]}, {"url": "http://www.iss.net/threats/280.html", "source": "secure@microsoft.com"}, {"url": "http://www.kb.cert.org/vuls/id/804089", "source": "secure@microsoft.com", "tags": ["US Government Resource"]}, {"url": "http://www.securityfocus.com/archive/1/485268/100/0/threaded", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/bid/26789", "source": "secure@microsoft.com"}, {"url": "http://www.securitytracker.com/id?1019073", "source": "secure@microsoft.com"}, {"url": "http://www.us-cert.gov/cas/techalerts/TA07-345A.html", "source": "secure@microsoft.com", "tags": ["US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2007/4180", "source": "secure@microsoft.com", "tags": ["Vendor Advisory"]}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2007/ms07-064", "source": "secure@microsoft.com"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/38721", "source": "secure@microsoft.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A4520", "source": "secure@microsoft.com"}, {"url": "https://www.exploit-db.com/exploits/4866", "source": "secure@microsoft.com"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2007-3901 - Execution of arbitrary code can be achieved by crafting a specific SAMI file, attackers can take advantage of this vulnerability to inject malicious code into the system, making it highly exploitable."}, {"techniqueID": "T1027", "comment": "This vulnerability allows attackers to execute code on the system, T1027 is relevant as it is a potential vector for malware to infect the victim's machine, this technique involves creating a connection to the system to exploit the vulnerability."}, {"techniqueID": "T1055", "comment": "The vulnerability allows for remote code execution, T1055 is relevant as it involves injecting code into a process. This technique can be used to establish persistence, manipulate data, or execute malicious code on the system."}, {"techniqueID": "T1102", "comment": "This technique involves creating a network-based attack against the system, the vulnerability is a potential entry point for attackers, this technique uses network communication to exploit the vulnerability."}, {"techniqueID": "T1078", "comment": "This technique involves injecting code into a process, the vulnerability allows for code injection, this technique can be used to establish persistence, manipulate data, or execute malicious code on the system."}], "stix_bundle": [{"id": "urn:schemas-microsoft-com:ms-2007-3901", "type": "software", "name": "DirectShow Synchronized Accessible Media Interchange (SAMI) parser", "description": "The DirectShow Synchronized Accessible Media Interchange (SAMI) parser in quartz.dll for Microsoft DirectX 7.0 through 10.0 allows remote attackers to execute arbitrary code via a crafted SAMI file.", "vulnerability": {"id": "CVE-2007-3901", "type": "vulnerability"}, "related": {"exploit": {"type": "exploit", "id": "CVE-2007-3901"}, "mitigation": {"type": "mitigation", "id": "fix_software"}}}, {"id": "urn:microsoft:ms-2007-3901-defense", "type": "defense", "description": "Implementing a robust security solution that monitors for and blocks suspicious activity, patching the DirectShow Synchronized Accessible Media Interchange (SAMI) parser, and educating users on safe handling of SAMI files can help to prevent exploitation of this vulnerability.", "related": {"technique": {"type": "technique", "id": "T1059"}, "vulnerability": {"type": "vulnerability", "id": "CVE-2007-3901"}}}], "technical_analysis": {"Introduction": "The DirectShow Synchronized Accessible Media Interchange (SAMI) parser in quartz.dll for Microsoft DirectX 7.0 through 10.0 allows remote attackers to execute arbitrary code via a crafted SAMI file.", "Impact and Scope": "The vulnerability has a CVSS score of 8.5 and is classified as HIGH severity, it has a high impact on the system and can be exploited remotely.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to multiple MITRE ATT&CK techniques, including T1059, T1027, T1055, T1102, and T1078.", "Technical Details": "The vulnerability is due to a stack-based buffer overflow in the DirectShow Synchronized Accessible Media Interchange (SAMI) parser, which can be exploited by crafting a specific SAMI file.", "Detection": "Detection can be done by monitoring for suspicious activity related to the DirectShow Synchronized Accessible Media Interchange (SAMI) parser, such as unusual system calls or network traffic.", "Mitigation": "Mitigation strategies include patching the DirectShow Synchronized Accessible Media Interchange (SAMI) parser, implementing a robust security solution that monitors for and blocks suspicious activity, and educating users on safe handling of SAMI files.", "Conclusion": "The vulnerability has a high impact on the system and can be exploited remotely, it is crucial to take steps to mitigate the vulnerability and prevent exploitation."}, "executive_analysis": {"Overview": "The vulnerability in the DirectShow Synchronized Accessible Media Interchange (SAMI) parser has the potential to allow remote attackers to execute arbitrary code, making it a high-priority vulnerability to address.", "Business Impact": "The vulnerability can have a significant impact on business operations, including data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability has a high technical impact, as it allows attackers to execute arbitrary code on the system, making it a high-priority vulnerability to address.", "Mitigation Strategies": "Mitigation strategies include patching the DirectShow Synchronized Accessible Media Interchange (SAMI) parser, implementing a robust security solution that monitors for and blocks suspicious activity, and educating users on safe handling of SAMI files.", "Recommendations": "We recommend patching the DirectShow Synchronized Accessible Media Interchange (SAMI) parser, implementing a robust security solution that monitors for and blocks suspicious activity, and educating users on safe handling of SAMI files.", "Conclusions": "In conclusion, the vulnerability in the DirectShow Synchronized Accessible Media Interchange (SAMI) parser is a high-priority vulnerability that requires immediate attention to prevent exploitation and mitigate potential risks."}}