{"id": "CVE-2009-0080", "sourceIdentifier": "secure@microsoft.com", "published": "2009-04-15T08:00:00.407", "lastModified": "2021-11-08T21:45:17.160", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The ThreadPool class in Windows Vista Gold and SP1, and Server 2008, does not properly implement isolation among a set of distinct processes that (1) all run under the NetworkService account or (2) all run under the LocalService account, which allows local users to gain privileges by leveraging incorrect thread ACLs to access the resources of one of the processes, aka \"Windows Thread Pool ACL Weakness Vulnerability.\""}, {"lang": "es", "value": "La clase ThreadPool en Windows Vista Gold y SP1, y Server 2008, no implementa adecuadamente el aislamiento entre un conjunto de procesos distintos que (1) se ejecutan bajo la cuenta NetworkService o (2) se ejecutan bajo la cuenta LocalService, lo cual permite a usuarios locales conseguir privilegios aprovechando hilos incorrectos ACLs para acceder a los recursos de uno de los procesos, tambi\u00e9n conocido como \"Vulnerabilidad Windows Thread Pool ACL Weakness\"."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.9}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-269"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:-:*:*:*:*:*:*:*", "matchCriteriaId": "32623D48-7000-4C7D-823F-7D2A9841D88C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_vista:-:*:*:*:*:*:*:*", "matchCriteriaId": "7CAEEA81-5037-4B68-98D9-83AAEBC98E20"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_vista:-:*:*:*:*:*:x64:*", "matchCriteriaId": "51160A46-6768-44D5-89CD-6DB9D2268A2E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_vista:-:sp1:*:*:*:*:*:*", "matchCriteriaId": "3A04E39A-623E-45CA-A5FC-25DAA0F275A3"}, {"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_vista:-:sp1:*:*:*:*:x64:*", "matchCriteriaId": "7211B5C5-6B6E-4A33-88BC-1D64CD684204"}]}]}], "references": [{"url": "http://osvdb.org/53668", "source": "secure@microsoft.com", "tags": ["Broken Link"]}, {"url": "http://www.securitytracker.com/id?1022044", "source": "secure@microsoft.com", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.us-cert.gov/cas/techalerts/TA09-104A.html", "source": "secure@microsoft.com", "tags": ["Third Party Advisory", "US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2009/1026", "source": "secure@microsoft.com", "tags": ["Permissions Required"]}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-012", "source": "secure@microsoft.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6177", "source": "secure@microsoft.com", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "TR.0005", "comment": "CVE-2009-0080 - A local privilege escalation vulnerability exists in Windows XP and Server 2003 due to improper ACLs being used in the thread pool. This technique can be used to gain elevated privileges."}, {"techniqueID": "TA0005", "comment": "CVE-2009-0080 - An attacker can exploit this vulnerability by leveraging incorrect thread ACLs to access the resources of one of the processes, potentially granting elevated privileges."}, {"techniqueID": "T1190", "comment": "CVE-2009-0080 - This vulnerability can be exploited using a thread pool ACL weakness, allowing an attacker to run a set of processes under a different account than the system's default account, potentially granting elevated privileges."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "urn:oval:com/security:windows_thread_pool_acls:v1", "extensions": [{"type": "vulnerability", "id": "CVE-2009-0080", "name": "Windows Thread Pool ACL Weakness Vulnerability", "description": "The Windows Thread Pool class in Windows Vista Gold and SP1, and Server 2008, does not properly implement isolation among a set of distinct processes that (1) all run under the NetworkService account or (2) all run under the LocalService account, which allows local users to gain privileges by leveraging incorrect thread ACLs to access the resources of one of the processes.", "assessed_configuration": {"nodes": [{"operator": "OR", "negate": false, "cpe_match": [{"vulnerable": true, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:-:*:*:*:*:*:*:*"}]}]}, "references": [{"url": "http://osvdb.org/53668", "source": "secure@microsoft.com", "tags": ["Broken Link"]}]}]}, "objects": [{"type": "course-of-action", "id": "COA-1", "name": "Mitigate Windows Thread Pool ACL Weakness", "description": "To mitigate this vulnerability, ensure that the Windows Thread Pool is configured to use proper ACLs, specifically ensuring that the process running under the NetworkService or LocalService accounts is properly isolated.", "related_technique": {"type": "related-technique", "technique_id": "TR.0005"}, "notes": [{"note": "Ensure proper ACL configuration for Windows Thread Pool"}]}]}, "technical_analysis": {"Introduction": "The Windows Thread Pool class in Windows Vista Gold and SP1, and Server 2008, does not properly implement isolation among a set of distinct processes that (1) all run under the NetworkService account or (2) all run under the LocalService account, which allows local users to gain privileges by leveraging incorrect thread ACLs to access the resources of one of the processes.", "Impact and Scope": "This vulnerability has a CVSS score of 6.9, with an attack vector of LOCAL and confidentiality, integrity, and availability impacts set to COMPLETE. This vulnerability affects Windows Vista Gold and SP1, and Server 2008.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to MITRE ATT&CK techniques TA0005: Privilege Escalation and TR.0005: Windows Privileged Account Discovery.", "Technical Details": "The vulnerability exists due to improper ACLs being used in the thread pool. This allows an attacker to gain elevated privileges by leveraging incorrect thread ACLs to access the resources of one of the processes.", "Detection": "Detection methods for this vulnerability include monitoring for unusual thread pool activity and verifying the integrity of Windows system files.", "Mitigation": "To mitigate this vulnerability, ensure that the Windows Thread Pool is configured to use proper ACLs, specifically ensuring that the process running under the NetworkService or LocalService accounts is properly isolated.", "Conclusion": "The Windows Thread Pool ACL Weakness vulnerability is a significant threat to Windows systems, and prompt mitigation is necessary to prevent privilege escalation and data breaches."}, "executive_analysis": {"Overview": "The Windows Thread Pool ACL Weakness vulnerability is a significant threat to Windows systems due to its potential to grant elevated privileges to local users.", "Business Impact": "Failure to mitigate this vulnerability can result in a loss of sensitive data and intellectual property, as well as loss of business credibility and reputation.", "Technical Impact": "The vulnerability can be exploited by leveraging incorrect thread ACLs to access the resources of one of the processes, potentially granting elevated privileges.", "Mitigation Strategies": "To mitigate this vulnerability, ensure that the Windows Thread Pool is configured to use proper ACLs, and implement regular vulnerability scanning and patch management.", "Recommendations": "Executives should implement regular vulnerability scanning and patch management, as well as ensure that all systems are up-to-date with the latest security patches.", "Conclusions": "The Windows Thread Pool ACL Weakness vulnerability is a high-priority threat that requires prompt mitigation to prevent privilege escalation and data breaches."}}