{"id": "CVE-2007-0729", "sourceIdentifier": "cve@mitre.org", "published": "2007-04-24T16:19:00.000", "lastModified": "2011-03-08T02:50:37.533", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Apple File Protocol (AFP) Client in Apple Mac OS X 10.3.9 through 10.4.9 does not properly clean the environment before executing commands, which allows local users to gain privileges by setting unspecified environment variables."}, {"lang": "es", "value": "El cliente Apple File Protocol (AFP) en Apple Mac OS X 10.3.9 hasta la 10.4.9 no limpia de forma adecuada el entorno antes de la ejecuci\u00f3n de comandos, lo cual permite a usuarios locales ganar privilegios a trav\u00e9s de la configuraci\u00f3n de variables de entorno no especificadas."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "99C273D1-ADFE-4B4C-B543-7B9CA741A117"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "0BC31B69-3DE1-4CF3-ADC9-CA0BF1714CBF"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "77CC671C-6D89-4279-86F7-DDE1D4D9A0CA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "8E4B77F6-E71C-45ED-96CC-7872AD2FCBF8"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.0.4:*:*:*:*:*:*:*", "matchCriteriaId": "066ABC3B-B395-42D2-95C0-5B810F91A6F0"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.1:*:*:*:*:*:*:*", "matchCriteriaId": "01BC19FC-6E03-4000-AE4B-232E47FA76F2"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "421FC2DD-0CF7-44A2-A63C-5221689E2363"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.1.2:*:*:*:*:*:*:*", "matchCriteriaId": "0F8B70BC-42B7-453A-B506-7BE69D49A4B5"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.1.3:*:*:*:*:*:*:*", "matchCriteriaId": "FAAC6EA5-DCB2-4A50-A8BC-25CC43FAEF9B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.1.4:*:*:*:*:*:*:*", "matchCriteriaId": "CA32F7D8-02F8-4CFE-B193-2888807BC4D6"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.1.5:*:*:*:*:*:*:*", "matchCriteriaId": "A9DCDE70-07DA-4F0B-805F-6BA03D410CD6"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.2:*:*:*:*:*:*:*", "matchCriteriaId": "CDCF4FB3-F781-46D5-BEE7-485B3DC78B83"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "AE52A344-8B07-480D-A57F-B1F6E6574F3B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.2.2:*:*:*:*:*:*:*", "matchCriteriaId": "56CC0444-570C-4BB5-B53A-C5CA0BD87935"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.2.3:*:*:*:*:*:*:*", "matchCriteriaId": "62E3EED7-FE30-4620-B40B-9CC49B77408A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.2.4:*:*:*:*:*:*:*", "matchCriteriaId": "5AFD8BC6-4893-4D9D-A26E-27AAC864F94B"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.2.5:*:*:*:*:*:*:*", "matchCriteriaId": "9BD1F9A1-5ADB-451D-9525-D545E42D2B8F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.2.6:*:*:*:*:*:*:*", "matchCriteriaId": "D7A24978-2891-425C-ACF6-E8F5C839C54A"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.2.7:*:*:*:*:*:*:*", "matchCriteriaId": "9B20E130-6078-4336-B614-273C27142B46"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.2.8:*:*:*:*:*:*:*", "matchCriteriaId": "AB461678-560D-436E-A3AE-9E1E16DB0412"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.3:*:*:*:*:*:*:*", "matchCriteriaId": "BFDADE04-29F0-446B-824B-0518880CF0A0"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.3.1:*:*:*:*:*:*:*", "matchCriteriaId": "ED9BE602-A740-4CF7-9CAF-59061B16AB31"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.3.2:*:*:*:*:*:*:*", "matchCriteriaId": "33E698C1-C313-40E6-BAF9-7C8F9CF02484"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.3.3:*:*:*:*:*:*:*", "matchCriteriaId": "BF2D00AC-FA2A-4C39-B796-DC19072862CF"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.3.4:*:*:*:*:*:*:*", "matchCriteriaId": "421079DA-B605-4E05-9454-C30CF7631CF4"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.3.5:*:*:*:*:*:*:*", "matchCriteriaId": "93B734BA-3435-40A9-B22B-5D56CEB865A7"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.3.6:*:*:*:*:*:*:*", "matchCriteriaId": "C4B57B3E-B1B2-4F13-99D3-4F9DB3C07B5E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.3.7:*:*:*:*:*:*:*", "matchCriteriaId": "30897327-44DD-4D6C-B8B6-2D66C44EA55D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.3.8:*:*:*:*:*:*:*", "matchCriteriaId": "B79D8F73-2E78-4A67-96BB-21AD9BCB0094"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.3.9:*:*:*:*:*:*:*", "matchCriteriaId": "DC6931D5-DE7E-41F6-ADDC-AB5A8A167F69"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4:*:*:*:*:*:*:*", "matchCriteriaId": "0760FDDB-38D3-4263-9B4D-1AF5E613A4F9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "AFD4DE58-46C7-4E69-BF36-C5FD768B8248"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "CF824694-52DE-44E3-ACAD-60B2A84CD3CE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.3:*:*:*:*:*:*:*", "matchCriteriaId": "B73A0891-A37A-4E0D-AA73-B18BFD6B1447"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.4:*:*:*:*:*:*:*", "matchCriteriaId": "26AC38AB-D689-4B2B-9DAE-F03F4DFD15BE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.5:*:*:*:*:*:*:*", "matchCriteriaId": "0C580935-0091-4163-B747-750FB7686973"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.6:*:*:*:*:*:*:*", "matchCriteriaId": "BB0F2132-8431-4CEF-9A3D-A69425E3834E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.7:*:*:*:*:*:*:*", "matchCriteriaId": "8719F3C4-F1DE-49B5-9301-22414A2B6F9C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.8:*:*:*:*:*:*:*", "matchCriteriaId": "09ED46A8-1739-411C-8807-2A416BDB6DFE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.9:*:*:*:*:*:*:*", "matchCriteriaId": "786BB737-EA99-4EC6-B742-0C35BF2453F9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_preview.app:3.0.8:*:*:*:*:*:*:*", "matchCriteriaId": "00C767DB-837D-4B67-BC06-6D4911FFA82D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "DB279593-17D1-4A65-BF54-969B38B74B23"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.1:*:*:*:*:*:*:*", "matchCriteriaId": "80F5B731-D5A7-4694-9B27-CEE1DCC810EC"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "8D5DB7BE-FC71-4ADE-8B9F-7EA401C8CA88"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.1.2:*:*:*:*:*:*:*", "matchCriteriaId": "D3E2571E-D9EB-43CD-82DD-8C813FF8D5E5"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.1.3:*:*:*:*:*:*:*", "matchCriteriaId": "36F4618C-1408-4097-B97D-5F32DE6D01DF"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.1.4:*:*:*:*:*:*:*", "matchCriteriaId": "5F558C40-D0DA-4700-95DA-DF1322C020E6"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.1.5:*:*:*:*:*:*:*", "matchCriteriaId": "64F8F30B-E4B8-4745-AFFA-8FD620E61994"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.2:*:*:*:*:*:*:*", "matchCriteriaId": "00AE033B-5F16-4262-A397-02D7450189B8"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "2E831F3E-A980-47AF-BD05-2DB1A14689B4"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.2.2:*:*:*:*:*:*:*", "matchCriteriaId": "36991737-904F-4B26-AEE2-7B30411279E8"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.2.3:*:*:*:*:*:*:*", "matchCriteriaId": "F7EE6036-1A18-43F1-8A92-7DF39E1516E3"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.2.4:*:*:*:*:*:*:*", "matchCriteriaId": "620ECFC8-293D-4C2B-9698-67185BB6E2EF"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.2.5:*:*:*:*:*:*:*", "matchCriteriaId": "C1F14A45-BDDB-4C12-9370-D5241975A928"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.2.6:*:*:*:*:*:*:*", "matchCriteriaId": "46BC34D4-A1E8-4E01-982D-EAF03A0EB886"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.2.7:*:*:*:*:*:*:*", "matchCriteriaId": "35932546-B614-47C0-98E6-8EF1EFE06725"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.2.8:*:*:*:*:*:*:*", "matchCriteriaId": "38F17066-C090-4DD7-A1AC-D8FF70D268CE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.3.9:*:*:*:*:*:*:*", "matchCriteriaId": "8923EE1A-DD48-4EC8-8698-A33093FD709C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4:*:*:*:*:*:*:*", "matchCriteriaId": "D24D5FA5-95DD-4ECC-B99A-8CB33156A6D0"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "29644501-54BD-45E9-A6C1-618892CD354F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "8A132487-E89F-4D0D-8366-14AFC904811F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.3:*:*:*:*:*:*:*", "matchCriteriaId": "FD231103-D7C7-4697-BE90-D67558D6115C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.4:*:*:*:*:*:*:*", "matchCriteriaId": "BCADAAA0-C885-466C-A122-A94E73EAF817"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.5:*:*:*:*:*:*:*", "matchCriteriaId": "448DB1C7-7B0C-4076-9B9F-1CDCD5EB6930"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.6:*:*:*:*:*:*:*", "matchCriteriaId": "2BE429EF-24D4-453A-8B43-8CCEF5D72773"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.7:*:*:*:*:*:*:*", "matchCriteriaId": "8AC9692A-CE81-446D-B136-449662C4B9A2"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.8:*:*:*:*:*:*:*", "matchCriteriaId": "504D78AB-5374-48C9-B357-DB6BD2267D2D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.9:*:*:*:*:*:*:*", "matchCriteriaId": "3029892E-1375-4F40-83D3-A51BDC4E9840"}]}]}], "references": [{"url": "http://docs.info.apple.com/article.html?artnum=305391", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://lists.apple.com/archives/Security-announce/2007/Apr/msg00001.html", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/24966", "source": "cve@mitre.org"}, {"url": "http://www.kb.cert.org/vuls/id/312424", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "US Government Resource"]}, {"url": "http://www.osvdb.org/34858", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/23569", "source": "cve@mitre.org"}, {"url": "http://www.securitytracker.com/id?1017944", "source": "cve@mitre.org"}, {"url": "http://www.us-cert.gov/cas/techalerts/TA07-109A.html", "source": "cve@mitre.org", "tags": ["US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2007/1470", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "The CVE-2007-0729 vulnerability in Apple File Protocol allows for a local privilege escalation. Validating the code execution with file permissions allows for increasing privileges."}, {"techniqueID": "T1027", "comment": "The vulnerability in Apple File Protocol allows an attacker to execute arbitrary commands as root. This can be used to gain high-privileged access to the system."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle--e7f443e0-2c44-4bb1-bdce-4d67c6d5f34a", "description": "STIX 2.1 bundle for CVE-2007-0729", "objects": [{"type": "vulnerability", "id": "vulnerability--c3a1e49f-745c-43e7-b3ce-e04cf22c4a34", "name": "CVE-2007-0729", "description": "Apple File Protocol (AFP) Client in Apple Mac OS X 10.3.9 through 10.4.9 does not properly clean the environment before executing commands, which allows local users to gain privileges by setting unspecified environment variables."}, {"type": "threat-actor", "id": "threat-actor--16d9d0db-f2d8-4c4a-9e4b-0aeb9463c93f", "name": "Attackers"}, {"type": "campaign", "id": "campaign--5ac3a5f4-1f5f-4f6d-bb93-b0d91f4bb1d1", "name": "Local Privilege Escalation Campaign"}, {"type": "course-of-action", "id": "course-of-action--53f9edd5-be16-46c5-b01a-49f31d79d53a", "name": " Mitigate Local Privilege Escalation", "description": "Apply the CVE-2007-0729 patch"}, {"type": "note", "id": "note--1c0e4e2f-3f2a-45a7-bb31-b41a44d41c73", "name": "Defense Point", "description": "Enable ASLR and DEP in the system settings"}, {"type": "vulnerability-exploits", "id": "relationship--d4c13c1f-93e5-409c-94f8-8e2a2a4f4f5f", "from": "vulnerability--c3a1e49f-745c-43e7-b3ce-e04cf22c4a34", "to": "threat-actor--16d9d0db-f2d8-4c4a-9e4b-0aeb9463c93f", "description": "The Apple File Protocol (AFP) Client vulnerability can be exploited by attackers to gain local privileges."}, {"type": "mitigates", "id": "relationship--6a51e7a6-33be-4826-9a1c-ebc53b5b4f49", "from": "course-of-action--53f9edd5-be16-46c5-b01a-49f31d79d53a", "to": "vulnerability--c3a1e49f-745c-43e7-b3ce-e04cf22c4a34", "description": "The CVE-2007-0729 patch mitigates the exploit of the Apple File Protocol (AFP) Client vulnerability."}, {"type": "mitigates", "id": "relationship--a8a4df44-e93c-4035-944f-3b9ca9356da8", "from": "note--1c0e4e2f-3f2a-45a7-bb31-b41a44d41c73", "to": "vulnerability--c3a1e49f-745c-43e7-b3ce-e04cf22c4a34", "description": "Enabling ASLR and DEP in the system settings mitigates the exploit of the Apple File Protocol (AFP) Client vulnerability."}], "relations": [{"type": "is-related-to", "from": "bundle--e7f443e0-2c44-4bb1-bdce-4d67c6d5f34a", "to": "vulnerability--c3a1e49f-745c-43e7-b3ce-e04cf22c4a34"}]}, "technical_analysis": {"Introduction": "The CVE-2007-0729 vulnerability is a local privilege escalation vulnerability in the Apple File Protocol (AFP) Client of Apple Mac OS X 10.3.9 through 10.4.9. This vulnerability allows an attacker to execute arbitrary commands as root, granting high-privileged access to the system.", "Impact and Scope": "The vulnerability has a CVSS score of 7.2, with an attack vector of LOCAL. This means that an attacker must be on the local network to exploit the vulnerability.", "Related MITRE ATT&CK Techniques": "T1190, T1027", "Technical Details": "The vulnerability occurs because the Apple File Protocol (AFP) Client does not properly clean the environment before executing commands. This allows an attacker to set unspecified environment variables, which can be used to gain high-privileged access.", "Detection": "Detection of this vulnerability may involve monitoring system logs for suspicious activity and looking for changes in system configuration.", "Mitigation": "The vulnerability can be mitigated by applying the CVE-2007-0729 patch and enabling ASLR and DEP in the system settings.", "Conclusion": "In conclusion, the CVE-2007-0729 vulnerability is a local privilege escalation vulnerability that can be exploited by attackers to gain high-privileged access to the system. It is important to apply the patch and enable ASLR and DEP to mitigate the vulnerability."}, "executive_analysis": {"Overview": "The CVE-2007-0729 vulnerability is a local privilege escalation vulnerability in the Apple File Protocol (AFP) Client of Apple Mac OS X 10.3.9 through 10.4.9.", "Business Impact": "The vulnerability can be exploited by attackers to gain high-privileged access to the system, which can result in data breaches and unauthorized access to sensitive information.", "Technical Impact": "The vulnerability can be exploited by attackers to gain high-privileged access to the system, which can result in compromise of system security and potential data breaches.", "Mitigation Strategies": "Apply the CVE-2007-0729 patch and enable ASLR and DEP in the system settings.", "Recommendations": "Recommendations for executives include applying the patch, enabling ASLR and DEP, and monitoring system logs for suspicious activity.", "Conclusions": "In conclusion, the CVE-2007-0729 vulnerability is a critical issue that requires immediate attention to prevent exploitation and potential data breaches."}}