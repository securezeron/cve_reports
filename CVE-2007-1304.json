{"id": "CVE-2007-1304", "sourceIdentifier": "cve@mitre.org", "published": "2007-03-07T00:19:00.000", "lastModified": "2024-02-14T01:17:43.863", "vulnStatus": "Modified", "cveTags": [], "evaluatorImpact": "Successful exploitation requires that \"magic_quotes_gpc\" is disabled.", "descriptions": [{"lang": "en", "value": "Multiple SQL injection vulnerabilities in add2.php in Sava's Guestbook 23.11.2006, when magic_quotes_gpc is disabled, allow remote attackers to execute arbitrary SQL commands via the (1) name, (2) country, (3) email, (4) website, and (5) message parameters."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de inyecci\u00f3n SQL en add2.php de Sava's Guestbook 23/11/2006, cuando magic_quotes_gpc est\u00e1 deshabilitado, permite a atacantes remotos ejecutar comandos sql de su elecci\u00f3n mediante los par\u00e1metros (1) name, (2) country, (3) email, (4) website, y (5) message."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:savas_place:savas_guestbook:2006-11-23:*:*:*:*:*:*:*", "matchCriteriaId": "8E0B26E3-8D94-42D5-B344-2AE29CB1D0A8"}]}]}], "references": [{"url": "http://belsec.com/advisories/142/summary.html", "source": "cve@mitre.org", "tags": ["URL Repurposed"]}, {"url": "http://secunia.com/advisories/24411", "source": "cve@mitre.org"}, {"url": "http://securityreason.com/securityalert/2350", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/461910/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/22820", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/32811", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059.007", "comment": "CVE-2007-1304 - This technique is relevant as it exploits SQL injection vulnerability in Sava's Guestbook. Attackers can execute arbitrary SQL commands, leading to data theft or system compromise. Defending against this technique involves validating and sanitizing user inputs, and implementing proper input validation filters."}, {"techniqueID": "T1047", "comment": "CVE-2007-1304 - This technique is relevant as it involves using web-based vulnerabilities to upload malicious code. The attacker can use this technique to upload malicious files, escalate privileges, and move laterally within the network. Defending against this technique involves patching vulnerabilities, restricting file uploads, and implementing web application firewalls."}, {"techniqueID": "T1190", "comment": "CVE-2007-1304 - This technique is relevant as it involves using command and control (C2) servers to manage compromised systems. The attacker can use this technique to send and receive commands, move files, and steal sensitive data. Defending against this technique involves detecting and blocking C2 servers, monitoring network traffic, and implementing incident response plans."}, {"techniqueID": "T1568.002", "comment": "CVE-2007-1304 - This technique is relevant as it involves using web shells to maintain access to compromised systems. The attacker can use this technique to upload and execute malicious code, steal sensitive data, and move laterally within the network. Defending against this technique involves detecting and removing web shells, monitoring network traffic, and implementing incident response plans."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2007-1304", "name": "Sava's Guestbook SQL Injection Vulnerability", "description": "Multiple SQL injection vulnerabilities in add2.php in Sava's Guestbook 23.11.2006, when magic_quotes_gpc is disabled, allow remote attackers to execute arbitrary SQL commands via the (1) name, (2) country, (3) email, (4) website, and (5) message parameters.", "severity": "MEDIUM", "cvssScore": {"version": "2.0", "score": 6.8, "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P"}, "references": [{"sourceName": "cve@mitre.org", "href": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-1304"}], "relationships": [{"id": "rel_123", "type": "indicated-by", "target_id": "T1059.007"}, {"id": "rel_124", "type": "indicated-by", "target_id": "T1047"}, {"id": "rel_125", "type": "indicated-by", "target_id": "T1190"}, {"id": "rel_126", "type": "indicated-by", "target_id": "T1568.002"}]}]}, "technical_analysis": {"Introduction": "Sava's Guestbook is a widely used guestbook application with a vulnerability in the add2.php file.", "Impact and Scope": "This vulnerability allows remote attackers to execute arbitrary SQL commands, potentially leading to data theft or system compromise. The cvss score is 6.8 with a version of 2.0 and attack vector as NETWORK.", "Related MITRE ATT&CK Techniques": "T1059.007, T1047, T1190, and T1568.002", "Technical Details": "The vulnerability occurs due to the lack of proper input validation filters and the disabling of magic_quotes_gpc. Attackers can use this to inject malicious SQL code and execute arbitrary commands.", "Detection": "Detecting this vulnerability involves monitoring for unusual network traffic and logs showing suspicious database queries.", "Mitigation": "Mitigating this vulnerability involves disabling magic_quotes_gpc, validating and sanitizing user inputs, and implementing proper input validation filters.", "Conclusion": "This vulnerability is a medium-severity vulnerability and should be prioritized for remediation."}, "executive_analysis": {"Overview": "Sava's Guestbook has a vulnerability that can be exploited to steal data or compromise systems.", "Business Impact": "Potential loss of sensitive data and system compromise can have significant business impact.", "Technical Impact": "Attackers can use this vulnerability to execute arbitrary SQL commands and steal sensitive data.", "Mitigation Strategies": "Implementing proper input validation filters, disabling magic_quotes_gpc, and monitoring network traffic and logs can help mitigate this vulnerability.", "Recommendations": "Remediate the vulnerability as soon as possible and implement incident response plans to respond quickly in case of an attack.", "Conclusions": "The vulnerability is a medium-severity vulnerability and should be prioritized for remediation."}}