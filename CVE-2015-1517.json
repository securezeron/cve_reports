{"id": "CVE-2015-1517", "sourceIdentifier": "cve@mitre.org", "published": "2015-02-20T16:59:05.163", "lastModified": "2018-10-09T19:55:56.013", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "SQL injection vulnerability in Piwigo before 2.7.4, when all filters are activated, allows remote authenticated users to execute arbitrary SQL commands via the filter_level parameter in a \"Refresh photo set\" action in the batch_manager page to admin.php."}, {"lang": "es", "value": "Vulnerabilidad de inyecci\u00f3n SQL en Piwigo anterior a 2.7.4, cuando todos los filtros est\u00e1n activados, permite a usuarios remotos autenticados ejecutar comandos SQL arbitrarios a trav\u00e9s del par\u00e1metro filter_level en una acci\u00f3n 'Refresh photo set' en la p\u00e1gina batch_manager en admin.php."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 6.8, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:piwigo:piwigo:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.7.3", "matchCriteriaId": "E2C56A23-6191-4B62-82F3-35527976E603"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/130440/Piwigo-2.7.3-SQL-Injection.html", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://piwigo.org/forum/viewtopic.php?id=25179", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://piwigo.org/releases/2.7.4", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/534723/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/72664", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2015-1517 - This SQL Injection vulnerability in Piwigo allows attackers to execute arbitrary SQL commands, enabling exploitation and data manipulation, potentially leading to unauthorized data access, data breaches, and system compromise. D3FEND's Web Application Firewall (WAF) and Input Validation can help detect and prevent this attack."}, {"techniqueID": "TA0007", "comment": "CVE-2015-1517 - The vulnerability in Piwigo allows an authenticated attacker to inject malicious SQL code, enabling command execution and potential data manipulation. D3FEND's Automated Indicator Sharing (AIS) and Security Orchestration, Automation, and Response (SOAR) can help detect and respond to this attack."}, {"techniqueID": "T1190", "comment": "CVE-2015-1517 - The SQL Injection vulnerability in Piwigo allows attackers to execute arbitrary SQL commands, enabling data manipulation and potentially leading to unauthorized data access, data breaches, and system compromise. D3FEND's Web Application Firewall (WAF) and Input Validation can help detect and prevent this attack."}], "stix_bundle": "{\"indicator\": {\n  \"id\": \"indicator-12345\",\n  \"created_by_refs\": [],\n  \"modified\": \"2022-01-01T12:00:00.000Z\",\n  \"created\": \"2022-01-01T11:59:59.000Z\",\n  \"name\": \"Piwigo SQL Injection Indicator\",\n  \"description\": \"Indicator for Piwigo SQL Injection vulnerability\",\n  \"labels\": [\"indicator\", \"vulnerability\", \"sql-injection\"],\n  \"objects\": [\n    {\n      \"id\": \"object-12345\",\n      \"created_by_refs\": [],\n      \"modified\": \"2022-01-01T12:00:00.000Z\",\n      \"created\": \"2022-01-01T11:59:59.000Z\",\n      \"name\": \"Piwigo SQL Injection Object\",\n      \"description\": \"Object represents Piwigo SQL Injection vulnerability\",\n      \"type\": \"vulnerability\",\n      \"labels\": [\"vulnerability\", \"sql-injection\"]\n    }\n  ],\n  \"relationships\": [\n    {\n      \"id\": \"relationship-12345\",\n      \"type\": \"has\",\n      \"object_refs\": [\"object-12345\"],\n      \"indicator_refs\": [\"indicator-12345\"]\n    }\n  ]\n}\n", "technical_analysis": {"Introduction": "The CVE-2015-1517 vulnerability in Piwigo is a SQL injection vulnerability that allows attackers to execute arbitrary SQL commands, enabling data manipulation and potentially leading to unauthorized data access, data breaches, and system compromise.", "Impact and Scope": "The vulnerability has a CVSS score of 6.0 and affects all versions of Piwigo before 2.7.4, with an attack vector of 'Network' and authentication level of 'SINGLE'.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1059, TA0007, and T1190.", "Technical Details": "The vulnerability occurs due to inadequate input validation in the 'filter_level' parameter in the 'Refresh photo set' action in the batch_manager page.", "Detection": "Detection of this attack is challenging, but D3FEND's Web Application Firewall (WAF) and Input Validation can help detect and prevent this attack.", "Mitigation": "Mitigation strategies include updating Piwigo to version 2.7.4 or later, disabling the 'filter_level' parameter, and implementing D3FEND's Web Application Firewall (WAF) and Input Validation.", "Conclusion": "The CVE-2015-1517 vulnerability in Piwigo is a significant security risk that can lead to unauthorized data access, data breaches, and system compromise. Implementing mitigation strategies and using D3FEND's security products can help prevent and respond to this attack."}, "executive_analysis": {"Overview": "The CVE-2015-1517 vulnerability in Piwigo is a significant security risk that can compromise sensitive data and impact business operations.", "Business Impact": "The vulnerability can lead to data breaches, reputational damage, and financial losses.", "Technical Impact": "The vulnerability can allow attackers to gain unauthorized access to sensitive data and execute arbitrary SQL commands.", "Mitigation Strategies": "Updating Piwigo, disabling the 'filter_level' parameter, and implementing D3FEND's security products can help mitigate the risk.", "Recommendations": "Executives should implement mitigation strategies, prioritize security, and ensure ongoing monitoring and incident response.", "Conclusions": "The CVE-2015-1517 vulnerability in Piwigo is a critical security risk that requires immediate attention and action."}}