{"id": "CVE-2007-2777", "sourceIdentifier": "cve@mitre.org", "published": "2007-05-21T23:30:00.000", "lastModified": "2017-10-11T01:32:22.863", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Unrestricted file upload vulnerability in admin/addsptemplate.php in AlstraSoft Template Seller Pro 3.25 and earlier allows remote attackers to execute arbitrary PHP code via an arbitrary .php filename in the zip parameter, which is created under sptemplates/."}, {"lang": "es", "value": "Vulnerabilidad de actualizaci\u00f3n de archivo no restringido en admin/addsptemplate.php en AlstraSoft Template Seller Pro 3.25 y anteriores permite a atacantes remotos ejecutar c\u00f3digo PHP a trav\u00e9s de un nombre de archivo .php de su elecci\u00f3n en el par\u00e1metro zip, el cual est\u00e1 creado bajo sptemplates/."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:alstrasoft:template_seller:*:*:pro:*:*:*:*:*", "versionEndIncluding": "3.25", "matchCriteriaId": "8B8ADFC5-CACA-4B6E-8CA1-A4582CC8E2E7"}]}]}], "references": [{"url": "http://osvdb.org/40423", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/24068", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/34398", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/3959", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "POST /admin/addsptemplate.php with a crafted zip file containing a PHP shell. - This technique is relevant as the vulnerability allows remote code execution and is a classic file inclusion vulnerability that can be exploited by a zip file with a crafted directory traversal."}, {"techniqueID": "T1191", "comment": "Use directory traversal to upload arbitrary files. - This technique is relevant as the vulnerability allows unauthorized file uploads and is commonly used to upload malicious files for persistence and privilege escalation."}, {"techniqueID": "T1193", "comment": "Use a vulnerability scanner to identify the vulnerable version of Template Seller Pro. - This technique is relevant as vulnerability scanners can be used to identify the vulnerable version and provide remediation steps."}, {"techniqueID": "T1210", "comment": "Use the exploit against the vulnerable version of Template Seller Pro. - This technique is relevant as the exploit provides a means to remotely execute arbitrary code on the vulnerable version."}, {"techniqueID": "T1222", "comment": "Use a web shell to interact with the compromised server. - This technique is relevant as the web shell provides a means to interact with the compromised server and can be used to execute arbitrary commands."}], "technical_analysis": {"Introduction": "The vulnerability allows remote code execution and can be exploited by uploading a crafted zip file containing a PHP shell. The vulnerability is a classic file inclusion vulnerability and can be exploited using directory traversal.", "Impact and Scope": "The vulnerability affects AlstraSoft Template Seller Pro 3.25 and earlier. The CVSS score is 7.5 with a version of 2.0, attack vector of NETWORK and confidentiality, integrity, and availability impacts all being PARTIAL.", "Related MITRE ATT&CK Techniques": "The techniques listed above are relevant to the CVE.", "Technical Details": "The vulnerability occurs when the admin/addsptemplate.php script creates a zip file with a directory traversal feature allowing attackers to upload arbitrary files.", "Detection": "Detection can be made by identifying the vulnerable version of Template Seller Pro and using a vulnerability scanner or exploit to identify the presence of a web shell.", "Mitigation": "Mitigation can be made by updating to a patched version of Template Seller Pro, disabling directory traversal functions, and implementing input validation and sanitization.", "Conclusion": "The vulnerability is a significant risk and enables remote code execution. It is essential to update to a patched version and implement mitigations to prevent exploitation."}, "executive_analysis": {"Overview": "The vulnerability in AlstraSoft Template Seller Pro 3.25 and earlier allows remote code execution and can be exploited by uploading a crafted zip file containing a PHP shell.", "Business Impact": "The vulnerability can result in significant business disruption and loss of sensitive data. It is essential to update to a patched version and implement mitigations to prevent exploitation.", "Technical Impact": "The vulnerability allows remote code execution and can be exploited using directory traversal. It is essential to update to a patched version and implement mitigations to prevent exploitation.", "Mitigation Strategies": "Update to a patched version, disable directory traversal functions, implement input validation and sanitization, and use a web application firewall.", "Recommendations": "Executives should recommend that the vulnerability be addressed promptly and that all necessary mitigations are implemented.", "Conclusions": "The vulnerability is a significant risk and requires immediate attention. Executives should prioritize the implementation of mitigations and recommend updates to a patched version."}}