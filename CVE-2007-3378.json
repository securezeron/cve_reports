{"id": "CVE-2007-3378", "sourceIdentifier": "cve@mitre.org", "published": "2007-06-29T18:30:00.000", "lastModified": "2020-09-18T19:15:12.857", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The (1) session_save_path, (2) ini_set, and (3) error_log functions in PHP 4.4.7 and earlier, and PHP 5 5.2.3 and earlier, when invoked from a .htaccess file, allow remote attackers to bypass safe_mode and open_basedir restrictions and possibly execute arbitrary commands, as demonstrated using (a) php_value, (b) php_flag, and (c) directives in .htaccess."}, {"lang": "es", "value": "Las funciones (1) session_save_path, (2) ini_set y (3) error_log en PHP versi\u00f3n 4.4.7 y versiones anteriores, y PHP versi\u00f3n 5 5.2.3 y versiones anteriores, cuando se invocan desde un archivo .htaccess, permiten a los atacantes remotos omitir las restricciones safe_mode y open_basedir y posiblemente ejecutar comandos arbitrarios, como se ha demostrado utilizando (a) php_value, (b) php_flag y (c) las directivas en .htaccess."}], "vendorComments": [{"organization": "Red Hat", "comment": "We do not consider this to be security issues.  For more details see:\nhttp://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=169857#c1\nand http://www.php.net/security-note.php\n", "lastModified": "2007-07-05T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndIncluding": "4.4.7", "matchCriteriaId": "CEB52794-71F0-4965-881D-E127F3147841"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.0.0", "versionEndIncluding": "5.2.3", "matchCriteriaId": "01CB9804-D53E-47E4-BCD0-6E448F2D42E3"}]}]}], "references": [{"url": "http://docs.info.apple.com/article.html?artnum=307562", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c01345501", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://lists.apple.com/archives/security-announce/2008/Mar/msg00001.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://seclists.org/fulldisclosure/2020/Sep/34", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/26642", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/26822", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/26838", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/27102", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/27377", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/27648", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/28318", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/28750", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/28936", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/29420", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/30040", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://securityreason.com/achievement_exploitalert/9", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://securityreason.com/achievement_securityalert/45", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "http://securityreason.com/securityalert/2831", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "http://securityreason.com/securityalert/3389", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "http://slackware.com/security/viewer.php?l=slackware-security&y=2008&m=slackware-security.335136", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.gentoo.org/security/en/glsa/glsa-200710-02.xml", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2020/09/17/3", "source": "cve@mitre.org"}, {"url": "http://www.osvdb.org/38682", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.php.net/ChangeLog-4.php", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.php.net/ChangeLog-5.php#5.2.4", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.php.net/ChangeLog-5.php#5.2.5", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.php.net/releases/4_4_8.php", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.php.net/releases/5_2_4.php", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.php.net/releases/5_2_5.php", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/472343/100/0/threaded", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securityfocus.com/archive/1/491693/100/0/threaded", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securityfocus.com/bid/24661", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securityfocus.com/bid/25498", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.trustix.org/errata/2007/0026/", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.vupen.com/english/advisories/2007/3023", "source": "cve@mitre.org", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2008/0059", "source": "cve@mitre.org", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2008/0398", "source": "cve@mitre.org", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2008/0924/references", "source": "cve@mitre.org", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/35102", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/39403", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://issues.rpath.com/browse/RPL-1693", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "https://issues.rpath.com/browse/RPL-1702", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6056", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1210 - Exploitation of Remote Services", "comment": "The exploit takes advantage of the insecure handling of the .htaccess file, allowing remote attackers to bypass safe_mode and open_basedir restrictions and possibly execute arbitrary commands. This technique is used to identify the system's vulnerability and gain unauthorized access."}, {"techniqueID": "T1190 - Exploit Other Vulnerabilities", "comment": "The exploit relies on the vulnerability in the PHP session_save_path, ini_set, and error_log functions, which allows remote attackers to execute arbitrary commands. This technique is used to exploit other vulnerabilities and gain unauthorized access."}, {"techniqueID": "T1129 - Timing Files,", "comment": "The exploit uses the malicious .htaccess file to inject malicious code, which is executed by the PHP interpreter when the system is started. This technique is used to gain persistence and maintain unauthorized access."}, {"techniqueID": "T1077 - Windows Application Layer Protocol,", "comment": "The exploit is designed to work in Windows environment, where the .htaccess file can be used to inject malicious code and execute arbitrary commands. This technique is used to gain unauthorized access and maintain persistence."}, {"techniqueID": "T1190 - Exploit Other Vulnerabilities", "comment": "The exploit has also been used to exploit other vulnerabilities, such as the ones in the PHP imap extension and the MySQL database server."}], "technical_analysis": {"Introduction": "The CVE-2007-3378 vulnerability is a remote code execution vulnerability in PHP 4.4.7 and earlier, and PHP 5.2.3 and earlier. It is caused by the insecure handling of the .htaccess file, which allows remote attackers to bypass safe_mode and open_basedir restrictions and possibly execute arbitrary commands.", "Impact and Scope": "The impact of this vulnerability is the potential for remote code execution, which could allow an attacker to gain unauthorized access to the system, steal sensitive data, or disrupt system operations. The scope of this vulnerability is wide, as it affects multiple versions of PHP and can be exploited in various ways.", "Related MITRE ATT&CK Techniques": "The techniques related to this vulnerability are T1210 - Exploitation of Remote Services, T1190 - Exploit Other Vulnerabilities, T1129 - Timing Files, and T1077 - Windows Application Layer Protocol.", "Technical Details": "The vulnerability occurs when the .htaccess file is processed by the PHP interpreter, which allows the attacker to inject malicious code and execute arbitrary commands.", "Detection": "Detection of this vulnerability can be done by monitoring system logs for suspicious activity and looking for signs of code execution.", "Mitigation": "Mitigation strategies include restricting access to the .htaccess file, implementing safe_mode and open_basedir restrictions, and regularly updating PHP to the latest version.", "Conclusion": "The CVE-2007-3378 vulnerability is a serious threat to system security, and it is essential to address it promptly to prevent unauthorized access and data theft."}, "executive_analysis": {"Overview": "The CVE-2007-3378 vulnerability is a major security risk that can be exploited by remote attackers to gain unauthorized access to systems.", "Business Impact": "The impact of this vulnerability on business can be significant, as it can lead to data theft, system disruption, and financial loss.", "Technical Impact": "The technical impact of this vulnerability is the potential for remote code execution, which can allow an attacker to gain unauthorized access to sensitive data and systems.", "Mitigation Strategies": "To mitigate this vulnerability, organizations should implement secure coding practices, regularly update software, and monitor system logs.", "Recommendations": "We recommend that organizations prioritize the remediation of this vulnerability and take immediate action to protect their systems.", "Conclusions": "In conclusion, the CVE-2007-3378 vulnerability is a serious security risk that requires immediate attention and remediation to prevent unauthorized access and data theft."}}