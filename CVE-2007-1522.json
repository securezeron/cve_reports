{"id": "CVE-2007-1522", "sourceIdentifier": "cve@mitre.org", "published": "2007-03-20T20:19:00.000", "lastModified": "2011-03-08T02:52:17.017", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Double free vulnerability in the session extension in PHP 5.2.0 and 5.2.1 allows context-dependent attackers to execute arbitrary code via illegal characters in a session identifier, which is rejected by an internal session storage module, which calls the session identifier generator with an improper environment, leading to code execution when the generator is interrupted, as demonstrated by triggering a memory limit violation or certain PHP errors."}, {"lang": "es", "value": "Vulnerabilidad de liberaci\u00f3n doble en la extensi\u00f3n session de PHP 5.2.0 and 5.2.1 permite a atacantes dependientes del contexto ejecutar c\u00f3digo de su elecci\u00f3n mediante caracteres ilegales en el identificador de sesi\u00f3n, lo cual es rechazado por el m\u00f3dulo de almacenamiento de sesi\u00f3n interno, lo cual llama al generador de identificador de sesi\u00f3n en un contexto inapropiado, dando la posibilidad de la inyecci\u00f3n de c\u00f3digo cuando el generador es interrumpido, como ha sido demostrado lanzando una violaci\u00f3n de l\u00edmite de memoria o ciertos errores de PHP."}], "vendorComments": [{"organization": "Red Hat", "comment": "The PHP interpreter does not offer a reliable &quot;sandboxed&quot; security\nlayer (as found in, say, a JVM) in which untrusted scripts can be run;\nany script run by the PHP interpreter must be trusted with the\nprivileges of the interpreter itself.  We therefore do not classify\nthis issue as security-sensitive since no trust boundary is crossed.\n", "lastModified": "2007-04-16T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.2.0:*:*:*:*:*:*:*", "matchCriteriaId": "CD02D837-FD28-4E0F-93F8-25E8D1C84A99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:5.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "88358D1E-BE6F-4CE3-A522-83D1FA4739E3"}]}]}], "references": [{"url": "http://secunia.com/advisories/24505", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/25056", "source": "cve@mitre.org"}, {"url": "http://www.novell.com/linux/security/advisories/2007_32_php.html", "source": "cve@mitre.org"}, {"url": "http://www.php-security.org/MOPB/MOPB-23-2007.html", "source": "cve@mitre.org", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/22971", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/0960", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "PHP Web Shell - The vulnerability can be exploited to inject web shell code"}, {"techniqueID": "T1210", "comment": "Map and Profile", "sub_comment": "Map the targeted web application and profile its environment"}, {"techniqueID": "T1117", "comment": " Encode Data", "sub_comment": "Encode the injected web shell code to evade detection"}, {"techniqueID": "T1048", "comment": "File and Directory Discovery", "sub_comment": "Discover and scan the targeted web application for files and directories"}, {"techniqueID": "T1053", "comment": "Input Validation Weakness", "sub_comment": "Exploit the input validation weakness to inject malicious code"}, {"techniqueID": "T1070", "comment": "Account Manipulation", "sub_comment": "Use the injected web shell to manipulate the targeted account"}, {"techniqueID": "T1174", "comment": "Lateral Movement", "sub_comment": "Use the compromised account to move laterally within the targeted network"}], "stix_bundle": {"@stix2_extension": "https://stix2.readthedocs.io/en/2.1/generated_extensions/", "bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle--f0f1d6b5-4ebd-43c3-9a4f-4e48c3a5e2da", "created_by_ref": "identity--7f5f5b5e-cf46-4e55-a5e5-a3cebe9f5d77", "created": "2022-01-22T14:30:00.000Z", "modified": "2022-01-22T14:30:00.000Z", "objects": [{"type": "incident", "spec_version": "2.1", "id": "incident--f0f1d6b5-4ebd-43c3-9a4f-4e48c3a5e2da", "created_by_ref": "identity--7f5f5b5e-cf46-4e55-a5e5-a3cebe9f5d77", "created": "2022-01-22T14:30:00.000Z", "modified": "2022-01-22T14:30:00.000Z", "title": "CVE-2007-1522 - Double Free Vulnerability in PHP 5.2.0 and 5.2.1", "description": "A double free vulnerability in the session extension in PHP 5.2.0 and 5.2.1 allows context-dependent attackers to execute arbitrary code via illegal characters in a session identifier", "first_seen": "2007-03-20T20:19:00.000Z", "last_seen": "2022-01-22T14:30:00.000Z", "objects": [{"type": "threat", "spec_version": "2.1", "id": "threat--f0f1d6b5-4ebd-43c3-9a4f-4e48c3a5e2da", "created_by_ref": "identity--7f5f5b5e-cf46-4e55-a5e5-a3cebe9f5d77", "created": "2022-01-22T14:30:00.000Z", "modified": "2022-01-22T14:30:00.000Z", "name": "Web Shell Threat"}], "relationships": {"incorporates": [{"from_ref": "incident--f0f1d6b5-4ebd-43c3-9a4f-4e48c3a5e2da", "to_ref": "technique--f0f1d6b5-4ebd-43c3-9a4f-4e48c3a5e2da"}], "threat_relationships": [{"from_ref": "incident--f0f1d6b5-4ebd-43c3-9a4f-4e48c3a5e2da", "to_ref": "threat--f0f1d6b5-4ebd-43c3-9a4f-4e48c3a5e2da"}]}}]}}, "technical_analysis": {"Introduction": "The CVE-2007-1522 is a double free vulnerability in the session extension in PHP 5.2.0 and 5.2.1 that allows context-dependent attackers to execute arbitrary code via illegal characters in a session identifier.", "Impact and Scope": "The impact of this vulnerability is the execution of arbitrary code on the targeted web application, which can lead to further compromise of the system.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190, T1210, T1117, T1048, T1053, T1070, and T1174.", "Technical Details": "The vulnerability occurs when illegal characters are passed in a session identifier, which is then processed by the PHP session extension.", "Detection": "Detection of this vulnerability is challenging, but it can be done using web application scanners and manual testing.", "Mitigation": "Mitigation of this vulnerability is done by updating to the latest version of PHP or by disabling the session extension.", "Conclusion": "The CVE-2007-1522 is a significant vulnerability that can lead to the compromise of web applications, and it is essential to patch and update systems to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2007-1522 is a severe vulnerability in the PHP session extension that can lead to the execution of arbitrary code on targeted web applications.", "Business Impact": "The business impact of this vulnerability is the potential compromise of sensitive data and disruption of business operations.", "Technical Impact": "The technical impact is the execution of arbitrary code on the targeted web application, which can lead to further compromise of the system.", "Mitigation Strategies": "Mitigation strategies include updating to the latest version of PHP, disabling the session extension, and implementing web application firewalls.", "Recommendations": "Recommendations for executives are to patch and update systems, implement robust security measures, and monitor for potential incidents.", "Conclusions": "The CVE-2007-1522 is a significant vulnerability that requires immediate attention and action to prevent exploitation and ensure the security of web applications."}}