{"id": "CVE-2007-4686", "sourceIdentifier": "cve@mitre.org", "published": "2007-11-15T01:46:00.000", "lastModified": "2018-10-15T21:36:57.483", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Integer signedness error in the ttioctl function in bsd/kern/tty.c in the xnu kernel in Apple Mac OS X 10.4 through 10.4.10 allows local users to cause a denial of service (system shutdown) or gain privileges via a crafted TIOCSETD ioctl request."}, {"lang": "es", "value": "Un error en la propiedad signedness de enteros en la funci\u00f3n ttioctl en el archivo bsd/kern/tty.c en el Kernel xnu en Apple Mac OS X versiones 10.4 hasta 10.4.10,  permite a usuarios locales causar una denegaci\u00f3n de servicio (apagado del sistema) o alcanzar privilegios por medio de una petici\u00f3n ioctl TIOCSETD dise\u00f1ada."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-189"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "AFD4DE58-46C7-4E69-BF36-C5FD768B8248"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "CF824694-52DE-44E3-ACAD-60B2A84CD3CE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.3:*:*:*:*:*:*:*", "matchCriteriaId": "B73A0891-A37A-4E0D-AA73-B18BFD6B1447"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.4:*:*:*:*:*:*:*", "matchCriteriaId": "26AC38AB-D689-4B2B-9DAE-F03F4DFD15BE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.5:*:*:*:*:*:*:*", "matchCriteriaId": "0C580935-0091-4163-B747-750FB7686973"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.6:*:*:*:*:*:*:*", "matchCriteriaId": "BB0F2132-8431-4CEF-9A3D-A69425E3834E"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.7:*:*:*:*:*:*:*", "matchCriteriaId": "8719F3C4-F1DE-49B5-9301-22414A2B6F9C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.8:*:*:*:*:*:*:*", "matchCriteriaId": "09ED46A8-1739-411C-8807-2A416BDB6DFE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.9:*:*:*:*:*:*:*", "matchCriteriaId": "786BB737-EA99-4EC6-B742-0C35BF2453F9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.10:*:*:*:*:*:*:*", "matchCriteriaId": "8D089858-3AF9-4B82-912D-AA33F25E3715"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "29644501-54BD-45E9-A6C1-618892CD354F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "8A132487-E89F-4D0D-8366-14AFC904811F"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.3:*:*:*:*:*:*:*", "matchCriteriaId": "FD231103-D7C7-4697-BE90-D67558D6115C"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.4:*:*:*:*:*:*:*", "matchCriteriaId": "BCADAAA0-C885-466C-A122-A94E73EAF817"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.5:*:*:*:*:*:*:*", "matchCriteriaId": "448DB1C7-7B0C-4076-9B9F-1CDCD5EB6930"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.6:*:*:*:*:*:*:*", "matchCriteriaId": "2BE429EF-24D4-453A-8B43-8CCEF5D72773"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.7:*:*:*:*:*:*:*", "matchCriteriaId": "8AC9692A-CE81-446D-B136-449662C4B9A2"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.8:*:*:*:*:*:*:*", "matchCriteriaId": "504D78AB-5374-48C9-B357-DB6BD2267D2D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.9:*:*:*:*:*:*:*", "matchCriteriaId": "3029892E-1375-4F40-83D3-A51BDC4E9840"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.10:*:*:*:*:*:*:*", "matchCriteriaId": "81F8DA6D-2258-4138-8FB2-90BE3C68B230"}]}]}], "references": [{"url": "http://docs.info.apple.com/article.html?artnum=307041", "source": "cve@mitre.org"}, {"url": "http://lists.apple.com/archives/security-announce/2007/Nov/msg00002.html", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://secunia.com/advisories/27643", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://securitytracker.com/id?1018950", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/483753/100/200/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/26444", "source": "cve@mitre.org"}, {"url": "http://www.trapkit.de/advisories/TKADV2007-001.txt", "source": "cve@mitre.org"}, {"url": "http://www.us-cert.gov/cas/techalerts/TA07-319A.html", "source": "cve@mitre.org", "tags": ["US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2007/3868", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/38470", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2007-4686 - This is an example of a Local File Inclusion (LFI) vulnerability, which is a type of Web Application Security (WAS) attack. The ttioctl function in the bsd/kern/tty.c file in the xnu kernel in Apple Mac OS X 10.4 through 10.4.10 allows local users to cause a denial of service (system shutdown) or gain privileges via a crafted TIOCSETD ioctl request."}, {"techniqueID": "T1035", "comment": "CVE-2007-4686 - This is an example of a command injection vulnerability, which allows an attacker to inject malicious commands that can be executed by the system. This vulnerability can be exploited to elevate privileges or gain unauthorized access to system resources."}, {"techniqueID": "T1024", "comment": "CVE-2007-4686 - This is an example of a system shutdown or restart vulnerability. The vulnerability allows an attacker to cause a system crash or restart, which can be used to disrupt the normal operation of the system."}], "stix_bundle": {"@stix2-1.0.0": {"bundle": {"type": "bundle", "id": "bundle---1", "created_by_ref": "https://www.example.com/stix-example.rdf#profile", "modified": "2021-09-08T15:00:00.000", "objects": [{"id": "attack-pattern---1", "type": "attack-pattern", "name": "CVE-2007-4686 - Local File Inclusion", "description": "This is an example of a Local File Inclusion (LFI) vulnerability, which is a type of Web Application Security (WAS) attack."}, {"id": "vulnerability---1", "type": "vulnerability", "name": "CVE-2007-4686 - Apple Mac OS X xnu kernel ttioctl function", "description": "The ttioctl function in the bsd/kern/tty.c file in the xnu kernel in Apple Mac OS X 10.4 through 10.4.10 allows local users to cause a denial of service (system shutdown) or gain privileges via a crafted TIOCSETD ioctl request."}, {"id": "course-of-action---1", "type": "course-of-action", "name": "Apply patch", "description": "Apply the patch provided by Apple to fix the vulnerability."}, {"id": "incident---1", "type": "incident", "name": "CVE-2007-4686 Incident", "description": "An incident resulting from the exploitation of the CVE-2007-4686 vulnerability."}], "relationships": [{"type": "was-generated-by", "source_ref": "vulnerability---1", "target_ref": "attack-pattern---1", "label": "related", "description": "The exploitation of the vulnerability is related to the attack pattern."}, {"type": "was-affected-by", "source_ref": "incident---1", "target_ref": "vulnerability---1", "label": "related", "description": "The incident was affected by the vulnerability."}, {"type": "is-implemented-by", "source_ref": "course-of-action---1", "target_ref": "patch---1", "label": "associated", "description": "The course of action is associated with the patch that is designed to fix the vulnerability."}]}}}, "technical_analysis": {"Introduction": "CVE-2007-4686 is a Local File Inclusion (LFI) vulnerability in the ttioctl function of the bsd/kern/tty.c file in the xnu kernel in Apple Mac OS X 10.4 through 10.4.10. An attacker can exploit this vulnerability to cause a denial of service (system shutdown) or gain privileges by sending a crafted TIOCSETD ioctl request.", "Impact and Scope": "The impact of this vulnerability is a denial of service (system shutdown) or unauthorized access to system resources. The scope of this vulnerability is limited to Apple Mac OS X 10.4 through 10.4.10.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1190, T1035, and T1024.", "Technical Details": "The vulnerability is caused by a signedness error in the ttioctl function, which can be exploited by sending a crafted TIOCSETD ioctl request.", "Detection": "Detection methods for this vulnerability include monitoring system logs for suspicious activity and using network traffic analysis tools to detect unauthorized access to system resources.", "Mitigation": "Mitigating this vulnerability involves applying the patch provided by Apple and implementing appropriate access controls and monitoring tools.", "Conclusion": "In conclusion, CVE-2007-4686 is a significant vulnerability that can be exploited to cause a denial of service (system shutdown) or gain unauthorized access to system resources. Proper detection and mitigation strategies are key to preventing the exploitation of this vulnerability."}, "executive_analysis": {"Overview": "CVE-2007-4686 is a Local File Inclusion (LFI) vulnerability in Apple Mac OS X 10.4 through 10.4.10 that can be exploited to cause a denial of service (system shutdown) or gain unauthorized access to system resources.", "Business Impact": "The business impact of this vulnerability is significant, as it can cause system downtime and data breaches.", "Technical Impact": "The technical impact of this vulnerability is a denial of service (system shutdown) or unauthorized access to system resources.", "Mitigation Strategies": "Mitigation strategies include applying the patch provided by Apple and implementing appropriate access controls and monitoring tools.", "Recommendations": "Recommendations for executives include prioritizing patching and vulnerability management, as well as implementing additional security controls and monitoring tools.", "Conclusions": "In conclusion, CVE-2007-4686 is a significant vulnerability that requires immediate attention and action to prevent exploitation."}}