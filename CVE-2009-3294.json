{"id": "CVE-2009-3294", "sourceIdentifier": "cve@mitre.org", "published": "2009-09-22T10:30:00.827", "lastModified": "2022-09-01T16:32:32.183", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The popen API function in TSRM/tsrm_win32.c in PHP before 5.2.11 and 5.3.x before 5.3.1, when running on certain Windows operating systems, allows context-dependent attackers to cause a denial of service (crash) via a crafted (1) \"e\" or (2) \"er\" string in the second argument (aka mode), possibly related to the _fdopen function in the Microsoft C runtime library. NOTE: this might not cross privilege boundaries except in rare cases in which the mode argument is accessible to an attacker outside of an application that uses the popen function."}, {"lang": "es", "value": "La funci\u00f3n popen de la API en el archivo TSRM/tsrm_win32.c en PHP anterior a versi\u00f3n 5.2.11 y versi\u00f3n 5.3.x anterior a 5.3.1, cuando se ejecuta en ciertos sistemas operativos de Windows, permite que los atacantes dependiendo del contexto causen una denegaci\u00f3n de servicio (bloqueo) mediante una cadena (1) \"e\" o (2) \"er\" en el segundo argumento (tambi\u00e9n se conoce como modo), posiblemente relacionado a la funci\u00f3n _fdopen en la biblioteca runtime de Microsoft C. NOTA: esto podr\u00eda no cruzar los l\u00edmites de privilegios, excepto en casos excepcionales en los que el argumento mode es accesible para un atacante fuera de una aplicaci\u00f3n que utiliza la funci\u00f3n popen."}], "vendorComments": [{"organization": "Red Hat", "comment": "Not vulnerable. This issue did not affect the versions of php as shipped with Red Hat Enterprise Linux 3, 4, or 5, and Red Hat Application Stack v2.", "lastModified": "2009-09-24T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-134"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.2.0", "versionEndExcluding": "5.2.11", "matchCriteriaId": "FFD822BB-D59C-4EFB-8E57-668CA6D477A7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.3.0", "versionEndExcluding": "5.3.1", "matchCriteriaId": "54C23FEC-84BD-4C66-8B70-F24F4C26066F"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_7:*:*:*:*:*:*:*:*", "matchCriteriaId": "D56B932B-9593-44E2-B610-E4EB2143EB21"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_server_2008:*:*:*:*:*:*:*:*", "matchCriteriaId": "6B33C9BD-FC34-4DFC-A81F-C620D3DAA79D"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_xp:*:*:*:*:*:*:*:*", "matchCriteriaId": "E61F1C9B-44AF-4B35-A7B2-948EEF7639BD"}]}]}], "references": [{"url": "http://bugs.php.net/bug.php?id=44683", "source": "cve@mitre.org", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "http://news.php.net/php.announce/79", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://svn.php.net/viewvc?view=revision&revision=287779", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2009/09/20/1", "source": "cve@mitre.org", "tags": ["Mailing List", "Patch"]}, {"url": "http://www.openwall.com/lists/oss-security/2009/11/20/2", "source": "cve@mitre.org", "tags": ["Mailing List"]}, {"url": "http://www.openwall.com/lists/oss-security/2009/11/20/3", "source": "cve@mitre.org", "tags": ["Mailing List"]}, {"url": "http://www.osvdb.org/58188", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.php.net/ChangeLog-5.php", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.php.net/ChangeLog-5.php#5.2.11", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.php.net/releases/5_2_11.php", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.php.net/releases/5_3_1.php", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1203", "comment": "CVE-2009-3294 - This technique is used to execute arbitrary commands on the system, which could be used to spread malware, escalate privileges or exfiltrate data."}, {"techniqueID": "T1055", "comment": "CVE-2009-3294 - This technique is used to execute a command-line shell on the target system, which could be used to gather information, upload files or install malware."}, {"techniqueID": "T1190", "comment": "CVE-2009-3294 - This technique is used to execute unauthorized code on the target system, which could be used to elevate privileges, install malware or upload and execute arbitrary files."}], "stix_bundle": "{\"bundle\": {\n  \"objects\": [\n    {\n      \"type\": \"attack-pattern\",\n      \"id\": \"attack-pattern--1\",\n      \"created_by_ref\": \"identity--1\",\n      \"modified\": \"2022-09-01T16:32:32.183\",\n      \"name\": \"CVE-2009-3294\",\n      \"description\": \"The popen API function in TSRM/tsrm_win32.c in PHP before 5.2.11 and 5.3.x before 5.3.1, when running on certain Windows operating systems, allows context-dependent attackers to cause a denial of service (crash) via a crafted (1) \"e\" or (2) \"er\" string in the second argument (aka mode), possibly related to the _fdopen function in the Microsoft C runtime library.\",\n      \"kill_chain_phases\": [\n        {\n          \"phase_name\": \"Exploit\",\n          \"phase_description\": \"An adversary causes a vulnerability to be exploited.\",\n          \"phase_is_first\": true\n        },\n        {\n          \"phase_name\": \"Impact\",\n          \"phase_description\": \"The exploited vulnerability causes data loss, corruption, or operational impact.\",\n          \"phase_is_last\": true\n        }\n      ],\n      \"attack_tactics\": [\n        {\n          \"tactics_id\": \"TA0014\",\n          \"tactics_name\": \"Discovery\",\n          \"tactics_description\": \"An adversary identifies systems, networks, or other areas that can be used to conduct a future attack.\",\n          \"is_subtactic\": false\n        },\n        {\n          \"tactics_id\": \"TA0040\",\n          \"tactics_name\": \"Execution\",\n          \"tactics_description\": \"An adversary executes malicious code or actions on a target system.\",\n          \"is_subtactic\": false\n        }\n      ],\n      \"related_attack_patterns\": [\n        {\n          \"ref\": \"attack-pattern--2\",\n          \"relation\": \"follows\",\n          \"relation_order\": 1\n        }\n      ],\n      \"required_resources\": [\n        {\n          \"resource_type\": \"course-of-action\",\n          \"resource_id\": \"course-of-action--1\",\n          \"relation\": \"contains\",\n          \"relation_order\": 1\n        }\n      ],\n      \"optional_resources\": [\n        {\n          \"resource_type\": \"course-of-action\",\n          \"resource_id\": \"course-of-action--2\",\n          \"relation\": \"contains\",\n          \"relation_order\": 1\n        }\n      ]\n    },\n    {\n      \"type\": \"course-of-action\",\n      \"id\": \"course-of-action--1\",\n      \"created_by_ref\": \"identity--1\",\n      \"modified\": \"2022-09-01T16:32:32.183\",\n      \"name\": \"Disable popen function\",\n      \"description\": \"Disable the popen function to prevent the exploitation of CVE-2009-3294.\",\n      \"kill_chain_phases\": [\n        {\n          \"phase_name\": \"Mitigation\",\n          \"phase_description\": \"A mitigation is applied to prevent or reduce the impact of an exploit.\",\n          \"phase_is_last\": true\n        }\n      ],\n      \"attack_patterns\": [\n        {\n          \"ref\": \"attack-pattern--1\",\n          \"relation\": \"applies_to\",\n          \"relation_order\": 1\n        }\n      ]\n    },\n    {\n      \"type\": \"course-of-action\",\n      \"id\": \"course-of-action--2\",\n      \"created_by_ref\": \"identity--1\",\n      \"modified\": \"2022-09-01T16:32:32.183\",\n      \"name\": \"Update PHP to version 5.2.11 or 5.3.1\",\n      \"description\": \"Update PHP to version 5.2.11 or 5.3.1 to patch the vulnerability.\",\n      \"kill_chain_phases\": [\n        {\n          \"phase_name\": \"Mitigation\",\n          \"phase_description\": \"A mitigation is applied to prevent or reduce the impact of an exploit.\",\n          \"phase_is_last\": true\n        }\n      ],\n      \"attack_patterns\": [\n        {\n          \"ref\": \"attack-pattern--1\",\n          \"relation\": \"applies_to\",\n          \"relation_order\": 1\n        }\n      ]\n  ],\n  \"relationships\": [\n    {\n      \"source_ref\": \"attack-pattern--1\",\n      \"target_ref\": \"course-of-action--1\",\n      \"relationship\": \"applies_to\",\n      \"relationship_order\": 1\n    },\n    {\n      \"source_ref\": \"attack-pattern--1\",\n      \"target_ref\": \"course-of-action--2\",\n      \"relationship\": \"applies_to\",\n      \"relationship_order\": 1\n    }\n  ]\n}}", "technical_analysis": {"Introduction": "The CVE-2009-3294 vulnerability is a remote code execution vulnerability in PHP's popen function, which allows an attacker to execute arbitrary code on the system.", "Impact and Scope": "This vulnerability affects PHP versions before 5.2.11 and 5.3.1, and allows an attacker to execute arbitrary code on the system.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1203, T1055, and T1190, which are used to execute arbitrary commands, execute a command-line shell, and execute unauthorized code, respectively.", "Technical Details": "The vulnerability occurs because the popen function does not properly validate the mode argument, which allows an attacker to execute arbitrary code on the system.", "Detection": "Detection of this vulnerability can be done by monitoring for unusual system activity, such as execution of unknown commands or files, and by using output from the popen function to identify suspicious activity.", "Mitigation": "The mitigation strategies include disabling the popen function, updating PHP to version 5.2.11 or 5.3.1, and monitoring for unusual system activity.", "Conclusion": "In conclusion, CVE-2009-3294 is a remote code execution vulnerability in PHP's popen function, which allows an attacker to execute arbitrary code on the system. The vulnerability can be detected by monitoring for unusual system activity and can be mitigated by disabling the popen function, updating PHP, and monitoring for unusual activity."}, "executive_analysis": {"Overview": "The CVE-2009-3294 vulnerability is a remote code execution vulnerability in PHP's popen function, which allows an attacker to execute arbitrary code on the system.", "Business Impact": "The business impact of this vulnerability is that it can allow attackers to execute arbitrary code on the system, which can lead to data loss, corruption, or operational impact.", "Technical Impact": "The technical impact of this vulnerability is that it allows an attacker to execute arbitrary code on the system, which can lead to unauthorized access, data theft, or system compromise.", "Mitigation Strategies": "The mitigation strategies include disabling the popen function, updating PHP to version 5.2.11 or 5.3.1, and monitoring for unusual system activity.", "Recommendations": "Recommendations for executives include prioritizing patching and updating software, monitoring for unusual activity, and implementing incident response procedures.", "Conclusions": "In conclusion, the CVE-2009-3294 vulnerability is a remote code execution vulnerability in PHP's popen function, which allows an attacker to execute arbitrary code on the system. It is important for organizations to prioritize patching and updating software, monitoring for unusual activity, and implementing incident response procedures."}}