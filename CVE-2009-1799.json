{"id": "CVE-2009-1799", "sourceIdentifier": "cve@mitre.org", "published": "2009-05-28T14:30:00.313", "lastModified": "2017-09-29T01:34:34.123", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple SQL injection vulnerabilities in the getGalleryImage function in st_admin/gallery_output.php in ST-Gallery 0.1 alpha, when magic_quotes_gpc is disabled, allow remote attackers to execute arbitrary SQL commands via the (1) gallery_category or (2) gallery_show parameter to example.php."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de inyecci\u00f3n SQL en la funci\u00f3n getGalleryImage en st_admin/gallery_output.php en ST-Gallery 0.1 alpha, cuando magic_quotes_gpc est\u00e1 deshabilitado, permiten a atacantes remotos ejecutar comandos SQL de su elecci\u00f3n a trav\u00e9s de los par\u00e1metros (1) gallery_category o (2) gallery_show para example.php."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sebastian-thiele:st-gallery:0.1_alpha:*:*:*:*:*:*:*", "matchCriteriaId": "0D52278C-53A6-464D-85B4-771FCEC201FE"}]}]}], "references": [{"url": "http://marc.info/?l=bugtraq&m=124171333011782&w=2", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.securityfocus.com/bid/34875", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/50378", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/8636", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2009-1799 - SQL Injection vulnerability allows attackers to execute arbitrary SQL commands. This technique is relevant as it can be used to compromise sensitive data. Defend against by implementing proper input validation and sanitization."}, {"techniqueID": "T1534", "comment": "CVE-2009-1799 - If not patched, an attacker can exploit this vulnerability to execute arbitrary SQL commands. This technique is relevant as it can be used to create a backdoor. Defend against by implementing a timely patch and configuring web application firewalls."}, {"techniqueID": "T1190", "comment": "CVE-2009-1799 - An attacker can exploit this vulnerability to inject malicious data into the database. This technique is relevant as it can be used to create a persistence mechanism. Defend against by monitoring database queries and implementing logging."}], "stix_bundle": {"stix_Bundle": {"bundle_id": "test_bundle", "bundle_name": "CVE-2009-1799 analysis", "bundle_version": "1.0", "objects": [{"type": "vulnerability", "id": "vuln-CVE-2009-1799", "name": "CVE-2009-1799: SQL Injection in ST-Gallery", "description": "SQL Injection vulnerability in ST-Gallery 0.1 alpha allowing remote attackers to execute arbitrary SQL commands."}, {"type": "indicator", "id": "ind-1", "name": "Indicating IP addresses", "description": "Indicating IP addresses attempting to exploit CVE-2009-1799", "pattern": "Destination Port: 80, Protocol: TCP, Source IP: [1.1.1.1-1.1.1.100]"}, {"type": "course-of-action", "id": "c-o-a-1", "name": "Patch Application", "description": "Applying the patch to ST-Gallery 0.1 alpha", "techniques": [{"technique_id": "T1065", "technique_name": "Exploitation of Public-Facing Application"}]}, {"type": "course-of-action", "id": "c-o-a-2", "name": "WAF Configuration", "description": "Configuring web application firewall to detect and prevent exploitation attempts", "techniques": [{"technique_id": "T1190", "technique_name": "Exploitation of Public-Facing Application"}]}], "relationships": [{"relationship_id": "r-1", "source_id": "vuln-CVE-2009-1799", "source_type": "vulnerability", "target_id": "ind-1", "target_type": "indicator", "relationship_type": "indicated_by"}, {"relationship_id": "r-2", "source_id": "vuln-CVE-2009-1799", "source_type": "vulnerability", "target_id": "c-o-a-1", "target_type": "course-of-action", "relationship_type": "mitigates"}, {"relationship_id": "r-3", "source_id": "vuln-CVE-2009-1799", "source_type": "vulnerability", "target_id": "c-o-a-2", "target_type": "course-of-action", "relationship_type": "mitigates"}]}}, "technical_analysis": {"Introduction": "SQL Injection vulnerability in ST-Gallery 0.1 alpha allows remote attackers to execute arbitrary SQL commands. This vulnerability is due to the lack of proper input validation and sanitization on the gallery_image function in st_admin/gallery_output.php.", "Impact and Scope": "The impact of this vulnerability is the potential to execute arbitrary SQL commands, which can lead to data manipulation, data destruction, and unauthorized access to sensitive data. The scope of this vulnerability is limited to ST-Gallery 0.1 alpha.", "Related MITRE ATT&CK Techniques": "T1059: Command and Control", "Technical Details": "The vulnerability is an SQL Injection vulnerability in the getGalleryImage function in st_admin/gallery_output.php. The function does not properly validate and sanitize user input, which allows an attacker to inject malicious SQL code.", "Detection": "Detection of this vulnerability may be difficult as it requires analyzing the web application request and monitoring for signs of malicious SQL code.", "Mitigation": "The recommended mitigation for this vulnerability is to apply the patch to ST-Gallery 0.1 alpha and to configure web application firewalls to detect and prevent exploitation attempts.", "Conclusion": "In conclusion, CVE-2009-1799 is an SQL Injection vulnerability in ST-Gallery 0.1 alpha that allows remote attackers to execute arbitrary SQL commands. The vulnerability is due to the lack of proper input validation and sanitization on the gallery_image function in st_admin/gallery_output.php."}, "executive_analysis": {"Overview": "CVE-2009-1799 is an SQL Injection vulnerability in ST-Gallery 0.1 alpha that allows remote attackers to execute arbitrary SQL commands.", "Business Impact": "The business impact of this vulnerability is the potential for data manipulation, data destruction, and unauthorized access to sensitive data.", "Technical Impact": "The technical impact of this vulnerability is the potential for exploitation and the requirement for timely patching and configuration of web application firewalls.", "Mitigation Strategies": "The recommended mitigation strategies for this vulnerability are to apply the patch to ST-Gallery 0.1 alpha and to configure web application firewalls to detect and prevent exploitation attempts.", "Recommendations": "The recommended action for executives is to prioritize the patch application and configuration of web application firewalls to minimize the risk of exploitation.", "Conclusions": "In conclusion, CVE-2009-1799 poses a moderate risk to the organization and requires immediate attention to mitigate the vulnerability."}}