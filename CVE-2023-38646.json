{"id": "CVE-2023-38646", "sourceIdentifier": "cve@mitre.org", "published": "2023-07-21T15:15:10.003", "lastModified": "2024-02-15T16:15:45.380", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation. The other fixed versions are 0.45.4.1, 1.45.4.1, 0.44.7.1, 1.44.7.1, 0.43.7.2, and 1.43.7.2."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionEndExcluding": "0.43.7.2", "matchCriteriaId": "5AE3BE02-E7B9-43CB-8FBA-001F5D8E24ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionEndExcluding": "1.43.7.2", "matchCriteriaId": "6591576F-15AC-493F-96B4-6F3E1E5D1350"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.44.0", "versionEndExcluding": "0.44.7.1", "matchCriteriaId": "90CEC6C0-C2EE-496D-BBE0-DBC83717F211"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.45.0", "versionEndExcluding": "0.45.4.1", "matchCriteriaId": "EC4D0A9A-F084-403A-83BF-F1C56470B845"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.46.0", "versionEndExcluding": "0.46.6.1", "matchCriteriaId": "BEA5EEF8-7F70-4D40-9EB6-8BB5226E281E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.44.0", "versionEndExcluding": "1.44.7.1", "matchCriteriaId": "825F5E14-49FC-4A8A-87FE-FA039D121F99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.45.0", "versionEndExcluding": "1.45.4.1", "matchCriteriaId": "C20D76CF-15B4-49C3-8F3A-8417B5C8016B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.46.0", "versionEndExcluding": "1.46.6.1", "matchCriteriaId": "47767C52-13CC-4164-84DC-54E3BDC1C590"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/174091/Metabase-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "http://packetstormsecurity.com/files/177138/Metabase-0.46.6-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "https://github.com/metabase/metabase/issues/32552", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://github.com/metabase/metabase/releases/tag/v0.46.6.1", "source": "cve@mitre.org", "tags": ["Release Notes"]}, {"url": "https://news.ycombinator.com/item?id=36812256", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://www.metabase.com/blog/security-advisory", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210 - Exploitation of Remote Services", "comment": "CVE-2023-38646 is a remote code execution vulnerability in Metabase. An attacker can exploit this vulnerability by sending a malicious HTTP request to the Metabase server. This technique is relevant as it allows for exploitation of the vulnerability and can be mitigated by implementing proper input validation and sanitization."}, {"techniqueID": "T1077 - Windows Service Execution", "comment": "This technique is related to the exploitation of the vulnerability, as an attacker can use Windows Service Execution to execute arbitrary code on the target system."}, {"techniqueID": "T1190 - Exploitation of Authentication Mechanism", "comment": "This technique is also relevant to the exploitation of the vulnerability, as authentication is not required for exploitation."}, {"techniqueID": "T1195 - Defense Evasion \u2013 Modified System Settings", "comment": "This technique is relevant as it allows an attacker to evade detection by modifying system settings, making it difficult to detect the exploitation of the vulnerability."}, {"techniqueID": "T1078 - Exploitation of Remote Services - Other", "comment": "This technique is relevant as it allows for exploitation of the vulnerability using other remote services, not just HTTP requests."}], "stix_bundle": "{\"bundle\": {\"type\": \"stix bundles\",\"description\": \"METABASE CVE-2023-38646\",\"objects\": [{\"type\": \"reported-vulnerability\",\"id\": \"reported-vulnerability-1\",\"created_by_ref\": \"identity-1\",\"created\": \"2023-07-21T15:15:10.003\",\"modified\": \"2023-07-21T15:15:10.003\",\"name\": \"Metabase CVE-2023-38646\",\"description\": \"Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation.\",\"vuln_status\": \"Modified\",\"cve\": \"CVE-2023-38646\",\"published\": \"2023-07-21T15:15:10.003\",\"last_modified\": \"2024-02-15T16:15:45.380\",\"severity\": \"CRITICAL\"},{\"type\": \"indicator\",\"id\": \"indicator-1\",\"created_by_ref\": \"identity-1\",\"created\": \"2023-07-21T15:15:10.003\",\"modified\": \"2023-07-21T15:15:10.003\",\"name\": \"Metabase CVE-2023-38646 Indicator\",\"description\": \"Indicator for Metabase CVE-2023-38646\",\"pattern_language\": \"Sguil\",\"pattern\": \"Metabase CVE-2023-38646\"},{\"type\": \"campaign\",\"id\": \"campaign-1\",\"created_by_ref\": \"identity-1\",\"created\": \"2023-07-21T15:15:10.003\",\"modified\": \"2023-07-21T15:15:10.003\",\"name\": \"Metabase CVE-2023-38646 Campaign\",\"description\": \"Campaign for Metabase CVE-2023-38646\"},{\"type\": \"course-of-action\",\"id\": \"course-of-action-1\",\"created_by_ref\": \"identity-1\",\"created\": \"2023-07-21T15:15:10.003\",\"modified\": \"2023-07-21T15:15:10.003\",\"name\": \"Metabase CVE-2023-38646 Mitigation\",\"description\": \"Mitigation for Metabase CVE-2023-38646\",\"course_of_action_type\": \"mitigation\"},{\"type\": \"course-of-action\",\"id\": \"course-of-action-2\",\"created_by_ref\": \"identity-1\",\"created\": \"2023-07-21T15:15:10.003\",\"modified\": \"2023-07-21T15:15:10.003\",\"name\": \"Metabase CVE-2023-38646 Detection\",\"description\": \"Detection for Metabase CVE-2023-38646\",\"course_of_action_type\": \"detection\"}]}}", "technical_analysis": {"Introduction": "Metabase CVE-2023-38646 is a remote code execution vulnerability that allows attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation.", "Impact and Scope": "This vulnerability affects Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1. The impact is a potential remote code execution, allowing an attacker to execute arbitrary commands on the server.", "Related MITRE ATT&CK Techniques": "T1210 - Exploitation of Remote Services, T1077 - Windows Service Execution, T1190 - Exploitation of Authentication Mechanism, T1195 - Defense Evasion \u2013 Modified System Settings, T1078 - Exploitation of Remote Services - Other", "Technical Details": "The vulnerability is due to the lack of input validation and sanitization in Metabase, allowing attackers to send malicious HTTP requests and execute arbitrary code.", "Detection": "Detection can be done by monitoring for unusual HTTP traffic and applying security patches.", "Mitigation": "Mitigation strategies include applying security patches, implementing input validation and sanitization, and monitoring for unusual HTTP traffic.", "Conclusion": "In conclusion, the Metabase CVE-2023-38646 vulnerability is a significant threat and requires immediate attention to mitigate."}, "executive_analysis": {"Overview": "The Metabase CVE-2023-38646 vulnerability is a critical vulnerability that can allow remote code execution without authentication.", "Business Impact": "The business impact of this vulnerability is significant, as it can allow attackers to execute arbitrary code on the server, potentially leading to data breaches or compromise of sensitive information.", "Technical Impact": "The technical impact is the remote code execution, allowing an attacker to execute arbitrary commands on the server, at the server's privilege level.", "Mitigation Strategies": "Applying security patches and implementing input validation and sanitization are critical mitigation strategies.", "Recommendations": "Recommendations include applying security patches, implementing input validation and sanitization, and monitoring for unusual HTTP traffic.", "Conclusions": "In conclusion, the Metabase CVE-2023-38646 vulnerability requires immediate attention and action to mitigate the risk of exploitation."}}