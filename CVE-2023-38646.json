{"id": "CVE-2023-38646", "sourceIdentifier": "cve@mitre.org", "published": "2023-07-21T15:15:10.003", "lastModified": "2024-02-15T16:15:45.380", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation. The other fixed versions are 0.45.4.1, 1.45.4.1, 0.44.7.1, 1.44.7.1, 0.43.7.2, and 1.43.7.2."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionEndExcluding": "0.43.7.2", "matchCriteriaId": "5AE3BE02-E7B9-43CB-8FBA-001F5D8E24ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionEndExcluding": "1.43.7.2", "matchCriteriaId": "6591576F-15AC-493F-96B4-6F3E1E5D1350"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.44.0", "versionEndExcluding": "0.44.7.1", "matchCriteriaId": "90CEC6C0-C2EE-496D-BBE0-DBC83717F211"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.45.0", "versionEndExcluding": "0.45.4.1", "matchCriteriaId": "EC4D0A9A-F084-403A-83BF-F1C56470B845"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.46.0", "versionEndExcluding": "0.46.6.1", "matchCriteriaId": "BEA5EEF8-7F70-4D40-9EB6-8BB5226E281E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.44.0", "versionEndExcluding": "1.44.7.1", "matchCriteriaId": "825F5E14-49FC-4A8A-87FE-FA039D121F99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.45.0", "versionEndExcluding": "1.45.4.1", "matchCriteriaId": "C20D76CF-15B4-49C3-8F3A-8417B5C8016B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.46.0", "versionEndExcluding": "1.46.6.1", "matchCriteriaId": "47767C52-13CC-4164-84DC-54E3BDC1C590"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/174091/Metabase-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "http://packetstormsecurity.com/files/177138/Metabase-0.46.6-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "https://github.com/metabase/metabase/issues/32552", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://github.com/metabase/metabase/releases/tag/v0.46.6.1", "source": "cve@mitre.org", "tags": ["Release Notes"]}, {"url": "https://news.ycombinator.com/item?id=36812256", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://www.metabase.com/blog/security-advisory", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210 - Exploitation of Remote Services", "comment": "CVE-2023-38646 - This technique is relevant as the vulnerability allows attackers to execute arbitrary commands on the server, which is a common attack vector for remote exploitation."}, {"techniqueID": "T1190 - Remote File Copy", "comment": "CVE-2023-38646 - This technique is relevant as the vulnerability allows attackers to execute arbitrary commands on the server, which could potentially allow them to copy files remotely."}, {"techniqueID": "T1056 - Network Service Scanning", "comment": "CVE-2023-38646 - This technique is relevant as the vulnerability allows attackers to exploit the Metabase server, which could potentially allow them to scan the network for other vulnerable systems."}, {"techniqueID": "T1086 - File and Directory Discovery", "comment": "CVE-2023-38646 - This technique is relevant as the vulnerability allows attackers to execute arbitrary commands on the server, which could potentially allow them to discover files and directories on the system."}, {"techniqueID": "T1078 - Net Badge Authentication", "comment": "CVE-2023-38646 - This technique is relevant as the vulnerability does not require authentication for exploitation, making it a high-risk vulnerability."}, {"techniqueID": "T1003 - Rootkit", "comment": "CVE-2023-38646 - This technique is relevant as the vulnerability allows attackers to execute arbitrary commands on the server, which could potentially allow them to install a rootkit."}], "technical_analysis": {"Introduction": "CVE-2023-38646 is a remote code execution vulnerability in Metabase, an open-source business intelligence platform. The vulnerability allows attackers to execute arbitrary commands on the server, at the server's privilege level.", "Impact and Scope": "The vulnerability has a CVSS score of 9.8, making it a critical vulnerability. The attack vector is network-based, and no authentication is required for exploitation.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including T1210, T1190, T1056, T1086, T1078, and T1003.", "Technical Details": "The vulnerability is caused by a lack of input validation and sanitization in the Metabase server. Attackers can exploit this vulnerability by sending a malicious request to the Metabase server, which will execute the request and allow attackers to execute arbitrary commands.", "Detection": "Detecting this vulnerability requires monitoring network traffic and system logs for suspicious activity. Tools such as intrusion detection systems and system monitoring software can help detect and alert on potential attacks.", "Mitigation": "The best mitigation strategy is to apply the provided patches and updates to the vulnerable Metabase server. Additionally, implementing a web application firewall (WAF) and intrusion detection system can help detect and block potential attacks.", "Conclusion": "CVE-2023-38646 is a critical vulnerability that allows attackers to execute arbitrary commands on the server, at the server's privilege level. It is essential to apply the provided patches and updates, implement a WAF and IDS, and monitor network traffic and system logs for suspicious activity."}, "executive_analysis": {"Overview": "CVE-2023-38646 is a critical vulnerability in Metabase that allows attackers to execute arbitrary commands on the server, at the server's privilege level.", "Business Impact": "The vulnerability could allow attackers to access sensitive data, compromise the confidentiality and integrity of the system, and disrupt business operations.", "Technical Impact": "The vulnerability requires immediate attention and patching to prevent exploitation. Failure to patch the vulnerability could result in data breaches, system compromise, and business disruption.", "Mitigation Strategies": "The mitigation strategy includes patching the vulnerability, implementing a WAF and IDS, and monitoring network traffic and system logs for suspicious activity.", "Recommendations": "Executives should prioritize patching the vulnerability and implementing the recommended mitigation strategies to minimize the risk of exploitation.", "Conclusions": "CVE-2023-38646 is a critical vulnerability that requires immediate attention and patching. Executives should prioritize mitigation and monitoring to minimize the risk of exploitation."}}