{"id": "CVE-2023-38646", "sourceIdentifier": "cve@mitre.org", "published": "2023-07-21T15:15:10.003", "lastModified": "2024-02-15T16:15:45.380", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation. The other fixed versions are 0.45.4.1, 1.45.4.1, 0.44.7.1, 1.44.7.1, 0.43.7.2, and 1.43.7.2."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionEndExcluding": "0.43.7.2", "matchCriteriaId": "5AE3BE02-E7B9-43CB-8FBA-001F5D8E24ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionEndExcluding": "1.43.7.2", "matchCriteriaId": "6591576F-15AC-493F-96B4-6F3E1E5D1350"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.44.0", "versionEndExcluding": "0.44.7.1", "matchCriteriaId": "90CEC6C0-C2EE-496D-BBE0-DBC83717F211"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.45.0", "versionEndExcluding": "0.45.4.1", "matchCriteriaId": "EC4D0A9A-F084-403A-83BF-F1C56470B845"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.46.0", "versionEndExcluding": "0.46.6.1", "matchCriteriaId": "BEA5EEF8-7F70-4D40-9EB6-8BB5226E281E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.44.0", "versionEndExcluding": "1.44.7.1", "matchCriteriaId": "825F5E14-49FC-4A8A-87FE-FA039D121F99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.45.0", "versionEndExcluding": "1.45.4.1", "matchCriteriaId": "C20D76CF-15B4-49C3-8F3A-8417B5C8016B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.46.0", "versionEndExcluding": "1.46.6.1", "matchCriteriaId": "47767C52-13CC-4164-84DC-54E3BDC1C590"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/174091/Metabase-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "http://packetstormsecurity.com/files/177138/Metabase-0.46.6-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "https://github.com/metabase/metabase/issues/32552", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://github.com/metabase/metabase/releases/tag/v0.46.6.1", "source": "cve@mitre.org", "tags": ["Release Notes"]}, {"url": "https://news.ycombinator.com/item?id=36812256", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://www.metabase.com/blog/security-advisory", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2023-38646 - Improper Input Validation in Metabase allows an attacker to execute arbitrary commands on the server, at the server's privilege level. Defending against this technique involves validating and sanitizing user input."}, {"techniqueID": "T1211", "comment": "CVE-2023-38646 - Injection of arbitrary commands in a Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allows an attacker to execute arbitrary commands on the server, at the server's privilege level. Defending against this technique involves validating and sanitizing user input."}, {"techniqueID": "T1218", "comment": "CVE-2023-38646 - Command and Scripting Interpreter in Metabase allows an attacker to execute arbitrary commands on the server, at the server's privilege level. Defending against this technique involves validating and sanitizing user input."}, {"techniqueID": "T1590", "comment": "CVE-2023-38646 - Execution with Unprivileged Deserialization in Metabase allows an attacker to execute arbitrary commands on the server, at the server's privilege level. Defending against this technique involves validating and sanitizing user input."}], "stix_bundle": {"@stix:Version": "2.1", "Bundle": {"ID": "bundle-1", "Label": "Metabase Remote Code Execution", "Created": "2023-07-21T15:15:10.003Z", "Updated": "2024-02-15T16:15:45.380Z", "Objects": [{"ItemType": "observed-data", "ID": "observed-data-1", "Created": "2023-07-21T15:15:10.003Z", "Updated": "2024-02-15T16:15:45.380Z", "Observable": {"x_openIOC": "CVE-2023-38646"}}, {"ItemType": "incident", "ID": "incident-1", "Created": "2023-07-21T15:15:10.003Z", "Updated": "2024-02-15T16:15:45.380Z", "Status": "active", "Context": {"type": "indicator", "id_ref": "indicator--1"}}, {"ItemType": "indicator", "ID": "indicator--1", "Created": "2023-07-21T15:15:10.003Z", "Updated": "2024-02-15T16:15:45.380Z", "Name": "Metabase Remote Code Execution", "Description": "Metabase Remote Code Execution", "Pattern": {"product": "Metabase", "version": "Before 0.46.6.1 and 1.46.6.1"}}, {"ItemType": "course-of-action", "ID": "course-of-action--1", "Created": "2023-07-21T15:15:10.003Z", "Updated": "2024-02-15T16:15:45.380Z", "Description": "Apply patches to Metabase to prevent remote code execution", "Mitigates": {"relationship": "mitigates", "id_ref": "technique-T1210"}}, {"ItemType": "technique", "ID": "technique-T1210", "Created": "2023-07-21T15:15:10.003Z", "Updated": "2024-02-15T16:15:45.380Z", "Name": "Command and Scripting Interpreter", "Description": "Command and Scripting Interpreter"}], "Relationships": [{"type": "has-part", "id refs": ["observed-data-1", "incident-1"]}]}}, "technical_analysis": {"Introduction": "Metabase Remote Code Execution allows an attacker to execute arbitrary commands on the server, at the server's privilege level.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to execute arbitrary commands on the server, at the server's privilege level. The scope of this vulnerability includes all versions of Metabase before 0.46.6.1 and 1.46.6.1.", "Related MITRE ATT&CK Techniques": "T1210, T1211, T1218, T1590", "Technical Details": "The vulnerability is due to the lack of input validation and sanitization in Metabase. An attacker can inject arbitrary commands into the Metabase server, which can be executed with the privileges of the Metabase user.", "Detection": "Detection of this vulnerability involves monitoring for unusual network activity and abnormal system behavior.", "Mitigation": "Mitigating this vulnerability involves updating Metabase to the latest version and enforcing strong authentication and authorization.", "Conclusion": "The Metabase Remote Code Execution vulnerability is a critical vulnerability that requires immediate attention and action."}, "executive_analysis": {"Overview": "The Metabase Remote Code Execution vulnerability is a critical vulnerability that allows an attacker to execute arbitrary commands on the server, at the server's privilege level.", "Business Impact": "The business impact of this vulnerability is significant, as it can allow an attacker to gain unauthorized access to sensitive data and systems.", "Technical Impact": "The technical impact of this vulnerability is high, as it can allow an attacker to execute arbitrary commands on the server, at the server's privilege level.", "Mitigation Strategies": "Updating Metabase to the latest version, enforcing strong authentication and authorization, and monitoring for unusual network activity and abnormal system behavior.", "Recommendations": "Apply patches to Metabase to prevent remote code execution, and conduct regular security testing and vulnerability assessments.", "Conclusions": "The Metabase Remote Code Execution vulnerability is a critical vulnerability that requires immediate attention and action."}}