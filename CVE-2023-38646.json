{"id": "CVE-2023-38646", "sourceIdentifier": "cve@mitre.org", "published": "2023-07-21T15:15:10.003", "lastModified": "2024-02-15T16:15:45.380", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation. The other fixed versions are 0.45.4.1, 1.45.4.1, 0.44.7.1, 1.44.7.1, 0.43.7.2, and 1.43.7.2."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionEndExcluding": "0.43.7.2", "matchCriteriaId": "5AE3BE02-E7B9-43CB-8FBA-001F5D8E24ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionEndExcluding": "1.43.7.2", "matchCriteriaId": "6591576F-15AC-493F-96B4-6F3E1E5D1350"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.44.0", "versionEndExcluding": "0.44.7.1", "matchCriteriaId": "90CEC6C0-C2EE-496D-BBE0-DBC83717F211"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.45.0", "versionEndExcluding": "0.45.4.1", "matchCriteriaId": "EC4D0A9A-F084-403A-83BF-F1C56470B845"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.46.0", "versionEndExcluding": "0.46.6.1", "matchCriteriaId": "BEA5EEF8-7F70-4D40-9EB6-8BB5226E281E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.44.0", "versionEndExcluding": "1.44.7.1", "matchCriteriaId": "825F5E14-49FC-4A8A-87FE-FA039D121F99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.45.0", "versionEndExcluding": "1.45.4.1", "matchCriteriaId": "C20D76CF-15B4-49C3-8F3A-8417B5C8016B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.46.0", "versionEndExcluding": "1.46.6.1", "matchCriteriaId": "47767C52-13CC-4164-84DC-54E3BDC1C590"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/174091/Metabase-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "http://packetstormsecurity.com/files/177138/Metabase-0.46.6-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "https://github.com/metabase/metabase/issues/32552", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://github.com/metabase/metabase/releases/tag/v0.46.6.1", "source": "cve@mitre.org", "tags": ["Release Notes"]}, {"url": "https://news.ycombinator.com/item?id=36812256", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://www.metabase.com/blog/security-advisory", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2023-38646 - Command and Scripting Interpreter (RCE) exploitation may lead to information disclosure, escalation of privileges, and denial-of-service. Defending against this vulnerability requires implementing proper input validation and sanitization for commands and scripts."}, {"techniqueID": "T1086", "comment": "CVE-2023-38646 - Exfiltration of data through command execution may be possible if an attacker can bypass authentications and gain access to the Metabase server. Implementing secure access controls and logging can help detect and prevent such attacks."}, {"techniqueID": "T1133", "comment": "CVE-2023-38646 - Impact assessments such as CVSS 3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H indicate high-level exploitation potential and severity. Implementing robust patch management and vulnerability scanning can help identify exploitation attempts."}], "stix_bundle": {"$schema": "https://example.com/stix2.1-schema.json", "type": "bundle", "id": "CVE-2023-38646-Bundle", "created_by_ref": "https://example.com/creator", "created": "2024-02-15T16:15:45.380", "modified": "2024-02-15T16:15:45.380", "objects": [{"type": "vulnerability", "id": "CVE-2023-38646", "name": "Metabase Remote Code Execution", "description": "Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation.", "exploit_maturity": "Diffused", "exploit_code_maturity": "Scriptable", "notes": [{"type": "note", "text": "The vulnerability can be exploited by sending a crafted request to the Metabase server."}]}, {"type": "command-execution", "id": "T1210_Observable", "name": "Command and Scripting Interpreter (RCE) exploit attempt", "description": "A command or script is executed on the Metabase server.", "spec_version": "2.1"}, {"type": "data-exfiltration", "id": "T1086_Observable", "name": "Data exfiltration through command execution", "description": "Data is exfiltrated from the Metabase server through command execution.", "spec_version": "2.1"}, {"type": "impact-assessment", "id": "T1133_Observable", "name": "Impact assessment", "description": "A command or script is executed on the Metabase server, indicating high-level exploitation potential and severity.", "spec_version": "2.1"}, {"type": "course-of-action", "id": "COA-1", "name": "Implement secure access controls and logging", "description": "Implementing secure access controls and logging can help detect and prevent data exfiltration attacks.", "tactic": "Mitigation", "technique": "T1086", "notes": [{"type": "note", "text": "Implementing secure access controls and logging can help detect and prevent data exfiltration attacks."}]}, {"type": "course-of-action", "id": "COA-2", "name": "Implement robust patch management and vulnerability scanning", "description": "Implementing robust patch management and vulnerability scanning can help identify exploitation attempts.", "tactic": "Mitigation", "technique": "T1133", "notes": [{"type": "note", "text": "Implementing robust patch management and vulnerability scanning can help identify exploitation attempts."}]}]}, "technical_analysis": {"Introduction": "CVE-2023-38646 is a remote code execution vulnerability in Metabase, a open-source data warehousing and business intelligence platform. The vulnerability allows an attacker to execute arbitrary commands on the server, at the server's privilege level.", "Impact and Scope": "The vulnerability has a high CVSS score of 9.8 and can lead to information disclosure, escalation of privileges, and denial-of-service. The attack vector is network-based and the privilege level of the attacker is none.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the following MITRE ATT&CK techniques: T1210, T1086, and T1133.", "Technical Details": "The vulnerability is caused by a command injection vulnerability in the Metabase server. An attacker can exploit this vulnerability by sending a crafted request to the Metabase server.", "Detection": "Detection of the vulnerability can be done using vulnerability scanning and patch management tools.", "Mitigation": "The recommended mitigation strategy is to implement secure access controls and logging, and to implement robust patch management and vulnerability scanning.", "Conclusion": "In conclusion, CVE-2023-38646 is a serious remote code execution vulnerability in Metabase, and it requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The vulnerability CVE-2023-38646 is a critical remote code execution flaw in Metabase, an open-source data warehousing and business intelligence platform.", "Business Impact": "The vulnerability has a significant impact on the business, as it allows an attacker to execute arbitrary commands on the server, at the server's privilege level.", "Technical Impact": "The vulnerability has a high technical impact as it can lead to information disclosure, escalation of privileges, and denial-of-service.", "Mitigation Strategies": "The recommended mitigation strategy is to implement secure access controls and logging, and to implement robust patch management and vulnerability scanning.", "Recommendations": "It is recommended to apply the patch as soon as possible, and to implement a robust vulnerability scanning and patch management plan.", "Conclusions": "In conclusion, the vulnerability CVE-2023-38646 is a critical security issue that requires immediate attention and mitigation."}}