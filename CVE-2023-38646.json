{"id": "CVE-2023-38646", "sourceIdentifier": "cve@mitre.org", "published": "2023-07-21T15:15:10.003", "lastModified": "2024-02-15T16:15:45.380", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation. The other fixed versions are 0.45.4.1, 1.45.4.1, 0.44.7.1, 1.44.7.1, 0.43.7.2, and 1.43.7.2."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionEndExcluding": "0.43.7.2", "matchCriteriaId": "5AE3BE02-E7B9-43CB-8FBA-001F5D8E24ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionEndExcluding": "1.43.7.2", "matchCriteriaId": "6591576F-15AC-493F-96B4-6F3E1E5D1350"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.44.0", "versionEndExcluding": "0.44.7.1", "matchCriteriaId": "90CEC6C0-C2EE-496D-BBE0-DBC83717F211"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.45.0", "versionEndExcluding": "0.45.4.1", "matchCriteriaId": "EC4D0A9A-F084-403A-83BF-F1C56470B845"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.46.0", "versionEndExcluding": "0.46.6.1", "matchCriteriaId": "BEA5EEF8-7F70-4D40-9EB6-8BB5226E281E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.44.0", "versionEndExcluding": "1.44.7.1", "matchCriteriaId": "825F5E14-49FC-4A8A-87FE-FA039D121F99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.45.0", "versionEndExcluding": "1.45.4.1", "matchCriteriaId": "C20D76CF-15B4-49C3-8F3A-8417B5C8016B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.46.0", "versionEndExcluding": "1.46.6.1", "matchCriteriaId": "47767C52-13CC-4164-84DC-54E3BDC1C590"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/174091/Metabase-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "http://packetstormsecurity.com/files/177138/Metabase-0.46.6-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "https://github.com/metabase/metabase/issues/32552", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://github.com/metabase/metabase/releases/tag/v0.46.6.1", "source": "cve@mitre.org", "tags": ["Release Notes"]}, {"url": "https://news.ycombinator.com/item?id=36812256", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://www.metabase.com/blog/security-advisory", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2023-38646 - Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation, allowing for common network exploitation of the CVE. This is relevant and can be exploited using various network exploitation techniques, and can be defended against by implementing strong access controls, auditing, and monitoring systems to detect and prevent malicious network activity."}, {"techniqueID": "T1204", "comment": "CVE-2023-38646 - The vulnerability allows attackers to execute arbitrary commands on the server, at the server's privilege level. This can be used to move laterally across the network and gain access to sensitive information and systems. This is relevant and can be exploited using various file manipulation techniques, and can be defended against by implementing strong file access controls, auditing, and monitoring systems to detect and prevent malicious file activity."}, {"techniqueID": "T1086", "comment": "CVE-2023-38646 - The vulnerability allows attackers to execute arbitrary commands on the server, at the server's privilege level. This can be used to achieve persistent presence on the network and elevate privileges. This is relevant and can be exploited using various command execution techniques, and can be defended against by implementing strong command execution controls, auditing, and monitoring systems to detect and prevent malicious command activity."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve-2023-38646.stix", "description": "STIX 2.1 bundle for CVE-2023-38646", "objects": [{"type": "indicator", "id": "https://example.com/cve-2023-38646-indicator", "name": "CVE-2023-38646 Indicator", "description": "Indicates the presence of CVE-2023-38646", "pattern": " Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. "}, {"type": "identity", "id": "https://example.com/cve-2023-38646-identity", "name": "CVE-2023-38646 Identity", "description": "Identifies the vulnerable Metabase version", "attributes": [{"name": "affected_version", "value": "Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1"}]}, {"type": "indicates", "id": "https://example.com/cve-2023-38646-relationship", "source_ref": "https://example.com/cve-2023-38646-indicator", "target_ref": "https://example.com/cve-2023-38646-identity"}]}, "technical_analysis": {"Introduction": "The CVE-2023-38646 vulnerability is a command injection vulnerability in Metabase, a popular open-source business intelligence platform.", "Impact and Scope": "The vulnerability allows attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation, making it a potential vector for initial access.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK T1190, T1204, and T1086, which involve command execution, file manipulation, and network exploitation.", "Technical Details": "The vulnerability is caused by a lack of input validation and sanitization in Metabase's command execution mechanism.", "Detection": "The vulnerability can be detected by monitoring for suspicious command execution activity and analyzing system logs for evidence of malicious activity.", "Mitigation": "The vulnerability can be mitigated by updating to the patched versions of Metabase, denying access to unknown users, and implementing strong access controls and monitoring systems.", "Conclusion": "In conclusion, the CVE-2023-38646 vulnerability is a serious security threat that can be exploited by attackers to gain unauthorized access to sensitive data and systems."}, "executive_analysis": {"Overview": "The CVE-2023-38646 vulnerability is a critical security flaw in Metabase that affects all versions prior to 0.46.6.1 and 1.46.6.1.", "Business Impact": "If left unpatched, the vulnerability can lead to significant financial losses and reputational damage.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary commands on the server, which can result in data breaches, lateral movement, and system compromise.", "Mitigation Strategies": "Updating to the patched versions of Metabase, denying access to unknown users, and implementing strong access controls and monitoring systems are recommended.", "Recommendations": "Executives should prioritize patching and upgrading Metabase installations, conducting regular security audits and risk assessments, and implementing incident response and disaster recovery plans.", "Conclusions": "In conclusion, the CVE-2023-38646 vulnerability is a critical security threat that requires immediate attention and action to mitigate."}}