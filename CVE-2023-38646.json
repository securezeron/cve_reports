{"id": "CVE-2023-38646", "sourceIdentifier": "cve@mitre.org", "published": "2023-07-21T15:15:10.003", "lastModified": "2024-02-15T16:15:45.380", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation. The other fixed versions are 0.45.4.1, 1.45.4.1, 0.44.7.1, 1.44.7.1, 0.43.7.2, and 1.43.7.2."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionEndExcluding": "0.43.7.2", "matchCriteriaId": "5AE3BE02-E7B9-43CB-8FBA-001F5D8E24ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionEndExcluding": "1.43.7.2", "matchCriteriaId": "6591576F-15AC-493F-96B4-6F3E1E5D1350"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.44.0", "versionEndExcluding": "0.44.7.1", "matchCriteriaId": "90CEC6C0-C2EE-496D-BBE0-DBC83717F211"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.45.0", "versionEndExcluding": "0.45.4.1", "matchCriteriaId": "EC4D0A9A-F084-403A-83BF-F1C56470B845"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.46.0", "versionEndExcluding": "0.46.6.1", "matchCriteriaId": "BEA5EEF8-7F70-4D40-9EB6-8BB5226E281E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.44.0", "versionEndExcluding": "1.44.7.1", "matchCriteriaId": "825F5E14-49FC-4A8A-87FE-FA039D121F99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.45.0", "versionEndExcluding": "1.45.4.1", "matchCriteriaId": "C20D76CF-15B4-49C3-8F3A-8417B5C8016B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.46.0", "versionEndExcluding": "1.46.6.1", "matchCriteriaId": "47767C52-13CC-4164-84DC-54E3BDC1C590"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/174091/Metabase-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "http://packetstormsecurity.com/files/177138/Metabase-0.46.6-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "https://github.com/metabase/metabase/issues/32552", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://github.com/metabase/metabase/releases/tag/v0.46.6.1", "source": "cve@mitre.org", "tags": ["Release Notes"]}, {"url": "https://news.ycombinator.com/item?id=36812256", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://www.metabase.com/blog/security-advisory", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1204.01", "comment": "CVE-2023-38646 - Metabase remote code execution vulnerability, can be exploited using Metabase's ability to execute arbitrary commands on the server, allowing attackers to perform various malicious activities."}, {"techniqueID": "T1210", "comment": "CVE-2023-38646 - Metabase remote code execution vulnerability, can be used to deliver a malicious payload, potentially leading to further exploitation and/or data exfiltration."}, {"techniqueID": "T1190", "comment": "CVE-2023-38646 - Metabase remote code execution vulnerability, can be used to execute a variety of malicious commands on the server, potentially leading to persistence, data leakage, or other malicious activities."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "urn:stix:bundle:12345678-1234-1234-1234-123456789012", "created": "2024-02-15T16:15:45.380", "modified": "2024-02-15T16:15:45.380", "description": "STIX Bundle for CVE-2023-38646", "content": {"objects": [{"type": "vulnerability", "id": "urn:stix:vulnerability:12345678-1234-1234-1234-123456789012", "created": "2024-02-15T16:15:45.380", "modified": "2024-02-15T16:15:45.380", "description": "Metabase remote code execution vulnerability", "impact": "HIGH", " likelihood_ofexploit": "HIGH", "remediation_level": "Partial", "exploit_cvss_score": 9.8, "notes": [{"content": "Metabase remote code execution vulnerability, can be exploited using Metabase's ability to execute arbitrary commands on the server, allowing attackers to perform various malicious activities."}], "relations": [{"type": "has-mitigation", "id": "urn:stix:rels:has-mitigation:12345678-1234-1234-1234-123456789012", "object": {"type": "mitigation", "id": "urn:stix:mitigation:12345678-1234-1234-1234-123456789012", "description": "Upgrade Metabase to a version of 0.46.6.1 or later"}}]}, {"type": "technique", "id": "urn:stix:technique:12345678-1234-1234-1234-123456789012", "created": "2024-02-15T16:15:45.380", "modified": "2024-02-15T16:15:45.380", "name": "T1204.01", "description": "Command and Control - Remote File Copy", "notes": [{"content": "This technique can be used to deliver a malicious payload, potentially leading to further exploitation and/or data exfiltration."}]}]}}}, "technical_analysis": {"Introduction": "Metabase's remote code execution vulnerability, CVE-2023-38646, allows attackers to execute arbitrary commands on the server, making it a high-severity risk.", "Impact and Scope": "The vulnerability affects Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1, and has a CVSS score of 9.8 with a base severity of CRITICAL.", "Related MITRE ATT&CK Techniques": "T1204.01, T1210, T1190", "Technical Details": "The vulnerability is due to Metabase's ability to execute arbitrary commands on the server, allowing attackers to perform various malicious activities.", "Detection": "Detection methods include monitoring for unauthorized command execution and looking for suspicious network traffic and system changes.", "Mitigation": "Mitigations include upgrading Metabase to a version of 0.46.6.1 or later, limiting network access to the Metabase server, and monitoring for suspicious activity.", "Conclusion": "The Metabase remote code execution vulnerability, CVE-2023-38646, is a high-severity risk that can lead to serious consequences if not properly mitigated."}, "executive_analysis": {"Overview": "Metabase remote code execution vulnerability, CVE-2023-38646, is a critical vulnerability that requires immediate attention and action.", "Business Impact": "The vulnerability can lead to data exfiltration, unauthorized access, and other malicious activities that can compromise the confidentiality, integrity, and availability of business-critical data.", "Technical Impact": "The vulnerability can be exploited by attackers to execute arbitrary commands on the Metabase server, potentially leading to further exploitation and/or data exfiltration.", "Mitigation Strategies": "Upgrade Metabase to a version of 0.46.6.1 or later, limit network access to the Metabase server, and monitor for suspicious activity.", "Recommendations": "Implement a patch management process to ensure timely updates and vulnerability remediation, and conduct regular security testing and audits to identify and address potential vulnerabilities.", "Conclusions": "The Metabase remote code execution vulnerability, CVE-2023-38646, is a critical risk that requires immediate attention and action from executives and IT teams."}}