{"id": "CVE-2023-38646", "sourceIdentifier": "cve@mitre.org", "published": "2023-07-21T15:15:10.003", "lastModified": "2024-02-15T16:15:45.380", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation. The other fixed versions are 0.45.4.1, 1.45.4.1, 0.44.7.1, 1.44.7.1, 0.43.7.2, and 1.43.7.2."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionEndExcluding": "0.43.7.2", "matchCriteriaId": "5AE3BE02-E7B9-43CB-8FBA-001F5D8E24ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionEndExcluding": "1.43.7.2", "matchCriteriaId": "6591576F-15AC-493F-96B4-6F3E1E5D1350"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.44.0", "versionEndExcluding": "0.44.7.1", "matchCriteriaId": "90CEC6C0-C2EE-496D-BBE0-DBC83717F211"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.45.0", "versionEndExcluding": "0.45.4.1", "matchCriteriaId": "EC4D0A9A-F084-403A-83BF-F1C56470B845"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.46.0", "versionEndExcluding": "0.46.6.1", "matchCriteriaId": "BEA5EEF8-7F70-4D40-9EB6-8BB5226E281E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.44.0", "versionEndExcluding": "1.44.7.1", "matchCriteriaId": "825F5E14-49FC-4A8A-87FE-FA039D121F99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.45.0", "versionEndExcluding": "1.45.4.1", "matchCriteriaId": "C20D76CF-15B4-49C3-8F3A-8417B5C8016B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.46.0", "versionEndExcluding": "1.46.6.1", "matchCriteriaId": "47767C52-13CC-4164-84DC-54E3BDC1C590"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/174091/Metabase-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "http://packetstormsecurity.com/files/177138/Metabase-0.46.6-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "https://github.com/metabase/metabase/issues/32552", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://github.com/metabase/metabase/releases/tag/v0.46.6.1", "source": "cve@mitre.org", "tags": ["Release Notes"]}, {"url": "https://news.ycombinator.com/item?id=36812256", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://www.metabase.com/blog/security-advisory", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2023-38646 - This vulnerability is related to Command and PowerShell (T1059) and Windows Command Shell (T1055) which can be used by attackers to execute arbitrary commands on the server."}, {"techniqueID": "T1204", "comment": "This vulnerability can also be related to File and Directory Discovery (T1204) which allows attackers to detect and exploit sensitive files and folders."}, {"techniqueID": "T1031", "comment": "This vulnerability may also be related to Data Encoding (T1031) which allows attackers to encode data to evade detection and execute malicious commands."}, {"techniqueID": "T1078", "comment": "This vulnerability may also be related to Account Manipulation (T1078) which allows attackers to manipulate and reuse existing accounts to execute malicious commands."}], "stix_bundle": {"type": "bundle", "id": "bundle-1", "spec_version": "2.1", "objects": [{"id": "indicator-1", "type": "indicator", "title": "CVE-2023-38646 Metabase Command Execution", "description": "This indicator is related to the CVE-2023-38646 Metabase Command Execution vulnerability", "category": "network-traffic", "created_by_ref": "identity-STIX-CSE-1234", "created": "2023-07-21T15:15:10.003", "modified": "2024-02-15T16:15:45.380", "objects": [{"id": "course-of-action-1", "type": "course-of-action", "title": "Update Metabase to a patched version", "description": "Update Metabase to a patched version to mitigate the vulnerability", "target_ref": "indicator-1", "modified": "2024-02-15T16:15:45.380"}]}, {"id": "mitigation-1", "type": "mitigation", "title": "Update Metabase to a patched version", "description": "Update Metabase to a patched version to mitigate the vulnerability", "deleted": "false", "modified": "2024-02-15T16:15:45.380", "objects": [{"id": "note-1", "type": "note", "title": "Update Metabase to a patched version", "description": "Update Metabase to a patched version to mitigate the vulnerability", "content": "This note provides guidance on how to update Metabase to a patched version", "target_ref": "mitigation-1", "modified": "2024-02-15T16:15:45.380"}]}], " relationships": [{"id": "r1", "type": "has-indicator", "source_ref": "indicator-1", "target_ref": "mitigation-1", "relationship_type": "indicator-mitigates"}]}, "technical_analysis": {"Introduction": "CVE-2023-38646 is a Metabase vulnerability that allows attackers to execute arbitrary commands on the server without authentication.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 9.8, and the scope is the Metabase application itself.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to several MITRE ATT&CK techniques, including Command and PowerShell (T1059) and Windows Command Shell (T1055).", "Technical Details": "The vulnerability is due to the unvalidated user input in the Metabase application, which allows attackers to execute arbitrary commands.", "Detection": "Detection of this vulnerability can be done by monitoring for suspicious command executions and file modifications.", "Mitigation": "The vulnerability can be mitigated by updating Metabase to a patched version.", "Conclusion": "In conclusion, CVE-2023-38646 is a high-severity vulnerability that allows attackers to execute arbitrary commands on the server without authentication, and it can be mitigated by updating Metabase to a patched version."}, "executive_analysis": {"Overview": "CVE-2023-38646 is a high-severity vulnerability in Metabase that allows attackers to execute arbitrary commands on the server without authentication.", "Business Impact": "The business impact of this vulnerability is significant, as it allows attackers to compromise sensitive data and disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is the potential for remote code execution without authentication.", "Mitigation Strategies": "The most effective mitigation strategy is to update Metabase to a patched version.", "Recommendations": "We recommend that all impacted organizations update Metabase to a patched version as soon as possible.", "Conclusions": "In conclusion, the recommendations are to update Metabase to a patched version as soon as possible, to mitigate the vulnerability and prevent potential attacks."}}