{"id": "CVE-2023-38646", "sourceIdentifier": "cve@mitre.org", "published": "2023-07-21T15:15:10.003", "lastModified": "2024-02-15T16:15:45.380", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation. The other fixed versions are 0.45.4.1, 1.45.4.1, 0.44.7.1, 1.44.7.1, 0.43.7.2, and 1.43.7.2."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionEndExcluding": "0.43.7.2", "matchCriteriaId": "5AE3BE02-E7B9-43CB-8FBA-001F5D8E24ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionEndExcluding": "1.43.7.2", "matchCriteriaId": "6591576F-15AC-493F-96B4-6F3E1E5D1350"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.44.0", "versionEndExcluding": "0.44.7.1", "matchCriteriaId": "90CEC6C0-C2EE-496D-BBE0-DBC83717F211"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.45.0", "versionEndExcluding": "0.45.4.1", "matchCriteriaId": "EC4D0A9A-F084-403A-83BF-F1C56470B845"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.46.0", "versionEndExcluding": "0.46.6.1", "matchCriteriaId": "BEA5EEF8-7F70-4D40-9EB6-8BB5226E281E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.44.0", "versionEndExcluding": "1.44.7.1", "matchCriteriaId": "825F5E14-49FC-4A8A-87FE-FA039D121F99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.45.0", "versionEndExcluding": "1.45.4.1", "matchCriteriaId": "C20D76CF-15B4-49C3-8F3A-8417B5C8016B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.46.0", "versionEndExcluding": "1.46.6.1", "matchCriteriaId": "47767C52-13CC-4164-84DC-54E3BDC1C590"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/174091/Metabase-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "http://packetstormsecurity.com/files/177138/Metabase-0.46.6-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "https://github.com/metabase/metabase/issues/32552", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://github.com/metabase/metabase/releases/tag/v0.46.6.1", "source": "cve@mitre.org", "tags": ["Release Notes"]}, {"url": "https://news.ycombinator.com/item?id=36812256", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://www.metabase.com/blog/security-advisory", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1204", "comment": "CVE-2023-38646 - Metabase Remote Code Execution vulnerability allows an attacker to execute arbitrary commands on the server, at the server's privilege level. This technique is relevant to remote code execution and privilege escalation attacks."}, {"techniqueID": "T1190", "comment": "CVE-2023-38646 - The vulnerability allows an attacker to execute arbitrary commands on the server, which indicates potential command and control (C2) communications. This technique is relevant to data exfiltration and lateral movement attacks."}], "stix_bundle": {"type": "bundle", "objects": [{"id": "CVE-2023-38646", "type": "vulnerability", "title": "Metabase Remote Code Execution Vulnerability", "description": "Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level.", "published": "2023-07-21T15:15:10.003", "author": "cve@mitre.org", "objective": "To provide a comprehensive understanding of the Metabase Remote Code Execution Vulnerability", "extends": [{"type": "relationship", "target": {"id": "attack-pattern-T1204", "type": "attack-pattern", "name": "Remote File Copy"}, "relationship_type": "related_to"}, {"type": "relationship", "target": {"id": "attack-pattern-T1190", "type": "attack-pattern", "name": "Command and Control"}, "relationship_type": "related_to"}], "defense_section": {"techniques": [{"techniqueID": "D2: Controls User Level Access", "description": "Implement access controls to limit user-level access"}, {"techniqueID": "D14: Isolate User Accounts", "description": "Isolate user accounts to prevent lateral movement"}]}}, {"id": "attack-pattern-T1204", "type": "attack-pattern", "name": "Remote File Copy", "description": "This attack pattern contains techniques for remotely copying files", "objective": "To provide a comprehensive understanding of remote file copy attacks", "extends": [{"type": "relationship", "target": {"id": "incident-response-T1204", "type": "incident-response", "name": "Remote File Copy Response"}, "relationship_type": "related_to"}]}, {"id": "attack-pattern-T1190", "type": "attack-pattern", "name": "Command and Control", "description": "This attack pattern contains techniques for command and control communications", "objective": "To provide a comprehensive understanding of command and control attacks", "extends": [{"type": "relationship", "target": {"id": "incident-response-T1190", "type": "incident-response", "name": "Command and Control Response"}, "relationship_type": "related_to"}]}, {"id": "incident-response-T1204", "type": "incident-response", "name": "Remote File Copy Response", "description": "This incident response plan contains procedures for remote file copy attacks", "objective": "To provide a comprehensive incident response plan for remote file copy attacks", "extends": [{"type": "relationship", "target": {"id": "intelligence-malware-T1204", "type": "intelligence-malware", "name": "Remote File Copy Malware"}, "relationship_type": "related_to"}]}, {"id": "incident-response-T1190", "type": "incident-response", "name": "Command and Control Response", "description": "This incident response plan contains procedures for command and control attacks", "objective": "To provide a comprehensive incident response plan for command and control attacks", "extends": [{"type": "relationship", "target": {"id": "intelligence-malware-T1190", "type": "intelligence-malware", "name": "Command and Control Malware"}, "relationship_type": "related_to"}]}, {"id": "intelligence-malware-T1204", "type": "intelligence-malware", "name": "Remote File Copy Malware", "description": "This malware contains techniques for remote file copy", "objective": "To provide a comprehensive understanding of remote file copy malware", "extends": [{"type": "relationship", "target": {"id": "indicator-T1204", "type": "indicator", "name": "Remote File Copy Indicator"}, "relationship_type": "related_to"}]}, {"id": "intelligence-malware-T1190", "type": "intelligence-malware", "name": "Command and Control Malware", "description": "This malware contains techniques for command and control communications", "objective": "To provide a comprehensive understanding of command and control malware", "extends": [{"type": "relationship", "target": {"id": "indicator-T1190", "type": "indicator", "name": "Command and Control Indicator"}, "relationship_type": "related_to"}]}, {"id": "indicator-T1204", "type": "indicator", "name": "Remote File Copy Indicator", "description": "This indicator contains techniques for remote file copy", "objective": "To provide a comprehensive understanding of remote file copy indicators", "extends": [{"type": "relationship", "target": {"id": "report-T1204", "type": "report", "name": "Remote File Copy Report"}, "relationship_type": "related_to"}]}, {"id": "indicator-T1190", "type": "indicator", "name": "Command and Control Indicator", "description": "This indicator contains techniques for command and control communications", "objective": "To provide a comprehensive understanding of command and control indicators", "extends": [{"type": "relationship", "target": {"id": "report-T1190", "type": "report", "name": "Command and Control Report"}, "relationship_type": "related_to"}]}, {"id": "report-T1204", "type": "report", "name": "Remote File Copy Report", "description": "This report contains findings and recommendations for remote file copy attacks", "objective": "To provide a comprehensive report on remote file copy attacks", "extends": [{"type": "relationship", "target": {"id": "workflow-T1204", "type": "workflow", "name": "Remote File Copy Workflow"}, "relationship_type": "related_to"}]}, {"id": "report-T1190", "type": "report", "name": "Command and Control Report", "description": "This report contains findings and recommendations for command and control attacks", "objective": "To provide a comprehensive report on command and control attacks", "extends": [{"type": "relationship", "target": {"id": "workflow-T1190", "type": "workflow", "name": "Command and Control Workflow"}, "relationship_type": "related_to"}]}, {"id": "workflow-T1204", "type": "workflow", "name": "Remote File Copy Workflow", "description": "This workflow contains procedures for remote file copy attacks", "objective": "To provide a comprehensive workflow for remote file copy attacks", "extends": [{"type": "relationship", "target": {"id": "analysis-T1204", "type": "analysis", "name": "Remote File Copy Analysis"}, "relationship_type": "related_to"}]}, {"id": "workflow-T1190", "type": "workflow", "name": "Command and Control Workflow", "description": "This workflow contains procedures for command and control attacks", "objective": "To provide a comprehensive workflow for command and control attacks", "extends": [{"type": "relationship", "target": {"id": "analysis-T1190", "type": "analysis", "name": "Command and Control Analysis"}, "relationship_type": "related_to"}]}, {"id": "analysis-T1204", "type": "analysis", "name": "Remote File Copy Analysis", "description": "This analysis contains techniques for remote file copy", "objective": "To provide a comprehensive analysis of remote file copy attacks", "extends": [{"type": "relationship", "target": {"id": "mitigation-T1204", "type": "mitigation", "name": "Remote File Copy Mitigation"}, "relationship_type": "related_to"}]}, {"id": "analysis-T1190", "type": "analysis", "name": "Command and Control Analysis", "description": "This analysis contains techniques for command and control communications", "objective": "To provide a comprehensive analysis of command and control attacks", "extends": [{"type": "relationship", "target": {"id": "mitigation-T1190", "type": "mitigation", "name": "Command and Control Mitigation"}, "relationship_type": "related_to"}]}, {"id": "mitigation-T1204", "type": "mitigation", "name": "Remote File Copy Mitigation", "description": "This mitigation contains techniques for remote file copy", "objective": "To provide a comprehensive mitigation for remote file copy attacks", "extends": [{"type": "relationship", "target": {"id": "mitigation-T1190", "type": "mitigation", "name": "Command and Control Mitigation"}, "relationship_type": "related_to"}]}, {"id": "mitigation-T1190", "type": "mitigation", "name": "Command and Control Mitigation", "description": "This mitigation contains techniques for command and control communications", "objective": "To provide a comprehensive mitigation for command and control attacks", "extends": [{"type": "relationship", "target": {"id": "mitigation-T1204", "type": "mitigation", "name": "Remote File Copy Mitigation"}, "relationship_type": "related_to"}]}]}}