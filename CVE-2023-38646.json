{"id": "CVE-2023-38646", "sourceIdentifier": "cve@mitre.org", "published": "2023-07-21T15:15:10.003", "lastModified": "2024-02-15T16:15:45.380", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level. Authentication is not required for exploitation. The other fixed versions are 0.45.4.1, 1.45.4.1, 0.44.7.1, 1.44.7.1, 0.43.7.2, and 1.43.7.2."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionEndExcluding": "0.43.7.2", "matchCriteriaId": "5AE3BE02-E7B9-43CB-8FBA-001F5D8E24ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionEndExcluding": "1.43.7.2", "matchCriteriaId": "6591576F-15AC-493F-96B4-6F3E1E5D1350"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.44.0", "versionEndExcluding": "0.44.7.1", "matchCriteriaId": "90CEC6C0-C2EE-496D-BBE0-DBC83717F211"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.45.0", "versionEndExcluding": "0.45.4.1", "matchCriteriaId": "EC4D0A9A-F084-403A-83BF-F1C56470B845"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:-:*:*:*", "versionStartIncluding": "0.46.0", "versionEndExcluding": "0.46.6.1", "matchCriteriaId": "BEA5EEF8-7F70-4D40-9EB6-8BB5226E281E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.44.0", "versionEndExcluding": "1.44.7.1", "matchCriteriaId": "825F5E14-49FC-4A8A-87FE-FA039D121F99"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.45.0", "versionEndExcluding": "1.45.4.1", "matchCriteriaId": "C20D76CF-15B4-49C3-8F3A-8417B5C8016B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:enterprise:*:*:*", "versionStartIncluding": "1.46.0", "versionEndExcluding": "1.46.6.1", "matchCriteriaId": "47767C52-13CC-4164-84DC-54E3BDC1C590"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/174091/Metabase-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "http://packetstormsecurity.com/files/177138/Metabase-0.46.6-Remote-Code-Execution.html", "source": "cve@mitre.org"}, {"url": "https://github.com/metabase/metabase/issues/32552", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://github.com/metabase/metabase/releases/tag/v0.46.6.1", "source": "cve@mitre.org", "tags": ["Release Notes"]}, {"url": "https://news.ycombinator.com/item?id=36812256", "source": "cve@mitre.org", "tags": ["Issue Tracking"]}, {"url": "https://www.metabase.com/blog/security-advisory", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1210", "comment": "CVE-2023-38646 - This technique is relevant in the context of Metabase's command execution vulnerability. An attacker can execute arbitrary commands on the server, allowing for lateral movement and potentially escalating privileges."}, {"techniqueID": "T1059", "comment": "CVE-2023-38646 - This technique is relevant in the context of Metabase's command execution vulnerability. An attacker can execute arbitrary commands on the server, allowing for data exfiltration and other malicious activities."}, {"techniqueID": "T1190", "comment": "CVE-2023-38646 - This technique is relevant in the context of Metabase's command execution vulnerability. An attacker can use the vulnerability to upload and execute malicious code on the server, allowing for further exploitation."}], "stix_bundle": {"id": "urn:samples:CVE-2023-38646", "type": "bundle", "created_by_ref": "urn:ietf:params:stix:2.1:STIX_Bundle_Package", "created": "2024-02-15T16:15:45.380", "modified": "2024-02-15T16:15:45.380", "objects": [{"id": "urn:samples:CVE-2023-38646:CVE-2023-38646", "type": "vulnerability", "name": "Metabase Command Execution Vulnerability", "description": "Metabase open source before 0.46.6.1 and Metabase Enterprise before 1.46.6.1 allow attackers to execute arbitrary commands on the server, at the server's privilege level.", "severity": "CRITICAL", "base_score": 9.8, "base_severity": "CRITICAL", "cvss_metrics": [{"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"}]}, {"id": "urn:samples:CVE-2023-38646:Attack", "type": "attack_pattern", "name": "Metabase Command Execution Attack", "description": "An attacker executes a command on the Metabase server, potentially allowing for lateral movement or privilege escalation.", "observed_data": [{"type": "Process", "indicator": "Metabase command execution"}]}, {"id": "urn:samples:CVE-2023-38646:Defense", "type": "defense", "name": "Metabase Command Execution Defense", "description": "Block or restrict incoming commands to the Metabase server, and ensure all commands are thoroughly validated and authenticated.", "mitigates": [{"ref_id": "urn:samples:CVE-2023-38646:Attack"}]}], "relationships": [{"sobject_ref": "urn:samples:CVE-2023-38646:CVE-2023-38646", "object_ref": "urn:samples:CVE-2023-38646:Attack", "relationship": "indicates-vulnerability"}, {"sobject_ref": "urn:samples:CVE-2023-38646:CVE-2023-38646", "object_ref": "urn:samples:CVE-2023-38646:Defense", "relationship": "mitigated-by"}]}, "technical_analysis": {"Introduction": "In this vulnerability, an attacker can execute arbitrary commands on the Metabase server, potentially allowing for lateral movement or privilege escalation. This vulnerability is critical, with a CVSS score of 9.8.", "Impact and Scope": "The impact of this vulnerability is significant, as it allows an attacker to execute arbitrary commands on the server. The scope of the vulnerability is limited to the Metabase server, but the potential impact is high.", "Related MITRE ATT&CK Techniques": "T1210, T1059, T1190", "Technical Details": "The vulnerability is due to a command execution vulnerability in the Metabase server. This allows an attacker to execute arbitrary commands, potentially allowing for lateral movement or privilege escalation.", "Detection": "Detection of this vulnerability can be challenging, as it requires identifying and analyzing suspicious command execution activity on the Metabase server.", "Mitigation": "Mitigation strategies include blocking or restricting incoming commands to the Metabase server, and ensuring all commands are thoroughly validated and authenticated.", "Conclusion": "In conclusion, the Metabase command execution vulnerability is a critical vulnerability that requires immediate attention and mitigation. This vulnerability highlights the importance of robust command execution validation and authentication."}, "executive_analysis": {"Overview": "This vulnerability highlights the importance of robust command execution validation and authentication in Metabase. It also emphasizes the importance of regularly applying security patches to prevent exploitation.", "Business Impact": "The business impact of this vulnerability is significant, as it could allow an attacker to execute arbitrary commands on the server, potentially compromising business data or processes.", "Technical Impact": "The technical impact of this vulnerability is high, as it allows an attacker to execute arbitrary commands on the server. This increases the risk of data exfiltration, privilege escalation, and other malicious activities.", "Mitigation Strategies": "Implementing command execution validation and authentication, and regularly applying security patches are key mitigation strategies.", "Recommendations": "Executives should prioritize implementing robust command execution validation and authentication, and regularly applying security patches to prevent exploitation.", "Conclusions": "In conclusion, the Metabase command execution vulnerability is a critical vulnerability that requires immediate attention and mitigation. Executives should prioritize implementing robust command execution validation and authentication, and regularly applying security patches to prevent exploitation."}}