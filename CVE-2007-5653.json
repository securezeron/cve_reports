{"id": "CVE-2007-5653", "sourceIdentifier": "cve@mitre.org", "published": "2007-10-23T21:47:00.000", "lastModified": "2017-09-29T01:29:40.050", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Component Object Model (COM) functions in PHP 5.x on Windows do not follow safe_mode and disable_functions restrictions, which allows context-dependent attackers to bypass intended limitations, as demonstrated by executing objects with the kill bit set in the corresponding ActiveX control Compatibility Flags, executing programs via a function in compatUI.dll, invoking wscript.shell via wscript.exe, invoking Scripting.FileSystemObject via wshom.ocx, and adding users via a function in shgina.dll, related to the com_load_typelib function."}, {"lang": "es", "value": "Las funciones Component Object Model (COM) en PHP 5.x sobre Windows no siguen las restricciones safe_mode y disable_functions, lo cual permite a atacantes dependientes del contexto evitar las limitaciones intencionadas, como se demostr\u00f3 ejecutando objetos con el bit matar asignado en el correspondientes controlador ActiveX Compatibility Flags, ejecutando programas a trav\u00e9s de una funci\u00f3n en compatUI.dll, invocando wscript.shell a trav\u00e9s de wscript.exe, invocando Scripting.FileSystemObject a trav\u00e9s de wshom.ocx, y a\u00f1adiendo usuarios a trav\u00e9s de una funci\u00f3n en shgina.dll, relacionado con la funci\u00f3n com_load_typelib."}], "vendorComments": [{"organization": "Red Hat", "comment": "Not vulnerable. These issues did not affect PHP on Linux.", "lastModified": "2007-10-24T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.3}, "baseSeverity": "HIGH", "exploitabilityScore": 8.6, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:windows:*:*:*:*:*", "versionEndIncluding": "5.2.4", "matchCriteriaId": "0D7159E3-5ABD-431B-AD9D-42ADC07F91CF"}]}]}], "references": [{"url": "http://secunia.com/advisories/27280", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/3590", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/37368", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/4553", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1200", "comment": "CVE-2007-5653 - The vulnerability allows an attacker to execute arbitrary code on the system, so a defense strategy would be to limit the use of COM functions, validate user input, and ensure that the vulnerable libraries are not used."}, {"techniqueID": "TA0002", "comment": "CVE-2007-5653 - The vulnerability allows an attacker to execute arbitrary code on the system, so a defense strategy would be to limit the use of COM functions, validate user input, and ensure that the vulnerable libraries are not used."}], "stix_bundle": "{\"bundle\": {\n  \"name\": \"CVE-2007-5653 Bundle\",\n  \"version\": \"1.0\",\n  \"timezone\": \"America/New_York\",\n  \"objects\": [\n    {\n      \"type\": \"indicator\",\n      \"id\": \"indicator-1\",\n      \"created_by_ref\": \"Attackers\",\n      \"modified\": \"2017-09-29T01:29:40.000\",\n      \"labels\": [\"vulnerability\"],\n      \"created\": \"2007-10-23T21:47:00.000\",\n      \"validated\": true,\n      \"objects\": [\n        {\n          \"type\": \"observed-data\",\n          \"id\": \"observed-data-1\",\n          \"first_seen\": \"2007-10-23T21:47:00.000\",\n          \"last_seen\": \"2007-10-23T21:47:00.000\",\n          \"number_observed\": 1,\n          \"indicator_id_ref\": \"indicator-1\"\n        }\n      ],\n      \"tactics\": [\n        {\n          \"id\": \" attack-1\",\n          \"modified\": \"2017-09-29T01:29:40.000\",\n          \"created\": \"2007-10-23T21:47:00.000\",\n          \"description\": \"Arbitrary code execution\",\n          \"tactic_id\": \"TA0002\"\n        }\n      ],\n      \"mitigations\": [\n        {\n          \"id\": \"mitigation-1\",\n          \"modify_by_ref\": \"Defenders\",\n          \"created\": \"2007-10-23T21:47:00.000\",\n          \"description\": \"Limit the use of COM functions\",\n          \"mitigation_id\": \"T1200\"\n        }\n      ]\n    },\n    {\n      \"type\": \"course-of-action\",\n      \"id\": \"course-of-action-1\",\n      \"created_by_ref\": \"Defenders\",\n      \"modified\": \"2017-09-29T01:29:40.000\",\n      \"labels\": [\" defense\"],\n      \"created\": \"2007-10-23T21:47:00.000\",\n      \"course_of_action_id\": \"Mitigation\"\n    }\n  ],\n  \" relations\": [\n    {\n      \"relation_type\": \"related-to\",\n      \"src_ref\": \"indicator-1\",\n      \"trg_ref\": \"course-of-action-1\"\n    }\n  ]\n}}", "technical_analysis": {"Introduction": "CVE-2007-5653 is a vulnerable COM function in PHP 5.x on Windows that allows an attacker to execute arbitrary code on the system.", "Impact and Scope": "The vulnerability has a CVSS score of 9.3 (AV:N/AC:M/Au:N/C:C/I:C/A:C) and affects users of PHP 5.x on Windows.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to the T1200 technique (\ucee4\uc2a4\ud140 \uc2a4\ud06c\ub9bd\ud2b8) and TA0002 technique (Command and Control).", "Technical Details": "The vulnerability occurs due to the improper validation of user input, which allows an attacker to execute arbitrary code on the system.", "Detection": "The vulnerability can be detected by monitoring for suspicious COM function calls and invalid user input.", "Mitigation": "The vulnerability can be mitigated by limiting the use of COM functions, validating user input, and ensuring that the vulnerable libraries are not used.", "Conclusion": "In conclusion, CVE-2007-5653 is a serious vulnerability that can be exploited by attackers to execute arbitrary code on the system. It is essential to patch the vulnerable library and implement defense strategies to prevent the exploitation of this vulnerability."}, "executive_analysis": {"Overview": "CVE-2007-5653 is a critical vulnerability in PHP 5.x on Windows that allows an attacker to execute arbitrary code on the system.", "Business Impact": "The vulnerability can result in financial losses, data theft, and reputational damage if exploited.", "Technical Impact": "The vulnerability can compromise system security, allowing attackers to execute arbitrary code and access sensitive data.", "Mitigation Strategies": "Implementing defense strategies such as patching the vulnerable library, validating user input, and limiting the use of COM functions can mitigate the impact of this vulnerability.", "Recommendations": "It is essential to prioritize patching the vulnerable library and implementing defense strategies to prevent the exploitation of this vulnerability.", "Conclusions": "In conclusion, CVE-2007-5653 is a critical vulnerability that requires urgent attention and action to mitigate its impact."}}