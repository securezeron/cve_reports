{"id": "CVE-2007-5653", "sourceIdentifier": "cve@mitre.org", "published": "2007-10-23T21:47:00.000", "lastModified": "2017-09-29T01:29:40.050", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Component Object Model (COM) functions in PHP 5.x on Windows do not follow safe_mode and disable_functions restrictions, which allows context-dependent attackers to bypass intended limitations, as demonstrated by executing objects with the kill bit set in the corresponding ActiveX control Compatibility Flags, executing programs via a function in compatUI.dll, invoking wscript.shell via wscript.exe, invoking Scripting.FileSystemObject via wshom.ocx, and adding users via a function in shgina.dll, related to the com_load_typelib function."}, {"lang": "es", "value": "Las funciones Component Object Model (COM) en PHP 5.x sobre Windows no siguen las restricciones safe_mode y disable_functions, lo cual permite a atacantes dependientes del contexto evitar las limitaciones intencionadas, como se demostr\u00f3 ejecutando objetos con el bit matar asignado en el correspondientes controlador ActiveX Compatibility Flags, ejecutando programas a trav\u00e9s de una funci\u00f3n en compatUI.dll, invocando wscript.shell a trav\u00e9s de wscript.exe, invocando Scripting.FileSystemObject a trav\u00e9s de wshom.ocx, y a\u00f1adiendo usuarios a trav\u00e9s de una funci\u00f3n en shgina.dll, relacionado con la funci\u00f3n com_load_typelib."}], "vendorComments": [{"organization": "Red Hat", "comment": "Not vulnerable. These issues did not affect PHP on Linux.", "lastModified": "2007-10-24T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.3}, "baseSeverity": "HIGH", "exploitabilityScore": 8.6, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:windows:*:*:*:*:*", "versionEndIncluding": "5.2.4", "matchCriteriaId": "0D7159E3-5ABD-431B-AD9D-42ADC07F91CF"}]}]}], "references": [{"url": "http://secunia.com/advisories/27280", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/3590", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/37368", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/4553", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1204", "comment": "Using COM to load arbitrary DLLs - This is a common technique used by attackers to execute malicious code on Windows systems. This vulnerability allows an attacker to load and execute arbitrary DLLs, which can be used to achieve code execution."}, {"techniqueID": "T1210", "comment": "Using a script to inject a malicious object - This technique is used by attackers to inject malicious objects into the system using scripts. This vulnerability can be used to inject malicious objects and execute malicious code."}, {"techniqueID": "T1199", "comment": "Calling a control or function in a script - This technique is used by attackers to call controls or functions in scripts to execute malicious code. This vulnerability can be used to call scripts and execute malicious code."}, {"techniqueID": "T1129", "comment": "Executing a process with elevated privileges - This technique is used by attackers to execute processes with elevated privileges. This vulnerability can be used to execute processes with elevated privileges."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "b-12345678", "created_by_ref": "a- attacker", "created": "2021-01-01T14:30:00.000", "modified": "2021-01-01T14:30:00.000", "voided": "false", "objects": [{"type": "vulnerability", "id": "v-20075653", "created_by_ref": "a-attacker", "created": "2021-01-01T14:30:00.000", "modified": "2021-01-01T14:30:00.000", "voided": "false", "name": "CVE-2007-5653", "description": "The Component Object Model (COM) functions in PHP 5.x on Windows do not follow safe_mode and disable_functions restrictions, which allows context-dependent attackers to bypass intended limitations.", "score": {"cvss_v3": {"base_score": 9.3, "access_vector": "NETWORK", "access_complexity": "MEDIUM", "authentication": "NONE", "confidentiality_impact": "COMPLETE", "integrity_impact": "COMPLETE", "availability_impact": "COMPLETE"}}, "related_opaque": {"relationships": [{"type": "used_by", "id": "r-12345678", "source_ref": "v-20075653", "target_ref": "tec-1204", "label": "uses technique"}]}}, {"type": "technique", "id": "tec-1204", "created_by_ref": "a-attacker", "created": "2021-01-01T14:30:00.000", "modified": "2021-01-01T14:30:00.000", "voided": "false", "name": "Using COM to load arbitrary DLLs", "description": "Using COM to load arbitrary DLLs is a technique used by attackers to execute malicious code on Windows systems."}]}}, "technical_analysis": {"Introduction": "The vulnerability CVE-2007-5653 is a remote code execution vulnerability in PHP 5.x on Windows.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 9.3. The scope of the vulnerability is remote code execution, which allows an attacker to execute arbitrary code on the victim's system.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1204, T1210, T1199, and T1129.", "Technical Details": "The vulnerability occurs when the PHP 5.x on Windows does not properly validate the input parameters and allows an attacker to execute arbitrary code.", "Detection": "The vulnerability can be detected through the use of exploit detection systems and memory forensics tools.", "Mitigation": "The vulnerability can be mitigated by applying the patch provided by the vendor or disabling the affected PHP functions.", "Conclusion": "The vulnerability CVE-2007-5653 is a serious remote code execution vulnerability that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "The vulnerability CVE-2007-5653 is a remote code execution vulnerability in PHP 5.x on Windows that can be exploited by attackers to execute arbitrary code on the victim's system.", "Business Impact": "The business impact of this vulnerability is high, as it can allow an attacker to gain access to sensitive data and execute unauthorized actions.", "Technical Impact": "The technical impact of this vulnerability is high, as it can allow an attacker to execute arbitrary code on the victim's system.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include applying the patch provided by the vendor or disabling the affected PHP functions.", "Recommendations": "Recommended actions include applying the patch, disabling the affected PHP functions, and implementing additional security measures to prevent exploitation.", "Conclusions": "In conclusion, the vulnerability CVE-2007-5653 is a serious remote code execution vulnerability that requires immediate attention and mitigation."}}