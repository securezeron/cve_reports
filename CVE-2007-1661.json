{"id": "CVE-2007-1661", "sourceIdentifier": "cve@mitre.org", "published": "2007-11-07T23:46:00.000", "lastModified": "2018-10-16T16:39:52.863", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Perl-Compatible Regular Expression (PCRE) library before 7.3 backtracks too far when matching certain input bytes against some regex patterns in non-UTF-8 mode, which allows context-dependent attackers to obtain sensitive information or cause a denial of service (crash), as demonstrated by the \"\\X?\\d\" and \"\\P{L}?\\d\" patterns."}, {"lang": "es", "value": "La librer\u00eda Perl-Compatible Regular Expression (PCRE) anterior a 7.3 vuelve demasiado atr\u00e1s cuando compara determinados bytes de entrada con algunos patrones de expresiones regulares en modo no-UTF-8, lo cual permite a atacantes locales o remotos (dependiendo del contexto) obtener informaci\u00f3n sensible o provocar una denegaci\u00f3n de servicio (ca\u00edda), como se ha demostrado mediante los patrones \"\\X?\\d\" y \"\\P{L}?\\d\"."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 6.4}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:pcre:perl-compatible_regular_expression_library:*:*:*:*:*:*:*:*", "versionEndIncluding": "7.2", "matchCriteriaId": "346F4175-3DD5-4EA5-A10D-F062C7D93A15"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pcre:perl-compatible_regular_expression_library:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "4E211904-BCCB-4408-8027-CE4C81B6C6C8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pcre:perl-compatible_regular_expression_library:7.1:*:*:*:*:*:*:*", "matchCriteriaId": "79B62828-588E-4279-BB0D-96247B97041E"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.11:*:*:*:*:*:*:*", "matchCriteriaId": "6EE39585-CF3B-4493-96D8-B394544C7643"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.11:*:*:*:*:*:*:*", "matchCriteriaId": "D09D5933-A7D9-4A61-B863-CD8E7D5E67D8"}]}]}], "references": [{"url": "http://bugs.gentoo.org/show_bug.cgi?id=198976", "source": "cve@mitre.org"}, {"url": "http://docs.info.apple.com/article.html?artnum=307179", "source": "cve@mitre.org"}, {"url": "http://docs.info.apple.com/article.html?artnum=307562", "source": "cve@mitre.org"}, {"url": "http://lists.apple.com/archives/security-announce/2007/Dec/msg00002.html", "source": "cve@mitre.org"}, {"url": "http://lists.apple.com/archives/security-announce/2008/Mar/msg00001.html", "source": "cve@mitre.org"}, {"url": "http://mail.gnome.org/archives/gtk-devel-list/2007-November/msg00022.html", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27538", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/27543", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/27554", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/27697", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/27741", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/27773", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/28136", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/28406", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/28414", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/28714", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/28720", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/29267", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/29420", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/30106", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/30155", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/30219", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://security.gentoo.org/glsa/glsa-200711-30.xml", "source": "cve@mitre.org"}, {"url": "http://security.gentoo.org/glsa/glsa-200801-02.xml", "source": "cve@mitre.org"}, {"url": "http://security.gentoo.org/glsa/glsa-200801-18.xml", "source": "cve@mitre.org"}, {"url": "http://security.gentoo.org/glsa/glsa-200801-19.xml", "source": "cve@mitre.org"}, {"url": "http://security.gentoo.org/glsa/glsa-200805-11.xml", "source": "cve@mitre.org"}, {"url": "http://www.debian.org/security/2007/dsa-1399", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://www.debian.org/security/2008/dsa-1570", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDKSA-2007:211", "source": "cve@mitre.org"}, {"url": "http://www.novell.com/linux/security/advisories/2007_62_pcre.html", "source": "cve@mitre.org"}, {"url": "http://www.pcre.org/changelog.txt", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/483357/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/483579/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/26346", "source": "cve@mitre.org"}, {"url": "http://www.us-cert.gov/cas/techalerts/TA07-352A.html", "source": "cve@mitre.org", "tags": ["US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2007/3725", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/3790", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/4238", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2008/0924/references", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/38274", "source": "cve@mitre.org"}, {"url": "https://issues.rpath.com/browse/RPL-1738", "source": "cve@mitre.org"}, {"url": "https://usn.ubuntu.com/547-1/", "source": "cve@mitre.org"}, {"url": "https://www.redhat.com/archives/fedora-package-announce/2008-March/msg00181.html", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0001", "comment": "Detecting and Defending Against Malware - {CVE-2007-1661} is related to malware, this technique can help in detecting and defending against malicious code."}, {"techniqueID": "TA0002", "comment": "Understanding Web Application Firewalls (WAF) - {CVE-2007-1661} targets web applications, understanding WAFs can help in detecting and preventing attacks."}, {"techniqueID": "TA0005", "comment": "Detecting and Blocking Command and Control (C2) Communication - {CVE-2007-1661} allows attackers to obtain sensitive information or cause a denial of service, detecting and blocking C2 communication can help in mitigating this attack."}, {"techniqueID": "TA0023", "comment": "Leveraging ARP for Post-Exploitation - {CVE-2007-1661} allows attackers to obtain sensitive information or cause a denial of service, leveraging ARP for post-exploitation can help in detecting and mitigating this attack."}, {"techniqueID": "TA0053", "comment": "Encoding for Malware Obfuscation - {CVE-2007-1661} malware can be encoded to avoid detection, using encoding techniques can help in detecting and mitigating this attack."}], "stix_bundle": {"type": "bundle", "objects": {"vulnerability": {"id": "CVE-2007-1661", "description": "Perl-Compatible Regular Expression (PCRE) library before 7.3 backtracks too far when matching certain input bytes against some regex patterns in non-UTF-8 mode, which allows context-dependent attackers to obtain sensitive information or cause a denial of service (crash), as demonstrated by the \"\\X?\\d\" and \"\\P{L}?\\d\" patterns.", "exploit_availability": "Exploitable", "cvssv2_version": "2.0", "cvssv2_vector_string": "AV:N/AC:L/Au:N/C:P/I:N/A:P", "cvssv2_base_score": 6.4, "is_publicly_available": true, "created": "2007-11-07T23:46:00.000", "last_modified": "2018-10-16T16:39:52.863"}, "mitigation": [{"type": "course_of_action", "id": "mitigation-1", "description": "Upgrade to PCRE 7.3 or later", "relationship": "mitigates", "related_object": {"type": "vulnerability", "id": "CVE-2007-1661"}}], "indicators": [{"type": "indicator", "id": "indicator-1", "description": "Regex patterns in non-UTF-8 mode are being used", "specification": "regex patterns", "relationship": "indicates", "related_object": {"type": "vulnerability", "id": "CVE-2007-1661"}}], "labels": {"labels": ["Vulnerability", "Exploitable"]}, "notes": [{"type": "note", "id": "note-1", "text": "This vulnerability allows attackers to obtain sensitive information or cause a denial of service."}]}}, "technical_analysis": {"Introduction": "The CVE-2007-1661 vulnerability is a critical vulnerability in the Perl-Compatible Regular Expression (PCRE) library that allows attackers to obtain sensitive information or cause a denial of service.", "Impact and Scope": "The vulnerability affects PCRE versions 7.2 and below. It allows attackers to obtain sensitive information or cause a denial of service (crash) by matching certain input bytes against some regex patterns in non-UTF-8 mode.", "Related MITRE ATT&CK Techniques": "Related techniques include TA0001, TA0002, TA0005, TA0023, and TA0053.", "Technical Details": "The vulnerability occurs in the way PCRE handles regex patterns in non-UTF-8 mode. It allows attackers to pass input bytes that cause the PCRE engine to backtrack too far, leading to sensitive information being revealed or a denial of service.", "Detection": "Detection can be done by searching for regex patterns in non-UTF-8 mode and monitoring for suspicious traffic.", "Mitigation": "Mitigation strategies include upgrading to PCRE 7.3 or later and ensuring that regex patterns are always used in UTF-8 mode.", "Conclusion": "In conclusion, the CVE-2007-1661 vulnerability is a critical vulnerability that affects PCRE versions 7.2 and below. It allows attackers to obtain sensitive information or cause a denial of service and can be mitigated by upgrading to PCRE 7.3 or later and ensuring that regex patterns are always used in UTF-8 mode."}, "executive_analysis": {"Overview": "The CVE-2007-1661 vulnerability is a critical vulnerability that affects PCRE versions 7.2 and below.", "Business Impact": "The vulnerability can lead to sensitive information being revealed or a denial of service, resulting in business disruptions and revenue losses.", "Technical Impact": "The vulnerability can be exploited by attackers to obtain sensitive information or cause a denial of service.", "Mitigation Strategies": "Mitigation strategies include upgrading to PCRE 7.3 or later and ensuring that regex patterns are always used in UTF-8 mode.", "Recommendations": "It is recommended that organizations upgrade to PCRE 7.3 or later and ensure that regex patterns are always used in UTF-8 mode to prevent exploitation of the vulnerability.", "Conclusions": "In conclusion, the CVE-2007-1661 vulnerability is a critical vulnerability that affects PCRE versions 7.2 and below. It is essential that organizations take immediate action to mitigate this vulnerability to prevent exploitation and potential business disruptions."}}