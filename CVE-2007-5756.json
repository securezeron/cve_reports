{"id": "CVE-2007-5756", "sourceIdentifier": "cve@mitre.org", "published": "2007-11-14T01:46:00.000", "lastModified": "2024-02-09T03:13:48.570", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple array index errors in the bpf_filter_init function in NPF.SYS in WinPcap before 4.0.2, when run in monitor mode (aka Table Management Extensions or TME), and as used in Wireshark and possibly other products, allow local users to gain privileges via crafted IOCTL requests."}, {"lang": "es", "value": "M\u00faltiples errores de \u00edndice de array en la funci\u00f3n bpf_filter_init en NPF.SYS en WinPcap anterior a 4.0.2, cuando funciona en modo monitor (tambi\u00e9n conocido c\u00f3mo Table Management Extensions o TME), y como es utilizado en Wireshark y posiblemente otros productos, permite a usuarios locales ganar privilegios a trav\u00e9s de respuestas IOCTL manipuladas."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.9}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-129"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:winpcap:winpcap:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.0.2", "matchCriteriaId": "4A6E528E-DE46-46F1-B8EA-0D885DA7D9E3"}]}]}], "references": [{"url": "http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=625", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/27676", "source": "cve@mitre.org", "tags": ["Broken Link", "Patch", "Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/26409", "source": "cve@mitre.org", "tags": ["Broken Link", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securitytracker.com/id?1018935", "source": "cve@mitre.org", "tags": ["Broken Link", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.vupen.com/english/advisories/2007/3835", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.winpcap.org/misc/changelog.htm", "source": "cve@mitre.org", "tags": ["Release Notes"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/38433", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "TA0001", "comment": "Authenticate as SYSTEM or NT AUTHORITY\\SYSTEM - CVE-2007-5756 - To exploit this vulnerability, an attacker can authenticate as the SYSTEM or NT AUTHORITY\\SYSTEM user and make a crafted IOCTL request to the bpf_filter_init function."}, {"techniqueID": "TA0002", "comment": "Inject a new program (Execute File) - CVE-2007-5756 - An attacker can inject a new program to exploit this vulnerability, for example, by using a crafted IOCTL request."}, {"techniqueID": "TA0003", "comment": "Create a new process (Process Creation) - CVE-2007-5756 - An attacker can create a new process to exploit this vulnerability, for example, by creating a new process with a crafted IOCTL request."}, {"techniqueID": "TA0004", "comment": "Write data to memory (Command Execution) - CVE-2007-5756 - An attacker can write data to memory to exploit this vulnerability, for example, by executing a crafted IOCTL request."}, {"techniqueID": "TA0009", "comment": "Invoke File Download (File and Archive Management) - CVE-2007-5756 - An attacker can invoke file download to exploit this vulnerability, for example, by downloading a crafted file."}, {"techniqueID": "TA0010", "comment": "Create a new account (Account Creation) - CVE-2007-5756 - An attacker can create a new account to exploit this vulnerability, for example, by creating a new account with a crafted IOCTL request."}, {"techniqueID": "TA0011", "comment": "Impersonate a user (Privilege Escalation) - CVE-2007-5756 - An attacker can impersonate a user to exploit this vulnerability, for example, by impersonating a SYSTEM or NT AUTHORITY\\SYSTEM user."}], "stix_bundle": "{\"bundle\": {\"id\": \"CVE-2007-5756_Bundle\", \"type\": \"bundle\", \"created_by_ref\": \"https://stix2.readthedocs.io/en/latest/\", \"created\": \"2024-02-09T03:13:48.570\", \"modified\": \"2024-02-09T03:13:48.570\", \"objects\": [{\"type\": \"indicator\", \"id\": \"CVE-2007-5756_Indicator\", \"name\": \"CVE-2007-5756 Indicator\", \"description\": \"Indicator for CVE-2007-5756 vulnerability\", \"created_by_ref\": \"https://stix2.readthedocs.io/en/latest/\", \"created\": \"2024-02-09T03:13:48.570\", \"modified\": \"2024-02-09T03:13:48.570\"}, {\"type\": \"campaign\", \"id\": \"CVE-2007-5756_Campaign\", \"name\": \"CVE-2007-5756 Campaign\", \"description\": \"Campaign for CVE-2007-5756 vulnerability\", \"created_by_ref\": \"https://stix2.readthedocs.io/en/latest/\", \"created\": \"2024-02-09T03:13:48.570\", \"modified\": \"2024-02-09T03:13:48.570\"}, {\"type\": \"course_of_action\", \"id\": \"CVE-2007-5756_COA\", \"name\": \"CVE-2007-5756 Course of Action\", \"description\": \"Course of Action for CVE-2007-5756 vulnerability\", \"created_by_ref\": \"https://stix2.readthedocs.io/en/latest/\", \"created\": \"2024-02-09T03:13:48.570\", \"modified\": \"2024-02-09T03:13:48.570\"}, {\"type\": \"container\", \"id\": \"CVE-2007-5756_Container\", \"name\": \"CVE-2007-5756 Container\", \"description\": \"Container for CVE-2007-5756 vulnerability\", \"created_by_ref\": \"https://stix2.readthedocs.io/en/latest/\", \"created\": \"2024-02-09T03:13:48.570\", \"modified\": \"2024-02-09T03:13:48.570\"}, {\"type\": \"note\", \"id\": \"CVE-2007-5756_Note\", \"name\": \"CVE-2007-5756 Note\", \"description\": \"Note for CVE-2007-5756 vulnerability\", \"created_by_ref\": \"https://stix2.readthedocs.io/en/latest/\", \"created\": \"2024-02-09T03:13:48.570\", \"modified\": \"2024-02-09T03:13:48.570\"}], \"relationships\": [{\"from\": \"CVE-2007-5756_Indicator\", \"to\": \"CVE-2007-5756_Campaign\"}]}", "technical_analysis": {"Introduction": "The CVE-2007-5756 vulnerability is a serious security flaw in the WinPcap NPF.SYS driver that allows an attacker to gain privileges by making a crafted IOCTL request.", "Impact and Scope": "The vulnerability affects all systems that use the WinPcap NPF.SYS driver, including Windows XP, Windows 2003, and Windows Vista, with a CVSS score of 6.9 (MEDIUM). The attack vector is LOCAL.", "Related MITRE ATT&CK Techniques": "TA0001, TA0002, TA0003, TA0004, TA0009, TA0010, TA0011", "Technical Details": "The vulnerability is caused by an array index error in the bpf_filter_init function, which can be exploited by an attacker to inject a new program, create a new process, write data to memory, invoke file download, create a new account, and impersonate a user.", "Detection": "The vulnerability can be detected by monitoring for unusual network traffic patterns, such as attempts to access the NPF.SYS driver, and by analyzing system logs for signs of privilege escalation.", "Mitigation": "The vulnerability can be mitigated by applying a patch, disabling the NPF.SYS driver, and monitoring for suspicious network traffic patterns.", "Conclusion": "The CVE-2007-5756 vulnerability is a serious security flaw that can be exploited by attackers to gain privileges. It is essential to apply a patch, disable the NPF.SYS driver, and monitor for suspicious network traffic patterns to mitigate the risk."}, "executive_analysis": {"Overview": "The CVE-2007-5756 vulnerability is a critical security flaw that affects all systems that use the WinPcap NPF.SYS driver.", "Business Impact": "The vulnerability can be exploited to gain privileges, which can lead to unauthorized access to sensitive data and systems.", "Technical Impact": "The vulnerability is caused by an array index error in the bpf_filter_init function, which can be exploited by an attacker to inject a new program, create a new process, write data to memory, invoke file download, create a new account, and impersonate a user.", "Mitigation Strategies": "Apply a patch, disable the NPF.SYS driver, and monitor for suspicious network traffic patterns.", "Recommendations": "Apply a patch, disable the NPF.SYS driver, and monitor for suspicious network traffic patterns. Also, consider implementing additional security controls, such as network segmentation and access controls, to prevent unauthorized access.", "Conclusions": "The CVE-2007-5756 vulnerability is a critical security flaw that requires immediate attention. It is essential to apply a patch, disable the NPF.SYS driver, and monitor for suspicious network traffic patterns to mitigate the risk."}}