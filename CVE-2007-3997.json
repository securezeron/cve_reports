{"id": "CVE-2007-3997", "sourceIdentifier": "cve@mitre.org", "published": "2007-09-04T18:17:00.000", "lastModified": "2018-10-26T13:59:38.397", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The (1) MySQL and (2) MySQLi extensions in PHP 4 before 4.4.8, and PHP 5 before 5.2.4, allow remote attackers to bypass safe_mode and open_basedir restrictions via MySQL LOCAL INFILE operations, as demonstrated by a query with LOAD DATA LOCAL INFILE."}, {"lang": "es", "value": "Las extensiones (1) MySQL y (2) MySQLi en PHP 4 anterior a 4.4.8, y PHP 5 anterior a  5.2.4, permite a atacantes remotos evitar las restricciones safe_mode y open_basedir a trav\u00e9s de operaciones MySQL LOCAL INFILE, como se demostr\u00f3 con un consulta con LOAD DATA LOCAL INFILE."}], "vendorComments": [{"organization": "Mandriva", "comment": "Due to the nature of safe_mode and open_basedir restrictions, and in alignment with the PHP group\u2019s stance on these features, Mandriva does not consider this a security issue.", "lastModified": "2007-09-18T00:00:00"}, {"organization": "Red Hat", "comment": "We do not consider these to be security issues.  For more details see http://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=169857#c1\nand http://www.php.net/security-note.php\n", "lastModified": "2007-09-05T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.4.8", "matchCriteriaId": "F6C219FD-2507-491C-B38F-777D1A626FEC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.0.0", "versionEndExcluding": "5.2.4", "matchCriteriaId": "EABE00F5-DB5A-480D-8D77-73C04DBAB2A0"}]}]}], "references": [{"url": "http://secunia.com/advisories/26642", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/26822", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/26838", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/27102", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/27377", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/28318", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://securityreason.com/securityalert/3102", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "http://secweb.se/en/advisories/php-mysql-safe-mode-bypass-vulnerability/", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "http://www.gentoo.org/security/en/glsa/glsa-200710-02.xml", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.php.net/ChangeLog-4.php", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.php.net/ChangeLog-5.php#5.2.4", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.php.net/releases/4_4_8.php", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.php.net/releases/5_2_4.php", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.trustix.org/errata/2007/0026/", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.vupen.com/english/advisories/2007/3023", "source": "cve@mitre.org", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2008/0059", "source": "cve@mitre.org", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/36384", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/39402", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://issues.rpath.com/browse/RPL-1693", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "https://issues.rpath.com/browse/RPL-1702", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "https://www.exploit-db.com/exploits/4392", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2007-3997 - MySQL LOAD DATA LOCAL INFILE allows remote attackers to bypass safe_mode and open_basedir restrictions, potentially leading to code execution or data exfiltration."}], "stix_bundle": {"type": "bundle", "id": "urn:uuid:41a02a33-1bcc-4c6e-ad33-8cc58a88edd1", "created_by_ref": "urn:uuid:41a02a33-1bcc-4c6e-ad33-8cc58a88edd1", "modified": "2022-01-01T14:30:00.000Z", "objects": [{"type": "vulnerability", "id": "urn:uuid:41a02a33-1bcc-4c6e-ad33-8cc58a88edd1", "description": [{"lang": "en", "value": "CVE-2007-3997 - MySQL LOAD DATA LOCAL INFILE allows remote attackers to bypass safe_mode and open_basedir restrictions, potentially leading to code execution or data exfiltration."}], "attributed_to": [{"type": "organization", "id": "urn:uuid:41a02a33-1bcc-4c6e-ad33-8cc58a88edd1", "name": "Apache"}], "related_to": [{"type": "technique", "id": "urn:uuid:41a02a33-1bcc-4c6e-ad33-8cc58a88edd1", "name": "T1190"}], "analysis": {"description": [{"lang": "en", "value": "This vulnerability allows remote attackers to bypass safe_mode and open_basedir restrictions, potentially leading to code execution or data exfiltration."}]}}], "relationships": [{"type": "has_part", "id": "urn:uuid:41a02a33-1bcc-4c6e-ad33-8cc58a88edd1", "source_ref": "urn:uuid:41a02a33-1bcc-4c6e-ad33-8cc58a88edd1", "target_ref": "urn:uuid:41a02a33-1bcc-4c6e-ad33-8cc58a88edd1"}]}, "technical_analysis": {"Introduction": "This vulnerability, CVE-2007-3997, allows remote attackers to bypass safe_mode and open_basedir restrictions in MySQL, potentially leading to code execution or data exfiltration.", "Impact and Scope": "The impact of this vulnerability is significant, as it allows remote attackers to bypass safety restrictions and potentially execute malicious code or exfiltrate sensitive data.", "Related MITRE ATT&CK Techniques": "The T1190 - Exploit Public-Facing Application technique is relevant to this vulnerability, as it allows attackers to exploit the vulnerability to execute malicious code.", "Technical Details": "The vulnerability occurs due to a vulnerability in the MySQL LOAD DATA LOCAL INFILE function, which allows remote attackers to bypass safe_mode and open_basedir restrictions.", "Detection": "Detecting this vulnerability requires a thorough analysis of network traffic and system logs to identify suspicious activity.", "Mitigation": "Mitigation strategies include updating MySQL to a version that fixes the vulnerability, disabling remote access to the database, and implementing additional security controls.", "Conclusion": "In conclusion, CVE-2007-3997 is a significant vulnerability that allows remote attackers to bypass security restrictions and potentially execute malicious code or exfiltrate sensitive data. It is crucial to implement effective mitigation strategies to prevent exploitation."}, "executive_analysis": {"Overview": "This analysis provides an overview of the impact of CVE-2007-3997 on the organization's systems and data.", "Business Impact": "The business impact of this vulnerability is significant, as it could lead to data breaches and reputational damage.", "Technical Impact": "The technical impact is equally significant, as it could allow attackers to execute malicious code or exfiltrate sensitive data.", "Mitigation Strategies": "Recommendations include updating MySQL to a version that fixes the vulnerability, disabling remote access to the database, and implementing additional security controls.", "Recommendations": "Based on this analysis, we recommend that the organization take immediate action to update MySQL and implement additional security controls to prevent exploitation.", "Conclusions": "In conclusion, CVE-2007-3997 is a critical vulnerability that requires immediate attention and action to prevent exploitation and protect against potential threats."}}