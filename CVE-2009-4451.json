{"id": "CVE-2009-4451", "sourceIdentifier": "cve@mitre.org", "published": "2009-12-29T20:41:20.563", "lastModified": "2009-12-30T05:00:00.000", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Unrestricted file upload vulnerability in upper.php in kandalf upper 0.1 allows remote attackers to execute arbitrary code by uploading a file with an executable extension, then accessing it via a direct request to the file in fileup/."}, {"lang": "es", "value": "Vulnerabilidad de subida no restringida de ficheros en upper.php en kandalf versiones superiores a v0.1 permite a atacantes remotos ejecutar c\u00f3digo de su elecci\u00f3n al subir un fichero con una extensi\u00f3n ejecutable, accediendo posteriormente mediante una petici\u00f3n directa del fichero en fileup/."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php.html:kandalf_upper:0.1:*:*:*:*:*:*:*", "matchCriteriaId": "B732CD77-A268-41B0-B240-8510C83C163F"}]}]}], "references": [{"url": "http://osvdb.org/61370", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/37946", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.exploit-db.com/exploits/10672", "source": "cve@mitre.org", "tags": ["Exploit"]}], "techniques": [{"techniqueID": "T1086", "comment": "PHP File Inclusion - This technique is relevant to CVE-2009-4451 as it involves unrestricted file upload vulnerability in upper.php in kandalf upper 0.1 allowing remote attackers to execute arbitrary code. Defending against this involves implementing proper file inclusion filters and validating file types."}, {"techniqueID": "T1190", "comment": "Exploit Public-Facing Application - This technique is relevant to CVE-2009-4451 as the vulnerability allows attackers to execute arbitrary code by uploading a file with an executable extension. Defending against this involves monitoring and blocking public-facing applications from being exploited."}, {"techniqueID": "T1204", "comment": "File and Directory Discovery - This technique is relevant to CVE-2009-4451 as it involves discovering file and directory information on the target system. Defending against this involves implementing access controls and restricting file and directory access."}, {"techniqueID": "T1210", "comment": "Exploit Public-Facing Application - This technique is relevant to CVE-2009-4451 as the vulnerability allows attackers to execute arbitrary code by accessing the uploaded file in fileup/. Defending against this involves monitoring and blocking public-facing applications from being exploited."}], "stix_bundle": "{ \"stix\": { \"objects\": [ { \"id\": \"CVE-2009-4451\", \"type\": \"vulnerability\", \"description\": \"Unrestricted file upload vulnerability in upper.php in kandalf upper 0.1 allows remote attackers to execute arbitrary code by uploading a file with an executable extension, then accessing it via a direct request to the file in fileup/.\", \"related_threat_actors\": [], \"related_threat_motivations\": [], \"related_tactics\": [' Command and Control', 'Defense Evasion', 'Execution'], \"related_course_of_actions\": ['Avoid', 'Detect', 'Mitigate'], \"related_defense_requirements\": ['AVSEC', 'FIREWALL', 'IDFENSE', 'IPS', 'NIDS', 'Vulnerability Management'], \"additional_attributes\": [ { \"name\": \"cvss_score\", \"value\": 6.8 }, { \"name\": \"attack_vector\", \"value\": \"NETWORK\" } ] }, { \"id\": \"T1086\", \"type\": \"attack-pattern\", \"description\": \"PHP File Inclusion\", \"related_vulnerabilities\": [ \"CVE-2009-4451\" ], \"related_course_of_actions\": [ \"T1086\" ], \"related_defense_requirements\": ['AVSEC', 'FIREWALL', 'IDFENSE', 'IPS', 'NIDS', 'Vulnerability Management'] }, { \"id\": \"T1190\", \"type\": \"attack-pattern\", \"description\": \"Exploit Public-Facing Application\", \"related_vulnerabilities\": [ \"CVE-2009-4451\" ], \"related_course_of_actions\": [ \"T1190\" ], \"related_defense_requirements\": ['AVSEC', 'FIREWALL', 'IDFENSE', 'IPS', 'NIDS', 'Vulnerability Management'] }, { \"id\": \"T1204\", \"type\": \"attack-pattern\", \"description\": \"File and Directory Discovery\", \"related_vulnerabilities\": [ \"CVE-2009-4451\" ], \"related_course_of_actions\": [ \"T1204\" ], \"related_defense_requirements\": ['AVSEC', 'FIREWALL', 'IDFENSE', 'IPS', 'NIDS', 'Vulnerability Management'] }, { \"id\": \"T1210\", \"type\": \"attack-pattern\", \"description\": \"Exploit Public-Facing Application\", \"related_vulnerabilities\": [ \"CVE-2009-4451\" ], \"related_course_of_actions\": [ \"T1210\" ], \"related_defense_requirements\": ['AVSEC', 'FIREWALL', 'IDFENSE', 'IPS', 'NIDS', 'Vulnerability Management'] } ] } }", "technical_analysis": {"Introduction": "CVE-2009-4451 is an unrestricted file upload vulnerability in upper.php in kandalf upper 0.1, allowing remote attackers to execute arbitrary code. This vulnerability is exploited by uploading a file with an executable extension and then accessing it via a direct request to the file in fileup/", "Impact and Scope": "CVSS Score: 6.8, Attack Vector: NETWORK", "Related MITRE ATT&CK Techniques": "T1086, T1190, T1204, T1210", "Technical Details": "The vulnerability occurs when the web application fails to properly validate and restrict the types of files that can be uploaded.", "Detection": "Monitoring for unknown files or modifications to the file system", "Mitigation": "Implementing file inclusion filters and validating file types, restricting access to fileup/, and monitoring for unknown files or modifications to the file system", "Conclusion": "The exploited file can be used to execute arbitrary code, making it a critical vulnerability that requires immediate attention"}, "executive_analysis": {"Overview": "CVE-2009-4451 is a critical vulnerability that can be exploited to execute arbitrary code and poses a significant risk to the organization.", "Business Impact": "The vulnerability can lead to data breaches, unauthorized access, and loss of sensitive information.", "Technical Impact": "The vulnerability affects the confidentiality, integrity, and availability of the system", "Mitigation Strategies": "Implementing file inclusion filters, validating file types, and restricting access to fileup/", "Recommendations": "Patch the vulnerability as soon as possible and conduct a thorough security audit to identify and remediate any other vulnerabilities.", "Conclusions": "The exploited file can be used to execute arbitrary code, making it a critical vulnerability that requires immediate attention"}}