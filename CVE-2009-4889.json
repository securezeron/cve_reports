{"id": "CVE-2009-4889", "sourceIdentifier": "cve@mitre.org", "published": "2010-06-11T14:30:16.457", "lastModified": "2017-09-19T01:30:06.953", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "SQL injection vulnerability in books.php in the Book Panel (book_panel) module for PHP-Fusion allows remote attackers to execute arbitrary SQL commands via the bookid parameter."}, {"lang": "es", "value": "Vulnerabilidad de inyecci\u00f3n SQL en books.php en el m\u00f3dulo Book Panel (book_panel) de PHP-Fusion permite a los atacantes remotos ejecutar a su elecci\u00f3n comandos SQL a trav\u00e9s del par\u00e1metro bookid."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:basti2web:book_panel:*:*:*:*:*:*:*:*", "matchCriteriaId": "2996AC96-B1C3-4F30-B628-3079B8831DE2"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:a:php-fusion:php-fusion:*:*:*:*:*:*:*:*", "matchCriteriaId": "8E3E18BD-EA3F-4136-A256-A6A74F7066DD"}]}]}], "references": [{"url": "http://www.exploit-db.com/exploits/8186", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/34049", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/49160", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2009-4889 - SQL injection vulnerability, this technique could be used by attackers to execute arbitrary SQL commands, exploited using crafted inputs and user interaction, defenses include input validation and sanitization, and whitelisting"}, {"techniqueID": "T1190", "comment": "CVE-2009-4889 - Exploitation of a vulnerability, this technique could be used by attackers to exploit the SQL injection vulnerability, exploited using crafted inputs and user interaction, defenses include patching and updating to the latest version of PHP-Fusion, and implementing a web application firewall"}, {"techniqueID": "T1027", "comment": "CVE-2009-4889 - Command and Control, this technique could be used by attackers to establish a command and control channel after exploiting the SQL injection vulnerability, exploited using crafted inputs and user interaction, defenses include network traffic monitoring and analysis, and implementing a intrusion detection system"}], "stix_bundle": {"packages": [{"type": "package", "id": "cve-2009-4889", "title": "CVE-2009-4889 - SQL Injection Vulnerability in PHP-Fusion", "description": "This STIX bundle describes a SQL injection vulnerability in PHP-Fusion, a popular open-source content management system.", "objects": [{"type": "vulnerability", "id": "cve-2009-4889", "title": "CVE-2009-4889 - SQL Injection Vulnerability in PHP-Fusion", "description": "A SQL injection vulnerability exists in the 'books.php' script in the 'book_panel' module of PHP-Fusion, allowing an attacker to execute arbitrary SQL commands.", "severity": "HIGH", "references": [{"type": "reference", "id": "CVE-2009-4889", "title": "CVE-2009-4889", "description": "A SQL injection vulnerability exists in the 'books.php' script in the 'book_panel' module of PHP-Fusion, allowing an attacker to execute arbitrary SQL commands."}]}, {"type": "technique", "id": "T1059", "title": "T1059 - Command Injection", "description": "T1059 is a technique used to inject malicious commands into a running program, potentially allowing an attacker to execute arbitrary commands."}, {"type": "technique", "id": "T1190", "title": "T1190 - Exploitation of Remotely Accessible Components", "description": "T1190 is a technique used to exploit vulnerabilities in remotely accessible components, potentially allowing an attacker to gain unauthorized access to a system."}, {"type": "technique", "id": "T1027", "title": "T1027 - Command and Control", "description": "T1027 is a technique used to establish a command and control channel with a compromised system, potentially allowing an attacker to execute arbitrary commands."}], " relationships": [{"type": "relationship", "id": "cve-2009-4889-T1059", "description": "This relationship shows that the SQL injection vulnerability (CVE-2009-4889) can be exploited using the Command Injection technique (T1059)."}, {"type": "relationship", "id": "cve-2009-4889-T1190", "description": "This relationship shows that the SQL injection vulnerability (CVE-2009-4889) can be exploited using the Exploitation of Remotely Accessible Components technique (T1190)."}, {"type": "relationship", "id": "cve-2009-4889-T1027", "description": "This relationship shows that the SQL injection vulnerability (CVE-2009-4889) can be used to establish a command and control channel with a compromised system (T1027)."}]}]}, "technical_analysis": {"Introduction": "SQL injection vulnerabilities are a common type of vulnerability in web applications, allowing attackers to execute arbitrary SQL commands and potentially gain unauthorized access to sensitive data.", "Impact and Scope": "The vulnerability exists in the 'books.php' script in the 'book_panel' module of PHP-Fusion, and allows an attacker to execute arbitrary SQL commands. This can result in the theft of sensitive data, modification of data, or even complete control of the database.\n\nThe vulnerability is exploitable remotely and can be exploited by an attacker with minimal permissions.", "Related MITRE ATT&CK Techniques": "T1059, T1190, T1027", "Technical Details": "The vulnerability exists in the 'books.php' script in the 'book_panel' module of PHP-Fusion, and allows an attacker to execute arbitrary SQL commands. This is achieved by injecting malicious input into the 'bookid' parameter of the 'books.php' script.", "Detection": "Detection methods include monitoring for unusual network traffic, reviewing system logs for suspicious activity, and implementing a web application firewall.", "Mitigation": "Mitigation strategies include patching and updating to the latest version of PHP-Fusion, implementing a web application firewall, and modifying the 'books.php' script to sanitize user input.", "Conclusion": "In conclusion, the SQL injection vulnerability in PHP-Fusion is a critical issue that requires immediate attention. Implementing mitigation strategies and monitoring for suspicious activity is crucial to preventing exploitation of this vulnerability."}, "executive_analysis": {"Overview": "The SQL injection vulnerability in PHP-Fusion is a critical issue that requires immediate attention.", "Business Impact": "The vulnerability can result in the theft of sensitive data, modification of data, or even complete control of the database.", "Technical Impact": "The vulnerability exists in the 'books.php' script in the 'book_panel' module of PHP-Fusion, and allows an attacker to execute arbitrary SQL commands.", "Mitigation Strategies": "Patching and updating to the latest version of PHP-Fusion, implementing a web application firewall, and modifying the 'books.php' script to sanitize user input.", "Recommendations": "Immediately patch and update to the latest version of PHP-Fusion, implement a web application firewall, and monitor for suspicious activity.", "Conclusions": "In conclusion, the SQL injection vulnerability in PHP-Fusion is a critical issue that requires immediate attention. Implementing mitigation strategies and monitoring for suspicious activity is crucial to preventing exploitation of this vulnerability."}}