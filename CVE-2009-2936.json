{"id": "CVE-2009-2936", "sourceIdentifier": "cve@mitre.org", "published": "2010-04-05T16:30:00.453", "lastModified": "2024-08-07T06:16:44.833", "vulnStatus": "Modified", "cveTags": [{"sourceIdentifier": "cve@mitre.org", "tags": ["disputed"]}], "descriptions": [{"lang": "en", "value": "The Command Line Interface (aka Server CLI or administration interface) in the master process in the reverse proxy server in Varnish before 2.1.0 does not require authentication for commands received through a TCP port, which allows remote attackers to (1) execute arbitrary code via a vcl.inline directive that provides a VCL configuration file containing inline C code; (2) change the ownership of the master process via param.set, stop, and start directives; (3) read the initial line of an arbitrary file via a vcl.load directive; or (4) conduct cross-site request forgery (CSRF) attacks that leverage a victim's location on a trusted network and improper input validation of directives.  NOTE: the vendor disputes this report, saying that it is \"fundamentally misguided and pointless."}, {"lang": "es", "value": "** DISPUTADA** La interfase de l\u00ednea de comandos (tambi\u00e9n conocida como Server CLI o interfase de administraci\u00f3n) en el proceso maestro en el \"reverse proxy server\" en Varnish anteriores a v2.1.0 no requiere autenticaci\u00f3n para comandos recibidos a trav\u00e9s del puerto TCP, lo que permite a atacantes remotos (1) ejecutar c\u00f3digo de su elecci\u00f3n a trav\u00e9s de una directiva vcl.inline que provee un fichero de configuraci\u00f3n c\u00f3digo C; (2) cambiar el propietario del proceso maestro a trav\u00e9s de directivas param.set, stop y start: (3) leer la l\u00ednea iniciar de un fichero de su elecci\u00f3n a trav\u00e9s de la directiva vcl.load; o (4) conducir un ataque de falsificaci\u00f3n de petici\u00f3n en sitios cruzados que muestren la localizaci\u00f3n de la v\u00edctima en una red segura y una validaci\u00f3n de entrada impropia de directivas. NOTA: el desarollador disputa este informe diciendo que es \"equivocada y sin sentido\"."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-287"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:0.9:*:*:*:*:*:*:*", "matchCriteriaId": "84D5B200-B3CE-4B3E-A64B-DEC2F1DFBA74"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:0.9.1:*:*:*:*:*:*:*", "matchCriteriaId": "163F7D79-3CDE-4022-AE54-AF4EB1E2BCDB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:1.0:*:*:*:*:*:*:*", "matchCriteriaId": "33A9C306-D088-477A-B5B1-A840083367C4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:1.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "6E59746B-600B-4086-B9DA-CC24C5D5C16D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:1.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "A70BA8DB-D016-4970-9026-A86A96CFEBAB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:1.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "A502A298-F6E6-4E37-9CF1-CBD6AC9E36E6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:1.0.4:*:*:*:*:*:*:*", "matchCriteriaId": "58BD6EC1-A38B-4761-BFC7-B0393C2FE48B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:1.1:*:*:*:*:*:*:*", "matchCriteriaId": "1D073F3A-4EBD-4144-B394-6DC998061CEE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:1.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "C33268B6-8F60-4502-9ECC-4F8465FA0AD8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:1.1.2:*:*:*:*:*:*:*", "matchCriteriaId": "F9BC6E22-867E-4A2F-92EC-177611047245"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:2.0:*:*:*:*:*:*:*", "matchCriteriaId": "3D1A460C-DBD9-4D08-B835-6897F6DA3611"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:2.0:beta1:*:*:*:*:*:*", "matchCriteriaId": "8C0DB8AF-F472-41CD-9CCD-A295B5517894"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:2.0:beta2:*:*:*:*:*:*", "matchCriteriaId": "F92062C5-6288-4244-B786-4621CC16A188"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:2.0:rc1:*:*:*:*:*:*", "matchCriteriaId": "0B559DD9-1FD3-45CB-8070-A899E9FADE16"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:2.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "44BEBA6C-F548-416F-8507-9578857ED384"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:2.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "7066D53C-8A0E-4875-9931-C593865AF6E4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:2.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "8F6CFA79-0172-47FB-9328-0278D1C3CC71"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:2.0.4:*:*:*:*:*:*:*", "matchCriteriaId": "C2F74286-4A7B-44B9-9AB1-CF39046F9D01"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:2.0.5:*:*:*:*:*:*:*", "matchCriteriaId": "5FFFD248-824B-47BE-AE16-A433E3C8AD56"}, {"vulnerable": true, "criteria": "cpe:2.3:a:varnish.projects.linpro:varnish:2.0.6:*:*:*:*:*:*:*", "matchCriteriaId": "D7EE367F-581D-41CC-A92C-699B7E6704E4"}]}]}], "references": [{"url": "http://lists.fedoraproject.org/pipermail/package-announce/2010-April/040359.html", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/510360/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/510368/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.varnish-cache.org/changeset/3865", "source": "cve@mitre.org"}, {"url": "http://www.varnish-cache.org/wiki/CLI", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0005", "comment": "CVE-2009-2936 - An attacker can execute arbitrary code or conduct cross-site scripting attacks by exploiting the lack of authentication for commands received through a TCP port in the Varnish reverse proxy server."}, {"techniqueID": "TA0002", "comment": "CVE-2009-2936 - An attacker can read files or change the ownership of the master process by using specially crafted commands in the Varnish reverse proxy server."}], "stix_bundle": {"objects": [{"type": "indicator", "id": "i-12345", "name": "Vulnerable Varnish Reverse Proxy Server", "description": "The Varnish reverse proxy server is vulnerable to exploitation", "created_by_ref": "u-12345", "modified": "2024-08-07T06:16:44.833Z", "created": "2024-08-07T06:16:44.833Z", "sto": "Object", " relations": [{"type": "has-note", "id": "n-12345", "object_id": "i-12345"}, {"type": "encapsulates", "id": "c-12345", "object_id": "t-12345"}]}, {"type": "intrusion-set", "id": "i-56789", "name": "Vulnerable Varnish Reverse Proxy Attack", "description": "An attacker exploits the vulnerable Varnish reverse proxy server", "created_by_ref": "u-12345", "modified": "2024-08-07T06:16:44.833Z", "created": "2024-08-07T06:16:44.833Z", "relations": [{"type": "was-involves", "id": "r-12345", "object_id": "i-56789"}]}, {"type": "course-of-action", "id": "c-12345", "name": "Patch the Varnish reverse proxy server", "description": "Update the Varnish reverse proxy server to version 2.1.0 or later", "created_by_ref": "u-12345", "modified": "2024-08-07T06:16:44.833Z", "created": "2024-08-07T06:16:44.833Z", " Relations": [{"type": "mitigates", "id": "m-12345", "object_id": "i-56789"}]}, {"type": "note", "id": "n-12345", "name": "Exploitation of Varnish Reverse Proxy Server", "description": "An attacker can exploit the Varnish reverse proxy server", "created_by_ref": "u-12345", "modified": "2024-08-07T06:16:44.833Z", "created": "2024-08-07T06:16:44.833Z", " Relations": [{"type": "has-source", "id": "s-12345", "object_id": "n-12345"}]}]}, "technical_analysis": {"Introduction": "The Varnish reverse proxy server is vulnerable to exploitation due to the lack of authentication for commands received through a TCP port.", "Impact and Scope": "The impact of this vulnerability is high, as it allows an attacker to execute arbitrary code or conduct cross-site scripting attacks.", "Related MITRE ATT&CK Techniques": "TA0005: Defense in Depth and TA0002: Command and Control", "Technical Details": "The vulnerability is caused by the lack of authentication for commands received through a TCP port in the Varnish reverse proxy server.", "Detection": "Detection methods include monitoring for suspicious network traffic and analyzing system logs for signs of exploitation.", "Mitigation": "Mitigation strategies include patching the Varnish reverse proxy server and implementing additional security controls.", "Conclusion": "In conclusion, the vulnerable Varnish reverse proxy server is a threat to security and should be patched as soon as possible."}, "executive_analysis": {"Overview": "The Varnish reverse proxy server is vulnerable to exploitation, which could result in significant financial losses and reputational damage.", "Business Impact": "The business impact of this vulnerability is high, as it allows an attacker to compromise sensitive information and disrupt business operations.", "Technical Impact": "The technical impact is also high, as it allows an attacker to compromise the confidentiality, integrity, and availability of sensitive information.", "Mitigation Strategies": "Mitigation strategies include patching the Varnish reverse proxy server and implementing additional security controls.", "Recommendations": "Recommendations for executives include prioritizing the patching of vulnerable systems and implementing additional security controls.", "Conclusions": "In conclusion, the vulnerable Varnish reverse proxy server is a threat to security and should be prioritized for remediation."}}