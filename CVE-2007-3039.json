{"id": "CVE-2007-3039", "sourceIdentifier": "secure@microsoft.com", "published": "2007-12-12T00:46:00.000", "lastModified": "2018-10-16T16:47:05.713", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Stack-based buffer overflow in the Microsoft Message Queuing (MSMQ) service in Microsoft Windows 2000 Server SP4, Windows 2000 Professional SP4, and Windows XP SP2 allows attackers to execute arbitrary code via a long string in an opnum 0x06 RPC call to port 2103.  NOTE: this is remotely exploitable on Windows 2000 Server."}, {"lang": "es", "value": "Un desbordamiento de b\u00fafer en la regi\u00f3n stack de la memoria en el servicio Microsoft Message Queuing Service (MSMQ) en Microsoft Windows 2000 Server SP4, Windows 2000 Professional SP4 y Windows XP SP2 permite a los atacantes ejecutar c\u00f3digo arbitrario por medio  de una cadena larga en una llamada RPC 0x06 opnum al puerto 2103. NOTA: esto es explotable de forma remota en Windows 2000 Server."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_2000:*:sp4:pro:*:*:*:*:*", "matchCriteriaId": "C6C99A6D-BE32-4634-9261-81E26983FB84"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_2000:*:sp4:srv:*:*:*:*:*", "matchCriteriaId": "F200FFC6-7D0E-4500-AB65-8785FD1EEC24"}, {"vulnerable": false, "criteria": "cpe:2.3:o:microsoft:windows_xp:*:sp2:*:*:*:*:*:*", "matchCriteriaId": "9B339C33-8896-4896-88FF-88E74FDBC543"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:microsoft:message_queuing:*:*:*:*:*:*:*:*", "matchCriteriaId": "F31DB341-76D4-44F6-B0DD-107775495110"}]}]}], "references": [{"url": "http://secunia.com/advisories/28011", "source": "secure@microsoft.com", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/28051", "source": "secure@microsoft.com", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/484891/100/0/threaded", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/archive/1/485268/100/0/threaded", "source": "secure@microsoft.com"}, {"url": "http://www.securityfocus.com/bid/26797", "source": "secure@microsoft.com"}, {"url": "http://www.securitytracker.com/id?1019077", "source": "secure@microsoft.com"}, {"url": "http://www.us-cert.gov/cas/techalerts/TA07-345A.html", "source": "secure@microsoft.com", "tags": ["US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2007/4181", "source": "secure@microsoft.com"}, {"url": "http://www.zerodayinitiative.com/advisories/ZDI-07-076.html", "source": "secure@microsoft.com"}, {"url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2007/ms07-065", "source": "secure@microsoft.com"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A4474", "source": "secure@microsoft.com"}, {"url": "https://www.exploit-db.com/exploits/4745", "source": "secure@microsoft.com"}, {"url": "https://www.exploit-db.com/exploits/4760", "source": "secure@microsoft.com"}, {"url": "https://www.exploit-db.com/exploits/4934", "source": "secure@microsoft.com"}], "techniques": [{"techniqueID": "T1204", "comment": "T1204: Buffer Copy without Checking Size of Input (Fixed in SP4) - This technique is relevant because it describes a buffer overflow vulnerability that can be exploited by an attacker to execute arbitrary code, which is the same type of vulnerability as CVE-2007-3039."}, {"techniqueID": "T1047", "comment": "T1047: Remote Service Session Abuse - This technique is relevant because it describes a method by which an attacker can establish a remote service session and potentially exploit a vulnerability like CVE-2007-3039 to gain unauthorized access."}, {"techniqueID": "T1064", "comment": "T1064: File and Directory Discovery - This technique is relevant because it describes a method by which an attacker can discover and gather information about files and directories, which could be used to identify potential targets for exploitation, such as systems vulnerable to CVE-2007-3039."}, {"techniqueID": "T1055", "comment": "T1055: File Transfer - This technique is relevant because it describes a method by which an attacker could transfer a file to a system, potentially exploiting a vulnerability like CVE-2007-3039 to gain unauthorized access."}], "stix_bundle": {"bundle": {"type": "bundle", "id": "https://example.com/STIX-Bundle-1.0.json", "label": "STIX Bundle for CVE-2007-3039", "description": "A bundle containing various objects related to CVE-2007-3039, including a vulnerability, techniques, and indicators.", "objects": [{"type": "vulnerability", "id": "https://example.com/CVE-2007-3039-1.0.json", "label": "CVE-2007-3039: Microsoft Windows MSMQ Buffer Overflow", "description": "A vulnerability in Microsoft Windows MSMQ that allows a buffer overflow, potentially leading to remote code execution."}, {"type": "indicator", "id": "https://example.com/CVE-2007-3039-Indicator-1.0.json", "label": "Indicator for CVE-2007-3039", "description": "An indicator that identifies potential targets for exploitation of CVE-2007-3039, including vulnerable systems and network traffic.", "pattern": " patterns to identify affected systems and network traffic"}, {"type": "technique", "id": "https://example.com/T1204-1.0.json", "label": "T1204: Buffer Copy without Checking Size of Input", "description": "A technique used to exploit CVE-2007-3039, in which an attacker copies data from an unknown location into a buffer without verifying the size of the input."}, {"type": "course-of-action", "id": "https://example.com/COA-1.0.json", "label": "Mitigation Strategy: Disable MSMQ Service", "description": "A course of action that recommends disabling the MSMQ service to prevent exploitation of CVE-2007-3039."}, {"type": "note", "id": "https://example.com/Note-1.0.json", "label": "Defensive Measure: Implement Input Validation", "description": "A note that suggests implementing input validation to detect and prevent exploitation of CVE-2007-3039."}], "relationships": [{"type": "related_to", "subject": "https://example.com/CVE-2007-3039-1.0.json", "object": "https://example.com/T1204-1.0.json"}, {"type": "mitigates", "subject": "https://example.com/COA-1.0.json", "object": "https://example.com/CVE-2007-3039-1.0.json"}, {"type": "has_note", "subject": "https://example.com/CVE-2007-3039-1.0.json", "object": "https://example.com/Note-1.0.json"}]}}, "technical_analysis": {"Introduction": "CVE-2007-3039 is a remote buffer overflow vulnerability in Microsoft Windows MSMQ that allows an attacker to execute arbitrary code with elevated privileges.", "Impact and Scope": "The vulnerability affects Microsoft Windows 2000 Server SP4, Microsoft Windows 2000 Professional SP4, and Microsoft Windows XP SP2.", "Related MITRE ATT&CK Techniques": "T1204: Buffer Copy without Checking Size of Input, T1047: Remote Service Session Abuse, T1064: File and Directory Discovery, T1055: File Transfer.", "Technical Details": "The vulnerability is caused by a buffer overflow in the MSMQ service, which can be exploited by an attacker to execute arbitrary code with elevated privileges.", "Detection": "Detection of this vulnerability can be achieved by monitoring network traffic and system logs for suspicious activity, and by running vulnerability scanners and penetration tests.", "Mitigation": "Mitigation strategies include disabling the MSMQ service, implementing input validation, and applying patches and updates from Microsoft.", "Conclusion": "In conclusion, CVE-2007-3039 is a serious remote buffer overflow vulnerability in Microsoft Windows MSMQ that requires immediate attention and mitigation."}, "executive_analysis": {"Overview": "CVE-2007-3039 is a remote buffer overflow vulnerability in Microsoft Windows MSMQ that allows an attacker to execute arbitrary code with elevated privileges.", "Business Impact": "This vulnerability affects Microsoft Windows 2000 Server SP4, Microsoft Windows 2000 Professional SP4, and Microsoft Windows XP SP2, which are widely used in enterprise environments.", "Technical Impact": "The vulnerability can be exploited by an attacker to execute arbitrary code with elevated privileges, potentially leading to unauthorized access and data theft.", "Mitigation Strategies": "Disabling the MSMQ service, implementing input validation, and applying patches and updates from Microsoft are recommended mitigation strategies.", "Recommendations": "Executive management should recommend immediate attention and mitigation to IT teams, and ensure that all affected systems are updated and patched as soon as possible.", "Conclusions": "In conclusion, CVE-2007-3039 is a serious vulnerability that requires immediate attention and mitigation. Executives should prioritize it as high-risk and ensure that all affected systems are updated and patched as soon as possible."}}