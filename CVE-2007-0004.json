{"id": "CVE-2007-0004", "sourceIdentifier": "secalert@redhat.com", "published": "2007-09-18T19:17:00.000", "lastModified": "2008-09-05T21:16:46.527", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The NFS client implementation in the kernel in Red Hat Enterprise Linux (RHEL) 3, when a filesystem is mounted with the noacl option, checks permissions for the open system call via vfs_permission (mode bits) data rather than an NFS ACCESS call to the server, which allows local client processes to obtain a false success status from open calls that the server would deny, and possibly obtain sensitive information about file permissions on the server, as demonstrated in a root_squash environment.  NOTE: it is uncertain whether any scenarios involving this issue cross privilege boundaries."}, {"lang": "es", "value": "La implementaci\u00f3n del cliente NFS en el n\u00facleo de Red Hat Enterprise Linux (RHEL) 3, cuando un sistema de ficheros se monta con la opci\u00f3n noacl, comprueba los permisos para la llamada al sistema open mediante la informaci\u00f3n vfs_permission (bits de modo o mode bits) en lugar de una llamada NFS ACCESS al servidor, lo cual permite a procesos cliente locales obtener un falso estado de \u00e9xito de llamadas a open que el servidor denegar\u00eda, y posiblemente obtener informaci\u00f3n sensible sobre los permisos de fichero en el servidor, como se ha demostrado en un entorno root_squash. NOTA: no est\u00e1 claro si cualquier escenario involucrando este problema cruzan los l\u00edmites de la seguridad."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:P/I:N/A:N", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 1.9}, "baseSeverity": "LOW", "exploitabilityScore": 3.4, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:redhat:enterprise_linux:3.0:*:*:*:*:*:*:*", "matchCriteriaId": "40D8DAE0-8E75-435C-9BD6-FAEED2ACB47C"}]}]}], "references": [{"url": "https://bugzilla.redhat.com/show_bug.cgi?id=199715", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1560", "comment": "CVE-2007-0004 - Accidental credential exposure through NFS client implementation vulnerability, potentially allowing attackers to obtain sensitive file permissions on the server."}, {"techniqueID": "T1555", "comment": "CVE-2007-0004 - NFS client implementation vulnerability, potentially allowing attackers to obtain false success status from open calls, potentially escalating privileges."}, {"techniqueID": "T1190", "comment": "CVE-2007-0004 - NFS client implementation vulnerability, potentially allowing attackers to obtain sensitive information about file permissions on the server, potentially enabling privilege escalation."}], "stix_bundle": {"objects": [{"type": "vx-cve", "id": "CVE-2007-0004", "spec_version": "2.1", "created_by_ref": "https://example.com/test/stix/creator", "created": "2023-02-20T14:30:00.000Z", "modified": "2023-02-20T14:30:00.000Z", "description": "The NFS client implementation in the kernel in Red Hat Enterprise Linux (RHEL) 3, when a filesystem is mounted with the noacl option, checks permissions for the open system call via vfs_permission (mode bits) data rather than an NFS ACCESS call to the server, which allows local client processes to obtain a false success status from open calls that the server would deny, and possibly obtain sensitive information about file permissions on the server.", "categories": [{"category": "Vulnerability"}], "objects": [{"type": "vuln:cve", "id": "CVE-2007-0004", "cve_data_version": "2.0", "cve_id": "CVE-2007-0004", "source": "NVD", "published": "2007-09-18T19:17:00.000Z", "last_modified": "2008-09-05T21:16:46.527Z", "description": "CWE-264", "cvss": {"vector_string": "AV:L/AC:M/Au:N/C:P/I:N/A:N", "base_severity": "LOW", "base_score": 1.9, "exploitability_score": 3.4, "impact_score": 2.9}}]}, {"type": "indicator", "id": "indicator-1", "spec_version": "2.1", "created_by_ref": "https://example.com/test/stix/creator", "created": "2023-02-20T14:30:00.000Z", "modified": "2023-02-20T14:30:00.000Z", "description": "NFS client implementation vulnerability", "types": [{"type": "Network Traffic"}], "where_clauses": [{"selector": "http.request.method == \"open\"", "operand": "and", "operator": "=="}]}, {"type": "course-of-action", "id": "course-of-action-1", "spec_version": "2.1", "created_by_ref": "https://example.com/test/stix/creator", "created": "2023-02-20T14:30:00.000Z", "modified": "2023-02-20T14:30:00.000Z", "description": "Implement additional access controls on NFS shares", "relationship_type": "Mitigates", "object_refs": [{"ref": "T1560"}]}], "relationships": [{"relationship_type": "described-by", "start_node_ref": "CVE-2007-0004", "end_node_ref": "indicator-1"}, {"relationship_type": "mitigated-by", "start_node_ref": "CVE-2007-0004", "end_node_ref": "course-of-action-1"}]}, "technical_analysis": {"Introduction": "CVE-2007-0004 is a vulnerability in the NFS client implementation in the kernel of Red Hat Enterprise Linux 3, allowing local client processes to obtain false success status from open calls and potentially obtain sensitive information about file permissions on the server.", "Impact and Scope": "The vulnerability has a CVSS score of 1.9 and is rated as LOW, with an attack vector of LOCAL and no user interaction required. The impact is PARTIAL confidentiality and no integrity or availability impact.", "Related MITRE ATT&CK Techniques": "T1560, T1555, and T1190", "Technical Details": "The vulnerability allows local client processes to obtain false success status from open calls through the NFS client implementation, potentially escalating privileges.", "Detection": "Detection methods include monitoring for NFS client process behavior, particularly regarding open system calls.", "Mitigation": "Mitigation strategies include implementing additional access controls on NFS shares, disabling NFS mounting with noacl option, and ensuring secure NFS client implementations.", "Conclusion": "CVE-2007-0004 is a vulnerability in the NFS client implementation of Red Hat Enterprise Linux 3, allowing local client processes to obtain false success status from open calls and potentially obtain sensitive information about file permissions on the server."}, "executive_analysis": {"Overview": "CVE-2007-0004 is a vulnerability in the NFS client implementation of Red Hat Enterprise Linux 3, which can be exploited by local attackers to obtain sensitive information and potentially escalate privileges.", "Business Impact": "The vulnerability can lead to unauthorized access to sensitive data and potential security breaches, impacting business operations and reputation.", "Technical Impact": "The vulnerability can be exploited by local attackers to obtain sensitive information and potentially escalate privileges, potentially compromising system security.", "Mitigation Strategies": "Implementing additional access controls on NFS shares and ensuring secure NFS client implementations are key mitigation strategies.", "Recommendations": "Recommendations include upgrading to a patched version of Red Hat Enterprise Linux 3, implementing additional access controls on NFS shares, and ensuring secure NFS client implementations.", "Conclusions": "CVE-2007-0004 is a vulnerability in the NFS client implementation of Red Hat Enterprise Linux 3, which is critical to address to maintain system security and prevent potential breaches."}}