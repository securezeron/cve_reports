{"id": "CVE-2009-1601", "sourceIdentifier": "cve@mitre.org", "published": "2009-05-11T15:30:00.563", "lastModified": "2017-08-17T01:30:25.943", "vulnStatus": "Modified", "cveTags": [], "evaluatorImpact": "Per https://bugs.launchpad.net/ubuntu/+source/clamav/+bug/365823\r\n\r\nA clean install of clamav-milter (0.95.1+dfsg-1ubuntu1.1) causes the root directory to become owned by the clamav user.\r\n\r\nThis was witnessed breaking ssh chroot environment.\r\n\r\nTEST CASE:\r\n- purge any existing clamav-milter installation, make sure you don't have any old /etc/init.d/clamav-milter init script around\r\n- check root directory's owner (should be root:root)\r\n- sudo apt-get install clamav-milter (the last one in Jaunty is 0.95.1+dfsg-1ubuntu1.1)\r\n- after installing the package, clamav-milter will start automatically (at least 'init.d/clamav-milter start' will execute)\r\n- check the root directory's owner:", "descriptions": [{"lang": "en", "value": "The Ubuntu clamav-milter.init script in clamav-milter before 0.95.1+dfsg-1ubuntu1.2 in Ubuntu 9.04 sets the ownership of the current working directory to the clamav account, which might allow local users to bypass intended access restrictions via read or write operations involving this directory."}, {"lang": "es", "value": "El script Ubuntu-clamav milter.init de clamav-milter antes de la versi\u00f3n v0.95.1+dfsg-1ubuntu1.2 en Ubuntu v9.04 establece la propiedad del directorio de trabajo actual a la cuenta clamav, lo que podr\u00eda permitir eludir las restricciones de acceso a los usuarios locales a trav\u00e9s de operaciones lectura o escritura o en este directorio."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.1, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:ubuntu:linux:9.04:*:*:*:*:*:*:*", "matchCriteriaId": "1AA1B57C-E00F-44E7-AB2E-24D689EC878C"}]}]}], "references": [{"url": "http://secunia.com/advisories/35000", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/34818", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://www.ubuntu.com/usn/USN-770-1", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/50311", "source": "cve@mitre.org"}, {"url": "https://launchpad.net/bugs/365823", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1069", "comment": "CVE-2009-1601 - This technique takes advantage of a locally exploitable vulnerability in the Ubuntu clamav-milter.init script, which allows an attacker to bypass access restrictions by setting the ownership of the current working directory to the clamav user."}, {"techniqueID": "T1193", "comment": "CVE-2009-1601 - This technique involves the exploitation of a file system access control vulnerability, allowing an attacker to maintain persistence by setting the ownership of system directories."}], "stix_bundle": {"objects": [{"id": "vulnerability:CVE-2009-1601", "type": "vulnerability", "created_by_ref": "identity:John Doe", "created": "2022-01-01T12:00:00.000Z", "modified": "2022-01-01T12:00:00.000Z", "description": "The Ubuntu clamav-milter.init script in clamav-milter before 0.95.1+dfsg-1ubuntu1.2 in Ubuntu 9.04 sets the ownership of the current working directory to the clamav account, which might allow local users to bypass intended access restrictions via read or write operations involving this directory.", "background": "A clean install of clamav-milter (0.95.1+dfsg-1ubuntu1.1) causes the root directory to become owned by the clamav user.", "remediation": "Apply patch according to vendor advisory", "exploitable": "Yes", "severity": "Medium", " cvss": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.8, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.1, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}, "relevant_actors": [{"id": "actor:A1", "type": "actor", "name": "Local attacker"}], "related_course_of_action": [{"id": "course_of_action:COC-1", "type": "course-of-action", "name": "Apply patch according to vendor advisory", "description": "Apply patch according to vendor advisory", "relevant_technique": "T1069"}, {"id": "course_of_action:COC-2", "type": "course-of-action", "name": "Monitor system logs", "description": "Monitor system logs for suspicious activity", "relevant_technique": "T1193"}]}], "relationships": [{"id": "r1", "type": "has-course-of-action", "source_ref": "vulnerability:CVE-2009-1601", "target_ref": "course_of_action:COC-1"}, {"id": "r2", "type": "has-course-of-action", "source_ref": "vulnerability:CVE-2009-1601", "target_ref": "course_of_action:COC-2"}]}, "technical_analysis": {"Introduction": "This vulnerability is a file system access control vulnerability that allows local attackers to bypass intended access restrictions.", "Impact and Scope": "The vulnerability affects Ubuntu 9.04 and allows local attackers to set the ownership of the current working directory to the clamav user.", "Related MITRE ATT&CK Techniques": "T1069 and T1193", "Technical Details": "The vulnerability is caused by a bug in the clamav-milter.init script, which sets the ownership of the current working directory to the clamav user.", "Detection": "Monitor system logs for suspicious activity", "Mitigation": "Apply patch according to vendor advisory", "Conclusion": "This vulnerability allows local attackers to bypass intended access restrictions and maintain persistence. It is essential to apply the patch according to the vendor advisory and monitor system logs for suspicious activity."}, "executive_analysis": {"Overview": "This vulnerability is a file system access control vulnerability that allows local attackers to bypass intended access restrictions.", "Business Impact": "This vulnerability could allow attackers to maintain persistence and escalate privileges, potentially leading to further exploitation.", "Technical Impact": "This vulnerability affects Ubuntu 9.04 and allows local attackers to set the ownership of the current working directory to the clamav user.", "Mitigation Strategies": "Apply patch according to vendor advisory and monitor system logs for suspicious activity.", "Recommendations": "Apply the patch according to the vendor advisory and implement additional security measures to prevent further exploitation.", "Conclusions": "This vulnerability is a significant risk and requires prompt action to mitigate its effects."}}