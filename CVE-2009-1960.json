{"id": "CVE-2009-1960", "sourceIdentifier": "cve@mitre.org", "published": "2009-06-08T01:00:00.797", "lastModified": "2023-11-07T02:04:03.343", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "inc/init.php in DokuWiki 2009-02-14, rc2009-02-06, and rc2009-01-30, when register_globals is enabled, allows remote attackers to include and execute arbitrary local files via the config_cascade[main][default][] parameter to doku.php.  NOTE: PHP remote file inclusion is also possible in PHP 5 using ftp:// URLs."}, {"lang": "es", "value": "inc/init.php de DokuWiki 2009-02-14, rc2009-02-06 y rc2009-01-30, cuando register_globals est\u00e1 habilitado, permite a atacantes remotos incluir y ejecutar ficheros locales de su elecci\u00f3n a trav\u00e9s del par\u00e1metro config_cascade[main][default][] de doku.php. NOTA: tambi\u00e9n es posible una inclusi\u00f3n remota de fichero PHP en PHP v5 que utilice URLs ftp://."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.3}, "baseSeverity": "HIGH", "exploitabilityScore": 8.6, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:dokuwiki:dokuwiki:2009-02-14:*:*:*:*:*:*:*", "matchCriteriaId": "0C1517AA-3CF0-4B87-BC19-09D1E58EDFFF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:dokuwiki:dokuwiki:rc2009-01-30:*:*:*:*:*:*:*", "matchCriteriaId": "3DB7EDB7-794F-4180-93B4-1C15D754F3B4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:dokuwiki:dokuwiki:rc2009-02-06:*:*:*:*:*:*:*", "matchCriteriaId": "71C079F7-4C88-4D24-9392-4BA7816DA6B5"}]}]}], "references": [{"url": "http://bugs.splitbrain.org/index.php?do=details&task_id=1700", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://dev.splitbrain.org/darcsweb/darcsweb.cgi?r=dokuwiki%3Ba=commitdiff%3Bh=20090526145030-7ad00-c0483e021f47898c8597f3bfbdd26c637f891d86.gz", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/35218", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/35095", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/8781", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/8812", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1055: Deployment", "comment": "CVE-2009-1960 - This technique is used to deploy the malicious payload remotely. Enabling register_globals in DokuWiki 2009-02-14, rc2009-02-06, and rc2009-01-30 allows remote attackers to include and execute arbitrary local files via the config_cascade[main][default][] parameter to doku.php. Defenders can prevent this by disabling register_globals and/or using a WAF to block suspicious requests."}, {"techniqueID": "T1086: Execution", "comment": "CVE-2009-1960 - The vulnerability allows remote attackers to execute arbitrary local files via the config_cascade[main][default][] parameter to doku.php. Execution is typically carried out using PHP's eval() function. Defenders can detect and prevent this by monitoring for suspicious PHP code execution and blocking traffic to the vulnerable server."}, {"techniqueID": "T1190: Data from Network Communication", "comment": "CVE-2009-1960 - The vulnerability allows remote attackers to include and execute arbitrary local files via the config_cascade[main][default][] parameter to doku.php. This can be used to steal data, inject malware, or spread exploitation. Defenders can detect and prevent this by monitoring network traffic for suspicious patterns and blocking untrusted traffic."}], "stix_bundle": {"type": "bundle", "id": "https://example.com/cve-2009-1960-stix-bundle", "title": "CVE-2009-1960 STIX Bundle", "description": "STIX Bundle for CVE-2009-1960, a vulnerability in DokuWiki 2009-02-14, rc2009-02-06, and rc2009-01-30 that allows remote attackers to include and execute arbitrary local files.", "objects": [{"type": "vulnerability", "id": "https://example.com/cve-2009-1960", "name": "CVE-2009-1960: DokuWiki Remote File Inclusion Vulnerability", "description": "The DokuWiki 2009-02-14, rc2009-02-06, and rc2009-01-30 allows remote attackers to include and execute arbitrary local files via the config_cascade[main][default][] parameter to doku.php.", "traits": [{"trait_type": "remote_file_inclusion", "trait_value": "true"}], "related_object": {"type": "exploit", "id": "https://example.com/exploit-cve-2009-1960", "name": "Exploit for CVE-2009-1960", "description": "An exploit for CVE-2009-1960, a vulnerability in DokuWiki 2009-02-14, rc2009-02-06, and rc2009-01-30 that allows remote attackers to include and execute arbitrary local files."}}, {"type": "indicator", "id": "https://example.com/indicator-cve-2009-1960", "name": "Indicator for CVE-2009-1960", "description": "An indicator for CVE-2009-1960, a vulnerability in DokuWiki 2009-02-14, rc2009-02-06, and rc2009-01-30 that allows remote attackers to include and execute arbitrary local files.", "pattern": "regex: '[\\Qconfig_cascade\\E[main][default][]']'", "handling": {"type": "alert"}}]}, "technical_analysis": {"Introduction": "The CVE-2009-1960 vulnerability is a remote file inclusion vulnerability in DokuWiki 2009-02-14, rc2009-02-06, and rc2009-01-30 that allows remote attackers to include and execute arbitrary local files.", "Impact and Scope": "The vulnerability allows remote attackers to execute arbitrary local files, which can lead to data theft, malware injection, or spreading exploitation.", "Related MITRE ATT&CK Techniques": "T1055: Deployment, T1086: Execution, T1190: Data from Network Communication", "Technical Details": "The vulnerability occurs when register_globals is enabled in DokuWiki 2009-02-14, rc2009-02-06, and rc2009-01-30. This can be exploited by submitting a crafted request to the vulnerable server.", "Detection": "Defenders can detect this vulnerability by monitoring for suspicious PHP code execution and blocking traffic to the vulnerable server.", "Mitigation": "Defenders can prevent this vulnerability by disabling register_globals and/or using a WAF to block suspicious requests.", "Conclusion": "In conclusion, the CVE-2009-1960 vulnerability is a significant threat to DokuWiki 2009-02-14, rc2009-02-06, and rc2009-01-30. Defenders must take swift action to prevent this vulnerability from being exploited."}, "executive_analysis": {"Overview": "The CVE-2009-1960 vulnerability is a remote file inclusion vulnerability in DokuWiki 2009-02-14, rc2009-02-06, and rc2009-01-30 that allows remote attackers to include and execute arbitrary local files.", "Business Impact": "The vulnerability can lead to data theft, malware injection, or spreading exploitation, which can have significant business implications.", "Technical Impact": "The vulnerability allows remote attackers to execute arbitrary local files, which can lead to technical issues and system compromise.", "Mitigation Strategies": "Disabling register_globals and/or using a WAF to block suspicious requests can help prevent this vulnerability from being exploited.", "Recommendations": "We recommend that executives take immediate action to prevent this vulnerability from being exploited. This includes disabling register_globals and/or using a WAF to block suspicious requests.", "Conclusions": "In conclusion, the CVE-2009-1960 vulnerability is a significant threat to DokuWiki 2009-02-14, rc2009-02-06, and rc2009-01-30. Executives must take swift action to prevent this vulnerability from being exploited."}}