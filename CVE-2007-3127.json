{"id": "CVE-2007-3127", "sourceIdentifier": "cve@mitre.org", "published": "2007-06-19T17:30:00.000", "lastModified": "2018-10-16T16:47:38.167", "vulnStatus": "Modified", "cveTags": [], "evaluatorImpact": "Successful exploitation requires PHP magic_quotes_gpc set to OFF.", "descriptions": [{"lang": "en", "value": "content.php in WSPortal 1.0, when magic_quotes_gpc is disabled, allows remote attackers to obtain sensitive information via a \"';\" (quote semicolon) sequence in the page parameter, which reveals the installation path in the resulting forced SQL error message."}, {"lang": "es", "value": "content.php de WSPortal 1.0, cuando magic_quotes_gpc est\u00e1 deshabilitado, permite a atacantes remotos obtener informaci\u00f3n sensible mediante una secuencia \"';\" (comilla simple, punto y coma) en el par\u00e1metro page, lo cual revela la ruta de instalaci\u00f3n en el mensaje de SQL forzado resultante."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ibm:websphere_portal:1.0:*:*:*:*:*:*:*", "matchCriteriaId": "FF2C6181-C0C5-4F0A-A800-663CC9DAD9E0"}]}]}], "references": [{"url": "http://archives.neohapsis.com/archives/fulldisclosure/2007-06/0368.html", "source": "cve@mitre.org"}, {"url": "http://www.netvigilance.com/advisory0032", "source": "cve@mitre.org"}, {"url": "http://www.osvdb.org/34164", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/471619/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/2237", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/34894", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2007-3127 - PHP Magic Quotes GPC allows an attacker to inject a semicolon (;) followed by SQL code to bypass magic_quotes_gpc protection and execute arbitrary SQL code. This is a common web application vulnerability that allows attackers to obtain sensitive information or execute arbitrary code."}, {"techniqueID": "T1117", "comment": "CVE-2007-3127 - Weakness in PHP Magic Quotes GPC allows an attacker to inject a semicolon (;) followed by SQL code to bypass magic_quotes_gpc protection and execute arbitrary SQL code. This is an example of code injection, which can lead to arbitrary code execution or data theft."}, {"techniqueID": "T1098", "comment": "CVE-2007-3127 - Magic quotes_gpc is a configuration setting that can be used by attackers to bypass certain security measures. Attackers can manipulate this setting to inject malicious code, such as SQL code, within a web application. This can lead to arbitrary code execution, data theft, or other malicious activities."}, {"techniqueID": "T1128", "comment": "CVE-2007-3127 - The presence of a semicolon (;) in a web application parameter can be used by attackers to inject SQL code. This can allow attackers to execute arbitrary SQL code, which can lead to data theft, data modification, or other malicious activities."}], "stix_bundle": {"bundleId": "d2d9f5c8-2a23-406b-8f64-f1f5ddc9aef4", "relationships": [{"type": "has_attack_pattern", "idRef": "attack-pattern--d2a0a21b-b18f-4625-8d82-3c5b0f7e1c1c", "id": "vulnerability--d2d9f5c8-2a23-406b-8f64-f1f5ddc9aef4"}], "objects": [{"id": "vulnerability--d2d9f5c8-2a23-406b-8f64-f1f5ddc9aef4", "type": "vulnerability", "name": "CVE-2007-3127 PHP Magic Quotes GPC", "description": "A vulnerability in PHP Magic Quotes GPC that allows an attacker to inject a semicolon (;) followed by SQL code to bypass magic_quotes_gpc protection and execute arbitrary SQL code.", "components": [{"id": "attack-pattern--d2a0a21b-b18f-4625-8d82-3c5b0f7e1c1c", "type": "attack-pattern", "name": "PHP Magic Quotes GPC Injection"}, {"id": "course-of-action--b6e6d7a1-df7f-4df1-b5ce-e37b87c76f49", "type": "course-of-action", "name": "Disable Magic Quotes GPC or Apply Proper Input Validation"}]}]}, "technical_analysis": {"Introduction": "This vulnerability is particularly interesting because it is a classic example of how an attacker can use unexpected input to bypass security measures.", "Impact and Scope": "The impact of this vulnerability is significant, as it allows an attacker to execute arbitrary SQL code and potentially gain unauthorized access to sensitive data.", "Related MITRE ATT&CK Techniques": "T1190, T1117, T1098, and T1128", "Technical Details": "The vulnerability occurs because the PHP magic_quotes_gpc configuration setting is not properly implemented, allowing an attacker to inject a semicolon (;) followed by SQL code.", "Detection": "The vulnerability can be detected by monitoring for suspicious SQL code injection attempts.", "Mitigation": "Disable Magic Quotes GPC or apply proper input validation to prevent this type of attack.", "Conclusion": "In conclusion, this vulnerability demonstrates the importance of proper configuration and input validation in web applications."}, "executive_analysis": {"Overview": "This vulnerability highlights the importance of properly configuring PHP settings to prevent common web application attacks.", "Business Impact": "The consequences of a successful attack can include data theft, unauthorized access, and disruption of business operations.", "Technical Impact": "The vulnerability exposes the web application to code injection attacks, allowing an attacker to execute arbitrary SQL code.", "Mitigation Strategies": "Disable Magic Quotes GPC or apply proper input validation to prevent this type of attack.", "Recommendations": "Our recommended course of action is to disable Magic Quotes GPC or apply proper input validation to prevent this type of attack.", "Conclusions": "In conclusion, this vulnerability emphasizes the need for proactive security measures to prevent web application attacks."}}