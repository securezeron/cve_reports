{"id": "CVE-2007-5307", "sourceIdentifier": "cve@mitre.org", "published": "2007-10-09T18:17:00.000", "lastModified": "2018-10-15T21:42:38.337", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "ELSEIF CMS Beta 0.6 does not properly unset variables when the input data includes a numeric parameter with a value matching an alphanumeric parameter's hash value, which allows remote attackers to execute arbitrary PHP code by uploading a .php file via externe/swfupload/upload.php.  NOTE: it could be argued that this vulnerability is due to a bug in the unset PHP command (CVE-2006-3017) and the proper fix should be in PHP; if so, then this should not be treated as a vulnerability in ELSEIF CMS."}, {"lang": "es", "value": "ELSEIF CMS Beta 0.6 no elimina (unset) variables adecuadamente cuando los datos de entrada incluyen un par\u00e1metro num\u00e9rico con un valor que coincide con un valor de resumen (hash) de un par\u00e1metro alfanum\u00e9rico, lo cual permite a atacantes remotos ejecutar c\u00f3digo PHP de su elecci\u00f3n enviando un archivo .php mediante externe/swfupload/upload.php. NOTA: podr\u00eda discutirse que esta vulnerabilidad se debe a un fallo en el comando unset de PHP (CVE-2006-3017) y que la soluci\u00f3n adecuada deber\u00eda estar en PHP; en tal caso, esto no deber\u00eda ser tratado como una vulnerabilidad en ELSEIF CMS."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:yannick_tanguy:else_if_cms:0.6-beta:*:*:*:*:*:*:*", "matchCriteriaId": "BEE8B4EB-C1A5-4993-9661-F1510813E478"}]}]}], "references": [{"url": "http://securityreason.com/securityalert/3204", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/481683/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/25951", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/37009", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2007-5307 - This PHP Remote File Inclusion vulnerability enables attackers to upload and execute arbitrary PHP code, leading to a network-based attack. Defense tactic: Implement input validation and sanitization, and restrict file uploads to approved locations."}, {"techniqueID": "T1055", "comment": "CVE-2007-5307 - This vulnerability can be used for PowerShell execution, allowing attackers to drop and execute malware. Defense tactic: Implement PowerShell script blocking and restricted execution of PowerShell commands."}, {"techniqueID": "T1130", "comment": "CVE-2007-5307 - This vulnerability could be used for code injection, allowing attackers to execute arbitrary code. Defense tactic: Implement input validation and sanitization, and restrict code execution to approved locations."}, {"techniqueID": "T1133", "comment": "CVE-2007-5307 - This vulnerability could be used for command and control, allowing attackers to establish a connection to the victim's system. Defense tactic: Implement network traffic scanning and blocking, and restrict incoming traffic to approved sources."}], "technical_analysis": {"Introduction": "CVE-2007-5307 is a remote file inclusion vulnerability affecting ELSEIF CMS Beta 0.6, allowing attackers to upload and execute arbitrary PHP code.", "Impact and Scope": "CVSS Score: 7.5 (AV:N/AC:L/Au:N/C:P/I:P/A:P).", "Related MITRE ATT&CK Techniques": "T1027, T1055, T1130, T1133. These techniques are relevant due to the potential for code injection, PowerShell execution, and code execution.", "Technical Details": "The vulnerability occurs when the input data includes a numeric parameter with a value matching an alphanumeric parameter's hash value, allowing attackers to execute arbitrary PHP code.", "Detection": " Detection can be achieved through network traffic analysis and monitoring for suspicious PHP code execution.", "Mitigation": "Implement input validation and sanitization, restrict file uploads to approved locations, and restrict PowerShell script execution.", "Conclusion": "CVE-2007-5307 is a critical vulnerability that requires prompt attention and mitigation. "}, "executive_analysis": {"Overview": "CVE-2007-5307 is a critical remote file inclusion vulnerability affecting ELSEIF CMS Beta 0.6, which could allow attackers to execute arbitrary PHP code.", "Business Impact": "This vulnerability could lead to data breaches, financial losses, and reputational damage.", "Technical Impact": "The vulnerability could be used for code injection, PowerShell execution, and code execution.", "Mitigation Strategies": "Implement input validation and sanitization, restrict file uploads to approved locations, and restrict PowerShell script execution.", "Recommendations": "Perform regular vulnerability scanning and patching, implement employee education and awareness programs, and consider implementing a web application firewall.", "Conclusions": "CVE-2007-5307 is a critical vulnerability that requires immediate attention and mitigation. Prompt action will help minimize the risk of exploitation."}}