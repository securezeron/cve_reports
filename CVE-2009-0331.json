{"id": "CVE-2009-0331", "sourceIdentifier": "cve@mitre.org", "published": "2009-01-29T18:30:02.547", "lastModified": "2017-09-29T01:33:45.107", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Directory traversal vulnerability in gallery/comment.php in Enhanced Simple PHP Gallery (ESPG) 1.72 allows remote attackers to read arbitrary files via a .. (dot dot) in the file parameter.  NOTE: the vulnerability may be in my little homepage Comment script. If so, then this should not be treated as a vulnerability in ESPG."}, {"lang": "es", "value": "Vulnerabilidad de salto de directorio en gallery/comment.php en Enhanced Simple PHP Gallery (ESPG) v1.72 permitiria a atacantes remotos leer ficheros de su eleccion a traves de ..(punto punto) en el parametro \"file\". NOTA: La vulnerabilidad podria estar en la secuencia de comandos del comentario de mi peque\u00f1a pagina web. Si es asi no deberia ser tratada como una vulnerabilidad en ESPG."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.8}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:quirm:espg:1.72:*:*:*:*:*:*:*", "matchCriteriaId": "928D1FF8-96FE-4985-BEFB-BBC7BC1E923F"}]}]}], "references": [{"url": "http://www.securityfocus.com/bid/33335", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/48087", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/7819", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1027", "comment": "CVE-2009-0331 - This vulnerability allows an attacker to read arbitrary files on the target system, making it relevant to techniques such as command injection and file collection."}, {"techniqueID": "T1059", "comment": "CVE-2009-0331 - This vulnerability allows an attacker to read arbitrary files on the target system, making it relevant to techniques such as file and directory discovery."}, {"techniqueID": "T1202", "comment": "CVE-2009-0331 - This vulnerability allows an attacker to read arbitrary files on the target system, making it relevant to techniques such as information exfiltration over alternative protocols."}, {"techniqueID": "T1567", "comment": "CVE-2009-0331 - This vulnerability allows an attacker to read arbitrary files on the target system, making it relevant to techniques such as theft of authentication blurder and authentication feature."}], "stix_bundle": {"@stix": {"bundleversion": "2.1"}, "bundle": {"objects": [{"@id": "https-www-securityfocus-com-bid-33335", "type": "Vulnerability", "name": "CVE-2009-0331", "description": {"lang": "en", "value": "Directory traversal vulnerability in gallery/comment.php in Enhanced Simple PHP Gallery (ESPG) 1.72 allows remote attackers to read arbitrary files via a .. (dot dot) in the file parameter."}, "vulnerabilityProperties": {"cvssV2": {"vectorString": "AV:N/AC:L/Au:N/C:C/I:N/A:N"}}, "relationships": [{"type": "relates-to", "id": "https-xforce-ibmcloud-com-vulnerabilities-48087"}]}, {"type": "TTP", "id": "T1027", "name": "Remote File Access", "description": {"lang": "en", "value": "Remotely access and read files on a target system."}}, {"type": "TTP", "id": "T1059", "name": "File and Directory Discovery", "description": {"lang": "en", "value": "Discover and extract file and directory information from a target system."}}, {"type": "TTP", "id": "T1202", "name": "Information Exfiltration Over Alternative Protocols", "description": {"lang": "en", "value": "Exfiltrate information over alternative protocols, such as HTTPS or FTP."}}, {"type": "TTP", "id": "T1567", "name": "Theft of Authentication Blurder and Authentication Feature", "description": {"lang": "en", "value": "Steal authentication credentials and use them to access the targeted system."}}, {"type": "D3FEND", "id": " defense-web-application-firewall", "name": "Web Application Firewall", "description": {"lang": "en", "value": "Configure a web application firewall to block malicious incoming traffic and prevent unauthorized access."}}, {"type": "D3FEND", "id": "defense-file-permissions", "name": "File Permissions", "description": {"lang": "en", "value": "Configure file permissions to restrict access to sensitive files and directories."}}]}}, "technical_analysis": {"Introduction": "This vulnerability, CVE-2009-0331, is a directory traversal vulnerability in gallery/comment.php in Enhanced Simple PHP Gallery (ESPG) 1.72. It allows remote attackers to read arbitrary files via a .. (dot dot) in the file parameter. This makes it relevant to techniques such as command injection and file collection.", "Impact and Scope": "The CVSS score of this vulnerability is 7.8, with a CVSS version of 2.0 and a vector string of AV:N/AC:L/Au:N/C:C/I:N/A:N. This means that it has a high impact on confidentiality and availability.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are T1027, T1059, T1202, and T1567.", "Technical Details": "The vulnerability occurs because the gallery/comment.php script in Enhanced Simple PHP Gallery (ESPG) 1.72 does not properly sanitize user input, allowing attackers to specify a file path that contains a dot-dot (../) sequence. This allows the attacker to read arbitrary files on the system.", "Detection": "Detection of this vulnerability can be done using web application scanners and vulnerability scanners.", "Mitigation": "Mitigation strategies for this vulnerability include configuring a web application firewall to block malicious incoming traffic, restricting access to sensitive files and directories, and updating the Enhanced Simple PHP Gallery (ESPG) to a version that is not vulnerable to this issue.", "Conclusion": "In conclusion, CVE-2009-0331 is a critical vulnerability that requires immediate attention and mitigation. It is important to update the Enhanced Simple PHP Gallery (ESPG) to a version that is not vulnerable to this issue and to configure a web application firewall to block malicious incoming traffic."}, "executive_analysis": {"Overview": "CVE-2009-0331 is a directory traversal vulnerability in Enhanced Simple PHP Gallery (ESPG) 1.72 that allows remote attackers to read arbitrary files.", "Business Impact": "This vulnerability has a high business impact because it can result in unauthorized access to sensitive information and data exfiltration.", "Technical Impact": "The technical impact of this vulnerability is that it allows remote attackers to read arbitrary files on the system, which can result in data exfiltration and unauthorized access to sensitive information.", "Mitigation Strategies": "Mitigation strategies for this vulnerability include configuring a web application firewall to block malicious incoming traffic, restricting access to sensitive files and directories, and updating the Enhanced Simple PHP Gallery (ESPG) to a version that is not vulnerable to this issue.", "Recommendations": "Recommendations for executives include updating the Enhanced Simple PHP Gallery (ESPG) to a version that is not vulnerable to this issue, configuring a web application firewall to block malicious incoming traffic, and restricting access to sensitive files and directories.", "Conclusions": "In conclusion, CVE-2009-0331 is a critical vulnerability that requires immediate attention and mitigation. It is important to take proactive measures to prevent unauthorized access to sensitive information and data exfiltration."}}