{"id": "CVE-2007-3280", "sourceIdentifier": "cve@mitre.org", "published": "2007-06-19T21:30:00.000", "lastModified": "2018-10-16T16:48:13.810", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The Database Link library (dblink) in PostgreSQL 8.1 implements functions via CREATE statements that map to arbitrary libraries based on the C programming language, which allows remote authenticated superusers to map and execute a function from any library, as demonstrated by using the system function in libc.so.6 to gain shell access."}, {"lang": "es", "value": "La librer\u00eda de Enlace a Base de Datos (Database Link) (dblink) en PostgreSQL 8.1 implementa funciones mediante sentencias CREATE que mapean a librer\u00edas arbitrarias basadas en el lenguaje de programaci\u00f3n C, lo cual permite a superusuarios autenticados remotamente, mapear y ejecutar una funci\u00f3n de cualquier librer\u00eda, como se ha demostrado usando la funci\u00f3n system en libc.so.6 para obtener acceso a una l\u00ednea de comandos."}], "vendorComments": [{"organization": "Red Hat", "comment": "Red Hat does not consider this do be a security issue.  The ability of the superuser to execute code on behalf of the database server is an intended feature and imposes no security threat as the superuser account is restricted to the database administrator.\n", "lastModified": "2007-09-28T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.0}, "baseSeverity": "HIGH", "exploitabilityScore": 8.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:postgresql:postgresql:8.1:*:*:*:*:*:*:*", "matchCriteriaId": "2AF590F2-899F-42E1-8A57-6F514C94CE4F"}]}]}], "references": [{"url": "http://osvdb.org/40901", "source": "cve@mitre.org"}, {"url": "http://www.leidecker.info/pgshell/Having_Fun_With_PostgreSQL.txt", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDKSA-2007:188", "source": "cve@mitre.org"}, {"url": "http://www.portcullis.co.uk/uplds/whitepapers/Having_Fun_With_PostgreSQL.pdf", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/471541/100/0/threaded", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/35145", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2007-3280 - Permission escalation using Library Functionality\nThis technique allows an attacker to execute arbitrary code on behalf of the database server, giving them complete control over the server.\nDefend against this technique by monitoring the database server for unusual queries and restricting access to sensitive functionality."}, {"techniqueID": "T1210", "comment": "CVE-2007-3280 - System Access via Abuse of Functionality\nThis technique allows an attacker to gain system access by exploiting weak permissions and executing arbitrary code.\nDefend against this technique by enforcing strict permissions and monitoring system access."}, {"techniqueID": "T1404", "comment": "CVE-2007-3280 - Connection to Remote Systems for User Execution\nThis technique allows an attacker to connect to remote systems and execute code on behalf of the user.\nDefend against this technique by monitoring user connections and restricting access to sensitive systems."}], "stix_bundle": {"stix": {"objects": [{"id": "cve-2007-3280", "type": "Indicator", "value": "CVE-2007-3280", "description": "PostgreSQL 8.1 Database Link library (dblink) permission escalation vulnerability", "created": "2023-02-15T14:30:00.000", "modified": "2023-02-15T14:30:00.000", "objects": [{"id": "exploit-1", "type": "Attack Pattern", "description": "Exploit for CVE-2007-3280", "created": "2023-02-15T14:30:00.000", "modified": "2023-02-15T14:30:00.000", "idmap": [{"resource_id": "cve-2007-3280", "resource_type": "Indicator"}]}, {"id": "mitigation-1", "type": "Course of Action", "description": "Monitor database server for unusual queries and restrict access to sensitive functionality", "created": "2023-02-15T14:30:00.000", "modified": "2023-02-15T14:30:00.000", "idmap": [{"resource_id": "cve-2007-3280", "resource_type": "Indicator"}]}]}], "relationships": [{"id": "r1", "relationship_type": "related_to", "idmap": [{"resource_id": "exploit-1", "resource_type": "Attack Pattern"}, {"resource_id": "cve-2007-3280", "resource_type": "Indicator"}]}, {"id": "r2", "relationship_type": "mitigates", "idmap": [{"resource_id": "mitigation-1", "resource_type": "Course of Action"}, {"resource_id": "cve-2007-3280", "resource_type": "Indicator"}]}]}}, "technical_analysis": {"Introduction": "The CVE-2007-3280 vulnerability allows an attacker to execute arbitrary code on behalf of the database server, giving them complete control over the server.\n", "Impact and Scope": "The impact of this vulnerability is a complete takeover of the database server, allowing an attacker to execute any command and have full control over the server. The scope of this vulnerability is limited to PostgreSQL 8.1 and earlier versions.", "Related MITRE ATT&CK Techniques": "Related MITRE ATT&CK techniques include T1059: Permission escalation using Library Functionality, T1210: System Access via Abuse of Functionality, and T1404: Connection to Remote Systems for User Execution.\n", "Technical Details": "The vulnerability occurs in the Database Link library (dblink) in PostgreSQL 8.1, which allows an attacker to map and execute a function from any library.\n", "Detection": "Detection of this vulnerability can be done by monitoring the database server for unusual queries and checking for the presence of the dblink library.\n", "Mitigation": "Mitigation strategies include monitoring the database server for unusual queries, restricting access to sensitive functionality, and updating to a patched version of PostgreSQL.\n", "Conclusion": "In conclusion, the CVE-2007-3280 vulnerability is a critical security issue that allows an attacker to take over a PostgreSQL 8.1 database server. It is essential to prioritize patching and mitigation strategies to minimize the risk of exploitation."}, "executive_analysis": {"Overview": "The CVE-2007-3280 vulnerability is a critical security issue that can result in a complete takeover of a PostgreSQL 8.1 database server.\n", "Business Impact": "The impact of this vulnerability is significant, as it could allow an attacker to access sensitive data and disrupt business operations.\n", "Technical Impact": "The technical impact of this vulnerability is a complete takeover of the database server, giving the attacker full control over the system.\n", "Mitigation Strategies": "Mitigation strategies include monitoring the database server for unusual queries and restricting access to sensitive functionality.\n", "Recommendations": "Recommendations include prioritizing patching and mitigation strategies, and conducting regular vulnerability assessments and penetration testing.\n", "Conclusions": "In conclusion, the CVE-2007-3280 vulnerability is a critical security issue that requires immediate attention and priority.\n"}}