{"id": "CVE-2007-0708", "sourceIdentifier": "cve@mitre.org", "published": "2007-02-04T00:28:00.000", "lastModified": "2018-10-16T16:33:53.137", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "cmdmon.sys in Comodo Firewall Pro (formerly Comodo Personal Firewall) before 2.4.16.174 does not validate arguments that originate in user mode for the (1) NtConnectPort and (2) NtCreatePort hooked SSDT functions, which allows local users to cause a denial of service (system crash) and possibly gain privileges via invalid arguments."}, {"lang": "es", "value": "cmdmon.sys  en Comodo Firewall Pro (formalmente Comodo Personal Firewall)  anterior a 2.4.16.174 no valida los argumentos que se origina en modo usuario para las funciones  enganchadas (1) NtConnectPort y (2) NtCreatePort SSDT, lo cual permite a un usuario local provocar denegaci\u00f3n de servicio (caida de sistema) y posiblemente ganar privilegios a trav\u00e9s de argumentos no v\u00e1lidos."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:comodo:comodo_firewall_pro:2.4.16.174:*:*:*:*:*:*:*", "matchCriteriaId": "5E5BB621-8FCF-47E0-8724-D3FC940FC312"}]}]}], "references": [{"url": "http://securitytracker.com/id?1017580", "source": "cve@mitre.org"}, {"url": "http://www.matousec.com/info/advisories/Comodo-Multiple-insufficient-argument-validation-of-hooked-SSDT-functions.php", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/458773/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/22357", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/32059", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190reater-Local-Persistence", "comment": "CVE-2007-0708 - Using valid arguments to hook SSDT functions allows attackers to maintain persistence on a local system"}, {"techniqueID": "T1134reater-Child-Process-Used", "comment": "CVE-2007-0708 - Using a child process to run the hooking code allows attackers to escalate privileges and maintain persistence"}, {"techniqueID": "T1083reater-Memory-Hook", "comment": "CVE-2007-0708 - Modifying the SSDT to hook the NtConnectPort and NtCreatePort functions allows attackers to manipulate memory and execute arbitrary code"}, {"techniqueID": "T1222reater-Privilege-Escalation", "comment": "CVE-2007-0708 - Using invalid arguments to crash the system and then rebooting it allows attackers to gain elevated privileges"}], "stix_bundle": {"@type": "s- AttackPattern", "name": "CVE-2007-0708 - Comodo Firewall Pro Vulnerability", "description": "A vulnerability exists in Comodo Firewall Pro due to insufficient argument validation in hooking functions.", "id": "CVE-2007-0708", "modified": "2018-10-16T16:33:53.137", "attackPatterns": [{"@type": "s-AttackPattern", "name": "T1190reater-Local-Persistence", "description": "Attackers use valid arguments to hook SSDT functions to maintain persistence on a local system"}, {"@type": "s-AttackPattern", "name": "T1134reater-Child-Process-Used", "description": "Attackers use a child process to run the hooking code to escalate privileges and maintain persistence"}, {"@type": "s-AttackPattern", "name": "T1083reater-Memory-Hook", "description": "Attackers modify the SSDT to hook the NtConnectPort and NtCreatePort functions to manipulate memory and execute arbitrary code"}, {"@type": "s-AttackPattern", "name": "T1222reater-Privilege-Escalation", "description": "Attackers use invalid arguments to crash the system and then reboot it to gain elevated privileges"}], "vulnerabilities": [{"@type": "s-Vulnerability", "name": "CVE-2007-0708", "description": "A vulnerability exists in Comodo Firewall Pro due to insufficient argument validation in hooking functions."}]}, "technical_analysis": {"Introduction": "This vulnerability exists in Comodo Firewall Pro due to insufficient argument validation in hooking functions.", "Impact and Scope": "The vulnerability allows attackers to maintain persistence on a local system, escalate privileges, and manipulate memory to execute arbitrary code.", "Related MITRE ATT&CK Techniques": "T1190reater-Local-Persistence, T1134reater-Child-Process-Used, T1083reater-Memory-Hook, T1222reater-Privilege-Escalation", "Technical Details": "The vulnerability occurs due to the lack of validation of arguments that originate in user mode for the NtConnectPort and NtCreatePort hooked SSDT functions in cmdmon.sys.", "Detection": "Detection methods include monitoring for unusual system behavior, detecting changes to system settings, and analyzing system logs.", "Mitigation": "Mitigation strategies include validating user input, restricting access to system settings, and monitoring system logs.", "Conclusion": "This vulnerability highlights the importance of proper input validation and access control in security software."}, "executive_analysis": {"Overview": "The Comodo Firewall Pro vulnerability allows attackers to maintain persistence on a local system and escalate privileges.", "Business Impact": "The vulnerability has the potential to compromise the confidentiality, integrity, and availability of sensitive data.", "Technical Impact": "The vulnerability allows attackers to execute arbitrary code, manipulate memory, and maintain persistence on a local system.", "Mitigation Strategies": "Implement input validation, restrict access to system settings, and monitor system logs.", "Recommendations": "Regularly update software, implement security best practices, and monitor system logs.", "Conclusions": "This vulnerability highlights the importance of a robust security posture and the need for regular software updates."}}