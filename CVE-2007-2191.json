{"id": "CVE-2007-2191", "sourceIdentifier": "cve@mitre.org", "published": "2007-04-24T17:19:00.000", "lastModified": "2017-07-29T01:31:17.457", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple cross-site scripting (XSS) vulnerabilities in freePBX 2.2.x allow remote attackers to inject arbitrary web script or HTML via the (1) From, (2) To, (3) Call-ID, (4) User-Agent, and unspecified other SIP protocol fields, which are stored in /var/log/asterisk/full and displayed by admin/modules/logfiles/asterisk-full-log.php."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de secuencia de comandos en sitios cruzados (XSS) en freePBX 2.2.x permite a atacantes remotos inyectar secuencias de comandos web o HTML a trav\u00e9s de los campos (1) From, (2) To, (3) Call-ID, (4) User-Agent, y otros no especificados del protocolo SIP, lo cuales son almacenados en /var/log/asterisk/full y mostrados por admin/modules/logfiles/asterisk-full-log.php."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:bsd:bsd:*:*:*:*:*:*:*:*", "matchCriteriaId": "B44D379F-F380-42EC-9C9A-A4C8314A4BDF"}, {"vulnerable": false, "criteria": "cpe:2.3:o:hp:hp-ux:*:*:*:*:*:*:*:*", "matchCriteriaId": "61A4F116-1FEE-450E-99AE-6AD9ACDDE570"}, {"vulnerable": false, "criteria": "cpe:2.3:o:hp:tru64:*:*:*:*:*:*:*:*", "matchCriteriaId": "1FE64F3F-48F6-493F-A81E-2B106FF73AC1"}, {"vulnerable": false, "criteria": "cpe:2.3:o:ibm:aix:*:*:*:*:*:*:*:*", "matchCriteriaId": "F7F01A55-7C37-4BAF-A4D4-61E8AC54FF79"}, {"vulnerable": false, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "matchCriteriaId": "155AD4FB-E527-4103-BCEF-801B653DEA37"}, {"vulnerable": false, "criteria": "cpe:2.3:o:santa_cruz_operation:sco_unix:*:*:*:*:*:*:*:*", "matchCriteriaId": "ECCBDA43-9C75-4B36-8C90-EF26B8CD777D"}, {"vulnerable": false, "criteria": "cpe:2.3:o:sun:solaris:*:*:*:*:*:*:*:*", "matchCriteriaId": "469B74F2-4B89-42B8-8638-731E92D463B9"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:freepbx:freepbx:2.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "A896A046-4843-46B6-A8BA-1E8207AC2915"}, {"vulnerable": true, "criteria": "cpe:2.3:a:freepbx:freepbx:2.2_rc1:*:*:*:*:*:*:*", "matchCriteriaId": "D2B7FDB0-1CB9-49B6-B260-3BE25D7973EC"}]}]}], "references": [{"url": "http://lists.grok.org.uk/pipermail/full-disclosure/2007-April/053882.html", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://osvdb.org/35315", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/24935", "source": "cve@mitre.org"}, {"url": "http://securityreason.com/securityalert/2627", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/23575", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/1535", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/33772", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2007-2191 uses cross-site scripting (XSS) vulnerability which is a common technique used by attackers to inject malicious scripts into a web page. This technique can be mitigated by proper input validation and sanitization."}, {"techniqueID": "T1190", "comment": "The vulnerability allows remote attackers to inject arbitrary web script or HTML which can be used to steal sensitive information or take control of the system. This technique can be mitigated by applying the latest security patches and configuring the system to reject malicious inputs."}, {"techniqueID": "T1048", "comment": "The vulnerability allows attackers to inject malicious scripts which can be used to conduct further attacks. This technique can be mitigated by implementing Web Application Firewalls (WAFs) and monitoring web traffic for suspicious activities."}], "stix_bundle": "This STIX bundle is a comprehensive representation of the vulnerability and its related techniques, along with possible risks and defense strategies.\r\n{\r\n    \"objects\": {\r\n        \"vulnerability\": {\r\n            \"id\": \"CVE-2007-2191\",\r\n            \"created\": \"2007-04-24T17:19:00.000\",\r\n            \"description\": \"Multiple cross-site scripting (XSS) vulnerabilities in freePBX 2.2.x allow remote attackers to inject arbitrary web script or HTML via the (1) From, (2) To, (3) Call-ID, (4) User-Agent, and unspecified other SIP protocol fields, which are stored in /var/log/asterisk/full and displayed by admin/modules/logfiles/asterisk-full-log.php.\",\r\n            \"affected_items\": [\"freePBX 2.2.x\"],\r\n            \"related_open_vuln_refs\": [],\r\n            \"related_exploit_refs\": [],\r\n            \"related_config_refs\": [],\r\n            \"related_affected_software_ref\": {\r\n                \"description\": \"freePBX 2.2.x\",\r\n                \"vulnerable_packages\": [\"freepbx\"]\r\n            },\r\n            \"related_affected_platform_ref\": [],\r\n            \"related_affected_vendor_ref\": [],\r\n            \"related_advisory_refs\": [],\r\n            \"related_white_paper_refs\": [],\r\n            \"related_vuln_publication_refs\": [],\r\n            \"related_tactics_refs\": [],\r\n            \"related_planner_refs\": [],\r\n            \"created_by\": \"cve@mitre.org\",\r\n            \"updated\": \"2017-07-29T01:31:17.457\",\r\n            \"edited_by\": \"cve@mitre.org\"\r\n        },\r\n        \"course_of_action\": {\r\n            \"description\": \"To mitigate this vulnerability, users can upgrade their freePBX to the latest version, which includes patch for this vulnerability.\",\r\n            \"related_tactic_ref\": []\r\n        },\r\n        \"detection\": {\r\n            \"description\": \"Users can detect this vulnerability by monitoring web traffic for suspicious activities.\",\r\n            \"related_tactic_ref\": []\r\n        }\r\n    },\r\n    \" relationships\": {\r\n        \"vulnerability\" : {\r\n            \"course_of_action\": {\r\n                \"object_ref\": \"course_of_action\",\r\n                \"to\": \"vulnerability\"\r\n            },\r\n            \"detection\": {\r\n                \"object_ref\": \"detection\",\r\n                \"to\": \"vulnerability\"\r\n            }\r\n        }\r\n    }\r\n}\r\n", "technical_analysis": {"Introduction": "This vulnerability allows attackers to inject arbitrary web script or HTML, which can be used to steal sensitive information or take control of the system. The vulnerability is a cross-site scripting (XSS) vulnerability in freePBX 2.2.x.", "Impact and Scope": "The impact of this vulnerability is high, as it allows attackers to inject malicious scripts that can be used to conduct further attacks. The scope of the vulnerability is limited to freePBX 2.2.x version.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to Techniques T1059, T1190, and T1048, which are primarily used for injecting malicious scripts and conducting further attacks.", "Technical Details": "The vulnerability is caused by improper input validation and sanitization in freePBX 2.2.x. The vulnerability allows attackers to inject arbitrary web script or HTML via the (1) From, (2) To, (3) Call-ID, (4) User-Agent, and unspecified other SIP protocol fields.", "Detection": "Users can detect this vulnerability by monitoring web traffic for suspicious activities. The detection of the vulnerability involves monitoring the web traffic for the presence of malicious scripts.", "Mitigation": "The mitigation of this vulnerability involves proper input validation and sanitization, as well as configuring the system to reject malicious inputs. Users can also upgrade their freePBX to the latest version, which includes patches for this vulnerability.", "Conclusion": "In conclusion, the vulnerability allows attackers to inject malicious scripts that can be used to conduct further attacks. It is essential to properly input validate and sanitize the user input to avoid this vulnerability."}, "executive_analysis": {"Overview": "The vulnerability allows attackers to inject malicious scripts, which can be used to conduct further attacks. This can result in the theft of sensitive information or the compromise of the system.", "Business Impact": "The business impact of this vulnerability is significant, as it can result in the loss of sensitive information and compromise of the system, which can lead to financial losses and damage to the organization's reputation.", "Technical Impact": "The technical impact of this vulnerability is also significant, as it allows attackers to inject malicious scripts that can be used to conduct further attacks.", "Mitigation Strategies": "The mitigation of this vulnerability involves proper input validation and sanitization, configuring the system to reject malicious inputs, and upgrading freePBX to the latest version.", "Recommendations": "It is recommended that organizations upgrade their freePBX to the latest version, configure the system to reject malicious inputs, and implement proper input validation and sanitization.", "Conclusions": "In conclusion, it is essential to properly input validate and sanitize the user input to avoid this vulnerability. The vulnerability allows attackers to inject malicious scripts that can be used to conduct further attacks, which can result in the theft of sensitive information or the compromise of the system."}}