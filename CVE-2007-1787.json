{"id": "CVE-2007-1787", "sourceIdentifier": "cve@mitre.org", "published": "2007-03-31T10:19:00.000", "lastModified": "2018-10-16T16:40:47.553", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple PHP remote file inclusion vulnerabilities in lib/timesheet.class.php in Softerra Time-Assistant 6.2 and earlier, when register_globals is enabled, allow remote attackers to execute arbitrary PHP code via a URL in the (1) inc_dir or (2) lib_dir parameter."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades PHP de inclusi\u00f3n remota de archivo en lib/timesheet.class.php en Softerra Time-Assistant 6.2 y anteriores, cuando register_globals est\u00e1 activado, permite a atacantes remotos ejecutar c\u00f3digo PHP de su elecci\u00f3n a trav\u00e9s de una URL en el par\u00e1metro (1) inc_dir o (2) lib_dir."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.3}, "baseSeverity": "HIGH", "exploitabilityScore": 8.6, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:softerra:time-assistant:*:*:*:*:*:*:*:*", "versionEndIncluding": "6.2", "matchCriteriaId": "E4486622-A1B7-425F-8853-14469066ADEF"}]}]}], "references": [{"url": "http://advisories.echo.or.id/adv/adv80-K-159-2007.txt", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://osvdb.org/34626", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/24729", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/464281/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/23203", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/1193", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/33327", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/3600", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059.007", "comment": "CVE-2007-1787 - This technique involves remote code execution using PHP RFI, which is used to exploit the vulnerability in Softerra Time-Assistant. Defense against this involves restricting the use of register_globals and ensuring that file inclusion parameters are properly sanitized."}, {"techniqueID": "T1190", "comment": "CVE-2007-1787 - This technique involves PHP file inclusion to deliver malware, which is a common attack vector used to exploit this vulnerability. Defense against this involves monitoring for suspicious file inclusion activity and ensuring that only trusted files are included."}, {"techniqueID": "T1574.004", "comment": "CVE-2007-1787 - This technique involves using web shells to maintain access to compromised systems, which can be used to exploit this vulnerability. Defense against this involves monitoring for web shell activity and ensuring that web shells are properly removed."}], "stix_bundle": {"bundle": {"id": "CVE-2007-1787", "type": "bundle", "spec_version": "2.1", "created_by_ref": "https://example.com", "created": "2022-01-01T12:00:00.000Z", "modified": "2022-01-01T12:00:00.000Z", "objects": [{"id": "CVE-2007-1787", "type": "vulnerability", "created_by_ref": "https://example.com", "created": "2022-01-01T12:00:00.000Z", "modified": "2022-01-01T12:00:00.000Z", "name": "Softerra Time-Assistant RFI Vulnerability", "description": "Multiple PHP remote file inclusion vulnerabilities in lib/timesheet.class.php in Softerra Time-Assistant 6.2 and earlier, when register_globals is enabled, allow remote attackers to execute arbitrary PHP code via a URL in the (1) inc_dir or (2) lib_dir parameter.", "severity": "high", "cvss": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C", "attackVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 9.3}, "references": [{"id": "CVE-2007-1787", "type": "reference", "href": "http://advisories.echo.or.id/adv/adv80-K-159-2007.txt", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}]}, {"id": "T1059.007", "type": "attack-pattern", "created_by_ref": "https://example.com", "created": "2022-01-01T12:00:00.000Z", "modified": "2022-01-01T12:00:00.000Z", "name": "php rfi", "description": "Remote code execution using PHP RFI", "techniques": [{"id": "T1059.007", "href": "#CVE-2007-1787", "label": "uses"}]}, {"id": "T1190", "type": "attack-pattern", "created_by_ref": "https://example.com", "created": "2022-01-01T12:00:00.000Z", "modified": "2022-01-01T12:00:00.000Z", "name": "php file inclusion", "description": "PHP file inclusion to deliver malware", "techniques": [{"id": "T1190", "href": "#CVE-2007-1787", "label": "uses"}]}], "relationships": [{"id": "CVE-2007-1787-T1059.007", "type": "uses", "from": "#CVE-2007-1787", "to": "#T1059.007"}, {"id": "CVE-2007-1787-T1190", "type": "uses", "from": "#CVE-2007-1787", "to": "#T1190"}]}}, "technical_analysis": {"Introduction": "Softerra Time-Assistant is a time-tracking software that has been affected by a remote code execution vulnerability (CVE-2007-1787). This vulnerability allows attackers to execute arbitrary PHP code by exploiting a remote file inclusion vulnerability.", "Impact and Scope": "The impact of this vulnerability is high, with a CVSS score of 9.3. The vulnerability affects Softerra Time-Assistant 6.2 and earlier, when register_globals is enabled.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1059.007 (php rfi), T1190 (php file inclusion), and T1574.004 (web shell maintenance).", "Technical Details": "The vulnerability is caused by the use of register_globals in the lib/timesheet.class.php file in Softerra Time-Assistant. This allows attackers to inject arbitrary PHP code by exploiting a remote file inclusion vulnerability.", "Detection": "Detection of this vulnerability can be achieved by monitoring for suspicious file inclusion activity and ensuring that only trusted files are included.", "Mitigation": "Mitigation strategies include restricting the use of register_globals and ensuring that file inclusion parameters are properly sanitized.", "Conclusion": "In conclusion, the Softerra Time-Assistant RFI vulnerability (CVE-2007-1787) is a high-risk vulnerability that allows attackers to execute arbitrary PHP code. Defense against this vulnerability involves restricting the use of register_globals and ensuring that file inclusion parameters are properly sanitized."}, "executive_analysis": {"Overview": "Softerra Time-Assistant is a time-tracking software that has been affected by a remote code execution vulnerability (CVE-2007-1787). This vulnerability allows attackers to execute arbitrary PHP code by exploiting a remote file inclusion vulnerability.", "Business Impact": "The business impact of this vulnerability is high, as it can allow attackers to steal sensitive data and disrupt business operations.", "Technical Impact": "The technical impact of this vulnerability is also high, as it can allow attackers to gain remote access to the system and execute arbitrary commands.", "Mitigation Strategies": "Mitigation strategies include restricting the use of register_globals and ensuring that file inclusion parameters are properly sanitized.", "Recommendations": "Recommendations for executives include ensuring that the vulnerability is patched as soon as possible and implementing additional security measures to prevent future attacks.", "Conclusions": "In conclusion, the Softerra Time-Assistant RFI vulnerability (CVE-2007-1787) is a high-risk vulnerability that requires immediate attention. Executive leaders should prioritize patching the vulnerability and implementing additional security measures to prevent future attacks."}}