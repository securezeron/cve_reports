{"id": "CVE-2007-6181", "sourceIdentifier": "cve@mitre.org", "published": "2007-11-30T00:46:00.000", "lastModified": "2018-10-26T14:18:33.610", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "Heap-based buffer overflow in cygwin1.dll in Cygwin 1.5.7 and earlier allows context-dependent attackers to execute arbitrary code via a filename with a certain length, as demonstrated by a remote authenticated user who uses the SCP protocol to send a file to the Cygwin machine, and thereby causes scp.exe on this machine to execute, and then overwrite heap memory with characters from the filename. NOTE: it is also reported that a related issue might exist in 1.5.7 through 1.5.19."}, {"lang": "es", "value": "Desbordamiento de b\u00fafer basado en pila en cygwin1.dll de Cygwin 1.5.7 y anteriores permite a atacantes dependientes de contexto ejecutar c\u00f3digo de su elecci\u00f3n mediante un nombre de fichero con cierta longitud, como ha sido demostrado por un usuario remoto autenticado que utiliza el protocolo SCP para enviar un fichero a una m\u00e1quina Cygwin, y de ese modo provoca que scp.exe sea ejecutado, y entonces sobrescribe la memoria (mont\u00edculo) con caracteres del nombre de fichero. NOTA: tambi\u00e9n ha sido reportado que un asunto relacionado podr\u00eda existir en 1.5.7 hasta 1.5.19."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 8.5}, "baseSeverity": "HIGH", "exploitabilityScore": 6.8, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:cygwin:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.5.19", "matchCriteriaId": "86E0E2B9-B979-432C-B795-543C1E6149C0"}]}]}], "references": [{"url": "http://cygwin.com/ml/cygwin-developers/2007-11/msg00005.html", "source": "cve@mitre.org", "tags": ["Exploit", "Patch", "Vendor Advisory"]}, {"url": "http://cygwin.com/ml/cygwin-developers/2007-11/msg00024.html", "source": "cve@mitre.org", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "http://cygwin.com/ml/cygwin-developers/2007-11/msg00026.html", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://securityreason.com/securityalert/3406", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/484153/100/0/threaded", "source": "cve@mitre.org", "tags": ["VDB Entry", "Third Party Advisory"]}, {"url": "http://www.securityfocus.com/bid/26557", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}], "techniques": [{"techniqueID": "TA0001", "comment": "Weakness - Inadequate Input Validation. CVE-2007-6181 allows context-dependent attackers to execute arbitrary code via a filename with a certain length, as demonstrated by a remote authenticated user who uses the SCP protocol to send a file to the Cygwin machine."}, {"techniqueID": "TA0002", "comment": "Weakness - Heap-buffer-overflow. CWE-119 - Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') allows an attacker to overwrite heap memory with characters from the filename."}, {"techniqueID": "TA0005", "comment": "Technical Analysis - Cygwin, a collection of GNU and Open Source tools that provide a Unix-like environment, can be exploited remotely if a remote authenticated user sends a file via the SCP protocol that has a filename with a certain length."}], "stix_bundle": {"version": "2.1", "objects": [{"type": "indicator", "id": "indicator--6aef8c12-24c3-4a1b-93d7-35d05d5c1da2", "created_by_ref": "observed-data--1", "modified": "2018-10-26T14:18:33.610", "created": "2007-11-30T00:46:00.000", "name": "CVE-2007-6181", "description": "Heap-based buffer overflow in cygwin1.dll in Cygwin 1.5.7 and earlier allows context-dependent attackers to execute arbitrary code via a filename with a certain length.", "first_seen": "2007-11-30T00:46:00.000", "last_seen": "2007-11-30T00:46:00.000", "indicated_triage_level_ref": "indicative--1", "objects": [{"type": "attack_pattern", "id": "attack-pattern--3f3ce5c8-1a4a-416d-ba09-5c4ab5f6a5a3", "created_by_ref": "attack-pattern--1", "modified": "2018-10-26T14:18:33.610", "created": "2007-11-30T00:46:00.000", "name": "Heap-based buffer overflow in cygwin1.dll", "description": "Heap-based buffer overflow in cygwin1.dll in Cygwin 1.5.7 and earlier allows context-dependent attackers to execute arbitrary code via a filename with a certain length."}, {"type": " course-of-action", "id": "course-of-action--5c70e4f1-5573-44eb-bd9a-9e0a63f74a99", "created_by_ref": "course-of-action--1", "modified": "2018-10-26T14:18:33.610", "created": "2007-11-30T00:46:00.000", "name": "Update Cygwin to version 1.5.20 or later", "description": "Update Cygwin to version 1.5.20 or later to mitigate CVE-2007-6181"}]}], "relationships": [{"source_ref": "indicator--6aef8c12-24c3-4a1b-93d7-35d05d5c1da2", "relationship": "indicates", "target_ref": "attack-pattern--3f3ce5c8-1a4a-416d-ba09-5c4ab5f6a5a3"}, {"source_ref": "indicator--6aef8c12-24c3-4a1b-93d7-35d05d5c1da2", "relationship": "is-mitigated-by", "target_ref": "course-of-action--5c70e4f1-5573-44eb-bd9a-9e0a63f74a99"}]}, "technical_analysis": {"Introduction": "CVE-2007-6181 is a remote code execution vulnerability in Cygwin 1.5.7 and earlier due to a heap-based buffer overflow.", "Impact and Scope": "A remote user can execute arbitrary code on a vulnerable system by sending a file with a certain length via the SCP protocol.", "Related MITRE ATT&CK Techniques": "TA0001, TA0002, and TA0005", "Technical Details": "The vulnerability occurs due to the lack of input validation in the cygwin1.dll file, which allows an attacker to send a file with a certain length and execute arbitrary code.", "Detection": "The vulnerability can be detected by monitoring SCP protocol traffic and examining the file names sent for unusual lengths.", "Mitigation": "Update Cygwin to version 1.5.20 or later to mitigate the vulnerability.", "Conclusion": "CVE-2007-6181 is a critical vulnerability that can be exploited remotely to execute arbitrary code on a vulnerable system."}, "executive_analysis": {"Overview": "CVE-2007-6181 is a critical remote code execution vulnerability in Cygwin 1.5.7 and earlier.", "Business Impact": "The vulnerability can be exploited to execute arbitrary code, potentially leading to unauthorized access to sensitive data or systems.", "Technical Impact": "The vulnerability occurs due to the lack of input validation in the cygwin1.dll file, which allows an attacker to send a file with a certain length and execute arbitrary code.", "Mitigation Strategies": "Update Cygwin to version 1.5.20 or later to mitigate the vulnerability.", "Recommendations": "Executives should ensure that all systems running Cygwin are updated to the latest version to prevent exploitation of this vulnerability.", "Conclusions": "CVE-2007-6181 is a critical vulnerability that requires immediate attention and remediation to prevent exploitation."}}