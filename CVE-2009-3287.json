{"id": "CVE-2009-3287", "sourceIdentifier": "cve@mitre.org", "published": "2009-09-22T10:30:00.640", "lastModified": "2009-09-22T10:30:00.640", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "lib/thin/connection.rb in Thin web server before 1.2.4 relies on the X-Forwarded-For header to determine the IP address of the client, which allows remote attackers to spoof the IP address and hide activities via a modified X-Forwarded-For header."}, {"lang": "es", "value": "lib/thin/connection.rb en el servidor web Thin anterior a v1.2.4 permite determinar la direcci\u00f3n IP del cliente sobre la cabecera X-Forwarded-For, lo que permite a atacantes remotos suplantar la direcci\u00f3n IP y ocultar la actividad a trav\u00e9s de una cabecera X-Forwarded-For."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.2.2", "matchCriteriaId": "DDB8B96B-7544-4ED1-97AF-BED85A6E02A2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.4.0:*:*:*:*:*:*:*", "matchCriteriaId": "3722C121-CA76-4BD6-9B17-059C1051BD3D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "A8DFE094-2523-47F6-9310-BE48DF205825"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.5.0:*:*:*:*:*:*:*", "matchCriteriaId": "DCA76B41-8699-4AB9-8569-98D792359C53"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.5.1:*:*:*:*:*:*:*", "matchCriteriaId": "D9BDC31A-0F16-4817-802B-C603050D7E83"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.5.2:*:*:*:*:*:*:*", "matchCriteriaId": "EB082342-11F8-479C-B884-0D3E6074A600"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.5.3:*:*:*:*:*:*:*", "matchCriteriaId": "C5367748-33ED-4AFC-951A-B3B10B9CA94F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.5.4:*:*:*:*:*:*:*", "matchCriteriaId": "627C15A0-669D-4E56-9C31-8B8FBF60F3C0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.6.0:*:*:*:*:*:*:*", "matchCriteriaId": "72D1B13B-96DE-4151-BEEC-2D438CBD4B7E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.6.3:*:*:*:*:*:*:*", "matchCriteriaId": "F90B1079-9276-486F-86B8-B7E2FEF49B84"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.6.4:*:*:*:*:*:*:*", "matchCriteriaId": "9A8E67F2-6A68-4DF2-BBFC-CD5FB8401CCF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.7.0:*:*:*:*:*:*:*", "matchCriteriaId": "7D151CA6-9C63-489D-B4AC-19F357E75C73"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.7.1:*:*:*:*:*:*:*", "matchCriteriaId": "A47C57AC-1892-40FE-9F03-DAFBAF509976"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.8.0:*:*:*:*:*:*:*", "matchCriteriaId": "9EB06946-318C-4E86-8F73-43E16A9EFEA3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.8.1:*:*:*:*:*:*:*", "matchCriteriaId": "5F03A874-0753-49F6-A9BD-3798929B3C1C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:0.8.2:*:*:*:*:*:*:*", "matchCriteriaId": "57048132-7659-444A-B78A-12B199E935B7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:1.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "F00DA27E-EB76-4773-A7DE-14246C24FFFA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:1.1.0:*:*:*:*:*:*:*", "matchCriteriaId": "1A8B33E0-77F2-405F-8755-02C30509C652"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:1.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "49E5A94C-3262-4AA3-90F0-5E7B45E213A5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:1.2.0:*:*:*:*:*:*:*", "matchCriteriaId": "63C61B64-0B37-4F7B-8C47-BCA425E09A97"}, {"vulnerable": true, "criteria": "cpe:2.3:a:macournoyer:thin:1.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "2F2E2ACB-9ED2-4712-8A25-DE288DBF27DE"}]}]}], "references": [{"url": "http://github.com/macournoyer/thin/blob/master/CHANGELOG", "source": "cve@mitre.org"}, {"url": "http://github.com/macournoyer/thin/commit/7bd027914c5ffd36bb408ef47dc749de3b6e063a", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://www.openwall.com/lists/oss-security/2009/09/12/1", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0005", "comment": "CVE-2009-3287 - Command Injection Attack. An attacker can inject commands into the system using the X-Forwarded-For header, allowing for code execution and remote command injection."}, {"techniqueID": "TA0003", "comment": "CVE-2009-3287 - File Inclusion Weakness. The vulnerable code relies on the X-Forwarded-For header to determine the IP address of the client, allowing for file inclusion attacks and possible code execution."}, {"techniqueID": "TA0002", "comment": "CVE-2009-3287 - OS Command Injection. The vulnerable code executes system commands based on user input, allowing for system command injection and code execution."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2009-3287", "created_by_ref": "https://stix2.io/", "created": "2022-01-01T12:00:00.000Z", "modified": "2022-01-01T12:00:00.000Z", "name": "lib/thin/connection.rb Remote Command Injection Vulnerability", "description": "The vulnerability exists in the lib/thin/connection.rb file of the Thin web server before version 1.2.4.", "keywords": ["command injection", "remote command execution", "X-Forwarded-For header"], "relevant_av": ["AV:N"], "relevant_ac": ["AC:L"], "relevant Au": ["Au:N"], "relevant impact": ["C:P", "I:P", "A:P"], "references": [{"id": "http://github.com/macournoyer/thin/blob/master/CHANGELOG", "source": "cve@mitre.org", "role": "patch"}]}, {"type": "intrusion-set", "id": "Threat-Actor", "created_by_ref": "https://stix2.io/", "created": "2022-01-01T12:00:00.000Z", "modified": "2022-01-01T12:00:00.000Z", "name": "Threat Actor", "description": "The threat actor is known to exploit this vulnerability to gain remote command execution access to the targeted system.", "_intrusions": [{"id": "http://stix2.io/courses-of-action/COA-1-Remote-Command-Execution", "description": "The threat actor exploits the command injection vulnerability to execute arbitrary system commands remotely."}]}, {"type": "course-of-action", "id": "COA-1-Remote-Command-Execution", "created_by_ref": "https://stix2.io/", "created": "2022-01-01T12:00:00.000Z", "modified": "2022-01-01T12:00:00.000Z", "name": "COA-1: Remote Command Execution", "description": "Implement patch and update Thin web server to version 1.2.4 or later.", "mitigated_by_ref": "CVE-2009-3287"}], "relationships": [{"id": "https://stix2.io/relationship/1", "source_ref": "CVE-2009-3287", "target_ref": "Threat-Actor", "type": "related-to"}, {"id": "https://stix2.io/relationship/2", "source_ref": "COA-1-Remote-Command-Execution", "target_ref": "CVE-2009-3287", "type": "mitigates"}]}, "technical_analysis": {"Introduction": "The CVE-2009-3287 vulnerability is a remote command injection vulnerability in the lib/thin/connection.rb file of the Thin web server before version 1.2.4. An attacker can exploit this vulnerability to execute arbitrary system commands remotely.", "Impact and Scope": "The impact of this vulnerability is high, as it allows for remote command execution and potentially leads to full system compromise.", "Related MITRE ATT&CK Techniques": "TA0005, TA0003, TA0002", "Technical Details": "The vulnerability exists due to the use of the X-Forwarded-For header to determine the IP address of the client, allowing for file inclusion attacks and possible code execution.", "Detection": "The vulnerability can be detected by looking for malicious X-Forwarded-For headers in server logs and configuring web server access controls to prevent unauthorized access.", "Mitigation": "Apply the patch to update the Thin web server to version 1.2.4 or later, and implement rate limiting and IP blocking controls to prevent malicious requests.", "Conclusion": "The CVE-2009-3287 vulnerability is a significant security risk and requires immediate attention to prevent exploitation."}, "executive_analysis": {"Overview": "The CVE-2009-3287 vulnerability is a remote command injection vulnerability in the Thin web server that allows for remote command execution and potentially leads to full system compromise.", "Business Impact": "This vulnerability poses a significant risk to business operations and can result in financial loss and reputational damage.", "Technical Impact": "The vulnerability can be exploited by attackers to gain remote command execution access to the targeted system, potentially leading to full system compromise.", "Mitigation Strategies": "Apply the patch to update the Thin web server to version 1.2.4 or later, and implement rate limiting and IP blocking controls to prevent malicious requests.", "Recommendations": "Recommend implementing a web application firewall and configuring server access controls to prevent unauthorized access.", "Conclusions": "The CVE-2009-3287 vulnerability is a critical security risk and requires immediate attention to prevent exploitation."}}