{"id": "CVE-2009-3016", "sourceIdentifier": "cve@mitre.org", "published": "2009-08-31T16:30:07.017", "lastModified": "2017-09-19T01:29:24.530", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Apple Safari 4.0.3 does not properly block javascript: and data: URIs in Refresh headers in HTTP responses, which allows remote attackers to conduct cross-site scripting (XSS) attacks via vectors related to (1) injecting a Refresh header that contains a javascript: URI, (2) entering a javascript: URI when specifying the content of a Refresh header, (3) injecting a Refresh header that contains JavaScript sequences in a data:text/html URI, or (4) entering a data:text/html URI with JavaScript sequences when specifying the content of a Refresh header."}, {"lang": "es", "value": "Apple Safari v4.0.3 no bloquea URIs JavaScript: ni data: de forma adecuada en las cabeceras Refresh en las respuestas HTTP, lo que permite a atacantes remotos realizar un ataque de ejecuci\u00f3n de secuencias de comandos en sitios cruzados (XSS) a trav\u00e9s de vectores relativos a (1) inyectando una cabecera Refresh que contiene una URI javascript:, (2) introduciendo una URI javascript: cuando se especifica el contenido de una cabecera Refresh, (3) inyectando a una cabecera Refresh que contiene secuencias javascript en una URI data:text/html, o (4) introduciendo una URI data:text/html con secuencias javascript cuando se especifica el contenido de una cabecera Refresh."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apple:safari:4.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "80E36485-565D-4FAA-A6AD-57DF42D47462"}]}]}], "references": [{"url": "http://websecurity.com.ua/3386/", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/52992", "source": "cve@mitre.org"}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6475", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "Cross-Site Scripting (XSS) - Apple Safari 4.0.3 does not properly block javascript: and data: URIs in Refresh headers in HTTP responses, which allows remote attackers to conduct cross-site scripting (XSS) attacks. Defend against this by using Content Security Policy, validating and sanitizing user input, and using a reputable library for parsing HTML."}, {"techniqueID": "T1191", "comment": "Cross-Site Scripting (XSS) - Apple Safari 4.0.3 does not properly block javascript: and data: URIs in Refresh headers in HTTP responses, which allows remote attackers to conduct cross-site scripting (XSS) attacks. Defend against this by using Content Security Policy, validating and sanitizing user input, and using a reputable library for parsing HTML."}], "stix_bundle": {"bundle_type": "Bundle", "id": "my_bundle", "generated_by": "Vulnerability analysis tool", "valid_until": "2023-02-28", "objects": [{"id": "vulnerability", "type": "vulnerability", "name": "CVE-2009-3016", "description": "Apple Safari 4.0.3 does not properly block javascript: and data: URIs in Refresh headers in HTTP responses, which allows remote attackers to conduct cross-site scripting (XSS) attacks.", "attack_pattern": [{"id": "cross-site-scripting", "type": "attack-pattern", "name": "Cross-Site Scripting", "description": "Cross-Site Scripting (XSS) is an attack where malware is injected into a web application, allowing an attacker to steal or manipulate user data."}], "course_of_action": [{"id": "content-security-policy", "type": "course-of-action", "name": "Use Content Security Policy", "description": "Mute or sandbox scripts to prevent XSS attacks.", "associated_attacks": ["cross-site-scripting"]}, {"id": "validate-and-sanitize-user-input", "type": "course-of-action", "name": "Validate and Sanitize User Input", "description": "Validate and sanitize user input to prevent XSS attacks.", "associated_attacks": ["cross-site-scripting"]}, {"id": "use-reputable-library-parser", "type": "course-of-action", "name": "Use Reputable Library for Parsing HTML", "description": "Use a reputable library for parsing HTML to prevent XSS attacks.", "associated_attacks": ["cross-site-scripting"]}]}]}, "technical_analysis": {"Introduction": "Apple Safari 4.0.3 is vulnerable to cross-site scripting (XSS) attacks due to its failing to properly block certain types of URIs in HTTP responses.", "Impact and Scope": "The vulnerability affects Apple Safari 4.0.3 and allows remote attackers to conduct cross-site scripting (XSS) attacks. CVSS 2.0 score: 4.3", "Related MITRE ATT&CK Techniques": "T1190, T1191", "Technical Details": "The vulnerability occurs due to Apple Safari 4.0.3's failure to properly block certain types of URIs in HTTP responses, which allows remote attackers to inject malware into the web application.", "Detection": "Methods for detecting the vulnerability include searching for HTTP responses containing certain types of URIs or monitoring for suspicious web traffic.", "Mitigation": "Mitigation strategies include using Content Security Policy, validating and sanitizing user input, and using a reputable library for parsing HTML.", "Conclusion": "In conclusion, the vulnerability in Apple Safari 4.0.3 is a significant security risk and should be mitigated as soon as possible."}, "executive_analysis": {"Overview": "Apple Safari 4.0.3 is vulnerable to cross-site scripting (XSS) attacks, which can have significant business and technical impacts.", "Business Impact": "XSS attacks can compromise sensitive data, leading to financial losses, reputational damage, and regulatory non-compliance.", "Technical Impact": "The vulnerability can also lead to server-side request forgery, cross-site request forgery, and other types of attacks.", "Mitigation Strategies": "Implementing Content Security Policy, validating and sanitizing user input, and using a reputable library for parsing HTML can help mitigate the risk.", "Recommendations": "Recommendations for executives include prioritizing the vulnerability, allocating resources for mitigation, and monitoring the vulnerability's remediation progress.", "Conclusions": "In conclusion, the vulnerability in Apple Safari 4.0.3 is a serious security risk and should be addressed promptly to mitigate business and technical impacts."}}