{"id": "CVE-2007-5772", "sourceIdentifier": "cve@mitre.org", "published": "2007-11-01T16:46:00.000", "lastModified": "2018-10-15T21:46:29.067", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Direct static code injection vulnerability in the download module in Flatnuke 3 allows remote authenticated administrators to inject arbitrary PHP code into a description.it.php file in a subdirectory of Download/ by saving a description and setting fneditmode to 1.  NOTE: unauthenticated remote attackers can exploit this by leveraging a cookie manipulation issue."}, {"lang": "es", "value": "Vulnerabilidad de inyecci\u00f3n directa de c\u00f3digo est\u00e1tico en el m\u00f3dulo de descargas de Flatnuke 3 permite a administradores remotos inyectar c\u00f3digo PHP de su elecci\u00f3n en el fichero description.it.php en un subdirectorio de Download/ guardando una descripci\u00f3n y estableciendo fneditmode a 1. NOTA: atacantes remotos no autenticados pueden explotar esto realizando manipulaciones en una cookie."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 6.8, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": true, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:flatnuke3:flatnuke3:*:*:*:*:*:*:*:*", "matchCriteriaId": "0DDC43B9-11E7-4556-A79D-6BCD57C17F87"}]}]}], "references": [{"url": "http://osvdb.org/43636", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/482774/100/0/threaded", "source": "cve@mitre.org"}, {"url": "https://www.exploit-db.com/exploits/4562", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059", "comment": "CVE-2007-5772 - Unauthenticated remote code execution vulnerability in a Flatnuke 3 download module through cookie manipulation. Defend against this by validating input and limiting access to authorized users."}, {"techniqueID": "T1190", "comment": "CVE-2007-5772 - Web shell deployment on a vulnerable Flatnuke 3 installation. Defend against this by monitoring network traffic and unusual system behaviors, and implementing web application firewalls."}, {"techniqueID": "T1078", "comment": "CVE-2007-5772 - Code execution vulnerability in Flatnuke 3 download module through PHP injection. Defend against this by validating and sanitizing user input, and limiting access to authorized users."}], "stix_bundle": {"@stix": {"version": "2.1"}, "bundle_label": "CVE-2007-5772-STIX-Bundle", "objects": [{"Kind": "vulnerability", "id": "CVE-2007-5772", "name": "Flatnuke 3 Download Module PHP Injection Vulnerability", "description": "Direct static code injection vulnerability in the download module in Flatnuke 3 allows remote authenticated administrators to inject arbitrary PHP code into a description.it.php file in a subdirectory of Download/ by saving a description and setting fneditmode to 1. NOTE: unauthenticated remote attackers can exploit this by leveraging a cookie manipulation issue.", "mitre_id": "CVE-2007-5772", "CVE_data_metadata": {"Problemtype": {"problemtype_data": {"affected_product": [{"vulnerable_software_package": {"name": "Flatnuke 3", "cpe": "2.3:a:flatnuke3:flatnuke3:*:*:*:*:*:*:*"}}]}}}}, {"Kind": "attack-pattern", "id": "T1059", "name": "Command and Scripting Interpreter", "description": "The adversary uses the command and scripting interpreter to execute arbitrary commands.", "related_objects": [{"object_reference": "CVE-2007-5772", "relationship": "exploited_by"}]}, {"Kind": "attack-pattern", "id": "T1190", "name": "Web Shell", "description": "The adversary uses a web shell to remotely access and control the affected system.", "related_objects": [{"object_reference": "CVE-2007-5772", "relationship": "exploited_by"}]}, {"Kind": "attack-pattern", "id": "T1078", "name": "Code Injection", "description": "The adversary injects arbitrary code into a process or program.", "related_objects": [{"object_reference": "CVE-2007-5772", "relationship": "exploited_by"}]}, {"Kind": "course-of-action", "id": "Mitigate-CVE-2007-5772", "name": "Mitigate-CVE-2007-5772", "description": "Apply patches, validate input, limit access to authorized users, and implement web application firewalls.", "related_objects": [{"object_reference": "CVE-2007-5772", "relationship": "applies_to"}]}]}, "technical_analysis": {"Introduction": "CVE-2007-5772 is a direct static code injection vulnerability in the download module of Flatnuke 3, which allows remote authenticated administrators to inject arbitrary PHP code. This vulnerability can be exploited by unauthenticated remote attackers through cookie manipulation.", "Impact and Scope": "CVSS Score: 6.0, Version: 2.0, Attack Vector: NETWORK. This vulnerability allows remote code execution, which can lead to data theft, system compromise, and unauthorized access.", "Related MITRE ATT&CK Techniques": "T1059, T1190, T1078. These techniques demonstrate how the vulnerabilty can be exploited and what countermeasures can be taken.", "Technical Details": "The vulnerability occurs in the download module of Flatnuke 3, when an administrator saves a description and sets fneditmode to 1. This allows unauthenticated remote attackers to inject arbitrary PHP code and execute remote code execution.", "Detection": "Monitor network traffic for suspicious connections, monitor system logs for unusual system behaviors, and implement web application firewalls.", "Mitigation": "Apply patches, validate input, limit access to authorized users, and implement web application firewalls.", "Conclusion": "CVE-2007-5772 is a serious vulnerability that can be exploited by unauthenticated remote attackers. It is essential to apply patches, validate input, limit access to authorized users, and implement web application firewalls to mitigate the risk."}, "executive_analysis": {"Overview": "CVE-2007-5772 is a critical vulnerability in Flatnuke 3 that allows remote code execution. It is essential to address this vulnerability to prevent data theft, system compromise, and unauthorized access.", "Business Impact": "The impact of this vulnerability can be significant, potentially leading to financial losses, reputational damage, and regulatory issues.", "Technical Impact": "The vulnerability allows remote attackers to execute arbitrary PHP code, which can compromise the system and lead to data theft.", "Mitigation Strategies": "Apply patches, validate input, limit access to authorized users, and implement web application firewalls.", "Recommendations": "Immediately apply patches, validate input, limit access to authorized users, and implement web application firewalls.", "Conclusions": "CVE-2007-5772 is a critical vulnerability that requires immediate attention. It is essential to address this vulnerability to prevent data theft, system compromise, and unauthorized access."}}