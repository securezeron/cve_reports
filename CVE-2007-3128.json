{"id": "CVE-2007-3128", "sourceIdentifier": "cve@mitre.org", "published": "2007-06-19T17:30:00.000", "lastModified": "2018-10-16T16:47:38.527", "vulnStatus": "Modified", "cveTags": [], "evaluatorImpact": "Successful exploitation requires PHP magic_quotes_gpc set to OFF.", "descriptions": [{"lang": "en", "value": "SQL injection vulnerability in content.php in WSPortal 1.0, when magic_quotes_gpc is disabled, allows remote attackers to execute arbitrary SQL commands via the page parameter."}, {"lang": "es", "value": "Vulnerabilidad de inyecci\u00f3n SQL en content.php de WSPortal 1.0, cuando magic_quotes_gpc est\u00e1 deshabilitado, permite a atacantes remotos ejecutar comandos SQL de su elecci\u00f3n a trav\u00e9s del par\u00e1metro page."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 6.4}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ibm:websphere_portal:1.0:*:*:*:*:*:*:*", "matchCriteriaId": "FF2C6181-C0C5-4F0A-A800-663CC9DAD9E0"}]}]}], "references": [{"url": "http://archives.neohapsis.com/archives/fulldisclosure/2007-06/0369.html", "source": "cve@mitre.org"}, {"url": "http://www.netvigilance.com/advisory0033", "source": "cve@mitre.org"}, {"url": "http://www.osvdb.org/34164", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/471629/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/24513", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/2237", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/34896", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1055", "comment": "CVE-2007-3128 - Untrusted data use vulnerability allowing attackers to inject SQL queries through the page parameter, leading to remote code execution. This technique is related to the 'SQL injection' attack vector and is a precursor to other attacks."}, {"techniqueID": "T12.001", "comment": "CVE-2007-3128 - SQL Injection attack using WSPortal 1.0, which is a vulnerability in PHP magic_quotes_gpc set to OFF. This vulnerability can be detected by monitoring network traffic for suspicious SQL queries and analyzing logs for unusual activity."}, {"techniqueID": "T1190", "comment": "CVE-2007-3128 - Web application scanning using SQL injection to discover additional vulnerabilities. This technique is relevant to the 'Web application scanning' attack vector and is a common precursor to further attacks."}], "stix_bundle": {"@context": "https://stix2.io/api/2.1", "bundle": {"id": "bundle-164", "created_by_ref": "https://stix2.io/api/2.1/Identity/identity-1", "created": "2022-09-01T00:00:00.000Z", "modified": "2022-09-01T00:00:00.000Z", "description": "STIX Bundle for CVE-2007-3128", "objects": [{"type": "malware", "id": "malware-1", "name": "WSPortal 1.0 SQL Injection Vulnerability", "description": "WSPortal 1.0 SQL Injection Vulnerability", "labels": ["sql injection", "untrusted data use"], "created_by_ref": "https://stix2.io/api/2.1/Identity/identity-1", "created": "2022-09-01T00:00:00.000Z", "modified": "2022-09-01T00:00:00.000Z"}, {"type": "intrusion-set", "id": "intrusion-set-1", "name": "Unknown", "description": "Unknown", "labels": [" unknown"], "created_by_ref": "https://stix2.io/api/2.1/Identity/identity-1", "created": "2022-09-01T00:00:00.000Z", "modified": "2022-09-01T00:00:00.000Z"}, {"type": "indicator", "id": "indicator-1", "name": "SQL Injection Indicator", "description": "Indicator for SQL injection attacks", "labels": ["sql injection", "web application scanning"], "pattern": "/* query execution */", "pattern_type": "string", "created_by_ref": "https://stix2.io/api/2.1/Identity/identity-1", "created": "2022-09-01T00:00:00.000Z", "modified": "2022-09-01T00:00:00.000Z"}, {"type": "course-of-action", "id": "course-of-action-1", "name": "Mitigation", "description": "Mitigate the vulnerability by disabling magic_quotes_gpc", "labels": ["mitigation"], "created_by_ref": "https://stix2.io/api/2.1/Identity/identity-1", "created": "2022-09-01T00:00:00.000Z", "modified": "2022-09-01T00:00:00.000Z"}], "relationships": [{"type": "vulnerability", "id": "vulnerability-1", "source_ref": "objects/malware-1", "target_ref": "objects/course-of-action-1", "label": "mitigates"}, {"type": "indicates", "id": "indicates-1", "source_ref": "objects/indicator-1", "target_ref": "objects/malware-1", "label": "indicates"}]}}, "technical_analysis": {"Introduction": "CVE-2007-3128 is a vulnerability in WSPortal 1.0 that allows attackers to inject SQL queries through the page parameter, leading to remote code execution.", "Impact and Scope": "CVSS score: 6.4 (AV:N/AC:L/Au:N/C:P/I:P/A:N). The vulnerability is remotely exploitable without authentication and requires PHP magic_quotes_gpc set to OFF.", "Related MITRE ATT&CK Techniques": "T1055, T12.001, T1190", "Technical Details": "The vulnerability is caused by the lack of input validation in the content.php file, which allows attackers to inject arbitrary SQL queries.", "Detection": "Detection methods include monitoring network traffic for suspicious SQL queries and analyzing logs for unusual activity.", "Mitigation": "Mitigation strategies include disabling magic_quotes_gpc, updating PHP to a version with improved input validation, and implementing web application firewalls.", "Conclusion": "CVE-2007-3128 is a significant vulnerability that requires immediate attention. Implementing mitigation strategies and monitoring for suspicious activity is crucial to preventing remote code execution."}, "executive_analysis": {"Overview": "CVE-2007-3128 is a vulnerability in WSPortal 1.0 that allows attackers to inject SQL queries, leading to remote code execution.", "Business Impact": "The vulnerability has significant business implications, including data breaches, financial loss, and reputation damage.", "Technical Impact": "The vulnerability has technical implications, including the need for immediate updates, monitoring, and mitigation strategies.", "Mitigation Strategies": "Disabling magic_quotes_gpc, updating PHP, and implementing web application firewalls are crucial mitigation strategies.", "Recommendations": "Executives should prioritize vulnerability remediation, implement monitoring and detection, and implement mitigation strategies to prevent remote code execution.", "Conclusions": "CVE-2007-3128 is a critical vulnerability that requires immediate attention. Executives must take proactive steps to mitigate the vulnerability and prevent remote code execution."}}