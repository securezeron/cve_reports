{"id": "CVE-2007-5795", "sourceIdentifier": "secalert@redhat.com", "published": "2007-11-02T22:46:00.000", "lastModified": "2017-07-29T01:33:52.553", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The hack-local-variables function in Emacs before 22.2, when enable-local-variables is set to :safe, does not properly search lists of unsafe or risky variables, which might allow user-assisted attackers to bypass intended restrictions and modify critical program variables via a file containing a Local variables declaration."}, {"lang": "es", "value": "La funci\u00f3n hack-local-variables en el Emacs anterior al 22.2, cuando el enable-local-variables est\u00e1 establecido a :safe, no busca correctamente las listas de las variables no seguras o de riesgo, lo que permite a permite a atacantes con la intervenci\u00f3n del usuario evitar las restricciones y modificar variables de programa cr\u00edticas a trav\u00e9s de un fichero que contiene declaraciones de variables Locales."}], "vendorComments": [{"organization": "Red Hat", "comment": "Not vulnerable. This issue did not affect versions of Emacs as shipped with Red Hat Enterprise Linux 2.1, 3, 4, or 5.", "lastModified": "2007-11-09T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:N/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 6.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.4, "impactScore": 9.2, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:debian:debian_linux:*:*:*:*:*:*:*:*", "matchCriteriaId": "4C8919F1-CD33-437E-9627-69352B276BA3"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gnu:emacs:*:*:*:*:*:*:*:*", "versionEndIncluding": "22.1", "matchCriteriaId": "F4FB1FAE-4C0F-4F1E-B2D8-C56B5603937D"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gnu:emacs:*:*:*:*:*:*:*:*", "versionEndIncluding": "22.1", "matchCriteriaId": "F4FB1FAE-4C0F-4F1E-B2D8-C56B5603937D"}]}]}], "references": [{"url": "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=449008", "source": "secalert@redhat.com"}, {"url": "http://bugs.gentoo.org/show_bug.cgi?id=197958", "source": "secalert@redhat.com"}, {"url": "http://cvs.savannah.gnu.org/viewvc/emacs/emacs/lisp/files.el?r1=1.896.2.28&r2=1.896.2.29", "source": "secalert@redhat.com"}, {"url": "http://docs.info.apple.com/article.html?artnum=307562", "source": "secalert@redhat.com"}, {"url": "http://lists.apple.com/archives/security-announce/2008/Mar/msg00001.html", "source": "secalert@redhat.com"}, {"url": "http://osvdb.org/42060", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/27508", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/27627", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/27728", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/27984", "source": "secalert@redhat.com"}, {"url": "http://secunia.com/advisories/29420", "source": "secalert@redhat.com"}, {"url": "http://security.gentoo.org/glsa/glsa-200712-03.xml", "source": "secalert@redhat.com"}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2008:034", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/bid/26327", "source": "secalert@redhat.com"}, {"url": "http://www.ubuntu.com/usn/usn-541-1", "source": "secalert@redhat.com"}, {"url": "http://www.vupen.com/english/advisories/2007/3715", "source": "secalert@redhat.com"}, {"url": "http://www.vupen.com/english/advisories/2008/0924/references", "source": "secalert@redhat.com"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/38263", "source": "secalert@redhat.com"}, {"url": "https://www.redhat.com/archives/fedora-package-announce/2007-November/msg00524.html", "source": "secalert@redhat.com"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2007-5795 - This vulnerability allows attackers to bypass intended restrictions and modify critical program variables via a file containing a Local variables declaration, exploiting the hack-local-variables function in Emacs before 22.2."}, {"techniqueID": "T1191", "comment": "CVE-2007-5795 - By exploiting this vulnerability, an attacker can elevate privileges on a compromised system, potentially leading to further exploitation or data theft."}], "stix_bundle": {"objects": [{"type": "indicator", "id": " indicator--93f35f4e-bd4a-41a6-8df1-d21fc53f1fe4", "created_by_ref": "identity--4f6e5f4f-4b6e-4f6e-8d4f-4c4f4f4c4f4c", "created": "2017-07-29T01:33:52.553", "name": "Vulnerable Emacs Configuration", "description": "An Emacs configuration that allows attackers to bypass intended restrictions and modify critical program variables via a file containing a Local variables declaration.", "first_seen": "2007-11-02T22:46:00.000", "last_seen": "2017-07-29T01:33:52.553", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "Reconnaissance"}], "objects": [{"type": "attack_pattern", "id": "attack_pattern--93f35f4e-bd4a-41a6-8df1-d21fc53f1fe4", "created_by_ref": "identity--4f6e5f4f-4b6e-4f6e-8d4f-4c4f4f4c4f4c", "created": "2017-07-29T01:33:52.553", "name": "Bypass intended restrictions", "description": "Exploit the hack-local-variables function in Emacs before 22.2 to bypass intended restrictions and modify critical program variables via a file containing a Local variables declaration.", "objects": [{"type": "kill_chain_phase", "id": "kill_chain_phase--93f35f4e-bd4a-41a6-8df1-d21fc53f1fe4", "created_by_ref": "identity--4f6e5f4f-4b6e-4f6e-8d4f-4c4f4f4c4f4c", "created": "2017-07-29T01:33:52.553", "name": "Reconnaissance", "description": "Gather information about the environment, such as vulnerable software configurations, user credentials, and network topology."}]}]}]}, "technical_analysis": {"Introduction": "The vulnerability affects Emacs before 22.2, allowing attackers to bypass intended restrictions and modify critical program variables via a file containing a Local variables declaration.", "Impact and Scope": "The vulnerability has a CVSS score of 6.3 and an attack vector of LOCAL. It can be exploited by anyone who has access to the affected system.", "Related MITRE ATT&CK Techniques": "T1190, T1191", "Technical Details": "The vulnerability arises from the hack-local-variables function in Emacs before 22.2, which does not properly search lists of unsafe or risky variables. This allows attackers to create a file containing a Local variables declaration that can be used to bypass intended restrictions and modify critical program variables.", "Detection": "Detect this vulnerability by monitoring for suspicious file uploads or modified configurations in Emacs, particularly those related to the hack-local-variables function.", "Mitigation": "Apply patches and updates to affected Emacs versions, restrict file uploads and configurations, and regularly scan for and remove malicious files.", "Conclusion": "This vulnerability highlights the importance of keeping software up-to-date and implementing proper security configurations to prevent exploitation."}, "executive_analysis": {"Overview": "This vulnerability allows attackers to bypass intended restrictions and modify critical program variables, potentially leading to further exploitation or data theft.", "Business Impact": "The vulnerability can have significant business impacts, such as data breaches, system compromise, and reputational damage.", "Technical Impact": "The vulnerability affects the security and integrity of critical program variables, making it easier for attackers to exploit system vulnerabilities.", "Mitigation Strategies": "Apply patches and updates, restrict file uploads and configurations, and regularly scan for and remove malicious files.", "Recommendations": "Immediately apply patches and updates to affected Emacs versions, restrict file uploads and configurations, and regularly scan for and remove malicious files.", "Conclusions": "This vulnerability highlights the importance of keeping software up-to-date and implementing proper security configurations to prevent exploitation. It is essential to prioritize patching and updating affected systems to minimize the risk of exploitation."}}