{"id": "CVE-2009-3307", "sourceIdentifier": "cve@mitre.org", "published": "2009-09-23T12:08:35.047", "lastModified": "2017-09-19T01:29:33.030", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Multiple PHP remote file inclusion vulnerabilities in FSphp 0.2.1 allow remote attackers to execute arbitrary PHP code via a URL in the FSPHP_LIB parameter to (1) FSphp.php, (2) navigation.php, and (3) pathwrite.php in lib/."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de inclusi\u00f3n remota de archivo PHP en FSphp v0.2.1, permite a atacantes remotos ejecutar c\u00f3digo PHP de su elecci\u00f3n a trav\u00e9s de una URL en el par\u00e1metro FSPHP_LIB a (1) FSphp.php, (2) navigation.php, y (3) pathwrite.php en lib/."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:frank_lichtenheld:fsphp:0.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "5DE3023A-A2CD-43F4-BCC6-735853607393"}]}]}], "references": [{"url": "http://www.exploit-db.com/exploits/9720", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2009/2704", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2009-3307 - This is a remote file inclusion vulnerability, which can be exploited by an attacker to execute arbitrary PHP code, thereby leading to a RCE. This can be mitigated by validating and sanitizing user input, as well as limiting the execution of 3rd party libraries."}, {"techniqueID": "T1191", "comment": "CVE-2009-3307 - This vulnerability can also be exploited using a Phishing tactic to trick the user into executing the malicious PHP code, hence this can also be applied to T1191 technique which describes the use of phishing tactics."}, {"techniqueID": "T1059", "comment": "CVE-2009-3307 - This is a common exploitation avenue for remote file inclusion vulnerabilities, hence this technique is also applicable in detecting the exploitation of this CVE."}, {"techniqueID": "T1068", "comment": "CVE-2009-3307 - This technique is applicable as the attacker can use a web shell to execute arbitrary PHP code and manipulate files on the targeted system."}, {"techniqueID": "T1078", "comment": "CVE-2009-3307 - This is a common post-exploitation tactic, where the attacker can use the remote file inclusion vulnerability to execute arbitrary PHP code and manipulate files on the targeted system, hence this technique is also applicable."}, {"techniqueID": "T1140", "comment": "CVE-2009-3307 - This technique is applicable as the attacker can use this remote file inclusion vulnerability to inject and execute arbitrary PHP code, hence allowing for an increasing privilege level."}], "stix_bundle": {"@stix2:Bundle": {"type": "bundle", "id": "CVE-2009-3307-bundle", "created_by_ref": "test", "modified": "2022-02-22T14:30:00.000Z", "objects": [{"@stix2:Vulnerability": {"type": "vulnerability", "id": "CVE-2009-3307", "created_by_ref": "test", "modified": "2022-02-22T14:30:00.000Z", "name": "FSphp 0.2.1 Remote File Inclusion Vulnerability", "description": ["FSphp 0.2.1 Remote File Inclusion Vulnerability"], "confidence": "high", "created": "2022-02-22T14:30:00.000Z", "objects": [{"@stix2:Technique": {"type": "technique", "id": "T1190", "created_by_ref": "test", "modified": "2022-02-22T14:30:00.000Z", "name": "Exploit Public-Facing Application", "description": ["Exploit Public-Facing Application"], "confidence": "high", "created": "2022-02-22T14:30:00.000Z"}}, {"@stix2:Technique": {"type": "technique", "id": "T1191", "created_by_ref": "test", "modified": "2022-02-22T14:30:00.000Z", "name": "Phishing", "description": ["Phishing"], "confidence": "high", "created": "2022-02-22T14:30:00.000Z"}}, {"@stix2:Technique": {"type": "technique", "id": "T1059", "created_by_ref": "test", "modified": "2022-02-22T14:30:00.000Z", "name": "Software Discovery", "description": ["Software Discovery"], "confidence": "high", "created": "2022-02-22T14:30:00.000Z"}}, {"@stix2:Technique": {"type": "technique", "id": "T1068", "created_by_ref": "test", "modified": "2022-02-22T14:30:00.000Z", "name": "Modifying Existing Authentic Privileges", "description": ["Modifying Existing Authentic Privileges"], "confidence": "high", "created": "2022-02-22T14:30:00.000Z"}}, {"@stix2:Technique": {"type": "technique", "id": "T1078", "created_by_ref": "test", "modified": "2022-02-22T14:30:00.000Z", "name": "OS Command Execution", "description": ["OS Command Execution"], "confidence": "high", "created": "2022-02-22T14:30:00.000Z"}}, {"@stix2:Technique": {"type": "technique", "id": "T1140", "created_by_ref": "test", "modified": "2022-02-22T14:30:00.000Z", "name": "Deobfuscate/Decode Files or Information", "description": ["Deobfuscate/Decode Files or Information"], "confidence": "high", "created": "2022-02-22T14:30:00.000Z"}}]}}]}}, "technical_analysis": {"Introduction": "FSphp 0.2.1 Remote File Inclusion Vulnerability is a devastating vulnerability that allows an attacker to execute arbitrary PHP code, thereby allowing for a complete compromise of the targeted system. The vulnerability is due to the lack of proper input validation and sanitization in the FSPHP_LIB parameter to the affected PHP scripts.", "Impact and Scope": "The vulnerability has a CVSS score of 7.5 and is classified as 'High' severity. The attack vector is 'NETWORK' and the vulnerable systems are those running PHP 0.2.1 with FSphp installed.", "Related MITRE ATT&CK Techniques": "T1190, T1191, T1059, T1068, T1078, T1140", "Technical Details": "The vulnerability can be exploited by an attacker to execute arbitrary PHP code, which can be used to manipulate files, execute system commands, and gain unauthorized access to the system.", "Detection": "The vulnerability can be detected by monitoring for abnormal PHP script behavior, such as unusual file access or modification patterns.", "Mitigation": "The vulnerability can be mitigated by validating and sanitizing user input, as well as limiting the execution of 3rd party libraries.", "Conclusion": "In conclusion, the FSphp 0.2.1 Remote File Inclusion Vulnerability is a critical vulnerability that can be exploited by an attacker to execute arbitrary PHP code and compromise the targeted system. It is essential to implement mitigation strategies and detect the vulnerability to prevent exploitation."}, "executive_analysis": {"Overview": "The FSphp 0.2.1 Remote File Inclusion Vulnerability is a critical security vulnerability that allows an attacker to execute arbitrary PHP code, thereby compromising the targeted system.", "Business Impact": "The vulnerability has the potential to cause significant damage to an organization's systems and data if exploited.", "Technical Impact": "The vulnerability can be exploited to gain unauthorized access to the system, execute system commands, and manipulate files.", "Mitigation Strategies": "Implement input validation and sanitization, limit the execution of 3rd party libraries, and monitor for abnormal PHP script behavior.", "Recommendations": "Recommendation 1: Implement input validation and sanitization Recommendation 2: Limit the execution of 3rd party libraries Recommendation 3: Monitor for abnormal PHP script behavior", "Conclusions": "In conclusion, the FSphp 0.2.1 Remote File Inclusion Vulnerability is a critical vulnerability that requires immediate attention and mitigation. It is essential to implement mitigation strategies and detect the vulnerability to prevent exploitation."}}