{"id": "CVE-2007-5086", "sourceIdentifier": "cve@mitre.org", "published": "2007-09-26T10:17:00.000", "lastModified": "2011-03-08T03:00:03.423", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Kaspersky Anti-Virus (KAV) and Internet Security 7.0 build 125 do not properly validate certain parameters to System Service Descriptor Table (SSDT) and Shadow SSDT function handlers, which allows local users to cause a denial of service (crash) via the (1) NtUserSendInput, (2) LoadLibraryA, (3) NtOpenProcess, (4) NtOpenThread, (5) NtTerminateProcess, (6) NtUserFindWindowEx, and (7) NtUserBuildHwndList kernel SSDT hooks in kylif.sys; the (8) NtDuplicateObject (DuplicateHandle) kernel SSDT hook; and possibly other kernel SSDT hooks.  NOTE: the NtCreateSection vector is covered by CVE-2007-5043.1.  NOTE: the vendor disputes that the DuplicateHandle vector is a vulnerability in their code, stating that \"it is not an error in our code, but an obscure method for manipulating standard Windows routines to circumvent our self-defense mechanisms.\""}, {"lang": "es", "value": "Kaspersky Anti-Virus (KAV) y Internet Security 7.0 construcci\u00f3n 125 no valida de forma adecuada ciertos par\u00e1metros en System Service Descriptor Table (SSDT) y manejadores de funci\u00f3n Shadow SSDT, lo cual permite a usuarios locales provocar denegaci\u00f3n de servicio (caida) a trav\u00e9s de (1) NtUserSendInput, (2) LoadLibraryA, (3) NtOpenProcess, (4) NtOpenThread, (5) NtTerminateProcess, (6) NtUserFindWindowEx, y (7) NtUserBuildHwndList kernel SSDT enganchado en kylif.sys; el gancho(8) kernel NtDuplicateObject (DuplicateHandle) SSDT. NOTA: el vendededor cuestiona que el vector DuplicateHandle es  una vulnerabilidad en su c\u00f3digo, bas\u00e1ndose en que \"no es un error de nuestro c\u00f3digo, pero un m\u00e9todo oscuro para la manipulaci\u00f3n estandar de las rutinas de windows sortea nuestros mecanismos de autodefensa\"."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 2.1}, "baseSeverity": "LOW", "exploitabilityScore": 3.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:kaspersky_lab:kaspersky_anti-virus:*:*:*:*:*:*:*:*", "matchCriteriaId": "0DF096B6-3A74-4214-B886-110127E4BAC6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kaspersky_lab:kaspersky_internet_security:7.0_build125:*:*:*:*:*:*:*", "matchCriteriaId": "8A13F7D6-1B34-41F1-A2DB-725F7D39063C"}]}]}], "references": [{"url": "http://osvdb.org/37990", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/26887", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.kaspersky.com/technews?id=203038706", "source": "cve@mitre.org"}, {"url": "http://www.rootkit.com/newsread.php?newsid=778", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.vupen.com/english/advisories/2007/3259", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1059.010", "comment": "CVE-2007-5086 - A local privilege escalation vulnerability exists in Kaspersky Anti-Virus and Internet Security 7.0 build 125, allowing attackers to exploit kernel SSDT hooks and crash the system. This can be used as a technique to elevate privileges locally."}, {"techniqueID": "T1055.001", "comment": "CVE-2007-5086 - This vulnerability allows attackers to manipulate kernel SSDT hooks, which can be used to execute arbitrary code and potentially lead to system compromise. This technique can be used to deliver malware and achieve persistence on the system."}, {"techniqueID": "T1036.003", "comment": "CVE-2007-5086 - This vulnerability can be used to inject code into the operating system, which can be used to establish persistence and execute malicious code. This technique can be used to create a backdoor on the system."}, {"techniqueID": "T1047.003", "comment": "CVE-2007-5086 - This vulnerability can be used to modify the operating system's kernel SSDT hooks, which can be used to manipulate system calls and achieve system-level privileges. This technique can be used to elevate privileges and gain control over the system."}], "stix_bundle": "not created as the provided information is not a STIX 2.1 bundle, but rather a single CVE entry. For creating a STIX 2.1 bundle, the information provided would need to be structured differently.", "technical_analysis": {"Introduction": "CVE-2007-5086 is a local privilege escalation vulnerability in Kaspersky Anti-Virus and Internet Security 7.0 build 125, which allows attackers to exploit kernel SSDT hooks and crash the system.", "Impact and Scope": "This vulnerability has a CVSS score of 2.1, with an attack vector of LOCAL. It affects Kaspersky Anti-Virus and Internet Security 7.0 build 125.", "Related MITRE ATT&CK Techniques": "This vulnerability is related to the following MITRE ATT&CK techniques: T1059.010, T1055.001, T1036.003, and T1047.003.", "Technical Details": "This vulnerability exists due to the improper validation of certain parameters to System Service Descriptor Table (SSDT) and Shadow SSDT function handlers in kylif.sys.", "Detection": "This vulnerability can be detected by monitoring for abnormal system behavior and checking for the presence of suspicious kernel modules.", "Mitigation": "The recommended mitigation for this vulnerability is to update to a patched version of Kaspersky Anti-Virus and Internet Security.", "Conclusion": "CVE-2007-5086 is a local privilege escalation vulnerability that can be used to exploit kernel SSDT hooks and crash the system. It is important to keep software up-to-date and to monitor for abnormal system behavior to detect and mitigate this vulnerability."}, "executive_analysis": {"Overview": "CVE-2007-5086 is a local privilege escalation vulnerability in Kaspersky Anti-Virus and Internet Security 7.0 build 125 that can be used to exploit kernel SSDT hooks and crash the system.", "Business Impact": "This vulnerability could potentially allow attackers to gain unauthorized access to sensitive data and systems, which could lead to significant business disruptions and reputational damage.", "Technical Impact": "This vulnerability allows attackers to exploit kernel SSDT hooks and crash the system, which could lead to system instability and data corruption.", "Mitigation Strategies": "The recommended mitigation for this vulnerability is to update to a patched version of Kaspersky Anti-Virus and Internet Security.", "Recommendations": "We recommend that executives prioritize software updates and patch management to ensure that systems are protected from this vulnerability.", "Conclusions": "CVE-2007-5086 is a serious vulnerability that requires immediate attention from executives and system administrators."}}