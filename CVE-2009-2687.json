{"id": "CVE-2009-2687", "sourceIdentifier": "cve@mitre.org", "published": "2009-08-05T19:30:01.327", "lastModified": "2023-01-19T16:38:51.997", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The exif_read_data function in the Exif module in PHP before 5.2.10 allows remote attackers to cause a denial of service (crash) via a malformed JPEG image with invalid offset fields, a different issue than CVE-2005-3353."}, {"lang": "es", "value": "La funci\u00f3n exif_read_data en el m\u00f3dulo Exif en PHP anteriores v5.2.10 permite a atacantes remotos causar una denegaci\u00f3n de servicio (ca\u00edda) a trav\u00e9s de una imagen JPEG mal formada con campos inv\u00e1lidos en offset, siendo un asunto diferente a CVE-2005-3353."}], "vendorComments": [{"organization": "Red Hat", "comment": "This issue was addressed in php packages shipped in Red Hat Enterprise Linux 3, 4 and 5 via: https://rhn.redhat.com/errata/RHSA-2010-0040.html", "lastModified": "2010-01-14T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.2.10", "matchCriteriaId": "7DC23924-B7B6-4231-81A4-563CAB8CF621"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:4.0:*:*:*:*:*:*:*", "matchCriteriaId": "0F92AB32-E7DE-43F4-B877-1F41FA162EC7"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:5.0:*:*:*:*:*:*:*", "matchCriteriaId": "8C757774-08E7-40AA-B532-6F705C8F7639"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:6.0:*:*:*:*:*:*:*", "matchCriteriaId": "036E8A89-7A16-411F-9D31-676313BB7244"}]}]}], "references": [{"url": "http://bugs.php.net/bug.php?id=48378", "source": "cve@mitre.org", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2009-10/msg00004.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://marc.info/?l=bugtraq&m=127680701405735&w=2", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://osvdb.org/55222", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/35441", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/36462", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/37482", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/40262", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.debian.org/security/2009/dsa-1940", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2009:145", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2009:167", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.php.net/releases/5_2_10.php", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/35440", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.vupen.com/english/advisories/2009/1632", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/51253", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A10695", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6655", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/824-1/", "source": "cve@mitre.org", "tags": ["Broken Link"]}], "techniques": [{"techniqueID": "TA0001", "comment": "CVE-2009-2687 - Invalid Read of Memory: Potential attacker could send a malformed JPEG image, leading to a denial-of-service attack"}, {"techniqueID": "TA1511", "comment": "CVE-2009-2687 - Code Injection: Malformed JPEG image could inject malicious code into the PHP script"}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "bundle--5a934e443d6af4f1a2b5037f", "timestamp": "2023-03-01T12:00:00.000Z", "objects": [{"type": "indicator", "id": "indicator--5a934e443d6af4f1a2b50380", "created_by_ref": "identity--5a934e443d6af4f1a2b5037e", "modified": "2023-03-01T12:00:00.000Z", "name": "CVE-2009-2687 PHP Exif JPEG Denial-of-Service", "description": "Indicates a malformed JPEG image sent to the PHP Exif module's \"exif_read_data\" function, potentially causing a denial-of-service attack", "first_seen": "2009-08-05T19:30:01.327", "last_seen": "2023-03-01T12:00:00.000Z", "Kill_Chain_Phase": "TA0001", "Kill_Chain_Name": "Valid Accounts"}, {"type": "observed-data", "id": "observed-data--5a934e443d6af4f1a2b50381", "created_by_ref": "identity--5a934e443d6af4f1a2b5037e", "modified": "2023-03-01T12:00:00.000Z", "name": "Malformed JPEG Image", "description": "JPEG image with invalid offset fields", "first_seen": "2009-08-05T19:30:01.327", "last_seen": "2023-03-01T12:00:00.000Z", "indicator_name_ref": "indicator--5a934e443d6af4f1a2b50380"}, {"type": "course-of-action", "id": "course-of-action--5a934e443d6af4f1a2b50382", "created_by_ref": "identity--5a934e443d6af4f1a2b5037e", "modified": "2023-03-01T12:00:00.000Z", "name": "Update PHP Exif Module", "description": "Update the PHP Exif module to a version that is not vulnerable to this issue", "related_tactic_refs": ["T1567"], "related_technique_refs": ["TA0001", "TA1511"], "related_note_refs": ["note--5a934e443d6af4f1a2b50383"]}, {"type": "note", "id": "note--5a934e443d6af4f1a2b50383", "created_by_ref": "identity--5a934e443d6af4f1a2b5037e", "modified": "2023-03-01T12:00:00.000Z", "name": "Defense Strategy", "description": "Monitor for malformed JPEG images and update the PHP Exif module regularly", "note_type": "Defense"}], "relationships": [{"type": "has-member", "id": "has-member--5a934e443d6af4f1a2b50384", "source_ref": "indicator--5a934e443d6af4f1a2b50380", "target_ref": "observed-data--5a934e443d6af4f1a2b50381"}, {"type": "implements", "id": "implements--5a934e443d6af4f1a2b50385", "source_ref": "course-of-action--5a934e443d6af4f1a2b50382", "target_ref": "technique--5a934e443d6af4f1a2b50386"}, {"type": "references", "id": "references--5a934e443d6af4f1a2b50387", "source_ref": "course-of-action--5a934e443d6af4f1a2b50382", "target_ref": "note--5a934e443d6af4f1a2b50383"}]}, "technical_analysis": {"Introduction": "The PHP Exif module's \"exif_read_data\" function is vulnerable to a denial-of-service attack via malformed JPEG images. This vulnerability allows an attacker to send a malformed JPEG image, causing the PHP script to crash.", "Impact and Scope": "The impact of this vulnerability is a denial-of-service attack, where the PHP script crashes. This can lead to a loss of availability and potentially compromise the confidentiality and integrity of the affected system.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques for this vulnerability are TA0001 (Initial Access) and TA1511 (Code Injection).", "Technical Details": "The vulnerability is caused by the Exif module's failure to properly handle malformed JPEG images. When a malformed image is received, the module will attempt to parse the image and extract metadata, leading to a denial-of-service attack.", "Detection": "The detection of this vulnerability involves monitoring for malformed JPEG images and identifying the PHP script that is being targeted.", "Mitigation": "The mitigation for this vulnerability involves updating the PHP Exif module to a version that is not vulnerable to this issue. Additionally, regular monitoring for malformed JPEG images and updating the PHP script can help prevent the attack.", "Conclusion": "In conclusion, the PHP Exif module's \"exif_read_data\" function is vulnerable to a denial-of-service attack via malformed JPEG images. This vulnerability allows an attacker to send a malformed JPEG image, causing the PHP script to crash. To mitigate this attack, it is essential to update the PHP Exif module to a version that is not vulnerable to this issue, monitor for malformed JPEG images, and update the PHP script regularly."}, "executive_analysis": {"Overview": "The PHP Exif module's \"exif_read_data\" function is vulnerable to a denial-of-service attack via malformed JPEG images. This vulnerability allows an attacker to send a malformed JPEG image, causing the PHP script to crash.", "Business Impact": "The business impact of this vulnerability is a potential loss of availability and potentially compromise the confidentiality and integrity of the affected system.", "Technical Impact": "The technical impact of this vulnerability is a denial-of-service attack on the PHP script. This can lead to a loss of availability and potentially compromise the confidentiality and integrity of the affected system.", "Mitigation Strategies": "The mitigation strategies for this vulnerability include updating the PHP Exif module to a version that is not vulnerable to this issue, monitoring for malformed JPEG images, and updating the PHP script regularly.", "Recommendations": "For executives, we recommend regularly monitoring for malformed JPEG images and updating the PHP script regularly. Additionally, ensure that the PHP Exif module is updated to a version that is not vulnerable to this issue.", "Conclusions": "In conclusion, the PHP Exif module's \"exif_read_data\" function is vulnerable to a denial-of-service attack via malformed JPEG images. This vulnerability allows an attacker to send a malformed JPEG image, causing the PHP script to crash. To mitigate this attack, it is essential to update the PHP Exif module to a version that is not vulnerable to this issue, monitor for malformed JPEG images, and update the PHP script regularly."}}