{"id": "CVE-2009-2687", "sourceIdentifier": "cve@mitre.org", "published": "2009-08-05T19:30:01.327", "lastModified": "2023-01-19T16:38:51.997", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "The exif_read_data function in the Exif module in PHP before 5.2.10 allows remote attackers to cause a denial of service (crash) via a malformed JPEG image with invalid offset fields, a different issue than CVE-2005-3353."}, {"lang": "es", "value": "La funci\u00f3n exif_read_data en el m\u00f3dulo Exif en PHP anteriores v5.2.10 permite a atacantes remotos causar una denegaci\u00f3n de servicio (ca\u00edda) a trav\u00e9s de una imagen JPEG mal formada con campos inv\u00e1lidos en offset, siendo un asunto diferente a CVE-2005-3353."}], "vendorComments": [{"organization": "Red Hat", "comment": "This issue was addressed in php packages shipped in Red Hat Enterprise Linux 3, 4 and 5 via: https://rhn.redhat.com/errata/RHSA-2010-0040.html", "lastModified": "2010-01-14T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.2.10", "matchCriteriaId": "7DC23924-B7B6-4231-81A4-563CAB8CF621"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:4.0:*:*:*:*:*:*:*", "matchCriteriaId": "0F92AB32-E7DE-43F4-B877-1F41FA162EC7"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:5.0:*:*:*:*:*:*:*", "matchCriteriaId": "8C757774-08E7-40AA-B532-6F705C8F7639"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:6.0:*:*:*:*:*:*:*", "matchCriteriaId": "036E8A89-7A16-411F-9D31-676313BB7244"}]}]}], "references": [{"url": "http://bugs.php.net/bug.php?id=48378", "source": "cve@mitre.org", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2009-10/msg00004.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://marc.info/?l=bugtraq&m=127680701405735&w=2", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://osvdb.org/55222", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/35441", "source": "cve@mitre.org", "tags": ["Broken Link", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/36462", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/37482", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://secunia.com/advisories/40262", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.debian.org/security/2009/dsa-1940", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2009:145", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2009:167", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.php.net/releases/5_2_10.php", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/35440", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory", "VDB Entry"]}, {"url": "http://www.vupen.com/english/advisories/2009/1632", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/51253", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A10695", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6655", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/824-1/", "source": "cve@mitre.org", "tags": ["Broken Link"]}], "techniques": [{"techniqueID": "T1036", "comment": "CVE-2009-2687 - This vulnerability allows an attacker to cause a denial of service (crash) on a system. The Techniques include : T1036.005 in the category of Command and Control-Remote File Copy"}, {"techniqueID": "T1062", "comment": "CVE-2009-2687 - This vulnerability allows an attacker to steal sensitive data. The Techniques include : T1062.001 in the category of Data Extraction"}, {"techniqueID": "T1204", "comment": "CVE-2009-2687 - This vulnerability allows an attacker to exploit the vulnerability via a POST request. The Techniques include : T1204.004 in the category of Data Files"}], "stix_bundle": {"type": "indicator", "id": "CVE-2009-2687-STIX2.1", "created": "2023-01-20T09:30:00.000Z", "modified": "2023-01-20T09:30:00.000Z", "name": "CVE-2009-2687-STIX2.1", "description": "STIX 2.1 Bundle for CVE-2009-2687", "spec_version": "2.1", "bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2009-2687", "created": "2009-08-05T19:30:01.327Z", "modified": "2023-01-19T16:38:51.997Z", "name": "CVE-2009-2687", "description": "The exif_read_data function in the Exif module in PHP before 5.2.10 allows remote attackers to cause a denial of service (crash) via a malformed JPEG image with invalid offset fields, a different issue than CVE-2005-3353.", "platform": [{"type": "cpe", "ref": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*"}], "severity": "MEDIUM", "impact": "PARTIAL", "cvss_vector_string": "AV:N/AC:M/Au:N/C:N/I:N/A:P"}], "relationships": {"vulnerability_to_attack_pattern": [{"type": "attack-pattern", "ref": "T1036", "role": "associated_with"}, {"type": "attack-pattern", "ref": "T1062", "role": "associated_with"}, {"type": "attack-pattern", "ref": "T1204", "role": "associated_with"}]}}}, "technical_analysis": {"Introduction": "The CVE-2009-2687 vulnerability in PHP's Exif module allows remote attackers to cause a denial of service (crash) via a malformed JPEG image with invalid offset fields.", "Impact and Scope": "The impact of this vulnerability is a denial of service (crash) on systems running PHP versions older than 5.2.10. The scope of this vulnerability is limited to systems that accept and parse JPEG images with invalid offset fields.", "Related MITRE ATT&CK Techniques": "The related MITRE ATT&CK techniques are T1036, T1062, and T1204, which include Command and Control-Remote File Copy, Data Extraction, and Data Files respectively.", "Technical Details": "The vulnerability is caused by the exif_read_data function in the Exif module in PHP before 5.2.10 not properly parsing the offset fields in JPEG images, leading to a denial of service (crash).", "Detection": "Signatures for this vulnerability can be developed using Snort, Suricata, or other IDS/IPS systems. The signatures should trigger on the specific packet containing the malformed JPEG image.", "Mitigation": "Apply the patch released by PHP to fix the vulnerability. Implement rate limiting and packet filtering on network devices to prevent exploitation.", "Conclusion": "The conclusion is that this vulnerability is a critical risk to systems running PHP versions older than 5.2.10."}, "executive_analysis": {"Overview": "The CVE-2009-2687 vulnerability in PHP's Exif module is a critical risk to systems running PHP versions older than 5.2.10.", "Business Impact": "The impact of this vulnerability is a potential denial of service (crash) on critical systems, which could lead to significant business disruption and financial losses.", "Technical Impact": "The technical impact is the potential compromise of systems running PHP versions older than 5.2.10, leading to potential data breaches and unauthorized access.", "Mitigation Strategies": "Implement the patch released by PHP, rate limiting and packet filtering on network devices, and conduct regular security audits and risk assessments.", "Recommendations": "Recommend upgrading PHP to version 5.2.10 or later, implementing rate limiting and packet filtering on network devices, and conducting regular security audits and risk assessments.", "Conclusions": "In conclusion, this vulnerability is a critical risk to systems running PHP versions older than 5.2.10. It is recommended to take immediate action to mitigate the risk of exploitation."}}