{"id": "CVE-2007-4659", "sourceIdentifier": "cve@mitre.org", "published": "2007-09-04T22:17:00.000", "lastModified": "2017-07-29T01:33:05.363", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "The zend_alter_ini_entry function in PHP before 5.2.4 does not properly handle an interruption to the flow of execution triggered by a memory_limit violation, which has unknown impact and attack vectors."}, {"lang": "es", "value": "La funci\u00f3n zend_alter_ini_entry de PHP versiones anteriores a 5.2.4 no gestiona apropiadamente una interrupci\u00f3n al flujo de ejecuci\u00f3n disparado por una violaci\u00f3n memory_limit, que tiene un impacto desconocido y vectores de ataque."}], "vendorComments": [{"organization": "Red Hat", "comment": "Not vulnerable. These issues did not affect the versions of PHP as shipped with Red Hat Enterprise Linux 2.1, 3, 4, 5 or Red Hat Application Stack v1.", "lastModified": "2007-09-05T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionEndIncluding": "5.2.3", "matchCriteriaId": "0CDA10FE-C930-4399-A0AE-1C9A6D547FB9"}]}]}], "references": [{"url": "http://secunia.com/advisories/26642", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://secunia.com/advisories/26822", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/26838", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27102", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/27377", "source": "cve@mitre.org"}, {"url": "http://secunia.com/advisories/28249", "source": "cve@mitre.org"}, {"url": "http://www.debian.org/security/2008/dsa-1444", "source": "cve@mitre.org"}, {"url": "http://www.gentoo.org/security/en/glsa/glsa-200710-02.xml", "source": "cve@mitre.org"}, {"url": "http://www.php.net/ChangeLog-5.php#5.2.4", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "http://www.php.net/releases/5_2_4.php", "source": "cve@mitre.org"}, {"url": "http://www.trustix.org/errata/2007/0026/", "source": "cve@mitre.org"}, {"url": "http://www.vupen.com/english/advisories/2007/3023", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/36380", "source": "cve@mitre.org"}, {"url": "https://issues.rpath.com/browse/RPL-1693", "source": "cve@mitre.org"}, {"url": "https://issues.rpath.com/browse/RPL-1702", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "TA0001", "comment": "Credential Dumping - This is relevant as the vulnerability allows for incomplete or destroyed PHP variables to be leveraged for code execution, which could potentially lead to execution of system commands and subsequent privilege escalation, making credential dumping possible."}, {"techniqueID": "TA0005", "comment": "Defense Evasion - The vulnerability's impact on PHP's execution can be leveraged to hide or modify system files, making it an attractive technique for defense evasion."}, {"techniqueID": "T1027", "comment": "Remote Services - As PHP is a remote service, an attacker could potentially leverage this vulnerability to remotely execute code, making it relevant to this technique."}, {"techniqueID": "T1217", "comment": "Scanner Vulnerability - The vulnerability itself could be used as a scanner vulnerability to identify and exploit other vulnerabilities on the system, making it relevant to this technique."}, {"techniqueID": "TA0347", "comment": "Lateral Movement - Once an attacker gains access through this vulnerability, they could potentially use it to move laterally throughout the system, making lateral movement possible."}, {"techniqueID": "T1133", "comment": "File and Object Permission Modification - The vulnerability's impact on PHP's execution can be leveraged to modify file permissions, making it relevant to this technique."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "CVE-2007-4659", "created_by_ref": "identity--cve@mitre.org", "modified": "2017-07-29T01:33:05.363", "objects": [{"type": "vulnerability", "id": "cve-2007-4659", "created_by_ref": "identity--cve@mitre.org", "modified": "2017-07-29T01:33:05.363", "name": "Zend Alter INI Entry Function", "description": "The zend_alter_ini_entry function in PHP before 5.2.4 does not properly handle an interruption to the flow of execution triggered by a memory_limit violation, which has unknown impact and attack vectors.", "references": [{"id": "http://secunia.com/advisories/26642", "source_name": "Secunia"}, {"id": "http://www.debian.org/security/2008/dsa-1444", "source_name": "Debian Security Team"}]}, {"type": "course-of-action", "id": "coa-1", "created_by_ref": "identity--cve@mitre.org", "modified": "2017-07-29T01:33:05.363", "name": "Apply Patch", "description": "Apply the patch provided by PHP and upgrade to version 5.2.4 or higher.", "related_tactics": [{"id_ref": "T1204"}]}, {"type": "course-of-action", "id": "coa-2", "created_by_ref": "identity--cve@mitre.org", "modified": "2017-07-29T01:33:05.363", "name": "Disable Zend Alter INI Entry Function", "description": "Disable the zend_alter_ini_entry function to prevent exploitation.", "related_tactics": [{"id_ref": "TA0011"}]}], " relationships": [{"source_ref": "cve-2007-4659", "target_ref": "coa-1", "relationship_type": "mitigates"}, {"source_ref": "cve-2007-4659", "target_ref": "coa-2", "relationship_type": "mitigates"}]}, "technical_analysis": {"Introduction": "This analysis focuses on the vulnerabilities and risks associated with CVE-2007-4659, a PHP vulnerability that allows for code execution and potentially leads to system compromise.", "Impact and Scope": "This vulnerability has a CVSS score of 7.5 and an attack vector of NETWORK, making it a medium-severity vulnerability. It affects PHP versions 5.2.3 and below.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to several MITRE ATT&CK techniques, including Credential Dumping, Defense Evasion, Remote Services, and Scanner Vulnerability.", "Technical Details": "The vulnerability occurs in the zend_alter_ini_entry function in PHP, which does not properly handle interruptions to the flow of execution triggered by a memory_limit violation.", "Detection": "Vulnerability detection involves monitoring system logs for suspicious activity and monitoring system resources for unusual patterns.", "Mitigation": "Mitigation strategies include applying the patch provided by PHP, disabling the zend_alter_ini_entry function, and implementing network segmentation and access controls.", "Conclusion": "In conclusion, CVE-2007-4659 is a significant vulnerability that affects PHP versions 5.2.3 and below. Immediate action is necessary to prevent exploitation and minimize risk."}, "executive_analysis": {"Overview": "This analysis provides an overview of the CVE-2007-4659 vulnerability and its potential impact on your organization.", "Business Impact": "The business impact of this vulnerability includes potential data compromise, system downtime, and reputational damage.", "Technical Impact": "The technical impact of this vulnerability includes potential code execution, system compromise, and lateral movement throughout the system.", "Mitigation Strategies": "Recommended mitigation strategies include applying the patch provided by PHP, disabling the zend_alter_ini_entry function, and implementing network segmentation and access controls.", "Recommendations": "We recommend that you prioritize this vulnerability and take immediate action to prevent exploitation and minimize risk.", "Conclusions": "In conclusion, immediate action is necessary to prevent exploitation and minimize risk. We recommend that you apply the patch provided by PHP and disable the zend_alter_ini_entry function to mitigate this vulnerability."}}