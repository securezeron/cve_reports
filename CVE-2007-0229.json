{"id": "CVE-2007-0229", "sourceIdentifier": "cve@mitre.org", "published": "2007-01-13T02:28:00.000", "lastModified": "2017-07-29T01:30:03.717", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Integer overflow in the ffs_mountfs function in Mac OS X 10.4.8 and FreeBSD 6.1 allows local users to cause a denial of service (panic) and possibly gain privileges via a crafted DMG image that causes \"allocation of a negative size buffer\" leading to a heap-based buffer overflow, a related issue to CVE-2006-5679.  NOTE: a third party states that this issue does not cross privilege boundaries in FreeBSD because only root may mount a filesystem."}, {"lang": "es", "value": "Un desbordamiento de enteros en la funci\u00f3n ffs_mountfs en Mac OS X versi\u00f3n 10.4.8 y FreeBSD versi\u00f3n 6.1, permite a los usuarios locales causar una denegaci\u00f3n de servicio (p\u00e1nico) y posiblemente conseguir privilegios por medio de una imagen DMG dise\u00f1ada que causa la \"allocation of a negative size buffer\" conllevando a un desbordamiento de b\u00fafer en la regi\u00f3n heap de la memoria, un problema relacionado con CVE-2006-5679. NOTA: un tercero declara que este problema no cruza los l\u00edmites de privilegios en FreeBSD porque solo el root puede montar un sistema de archivos."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": true, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-189"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:10.4.8:*:*:*:*:*:*:*", "matchCriteriaId": "09ED46A8-1739-411C-8807-2A416BDB6DFE"}, {"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x_server:10.4.8:*:*:*:*:*:*:*", "matchCriteriaId": "504D78AB-5374-48C9-B357-DB6BD2267D2D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:freebsd:freebsd:6.1:*:*:*:*:*:*:*", "matchCriteriaId": "F4416CBA-76B9-4051-B015-F1BE89517309"}]}]}], "references": [{"url": "http://applefun.blogspot.com/2007/01/moab-10-01-2007-apple-dmg-ufs.html", "source": "cve@mitre.org"}, {"url": "http://docs.info.apple.com/article.html?artnum=305214", "source": "cve@mitre.org"}, {"url": "http://lists.apple.com/archives/security-announce/2007/Mar/msg00002.html", "source": "cve@mitre.org"}, {"url": "http://lists.freebsd.org/pipermail/freebsd-security/2007-January/004218.html", "source": "cve@mitre.org"}, {"url": "http://projects.info-pull.com/moab/MOAB-10-01-2007.html", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://secunia.com/advisories/23703", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://secunia.com/advisories/24479", "source": "cve@mitre.org"}, {"url": "http://www.osvdb.org/32684", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/21993", "source": "cve@mitre.org"}, {"url": "http://www.securitytracker.com/id?1017751", "source": "cve@mitre.org"}, {"url": "http://www.us-cert.gov/cas/techalerts/TA07-072A.html", "source": "cve@mitre.org", "tags": ["US Government Resource"]}, {"url": "http://www.vupen.com/english/advisories/2007/0141", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2007/0930", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/31409", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2007-0229 - The integer overflow in the ffs_mountfs function allows an attacker to cause a denial of service (panic) and possibly gain privileges by crafting a DMG image that can lead to a heap-based buffer overflow. Defending against this involves implementing controls to restrict file system mounting and validating user input."}, {"techniqueID": "T1203", "comment": "CVE-2007-0229 - The vulnerability allows an attacker to create a malicious DMG image that can be used to exploit the heap-based buffer overflow. Defending against this involves implementing controls to restrict file system mounting and validating user input."}, {"techniqueID": "T1077", "comment": "CVE-2007-0229 - The vulnerability allows an attacker to create a malicious DMG image that can be used to exploit the heap-based buffer overflow. Defending against this involves implementing controls to restrict file system mounting and validating user input."}], "stix_bundle": {"bundle": {"description": "Bundle for CVE-2007-0229", "objects": [{"type": "vulnerability", "id": "vuln-CVE-2007-0229", "description": "Integer overflow in the ffs_mountfs function in Mac OS X 10.4.8 and FreeBSD 6.1 allowing local users to cause a denial of service (panic) and possibly gain privileges."}, {"type": "attack_pattern", "id": "pat-T1190", "description": "The integer overflow in the ffs_mountfs function allows an attacker to cause a denial of service (panic) and possibly gain privileges by crafting a DMG image that can lead to a heap-based buffer overflow."}, {"type": "attack_pattern", "id": "pat-T1203", "description": "The vulnerability allows an attacker to create a malicious DMG image that can be used to exploit the heap-based buffer overflow."}, {"type": "attack_pattern", "id": "pat-T1077", "description": "The vulnerability allows an attacker to create a malicious DMG image that can be used to exploit the heap-based buffer overflow."}, {"type": "course_of_action", "id": "coa-mitigation", "description": "Implement controls to restrict file system mounting and validate user input."}, {"type": "note", "id": "note-detection", "description": "Look for signs of file system mounting manipulation and unusual system behavior."}, {"type": "note", "id": "note-mitigation", "description": "Implement controls to restrict file system mounting and validate user input."}], "relationships": [{"id": "rel-vuln-pat", "type": "vulnerability_attack_pattern", "object_id": "vuln-CVE-2007-0229", "target_id": "pat-T1190", "sObject": true}, {"id": "rel-vuln-pat", "type": "vulnerability_attack_pattern", "object_id": "vuln-CVE-2007-0229", "target_id": "pat-T1203", "sObject": true}, {"id": "rel-vuln-pat", "type": "vulnerability_attack_pattern", "object_id": "vuln-CVE-2007-0229", "target_id": "pat-T1077", "sObject": true}, {"id": "rel-coa-pat", "type": "course_of_action_attack_pattern", "object_id": "coa-mitigation", "target_id": "pat-T1190", "sObject": false}, {"id": "rel-coa-pat", "type": "course_of_action_attack_pattern", "object_id": "coa-mitigation", "target_id": "pat-T1203", "sObject": false}, {"id": "rel-coa-pat", "type": "course_of_action_attack_pattern", "object_id": "coa-mitigation", "target_id": "pat-T1077", "sObject": false}, {"id": "rel-note-coa", "type": "note_course_of_action", "object_id": "note-detection", "target_id": "coa-mitigation", "sObject": true}, {"id": "rel-note-coa", "type": "note_course_of_action", "object_id": "note-mitigation", "target_id": "coa-mitigation", "sObject": true}]}}, "technical_analysis": {"Introduction": "The CVE-2007-0229 vulnerability is a heap-based buffer overflow in the ffs_mountfs function that allows an attacker to create a malicious DMG image that can be used to exploit the vulnerability.", "Impact and Scope": "The vulnerability is identified as a high-severity weakness by CVSSv2, with a score of 7.2. It allows an attacker to cause a denial of service (panic) and possibly gain privileges.", "Related MITRE ATT&CK Techniques": "The vulnerability is related to MITRE ATT&CK techniques T1190, T1203, and T1077.", "Technical Details": "The vulnerability is caused by an integer overflow in the ffs_mountfs function, which can lead to a heap-based buffer overflow.", "Detection": "Detection can be done by looking for signs of file system mounting manipulation and unusual system behavior.", "Mitigation": "The vulnerability can be mitigated by implementing controls to restrict file system mounting and validating user input.", "Conclusion": "In conclusion, the CVE-2007-0229 vulnerability is a high-severity weakness that can be exploited by an attacker to cause a denial of service (panic) and possibly gain privileges. It is important to implement controls to restrict file system mounting and validate user input to mitigate the risk of exploitation."}, "executive_analysis": {"Overview": "The CVE-2007-0229 vulnerability is a critical weakness that can have significant business and technical impact.", "Business Impact": "The vulnerability can potentially allow an attacker to gain privileged access to the system, which can lead to significant business disruption and data compromise.", "Technical Impact": "The vulnerability is a high-severity weakness that can be exploited to cause a denial of service (panic) and possibly gain privileges.", "Mitigation Strategies": "To mitigate the risk of exploitation, it is important to implement controls to restrict file system mounting and validate user input.", "Recommendations": "Based on the analysis, we recommend implementing controls to restrict file system mounting and validating user input to mitigate the risk of exploitation.", "Conclusions": "In conclusion, the CVE-2007-0229 vulnerability is a critical weakness that can have significant business and technical impact. It is important to implement controls to restrict file system mounting and validate user input to mitigate the risk of exploitation."}}