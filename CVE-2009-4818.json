{"id": "CVE-2009-4818", "sourceIdentifier": "cve@mitre.org", "published": "2010-04-27T15:30:00.797", "lastModified": "2017-08-17T01:31:46.180", "vulnStatus": "Modified", "cveTags": [], "evaluatorComment": "Per: http://cwe.mitre.org/data/definitions/434.html\r\n\r\n'CWE-434: Unrestricted Upload of File with Dangerous Type'", "descriptions": [{"lang": "en", "value": "Unrestricted file upload vulnerability in upload.php in PHPSimplicity Simplicity oF Upload 1.3.2 allows remote attackers to execute arbitrary PHP code by uploading a file with a double extension, as demonstrated by .php.gif."}, {"lang": "es", "value": "Vulnerabilidades de subida de archivos sin restricci\u00f3n en upload.php en PHPSimplicity Simplicity oF Upload v1.3.2 permite a atacantes remotos ejecutar c\u00f3digo PHP de su elecci\u00f3n por la carga de un archivo con doble extensi\u00f3n, como ha sido demostrado con uno .php.gif. \r\n"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpsimplicity:simplicity_of_upload:1.3.2:*:*:*:*:*:*:*", "matchCriteriaId": "0180D91E-66EA-4A24-AA2E-16F658FF6F2F"}]}]}], "references": [{"url": "http://www.exploit-db.com/exploits/10568", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.securityfocus.com/bid/37424", "source": "cve@mitre.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/54952", "source": "cve@mitre.org"}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2009-4818 - The vulnerability allows remote attackers to execute arbitrary PHP code by uploading a file with a double extension. This is a classic example of a file inclusion vulnerability, where an attacker can include malicious PHP code by uploading a PHP file with a .php.gif extension. This technique is relevant as it allows an attacker to gain initial access to the system, which can be further exploited to achieve persistence, lateral movement, and data exfiltration."}, {"techniqueID": "T1070", "comment": "CVE-2009-4818 - The vulnerability allows remote attackers to execute arbitrary PHP code by uploading a file with a double extension. This is a demonstration of the use of a file inclusion vulnerability to execute arbitrary code. This technique is relevant as it allows an attacker to execute arbitrary code on the system, including the ability to create and modify files, execute system commands, and potentially gain elevated privileges."}], "stix_bundle": {"objects": [{"type": "vulnerability", "id": "CVE-2009-4818", "value": "CVE-2009-4818", "external_ids": ["CVE-2009-4818"], "description": "Unrestricted file upload vulnerability in upload.php in PHPSimplicity Simplicity oF Upload 1.3.2 allows remote attackers to execute arbitrary PHP code by uploading a file with a double extension.", "impact": "PARTIAL", "affected_product": "PHPSimplicity Simplicity oF Upload v1.3.2", "attack_vector": "NETWORK", "cvss_score": 6.8, "cvss_vector": "CVSS:2.0/AV:N/AC:M/Au:N/C:P/I:P/A:P", "references": [{"source_name": "MITRE", "url": "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4818"}, {"source_name": "NVD", "url": "https://web.nvd.com/web.nvd.json?v=2.0&cve_id=CVE-2009-4818"}], "analysis": {"intelligence": [{"id": "T1190", "label": "Exploit Public-Facing Application", "comment": "An attacker can exploit the vulnerability by uploading a PHP file with a double extension."}, {"id": "T1070", "label": "Customizable Remote Access Tool", "comment": "An attacker can use the vulnerability to execute arbitrary code on the system."}], "mitigation": [{"note": "Apply the patch released by PHPSimplicity to fix the vulnerability."}]}, "related_courses_of_action": [{"id": "COA-1", "label": "Apply the patch released by PHPSimplicity", "description": "Apply the patch released by PHPSimplicity to fix the vulnerability.", "mitigates": ["T1190", "T1070"], "notes": [{"title": "Additional Information", "content": "For more information, please refer to the PHPSimplicity patch documentation."}]}], "affected_components": [{"id": "COMP-1", "label": "PHPSimplicity Simplicity oF Upload v1.3.2", "description": "PHPSimplicity Simplicity oF Upload v1.3.2 is vulnerable to the file inclusion vulnerability."}]}]}, "technical_analysis": {"Introduction": "The vulnerability is a classic example of a file inclusion vulnerability, where an attacker can include malicious PHP code by uploading a PHP file with a .php.gif extension.", "Impact and Scope": "The vulnerability allows remote attackers to execute arbitrary PHP code, which can be used to gain initial access to the system, execute system commands, and potentially gain elevated privileges.", "Related MITRE ATT&CK Techniques": "T1190 - Exploit Public-Facing Application, T1070 - Customizable Remote Access Tool", "Technical Details": "The vulnerability occurs because the upload.php script does not properly validate the file extension before uploading the file. This can be exploited by an attacker to include malicious PHP code.", "Detection": "Detection can be performed by monitoring the system for suspicious file upload activity and analyzing the file contents for malicious code.", "Mitigation": "Apply the patch released by PHPSimplicity to fix the vulnerability.", "Conclusion": "The vulnerability is a serious security risk and must be patched as soon as possible to prevent exploitation by attackers."}, "executive_analysis": {"Overview": "The vulnerability is a critical security risk that can allow attackers to execute arbitrary PHP code on the system.", "Business Impact": "The vulnerability can result in unauthorized access to sensitive data, system compromise, and potentially significant financial losses.", "Technical Impact": "The vulnerability can allow attackers to execute system commands, create and modify files, and potentially gain elevated privileges on the system.", "Mitigation Strategies": "Apply the patch released by PHPSimplicity to fix the vulnerability.", "Recommendations": "Recommend that the system administrator apply the patch as soon as possible to prevent exploitation by attackers.", "Conclusions": "The vulnerability is a serious security risk that must be addressed promptly to protect the system and its data."}}