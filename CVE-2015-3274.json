{"id": "CVE-2015-3274", "sourceIdentifier": "secalert@redhat.com", "published": "2016-02-22T05:59:02.100", "lastModified": "2020-12-01T14:54:45.183", "vulnStatus": "Modified", "cveTags": [], "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in the user_get_user_details function in user/lib.php in Moodle through 2.6.11, 2.7.x before 2.7.9, 2.8.x before 2.8.7, and 2.9.x before 2.9.1 allows remote attackers to inject arbitrary web script or HTML by leveraging absence of an external_format_text call in a web service."}, {"lang": "es", "value": "Vulnerabilidad de XSS en la funci\u00f3n user_get_user_details en user/lib.php en Moodle hasta la versi\u00f3n 2.6.11, 2.7.x en versiones anteriores a 2.7.9, 2.8.x en versiones anteriores a 2.8.7 y 2.9.x en versiones anteriores a 2.9.1 permite a atacantes remotos inyectar secuencias de comandos web o HTML arbitrarios aprovechando la ausencia de una llamada external_format_text en un servicio web."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.0:*:*:*:*:*:*:*", "matchCriteriaId": "05112EC5-3AAA-499B-8763-345187529C09"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.1:*:*:*:*:*:*:*", "matchCriteriaId": "71407960-077B-4407-B249-789436687D91"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.2:*:*:*:*:*:*:*", "matchCriteriaId": "72728F94-D408-4CAD-A214-800B1D1C7971"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.3:*:*:*:*:*:*:*", "matchCriteriaId": "33C1E9B5-6B2B-4230-92F2-EC0FB307ECF4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.4:*:*:*:*:*:*:*", "matchCriteriaId": "6925A366-37EB-41ED-85C8-B56D6A93D4EB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.5:*:*:*:*:*:*:*", "matchCriteriaId": "A6400F9D-9654-444F-9EBB-0F73025AD744"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.6:*:*:*:*:*:*:*", "matchCriteriaId": "66ED87A3-8237-4182-BEF5-052346067737"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.7:*:*:*:*:*:*:*", "matchCriteriaId": "57441C51-2ADB-48B9-A655-82D6B1071C26"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.8:*:*:*:*:*:*:*", "matchCriteriaId": "0E8D7276-415B-4394-8CBE-53EB40B8C5BB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.9:*:*:*:*:*:*:*", "matchCriteriaId": "65CA6C47-3E85-4639-9E04-E9E63D0CED06"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.6.10:*:*:*:*:*:*:*", "matchCriteriaId": "105490A4-7F97-467C-9015-069CE25980EB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.0:*:*:*:*:*:*:*", "matchCriteriaId": "4E051AAC-EB40-491F-AF0E-EE8143C12567"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.1:*:*:*:*:*:*:*", "matchCriteriaId": "FADBE87F-1855-453B-B958-0CB8A7908A06"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.2:*:*:*:*:*:*:*", "matchCriteriaId": "1B53A7D2-BDA2-4185-97C3-977A04876A37"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.3:*:*:*:*:*:*:*", "matchCriteriaId": "A51DFFA8-DFF0-429C-B697-F82F41621FEE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.4:*:*:*:*:*:*:*", "matchCriteriaId": "19FD1565-0DA1-4BA8-A501-86F13D3D29ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.5:*:*:*:*:*:*:*", "matchCriteriaId": "6D82CFE8-C38D-4FF3-BC4F-6C27AD64D9A3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.6:*:*:*:*:*:*:*", "matchCriteriaId": "FEB754AF-3DA4-4459-A53B-3BC7B78CE313"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.7:*:*:*:*:*:*:*", "matchCriteriaId": "F57E8383-C3F3-480C-B9A9-49633DAAEC18"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.7.8:*:*:*:*:*:*:*", "matchCriteriaId": "645E8B7B-1AE6-4F46-AFA9-7506685CD571"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.0:*:*:*:*:*:*:*", "matchCriteriaId": "12737AF4-B2D5-4661-B06A-6A06FE95EC2D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.1:*:*:*:*:*:*:*", "matchCriteriaId": "88C59A94-D225-478A-B23E-41C4324BC643"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.2:*:*:*:*:*:*:*", "matchCriteriaId": "192EA69B-A1E1-4E0D-8E73-76EB74CCDE49"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.3:*:*:*:*:*:*:*", "matchCriteriaId": "D88385B1-EEFB-4825-BD8F-215C39FD86DA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.4:*:*:*:*:*:*:*", "matchCriteriaId": "A3BE2782-D167-4237-B57D-2E4C04571524"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.5:*:*:*:*:*:*:*", "matchCriteriaId": "F277F979-12FA-47A5-B0A5-D174C2127A7D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.8.6:*:*:*:*:*:*:*", "matchCriteriaId": "38498617-8E45-4E73-AE9F-C7A0D18FDE47"}, {"vulnerable": true, "criteria": "cpe:2.3:a:moodle:moodle:2.9.0:*:*:*:*:*:*:*", "matchCriteriaId": "C9224D94-1C48-468C-A39B-B2694ED178F4"}]}]}], "references": [{"url": "http://git.moodle.org/gw?p=moodle.git&a=search&h=HEAD&st=commit&s=MDL-50130", "source": "secalert@redhat.com"}, {"url": "http://openwall.com/lists/oss-security/2015/07/13/2", "source": "secalert@redhat.com"}, {"url": "http://www.securitytracker.com/id/1032877", "source": "secalert@redhat.com"}, {"url": "https://moodle.org/mod/forum/discuss.php?d=316664", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}], "techniques": [{"techniqueID": "T1046", "comment": " CVE-2015-3274 - This is an example of a cross-site scripting (XSS) vulnerability that allows an attacker to inject arbitrary web script or HTML. It is a potential entry vector for a web application attack, and defenders should prioritize addressing this vulnerability to prevent exploitation."}, {"techniqueID": "T1190", "comment": " CVE-2015-3274 - Cross-site scripting (XSS) vulnerabilities can be used to facilitate phoning home, where an attacker sends stolen data to a command and control server. Defenders should monitor for suspicious network traffic and implement measures to prevent data exfiltration."}, {"techniqueID": "T1075", "comment": " CVE-2015-3274 - Cross-site scripting (XSS) vulnerabilities can be used to facilitate lateral movement across a network, allowing an attacker to move laterally and increase their attack surface. Defenders should prioritize implementing segmentation and access controls to prevent lateral movement."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "Bundle:cve-2015-3274", "objects": [{"type": "attack-pattern", "id": "AP:00001234", "name": "XSS Vulnerability", "description": "A cross-site scripting (XSS) vulnerability in the user_get_user_details function in user/lib.php in Moodle through 2.6.11, 2.7.x before 2.7.9, 2.8.x before 2.8.7, and 2.9.x before 2.9.1 allows remote attackers to inject arbitrary web script or HTML by leveraging absence of an external_format_text call in a web service."}, {"type": "vulnerability", "id": "V:00001235", "name": "Moodle XSS Vulnerability", "description": "A cross-site scripting (XSS) vulnerability in the user_get_user_details function in user/lib.php in Moodle through 2.6.11, 2.7.x before 2.7.9, 2.8.x before 2.8.7, and 2.9.x before 2.9.1 allows remote attackers to inject arbitrary web script or HTML by leveraging absence of an external_format_text call in a web service."}, {"type": "course-of-action", "id": "COA:00001236", "name": "Update Moodle to a Non-Vulnerable Version", "description": "Update the Moodle installation to a non-vulnerable version to prevent exploitation of this vulnerability.", "mitigates": [{"ref_id": "AP:00001234"}]}], "relationships": [{"type": "has-part", "id": "Bundle-part-1", "source_ref_id": "Bundle:cve-2015-3274", "target_ref_id": "AP:00001234"}, {"type": "has-part", "id": "Bundle-part-2", "source_ref_id": "Bundle:cve-2015-3274", "target_ref_id": "V:00001235"}, {"type": "mitigates", "id": "Bundle-mitigates-1", "source_ref_id": "COA:00001236", "target_ref_id": "AP:00001234"}]}, "technical_analysis": {"Introduction": "Moodle, an open-source Learning Management System, has a critical vulnerability in its user_get_user_details function, allowing remote attackers to inject arbitrary web script or HTML.", "Impact and Scope": "This vulnerability affects Moodle versions 2.6.0 through 2.9.x and has a CVSS score of 6.1 with a low attack vector and no privileges required.", "Related MITRE ATT&CK Techniques": "T1046, T1190, and T1075", "Technical Details": "The vulnerability is due to the absence of an external_format_text call in a web service, allowing an attacker to inject arbitrary web script or HTML.", "Detection": "Network traffic monitoring and web application scanning can be used to detect this vulnerability.", "Mitigation": "Updating to a non-vulnerable version is the most effective mitigation strategy.", "Conclusion": "This vulnerability is a critical security risk and should be prioritized for patching."}, "executive_analysis": {"Overview": "Moodle has a critical vulnerability in its user_get_user_details function, allowing remote attackers to inject arbitrary web script or HTML.", "Business Impact": "This vulnerability has the potential to compromise sensitive data and disrupt business operations.", "Technical Impact": "The vulnerability can be exploited to target users and gain unauthorized access to sensitive data.", "Mitigation Strategies": "Prioritize updating to a non-vulnerable version and implement network traffic monitoring and web application scanning.", "Recommendations": "Executives should prioritize addressing this vulnerability to prevent exploitation and reduce business risk.", "Conclusions": "This vulnerability is a critical security risk and should be addressed promptly to minimize business impact."}}