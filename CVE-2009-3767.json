{"id": "CVE-2009-3767", "sourceIdentifier": "cve@mitre.org", "published": "2009-10-23T19:30:00.250", "lastModified": "2020-10-14T17:13:00.343", "vulnStatus": "Analyzed", "cveTags": [], "descriptions": [{"lang": "en", "value": "libraries/libldap/tls_o.c in OpenLDAP 2.2 and 2.4, and possibly other versions, when OpenSSL is used, does not properly handle a '\\0' character in a domain name in the subject's Common Name (CN) field of an X.509 certificate, which allows man-in-the-middle attackers to spoof arbitrary SSL servers via a crafted certificate issued by a legitimate Certification Authority, a related issue to CVE-2009-2408."}, {"lang": "es", "value": "libraries/libldap/tls_o.c en OpenLDAP, cuando se usa OpenSSL, no maneja de forma adecuada el caracter  '\\0' en un nombre de dominio, dentro del campo sujeto del Common Name (CN) en los certificados X.509, lo\r\nque permite a atacantes man-in-the-middle, esp\u00edar servidores SSL de su elecci\u00f3n a trav\u00e9s de certificados manipulados concedidos por Autoridades Certificadoras, esta relacionado con CVE-2009-2408.\r\n"}], "vendorComments": [{"organization": "Red Hat", "comment": "Red Hat is aware of this issue and is tracking it via the following bug: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2009-3767\n\nThis issue was addressed in the openldap packages as shipped with Red Hat Enterprise Linux 5 and 4 via: https://rhn.redhat.com/errata/RHSA-2010-0198.html and https://rhn.redhat.com/errata/RHSA-2010-0543.html respectively.\n\nThe Red Hat Security Response Team has rated this issue as having moderate security impact, a future openldap update may address this flaw in Red Hat Enterprise Linux 3.", "lastModified": "2010-07-20T00:00:00"}, {"organization": "OpenLDAP", "comment": "OpenLDAP reported this issue and published a patch for it on 2009-07-30. The patch was included in OpenLDAP 2.4.18 which was released on 2009-09-06. The current release of OpenLDAP is available from the following location:\n\nhttp://www.openldap.org/software/download/", "lastModified": "2009-10-30T00:00:00"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-295"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:openldap:openldap:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.4.18", "matchCriteriaId": "1479E6E9-32C0-437A-97D0-896D354BCF46"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:a:openssl:openssl:*:*:*:*:*:*:*:*", "matchCriteriaId": "DDA1CA86-1405-4C25-9BC2-5A5E6A76B911"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:apple:mac_os_x:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.6.2", "matchCriteriaId": "8333C974-DF5B-4098-A766-EB8D875817F5"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:11:*:*:*:*:*:*:*", "matchCriteriaId": "B3BB5EDB-520B-4DEF-B06E-65CA13152824"}]}]}], "references": [{"url": "http://lists.apple.com/archives/security-announce/2009/Nov/msg00000.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://lists.fedoraproject.org/pipermail/package-announce/2010-March/036138.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://lists.opensuse.org/opensuse-security-announce/2009-10/msg00001.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://marc.info/?l=oss-security&m=125198917018936&w=2", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://marc.info/?l=oss-security&m=125369675820512&w=2", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/38769", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://secunia.com/advisories/40677", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://security.gentoo.org/glsa/glsa-201406-36.xml", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://support.apple.com/kb/HT3937", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "http://www.openldap.org/devel/cvsweb.cgi/libraries/libldap/tls_o.c.diff?r1=1.8&r2=1.11&f=h", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.redhat.com/support/errata/RHSA-2010-0543.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.redhat.com/support/errata/RHSA-2011-0896.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2009/3056", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.vupen.com/english/advisories/2010/1858", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A11178", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A7274", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}], "techniques": [{"techniqueID": "T1190", "comment": "CVE-2009-3767 -TLS 0-day exploit allows man-in-the-middle attacks. This technique can be used to manipulate the SSL/TLS certificate and make it appear as a trusted certificate, allowing the attacker to impersonate the actual server. Defense: Enable TLS certificate validation, and verify the authenticity of the server certificate."}, {"techniqueID": "T1193", "comment": "CVE-2009-3767 - An attacker can impersonate any SSL server by issuing a crafted certificate. This can be done by exploiting the SSL/TLS certificate validation vulnerability. Defense: Implement certificate pinning, and validate the server's SSL/TLS certificate."}, {"techniqueID": "T1562", "comment": "CVE-2009-3767 - An attacker can perform a man-in-the-middle attack by intercepting and modifying SSL/TLS traffic. Defense: Implement SSL/TLS encryption, and verify the authenticity of the server certificate."}], "stix_bundle": {"type": "bundle", "spec_version": "2.1", "id": "CVE-2009-3767-STIX-Bundle", "description": "STIX 2.1 Bundle for CVE-2009-3767 - TLS 0-day exploit", "objects": [{"type": "vulnerability", "id": "CVE-2009-3767", "name": "OpenLDAP TLS 0-day exploit", "description": "A vulnerability in the TLS certificate validation of OpenLDAP allows an attacker to impersonate any SSL server by issuing a crafted certificate.", "severity": "MEDIUM", "impact": "PARTIAL", "vulnerable_configuration": "cpe:2.3:a:openldap:openldap:*:*:*:*:*:*:*:*", "exploitability": "HIGH"}, {"type": "attack-pattern", "id": "T1190", "name": "TLS 0-day exploit", "description": "A technique used to manipulate the SSL/TLS certificate and make it appear as a trusted certificate, allowing the attacker to impersonate the actual server.", "platforms": ["Linux", "Windows"], "indicators": ["TLS 0-day exploit"], "tactics": ["Command and Control", "Data Exfiltration"], "mitigation": "Enable TLS certificate validation, and verify the authenticity of the server certificate"}, {"type": "attack-pattern", "id": "T1193", "name": "Impersonate any SSL server", "description": "A technique used to impersonate any SSL server by issuing a crafted certificate, exploiting the SSL/TLS certificate validation vulnerability.", "platforms": ["Linux", "Windows"], "indicators": ["SSL/TLS certificate validation vulnerability"], "tactics": ["Command and Control", "Data Exfiltration"], "mitigation": "Implement certificate pinning, and validate the server's SSL/TLS certificate"}, {"type": "attack-pattern", "id": "T1562", "name": "Man-in-the-middle attack", "description": "A technique used to perform a man-in-the-middle attack by intercepting and modifying SSL/TLS traffic.", "platforms": ["Linux", "Windows"], "indicators": ["SSL/TLS traffic interception"], "tactics": ["Command and Control", "Data Exfiltration"], "mitigation": "Implement SSL/TLS encryption, and verify the authenticity of the server certificate"}, {"type": "course-of-action", "id": "COA-1", "name": "Patch and Update", "description": "Apply the patch for CVE-2009-3767 to the affected OpenLDAP version.", "tasks": ["Apply patch", "Verify certificate validation"], "mitigates": ["T1190", "T1193", "T1562"]}, {"type": "course-of-action", "id": "COA-2", "name": "Implement Certificate Pinning", "description": "Implement certificate pinning to prevent impersonation attacks.", "tasks": ["Implement certificate pinning", "Verify certificate validation"], "mitigates": ["T1193"]}, {"type": "course-of-action", "id": "COA-3", "name": "Verify Server Certificate", "description": "Verify the authenticity of the server certificate to prevent man-in-the-middle attacks.", "tasks": ["Verify server certificate", "Implement SSL/TLS encryption"], "mitigates": ["T1562"]}], "relationships": [{"type": "related", "from": "CVE-2009-3767", "to": "T1190"}, {"type": "related", "from": "CVE-2009-3767", "to": "T1193"}, {"type": "related", "from": "CVE-2009-3767", "to": "T1562"}, {"type": "mitigates", "from": "COA-1", "to": "T1190"}, {"type": "mitigates", "from": "COA-1", "to": "T1193"}, {"type": "mitigates", "from": "COA-1", "to": "T1562"}, {"type": "mitigates", "from": "COA-2", "to": "T1193"}, {"type": "mitigates", "from": "COA-3", "to": "T1562"}]}, "technical_analysis": {"Introduction": "This analysis provides an in-depth technical analysis of the CVE-2009-3767 SSL/TLS 0-day exploit vulnerability in OpenLDAP.", "Impact and Scope": "The vulnerability allows an attacker to impersonate any SSL server by issuing a crafted certificate, which can be used to perform various malicious activities such as data exfiltration and command and control.", "Related MITRE ATT&CK Techniques": "T1190, T1193, and T1562", "Technical Details": "The vulnerability is due to the incorrect handling of a '\\0' character in the domain name component of the X.509 certificate, which allows an attacker to issue a crafted certificate that can be used to impersonate any SSL server.", "Detection": "The vulnerability can be detected by monitoring for suspicious SSL/TLS traffic and verifying the authenticity of the server certificate.", "Mitigation": "Apply the patch for CVE-2009-3767 to the affected OpenLDAP version, implement certificate pinning, and verify the authenticity of the server certificate.", "Conclusion": "The CVE-2009-3767 SSL/TLS 0-day exploit vulnerability is a critical vulnerability that can be used to perform various malicious activities. It is essential to apply the patch and implement certificate pinning to mitigate this vulnerability."}, "executive_analysis": {"Overview": "This analysis provides an executive-level overview of the CVE-2009-3767 SSL/TLS 0-day exploit vulnerability in OpenLDAP.", "Business Impact": "The vulnerability can be used to perform data exfiltration and command and control, which can have significant business impacts such as financial loss and reputational damage.", "Technical Impact": "The vulnerability allows an attacker to impersonate any SSL server, which can be used to perform various malicious activities.", "Mitigation Strategies": "Apply the patch for CVE-2009-3767 to the affected OpenLDAP version, implement certificate pinning, and verify the authenticity of the server certificate.", "Recommendations": "Immediate attention and action should be taken to apply the patch and implement certificate pinning to mitigate this vulnerability.", "Conclusions": "The CVE-2009-3767 SSL/TLS 0-day exploit vulnerability is a critical vulnerability that requires immediate attention and action."}}